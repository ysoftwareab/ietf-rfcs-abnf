<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Fast Stateless Address Auto-configuration and Duplicate Address Detection in IPv6 Network</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Fast Stateless Address Auto-configuration and Duplicate Address Detection in IPv6 Network">
<meta name="keywords" content="template">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Internet Engineering Task Force</td><td class="header">F. Liu</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">C. Chi</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Alcatel-Lucent</td></tr>
<tr><td class="header">Expires: November 17, 2010</td><td class="header">May 16, 2010</td></tr>
</table></td></tr></table>
<h1><br />Fast Stateless Address Auto-configuration and Duplicate Address Detection in IPv6 Network<br />draft-liu-ipv6-fdad-00</h1>

<h3>Abstract</h3>

<p>This document proposes an efficient method to speed the address auto-configuration and Duplicate Address Detection (DAD) in IPv6 network and thus greatly decrease the time spend on the address configuration and DAD. This is achieved by modifing the host and router's behaviour and related IPv6 messages.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on November 17, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Host's Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Access Router's Requirements<br />
<a href="#anchor6">4.</a>&nbsp;
General Fast DAD Procedure<br />
<a href="#anchor7">5.</a>&nbsp;
Message Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.2.</a>&nbsp;
Modified Router Advertisement Message Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.3.</a>&nbsp;
Modified Neighbour Solicitation Message Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.4.</a>&nbsp;
Modified Neighbour Advertisement Message Format<br />
<a href="#anchor12">6.</a>&nbsp;
Modified Host and Router Behaviour<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">6.1.</a>&nbsp;
Modified Host Behaviour<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">6.2.</a>&nbsp;
Modified Router Behaviour<br />
<a href="#procedure">7.</a>&nbsp;
The Example Usage in 802.16 Network<br />
<a href="#IANA">8.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">9.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p><a class='info' href='#RFC2460'>IPv6<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> [RFC2460] is the Internet Protocol designed for the next generation network. Compared with IPv4, some new features are introduced. Among these new features, Stateless Address Configuration <a class='info' href='#RFC2462'>[RFC2462]<span> (</span><span class='info'>Thomson, S. and T. Narten, &ldquo;IPv6 Stateless Address Autoconfiguration,&rdquo; December&nbsp;1998.</span><span>)</span></a>  allows a host to generate its own IPv6 addresses using a combination of locally available information and information advertised by routers. Routers advertise prefixes that identify the subnet(s) associated with a link, while hosts generate an "interface identifier" that uniquely identifies an interface on a subnet. An address is formed by combining the two. Router sends Router Advertisements (RA) periodically which contain two flags indicating what type of auto-configuration (if any) should be performed. A "managed address configuration" flag indicates whether hosts should use stateless auto-configuration to obtain addresses. The RA message also contains zero or more Prefix Information options that provide on-link prefixes for address auto-configuration. 
	  
</p>
<p> Upon receiving the RA message, the host generates an IPv6 address based on the received Prefix Information by itself. Then the host performs Duplicate Address Detection (DAD) by sending out a Neighbor Solicitation (NS) message containing the newly generated address. If the address is already used by another host, that host replies with a Neighbor Advertisement (NA) defending the address. Once a defending NA is received, the address auto-configuration process is stopped, another address is re-generated or manual configuration is performed. 

Once it has sent the NS, the node waits for RetransTimer milliseconds (ms) for a defending NA, and this solicit-and-wait process is repeated DupAddrDetectTransmits times.  The default value of RetransTimer is 1000ms and by default the process is done once, resulting in a default delay of 1000ms, i.e., 1 second (s) for DAD.
	  
</p>
<p> For Mobile IPv6 [RFC3775] enabled nodes, part of the Layer 3 handover delay is contributed by the configuration of the Care-of-Address (CoA) and DAD when the node moves into a visiting network. From the above analysis, the address configuration and DAD process may add up to 1s delay, which is significant for real-time applications such as VoIP. Hence if we could reduce the time spending on DAD procedure, the whole Mobile IPv6 handover procedure could be speed up. 
	  
</p>
<p>
		Some methods have been proposed to reduce the duration time of DAD. 
		
		
		
</p>
<p>	
 In [RFC4429], Optimistic Duplicate Address Detection is proposed by N. Moore. In this proposal, a new address state, 'Optimistic', is introduced. This state is used to mark an address that is available for use but that has not completed DAD. The use of Optimistic Address is limited, for example, it should not be used as a source address in new communications. However for MIPv6, if the Optimistic Address is used in the Binding Update message as the Care-of-Address before the DAD process is finished, the handover process may be disrupted when duplicated address is detected. 
		
</p>
<p>
In [END], the Access Router maintains an Address Cache which contains a list of addresses of all connected hosts. To check an address, an MS sends Neighbor Solicitations per RFC2461 and RFC2462.  Upon receiving the NS, the Access Router compares the tentative address in the NS against the entries in its Address Cache.  If there is no match, the Access Router makes an entry for the (tentative) address in its Address Cache and sends a special Router Advertisement to the MS indicating the address's uniqueness. If there is a match that indicates that the address is conflict with another host, the Access Router relays the NS to the address owner without any modification.  Upon receiving the NS, the address owner replies with an NA to defend its address. The Access Router relays the NA to the soliciting MS without any modification.  Upon receiving the defending NA, the soliciting MS perceives the address conflict and refrains from assigning the tentative address to the interface. This mechanism reduces the DAD process significantly, however, there is still some delay introduced by the signaling exchange.
		
</p>
<p>
		
		
</p>
<p> 
		Some access networks are point-to-multipoint networks in which the hosts can not communicate with other hosts connected to the same access router and all communication should go through the access router first. For example, in IEEE 802.16 (WiMAX) network [RFC5154], the subscriber station is not capable of multicasting (e.g., for neighbor discovery, IP multicasting services, etc.) or direct communication to the other nodes attached to the same Base Station within the same subnet (prefix).   
		
</p>
<p> Proxy Neighbour Discovery (PND) is often used to handle the neighbour discovery problem in the above networks. The access router maintains an address table which contains a list of IPv6 addresses and corresponding link-layer addresses that are being used by all IPv6 hosts in the same subnet. Upon receiving NS, the router would relay the NS message to the solicited host or send back a NA message directly on behalf of the solicited host.   
		
</p>
<p> In this document, a fast Stateless Address Auto-configuration and DAD process is proposed, in which an Address Table is used to contain the addresses and their corresponding link-layer addresses of all hosts in the same link. Unlike the standard method as defined in [RFC2462], after the stateless address configuration, an explicit NS message is sent to notify the access router. In addition, since the probability of having a duplicate address is too small, the DAD process is omitted by the host. Instead, the access router performs the DAD on behalf of the host. If duplicate address is detected, then the access router notifies the host to re-generate a new address.  
		
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT","SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in BCP 14 [STANDARDS].
	
</p>
<p></p>
<ul class="text">
<li> MS - Mobile Station. 
</li>
<li> BS - Base Station. 
</li>
</ul>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Requirements</h3>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Host's Requirements</h3>

<p>
	The host should set the access router as the default gateway after receiving the RA message from it and all communication should go through the router;
The host should be able to process the modified messages as defined below.
	
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Access Router's Requirements</h3>

<p>
	The access router should maintain an address table. This table contains the host's IPv6 address, link-layer address, life time and etc. 
	Access routers should process all received NS with specified and unspecified source address and solicited-node-multicast destination address for DAD and address resolving.
	
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
General Fast DAD Procedure</h3>

<p>
	When a host boots up or moves into a new network, it sends a Router Solicitation (RS) message to perform router and prefix discovery as defined in [RFC2461]. After receiving a valid RS message, the access router should send a special Router Advertisement (RA) as reply. The RA message is used to indicate the fast address configuration and DAD should be used by the host.
	
</p>
<p>
If the host could recognize the special RA message, it generates a stateless IPv6 address as described in RFC2462. Then the host would skip the normal DAD process and sends a special NS message immediately to the access router to notify its configured address.
	
</p>
<p>
After receiving the NS message, the access router compares the address in the message against the entries in its Address Table. If there is no match, the access router create an entry contains the address and the corresponding link-layer address of the host. 
	
</p>
<p>
Otherwise, if there exists a match indicates that the address is duplicate, the access router sends a special NA message to notify the host that duplicate address is detected and another address needs to be generated. Before a new unique address is generated by the host, the access router does not forward the data packet from or to this host.
	
</p>
<p>
If the host receives the special NA message, it should abandon the duplicate address contained in the message. And it should re-generate a new stateless address automatically and repeat the above process.
	
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Message Format</h3>

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Overview</h3>

<p> In this document, the messages defined in IPv6 standards are reused and some modification are made as described below:
</p>
<p>
	</p>
<ul class="text">
<li> 
	An "E" indication bit is added to the reserved section of the RA message.
	
</li>
<li>
	An "E" and "D" indication bit is added to the reserved section of the NS message.
	
</li>
<li>
	An "E" indication bit is added to the reserved section of the NA message.
	
</li>
</ul><p>
	
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Modified Router Advertisement Message Format</h3>

<p>
The fields in the message are as defined in RFC2461 <a class='info' href='#RFC2461'>RFC 2461<span> (</span><span class='info'>Narten, T., Nordmark, E., and W. Simpson, &ldquo;Neighbor Discovery for IP Version 6 (IPv6),&rdquo; December&nbsp;1998.</span><span>)</span></a> [RFC2461]except one bit (E bit) is added to the 'Reserved' field. If the access router wants to request the hosts to use the fast stateless address configuration, it must set the 'E' bit of the RA message sent to the hosts in order to indicate the fast address configuration and DAD may be used.  
	
</p><br /><hr class="insert" />
<a name="fig1"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |     Code      |          Checksum             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Cur Hop Limit |M|O|E|Reserved |       Router Lifetime         |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                         Reachable Time                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          Retrans Timer                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                 Prefix Information Option                     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Modified Router Advertisement Message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Modified Neighbour Solicitation Message Format</h3>

<p>

The fields in the message are as defined in RFC2461 except two bits ('E' bit and 'D' bit) is added to the 'Reserved' field. The 'E' bit is set if the host want to register its auto-configured address with the access router explicitly. The 'D' bit is set if the host want to de-register its generated address with the access router explicitly. The 'Target Address' is set to the address auto-configured by the host.
	
</p><br /><hr class="insert" />
<a name="fig2"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |     Code      |          Checksum             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |E|D|                        Reserved                           |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                        Target Address                         |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Options ...
     +-+-+-+-+-+-+-+-+-+-+-+-
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Modified Neighbour Solicitation Message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Modified Neighbour Advertisement Message Format</h3>

<p>
The fields in the message are as defined in RFC2461. One bit (E bit) is added to the 'Reserved' field. This message is sent to the host by the access router to indicate that duplicate address is detected. The 'Target Address' is the duplicated address detected by the access router.
	
</p><br /><hr class="insert" />
<a name="fig3"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |     Code      |          Checksum             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |R|S|0|E|                    Reserved                           |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                        Target Address                         |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Options ...
     +-+-+-+-+-+-+-+-+-+-+-+-
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Modified Neighbour Advertisement Message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Modified Host and Router Behaviour</h3>

<p>The host and access router behaviours should be modified to deal with these modified messages.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Modified Host Behaviour</h3>

<p>
Upon receiving a RA message, the host should check the 'E' bit of the message to see if the fast stateless address auto-configuration is required. If the 'M' bit is not set and 'E' bit is set, a stateless IPv6 address is generated according to the procedure defined in RFC2462. In the proposed mechanism, the 'Tentative Address' is not used anymore. The generated address is assigned to the host's interface as an effective address and an explicit NS message is send to the access router immediately. In this message, the 'E' bit is set to indicate that this is an explicit registration message for fast DAD. 
	
</p>
<p>
Afterwards, if a NA message is received and the 'E' bit is set in the message, the host compares the 'Target Address' with its own generated address. If the two addresses are the same, then a duplicate address is detected by the access router. The host must abandon the current assigned address and re-generated an address as defined in RFC2462. As described as above, the data packets sent before the NA message is received are discarded by the router. Because the router would send the NA message to the host immediately after the duplicated address is detected, the impact on the host is small. 
	
</p>
<p>
When the host wants to move out of the subnet or stop using the address, it sends a NS message with 'D' bit set to the access router to de-register the address explicitly.
	
</p>
<p>
If the host can not recognize the 'E' and 'D' bit in the RA and NA message, its behavior is the same as defined in RFC2462.
	
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Modified Router Behaviour</h3>

<p>
In the proposed mechanism, the 'E' bit is set in the RA message to indicate the fast address configuration and DAD are used. The RA message is sent periodically or when a Router Solicitation message is received. Upon receiving a Neighbour Solicitation message, the router checks if the 'E' bit of the message is set. If the 'E' bit is set, the router compares the 'Target Address' field in the message against the Address Table. If there is a match, then the address is conflict with another host. The router must send the host a NA message with 'E' bit set to indicate the duplicate address is detected. Before a unique address is re-generated by the host, all messages sent from the host must not be forwarded to other nodes, so the duplicate address does not cause problems for other hosts. If there is no match in the Address Table, the router creates an entry in the Address Table to store the 'Target Address' and the corresponding link-layer address. 
	
</p>
<p>
If the 'D' bit is set in the received NS message, the access router compares the 'Target Address' field in the message against the Address Table. If there is a match, then delete the entry that contains the address. If there is no match in the Address Table, just ignore the message.
	
</p>
<p>
After the entry is created, the updating and ageing of the contents of the entry could refer to the Neighbor Cache maintaining procedure described in RFC2461. 
	
</p>
<p>
If the 'E' bit and 'D' bit are not set in the received NS message, the NS is treated as a normal address resolving message. The router compares the 'Target Address' field against the address list. If there is a match, then a normal NA message is sent to the soliciting host. In this NA message, the 'Target Address' field is set to the one in the NS message. If there is no match and the source address of the NS message is unspecified, then the NS message is sent out in the normal DAD process. Then an entry is created to contain the 'Target Address' and link-layer address in the NS message. So the router could support both modified hosts and un-modified hosts.
		
</p>
<a name="procedure"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
The Example Usage in 802.16 Network</h3>

<p>
Let's suppose a mobile subscriber station (MS) is moving into a mobile WiMAX network (802.16e) in which Mobile IPv6 (MIPv6) is supported. As mentioned as above, the WiMAX IP network is a point-to-multipoint network.  A MS can not communicate with another MS directly. All the traffic should go through an Access Router (ASN-GW) as shown in Figure 4. One thing to be noted is that in 802.16 networks sometimes the DAD process can be omitted, e.g., as described in [RFC5121] [RFC5154]. In these cases, the method described in the document is not necessary.

The process when the MS roams into a new access network is described as the follow:
</p>
<ol class="text">
<li>	After finishing layer-2 handover, the MS send a RS message to the Access Router (AR); 
</li>
<li>
Upon receipt of the RS message, the AR sends a RA message to the MS. In this message, the 'E' bit is set to indicate the fast address configuration and DAD. Also the 'Prefix Information' option is included in the message;

</li>
<li>
The MS generates a stateless address based on the prefix information extracted from the RA message. The MS also set the AR as the default gateway;

</li>
<li>
After the address is generated, an explicit NS message is sent to the AR.

</li>
<li>
The AR checks the address contained in the NS message in its address list. If not found, the AR creates an entry for this MS in which the CoA and the corresponding link-layer address is contained.

</li>
<li>
If duplicate address is found, an NA message with 'E' bit set is sent to the MS by the AR.


</li>
<li>
The MS uses the address as the Care-of-Address (CoA), and sends a Binding Update (BU) message to register with Home Agent. If the CoA is not in conflict with other MSs, the AR forwards the BU message to the next hop. Otherwise, the BU message is discarded by the AR. And the MS must re-generate a new CoA and repeats the above steps; When the MS is about to move out from the subnet, it sends a NS message with 'D' bit set to de-register with the access router explicitly. If the MS does not send the explicit de-register message before moving out, the corresponding entry in the access router would be invalid after the lifetime expires.

</li>
</ol><p>
From the above procedure, we could see that the proposed mechanism can significantly decrease the overall handover delay by reducing the time spent in address configuration and DAD. So it could reduce the overall handover delay in Mobile IPv6 networks.

	
</p><br /><hr class="insert" />
<a name="fig4"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
              +-----+       +-----+      +----------+          +----+
              | MS1 |-------|     |      | +-----+  |          | CN |
              +-----+       |     |------| | HA  |  |          +----+
              +-----+       | AR1 |      | +-----+  |             |
              | MS2 |-------|     |      |          |             |
           |  +-----+       +-----+      |          |             |
           |                             | +-----+  |--------- Internet
           |  +-----+       +-----+      | | AAA |  |
           V  | MS2 |-------|     |------| +-----+  |
              +-----+       |     |      |          |
              +-----+       | AR2 |      +----------+
              | MS3 |-------|     |
              +-----+       +-----+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Handover in Mobile 802.16 Networks&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>This document includes no request to IANA.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>This document does not introduce any new vulnerabilities to IPv6
   specifications or operation.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2460">[RFC2460]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a> and <a href="mailto:hinden@iprg.nokia.com">R. Hinden</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;2460, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2460.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2460.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2460.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2461">[RFC2461]</a></td>
<td class="author-text"><a href="mailto:narten@raleigh.ibm.com">Narten, T.</a>, <a href="mailto:nordmark@sun.com">Nordmark, E.</a>, and <a href="mailto:bsimpson@MorningStar.com">W. Simpson</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2461">Neighbor Discovery for IP Version 6 (IPv6)</a>,&rdquo; RFC&nbsp;2461, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2461.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2461.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2461.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2462">[RFC2462]</a></td>
<td class="author-text"><a href="mailto:set@thumper.bellcore.com">Thomson, S.</a> and <a href="mailto:narten@raleigh.ibm.com">T. Narten</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2462">IPv6 Stateless Address Autoconfiguration</a>,&rdquo; RFC&nbsp;2462, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2462.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2462.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2462.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4429">[RFC4429]</a></td>
<td class="author-text">Moore, N., &ldquo;<a href="http://tools.ietf.org/html/rfc4429">Optimistic Duplicate Address Detection (DAD) for IPv6</a>,&rdquo; RFC&nbsp;4429, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4429.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4968">[RFC4968]</a></td>
<td class="author-text">Madanapalli, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4968">Analysis of IPv6 Link Models for 802.16 Based Networks</a>,&rdquo; RFC&nbsp;4968, August&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4968.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5121">[RFC5121]</a></td>
<td class="author-text">Patil, B., Xia, F., Sarikaya, B., Choi, JH., and S. Madanapalli, &ldquo;<a href="http://tools.ietf.org/html/rfc5121">Transmission of IPv6 via the IPv6 Convergence Sublayer over IEEE 802.16 Networks</a>,&rdquo; RFC&nbsp;5121, February&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5121.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5154">[RFC5154]</a></td>
<td class="author-text">Jee, J., Madanapalli, S., and J. Mandin, &ldquo;<a href="http://tools.ietf.org/html/rfc5154">IP over IEEE 802.16 Problem Statement and Goals</a>,&rdquo; RFC&nbsp;5154, April&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5154.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ADAD">[ADAD]</a></td>
<td class="author-text">Han, Y., Choi, J., Jang, H., and S. Park, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-han-mobileip-adad-01.txt.txt">Advance Duplicate Address Detection</a>,&rdquo; draft-han-mobileip-adad-01.txt (work in progress), 2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="END">[END]</a></td>
<td class="author-text">Xia, F. and B. Sarikaya, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-xia-16ng-end-01.txt">Duplicate Address Detection Optimization Using Enhanced Neighbor Discovery</a>,&rdquo; draft-xia-16ng-end-01 (work in progress), December&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-xia-16ng-end-01.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fang Liu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alcatel-Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Beijing,   </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86 10 58605827</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:christine.liu@alcatel-lucent.com">christine.liu@alcatel-lucent.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Caixia Chi</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alcatel-Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Beijing,   </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86 10 58605828</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:caixia.chi@alcatel-lucent.com">caixia.chi@alcatel-lucent.com</a></td></tr>
</table>
</body></html>
