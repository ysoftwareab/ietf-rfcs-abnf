<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>PKI Resource Query Protocol (PRQP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="PKI Resource Query Protocol (PRQP)">
<meta name="keywords" content="PKI, Resource Discovery, Protocol">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">PKIX Working Group</td><td class="header">M. Pala</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Dartmouth College</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">February 25, 2008</td></tr>
<tr><td class="header">Expires: August 28, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />PKI Resource Query Protocol (PRQP)<br />draft-pala-prqp-01</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 28, 2008.</p>

<h3>Abstract</h3>

<p>One of the most strategic problems still open in PKIX is locating
   public data and services associated with a Certification Authority (CA).
   This issue impacts interoperability and usability in PKIX.
   <br />
<br />

   This draft describes the PKI Resource Query Protocol (PRQP), its design,
   definition, and its impact in already deployed PKIX protocols.
   <br />
<br />

   
   
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Requirements notation<br />
<a href="#intro">2.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#overview">2.1.</a>&nbsp;
Overview of existing solutions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#exts">2.1.1.</a>&nbsp;
Certificate Extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dnssrv">2.1.2.</a>&nbsp;
DNS SRV records<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lan">2.1.3.</a>&nbsp;
Local Network Oriented Solutions<br />
<a href="#proto">3.</a>&nbsp;
Protocol Details<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rqa">3.1.</a>&nbsp;
The Resource Query Authority (RQA)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prqpover">3.2.</a>&nbsp;
PRQP Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#req">3.2.1.</a>&nbsp;
PRQP Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#reqsyn">3.2.1.1.</a>&nbsp;
Request Syntax<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prqpresp">3.2.2.</a>&nbsp;
PRQP Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#respsyn">3.2.2.1.</a>&nbsp;
Response Syntax<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#iana">3.3.</a>&nbsp;
IANA Considerations<br />
<a href="#rationale">4.</a>&nbsp;
PRQP Design Rationale<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#complexity">4.1.</a>&nbsp;
Response Complexity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#uri">4.2.</a>&nbsp;
RQA's URL distribution<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security">4.3.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#time">4.4.</a>&nbsp;
Time Validity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#format">4.5.</a>&nbsp;
Message Format<br />
<a href="#acknoledgments">5.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">6.</a>&nbsp;
Normative References<br />
<a href="#app_A">Appendix&nbsp;A.</a>&nbsp;
Distribution of PRQP Responses<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#http">A.1.</a>&nbsp;
PRQP over HTTP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#httpreq">A.1.1.</a>&nbsp;
Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#httpresp">A.1.2.</a>&nbsp;
Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#caching">A.1.3.</a>&nbsp;
Message Caching<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#p2p">A.2.</a>&nbsp;
PRQP over Peer-to-Peer Network<br />
<a href="#ans1">Appendix&nbsp;B.</a>&nbsp;
PRQP ASN1.1 Specification<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Requirements notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
"SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
and "OPTIONAL" in this document are to be interpreted as
described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>
   An increasing number of services and protocols are being defined to
   address different needs of users and administrators of PKIs. With
   the deployment of new applications and services, the need to access
   information and services provided by Certificate Service Providers
   (CSPs) is critical. Currently Certification Authorities (CAs) barely
   publish access details on their official web sites, this includes
   URL of provided services and repositories.
   <br />
<br />

   Using the PRQP, resources provided by a CA can be automatically
   and securely discovered by an application.
   
</p>
<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Overview of existing solutions</h3>

<p>
   Currently there are three options to find URLs providing
   access to PKI data:
   </p>
<ul class="text">
<li>by including such data in certificate extensions
</li>
<li>by searching easily accessible repositories (e.g. DNS, local
     database, etc.)
</li>
<li>by adapting existing protocols (e.g. SLP)
</li>
</ul><p>
   
</p>
<a name="exts"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.1"></a><h3>2.1.1.&nbsp;
Certificate Extensions</h3>

<p>
   To provide pointers to published data it is possible to use
   the Authority Information Access (AIA) Subject Information Access
   (SIA) extensions defined by PKIX <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>.
   <br />
<br />

   The former can provide information about services associated with
   the issuer of the certificate,
   while the latter carries information (inside a CA certificate) about
   offered CA services.
   <br />
<br />

   AIA and SIA extensions are static, i.e. not modifiable unless the
   certificate is re-issued. 
   If a CA inserts the AIA extension into every certificate it issues,
   e.g., to identify the location of an OCSP
   responder, then changing that location would require re-issuance of
   all these certificates, a substantial barrier to such a change. If a CA
   certificate is self-signed and used as a trust anchor, then re-issuing 
   the certificate to change the content of the SIA extension, e.g., to reflect
   a change in the location of a time stamping server would be very disruptive.
   In closed PKIs, e.g., enterprises,
   use of these extensions may be replaced by manual configuration 
   and management of this data via ad hoc means.
   Because of the centrally controlled nature of such environments,
   the static nature of SIA and AIA extensions is not a concern.
   <br />
<br />

   However in order to promote interoperability between PKIs, PRQP enables
   dynamic management of pointers to such services (e.g., adding/removing
   or moving) without requiring changes in the certificate contents or
   third parties to manually configure services in their applications.
   Even in closed environments, PRQP could help manage PKI services 
   analogous the way DHCP facilitates network management.
   
</p>
<a name="dnssrv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.2"></a><h3>2.1.2.&nbsp;
DNS SRV records</h3>

<p>
   The SRV record technique provides pointers to servers via the 
   DNS <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>.
   <br />
<br />

   As defined in <a class='info' href='#RFC2782'>[RFC2782]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a>, the introduction of this 
   type of record allows
   administrators to perform operations similar to what we require
   in order to solve the problem we are addressing in this draft,
   i.e., to provide URLs to services.
   <br />
<br />

   The problem in the adoption of this mechanism is that, in contrast to 
   the DNS environment, usually in PKIX there is no fixed mapping
   between certificates and the DNS name space. 
   The only exception is when the
   Domain Component (DC) attributes are used in the certificate's Subject.
   <br />
<br />

   Currently this approach is not widely adopted. Moreover, it is not
   always easy to identify the right DNS to query to, when trying to find
   a particular service provided by a CA, because of the lack of such
   information in certificates.
   
</p>
<a name="lan"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.3"></a><h3>2.1.3.&nbsp;
Local Network Oriented Solutions</h3>

<p>
   Another approach to provide reliable information is to use existing
   protocols for service location such as Jini, Universal Plug and Play
   protocol (UPnP) or Service Location Protocol (SLP) <a class='info' href='#RFC2608'>[RFC2608]<span> (</span><span class='info'>Guttman, E., Perkins, C., Veizades, J., and M. Day, &ldquo;Service Location Protocol, Version 2,&rdquo; June&nbsp;1999.</span><span>)</span></a>
   <a class='info' href='#RFC2609'>[RFC2609]<span> (</span><span class='info'>Guttman, E., Perkins, C., and J. Kempf, &ldquo;Service Templates and Service: Schemes,&rdquo; June&nbsp;1999.</span><span>)</span></a>.
   <br />
<br />

   The IETF defined the SLP to provide a service location mechanism
   that is language and technology independent.
   Some issues, however, make it not the right choice to solve our
   problem, e.g., the protocol is quite complex to implement when
   considering the scope of the problem we are addressing.
   <br />
<br />

   The definition of a specific and simple protocol for PKI service and
   resource location is needed to ease PKI integration into existing and
   future
   applications, especially for mobile devices which have limited
   computational power and communication bandwidth.
   
</p>
<a name="proto"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Protocol Details</h3>

<p>
   The PRQP protocol is a request-response protocol, formed by the 
   exchanging of two messages, i.e., a request and a response between a
   client and a server, called the Resource Query Authority (RQA).
   <br />
<br />

   The requesting entity (the client) may be any entity that needs
   to access information about repositories and services related
   to a certificate.
   <br />
<br />

   The RQA is the authority entitled to answer for a particular CA or to
   act as a PRQP Trusted Authority (PTA) for a set of users, e.g., users
   in an enterprise environment.
   <br />
<br />

   In the first case the RQA is directly designated by a CA to act
   as an RQA, by having the CA issue a certificate to the RQA with a
   specific value set in the extendedKeyUsage extension.
   In this case the RQA provides authoritative
   responses for requests regarding the CA that issued the RQA's
   certificate.
   <br />
<br />

   When operating as a PTA, the RQA may provide responses about multiple CAs,
   without the need to have been directly certified by them. To operate as
   such, a specific extension (prqpTrustedAuthority) should be present in
   RQA's certificate and its value should be set to TRUE.
   
</p>
<a name="rqa"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
The Resource Query Authority (RQA)</h3>

<p>
   The Resource Query Authority is the designated authority to act as PRQP
   responder. The RQA's signing key needs not to be the same as that of the
   CA that designated it.
   <br />
<br />

   The CA may designate an RQA by issuing a certificate containing a unique
   value for the extendedKeyUsage in RQA's certificate. The RQA may also act
   as a trusted responder. PRQP signing delegation SHALL be designated by
   the inclusion of id-kp-PRQPSigning in the extendedKeyUsage extension
   within the PRQP response signer's certificate.
   </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>id-kp-PRQPSigning OBJECT IDENTIFIER ::= {id-kp 10}
</dd>
</dl></blockquote><p>
   When operating as a PTA, the RQA may provide responses about multiple CAs,
   without the need to have been directly certified by them. To operate as
   a PTA a specific extension (prqpTrustedAuthority) should be present in
   RQA's certificate and its value should be set to TRUE.
   </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>prqpTrustedAuthority ::= BOOLEAN DEFAULT TRUE
</dd>
</dl></blockquote><p>
   
</p>
<a name="prqpover"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
PRQP Overview</h3>

<p>
   The protocol encompasses the exchange of a single round of messages
   between a client and an RQA:
   </p>
<ol class="text">
<li>the client requests a resource token by sending a request to the
         RQA
</li>
<li>the RQA replies by sending a response to the client
</li>
</ol><p>
   Upon receiving the response the client MUST verify the status error
   returned in the response. If no error is present, the client MUST
   verify the
   various fields contained in the ResourceResponseToken and the validity
   of the associated digital signature (if present).
   A nonce MAY be used to guarantee that the response is associated with a
   specific request in order to avoid reply attacks.
   <br />
<br />

   The client also SHOULD check the validity period of the response. It
   SHOULD NOT, in order to minimize the load on an RQA, request again the
   location of the same resource within this interval to the same RQA.
   <br />
<br />

   If the response is signed, the client SHOULD check the RQA's certificate
   validity.
   
</p>
<a name="req"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
PRQP Request</h3>

<p>
   A PRQP request contains the following data:
   </p>
<ul class="text">
<li>protocol version
</li>
<li>nonce
</li>
<li>MaxResponse
</li>
<li>ResourceRequestToken
</li>
<li>Extensions
</li>
</ul><p>
   The ASN.1 syntax imports terms defined in <a class='info' href='#RFC4210'>[RFC4210]<span> (</span><span class='info'>Adams, C., Farrell, S., Kause, T., and T. Mononen, &ldquo;Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP),&rdquo; September&nbsp;2005.</span><span>)</span></a>.
   For signature calculation,
   the data to be signed is encoded by using the DER format. ASN.1 EXPLICIT
   tagging is used as a default unless specified otherwise. The terms
   imported from <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> are: Extensions, Certificate, 
   CertificateSerialNumber, SubjectPublicKeyInfo, Name, AlgorithmIdentifier.
   
</p>
<a name="reqsyn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1.1"></a><h3>3.2.1.1.&nbsp;
Request Syntax</h3>

<p>
   The PRQP request syntax is as follows:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    PRQPRequest ::= SEQUENCE {
        requestData            TBSReqData,
        signature              [0] EXPLICIT Signature OPTIONAL }

    TBSReqData ::= SEQUENCE {
        version                INTEGER { v(1) },
        nonce                  INTEGER              OPTIONAL,
              -- very large number
        maxRespEntries         INTEGER              OPTIONAL,
              -- maximum number of accepted entries in
              -- corresponding response
        serviceToken           ResourceRequestToken,
              -- token identifying the requested service
        extensions         [0] IMPLICIT Extensions  OPTIONAL }
</pre></div>
<p>
   The version field (currently v1) describes the version of the PRQP
   request. The nonce field, if present, is an integer between 80 bits
   and 256 bit in length.
   <br />
<br />

   The MaxResponse identifier is used to tell the RQA the maximum number
   of ResourceResponseToken that presenting can include in the response.
   <br />
<br />

   The ResourceRequestToken is used to identify the requested services.
   It carries information about the requested services. It contains
   a CA identifier and optionally one or more service identifiers.
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      ResourceRequestToken ::= SEQUENCE {
        ca                      CertIdentifier,
        servicesList        [0] SET OF ResourceIdentifier OPTIONAL }
</pre></div>
<p>
   The ca field is of type CertIdentifier. This is used to identify
   the certificate of the CA whose services are requested.
   <br />
<br />

   The CertIdentifier syntax is as follows:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      BasicCertIdentifier ::= SEQUENCE {
        issuerNameHash              OCTET STRING,
        serialNumber                CertificateSerialNumber  }

      ExtenderCertInfo ::= SEQUENCE {
        certificateHash             OCTET STRING,
        subjectKeyHash              OCTET STRING,
        subjectKeyIdentifier    [0] KeyIdentifier          OPTIONAL,
        issuerKeyIdentifier     [1] KeyIdentifier          OPTIONAL    }

      CertIdentifier ::= SEQUENCE {
        hashAlgorithm               AlgorithmIdentifier,
        basicCertIdentifier         BasicCertIdentifier,
        extInfo                     [0] ExtendedCertInfo    OPTIONAL,
        caCertificate               [1] Certificate         OPTIONAL,
        issuedCertificate           [2] Certificate         OPTIONAL }
</pre></div>
<p>
    The resourceList specifies the resources or services being requested.
    
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      ResourceIdentifier ::= SEQUENCE {
        resourceId             OBJECT IDENTIFIER,
        version            [0] INTEGER             OPTIONAL
          --- version of the protocol or data format (if applicable)   }
</pre></div>
<p>
   The ResourceIdentifier is formed by an OID that identifies the service
   or the data being requested (e.g. OCSP, LDAP, CRL, etc... ) and an optional
   version number that may be used to better identify the requested resource.
   All fields SHOULD be used whenever applicable.
   <br />
<br />

   If one or more ResourceIdentifier are provided in the request, the RQA
   should report back the location for each of the requested services. If
   no ResourceIdentifier is present in the request, the response should
   carry all the available service locations for the specified CA (with
   respect to the MaxResponse and optional parameters constrain).
   <br />
<br />

   The signature field is of type Signature and it is defined in
   <a class='info' href='#RFC2560'>[RFC2560]<span> (</span><span class='info'>Myers, M., Ankney, R., Malpani, A., Galperin, S., and C. Adams, &ldquo;X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP,&rdquo; June&nbsp;1999.</span><span>)</span></a>:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Signature ::= SEQUENCE {
        signatureAlgorithm     AlgorithmIdentifier,
        signature              BIT STRING,
        certs              [0] EXPLICIT SEQUENCE OF Certificate
                                                            OPTIONAL }
</pre></div>
<p>
   Extensions can be used for future protocol enhancement.
   
</p>
<a name="prqpresp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
PRQP Response</h3>

<p>
   The PRQP response contains the following data:
   </p>
<ul class="text">
<li>protocol version
</li>
<li>nonce
</li>
<li>status
</li>
<li>CA identifier
</li>
<li>ResourceResponseToken
</li>
<li>Extensions
</li>
</ul><p>
   
</p>
<a name="respsyn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2.1"></a><h3>3.2.2.1.&nbsp;
Response Syntax</h3>

<p>
   The response syntax is as follows:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      PRQPResponse ::= SEQUENCE {
        respData               TBSRespData,
        signature          [0] EXPLICIT Signature OPTIONAL }

      TBSRespData ::= SEQUENCE {
        version                INTEGER { v(1)},
        nonce                  INTEGER              OPTIONAL,
              -- as duplicated from the request
        producedAt             GeneralizedTime,
              -- time when the response has been generated
        nextUpdate         [0] GeneralizedTime      OPTIONAL,
              -- time till when the response should be considered valid
        pkiStatus              PKIStatusInfo,
              -- status of the response
        responseToken          SEQUENCE OF ResourceResponseToken
                                                              OPTIONAL,
              -- token carrying informations about
              -- requested services
        extensions         [0] EXPLICIT Extensions  OPTIONAL }
</pre></div>
<p>
   The version field (currently v1) describes the version of the used PRQP
   response. The nonce, if present, binds the response to a specific request.
   The usage of the nonce is meaningful only in signed responses
   and its value must be copied directly from the corresponding request.
   If not present in the request, the nonce MUST be omitted.
   <br />
<br />

   The status field is based on the definition of status in section 3.2.3 of
   <a class='info' href='#RFC4210'>[RFC4210]<span> (</span><span class='info'>Adams, C., Farrell, S., Kause, T., and T. Mononen, &ldquo;Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP),&rdquo; September&nbsp;2005.</span><span>)</span></a> as follows:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      PKIStatusInfo ::= SEQUENCE {
        status        PKIStatus,
        statusString  PKIFreeText     OPTIONAL,
        failInfo      PKIFailureInfo  OPTIONAL  }
</pre></div>
<p>
   If status has value zero, a responseToken MUST be present in the response.
   When the status value is non zero, the responseToken MUST be omitted 
   and the reason code MUST be one of the values in PKIStatus.
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      PKIStatus ::= INTEGER {
        ok                     (0),
           -- when the PKIStatus contains the value zero one or
              more responseToken is present
        badRequest             (1),
           -- the request is badly formatted
        caNotPresent           (2),
           -- the requested CA is not present
        systemFailure          (3)
           -- a system failure has occourred }
</pre></div>
<p>
   The signature field is of type Signature and it is defined in 
   <a class='info' href='#RFC2560'>[RFC2560]<span> (</span><span class='info'>Myers, M., Ankney, R., Malpani, A., Galperin, S., and C. Adams, &ldquo;X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP,&rdquo; June&nbsp;1999.</span><span>)</span></a>:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Signature ::= SEQUENCE {
        signatureAlgorithm     AlgorithmIdentifier,
        signature              BIT STRING,
        certs              [0] EXPLICIT SEQUENCE OF Certificate
                                                          OPTIONAL }
</pre></div>
<p>
   The responseToken carries information about the services requested by
   the client. For each of the requested service, the RQA should include
   a ResourceResponseToken which bears the OID of the service and the
   corresponding URI.
   <br />
<br />

   The ResourceResponseToken syntax is described below:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      ResourceInfo ::= SEQUENCE {
        resourceUri            IA5String,
            --- resource locator
        version            [0] INTEGER             OPTIONAL,
            --- version of the protocol or data format (if applicable)
        }

      ResourceResponseToken ::= SEQUENCE {
        serviceId              OBJECT IDENTIFIER,
        resourceLocator    [1] EXPLICIT SEQUENCE OF ResourceInfo    }
</pre></div>
<p>
   The serviceId field value is copied from the corresponding request
   and it bears the OID of the service about which the client inquired.
   Along the OIDs already defined by the PKIX WG, we define the following
   OIDs that SHOULD be used to identify the specified PKI services:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  id-pkix-prqp-certPolicy OBJECT IDENTIFIER ::= {id-ad 50}
          --- Certificate Policy (CP) URL
  id-pkix-prqp-certPracticesStatement OBJECT IDENTIFIER ::= {id-ad 51}
          --- Certification Practices Statement (CPS) URL
  id-pkix-prqp-httpRevokeCertificate OBJECT IDENTIFIER ::= {id-ad 60}
          --- HTTP Based (Browsers) Certificate Revocation Service
  id-pkix-prqp-httpRequestCertificate OBJECT IDENTIFIER ::= {id-ad 61}
          --- HTTP Based (Browsers) Certificate Request Service
  id-pkix-prqp-httpRenewCertificate OBJECT IDENTIFIER ::= { id-ad 62 }
          --- HTTP Based (Browsers) Certificate Renewal Service
  id-pkix-prqp-httpSuspendCertificate OBJECT IDENTIFIER ::= {id-ad 63}
          --- Certificate Suspension Service
  id-pkix-prqp-cmsGateway OBJECT IDENTIFIER ::= {id-ad 40}
          --- CMS Gateway
  id-pkix-prqp-scepGateway OBJECT IDENTIFIER ::= {id-ad 41}
          --- SCEP Gateway
  id-pkix-prqp-xkmsGateway OBJECT IDENTIFIER ::= {id-ad 42}
          --- XKMS Gateway
</pre></div>
<p>
   <br />
<br />

   The producedAt and nextUpdate define the time-frame when the response
   data is to be considered valid. Within the defined period, the client
   SHOULD NOT request for the same service. Use of wider time-frames values
   can help the RQA avoid duplication of requests from the same client
   thus potentially lowering the load of the responder. However, providing
   this data to a client does not ensure a lower query rate, as a server
   cannot rely on clients to obey the advice provided in the rersponse.
   <br />
<br />

   The resourceLocator bears access information for the service identified
   by the serviceId. The name MUST be an absolute URL, and it MUST follow
   the URL syntax and encoding rules specified in <a class='info' href='#RFC4248'>[RFC4248]<span> (</span><span class='info'>Hoffman, P., &ldquo;The telnet URI Scheme,&rdquo; October&nbsp;2005.</span><span>)</span></a>
   and <a class='info' href='#RFC4266'>[RFC4266]<span> (</span><span class='info'>Hoffman, P., &ldquo;The gopher URI Scheme,&rdquo; November&nbsp;2005.</span><span>)</span></a>.
   The resourceLocator
   includes both a scheme (e.g., HTTP or FTP) and a scheme specific part.
   The scheme specific part is supposed to carry information on how to
   reach the requested service, this is, for example, a fully qualified
   domain name or IP address as the host. If the requested service is not
   available or it is unknown by the server, the resourceLocator value
   should be empty.
   <br />
<br />

   Optional Extensions may be added if requested.
   
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
IANA Considerations</h3>

<p>
    This document has no actions for IANA.
 
</p>
<a name="rationale"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
PRQP Design Rationale</h3>

<p>

   In this section we provide some considerations about the protocol design
   and its details.
   
</p>
<a name="complexity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Response Complexity</h3>

<p>
   An important design consideration is the complexity of messages. Some type
   of services, e.g. delta CRLs, can be directly detected upon data
   downloading. On the contrary if a client is looking for a specific
   version of a protocol or data type, the definition of a fine-grained
   query system would allow for data downloading only when it is actually
   supported by the requesting client, thus reducing the server's load.
   <br />
<br />

   At present we think that keeping the protocol simple will encourage
   its adoption in current environments because the flexibility introduced
   by PRQP is a big enhancement over the current options.
   <br />
<br />

   Moreover, without requiring changes to the protocol, extensions could
   be defined to provide more fine grained options.
   <br />
<br />

   Future versions of the protocol may implement extended request
   and response types if required by applications.
   
</p>
<a name="uri"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
RQA's URL distribution</h3>

<p>
   The AIA and SIA extensions in certificates can be used to carry the
   pointer to the RQA. If no RQA address is present in the certificate,
   a client application could use a default configured URL.
   <br />
<br />

   Although this approach seems to contraddict the criticism of Certificate
   extensions use in <a class='info' href='#exts'>Section&nbsp;2.1.1<span> (</span><span class='info'>Certificate Extensions</span><span>)</span></a>, using only one extension
   to locate the RQA would provide an easy way to distribute the RQA's URL.
   <br />
<br />

   The usage of PRQP will provide a gateway for all the other services
   and data URLs.
   
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Security Considerations</h3>

<p>
   The PRQP provides URLs for PKI resources. This means that it provides
   locators to data and services, not the data per se. It still remains
   the client's job to access the provided URLs to gather the needed data.
   <br />
<br />

   Both NONCEs and signatures are optional in order to provide flexibility
   in how requests and responses are generated.
   <br />
<br />

   It is possible to provide pre-computed responses in case the NONCE is
   not provided by the client. This allows the RQA to generate off-line
   signatures for responses, an optimization used in OCSP.
   <br />
<br />

   Moreover if an authenticated secure channel is used at the transport level
   between the client and the RQA (e.g. HTTPS or SFTP) signatures in requests
   and responses can be safely omitted.
   
</p>
<a name="time"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Time Validity</h3>

<p>
   The time validity should reflect the frequency of updates in configured
   URLs. An interesting aspect to be considered is how often would users
   execute the protocol for a given set of data.
   <br />
<br />

   If the clients query the server often it could be a serious burden
   on the server but, if executed rarely, clients would not be able to
   discover changes in provided resources.
   <br />
<br />

   As described in more detail in <a class='info' href='#app_A'>Appendix&nbsp;A<span> (</span><span class='info'>Distribution of PRQP Responses</span><span>)</span></a>,
   the adoption of a validity
   time frame for responses can be used as a mean to balance the trade off
   between this two aspects, but this is merely advisory
   data for clients and thus not a guarantee against DoS attacks by clients.
   
</p>
<a name="format"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Message Format</h3>

<p>
   Two different candidates have been considered. The first one is the
   Extensible Markup Language (XML), while the second one is the
   Distinguished Encoding Rules (DER).
   <br />
<br />

   The adoption of the Abstract Syntax Notation (ASN.1) to describe the
   data structures allows a software developer to provide either DER or XML
   based implementations of the protocol.
   <br />
<br />

   However we think that a DER based implementation of PRQP is the best
   choice because of compatibility considerations with existing applications
   and APIs. Moreover DER encoded messages are smaller in size then XML
   encoded ones and almost all PKI aware applications already support it.
   
</p>
<a name="acknoledgments"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Acknowledgments</h3>

<p>
  The authors would like to thank Stephen Kent for his insightful comments 
  about PRQP and his help in writing this document.
  
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1035">[RFC1035]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="ftp://ftp.isi.edu/in-notes/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2560">[RFC2560]</a></td>
<td class="author-text"><a href="mailto:mmyers@verisign.com">Myers, M.</a>, <a href="mailto:rankney@erols.com">Ankney, R.</a>, <a href="mailto:ambarish@valicert.com">Malpani, A.</a>, <a href="mailto:galperin@mycfo.com">Galperin, S.</a>, and <a href="mailto:cadams@entrust.com">C. Adams</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2560">X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</a>,&rdquo; RFC&nbsp;2560, June&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2560.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2608">[RFC2608]</a></td>
<td class="author-text"><a href="mailto:Erik.Guttman@sun.com">Guttman, E.</a>, <a href="mailto:cperkins@sun.com">Perkins, C.</a>, <a href="mailto:veizades@home.net">Veizades, J.</a>, and <a href="mailto:mday@vinca.com">M. Day</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2608">Service Location Protocol, Version 2</a>,&rdquo; RFC&nbsp;2608, June&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2608.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2609">[RFC2609]</a></td>
<td class="author-text"><a href="mailto:erik.guttman@sun.com">Guttman, E.</a>, <a href="mailto:cperkins@sun.com">Perkins, C.</a>, and <a href="mailto:james.kempf@sun.com">J. Kempf</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2609">Service Templates and Service: Schemes</a>,&rdquo; RFC&nbsp;2609, June&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2609.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2782">[RFC2782]</a></td>
<td class="author-text"><a href="mailto:arnt@troll.no">Gulbrandsen, A.</a>, Vixie, P., and <a href="mailto:levone@microsoft.com">L. Esibov</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>,&rdquo; RFC&nbsp;2782, February&nbsp;2000 (<a href="ftp://ftp.isi.edu/in-notes/rfc2782.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3280">[RFC3280]</a></td>
<td class="author-text">Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;<a href="http://tools.ietf.org/html/rfc3280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3280, April&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4210">[RFC4210]</a></td>
<td class="author-text">Adams, C., Farrell, S., Kause, T., and T. Mononen, &ldquo;<a href="http://tools.ietf.org/html/rfc4210">Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)</a>,&rdquo; RFC&nbsp;4210, September&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4210.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4248">[RFC4248]</a></td>
<td class="author-text">Hoffman, P., &ldquo;<a href="http://tools.ietf.org/html/rfc4248">The telnet URI Scheme</a>,&rdquo; RFC&nbsp;4248, October&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4248.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4266">[RFC4266]</a></td>
<td class="author-text">Hoffman, P., &ldquo;<a href="http://tools.ietf.org/html/rfc4266">The gopher URI Scheme</a>,&rdquo; RFC&nbsp;4266, November&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4266.txt">TXT</a>).</td></tr>
</table>

<a name="app_A"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Distribution of PRQP Responses</h3>

<a name="http"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
PRQP over HTTP</h3>

<p>
   This section describes the formatting needed in order to route PRQP
   request and response over HTTP.
   
</p>
<a name="httpreq"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.1"></a><h3>A.1.1.&nbsp;
Request</h3>

<p>
   HTTP based PRQP requests SHOULD use the POST method to submit their
   requests. Where privacy is a requirement, PRQP transactions
   exchanged using HTTP MAY be protected using either TLS/SSL or some
   other lower layer protocol.
   <br />
<br />

   The required HTTP headers for the request are:
   </p>
<ul class="text">
<li>Content-Type
</li>
<li>Content-Transfer-Encoding
</li>
<li>Content-Length
</li>
</ul><p>
   The Content-Type header SHOULD be set to "application/prqp-request".
   The Content-Transfer-Encoding SHOULD be set to "Binary", while the
   Content-Length SHOULD be set to the length (in bytes) of the body
   of the request. The body of the HTTP message MUST carry the binary
   value of the DER encoding of the PRQPRequest.
   
</p>
<a name="httpresp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.2"></a><h3>A.1.2.&nbsp;
Response</h3>

<p>
   An HTTP-based PRQP response is composed of the appropriate HTTP
   headers, followed by the binary value of the DER encoding of the
   PRQPPResponse.
   <br />
<br />

   The required HTTP headers for the response are:
   </p>
<ul class="text">
<li>Content-Type
</li>
<li>Content-Transfer-Encoding
</li>
<li>Content-Length
</li>
</ul><p>
   The Content-Type header SHOULD be set to "application/prqp-response".
   The Content-Transfer-Encoding SHOULD be set to "Binary", while the
   Content-Length SHOULD be set to the length (in bytes) of the body
   of the request. The body of the HTTP message MUST carry the binary
   value of the DER encoding of the PRQPResponse.
   
</p>
<a name="caching"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.3"></a><h3>A.1.3.&nbsp;
Message Caching</h3>

<p>
   To minimize bandwidth usage, clients MUST locally cache authoritative
   PRQP responses for the validity period of the request. To enable
   proxy servers to be able to cache responses as well, additional HTTP
   headers MAY be used in the response.
   <br />
<br />

   The PRQP responder MAY ease caching by setting the following headers:
   </p>
<ul class="text">
<li>date
</li>
<li>last-modified
</li>
<li>expires
</li>
</ul><p>
   In particular, the date field SHOULD carry the date at which the HTTP
   response has been generated. The last-modified, instead, SHOULD bear the
   date at which the response has been modified. This field SHOULD carry
   the same date as the producedAt field of the PRQPResponse.
   The expires field SHOULD carry the date till when the response is to be
   considered valid. This field SHOULD carry the same date as in the
   nextUpdate field of the PRQPResponse.
   <br />
<br />

   An example HTTP response would look like:
   
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      HTTP/1.0 200 OK
      Content-Type: application/prqp-response
      Content-Transfer-Encoding: Binary
      Content-Length: 860
      Date: Thu, 03 May 2007 04:43:43 GMT
      Last-Modified: Thu, 03 May 2007 04:43:42 GMT
      Expires: Thu, 04 May 2007 04:43:42 GMT

      &lt;...response data...&gt;
</pre></div>
<p>
   PRQP clients SUOULD NOT included a no-cache header in PRQP request 
   messages, unless the client encounters an expired response which may 
   be a result of an intermediate proxy caching stale data.
   
</p>
<a name="p2p"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
PRQP over Peer-to-Peer Network</h3>

<p>
   PRQP offers a starting point for the development of a PKI Resource
   Discovery Architecture where different RQAs cooperate to access data
   not locally available.
   <br />
<br />

   One technology that already provides good results in data sharing is
   Peer-to-Peer (P2P) networking.
   <br />
<br />

   Signed PRQP requests and responses can be routed also on existing P2P
   networks or a PRQP-specific network can be setup to provide a World
   Wide PKI Resources Discovery Architecture (PRDA), the definition of
   which is out of the scope of this document.
   
</p>
<a name="ans1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
PRQP ASN1.1 Specification</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
PRQP DEFINITIONS EXPLICIT TAGS ::=

BEGIN

-- EXPORTS ALL --

IMPORTS

      -- Directory Authentication Framework (X.509)
            Certificate, AlgorithmIdentifier
            FROM AuthenticationFramework { joint-iso-itu-t ds(5)
                     module(1) authenticationFramework(7) 3 }


      --  PKIX Certificate Extensions
            AuthorityKeyIdentifier, SubjectKeyIdentifier, KeyIdentifier,
          FROM PKIX1Implicit88 {iso(1) identified-organization(3)
                  dod(6) internet(1) security(5) mechanisms(5) pkix(7)
                  id-mod(0) id-pkix1-implicit-88(2)}


             CertificateSerialNumber, Extensions, id-kp, id-ad-prqp
          FROM PKIX1Explicit88 {iso(1) identified-organization(3)
                  dod(6) internet(1) security(5) mechanisms(5) pkix(7)
                  id-mod(0) id-pkix1-explicit-88(1)};


    PRQPRequest ::= SEQUENCE {
        requestData            TBSReqData,
        signature              [0] EXPLICIT Signature OPTIONAL }


    TBSReqData ::= SEQUENCE {
        version                INTEGER { v(1) },
        nonce                  INTEGER              OPTIONAL,
              -- very large number
        maxRespEntries         INTEGER              OPTIONAL,
              -- maximum number of accepted entries in
              -- corresponding response
        serviceToken           ResourceRequestToken,
              -- token identifying the requested service
        extensions         [0] IMPLICIT Extensions  OPTIONAL }


    ResourceRequestToken ::= SEQUENCE {
        ca                      CertIdentifier,
        servicesList        [0] SET OF ResourceIdentifier OPTIONAL }


    BasicCertIdentifier ::= SEQUENCE {
        issuerNameHash              OCTET STRING,
        serialNumber                CertificateSerialNumber  }


    ExtenderCertInfo ::= SEQUENCE {
        certificateHash             OCTET STRING,
        subjectKeyHash              OCTET STRING,
        subjectKeyIdentifier    [0] KeyIdentifier          OPTIONAL,
        issuerKeyIdentifier     [1] KeyIdentifier          OPTIONAL }


    CertIdentifier ::= SEQUENCE {
        hashAlgorithm               AlgorithmIdentifier,
        basicCertIdentifier         BasicCertIdentifier,
        extInfo                     [0] ExtendedCertInfo    OPTIONAL,
        caCertificate               [1] Certificate         OPTIONAL,
        issuedCertificate           [2] Certificate         OPTIONAL }


      ResourceIdentifier ::= SEQUENCE {
        resourceId             OBJECT IDENTIFIER,
        version            [0] INTEGER             OPTIONAL
          --- version of the protocol or data format (if applicable) }


    PRQPResponse ::= SEQUENCE {
        respData               TBSRespData,
        signature          [0] EXPLICIT Signature OPTIONAL           }


    TBSRespData ::= SEQUENCE {
        version                INTEGER { v(1)},
        nonce                  INTEGER              OPTIONAL,
              -- as duplicated from the request
        producedAt             GeneralizedTime,
              -- time when the response has been generated
        nextUpdate         [0] GeneralizedTime      OPTIONAL,
              -- time till when the response should be considered
              -- valid
        pkiStatus              PKIStatusInfo,
              -- status of the response
        ca                     CertIdentifier,
              -- certificate identifier of the CA the resp is related to
        responseToken          SEQUENCE OF ResourceResponseToken
                                                             OPTIONAL,
              -- token carrying informations about
              -- requested services
        extensions         [0] EXPLICIT Extensions  OPTIONAL }


    PKIStatusInfo ::= SEQUENCE {
        status        PKIStatus,
        statusString  PKIFreeText     OPTIONAL,
        failInfo      PKIFailureInfo  OPTIONAL  }


    PKIStatus ::= INTEGER {
        ok                     (0),
           -- when the PKIStatus contains the value zero one or
              more responseToken is present
        badRequest             (1),
           -- the request is badly formatted
        caNotPresent           (2),
           -- the requested CA is not present
        systemFailure          (3)
           -- a system failure has occourred }


    Signature ::= SEQUENCE {
        signatureAlgorithm     AlgorithmIdentifier,
        signature              BIT STRING,
        certs              [0] EXPLICIT SEQUENCE OF Certificate
                                                          OPTIONAL }


      ResourceInfo ::= SEQUENCE {
        resourceUri            IA5String,
            --- resource locator
        version            [0] INTEGER             OPTIONAL,
            --- version of the protocol or data format (if applicable)}


    ResourceResponseToken ::= SEQUENCE {
        serviceId              OBJECT IDENTIFIER,
        resourceLocator    [0] EXPLICIT SEQUENCE OF ResourceInfo      }


-- Object Identifiers

id-kp-PRQPSigning            OBJECT IDENTIFIER ::= { id-kp 10 }
id-pkix-prqp                 OBJECT IDENTIFIER ::= { id-ad-prqp }
id-pkix-prqp-pta             OBJECT IDENTIFIER ::= { id-ad-prqp 1 }
id-pkix-prqp-certPolicy      OBJECT IDENTIFIER ::= {id-ad 50}
id-pkix-prqp-certPracticesStatement OBJECT IDENTIFIER ::= {id-ad 51}
id-pkix-prqp-httpRevokeCertificate  OBJECT IDENTIFIER ::= {id-ad 60}
id-pkix-prqp-httpRequestCertificate OBJECT IDENTIFIER ::= {id-ad 61}
id-pkix-prqp-httpRenewCertificate   OBJECT IDENTIFIER ::= { id-ad 62 }
id-pkix-prqp-httpSuspendCertificate OBJECT IDENTIFIER ::= {id-ad 63}
id-pkix-prqp-cmsGateway      OBJECT IDENTIFIER ::= {id-ad 40}
id-pkix-prqp-scepGateway     OBJECT IDENTIFIER ::= {id-ad 41}
id-pkix-prqp-xkmsGateway     OBJECT IDENTIFIER ::= {id-ad 42}
</pre></div>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Massimiliano Pala</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dartmouth College</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">6211 Sudikoff PKI/Trust Lab</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hanover, NH  03755</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:madwolf@openca.org">madwolf@openca.org</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.openca.org">http://www.openca.org</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
