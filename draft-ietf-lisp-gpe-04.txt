



Internet Engineering Task Force                            F. Maino, Ed.
Internet-Draft                                                     Cisco
Intended status: Standards Track                                J. Lemon
Expires: January 20, 2019                                       Broadcom
                                                              P. Agarwal
                                                                Innovium
                                                                D. Lewis
                                                                M. Smith
                                                                   Cisco
                                                           July 19, 2018


                    LISP Generic Protocol Extension
                         draft-ietf-lisp-gpe-04

Abstract

   This document describes extending the Locator/ID Separation Protocol
   (LISP) Data-Plane, via changes to the LISP header, to support multi-
   protocol encapsulation.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on January 20, 2019.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect



Maino, et al.           Expires January 20, 2019                [Page 1]

Internet-Draft       LISP Generic Protocol Extension           July 2018


   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Conventions . . . . . . . . . . . . . . . . . . . . . . .   3
     1.2.  Definition of Terms . . . . . . . . . . . . . . . . . . .   3
   2.  LISP Header Without Protocol Extensions . . . . . . . . . . .   3
   3.  Generic Protocol Extension for LISP (LISP-GPE)  . . . . . . .   3
   4.  Backward Compatibility  . . . . . . . . . . . . . . . . . . .   4
     4.1.  Use of "Multiple Data-Planes" LCAF to Determine ETR
           Capabilities  . . . . . . . . . . . . . . . . . . . . . .   5
     4.2.  Type of Service . . . . . . . . . . . . . . . . . . . . .   6
     4.3.  VLAN Identifier (VID) . . . . . . . . . . . . . . . . . .   6
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   6
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .   6
   7.  Acknowledgements and Contributors . . . . . . . . . . . . . .   6
   8.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   7
     8.1.  Normative References  . . . . . . . . . . . . . . . . . .   7
     8.2.  Informative References  . . . . . . . . . . . . . . . . .   8
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   8

1.  Introduction

   LISP Data-Plane, as defined in in [I-D.ietf-lisp-rfc6830bis], defines
   an encapsulation format that carries IPv4 or IPv6 (henceforth
   referred to as IP) packets in a LISP header and outer UDP/IP
   transport.

   The LISP Data-Plane header does not specify the protocol being
   encapsulated and therefore is currently limited to encapsulating only
   IP packet payloads.  Other protocols, most notably VXLAN [RFC7348]
   (which defines a similar header format to LISP), are used to
   encapsulate L2 protocols such as Ethernet.

   This document defines an extension for the LISP header, as defined in
   [I-D.ietf-lisp-rfc6830bis], to indicate the inner protocol, enabling
   the encapsulation of Ethernet, IP or any other desired protocol all
   the while ensuring compatibility with existing LISP deployments.

   A flag in the LISP header, called the P-bit, is used to signal the
   presence of the 8-bit Next Protocol field.  The Next Protocol field,
   when present, uses 8 bits of the field allocated to the echo-noncing
   and map-versioning features.  The two features are still available,
   albeit with a reduced length of Nonce and Map-Version.



Maino, et al.           Expires January 20, 2019                [Page 2]

Internet-Draft       LISP Generic Protocol Extension           July 2018


1.1.  Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

1.2.  Definition of Terms

   This document uses terms already defined in
   [I-D.ietf-lisp-rfc6830bis].

2.  LISP Header Without Protocol Extensions

   As described in the introduction, the LISP header has no protocol
   identifier that indicates the type of payload being carried.  Because
   of this, LISP is limited to carry IP payloads.

   The LISP header [I-D.ietf-lisp-rfc6830bis] contains a series of flags
   (some defined, some reserved), a Nonce/Map-version field and an
   instance ID/Locator-status-bit field.  The flags provide flexibility
   to define how the various fields are encoded.  Notably, Flag bit 5 is
   the last reserved bit in the LISP header.


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |N|L|E|V|I|R|K|K|            Nonce/Map-Version                  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                 Instance ID/Locator-Status-Bits               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


                                LISP Header

3.  Generic Protocol Extension for LISP (LISP-GPE)

   This document defines the following changes to the LISP header in
   order to support multi-protocol encapsulation:

   P Bit:  Flag bit 5 is defined as the Next Protocol bit.  The P bit
      MUST be set to 1 to indicate the presence of the 8 bit next
      protocol field.

      P = 0 indicates that the payload MUST conform to LISP as defined
      in [I-D.ietf-lisp-rfc6830bis].  Flag bit 5 was chosen as the P bit
      because this flag bit is currently unallocated.




Maino, et al.           Expires January 20, 2019                [Page 3]

Internet-Draft       LISP Generic Protocol Extension           July 2018


   Next Protocol:  The lower 8 bits of the first 32-bit word are used to
      carry a Next Protocol.  This Next Protocol field contains the
      protocol of the encapsulated payload packet.

      LISP uses the lower 24 bits of the first word for either a nonce,
      an echo-nonce, or to support map-versioning
      [I-D.ietf-lisp-6834bis].  These are all optional capabilities that
      are indicated in the LISP header by setting the N, E, and the V
      bit respectively.

      When the P-bit and the N-bit are set to 1, the Nonce field is the
      middle 16 bits.

      When the P-bit and the V-bit are set to 1, the Version field is
      the middle 16 bits.

      When the P-bit is set to 1 and the N-bit and the V-bit are both 0,
      the middle 16-bits are set to 0.

      This document defines the following Next Protocol values:



      0x1 :  IPv4

      0x2 :  IPv6

      0x3 :  Ethernet

      0x4 :  Network Service Header [RFC8300]


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |N|L|E|V|I|P|K|K|        Nonce/Map-Version      | Next Protocol |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                 Instance ID/Locator-Status-Bits               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


                              LISP-GPE Header

4.  Backward Compatibility

   LISP-GPE uses the same UDP destination port (4341) allocated to LISP.





Maino, et al.           Expires January 20, 2019                [Page 4]

Internet-Draft       LISP Generic Protocol Extension           July 2018


   The next Section describes a method to determine the Data-Plane
   capabilities of a LISP ETR, based on the use of the "Multiple Data-
   Planes" LCAF type defined in [RFC8060].  Other mechanisms can be
   used, including static xTR configuration, but are out of the scope of
   this document.

   When encapsulating IP packets to a non LISP-GPE capable router the P
   bit MUST be set to 0.

   A LISP-GPE router MUST NOT encapsulate non-IP packets to a non LISP-
   GPE capable router.

4.1.  Use of "Multiple Data-Planes" LCAF to Determine ETR Capabilities

   The LISP Canonical Address Format (LCAF) [RFC8060] defines the
   "Multiple Data-Planes" LCAF type, that can be included by an ETR in a
   Map-Reply to encode the encapsularion formats supported by a given
   RLOC.  In this way an ITR can be made aware of the capability to
   support LISP-GPE on a given RLOC of that ETR.

   The "Multiple Data-Planes" LCAF type, as defined in [RFC8060], has a
   Reserved-for-Future-Encapsulations 25-bit field.  This document
   defines the least significant bit of that field as g bit (bit 24 in
   the third 32-bit word of the LCAF).


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           AFI = 16387         |     Rsvd1     |     Flags     |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Type = 16   |     Rsvd2     |             Length            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        Reserved-for-Future-Encapsulations     |g|U|G|N|v|V|l|L|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |              AFI = x          |          Address ...          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


                      Multiple Data-Planes LCAF Type

   g Bit:  The RLOCs listed in the AFI-encoded addresses in the next
      longword can accept LISP-GPE (Generic Protocol Extension)
      encapsulation using destination UDP port 4341

   All other fields:  As defined in [RFC8060]





Maino, et al.           Expires January 20, 2019                [Page 5]

Internet-Draft       LISP Generic Protocol Extension           July 2018


4.2.  Type of Service

   When a LISP-GPE router performs Ethernet encapsulation, the inner
   802.1Q [IEEE.802.1Q_2014] priority code point (PCP) field MAY be
   mapped from the encapsulated frame to the Type of Service field in
   the outer IPv4 header, or in the case of IPv6 the 'Traffic Class'
   field

4.3.  VLAN Identifier (VID)

   When a LISP-GPE router performs Ethernet encapsulation, the inner
   header 802.1Q [IEEE.802.1Q_2014] VLAN Identifier (VID) MAY be mapped
   to, or used to determine the LISP Instance ID field.

5.  IANA Considerations

   IANA is requested to set up a registry of LISP-GPE "Next Protocol".
   These are 8-bit values.  Next Protocol values in the table below are
   defined in this document.  New values are assigned via Standards
   Action [RFC8126].  The protocols that are being assigned values do
   not themselves need to be IETF standards track protocols.

              +---------------+-------------+---------------+
              | Next Protocol | Description | Reference     |
              +---------------+-------------+---------------+
              | 0             | Reserved    | This Document |
              | 1             | IPv4        | This Document |
              | 2             | IPv6        | This Document |
              | 3             | Ethernet    | This Document |
              | 4             | NSH         | This Document |
              | 5..255        | Unassigned  |               |
              +---------------+-------------+---------------+

6.  Security Considerations

   LISP-GPE security considerations are similar to the LISP security
   considerations and mitigation techniques documented in [RFC7835].

   With LISP-GPE, issues such as data-plane spoofing, flooding, and
   traffic redirection may depend on the particular protocol payload
   encapsulated.

7.  Acknowledgements and Contributors

   A special thank you goes to Dino Farinacci for his guidance and
   detailed review.





Maino, et al.           Expires January 20, 2019                [Page 6]

Internet-Draft       LISP Generic Protocol Extension           July 2018


   This WG document originated as draft-lewis-lisp-gpe; the following
   are its coauthors and contributors along with their respective
   affiliations at the time of WG adoption.  The editor of this document
   would like to thank and recognize them and their contributions.
   These coauthors and contributors provided invaluable concepts and
   content for this document's creation.

   o  Darrel Lewis, Cisco Systems, Inc.

   o  Fabio Maino, Cisco Systems, Inc.

   o  Paul Quinn, Cisco Systems, Inc.

   o  Michael Smith, Cisco Systems, Inc.

   o  Navindra Yadav, Cisco Systems, Inc.

   o  Larry Kreeger

   o  John Lemon, Broadcom

   o  Puneet Agarwal, Innovium

8.  References

8.1.  Normative References

   [I-D.ietf-lisp-6834bis]
              Iannone, L., Saucez, D., and O. Bonaventure, "Locator/ID
              Separation Protocol (LISP) Map-Versioning", draft-ietf-
              lisp-6834bis-00 (work in progress), July 2018.

   [I-D.ietf-lisp-rfc6830bis]
              Farinacci, D., Fuller, V., Meyer, D., Lewis, D., and A.
              Cabellos-Aparicio, "The Locator/ID Separation Protocol
              (LISP)", draft-ietf-lisp-rfc6830bis-14 (work in progress),
              July 2018.

   [IEEE.802.1Q_2014]
              IEEE, "IEEE Standard for Local and metropolitan area
              networks--Bridges and Bridged Networks", IEEE 802.1Q-2014,
              DOI 10.1109/ieeestd.2014.6991462, December 2014,
              <http://ieeexplore.ieee.org/servlet/
              opac?punumber=6991460>.







Maino, et al.           Expires January 20, 2019                [Page 7]

Internet-Draft       LISP Generic Protocol Extension           July 2018


   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997, <https://www.rfc-
              editor.org/info/rfc2119>.

8.2.  Informative References

   [RFC7348]  Mahalingam, M., Dutt, D., Duda, K., Agarwal, P., Kreeger,
              L., Sridhar, T., Bursell, M., and C. Wright, "Virtual
              eXtensible Local Area Network (VXLAN): A Framework for
              Overlaying Virtualized Layer 2 Networks over Layer 3
              Networks", RFC 7348, DOI 10.17487/RFC7348, August 2014,
              <https://www.rfc-editor.org/info/rfc7348>.

   [RFC7835]  Saucez, D., Iannone, L., and O. Bonaventure, "Locator/ID
              Separation Protocol (LISP) Threat Analysis", RFC 7835,
              DOI 10.17487/RFC7835, April 2016, <https://www.rfc-
              editor.org/info/rfc7835>.

   [RFC8060]  Farinacci, D., Meyer, D., and J. Snijders, "LISP Canonical
              Address Format (LCAF)", RFC 8060, DOI 10.17487/RFC8060,
              February 2017, <https://www.rfc-editor.org/info/rfc8060>.

   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, "Guidelines for
              Writing an IANA Considerations Section in RFCs", BCP 26,
              RFC 8126, DOI 10.17487/RFC8126, June 2017,
              <https://www.rfc-editor.org/info/rfc8126>.

   [RFC8300]  Quinn, P., Ed., Elzur, U., Ed., and C. Pignataro, Ed.,
              "Network Service Header (NSH)", RFC 8300,
              DOI 10.17487/RFC8300, January 2018, <https://www.rfc-
              editor.org/info/rfc8300>.

Authors' Addresses

   Fabio Maino (editor)
   Cisco Systems
   San Jose, CA  95134
   USA

   Email: fmaino@cisco.com










Maino, et al.           Expires January 20, 2019                [Page 8]

Internet-Draft       LISP Generic Protocol Extension           July 2018


   John Lemon
   Broadcom
   270 Innovation Drive
   San Jose, CA  95134
   USA

   Email: john.lemon@broadcom.com


   Puneet Agarwal
   Innovium
   USA

   Email: puneet@acm.org


   Darrel Lewis
   Cisco Systems

   Email: darlewis@cisco.com


   Michael Smith
   Cisco Systems

   Email: michsmit@cisco.com

























Maino, et al.           Expires January 20, 2019                [Page 9]
