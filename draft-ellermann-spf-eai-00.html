<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Sender Policy Framework: Email Address Internationalization</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Sender Policy Framework: Email Address Internationalization">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">F. Ellermann</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">xyzzy</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">March 17, 2008</td></tr>
<tr><td class="header">Expires: September 18, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Sender Policy Framework: Email Address Internationalization<br />draft-ellermann-spf-eai-00</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 18, 2008.</p>

<h3>Abstract</h3>

<p>
        UTF8SMTP is an extension of SMTP (Simple Mail Transfer Protocol)
        allowing the use of UTF-8 in the SMTP envelope for EAI (Email
        Address Internationalization) and other purposes. This memo
        discusses some consequences for SPF (Sender Policy Framework).
    
</p>
<h3>Editorial note</h3>

<p>
        This note, the <a class='info' href='#iana'>IANA considerations<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>,
        and the <a class='info' href='#history'>document history<span> (</span><span class='info'>Document History</span><span>)</span></a> should
        be removed before publication.
    
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Background<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
SPF HELO identity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
EAI MAIL FROM identity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
local parts<br />
<a href="#spf">3.</a>&nbsp;
Considerations for policy publishers<br />
<a href="#anchor6">4.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor7">5.</a>&nbsp;
Security Considerations<br />
<a href="#iana">6.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#history">Appendix&nbsp;A.</a>&nbsp;
Document History<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
        The keywords "MUST NOT" and "SHOULD" in this memo are to be
        interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.  UTF-8
        is specified in <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a>.
    
</p>
<p>
        Readers should be familiar with SMTP as specified in
        <a class='info' href='#I-D.klensin-rfc2821bis'>[I&#8209;D.klensin&#8209;rfc2821bis]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; July&nbsp;2008.</span><span>)</span></a>
        and the SPF terminology in <a class='info' href='#RFC4408'>[RFC4408]<span> (</span><span class='info'>Wong, M. and W. Schlitt, &ldquo;Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1,&rdquo; April&nbsp;2006.</span><span>)</span></a>.  An MTA
        is a Mail Transfer Agent, e.g., an SMTP relay.
    
</p>
<p>
        Comments and questions can be sent to the SPF-Discuss mailing list
        <a href='http://dir.gmane.org/gmane.mail.spam.spf.discuss'>http://dir.gmane.org/gmane.mail.spam.spf.discuss</a>.
    
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Background</h3>

<p>
        SMTP as specified in
        <a class='info' href='#I-D.klensin-rfc2821bis'>[I&#8209;D.klensin&#8209;rfc2821bis]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; July&nbsp;2008.</span><span>)</span></a>
        supports only ASCII addresses and LDH (letter, digit, hyphen)
        domain labels. The letters are ASCII letters, LDH-labels are
        also known as A-labels in the context of IDN (Internationalization
        of Domain Names).

    
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
SPF HELO identity</h3>

<p>
        In SMTP sessions after an SMTP EHLO command from the client the
        server response can indicate supported SMTP extensions.
        <a class='info' href='#I-D.ietf-eai-smtpext'>[I&#8209;D.ietf&#8209;eai&#8209;smtpext]<span> (</span><span class='info'>Yao, J. and W. MAO, &ldquo;SMTP extension for internationalized email address,&rdquo; July&nbsp;2008.</span><span>)</span></a> specifies the UTF8SMTP
        extension.
    
</p>
<p>
        The SMTP client can accept an offered UTF8SMTP extension by
        using one of the specified features, notably by the use of UTF-8
        in mailbox addresses of SMTP commands, by the use of alternative
        ASCII addresses in these commands, or by the use of UTF-8 in
        the message header for addresses and other purposes, i.e. by
        sending a "message/global" instead of a "message/rfc822".
    
</p>
<p>
        Because UTF8SMTP support is indicated in the response to an
        EHLO command it cannot be used after HELO, and the SPF HELO
        identity is not affected by EAI:  The domain in a HELO
        or EHLO command consists of ordinary LDH-labels (A-labels),
        or it is a domain literal.  For an empty reverse path, as it
        is used in non-delivery reports and other auto-replies, SPF
        fabricates a MAIL FROM identity based on the HELO identity
        with a case insensitive local part "postmaster", this scenario
        is also not affected by EAI.
    
</p>
<p>
        A domain consisting of LDH-labels including IDN A-labels
        beginning with "xn--" is an ordinary LDH-domain as far as
        DNS (Domain Name System), SPF, and UTF8SMTP are concerned.
        Apart from HELO and EHLO the only relevant SMTP command for
        SPF is the MAIL FROM command with the reverse path containing
        the envelope sender address (if it is not empty, see above).
        Where the derived MAIL FROM identity is an ordinary address
        SPF can handle it as specified in <a class='info' href='#RFC4408'>[RFC4408]<span> (</span><span class='info'>Wong, M. and W. Schlitt, &ldquo;Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1,&rdquo; April&nbsp;2006.</span><span>)</span></a>.

    
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
EAI MAIL FROM identity</h3>

<p>
        The interesting UTF8SMTP cases for SPF contain non-ASCII
        UTF-8 characters in the local part (left hand side) or the
        domain part (right hand side) of the MAIL FROM identity.
        Domain labels containing non-ASCII UTF-8 characters are also
        known as U-labels in IDN.
    
</p>
<p>
        SPF checks typically make only sense at the border MTA, and
        ignoring the address fallback in SMTP for the moment this is
        an MX (Mail eXchanger) of the receiver talking with a sender.
        An MTA wishing to check the SPF sender policy against the
        IP of the sender fetches the sender policy for the domain of
        the HELO or MAIL FROM identity as DNS client of a server for
        the alleged server. The SPF terminology might be confusing,
        the MX is the SMTP server, but for the purpose of checking
        a sender policy it is the SPF (or rather DNS) client of an
        alleged sender with a known HELO or MAIL FROM identity.
    
</p>
<p>
        Skipping all ordinary cases as noted above the SPF client
        confronted with an EAI address in the MAIL FROM identity is
        typically the SMTP server supporting UTF8SMTP, and in that
        case it is supposed to know how to transform U-labels into
        corresponding A-labels, e.g., because it might need to send
        a non-delivey report to the envelope sender address later.
    
</p>
<p>
        For agents trying post-SMTP SPF-checks this might be not the
        case, but arguably that is a broken setup, the border MTA
        should not offer and accept UTF8SMTP mails if critical parts
        behind it - not limited to the mailbox of the receiver -
        cannot handle it.  Where this nevertheless happens software
        could try to use U-labels "as is" in DNS queries, this is a
        general EAI issue.  SPF clients return NONE for domain
        literals, a domain literal has no sender policy, they also
        return NONE for invalid, malformed, or non-existent domains
        as specified in <a class='info' href='#RFC4408'>[RFC4408]<span> (</span><span class='info'>Wong, M. and W. Schlitt, &ldquo;Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1,&rdquo; April&nbsp;2006.</span><span>)</span></a>.  This includes
        U-labels in MAIL FROM identities for SPF clients not
        supporting UTF8SMTP.
    
</p>
<p>
        An MTA could "downgrade" EAI MAIL FROM addresses using an
        optional alternative address given as UTF8SMTP Mail-parameter.
        Where that happens the resulting new MAIL FROM address is an
        ordinary <a class='info' href='#I-D.klensin-rfc2821bis'>[I&#8209;D.klensin&#8209;rfc2821bis]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; July&nbsp;2008.</span><span>)</span></a>
        reverse path and can be handled as usual.
    
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
local parts</h3>

<p>
        Top down at this point the remaining SPF clients are supposed
        to know how to transform U-labels into A-labels, and fetch the
        SPF policy of the alleged sender.  SPF implementors and
        publishers of SPF sender policies should note that only the
        domain part of the MAIL FROM identity is transformed from
        U-labels into A-labels.  The local part MUST NOT be transformed,
        it is used "as is" in the construction of a &lt;target-name&gt;
        by SPF macro expansion involving local part macros.
    
</p>
<p>
        Please note that <a class='info' href='#RFC4408'>[RFC4408]<span> (</span><span class='info'>Wong, M. and W. Schlitt, &ldquo;Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1,&rdquo; April&nbsp;2006.</span><span>)</span></a> allows all octets in
        labels of a &lt;target-name&gt; excluding dots, which are
        supposed to separate labels.  Leading, trailing, or adjacent
        dots in a &lt;target-name&gt; are expected to cause a PERMERROR,
        or to explore dark corners of SPF implementations.  This is no
        DNS issue, in theory all octets can be used in a label, it is a
        limitation caused by baroque SPF features, and this memo is not
        the place to specify the handling of labels with embedded dots.
    
</p>
<p>
        <a class='info' href='#I-D.klensin-rfc2821bis'>[I&#8209;D.klensin&#8209;rfc2821bis]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; July&nbsp;2008.</span><span>)</span></a>
        recommends to avoid quoted strings in local parts of addresses,
        and a quoted string containing leading, trailing, or adjacent
        dots in conjunction with rarely used local part macros is the
        only way to arrive at a problematic &lt;target-name&gt;.
    
</p>
<p>
        Other octets found in an UTF-8 local part of EAI addresses are
        no problem for SPF, but note that DNS compares ASCII letters
        case-insensitively.  Domains supporting case-sensitive ASCII
        characters in local parts cannot expect to use the SPF local
        part macro feature.  Non-ASCII UTF-8 octets are not affected
        by this DNS limitation.
    
</p>
<a name="spf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Considerations for policy publishers</h3>

<p>
        Policy publishers should know that this memo does not update
        <a class='info' href='#RFC4408'>[RFC4408]<span> (</span><span class='info'>Wong, M. and W. Schlitt, &ldquo;Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1,&rdquo; April&nbsp;2006.</span><span>)</span></a>, in theory EAI is compatible with
        SPF.  It is not possible to use U-labels in sender policies
        directly, they have to be transformed into the corresponding
        A-labels.  Likewise U-labels in UTF8SMTP MAIL FROM addresses
        are transformed into A-labels for the purposes of SPF by
        implementations supporting EAI.
    
</p>
<p>
        SPF implementations not supporting U-labels in MAIL FROM
        identities will return NONE instead of the intended result,
        e.g., PASS or FAIL.  UTF8SMTP senders wishing to avoid this
        problem could transform MAIL FROM U-labels into A-labels on
        their side.  They can also hope that spammers forging MAIL
        FROM identities will not abuse IDN U-labels in the near
        future, and that most SPF implementations will be updated
        before this changes.  Unfortunately experience has shown that
        spammers learn faster than lazy users.
    
</p>
<p>
        MAIL FROM identities using only A-labels, with or without
        UTF-8 in the local part, work "as is" for the purposes of
        SPF.  HELO identities consist either of A-labels, are domain
        literals and irrelevant for SPF, or are syntactically malformed
        as far as UTF8SMTP and SPF are concerned.  SPF does not
        specify how receivers should handle SMTP HELO syntax errors.
    
</p>
<p>
        UTF8SMTP allows to specify an optional alternative address
        in the traditional syntax.  Receivers are free to check SPF
        also or only based on the alternative address.  Obviously a
        sender policy for the alternative address should permit the
        same sending IPs as the sender policy for the EAI address,
        and one simple way to achieve this is to use corresponding
        A-labels in an alternative address yielding one SPF sender
        policy for both addresses.  Please note that this is not
        required by UTF8SMTP, it permits to use unrelated domains
        with different policies.  Clearly if some IPs permitted for
        one address fail for the other address, or vice versa, the
        sender will have problems, if the affected IPs are actually
        used to send mails.
    
</p>
<p>
        This memo does not discuss EAI considerations for PRA
        (Purported Responsible Address) policies specified in
        <a class='info' href='#RFC4406'>[RFC4406]<span> (</span><span class='info'>Lyon, J. and M. Wong, &ldquo;Sender ID: Authenticating E-Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a>, the PRA is determined by
        addresses in the message header and not necessarily related
        to the MAIL FROM identity used by SPF based on UTF8SMTP
        MAIL FROM or EHLO commands.  Publishers of sender policies
        should know that "spf2.0/pra" introduces a PRA policy.  In
        theory policy records starting with "spf2.0/pra,mfrom" or
        "spf2.0/mfrom,pra" can be checked using the PRA algorithm
        or the SPF algorithm, while policy records starting with
        "spf2.0/mfrom" have to be checked using the SPF algorithm.
    
</p>
<p>
        In practice all SPF implementations support SPF policies
        introduced by "v=spf1" as specified in
        <a class='info' href='#RFC4408'>[RFC4408]<span> (</span><span class='info'>Wong, M. and W. Schlitt, &ldquo;Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1,&rdquo; April&nbsp;2006.</span><span>)</span></a>.  The "spf2.0/mfrom" variations
        can be considered as obsolete, "spf2.0/mfrom" is an alias
        for "v=spf1".  If users wish to publish policies for both
        PRA and SPF they SHOULD use separate "spf2.0/pra" and
        "v=spf1" policy records, even if those policy records are
        otherwise syntactically identical.  In any case there are
        significant semantical differences between SPF and PRA.
    
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Acknowledgements</h3>

<p>
        Various IETF tools by Henrik Levkowetz, Bill Fenner, and
        others were a great help in the creation of this memo.
    
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>
        When UTF8SMTP senders use a different domain in the optional
        alternative MAIL FROM address, and the corresponding sender
        policy is also different, it is hard to predict which policy
        will be checked, if any, depending on the route to the
        receiver and other factors.  Different results can be hard
        to diagnose, e.g., if a mail from the same sender to the
        same receiver sometimes results in PASS and at other times
        in FAIL.  Various proposals to mitigate this problem are
        discussed in <a class='info' href='#spf'>Section&nbsp;3<span> (</span><span class='info'>Considerations for policy publishers</span><span>)</span></a>
    
</p>
<p>
        Using the SPF local part macro in conjunction with EAI is not
        intuitive, local parts are not transformed to A-labels.  This
        is no new problem, but in conjunction with EAI it is more
        likely, the details are explained in <a class='info' href='#spf'>Section&nbsp;3<span> (</span><span class='info'>Considerations for policy publishers</span><span>)</span></a>.
    
</p>
<p>
        Unsurprisingly evaluating PRA policies with SPF or vice versa
        can cause havoc, as the algorithms are semantically different
        even when the policies are otherwise syntactically identical.
        This memo deprecates three of five sender policy variants in
        <a class='info' href='#spf'>Section&nbsp;3<span> (</span><span class='info'>Considerations for policy publishers</span><span>)</span></a> to reduce the confusion.
    
</p>
<p>
        Not all SPF implementations will already support U-labels as
        specified in this memo.  Senders could transform U-labels in
        MAIL FROM commands to A-labels on their side where this is a
        problem.
    
</p>
<p>
        UTF8SMTP servers can be forced to send non-delivery reports
        to forged envelope sender addresses, if some receiver mailboxes
        can handle EAI mails, while others can't, and the server has no
        way to "downgrade" mails to traditional receivers.  Hopefully a
        future SMTP extension will allow a kind of "selective reject"
        mechanism.  Publishing SPF PASS or FAIL policies, and rejecting
        FAIL at the border MTA can eliminate this problem.  Similarly
        non-delivery reports after a PASS cannot hit innocent bystanders.
    
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>
        Keep up the good work, nothing to do here.
    
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4408">[RFC4408]</a></td>
<td class="author-text">Wong, M. and W. Schlitt, &ldquo;<a href="http://tools.ietf.org/html/rfc4408">Sender Policy Framework (SPF) for Authorizing Use of Domains in E-Mail, Version 1</a>,&rdquo; RFC&nbsp;4408, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4408.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-eai-smtpext">[I-D.ietf-eai-smtpext]</a></td>
<td class="author-text">Yao, J. and W. MAO, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-eai-smtpext-13.txt">SMTP extension for internationalized email address</a>,&rdquo; draft-ietf-eai-smtpext-13 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-eai-smtpext-13.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4406">[RFC4406]</a></td>
<td class="author-text">Lyon, J. and M. Wong, &ldquo;<a href="http://tools.ietf.org/html/rfc4406">Sender ID: Authenticating E-Mail</a>,&rdquo; RFC&nbsp;4406, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4406.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.klensin-rfc2821bis">[I-D.klensin-rfc2821bis]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-klensin-rfc2821bis-11.txt">Simple Mail Transfer Protocol</a>,&rdquo; draft-klensin-rfc2821bis-11 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-klensin-rfc2821bis-11.txt">TXT</a>).</td></tr>
</table>

<a name="history"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Document History</h3>

<p>
        Initial version

    
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Frank Ellermann</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">xyzzy</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hamburg, Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hmdmhdfmhdjmzdtjmzdtzktdkztdjz@gmail.com">hmdmhdfmhdjmzdtjmzdtzktdkztdjz@gmail.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://purl.net/xyzzy/">http://purl.net/xyzzy/</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
<h3>Acknowledgment</h3>
<p class='copyright'>
This document was produced
using xml2rfc&nbsp;v1.35 (of <a href='http://xml.resource.org/'>http://xml.resource.org/</a>)
from a source in RFC-2629 XML format.</p>
</body></html>
