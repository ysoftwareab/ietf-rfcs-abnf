


Network Working Group                                             F. Xia
Internet-Draft                                               B. Sarikaya
Expires: November 2, 2007                                     Huawei USA
                                                                May 2007


                PMIPv6 service negotiation based on EAP
                draft-xia-netlmm-service-negotiation-00

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on November 2, 2007.

Copyright Notice

   Copyright (C) The IETF Trust (2007).














Xia & Sarikaya          Expires November 2, 2007                [Page 1]

Internet-Draft         PMIPv6 service negotiation               May 2007


Abstract

   Proxy Mobile IPv6 (PMIPv6) is network based mobility protocol which
   provides IP session continuity for a mobile node without its
   involvement in mobility management.  PMIPv6 also can be viewed as a
   service and authorization provided by networks.  A mobile node can
   decide if it wants to use the service or not.  This proposal
   describes an Extensible Authentication Protocol(EAP) based mechanism
   for the service negotiation between a mobile node and an AAA server.


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  4
   3.  Protocol Overview  . . . . . . . . . . . . . . . . . . . . . .  4
   4.  Detailed Description of PMIPv6 Authorization . . . . . . . . .  5
   5.  New TLVs for EAP methods . . . . . . . . . . . . . . . . . . .  6
     5.1.  Service-Status-TLV . . . . . . . . . . . . . . . . . . . .  6
     5.2.  Service-Selection-TLV  . . . . . . . . . . . . . . . . . .  7
     5.3.  Negotiation-Result-TLV . . . . . . . . . . . . . . . . . .  7
   6.  Attributes Extension for RADIUS  . . . . . . . . . . . . . . .  8
     6.1.  Extension of Attribute Service-Type  . . . . . . . . . . .  8
   7.  Security Considerations  . . . . . . . . . . . . . . . . . . .  8
   8.  IANA consideration . . . . . . . . . . . . . . . . . . . . . .  8
   9.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . .  8
   10. References . . . . . . . . . . . . . . . . . . . . . . . . . .  8
     10.1. Normative References . . . . . . . . . . . . . . . . . . .  8
     10.2. Informative references . . . . . . . . . . . . . . . . . .  9
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 10
   Intellectual Property and Copyright Statements . . . . . . . . . . 11




















Xia & Sarikaya          Expires November 2, 2007                [Page 2]

Internet-Draft         PMIPv6 service negotiation               May 2007


1.  Introduction

   PMIPv6 can be viewed as a service provided by networks, and based on
   it's own discretion, a mobile node (MN) may or may not choose the
   service.  PMIPv6 service negotiation between an MN and networks is
   necessary in the following scenarios

   1.  PMIPv6 is provided to simple IP host to enable IP session
       continuity.

   2.  PMIPv6 is not necessary because simple IP host prefers local IP
       services, such as broadcast news, tourism information and so on.

   3.  CMIPv6 host wants to make use of PMIPv6 because PMIPv6 is a lower
       rate mobility service.

   4.  CMIPv6 host would not use PMIPv6 because CMIPv6 can provide wider
       range mobility.

   In summary, networks need to have a mechanism to indicate to the MN
   the presence of network based mobility management capability, at the
   same time, the MN also needs to have mechanism to express it's
   preference.

   EAP [RFC3748] is now becoming prevailing access authentication tool
   because of it's flexibility and extensibility.  In
   [WiMAX-NWG-Stage-2] and [WiMAX-NWG-Stage-3], EAP is a mandatory
   access authentication protocol for WiMAX networks.  So PMIPv6 service
   negotiation based on EAP is proposed here:

   1.  An AAA server has an access router (AR)'s PMIPv6 capability
       information to act as the mobility access gateway (MAG) which
       could be manually configured or be reported by the AR/MAG
       dynamically.  PMIPv6 is kind of a service or authorization
       granted by the AAA server to an MN.  Related accounting and
       forwarding policy should be bound to the service or
       authorization.

   2.  PMIPv6 service negotiation is controlled by the AAA server which
       exploits the capability of EAP methods (e.g.  EAP-TLS [RFC2716],
       EAP-AKA [RFC4187] ) to convey generic information items together
       with authentication data.

   3.  The AAA server configures the AR/MAG based on PMIPv6 service
       negotiation between the AAA server and the MN.  Different service
       needs different forwarding, accounting policy.  The AR/MAG is the
       policy enforcement point (PEP).




Xia & Sarikaya          Expires November 2, 2007                [Page 3]

Internet-Draft         PMIPv6 service negotiation               May 2007


2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].


3.  Protocol Overview

   The solution is applicable to any access network relying on EAP for
   user authentication and works with all EAP methods supporting the
   exchange of general purpose information elements, in any form (e.g.
   TLVs or AVPs), between EAP peers.  Exploiting this capability, an MN
   and an AAA server can piggyback negotiation messages within the same
   EAP conversation used to carry out user authentication or re-
   authentication.

   Figure 1 shows an overview of the procedure defined to handle PMIPv6
   service negotiation.


           EAP/PKMv2..             EAP over RADIUS
                          AAA      (or Diameter)    AAA
       MN +------------+ Client +----------------+ Server

      1) <--Req. Id.---
         --Identity--->     ----Diameter EAP Req.-->
          /----------------------------------------\
      2) /         Set-up of protected channel      \
         \         e.g. TLS Tunnel (optional)       /
          \----------------------------------------/
          /----------------------------------------\
      3) /               Authentication             \
         \                    Phase                 /
          \----------------------------------------/
          /----------------------------------------\
      4) /              Mobile node service         \
         \       authorization and configuration    /
          \----------------------------------------/

      5) <-----EAP-------    <-----RADIUS EAP----
         Success/Failure      Answer (Success/Failure
                            and authorization AVPs/TLVs)


             Figure 1: Overview of PMIPv6 Service Negotiation





Xia & Sarikaya          Expires November 2, 2007                [Page 4]

Internet-Draft         PMIPv6 service negotiation               May 2007


   1.  EAP identity exchange.  The MN is polled for its identity by
       means of an EAP Request Identity message when the MN enters a
       network.  This message is used to start the EAP communication.
       The MN replies an EAP Response Identity message which is received
       by an AAA client (e.g.  AR/MAG or ASN-GW in [WiMAX-NWG-Stage-2])
       and forwarded to an AAA server using RADIUS EAP extension (or
       Diameter EAP application).  Then the AAA server selects an EAP
       method (e.g. based on the user's profile) and proposes it to the
       MN in subsequent EAP messages.
   2.  Set-up of a protected channel (e.g.  TLS tunnel and so on) for
       the delivery of subsequent EAP signaling.  This is an optional
       step that is present only if the EAP method provides
       confidentiality support.  It is mandatory only if the MN-AAA
       negotiation involves the exchange of sensitive information.
   3.  Authentication phase.  The actual authentication procedure and
       its security properties depend on the selected EAP method.  Each
       EAP conversation may accomplish user authentication relying on
       any available EAP method (e.g.  EAP-MD5, EAP-SIM, EAP-AKA).
   4.  MN service authorization and configuration.  The MN and the AAA
       server exchange a sequence of signaling messages to authorize and
       configure the MN.  Those messages are encapsulated as requested
       by the employed EAP method (e.g.  TLVs or AVPs) and delivered as
       part of the on-going EAP session.  During this phase, the AAA
       server advertises the network's PMIPv6 capability to the MN, and
       the MN then decides if PMIPv6 service is needed or not.  The
       details are elaborated in Section 4.
   5.  EAP session termination.  After successful authentication and
       authorization, the AAA server sends the AAA client RADIUS Access-
       Accept message in which Result-Code is set to SUCCESS.  The AAA
       client configures itself based on authorization, and forwards the
       result to the MN to terminate the EAP session.


4.  Detailed Description of PMIPv6 Authorization

   This section presents the detailed description of stage 4 in
   Figure 1.  All messages used for MN's PMIPv6 authorization are
   encoded in TLVs which can be optionally carried by a generic
   container described in [I-D.giaretta-mip6-authorization-eap].  The
   generic container simplifies a lot the deployment of the procedure
   with any EAP method.  For conciseness, only PMIPv6 authorization
   related TLVs are illustrated in Figure 2.









Xia & Sarikaya          Expires November 2, 2007                [Page 5]

Internet-Draft         PMIPv6 service negotiation               May 2007


                                             AAA
          MN +----------------------------+ Server

          1)         <---------------------
                         Service-Status-TLV

          2) ----------------------->
             Service-Selection-TLV

          3)          <---------------------
                      Negotiation-Result-TLV



                Figure 2: Detailed Authorization Procedure

   1.  An AAA server starts the PMIPv6 negotiation phase by sending to
       an MN a Service-Status-TLV defined in Section 5.1.  PMIPv6
       capability is indicated to MN for choice.
   2.  The MN replies to this first message by confirming its intention
       to make use of PMIPv6 or not.  Service-Selection-TLV defined in
       Section 5.2 is used to convey this preference.
   3.  The AAA server sends Negotiation-Result-TLV defined in
       Section 5.3 to terminate PMIPv6 authorization procedure.


5.  New TLVs for EAP methods

5.1.  Service-Status-TLV

   This TLV is sent by the AAA server to inform the MN on the status of
   PMIPv6 service.  It is defined as follows:


        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      Type=Service-Status      |             Length            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     Code      |
       +-+-+-+-+-+-+-+-+

       Type
          TBD - Service-Status
       Length
          1
       Code
          0 = PMIPv6 service is available
          1 = PMIPv6 service is not available



Xia & Sarikaya          Expires November 2, 2007                [Page 6]

Internet-Draft         PMIPv6 service negotiation               May 2007


                       Figure 3: Service-Status-TLV

5.2.  Service-Selection-TLV

   This TLV is sent by the MN to inform the AAA server whether it wants
   the PMIPv6 service to be activated or not.


        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      Type=Service-Selection   |             Length            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     Code      |
       +-+-+-+-+-+-+-+-+

       Type
          TBD - Service-Selection
       Length
          1
       Code
          0 = activate PMIPv6 service
          1 = PMIPv6 service already active
          2 = do not activate PMIPv6 service


                      Figure 4: Service-Selection-TLV

5.3.  Negotiation-Result-TLV


        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      Type=Negotiation-Result  |             Length            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     Code      |
       +-+-+-+-+-+-+-+-+

       Type
          TBD - Negotiation-Result
       Length
          1
       Code
            0 = Success
          128 = Failure


                     Figure 5: Negotiation-Result-TLV




Xia & Sarikaya          Expires November 2, 2007                [Page 7]

Internet-Draft         PMIPv6 service negotiation               May 2007


6.  Attributes Extension for RADIUS

6.1.   Extension of Attribute Service-Type

   This attribute defined in [RFC2865] indicates the type of service the
   user has requested, or the type of service to be provided.  It MAY be
   used in both Access-Request and Access-Accept packets.  In this memo,
   AAA server notifies AR to function through RADIUS protocol based on
   negotiation between the AAA server and MN.  A new service type called
   PMIPv6 is to be defined.


7.  Security Considerations

   Only a few new options/TLVs are needed for the PMIPv6 service
   negotiation, and therefore no additional security threat is
   introduced in this document.


8.  IANA consideration

   TBD


9.  Acknowledgements


10.  References

10.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC4072]  Eronen, P., Hiller, T., and G. Zorn, "Diameter Extensible
              Authentication Protocol (EAP) Application", RFC 4072,
              August 2005.

   [RFC3748]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
              Levkowetz, "Extensible Authentication Protocol (EAP)",
              RFC 3748, June 2004.

   [RFC2865]  Rigney, C., Willens, S., Rubens, A., and W. Simpson,
              "Remote Authentication Dial In User Service (RADIUS)",
              RFC 2865, June 2000.






Xia & Sarikaya          Expires November 2, 2007                [Page 8]

Internet-Draft         PMIPv6 service negotiation               May 2007


10.2.  Informative references

   [WiMAX-NWG-Stage-2]
              "WiMAX Forum Network Architecture Stage 2: Architecture
              Tenets, Reference Model and Reference Points",  ,
              March 2007.

   [WiMAX-NWG-Stage-3]
              "WiMAX Forum Network Architecture Stage 3: Detailed
              Protocols and Procedures",  , March 2007.

   [I-D.giaretta-mip6-authorization-eap]
              Giaretta, G., "MIPv6 Authorization and Configuration based
              on EAP", draft-giaretta-mip6-authorization-eap-04 (work in
              progress), October 2006.

   [I-D.ietf-netlmm-proxymip6]
              Gundavelli, S., "Proxy Mobile IPv6",
              draft-ietf-netlmm-proxymip6-00 (work in progress),
              April 2007.

   [RFC4187]  Arkko, J. and H. Haverinen, "Extensible Authentication
              Protocol Method for 3rd Generation Authentication and Key
              Agreement (EAP-AKA)", RFC 4187, January 2006.

   [RFC3579]  Aboba, B. and P. Calhoun, "RADIUS (Remote Authentication
              Dial In User Service) Support For Extensible
              Authentication Protocol (EAP)", RFC 3579, September 2003.

   [RFC2716]  Aboba, B. and D. Simon, "PPP EAP TLS Authentication
              Protocol", RFC 2716, October 1999.




















Xia & Sarikaya          Expires November 2, 2007                [Page 9]

Internet-Draft         PMIPv6 service negotiation               May 2007


Authors' Addresses

   Frank Xia
   Huawei USA
   1700 Alma Dr. Suite 100
   Plano, TX  75075

   Phone: +1 972-509-5599
   Email: xiayangsong@huawei.com


   Behcet Sarikaya
   Huawei USA
   1700 Alma Dr. Suite 100
   Plano, TX  75075

   Phone: +1 972-509-5599
   Email: sarikaya@ieee.org

































Xia & Sarikaya          Expires November 2, 2007               [Page 10]

Internet-Draft         PMIPv6 service negotiation               May 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Xia & Sarikaya          Expires November 2, 2007               [Page 11]


