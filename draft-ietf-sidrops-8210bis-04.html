<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The Resource Public Key Infrastructure (RPKI) to Router Protocol, Version 2</title>
<meta content="Randy Bush" name="author">
<meta content="Rob Austein" name="author">
<meta content="
       
        In order to verifiably validate the origin Autonomous Systems
        and Autonomous System Paths of BGP announcements, routers need
        a simple but reliable mechanism to receive Resource Public Key
        Infrastructure (RFC 6480) prefix origin data and router keys
        from a trusted cache.  This document describes a protocol to
        deliver them.
       
       
        This document describes version 2 of the RPKI-Router protocol.
        RFC 6810 describes version 0, and RFC 8210 describes version 1.
        This document updates RFC 8210.
       
    " name="description">
<meta content="xml2rfc 3.11.1" name="generator">
<meta content="draft-ietf-sidrops-8210bis-04" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.11.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.4
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.26.0
    setuptools 59.1.1
    six 1.16.0
-->
<link href="/tmp/draft-ietf-sidrops-8210bis-oeeuou9n.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">RPKI-Router Protocol</td>
<td class="right">December 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Bush &amp; Austein</td>
<td class="center">Expires 9 June 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-sidrops-8210bis-04</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc8210" class="eref">8210</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-12-06" class="published">6 December 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-06-09">9 June 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Bush</div>
<div class="org">IIJ, Arrcus, &amp; DRL</div>
</div>
<div class="author">
      <div class="author-name">R. Austein</div>
<div class="org">Dragon Research Labs</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The Resource Public Key Infrastructure (RPKI) to Router Protocol, Version 2</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
        In order to verifiably validate the origin Autonomous Systems
        and Autonomous System Paths of BGP announcements, routers need
        a simple but reliable mechanism to receive Resource Public Key
        Infrastructure (RFC 6480) prefix origin data and router keys
        from a trusted cache.  This document describes a protocol to
        deliver them.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">
        This document describes version 2 of the RPKI-Router protocol.
        RFC 6810 describes version 0, and RFC 8210 describes version 1.
        This document updates RFC 8210.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 9 June 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-changes-from-rfc-8210" class="xref">Changes from RFC 8210</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-glossary" class="xref">Glossary</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-deployment-structure" class="xref">Deployment Structure</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-operational-overview" class="xref">Operational Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-protocol-data-units-pdus" class="xref">Protocol Data Units (PDUs)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-fields-of-a-pdu" class="xref">Fields of a PDU</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-serial-notify" class="xref">Serial Notify</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-serial-query" class="xref">Serial Query</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-reset-query" class="xref">Reset Query</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-cache-response" class="xref">Cache Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-ipv4-prefix" class="xref">IPv4 Prefix</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.  <a href="#name-ipv6-prefix" class="xref">IPv6 Prefix</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="xref">5.8</a>.  <a href="#name-end-of-data" class="xref">End of Data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="xref">5.9</a>.  <a href="#name-cache-reset" class="xref">Cache Reset</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.10">
                <p id="section-toc.1-1.5.2.10.1"><a href="#section-5.10" class="xref">5.10</a>. <a href="#name-router-key" class="xref">Router Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.11">
                <p id="section-toc.1-1.5.2.11.1"><a href="#section-5.11" class="xref">5.11</a>. <a href="#name-error-report" class="xref">Error Report</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.12">
                <p id="section-toc.1-1.5.2.12.1"><a href="#section-5.12" class="xref">5.12</a>. <a href="#name-aspa-pdu" class="xref">ASPA PDU</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-protocol-timing-parameters" class="xref">Protocol Timing Parameters</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-protocol-version-negotiatio" class="xref">Protocol Version Negotiation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-protocol-sequences" class="xref">Protocol Sequences</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-start-or-restart" class="xref">Start or Restart</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-typical-exchange" class="xref">Typical Exchange</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-no-incremental-update-avail" class="xref">No Incremental Update Available</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-cache-has-no-data-available" class="xref">Cache Has No Data Available</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-transport" class="xref">Transport</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-ssh-transport" class="xref">SSH Transport</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-tls-transport" class="xref">TLS Transport</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-tcp-md5-transport" class="xref">TCP MD5 Transport</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="xref">9.4</a>.  <a href="#name-tcp-ao-transport" class="xref">TCP-AO Transport</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-router-cache-setup" class="xref">Router-Cache Setup</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-roa-pdu-race-minimization" class="xref">ROA PDU Race Minimization</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-deployment-scenarios" class="xref">Deployment Scenarios</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-error-codes" class="xref">Error Codes</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="xref">16</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#section-16.1" class="xref">16.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#section-16.2" class="xref">16.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-A" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
        In order to verifiably validate the origin Autonomous Systems
        (ASs) and AS paths of BGP announcements, routers need a
        simple but reliable mechanism to receive cryptographically
        validated Resource Public Key Infrastructure (RPKI)
        <span>[<a href="#RFC6480" class="xref">RFC6480</a>]</span> prefix origin data and router keys
        from a trusted cache.  This document describes a protocol to
        deliver them.  The design is intentionally constrained to be
        usable on much of the current generation of ISP router
        platforms.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document updates <span>[<a href="#RFC8210" class="xref">RFC8210</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
        <a href="#Struct" class="xref">Section 3</a> describes the deployment structure, and
        <a href="#OpOvr" class="xref">Section 4</a> then presents an operational overview.
        The binary payloads of the protocol are formally described in
        <a href="#pdus" class="xref">Section 5</a>, and the expected Protocol Data Unit
        (PDU) sequences are described in <a href="#protocol" class="xref">Section 8</a>.
        The transport protocol options are described in
        <a href="#Transport" class="xref">Section 9</a>.  <a href="#Setup" class="xref">Section 10</a> details
        how routers and caches are configured to connect and authenticate.
        <a href="#Scenarios" class="xref">Section 12</a> describes likely deployment
        scenarios.  The traditional security and IANA considerations end
        the document.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
        The protocol is extensible in order to support new PDUs with
        new semantics, if deployment experience indicates that they are
        needed.  PDUs are versioned should deployment experience call
        for change.<a href="#section-1-4" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
        "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",
        "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document
        are to be interpreted as described in BCP 14
        <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>
          <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when,
        and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-changes-from-rfc-8210">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-changes-from-rfc-8210" class="section-name selfRef">Changes from RFC 8210</a>
        </h3>
<p id="section-1.2-1">
          This section summarizes the significant changes between
          <span>[<a href="#RFC8210" class="xref">RFC8210</a>]</span> and the protocol described in this
          document.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">
              A new ASPA PDU type (<a href="#aspa" class="xref">Section 5.12</a>) has added to
              support <span>[<a href="#I-D.ietf-sidrops-aspa-profile" class="xref">I-D.ietf-sidrops-aspa-profile</a>]</span>.<a href="#section-1.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.2">
       A small section, <a href="#races" class="xref">Section 11</a>, has been added to
       handle two ROA PDU race conditions, Break Before Make and
       Shorter Prefix First.<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.3">
              The protocol version number incremented from 1 (one) to 2
              (two) and the <a href="#version" class="xref">Section 7</a> section has been
              updated accordingly.<a href="#section-1.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</section>
</div>
<div id="Glossary">
<section id="section-2">
      <h2 id="name-glossary">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-glossary" class="section-name selfRef">Glossary</a>
      </h2>
<p id="section-2-1">
        The following terms are used with special meaning.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-2">
        <dt id="section-2-2.1">Global RPKI:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.2">
            The authoritative data of the RPKI are published in a
            distributed set of servers at the IANA, Regional Internet
            Registries (RIRs), National Internet Registries (NIRs),
            and ISPs; see <span>[<a href="#RFC6481" class="xref">RFC6481</a>]</span>.<a href="#section-2-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.3">Cache:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.4">
            A cache is a coalesced copy
            of the published Global RPKI data, periodically fetched or
            refreshed, directly or indirectly, using the
            rsync protocol <span>[<a href="#RFC5781" class="xref">RFC5781</a>]</span> or some
            successor.  Relying Party software is used to gather and
            validate the distributed data of the RPKI into a cache.
            Trusting this cache further is a matter between the
            provider of the cache and a Relying Party.<a href="#section-2-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.5">Serial Number:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.6">
            "Serial Number" is a
            32‑bit strictly increasing unsigned integer which wraps
            from 2^32-1 to 0.  It denotes the logical version of a
            cache.  A cache increments the value when it successfully
            updates its data from a parent cache or from primary RPKI
            data.  While a cache is receiving updates, new incoming
            data and implicit deletes are associated with the new
            serial but MUST NOT be sent until the fetch is complete.
            A Serial Number is not commensurate between different
            caches or different protocol versions, nor need it be
            maintained across resets of the cache server.  See
            <span>[<a href="#RFC1982" class="xref">RFC1982</a>]</span> on DNS Serial Number Arithmetic
            for too much detail on the topic.<a href="#section-2-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.7">Session ID:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.8">
            When a cache server is started, it generates a Session ID
            to uniquely identify the instance of the cache and
            to bind it to the sequence of Serial Numbers that cache
            instance will generate.  This allows the router to restart a
            failed session knowing that the Serial Number it is using is
            commensurate with that of the cache.<a href="#section-2-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.9">Payload PDU:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.10">
            A payload PDU is a protocol message which contains data for
            use by the router, as opposed to a PDU which conveys the control
            mechanisms of this protocol.  Prefixes and Router Keys are
            examples of payload PDUs.<a href="#section-2-2.10" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="Struct">
<section id="section-3">
      <h2 id="name-deployment-structure">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-deployment-structure" class="section-name selfRef">Deployment Structure</a>
      </h2>
<p id="section-3-1">
        Deployment of the RPKI to reach routers has a three-level
        structure as follows:<a href="#section-3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-2">
        <dt id="section-3-2.1">Global RPKI:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.2">
            The authoritative data of the RPKI are published in a
            distributed set of servers at the IANA, RIRs, NIRs, and
            ISPs (see <span>[<a href="#RFC6481" class="xref">RFC6481</a>]</span>).<a href="#section-3-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.3">Local Caches:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.4">
            Local caches are a local set of one or more collected and
            verified caches of RPKI data.  A Relying Party, e.g., router
            or other client, MUST have a trust relationship with, and a
            trusted transport channel to, any cache(s) it uses.<a href="#section-3-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.5">Routers:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.6">
            A router fetches data from a local cache using the protocol
            described in this document.  It is said to be a client of the
            cache.  There MAY be mechanisms for the router to assure
            itself of the authenticity of the cache and to authenticate
            itself to the cache (see <a href="#Transport" class="xref">Section 9</a>).<a href="#section-3-2.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="OpOvr">
<section id="section-4">
      <h2 id="name-operational-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-operational-overview" class="section-name selfRef">Operational Overview</a>
      </h2>
<p id="section-4-1">
        A router establishes and keeps open a connection to one or more
        caches with which it has client/server relationships.  It is
        configured with a semi-ordered list of caches and establishes a
        connection to the most preferred cache, or set of caches, which
        accept the connections.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
        The router MUST choose the most preferred, by configuration,
        cache or set of caches so that the operator may control load
        on their caches and the Global RPKI.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">
        Periodically, the router sends to the cache the most recent
        Serial Number for which it has received data from that
        cache, i.e., the router's current Serial Number, in the form of a
        Serial Query.  When a router establishes a new session with a
        cache or wishes to reset a current relationship, it sends a
        Reset Query.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
        The cache responds to the Serial Query with all data changes
        which took place since the given Serial Number.  This may be the
        null set, in which case the End of Data PDU (<a href="#eod" class="xref">Section 5.8</a>)
        is still sent.  Note that the Serial Number comparison used to
        determine "since the given Serial Number" MUST take wrap-around
        into account; see <span>[<a href="#RFC1982" class="xref">RFC1982</a>]</span>.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">
        When the router has received all data records from the cache,
        it sets its current Serial Number to that of the Serial Number
        in the received End of Data PDU.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">
        When the cache updates its database, it sends a Notify PDU to
        every currently connected router.  This is a hint
        that now would be a good time for the router to poll for an
        update, but it is only a hint.  The protocol requires the router
        to poll for updates periodically in any case.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">
        Strictly speaking, a router could track a cache simply by
        asking for a complete data set every time it updates, but this
        would be very inefficient.  The Serial-Number-based
        incremental update mechanism allows an efficient transfer of
        just the data records which have changed since the last update.
        As with any update protocol based on incremental transfers,
        the router must be prepared to fall back to a full transfer if
        for any reason the cache is unable to provide the necessary
        incremental data.  Unlike some incremental transfer protocols,
        this protocol requires the router to make an explicit request
        to start the fallback process; this is deliberate, as the
        cache has no way of knowing whether the router has also
        established sessions with other caches that may be able to
        provide better service.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">
        As a cache server must evaluate certificates and ROAs (Route
        Origin Authorizations; see <span>[<a href="#RFC6480" class="xref">RFC6480</a>]</span>),
        which are time dependent, servers' clocks MUST be correct to a
        tolerance of approximately an hour.<a href="#section-4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pdus">
<section id="section-5">
      <h2 id="name-protocol-data-units-pdus">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-protocol-data-units-pdus" class="section-name selfRef">Protocol Data Units (PDUs)</a>
      </h2>
<p id="section-5-1">
        The exchanges between the cache and the router are sequences of
        exchanges of the following PDUs according to the rules described
        in <a href="#protocol" class="xref">Section 8</a>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
        Reserved fields (marked "zero" in PDU diagrams) MUST be zero
        on transmission and MUST be ignored on receipt.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="fields">
<section id="section-5.1">
        <h3 id="name-fields-of-a-pdu">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-fields-of-a-pdu" class="section-name selfRef">Fields of a PDU</a>
        </h3>
<p id="section-5.1-1">
          PDUs contain the following data elements:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-2">
          <dt id="section-5.1-2.1">Protocol Version:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.2">
              An 8-bit unsigned integer, currently 1, denoting the
              version of this protocol.<a href="#section-5.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.3">PDU Type:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.4">
              An 8-bit unsigned integer, denoting the type of the PDU,
              e.g., IPv4 Prefix.<a href="#section-5.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.5">Serial Number:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.6">
              The Serial Number of the RPKI cache when this set of PDUs
              was received from an upstream cache server or gathered from
              the Global RPKI.  A cache increments its Serial Number when
              completing a rigorously validated update from a parent cache
              or the Global RPKI.<a href="#section-5.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.7">Session ID:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.8">
              A 16-bit unsigned integer.
              When a cache server is started, it generates a Session
              ID to identify the instance of the cache and to bind it
              to the sequence of Serial Numbers that cache instance
              will generate.  This allows the router to restart a
              failed session knowing that the Serial Number it is
              using is commensurate with that of the cache.  If, at
              any time after the protocol version has been negotiated
              (<a href="#version" class="xref">Section 7</a>), either the router or the
              cache finds that the value of the Session ID is not the
              same as the other's, the party which detects the mismatch
              MUST immediately terminate the session with an Error
              Report PDU with code 0 ("Corrupt Data"),
              and the router MUST flush all data learned from that cache.<a href="#section-5.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.9"></dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.10">
              Note that sessions are specific to a particular protocol
              version.  That is, if a cache server supports multiple
              versions of this protocol, happens to use the same
              Session ID value for multiple protocol versions, and
              further happens to use the same Serial Number values for
              two or more sessions using the same Session ID but
              different Protocol Version values, the Serial Numbers
              are not commensurate.  The full test for whether Serial
              Numbers are commensurate requires comparing Protocol
              Version, Session ID, and Serial Number.  To reduce the
              risk of confusion, cache servers SHOULD NOT use the same
              Session ID across multiple protocol versions, but even
              if they do, routers MUST treat sessions with different
              Protocol Version fields as separate sessions even if
              they do happen to have the same Session ID.<a href="#section-5.1-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.11"></dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.12">
              Should a cache erroneously reuse a Session ID so that a
              router does not realize that the session has changed (old
              Session ID and new Session ID have the same numeric value),
              the router may become confused as to the content of the cache.
              The time it takes the router to discover that it is confused
              will depend on whether the Serial Numbers are also reused.  If
              the Serial Numbers in the old and new sessions are different
              enough, the cache will respond to the router's Serial Query
              with a Cache Reset, which will solve the problem.  If,
              however, the Serial Numbers are close, the cache may respond
              with a Cache Response, which may not be enough to bring the
              router into sync.  In such cases, it's likely but not
              certain that the router will detect some discrepancy between
              the state that the cache expects and its own state.  For
              example, the Cache Response may tell the router to drop a
              record which the router does not hold or may tell the
              router to add a record which the router already has.  In
              such cases, a router will detect the error and reset the
              session.  The one case in which the router may stay out of
              sync is when nothing in the Cache Response contradicts any
              data currently held by the router.<a href="#section-5.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.13"></dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.14">
              Using persistent storage for the Session ID or a
              clock-based scheme for generating Session IDs should
              avoid the risk of Session ID collisions.<a href="#section-5.1-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.15"></dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.16">
              The Session ID might be a pseudorandom value, a
              strictly increasing value if the cache has reliable
              storage, et cetera.  A seconds-since-epoch timestamp
              value such as the POSIX time() function makes a good
              Session ID value.<a href="#section-5.1-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.17">Length:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.18">
              A 32-bit unsigned integer which has as its value the count
              of the bytes in the entire PDU, including the 8 bytes of
              header which includes the length field.<a href="#section-5.1-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.19">Flags:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.20">
              The lowest-order bit of the Flags field is 1 for an
              announcement and 0 for a withdrawal.  For a Prefix PDU
              (IPv4 or IPv6), the flag indicates whether this PDU
              announces a new right to announce the prefix or
              withdraws a previously announced right; a withdraw
              effectively deletes one previously announced Prefix PDU
              with the exact same Prefix, Length, Max-Len, and
              Autonomous System Number (ASN).  Similarly, for a Router
              Key PDU, the flag indicates whether this PDU announces a
              new Router Key or deletes one previously announced
              Router Key PDU with the exact same AS Number,
              subjectKeyIdentifier, and subjectPublicKeyInfo.<a href="#section-5.1-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.21"></dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.22">
              The remaining bits in the Flags field are reserved for
              future use.  In protocol version 1, they MUST be zero on
              transmission and MUST be ignored on receipt.<a href="#section-5.1-2.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.23">Prefix Length:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.24">
              An 8-bit unsigned integer denoting the shortest prefix
              allowed by the Prefix element.<a href="#section-5.1-2.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.25">Max Length:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.26">
              An 8-bit unsigned integer denoting the longest prefix
              allowed by the Prefix element.  This MUST NOT be less
              than the Prefix Length element.<a href="#section-5.1-2.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.27">Prefix:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.28">
              The IPv4 or IPv6 prefix of the ROA.<a href="#section-5.1-2.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.29">Autonomous System Number:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.30">
              A 32-bit unsigned integer representing an ASN allowed to
              announce a prefix or associated with a router key.<a href="#section-5.1-2.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.31">Subject Key Identifier:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.32"> 20-octet
              Subject Key Identifier (SKI) value of a router key, as
              described in <span>[<a href="#RFC6487" class="xref">RFC6487</a>]</span>.<a href="#section-5.1-2.32" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.33">Subject Public Key Info:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.34"> A router key's
              subjectPublicKeyInfo value, as described in
              <span>[<a href="#RFC8208" class="xref">RFC8208</a>]</span>.  This is the
              full ASN.1 DER encoding of the subjectPublicKeyInfo,
              including the ASN.1 tag and length values of the
              subjectPublicKeyInfo SEQUENCE.<a href="#section-5.1-2.34" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.35">Refresh Interval:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.36">
            Interval between normal cache polls.
            See <a href="#timing" class="xref">Section 6</a>.<a href="#section-5.1-2.36" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.37">Retry Interval:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.38">
            Interval between cache poll retries after a failed cache poll.
            See <a href="#timing" class="xref">Section 6</a>.<a href="#section-5.1-2.38" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.39">Expire Interval:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.40">
            Interval during which data fetched from a cache remains
            valid in the absence of a successful subsequent cache poll.
            See <a href="#timing" class="xref">Section 6</a>.<a href="#section-5.1-2.40" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="notify">
<section id="section-5.2">
        <h3 id="name-serial-notify">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-serial-notify" class="section-name selfRef">Serial Notify</a>
        </h3>
<p id="section-5.2-1">
          The cache notifies the router that the cache has new data.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
          The Session ID reassures the router that the Serial Numbers
          are commensurate, i.e., the cache session has not been
          changed.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">
          Upon receipt of a Serial Notify PDU, the router MAY issue an
          immediate Serial Query (<a href="#serialquery" class="xref">Section 5.3</a>) or 
          Reset Query (<a href="#resetquery" class="xref">Section 5.4</a>) without waiting for
          the Refresh Interval timer (see <a href="#timing" class="xref">Section 6</a>)
          to expire.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">
          Serial Notify is the only message that the cache can send
          that is not in response to a message from the router.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">
          If the router receives a Serial Notify PDU during the
          initial startup period where the router and cache are still
          negotiating to agree on a protocol version, the router
          MUST simply ignore the Serial Notify PDU, even if the
          Serial Notify PDU is for an unexpected protocol version.
          See <a href="#version" class="xref">Section 7</a> for details.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-6">
<pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |     Session ID      |
|    2     |    0     |                     |
+-------------------------------------------+
|                                           |
|                Length=12                  |
|                                           |
+-------------------------------------------+
|                                           |
|               Serial Number               |
|                                           |
`-------------------------------------------'
</pre><a href="#section-5.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="serialquery">
<section id="section-5.3">
        <h3 id="name-serial-query">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-serial-query" class="section-name selfRef">Serial Query</a>
        </h3>
<p id="section-5.3-1">
          The router sends a Serial Query to ask the cache
          for all announcements and withdrawals which have
          occurred since the Serial Number specified in the Serial
          Query.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">
          The cache replies to this query with a Cache Response PDU
          (<a href="#cacheresponse" class="xref">Section 5.5</a>) if the cache has a
          (possibly null) record of the changes since the Serial Number
          specified by the router, followed by zero or more payload
          PDUs and an End Of Data PDU (<a href="#eod" class="xref">Section 5.8</a>).<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">
          When replying to a Serial Query, the cache MUST return the
          minimum set of changes needed to bring the router into sync
          with the cache.  That is, if a particular prefix or router
          key underwent multiple changes between the Serial Number
          specified by the router and the cache's current Serial
          Number, the cache MUST merge those changes to present the
          simplest possible view of those changes to the router.  In
          general, this means that, for any particular prefix or
          router key, the data stream will include at most one
          withdrawal followed by at most one announcement, and if all
          of the changes cancel out, the data stream will not mention
          the prefix or router key at all.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">
          The rationale for this approach is that the entire purpose of
          the RPKI‑Router protocol is to offload work from the router
          to the cache, and it should therefore be the cache's job to
          simplify the change set, thus reducing work for the router.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<p id="section-5.3-5">
          If the cache does not have the data needed to update the
          router, perhaps because its records do not go back to the
          Serial Number in the Serial Query, then it responds with a
          Cache Reset PDU (<a href="#cachereset" class="xref">Section 5.9</a>).<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3-6">
          The Session ID tells the cache what instance the router
          expects to ensure that the Serial Numbers are commensurate,
          i.e., the cache session has not been changed.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-7">
<pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |     Session ID      |
|    2     |    1     |                     |
+-------------------------------------------+
|                                           |
|                 Length=12                 |
|                                           |
+-------------------------------------------+
|                                           |
|               Serial Number               |
|                                           |
`-------------------------------------------'
</pre><a href="#section-5.3-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="resetquery">
<section id="section-5.4">
        <h3 id="name-reset-query">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-reset-query" class="section-name selfRef">Reset Query</a>
        </h3>
<p id="section-5.4-1">
          The router tells the cache that it wants to
          receive the total active, current, non-withdrawn database.
          The cache responds with a Cache Response PDU
          (<a href="#cacheresponse" class="xref">Section 5.5</a>), followed by zero or more
          payload PDUs and an End of Data PDU (<a href="#eod" class="xref">Section 5.8</a>).<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4-2">
<pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |         zero        |
|    2     |    2     |                     |
+-------------------------------------------+
|                                           |
|                 Length=8                  |
|                                           |
`-------------------------------------------'
</pre><a href="#section-5.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cacheresponse">
<section id="section-5.5">
        <h3 id="name-cache-response">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-cache-response" class="section-name selfRef">Cache Response</a>
        </h3>
<p id="section-5.5-1">
          The cache responds to queries with zero or more payload
          PDUs.  When replying to a Serial Query
          (<a href="#serialquery" class="xref">Section 5.3</a>), the cache sends the set of
          announcements and withdrawals that have occurred since the
          Serial Number sent by the client router.  When replying to a
          Reset Query (<a href="#resetquery" class="xref">Section 5.4</a>), the cache sends
          the set of all data records it has; in this case, the
          withdraw/announce field in the payload PDUs MUST have the
          value 1 (announce).<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">
          In response to a Reset Query, the new value of the Session ID
          tells the router the instance of the cache session for future
          confirmation.  In response to a Serial Query, the Session ID
          being the same reassures the router that the Serial Numbers
          are commensurate, i.e., the cache session has not been changed.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5-3">
<pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |     Session ID      |
|    2     |    3     |                     |
+-------------------------------------------+
|                                           |
|                 Length=8                  |
|                                           |
`-------------------------------------------'
</pre><a href="#section-5.5-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ipv4">
<section id="section-5.6">
        <h3 id="name-ipv4-prefix">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-ipv4-prefix" class="section-name selfRef">IPv4 Prefix</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-5.6-1">
<pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |         zero        |
|    2     |    4     |                     |
+-------------------------------------------+
|                                           |
|                 Length=20                 |
|                                           |
+-------------------------------------------+
|          |  Prefix  |   Max    |          |
|  Flags   |  Length  |  Length  |   zero   |
|          |   0..32  |   0..32  |          |
+-------------------------------------------+
|                                           |
|                IPv4 Prefix                |
|                                           |
+-------------------------------------------+
|                                           |
|         Autonomous System Number          |
|                                           |
`-------------------------------------------'
</pre><a href="#section-5.6-1" class="pilcrow">¶</a>
</div>
<p id="section-5.6-2">
          The lowest-order bit of the Flags field is 1 for an
          announcement and 0 for a withdrawal.<a href="#section-5.6-2" class="pilcrow">¶</a></p>
<p id="section-5.6-3">
          In the RPKI, nothing prevents a signing certificate from
          issuing two identical ROAs.  In this case, there would be no
          semantic difference between the objects, merely a process
          redundancy.<a href="#section-5.6-3" class="pilcrow">¶</a></p>
<p id="section-5.6-4">
          In the RPKI, there is also an actual need for what might
          appear to a router as identical IPvX PDUs.
          This can occur when an upstream certificate is being reissued
          or there is an address ownership transfer up the validation
          chain.  The ROA would be identical in the router sense,
          i.e., have the same {Prefix, Len, Max-Len, ASN}, but it would
          have a different validation path in the RPKI.  This is
          important to the RPKI but not to the router.<a href="#section-5.6-4" class="pilcrow">¶</a></p>
<p id="section-5.6-5">
          The cache server MUST ensure that it has told the router
          client to have one and only one IPvX PDU for a unique {Prefix,
          Len, Max-Len, ASN} at any one point in time.  Should the
          router client receive an IPvX PDU with a {Prefix, Len,
          Max-Len, ASN} identical to one it already has active, it
          SHOULD raise a Duplicate Announcement Received error.<a href="#section-5.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ipv6">
<section id="section-5.7">
        <h3 id="name-ipv6-prefix">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-ipv6-prefix" class="section-name selfRef">IPv6 Prefix</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-5.7-1">
<pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |         zero        |
|    2     |    6     |                     |
+-------------------------------------------+
|                                           |
|                 Length=32                 |
|                                           |
+-------------------------------------------+
|          |  Prefix  |   Max    |          |
|  Flags   |  Length  |  Length  |   zero   |
|          |  0..128  |  0..128  |          |
+-------------------------------------------+
|                                           |
+---                                     ---+
|                                           |
+---            IPv6 Prefix              ---+
|                                           |
+---                                     ---+
|                                           |
+-------------------------------------------+
|                                           |
|         Autonomous System Number          |
|                                           |
`-------------------------------------------'
</pre><a href="#section-5.7-1" class="pilcrow">¶</a>
</div>
<p id="section-5.7-2">
          Analogous to the IPv4 Prefix PDU, it has 96 more bits and no magic.<a href="#section-5.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="eod">
<section id="section-5.8">
        <h3 id="name-end-of-data">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-end-of-data" class="section-name selfRef">End of Data</a>
        </h3>
<p id="section-5.8-1">
          The cache tells the router it has no more data for the request.<a href="#section-5.8-1" class="pilcrow">¶</a></p>
<p id="section-5.8-2">
          The Session ID and Protocol Version MUST be the same as that of
          the corresponding Cache Response which began the (possibly null)
          sequence of payload PDUs.<a href="#section-5.8-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.8-3">
<pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |     Session ID      |
|    2     |    7     |                     |
+-------------------------------------------+
|                                           |
|                 Length=24                 |
|                                           |
+-------------------------------------------+
|                                           |
|               Serial Number               |
|                                           |
+-------------------------------------------+
|                                           |
|              Refresh Interval             |
|                                           |
+-------------------------------------------+
|                                           |
|               Retry Interval              |
|                                           |
+-------------------------------------------+
|                                           |
|              Expire Interval              |
|                                           |
`-------------------------------------------'
</pre><a href="#section-5.8-3" class="pilcrow">¶</a>
</div>
<p id="section-5.8-4">
          The Refresh Interval, Retry Interval, and Expire Interval
          are all 32-bit elapsed times measured in seconds. They express
          the timing parameters which the cache expects the router to
          use in deciding when to send subsequent Serial Query or
          Reset Query PDUs to the cache.
          See <a href="#timing" class="xref">Section 6</a> for an explanation of the use
          and the range of allowed values for these parameters.<a href="#section-5.8-4" class="pilcrow">¶</a></p>
<p id="section-5.8-5">Note that the End of Data PDU changed significantly between
 versions 0 and 1.  For version 0 compatibility, the following is
 the version 0 End of Data PDU.<a href="#section-5.8-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.8-6">
<pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |     Cache Nonce     |
|    0     |    7     |                     |
+-------------------------------------------+
|                                           |
|                 Length=12                 |
|                                           |
+-------------------------------------------+
|                                           |
|               Serial Number               |
|                                           |
`-------------------------------------------'
</pre><a href="#section-5.8-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cachereset">
<section id="section-5.9">
        <h3 id="name-cache-reset">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-cache-reset" class="section-name selfRef">Cache Reset</a>
        </h3>
<p id="section-5.9-1">
          The cache may respond to a Serial Query informing the router
          that the cache cannot provide an incremental update
          starting from the Serial Number specified by the router.
          The router must decide whether to issue a Reset Query or
          switch to a different cache.<a href="#section-5.9-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.9-2">
<pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |         zero        |
|    2     |    8     |                     |
+-------------------------------------------+
|                                           |
|                 Length=8                  |
|                                           |
`-------------------------------------------'
</pre><a href="#section-5.9-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="routerkey">
<section id="section-5.10">
        <h3 id="name-router-key">
<a href="#section-5.10" class="section-number selfRef">5.10. </a><a href="#name-router-key" class="section-name selfRef">Router Key</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-5.10-1">
<pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |          |          |
| Version  |   Type   |   Flags  |   zero   |
|    2     |    9     |          |          |
+-------------------------------------------+
|                                           |
|                  Length                   |
|                                           |
+-------------------------------------------+
|                                           |
+---                                     ---+
|          Subject Key Identifier           |
+---                                     ---+
|                                           |
+---                                     ---+
|                (20 octets)                |
+---                                     ---+
|                                           |
+-------------------------------------------+
|                                           |
|                 AS Number                 |
|                                           |
+-------------------------------------------+
|                                           |
|          Subject Public Key Info          |
|                                           |
`-------------------------------------------'
</pre><a href="#section-5.10-1" class="pilcrow">¶</a>
</div>
<p id="section-5.10-2">
          The lowest-order bit of the Flags field is 1 for an
          announcement and 0 for a withdrawal.<a href="#section-5.10-2" class="pilcrow">¶</a></p>
<p id="section-5.10-3">
          The cache server MUST ensure that it has told the router
          client to have one and only one Router Key PDU for a unique
          {SKI, ASN, Subject Public Key} at any one point in time.
          Should the router client receive a Router Key PDU with a
          {SKI, ASN, Subject Public Key} identical to one it already
          has active, it SHOULD raise a Duplicate Announcement
          Received error.<a href="#section-5.10-3" class="pilcrow">¶</a></p>
<p id="section-5.10-4">
          Note that a particular ASN may appear in multiple Router Key
          PDUs with different Subject Public Key values, while a
          particular Subject Public Key value may appear in multiple
          Router Key PDUs with different ASNs.  In the interest of
          keeping the announcement and withdrawal semantics as simple
          as possible for the router, this protocol makes no attempt
          to compress either of these cases.<a href="#section-5.10-4" class="pilcrow">¶</a></p>
<p id="section-5.10-5">
          Also note that it is possible, albeit very unlikely, for
          multiple distinct Subject Public Key values to hash to the
          same SKI.  For this reason, implementations MUST compare
          Subject Public Key values as well as SKIs when detecting
          duplicate PDUs.<a href="#section-5.10-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="error">
<section id="section-5.11">
        <h3 id="name-error-report">
<a href="#section-5.11" class="section-number selfRef">5.11. </a><a href="#name-error-report" class="section-name selfRef">Error Report</a>
        </h3>
<p id="section-5.11-1">
          This PDU is used by either party to report an error to the
          other.<a href="#section-5.11-1" class="pilcrow">¶</a></p>
<p id="section-5.11-2">
          Error reports are only sent as responses to other PDUs, not
          to report errors in Error Report PDUs.<a href="#section-5.11-2" class="pilcrow">¶</a></p>
<p id="section-5.11-3">
          Error codes are described in <a href="#errorcodes" class="xref">Section 13</a>.<a href="#section-5.11-3" class="pilcrow">¶</a></p>
<p id="section-5.11-4">
          If the error is generic (e.g., "Internal Error") and not
          associated with the PDU to which it is responding, the
          Erroneous PDU field MUST be empty and the Length of
          Encapsulated PDU field MUST be zero.<a href="#section-5.11-4" class="pilcrow">¶</a></p>
<p id="section-5.11-5">
          An Error Report PDU MUST NOT be sent for an Error Report PDU.
          If an erroneous Error Report PDU is received, the session
          SHOULD be dropped.<a href="#section-5.11-5" class="pilcrow">¶</a></p>
<p id="section-5.11-6">
          If the error is associated with a PDU of excessive length,
          i.e., too long to be any legal PDU other than another Error
          Report, or a possibly corrupt length, the Erroneous PDU field
          MAY be truncated.<a href="#section-5.11-6" class="pilcrow">¶</a></p>
<p id="section-5.11-7">
          The diagnostic text is optional; if not present, the Length of
          Error Text field MUST be zero.  If error text is present, it
          MUST be a string in UTF-8 encoding (see <span>[<a href="#RFC3629" class="xref">RFC3629</a>]</span>).<a href="#section-5.11-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.11-8">
<pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |     Error Code      |
|    2     |    10    |                     |
+-------------------------------------------+
|                                           |
|                  Length                   |
|                                           |
+-------------------------------------------+
|                                           |
|       Length of Encapsulated PDU          |
|                                           |
+-------------------------------------------+
|                                           |
~               Erroneous PDU               ~
|                                           |
+-------------------------------------------+
|                                           |
|           Length of Error Text            |
|                                           |
+-------------------------------------------+
|                                           |
|              Arbitrary Text               |
|                    of                     |
~          Error Diagnostic Message         ~
|                                           |
`-------------------------------------------'
</pre><a href="#section-5.11-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="aspa">
<section id="section-5.12">
        <h3 id="name-aspa-pdu">
<a href="#section-5.12" class="section-number selfRef">5.12. </a><a href="#name-aspa-pdu" class="section-name selfRef">ASPA PDU</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-5.12-1">
<pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |        zero         |
|    2     |    11    |                     |
+-------------------------------------------+
|                                           |
|                 Length                    |
|                                           |
+-------------------------------------------+
|          |          |                     |
|  Flags   |   zero   |  Provider AS Count  |
|          |          |                     |
+-------------------------------------------+
|                                           |
|    Customer Autonomous System Number      |
|                                           |
+-------------------------------------------+
|                                           |
|    Provider Autonomous System Numbers     |
|                                           |
~-------------------------------------------~
</pre><a href="#section-5.12-1" class="pilcrow">¶</a>
</div>
<p id="section-5.12-2">
   The ASPA PDU is to support <span>[<a href="#I-D.ietf-sidrops-aspa-profile" class="xref">I-D.ietf-sidrops-aspa-profile</a>]</span>.  An ASPA PDU
   represents one single customer AS and its provider ASs for a
   particular Address Family.  Receipt of an ASPA PDU
   announcement when the router already has an ASPA PDU with the
   same Customer Autonomous System Number and the same Address
   Family (see Flags field), replaces the previous one.  This is
   to avoid a race condition when a BGP announcement is received
   between an withdrawn PDU and a new announced PDU.  Therefore,
   the cache MUST deliver entire data of an ASPA record in a
   single ASPA PDU.<a href="#section-5.12-2" class="pilcrow">¶</a></p>
<p id="section-5.12-3">
   The router should see at most one ASPA from a cache for a
   particular Customer Autonomous System Number active at any
   time.  As a number of conditions in the global RPKI may
   present multiple valid ASPA objects for a single customer to a
   particular RP cache, this places a burden on the cache to
   merge multiple ASPA records it has received from the global
   RPKI into one ASPA PDU.<a href="#section-5.12-3" class="pilcrow">¶</a></p>
<p id="section-5.12-4">
          The Flags field is defined as follows:<a href="#section-5.12-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.12-5">
<pre>
    Bit     Bit Name
    ----    -------------------
     0      AFI (IPv4 == 0, IPv6 == 1)
     1-7    Reserved, must be zero
</pre><a href="#section-5.12-5" class="pilcrow">¶</a>
</div>
<p id="section-5.12-6">
          The Provider AS Count is the number of 32-bit Provider
          Autonomous System Numbers in the PDU.<a href="#section-5.12-6" class="pilcrow">¶</a></p>
<p id="section-5.12-7">
          The Customer Autonomous System Number is the 32-bit Autonomous
          System Number of the customer which signed the PDU.  There
          MUST be one and only one ASPA for a Customer Autonomous System
          Number active in the router at any time.<a href="#section-5.12-7" class="pilcrow">¶</a></p>
<p id="section-5.12-8">
          There are one or more 32-bit Provider Autonomous System Number
          fields; see <span>[<a href="#I-D.ietf-sidrops-aspa-profile" class="xref">I-D.ietf-sidrops-aspa-profile</a>]</span>.<a href="#section-5.12-8" class="pilcrow">¶</a></p>
<p id="section-5.12-9">
   Receipt of an ASPA PDU with zero providers is an implicit
   withdraw of the entire ASPA data for that customer AS from
   that cache.<a href="#section-5.12-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="timing">
<section id="section-6">
      <h2 id="name-protocol-timing-parameters">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-protocol-timing-parameters" class="section-name selfRef">Protocol Timing Parameters</a>
      </h2>
<p id="section-6-1">
        Since the data the cache distributes via the RPKI-Router
        protocol are retrieved from the Global RPKI system at intervals
        which are only known to the cache, only the cache can really
        know how frequently it makes sense for the router to poll the
        cache, or how long the data are likely to remain valid (or, at
        least, unchanged).  For this reason, as well as to allow the
        cache some control over the load placed on it by its client
        routers, the End Of Data PDU includes three values that allow
        the cache to communicate timing parameters to the router:<a href="#section-6-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6-2">
        <dt id="section-6-2.1">Refresh Interval:</dt>
        <dd style="margin-left: 1.5em" id="section-6-2.2">
          <p id="section-6-2.2.1">
            This parameter tells the router how long to wait before
            next attempting to poll the cache and between subsequent
            attempts, using a Serial Query or Reset Query PDU.  The
            router SHOULD NOT poll the cache sooner than indicated by
            this parameter.  Note that receipt of a Serial Notify PDU
            overrides this interval and suggests that the router issue
            an immediate query without waiting for the Refresh
            Interval to expire.  Countdown for this timer starts upon
            receipt of the containing End Of Data PDU.<a href="#section-6-2.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6-2.2.2">
            <dt id="section-6-2.2.2.1">Minimum allowed value:</dt>
            <dd style="margin-left: 1.5em" id="section-6-2.2.2.2">1 second.<a href="#section-6-2.2.2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6-2.2.2.3">Maximum allowed value:</dt>
            <dd style="margin-left: 1.5em" id="section-6-2.2.2.4">86400 seconds (1 day).<a href="#section-6-2.2.2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6-2.2.2.5">Recommended default:</dt>
            <dd style="margin-left: 1.5em" id="section-6-2.2.2.6">3600 seconds (1 hour).<a href="#section-6-2.2.2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</dd>
        <dd class="break"></dd>
<dt id="section-6-2.3">Retry Interval:</dt>
        <dd style="margin-left: 1.5em" id="section-6-2.4">
          <p id="section-6-2.4.1">
            This parameter tells the router how long to wait before
            retrying a failed Serial Query or Reset Query.  The router
            SHOULD NOT retry sooner than indicated by this parameter.
            Note that a protocol version mismatch overrides this
            interval: if the router needs to downgrade to a lower
            protocol version number, it MAY send the first Serial
            Query or Reset Query immediately.  Countdown for this
            timer starts upon failure of the query and restarts after
            each subsequent failure until a query succeeds.<a href="#section-6-2.4.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6-2.4.2">
            <dt id="section-6-2.4.2.1">Minimum allowed value:</dt>
            <dd style="margin-left: 1.5em" id="section-6-2.4.2.2">1 second.<a href="#section-6-2.4.2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6-2.4.2.3">Maximum allowed value:</dt>
            <dd style="margin-left: 1.5em" id="section-6-2.4.2.4">7200 seconds (2 hours).<a href="#section-6-2.4.2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6-2.4.2.5">Recommended default:</dt>
            <dd style="margin-left: 1.5em" id="section-6-2.4.2.6">600 seconds (10 minutes).<a href="#section-6-2.4.2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</dd>
        <dd class="break"></dd>
<dt id="section-6-2.5">Expire Interval:</dt>
        <dd style="margin-left: 1.5em" id="section-6-2.6">
          <p id="section-6-2.6.1">
            This parameter tells the router how long it can continue
            to use the current version of the data while unable to
            perform a successful subsequent query.  The router MUST
            NOT retain the data past the time indicated by this
            parameter.  Countdown for this timer starts upon receipt
            of the containing End Of Data PDU.<a href="#section-6-2.6.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6-2.6.2">
            <dt id="section-6-2.6.2.1">Minimum allowed value:</dt>
            <dd style="margin-left: 1.5em" id="section-6-2.6.2.2">600 seconds (10 minutes).<a href="#section-6-2.6.2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6-2.6.2.3">Maximum allowed value:</dt>
            <dd style="margin-left: 1.5em" id="section-6-2.6.2.4">172800 seconds (2 days).<a href="#section-6-2.6.2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6-2.6.2.5">Recommended default:</dt>
            <dd style="margin-left: 1.5em" id="section-6-2.6.2.6">3600 seconds (1 hour).<a href="#section-6-2.6.2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-6-3">
        If the router has never issued a successful query against a
        particular cache, it SHOULD retry periodically using the default
        Retry Interval, above.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">
        Caches MUST set Expire Interval to a value larger than
        either Refresh Interval or Retry Interval.<a href="#section-6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="version">
<section id="section-7">
      <h2 id="name-protocol-version-negotiatio">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-protocol-version-negotiatio" class="section-name selfRef">Protocol Version Negotiation</a>
      </h2>
<p id="section-7-1">
        A router MUST start each transport connection by issuing either a
        Reset Query or a Serial Query.  This query will tell the cache
        which version of this protocol the router implements.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">
        If a cache which supports version N receives a query from a
        router which specifies version Q &lt; N, the cache MUST downgrade
        to protocol version Q <span>[<a href="#RFC6810" class="xref">RFC6810</a>]</span> or <span>[<a href="#RFC8210" class="xref">RFC8210</a>]</span> or send a version 1 Error Report PDU with
        Error Code 4 ("Unsupported Protocol Version") and terminate the
        connection.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">
        If a router which supports version N sends a query to a cache
        which only supports version C &lt; N, one of two things will
        happen:<a href="#section-7-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-4">
<li id="section-7-4.1">
            The cache may terminate the connection, perhaps with a
            version 0 Error Report PDU.  In this case, the router MAY
            retry the connection using protocol version C.<a href="#section-7-4.1" class="pilcrow">¶</a>
</li>
        <li id="section-7-4.2">
            The cache may reply with a version C response.  In this
            case, the router MUST either downgrade to version C or
            terminate the connection.<a href="#section-7-4.2" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-7-5">
        In any of the downgraded combinations above, the new features of
        the higher version will not be available, and all PDUs will have
        the negotiated lower version number in their version fields.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">
        If either party receives a PDU containing an unrecognized
        Protocol Version (neither 0, 1, nor 2) during this negotiation,
        it MUST either downgrade to a known version or terminate the
        connection, with an Error Report PDU unless the received PDU is
        itself an Error Report PDU.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">
        The router MUST ignore any Serial Notify PDUs it might receive
        from the cache during this initial startup period, regardless
        of the Protocol Version field in the Serial Notify PDU.  Since
        Session ID and Serial Number values are specific to a
        particular protocol version, the values in the notification
        are not useful to the router.  Even if these values were
        meaningful, the only effect that processing the notification
        would have would be to trigger exactly the same Reset Query or
        Serial Query that the router has already sent as part of the
        not-yet-complete version negotiation process, so there is
        nothing to be gained by processing notifications until version
        negotiation completes.<a href="#section-7-7" class="pilcrow">¶</a></p>
<p id="section-7-8">
        Caches SHOULD NOT send Serial Notify PDUs before version
        negotiation completes.  Routers, however, MUST handle such
        notifications (by ignoring them) for backwards compatibility
        with caches serving protocol version 0.<a href="#section-7-8" class="pilcrow">¶</a></p>
<p id="section-7-9">
        Once the cache and router have agreed upon a Protocol Version
        via the negotiation process above, that version is stable for
        the life of the session.  See <a href="#fields" class="xref">Section 5.1</a> for a
        discussion of the interaction between Protocol Version and
        Session ID.<a href="#section-7-9" class="pilcrow">¶</a></p>
<p id="section-7-10">
        If either party receives a PDU for a different Protocol
        Version once the above negotiation completes, that party MUST
        drop the session; unless the PDU containing the unexpected
        Protocol Version was itself an Error Report PDU, the party
        dropping the session SHOULD send an Error Report with an error
        code of 8 ("Unexpected Protocol Version").<a href="#section-7-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol">
<section id="section-8">
      <h2 id="name-protocol-sequences">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-protocol-sequences" class="section-name selfRef">Protocol Sequences</a>
      </h2>
<p id="section-8-1">
        The sequences of PDU transmissions fall into four
        conversations as follows:<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="start">
<section id="section-8.1">
        <h3 id="name-start-or-restart">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-start-or-restart" class="section-name selfRef">Start or Restart</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-8.1-1">
<pre>
Cache                         Router
  ~                             ~
  | &lt;----- Reset Query -------- | R requests data (or Serial Query)
  |                             |
  | ----- Cache Response -----&gt; | C confirms request
  | ------- Payload PDU ------&gt; | C sends zero or more
  | ------- Payload PDU ------&gt; |   IPv4 Prefix, IPv6 Prefix,
  | ------- Payload PDU ------&gt; |   or Router Key PDUs
  | ------- End of Data ------&gt; | C sends End of Data
  |                             |   and sends new serial
  ~                             ~
</pre><a href="#section-8.1-1" class="pilcrow">¶</a>
</div>
<p id="section-8.1-2">
          When a transport connection is first established, the router
          MUST send either a Reset Query or a Serial Query.  A Serial
          Query would be appropriate if the router has significant
          unexpired data from a broken session with the same cache and
          remembers the Session ID of that session, in which case a
          Serial Query containing the Session ID from the previous
          session will allow the router to bring itself up to date
          while ensuring that the Serial Numbers are commensurate and
          that the router and cache are speaking compatible versions
          of the protocol.  In all other cases, the router lacks the
          necessary data for fast resynchronization and therefore
          MUST fall back to a Reset Query.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">
          The Reset Query sequence is also used when the router
          receives a Cache Reset, chooses a new cache, or fears that
          it has otherwise lost its way.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">
          See <a href="#version" class="xref">Section 7</a> for details on version
          negotiation.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5">
          To limit the length of time a cache must keep the data
          necessary to generate incremental updates, a router MUST
          send either a Serial Query or a Reset Query periodically.
          This also acts as a keep-alive at the application layer.
          See <a href="#timing" class="xref">Section 6</a> for details on the required
          polling frequency.<a href="#section-8.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="query">
<section id="section-8.2">
        <h3 id="name-typical-exchange">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-typical-exchange" class="section-name selfRef">Typical Exchange</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-8.2-1">
<pre>
Cache                         Router
  ~                             ~
  | -------- Notify ----------&gt; |  (optional)
  |                             |
  | &lt;----- Serial Query ------- | R requests data
  |                             |
  | ----- Cache Response -----&gt; | C confirms request
  | ------- Payload PDU ------&gt; | C sends zero or more
  | ------- Payload PDU ------&gt; |   IPv4 Prefix, IPv6 Prefix,
  | ------- Payload PDU ------&gt; |   or Router Key PDUs
  | ------- End of Data ------&gt; | C sends End of Data
  |                             |   and sends new serial
  ~                             ~
</pre><a href="#section-8.2-1" class="pilcrow">¶</a>
</div>
<p id="section-8.2-2">
          The cache server SHOULD send a Notify PDU with its current
          Serial Number when the cache's serial changes, with the
          expectation that the router MAY then issue a Serial Query
          earlier than it otherwise might.  This is analogous to DNS
          NOTIFY in <span>[<a href="#RFC1996" class="xref">RFC1996</a>]</span>.  The cache MUST rate‑limit
          Serial Notifies to no more frequently than one per minute.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">
          When the transport layer is up and either a timer has gone
          off in the router or the cache has sent a Notify PDU, the router
          queries for new data by sending a Serial Query, and the cache
          sends all data newer than the serial in the Serial Query.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">
          To limit the length of time a cache must keep old withdraws,
          a router MUST send either a Serial Query or a Reset Query
          periodically.  See <a href="#timing" class="xref">Section 6</a> for details on the
          required polling frequency.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nodiff">
<section id="section-8.3">
        <h3 id="name-no-incremental-update-avail">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-no-incremental-update-avail" class="section-name selfRef">No Incremental Update Available</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-8.3-1">
<pre>
Cache                         Router
  ~                             ~
  | &lt;------ Serial Query ------ | R requests data
  | ------- Cache Reset ------&gt; | C cannot supply update
  |                             |   from specified serial
  | &lt;------ Reset Query ------- | R requests new data
  | ----- Cache Response -----&gt; | C confirms request
  | ------- Payload PDU ------&gt; | C sends zero or more
  | ------- Payload PDU ------&gt; |   IPv4 Prefix, IPv6 Prefix,
  | ------- Payload PDU ------&gt; |   or Router Key PDUs
  | ------- End of Data ------&gt; | C sends End of Data
  |                             |   and sends new serial
  ~                             ~
</pre><a href="#section-8.3-1" class="pilcrow">¶</a>
</div>
<p id="section-8.3-2">
          The cache may respond to a Serial Query with a Cache Reset,
          informing the router that the cache cannot supply an
          incremental update from the Serial Number specified by the
          router.  This might be because the cache has lost state, or
          because the router has waited too long between polls and the
          cache has cleaned up old data that it no longer believes it
          needs, or because the cache has run out of storage space and
          had to expire some old data early.  Regardless of how this
          state arose, the cache replies with a Cache Reset to tell
          the router that it cannot honor the request.  When a router
          receives this, the router SHOULD attempt to connect to any
          more-preferred caches in its cache list. If there are
          no more-preferred caches, it MUST issue a Reset Query and
          get an entire new load from the cache.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nodata">
<section id="section-8.4">
        <h3 id="name-cache-has-no-data-available">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-cache-has-no-data-available" class="section-name selfRef">Cache Has No Data Available</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-8.4-1">
<pre>
Cache                         Router
  ~                             ~
  | &lt;------ Serial Query ------ | R requests data
  | ---- Error Report PDU ----&gt; | C No Data Available
  ~                             ~

Cache                         Router
  ~                             ~
  | &lt;------ Reset Query ------- | R requests data
  | ---- Error Report PDU ----&gt; | C No Data Available
  ~                             ~
</pre><a href="#section-8.4-1" class="pilcrow">¶</a>
</div>
<p id="section-8.4-2">
          The cache may respond to either a Serial Query or a Reset
          Query informing the router that the cache cannot supply any
          update at all.  The most likely cause is that the cache has
          lost state, perhaps due to a restart, and has not yet
          recovered.  While it is possible that a cache might go into
          such a state without dropping any of its active sessions,
          a router is more likely to see this behavior when it
          initially connects and issues a Reset Query while the cache
          is still rebuilding its database.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4-3">
          When a router receives this kind of error, the router
          SHOULD attempt to connect to any other caches in its cache
          list, in preference order.  If no other caches are
          available, the router MUST issue periodic Reset Queries
          until it gets a new usable load from the cache.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Transport">
<section id="section-9">
      <h2 id="name-transport">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-transport" class="section-name selfRef">Transport</a>
      </h2>
<p id="section-9-1">
        The transport-layer session between a router and a cache
        carries the binary PDUs in a persistent session.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">
        To prevent cache spoofing and DoS attacks by illegitimate
        routers, it is highly desirable that the router and the cache
        be authenticated to each other.  Integrity protection for
        payloads is also desirable to protect against
        monkey-in-the-middle (MITM) attacks.  Unfortunately, there is
        no protocol to do so on all currently used platforms.
        Therefore, as of the writing of this document, there is no
        mandatory-to-implement transport which provides authentication
        and integrity protection.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">
        To reduce exposure to dropped but non-terminated sessions, both
        caches and routers SHOULD enable keep-alives when available in
        the chosen transport protocol.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">
        It is expected that, when the TCP Authentication Option
        (TCP-AO) <span>[<a href="#RFC5925" class="xref">RFC5925</a>]</span> is available on all
        platforms deployed by operators, it will become the
        mandatory-to-implement transport.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">
        Caches and routers MUST implement unprotected transport over
        TCP using a port, rpki-rtr (323); see
        <a href="#IANA" class="xref">Section 15</a>.  Operators SHOULD use procedural means,
        e.g., access control lists (ACLs), to reduce the exposure to
        authentication issues.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">
        If unprotected TCP is the transport, the cache and routers MUST be
        on the same trusted and controlled network.<a href="#section-9-6" class="pilcrow">¶</a></p>
<p id="section-9-7">
        If available to the operator, caches and routers MUST use one
        of the following more protected protocols:<a href="#section-9-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-8.1">
        Caches and routers SHOULD use TCP-AO transport
        <span>[<a href="#RFC5925" class="xref">RFC5925</a>]</span> over the rpki-rtr port.<a href="#section-9-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-8.2">
        Caches and routers MAY use Secure Shell version 2 (SSHv2) transport
        <span>[<a href="#RFC4252" class="xref">RFC4252</a>]</span> using the normal SSH port.  For an
        example, see <a href="#SSH" class="xref">Section 9.1</a>.<a href="#section-9-8.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-8.3">
        Caches and routers MAY use TCP MD5 transport
        <span>[<a href="#RFC2385" class="xref">RFC2385</a>]</span> using the rpki-rtr port.  Note that
        TCP MD5 has been obsoleted by TCP-AO
        <span>[<a href="#RFC5925" class="xref">RFC5925</a>]</span>.<a href="#section-9-8.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-8.4">
        Caches and routers MAY use TCP over IPsec transport
        <span>[<a href="#RFC4301" class="xref">RFC4301</a>]</span> using the rpki-rtr port.<a href="#section-9-8.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-8.5">
        Caches and routers MAY use Transport Layer Security (TLS) transport
        <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> using port rpki-rtr-tls (324); see
        <a href="#IANA" class="xref">Section 15</a>.<a href="#section-9-8.5" class="pilcrow">¶</a>
</li>
      </ul>
<div id="SSH">
<section id="section-9.1">
        <h3 id="name-ssh-transport">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-ssh-transport" class="section-name selfRef">SSH Transport</a>
        </h3>
<p id="section-9.1-1">
          To run over SSH, the client router first establishes an SSH
          transport connection using the SSHv2 transport protocol, and
          the client and server exchange keys for message integrity and
          encryption.  The client then invokes the "ssh-userauth"
          service to authenticate the application, as described in the
          SSH authentication protocol <span>[<a href="#RFC4252" class="xref">RFC4252</a>]</span>.
          Once the application has been successfully
          authenticated, the client invokes the "ssh-connection"
          service, also known as the SSH connection protocol.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">
          After the ssh-connection service is established, the client
          opens a channel of type "session", which results in an SSH
          session.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">
          Once the SSH session has been established, the application
          invokes the application transport as an SSH subsystem called
          "rpki-rtr".  Subsystem support is a feature of SSHv2 and is not
          included in SSHv1.  Running this protocol as an SSH subsystem
          avoids the need for the application to recognize shell prompts
          or skip over extraneous information, such as a system message
          that is sent at shell startup.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">
          It is assumed that the router and cache have exchanged keys
          out of band by some reasonably secured means.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1-5">
          Cache servers supporting SSH transport MUST accept RSA
          authentication and SHOULD accept Elliptic Curve Digital
          Signature Algorithm (ECDSA) authentication.  User
          authentication MUST be supported; host authentication MAY be
          supported.  Implementations MAY support password
          authentication.  Client routers SHOULD verify the public key
          of the cache to avoid MITM attacks.<a href="#section-9.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9.2">
        <h3 id="name-tls-transport">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-tls-transport" class="section-name selfRef">TLS Transport</a>
        </h3>
<p id="section-9.2-1">
          Client routers using TLS transport MUST present client-side
          certificates to authenticate themselves to the cache in
          order to allow the cache to manage the load by rejecting
          connections from unauthorized routers.  In principle, any
          type of certificate and Certification Authority (CA) may be
          used; however, in general, cache operators will wish to
          create their own small-scale CA and issue certificates to
          each authorized router.  This simplifies credential
          rollover; any unrevoked, unexpired certificate from the
          proper CA may be used.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">
          Certificates used to authenticate client routers in this
          protocol MUST include a subjectAltName extension
          <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>
          containing one or more iPAddress identities; when
          authenticating the router's certificate, the cache MUST check
          the IP address of the TLS connection against these iPAddress
          identities and SHOULD reject the connection if none of the
          iPAddress identities match the connection.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">
          Routers MUST also verify the cache's TLS server certificate,
          using subjectAltName dNSName identities as described in
          <span>[<a href="#RFC6125" class="xref">RFC6125</a>]</span>, to avoid MITM attacks.  The rules
          and guidelines defined in <span>[<a href="#RFC6125" class="xref">RFC6125</a>]</span> apply here,
          with the following considerations:<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-4.1">
              Support for the DNS-ID identifier type (that is, the dNSName
              identity in the subjectAltName extension) is REQUIRED in
              rpki-rtr server and client implementations which use TLS.
              Certification authorities which issue rpki-rtr server
              certificates MUST support the DNS-ID identifier type, and
              the DNS-ID identifier type MUST be present in rpki-rtr
              server certificates.<a href="#section-9.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.2-4.2">
              DNS names in rpki-rtr server certificates SHOULD NOT
              contain the wildcard character "*".<a href="#section-9.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.2-4.3">
              rpki-rtr implementations which use TLS MUST NOT use
              Common Name (CN-ID) identifiers; a CN field may be present
              in the server certificate's subject name but MUST NOT be
              used for authentication within the rules described in
              <span>[<a href="#RFC6125" class="xref">RFC6125</a>]</span>.<a href="#section-9.2-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.2-4.4">
              The client router MUST set its "reference identifier" to
              the DNS name of the rpki-rtr cache.<a href="#section-9.2-4.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-9.3">
        <h3 id="name-tcp-md5-transport">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-tcp-md5-transport" class="section-name selfRef">TCP MD5 Transport</a>
        </h3>
<p id="section-9.3-1">
          If TCP MD5 is used, implementations MUST support key lengths
          of at least 80 printable ASCII bytes, per Section 4.5 of
          <span>[<a href="#RFC2385" class="xref">RFC2385</a>]</span>.  Implementations MUST also support
          hexadecimal sequences of at least 32 characters, i.e.,
          128 bits.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">
          Key rollover with TCP MD5 is problematic.  Cache servers
          SHOULD support <span>[<a href="#RFC4808" class="xref">RFC4808</a>]</span>.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
</section>
<section id="section-9.4">
        <h3 id="name-tcp-ao-transport">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-tcp-ao-transport" class="section-name selfRef">TCP-AO Transport</a>
        </h3>
<p id="section-9.4-1">
          Implementations MUST support key lengths of at least 80
          printable ASCII bytes.  Implementations MUST also support
          hexadecimal sequences of at least 32 characters, i.e., 128
          bits.  Message Authentication Code (MAC) lengths of at least
          96 bits MUST be supported, per Section 5.1 of
          <span>[<a href="#RFC5925" class="xref">RFC5925</a>]</span>.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">
          The cryptographic algorithms and associated parameters described in
          <span>[<a href="#RFC5926" class="xref">RFC5926</a>]</span> MUST be supported.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="Setup">
<section id="section-10">
      <h2 id="name-router-cache-setup">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-router-cache-setup" class="section-name selfRef">Router-Cache Setup</a>
      </h2>
<p id="section-10-1">
        A cache has the public authentication data for each router it
        is configured to support.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">
        A router may be configured to peer with a selection of caches,
        and a cache may be configured to support a selection of routers.
        Each must have the name of, and authentication data for, each
        peer.  In addition, in a router, this list has a non-unique
        preference value for each server.  This
        preference merely denotes proximity, not trust, preferred
        belief, et cetera.  The client router attempts to establish
        a session with each potential serving cache in preference order
        and then starts to load data from the most preferred cache to which
        it can connect and authenticate.  The router's list of caches has
        the following elements:<a href="#section-10-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10-3">
        <dt id="section-10-3.1">Preference:</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.2">
            An unsigned integer denoting the router's preference to
            connect to that cache; the lower the value, the more preferred.<a href="#section-10-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.3">Name:</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.4">
            The IP address or fully qualified domain name of the cache.<a href="#section-10-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.5">Cache Credential(s):</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.6">
            Any credential (such as a public key) needed to
            authenticate the cache's identity to the router.<a href="#section-10-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-10-3.7">Router Credential(s):</dt>
        <dd style="margin-left: 1.5em" id="section-10-3.8">
            Any credential (such as a private key or certificate)
            needed to authenticate the router's identity to the cache.<a href="#section-10-3.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-10-4">
        Due to the distributed nature of the RPKI, caches simply
        cannot be rigorously synchronous.  A client may hold data from
        multiple caches but MUST keep the data marked as to source, as
        later updates MUST affect the correct data.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">
        Just as there may be more than one covering ROA from a single
        cache, there may be multiple covering ROAs from multiple caches.
        The results are as described in
        <span>[<a href="#RFC6811" class="xref">RFC6811</a>]</span>.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">
        If data from multiple caches are held, implementations MUST NOT
        distinguish between data sources when performing validation of
        BGP announcements.<a href="#section-10-6" class="pilcrow">¶</a></p>
<p id="section-10-7">
        When a more-preferred cache becomes available, if resources
        allow, it would be prudent for the client to start fetching
        from that cache.<a href="#section-10-7" class="pilcrow">¶</a></p>
<p id="section-10-8">
        The client SHOULD attempt to maintain at least one set of data,
        regardless of whether it has chosen a different cache or
        established a new connection to the previous cache.<a href="#section-10-8" class="pilcrow">¶</a></p>
<p id="section-10-9">
        A client MAY drop the data from a particular cache when it is
        fully in sync with one or more other caches.<a href="#section-10-9" class="pilcrow">¶</a></p>
<p id="section-10-10">
        See <a href="#timing" class="xref">Section 6</a> for details on what to do when the
        client is not able to refresh from a particular cache.<a href="#section-10-10" class="pilcrow">¶</a></p>
<p id="section-10-11">
        If a client loses connectivity to a cache it is using or
        otherwise decides to switch to a new cache, it SHOULD retain the
        data from the previous cache until it has a full set of data
        from one or more other caches.  Note that this may already be
        true at the point of connection loss if the client has
        connections to more than one cache.<a href="#section-10-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="races">
<section id="section-11">
      <h2 id="name-roa-pdu-race-minimization">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-roa-pdu-race-minimization" class="section-name selfRef">ROA PDU Race Minimization</a>
      </h2>
<p id="section-11-1">
      When a cache is sending ROA PDUs to the router, especially during
      an initial full load, two undesirable race conditions are
      possible:<a href="#section-11-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11-2">
        <dt id="section-11-2.1">Break Before Make:</dt>
        <dd style="margin-left: 1.5em" id="section-11-2.2">
   For some prefix P, an AS may announce two (or more) ROAs
   because they are in the process of changing what provider AS
   is announcing P.  This is is a case of "make before break."
   If a cache is feeding a router and sends the one not yet in
   service a significant time before sending the one currently
   in service, then BGP data could be marked invalid during the
   interval.  To minimize that interval, the cache SHOULD
   announce all ROAs for the same prefix as close to
   sequentially as possible.<a href="#section-11-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-11-2.3">Shorter Prefix First:</dt>
        <dd style="margin-left: 1.5em" id="section-11-2.4">
   If an AS has issued a ROA for P0, and another AS (likely
   their customer) has issued a ROA for P1 which is a
   sub-prefix of P0, a router which receives the ROA for P0
   before that for P1 is likely to mark a BGP prefix P1
   invalid.  Therefore, the cache SHOULD announce the
   sub-prefix P1 before the covering prefix P0.<a href="#section-11-2.4" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="Scenarios">
<section id="section-12">
      <h2 id="name-deployment-scenarios">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-deployment-scenarios" class="section-name selfRef">Deployment Scenarios</a>
      </h2>
<p id="section-12-1">
        For illustration, we present three likely deployment
        scenarios:<a href="#section-12-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-12-2">
        <dt id="section-12-2.1">Small End Site:</dt>
        <dd style="margin-left: 1.5em" id="section-12-2.2">
            The small multihomed end site may wish to outsource the
            RPKI cache to one or more of their upstream ISPs.  They
            would exchange authentication material with the ISP using
            some out-of-band mechanism, and their router(s) would
            connect to the cache(s) of one or more upstream ISPs.  The
            ISPs would likely deploy caches intended for customer use
            separately from the caches with which their own BGP
            speakers peer.<a href="#section-12-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-12-2.3">Large End Site:</dt>
        <dd style="margin-left: 1.5em" id="section-12-2.4">
            A larger multihomed end site might run one or more caches,
            arranging them in a hierarchy of client caches, each fetching
            from a serving cache which is closer to the Global RPKI.  They
            might configure fallback peerings to upstream ISP caches.<a href="#section-12-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-12-2.5">ISP Backbone:</dt>
        <dd style="margin-left: 1.5em" id="section-12-2.6">
            A large ISP would likely have one or more redundant caches
            in each major point of presence (PoP), and these caches
            would fetch from each other in an ISP-dependent topology
            so as not to place undue load on the Global RPKI.<a href="#section-12-2.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-12-3">
        Experience with large DNS cache deployments has shown that
        complex topologies are ill-advised, as it is easy to make errors
        in the graph, e.g., not maintain a loop-free condition.<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">
        Of course, these are illustrations, and there are other possible
        deployment strategies.  It is expected that minimizing load on
        the Global RPKI servers will be a major consideration.<a href="#section-12-4" class="pilcrow">¶</a></p>
<p id="section-12-5">
        To keep load on Global RPKI services from unnecessary peaks, it
        is recommended that primary caches which load from the
        distributed Global RPKI not do so all at the same times, e.g., on
        the hour.  Choose a random time, perhaps the ISP's AS number
        modulo 60, and jitter the inter-fetch timing.<a href="#section-12-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="errorcodes">
<section id="section-13">
      <h2 id="name-error-codes">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-error-codes" class="section-name selfRef">Error Codes</a>
      </h2>
<p id="section-13-1">
        This section contains a preliminary list of error codes.  The
        authors expect additions to the list during development of
        the initial implementations.  There is an IANA registry where
        valid error codes are listed; see <a href="#IANA" class="xref">Section 15</a>.  Errors
        which are considered fatal MUST cause the session to be
        dropped.<a href="#section-13-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-13-2">
        <dt id="section-13-2.1">0: Corrupt Data (fatal):</dt>
        <dd style="margin-left: 1.5em" id="section-13-2.2">
            The receiver believes the received PDU to be corrupt in a
            manner not specified by another error code.<a href="#section-13-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-2.3">1: Internal Error (fatal):</dt>
        <dd style="margin-left: 1.5em" id="section-13-2.4">
            The party reporting the error experienced some kind of
            internal error unrelated to protocol operation (ran out of
            memory, a coding assertion failed, et cetera).<a href="#section-13-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-2.5">2: No Data Available:</dt>
        <dd style="margin-left: 1.5em" id="section-13-2.6">
            The cache believes itself to be in good working order but
            is unable to answer either a Serial Query or a Reset Query
            because it has no useful data available at this time.  This
            is likely to be a temporary error and most likely indicates
            that the cache has not yet completed pulling down an initial
            current data set from the Global RPKI system after some kind
            of event that invalidated whatever data it might have
            previously held (reboot, network partition, et cetera).<a href="#section-13-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-2.7">3: Invalid Request (fatal):</dt>
        <dd style="margin-left: 1.5em" id="section-13-2.8">
            The cache server believes the client's request to be
            invalid.<a href="#section-13-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-2.9">4: Unsupported Protocol Version (fatal):</dt>
        <dd style="margin-left: 1.5em" id="section-13-2.10">
            The Protocol Version is not known by the receiver of the
            PDU.<a href="#section-13-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-2.11">5: Unsupported PDU Type (fatal):</dt>
        <dd style="margin-left: 1.5em" id="section-13-2.12">
            The PDU Type is not known by the receiver of the PDU.<a href="#section-13-2.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-2.13">6: Withdrawal of Unknown Record (fatal):</dt>
        <dd style="margin-left: 1.5em" id="section-13-2.14">
            The received PDU has Flag=0, but a matching record
            ({Prefix, Len, Max-Len, ASN} tuple for an IPvX PDU or
            {SKI, ASN, Subject Public Key} tuple for a Router Key PDU)
            does not exist in the receiver's database.<a href="#section-13-2.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-2.15">7: Duplicate Announcement Received (fatal):</dt>
        <dd style="margin-left: 1.5em" id="section-13-2.16">
            The received PDU has Flag=1, but a matching record
            ({Prefix, Len, Max-Len, ASN} tuple for an IPvX PDU or
            {SKI, ASN, Subject Public Key} tuple for a Router Key PDU)
            is already active in the router.<a href="#section-13-2.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-13-2.17">8: Unexpected Protocol Version (fatal):</dt>
        <dd style="margin-left: 1.5em" id="section-13-2.18">
            The received PDU has a Protocol Version field that differs
            from the protocol version negotiated in
            <a href="#version" class="xref">Section 7</a>.<a href="#section-13-2.18" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="Security">
<section id="section-14">
      <h2 id="name-security-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-14-1">
        As this document describes a security protocol, many aspects of
        security interest are described in the relevant sections.  This
        section points out issues which may not be obvious in other
        sections.<a href="#section-14-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-14-2">
        <dt id="section-14-2.1">Cache Validation:</dt>
        <dd style="margin-left: 1.5em" id="section-14-2.2">
            In order for a collection of caches as described in
            <a href="#Scenarios" class="xref">Section 12</a> to guarantee a consistent view,
            they need to be given consistent trust anchors to use in their
            internal validation process.  Distribution of a consistent
            trust anchor is assumed to be out of band.<a href="#section-14-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-14-2.3">Cache Peer Identification:</dt>
        <dd style="margin-left: 1.5em" id="section-14-2.4">
            The router initiates a transport connection to a cache, which it
            identifies by either IP address or fully qualified domain
            name.  Be aware that a DNS or address spoofing attack could
            make the correct cache unreachable.  No session would be
            established, as the authorization keys would not match.<a href="#section-14-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-14-2.5">Transport Security:</dt>
        <dd style="margin-left: 1.5em" id="section-14-2.6">
            The RPKI relies on object, not server or transport, trust.
            That is, the IANA root trust anchor is distributed to all
            caches through some out-of-band means and can then be
            used by each cache to validate certificates and ROAs all
            the way down the tree.  The inter-cache relationships are
            based on this object security model; hence, the
            inter-cache transport can be lightly protected.<a href="#section-14-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-14-2.7"></dt>
        <dd style="margin-left: 1.5em" id="section-14-2.8">
            However, this protocol document assumes that the routers cannot
            do the validation cryptography.  Hence, the last link, from
            cache to router, is secured by server authentication and
            transport-level security.  This is dangerous, as server
            authentication and transport have very different threat models
            than object security.<a href="#section-14-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-14-2.9"></dt>
        <dd style="margin-left: 1.5em" id="section-14-2.10">
            So the strength of the trust relationship and the transport
            between the router(s) and the cache(s) are critical.  You're
            betting your routing on this.<a href="#section-14-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-14-2.11"></dt>
        <dd style="margin-left: 1.5em" id="section-14-2.12">
            While we cannot say the cache must be on the same LAN, if
            only due to the issue of an enterprise wanting to offload the
            cache task to their upstream ISP(s), locality, trust, and
            control are very critical issues here.  The cache(s) really
            SHOULD be as close, in the sense of controlled and protected
            (against DDoS, MITM) transport, to the router(s) as possible.
            It also SHOULD be topologically close so that a minimum of
            validated routing data are needed to bootstrap a router's access
            to a cache.<a href="#section-14-2.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-14-2.13"></dt>
        <dd style="margin-left: 1.5em" id="section-14-2.14">
            The identity of the cache server SHOULD be verified and
            authenticated by the router client, and vice versa, before any
            data are exchanged.<a href="#section-14-2.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-14-2.15"></dt>
        <dd style="margin-left: 1.5em" id="section-14-2.16">
            Transports which cannot provide the necessary authentication
            and integrity (see <a href="#Transport" class="xref">Section 9</a>) must rely on
            network design and operational controls to provide protection
            against spoofing/corruption attacks.  As pointed out in
            <a href="#Transport" class="xref">Section 9</a>, TCP-AO is the long-term plan.
            Protocols which provide integrity and authenticity SHOULD be
            used, and if they cannot, i.e., TCP is used as the transport,
            the router and cache MUST be on the same trusted, controlled
            network.<a href="#section-14-2.16" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="IANA">
<section id="section-15">
      <h2 id="name-iana-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-15-1">
        This section only discusses updates required in the existing
        IANA protocol registries to accommodate version 1 of this
        protocol.  See <span>[<a href="#RFC8210" class="xref">RFC8210</a>]</span> for IANA considerations
        from the original (version 0) protocol.<a href="#section-15-1" class="pilcrow">¶</a></p>
<p id="section-15-2">
        All existing entries in the IANA "rpki-rtr-pdu" registry
        remain valid for protocol version 0.  All of the PDU types
        allowed in protocol version 0 are also allowed in protocol
        version 1, with the addition of the new Router Key PDU.  To
        reduce the likelihood of confusion, the PDU number used by the
        Router Key PDU in protocol version 1 is hereby registered as
        reserved (and unused) in protocol version 0.<a href="#section-15-2" class="pilcrow">¶</a></p>
<p id="section-15-3">
        The policy for adding to the registry is RFC Required per
        <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>; the document must be either Standards Track or
        Experimental.<a href="#section-15-3" class="pilcrow">¶</a></p>
<p id="section-15-4">
        The "rpki-rtr-pdu" registry has been updated as follows:<a href="#section-15-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-15-5">
<pre>
           Protocol   PDU
           Version    Type  Description
           --------   ----  ---------------
              0-2       0   Serial Notify
              0-2       1   Serial Query
              0-2       2   Reset Query
              0-2       3   Cache Response
              0-2       4   IPv4 Prefix
              0-2       6   IPv6 Prefix
              0-2       7   End of Data
              0-2       8   Cache Reset
               0        9   Reserved
              1-2       9   Router Key
              0-2      10   Error Report
              0-1      11   Reserved
               2       11   ASPA
              0-2     255   Reserved
</pre><a href="#section-15-5" class="pilcrow">¶</a>
</div>
<p id="section-15-6">
        All previous entries in the IANA "rpki-rtr-error" registry
        remain valid for all protocol versions.  Protocol version 1
        added one new error code:<a href="#section-15-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-15-7">
<pre>
           Error
           Code    Description
           -----   ---------------------------
               8   Unexpected Protocol Version
</pre><a href="#section-15-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<section id="section-16">
      <h2 id="name-references">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-16.1">
        <h3 id="name-normative-references">
<a href="#section-16.1" class="section-number selfRef">16.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-sidrops-aspa-profile">[I-D.ietf-sidrops-aspa-profile]</dt>
        <dd>
<span class="refAuthor">Azimov, A.</span>, <span class="refAuthor">Uskov, E.</span>, <span class="refAuthor">Bush, R.</span>, <span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Snijders, J.</span>, and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"A Profile for Autonomous System Provider Authorization"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-sidrops-aspa-profile-06</span>, <time datetime="2021-07-30" class="refDate">30 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-sidrops-aspa-profile-06.txt">https://www.ietf.org/archive/id/draft-ietf-sidrops-aspa-profile-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1982">[RFC1982]</dt>
        <dd>
<span class="refAuthor">Elz, R.</span> and <span class="refAuthor">R. Bush</span>, <span class="refTitle">"Serial Number Arithmetic"</span>, <span class="seriesInfo">RFC 1982</span>, <span class="seriesInfo">DOI 10.17487/RFC1982</span>, <time datetime="1996-08" class="refDate">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1982">https://www.rfc-editor.org/info/rfc1982</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2385">[RFC2385]</dt>
        <dd>
<span class="refAuthor">Heffernan, A.</span>, <span class="refTitle">"Protection of BGP Sessions via the TCP MD5 Signature Option"</span>, <span class="seriesInfo">RFC 2385</span>, <span class="seriesInfo">DOI 10.17487/RFC2385</span>, <time datetime="1998-08" class="refDate">August 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2385">https://www.rfc-editor.org/info/rfc2385</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4252">[RFC4252]</dt>
        <dd>
<span class="refAuthor">Ylonen, T.</span> and <span class="refAuthor">C. Lonvick, Ed.</span>, <span class="refTitle">"The Secure Shell (SSH) Authentication Protocol"</span>, <span class="seriesInfo">RFC 4252</span>, <span class="seriesInfo">DOI 10.17487/RFC4252</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4252">https://www.rfc-editor.org/info/rfc4252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4301">[RFC4301]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span> and <span class="refAuthor">K. Seo</span>, <span class="refTitle">"Security Architecture for the Internet Protocol"</span>, <span class="seriesInfo">RFC 4301</span>, <span class="seriesInfo">DOI 10.17487/RFC4301</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4301">https://www.rfc-editor.org/info/rfc4301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5925">[RFC5925]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Mankin, A.</span>, and <span class="refAuthor">R. Bonica</span>, <span class="refTitle">"The TCP Authentication Option"</span>, <span class="seriesInfo">RFC 5925</span>, <span class="seriesInfo">DOI 10.17487/RFC5925</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5925">https://www.rfc-editor.org/info/rfc5925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5926">[RFC5926]</dt>
        <dd>
<span class="refAuthor">Lebovitz, G.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Cryptographic Algorithms for the TCP Authentication Option (TCP-AO)"</span>, <span class="seriesInfo">RFC 5926</span>, <span class="seriesInfo">DOI 10.17487/RFC5926</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5926">https://www.rfc-editor.org/info/rfc5926</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[RFC6125]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6487">[RFC6487]</dt>
        <dd>
<span class="refAuthor">Huston, G.</span>, <span class="refAuthor">Michaelson, G.</span>, and <span class="refAuthor">R. Loomans</span>, <span class="refTitle">"A Profile for X.509 PKIX Resource Certificates"</span>, <span class="seriesInfo">RFC 6487</span>, <span class="seriesInfo">DOI 10.17487/RFC6487</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6487">https://www.rfc-editor.org/info/rfc6487</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6810">[RFC6810]</dt>
        <dd>
<span class="refAuthor">Bush, R.</span> and <span class="refAuthor">R. Austein</span>, <span class="refTitle">"The Resource Public Key Infrastructure (RPKI) to Router Protocol"</span>, <span class="seriesInfo">RFC 6810</span>, <span class="seriesInfo">DOI 10.17487/RFC6810</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6810">https://www.rfc-editor.org/info/rfc6810</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6811">[RFC6811]</dt>
        <dd>
<span class="refAuthor">Mohapatra, P.</span>, <span class="refAuthor">Scudder, J.</span>, <span class="refAuthor">Ward, D.</span>, <span class="refAuthor">Bush, R.</span>, and <span class="refAuthor">R. Austein</span>, <span class="refTitle">"BGP Prefix Origin Validation"</span>, <span class="seriesInfo">RFC 6811</span>, <span class="seriesInfo">DOI 10.17487/RFC6811</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6811">https://www.rfc-editor.org/info/rfc6811</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8208">[RFC8208]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span> and <span class="refAuthor">O. Borchert</span>, <span class="refTitle">"BGPsec Algorithms, Key Formats, and Signature Formats"</span>, <span class="seriesInfo">RFC 8208</span>, <span class="seriesInfo">DOI 10.17487/RFC8208</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8208">https://www.rfc-editor.org/info/rfc8208</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8210">[RFC8210]</dt>
      <dd>
<span class="refAuthor">Bush, R.</span> and <span class="refAuthor">R. Austein</span>, <span class="refTitle">"The Resource Public Key Infrastructure (RPKI) to Router Protocol, Version 1"</span>, <span class="seriesInfo">RFC 8210</span>, <span class="seriesInfo">DOI 10.17487/RFC8210</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8210">https://www.rfc-editor.org/info/rfc8210</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-16.2">
        <h3 id="name-informative-references">
<a href="#section-16.2" class="section-number selfRef">16.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC1996">[RFC1996]</dt>
        <dd>
<span class="refAuthor">Vixie, P.</span>, <span class="refTitle">"A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)"</span>, <span class="seriesInfo">RFC 1996</span>, <span class="seriesInfo">DOI 10.17487/RFC1996</span>, <time datetime="1996-08" class="refDate">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1996">https://www.rfc-editor.org/info/rfc1996</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4808">[RFC4808]</dt>
        <dd>
<span class="refAuthor">Bellovin, S.</span>, <span class="refTitle">"Key Change Strategies for TCP-MD5"</span>, <span class="seriesInfo">RFC 4808</span>, <span class="seriesInfo">DOI 10.17487/RFC4808</span>, <time datetime="2007-03" class="refDate">March 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4808">https://www.rfc-editor.org/info/rfc4808</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5781">[RFC5781]</dt>
        <dd>
<span class="refAuthor">Weiler, S.</span>, <span class="refAuthor">Ward, D.</span>, and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"The rsync URI Scheme"</span>, <span class="seriesInfo">RFC 5781</span>, <span class="seriesInfo">DOI 10.17487/RFC5781</span>, <time datetime="2010-02" class="refDate">February 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5781">https://www.rfc-editor.org/info/rfc5781</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6480">[RFC6480]</dt>
        <dd>
<span class="refAuthor">Lepinski, M.</span> and <span class="refAuthor">S. Kent</span>, <span class="refTitle">"An Infrastructure to Support Secure Internet Routing"</span>, <span class="seriesInfo">RFC 6480</span>, <span class="seriesInfo">DOI 10.17487/RFC6480</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6480">https://www.rfc-editor.org/info/rfc6480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6481">[RFC6481]</dt>
      <dd>
<span class="refAuthor">Huston, G.</span>, <span class="refAuthor">Loomans, R.</span>, and <span class="refAuthor">G. Michaelson</span>, <span class="refTitle">"A Profile for Resource Certificate Repository Structure"</span>, <span class="seriesInfo">RFC 6481</span>, <span class="seriesInfo">DOI 10.17487/RFC6481</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6481">https://www.rfc-editor.org/info/rfc6481</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">
        The authors wish to thank Nils Bars, Steve Bellovin, Oliver
        Borchert, Tim Bruijnzeels, Rex Fernando, Richard Hansen, Martin
        Hoffmann, Paul Hoffman, Fabian Holler, Russ Housley, Pradosh
        Mohapatra, Keyur Patel, David Mandelberg, Sandy Murphy, Robert
        Raszuk, Andreas Reuter, Thomas Schmidt, John Scudder, Ruediger
        Volk, Matthias Waehlisch, and David Ward.  Particular thanks go
        to Hannes Gredler for showing us the dangers of unnecessary
        fields.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">
        No doubt this list is incomplete.  We apologize to any
        contributor whose name we missed.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Randy Bush</span></div>
<div dir="auto" class="left"><span class="org">IIJ, Arrcus, &amp; DRL</span></div>
<div dir="auto" class="left"><span class="street-address">5147 Crystal Springs</span></div>
<div dir="auto" class="left">
<span class="locality">Bainbridge Island</span>, <span class="region">Washington</span> <span class="postal-code">98110</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:randy@psg.com" class="email">randy@psg.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rob Austein</span></div>
<div dir="auto" class="left"><span class="org">Dragon Research Labs</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sra@hactrn.net" class="email">sra@hactrn.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
