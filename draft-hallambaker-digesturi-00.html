<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>The DIGEST URI Scheme</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Definitions">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Defined Terms">
<link href="#rfc.section.2" rel="Chapter" title="2 The DIGEST URI Type.">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 The DIGEST URI TYPE">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Use in binary formats.">
<link href="#rfc.section.3" rel="Chapter" title="3 Object Digest Value Specifier">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Example: CA Certificate A">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Example: Text File">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Integrity">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Confidentiality">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Weak Digest Algorithm">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="6 References">
<link href="#rfc.references.1" rel="Chapter" title="6.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="6.2 Non Normative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Example Certificates">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 CA Certificate A">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B ASN.1 Values (Non-Normative)">
<link href="#rfc.appendix.Appendix%20B.1" rel="Chapter" title="Appendix B.1 DER Sequence Encoding">
<link href="#rfc.appendix.Appendix%20B.2" rel="Chapter" title="Appendix B.2 Object Identifiers for Certificate Types">
<link href="#rfc.appendix.Appendix%20B.3" rel="Chapter" title="Appendix B.3 Object Identifiers for Digest Algorithms">
<link href="#rfc.appendix.Appendix%20B.4" rel="Chapter" title="Appendix B.4 DER Data Encoding Prefixes">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="A URI scheme for referencing static data abjects by means of a cryptographic digest mechanism is specified. The format is designed to resist content type substitution attacks and supports a choice of digest algorithms.  " />
  <meta name="description" content="A URI scheme for referencing static data abjects by means of a cryptographic digest mechanism is specified. The format is designed to resist content type substitution attacks and supports a choice of digest algorithms.  " />
  <meta name="keywords" content="Cryptography, URI" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">P. M. Hallam-Baker</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Comodo Group Inc.</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">R. N. Stradling</td>
</tr>
<tr>
<td class="left">Expires: March 30, 2012</td>
<td class="right">Comodo CA Ltd.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">September 27, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">The DIGEST URI Scheme<br />
  <span class="filename">draft-hallambaker-digesturi-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>A URI scheme for referencing static data abjects by means of a cryptographic digest mechanism is specified. The format is designed to resist content type substitution attacks and supports a choice of digest algorithms.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on March 30, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Definitions</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Defined Terms</a>
</li>
<li>2.   <a href="#rfc.section.2">The DIGEST URI Type.</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">The DIGEST URI TYPE</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Use in binary formats.</a>
</li>
<li>3.   <a href="#rfc.section.3">Object Digest Value Specifier</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Example: CA Certificate A</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Example: Text File</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Integrity</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Confidentiality</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Weak Digest Algorithm</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.references">References</a>
</li>
<li>6.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>6.2.   <a href="#rfc.references.2">Non Normative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Example Certificates</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">CA Certificate A</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">ASN.1 Values (Non-Normative)</a>
</li>
<li>Appendix B.1.   <a href="#rfc.appendix.Appendix%20B.1">DER Sequence Encoding</a>
</li>
<li>Appendix B.2.   <a href="#rfc.appendix.Appendix%20B.2">Object Identifiers for Certificate Types</a>
</li>
<li>Appendix B.3.   <a href="#rfc.appendix.Appendix%20B.3">Object Identifiers for Digest Algorithms</a>
</li>
<li>Appendix B.4.   <a href="#rfc.appendix.Appendix%20B.4">DER Data Encoding Prefixes</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Definitions</h1>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Defined Terms</h1>
<p id="rfc.section.1.2.p.1">The following terms are used in this document:</p>
<p></p>

<dl>
<dt>Abstract Syntax Notation One (ASN.1)</dt>
<dd style="margin-left: 8">A notation for describing abstract types and values, as specified in <a href="#X.680">X.680</a> <cite title="NONE">[X.680]</cite>.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> The DIGEST URI Type.</h1>
<p id="rfc.section.2.p.1">Provides a strong reference to a static data object.  </p>
<p id="rfc.section.2.p.2">Does not provide a means of resolution.  </p>
<p id="rfc.section.2.p.3">Allows an authenticated data source to provide an authenticated reference to a static data object.  </p>
<p id="rfc.section.2.p.4">Intended applications include creating references from </p>
<p></p>

<ul class="empty">
<li>Web pages delivered over HTTP/TLS </li>
<li>DNS resource records signed using DNSSEC </li>
<li>Data values embedded in certificates, CRLs, OCSP tokens and other signed data objects.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> The DIGEST URI TYPE</h1>
<p id="rfc.section.2.1.p.1">The DIGEST URI Type has the following format: </p>
<p id="rfc.section.2.1.p.2">DIGEST:&lt; Base64 (Object Digest Value Specifier) &gt; </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Use in binary formats.</h1>
<p id="rfc.section.2.2.p.1">The URI encoding of the Object Digest Value Specifier is compatible with ASCII encoding formats and MAY be used in any situation where a URI is specified.  </p>
<p id="rfc.section.2.2.p.2">In a binary format such as an ASN.1 signed object, a direct encoding of the data without the BASE64 encoding MAY be more convenient.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Object Digest Value Specifier</h1>
<p id="rfc.section.3.p.1">An Object Digest is an ASN.1 structure with three components: </p>
<p></p>

<ul class="empty">
<li>An ASN.1 Object Identifier specifying the object type of the referenced object</li>
<li>An ASN.1 Object Identifier specifying the digest algorithm.</li>
<li>Either: <ul class="empty">
<li>An ASCII MIME Content type specifier.</li>
<li>An ASN.1 <a href="#X.690">DER</a> <cite title="NONE">[X.690]</cite> encoded data field containing the digest value of the referenced object processed using the specified digest algorithm.  </li>
</ul>
<p> </p>
</li>
</ul>

<p> </p>
<p id="rfc.section.3.p.3">The ASN.1 structure is defined by the following schema: </p>
<div id="#rfc.figure.1"></div>
<pre>
DIGESTURI DEFINITIONS ::=

BEGIN

 ObjectDigestIdentifier ::= SEQUENCE {
   CHOICE {
     OIDtype        OBJECT IDENTIFIER,
     MIMEtype       IA5String
     }
   digestAlgorithm  OBJECT IDENTIFIER,
   digest           OCTET STRING
 }

END
        </pre>
<p id="rfc.section.3.p.4">The Object Digest Identifier construction is designed to facilitate implementation in applications that already require ASN.1 handling mechanisms (i.e. most cryptographic applications) without causing an undue coding burden in cases where ASN.1 code is not already supported.  Appendix C provides all the necessary information to create a fully compliant Object Digest Identifier implementation.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Example: CA Certificate A</h1>
<p id="rfc.section.3.1.p.1">The ODI of CA Certificate A (specified in Appendix B.1) is calculated as follows: </p>
<p></p>

<ul class="empty">
<li>ASN.1 Sequence tag: <samp>3032</samp> </li>
<li>ASN.1 OID id-at-cACertificate (2.5.4.37): <samp>0603550425</samp> </li>
<li>ASN.1 OID sha256 (2.16.840.1.101.3.4.2.1): <samp>0609608648016503040201</samp> </li>
<li>SHA-256 Digest Value: <samp>042017cc980f6a84fb15e5da3f32afea62360f4ca29627feed68739a13062defe804</samp> </li>
</ul>

<p> </p>
<p id="rfc.section.3.1.p.3">The DIGEST URI is DIGEST:MDIGA1UEJQYJYIZIAWUDBAIBBCAXzJgPaoT7FeXaPzKv6mI2D0yilif+7WhzmhMGLe/oBA==.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Example: Text File</h1>
<p id="rfc.section.3.2.p.1">The Digest URI of the text file "Hello World" is computed as follows: </p>
<p></p>

<ul class="empty">
<li>ASN.1 Sequence tag  <samp>3039</samp> </li>
<li>ASN.1 IA5String 'text/plain'  <samp>160A746578742f706c61696e</samp> </li>
<li>ASN.1 OID 'SHA-256' <samp>0609608648016503040201</samp> </li>
<li>SHA-256 Digest Value <samp>a591a6d40bf420404a011733cfb7b190d62c65bf0bcda32b57b277d9ad9f146e</samp> </li>
</ul>

<p> </p>
<p id="rfc.section.3.2.p.3">The DIGEST URI is DIGEST:MDkWCnRleHQvcGxhaW4GCWCGSAFlAwQCAaWRptQL9CBASgEXM8+3sZDWLGW/C82jK1eyd9mtnxRu.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Security Considerations</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Integrity</h1>
<p id="rfc.section.4.1.p.1">No secret information is required to generate a DIGEST URI. Therefore a DIGEST URI only provides a proof of integrity for the referenced object and the proof of integrity provided is only as good as the proof of integrity for the DIGEST URI value.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Confidentiality</h1>
<p id="rfc.section.4.2.p.1">Disclosure of a DIGEST URI value does not necessarily entail disclosure of the referenced object but may enable an attacker to determine the contents of the referenced object by reference to a search engine or other data repository.  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Weak Digest Algorithm</h1>
<p id="rfc.section.4.3.p.1">[The digest algorithm MUST be strong] </p>
<p id="rfc.section.4.3.p.2">[For most use cases collision resistance is a requirement] </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> IANA Considerations</h1>
<p id="rfc.section.5.p.1">[Assign the DIGEST URI type.] </p>
<h1 id="rfc.references">
<a href="#rfc.references">6.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">6.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4055">[RFC4055]</b></td>
<td class="top">
<a>Schaad, J.</a>, <a>Kaliski, B.</a> and <a>R. Housley</a>, "<a href="http://tools.ietf.org/html/rfc4055">Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 4055, June 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="X.509">[X.509]</b></td>
<td class="top">
<a>International Telecommunication Union </a>, "<a>ITU-T Recommendation X.509 (11/2008): Information technology - Open systems interconnection - The Directory: Public-key and attribute certificate frameworks </a>", ITU-T Recommendation X.509, November 2008.</td>
</tr>
<tr>
<td class="reference"><b id="X.680">[X.680]</b></td>
<td class="top">
<a>International Telecommunication Union </a>, "<a>ITU-T Recommendation X.680 (11/2008): Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation </a>", ITU-T Recommendation X.680, November 2008.</td>
</tr>
<tr>
<td class="reference"><b id="X.690">[X.690]</b></td>
<td class="top">
<a>International Telecommunication Union </a>, "<a>ITU-T Recommendation X.690 (11/2008): Information technology - Abstract Syntax Notation One (ASN.1): Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER) </a>", ITU-T Recommendation X.690, November 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">6.2.</a> Non Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3642">[RFC3642]</b></td>
<td class="top">
<a>Legg, S.</a>, "<a href="http://tools.ietf.org/html/rfc3642">Common Elements of Generic String Encoding Rules (GSER) Encodings</a>", RFC 3642, October 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="NIST-ALGS">[NIST-ALGS]</b></td>
<td class="top">
<a>National Institute of Standards and Technology </a>, "<a>Cryptographic Algorithm Registration</a>", March 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Example Certificates</h1>
<p id="rfc.section.Appendix A.p.1">The following certificates are used in the examples.  </p>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> CA Certificate A</h1>
<p id="rfc.section.Appendix A.1.p.1">CA Certificate A is a self signed certificate signed with a 2048 bit RSA key: </p>
<div id="#rfc.figure.2"></div>
<pre>
-----BEGIN CERTIFICATE-----
MIIDATCCAeugAwIBAgIBATALBgkqhkiG9w0BAQUwKDERMA8GA1UEChMIQWNtZSBJ
bmMxEzARBgNVBAMTCkV4YW1wbGUgQ0EwHhcNMTAxMTExMTgxMjAzWhcNMjAxMTA4
MTgxMjAzWjAoMREwDwYDVQQKEwhBY21lIEluYzETMBEGA1UEAxMKRXhhbXBsZSBD
QTCCAR8wCwYJKoZIhvcNAQEBA4IBDgAwggEJAoIBALHvos3yEe0ugR6Ae2rPATXA
pBYGK6BMzGTLkXCg6MZaG9CZpfleZTZ/EgIKBwRJlIXvWdKwjMZ7GBByT+fdMDZp
7zkx64UZ4+CJm98NRjdugxovl8HhscIBXnhCHERgamp0U/f8Ho5W8eAxYLZ1XcIG
mB7mVknvolaN9EqlEmYn+qHexGJPlpWFmR4NKhVAATE6B1a9z5PCmoOgW9p0Vqic
SJ6CdAHKaa7JZS+sqNQDx57H8Q6R9lh52XXmJVVficxBp2K7C+Wvht45t68FG6f1
sXWuWDRYc6iUmOxZbzDDvIoFU0pAXESTdMOWvXKI8ZUaYBoZ7/YnSSTaseiW86sC
AwEAAaM9MDswDgYDVR0PAQEBBAQDAgAEMA8GA1UdEwEBAQQFMAMBAQEwGAYDVR0g
BBEwDzANBgsrBgEEAYKUTYUaATALBgkqhkiG9w0BAQUDggEBAGcNiaQXdyiI9Y5e
Ps+XEYdKiWYvmSnRIfbUZuQWaQpPcj5cHzMe91CUZipGDNJYXwqWhIUtQAAGmtrq
ZGa4F9Yh0cPFAHBXPHXKGeM1hMtAR7Mv9kHu4DFIhb822O0n4DdBIit8FNas5t/5
CbM6crDpWB5hjAsD37U+GZGvTJmag059VWjnjv90NcfCQ6YJ6AA5VKnmrV695VnL
dSPaN9VS5RN6heJqU9tcbqPkAEP3MuJtd1QxB8Q34f9e1kTYXxc/dBJK1RQ0F4nc
Jc4NbJzakvFq+QcbzEqkhDMiXvjDV0JJt+GkFZrsREi6IgQY4DQHPv65OIvbr3uW
329dd+g=
-----END CERTIFICATE-----
          </pre>
<p id="rfc.section.Appendix A.1.p.2">In binary form, the certificate data is: </p>
<div id="#rfc.figure.3"></div>
<pre>
0000  30 82 03 01 30 82 01 eb  a0 03 02 01 02 02 01 01
0010  30 0b 06 09 2a 86 48 86  f7 0d 01 01 05 30 28 31
0020  11 30 0f 06 03 55 04 0a  13 08 41 63 6d 65 20 49
0030  6e 63 31 13 30 11 06 03  55 04 03 13 0a 45 78 61
0040  6d 70 6c 65 20 43 41 30  1e 17 0d 31 30 31 31 31
0050  31 31 38 31 32 30 33 5a  17 0d 32 30 31 31 30 38
0060  31 38 31 32 30 33 5a 30  28 31 11 30 0f 06 03 55
0070  04 0a 13 08 41 63 6d 65  20 49 6e 63 31 13 30 11
0080  06 03 55 04 03 13 0a 45  78 61 6d 70 6c 65 20 43
0090  41 30 82 01 1f 30 0b 06  09 2a 86 48 86 f7 0d 01
00a0  01 01 03 82 01 0e 00 30  82 01 09 02 82 01 00 b1
00b0  ef a2 cd f2 11 ed 2e 81  1e 80 7b 6a cf 01 35 c0
00c0  a4 16 06 2b a0 4c cc 64  cb 91 70 a0 e8 c6 5a 1b
00d0  d0 99 a5 f9 5e 65 36 7f  12 02 0a 07 04 49 94 85
00e0  ef 59 d2 b0 8c c6 7b 18  10 72 4f e7 dd 30 36 69
00f0  ef 39 31 eb 85 19 e3 e0  89 9b df 0d 46 37 6e 83
0100  1a 2f 97 c1 e1 b1 c2 01  5e 78 42 1c 44 60 6a 6a
0110  74 53 f7 fc 1e 8e 56 f1  e0 31 60 b6 75 5d c2 06
0120  98 1e e6 56 49 ef a2 56  8d f4 4a a5 12 66 27 fa
0130  a1 de c4 62 4f 96 95 85  99 1e 0d 2a 15 40 01 31
0140  3a 07 56 bd cf 93 c2 9a  83 a0 5b da 74 56 a8 9c
0150  48 9e 82 74 01 ca 69 ae  c9 65 2f ac a8 d4 03 c7
0160  9e c7 f1 0e 91 f6 58 79  d9 75 e6 25 55 5f 89 cc
0170  41 a7 62 bb 0b e5 af 86  de 39 b7 af 05 1b a7 f5
0180  b1 75 ae 58 34 58 73 a8  94 98 ec 59 6f 30 c3 bc
0190  8a 05 53 4a 40 5c 44 93  74 c3 96 bd 72 88 f1 95
01a0  1a 60 1a 19 ef f6 27 49  24 da b1 e8 96 f3 ab 02
01b0  03 01 00 01 a3 3d 30 3b  30 0e 06 03 55 1d 0f 01
01c0  01 01 04 04 03 02 00 04  30 0f 06 03 55 1d 13 01
01d0  01 01 04 05 30 03 01 01  01 30 18 06 03 55 1d 20
01e0  04 11 30 0f 30 0d 06 0b  2b 06 01 04 01 82 94 4d
01f0  85 1a 01 30 0b 06 09 2a  86 48 86 f7 0d 01 01 05
0200  03 82 01 01 00 67 0d 89  a4 17 77 28 88 f5 8e 5e
0210  3e cf 97 11 87 4a 89 66  2f 99 29 d1 21 f6 d4 66
0220  e4 16 69 0a 4f 72 3e 5c  1f 33 1e f7 50 94 66 2a
0230  46 0c d2 58 5f 0a 96 84  85 2d 40 00 06 9a da ea
0240  64 66 b8 17 d6 21 d1 c3  c5 00 70 57 3c 75 ca 19
0250  e3 35 84 cb 40 47 b3 2f  f6 41 ee e0 31 48 85 bf
0260  36 d8 ed 27 e0 37 41 22  2b 7c 14 d6 ac e6 df f9
0270  09 b3 3a 72 b0 e9 58 1e  61 8c 0b 03 df b5 3e 19
0280  91 af 4c 99 9a 83 4e 7d  55 68 e7 8e ff 74 35 c7
0290  c2 43 a6 09 e8 00 39 54  a9 e6 ad 5e bd e5 59 cb
02a0  75 23 da 37 d5 52 e5 13  7a 85 e2 6a 53 db 5c 6e
02b0  a3 e4 00 43 f7 32 e2 6d  77 54 31 07 c4 37 e1 ff
02c0  5e d6 44 d8 5f 17 3f 74  12 4a d5 14 34 17 89 dc
02d0  25 ce 0d 6c 9c da 92 f1  6a f9 07 1b cc 4a a4 84
02e0  33 22 5e f8 c3 57 42 49  b7 e1 a4 15 9a ec 44 48
02f0  ba 22 04 18 e0 34 07 3e  fe b9 38 8b db af 7b 96
0300  df 6f 5d 77 e8
          </pre>
<p id="rfc.section.Appendix A.1.p.3">The SHA-256 digest of the certificate data is: </p>
<div id="#rfc.figure.4"></div>
<pre>
17cc980f6a84fb15e5da3f32afea62360f4ca29627feed68739a13062defe804
          </pre>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> ASN.1 Values (Non-Normative)</h1>
<p id="rfc.section.Appendix B.p.1">Although the Object Digest Identifier form employs ASN.1 DER encoding only a small subset of ASN.1 features are used and a full ASN.1 stack is not necessary.  </p>
<p id="rfc.section.Appendix B.p.2">This appendix provides sufficient information to implement an Object Digest Identifier constructor or parser.  </p>
<h1 id="rfc.appendix.Appendix B.1">
<a href="#rfc.appendix.Appendix%20B.1">Appendix B.1.</a> DER Sequence Encoding</h1>
<p id="rfc.section.Appendix B.1.p.1">In DER encoding, the enclosing SEQUENCE will always be represented by the type identifier x30 followed by the length specifier. Since the total length of the following data fields will almost certainly be less than 127 bytes, the single byte encoding mechanism in which bit 7 is clear and the length value is encoded in the lower 7 bits will be required.  </p>
<h1 id="rfc.appendix.Appendix B.2">
<a href="#rfc.appendix.Appendix%20B.2">Appendix B.2.</a> Object Identifiers for Certificate Types</h1>
<p id="rfc.section.Appendix B.2.p.1">OIDs have been defined in connection with the X.500 directory for user certificates, certification authority certificates, revocations of certification authority, and revocations of user certificates.  The following table lists the OIDs, their DER encoding, and their type identifier and length-prefixed hex format for use in Object Digest Identifiers.  </p>
<div id="#rfc.figure.5"></div>
<pre>
id-at  OBJECT IDENTIFIER  ::=  { joint-iso-itu-t(2) ds(5) 4 }

id-at-userCertificate  OBJECT IDENTIFIER  ::=  { id-at 36 }    
                                                 -- 06 03 55 04 24
  id-at-cACertificate  OBJECT IDENTIFIER  ::=  { id-at 37 }    
                                                 -- 06 03 55 04 25
 TBS-PUBLIC-KEY-VALUE  OBJECT IDENTIFIER  ::=  { ??? }         
                                                 -- 06 xx xx xx xx
          </pre>
<h1 id="rfc.appendix.Appendix B.3">
<a href="#rfc.appendix.Appendix%20B.3">Appendix B.3.</a> Object Identifiers for Digest Algorithms</h1>
<p id="rfc.section.Appendix B.3.p.1">OIDs have been assigned by NIST for the SHA-2 digest algorithms <a href="#NIST-ALGS">[NIST-ALGS]</a> <a href="#RFC4055">[RFC4055]</a> Use of the SHA-1 digest algorithm is not recommended due to concerns for the security of the algorithm.  </p>
<div id="#rfc.figure.6"></div>
<pre>
hashAlgs  OBJECT IDENTIFIER  ::=  { joint-iso-itu-t(2) 
              country(16) us(840) organization(1) gov(101) csor(3) 
              nistAlgorithm(4) 2 }

id-sha256  OBJECT IDENTIFIER  ::=  { hashAlgs 1 }    
                                     -- 06 09 60 86 48 01 65 03 04 02 01
id-sha384  OBJECT IDENTIFIER  ::=  { hashAlgs 2 }    
                                     -- 06 09 60 86 48 01 65 03 04 02 02
id-sha512  OBJECT IDENTIFIER  ::=  { hashAlgs 3 }    
                                     -- 06 09 60 86 48 01 65 03 04 02 03
id-sha224  OBJECT IDENTIFIER  ::=  { hashAlgs 4 }    
                                     -- 06 09 60 86 48 01 65 03 04 02 04
          </pre>
<h1 id="rfc.appendix.Appendix B.4">
<a href="#rfc.appendix.Appendix%20B.4">Appendix B.4.</a> DER Data Encoding Prefixes</h1>
<p id="rfc.section.Appendix B.4.p.1">The rules of ASN.1 encoding state that every data value is preceded by a data type identifier and a length identifier. In the case of an Object Digest Identifier the data type identifier is always OCTET STRING (04) and the length for all currently defined digest algorithms will be less than 128 bytes (1024 bits) and thus use the single byte encoding form in which bit 7 is set to 0 and the lower 7 bits specify the length.  </p>
<p id="rfc.section.Appendix B.4.p.2">The length prefixes for commonly used digest lengths in hexadecimal notation are thus: </p>
<p></p>

<dl>
<dt>160 bits</dt>
<dd style="margin-left: 8">04 14</dd>
<dt>224 bits</dt>
<dd style="margin-left: 8">04 1C</dd>
<dt>256 bits</dt>
<dd style="margin-left: 8">04 20</dd>
<dt>384 bits</dt>
<dd style="margin-left: 8">04 30</dd>
<dt>512 bits</dt>
<dd style="margin-left: 8">04 40</dd>
</dl>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Phillip Hallam-Baker</span> 
	  <span class="n hidden">
		<span class="family-name">Hallam-Baker</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo Group Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:philliph@comodo.com">philliph@comodo.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Rob Stradling</span> 
	  <span class="n hidden">
		<span class="family-name">Stradling</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo CA Ltd.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:rob.stradling@comodo.com">rob.stradling@comodo.com</a></span>

  </address>
</div>

</body>
</html>