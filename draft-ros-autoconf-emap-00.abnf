message = <Type><Code><Length><TTL><Originator Address><P>
             {<specific message fields>}*

      Type

         Type of the message.  Currently this protocol only specifies
         EMAP_REQUEST and EMAP_REPLY messages.
      Code

         Indicates the configuration which is being performed (currently
         local, global and DNS servers auto-configuration).

      Length

         Size (in bytes) of the whole message.

      TTL

         Number of hops this packet can still take.

      Originator Address

         IP(v4/v6) address of the node that originated the information
         contained in this packet.  In the case of replies which have
         been proxied (P bit set to 1), this field contains the address
         of the node which originally provided the information (i.e.,
         not the proxy).  The receiver can gather the address of the
         proxy from the source field of the IP Datagram.

      P

         Proxy bit.  If set in a request, this flag indicates that
         receivers SHOULD act as proxies.  If not set they MUST NOT act
         as proxies.  If set in a reply, it means that this message has
         been generated by a proxy.

      Specific message fields

         Remaining fields corresponding to an specific EMAP message.

