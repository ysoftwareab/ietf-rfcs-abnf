<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Recommended Configuration and Use of DNS Redirect by Service Providers</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Recommended Configuration and Use of DNS Redirect by Service Providers">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Internet Engineering Task Force</td><td class="header">T. Creighton</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">C. Griffiths</td></tr>
<tr><td class="header">Intended status: BCP</td><td class="header">J. Livingood, Ed.</td></tr>
<tr><td class="header">Expires: January 7, 2010</td><td class="header">Comcast</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">R. Weber</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Unaffiliated</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 06, 2009</td></tr>
</table></td></tr></table>
<h1><br />Recommended Configuration and Use of DNS Redirect by Service Providers<br />draft-livingood-dns-redirect-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 7, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>The objective of this document is to describe the design of so-called DNS Redirect services deployed today by Internet Service Providers (ISPs), DNS Application Service Providers (ASPs), and other organizations providing so-called DNS Redirect services via their recursive DNS services, as well as to describe the recommended best current practices regarding such systems.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#ReqLang">1.</a>&nbsp;
Requirements Language<br />
<a href="#intro">2.</a>&nbsp;
Introduction<br />
<a href="#anchor1">3.</a>&nbsp;
Document Scope<br />
<a href="#anchor2">4.</a>&nbsp;
Terminology<br />
<a href="#anchor12">5.</a>&nbsp;
Major Types of DNS Redirect Services<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.1.</a>&nbsp;
Web Error Redirect<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#malware">5.2.</a>&nbsp;
Malicious Site Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mandated">5.3.</a>&nbsp;
Legally-Mandated DNS Redirect<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">5.4.</a>&nbsp;
Content-Based Redirect<br />
<a href="#options">6.</a>&nbsp;
Opt-In or Opt-Out Mechanisms<br />
<a href="#Practices to Avoid">7.</a>&nbsp;
Practices to Avoid<br />
<a href="#anchor36">8.</a>&nbsp;
Functional Design<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">8.1.</a>&nbsp;
DNS Recursive Resolver<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">8.2.</a>&nbsp;
Web Error Landing Server<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">8.3.</a>&nbsp;
Web Browser Client<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">8.4.</a>&nbsp;
Domain White List<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">8.5.</a>&nbsp;
Malicious Domain List<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">8.6.</a>&nbsp;
Legally-Mandated DNS Redirect Domain List<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">8.7.</a>&nbsp;
Content-Based DNS Redirect Domain List<br />
<a href="#anchor44">9.</a>&nbsp;
Example DNS and HTTP Flows<br />
<a href="#DNSSEC Considerations Section">10.</a>&nbsp;
DNSSEC Considerations<br />
<a href="#anchor51">11.</a>&nbsp;
Security Considerations<br />
<a href="#anchor52">12.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor53">13.</a>&nbsp;
Contributors<br />
<a href="#anchor54">14.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">15.</a>&nbsp;
Normative References<br />
<a href="#anchor56">Appendix&nbsp;A.</a>&nbsp;
Document Change Log<br />
<a href="#anchor57">Appendix&nbsp;B.</a>&nbsp;
Open Issues<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="ReqLang"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>Internet users typically are provided with several IP addresses for recursive DNS servers, as described in Section 2.3 of <a class='info' href='#RFC1591'>[RFC1591]<span> (</span><span class='info'>Postel, J., &ldquo;Domain Name System Structure and Delegation,&rdquo; March&nbsp;1994.</span><span>)</span></a>, by their respective ISPs, typically in an automated fashion via DHCP <a class='info' href='#RFC2131'>[RFC2131]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a>.  Some other users and organizations choose to use a different set of IP address for their DNS servers, which are hosted and managed by another organization, such as a DNS ASP.  It is also the case that a number of users and organizations choose to operate their own DNS servers, though those use cases are outside of the scope of this document.
</p>
<p>ISPs and DNS ASPs have discovered over time that their users would benefit via &quot enhanced &quot DNS services, which often rely upon DNS Redirect functionality.  These enhanced services, which are offered on an opt-in or opt-out basis (with the exception of where legal mandates preclude this), can perform a number of value added services for users, such as attempting to interpret web address errors and protecting users from reaching domains or fully qualified domain names (FQDNs, Section 5.1 of <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>) that would cause a user to inadvertently access malware.
</p>
<p>There are a number of ways such services should and should not work.  As a result, a document describing the best current practices in this area is beneficial to the community, and this is the motivation for this document.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Document Scope</h3>

<p>This document focuses on the practices of ISPs and DNS ASPs.  All other use cases, such as when an Internet user or organization chooses to operate their own DNS servers is outside of the scope of this document.
</p>
<p>In addition, there are several ways that such entities can provide users with these enhanced services, such as web error redirect services and malicious domain protection services.  In addition to methods which rely primarily upon a recursive DNS server, alternate methods include (a) interception and replacement of the error by a web browser client software, (b) interception and replacement of the error by a tool bar, plug-in, personal firewall security software or other web browser client add-on.  These alternate methods, which rely upon various types of client software, are also outside of the scope of this document.
</p>
<p>It is important to note that while these alternate methods are considered out of scope for this document, this should not be interpreted as a negative judgment of their suitability or applicability to the relevant problem space.  Instead, these should simply be considered as alternate methods since, as with most any technical problem, there are a variety of valid methods for solving a problem.
</p>
<p>While the <a class='info' href='#malware'>Section&nbsp;5.2<span> (</span><span class='info'>Malicious Site Protection</span><span>)</span></a> section indicates that users must be able to opt into or out of DNS Redirect services, the reasons for why an ISP or DNS ASP may choose one or the other as the default are out of scope.
</p>
<p>Lastly, in the <a class='info' href='#malware'>Section&nbsp;5.2<span> (</span><span class='info'>Malicious Site Protection</span><span>)</span></a> section of this document, the method by which FQDNs, domains, and/or sites are added or removed from malware lists is outside the scope of this document.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Terminology</h3>

<p>While these terms are generally well known, it is important to define them in the context of this document.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Internet Service Provider (ISP)</h3>

<p>An Internet Service Provider, which provides Internet services, including basic network connectivity.  It is not germane to this document what the method of connection is, such as wired or wireless, what the speed of such a connection is, and what other services are included or available to users.  It is, however, assumed that the ISP is providing recursive DNS services to their users and is in some manner providing users with the IP addresses of these DNS servers, whether via DHCP, static assignment by users, or some other method.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
DNS Application Service Provider (ASP)</h3>

<p>A DNS Application Service Provider, which provides managed and/or hosted recursive DNS services (and possibly other DNS services) to their users.  In the case of managed services, the DNS ASP may remotely manage the recursive DNS servers in a user's network.  For a hosted recursive DNS service, these servers are typically located outside of the user's network and these hosted resources are shared across multiple users.  In most instances, these are hosted services and users are manually configuring either their DHCP server or their individual computing devices with the IP addresses of the recursive DNS servers operated by their ASP.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Internet User</h3>

<p>An Internet user, which is generally a person using a computing device to connect to and make use of the Internet.  Such users are typically connected at the edge of the network, though the method by which they connect to the Internet is not particularly relevant to this document.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
DNS Recursive Resolver</h3>

<p>A DNS recursive resolver processes fully qualified domain name queries (FQDN, Section 5.1 of <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>) into IP addresses by finding the resource records in the authoritative DNS servers for the domain associated with the FQDN.  The resource records are then cached on the recursive server for future requests until an expiration timer expires called time to live (TTL), as described in Section 5.2 of <a class='info' href='#RFC2181'>[RFC2181]<span> (</span><span class='info'>Elz, R. and R. Bush, &ldquo;Clarifications to the DNS Specification,&rdquo; July&nbsp;1997.</span><span>)</span></a>.  These servers are in most cases provide by ISPs for name resolution.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Web Browser</h3>

<p>Client software operated by the user locally on their computing device, such as Microsoft Internet Explorer, Mozilla Firefox, Apple Safari, Google Chrome, etc.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Web Error Landing Server</h3>

<p>The host that a user is directed to when the DNS Recursive Server receives a NXDOMAIN response.  The contents of the web page that the web server sends the user varies widely across different ISPs and DNS ASPs. In some cases it is simply a more descriptive error that the user would otherwise receive, while in other cases it may include links to sites similar to the URL attempted and/or a search page, among many other possibilities.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
Malicious Domain Web Error Landing Server</h3>

<p>The web server that a user's web browser is directed to when the DNS Recursive Server matches a DNS query to a malicious domain or FQDN.  The contents of the web page that the web server sends the user varies widely across different ISPs and DNS ASPs. In most cases it simply explains that the attempted URL contains malware and that access has been prevented, though there are many other possibilities.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.8"></a><h3>4.8.&nbsp;
User Options Web Server</h3>

<p>The web server that a user is directed to via a link on a page served by the Web Error Landing Server, the Malicious Domain Web Error Landing Server, from another system such as an account management system, or via direct access, which enables a user to control whether or not they are opted into or opted out of DNS Redirect services.  This is described in additional detail in the <a class='info' href='#options'>Section&nbsp;6<span> (</span><span class='info'>Opt-In or Opt-Out Mechanisms</span><span>)</span></a> section.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.9"></a><h3>4.9.&nbsp;
NXDOMAIN Response</h3>

<p>In this document, an NXDOMAIN (nonexistent domain) response can be used interchangeably with an RCODE 3 response.  The RCODE 3 response was first documented in see Section 4.1.1 of <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>).  Subsequent RFCs introduced the term NXDOMAIN response, which is synonymous with RCODE 3 and tends to be used more frequently, as noted in Section 2.2 of <a class='info' href='#RFC2136'>[RFC2136]<span> (</span><span class='info'>Vixie, P., Thomson, S., Rekhter, Y., and J. Bound, &ldquo;Dynamic Updates in the Domain Name System (DNS UPDATE),&rdquo; April&nbsp;1997.</span><span>)</span></a>, Section 1 of <a class='info' href='#RFC2308'>[RFC2308]<span> (</span><span class='info'>Andrews, M., &ldquo;Negative Caching of DNS Queries (DNS NCACHE),&rdquo; March&nbsp;1998.</span><span>)</span></a>, and Section 5.4 of <a class='info' href='#RFC2535'>[RFC2535]<span> (</span><span class='info'>Eastlake, D., &ldquo;Domain Name System Security Extensions,&rdquo; March&nbsp;1999.</span><span>)</span></a>.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Major Types of DNS Redirect Services</h3>

<p>DNS Redirect services can be classified into several major categories, as follows below.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Web Error Redirect</h3>

<p>A web error redirect service enables an ISP or ASP to provide a user, who is generally utilizing a web browser, with an improved user experience when an attempt to reach a nonexistent domain is made.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Web Error Redirect Problem Statement</h3>

<p>A user enters an incorrect URL into their web browser, such as http://www.example.invalid, where .invalid is a nonexistent Top Level Domain (TLD, see Section 2 of <a class='info' href='#RFC1591'>[RFC1591]<span> (</span><span class='info'>Postel, J., &ldquo;Domain Name System Structure and Delegation,&rdquo; March&nbsp;1994.</span><span>)</span></a>).  In such a case, a user would typically receive an error.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
Web Error Redirect Solution Description</h3>

<p>When a recursive DNS server detects such a nonexistent domain error (NXDOMAIN, see Section 4.1.1 of <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a>), the ISP or ASP can instead provide a IP address for a Web Error Landing Server that can present the user with a list of suggested destinations rather than simply an error page.  This page must also provide the user with a link to a method of opting out in the future.  See <a class='info' href='#DNS Redirect Response'>Figure&nbsp;1<span> (</span><span class='info'>DNS Redirect Response</span><span>)</span></a>, <a class='info' href='#Web Error Landing Server'>Figure&nbsp;2<span> (</span><span class='info'>Web Error Landing Server</span><span>)</span></a>, and <a class='info' href='#DNS Redirect and HTTP Flow'>Figure&nbsp;8<span> (</span><span class='info'>DNS Redirect and HTTP Flow</span><span>)</span></a> for examples below.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
Web Error Redirect Solution Considerations</h3>

<p>It is important to note that this technology can directly impact non-web clients such as instant messaging, VPNs, FTP, email filters-related DNS queries. Thus, special exclusions may need to be made in order to prevent unintentional side effects. Design considerations for the Web Error Search and Malicious Site Protection services should include properly and promptly terminating non-HTTP connection requests. Only A and AAAA resource records should be redirected, all other resource record types must be answered as if there was no redirection.
</p>
<a name="malware"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Malicious Site Protection</h3>

<p>Malware websites have proliferated recently, making malware and bot networks a major problem for users.  In many cases, the initial contact with a virus or malware occurs when an unsuspecting user visits a particular website.  This has even been observed to occur when a user visits an otherwise legitimate website, which contains external references that happen to contain malware, for example (such as advertisements served by a third party).  Many organizations maintain lists of domains and FQDNs which host malware.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Malicious Site Protection Problem Statement</h3>

<p>A user, malware agent, or bot requests a URL www.example.net or domain example.net.  This site is associated with distributing malware or some other malicious activity that would not be desired by the user.  The correct IP address is returned by the DNS and the user accesses the malware site or domain and their computer is infected with a bot.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Malicious Site Protection Solution Description</h3>

<p>By using Malicious Site Protection, a user may have their DNS response redirected from the IP address for the malicious URL www.example.net or domain example.net to a safe website that explains why the user was redirected.  Importantly, the application attempting to access a malicious resource may or may not be a web browser and, further, may be operating without the user's knowledge and/or permission.  This page on the aforementioned safe website that the user is directed to may also provide the user with a link to a method of opting out in the future. See <a class='info' href='#Malicious Domain Response'>Figure&nbsp;3<span> (</span><span class='info'>Malicious Domain Response</span><span>)</span></a> and <a class='info' href='#Malicious Site Redirect and HTTP Flow'>Figure&nbsp;9<span> (</span><span class='info'>Malicious Site Redirect and HTTP Flow</span><span>)</span></a> for examples below.  There may also be limited cases where it could be harmful to the objective of Malicious Site Protection to redirect the user to a safe website, in which case the user may not be directed to any resource, and a NXDOMAIN response be provided.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.3"></a><h3>5.2.3.&nbsp;
Malicious Site Protection Solution Considerations</h3>

<p>It is important to note that this technology can directly impact non-web clients such as instant messaging, VPNs, FTP, email filters-related DNS queries. Thus, special exclusions may need to be made in order to prevent unintentional side effects. Design considerations for the Web Error Search and Malicious Site Protection services should include properly and promptly terminating non-HTTP connection requests. A range of resource records may be redirected, such as A, AAAA, MX, SRV, and NAPTR records, in order to fulfill the objective of preventing access to certain network elements containing malicious content or which and in some way used to transmit, relay, or otherwise transfer malicious content.  All other resource record types must be answered as if there was no redirection.
</p>
<p>Malicious domain protection is also only effective if a user is actually using the DNS IP addresses that have this functionality.  Thus, should a user's computer become compromised with some type of bot or virus that changes their DNS IP addresses (typically without their knowledge), the malicious domain protection would have no effect since the user is now pointed to DNS servers which are presumably in the control of a third party with malicious intentions.
</p>
<a name="mandated"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Legally-Mandated DNS Redirect</h3>

<p>A regulatory organization or other entities with law enforcement authority over ISP businesses may in some cases mandate or otherwise compel ISPs and/or DNS ASPs to perform DNS Redirection for specific sites. For example, local laws may compel an ISP and/or DNS ASP to attempt to protect/prevent users from viewing illegal content via a mandate to redirect or block specific sites and/or domains.  However, it is out of the scope of this document to address the suitability of DNS Redirect for this problem, how this may or may not affect user rights/freedoms in various jurisdictions, problematic judgment areas which may exist relating to management of applicable site lists, unintended side effects of legally-mandated lists, etc.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
Legally-Mandated DNS Redirect Problem Statement</h3>

<p>Governments, whether via regulatory or law enforcement bodies, as well as courts, sometimes require ISPs and/or DNS ASPs to block access to certain sites or domains.  In some cases, these entities will provide a site (FQDN) and/or domain list to the ISP and/or DNS ASP, and compel the ISP and/or DNS ASP to prevent access to these sites and/or domains via the DNS.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
Legally-Mandated DNS Redirect Solution Description</h3>

<p>By using legally-mandated domain redirection, a user may have their DNS response redirected from the IP address for the URL www.illegalcontent.example.net or domain illegalcontent.example to a "safe" website that may explain why the user was redirected. See <a class='info' href='#Legally-Mandated DNS Redirect Domain Response'>Figure&nbsp;4<span> (</span><span class='info'>Legally-Mandated DNS Redirect Domain Response</span><span>)</span></a> and <a class='info' href='#Legally-Mandated Redirect and HTTP Flow'>Figure&nbsp;10<span> (</span><span class='info'>Legally-Mandated Redirect and HTTP Flow</span><span>)</span></a> for examples below.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.3"></a><h3>5.3.3.&nbsp;
Legally-Mandated DNS Redirect Solution Considerations</h3>

<p>It is important to note that these governmental and/or law enforcement actions are frequently quite controversial in a given jurisdiction, and also that there are many examples where lists have inadvertently blocked legal content and therefore improperly blocked the freedom of access to legitimate and legal content. A range of resource records may be redirected, such as A, AAAA, SRV, and NAPTR records, in order to fulfill particular legal mandates. All other resource record types must be answered as if there was no redirection.
</p>
<p>Depending upon government, law enforcement, and/or court-related mandates/laws/rules, an ISP and/or DNS ASP performing Legally-Mandated DNS Redirect may not provide an opt-out capability, and in some jurisdictions they must not provide an opt-out capability.  ISPs should disclose openly that they have been compelled to perform legally-mandated DNS Redirect, provided that such disclosure has not been prohibited for some reason by any relevant regulator, court, or law enforcement organization.  For example, a page which may be served in response to redirection should be a location at which such a disclosure is made, in addition to the relevant sections of network policy documents, etc.
</p>
<p>In some cases where the such Legally-Mandated DNS Redirect is required, there may be hosts with a mix of legal and illegal/restricted content such that the redirect will not be to an error page but will be instead to a proxy server, which will be capable of performing a more fine-grained content analysis.  The manner in which such functionality might work is outside the scope of this document.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Content-Based Redirect</h3>

<p>Content-Based Redirect is similar to content filtering, except that it is more aptly "content avoidance."  To explain this difference more fully, no content is actually filtered by an ISP or DNS ASP system before it is sent to the user.  Instead, DNS responses can be modified in order that a user is protected from content which they deemed inappropriate.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.1"></a><h3>5.4.1.&nbsp;
Content-Based Redirect Problem Statement</h3>

<p>A user wishes to avoid visiting web sites with certain types of content.  For example, the user may have children in their household and wished to prevent access to adult-themed content.  Other examples of the type of content that the user may wish to prevent access to may include categories such as illicit drugs, alcohol, hate speech, and weapons, among many other potential categories.  The user in this case may not exclusively be a residential user, but may also be the network administrator for a small business, school, church, or other organization.  Thus, there may be a wide range of motivations for the desire to prevent access to certain types of content.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.2"></a><h3>5.4.2.&nbsp;
Content-Based Redirect Solution Description</h3>

<p>By using Content-Based Redirect, a user may have their DNS response redirected from the IP address for the inappropriate URL www.inappropriate.example.com to a safe website that explains why the user was redirected.  This page may also provide the user with a link to a method of reconfiguring the service, in case it has unexpected results and a site that the user wishes to access has been blocked.  In addition, the user should be able to fully configure Content-Based Redirect via the User Options Web Server, such as electing which categories of content they may wish to prevent access to.  See <a class='info' href='#Content-Based Redirect Domain Response'>Figure&nbsp;5<span> (</span><span class='info'>Content-Based Redirect Domain Response</span><span>)</span></a> and <a class='info' href='#Content-Based Redirect and HTTP Flow'>Figure&nbsp;11<span> (</span><span class='info'>Content-Based Redirect and HTTP Flow</span><span>)</span></a> for examples below.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Content-Based Redirect Solution Considerations</h3>

<p>A range of resource records may be redirected, such as A, AAAA, SRV, and NAPTR records, in order to fulfill the user-directed objective of preventing access to certain types of content.  All other resource record types must be answered as if there was no redirection.
</p>
<a name="options"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Opt-In or Opt-Out Mechanisms</h3>

<p>ISPs and DNS ASPs must provide their users with a method to opt into (opt-in) or out (opt-out) of some or all DNS Redirect services.  Opt-out and opt-in methods should be reliable and should take into consideration the <a class='info' href='#Practices to Avoid'>Section&nbsp;7<span> (</span><span class='info'>Practices to Avoid</span><span>)</span></a> section below.  Whether such services are offered on an opt-in or opt-out basis depends on a range of factors which are outside of the scope of this document.  The two different methods, opt-out and opt-in, are described below.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Opt-Out</h3>

<p>Opt-Out is used when the users are by default offered all or some DNS Redirect services.  As a result, the user must take an action to disable some or all such services.  This is typically performed via a User Options Web Server.  Users that have chosen to opt-out should receive DNS responses which are indistinguishable from those responses provided by a DNS server with no DNS Redirect functionality.  In addition, opt-out should be persistent in nature, which means that opt-out should be tied to a fixed credential or attribute of some type, such as an account identifier, billing identifier, or equipment identifier, which is not typically subject to change on a regular basis.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Opt-In</h3>

<p>Opt-In is used when the users are by default not offered any DNS Redirect services.  As a result, the user must take an action to enable some or all such services.  This is typically performed via a User Options Web Server.
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Automated Mechanisms and Reasonable Processing Times</h3>

<p>Once a user has selected to opt-in or opt-out of DNS Redirect services, such changes should occur automatically, when this is technically possible, without requiring the user to manually change any settings on their computing device.  Such changes should also occur within a reasonable period of time.  In some cases, however, a user may be offered the ability to speed the period of time for these changes to take effect, such as by restarting the computing device or a piece of network equipment which connects them to their ISP's network, for example.
</p>
<p>While an automated mechanism may be the easiest for users, since it requires no manual reconfiguration of their network settings, the authors also recognize that there may be extenuating circumstances where this is not achievable.  In such cases, which may for example be due to the particular attributes of one or another ISP's network design, a fully automated mechanism may not be possible.  Another example is where a user is switching from their ISP's DNS server IP addresses to those of a DNS ASP.  As a result, a user in all of these cases, as well as other possible cases, must manually reconfigure their network with different DNS IP addresses.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Type of Opt-Out Method</h3>

<p>There are several workable methods that can be employed to effect the actual opt-out for a given user.  These include setting a local user application attribute, such as via a cookie in a web browser, as well as setting a network attribute, via a DHCP change or manually configuring the DNS IP addresses (in the operating system, modem, home gateway device, or router) in order to change the DNS IP addresses for a particular user.
</p>
<p>While all of these methods are workable and can be made reliable, the best current method is via a network-based change of some sort.  In this way, all Internet-connected computing devices within a given household are included in the opt-out (these devices are generally connected in some manner to the LAN side of some type of customer premise device, such as a cable modem or DSL modem).  This is in contrast to a method which uses a local user application attribute, such as a cookie in a web browser, where deletion of cookies, upgrade to a new operating system, upgrade to a new web browser, use of a different web browser, or countless other factors on that device could cause the user to be opted back into a DNS Redirect service.  Thus, a network-based approach which sets opt-out-related attributes at the device, or household level, is the most inclusive and persistent method for providing a reliable opt-out method, and is the recommended practice.
</p>
<a name="Practices to Avoid"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Practices to Avoid</h3>

<p>This document primarily focuses on the best current practices for an ISP or ASP to provide users with DNS Redirect services.  However, it is important to note that some entities may not operate in accordance with such practices.  As such, some of these are cataloged below in order to contrast them with best practices and provide information which may be of interest and use to the community.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Improper Redirect of Valid Responses</h3>

<p>It has been observed that some service providers improperly utilize DNS Redirect services when there is a valid DNS resource record returned in response to a DNS recursive query.  The effect is to redirect users to a server not maintained by the intended destination, such as a web site that looks like the intended web site but is not actually the intended site and is instead controlled by the service provider. For example a DNS query for www.example.com results in a valid A record response, but this valid response is instead replaced with an A record controlled by the service provider.  In this case the intended server identified with the valid A record contained valid, lawful, non-malicious content, and there would otherwise appear to be no valid justification for a redirect to occur. See <a class='info' href='#Improper Redirect of Valid Response Redirect and HTTP Flow'>Figure&nbsp;12<span> (</span><span class='info'>Improper Redirect of Valid Response Redirect and HTTP Flow</span><span>)</span></a> for an example below.
</p>
<p>If there is a valid and reasonable justification for such a redirect to occur, examples of which are not currently known by the authors of this document, then the resulting connection to the server that the user has been redirected to should clearly and prominently disclose that this is not the intended site.  For example, in the case of an attempt by a user to connect to a web site, the site may contain a banner or frame which indicates that this is not the intended site or that the site is in some manner controlled by the service provider.  In addition, such a notice should also offer a clear method to opt-out of this redirect function.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Redirect of SERVFAIL Responses</h3>

<p>Redirection of SERVFAIL responses should not occur. SERVFAIL responses may occur intermittently in an operational network for a variety of highly transient reasons.  As a result, a DNS Redirect should not be performed when a SERVFAIL response is received, as normal retry a short time later is likely to result in a valid response.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Routinely Broken, Purposefully Broken, and Otherwise Unreliable Opt-Out Mechanisms</h3>

<p>There are several well known and dependable methods of opt-out mechanisms that ISPs and DNS ASPs can deploy for users to opt-out of their DNS Redirect services.  These methods can rather easily be employed and are highly recommended, as noted in <a class='info' href='#options'>Section&nbsp;6<span> (</span><span class='info'>Opt-In or Opt-Out Mechanisms</span><span>)</span></a>.  However, some ISPs and DNS ASPs may instead choose to employ a less dependable mechanism, which routinely fails to work as expected by users or is known not to function properly.
</p>
<p>For example, one routinely unreliable method for opt-out is the cookie-based method.  When a user opts out of a DNS Redirect service, a cookie is installed in their web browser.  The problem with this method occurs when a user clears their cookies or the cookies are deleted for some reason.  In some cases, users may configure their web browsers to clear all cookies every time the close their web browser.  Thus, one possible effect upon the user in this case is that they are once again opted into the redirect service.  Furthermore, a cookie-based method has the effect of only opting out browser-based protocols (generally HTTP and HTTPS), which means that the user may have non-web applications affected by DNS Redirect, even though they believe they have opted-out.  As a result, there is no assured permanency with this opt-out method, nor does it work consistently across all applications and protocols, which can be aggravating to users who do not wish to utilize DNS Redirect services.
</p>
<p>Another example of an unreliable method for opt-out is one where opt-out is tied to the IP address of the user, where that address may be subject to change on a regular basis, such as via an ISP-based DHCP lease.  In such a case, if opt-out was tied to what can be considered a largely dynamic IP address, then the user would be opted-in every time they received a new IP address, forcing them to repeatedly opt-out.
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Markedly Slower DNS Query Performance</h3>

<p>An ISP or DNS ASP should also understand that DNS query latency, the time between when a user's stub resolver issues and DNS query and receives a DNS response, should be kept as low as is reasonably possible.  High DNS query latency is often perceived by users, and can have an adverse effect on a variety of applications where low DNS query latency may be especially important.  Any additional processing which must be performed in order to provide DNS Redirect services should be monitored closely, in order that DNS Redirect functionality does not markedly slow DNS query performance.
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
Override of a User&#039;s DNS Selection</h3>

<p>Some users may decide to use the DNS server IP addresses of a DNS ASP or other non-ISP-provided DNS servers.  Such selections should be preserved as the free choice of a user, particularly when DNS Redirect services are offered.  Thus, an ISP should not redirect port 53 DNS traffic from servers intended by the user via their selection of non-ISP DNS servers to the DNS servers of the ISP, except in reasonable and justifiable cases where a user has been placed into a so-called "walled garden" for reasons of abuse, security compromise, account non-payment, new service activation, etc.
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Functional Design</h3>

<p>The functional design described in this section is intended to be generally representative of the many different ways that DNS Redirect services are deployed today.  As such, they are necessarily high level and different implementations may vary somewhat, due to any number of factors.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
DNS Recursive Resolver</h3>

<p>The DNS Recursive Resolver is used by the host computer to translate fully qualified domain names into IP addresses, according to Section 3.6.1 of <a class='info' href='#RFC1034'>[RFC1034]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a>.  When a FQDN does not exist in authoritative DNS a NXDOMAIN response, as described in Section 4.1.1 of <a class='info' href='#RFC1035'>[RFC1035]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - implementation and specification,&rdquo; November&nbsp;1987.</span><span>)</span></a> is normally returned (see <a class='info' href='#DNS Redirect Response'>Figure&nbsp;1<span> (</span><span class='info'>DNS Redirect Response</span><span>)</span></a>).  In the case of DNS Redirect, the NXDOMAIN response is changed to reply with a resource record (RR) response which instructs the host computer to send the original request to a new IP address (see <a class='info' href='#DNS Redirect Response'>Figure&nbsp;1<span> (</span><span class='info'>DNS Redirect Response</span><span>)</span></a>).
</p><br /><hr class="insert" />
<a name="DNS Redirect Response"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                Request                  Request
         www.example.invalid  	   www.example.invalid
                           +--------+                +--------+
    ++--++   ------------&gt; |        |  ------------&gt; |        |
    ||  ||                 |        |                |        |
  +-++--++-+               |        |                |        |
  +--------+ &lt;------------ |        |  &lt;------------ |        |
     Host      NXDOMAIN    +--------+    NXDOMAIN    +--------+
   Computer    Response     Recursive    Response    Authoritative
                             Server                    Server


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: DNS Redirect Response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Web Error Landing Server</h3>

<p>When a user requests an invalid URL or Domain, their web client is redirected to a Web Error Landing Server which presents several possible helpful website views (see <a class='info' href='#Web Error Landing Server'>Figure&nbsp;2<span> (</span><span class='info'>Web Error Landing Server</span><span>)</span></a>).  The first is "Did you mean..." response which presents the user with possible correct results based on their original invalid request.  The search server can also present search engine results to the user.
</p><br /><hr class="insert" />
<a name="Web Error Landing Server"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

               Request                      Request
         www.example.invalid          www.example.invalid
                             +--------+                 +--------+
   ++--++   ---------------&gt; |        | ---------------&gt;|        |
   ||  ||                    |        |                 |        |
 +-++--++-+                  |        |                 |        |
 +--------+ &lt;--------------  |        | &lt;-------------  |        |
    Host       Redirect      +--------+    NXDOMAIN     +--------+
  Computer    IP Address      Recursive    Response     Authoritative
                               Server                     Server
     |
     |                              ___________________________________
     |         +--------+          |  Web Response:                   |
     |         |        |          |  "Did you mean...www.example.com"|
     +------&gt;  |        | ------&gt;  |__________________________________|
               |        |          |  Search result:  #1              |
               |        |          |  Search result:  #2              |
               +--------+          |__________________________________|
               Web Server
              Landing Page

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Web Error Landing Server&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Web Browser Client</h3>

<p>The Web Browser Client is redirected to a Web Server Landing Page instead of presenting an error page when there is no valid DNS record present.
</p>
<p>Examples of common Web Browser Clients include:
            		</p>
<ul class="text">
<li>Microsoft Internet Explorer
</li>
<li>Mozilla Firefox
</li>
<li>Apple Safari
</li>
<li>Google Chrome
</li>
<li>Opera
</li>
</ul><p>
            		
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Domain White List</h3>

<p>There may be certain domains which should be not be redirected under any circumstances for legal, business, or other reasons.  The Domain White List can contain both domains, such as *.example.com, as well as specific FQDNs, such as www.example.com.  For instance, the owner of example.com may request that the ISP or DNS ASP not perform DNS Redirect for the example.com domain, so that there is no DNS Redirect resulting from queries to nonexistent names, such as invalid.example.com.
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.5"></a><h3>8.5.&nbsp;
Malicious Domain List</h3>

<p>Using a Malicious Domain List, a DNS server can redirect DNS requests that were intended for malicious websites or domains to a web server landing page (see <a class='info' href='#Malicious Domain Response'>Figure&nbsp;3<span> (</span><span class='info'>Malicious Domain Response</span><span>)</span></a>).  The Malicious Domain List can contain both domains, such as *.example.net, as well as specific FQDNs, such as www.example.net.
</p><br /><hr class="insert" />
<a name="Malicious Domain Response"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

               Request                      Request
            www.example.net             www.example.net
                             +--------+                 +--------+
   ++--++   ---------------&gt; |        | ---------------&gt;|        |
   ||  ||                    |        |                 |        |
 +-++--++-+                  |        |                 |        |
 +--------+ &lt;--------------  |        | &lt;-------------  |        |
    Host       Redirect      +--------+    Response     +--------+
  Computer    IP Address      Recursive   IP Address   Authoritative
                               Server                     Server
     |
     |                               ___________________________________
     |          +--------+          |  Web Response:                   |
     |          |        |          |  "Malware software alert!"       |
     +-------&gt;  |        | ------&gt;  |__________________________________|
                |        |          | The site you attempted to access |
                |        |          |  is known to host malware that   |
                +--------+          |   could damage your computer.    |
                Web Server          |__________________________________|
               Landing Page

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Malicious Domain Response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.6"></a><h3>8.6.&nbsp;
Legally-Mandated DNS Redirect Domain List</h3>

<p>Using a Malicious Domain List, a DNS server can redirect DNS requests that were intended for malicious websites or domains to a web server landing page (see <a class='info' href='#Malicious Domain Response'>Figure&nbsp;3<span> (</span><span class='info'>Malicious Domain Response</span><span>)</span></a>).  The Legally-Mandated DNS Redirect Domain List can contain both domains, such as *.illegalcontent.example, as well as specific FQDNs, such as www.illegalcontent.example.net.
</p><br /><hr class="insert" />
<a name="Legally-Mandated DNS Redirect Domain Response"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

               Request                          Request
    www.illegalcontent.example.net    www.illegalcontent.example.net
                             +--------+                 +--------+
   ++--++   ---------------&gt; |        | ---------------&gt;|        |
   ||  ||                    |        |                 |        |
 +-++--++-+                  |        |                 |        |
 +--------+ &lt;--------------  |        | &lt;-------------  |        |
    Host       Redirect      +--------+    Response     +--------+
  Computer    IP Address      Recursive   IP Address   Authoritative
                               Server                     Server
     |
     |                               ___________________________________
     |          +--------+          |  Web Response:                   |
     |          |        |          |  "Illegal content alert!"        |
     +-------&gt;  |        | ------&gt;  |__________________________________|
                |        |          | The site you attempted to access |
                |        |          |  has been designated as hosting  |
                +--------+          | illegal content under XYZ law of |
                Web Server          | 2009, which your ISP is legally  |
               Landing Page         | compelled to block or be fined.  |
                                    |__________________________________|

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Legally-Mandated DNS Redirect Domain Response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.7"></a><h3>8.7.&nbsp;
Content-Based DNS Redirect Domain List</h3>

<p>Using a Content Protection List, a DNS server can redirect DNS requests that were intended for websites or domains containing content deemed inappropriate by a user, to a web server landing page (see <a class='info' href='#Content-Based Redirect Domain Response'>Figure&nbsp;5<span> (</span><span class='info'>Content-Based Redirect Domain Response</span><span>)</span></a>).  The Legally-Mandated DNS Redirect Domain List can contain both domains, such as *.inappropriate.example, as well as specific FQDNs, such as www.inappropriate.example.com.
</p><br /><hr class="insert" />
<a name="Content-Based Redirect Domain Response"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

               Request                          Request
    www.inappropriate.example.com       www.inappropriate.example.com
                             +--------+                 +--------+
   ++--++   ---------------&gt; |        | ---------------&gt;|        |
   ||  ||                    |        |                 |        |
 +-++--++-+                  |        |                 |        |
 +--------+ &lt;--------------  |        | &lt;-------------  |        |
    Host       Redirect      +--------+    Response     +--------+
  Computer    IP Address      Recursive   IP Address   Authoritative
                               Server                     Server
     |
     |                              ___________________________________
     |         +--------+          |  Web Response:                   |
     |         |        |          |  "Inappropriate content alert!"  |
     +------&gt;  |        | ------&gt;  |__________________________________|
               |        |          | The site you attempted to access |
               |        |          |    has been blocked by you or    |
               +--------+          |    your network administrator.   |
               Web Server          |__________________________________|
              Landing Page

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Content-Based Redirect Domain Response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Example DNS and HTTP Flows</h3>

<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Successful DNS Lookup and HTTP Flow</h3>

<p>This example represents a successful lookup of a valid DNS RR, and the resulting HTTP transaction.
</p><br /><hr class="insert" />
<a name="Successful DNS Lookup and HTTP Flow"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   Web          DNS          R DNS        A DNS       Web Server
 Browser       Client        Server       Server      10.1.10.10

   |   Request   |     A       |             |             |
   |www.example. |Record Query |     A       |             |
   |     com     |www.example. |Record Query |             |
   |------------&gt;|     com     |www.example. |             |
   |             |------------&gt;|     com     |             |
   |             |             |------------&gt;|             |
   |             |             |  A Record   |             |
   |             |  A Record   | 10.1.10.10  |             |
   | DNS Response| 10.1.10.10  |&lt;------------|             |
   | 10.1.10.10  |&lt;------------|             |             |
   |&lt;------------|             |             |             |
   | HTTP GET    |             |             |             |
   | 10.1.10.10  |             |             |             |
   |------------------------------------------------------&gt;|
   |             |             |             |             |
   |             |             |             |             |
   |             |             |             |             |

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: Successful DNS Lookup and HTTP Flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
Unsuccessful DNS Lookup and HTTP Flow</h3>

<p>This example represents a lookup of a nonexistent DNS RR, and the resulting HTTP transaction.
</p><br /><hr class="insert" />
<a name="Unsuccessful DNS Lookup and HTTP Flow"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

        Web          DNS          R DNS        A DNS
      Browser       Client        Server       Server

        |   Request   |     A       |             |
        |www.example. |Record Query |     A       |
        |   invalid   |www.example. |Record Query |
        |------------&gt;|   invalid   |www.example. |
        |             |------------&gt;|   invalid   |
        |             |             |------------&gt;|
        |             |             |  NXDOMAIN   |
        |             |  NXDOMAIN   |&lt;------------|
        |  NXDOMAIN   |&lt;------------|             |
        |&lt;------------|             |             |
        |             |             |             |

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: Unsuccessful DNS Lookup and HTTP Flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
DNS Redirect and HTTP Flow</h3>

<p>This example represents a lookup of a non-existing DNS RR, and the HTTP transition that results from a typical DNS Redirect service.
</p><br /><hr class="insert" />
<a name="DNS Redirect and HTTP Flow"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                                          Redirect
  Host         R DNS         A DNS       Web Server   Web Server
Computer       Server        Server      10.2.20.20   10.1.10.10

   |     A       |             |             |             |
   |Record Query |     A       |             |             |
   |www.example. |Record Query |             |             |
   |   invalid   |www.example. |             |             |
   |------------&gt;|   invalid   |             |             |
   |             |------------&gt;|             |             |
   | A Record    |  NXDOMAIN   |             |             |
   | 10.2.20.20  |&lt;------------|             |             |
   |&lt;------------|             |             |             |
   | HTTP GET    |             |             |             |
   | 10.2.20.20  |             |             |             |
   |----------------------------------------&gt;|             |
   |             |             | HTTP 200 OK |             |
   |&lt;----------------------------------------|             |
   |     A       |             |             |             |
   |Record Query |     A       |             |             |
   |www.example. |Record Query |             |             |
   |     com     |www.example. |             |             |
   |------------&gt;|     com     |             |             |
   |             |------------&gt;|             |             |
   |             |  A Record   |             |             |
   |  A Record   | 10.1.10.10  |             |             |
   | 10.1.10.10  |&lt;------------|             |             |
   |&lt;------------|             |             |             |
   | HTTP GET    |             |             |             |
   | 10.1.10.10  |             |             |             |
   |------------------------------------------------------&gt;|
   |             |             |             | HTTP 200 OK |
   |&lt;------------------------------------------------------|
   |             |             |             |             |

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: DNS Redirect and HTTP Flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.4"></a><h3>9.4.&nbsp;
Malicious Site Redirect and HTTP Flow</h3>

<p>This example represents a lookup of a valid RR which hosts malware, and the HTTP transaction that results from a typical Malicious Site Protection service.
</p><br /><hr class="insert" />
<a name="Malicious Site Redirect and HTTP Flow"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                                 R DNS      Mal Redirect
      Host         R DNS         Server      Web Server
    Computer       Server       Mal List     10.2.20.20

       |     A       |             |             |
       |Record Query |  Mal List   |             |
       |www.example. |   Query     |             |
       |     net     |www.example. |             |
       |------------&gt;|     net     |             |
       |             |------------&gt;|             |
       |             |  Postivie   |             |
       | A Record    |   Match     |             |
       | 10.2.20.20  |&lt;------------|             |
       |&lt;------------|             |             |
       | HTTP GET    |             |             |
       | 10.2.20.20  |             |             |
       |----------------------------------------&gt;|
       |             |             | HTTP 200 OK |
       |&lt;----------------------------------------|
       |             |             |             |

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;9: Malicious Site Redirect and HTTP Flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.5"></a><h3>9.5.&nbsp;
Legally-Mandated Redirect and HTTP Flow</h3>

<p>This example represents a lookup of a valid RR which hosts illegal content, and the HTTP transaction that results from a typical Legally-Mandated DNS Redirect function.
</p><br /><hr class="insert" />
<a name="Legally-Mandated Redirect and HTTP Flow"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                                    R DNS      Illegal Content
                                   Server          Redirect
      Host           R DNS         Illegal        Web Server
    Computer         Server      Content List     10.2.20.20

       |     A         |               |               |
       |Record Query   |   Illegal     |               |
       |     www.      | Content List  |               |
       |illegalcontent.|               |               |
       |example.net    |    Query      |               |
       |               |     www.      |               |
       |               |illegalcontent.|               |
       |               |example.net    |               |
       |--------------&gt;|               |               |
       |               |--------------&gt;|               |
       |               |   Postivie    |               |
       | A Record      |    Match      |               |
       | 10.2.20.20    |&lt;--------------|               |
       |&lt;--------------|               |               |
       | HTTP GET      |               |               |
       | 10.2.20.20    |               |               |
       |----------------------------------------------&gt;|
       |               |               |  HTTP 200 OK  |
       |&lt;----------------------------------------------|
       |               |               |               |

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;10: Legally-Mandated Redirect and HTTP Flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor50"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.6"></a><h3>9.6.&nbsp;
Content-Based Redirect and HTTP Flow</h3>

<p>This example represents a lookup of a valid RR which hosts content which has been deemed inappropriate by a user, and the HTTP transaction that results from a typical Content-Based Redirect function.
</p><br /><hr class="insert" />
<a name="Content-Based Redirect and HTTP Flow"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                                    R DNS         Inappropriate
                                   Server        Content Redirect
      Host           R DNS       Inappropriate     Web Server
    Computer         Server      Content List     10.2.20.20

       |     A         |               |               |
       |Record Query   |   Illegal     |               |
       |     www.      | Content List  |               |
       |inappropriate. |               |               |
       |example.com    |    Query      |               |
       |               |     www.      |               |
       |               |inappropriate. |               |
       |               |example.com    |               |
       |--------------&gt;|               |               |
       |               |--------------&gt;|               |
       |               |   Postivie    |               |
       | A Record      |    Match      |               |
       | 10.2.20.20    |&lt;--------------|               |
       |&lt;--------------|               |               |
       | HTTP GET      |               |               |
       | 10.2.20.20    |               |               |
       |----------------------------------------------&gt;|
       |               |               |  HTTP 200 OK  |
       |&lt;----------------------------------------------|
       |               |               |               |

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;11: Content-Based Redirect and HTTP Flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="Improper Redirect Section"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.7"></a><h3>9.7.&nbsp;
Improper Redirect of Valid Response Redirect and HTTP Flow</h3>

<p>This example represents an improper redirect occurring when a valid DNS RR should have been returned in response to a DNS recursive query for an example website, the resulting HTTP transaction, and that no DNS query or HTTP traffic was sent to the valid authoritative DNS server and valid web server.  <a class='info' href='#DNSSEC Considerations Section'>Section&nbsp;10<span> (</span><span class='info'>DNSSEC Considerations</span><span>)</span></a> below shows one of the reasons why this practice is problematic.  Another reason is that a user intends to visit a valid resource with lawful and legitimate content, such as a web site, and is instead sent to a different destination (which may even closely resemble the intended site, in the pattern used by phishing sites).
</p><br /><hr class="insert" />
<a name="Improper Redirect of Valid Response Redirect and HTTP Flow"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                              R DNS      Improper             Valid
                             Server      Redirect   Valid      Web
  Host         R DNS        Improper    Web Server  A DNS     Server
Computer       Server     Reirect List  10.2.20.20  Server   10.1.10.10

   |     A       |  Improper   |           |          |          |
   |Record Query |Redirect List|           |          |          |
   |www.example. |   Query     |           |          |          |
   |     com     |www.example. |           |          |          |
   |------------&gt;|     com     |           |          |          |
   |             |------------&gt;|           |          |          |
   |             |  Postivie   |           |          |          |
   | A Record    |   Match     |           |          |          |
   | 10.2.20.20  |&lt;------------|           |          |          |
   |&lt;------------|             |           |          |          |
   | HTTP GET    |             |           |          |          |
   | 10.2.20.20  |             |           |          |          |
   |--------------------------------------&gt;|          |          |
   |             |             |HTTP 200 OK|          |          |
   |&lt;--------------------------------------|          |          |
   |             |             |           |          |          |

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;12: Improper Redirect of Valid Response Redirect and HTTP Flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="DNSSEC Considerations Section"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
DNSSEC Considerations</h3>

<p>DNS security extensions defined in <a class='info' href='#RFC4033'>[RFC4033]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a>, <a class='info' href='#RFC4034'>[RFC4034]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Resource Records for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a>, and <a class='info' href='#RFC4035'>[RFC4035]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Protocol Modifications for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a> use cryptographic digital signatures to provide origin authentication and integrity assurance for DNS data. This is done by creating signatures for DNS data on a Security-Aware Name Server that can be used by Security-Aware Resolvers to verify the answers. As the DNS redirections described herein take place on the recursive server there is no need to look into the communication between the recursive resolvers and name servers.  Depending on the security awareness of recursive server used to perform DNS Redirect services, as well as the security awareness of the stub resolvers the following impact is observed on DNS Redirect when giving out answers to fully secured zones or parent zones:
</p>
<p></p>
<ul class="text">
<li>Security-Oblivious Resolver with Validating and Non-Validating Stub Resolvers: Since the resolver is not security-aware, it will not pass any DNSSEC-related packets and, thus, even the validating stub resolver cannot validate the records and will present the DNS Redirect answers to the application.
</li>
<li>Security-Aware Resolver with Non-Validating Stub Resolver: As the security-aware resolver does not have the key generated the resource record signatures (RRSIG) for it's response it should give the redirected answer out as indeterminate or insecure. As the stub resolver is not doing any validation it will use the DNS Redirect response and pass them on to the application.
</li>
<li>Security-Aware Resolver with Validating Stub Resolver: As the security-aware resolver does not have the key generated the resource record signatures (RRSIG) for it's response it should give the redirected answer out as indeterminate or insecure. However, as the validating stub has a DNSKEY record for the zone or a DS record for the parent zone it cannot validate the answer and will report it as bogus to the application leading to non-resolution for that domain.
</li>
</ul>

<p>So the only case where DNS security extensions cause problems for DNS Redirect is with a validating stub resolver. This case doesn't have widespread deployment now and could be mitigated by using trust anchor, configured by the applicable ISP or DNS ASP, that could be used to sign the redirected answers. As noted above in <a class='info' href='#Improper Redirect Section'>Section&nbsp;9.7<span> (</span><span class='info'>Improper Redirect of Valid Response Redirect and HTTP Flow</span><span>)</span></a>, such improper redirection of valid responses may also cause DNSSEC trust verification problems.
</p>
<a name="anchor51"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Considerations</h3>

<p>Security best practices should be followed regarding access to the opt-in and opt-out functions, in order that someone other than the user is able to change the user's DNS Redirect settings.  For example, the User Options Web Server must not permit someone to modify a page URI to access and change another user's options.  Thus, if the URI is "http://www.example.net/redirect-options.php?account=1234", someone must not be able to modify the account to be "=1235" and then be able to change the options for a different user with some other additional validation being performed.  While web site security practices are outside the scope of this document, the authors believe it is important to identify such problematic use cases to any ISPs and DNS ASPs offering and/or implementing DNS Redirect functionality.
</p>
<a name="anchor52"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
IANA Considerations</h3>

<p>There are no IANA considerations in this document.
</p>
<a name="anchor53"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Contributors</h3>

<p>The following people made significant textual contributions to this document and played an important role in the development and evolution of this document:
</p>
<p>Don Bowman, Sandvine (don@sandvine.com)
</p>
<p>Rick Hiester, Verizon (richard.hiester@verizon.com)
</p>
<p>Chris Roosenraad, Time Warner Cable (chris.roosenraad@twcable.com)
</p>
<p>David Ulevitch, OpenDNS (david@opendns.com)
</p>
<a name="anchor54"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
Acknowledgements</h3>

<p>The authors and contributors also wish to acknowledge the assistance of the following individuals in helping us to develop and/or review this document: 
</p>
<p>John Barnitz, Comcast Cable Communications (john_barnitz@cable.comcast.com)
</p>
<p>Mike Burns, Cablevision (mburns@cablevision.com)
</p>
<p>Phil Marcella, Comcast Interactive Media (phillip_marcella@cable.comcast.com)
</p>
<p>Luis Uribarri, Comcast Cable Communications (luis_uribarri@cable.comcast.com)
</p>
<p>Sandy Wilbourn, Nominum (sandy.wilbourn@nominum.com)
</p>
<p>Matt Williams, Cox Cable (matt.williams@cox.com)
</p>
<p>And another contributor...
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1035">[RFC1035]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1536">[RFC1536]</a></td>
<td class="author-text"><a href="mailto:anant@isi.edu">Kumar, A.</a>, <a href="mailto:postel@isi.edu">Postel, J.</a>, <a href="mailto:bcn@isi.edu">Neuman, C.</a>, <a href="mailto:danzig@caldera.usc.edu">Danzig, P.</a>, and <a href="mailto:smiller@caldera.usc.edu">S. Miller</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1536">Common DNS Implementation Errors and Suggested Fixes</a>,&rdquo; RFC&nbsp;1536, October&nbsp;1993 (<a href="http://www.rfc-editor.org/rfc/rfc1536.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1591">[RFC1591]</a></td>
<td class="author-text"><a href="mailto:Postel@ISI.EDU">Postel, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1591">Domain Name System Structure and Delegation</a>,&rdquo; RFC&nbsp;1591, March&nbsp;1994 (<a href="http://www.rfc-editor.org/rfc/rfc1591.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2131">[RFC2131]</a></td>
<td class="author-text"><a href="mailto:droms@bucknell.edu">Droms, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2131">Dynamic Host Configuration Protocol</a>,&rdquo; RFC&nbsp;2131, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2131.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2131.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2131.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2136">[RFC2136]</a></td>
<td class="author-text"><a href="mailto:paul@vix.com">Vixie, P.</a>, <a href="mailto:set@thumper.bellcore.com">Thomson, S.</a>, <a href="mailto:yakov@cisco.com">Rekhter, Y.</a>, and <a href="mailto:bound@zk3.dec.com">J. Bound</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2136">Dynamic Updates in the Domain Name System (DNS UPDATE)</a>,&rdquo; RFC&nbsp;2136, April&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2136.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2136.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2136.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2181">[RFC2181]</a></td>
<td class="author-text"><a href="mailto:kre@munnari.OZ.AU">Elz, R.</a> and <a href="mailto:randy@psg.com">R. Bush</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2181">Clarifications to the DNS Specification</a>,&rdquo; RFC&nbsp;2181, July&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2181.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2181.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2181.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2308">[RFC2308]</a></td>
<td class="author-text"><a href="mailto:Mark.Andrews@cmis.csiro.au">Andrews, M.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2308">Negative Caching of DNS Queries (DNS NCACHE)</a>,&rdquo; RFC&nbsp;2308, March&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2308.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2308.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2308.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2535">[RFC2535]</a></td>
<td class="author-text"><a href="mailto:dee3@us.ibm.com">Eastlake, D.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2535">Domain Name System Security Extensions</a>,&rdquo; RFC&nbsp;2535, March&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2535.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[RFC4033]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4034">[RFC4034]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4034">Resource Records for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4034, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4035">[RFC4035]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4035">Protocol Modifications for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4035, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4035.txt">TXT</a>).</td></tr>
</table>

<a name="anchor56"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Document Change Log</h3>

<p>[RFC Editor: This section is to be removed before publication]
</p>
<p>-00 version:
     		</p>
<ul class="text">
<li>first version published
</li>
</ul><p>
     	
</p>
<a name="anchor57"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Open Issues</h3>

<p>[RFC Editor: This section is to be removed before publication]
</p>
<p>
			</p>
<ol class="text">
<li>RW: Consider whether it is a good idea to add to section 4.9 (NXDOMAIN RESPONSE) a reference to Authenticated Denial of Existence described in RFC4035 section 5.4 as these should be also redirected.
</li>
<li>MB: Consider addressing how opt-out works when a user roams across a shared WiFi AP.
</li>
<li>RH: Update reference to RFC2535, which is obsoleted by RFCs 4033, 4034, 4035.
</li>
<li>JL: Consider capitalizing RFC 2119 language used.
</li>
<li>JL: Need additional review and development of the DNSSEC section.  Could probably benefit by having a DNSSEC expert perform a review of that section and offer suggestions.
</li>
</ol><p>
		
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tom Creighton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Comcast Cable Communications</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Comcast Center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1701 John F. Kennedy Boulevard</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Philadelphia, PA  19103</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tom_creighton@cable.comcast.com">tom_creighton@cable.comcast.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.comcast.com">http://www.comcast.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Chris Griffiths</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Comcast Cable Communications</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Comcast Center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1701 John F. Kennedy Boulevard</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Philadelphia, PA  19103</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:chris_griffiths@cable.comcast.com">chris_griffiths@cable.comcast.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.comcast.com">http://www.comcast.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jason Livingood (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Comcast Cable Communications</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">One Comcast Center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1701 John F. Kennedy Boulevard</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Philadelphia, PA  19103</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jason_livingood@cable.comcast.com">jason_livingood@cable.comcast.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.comcast.com">http://www.comcast.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ralf Weber</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Unaffiliated</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bleichgarten 1</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hohenahr-Hohensolms  35644</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rw@hohensolms.de">rw@hohensolms.de</a></td></tr>
</table>
</body></html>
