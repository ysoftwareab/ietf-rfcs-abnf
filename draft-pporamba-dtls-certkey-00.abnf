R_U = r_U * G
P_U = R_U + r_CA * G
Cert_U = {U, P_U, T}
e = H(Cert_U)
s = e*r_CA + d_CA (mod n)
e = H(Cert_U)
d_U = e*r_U + s (mod n)
e = H(Cert_U)
Q_U = eCert_U + Q_CA
e = H(Cert_V)
Q_V = eCert_V + Q_CA
K_UV = d_U*Q_V = d_U*d_V*G

Q_U =   d_U * G
                   =   (er_U + s (mod n)) * G
                   =   (er_U + er_CA + d_CA (mod n)) *G
                   =   e (r_U + r_CA (mod n)) * G + d_CA * G
                   =   e(r_U * G + r_CA * G) + Q_CA
                   =   e(R_U + r_CA * G) + Q_CA
                   =   eCert_U + Q_CA

                                 Figure 3

