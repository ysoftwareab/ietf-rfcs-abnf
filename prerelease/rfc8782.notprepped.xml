<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc SYSTEM "rfc2629-xhtml.ent">
<rfc 
xmlns:xi="http://www.w3.org/2001/XInclude" 
category="std" 
docName="draft-ietf-dots-signal-channel-41" 
number="8782" ipr="trust200902" 
obsoletes="" 
updates="" 
submissionType="IETF" 
consensus="true" 
xml:lang="en" 
tocInclude="true" 
tocDepth="4" 
symRefs="true" 
sortRefs="true" 
version="3">
  <!-- xml2rfc v2v3 conversion 2.39.0 -->
  <front>
    <title abbrev="DOTS Signal Channel Protocol">Distributed Denial-of-Service
    Open Threat Signaling (DOTS) Signal Channel Specification</title>
    <seriesInfo name="RFC" value="8782"/>
    
    <author fullname="Tirumaleswar Reddy.K" initials="T." role="editor" surname="Reddy.K">
      <organization abbrev="McAfee">McAfee, Inc.</organization>
      <address>
        <postal>
          <street>Embassy Golf Link Business Park</street>
          <city>Bangalore</city>
          <region>Karnataka</region>
          <code>560071</code>
          <country>India</country>
        </postal>
        <email>kondtir@gmail.com</email>
      </address>
    </author>
    <author fullname="Mohamed Boucadair" initials="M." role="editor" surname="Boucadair">
      <organization>Orange</organization>
      <address>
        <postal>
          <city>Rennes</city>
          <code>35000</code>
          <country>France</country>
        </postal>
        <email>mohamed.boucadair@orange.com</email>
      </address>
    </author>
    <author fullname="Prashanth Patil" initials="P." surname="Patil">
      <organization abbrev="Cisco">Cisco Systems, Inc.</organization>
      <address>
        <email>praspati@cisco.com</email>
      </address>
    </author>
    <author fullname="Andrew Mortensen" initials="A." surname="Mortensen">
      <organization>Arbor Networks, Inc.</organization>
      <address>
        <postal>
          <street>2727 S. State Street</street>
          <city>Ann Arbor</city>
          <region>MI</region>
          <code>48104</code>
          <country>United States of America</country>
        </postal>
        <email>andrew@moretension.com</email>
      </address>
    </author>
    <author fullname="Nik Teague" initials="N." surname="Teague">
      <organization>Iron Mountain Data Centers</organization>
      <address>
        <postal>
          <country>United Kingdom</country>
        </postal>
        <email>nteague@ironmountain.co.uk</email>
      </address>
    </author>
    <date month="May" year="2020"/>
    <workgroup>DOTS</workgroup>
    <keyword>security</keyword>
    <keyword>mitigation</keyword>
    <keyword>service delivery</keyword>
    <keyword>connectivity</keyword>
    <keyword>anti-DDoS</keyword>
    <keyword>automation</keyword>
    <keyword>cooperation</keyword>
    <keyword>resilience</keyword>
    <keyword>filtering</keyword>
    <keyword>security center</keyword>
    <keyword>mitigator</keyword>
    <keyword>scrubbing</keyword>
    <keyword>dynamic service protection</keyword>
    <keyword>dynamic mitigation</keyword>
    <keyword>cooperative networking</keyword>
    <keyword>protective networking</keyword>
    <abstract>
      <t>This document specifies the Distributed Denial-of-Service
    Open Threat Signaling (DOTS) signal channel, a protocol for
      signaling the need for protection against Distributed Denial-of-Service
      (DDoS) attacks to a server capable of enabling network traffic
      mitigation on behalf of the requesting client.</t>
      <t>A companion document defines the DOTS data channel, a separate
      reliable communication layer for DOTS management and configuration
      purposes.</t>
    </abstract>

  </front>
  <middle>
    <section anchor="introduction" numbered="true" toc="default">
      <name>Introduction</name>
      <t>A Distributed Denial-of-Service (DDoS) attack is a distributed
      attempt to make machines or network resources unavailable to their
      intended users. In most cases, sufficient scale for an effective attack
      can be achieved by compromising enough end hosts and using those
      infected hosts to perpetrate and amplify the attack. The victim in this
      attack can be an application server, a host, a router, a firewall, or an
      entire network.</t>
      <t>
   Network applications have finite resources like CPU cycles, the
   number of processes or threads they can create and use, the maximum
   number of simultaneous connections they can handle, the resources 
   assigned to the control plane, etc.  When processing network traffic,
      such applications are supposed to use these resources to provide the
      intended functionality in the most efficient manner. However, a DDoS
      attacker may be able to prevent an application from performing its
      intended task by making the application exhaust its finite
      resources.</t>
      <t>A TCP DDoS SYN flood <xref target="RFC4987" format="default"/>, for example, is
      a memory-exhausting attack while an ACK flood is a CPU-exhausting
      attack. Attacks on the link are carried out by sending enough traffic so
      that the link becomes congested, thereby likely causing packet loss for
      legitimate traffic.
Stateful firewalls can also be attacked by sending traffic
that causes the firewall to maintain an excessive number of states
that may jeopardize the firewall's operation overall, in addition to likely
performance impacts.
      The firewall then runs out of memory, and
      it can no longer instantiate the states required to process legitimate
      flows. Other possible DDoS attacks are discussed in <xref target="RFC4732" format="default"/>.</t>
      <t>In many cases, it may not be possible for network administrators to
      determine the cause(s) of an attack. They may instead just realize that
      certain resources seem to be under attack. This document defines a
      lightweight protocol that allows a DOTS client to request mitigation
      from one or more DOTS servers for protection against detected,
      suspected, or anticipated attacks. This protocol enables cooperation
      between DOTS agents to permit a highly automated network defense that is
      robust, reliable, and secure. Note that "secure" means the support of
      the features defined in <xref target="RFC8612" section="2.4" sectionFormat="of" format="default"/>.</t>
      <t>An example of a network diagram that illustrates a deployment of DOTS
      agents is shown in <xref target="fig1" format="default"/>. In this example, a DOTS
      server is operating on the access network. A DOTS client is located on
      the LAN (Local Area Network), while a DOTS gateway is embedded in the
      CPE (Customer Premises Equipment).</t>
      <figure anchor="fig1">
        <name>Sample DOTS Deployment (1)</name>
        <artwork align="center" name="" type="" alt=""><![CDATA[
  Network
  Resource         CPE Router        Access Network     __________
+-----------+   +--------------+    +-------------+    /          \
|           |___|              |____|             |___ | Internet |
|DOTS Client|   | DOTS Gateway |    | DOTS Server |    |          |
|           |   |              |    |             |    |          |
+-----------+   +--------------+    +-------------+    \__________/
]]></artwork>
      </figure>
      <t>DOTS servers can also be reachable over the Internet, as depicted in
      <xref target="fig_blah" format="default"/>.</t>
      <figure anchor="fig_blah">
        <name>Sample DOTS Deployment (2)</name>
        <artwork align="center" name="" type="" alt=""><![CDATA[
  Network                                           DDoS Mitigation
  Resource         CPE Router        __________         Service
+-----------+   +--------------+    /          \    +-------------+
|           |___|              |____|          |___ |             |
|DOTS Client|   | DOTS Gateway |    | Internet |    | DOTS Server |
|           |   |              |    |          |    |             |
+-----------+   +--------------+    \__________/    +-------------+
]]></artwork>
      </figure>
      <t>In typical deployments, the DOTS client belongs to a
      different administrative domain than the DOTS server. For example, the
      DOTS client is embedded in a firewall protecting services owned and
      operated by a customer, while the DOTS server is owned and operated by a
      different administrative entity (service provider, typically) providing
      DDoS mitigation services. The latter might or might not provide
      connectivity services to the network hosting the DOTS client.</t>
      <t>The DOTS server may (not) be co-located with the DOTS mitigator. In
      typical deployments, the DOTS server belongs to the same administrative
      domain as the mitigator. The DOTS client can communicate directly with a
      DOTS server or indirectly via a DOTS gateway.</t>
      <t>This document adheres to the DOTS architecture <xref target="I-D.ietf-dots-architecture" format="default"/>. The requirements for DOTS
      signal channel protocol are documented in <xref target="RFC8612" format="default"/>. This document satisfies all the use cases
      discussed in <xref target="I-D.ietf-dots-use-cases" format="default"/>.</t>
      <t>This document focuses on the DOTS signal channel. This is a companion
      document of the DOTS data channel specification <xref target="RFC8783" format="default"/> that defines a configuration
      and a bulk data exchange mechanism supporting the DOTS signal
      channel.</t>
    </section>
    <section anchor="notation" numbered="true" toc="default">
      <name>Terminology</name>
      <t>The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>",
      "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>", "<bcp14>MAY</bcp14>", and
      "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as described in BCP 14
      <xref target="RFC2119" format="default"/><xref target="RFC8174" format="default"/> when, and
      only when, they appear in all capitals, as shown here.</t>
      <t>(D)TLS is used for statements that apply to both Transport Layer
      Security <xref target="RFC5246" format="default"/> <xref target="RFC8446" format="default"/>
      and Datagram Transport Layer Security <xref target="RFC6347" format="default"/>.
      Specific terms are used for any statement that applies to either
      protocol alone.</t>
      <t>The reader should be familiar with the terms defined in <xref target="RFC8612" format="default"/>.</t>
      <t>The meaning of the symbols in YANG tree diagrams is defined in <xref target="RFC8340" format="default"/>.</t>
    </section>
    <section numbered="true" toc="default">
      <name>Design Overview</name>
      <t>The DOTS signal channel is built on top of the Constrained
      Application Protocol (CoAP) <xref target="RFC7252" format="default"/>, a
      lightweight protocol originally designed for constrained devices and
      networks. The many features of CoAP (expectation of packet loss, support
      for asynchronous Non-confirmable messaging, congestion control, small
      message overhead limiting the need for fragmentation, use of minimal
      resources, and support for (D)TLS) make it a good candidate upon which to build
      the DOTS signaling mechanism.</t>
      <t>DOTS clients and servers behave as CoAP endpoints. By default, a DOTS
      client (or server) behaves as a CoAP client (or server). Nevertheless, a
      DOTS client (or server) behaves as a CoAP server (or client) for
      specific operations such as DOTS heartbeat operations (<xref target="hb" format="default"/>).</t>
      <t>The DOTS signal channel is layered on existing standards (see
      <xref target="fig_dots" format="default"/>).</t>
      <figure anchor="fig_dots">
        <name>Abstract Layering of DOTS Signal Channel over CoAP over (D)TLS</name>
        <artwork align="center" name="" type="" alt=""><![CDATA[
+---------------------+
| DOTS Signal Channel |
+---------------------+
|         CoAP        |
+----------+----------+
|   TLS    |   DTLS   |
+----------+----------+
|   TCP    |   UDP    |
+----------+----------+
|          IP         |
+---------------------+
]]></artwork>
      </figure>

      <t>In some cases, a DOTS client and server may have a mutual agreement to
      use a specific port number, such as by explicit configuration or dynamic
      discovery <xref target="I-D.ietf-dots-server-discovery" format="default"/>. Absent
      such mutual agreement, the DOTS signal channel <bcp14>MUST</bcp14> run over port number
      4646 as defined in <xref target="port" format="default"/>, for both UDP and TCP. In
      order to use a distinct port number (as opposed to 4646), DOTS clients
      and servers <bcp14>SHOULD</bcp14> support a configurable parameter to supply the port
      number to use.</t>
      <aside>
          <t>Note: The rationale for not using the default port number 5684
          ((D)TLS CoAP) is to avoid the discovery of services and resources
          discussed in <xref target="RFC7252" format="default"/> and allow for
          differentiated behaviors in environments where both a DOTS gateway
          and an Internet of Things (IoT) gateway (e.g., Figure 3 of <xref target="RFC7452" format="default"/>) are co-located. </t>
          <t>Particularly, the use of a default port number is
          meant to simplify DOTS deployment in scenarios where no explicit IP
          address configuration is required. For example, the use of the
          default router as the DOTS server aims to ease DOTS deployment within
          LANs (in which CPEs embed a DOTS gateway as illustrated in Figures
          <xref format="counter" target="fig1"/> and <xref format="counter" target="fig_blah"/>) without requiring a
          sophisticated discovery method and configuration tasks within the
          LAN. It is also possible to use anycast addresses for DOTS servers
          to simplify DOTS client configuration, including service discovery.
          In such an anycast-based scenario, a DOTS client initiating a DOTS
          session to the DOTS server anycast address may, for example, be (1)
          redirected to the DOTS server unicast address to be used by the DOTS
          client following the procedure discussed in <xref target="redirect" format="default"/> or (2) relayed to a unicast DOTS
          server.</t>
        
      </aside>
      <t>The signal channel uses the "coaps" URI scheme defined in
      <xref target="RFC7252" section="6" sectionFormat="of" format="default"/> and the "coaps+tcp" URI
      scheme defined in <xref target="RFC8323" section="8.2" sectionFormat="of" format="default"/> to
      identify DOTS server resources that are accessible using CoAP over UDP secured
      with DTLS and CoAP over TCP secured with TLS, respectively.</t>
      <t>The DOTS signal channel can be established between two DOTS agents
      prior to or during an attack. The DOTS signal channel is initiated by the
      DOTS client. The DOTS client can then negotiate, configure, and retrieve
      the DOTS signal channel session behavior with its DOTS peer (<xref target="sigconfig" format="default"/>). Once the signal channel is established, the
      DOTS agents may periodically send heartbeats to keep the channel active
      (<xref target="hb" format="default"/>). At any time, the DOTS client may send a
      mitigation request message (<xref target="m_req" format="default"/>) to a DOTS
      server over the active signal channel. While mitigation is active
      (because of the higher likelihood of packet loss during a DDoS attack),
      the DOTS server periodically sends status messages to the client,
      including basic mitigation feedback details. Mitigation remains active
      until the DOTS client explicitly terminates mitigation or the
      mitigation lifetime expires. Also, the DOTS server may rely on the
      signal channel session loss to trigger mitigation for preconfigured
      mitigation requests (if any).</t>
      <t>DOTS signaling can happen with DTLS over UDP and TLS over TCP.
      Likewise, DOTS requests may be sent using IPv4 or IPv6 transfer
      capabilities. A Happy Eyeballs procedure for the DOTS signal channel is
      specified in <xref target="HE" format="default"/>.</t>
      <t>A DOTS client is entitled to access only the resources it creates. In
      particular, a DOTS client cannot retrieve data related to mitigation
      requests created by other DOTS clients of the same DOTS client
      domain.</t>
      <t>Messages exchanged between DOTS agents are serialized using Concise
      Binary Object Representation (CBOR) <xref target="RFC7049" format="default"/>, a
      binary encoding scheme designed for small code and message size.
      CBOR-encoded payloads are used to carry signal channel-specific payload
      messages that convey request parameters and response information such
      as errors. In order to allow the reusing of data models across protocols, <xref target="RFC7951" format="default"/> specifies the JavaScript Object Notation (JSON)
      encoding of YANG-modeled data. A similar effort for CBOR is defined in
      <xref target="I-D.ietf-core-yang-cbor" format="default"/>.</t>
      <t>DOTS agents determine that a CBOR data structure is a DOTS signal
      channel object from the application context, such as from the port
      number assigned to the DOTS signal channel. The other method DOTS agents
      use to indicate that a CBOR data structure is a DOTS signal channel
      object is the use of the "application/dots+cbor" content type (<xref target="MediaReg" format="default"/>).</t>
      <t>This document specifies a YANG module for representing DOTS
      mitigation scopes, DOTS signal channel session configuration data, and
      DOTS redirected signaling (<xref target="YANG" format="default"/>). All parameters
      in the payload of the DOTS signal channel are mapped to CBOR types as
      specified in <xref target="cbor-key-values" format="default"/> (<xref target="mapping" format="default"/>).</t>
      <t>In order to prevent fragmentation, DOTS agents must follow the
      recommendations documented in <xref target="RFC7252" section="4.6" sectionFormat="of" format="default"/>. Refer to <xref target="mtu" format="default"/> for more
      details.</t>
      <t>DOTS agents <bcp14>MUST</bcp14> support GET, PUT, and DELETE CoAP methods. The
      payload included in CoAP responses with 2.xx Response Codes <bcp14>MUST</bcp14> be of
      content type "application/dots+cbor". CoAP responses with 4.xx and 5.xx
      error Response Codes <bcp14>MUST</bcp14> include a diagnostic payload 
(<xref target="RFC7252" section="5.5.2" sectionFormat="of" format="default"/>). The diagnostic payload may contain
      additional information to aid troubleshooting.</t>
      <t>In deployments where multiple DOTS clients are enabled in a network
      (owned and operated by the same entity), the DOTS server may detect
      conflicting mitigation requests from these clients. This document does
      not aim to specify a comprehensive list of conditions under which a DOTS
      server will characterize two mitigation requests from distinct DOTS
      clients as conflicting, nor does it recommend a DOTS server behavior for
      processing conflicting mitigation requests. Those considerations are
      implementation and deployment specific. Nevertheless, this document
      specifies the mechanisms to notify DOTS clients when conflicts occur,
      including the conflict cause (<xref target="m_req" format="default"/>).</t>
      <t>In deployments where one or more translators (e.g., Traditional NAT
      <xref target="RFC3022" format="default"/>, CGN <xref target="RFC6888" format="default"/>,
      NAT64 <xref target="RFC6146" format="default"/>, NPTv6 <xref target="RFC6296" format="default"/>) are enabled between the client's network and
      the DOTS server, any DOTS signal channel messages forwarded to a DOTS server
      <bcp14>MUST NOT</bcp14> include internal IP addresses/prefixes
      and/or port numbers; instead,
      external addresses/prefixes and/or port numbers as assigned by the
      translator <bcp14>MUST</bcp14> be used. This document does not make any
      recommendations about possible translator discovery mechanisms. The
      following are some (non-exhaustive) deployment examples that may be
      considered: </t>
      <ul spacing="normal">
	
        <li>Port Control Protocol (PCP) <xref target="RFC6887" format="default"/> or
          Session Traversal Utilities for NAT (STUN) <xref target="RFC8489" format="default"/> may be used to retrieve the external
          addresses/prefixes and/or port numbers. Information retrieved by
          means of PCP or STUN will be used to feed the DOTS signal channel
          messages that will be sent to a DOTS server.</li>
        <li>A DOTS gateway may be co-located with the translator. The DOTS
          gateway will need to update the DOTS messages based upon the local
          translator's binding table.</li>
      </ul>
    </section>
    <section numbered="true" toc="default">
      <name>DOTS Signal Channel: Messages &amp; Behaviors</name>
      <section anchor="discover" numbered="true" toc="default">
        <name>DOTS Server(s) Discovery</name>
        <t>This document assumes that DOTS clients are provisioned with the
        reachability information of their DOTS server(s) using any of a
        variety of means (e.g., local configuration or dynamic means such as
        DHCP <xref target="I-D.ietf-dots-server-discovery" format="default"/>). The
        description of such means is out of scope of this document.</t>
        <t>Likewise, it is out of the scope of this document to specify the
        behavior to be followed by a DOTS client in order to send DOTS requests when
        multiple DOTS servers are provisioned (e.g., contact all DOTS servers,
        select one DOTS server among the list). Such behavior is specified in
        other documents (e.g., <xref target="I-D.ietf-dots-multihoming" format="default"/>).</t>
      </section>
      <section anchor="uri-path" numbered="true" toc="default">
        <name>CoAP URIs</name>
        <t>The DOTS server <bcp14>MUST</bcp14> support the use of the path prefix of
        "/.well-known/" as defined in <xref target="RFC8615" format="default"/> and the
        registered name of "dots". Each DOTS operation is denoted by a
        path suffix that indicates the intended operation. The operation path
        (<xref target="uris" format="default"/>) is appended to the path prefix to form
        the URI used with a CoAP request to perform the desired DOTS
        operation.</t>
        <table align="center" anchor="uris">
          <name>Operations and Corresponding URIs</name>
          <thead>
            <tr>
              <th align="left">Operation</th>
              <th align="left">Operation Path</th>
              <th align="left">Details</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Mitigation</td>
              <td align="left">/mitigate</td>
              <td align="left">
                <xref target="m_req" format="default"/></td>
            </tr>
            <tr>
              <td align="left">Session configuration</td>
              <td align="left">/config</td>
              <td align="left">
                <xref target="sigconfig" format="default"/></td>
            </tr>
            <tr>
              <td align="left">Heartbeat</td>
              <td align="left">/hb</td>
              <td align="left">
                <xref target="hb" format="default"/></td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="HE" numbered="true" toc="default">
        <name>Happy Eyeballs for DOTS Signal Channel</name>
        <t><xref target="RFC8612" format="default"/> mentions that DOTS agents will have
        to support both connectionless and connection-oriented protocols. As
        such, the DOTS signal channel is designed to operate with DTLS over
        UDP and TLS over TCP. Further, a DOTS client may acquire a list of
        IPv4 and IPv6 addresses (<xref target="discover" format="default"/>), each of
        which can be used to contact the DOTS server using UDP and TCP. If no
        list of IPv4 and IPv6 addresses to contact the DOTS server is
        configured (or discovered), the DOTS client adds the IPv4/IPv6
        addresses of its default router to the candidate list to contact the
        DOTS server.</t>
        <t>The following specifies the procedure to follow to select the
        address family and the transport protocol for sending DOTS signal
        channel messages.</t>
        <t>Such a procedure is needed to avoid experiencing long connection
        delays. For example, if an IPv4 path to a DOTS server is
        functional, but the DOTS server's IPv6 path is nonfunctional, a
        dual-stack DOTS client may experience a significant connection delay
        compared to an IPv4-only DOTS client in the same network conditions.
        The other problem is that if a middlebox between the DOTS client and
        DOTS server is configured to block UDP traffic, the DOTS client will
        fail to establish a DTLS association with the DOTS server;
	consequently, it will have to fall back to TLS over TCP, thereby incurring
        significant connection delays.</t>
        <t>To overcome these connection setup problems, the DOTS client
        attempts to connect to its DOTS server(s) using both IPv6 and IPv4,
        and it tries both DTLS over UDP and TLS over TCP following a DOTS Happy
        Eyeballs approach. To some extent, this approach is similar to the
        Happy Eyeballs mechanism defined in <xref target="RFC8305" format="default"/>.
        The connection attempts are performed by the DOTS client when it
        initializes or, in general, when it has to select an address family and
        transport to contact its DOTS server. The results of the Happy
        Eyeballs procedure are used by the DOTS client for sending its
        subsequent messages to the DOTS server. The differences in behavior
        with respect to the Happy Eyeballs mechanism <xref target="RFC8305" format="default"/> are listed below:</t>
        <ul spacing="normal">
          <li>The order of preference of the DOTS signal channel address
            family and transport protocol (most preferred first) is the following: UDP over
            IPv6, UDP over IPv4, TCP over IPv6, and finally TCP over IPv4.
            This order adheres to the address preference order specified in
            <xref target="RFC6724" format="default"/> and the DOTS signal channel
            preference that promotes the use of UDP over TCP (to avoid
            TCP's head of line blocking).</li>
          <li>After successfully establishing a connection, the DOTS client
            <bcp14>MUST</bcp14> cache information regarding the outcome of each connection
            attempt for a specific time period; it uses that information
            to avoid thrashing the network with subsequent attempts. The
            cached information is flushed when its age exceeds a specific time
            period on the order of few minutes (e.g., 10 min). Typically, if
            the DOTS client has to reestablish the connection with the same
            DOTS server within a few seconds after the Happy Eyeballs mechanism
            is completed, caching avoids thrashing the network especially in
            the presence of DDoS attack traffic.</li>
          <li>If a DOTS signal channel session is established with TLS (but
            DTLS failed), the DOTS client periodically repeats the mechanism
            to discover whether DOTS signal channel messages with DTLS over
            UDP become available from the DOTS server; this is so the DOTS client can
            migrate the DOTS signal channel from TCP to UDP. Such probing
            <bcp14>SHOULD NOT</bcp14> be done more frequently than every 24 hours and <bcp14>MUST
            NOT</bcp14> be done more frequently than every 5 minutes.</li>
        </ul>
        <t>
        When connection attempts are made during an attack, the DOTS client <bcp14>SHOULD</bcp14>
        use a "Connection Attempt Delay" <xref target="RFC8305" format="default"/> set to
        100 ms.</t>
        <t>In <xref target="fig_happy_eyeballs" format="default"/>, the DOTS
        client proceeds with the connection attempts following the rules in
        <xref target="RFC8305" format="default"/>. In this example, it is assumed that
        the IPv6 path is broken and UDP traffic is dropped by a middlebox, but this
        has little impact on the DOTS client because there is not a long delay
        before using IPv4 and TCP.</t>
        <figure anchor="fig_happy_eyeballs">
          <name>DOTS Happy Eyeballs (Sample Flow)</name>
          <artwork align="center" name="" type="" alt=""><![CDATA[
 +-----------+                                         +-----------+
 |DOTS Client|                                         |DOTS Server|
 +-----------+                                         +-----------+
       |                                                     |
    T0 |--DTLS ClientHello, IPv6 ---->X                      |
    T1 |--DTLS ClientHello, IPv4 ---->X                      |
    T2 |--TCP SYN, IPv6-------------->X                      |
    T3 |--TCP SYN, IPv4------------------------------------->|
       |<-TCP SYNACK-----------------------------------------|
       |--TCP ACK------------------------------------------->|
       |<------------Establish TLS Session------------------>|
       |----------------DOTS signal------------------------->|
       |                                                     |

  Note: 
   * Retransmission messages are not shown.
   * T1-T0=T2-T1=T3-T2= Connection Attempt Delay.
]]></artwork>
        </figure>
        <t>A single DOTS signal channel between DOTS agents can be used to
        exchange multiple DOTS signal messages. To reduce DOTS client and DOTS
        server workload, DOTS clients <bcp14>SHOULD</bcp14> reuse the (D)TLS session.</t>
      </section>
      <section anchor="m_req" numbered="true" toc="default">
        <name>DOTS Mitigation Methods</name>
        <t>The following methods are used by a DOTS client to request,
        withdraw, or retrieve the status of mitigation requests:</t>
        <dl newline="false" spacing="normal" indent="10">
          <dt>PUT:</dt>
          <dd>DOTS clients use the PUT method to request
            mitigation from a DOTS server (<xref target="post" format="default"/>).
            During active mitigation, DOTS clients may use PUT requests to
            carry mitigation efficacy updates to the DOTS server (<xref target="put" format="default"/>).</dd>
          <dt>GET:</dt>
          <dd>DOTS clients may use the GET method to
            subscribe to DOTS server status messages or to retrieve the list
            of its mitigations maintained by a DOTS server (<xref target="get" format="default"/>).</dd>
          <dt>DELETE:</dt>
          <dd>DOTS clients use the DELETE method to
            withdraw a request for mitigation from a DOTS server (<xref target="del" format="default"/>).</dd>
        </dl>
        <t>Mitigation request and response messages are marked as
        Non-confirmable messages (<xref target="RFC7252" section="2.2" sectionFormat="of" format="default"/>).</t>
        <t>DOTS agents <bcp14>MUST NOT</bcp14> send more than one UDP datagram per round-trip
        time (RTT) to the peer DOTS agent on average following the data
        transmission guidelines discussed in <xref target="RFC8085" section="3.1.3" sectionFormat="of" format="default"/>.</t>
        <t>Requests marked by the DOTS client as Non-confirmable messages are
        sent at regular intervals until a response is received from the DOTS
        server. If the DOTS client cannot maintain an RTT estimate, it <bcp14>MUST
        NOT</bcp14> send more than one Non-confirmable request every 3 seconds, and
        <bcp14>SHOULD</bcp14> use an even less aggressive rate whenever possible (case 2 in
        <xref target="RFC8085" section="3.1.3" sectionFormat="of" format="default"/>). Mitigation requests
        <bcp14>MUST NOT</bcp14> be delayed because of checks on probing rate 
(<xref target="RFC7252" section="4.7" sectionFormat="of" format="default"/>).</t>
        <t>JSON encoding of YANG  modeled data <xref target="RFC7951" format="default"/>
        is used to illustrate the various methods defined in the following
        subsections. Also, the examples use the Labels defined in Sections
        <xref format="counter" target="sc"/>, <xref format="counter" target="cs"/>, <xref format="counter" target="cc"/>, and
        <xref format="counter" target="as"/>.</t>
        <section anchor="post" numbered="true" toc="default">
          <name>Request Mitigation</name>
          <t>When a DOTS client requires mitigation for some reason, the DOTS
          client uses the CoAP PUT method to send a mitigation request to its
          DOTS server(s) (Figures <xref format="counter" target="Figure1"/> and <xref format="counter" target="Figure1c"/>).</t>
          <t>If a DOTS client is entitled to solicit the DOTS service, the
          DOTS server enables mitigation on behalf of the DOTS client by
          communicating the DOTS client's request to a mitigator (which may be
          co-located with the DOTS server) and relaying the feedback of the
          thus-selected mitigator to the requesting DOTS client.</t>
          <figure anchor="Figure1">
            <name>PUT to Convey DOTS Mitigation Requests</name>
<sourcecode><![CDATA[
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Uri-Path: "mid=123"
  Content-Format: "application/dots+cbor"

  {
    ...
  }
]]></sourcecode>
          </figure>
          <t>The order of the Uri-Path options is important as it defines the
          CoAP resource. In particular, 'mid' <bcp14>MUST</bcp14> follow 'cuid'.</t>
          <t>The additional Uri-Path parameters to those defined in <xref target="uri-path" format="default"/> are as follows:</t>
          <dl newline="false" spacing="normal" indent="6">
            <dt>cuid:</dt>
            <dd>
              <t>Stands for Client Unique Identifier. A
              globally unique identifier that is meant to prevent collisions
              among DOTS clients, especially those from the same domain. It
              <bcp14>MUST</bcp14> be generated by DOTS clients.</t>
              <t>For
              the reasons discussed in <xref target="motiv" format="default"/>,
              implementations <bcp14>SHOULD</bcp14> set 'cuid' using the following procedure:

   first, the DOTS client inputs one of the following into the 
   SHA-256 <xref target="RFC6234" format="default"/> cryptographic hash: the DER-encoded ASN.1 
   representation of the Subject Public Key Info (SPKI) of its X.509 
   certificate <xref target="RFC5280" format="default"/>, its raw public key <xref target="RFC7250" format="default"/>, the 
   "Pre-Shared Key (PSK) identity" it uses in the TLS 1.2 
   ClientKeyExchange message, or the "identity" it uses in the 
   "pre_shared_key" TLS 1.3 extension.

              Then, the output of
              the cryptographic hash algorithm is truncated to 16 bytes;
              truncation is done by stripping off the final 16 bytes. The
              truncated output is base64url encoded (<xref target="RFC4648" section="5" sectionFormat="of" format="default"/>) 
              with the trailing "=" removed from the
              encoding, and the resulting value used as the 'cuid'. </t>
              <t>The 'cuid' is intended to be stable when
              communicating with a given DOTS server, i.e., the 'cuid' used by
              a DOTS client <bcp14>SHOULD NOT</bcp14> change over time. Distinct 'cuid'
              values <bcp14>MAY</bcp14> be used by a single DOTS client per DOTS server.
              </t>
              <t>If a DOTS client has to change its
              'cuid' for some reason, it <bcp14>MUST NOT</bcp14> do so when mitigations are
              still active for the old 'cuid'. The 'cuid' <bcp14>SHOULD</bcp14> be 22
              characters to avoid DOTS signal message fragmentation over UDP.
              Furthermore, if that DOTS client created aliases and filtering
              entries at the DOTS server by means of the DOTS data channel, it
              <bcp14>MUST</bcp14> delete all the entries bound to the old 'cuid' and
              reinstall them using the new 'cuid'.</t>
              <t>DOTS servers <bcp14>MUST</bcp14> return 4.09 (Conflict) error
              code to a DOTS peer to notify that the 'cuid' is already in use
              by another DOTS client. Upon receipt of that error code, a new
              'cuid' <bcp14>MUST</bcp14> be generated by the DOTS peer (e.g., using <xref target="RFC4122" format="default"/>). </t>
              <t>Client-domain DOTS gateways <bcp14>MUST</bcp14> handle 'cuid'
              collision directly and it is <bcp14>RECOMMENDED</bcp14> that 'cuid' collision
              is handled directly by server-domain DOTS gateways.</t>
              <t>DOTS gateways <bcp14>MAY</bcp14> rewrite the 'cuid' used by
              peer DOTS clients. Triggers for such rewriting are out of scope.
              </t>
              <t>This is a mandatory Uri-Path
              parameter.</t>
            </dd>
            <dt>mid:</dt>
            <dd>
              <t>Identifier for the mitigation request
              represented with an integer. This identifier <bcp14>MUST</bcp14> be unique for
              each mitigation request bound to the DOTS client, i.e., the
              'mid' parameter value in the mitigation request needs to be
              unique (per 'cuid' and DOTS server) relative to the 'mid'
              parameter values of active mitigation requests conveyed from the
              DOTS client to the DOTS server.</t>
              <t>In order
              to handle out-of-order delivery of mitigation requests, 'mid'
              values <bcp14>MUST</bcp14> increase monotonically. </t>
              <t>If
              the 'mid' value has reached 3/4 of (2<sup>32</sup> - 1) (i.e.,
              3221225471) and no attack is detected, the DOTS client <bcp14>MUST</bcp14>
              reset 'mid' to 0 to handle 'mid' rollover. If the DOTS client
              maintains mitigation requests with preconfigured scopes, it
              <bcp14>MUST</bcp14> recreate them with the 'mid' restarting at 0. </t>
              <t>This identifier <bcp14>MUST</bcp14> be generated by the DOTS
              client.</t>
              <t>This is a mandatory Uri-Path
              parameter.</t>
            </dd>
          </dl>
          <t>'cuid' and 'mid' <bcp14>MUST NOT</bcp14> appear in the PUT request message body
          (<xref target="Figure1c" format="default"/>). The schema in <xref target="Figure1c" format="default"/> 
          uses the types defined in <xref target="mapping" format="default"/>. Note that this figure (and other similar
          figures depicting a schema) are non-normative sketches of the
          structure of the message.</t>
          <figure anchor="Figure1c">
            <name>PUT to Convey DOTS Mitigation Requests (Message Body Schema)</name>
            <sourcecode><![CDATA[
  {
    "ietf-dots-signal-channel:mitigation-scope": {
      "scope": [
        {
          "target-prefix": [
             "string"
           ],
          "target-port-range": [
             {
               "lower-port": number,
               "upper-port": number
             }
           ],     
           "target-protocol": [
             number
           ],
           "target-fqdn": [
             "string"
           ],
           "target-uri": [
             "string"
           ],
           "alias-name": [
             "string"
           ],
          "lifetime": number,
          "trigger-mitigation": true|false
        }
      ]
    }
  }
]]></sourcecode>
          </figure>
          <t>The parameters in the CBOR body (<xref target="Figure1c" format="default"/>)
          of the PUT request are described below:</t>
          <dl newline="false" spacing="normal">
            <dt>target-prefix:</dt>
            <dd>
              <t>A list of prefixes identifying
              resources under attack. Prefixes are represented using Classless
              Inter-Domain Routing (CIDR) notation <xref target="RFC4632" format="default"/>. </t>
              <t>As a
              reminder, the prefix length must be less than or equal to 32 (or
              128) for IPv4 (or IPv6).</t>
              <t>The prefix list
              <bcp14>MUST NOT</bcp14> include broadcast, loopback, or multicast addresses.
              These addresses are considered to be invalid values. In addition,
              the DOTS server <bcp14>MUST</bcp14> validate that target prefixes are within
              the scope of the DOTS client domain. Other validation checks may
              be supported by DOTS servers.</t>
              <t>This is an
              optional attribute.</t>
            </dd>
            <dt>target-port-range:</dt>
            <dd>
              <t>A list of port numbers bound to
              resources under attack. </t>
              <t>A port range is
              defined by two bounds, a lower port number ('lower-port') and an
              upper port number ('upper-port'). When only 'lower-port' is
              present, it represents a single port number. </t>
              <t>For TCP, UDP, Stream Control Transmission
              Protocol (SCTP) <xref target="RFC4960" format="default"/>, or Datagram
              Congestion Control Protocol (DCCP) <xref target="RFC4340" format="default"/>, a range of ports can be, for example,
              0-1023, 1024-65535, or 1024-49151. </t>
              <t>This
              is an optional attribute.</t>
            </dd>
            <dt>target-protocol:</dt>
            <dd>
              <t>A list of protocols involved in
              an attack. Values are taken from the IANA protocol registry
              <xref target="IANA-Proto" format="default"/>. </t>
              <t>If 'target-protocol' is not specified, then the
              request applies to any protocol. </t>
              <t>This
              is an optional attribute.</t>
            </dd>
            <dt>target-fqdn: </dt>
            <dd>
              <t>A list of Fully Qualified Domain
              Names (FQDNs) identifying resources under attack <xref target="RFC8499" format="default"/>.</t>
              <t>How a name is
              passed to an underlying name resolution library is
              implementation and deployment specific. Nevertheless, once the
              name is resolved into one or multiple IP addresses, DOTS servers
              <bcp14>MUST</bcp14> apply the same validation checks as those for
              'target-prefix'.</t>
              <t>The use of FQDNs may be
              suboptimal because:</t>
              <ul spacing="normal">
                <li>It induces both an extra load and increased delays on the
                  DOTS server to handle and manage DNS resolution
                  requests.</li>
                <li>It does not guarantee that the DOTS server will resolve a
                  name to the same IP addresses that the DOTS client does.</li>
              </ul>
              <t>This is an optional
              attribute.</t>
            </dd>
            <dt>target-uri: </dt>
            <dd>
              <t>A list of URIs <xref target="RFC3986" format="default"/> identifying
              resources under attack. </t>
              <t>The same
              validation checks used for 'target-fqdn' <bcp14>MUST</bcp14> be followed by
              DOTS servers to validate a target URI. </t>
              <t>This is an optional attribute.</t>
            </dd>
            <dt>alias-name:</dt>
            <dd>
              <t>A list of aliases of resources for
              which the mitigation is requested. Aliases can be created using
              the DOTS data channel (<xref target="RFC8783" section="6.1" sectionFormat="of" format="default"/>), direct
              configuration, or other means. </t>
              <t>An alias
              is used in subsequent signal channel exchanges to refer more
              efficiently to the resources under attack.</t>
              <t>This is an optional attribute.</t>
            </dd>
            <dt>lifetime: </dt>
            <dd>
              <t>Lifetime of the mitigation request in
              seconds. The <bcp14>RECOMMENDED</bcp14> lifetime of a mitigation request is
              3600 seconds: this value was chosen to be long enough so that
              refreshing is not typically a burden on the DOTS client, while
              still making the request expire in a timely manner when the
              client has unexpectedly quit. DOTS clients <bcp14>MUST</bcp14> include this
              parameter in their mitigation requests. Upon the expiry of this
              lifetime, and if the request is not refreshed, the mitigation
              request is removed. The request can be refreshed by sending the
              same request again. </t>
              <t>A lifetime of '0'
              in a mitigation request is an invalid value. </t>
              <t>A lifetime of negative one (-1) indicates
              indefinite lifetime for the mitigation request. The DOTS server
              <bcp14>MAY</bcp14> refuse an indefinite lifetime, for policy reasons; the granted
              lifetime value is returned in the response. DOTS clients <bcp14>MUST</bcp14> be
              prepared to not be granted mitigations with indefinite
              lifetimes.</t>
              <t>The DOTS server <bcp14>MUST</bcp14> always
              indicate the actual lifetime in the response and the remaining
              lifetime in status messages sent to the DOTS client. </t>
              <t>This is a mandatory attribute.</t>
            </dd>
            <dt>trigger-mitigation: </dt>
            <dd>
              <t>If the parameter value is set
              to 'false', DDoS mitigation will not be triggered for the
              mitigation request unless the DOTS signal channel session is
              lost. </t>
              <t>If the DOTS client ceases to
              respond to heartbeat messages, the DOTS server can detect that
              the DOTS signal channel session is lost. More details are
              discussed in <xref target="hb" format="default"/>.</t>
              <t>The default value of the parameter is 'true'
              (that is, the mitigation starts immediately). If
              'trigger-mitigation' is not present in a request, this is
              equivalent to receiving a request with 'trigger-mitigation' set
              to 'true'. </t>
              <t>This is an optional
              attribute.</t>
            </dd>
          </dl>
          <t>In deployments where server-domain DOTS gateways are enabled,
          identity information about the origin source client domain ('cdid')
          <bcp14>SHOULD</bcp14> be propagated to the DOTS server. That information is meant
          to assist the DOTS server in enforcing some policies such as grouping
          DOTS clients that belong to the same DOTS domain, limiting the
          number of DOTS requests, and identifying the mitigation scope. These
          policies can be enforced per client, per client domain, or both.
          Also, the identity information may be used for auditing and
          debugging purposes.</t>
          <t><xref target="Figure1a" format="default"/> shows an example of a request
          relayed by a server-domain DOTS gateway.</t>
          <figure anchor="Figure1a">
            <name>PUT for DOTS Mitigation Request as Relayed by a DOTS Gateway</name>
            <sourcecode><![CDATA[
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cdid=7eeaf349529eb55ed50113"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Uri-Path: "mid=123"
  Content-Format: "application/dots+cbor"

  {
    ...
  }
]]></sourcecode>
          </figure>
          <t>A server-domain DOTS gateway <bcp14>SHOULD</bcp14> add the following Uri-Path
          parameter:</t>
          <dl newline="false" spacing="normal" indent="6">
            <dt>cdid:</dt>
            <dd>
              <t>Stands for Client Domain Identifier. The
              'cdid' is conveyed by a server-domain DOTS gateway to propagate
              the source domain identity from the gateway's client-facing side
              to the gateway's server-facing side, and from the gateway's
              server-facing side to the DOTS server. 'cdid' may be used by the
              final DOTS server for policy enforcement purposes (e.g., enforce
              a quota on filtering rules). These policies are
              deployment specific. </t>
              <t>Server-domain DOTS
              gateways <bcp14>SHOULD</bcp14> support a configuration option to instruct
              whether 'cdid' parameter is to be inserted. </t>
              <t>In order to accommodate deployments that
              require enforcing per-client policies, per-client domain
              policies, or a combination thereof, server-domain DOTS gateways
              instructed to insert the 'cdid' parameter <bcp14>MUST</bcp14> supply the SPKI
              hash of the DOTS client X.509 certificate, the DOTS client raw
              public key, or the hash of the "PSK identity" in the 'cdid',
              following the same rules for generating the hash conveyed in
              'cuid', which is then used by the ultimate DOTS server to
              determine the corresponding client's domain.

	      The 'cdid'
              generated by a server-domain gateway is likely to be the same as
              the 'cuid' except the case in which the DOTS message was relayed by a
              client-domain DOTS gateway or the 'cuid' was generated from a
              rogue DOTS client. </t>
              <t>If a DOTS client is
              provisioned, for example, with distinct certificates as a
              function of the peer server-domain DOTS gateway, distinct 'cdid'
              values may be supplied by a server-domain DOTS gateway. The
              ultimate DOTS server <bcp14>MUST</bcp14> treat those 'cdid' values as
              equivalent. </t>
              <t>The 'cdid' attribute <bcp14>MUST
              NOT</bcp14> be generated and included by DOTS clients. </t>
              <t>DOTS servers <bcp14>MUST</bcp14> ignore 'cdid' attributes that
              are directly supplied by source DOTS clients or client-domain
              DOTS gateways. This implies that first server-domain DOTS
              gateways <bcp14>MUST</bcp14> strip 'cdid' attributes supplied by DOTS clients.
              DOTS servers <bcp14>SHOULD</bcp14> support a configuration parameter to
              identify DOTS gateways that are trusted to supply 'cdid'
              attributes.</t>
              <t>Only single-valued 'cdid'
              are defined in this document. That is, only the first on-path
              server-domain DOTS gateway can insert a 'cdid' value. This
              specification does not allow multiple server-domain DOTS
              gateways, whenever involved in the path, to insert a 'cdid'
              value for each server-domain gateway. </t>
              <t>This is an optional Uri-Path. When present,
              'cdid' <bcp14>MUST</bcp14> be positioned before 'cuid'.</t>
            </dd>
          </dl>
          <t>A DOTS gateway <bcp14>SHOULD</bcp14> add the CoAP Hop-Limit option <xref target="RFC8768" format="default"/>.</t>
          <t>Because of the complexity of handling partial failure cases, this
          specification does not allow the inclusion of multiple mitigation
          requests in the same PUT request. Concretely, a DOTS client <bcp14>MUST NOT</bcp14>
          include multiple entries in the 'scope' array of the same PUT
          request.</t>
          <t>FQDN and URI mitigation scopes may be thought of as a form of
          scope alias, in which the addresses associated with the domain name
          or URI (as resolved by the DOTS server) represent the scope of the
          mitigation. Particularly, the IP addresses to which the host
          subcomponent of authority component of a URI resolves represent the
          'target-prefix', the URI scheme represents the 'target-protocol',
          the port subcomponent of authority component of a URI represents
          the 'target-port-range'. If the optional port information is not
          present in the authority component, the default port defined for the
          URI scheme represents the 'target-port'.</t>
          <t>In the PUT request, at least one of the attributes
          'target-prefix', 'target-fqdn','target-uri', or 'alias-name' <bcp14>MUST</bcp14> be
          present.</t>
          <t>Attributes and Uri-Path parameters with empty values 
          <bcp14>MUST NOT</bcp14> be present in a request as an empty value
          will render the entire request invalid. </t>
          <t> <xref target="Figure2" format="default"/> shows a PUT 
   request example to signal that servers 2001:db8:6401::1
   and 2001:db8:6401::2 are receiving attack traffic on TCP port 
   numbers 80, 8080, and 443.
          The presence of 'cdid' indicates that a server-domain DOTS gateway has
          modified the initial PUT request sent by the DOTS client. Note that
          'cdid' <bcp14>MUST NOT</bcp14> appear in the PUT request message body.</t>
          <figure anchor="Figure2">
            <name>PUT for DOTS Mitigation Request (An Example)</name>
            <sourcecode><![CDATA[
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cdid=7eeaf349529eb55ed50113"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Uri-Path: "mid=123"
  Content-Format: "application/dots+cbor"

  {
    "ietf-dots-signal-channel:mitigation-scope": {
      "scope": [
        {
          "target-prefix": [
             "2001:db8:6401::1/128",
             "2001:db8:6401::2/128"
           ],
          "target-port-range": [
            { 
              "lower-port": 80
            },
            { 
              "lower-port": 443 
            },
            { 
               "lower-port": 8080
            }
           ],     
           "target-protocol": [
             6
           ],
          "lifetime": 3600
        }
      ]
    }
  }
]]></sourcecode>
          </figure>
          <t>The corresponding CBOR encoding format for the payload is shown
          in <xref target="Figure2a" format="default"/>.</t>
          <figure anchor="Figure2a">
            <name>PUT for DOTS Mitigation Request (CBOR)</name>
            <sourcecode><![CDATA[
   A1                                      # map(1)
      01                                   # unsigned(1)
      A1                                   # map(1)
         02                                # unsigned(2)
         81                                # array(1)
            A4                             # map(4)
               06                          # unsigned(6)
               82                          # array(2)
                  74                       # text(20)
                     323030313A6462383A363430313A3A312F313238
                  74                       # text(20)
                     323030313A6462383A363430313A3A322F313238
               07                          # unsigned(7)
               83                          # array(3)
                  A1                       # map(1)
                     08                    # unsigned(8)
                     18 50                 # unsigned(80)
                  A1                       # map(1)
                     08                    # unsigned(8)
                     19 01BB               # unsigned(443)
                  A1                       # map(1)
                     08                    # unsigned(8)
                     19 1F90               # unsigned(8080)
               0A                          # unsigned(10)
               81                          # array(1)
                  06                       # unsigned(6)
               0E                          # unsigned(14)
               19 0E10                     # unsigned(3600)
]]></sourcecode>
          </figure>
          <t>In both DOTS signal and data channel sessions, the DOTS client
          <bcp14>MUST</bcp14> authenticate itself to the DOTS server (<xref target="mutauth" format="default"/>). The DOTS server <bcp14>MAY</bcp14> use the algorithm
          presented in <xref target="RFC7589" section="7" sectionFormat="of" format="default"/> to derive
          the DOTS client identity or username from the client certificate.
          The DOTS client identity allows the DOTS server to accept mitigation
          requests with scopes that the DOTS client is authorized to
          manage.</t>
          <t>The DOTS server couples the DOTS signal and data channel sessions
          using the DOTS client identity and optionally the 'cdid' parameter
          value, so the DOTS server can validate whether the aliases conveyed
          in the mitigation request were indeed created by the same DOTS
          client using the DOTS data channel session. If the aliases were not
          created by the DOTS client, the DOTS server <bcp14>MUST</bcp14> return 4.00 (Bad
          Request) in the response.</t>
          <t>The DOTS server couples the DOTS signal channel sessions using
          the DOTS client identity and optionally the 'cdid' parameter value,
          and the DOTS server uses 'mid' and 'cuid' Uri-Path parameter values
          to detect duplicate mitigation requests. If the mitigation request
          contains the 'alias-name' and other parameters identifying the
          target resources (such as 'target-prefix', 'target-port-range',
          'target-fqdn', or 'target-uri'), the DOTS server appends the
          parameter values in 'alias-name' with the corresponding parameter
          values in 'target-prefix', 'target-port-range', 'target-fqdn', or
          'target-uri'.</t>
          <t>The DOTS server indicates the result of processing the PUT
          request using CoAP Response Codes. CoAP 2.xx codes are success. CoAP
          4.xx codes are some sort of invalid requests (client errors). COAP
          5.xx codes are returned if the DOTS server is in an error state or
          is currently unavailable to provide mitigation in response to the
          mitigation request from the DOTS client.</t>
          <t><xref target="put_response" format="default"/> shows an example response to
          a PUT request that is successfully processed by a DOTS server (i.e.,
          CoAP 2.xx Response Codes). This version of the specification forbids
          'cuid' and 'cdid' (if used) to be returned in a response message
          body.</t>
          <figure anchor="put_response">
            <name>2.xx Response Body</name>
            <sourcecode><![CDATA[
{
  "ietf-dots-signal-channel:mitigation-scope": {
     "scope": [
        {
          "mid": 123,
          "lifetime": 3600
        }
      ]
   }
}
]]></sourcecode>
          </figure>
          <t>If the request is missing a mandatory attribute, does not include
          'cuid' or 'mid' Uri-Path options, includes multiple 'scope'
          parameters, or contains invalid or unknown parameters, the DOTS
          server <bcp14>MUST</bcp14> reply with 4.00 (Bad Request). DOTS agents can safely
          ignore comprehension-optional parameters they don't understand
          (<xref target="format" format="default"/>).</t>
          <t>A DOTS server that receives a mitigation request with a 'lifetime'
          set to '0' <bcp14>MUST</bcp14> reply with a 4.00 (Bad Request).</t>
          <t>If the DOTS server does not find the 'mid' parameter value
          conveyed in the PUT request in its configuration data, it <bcp14>MAY</bcp14> accept
          the mitigation request by sending back a 2.01 (Created) response to
          the DOTS client; the DOTS server will consequently try to mitigate
          the attack. A DOTS server could reject mitigation requests when it
          is near capacity or needs to rate-limit a particular client, for
          example.</t>
          <t>The relative order of two mitigation requests with the same
          'trigger-mitigation' type from a DOTS client is determined by
          comparing their respective 'mid' values. If two mitigation requests
          with the same 'trigger-mitigation' type have overlapping mitigation
          scopes, the mitigation request with the highest numeric 'mid' value
          will override the other mitigation request. 
    Two mitigation requests from a DOTS client have overlapping
    scopes if there is a common IP address, IP prefix, FQDN, URI,
    or alias.  To avoid maintaining a
          long list of overlapping mitigation requests (i.e., requests with
          the same 'trigger-mitigation' type and overlapping scopes) from a
          DOTS client and to avoid error-prone provisioning of mitigation
          requests from a DOTS client, the overlapped lower numeric 'mid' <bcp14>MUST</bcp14>
          be automatically deleted and no longer available at the DOTS server.
          For example, if the DOTS server receives a mitigation request that 
          overlaps with an existing mitigation with a higher numeric 'mid',
          the DOTS server rejects the request by returning 4.09 (Conflict) to
          the DOTS client. The response includes enough information for a DOTS
          client to recognize the source of the conflict as described below in
          the 'conflict-information' subtree with only the relevant nodes
          listed:</t>
          <dl newline="false" spacing="normal">
            <dt>conflict-information:</dt>
            <dd>
              <t>Indicates that a mitigation
              request is conflicting with another mitigation request. This
              optional attribute has the following structure: </t>
              <dl newline="false" spacing="normal">

                <dt>conflict-cause:</dt>
                <dd>
                  <t>Indicates the cause of the
                  conflict. The following values are defined:</t>
                  <dl spacing="normal" indent="4">
                    <dt>1:</dt>
                    <dd>Overlapping targets. 'conflict-scope' provides more
                      details about the conflicting target clauses.</dd>
                  </dl>
                </dd>
                <dt>conflict-scope:</dt>
                <dd>Characterizes the exact
                  conflict scope. 
    It may include a list of IP addresses, a list of prefixes,
    a list of port numbers, a list of target protocols, a list
    of FQDNs, a list of URIs, a list of aliases, or a 'mid'.
                </dd>
              </dl>
            </dd>
          </dl>
          <t>If the DOTS server receives a mitigation request that overlaps
          with an active mitigation request, but both have distinct
          'trigger-mitigation' types, the DOTS server <bcp14>SHOULD</bcp14> deactivate
          (absent explicit policy/configuration otherwise) the mitigation
          request with 'trigger-mitigation' set to 'false'. Particularly, if the
          mitigation request with 'trigger-mitigation' set to 'false' is active,
          the DOTS server withdraws the mitigation request (i.e., status code
          is set to '7' as defined in <xref target="status" format="default"/>) and
          transitions the status of the mitigation request to '8'.</t>
          <t>Upon DOTS signal channel session loss with a peer DOTS client,
          the DOTS server <bcp14>SHOULD</bcp14> withdraw (absent explicit
          policy/configuration otherwise) any active mitigation requests
          that overlap with mitigation requests having 'trigger-mitigation' set
          to 'false' from that DOTS client, as the loss of the session
          implicitly activates these preconfigured mitigation requests, and
          they take precedence. Note that the active-but-terminating period is not
          observed for mitigations withdrawn at the initiative of the DOTS
          server.</t>
          <t>DOTS clients may adopt various strategies for setting the scopes
          of immediate and preconfigured mitigation requests to avoid
          potential conflicts. For example, a DOTS client may tweak
          preconfigured scopes so that the scope of any overlapping immediate
          mitigation request will be a subset of the preconfigured scopes.
          Also, if an immediate mitigation request overlaps with any of the
          preconfigured scopes, the DOTS client sets the scope of the
          overlapping immediate mitigation request to be a subset of the
          preconfigured scopes, so as to get a broad mitigation when the DOTS
          signal channel collapses and to maximize the chance of recovery.</t>
          <t>If the request conflicts with an existing mitigation request
          from a different DOTS client, the DOTS server may return 2.01
          (Created) or 4.09 (Conflict) to the requesting DOTS client. If the
          DOTS server decides to maintain the new mitigation request, the DOTS
          server returns 2.01 (Created) to the requesting DOTS client. If the
          DOTS server decides to reject the new mitigation request, the DOTS
          server returns 4.09 (Conflict) to the requesting DOTS client. For
          both 2.01 (Created) and 4.09 (Conflict) responses, the response
          includes enough information for a DOTS client to recognize the
          source of the conflict as described below:</t>

          <dl newline="false" spacing="normal">
            <dt>conflict-information:</dt>
            <dd>
              <t>Indicates that a mitigation
              request is conflicting with another mitigation request(s) from
              other DOTS client(s). This optional attribute has the following
              structure: </t>
              <dl newline="false" spacing="normal">
                <dt>conflict-status:</dt>
                <dd>
                  <t>Indicates the status of a
                  conflicting mitigation request. The following values are
                  defined:</t>
                  <dl spacing="normal" indent="4">
                    <dt>1:</dt>
                    <dd>DOTS server has detected conflicting mitigation
                      requests from different DOTS clients. This mitigation
                      request is currently inactive until the conflicts are
                      resolved.  Another mitigation request is active.</dd>
                    <dt>2:</dt>
                    <dd>DOTS server has detected conflicting mitigation
                      requests from different DOTS clients. This mitigation
                      request is currently active.</dd>
                    <dt>3:</dt>
                    <dd>DOTS server has detected conflicting mitigation
                      requests from different DOTS clients. All conflicting
                      mitigation requests are inactive.</dd>
                  </dl>
                </dd>
                <dt>conflict-cause:</dt>
                <dd>
                  <t>Indicates the cause of the
                  conflict. The following values are defined:</t>
                  <dl spacing="normal" indent="4">
                    <dt>1:</dt>
                    <dd>Overlapping targets. 'conflict-scope' provides more
                      details about the conflicting target clauses.</dd>
                    <dt>2:</dt>
                    <dd>Conflicts with an existing accept-list. This code is
                      returned when the DDoS mitigation detects source
                      addresses/prefixes in the accept-listed ACLs are
                      attacking the target.</dd>
                    <dt>3:</dt>
                    <dd>CUID Collision. This code is returned when a DOTS
                      client uses a 'cuid' that is already used by another
                      DOTS client. This code is an indication that the request
                      has been rejected and a new request with a new 'cuid' is
                      to be re-sent by the DOTS client (see the example shown
                      in <xref target="newcuid" format="default"/>). Note that
                      'conflict-status', 'conflict-scope', and 'retry-timer'
                      <bcp14>MUST NOT</bcp14> be returned in the error response.</dd>
                  </dl>
                </dd>
                <dt>conflict-scope:</dt>
                <dd>Characterizes the exact
                  conflict scope. It may include a list of IP addresses, a
                  list of prefixes, a list of port numbers, a list of target
                  protocols, a list of FQDNs, a list of URIs, a list of
                  aliases, or references to conflicting ACLs (by an
                  'acl-name', typically <xref target="RFC8783" format="default"/>).</dd>
                <dt>retry-timer:</dt>
                <dd>
                  <t>Indicates, in seconds, the time
                  after which the DOTS client may reissue the same request.
                  The DOTS server returns 'retry-timer' only to DOTS client(s)
                  for which a mitigation request is deactivated. Any
                  retransmission of the same mitigation request before the
                  expiry of this timer is likely to be rejected by the DOTS
                  server for the same reasons.</t>
                  <t>The
                  'retry-timer' <bcp14>SHOULD</bcp14> be equal to the lifetime of the active
                  mitigation request resulting in the deactivation of the
                  conflicting mitigation request. </t>
                  <t>If
                  the DOTS server decides to maintain a state for the
                  deactivated mitigation request, the DOTS server updates the
                  lifetime of the deactivated mitigation request to
                  'retry-timer + 45 seconds' (that is, this mitigation request
                  remains deactivated for the entire duration of 'retry-timer
                  + 45 seconds') so that the DOTS client can refresh the
                  deactivated mitigation request after 'retry-timer' seconds,
                  but before the expiry of the lifetime, and check if the
                  conflict is resolved.</t>
                </dd>
              </dl>
            </dd>
          </dl>
          <figure anchor="newcuid">
            <name>Example of Generating a New 'cuid'</name>
            <sourcecode><![CDATA[
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=7eeaf349529eb55ed50113"
  Uri-Path: "mid=12"

  (1) Request with a conflicting 'cuid'

  {
    "ietf-dots-signal-channel:mitigation-scope": {
       "scope": [
          {
            "conflict-information": {
              "conflict-cause": "cuid-collision"
             }
          }
        ]
     }
  }

  (2) Message body of the 4.09 (Conflict) response
    from the DOTS server

  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=f30d281ce6b64fc5a0b91e"                  
  Uri-Path: "mid=12"

  (3) Request with a new 'cuid']]></sourcecode>
          </figure>
          <t>As an active attack evolves,
          DOTS clients can adjust the scope of requested mitigation as
          necessary, by refining the scope of resources requiring mitigation.
          This can be achieved by sending a PUT request with a new 'mid' value
          that will override the existing one with overlapping mitigation
          scopes.</t>
          <t>For a mitigation request to
          continue beyond the initial negotiated lifetime, the DOTS client has
          to refresh the current mitigation request by sending a new PUT
          request. This PUT request <bcp14>MUST</bcp14> use the same
	  'mid' value, and it <bcp14>MUST</bcp14>
          repeat all the other parameters as sent in the original mitigation
          request apart from a possible change to the 'lifetime' parameter
          value. In such a case, the DOTS server <bcp14>MAY</bcp14> update the mitigation
          request, and a 2.04 (Changed) response is returned to indicate a
          successful update of the mitigation request. If this is not the
          case, the DOTS server <bcp14>MUST</bcp14> reject the request with a 4.00 (Bad
          Request).</t>
        </section>
        <section anchor="get" numbered="true" toc="default">
          <name>Retrieve Information Related to a Mitigation</name>
          <t>A GET request is used by a DOTS client to retrieve information
          (including status) of DOTS mitigations from a DOTS server.</t>
          <t>'cuid' is a mandatory Uri-Path parameter for GET requests.</t>
          <t>Uri-Path parameters with empty values <bcp14>MUST NOT</bcp14> be present in a
          request.</t>
          <t>The same considerations for manipulating the 'cdid' parameter by
          server-domain DOTS gateways specified in <xref target="post" format="default"/>
          <bcp14>MUST</bcp14> be followed for GET requests.</t>
          <t>The 'c' Uri-Query option is used to control selection of
          configuration and non-configuration data nodes. Concretely, the 'c'
          (content) parameter and its permitted values defined in 
          <xref target="tab-option-controls" format="default"/> <xref target="I-D.ietf-core-comi" format="default"/> can be
          used to retrieve non-configuration data (attack mitigation status),
          configuration data, or both. The DOTS server <bcp14>MAY</bcp14> support this
          optional filtering capability. It can safely ignore it if not
          supported. If the DOTS client supports the optional filtering
          capability, it <bcp14>SHOULD</bcp14> use "c=n" query (to get back only the
          dynamically changing data) or "c=c" query (to get back the static
          configuration values) when the DDoS attack is active to limit the
          size of the response.</t>
          <table anchor="tab-option-controls" align="center">
          <name>Permitted Values of the 'c' Parameter</name>
            <thead>
              <tr>
                <th align="left">Value</th>
                <th align="left">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">c</td>
                <td align="left">Return only configuration descendant data nodes</td>
              </tr>
              <tr>
                <td align="left">n</td>
                <td align="left">Return only non-configuration descendant data nodes</td>
              </tr>
              <tr>
                <td align="left">a</td>
                <td align="left">Return all descendant data nodes</td>
              </tr>
            </tbody>
          </table>
          <t>The DOTS client can use block-wise transfer <xref target="RFC7959" format="default"/> to get the list of all its mitigations
          maintained by a DOTS server, it can send a Block2 Option in a GET
          request with NUM = 0 to aid in limiting the size of the response. If
          the representation of all the active mitigation requests associated
          with the DOTS client does not fit within a single datagram, the DOTS
          server <bcp14>MUST</bcp14> use the Block2 Option with NUM = 0 in the GET response.
          The Size2 Option may be conveyed in the response to indicate the
          total size of the resource representation. The DOTS client retrieves
          the rest of the representation by sending additional GET requests
          with Block2 Options containing NUM values greater than zero. The
          DOTS client <bcp14>MUST</bcp14> adhere to the block size preferences indicated by
          the DOTS server in the response. If the DOTS server uses the Block2
          Option in the GET response, and the response is for a dynamically
          changing resource (e.g., "c=n" or "c=a" query), the DOTS server <bcp14>MUST</bcp14>
          include the ETag Option in the response. The DOTS client <bcp14>MUST</bcp14>
          include the same ETag value in subsequent GET requests to retrieve
          the rest of the representation.</t>
          <t>The following examples illustrate how a DOTS client retrieves
          active mitigation requests from a DOTS server. In particular: </t>
          <ul spacing="normal">
            <li>
              <xref target="Figure4" format="default"/> shows the example of a GET
              request to retrieve all DOTS mitigation requests signaled by a
              DOTS client.</li>
            <li>
              <xref target="Figure4a" format="default"/> shows the example of a GET
              request to retrieve a specific DOTS mitigation request signaled
              by a DOTS client. The configuration data to be reported in the
              response is formatted in the same order as it was processed by the
              DOTS server in the original mitigation request.</li>
          </ul>
          <t>These two examples assume the default of "c=a"; that is, the DOTS
          client asks for all data to be reported by the DOTS server.</t>
          <figure anchor="Figure4">
            <name>GET to Retrieve All DOTS Mitigation Requests</name>
            <sourcecode><![CDATA[
  Header: GET (Code=0.01)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Observe: 0
]]></sourcecode>
          </figure>
          <figure anchor="Figure4a">
            <name>GET to Retrieve a Specific DOTS Mitigation Request</name>
            <sourcecode><![CDATA[  
  Header: GET (Code=0.01)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Uri-Path: "mid=12332"
  Observe: 0
]]></sourcecode>
          </figure>
          <t>If the DOTS server does not find the 'mid' Uri-Path value
          conveyed in the GET request in its configuration data for the
          requesting DOTS client, it <bcp14>MUST</bcp14> respond with a 4.04 (Not Found)
          error Response Code. Likewise, the same error <bcp14>MUST</bcp14> be returned as a
          response to a request to retrieve all mitigation records (i.e.,
          'mid' Uri-Path is not defined) of a given DOTS client if the DOTS
          server does not find any mitigation record for that DOTS client. As
          a reminder, a DOTS client is identified by its identity (e.g.,
          client certificate, 'cuid') and optionally the 'cdid'.</t>
          <t><xref target="Figure5" format="default"/> shows a response example of all
          active mitigation requests associated with the DOTS client as
          maintained by the DOTS server. The response indicates the mitigation
          status of each mitigation request.</t>
          <figure anchor="Figure5">
            <name>Response Body to a GET Request</name>
            <sourcecode><![CDATA[
{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "mid": 12332,
        "mitigation-start": "1507818434",
        "target-prefix": [
             "2001:db8:6401::1/128",
             "2001:db8:6401::2/128"
        ],
        "target-protocol": [
          17
        ],
        "lifetime": 1756,
        "status": "attack-successfully-mitigated",
        "bytes-dropped": "134334555",
        "bps-dropped": "43344",
        "pkts-dropped": "333334444",
        "pps-dropped": "432432"
      },
      {
        "mid": 12333,
        "mitigation-start": "1507818393",
        "target-prefix": [
             "2001:db8:6401::1/128",
             "2001:db8:6401::2/128"
        ],
        "target-protocol": [
          6
        ],
        "lifetime": 1755,
        "status": "attack-stopped",
        "bytes-dropped": "0",
        "bps-dropped": "0",
        "pkts-dropped": "0",
        "pps-dropped": "0"
      }
    ]
  }
}]]></sourcecode>
          </figure>
          <t>The mitigation status parameters are described below:</t>
          <dl newline="false" spacing="normal">
            <dt>mitigation-start:</dt>
            <dd>
              <t>Mitigation start time is
              expressed in seconds relative to 1970-01-01T00:00Z in UTC time
              (<xref target="RFC7049" section="2.4.1" sectionFormat="of" format="default"/>). The CBOR
              encoding is modified so that the leading tag 1 (epoch-based
              date/time) <bcp14>MUST</bcp14> be omitted.</t>
              <t>This is a
              mandatory attribute when an attack mitigation is active.
              Particularly, 'mitigation-start' is not returned for a
              mitigation with 'status' code set to 8.</t>
            </dd>
            <dt>lifetime:</dt>
            <dd>
              <t>The remaining lifetime of the mitigation
              request, in seconds.</t>
              <t>This is a mandatory
              attribute.</t>
            </dd>
            <dt>status:</dt>
            <dd>
              <t>Status of attack mitigation. The various
              possible values of 'status' parameter are explained in <xref target="status" format="default"/>.</t>
              <t>This is a
              mandatory attribute.</t>
            </dd>
            <dt>bytes-dropped:</dt>
            <dd>
              <t>The total dropped byte count for
              the mitigation request since the attack mitigation was triggered.
              The count wraps around when it reaches the maximum value of
              unsigned integer64. </t>
              <t>This is an optional
              attribute.</t>
            </dd>
            <dt>bps-dropped:</dt>
            <dd>
              <t>The average number of dropped bytes
              per second for the mitigation request since the attack
              mitigation was triggered. This average <bcp14>SHOULD</bcp14> be over five-minute
              intervals (that is, measuring bytes into five-minute buckets and
              then averaging these buckets over the time since the mitigation
              was triggered). </t>
              <t>This is an optional
              attribute.</t>
            </dd>
            <dt>pkts-dropped:</dt>
            <dd>
              <t>The total number of dropped packet
              count for the mitigation request since the attack mitigation was
              triggered. The count wraps around when it reaches the maximum
              value of unsigned integer64.</t>
              <t>This is an
              optional attribute.</t>
            </dd>
            <dt>pps-dropped:</dt>
            <dd>
              <t>The average number of dropped packets
              per second for the mitigation request since the attack
              mitigation was triggered. This average <bcp14>SHOULD</bcp14> be over five-minute
              intervals (that is, measuring packets into five-minute buckets
              and then averaging these buckets over the time since the
              mitigation was triggered).</t>
              <t>This is an
              optional attribute.</t>
            </dd>
          </dl>
          <table anchor="status" align="center">
            <name>Values of 'status' Parameter</name>
            <thead>
              <tr>
                <th align="right">Parameter Value</th>
                <th align="left">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right">1</td>
                <td align="left">Attack mitigation setup is in progress (e.g., changing the
            network path to redirect the inbound traffic to a DOTS
            mitigator).</td>
              </tr>
              <tr>
                <td align="right">2</td>
                <td align="left">Attack is being successfully mitigated (e.g., traffic is
            redirected to a DDoS mitigator and attack traffic is dropped).</td>
              </tr>
              <tr>
                <td align="right">3</td>
                <td align="left">Attack has stopped and the DOTS client can withdraw the
            mitigation request. This status code will be transmitted for
            immediate mitigation requests till the mitigation is withdrawn or
            the lifetime expires. For mitigation requests with preconfigured
            scopes (i.e., 'trigger-mitigation' set to 'false'), this status
            code will be transmitted four times and then transition to "8".</td>
              </tr>
              <tr>
                <td align="right">4</td>
                <td align="left">Attack has exceeded the mitigation provider capability.</td>
              </tr>
              <tr>
                <td align="right">5</td>
                <td align="left">DOTS client has withdrawn the mitigation request and the
            mitigation is active but terminating.</td>
              </tr>
              <tr>
                <td align="right">6</td>
                <td align="left">Attack mitigation is now terminated.</td>
              </tr>
              <tr>
                <td align="right">7</td>
                <td align="left">Attack mitigation is withdrawn (by the DOTS server). If a
            mitigation request with 'trigger-mitigation' set to 'false' is
            withdrawn because it overlaps with an immediate mitigation
            request, this status code will be transmitted four times and then
            transition to "8" for the mitigation request with preconfigured
            scopes.</td>
              </tr>
              <tr>
                <td align="right">8</td>
                <td align="left">Attack mitigation will be triggered for the mitigation request
            only when the DOTS signal channel session is lost.</td>
              </tr>
            </tbody>
          </table>
          <section numbered="true" toc="default">
            <name>DOTS Servers Sending Mitigation Status</name>
            <t>The Observe Option defined in <xref target="RFC7641" format="default"/>
            extends the CoAP core protocol with a mechanism for a CoAP client
            to "observe" a resource on a CoAP server: the client retrieves a
            representation of the resource and requests this representation be
            updated by the server as long as the client is interested in the
            resource. DOTS implementations <bcp14>MUST</bcp14> use the Observe Option for
            both 'mitigate' and 'config' (<xref target="uri-path" format="default"/>).</t>
            <t>A DOTS client conveys the Observe Option set to '0' in the GET
            request to receive asynchronous notifications of attack mitigation
            status from the DOTS server.</t>
            <t>Unidirectional mitigation notifications within the
            bidirectional signal channel enables asynchronous notifications
            between the agents. <xref target="RFC7641" format="default"/> indicates that
            (1) a notification can be sent in a Confirmable or a
            Non-confirmable message, and (2) the message type used is
            typically application dependent and may be determined by the
            server for each notification individually. For the DOTS server
            application, the message type <bcp14>MUST</bcp14> always be set to
            Non-confirmable even if the underlying COAP library elects a
            notification to be sent in a Confirmable message. This overrides
            the behavior defined in <xref target="RFC7641" section="4.5" sectionFormat="of" format="default"/> to send a Confirmable message instead of
            a Non-confirmable message at least every 24 hours for the following
            reasons: First, the DOTS signal channel uses a heartbeat mechanism
            to determine if the DOTS client is alive. Second, Confirmable
            messages are not suitable during an attack.</t>
            <t>Due to the higher likelihood of packet loss during a DDoS
            attack, the DOTS server periodically sends attack mitigation
            status to the DOTS client and also notifies the DOTS client
            whenever the status of the attack mitigation changes. If the DOTS
            server cannot maintain an RTT estimate, it <bcp14>MUST NOT</bcp14> send more than
            one asynchronous notification every 3 seconds, and <bcp14>SHOULD</bcp14> use an
            even less aggressive rate whenever possible (case 2 in 
            <xref target="RFC8085" section="3.1.3" sectionFormat="of" format="default"/>).</t>
            <t>When conflicting requests are detected, the DOTS server enforces the
            corresponding policy (e.g., accept all requests, reject all
            requests, accept only one request but reject all the others, etc.).
            It is assumed that this policy is supplied by the DOTS server
            administrator or that it is a default behavior of the DOTS server
            implementation. Then, the DOTS server sends a notification
            message(s) to the DOTS client(s) at the origin of the conflict
            (refer to the conflict parameters defined in <xref target="post" format="default"/>). A conflict notification message includes
            information about the conflict cause, scope, and the status of the
            mitigation request(s). For example:</t>
            <ul spacing="normal">
              <li>A notification message with 'status' code set to '7 (Attack
                mitigation is withdrawn)' and 'conflict-status' set to '1' is
                sent to a DOTS client to indicate that an active mitigation
                request is deactivated because a conflict is detected.</li>
              <li>A notification message with 'status' code set to '1 (Attack
                mitigation is in progress)' and 'conflict-status' set to '2'
                is sent to a DOTS client to indicate that this mitigation
                request is in progress, but a conflict is detected.</li>
            </ul>
            <t>Upon receipt of a conflict notification message indicating that
            a mitigation request is deactivated because of a conflict, a DOTS
            client <bcp14>MUST NOT</bcp14> resend the same mitigation request before the
            expiry of 'retry-timer'. It is also recommended that DOTS clients
            support the means to alert administrators about mitigation
            conflicts.</t>
            <t>A DOTS client that is no longer interested in receiving
            notifications from the DOTS server can simply "forget" the
            observation. When the DOTS server sends the next notification, the
            DOTS client will not recognize the token in the message and, thus,
            will return a Reset message. This causes the DOTS server to remove
            the associated entry. Alternatively, the DOTS client can
            explicitly de-register itself by issuing a GET request that has the
            Token field set to the token of the observation to be  canceled
            and includes an Observe Option with the value set to '1'
            (de-register). The latter is more deterministic and, thus, is
            <bcp14>RECOMMENDED</bcp14>.</t>
            <t><xref target="Figure6" format="default"/> shows an example of a DOTS
            client requesting a DOTS server to send notifications related to a
            mitigation request. Note that for mitigations with preconfigured
            scopes (i.e., 'trigger-mitigation' set to 'false'), the state will
            need to transition from 3 (attack-stopped) to 8
            (attack-mitigation-signal-loss).</t>
            <figure anchor="Figure6">
              <name>Notifications of Attack Mitigation Status</name>
              <artwork align="center" name="" type="" alt=""><![CDATA[
+-----------+                              +-----------+
|DOTS Client|                              |DOTS Server|
+-----------+                              +-----------+
      |                                          |
      |  GET /<mid>                              |
      |  Token: 0x4a                             | Registration
      |  Observe: 0                              |
      +----------------------------------------->|
      |                                          |
      |  2.05 Content                            |
      |  Token: 0x4a                             | Notification of 
      |  Observe: 12                             | the current state
      |  status: "attack-mitigation-in-progress" |  
      |<-----------------------------------------+
      |                                          |
      |  2.05 Content                            |
      |  Token: 0x4a                             | Notification upon
      |  Observe: 44                             | a state change
      |  status: "attack-successfully-mitigated" |  
      |<-----------------------------------------+
      |                                          |
      |  2.05 Content                            |
      |  Token: 0x4a                             | Notification upon
      |  Observe: 60                             | a state change
      |  status: "attack-stopped"                |  
      |<-----------------------------------------+
      |                                          |
                         ...
]]></artwork>
            </figure>
          </section>
          <section numbered="true" toc="default">
            <name>DOTS Clients Polling for Mitigation Status</name>
            <t>The DOTS client can send the GET request at frequent intervals
            without the Observe Option to retrieve the configuration data of
            the mitigation request and non-configuration data (i.e., the
            attack status). DOTS clients <bcp14>MAY</bcp14> be configured with a policy
            indicating the frequency of polling DOTS servers to get the
            mitigation status. This frequency <bcp14>MUST NOT</bcp14> be more than one UDP
            datagram per RTT as discussed in <xref target="RFC8085" section="3.1.3" sectionFormat="of" format="default"/>.</t>
            <t>If the DOTS server has been able to mitigate the attack and the
            attack has stopped, the DOTS server indicates as such in the
            status. In such case, the DOTS client recalls the mitigation
            request by issuing a DELETE request for this mitigation request
            (<xref target="del" format="default"/>).</t>
            <t>A DOTS client <bcp14>SHOULD</bcp14> react to the status of the attack per
            the information sent by the DOTS server rather than performing its
            own detection that the attack has been mitigated. This ensures
            that the DOTS client does not recall a mitigation request
            prematurely because it is possible that the DOTS client does not
            sense the DDoS attack on its resources, but the DOTS server could
            be actively mitigating the attack because the attack is not
            completely averted.</t>
          </section>
        </section>
        <section anchor="put" numbered="true" toc="default">
          <name>Efficacy Update from DOTS Clients</name>
          <t>While DDoS mitigation is in progress, due to the likelihood of
          packet loss, a DOTS client <bcp14>MAY</bcp14> periodically transmit DOTS mitigation
          efficacy updates to the relevant DOTS server. A PUT request is used
          to convey the mitigation efficacy update to the DOTS server. This
          PUT request is treated as a refresh of the current mitigation.</t>
          <t>The PUT request used for the efficacy update <bcp14>MUST</bcp14> include all the
          parameters used in the PUT request to carry the DOTS mitigation
          request (<xref target="post" format="default"/>) unchanged apart from the
          'lifetime' parameter value. If this is not the case, the DOTS server
          <bcp14>MUST</bcp14> reject the request with a 4.00 (Bad Request).</t>
          <t>The If-Match Option (<xref target="RFC7252" section="5.10.8.1" sectionFormat="of" format="default"/>) with an empty value is used to make the
          PUT request conditional on the current existence of the mitigation
          request. If UDP is used as transport, CoAP requests may arrive
          out of order. For example, the DOTS client may send a PUT request to
          convey an efficacy update to the DOTS server followed by a DELETE
          request to withdraw the mitigation request, but the DELETE request
          arrives at the DOTS server before the PUT request. To handle
          out-of-order delivery of requests, if an If-Match Option is present
          in the PUT request and the 'mid' in the request matches a mitigation
          request from that DOTS client, the request is processed by the DOTS
          server. If no match is found, the PUT request is silently ignored by
          the DOTS server.</t>
          <t>An example of an efficacy update message, which includes an
          If-Match Option with an empty value, is depicted in <xref target="Figure7" format="default"/>.</t>
          <figure anchor="Figure7">
            <name>An Example of Efficacy Update</name>
            <sourcecode><![CDATA[
   Header: PUT (Code=0.03)
   Uri-Path: ".well-known"
   Uri-Path: "dots"
   Uri-Path: "mitigate"
   Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
   Uri-Path: "mid=123"
   If-Match: 
   Content-Format: "application/dots+cbor"

   {
    "ietf-dots-signal-channel:mitigation-scope": {
      "scope": [
        {
          "target-prefix": [
             "2001:db8:6401::1/128",
             "2001:db8:6401::2/128"
           ],
          "target-port-range": [
            { 
              "lower-port": 80
            },
            { 
              "lower-port": 443 
            },
            { 
               "lower-port": 8080
            }
          ],     
          "target-protocol": [
             6
          ],
          "attack-status": "under-attack"
        }
      ]
    }
   }]]></sourcecode>
          </figure>
          <t>The 'attack-status' parameter is a mandatory attribute when
          performing an efficacy update. The various possible values contained
          in the 'attack-status' parameter are described in <xref target="astatus" format="default"/>.</t>
          <table anchor="astatus" align="center">
            <name>Values of 'attack-status' Parameter</name>
            <thead>
              <tr>
                <th align="right">Parameter Value</th>
                <th align="left">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right">1</td>
                <td align="left">The DOTS client determines that it is still under attack.</td>
              </tr>
              <tr>
                <td align="right">2</td>
                <td align="left">The DOTS client determines that the attack is successfully
            mitigated (e.g., attack traffic is not seen).</td>
              </tr>
            </tbody>
          </table>
          <t>The DOTS server indicates the result of processing a PUT request
          using CoAP Response Codes. The Response Code 2.04 (Changed) is
          returned if the DOTS server has accepted the mitigation efficacy
          update. The error Response Code 5.03 (Service Unavailable) is
          returned if the DOTS server has erred or is incapable of performing
          the mitigation. As specified in <xref target="RFC7252" format="default"/>, 5.03
          uses Max-Age Option to indicate the number of seconds after which to
          retry.</t>
        </section>
        <section anchor="del" numbered="true" toc="default">
          <name>Withdraw a Mitigation</name>
          <t>DELETE requests are used to withdraw DOTS mitigation requests
          from DOTS servers (<xref target="Figure3" format="default"/>).</t>
          <t>'cuid' and 'mid' are mandatory Uri-Path parameters for DELETE
          requests.</t>
          <t>The same considerations for manipulating 'cdid' parameter by DOTS
          gateways, as specified in <xref target="post" format="default"/>, <bcp14>MUST</bcp14> be
          followed for DELETE requests. Uri-Path parameters with empty values
          <bcp14>MUST NOT</bcp14> be present in a request.</t>
          <figure anchor="Figure3">
            <name>Withdraw a DOTS Mitigation</name>
            <sourcecode><![CDATA[
  Header: DELETE (Code=0.04)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Uri-Path: "mid=123"
]]></sourcecode>
          </figure>
          <t>If the DELETE request does not include 'cuid' and 'mid'
          parameters, the DOTS server <bcp14>MUST</bcp14> reply with a 4.00 (Bad
          Request).</t>
          <t>Once the request is validated, the DOTS server immediately
          acknowledges a DOTS client's request to withdraw the DOTS signal
          using 2.02 (Deleted) Response Code with no response payload. A 2.02
          (Deleted) Response Code is returned even if the 'mid' parameter
          value conveyed in the DELETE request does not exist in its
          configuration data before the request.</t>
          <t>If the DOTS server finds the 'mid' parameter value conveyed in
          the DELETE request in its configuration data for the DOTS client,
          then to protect against route or DNS flapping caused by a DOTS
          client rapidly removing a mitigation, and to dampen the effect of
          oscillating attacks, the DOTS server <bcp14>MAY</bcp14> allow mitigation to
          continue for a limited period after acknowledging a DOTS client's
          withdrawal of a mitigation request. During this period, the DOTS
          server status messages <bcp14>SHOULD</bcp14> indicate that mitigation is active but
          terminating (<xref target="get" format="default"/>).</t>
          <t>The initial active-but-terminating period <bcp14>SHOULD</bcp14> be sufficiently
          long to absorb latency incurred by route propagation. The
          active-but-terminating period <bcp14>SHOULD</bcp14> be set by default to 120
          seconds. If the client requests mitigation again before the initial
          active-but-terminating period elapses, the DOTS server <bcp14>MAY</bcp14>
          exponentially increase (the base of the exponent is 2) the
          active-but-terminating period up to a maximum of 300 seconds (5
          minutes).</t>
          <t>Once the active-but-terminating period elapses, the DOTS server
          <bcp14>MUST</bcp14> treat the mitigation as terminated, as the DOTS client is no
          longer responsible for the mitigation.</t>
          <t>If a mitigation is triggered due to a signal channel loss, the
          DOTS server relies upon normal triggers to stop that mitigation
          (typically, receipt of a valid DELETE request, expiry of the
          mitigation lifetime, or scrubbing the traffic to the attack target).
          In particular, the DOTS server <bcp14>MUST NOT</bcp14> consider the signal channel
          recovery as a trigger to stop the mitigation.</t>
        </section>
      </section>
      <section anchor="sigconfig" numbered="true" toc="default">
        <name>DOTS Signal Channel Session Configuration</name>
        <t>A DOTS client can negotiate, configure, and retrieve the DOTS
        signal channel session behavior with its DOTS peers. The DOTS signal
        channel can be used, for example, to configure the following:</t>
        <ol spacing="normal" type="a">
          <li>Heartbeat interval (heartbeat-interval): DOTS agents regularly
            send heartbeats to each other after mutual authentication is
            successfully completed in order to keep the DOTS signal channel
            open. Heartbeat messages are exchanged between DOTS agents every
            'heartbeat-interval' seconds to detect the current status of the
            DOTS signal channel session.</li>
          <li>Missing heartbeats allowed (missing-hb-allowed): This variable
            indicates the maximum number of consecutive heartbeat messages for
            which a DOTS agent did not receive a response before concluding
            that the session is disconnected or defunct.</li>
          <li>Acceptable probing rate (probing-rate): This parameter
            indicates the average data rate that must not be exceeded by a
            DOTS agent in sending to a peer DOTS agent that does not
            respond.</li>
          <li>Acceptable signal loss ratio: Maximum retransmissions,
            retransmission timeout value, and other message transmission
            parameters for Confirmable messages over the DOTS signal
            channel.</li>
        </ol>
        <t>When the DOTS signal channel is established over a reliable
        transport (e.g., TCP), there is no need for the reliability mechanisms
        provided by CoAP over UDP since the underlying TCP connection provides
        retransmissions and deduplication <xref target="RFC8323" format="default"/>. As a
        reminder, CoAP over reliable transports does not support Confirmable
        or Non-confirmable message types. As such, the transmission-related
        parameters ('missing-hb-allowed' and acceptable signal loss ratio) are
        negotiated only for DOTS over unreliable transports.</t>
        <t>The same or distinct configuration sets may be used during times
        when a mitigation is active ('mitigating-config') and when no
        mitigation is active ('idle-config'). This is particularly useful for
        DOTS servers that might want to reduce heartbeat frequency or cease
        heartbeat exchanges when an active DOTS client has not requested
        mitigation. If distinct configurations are used, DOTS agents <bcp14>MUST</bcp14>
        follow the appropriate configuration set as a function of the
        mitigation activity (e.g., if no mitigation request is active (also
        referred to as 'idle' time), values related to 'idle-config' must be
        followed). Additionally, DOTS agents <bcp14>MUST</bcp14> automatically switch to the
        other configuration upon a change in the mitigation activity (e.g., if
        an attack mitigation is launched after an 'idle' time, the DOTS agent
        switches from values related to 'idle-config' to values
	related to 'mitigating-config').</t>
        <t>CoAP requests and responses are indicated for reliable delivery by
        marking them as Confirmable messages. DOTS signal channel session
        configuration requests and responses are marked as Confirmable
        messages. As explained in <xref target="RFC7252" section="2.1" sectionFormat="of" format="default"/>, a Confirmable message is retransmitted using
        a default timeout and exponential backoff between retransmissions,
        until the DOTS server sends an Acknowledgement message (ACK) with the
        same Message ID conveyed from the DOTS client.</t>
        <t>Message transmission parameters are defined in <xref target="RFC7252" section="4.8" sectionFormat="of" format="default"/>. The DOTS server can either piggyback the
        response in the Acknowledgement message or, if the DOTS server cannot
        respond immediately to a request carried in a Confirmable message, it
        simply responds with an Empty Acknowledgement message so that the DOTS
        client can stop retransmitting the request. Empty Acknowledgement
        messages are explained in <xref target="RFC7252" section="2.2" sectionFormat="of" format="default"/>. When the response is ready, the server sends
        it in a new Confirmable message, which, in turn, needs to be acknowledged
        by the DOTS client (see Sections <xref target="RFC7252" section="5.2.1" sectionFormat="bare" format="default"/> 
and <xref target="RFC7252" section="5.2.2" sectionFormat="bare" format="default"/> 
of <xref target="RFC7252" format="default"/>). Requests and responses exchanged between
        DOTS agents during 'idle' time, except heartbeat messages, are marked
        as Confirmable messages.</t>
        <aside>
          <t>Implementation Note: A DOTS client that receives a response in
            a Confirmable message may want to clean up the message state right
            after sending the ACK. If that ACK is lost and the DOTS server
            retransmits the Confirmable message, the DOTS client may no longer
            have any state that would help it correlate this response: from
            the DOTS client's standpoint, the retransmission message is
            unexpected. The DOTS client will send a Reset message so it does
            not receive any more retransmissions. This behavior is normal and
            not an indication of an error 
(see <xref target="RFC7252" section="5.3.2" sectionFormat="of" format="default"/> for more details).</t>
        </aside>
        <section anchor="discovery" numbered="true" toc="default">
          <name>Discover Configuration Parameters</name>
          <t>A GET request is used to obtain acceptable (e.g., minimum and
          maximum values) and current configuration parameters on the DOTS
          server for DOTS signal channel session configuration. This procedure
          occurs between a DOTS client and its immediate peer DOTS server. As
          such, this GET request <bcp14>MUST NOT</bcp14> be relayed by a DOTS gateway.</t>
          <t><xref target="Figure18" format="default"/> shows how to obtain configuration
          parameters that the DOTS server will find acceptable.</t>
          <figure anchor="Figure18">
            <name>GET to Retrieve Configuration</name>
            <sourcecode><![CDATA[
  Header: GET (Code=0.01)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "config"
]]></sourcecode>
          </figure>
          <t>The DOTS server in the 2.05 (Content) response conveys the
          current, minimum, and maximum attribute values acceptable by the
          DOTS server (<xref target="Figure19" format="default"/>).</t>
          <figure anchor="Figure19">
            <name>GET Configuration Response Body Schema</name>
            <sourcecode><![CDATA[
{    
  "ietf-dots-signal-channel:signal-config": {
    "mitigating-config": {
      "heartbeat-interval": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "missing-hb-allowed": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "probing-rate": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "max-retransmit": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "ack-timeout": {
        "max-value-decimal": "string",
        "min-value-decimal": "string",
        "current-value-decimal": "string"
      },
      "ack-random-factor": {
        "max-value-decimal": "string",
        "min-value-decimal": "string",
        "current-value-decimal": "string"
      }
    },
    "idle-config": {
      "heartbeat-interval": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "missing-hb-allowed": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "probing-rate": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "max-retransmit": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "ack-timeout": {
        "max-value-decimal": "string",
        "min-value-decimal": "string",
        "current-value-decimal": "string"
      },
      "ack-random-factor": {
        "max-value-decimal": "string",
        "min-value-decimal": "string",
        "current-value-decimal": "string"
      }
    }
  }
}]]></sourcecode>
          </figure>
          <t>The parameters in <xref target="Figure19" format="default"/> are described
          below:</t>
          <dl newline="false" spacing="normal">
            <dt>mitigating-config:</dt>
            <dd>
              <t>Set of configuration parameters
              to use when a mitigation is active. The following parameters may
              be included: </t>
              <dl newline="false" spacing="normal">
                <dt>heartbeat-interval: </dt>
                <dd>
                  <t>Time interval in seconds
                  between two consecutive heartbeat messages. </t>
                  <t>'0' is used to disable the heartbeat
                  mechanism. </t>
                  <t>This is an optional
                  attribute.</t>
                </dd>
                <dt>missing-hb-allowed: </dt>
                <dd>
                  <t>Maximum number of
                  consecutive heartbeat messages for which the DOTS agent did
                  not receive a response before concluding that the session is
                  disconnected. </t>
                  <t>This is an optional
                  attribute.</t>
                </dd>
                <dt>probing-rate:</dt>
                <dd>
                  <t>The average data rate that must
                  not be exceeded by a DOTS agent in sending to a peer DOTS
                  agent that does not respond (referred to as PROBING_RATE
                  parameter in CoAP). </t>
                  <t>This is an
                  optional attribute.</t>
                </dd>
                <dt>max-retransmit: </dt>
                <dd>
                  <t>Maximum number of
                  retransmissions for a message (referred to as MAX_RETRANSMIT
                  parameter in CoAP). </t>
                  <t>This is an
                  optional attribute.</t>
                </dd>
                <dt>ack-timeout: </dt>
                <dd>
                  <t>Timeout value in seconds used to
                  calculate the initial retransmission timeout value (referred
                  to as ACK_TIMEOUT parameter in CoAP). </t>
                  <t>This is an optional attribute.</t>
                </dd>
                <dt>ack-random-factor: </dt>
                <dd>
                  <t>Random factor used to
                  influence the timing of retransmissions (referred to as
                  ACK_RANDOM_FACTOR parameter in CoAP). </t>
                  <t>This is an optional attribute.</t>
                </dd>
              </dl>
            </dd>
            <dt>idle-config: </dt>
            <dd>Set of configuration parameters to
              use when no mitigation is active. This attribute has the same
              structure as 'mitigating-config'.</dd>
          </dl>
          <t><xref target="Figure17" format="default"/> shows an example of acceptable
          and current configuration parameters on a DOTS server for DOTS
          signal channel session configuration. The same acceptable
          configuration is used during mitigation and idle times.</t>
          <figure anchor="Figure17">
            <name>Example of a Configuration Response Body</name>
            <sourcecode><![CDATA[
{
  "ietf-dots-signal-channel:signal-config": {
    "mitigating-config": {
      "heartbeat-interval": {
        "max-value": 240,
        "min-value": 15,
        "current-value": 30
      },
      "missing-hb-allowed": {
        "max-value": 20,
        "min-value": 3,
        "current-value": 15
      },
      "probing-rate": {
        "max-value": 20,
        "min-value": 5,
        "current-value": 15
      },
      "max-retransmit": {
        "max-value": 15,
        "min-value": 2,
        "current-value": 3
      },
      "ack-timeout": {
        "max-value-decimal": "30.00",
        "min-value-decimal": "1.00",
        "current-value-decimal": "2.00"
      },
      "ack-random-factor": {
        "max-value-decimal": "4.00",
        "min-value-decimal": "1.10",
        "current-value-decimal": "1.50"
      }
    },
    "idle-config": {
      "heartbeat-interval": {
        "max-value": 240,
        "min-value": 15,
        "current-value": 30
      },
      "missing-hb-allowed": {
        "max-value": 20,
        "min-value": 3,
        "current-value": 15
      },
      "probing-rate": {
        "max-value": 20,
        "min-value": 5,
        "current-value": 15
      },
      "max-retransmit": {
        "max-value": 15,
        "min-value": 2,
        "current-value": 3
      },
      "ack-timeout": {
        "max-value-decimal": "30.00",
        "min-value-decimal": "1.00",
        "current-value-decimal": "2.00"
      },
      "ack-random-factor": {
        "max-value-decimal": "4.00",
        "min-value-decimal": "1.10",
        "current-value-decimal": "1.50"
      }
    }
  }
}]]></sourcecode>
          </figure>
        </section>
        <section anchor="convey" numbered="true" toc="default">
          <name>Convey DOTS Signal Channel Session Configuration</name>
          <t>A PUT request (Figures <xref format="counter" target="Figure13"/> 
          and <xref format="counter" target="Figure13a"/>) is used to convey the configuration
          parameters for the signal channel (e.g., heartbeat interval, maximum
          retransmissions). Message transmission parameters for CoAP are
          defined in <xref target="RFC7252" section="4.8" sectionFormat="of" format="default"/>. The
          <bcp14>RECOMMENDED</bcp14> values of transmission parameter values are 'ack-timeout'
          (2 seconds), 'max-retransmit' (3), and 'ack-random-factor' (1.5). In
          addition to those parameters, the <bcp14>RECOMMENDED</bcp14> specific DOTS
          transmission parameter values are 'heartbeat-interval' (30 seconds)
          and 'missing-hb-allowed' (15). </t>
          <aside>
            <t>Note: 'heartbeat-interval' should be tweaked to also assist
              DOTS messages for NAT traversal (SIG-011 of <xref target="RFC8612" format="default"/>). 
              According to <xref target="RFC8085" format="default"/>, heartbeat messages must not be sent
              more frequently than once every 15 seconds and should use longer
              intervals when possible. Furthermore, <xref target="RFC4787" format="default"/> 
              recommends that NATs use a state timeout
              of 2 minutes or longer, but experience shows that sending
              packets every 15 to 30 seconds is necessary to prevent the
              majority of middleboxes from losing state for UDP flows. From
              that standpoint, the <bcp14>RECOMMENDED</bcp14> minimum 'heartbeat-interval' is
              15 seconds and the <bcp14>RECOMMENDED</bcp14> maximum 'heartbeat-interval' is 240
              seconds. The recommended value of 30 seconds is selected to
              anticipate the expiry of NAT state.</t>
            <t>A 'heartbeat-interval' of 30 seconds may be considered
	    to be too
              chatty in some deployments. For such deployments, DOTS agents
              may negotiate longer 'heartbeat-interval' values to prevent any
              network overload with too frequent heartbeats.</t>
            <t>Different heartbeat intervals can be defined for
              'mitigating-config' and 'idle-config' to reduce being too chatty
              during idle times. If there is an on-path translator between the
              DOTS client (standalone or part of a DOTS gateway) and the DOTS
              server, the 'mitigating-config' 'heartbeat-interval' has to be
              smaller than the translator session timeout. It is recommended
              that the 'idle-config' 'heartbeat-interval' also be smaller than
              the translator session timeout to prevent translator traversal
              issues or that it be disabled entirely. Means to discover the lifetime
              assigned by a translator are out of scope.</t>
            <t>Given that the size of the heartbeat request cannot exceed
              ('heartbeat-interval' * 'probing-rate') bytes, 'probing-rate' should
              be set appropriately to avoid slowing down heartbeat exchanges.
              For example, 'probing-rate' may be set to 2 * ("size of encrypted
              DOTS heartbeat request"/'heartbeat-interval') or (("size of
              encrypted DOTS heartbeat request" + "average size of an
              encrypted mitigation request")/'heartbeat-interval'). Absent any
              explicit configuration or inability to dynamically adjust
              'probing-rate' values (<xref target="RFC7252" section="4.8.1" sectionFormat="of" format="default"/>), 
              DOTS agents use 5 bytes/second as a default 'probing-rate' value.</t>
          </aside>
          <t>If the DOTS agent wishes to change the default values of message
          transmission parameters, it <bcp14>SHOULD</bcp14> follow the guidance given in
          <xref target="RFC7252" section="4.8.1" sectionFormat="of" format="default"/>. The DOTS agents
          <bcp14>MUST</bcp14> use the negotiated values for message transmission parameters
          and default values for non-negotiated message transmission
          parameters.</t>
          <t>The signal channel session configuration is applicable to a
          single DOTS signal channel session between DOTS agents, so the
          'cuid' Uri-Path <bcp14>MUST NOT</bcp14> be used.</t>
          <figure anchor="Figure13">
            <name>PUT to Convey the DOTS Signal Channel Session Configuration Data</name>
            <sourcecode><![CDATA[
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "config"
  Uri-Path: "sid=123"
  Content-Format: "application/dots+cbor"

  {
   ...
  }
]]></sourcecode>
          </figure>
          <t>The additional Uri-Path parameter to those defined in <xref target="uris" format="default"/> is as follows: </t>
          <dl newline="false" spacing="normal" indent="5">
            <dt>sid:</dt>
            <dd>
              <t>Session Identifier is an identifier for the
              DOTS signal channel session configuration data represented as an
              integer. This identifier <bcp14>MUST</bcp14> be generated by DOTS clients.
              'sid' values <bcp14>MUST</bcp14> increase monotonically (when a new PUT is
              generated by a DOTS client to convey the configuration
              parameters for the signal channel). </t>
              <t>This is a mandatory attribute.</t>
            </dd>
          </dl>
          <figure anchor="Figure13a">
            <name>PUT to Convey the DOTS Signal Channel Session Configuration Data (Message Body Schema)</name>
            <sourcecode><![CDATA[
  {
    "ietf-dots-signal-channel:signal-config": {
      "mitigating-config": {
        "heartbeat-interval": {
          "current-value": number
        },
        "missing-hb-allowed": {
          "current-value": number
        },
        "probing-rate": {
          "current-value": number
        },
        "max-retransmit": {
          "current-value": number
        },
        "ack-timeout": {
          "current-value-decimal": "string"
        },
        "ack-random-factor": {
          "current-value-decimal": "string"
        }
      },
      "idle-config": {
        "heartbeat-interval": {
          "current-value": number
        },
        "missing-hb-allowed": {
          "current-value": number
        },
        "probing-rate": {
          "current-value": number
        },
        "max-retransmit": {
          "current-value": number
        },
        "ack-timeout": {
          "current-value-decimal": "string"
        },
        "ack-random-factor": {
          "current-value-decimal": "string"
        }
      }
    }
  }
]]></sourcecode>
          </figure>
          <t>The meaning of the parameters in the CBOR body 
          (<xref target="Figure13a" format="default"/>) is defined in <xref target="discovery" format="default"/>.</t>
          <t>At least one of the attributes 'heartbeat-interval',
          'missing-hb-allowed', 'probing-rate', 'max-retransmit',
          'ack-timeout', and 'ack-random-factor' <bcp14>MUST</bcp14> be present in the PUT
          request. Note that 'heartbeat-interval', 'missing-hb-allowed',
          'probing-rate', 'max-retransmit', 'ack-timeout', and
          'ack-random-factor', if present, do not need to be provided for both
          'mitigating-config', and 'idle-config' in a PUT request.</t>
          <t>The PUT request with a higher numeric 'sid' value overrides the
          DOTS signal channel session configuration data installed by a PUT
          request with a lower numeric 'sid' value. To avoid maintaining a
          long list of 'sid' requests from a DOTS client, the lower numeric
          'sid' <bcp14>MUST</bcp14> be automatically deleted and no longer available at the
          DOTS server.</t>
          <t><xref target="Figure14" format="default"/> shows a PUT request example to
          convey the configuration parameters for the DOTS signal channel. In
          this example, the heartbeat mechanism is disabled when no mitigation
          is active, while the heartbeat interval is set to '30' when a
          mitigation is active.</t>
          <figure anchor="Figure14">
            <name>PUT to Convey the Configuration Parameters</name>
            <sourcecode><![CDATA[
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "config"
  Uri-Path: "sid=123"
  Content-Format: "application/dots+cbor"

  {
    "ietf-dots-signal-channel:signal-config": {
      "mitigating-config": {
        "heartbeat-interval": {
          "current-value": 30
        },
        "missing-hb-allowed": {
          "current-value": 15
        },
        "probing-rate": {
          "current-value": 15
        },
        "max-retransmit": {
          "current-value": 3
        },
        "ack-timeout": {
          "current-value-decimal": "2.00"
        },
        "ack-random-factor": {
          "current-value-decimal": "1.50"
        }
      },
      "idle-config": {
        "heartbeat-interval": {
          "current-value": 0
        },
        "max-retransmit": {
          "current-value": 3
        },
        "ack-timeout": {
          "current-value-decimal": "2.00"
        },
        "ack-random-factor": {
          "current-value-decimal": "1.50"
        }
      }
    }
  }
]]></sourcecode>
          </figure>
          <t>The DOTS server indicates the result of processing the PUT
          request using CoAP Response Codes:</t>
          <ul spacing="normal">
            <li>If the request is missing a mandatory attribute, does not
              include a 'sid' Uri-Path, or contains one or more invalid or
              unknown parameters, 4.00 (Bad Request) <bcp14>MUST</bcp14> be returned in the
              response.</li>
            <li>If the DOTS server does not find the 'sid' parameter value
              conveyed in the PUT request in its configuration data and if the
              DOTS server has accepted the configuration parameters, then a
              Response Code 2.01 (Created) <bcp14>MUST</bcp14> be returned in the
              response.</li>
            <li>If the DOTS server finds the 'sid' parameter value conveyed
              in the PUT request in its configuration data and if the DOTS
              server has accepted the updated configuration parameters, 2.04
              (Changed) <bcp14>MUST</bcp14> be returned in the response.</li>
            <li>
              <t>If any of the 'heartbeat-interval', 'missing-hb-allowed',
              'probing-rate', 'max-retransmit', 'target-protocol',
              'ack-timeout', and 'ack-random-factor' attribute values are not
              acceptable to the DOTS server, 4.22 (Unprocessable Entity) <bcp14>MUST</bcp14>
              be returned in the response. Upon receipt of this error code,
              the DOTS client <bcp14>SHOULD</bcp14> retrieve the maximum and minimum
              attribute values acceptable to the DOTS server (<xref target="discovery" format="default"/>).</t>
              <t>The DOTS
              client may retry and send the PUT request with updated
              attribute values acceptable to the DOTS server.</t>
            </li>
          </ul>
          <t>A DOTS client may issue a GET message with a 'sid' Uri-Path
          parameter to retrieve the negotiated configuration. The response
          does not need to include 'sid' in its message body.</t>
        </section>
        <section numbered="true" toc="default">
          <name>Configuration Freshness and Notifications</name>
          <t>Max-Age Option (<xref target="RFC7252" section="5.10.5" sectionFormat="of" format="default"/>)
          <bcp14>SHOULD</bcp14> be returned by a DOTS server to associate a validity time
          with a configuration it sends. This feature allows the update of the
          configuration data if a change occurs at the DOTS server side. For
          example, the new configuration may instruct a DOTS client to cease
          heartbeats or reduce heartbeat frequency.</t>
          <t>It is <bcp14>NOT RECOMMENDED</bcp14> to return a Max-Age Option set to 0.</t>
          <t>Returning a Max-Age Option set to 2<sup>32</sup>-1 is equivalent to
          associating an infinite lifetime with the configuration.</t>
          <t>If a non-zero value of Max-Age Option is received by a DOTS
          client, it <bcp14>MUST</bcp14> issue a GET request with a 'sid' Uri-Path parameter to
          retrieve the current and acceptable configuration before the expiry
          of the value enclosed in the Max-Age Option. This request is
          considered by the client and the server to be a means to refresh the
          configuration parameters for the signal channel. When a DDoS attack
          is active, refresh requests <bcp14>MUST NOT</bcp14> be sent by DOTS clients, and the
          DOTS server <bcp14>MUST NOT</bcp14> terminate the (D)TLS session after the expiry
          of the value returned in Max-Age Option.</t>
          <t>If Max-Age Option is not returned in a response, the DOTS client
          initiates GET requests to refresh the configuration parameters each
          60 seconds (<xref target="RFC7252" section="5.10.5" sectionFormat="of" format="default"/>). To
          prevent such overload, it is <bcp14>RECOMMENDED</bcp14> that DOTS servers return a
          Max-Age Option in GET responses. Considerations related to which
          value to use and how such a value is set are implementation and
          deployment specific.</t>
          <t>If an Observe Option set to 0 is included in the configuration
          request, the DOTS server sends notifications of any configuration
          change (<xref target="RFC7641" section="4.2" sectionFormat="of" format="default"/>).</t>
          <t>If a DOTS server detects that a misbehaving DOTS client does not
          contact the DOTS server after the expiry of Max-Age to retrieve the
          signal channel configuration data, it <bcp14>MAY</bcp14> terminate the (D)TLS
          session. A (D)TLS session is terminated by the receipt of an
          authenticated message that closes the connection (e.g., a fatal
          alert (<xref target="RFC8446" section="6" sectionFormat="of" format="default"/>)).</t>
        </section>
        <section numbered="true" toc="default">
          <name>Delete DOTS Signal Channel Session Configuration</name>
          <t>A DELETE request is used to delete the installed DOTS signal
          channel session configuration data (<xref target="Figure15" format="default"/>).</t>
          <figure anchor="Figure15">
            <name>Delete Configuration</name>
            <sourcecode><![CDATA[
  Header: DELETE (Code=0.04)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "config"
  Uri-Path: "sid=123"
]]></sourcecode>
          </figure>
          <t>The DOTS server resets the DOTS signal channel session
          configuration back to the default values and acknowledges a DOTS
          client's request to remove the DOTS signal channel session
          configuration using 2.02 (Deleted) Response Code.</t>
          <t>Upon bootstrapping or reboot, a DOTS client <bcp14>MAY</bcp14> send a DELETE
          request to set the configuration parameters to default values. Such
          a request does not include any 'sid'.</t>
        </section>
      </section>
      <section anchor="redirect" numbered="true" toc="default">
        <name>Redirected Signaling</name>
        <t>Redirected DOTS signaling is discussed in detail in
        <xref target="I-D.ietf-dots-architecture" section="3.2.2" sectionFormat="of" format="default"/>.</t>
        <t>If a DOTS server wants to redirect a DOTS client to an alternative
        DOTS server for a signal session, then the Response Code 5.03 (Service
        Unavailable) will be returned in the response to the DOTS client.</t>
        <t>The DOTS server can return the error Response Code 5.03 in response
        to a request from the DOTS client or convey the error Response Code
        5.03 in a unidirectional notification response from the DOTS
        server.</t>
        <t>The DOTS server in the error response conveys the alternate DOTS
        server's FQDN, and the alternate DOTS server's IP address(es) values
        in the CBOR body (<xref target="Figure20" format="default"/>).</t>
        <figure anchor="Figure20">
          <name>Redirected Server Error Response Body Schema</name>
          <sourcecode><![CDATA[
{ 
  "ietf-dots-signal-channel:redirected-signal": {
    "alt-server": "string",
    "alt-server-record": [
       "string"
    ]
  }
}]]></sourcecode>
        </figure>
        <t>The parameters are described below:</t>
        <dl newline="false" spacing="normal">
          <dt>alt-server:</dt>
          <dd>
            <t>FQDN of an alternate DOTS server.
            </t>
            <t>This is a mandatory attribute.</t>
          </dd>
          <dt>alt-server-record:</dt>
          <dd>
            <t>A list of IP addresses of an
            alternate DOTS server.</t>
            <t>This is an optional
            attribute.</t>
          </dd>
        </dl>
        <t>The DOTS server returns the Time to Live (TTL) of the alternate
        DOTS server in a Max-Age Option. That is, the time interval that the
        alternate DOTS server may be cached for use by a DOTS client. A
        Max-Age Option set to 2<sup>32</sup>-1 is equivalent to receiving an infinite
        TTL. This value means that the alternate DOTS server is to be used
        until the alternate DOTS server redirects the traffic with another
        5.03 response that conveys an alternate server's FQDN.</t>
        <t>A Max-Age Option set to '0' may be returned for redirecting
        mitigation requests. Such a value means that the redirection applies
        only for the mitigation request in progress. Returning short TTL in a
        Max-Age Option may adversely impact DOTS clients on slow links.
        Returning short values should be avoided under such conditions.</t>
        <t>If the alternate DOTS server TTL has expired, the DOTS client <bcp14>MUST</bcp14>
        use the DOTS server(s) that was provisioned using means discussed in
        <xref target="discover" format="default"/>. This fallback mechanism is triggered
        immediately upon expiry of the TTL, except when a DDoS attack is
        active.</t>
        <t>Requests issued by misbehaving DOTS clients that do not honor the
        TTL conveyed in the Max-Age Option or react to explicit redirect
        messages can be rejected by DOTS servers.</t>
        <t><xref target="Figure21" format="default"/> shows a 5.03 response example to
        convey the DOTS alternate server 'alt-server.example' together with
        its IP addresses 2001:db8:6401::1 and 2001:db8:6401::2.</t>
        <figure anchor="Figure21">
          <name>Example of Redirected Server Error Response Body</name>
          <sourcecode><![CDATA[
{ 
  "ietf-dots-signal-channel:redirected-signal": {
    "alt-server": "alt-server.example",
    "alt-server-record": [
       "2001:db8:6401::1",
       "2001:db8:6401::2" 
    ]
  }
}]]></sourcecode>
        </figure>
        <t>When the DOTS client receives a 5.03 response with an alternate
        server included, it considers the current request to have
	failed, but it
        <bcp14>SHOULD</bcp14> try resending the request to the alternate DOTS server. During
        a DDoS attack, the DNS server may be the target of another DDoS
        attack, the alternate DOTS server's IP addresses conveyed in the 5.03
        response help the DOTS client skip the DNS lookup of the alternate DOTS
        server, at the cost of trusting the first DOTS server to provide
        accurate information. The DOTS client can then try to establish a UDP
        or a TCP session with the alternate DOTS server. The DOTS client <bcp14>MAY</bcp14>
        implement a method to construct IPv4-embedded IPv6 addresses <xref target="RFC6052" format="default"/>; this is required to handle the scenario
        where an IPv6-only DOTS client communicates with an IPv4-only
        alternate DOTS server.</t>
        <t>If the DOTS client has been redirected to a DOTS server with which it
        has already communicated within the last five (5) minutes, it
        <bcp14>MUST</bcp14> ignore the redirection and try to contact other DOTS servers
        listed in the local configuration or discovered using dynamic means
        such as DHCP or SRV procedures <xref target="I-D.ietf-dots-server-discovery" format="default"/>. It is <bcp14>RECOMMENDED</bcp14>
        that DOTS clients support the means to alert administrators about redirect
        loops.</t>
      </section>
      <section anchor="hb" numbered="true" toc="default">
        <name>Heartbeat Mechanism</name>
        <t>To provide an indication of signal health and to distinguish an 'idle'
        signal channel from a 'disconnected' or 'defunct' session, the DOTS
        agent sends a heartbeat over the signal channel to maintain its half
        of the channel (also, aligned with the "consents" recommendation in
        <xref target="RFC8085" section="6" sectionFormat="of" format="default"/>). The DOTS agent similarly
        expects a heartbeat from its peer DOTS agent, and it may consider a
        session terminated in the prolonged absence of a peer agent heartbeat.
        Concretely, while the communication between the DOTS agents is
        otherwise quiescent, the DOTS client will probe the DOTS server to
        ensure it has maintained cryptographic state and vice versa.
Such probes can also keep the bindings of firewalls and/or stateful translators
alive.
        This probing reduces the frequency of establishing a new
        handshake when a DOTS signal needs to be conveyed to the DOTS
        server.</t>
        <aside>
          <t>Implementation Note: Given that CoAP roles can be multiplexed
            over the same session as discussed in <xref target="RFC7252" format="default"/> 
            and are already supported by CoAP
            implementations, both the DOTS client and server can send DOTS
            heartbeat requests.</t>
        </aside>
        <t>The DOTS heartbeat mechanism uses Non-confirmable PUT requests
        (<xref target="hbreq" format="default"/>) with an expected 2.04 (Changed)
        Response Code (<xref target="hbrep" format="default"/>). This procedure occurs
        between a DOTS agent and its immediate peer DOTS agent. As such, this
        PUT request <bcp14>MUST NOT</bcp14> be relayed by a DOTS gateway. The PUT request
        used for DOTS heartbeat <bcp14>MUST NOT</bcp14> have a 'cuid', 'cdid', or 'mid'
        Uri-Path.</t>
        <figure anchor="hbreq">
          <name>PUT to Check Peer DOTS Agent Is Responding</name>
          <sourcecode><![CDATA[
     Header: PUT (Code=0.03)
     Uri-Path: ".well-known"
     Uri-Path: "dots"
     Uri-Path: "hb"  
     Content-Format: "application/dots+cbor"

     {
       "ietf-dots-signal-channel:heartbeat": {
          "peer-hb-status": true       
        }
     }
]]></sourcecode>
        </figure>
        <t>The mandatory 'peer-hb-status' attribute is set to 'true' (or
        'false') to indicate that a DOTS agent is (or is not) receiving
        heartbeat messages from its peer in the last (2 * 'heartbeat-interval')
        period. Such information can be used by a peer DOTS agent to detect or
        confirm connectivity issues and react accordingly. For example, if a
        DOTS client receives a 2.04 response for its heartbeat messages but no
        server-initiated heartbeat messages, the DOTS client sets
        'peer-hb-status' to 'false'. The DOTS server then will need to try
        another strategy for sending the heartbeats (e.g., adjust the
        heartbeat interval or send a server-initiated heartbeat immediately
        after receiving a client-initiated heartbeat message).</t>
        <figure anchor="hbrep">
          <name>Response to a DOTS Heartbeat Request</name>
          <sourcecode><![CDATA[
     Header: (Code=2.04)

]]></sourcecode>
        </figure>
        <t>DOTS servers <bcp14>MAY</bcp14> trigger their heartbeat requests immediately after
        receiving heartbeat probes from peer DOTS clients. As a reminder, it
        is the responsibility of DOTS clients to ensure that on-path
        translators/firewalls are maintaining a binding so that the same
        external IP address and/or port number is retained for the DOTS signal
        channel session.</t>
        <t>Under normal traffic conditions (i.e., no attack is ongoing), if a
        DOTS agent does not receive any response from the peer DOTS agent for
        'missing-hb-allowed' number of consecutive heartbeat messages, it
        concludes that the DOTS signal channel session is disconnected. The
        DOTS client <bcp14>MUST</bcp14> then try to reestablish the DOTS signal channel
        session, preferably by resuming the (D)TLS session.</t>
        <aside>
          <t>Note: If a new DOTS signal channel session
            cannot be established, the DOTS client <bcp14>SHOULD NOT</bcp14> retry to
            establish the DOTS signal channel session more frequently than
            every 300 seconds (5 minutes) and <bcp14>MUST NOT</bcp14> retry more frequently
            than every 60 seconds (1 minute). It is recommended that DOTS
            clients support the means to alert administrators about the failure to
            establish a (D)TLS session.</t>
        </aside>
        <t>In case of a massive DDoS attack that saturates the incoming
        link(s) to the DOTS client, all traffic from the DOTS server to the
        DOTS client will likely be dropped, although the DOTS server receives
        heartbeat requests in addition to DOTS messages sent by the DOTS
        client. In this scenario, DOTS clients <bcp14>MUST</bcp14> behave differently to
        handle message transmission and DOTS signal channel session liveliness
        during link saturation:</t>
        <ul empty="true" spacing="normal">
          <li>
            <t>The DOTS client <bcp14>MUST NOT</bcp14> consider the DOTS signal channel
            session terminated even after a maximum 'missing-hb-allowed'
            threshold is reached. The DOTS client <bcp14>SHOULD</bcp14> keep on using the
            current DOTS signal channel session to send heartbeat requests
            over it, so that the DOTS server knows the DOTS client has not
            disconnected the DOTS signal channel session. </t>
            <t>After the maximum 'missing-hb-allowed' threshold
            is reached, the DOTS client <bcp14>SHOULD</bcp14> try to establish a new DOTS
            signal channel session. The DOTS client <bcp14>SHOULD</bcp14> send mitigation
            requests over the current DOTS signal channel session and, in
            parallel, send the mitigation requests over the new DOTS signal
            channel session. This may be handled, for example, by resumption
            of the (D)TLS session or using 0-RTT mode in DTLS 1.3 to piggyback
            the mitigation request in the ClientHello message.</t>
            <t>As soon as the link is no longer
            saturated, if traffic from the DOTS server reaches the DOTS client
            over the current DOTS signal channel session, the DOTS client can
            stop the new DOTS signal channel session attempt or if a new DOTS
            signal channel session is successful then disconnect the current
            DOTS signal channel session.</t>
          </li>
        </ul>
        <t>If the DOTS server receives traffic from the peer DOTS client
        (e.g., peer DOTS client-initiated heartbeats) but the maximum
        'missing-hb-allowed' threshold is reached, the DOTS server <bcp14>MUST NOT</bcp14>
        consider the DOTS signal channel session disconnected. The DOTS server
        <bcp14>MUST</bcp14> keep on using the current DOTS signal channel session so that the
        DOTS client can send mitigation requests over the current DOTS signal
        channel session. In this case, the DOTS server can identify that the DOTS
        client is under attack and that the inbound link to the DOTS client
        (domain) is saturated. Furthermore, if the DOTS server does not
        receive a mitigation request from the DOTS client, it implies that the DOTS
        client has not detected the attack or, if an attack mitigation is in
        progress, it implies that the applied DDoS mitigation actions are not yet
        effectively handling the DDoS attack volume.</t>
        <t>If the DOTS server does not receive any traffic from the peer DOTS
        client during the time span required to exhaust the maximum
        'missing-hb-allowed' threshold, the DOTS server concludes the session
        is disconnected. The DOTS server can then trigger preconfigured
        mitigation requests for this DOTS client (if any).</t>
        <t>In DOTS over TCP, the sender of a DOTS heartbeat message has to
        allow up to 'heartbeat-interval' seconds when waiting for a heartbeat
        reply. When a failure is detected by a DOTS client, it proceeds with
        the session recovery, following the same approach as the one used for
        unreliable transports.</t>
      </section>
    </section>
    <section anchor="YANG" numbered="true" toc="default">
      
      <name>DOTS Signal Channel YANG Modules</name>
      <t>This document defines a YANG module <xref target="RFC7950" format="default"/> 
      for DOTS mitigation scope, DOTS signal channel session configuration
      data, DOTS redirection signaling, and DOTS heartbeats.</t>

      
      <t>This YANG module (ietf-dots-signal-channel) defines the DOTS client
      interaction with the DOTS server as seen by the DOTS client. A DOTS
      server is allowed to update the non-configurable 'ro' entities in the
      responses. This YANG module is not intended to be used via
      NETCONF/RESTCONF for DOTS server management purposes; such a module is out
      of the scope of this document. It serves only to provide a data model
      and encoding, but not a management data model.</t>
      <t>A companion YANG module is defined to include a collection of types
      defined by IANA: "iana-dots-signal-channel" (<xref target="iana-yang" format="default"/>).</t>
      <section numbered="true" toc="default">
        <name>Tree Structure</name>
        <t>This document defines the YANG module "ietf-dots-signal-channel"
        (<xref target="yrequest" format="default"/>), which has the following tree
        structure. A DOTS signal message can be a mitigation, a configuration,
        a redirect, or a heartbeat message.</t>
        <sourcecode type="yangtree"><![CDATA[
module: ietf-dots-signal-channel
  +--rw dots-signal
     +--rw (message-type)?
        +--:(mitigation-scope)
        |  +--rw scope* [cuid mid]
        |     +--rw cdid?                   string
        |     +--rw cuid                    string
        |     +--rw mid                     uint32
        |     +--rw target-prefix*          inet:ip-prefix
        |     +--rw target-port-range*      [lower-port]
        |     |  +--rw lower-port    inet:port-number
        |     |  +--rw upper-port?   inet:port-number
        |     +--rw target-protocol*        uint8
        |     +--rw target-fqdn*            inet:domain-name
        |     +--rw target-uri*             inet:uri
        |     +--rw alias-name*             string
        |     +--rw lifetime?               int32
        |     +--rw trigger-mitigation?     boolean
        |     +--ro mitigation-start?       uint64
        |     +--ro status?                 iana-signal:status
        |     +--ro conflict-information
        |     |  +--ro conflict-status?   iana-signal:conflict-status
        |     |  +--ro conflict-cause?    iana-signal:conflict-cause
        |     |  +--ro retry-timer?       uint32
        |     |  +--ro conflict-scope
        |     |     +--ro target-prefix*       inet:ip-prefix
        |     |     +--ro target-port-range*   [lower-port]
        |     |     |  +--ro lower-port      inet:port-number
        |     |     |  +--ro upper-port?     inet:port-number
        |     |     +--ro target-protocol*     uint8
        |     |     +--ro target-fqdn*         inet:domain-name
        |     |     +--ro target-uri*          inet:uri
        |     |     +--ro alias-name*          string
        |     |     +--ro acl-list* [acl-name]
        |     |     |  +--ro acl-name    
        |     |     |  |   -> /ietf-data:dots-data/dots-client/acls/
        |     |     |  |      acl/name
        |     |     |  +--ro acl-type?   
        |     |     |      -> /ietf-data:dots-data/dots-client/acls/
        |     |     |         acl/type
        |     |     +--ro mid?                 -> ../../../mid
        |     +--ro bytes-dropped?          yang:zero-based-counter64
        |     +--ro bps-dropped?            yang:gauge64
        |     +--ro pkts-dropped?           yang:zero-based-counter64
        |     +--ro pps-dropped?            yang:gauge64
        |     +--rw attack-status?          iana-signal:attack-status
        +--:(signal-config)
        |  +--rw sid                   uint32
        |  +--rw mitigating-config
        |  |  +--rw heartbeat-interval
        |  |  |  +--ro max-value?       uint16
        |  |  |  +--ro min-value?       uint16
        |  |  |  +--rw current-value?   uint16
        |  |  +--rw missing-hb-allowed
        |  |  |  +--ro max-value?       uint16
        |  |  |  +--ro min-value?       uint16
        |  |  |  +--rw current-value?   uint16
        |  |  +--rw probing-rate
        |  |  |  +--ro max-value?       uint16
        |  |  |  +--ro min-value?       uint16
        |  |  |  +--rw current-value?   uint16
        |  |  +--rw max-retransmit
        |  |  |  +--ro max-value?       uint16
        |  |  |  +--ro min-value?       uint16
        |  |  |  +--rw current-value?   uint16
        |  |  +--rw ack-timeout
        |  |  |  +--ro max-value-decimal?       decimal64
        |  |  |  +--ro min-value-decimal?       decimal64
        |  |  |  +--rw current-value-decimal?   decimal64
        |  |  +--rw ack-random-factor
        |  |     +--ro max-value-decimal?       decimal64
        |  |     +--ro min-value-decimal?       decimal64
        |  |     +--rw current-value-decimal?   decimal64
        |  +--rw idle-config
        |     +--rw heartbeat-interval
        |     |  +--ro max-value?       uint16
        |     |  +--ro min-value?       uint16
        |     |  +--rw current-value?   uint16
        |     +--rw missing-hb-allowed
        |     |  +--ro max-value?       uint16
        |     |  +--ro min-value?       uint16
        |     |  +--rw current-value?   uint16
        |     +--rw probing-rate
        |     |  +--ro max-value?       uint16
        |     |  +--ro min-value?       uint16
        |     |  +--rw current-value?   uint16
        |     +--rw max-retransmit
        |     |  +--ro max-value?       uint16
        |     |  +--ro min-value?       uint16
        |     |  +--rw current-value?   uint16
        |     +--rw ack-timeout
        |     |  +--ro max-value-decimal?       decimal64
        |     |  +--ro min-value-decimal?       decimal64
        |     |  +--rw current-value-decimal?   decimal64
        |     +--rw ack-random-factor
        |        +--ro max-value-decimal?       decimal64
        |        +--ro min-value-decimal?       decimal64
        |        +--rw current-value-decimal?   decimal64
        +--:(redirected-signal)
        |  +--ro alt-server            string
        |  +--ro alt-server-record*    inet:ip-address
        +--:(heartbeat)
           +--rw peer-hb-status              boolean
]]></sourcecode>
      </section>
      <section anchor="iana-yang" numbered="true" toc="default">
        <name>IANA DOTS Signal Channel YANG Module</name>
        <sourcecode name="iana-dots-signal-channel@2020-05-28.yang" type="yang" markers="true"><![CDATA[
module iana-dots-signal-channel {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:iana-dots-signal-channel";
  prefix iana-signal;

  organization
    "IANA";
  contact
    "Internet Assigned Numbers Authority

     Postal: ICANN
          12025 Waterfront Drive, Suite 300
          Los Angeles, CA  90094-2536
          United States of America
     Tel:    +1 310 301 5800
     <mailto:iana@iana.org>";
  description
    "This module contains a collection of YANG data types defined
     by IANA and used for DOTS signal channel protocol.

     Copyright (c) 2020 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD License
     set forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (http://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC 8782; see
     the RFC itself for full legal notices.";

  revision 2020-05-28 {
    description
      "Initial revision.";
    reference
      "RFC 8782: Distributed Denial-of-Service Open Threat
                 Signaling (DOTS) Signal Channel Specification";
  }

  typedef status {
    type enumeration {
      enum attack-mitigation-in-progress {
        value 1;
        description
          "Attack mitigation setup is in progress (e.g., changing
           the network path to reroute the inbound traffic
           to DOTS mitigator).";
      }
      enum attack-successfully-mitigated {
        value 2;
        description
          "Attack is being successfully mitigated (e.g., traffic
           is redirected to a DDoS mitigator and attack
           traffic is dropped or blackholed).";
      }
      enum attack-stopped {
        value 3;
        description
          "Attack has stopped and the DOTS client can
           withdraw the mitigation request.";
      }
      enum attack-exceeded-capability {
        value 4;
        description
          "Attack has exceeded the mitigation provider
           capability.";
      }
      enum dots-client-withdrawn-mitigation {
        value 5;
        description
          "DOTS client has withdrawn the mitigation
           request and the mitigation is active but
           terminating.";
      }
      enum attack-mitigation-terminated {
        value 6;
        description
          "Attack mitigation is now terminated.";
      }
      enum attack-mitigation-withdrawn {
        value 7;
        description
          "Attack mitigation is withdrawn.";
      }
      enum attack-mitigation-signal-loss {
        value 8;
        description
          "Attack mitigation will be triggered 
           for the mitigation request only when
           the DOTS signal channel session is lost.";
      }
    }
    description
      "Enumeration for status reported by the DOTS server.";
  }

  typedef conflict-status {
    type enumeration {
      enum request-inactive-other-active {
        value 1;
        description
          "DOTS Server has detected conflicting mitigation
           requests from different DOTS clients.
           This mitigation request is currently inactive
           until the conflicts are resolved. Another
           mitigation request is active.";
      }
      enum request-active {
        value 2;
        description
          "DOTS Server has detected conflicting mitigation
           requests from different DOTS clients.
           This mitigation request is currently active.";
      }
      enum all-requests-inactive {
        value 3;
        description
          "DOTS Server has detected conflicting mitigation
           requests from different DOTS clients.  All
           conflicting mitigation requests are inactive.";
      }
    }
    description
      "Enumeration for conflict status.";
  }

  typedef conflict-cause {
    type enumeration {
      enum overlapping-targets {
        value 1;
        description
          "Overlapping targets. conflict-scope provides
           more details about the exact conflict.";
      }
      enum conflict-with-acceptlist {
        value 2;
        description
          "Conflicts with an existing accept-list.
                 
           This code is returned when the DDoS mitigation
           detects that some of the source addresses/prefixes
           listed in the accept-list ACLs are actually
           attacking the target.";
      }
      enum cuid-collision {
        value 3;
        description
          "Conflicts with the cuid used by another
           DOTS client.";
      }
    }
    description
      "Enumeration for conflict causes.";
  }

  typedef attack-status {
    type enumeration {
      enum under-attack {
        value 1;
        description
          "The DOTS client determines that it is still under
           attack.";
      }
      enum attack-successfully-mitigated {
        value 2;
        description
          "The DOTS client determines that the attack is
           successfully mitigated.";
      }
    }
    description
      "Enumeration for attack status codes.";
  }
}
]]></sourcecode>
      </section>
      <section anchor="yrequest" numbered="true" toc="default">
        <name>IETF DOTS Signal Channel YANG Module</name>
        <t>This module uses the common YANG types defined in <xref target="RFC6991" format="default"/> 
        and types defined in <xref target="RFC8783" format="default"/>.</t>

        <sourcecode name="ietf-dots-signal-channel@2020-05-28.yang" type="yang" markers="true"><![CDATA[
module ietf-dots-signal-channel {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-dots-signal-channel";
  prefix signal;

  import ietf-inet-types {
    prefix inet;
    reference
      "Section 4 of RFC 6991";
  }
  import ietf-yang-types {
    prefix yang;
    reference
      "Section 3 of RFC 6991";
  }
  import ietf-dots-data-channel {
    prefix ietf-data;
    reference
      "RFC 8783: Distributed Denial-of-Service Open Threat Signaling
                 (DOTS) Data Channel Specification";
  }
  import iana-dots-signal-channel {
    prefix iana-signal;
  }

  organization
    "IETF DDoS Open Threat Signaling (DOTS) Working Group";
  contact
    "WG Web:   <https://datatracker.ietf.org/wg/dots/>
     WG List:  <mailto:dots@ietf.org>

     Editor:  Konda, Tirumaleswar Reddy.K
              <mailto:TirumaleswarReddy_Konda@McAfee.com>

     Editor:  Mohamed Boucadair
              <mailto:mohamed.boucadair@orange.com>

     Author:  Prashanth Patil
              <mailto:praspati@cisco.com>

     Author:  Andrew Mortensen
              <mailto:amortensen@arbor.net>

     Author:  Nik Teague
              <mailto:nteague@ironmountain.co.uk>";
  description
    "This module contains YANG definition for the signaling
     messages exchanged between a DOTS client and a DOTS server.

     Copyright (c) 2020 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD License
     set forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (http://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC 8782; see
     the RFC itself for full legal notices.";

  revision 2020-05-28 {
    description
      "Initial revision.";
    reference
      "RFC 8782: Distributed Denial-of-Service Open Threat
                 Signaling (DOTS) Signal Channel Specification";
  }

  /*
   * Groupings
   */

  grouping mitigation-scope {
    description
      "Specifies the scope of the mitigation request.";
    list scope {
      key "cuid mid";
      description
        "The scope of the request.";
      leaf cdid {
        type string;
        description
          "The cdid should be included by a server-domain 
           DOTS gateway to propagate the client domain 
           identification information from the
           gateway's client-facing side to the gateway's
           server-facing side, and from the gateway's
           server-facing side to the DOTS server.
                    
           It may be used by the final DOTS server
           for policy enforcement purposes.";
      }
      leaf cuid {
        type string;
        description
          "A unique identifier that is
           generated by a DOTS client to prevent
           request collisions.  It is expected that the 
           cuid will remain consistent throughout the
           lifetime of the DOTS client.";
      }
      leaf mid {
        type uint32;
        description
          "Mitigation request identifier.

           This identifier must be unique for each mitigation
           request bound to the DOTS client.";
      }
      uses ietf-data:target;
      leaf-list alias-name {
        type string;
        description
          "An alias name that points to a resource.";
      }
      leaf lifetime {
        type int32;
        units "seconds";
        default "3600";
        description
          "Indicates the lifetime of the mitigation request.

           A lifetime of '0' in a mitigation request is an 
           invalid value.

           A lifetime of negative one (-1) indicates indefinite
           lifetime for the mitigation request.";
      }
      leaf trigger-mitigation {
        type boolean;
        default "true";
        description
          "If set to 'false', DDoS mitigation will not be 
           triggered unless the DOTS signal channel 
           session is lost.";
      }
      leaf mitigation-start {
        type uint64;
        config false;
        description
          "Mitigation start time is represented in seconds
           relative to 1970-01-01T00:00:00Z in UTC time.";
      }
      leaf status {
        type iana-signal:status;
        config false;
        description
          "Indicates the status of a mitigation request.
           It must be included in responses only.";
      }
      container conflict-information {
        config false;
        description
          "Indicates that a conflict is detected.
           Must only be used for responses.";
        leaf conflict-status {
          type iana-signal:conflict-status;
          description
            "Indicates the conflict status.";
        }
        leaf conflict-cause {
          type iana-signal:conflict-cause;
          description
            "Indicates the cause of the conflict.";
        }
        leaf retry-timer {
          type uint32;
          units "seconds";
          description
            "The DOTS client must not resend the
             same request that has a conflict before the expiry of
             this timer.";
        }
        container conflict-scope {
          description
            "Provides more information about the conflict scope.";
          uses ietf-data:target {
            when "/dots-signal/scope/conflict-information/"
               + "conflict-cause = 'overlapping-targets'";
          }
          leaf-list alias-name {
            when "../../conflict-cause = 'overlapping-targets'";
            type string;
            description
              "Conflicting alias-name.";
          }
          list acl-list {
            when "../../conflict-cause = 'conflict-with-acceptlist'";
            key "acl-name";
            description
              "List of conflicting ACLs as defined in the DOTS data
               channel.  These ACLs are uniquely defined by
               cuid and acl-name.";
            leaf acl-name {
              type leafref {
                path "/ietf-data:dots-data/ietf-data:dots-client/"
                   + "ietf-data:acls/ietf-data:acl/ietf-data:name";
              }
              description
                "Reference to the conflicting ACL name bound to
                 a DOTS client.";
            }
            leaf acl-type {
              type leafref {
                path "/ietf-data:dots-data/ietf-data:dots-client/"
                   + "ietf-data:acls/ietf-data:acl/ietf-data:type";
              }
              description
                "Reference to the conflicting ACL type bound to
                 a DOTS client.";
            }
          }
          leaf mid {
            when "../../conflict-cause = 'overlapping-targets'";
            type leafref {
              path "../../../mid";
            }
            description
              "Reference to the conflicting 'mid' bound to
               the same DOTS client.";
          }
        }
      }
      leaf bytes-dropped {
        type yang:zero-based-counter64;
        units "bytes";
        config false;
        description
          "The total dropped byte count for the mitigation
           request since the attack mitigation was triggered.
           The count wraps around when it reaches the maximum value
           of counter64 for dropped bytes.";
      }
      leaf bps-dropped {
        type yang:gauge64;
        config false;
        description
          "The average number of dropped bits per second for
           the mitigation request since the attack
           mitigation was triggered.  This should be over
           five-minute intervals (that is, measuring bytes
           into five-minute buckets and then averaging these 
           buckets over the time since the mitigation was 
           triggered).";
      }
      leaf pkts-dropped {
        type yang:zero-based-counter64;
        config false;
        description
          "The total number of dropped packet count for the
           mitigation request since the attack mitigation was
           triggered.  The count wraps around when it reaches 
           the maximum value of counter64 for dropped packets.";
      }
      leaf pps-dropped {
        type yang:gauge64;
        config false;
        description
          "The average number of dropped packets per second
           for the mitigation request since the attack
           mitigation was triggered.  This should be over
           five-minute intervals (that is, measuring packets
           into five-minute buckets and then averaging these 
           buckets over the time since the mitigation was 
           triggered).";
      }
      leaf attack-status {
        type iana-signal:attack-status;
        description
          "Indicates the status of an attack as seen by the
           DOTS client.";
      }
    }
  }

  grouping config-parameters {
    description
      "Subset of DOTS signal channel session configuration.";
    container heartbeat-interval {
      description
        "DOTS agents regularly send heartbeats to each other
         after mutual authentication is successfully
         completed in order to keep the DOTS signal channel
         open.";
      leaf max-value {
        type uint16;
        units "seconds";
        config false;
        description
          "Maximum acceptable heartbeat-interval value.";
      }
      leaf min-value {
        type uint16;
        units "seconds";
        config false;
        description
          "Minimum acceptable heartbeat-interval value.";
      }
      leaf current-value {
        type uint16;
        units "seconds";
        default "30";
        description
          "Current heartbeat-interval value.

           '0' means that heartbeat mechanism is deactivated.";
      }
    }
    container missing-hb-allowed {
      description
        "Maximum number of missing heartbeats allowed.";
      leaf max-value {
        type uint16;
        config false;
        description
          "Maximum acceptable missing-hb-allowed value.";
      }
      leaf min-value {
        type uint16;
        config false;
        description
          "Minimum acceptable missing-hb-allowed value.";
      }
      leaf current-value {
        type uint16;
        default "15";
        description
          "Current missing-hb-allowed value.";
      }
    }
    container probing-rate {
      description
        "The limit for sending Non-confirmable messages with
         no response.";
      leaf max-value {
        type uint16;
        units "byte/second";
        config false;
        description
          "Maximum acceptable probing-rate value.";
      }
      leaf min-value {
        type uint16;
        units "byte/second";
        config false;
        description
          "Minimum acceptable probing-rate value.";
      }
      leaf current-value {
        type uint16;
        units "byte/second";
        default "5";
        description
          "Current probing-rate value.";
      }
    }
    container max-retransmit {
      description
        "Maximum number of retransmissions of a Confirmable
         message.";
      leaf max-value {
        type uint16;
        config false;
        description
          "Maximum acceptable max-retransmit value.";
      }
      leaf min-value {
        type uint16;
        config false;
        description
          "Minimum acceptable max-retransmit value.";
      }
      leaf current-value {
        type uint16;
        default "3";
        description
          "Current max-retransmit value.";
      }
    }
    container ack-timeout {
      description
        "Initial retransmission timeout value.";
      leaf max-value-decimal {
        type decimal64 {
          fraction-digits 2;
        }
        units "seconds";
        config false;
        description
          "Maximum ack-timeout value.";
      }
      leaf min-value-decimal {
        type decimal64 {
          fraction-digits 2;
        }
        units "seconds";
        config false;
        description
          "Minimum ack-timeout value.";
      }
      leaf current-value-decimal {
        type decimal64 {
          fraction-digits 2;
        }
        units "seconds";
        default "2";
        description
          "Current ack-timeout value.";
      }
    }
    container ack-random-factor {
      description
        "Random factor used to influence the timing of
         retransmissions.";
      leaf max-value-decimal {
        type decimal64 {
          fraction-digits 2;
        }
        config false;
        description
          "Maximum acceptable ack-random-factor value.";
      }
      leaf min-value-decimal {
        type decimal64 {
          fraction-digits 2;
        }
        config false;
        description
          "Minimum acceptable ack-random-factor value.";
      }
      leaf current-value-decimal {
        type decimal64 {
          fraction-digits 2;
        }
        default "1.5";
        description
          "Current ack-random-factor value.";
      }
    }
  }

  grouping signal-config {
    description
      "DOTS signal channel session configuration.";
    leaf sid {
      type uint32;
      mandatory true;
      description
        "An identifier for the DOTS signal channel
         session configuration data.";
    }
    container mitigating-config {
      description
        "Configuration parameters to use when a mitigation
         is active.";
      uses config-parameters;
    }
    container idle-config {
      description
        "Configuration parameters to use when no mitigation 
         is active.";
      uses config-parameters;
    }
  }

  grouping redirected-signal {
    description
      "Grouping for the redirected signaling.";
    leaf alt-server {
      type string;
      config false;
      mandatory true;
      description
        "FQDN of an alternate server.";
    }
    leaf-list alt-server-record {
      type inet:ip-address;
      config false;
      description
        "List of records for the alternate server.";
    }
  }

  /*
   * Main Container for DOTS Signal Channel
   */

  container dots-signal {
    description
      "Main container for DOTS signal message.

       A DOTS signal message can be a mitigation, a configuration,
       or a redirected signal message.";
    choice message-type {
      description
        "Can be a mitigation, a configuration, or a redirect
         message.";
      case mitigation-scope {
        description
          "Mitigation scope of a mitigation message.";
        uses mitigation-scope;
      }
      case signal-config {
        description
          "Configuration message.";
        uses signal-config;
      }
      case redirected-signal {
        description
          "Redirected signaling.";
        uses redirected-signal;
      }
      case heartbeat {
        description
          "DOTS heartbeats.";
        leaf peer-hb-status {
          type boolean;
          mandatory true;
          description
            "Indicates whether a DOTS agent receives heartbeats
             from its peer.  The value is set to 'true' if the 
             DOTS agent is receiving heartbeat messages 
             from its peer.";
        }
      }
    }
  }
}
]]></sourcecode>
      </section>
    </section>
    <section anchor="mapping" numbered="true" toc="default">
      <name>YANG/JSON Mapping Parameters to CBOR</name>
      <t>All parameters in the payload of the DOTS signal channel <bcp14>MUST</bcp14> be
      mapped to CBOR types as shown in <xref target="cbor-key-values" format="default"/> 
      and are assigned an integer key to save space. </t>
      <ul empty="true" spacing="normal">
        <li>Note: Implementers must check that the mapping output provided by
          their YANG-to-CBOR encoding schemes is aligned with the content of
          <xref target="cbor-key-values" format="default"/>. For example, some CBOR and JSON types for enumerations and
          the 64-bit quantities can differ depending on the encoder used.</li>
      </ul>
      <t>The CBOR key values are divided into two types:
      comprehension-required and comprehension-optional. DOTS agents can
      safely ignore comprehension-optional values they don't
      understand, but they
      cannot successfully process a request if it contains
      comprehension-required values that are not understood. The 4.00 response
      <bcp14>SHOULD</bcp14> include a diagnostic payload describing the unknown
      comprehension-required CBOR key values. The initial set of CBOR key
      values defined in this specification are of type
      comprehension-required.</t>
<table anchor="cbor-key-values">
	<name>CBOR Key Values Used in DOTS Signal Channel Messages &amp; Their
            Mappings to JSON and YANG</name>
	<thead>
	<tr>
		<th>Parameter Name</th>
		<th>YANG Type</th>
		<th>CBOR Key</th>
		<th>CBOR Major Type &amp; Information</th>
		<th>JSON Type</th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td><t>ietf-dots-signal-channel:mitigation-scope</t></td>
		<td>container</td>
		<td>1</td>
		<td>5 map</td>
		<td>Object</td>
	</tr>
	<tr>
		<td>scope</td>
		<td>list</td>
		<td>2</td>
		<td>4 array</td>
		<td>Array</td>
	</tr>
	<tr>
		<td>cdid</td>
		<td>string</td>
		<td>3</td>
		<td>3 text string</td>
		<td>String</td>
	</tr>
	<tr>
		<td>cuid</td>
		<td>string</td>
		<td>4</td>
		<td>3 text string</td>
		<td>String</td>
	</tr>
	<tr>
		<td>mid</td>
		<td>uint32</td>
		<td>5</td>
		<td>0 unsigned</td>
		<td>Number</td>
	</tr>
        <tr>
                <td rowspan="2">target-prefix</td>
                <td>leaf-list</td>
                <td>6</td>
                <td>4 array</td>
                <td>Array</td>
        </tr>
        <tr>
                <td>inet:ip-prefix</td>
                <td/>
                <td>3 text string</td>
                <td>String</td>
        </tr>
        <tr>
                <td>target-port-range</td>
                <td>list</td>
                <td>7</td>
                <td>4 array</td>
                <td>Array</td>
        </tr>
        <tr>
                <td>lower-port</td>
                <td>inet:port-number</td>
                <td>8</td>
                <td>0 unsigned</td>
                <td>Number</td>
        </tr>
        <tr>
                <td>upper-port</td>
                <td>inet:port-number</td>
                <td>9</td>
                <td>0 unsigned</td>
                <td>Number</td>
        </tr>
        <tr>
                <td rowspan="2">target-protocol</td>
                <td>leaf-list</td>
                <td>10</td>
                <td>4 array</td>
                <td>Array</td>
        </tr>
        <tr>
                <td>uint8</td>
                <td/>
                <td>0 unsigned</td>
                <td>Number</td>
        </tr>
        <tr>
                <td rowspan="2">target-fqdn</td>
                <td>leaf-list</td>
                <td>11</td>
                <td>4 array</td>
                <td>Array</td>
        </tr>
        <tr>
                <td>inet:domain-name</td>
                <td/>
                <td>3 text string</td>
                <td>String</td>
        </tr>
        <tr>
                <td rowspan="2">target-uri</td>
                <td>leaf-list</td>
                <td>12</td>
                <td>4 array</td>
                <td>Array</td>
        </tr>
        <tr>
                <td>inet:uri</td>
                <td/>
                <td>3 text string</td>
                <td>String</td>
        </tr>
        <tr>
                <td rowspan="2">alias-name</td>
                <td>leaf-list</td>
                <td>13</td>
                <td>4 array</td>
                <td>Array</td>
        </tr>
        <tr>
                <td>string</td>
                <td/>
                <td>3 text string</td>
                <td>String</td>
        </tr>
        <tr>
                <td rowspan="2">lifetime</td>
                <td rowspan="2">int32</td>
                <td rowspan="2">14</td>
                <td>0 unsigned</td>
                <td>Number</td>
        </tr>
        <tr>
                <td>1 negative</td>
                <td>Number</td>
        </tr>
        <tr>
                <td>mitigation-start</td>
                <td>uint64</td>
                <td>15</td>
                <td>0 unsigned</td>
                <td>String</td>
        </tr>
        <tr>
                <td>status</td>
                <td>enumeration</td>
                <td>16</td>
                <td>0 unsigned</td>
                <td>String</td>
        </tr>
        <tr>
                <td>conflict-information</td>
                <td>container</td>
                <td>17</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td>conflict-status</td>
                <td>enumeration</td>
                <td>18</td>
                <td>0 unsigned</td>
                <td>String</td>
        </tr>
        <tr>
                <td>conflict-cause</td>
                <td>enumeration</td>
                <td>19</td>
                <td>0 unsigned</td>
                <td>String</td>
        </tr>
        <tr>
                <td>retry-timer</td>
                <td>uint32</td>
                <td>20</td>
                <td>0 unsigned</td>
                <td>String</td>
        </tr>
        <tr>
                <td>conflict-scope</td>
                <td>container</td>
                <td>21</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td>acl-list</td>
                <td>list</td>
                <td>22</td>
                <td>4 array</td>
                <td>Array</td>
        </tr>
        <tr>
                <td>acl-name</td>
                <td>leafref</td>
                <td>23</td>
                <td>3 text string</td>
                <td>String</td>
        </tr>
        <tr>
                <td>acl-type</td>
                <td>leafref</td>
                <td>24</td>
                <td>3 text string</td>
                <td>String</td>
        </tr>
        <tr>
                <td>bytes-dropped</td>
                <td><t>yang:zero-based-counter64</t></td>
                <td>25</td>
                <td>0 unsigned</td>
                <td>String</td>
        </tr>
        <tr>
                <td>bps-dropped</td>
                <td>yang:gauge64</td>
                <td>26</td>
                <td>0 unsigned</td>
                <td>String</td>
        </tr>
        <tr>
                <td>pkts-dropped</td>
                <td><t>yang:zero-based-counter64</t></td>
                <td>27</td>
                <td>0 unsigned</td>
                <td>String</td>
        </tr>
        <tr>
                <td>pps-dropped</td>
                <td>yang:gauge64</td>
                <td>28</td>
                <td>0 unsigned</td>
                <td>String</td>
        </tr>
        <tr>
                <td>attack-status</td>
                <td>enumeration</td>
                <td>29</td>
                <td>0 unsigned</td>
                <td>String</td>
        </tr>
        <tr>
                <td><t>ietf-dots-signal-channel:signal-config</t></td>
                <td>container</td>
                <td>30</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td>sid</td>
                <td>uint32</td>
                <td>31</td>
                <td>0 unsigned</td>
                <td>Number</td>
        </tr>
        <tr>
                <td>mitigating-config</td>
                <td>container</td>
                <td>32</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td>heartbeat-interval</td>
                <td>container</td>
                <td>33</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td>max-value</td>
                <td>uint16</td>
                <td>34</td>
                <td>0 unsigned</td>
                <td>Number</td>
        </tr>
        <tr>
                <td>min-value</td>
                <td>uint16</td>
                <td>35</td>
                <td>0 unsigned</td>
                <td>Number</td>
        </tr>
        <tr>
                <td>current-value</td>
                <td>uint16</td>
                <td>36</td>
                <td>0 unsigned</td>
                <td>Number</td>
        </tr>
        <tr>
                <td>missing-hb-allowed</td>
                <td>container</td>
                <td>37</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td>max-retransmit</td>
                <td>container</td>
                <td>38</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td>ack-timeout</td>
                <td>container</td>
                <td>39</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td>ack-random-factor</td>
                <td>container</td>
                <td>40</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td>max-value-decimal</td>
                <td>decimal64</td>
                <td>41</td>
                <td>6 tag 4 [-2, integer]</td>
                <td>String</td>
        </tr>
        <tr>
                <td>min-value-decimal</td>
                <td>decimal64</td>
                <td>42</td>
                <td>6 tag 4 [-2, integer]</td>
                <td>String</td>
        </tr>
        <tr>
                <td>current-value-decimal</td>
                <td>decimal64</td>
                <td>43</td>
                <td>6 tag 4 [-2, integer]</td>
                <td>String</td>
        </tr>
        <tr>
                <td>idle-config</td>
                <td>container</td>
                <td>44</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td rowspan="2">trigger-mitigation</td>
                <td rowspan="2">boolean</td>
                <td rowspan="2">45</td>
                <td>7 bits 20</td>
                <td>False</td>
        </tr>
        <tr>
                <td>7 bits 21</td>
                <td>True</td>
        </tr>
        <tr>
                <td><t>ietf-dots-signal-channel:redirected-signal</t></td>
                <td>container</td>
                <td>46</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td>alt-server</td>
                <td>string</td>
                <td>47</td>
                <td>3 text string</td>
                <td>String</td>
        </tr>
        <tr>
                <td rowspan="2">alt-server-record</td>
                <td>leaf-list</td>
                <td>48</td>
                <td>4 array</td>
                <td>Array</td>
        </tr>
        <tr>
                <td>inet:ip-address</td>
                <td/>
                <td>3 text string</td>
                <td>String</td>
        </tr>
        <tr>
                <td><t>ietf-dots-signal-channel:heartbeat</t></td>
                <td>container</td>
                <td>49</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td>probing-rate</td>
                <td>container</td>
                <td>50</td>
                <td>5 map</td>
                <td>Object</td>
        </tr>
        <tr>
                <td rowspan="2">peer-hb-status</td>
                <td rowspan="2">boolean</td>
                <td rowspan="2">51</td>
                <td>7 bits 20</td>
                <td>False</td>
        </tr>
        <tr>
                <td>7 bits 21</td>
                <td>True</td>
        </tr>
	</tbody>
</table>
    </section>
    <section anchor="profile" numbered="true" toc="default">
      <name>(D)TLS Protocol Profile and Performance Considerations</name>
      <section numbered="true" toc="default">
        <name>(D)TLS Protocol Profile</name>
        <t>This section defines the (D)TLS protocol profile of DOTS signal
        channel over (D)TLS and DOTS data channel over TLS.</t>
        <t>There are known attacks on (D)TLS, such as man-in-the-middle and
        protocol downgrade attacks. These are general attacks on (D)TLS and,
        as such, they are not specific to DOTS over (D)TLS; refer to the
        (D)TLS RFCs for discussion of these security issues. DOTS agents <bcp14>MUST</bcp14>
        adhere to the (D)TLS implementation recommendations and security
        considerations of <xref target="RFC7525" format="default"/> except with respect
        to (D)TLS version. Because DOTS signal channel encryption relying upon
        (D)TLS is virtually a greenfield deployment, DOTS agents <bcp14>MUST</bcp14>
        implement only (D)TLS 1.2 or later.</t>
        <t>When a DOTS client is configured with a domain name of the DOTS
        server, and it connects to its configured DOTS server, the server may
        present it with a PKIX certificate. In order to ensure proper
        authentication, a DOTS client <bcp14>MUST</bcp14> verify the entire certification
        path per <xref target="RFC5280" format="default"/>. Additionally, the DOTS client
        <bcp14>MUST</bcp14> use <xref target="RFC6125" format="default"/> validation techniques to
        compare the domain name with the certificate provided. Certification
        authorities that issue DOTS server certificates <bcp14>SHOULD</bcp14> support the
        DNS-ID and SRV-ID identifier types. DOTS servers <bcp14>SHOULD</bcp14> prefer the use
        of DNS-ID and SRV-ID over CN-ID identifier types in certificate
        requests (as described in <xref target="RFC6125" section="2.3" sectionFormat="of" format="default"/>), and the wildcard character '*' <bcp14>SHOULD NOT</bcp14> be
        included in the presented identifier. DOTS doesn't use URI-IDs for
        server identity verification.</t>
        <t>A key challenge to deploying DOTS is the provisioning of DOTS
        clients, including the distribution of keying material to DOTS clients
        to enable the required mutual authentication of DOTS agents.
        Enrollment over Secure Transport (EST) <xref target="RFC7030" format="default"/>
        defines a method of certificate enrollment by which domains operating
        DOTS servers may provide DOTS clients with all the necessary
        cryptographic keying material, including a private key and a
        certificate, to authenticate themselves. One deployment option is to have DOTS
        clients behave as EST clients for certificate enrollment from an EST
        server provisioned by the mitigation provider. This document does not
        specify which EST or other mechanism the DOTS client uses to achieve
        initial enrollment.</t>
        <t>The Server Name Indication (SNI) extension <xref target="RFC6066" format="default"/> i
        defines a mechanism for a client to tell a
        (D)TLS server the name of the server it wants to contact. This is a
        useful extension for hosting environments where multiple virtual
        servers are reachable over a single IP address. The DOTS client may or
        may not know if it is interacting with a DOTS server in a virtual
        server hosting environment, so the DOTS client <bcp14>SHOULD</bcp14> include the DOTS
        server FQDN in the SNI extension.</t>
        <t>Implementations compliant with this profile <bcp14>MUST</bcp14> implement all of
        the following items:</t>
        <ul spacing="normal">
          <li>DTLS record replay detection 
            (<xref target="RFC6347" section="3.3" sectionFormat="of" format="default"/>) or an equivalent mechanism to protect
            against replay attacks.</li>
          <li>DTLS session resumption without server-side state to resume
            session and convey the DOTS signal.</li>
          <li>At least one of raw public keys <xref target="RFC7250" format="default"/>
            or PSK handshake <xref target="RFC4279" format="default"/> with (EC)DHE key
            exchange. This reduces the size of the ServerHello. Also, this can be
            used by DOTS agents that cannot obtain certificates.</li>
        </ul>
        <t>Implementations compliant with this profile <bcp14>SHOULD</bcp14> implement all of
        the following items to reduce the delay required to deliver a DOTS
        signal channel message:</t>
        <ul spacing="normal">
          <li>TLS False Start <xref target="RFC7918" format="default"/>, which reduces
            round-trips by allowing the TLS client's second flight of messages
            (ChangeCipherSpec) to also contain the DOTS signal. TLS False
            Start is formally defined for use with TLS, but the same technique
            is applicable to DTLS as well.</li>
          <li>Cached Information Extension <xref target="RFC7924" format="default"/>
            which avoids transmitting the server's certificate and certificate
            chain if the client has cached that information from a previous
            TLS handshake.</li>
        </ul>
        <t>Compared to UDP, DOTS signal channel over TCP requires an
        additional round-trip time (RTT) of latency to establish a TCP
        connection. DOTS implementations are encouraged to implement TCP Fast
        Open <xref target="RFC7413" format="default"/> to eliminate that RTT.</t>
      </section>
      <section anchor="DTLS" numbered="true" toc="default">
        <name>(D)TLS 1.3 Considerations</name>
        <t>TLS 1.3 provides critical latency improvements for connection
        establishment over TLS 1.2. The DTLS 1.3 protocol 
        <xref target="I-D.ietf-tls-dtls13" format="default"/> is based upon the TLS 1.3
        protocol and provides equivalent security guarantees. (D)TLS 1.3
        provides two basic handshake modes the DOTS signal channel can take
        advantage of:</t>
        <ul spacing="normal">
          <li>
            A full handshake mode in which a DOTS client can send a DOTS
            mitigation request message after one round trip and the DOTS
            server immediately responds with a DOTS mitigation response. This
            assumes no packet loss is experienced.
          </li>
          <li>
            0-RTT mode in which the DOTS client can authenticate itself and
            send DOTS mitigation request messages in the first message, thus
            reducing handshake latency. 0-RTT only works if the DOTS client
            has previously communicated with that DOTS server, which is very
            likely with the DOTS signal channel.
           </li>
         </ul>
            <t>The DOTS client has to establish a (D)TLS session with the DOTS server
            during 'idle' time and share a PSK. </t>
            <t>During a DDoS attack, the DOTS client can use the
            (D)TLS session to convey the DOTS mitigation request message and,
            if there is no response from the server after multiple retries,
            the DOTS client can resume the (D)TLS session in 0-RTT mode using
            PSK. </t>
            <t>DOTS servers that support (D)TLS 1.3
            <bcp14>MAY</bcp14> allow DOTS clients to send early data (0-RTT). DOTS clients
            <bcp14>MUST NOT</bcp14> send "CoAP Ping" as early data; such messages <bcp14>MUST</bcp14> be
            rejected by DOTS servers. <xref target="RFC8446" section="8" sectionFormat="of" format="default"/> 
            discusses some mechanisms to implement in order to
            limit the impact of replay attacks on 0-RTT data. If the DOTS
            server accepts 0-RTT, it <bcp14>MUST</bcp14> implement one of these mechanisms to
            prevent replay at the TLS layer. A DOTS server can reject 0-RTT by
            sending a TLS HelloRetryRequest. </t>
            <t>The DOTS signal channel messages sent as early data by the DOTS 
            client are idempotent requests. As a reminder, the Message ID 
            (<xref target="RFC7252" section="3" sectionFormat="of" format="default"/>) 
            is changed each time a new CoAP request is sent, and the Token 
            (<xref target="RFC7252" section="5.3.1" sectionFormat="of" format="default"/>) 
            is randomized in each CoAP request.
	    The DOTS server(s) <bcp14>MUST</bcp14> use 
            the Message ID and the Token in the DOTS signal channel message to 
            detect replay of early data at the
            application layer and accept 0-RTT data at most once from the
            same DOTS client. This anti-replay defense requires sharing the
            Message ID and the Token in the 0-RTT data between DOTS servers in
            the DOTS server domain. DOTS servers do not rely on transport
            coordinates to identify DOTS peers. As specified in 
            <xref target="post" format="default"/>, DOTS servers couple the DOTS signal channel
            sessions using the DOTS client identity and optionally the 'cdid'
            parameter value. Furthermore, the 'mid' value is monotonically
            increased by the DOTS client for each mitigation request, thus
            attackers that replay mitigation requests with lower numeric 'mid'
            values and overlapping scopes with mitigation requests having
            higher numeric 'mid' values will be rejected systematically by the
            DOTS server. Likewise, the 'sid' value is monotonically increased by
            the DOTS client for each configuration request 
            (<xref target="convey" format="default"/>); attackers replaying configuration
            requests with lower numeric 'sid' values will be rejected by the
            DOTS server if it maintains a higher numeric 'sid' value for this
            DOTS client. </t>
            <t>Owing to the aforementioned
            protections, all DOTS signal channel requests are safe to transmit
            in TLS 1.3 as early data. Refer to <xref target="I-D.boucadair-dots-earlydata" format="default"/> for more details.
            </t>
            <t>A simplified TLS 1.3 handshake with 0-RTT
            DOTS mitigation request message exchange is shown in <xref target="Figure24" format="default"/>.</t>
            <figure anchor="Figure24">
              <name>A Simplified TLS 1.3 Handshake with 0-RTT</name>
              <artwork align="left" name="" type="" alt=""><![CDATA[
    DOTS Client                                    DOTS Server

    ClientHello
    (0-RTT DOTS signal message)
                              -------->
                                                    ServerHello
                                          {EncryptedExtensions}
                                                     {Finished}
                              <--------   [DOTS signal message]
    (end_of_early_data)       
    {Finished}                --------> 
    [DOTS signal message]     <------->   [DOTS signal message]

Note that:
    () Indicates messages protected 0-RTT keys
    {} Indicates messages protected using handshake keys
    [] Indicates messages protected using 1-RTT keys
]]></artwork>
            </figure>
      </section>
      <section anchor="mtu" numbered="true" toc="default">
        <name>DTLS MTU and Fragmentation</name>
        <t>To avoid DOTS signal message fragmentation and the subsequent
        decreased probability of message delivery, DOTS agents <bcp14>MUST</bcp14> ensure
        that the DTLS record fits within a single datagram. As a reminder, DTLS
        handles fragmentation and reassembly only for handshake messages and
        not for the application data (<xref target="RFC6347" section="4.1.1" sectionFormat="of" format="default"/>). 
        If the path MTU (PMTU) cannot be discovered, DOTS
        agents <bcp14>MUST</bcp14> assume a PMTU of 1280 bytes, as IPv6 requires that every
        link in the Internet have an MTU of 1280 octets or greater as
        specified in <xref target="RFC8200" format="default"/>. If IPv4 support on legacy
        or otherwise unusual networks is a consideration and the PMTU is
        unknown, DOTS implementations <bcp14>MAY</bcp14> assume a PMTU of 576 bytes for
        IPv4 datagrams, as every IPv4 host must be capable of receiving a
        packet whose length is equal to 576 bytes as discussed in <xref target="RFC0791" format="default"/> and <xref target="RFC1122" format="default"/>.</t>
        <t>The DOTS client must consider the amount of record expansion
        expected by the DTLS processing when calculating the size of the CoAP
        message that fits within the PMTU. PMTU <bcp14>MUST</bcp14> be greater than
        or equal to [CoAP message size + DTLS 1.2 overhead of 13 octets +
        authentication overhead of the negotiated DTLS cipher suite + block
        padding] (<xref target="RFC6347" section="4.1.1.1" sectionFormat="of" format="default"/>). If the
        total request size exceeds the PMTU, then the DOTS client <bcp14>MUST</bcp14>
        split the DOTS signal into separate messages; for example, the list of
        addresses in the 'target-prefix' parameter could be split into
        multiple lists and each list conveyed in a new PUT request.</t>
        <aside><t>Implementation Note: DOTS choice of message size parameters works
        well with IPv6 and with most of today's IPv4 paths. However, with
        IPv4, it is harder to safely make sure that there is no IP
        fragmentation. If the IPv4 PMTU is unknown, implementations may
        want to limit themselves to more conservative IPv4 datagram sizes such
        as 576 bytes, per <xref target="RFC0791" format="default"/>.</t></aside>
      </section>
    </section>
    <section anchor="mutauth" numbered="true" toc="default">
      <name>Mutual Authentication of DOTS Agents &amp; Authorization of DOTS Clients</name>
      <t>(D)TLS based upon client certificates can be used for mutual
      authentication between DOTS agents. If, for example, a DOTS gateway is
      involved, DOTS clients and DOTS gateways must perform mutual
      authentication; only authorized DOTS clients are allowed to send DOTS
      signals to a DOTS gateway. The DOTS gateway and the DOTS server must
      perform mutual authentication; a DOTS server only allows DOTS signal
      channel messages from an authorized DOTS gateway, thereby creating a
      two-link chain of transitive authentication between the DOTS client and
      the DOTS server.</t>
      <t>The DOTS server should support certificate-based client
      authentication. The DOTS client should respond to the DOTS server's TLS
      CertificateRequest message with the PKIX certificate held by the DOTS
      client. DOTS client certificate validation must be performed per
      <xref target="RFC5280" format="default"/>, and the DOTS client certificate must
      conform to the <xref target="RFC5280" format="default"/> certificate profile. If a
      DOTS client does not support TLS client certificate authentication, it
      must support client authentication based on pre-shared key or raw public key.</t>
      <figure anchor="Figure12">
        <name>Example of Authentication and Authorization of DOTS Agents</name>
        <artwork align="center" name="" type="" alt=""><![CDATA[
+---------------------------------------------+
|       example.com domain       +---------+  |
|                                | AAA     |  |
| +---------------+              | Server  |  |
| | Application   |              +------+--+  |
| | server        +<---------------+    ^     |
| | (DOTS client) |                |    |     |
| +---------------+                |    |     |
|                                  V    V     |   example.net domain
|                            +-----+----+--+  |    +---------------+
| +--------------+           |             |  |    |               |
| |   Guest      +<----x---->+    DOTS     +<----->+    DOTS       |
| | (DOTS client)|           |    gateway  |  |    |    server     |
| +--------------+           |             |  |    |               |
|                            +----+--------+  |    +---------------+
|                                 ^           |
|                                 |           |
| +----------------+              |           |
| | DDoS detector  |              |           |
| | (DOTS client)  +<-------------+           |
| +----------------+                          |
+---------------------------------------------+
]]></artwork>
      </figure>
      <t>In the example depicted in <xref target="Figure12" format="default"/>, the DOTS
      gateway and DOTS clients within the 'example.com' domain mutually
      authenticate. After the DOTS gateway validates the identity of a DOTS
      client, it communicates with the AAA server in the 'example.com' domain
      to determine if the DOTS client is authorized to request DDoS
      mitigation. If the DOTS client is not authorized, a 4.01 (Unauthorized)
      is returned in the response to the DOTS client. In this example, the
      DOTS gateway only allows the application server and DDoS attack detector
      to request DDoS mitigation, but does not permit the user of type 'guest'
      to request DDoS mitigation.</t>
      <t>Also, DOTS gateways and servers located in different domains must
      perform mutual authentication (e.g., using certificates). A DOTS server
      will only allow a DOTS gateway with a certificate for a particular
      domain to request mitigation for that domain. In reference to 
      <xref target="Figure12" format="default"/>, the DOTS server only allows the DOTS gateway
      to request mitigation for the 'example.com' domain and not for other
      domains.</t>
    </section>

    <section anchor="IANA" numbered="true" toc="default">
      <name>IANA Considerations</name>
      <section anchor="port" numbered="true" toc="default">
        <name>DOTS Signal Channel UDP and TCP Port Number</name>

        <t>IANA has assigned the port number 4646 (the ASCII decimal value for 
   ".." (DOTS)) to the DOTS signal channel protocol for both UDP and TCP 
   from the "Service Name and Transport Protocol Port Number Registry" 
        available at
        <eref target="https://www.iana.org/assignments/service-names-port-numbers/" brackets="angle"/>.</t>
        <ul empty="true" spacing="normal">
          <li>
            <dl newline="false" spacing="compact">
             <dt>Service Name:</dt><dd>dots-signal</dd>
             <dt>Port Number:</dt><dd>4646</dd>
             <dt>Transport Protocol:</dt><dd>TCP</dd>
             <dt>Description:</dt><dd>Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal Channel</dd>
             <dt>Assignee:</dt><dd>IESG</dd>
             <dt>Contact:</dt><dd>IETF Chair</dd>
             <dt>Registration Date:</dt><dd>2020-01-16</dd>
             <dt>Reference:</dt><dd>[RFC8782]</dd>
           </dl>
          </li>
          <li>
            <dl newline="false" spacing="compact">
             <dt>Service Name:</dt><dd>dots-signal</dd>
             <dt>Port Number:</dt><dd>4646</dd>
             <dt>Transport Protocol:</dt><dd>UDP</dd>
             <dt>Description:</dt><dd>Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal Channel</dd>
             <dt>Assignee:</dt><dd>IESG</dd>
             <dt>Contact:</dt><dd>IETF Chair</dd>
             <dt>Registration Date:</dt><dd>2020-01-16</dd>
             <dt>Reference:</dt><dd>[RFC8782]</dd>
           </dl>
         </li>
        </ul>


      </section>

      <section anchor="uri" numbered="true" toc="default">
        <name>Well-Known 'dots' URI</name>
        <t>IANA has registered the 'dots' well-known URI
        (<xref target="tab-dots-uri" format="default"/>) in the Well-Known URIs registry
        (<eref target="https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml" brackets="angle"/>)
        as defined by <xref target="RFC8615" format="default"/>:</t>
<table anchor="tab-dots-uri">
	<name>'dots' Well-Known URI</name>
	<thead>
	<tr>
		<th>URI Suffix</th>
		<th>Change Controller</th>
		<th>Reference</th>
                <th>Status</th>
		<th>Related information</th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td>dots</td>
		<td>IETF</td>
		<td>[RFC8782]</td>
                <td>permanent</td>
		<td>None</td>
	</tr>
	</tbody>
</table>
      </section>
      <section anchor="MediaReg" numbered="true" toc="default">
        <name>Media Type Registration</name>
        <t>IANA has registered the "application/dots+cbor"
        media type in the "Media Types" registry <xref target="IANA-MediaTypes" format="default"/> 
        in the manner described in <xref target="RFC6838" format="default"/>, 
        which can be used to indicate that the
        content is a DOTS signal channel object: </t>
 
          <t>Type name: application</t>
          <t>Subtype name: dots+cbor</t>
          <t>Required parameters: N/A</t>
          <t>Optional parameters: N/A</t>
          <t>Encoding considerations: binary</t>
          <t>Security considerations: See the Security Considerations
            section of [RFC8782].</t>
          <t>Interoperability considerations: N/A</t>
          <t>Published specification: [RFC8782]</t>
          <t>Applications that use this media type: DOTS agents sending DOTS
            messages over CoAP over (D)TLS.</t>
          <t>Fragment identifier considerations: N/A</t>
          
	    
            <t>Additional information:</t>
            <ul empty="true" spacing="compact">
              <li>Deprecated alias names for this type: N/A</li>
              <li>Magic number(s): N/A</li>
              <li>File extension(s): N/A</li>
              <li>Macintosh file type code(s): N/A</li>
            </ul>
          
          <t>Person &amp; email address to contact for further information: IESG, iesg@ietf.org</t>
          <t>Intended usage: COMMON</t>
          <t>Restrictions on usage: none</t>
          <t>Author: See Authors' Addresses section.</t>
          <t>Change controller: IESG</t>
          <t>Provisional registration? No</t>
        

	
      </section>

      <section anchor="IANACoAPContentFormatRegistration" numbered="true" toc="default">
        <name>CoAP Content-Formats Registration</name>
        <t>IANA has registered the CoAP Content-Format ID
        for the "application/dots+cbor" media type in the "CoAP
        Content-Formats" registry <xref target="IANA-CoAP-Content-Formats" format="default"/>:</t>
        <ul spacing="compact">
          <li>Media Type: application/dots+cbor</li>
          <li>Encoding: -</li>
          <li>ID: 271</li>
          <li>Reference: [RFC8782]</li>
        </ul>
      </section>

      <section anchor="IANACBORTagAssignment" numbered="true" toc="default">
        <name>CBOR Tag Registration</name>
        <t>This section defines the DOTS CBOR tag as another means for
        applications to declare that a CBOR data structure is a DOTS signal
        channel object. Its use is optional and is intended for use in cases
        in which this information would not otherwise be known. The DOTS CBOR tag
        is not required for DOTS signal channel protocol version specified in
        this document. If present, the DOTS tag <bcp14>MUST</bcp14> prefix a DOTS signal
        channel object.</t>
        <t>IANA has registered the DOTS signal channel
        CBOR tag in the "CBOR Tags" registry <xref target="IANA-CBOR-Tags" format="default"/>:</t>
        <ul spacing="compact">
          <li>Tag: 271</li>
          <li>Data Item: DDoS Open Threat Signaling (DOTS) signal channel
            object</li>
          <li>Semantics: DDoS Open Threat Signaling (DOTS) signal channel
            object, as defined in [RFC8782]</li>
          <li>Reference: [RFC8782]</li>
        </ul>
      </section>
      <section anchor="reg" numbered="true" toc="default">
        <name>DOTS Signal Channel Protocol Registry</name>
        <t>IANA has created a new registry titled the "Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal Channel" registry. The following sections define
        subregistries.</t>

        <section anchor="map" numbered="true" toc="default">
          <name>DOTS Signal Channel CBOR Key Values Subregistry</name>
          <t>IANA has created a new subregistry titled
          "DOTS Signal Channel CBOR Key Values".</t>
          <t>The structure of this subregistry is provided in 
          <xref target="format" format="default"/>. 
          <xref target="initial" format="default"/> provides 
          the registry as initially populated with the values in 
          <xref target="tab-cbor-key-reg" format="default"/>.</t>
          <section anchor="format" numbered="true" toc="default">
            <name>Registration Template</name>
            <dl newline="true" spacing="normal">
              <dt>Parameter name:</dt>
              <dd>Parameter name as used
                in the DOTS signal channel.</dd>
              <dt>CBOR Key Value:</dt>
              <dd>
                <t>Key value for the
                parameter. The key value <bcp14>MUST</bcp14> be an integer in the 1-65535
                range. The key values of the comprehension-required range
                (0x0001 - 0x3FFF) and of the comprehension-optional range
                (0x8000 - 0xBFFF) are assigned by IETF Review 
(<xref target="RFC8126" section="4.8" sectionFormat="of" format="default"/>). The key values of the
                comprehension-optional range (0x4000 - 0x7FFF) are assigned by
                Specification Required 
(<xref target="RFC8126" section="4.6" sectionFormat="of" format="default"/>) and of the comprehension-optional
                range (0xC000 - 0xFFFF) are reserved for Private Use 
(<xref target="RFC8126" section="4.1" sectionFormat="of" format="default"/>).</t>
                <t>Registration requests for the 0x4000 - 0x7FFF
                range are evaluated after a three-week review period on the
                dots-signal-reg-review@ietf.org mailing list, on the advice of
                one or more Designated Experts. However, to allow for the
                allocation of values prior to publication, the Designated
                Experts may approve registration once they are satisfied that
                such a specification will be published. New registration
                requests should be sent in the form of an email to the review
                mailing list; the request should use an appropriate subject
                (e.g., "Request to register CBOR Key Value for DOTS:
                example"). IANA will only accept new registrations from the
                Designated Experts, and it will check that review was requested
                on the mailing list in accordance with these
                procedures.</t>
                <t>Within the review period,
                the Designated Experts will either approve or deny the
                registration request, communicating this decision to the
                review list and IANA. Denials should include an explanation
                and, if applicable, suggestions as to how to make the request
                successful. Registration requests that are undetermined for a
                period longer than 21 days can be brought to the IESG's
                attention (using the iesg@ietf.org mailing list) for
                resolution.</t>
                <t>Criteria that should be
                applied by the Designated Experts include determining whether
                the proposed registration duplicates existing functionality,
                whether it is likely to be of general applicability or whether
                it is useful only for a single use case, and whether the
                registration description is clear. IANA must only accept
                registry updates to the 0x4000 - 0x7FFF range from the
                Designated Experts and should direct all requests for
                registration to the review mailing list. It is suggested that
                multiple Designated Experts be appointed. In cases where a
                registration decision could be perceived as creating a
                conflict of interest for a particular Expert, that Expert
                should defer to the judgment of the other Experts.</t>
              </dd>
              <dt>CBOR Major Type:</dt>
              <dd>CBOR Major type and
                optional tag for the parameter.</dd>
              <dt>Change Controller:</dt>
              <dd>For Standards Track
                RFCs, list the "IESG". For others, give the name of the
                responsible party. Other details (e.g., email address) may
                also be included.</dd>
              <dt>Specification Document(s):</dt>
              <dd>Reference
                to the document or documents that specify the parameter,
                preferably including URIs that can be used to retrieve copies
                of the documents. An indication of the relevant sections may
                also be included but is not required.</dd>
            </dl>
          </section>
          <section anchor="initial" numbered="true" toc="default">
            <name>Initial Subregistry Content</name>

<table anchor="tab-cbor-key-reg">
	<name>Initial DOTS Signal Channel CBOR Key Values Registry</name>
	<thead>
	<tr>
		<th>Parameter Name</th>
		<th>CBOR Key Value</th>
		<th>CBOR Major Type</th>
		<th>Change Controller</th>
		<th>Specification Document(s)</th>
	</tr>
	</thead>
	<tbody>
	<tr>
                <td>Reserved</td>
                <td>0</td>
                <td/>
                <td/>
                <td>[RFC8782]</td>
        </tr>
        <tr>
		<td><t>ietf-dots-signal-channel:mitigation-scope</t></td>
		<td>1</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>scope</td>
		<td>2</td>
		<td>4</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>cdid</td>
		<td>3</td>
		<td>3</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>cuid</td>
		<td>4</td>
		<td>3</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>mid</td>
		<td>5</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>target-prefix</td>
		<td>6</td>
		<td>4</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>target-port-range</td>
		<td>7</td>
		<td>4</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>lower-port</td>
		<td>8</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>upper-port</td>
		<td>9</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>target-protocol</td>
		<td>10</td>
		<td>4</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>target-fqdn</td>
		<td>11</td>
		<td>4</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>target-uri</td>
		<td>12</td>
		<td>4</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>alias-name</td>
		<td>13</td>
		<td>4</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>lifetime</td>
		<td>14</td>
		<td>0/1</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>mitigation-start</td>
		<td>15</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>status</td>
		<td>16</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>conflict-information</td>
		<td>17</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>conflict-status</td>
		<td>18</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>conflict-cause</td>
		<td>19</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>retry-timer</td>
		<td>20</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>conflict-scope</td>
		<td>21</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>acl-list</td>
		<td>22</td>
		<td>4</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>acl-name</td>
		<td>23</td>
		<td>3</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>acl-type</td>
		<td>24</td>
		<td>3</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>bytes-dropped</td>
		<td>25</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>bps-dropped</td>
		<td>26</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>pkts-dropped</td>
		<td>27</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>pps-dropped</td>
		<td>28</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>attack-status</td>
		<td>29</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td><t>ietf-dots-signal-channel:signal-config</t></td>
		<td>30</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>sid</td>
		<td>31</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>mitigating-config</td>
		<td>32</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>heartbeat-interval</td>
		<td>33</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>min-value</td>
		<td>34</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>max-value</td>
		<td>35</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>current-value</td>
		<td>36</td>
		<td>0</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>missing-hb-allowed</td>
		<td>37</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>max-retransmit</td>
		<td>38</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>ack-timeout</td>
		<td>39</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>ack-random-factor</td>
		<td>40</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>min-value-decimal</td>
		<td>41</td>
		<td>6tag4</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>max-value-decimal</td>
		<td>42</td>
		<td>6tag4</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>current-value-decimal</td>
		<td>43</td>
		<td>6tag4</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>idle-config</td>
		<td>44</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>trigger-mitigation</td>
		<td>45</td>
		<td>7</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td><t>ietf-dots-signal-channel:redirected-signal</t></td>
		<td>46</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>alt-server</td>
		<td>47</td>
		<td>3</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>alt-server-record</td>
		<td>48</td>
		<td>4</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td><t>ietf-dots-signal-channel:heartbeat</t></td>
		<td>49</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>probing-rate</td>
		<td>50</td>
		<td>5</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
		<td>peer-hb-status</td>
		<td>51</td>
		<td>7</td>
		<td>IESG</td>
		<td>[RFC8782]</td>
	</tr>
	<tr>
                <td>Unassigned</td>
                <td>52-49151</td>
                <td/>
                <td/>
                <td/>
        </tr>
	<tr>
                <td>Reserved for Private Use</td>
                <td>49152-65535</td>
                <td/>
                <td/>
                <td>[RFC8782]</td>
        </tr>
	</tbody>
</table>
          </section>
        </section>

        <section anchor="sc" numbered="true" toc="default">
          <name>Status Codes Subregistry</name>
          <t>IANA has created a new subregistry titled
          "DOTS Signal Channel Status Codes". Codes in this registry are used
          as valid values of 'status' parameter.</t>
          <t>The registry is initially populated with the following
          values:</t>

          <table align="center">
          <name>Initial DOTS Signal Channel Status Codes</name>
            <thead>
              <tr>
                <th align="right">Code</th>
                <th align="left">Label</th>
                <th align="left">Description</th>
                <th align="left">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right"><t>0</t></td>
                <td align="left"><t>Reserved</t></td>
                <td align="left"/>
                <td align="left"><t>[RFC8782]</t></td>
              </tr>
              <tr>
                <td align="right"><t>1</t></td>
                <td align="left"><t>attack-mitigation-in-progress</t></td>
                <td align="left"><t>Attack mitigation setup is in progress (e.g., changing the
            network path to redirect the inbound traffic to a DOTS
            mitigator).</t></td>
                <td align="left"><t>[RFC8782]</t></td>
              </tr>
              <tr>
                <td align="right"><t>2</t></td>
                <td align="left"><t>attack-successfully-mitigated</t></td>
                <td align="left"><t>Attack is being successfully mitigated (e.g., traffic is
            redirected to a DDoS mitigator and attack traffic is dropped).</t></td>
                <td align="left"><t>[RFC8782]</t></td>
              </tr>
              <tr>
                <td align="right"><t>3</t></td>
                <td align="left"><t>attack-stopped</t></td>
                <td align="left"><t>Attack has stopped and the DOTS client can withdraw the
            mitigation request.</t></td>
                <td align="left"><t>[RFC8782]</t></td>
              </tr>
              <tr>
                <td align="right"><t>4</t></td>
                <td align="left"><t>attack-exceeded-capability</t></td>
                <td align="left"><t>Attack has exceeded the mitigation provider capability.</t></td>
                <td align="left"><t>[RFC8782]</t></td>
              </tr>
              <tr>
                <td align="right"><t>5</t></td>
                <td align="left"><t>dots-client-withdrawn-mitigation</t></td>
                <td align="left"><t>DOTS client has withdrawn the mitigation request and the
            mitigation is active but terminating.</t></td>
                <td align="left"><t>[RFC8782]</t></td>
              </tr>
              <tr>
                <td align="right"><t>6</t></td>
                <td align="left"><t>attack-mitigation-terminated</t></td>
                <td align="left"><t>Attack mitigation is now terminated.</t></td>
                <td align="left"><t>[RFC8782]</t></td>
              </tr>
              <tr>
                <td align="right"><t>7</t></td>
                <td align="left"><t>attack-mitigation-withdrawn</t></td>
                <td align="left"><t>Attack mitigation is withdrawn.</t></td>
                <td align="left"><t>[RFC8782]</t></td>
              </tr>
              <tr>
                <td align="right"><t>8</t></td>
                <td align="left"><t>attack-mitigation-signal-loss</t></td>
                <td align="left"><t>Attack mitigation will be triggered for the mitigation request
            only when the DOTS signal channel session is lost.</t></td>
                <td align="left"><t>[RFC8782]</t></td>
              </tr>
              <tr>
                <td align="right"><t>9-2147483647</t></td>
                <td align="left"><t>Unassigned</t></td>
                <td align="left"/>
                <td align="left"/>
              </tr>
            </tbody>
          </table>
          <t>New codes can be assigned via Standards Action <xref target="RFC8126" format="default"/>.</t>
        </section>

        <section anchor="cs" numbered="true" toc="default">
          <name>Conflict Status Codes Subregistry</name>
          <t>IANA has created a new subregistry titled
          "DOTS Signal Channel Conflict Status Codes". Codes in this registry
          are used as valid values of 'conflict-status' parameter.</t>
          <t>The registry is initially populated with the following
          values:</t>
          <table align="center">
          <name>Initial DOTS Signal Channel Conflict Status Codes</name>
            <thead>
              <tr>
                <th align="right">Code</th>
                <th align="left">Label</th>
                <th align="left">Description</th>
                <th align="left">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right">0</td>
                <td align="left">Reserved</td>
                <td align="left"/>
                <td align="left">[RFC8782]</td>
              </tr>
              <tr>
                <td align="right">1</td>
                <td align="left">request-inactive-&zwsp;other-active</td>
                <td align="left">DOTS server has detected conflicting mitigation requests from
            different DOTS clients. This mitigation request is currently
            inactive until the conflicts are resolved. Another mitigation
            request is active.</td>
                <td align="left">[RFC8782]</td>
              </tr>
              <tr>
                <td align="right">2</td>
                <td align="left">request-active</td>
                <td align="left">DOTS server has detected conflicting mitigation requests from
            different DOTS clients. This mitigation request is currently
            active.</td>
                <td align="left">[RFC8782]</td>
              </tr>
              <tr>
                <td align="right">3</td>
                <td align="left">all-requests-&zwsp;inactive</td>
                <td align="left">DOTS server has detected conflicting mitigation requests from
            different DOTS clients. All conflicting mitigation requests are
            inactive.</td>
                <td align="left">[RFC8782]</td>
              </tr>
              <tr>
                <td align="right">4-2147483647</td>
                <td align="left">Unassigned</td>
                <td align="left"/>
                <td align="left"/>
              </tr>
            </tbody>
          </table>
          <t>New codes can be assigned via Standards Action <xref target="RFC8126" format="default"/>.</t>
        </section>


        <section anchor="cc" numbered="true" toc="default">
          <name>Conflict Cause Codes Subregistry</name>
          <t>IANA has created a new subregistry titled
          "DOTS Signal Channel Conflict Cause Codes". Codes in this registry
          are used as valid values of 'conflict-cause' parameter.</t>
          <t>The registry is initially populated with the following
          values:</t>
          <table align="center">
          <name>Initial DOTS Signal Channel Conflict Cause Codes</name>
            <thead>
              <tr>
                <th align="right">Code</th>
                <th align="left">Label</th>
                <th align="left">Description</th>
                <th align="left">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right">0</td>
                <td align="left">Reserved</td>
                <td align="left"/>
                <td align="left">[RFC8782]</td>
              </tr>
              <tr>
                <td align="right">1</td>
                <td align="left">overlapping-targets</td>
                <td align="left">Overlapping targets.</td>
                <td align="left">[RFC8782]</td>
              </tr>
              <tr>
                <td align="right">2</td>
                <td align="left">conflict-with-&zwsp;acceptlist</td>
                <td align="left">Conflicts with an existing accept-list. This code is returned
            when the DDoS mitigation detects source addresses/prefixes in the
            accept-listed ACLs are attacking the target.</td>
                <td align="left">[RFC8782]</td>
              </tr>
              <tr>
                <td align="right">3</td>
                <td align="left">cuid-collision</td>
                <td align="left">CUID Collision. This code is returned when a DOTS client uses a
            'cuid' that is already used by another DOTS client.</td>
                <td align="left">[RFC8782]</td>
              </tr>
              <tr>
                <td align="right">4-2147483647</td>
                <td align="left">Unassigned</td>
                <td align="left"/>
                <td align="left"/>
              </tr>
            </tbody>
          </table>
          <t>New codes can be assigned via Standards Action <xref target="RFC8126" format="default"/>.</t>
        </section>


        <section anchor="as" numbered="true" toc="default">
          <name>Attack Status Codes Subregistry</name>
          <t>IANA has created a new subregistry titled
          "DOTS Signal Channel Attack Status Codes". Codes in this registry
          are used as valid values of 'attack-status' parameter.</t>
          <t>The registry is initially populated with the following
          values:</t>
          <table align="center">
          <name>Initial DOTS Signal Channel Attack Status Codes</name>
            <thead>
              <tr>
                <th align="right">Code</th>
                <th align="left">Label</th>
                <th align="left">Description</th>
                <th align="left">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right">0</td>
                <td align="left">Reserved</td>
                <td align="left"/>
                <td align="left">[RFC8782]</td>
              </tr>
              <tr>
                <td align="right">1</td>
                <td align="left">under-attack</td>
                <td align="left">The DOTS client determines that it is still under attack.</td>
                <td align="left">[RFC8782]</td>
              </tr>
              <tr>
                <td align="right">2</td>
                <td align="left">attack-successfully-&zwsp;mitigated</td>
                <td align="left">The DOTS client determines that the attack is successfully
            mitigated.</td>
                <td align="left">[RFC8782]</td>
              </tr>
              <tr>
                <td align="right">3-2147483647</td>
                <td align="left">Unassigned</td>
                <td align="left"/>
                <td align="left"/>
              </tr>
            </tbody>
          </table>
          <t>New codes can be assigned via Standards Action <xref target="RFC8126" format="default"/>.</t>
        </section>
      </section>


      <section anchor="yang" numbered="true" toc="default">
        <name>DOTS Signal Channel YANG Modules</name>
        <t>IANA has registered the following URIs in the
        "ns" subregistry within the "IETF XML Registry" <xref target="RFC3688" format="default"/>: </t>
        <ul empty="true" spacing="normal">
        <li>
	   <dl newline="false" spacing="compact">
		<dt>URI:</dt><dd>urn:ietf:params:xml:ns:yang:ietf-dots-signal-channel</dd>
		<dt>Registrant Contact:</dt><dd>The IESG.</dd>
		<dt>XML:</dt><dd>N/A; the requested URI is an XML namespace.</dd>
	  </dl>
        </li>
        <li>
	<dl newline="false" spacing="compact">
                <dt>URI:</dt> <dd>urn:ietf:params:xml:ns:yang:iana-dots-signal-channel</dd>
                <dt>Registrant Contact:</dt> <dd>IANA.</dd>
                <dt>XML:</dt> <dd>N/A; the requested URI is an XML namespace.</dd>
        </dl>
        </li>
        </ul>

        <t>IANA has registered the following YANG
        modules in the "YANG Module Names" subregistry <xref target="RFC7950" format="default"/> 
        within the "YANG Parameters" registry.</t>

        <ul empty="true" spacing="normal">
        <li>
	   <dl newline="false" spacing="compact">
		<dt>Name:</dt> <dd>ietf-dots-signal-channel</dd>
		<dt>Maintained by IANA:</dt> <dd>N</dd>
		<dt>Namespace:</dt> <dd>urn:ietf:params:xml:ns:yang:ietf-dots-signal-channel</dd>
		<dt>Prefix:</dt> <dd>signal</dd>
		<dt>Reference:</dt> <dd>RFC8782</dd>
	  </dl>
        </li>
        <li>
	<dl newline="false" spacing="compact">
                <dt>Name:</dt> <dd>iana-dots-signal-channel</dd>
                <dt>Maintained by IANA:</dt> <dd>Y</dd>
                <dt>Namespace:</dt> <dd>urn:ietf:params:xml:ns:yang:iana-dots-signal-channel</dd>
                <dt>Prefix:</dt> <dd>iana-signal</dd>
                <dt>Reference:</dt> <dd>RFC8782</dd>
        </dl>
        </li>
        </ul>

        <t>This document defines the initial version of the IANA-maintained
        iana-dots-signal-channel YANG module. IANA has added this
        note:</t>
        <ul empty="true" spacing="normal">
          <li>Status, conflict status, conflict cause, and attack status
            values must not be directly added to the iana-dots-signal-channel
            YANG module. They must instead be respectively added to the "DOTS
            Status Codes", "DOTS Conflict Status Codes", "DOTS Conflict Cause
            Codes", and "DOTS Attack Status Codes" registries.</li>
        </ul>
        <t>When a 'status', 'conflict-status', 'conflict-cause', or
        'attack-status' value is respectively added to the "DOTS Status
        Codes", "DOTS Conflict Status Codes", "DOTS Conflict Cause Codes", or
        "DOTS Attack Status Codes" registry, a new "enum" statement must be
        added to the iana-dots-signal-channel YANG module. The following
        "enum" statement, and substatements thereof, should be defined:</t>
        <dl newline="false" spacing="normal" indent="15">
          <dt>"enum":</dt>
          <dd>Replicates the label from the registry.</dd>
          <dt>"value":</dt>
          <dd>Contains the IANA-assigned value
            corresponding to the 'status', 'conflict-status',
            'conflict-cause', or 'attack-status'.</dd>
          <dt>"description":</dt>
          <dd>Replicates the description from the registry.</dd>
          <dt>"reference":</dt>
          <dd>Replicates the reference from
            the registry and adds the title of the document.</dd>
        </dl>
        <t>When the iana-dots-signal-channel YANG module is updated, a new
        "revision" statement must be added in front of the existing revision
        statements.</t>
        <t>IANA added this note to "DOTS Status Codes", "DOTS
        Conflict Status Codes", "DOTS Conflict Cause Codes", and "DOTS Attack
        Status Codes" registries:</t>
        <ul empty="true" spacing="normal">
          <li>When this registry is modified, the YANG module
            iana-dots-signal-channel must be updated as defined in
            [RFC8782].</li>
        </ul>
      </section>
    </section>
    <section anchor="security" numbered="true" toc="default">
      <name>Security Considerations</name>
      <t>High-level DOTS security considerations are documented in <xref target="RFC8612" format="default"/> and <xref target="I-D.ietf-dots-architecture" format="default"/>.</t>
      <t>Authenticated encryption <bcp14>MUST</bcp14> be used for data confidentiality and
      message integrity. The interaction between the DOTS agents requires
      Datagram Transport Layer Security (DTLS) or Transport Layer Security
      (TLS) with a cipher suite offering confidentiality protection, and the
      guidance given in <xref target="RFC7525" format="default"/> <bcp14>MUST</bcp14> be followed to
      avoid attacks on (D)TLS. The (D)TLS protocol profile used for the DOTS
      signal channel is specified in <xref target="profile" format="default"/>.</t>
      <t>If TCP is used between DOTS agents, an attacker may be able to inject
      RST packets, bogus application segments, etc., regardless of whether TLS
      authentication is used. Because the application data is TLS protected,
      this will not result in the application receiving bogus data, but it
      will constitute a DoS on the connection. This attack can be countered by
      using TCP Authentication Option (TCP-AO) <xref target="RFC5925" format="default"/>. Although not widely
      adopted, if TCP-AO is used, then any bogus packets injected by an
      attacker will be rejected by the TCP-AO integrity check and therefore
      will never reach the TLS layer.</t>
      <t>
   If the 'cuid' is guessable, a misbehaving DOTS client from within 
   the client's domain can use the 'cuid' of another DOTS client of 
   the domain to delete or alter active mitigations. 
      For this attack vector to happen, the misbehaving client
      needs to pass the security validation checks by the DOTS server, and
      eventually the checks of a client-domain DOTS gateway.</t>
      <t>A similar attack can be achieved by a compromised DOTS client that
      can sniff the TLS 1.2 handshake, use the client certificate to identify
      the 'cuid' used by another DOTS client. This attack is not possible if
      algorithms such as version 4 Universally Unique IDentifiers (UUIDs) in
      <xref target="RFC4122" section="4.4" sectionFormat="of" format="default"/> are used to generate the
      'cuid' because such UUIDs are not a deterministic function of the client
      certificate. Likewise, this attack is not possible with TLS 1.3 because
      most of the TLS handshake is encrypted and the client certificate is not
      visible to eavesdroppers.</t>
      <t>A compromised DOTS client can collude with a DDoS attacker to send
      mitigation request for a target resource, get the mitigation efficacy
      from the DOTS server, and convey the mitigation efficacy to the DDoS
      attacker to possibly change the DDoS attack strategy. Obviously,
      signaling an attack by the compromised DOTS client to the DOTS server
      will trigger attack mitigation. This attack can be prevented by
      monitoring and auditing DOTS clients to detect misbehavior and to deter
      misuse, and by only authorizing the DOTS client to request mitigation
      for specific target resources (e.g., an application server is authorized
      to request mitigation for its IP addresses, but a DDoS mitigator can
      request mitigation for any target resource in the network). Furthermore,
      DOTS clients are typically co-located on network security services
      (e.g., firewall), and a compromised security service potentially can do a
      lot more damage to the network.</t>
      <t>Rate-limiting DOTS requests, including those with new 'cuid' values,
      from the same DOTS client defend against DoS attacks that would result
      in varying the 'cuid' to exhaust DOTS server resources. Rate-limit
      policies <bcp14>SHOULD</bcp14> be enforced on DOTS gateways (if deployed) and DOTS
      servers.</t>
      <t>In order to prevent leaking internal information outside a
      client's domain, DOTS gateways located in the client domain <bcp14>SHOULD NOT</bcp14>
      reveal the identification information that pertains to internal DOTS
      clients (e.g., source IP address, client's hostname) unless explicitly
      configured to do so.</t>
      <t>DOTS servers <bcp14>MUST</bcp14> verify that requesting DOTS clients are entitled to
      trigger actions on a given IP prefix. That is, only actions on IP
      resources that belong to the DOTS client's domain <bcp14>MUST</bcp14> be authorized by a
      DOTS server. The exact mechanism for the DOTS servers to validate that
      the target prefixes are within the scope of the DOTS client domain is
      deployment specific.</t>
      <t>The presence of DOTS gateways may lead to infinite forwarding loops,
      which is undesirable. To prevent and detect such loops, this document
      uses the Hop-Limit option.</t>
      <t>When FQDNs are used as targets, the DOTS server <bcp14>MUST</bcp14> rely upon DNS
      privacy-enabling protocols (e.g., DNS over TLS <xref target="RFC7858" format="default"/> or DNS over HTTPS (DoH) <xref target="RFC8484" format="default"/>) to
      prevent eavesdroppers from possibly identifying the target resources
      protected by the DDoS mitigation service to ensure the target
      FQDN resolution is authentic (e.g., DNSSEC <xref target="RFC4034" format="default"/>).</t>
      <t>CoAP-specific security considerations are discussed in 
      <xref target="RFC7252" section="11" sectionFormat="of" format="default"/>, while CBOR-related security
      considerations are discussed in <xref target="RFC7049" section="8" sectionFormat="of" format="default"/>.</t>
    </section>
  </middle>
  <back>
    <displayreference target="I-D.ietf-dots-multihoming" to="DOTS-MH"/>
    <displayreference target="I-D.ietf-core-yang-cbor" to="CORE-YANG-CBOR"/>
    <displayreference target="I-D.ietf-core-comi" to="COMI"/>
    <displayreference target="I-D.ietf-dots-use-cases" to="DOTS-USE-CASES"/>
    <displayreference target="I-D.ietf-dots-architecture" to="DOTS-ARCH"/>
    <displayreference target="I-D.ietf-tls-dtls13" to="DTLS"/>
    <displayreference target="I-D.ietf-dots-server-discovery" to="DOTS-SERVER-DISC"/>
    <displayreference target="I-D.boucadair-dots-earlydata" to="DOTS-EARLYDATA"/>
    <references>
      <name>References</name>
      <references>
        <name>Normative References</name>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7525.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6347.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7252.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7250.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7641.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8615.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4279.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5280.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6991.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5246.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6125.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3688.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7950.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8126.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6066.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8323.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8085.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7049.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8446.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7959.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4632.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7918.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7924.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4648.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3986.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8200.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1122.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8305.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.0791.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8768.xml"/>
      </references>
      <references>
        <name>Informative References</name>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4732.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7951.xml"/>
        <reference anchor="IANA-MediaTypes" target="http://www.iana.org/assignments/media-types">
          <front>
            <title>Media Types</title>
            <author>
              <organization>IANA</organization>
            </author>
          </front>
        </reference>
        <reference anchor="IANA-CoAP-Content-Formats" target="http://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats">
          <front>
            <title>CoAP Content-Formats</title>
            <author>
              <organization>IANA</organization>
            </author>
          </front>
        </reference>
        <reference anchor="IANA-CBOR-Tags" target="http://www.iana.org/assignments/cbor-tags/cbor-tags.xhtml">
          <front>
            <title>Concise Binary Object Representation (CBOR) Tags</title>
            <author>
              <organization>IANA</organization>
            </author>
          </front>
        </reference>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8499.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4034.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7858.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8484.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6234.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4122.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6052.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7030.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7452.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5925.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8489.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4987.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7413.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3022.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6146.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6296.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6724.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7589.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6888.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4787.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4340.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4960.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8340.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6838.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-dots-multihoming.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-core-yang-cbor.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-core-comi.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8612.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-dots-use-cases.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-dots-architecture.xml"/>
        <reference anchor="RFC8783" target="https://www.rfc-editor.org/info/rfc8783">
         <front>
          <title>Distributed Denial-of-Service Open Threat Signaling (DOTS) Data Channel Specification</title>
          <author initials="M" surname="Boucadair" fullname="Mohamed
							     Boucadair" role="editor">
           <organization/>
          </author>
          <author initials="T" surname="Reddy.K" fullname="Tirumaleswar
							   Reddy.K" role="editor">
           <organization/>
          </author>
          <date month="May" year="2020"/>
         </front>
        <seriesInfo name="RFC" value="8783"/>
        <seriesInfo name="DOI" value="10.17487/RFC8783"/>
        </reference>

        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-tls-dtls13.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-dots-server-discovery.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6887.xml"/>
        <reference anchor="I-D.boucadair-dots-earlydata">
          <front>
            <title>Using Early Data in DOTS</title>
            <author initials="M" surname="Boucadair" fullname="Mohamed Boucadair">
              <organization/>
            </author>
            <author initials="T" surname="Reddy.K" fullname="Tirumaleswar Reddy.K">
              <organization/>
            </author>
            <date month="January" day="29" year="2019"/>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-boucadair-dots-earlydata-00"/>
          <format type="TXT" target="http://www.ietf.org/internet-drafts/draft-boucadair-dots-earlydata-00.txt"/>
        </reference>
        <reference anchor="IANA-Proto" target="http://www.iana.org/assignments/protocol-numbers">
          <front>
            <title>Protocol Numbers</title>
            <author>
              <organization>IANA</organization>
            </author>
            <date year="2011"/>
          </front>
        </reference>
      </references>
    </references>
    <section anchor="motiv" numbered="true" toc="default">
      <name>CUID Generation</name>
      <t>The document recommends the use of SPKI to generate the 'cuid'. This
      design choice is motivated by the following reasons:</t>
      <ul spacing="normal">
        <li>SPKI is globally unique.</li>
        <li>It is deterministic.</li>
        <li>It allows the avoidance of extra cycles that may be induced by 'cuid'
          collision.</li>
        <li>DOTS clients do not need to store the 'cuid' in a persistent
          storage.</li>
        <li>It allows the detection of compromised DOTS clients that do not adhere
          to the 'cuid' generation algorithm.</li>
      </ul>
    </section>
    <section anchor="ack" numbered="false" toc="default">
      <name>Acknowledgements</name>
      <t>Thanks to <contact fullname="Christian Jacquenet"/>, <contact fullname="Roland Dobbins"/>, 
      <contact fullname="Roman Danyliw"/>, <contact fullname="Michael Richardson"/>, 
      <contact fullname="Ehud Doron"/>, <contact fullname="Kaname Nishizuka"/>, 
      <contact fullname="Dave Dolson"/>, <contact fullname="Liang Xia"/>,
      <contact fullname="Gilbert Clark"/>, <contact fullname="Xialiang Frank"/>, 
      <contact fullname="Jim Schaad"/>, <contact fullname="Klaus Hartke"/>, 
      <contact fullname="Nesredien Suleiman"/>, <contact fullname="Stephen Farrell"/>, and 
      <contact fullname="Yoshifumi Nishida"/> for the discussion and
      comments.</t>
      <t>The authors would like to give special thanks to <contact fullname="Kaname Nishizuka"/> and
      <contact fullname="Jon Shallow"/> for their efforts in implementing the protocol and
      performing interop testing at IETF Hackathons.</t>
      <t>Thanks to the core WG for the recommendations on Hop-Limit and
      redirect signaling.</t>
      <t>Special thanks to <contact fullname="Benjamin Kaduk"/> for the detailed AD review.</t>
      <t>Thanks to <contact fullname="Alexey Melnikov"/>, <contact fullname="Adam Roach"/>, 
      <contact fullname="Suresh Krishnan"/>, <contact fullname="Mirja Kühlewind"/>, and 
      <contact fullname="Alissa Cooper"/> for the review.</t>
      <t>Thanks to <contact fullname="Carsten Bormann"/> for his review of the DOTS heartbeat
      mechanism.</t>
    </section>
    <section anchor="contr" numbered="false" toc="default">
      <name>Contributors</name>


      <t>The following individuals have contributed to this
      document:</t>

      <contact fullname="Jon Shallow" >
        <organization>NCC Group</organization>
        <address>
          <postal>
            <street></street>
            <city></city>
            <region></region><code></code>
            <country></country>
          </postal>
          <email>jon.shallow@nccgroup.trust</email>
        </address>
      </contact>

            <contact fullname="Mike Geller" >
        <organization>Cisco Systems, Inc.</organization>
        <address>
          <postal>
            <street></street>
            <city></city>
            <region>FL</region><code>33309</code>
            <country>United States of America</country>
          </postal>
          <email>mgeller@cisco.com</email>
        </address>
      </contact>


            <contact fullname="Robert Moskowitz" >
        <organization>HTT Consulting</organization>
        <address>
          <postal>
            <street></street>
            <city>Oak Park</city>
            <region>MI</region><code>42837</code>
            <country>United States of America</country>
          </postal>
          <email>rgm@htt-consult.com</email>
        </address>
      </contact>


            <contact fullname="Dan Wing" >
        <organization></organization>
        <address>
          <postal>
            <street></street>
            <city></city>
            <region></region><code></code>
            <country></country>
          </postal>
          <email>dwing-ietf@fuggles.com</email>
        </address>
      </contact>

    </section>
  </back>
</rfc>
