<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc SYSTEM "rfc2629-xhtml.ent">
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" 
     docName="draft-ietf-anima-autonomic-control-plane-30" 
     number="8994" 
     ipr="trust200902" 
     obsoletes="" 
     updates="" 
     submissionType="IETF" 
     category="std" 
     consensus="true" 
     xml:lang="en" 
     tocInclude="true" 
     tocDepth="5" 
     symRefs="true" 
     sortRefs="true" 
     version="3">

  <front>
    <title abbrev="An Autonomic Control Plane (ACP)">An Autonomic Control Plane (ACP)</title>
    <seriesInfo name="RFC" value="8994"/>
    <author role="editor" fullname="Toerless Eckert" surname="Eckert">
      <organization abbrev="Futurewei USA">
                                Futurewei Technologies Inc. USA</organization>
      <address>
        <postal>
          <street>2330 Central Expy</street>
          <city>Santa Clara</city>
	  <region>CA</region>
          <code>95050</code>
          <country>United States of America</country>
        </postal>
        <email>tte+ietf@cs.fau.de</email>
      </address>
    </author>
    <author role="editor" fullname="Michael H. Behringer" initials="M." surname="Behringer">
      <address>
        <email>michael.h.behringer@gmail.com</email>
      </address>
    </author>
    <author fullname="Steinthor Bjarnason" initials="S." surname="Bjarnason">
      <organization>Arbor Networks</organization>
      <address>
        <postal>
          <street>2727 South State Street, Suite 200</street>
          <city>Ann Arbor</city>
	  <region>MI</region>
          <code>48104</code>
          <country>United States of America</country>
        </postal>
        <email>sbjarnason@arbor.net</email>
      </address>
    </author>
    <date month="May" year="2021"/>
    <area>Operations and Management</area>
    <workgroup>ANIMA</workgroup>

<keyword>addressing-scheme</keyword>
<keyword>ANI</keyword>
<keyword>autonomic networking</keyword>
<keyword>autonomous operation</keyword>
<keyword>BRSKI</keyword>
<keyword>certificate</keyword>
<keyword>Data-Plane</keyword>
<keyword>domain</keyword>
<keyword>DTLS</keyword>
<keyword>DULL</keyword>
<keyword>EST</keyword>
<keyword>GRASP</keyword>
<keyword>IDevID</keyword>
<keyword>inband</keyword>
<keyword>IPsec</keyword>
<keyword>IPv6</keyword>
<keyword>LDevID</keyword>
<keyword>loopback-interface</keyword>
<keyword>NOC</keyword>
<keyword>OAM</keyword>
<keyword>out-of-band</keyword>
<keyword>registrar</keyword>
<keyword>renewal</keyword>
<keyword>RPL</keyword>
<keyword>secure</keyword>
<keyword>self-management</keyword>
<keyword>ULA</keyword>
<keyword>VPN</keyword>
<keyword>VRF</keyword>
<keyword></keyword>

    <abstract>
      <t>
                                Autonomic functions need a control plane to communicate, which depends on some addressing and routing.  This Autonomic Control Plane should ideally be self-managing and be as independent as possible of configuration.  This document defines such a plane and calls it the "Autonomic Control Plane", with the primary use as a control plane for autonomic functions.  It also serves as a "virtual out-of-band channel" for Operations, Administration, and Management (OAM) communications over a network that provides automatically configured, hop-by-hop authenticated and encrypted communications via automatically configured IPv6 even when the network is not configured or is misconfigured.
                        </t>
    </abstract>
  </front>
  <middle>
    <section anchor="intro" numbered="true" toc="default">
      <name>Introduction (Informative)</name>
      <t>Autonomic Networking is a concept of self-management: autonomic functions self-configure, and negotiate parameters and settings across the network. "<xref target="RFC7575" format="title"/>" <xref target="RFC7575" format="default"/> defines the fundamental ideas and design goals of Autonomic Networking.  A gap analysis of Autonomic Networking is given in "<xref target="RFC7576" format="title"/>" <xref target="RFC7576" format="default"/>.  The reference architecture for Autonomic Networking in the IETF is specified in the document "<xref target="RFC8993" format="title"/>" <xref target="RFC8993" format="default"/>.</t>
      <t>Autonomic functions need an autonomically built communications
      infrastructure.  This infrastructure needs to be secure, resilient, and
      reusable by all autonomic functions.  <xref target="RFC7575" sectionFormat="of" section="5"/> introduces that infrastructure and calls it the Autonomic Control Plane (ACP).  More descriptively, it could be called the "Autonomic communications infrastructure for OAM and control".  For naming consistency with that prior document, this document continues to use the name ACP.</t>
      <t>Today, the OAM and control plane of IP networks is what is typically called in-band management and/or signaling: its management and control protocol traffic depends on the routing and forwarding tables, security, policy, QoS, and potentially other configuration that first has to be established through the very same management and control protocols. Misconfigurations, including unexpected side effects or mutual  dependencies, can disrupt OAM and control operations and especially disrupt remote management access to the affected node itself and potentially disrupt access to a much larger number of nodes for which the affected node is on the network path.</t>

<t>For an example of in-band management failing in the face of operator-induced misconfiguration, see <xref target="FCC"/>, for example, Section III.B.15 on page 8:</t> 
<blockquote>...engineers almost immediately recognized that they had misdiagnosed the problem.  However, they were unable to resolve the issue by restoring the link because the network management tools required to do so remotely relied on the same paths they had just disabled.</blockquote>

<t>Traditionally, physically separate, so-called out-of-band (management) networks have been used to avoid these problems or at least to allow recovery from such problems. In the worst-case scenario, personnel are sent on site to access devices through out-of-band management ports (also called craft ports, serial consoles, or management Ethernet ports).  However, both options are expensive.</t>
      <t>In increasingly automated networks, both centralized management systems 
and distributed autonomic service agents in the network require a control plane that is independent of the configuration of the network they manage, to avoid impacting their own operations through the configuration actions they take.</t>

      <t>This document describes a modular design for a self-forming, self-managing, and self-protecting ACP,  which is a virtual out-of-band network designed to be as independent as possible of configuration, addressing, and routing to avoid the self-dependency problems of current IP  networks while still operating in-band on the same physical network that it is controlling and managing. The ACP design is therefore intended to combine as well as possible the resilience of out-of-band management networks with the low cost of traditional IP in-band network management.  The details of how this is achieved are described in <xref target="self-creation" format="default"/>.</t>
      <t>In a fully Autonomic Network without legacy control or management functions and/or protocols, the data plane would be just a forwarding plane for "data" IPv6 packets, which are packets other than those control and  management plane packets forwarded by the ACP itself.  In such a network, there would be no non-autonomous control of nodes nor a non-autonomous management plane.</t>
      <t>Routing protocols would be built inside the ACP as autonomous functions via autonomous service agents, leveraging the following ACP functions instead of implementing them separately for each protocol: discovery; automatically established, authenticated, and encrypted local and distant peer connectivity for control and management traffic; and common session and presentation functions of the control and management protocol.</t>
      <t>When ACP functionality is added to nodes that do not have autonomous management plane and/or control plane functions (henceforth called non-autonomous nodes), the ACP instead is best abstracted as a special Virtual Routing and Forwarding (VRF) instance (or virtual router), and the complete, preexisting, non-autonomous management and/or control plane is considered to be part of the data plane to avoid introducing more complex terminology only for this case.</t>
      <t>Like the forwarding plane for "data" packets, the non-autonomous control and management plane functions can then be managed and/or used via the ACP. This terminology is consistent with preexisting documents such as "<xref target="RFC8368" format="title"/>" <xref target="RFC8368" format="default"/>.</t>
      <t>In both autonomous and non-autonomous instances, the ACP is built such that it operates in the absence of the data plane.
The ACP also operates in the presence of any (mis)configured non-autonomous management and/or control components in the data plane.</t>
      <t>The ACP serves several purposes simultaneously:
                        </t>
			<ol type="1" spacing="normal">
        <li>Autonomic functions communicate over the ACP.  The ACP therefore directly supports Autonomic Networking functions, as described in <xref target="RFC8993" format="default"/>.  For example, GRASP ("<xref target="RFC8990" format="title"/>" <xref target="RFC8990" format="default"/>) runs securely inside the ACP and depends on the ACP as its "security and transport substrate".</li>
        <li>A controller or network management system can use ACP to securely bootstrap network devices in remote locations, even if the (data plane) network in between is not yet configured; no bootstrap configuration that is dependent on the data plane is required.  An example of such a secure bootstrap process is described in "<xref target="RFC8995" format="title"/>" <xref target="RFC8995" format="default"/>.</li>
        <li>An operator can use ACP to access remote devices using protocols such as Secure SHell (SSH) or Network Configuration Protocol (NETCONF), even if the network is misconfigured or unconfigured.</li>
      </ol>
      <t>This document describes these purposes as use cases for the ACP in <xref target="usage" format="default"/>, and it defines the requirements in <xref target="requirements" format="default"/>. <xref target="overview" format="default"/> gives an overview of how the ACP is constructed.</t>
      <t>The normative part of this document starts with <xref target="self-creation" format="default"/>, where the ACP is specified. <xref target="acp-l2-switches" format="default"/> explains how to support ACP on Layer 2 (L2) switches (normative). <xref target="workarounds" format="default"/> explains how non-ACP nodes and networks can be integrated (normative).</t>
      <t>The remaining sections are non-normative. <xref target="benefit" format="default"/> reviews the benefits of the ACP (after all the details have been defined). <xref target="operational" format="default"/> provides operational recommendations. <xref target="further" format="default"/> 
   provides additional background and describes possible 
   extensions that were not applicable for this specification but were 
   considered important to document.  
There are no dependencies on <xref target="further" format="default"/> in order to build a complete working and interoperable
ACP according to this document.</t>
      <t>The ACP provides secure IPv6 connectivity; therefore, it can be used for secure connectivity not only for self-management as required for the ACP in <xref target="RFC7575" format="default"/> but also for traditional (centralized) management. The ACP can be implemented and operated without any other components of Autonomic Networks, except for GRASP. ACP relies on per-link Discovery Unsolicited Link-Local (DULL) GRASP (see <xref target="discovery-grasp" format="default"/>) to auto-discover ACP neighbors and includes the ACP GRASP instance to provide service discovery for clients of the ACP (see <xref target="GRASP" format="default"/>), including for its own maintenance of ACP certificates.</t>
      <t>The document <xref target="RFC8368" format="default"/> describes how the ACP can be used alone to provide secure and stable connectivity for autonomic and non-autonomic OAM applications, specifically for the case of current non-autonomic networks and/or nodes. That document also explains how existing management solutions can leverage the ACP in parallel with traditional management models, when to use the ACP, and how to integrate with potentially IPv4-only OAM backends.</t>
      <t>Combining ACP with Bootstrapping Remote Secure Key Infrastructure (BRSKI) (see <xref target="RFC8995" format="default"/>) results in the "Autonomic Network Infrastructure" (ANI) as defined in <xref target="RFC8993" format="default"/>, which provides autonomic connectivity (from ACP) with secure zero-touch (automated) bootstrap from BRSKI.  The ANI itself does not constitute an Autonomic Network, but it allows the building of more or less Autonomic Networks on top of it, using either centralized automation in SDN style (see "<xref target="RFC7426" format="title"/>" <xref target="RFC7426" format="default"/>) or distributed automation via Autonomic Service Agents (ASA) and/or Autonomic Functions (AF), or a mixture of both.  See <xref target="RFC8993" format="default"/> for more information.</t>
      <section anchor="applicability" numbered="true" toc="default">
        <name>Applicability and Scope</name>
        <t>Please see the following Terminology section (<xref target="terminology" format="default"/>) for explanations of terms used in this section.</t>
        <t>The design of the ACP as defined in this document is considered to
	be applicable to all types of "professionally managed" networks:
	Service Provider, Local Area Network (LAN), Metropolitan Area Network (MAN/Metro),
	Wide Area Network (WAN), Enterprise Information Technology (IT) and
	<xref target="ot" format="none">Operational Technology</xref> (OT) networks. The ACP can operate equally on Layer 3 (L3) equipment and on L2 equipment such as bridges (see <xref target="acp-l2-switches" format="default"/>). The hop-by-hop authentication, integrity protection, and confidentiality mechanism used by the ACP is defined to be negotiable; therefore, it can be extended  to environments with different protocol preferences. The minimum implementation requirements in this document attempt to achieve maximum interoperability by requiring support for multiple options depending on the type of device: IPsec (see "<xref target="RFC4301" format="title"/>" <xref target="RFC4301" format="default"/>) and Datagram Transport Layer Security (DTLS, see <xref target="DTLS" format="default"/>).</t>
        <t>The implementation footprint of the ACP consists of Public Key Infrastructure (PKI) code for the ACP certificate including EST (see "<xref target="RFC7030" format="title"/>" <xref target="RFC7030" format="default"/>), GRASP, UDP, TCP, and Transport Layer Security (TLS, see <xref target="tls" format="default"/>). For more information regarding the security and reliability of GRASP and for EST, the ACP secure channel protocol used (such as IPsec or DTLS), and an instance of IPv6 packet forwarding and routing via RPL, see "<xref target="RFC6550" format="title"/>" <xref target="RFC6550" format="default"/>, which is separate from routing and forwarding for the data plane (user traffic).</t>
        <t>The ACP uses only IPv6 to avoid the complexity of dual-stack (both IPv6 and IPv4) ACP operations. Nevertheless, it can be integrated without any changes to otherwise IPv4-only network devices. The data plane itself would not need to change, and it could continue to be IPv4 only. For such IPv4-only devices, IPv6 itself would be additional implementation footprint that is only required for the ACP.</t>
        <t>The protocol choices of the ACP are primarily based on wide use and support in networks and devices, well-understood security properties, and required scalability. The ACP design is an attempt to produce the lowest risk combination of existing technologies and protocols to build a widely applicable, operational network management solution.</t>
        <t>RPL was chosen because it requires a smaller routing table footprint in large networks compared to other routing protocols with an autonomically configured single area. The deployment experience of large-scale Internet of Things (IoT) networks serves as the basis for wide deployment experience with RPL. The profile chosen for RPL in the ACP does not leverage any RPL-specific forwarding plane features (IPv6 extension headers), making its implementation a pure control plane software requirement.</t>
        <t>GRASP is the only completely novel protocol used in the ACP, and this choice was necessary because there is no existing protocol suitable for providing the necessary functions to the ACP, so GRASP was developed to fill that gap.</t>
        <t>The ACP design can be applicable to devices constrained with respect to CPU and memory, and to networks constrained with respect to bitrate and reliability,
but this document does not attempt to define the most constrained type of devices or networks to which the ACP is applicable. RPL and DTLS for ACP secure channels are two protocol choices already making ACP more applicable to constrained environments. Support for constrained devices in this specification is opportunistic, but not complete, because the reliable transport for GRASP (see <xref target="GRASP-substrate" format="default"/>) only specifies TCP/TLS.  See <xref target="reuse-acp" format="default"/> for discussions about how future standards or proprietary extensions and/or variations of the ACP could better meet expectations that are different from those upon which the current design is based, including supporting constrained devices better.</t>
      </section>
    </section>
    <section anchor="terminology" numbered="true" toc="default">
      <name>Acronyms and Terminology (Informative)</name>

      <t>This document serves both as a normative specification for ACP
        node behavior as well as an explanation of the context by providing descriptions of requirements, benefits,
        architecture, and operational aspects. 
        Normative sections are labeled "(Normative)" and use BCP 14 keywords. 
        Other sections are labeled "(Informative)" and do not use those normative
        keywords.</t>
      <t>In the rest of the document, we will refer to systems that use the ACP as "nodes".  Typically, such a node is a physical (network equipment) device, but it can equally be some virtualized system.  Therefore, we do not refer to them as devices unless the context specifically calls for a physical system.</t>
      <t>This document introduces or uses the following terms (sorted alphabetically).  Introduced terms are
        explained on first use, so this list is for reference only.</t>
      <dl spacing="normal" newline="false">
        <dt>ACP:</dt>
        <dd>Autonomic Control Plane.  The <xref target="af-def" format="none">autonomic function</xref> as defined in this document.
            It provides secure, zero-touch (automated) transitive (network-wide) IPv6 connectivity for all nodes in the same ACP domain as well as a GRASP instance running across this ACP IPv6 connectivity.
            The ACP is primarily meant to be used as a component of the <xref target="ani-def" format="none">ANI</xref> to enable <xref target="an-def" format="none">Autonomic Networks</xref>,
            but it can equally be used in simple ANI networks (with no other autonomic functions) or
            completely by itself.
            </dd>
        <dt>ACP address:</dt>
        <dd>An IPv6 address assigned to the ACP node.  It is stored
            in the <xref target="acp-node-name-def" format="none">acp-node-name</xref> of the <xref target="domcert-def" format="none">ACP certificate</xref>.
            </dd>
        <dt>ACP address range or set:</dt>
        <dd>The ACP address may imply a range or set of addresses that the node can assign for different purposes.  This address range or set is derived by the node from the format of the ACP address called the addressing sub-scheme.
            </dd>
        <dt anchor="domcert-def">ACP certificate:</dt>
        <dd>A Local Device IDentity (<xref target="ldevid" format="none">LDevID</xref>) certificate conforming to "<xref target="RFC5280" format="title"/>" <xref target="RFC5280" format="default"/> that carries the <xref target="acp-node-name-def" format="none">acp-node-name</xref>, which is used by the ACP to learn its address in the ACP and to derive and cryptographically assert its membership in the ACP domain.  In the context of the ANI, the ACP certificate is also called the ANI certificate.
In the context of AN, the ACP certificate is also called the AN certificate. </dd>
        <dt>ACP connect interface:</dt>
        <dd>An interface on an ACP node that provides access to the ACP for non-ACP-capable nodes without using an ACP secure channel.  See <xref target="NMS" format="default"/>.
            </dd>
        <dt>ACP domain:</dt>
        <dd>The ACP domain is the set of nodes with <xref target="domcert-def" format="none">ACP certificates</xref> that allow them to authenticate each other as members of the ACP domain.  See also <xref target="certcheck" format="default"/>.</dd>
        <dt anchor="acp-loopback-def">ACP loopback interface:</dt>
        <dd>The loopback interface in the ACP <xref target="vrf-def" format="none">VRF</xref> that has the ACP address assigned to it. See <xref target="ACP-loopback" format="default"/>.
            </dd>
        <dt>ACP network:</dt>
        <dd>The ACP network comprises all the nodes that have access to the ACP.
            It is the set of active and transitively connected nodes of an ACP domain plus all nodes that get access to 
            the ACP of that domain via ACP edge nodes.
            </dd>
        <dt>ACP (ULA) prefix(es):</dt>
        <dd>The /48 IPv6 address prefixes used across the ACP.  In the normal or simple case, the ACP has one <xref target="ula-def" format="none">Unique Local Address (ULA)</xref> prefix, see <xref target="addressing" format="default"/>.  The ACP routing table may include multiple ULA prefixes if the rsub option is used to create addresses from more than one ULA prefix.  See <xref target="domcert-acpinfo" format="default"/>.  The ACP may also include non-ULA prefixes if those are configured on ACP connect interfaces.  See <xref target="NMS" format="default"/>.
            </dd>
        <dt>ACP secure channel:</dt>
        <dd>A channel authenticated via <xref target="domcert-def" format="none">ACP certificates</xref> providing integrity protection and confidentiality through encryption. These channels are established between (normally) adjacent ACP nodes to carry ACP <xref target="vrf-def" format="none">VRF</xref> traffic in-band over the same links and paths as data plane traffic but isolate it from the data plane traffic and secure it.
            </dd>
        <dt>ACP secure channel protocol:</dt>
        <dd>The protocol used to build an ACP secure channel,
            e.g., Internet Key Exchange Protocol version 2 (IKEv2) with IPsec or DTLS.
            </dd>
        <dt>ACP virtual interface:</dt>
        <dd>An interface in the ACP <xref target="vrf-def" format="none">VRF</xref> mapped to one or more
            ACP secure channels.  See <xref target="ACP_interfaces" format="default"/>.
            </dd>
        <dt anchor="acp-node-name-def">acp-node-name field:</dt>
        <dd>An information field in the <xref target="domcert-def" format="none">ACP certificate</xref> in which the following ACP-relevant information is encoded: the ACP domain name, the ACP IPv6 address of the node, and optional additional role attributes about the node.  </dd>
        <dt anchor="an-def">AN:</dt>
        <dd>Autonomic Network. A network according to <xref target="RFC8993" format="default"/>.
            Its main components are <xref target="ani-def" format="none">ANI</xref>, <xref target="af-def" format="none">autonomic functions</xref>, and <xref target="intent-def" format="none">Intent</xref>.
            </dd>
        <dt>(AN) Domain Name:</dt>
        <dd>An FQDN (Fully Qualified Domain Name) in the acp-node-name of the domain certificate.  See <xref target="domcert-acpinfo" format="default"/>.
            </dd>
        <dt anchor="ani-def">ANI (nodes/network):</dt>
        <dd>Autonomic Network Infrastructure. 
            The ANI is the infrastructure to enable <xref target="an-def" format="none">Autonomic Networks</xref>.  It includes ACP, BRSKI, and GRASP. 
            Every Autonomic Network includes the ANI, but not every ANI network needs to include <xref target="af-def" format="none">autonomic functions</xref> beyond the ANI (nor <xref target="intent-def" format="none">Intent</xref>).  An ANI network without further autonomic functions can, for example, support secure zero-touch (automated) bootstrap
            and stable connectivity for SDN networks, see <xref target="RFC8368" format="default"/>.
            </dd>
        <dt>ANIMA:</dt>
        <dd>Autonomic Networking Integrated Model and Approach.
            ACP, BRSKI, and GRASP are specifications of the IETF ANIMA Working Group.
            </dd>
        <dt>ASA:</dt>
        <dd>Autonomic Service Agent.  Autonomic software modules running on
            an <xref target="ani-def" format="none">ANI</xref> device.  The components making up the ANI (BRSKI, ACP, and GRASP) are also described as ASAs.
            </dd>
        <dt anchor="af-def">autonomic function:</dt>
        <dd>A function and/or service in an Autonomic Network (AN)
            composed of one or more ASAs across one or more ANI nodes.
            </dd>
        <dt>BRSKI:</dt>
        <dd>Bootstrapping Remote Secure Key Infrastructure
            <xref target="RFC8995" format="default"/>.  A protocol extending <xref target="est-def" format="none">EST</xref> to
            enable secure zero-touch bootstrap in conjunction with ACP.  ANI nodes use ACP, BRSKI, and GRASP.
            </dd>
        <dt anchor="ca-def">CA:</dt>
        <dd>Certification Authority. An entity that issues digital certificates. A CA uses its private key to sign the certificates it issues. Relying parties use the public key in the CA certificate to validate the signature.</dd>
        <dt>CRL:</dt>
        <dd>Certificate Revocation List. A list of revoked certificates is required to revoke certificates before their lifetime expires.
            </dd>
        <dt>data plane:</dt>
        <dd>The counterpoint to the ACP <xref target="vrf-def" format="none">VRF</xref> in an ACP node: the forwarding of user traffic 
            in non-autonomous nodes and/or networks and also any non-autonomous control and/or management plane functions.
            In a fully <xref target="an-def" format="none">Autonomic Network</xref> node, the data plane is managed autonomically via <xref target="af-def" format="none">autonomic
            functions</xref> and <xref target="intent-def" format="none">Intent</xref>. See <xref target="intro" format="default"/> for more details.
            </dd>
        <dt>device:</dt>
        <dd>A physical system or physical node.</dd>
        <dt anchor="enrollment-def">enrollment:</dt>
        <dd>The process by which a node authenticates itself to a
            network with an initial identity, which is often called an <xref target="idevid-def" format="none">Initial Device IDentity (IDevID)</xref> certificate, and acquires from the network
            a network-specific identity, which is often called an <xref target="ldevid" format="none">LDevID</xref> certificate, and certificates of one or more <xref target="ta-def" format="none">trust anchor(s)</xref>.
            In the ACP, the LDevID certificate is called the <xref target="domcert-def" format="none">ACP certificate</xref>.
            </dd>
        <dt anchor="est-def">EST:</dt>
        <dd>Enrollment over Secure Transport <xref target="RFC7030" format="default"/>.  IETF
            Standards Track protocol for enrollment of a node with an <xref target="ldevid" format="none">LDevID</xref> certificate.  BRSKI is based on EST.
            </dd>
        <dt>GRASP:</dt>
        <dd>GeneRic Autonomic Signaling Protocol.  An extensible signaling
            protocol required by the ACP for ACP neighbor discovery.</dd>
        <dt/>
        <dd>The ACP also provides the
            "security and transport substrate" for the "ACP instance of GRASP". This instance 
            of GRASP runs across the ACP secure channels to support BRSKI and other NOC and/or OAM or
            <xref target="af-def" format="none">autonomic functions</xref>.  See <xref target="RFC8990" format="default"/>.
            </dd>
        <dt anchor="idevid-def">IDevID:</dt>
        <dd>An Initial Device IDentity X.509 certificate installed by
            the vendor on new equipment.  The IDevID certificate contains information that establishes the identity of the
            node in the context of its vendor and/or manufacturer such as device model and/or type
            and serial number.  See <xref target="AR8021" format="default"/>. The IDevID certificate cannot be used as a node identifier for the
            ACP because they are not provisioned by the owner of the network, so they can
            not directly indicate an ACP domain they belong to.
            </dd>
        <dt anchor="in-band-def">in-band (as in management or signaling):</dt>
        <dd>
            In-band management traffic and/or control plane signaling uses the same network
            resources such as routers and/or switches and network links that it manages and/or controls.
            In-band is the standard management and signaling mechanism in IP networks.
            Compared to <xref target="out-of-band-def" format="none">out-of-band</xref>, the in-band mechanism
            requires no additional physical resources, but it introduces potentially circular
            dependencies for its correct operations.
            See <xref target="intro" format="default"/>.
            </dd>
        <dt anchor="intent-def">Intent:</dt>
        <dd>The policy language of an Autonomic Network according to <xref target="RFC8993" format="default"/>.
            </dd>
        <dt>Loopback interface:</dt>
        <dd>See 
            <xref target="acp-loopback-def" format="none">ACP loopback interface</xref>.
            </dd>
        <dt anchor="ldevid">LDevID:</dt>
        <dd>A Local Device IDentity is an X.509 certificate installed during
            <xref target="enrollment-def" format="none">enrollment</xref>.  The <xref target="domcert-def" format="none">domain certificate</xref> used by the ACP is an LDevID certificate.  See <xref target="AR8021" format="default"/>.
            </dd>
        <dt>management:</dt>
        <dd>Used in this document as another word for <xref target="OAM" format="none">OAM</xref>.
            </dd>
        <dt>MASA (service):</dt>
        <dd>Manufacturer Authorized Signing Authority.  A vendor and/or manufacturer
            or delegated cloud service on the Internet used as part of the BRSKI protocol.
            </dd>
        <dt>MIC:</dt>
        <dd>Manufacturer Installed Certificate.  A synonym for an <xref target="idevid-def" format="none">IDevID</xref> in referenced materials. This term is not used in this document.
            </dd>
        <dt>native interface:</dt>
        <dd>Interfaces existing on a node without configuration of the already running node.  On physical nodes, these are usually physical interfaces; on virtual nodes, their equivalent.
            </dd>
        <dt>NOC:</dt>
        <dd>Network Operations Center.
            </dd>
        <dt>node:</dt>
        <dd>A system supporting the ACP according to this document.  A node can be virtual or physical.  Physical nodes are called devices.
            </dd>
        <dt anchor="node-id">Node-ID:</dt>
        <dd>
            The identifier of an ACP node inside that ACP. It is either the last 64 bits (see <xref target="zone-scheme" format="default"/>) or 78 bits (see <xref target="Vlong" format="default"/>) of the ACP address.
            </dd>
        <dt anchor="OAM">OAM:</dt>
        <dd>Operations, Administration, and Management. Includes network monitoring.
            </dd>
        <dt anchor="ot">Operational Technology (OT):</dt>
        <dd>
             "The hardware and software dedicated to detecting or causing changes
              in physical processes through direct monitoring and/or control of physical
              devices such as valves, pumps, etc." <xref target="OP-TECH"/>. In most cases today, OT networks are 
              well separated from Information Technology (IT) networks.
             </dd>
        <dt anchor="out-of-band-def">out-of-band (management) network:</dt>
        <dd>
             An out-of-band network is a secondary network
             used to manage a primary network. The equipment of the primary network is connected to
             the out-of-band network via dedicated management ports on the primary network equipment.
             Serial (console) management ports were historically most common; however, higher-end network equipment
             now also has Ethernet ports dedicated only to management. An out-of-band network provides
             management access to the primary network independent of the configuration state of the primary
             network.  See <xref target="intro" format="default"/>.</dd>
        <dt anchor="virtual-out-of-band-def">out-of-band network, virtual:</dt>
        <dd>
             The ACP can be called a virtual out-of-band network for management and control
             because it attempts to provide the benefits of a (physical)
             <xref target="out-of-band-def" format="none">out-of-band network</xref>
             even though it is physically carried <xref target="in-band-def" format="none">in-band</xref>.
             See <xref target="intro" format="default"/>.
            </dd>
        <dt>root CA:</dt>
        <dd>root Certification Authority. A <xref target="ca-def" format="none">CA</xref> for which the root CA key update
	procedures of <xref target="RFC7030" sectionFormat="comma" section="4.4"/>, can be applied.
            </dd>
        <dt>RPL:</dt>
        <dd>IPv6 Routing Protocol for Low-Power and Lossy Networks.  The routing protocol used in the ACP. See <xref target="RFC6550" format="default"/>.
            </dd>
        <dt>registrar (ACP, ANI/BRSKI):</dt>
        <dd>
            An ACP registrar is an entity (software and/or person) that orchestrates
            the <xref target="enrollment-def" format="none">enrollment</xref> of ACP nodes with the <xref target="domcert-def" format="none">ACP certificate</xref>. ANI nodes use
            BRSKI, so ANI registrars are also called BRSKI registrars. For non-ANI ACP nodes,
            the registrar mechanisms are not defined in this document. See <xref target="acp-registrars" format="default"/>. 
            Renewal and other maintenance (such as revocation) of ACP certificates
            may be performed by entities other than registrars. EST must be supported for
            ACP certificate renewal (see <xref target="domcert-maint" format="default"/>). BRSKI
            is an extension of EST, so ANI/BRSKI registrars can easily support ACP domain
            certificate renewal in addition to initial enrollment.
            </dd>
        <dt>RPI:</dt>
        <dd>RPL Packet Information. Network extension headers for use with  
            <xref target="rpl-def" format="none">RPL</xref>.
            Not used with RPL in the ACP. See <xref target="rpl-Data-Plane" format="default"/>.
            </dd>
        <dt anchor="rpl-def">RPL:</dt>
        <dd>Routing Protocol for Low-Power and Lossy Networks. The routing protocol used in the ACP.  See <xref target="routing" format="default"/>.
            </dd>
        <dt anchor="sudi">sUDI:</dt>
        <dd>secured Unique Device Identifier.  This is a synonym of IDevID in referenced material.  This term is not used in this document.
            </dd>
        <dt anchor="ta-def">TA:</dt>
        <dd>Trust Anchor. A TA is an entity that
	is trusted for the purpose of certificate validation. TA 
	information such as self-signed certificate(s) of the TA is
	configured into the ACP node as part of <xref target="enrollment-def" format="none">enrollment</xref>. See <xref target="RFC5280" sectionFormat="comma" section="6.1.1"/>.
            </dd>
        <dt>UDI:</dt>
        <dd>Unique Device Identifier.  In the context of this document, unsecured
            identity information of a node typically consists of at least a device model and/or type and a
            serial number, often in a vendor-specific format.  See <xref target="sudi" format="none">sUDI</xref> and <xref target="ldevid" format="none">LDevID</xref>.
            </dd>
        <dt anchor="ula-def">ULA (Global ID prefix):</dt>
        <dd>
            A Unique Local Address is an IPv6
            address in the block fc00::/7, defined in "<xref target="RFC4193" format="title"/>" <xref target="RFC4193" format="default"/>.  ULA is the
            IPv6 successor of the IPv4 private address space ("<xref target="RFC1918" format="title"/>" <xref target="RFC1918" format="default"/>).
            ULAs have important differences over IPv4 private addresses that
            are beneficial for and exploited by the ACP, such as the locally
            assigned Global ID prefix, which is the first 48 bits of a ULA
            address <xref target="RFC4193" sectionFormat="comma" section="3.2.1"/>.
            In this document, this prefix is abbreviated as "ULA prefix".                  
            </dd>
        <dt anchor="vrf-def">(ACP) VRF:</dt>
        <dd>The ACP is modeled in this document as a Virtual Routing and Forwarding instance. This means that it is based on a "virtual router" consisting of a separate IPv6 forwarding table to which the ACP virtual interfaces are attached and an associated IPv6 routing table separate from the data plane. Unlike the VRFs on MPLS/VPN Provider Edge ("<xref target="RFC4364" format="title"/>" <xref target="RFC4364" format="default"/>) or LISP xTR ("<xref target="RFC6830" format="title"/>" <xref target="RFC6830" format="default"/>), the ACP VRF does not have any special "core facing" functionality or routing and/or mapping protocols shared across multiple VRFs. In vendor products, a VRF such as the ACP VRF may also be referred to as a VRF-lite.
            </dd>
        <dt>(ACP) Zone:</dt>
        <dd>An ACP zone is a set of ACP nodes using the same zone field value in their ACP address according to <xref target="zone-scheme" format="default"/>. Zones are a mechanism to support structured addressing of ACP addresses within the same /48 ULA prefix. 
            </dd>
      </dl>
        <t>
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL
    NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP&nbsp;14 <xref target="RFC2119"/> <xref target="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
    </section>
    <section anchor="usage" numbered="true" toc="default">
      <name>Use Cases for an Autonomic Control Plane (Informative)</name>
      <t>This section summarizes the use cases that are intended to be supported by an ACP. To understand how these are derived from and relate to the larger set of use cases for Autonomic Networks, please refer to "<xref target="RFC8316" format="title"/>" <xref target="RFC8316" format="default"/>.</t>
      <section anchor="infrastructure" numbered="true" toc="default">
        <name>An Infrastructure for Autonomic Functions</name>
        <t>Autonomic functions need a stable infrastructure to run on, and all autonomic functions should use the same infrastructure to minimize the complexity of the network.  In this way, there is only need for a single discovery mechanism, a single security mechanism, and single instances of other processes that distributed functions require.</t>
      </section>
      <section anchor="secure-bootstrap" numbered="true" toc="default">
        <name>Secure Bootstrap over an Unconfigured Network</name>
        <t>Today, bootstrapping a new node typically requires all nodes between a controlling node such as an SDN controller (see <xref target="RFC7426" format="default"/>) and the new node to be completely and correctly addressed, configured, and secured.  Bootstrapping and configuration of a network happens in rings around the controller -- configuring each ring of devices before the next one can be bootstrapped.  Without console access (for example, through an out-of-band network), it is not possible today to make devices securely reachable before having configured the entire network leading up to them.</t>
        <t>With the ACP, secure bootstrap of new devices and whole new networks can happen without requiring any configuration of unconfigured devices along the path. As long as all devices along the path support ACP and a zero-touch bootstrap mechanism such as BRSKI, the ACP across a whole network of unconfigured devices can be brought up without operator and/or provisioning intervention. The ACP also offers additional security for any bootstrap mechanism because it can provide the encrypted discovery (via ACP GRASP) of registrars or other bootstrap servers by bootstrap proxies connecting to nodes that are to be bootstrapped. The ACP encryption hides the identities of the communicating entities (pledge and registrar), making it more difficult to learn which network node might be attackable. The ACP certificate can also be used to end-to-end encrypt the bootstrap communication between such proxies and server. Note that bootstrapping here includes not only the first step that can be provided by BRSKI (secure keys), but also later stages where configuration is bootstrapped.</t>
      </section>
      <section anchor="reachability" numbered="true" toc="default">
        <name>Permanent Reachability Independent of the Data Plane</name>
        <t>Today, most critical control plane protocols and OAM protocols use the data plane of the network.  This leads to often undesirable dependencies between the control and OAM plane on one side and the data plane on the other: only if the forwarding and control plane of the data plane are configured correctly, will the data plane and the OAM and/or control plane work as expected.</t>
        <t>Data plane connectivity can be affected by errors and faults. Examples include misconfigurations that make AAA (Authentication, Authorization, and Accounting) servers unreachable or that can lock an administrator out of a device; routing or addressing issues can make a device unreachable; and shutting down interfaces over which a current management session is running can lock an administrator irreversibly out of the device.  Traditionally only out-of-band access via a serial console or Ethernet management port can help recover from such issues.</t>
        <t>Data plane dependencies also affect applications in a NOC such as SDN controller applications: certain network changes are hard to implement today because the change itself may affect reachability of the devices.  Examples include address or mask changes, routing changes, or security policies.  Today such changes require precise, hop-by-hop planning.</t>
        <t>Note that specific control plane functions for the data plane often depend on the ability to forward their packets via the data plane: sending aliveness and routing protocol signaling packets across the data plane to verify reachability, using IPv4 signaling packets for IPv4 routing and IPv6 signaling packets for IPv6 routing.</t>
        <t>Assuming appropriate implementation (see <xref target="general_addressing" format="default"/> for more details), the ACP provides reachability that is independent of the data plane. This  allows the control plane and OAM plane to operate more robustly:
                                </t>
        <ul spacing="normal">
          <li>For management plane protocols, the ACP provides the functionality of a Virtual out-of-Band (VooB) channel, by providing connectivity to all nodes regardless of their data plane configuration, and routing and forwarding tables.</li>
          <li>For control plane protocols, the ACP allows their operation even when the data plane is temporarily faulty, or during transitional events, such as routing changes, which may affect the control plane at least temporarily.  This is specifically important for autonomic service agents, which could affect data plane connectivity.</li>
        </ul>
        <t>The document <xref target="RFC8368" format="default">"Using Autonomic Control Plane for Stable Connectivity of Network OAM"</xref> explains this use case for the ACP in significantly more detail and explains how the ACP can be used in practical network operations.</t>
      </section>
    </section>
    <section anchor="requirements" numbered="true" toc="default">
      <name>Requirements (Informative)</name>
      <t>The following requirements were identified for the design of the ACP based on the above use cases (<xref target="usage" format="default"/>). These requirements are informative. The ACP as specified in the normative parts of this document is meeting or exceeding these use case requirements:</t>
      <ol type="ACP%d:" spacing="normal" indent="10">
        <li anchor="acp1">The ACP should provide robust connectivity: as far as possible, it should be independent of configured addressing, configuration, and routing.  Requirements 2 and 3 build on this requirement, but they also have value on their own.</li>
        <li>The ACP must have a separate address space from the data plane.  This separate address space provides traceability, ease of debugging, separation from data plane, and infrastructure security (filtering based on known address space).</li>
        <li>The ACP must use an autonomically managed address space.  An autonomically managed address space provides ease of bootstrap and setup ("autonomic"), and robustness (the administrator cannot break network easily).  This document uses ULA for this purpose, see <xref target="RFC4193" format="default"/>.</li>
        <li anchor="acp4">The ACP must be generic, that is, it must be usable by all the functions and protocols of the ANI.  Clients of the ACP must not be tied to a particular application or transport protocol.</li>
        <li>The ACP must provide security: messages coming through the ACP must be authenticated to be from a trusted node, and it is very strongly recommended that they be encrypted.</li>
      </ol>
      <t>The explanation for <xref target="acp4" format="none">ACP4</xref> is as follows: in a fully Autonomic Network (AN), all newly written ASAs could potentially communicate with each other exclusively via GRASP, and if that were the only requirement for the ACP, it would not need to provide IPv6-layer connectivity between nodes, but only GRASP connectivity. Nevertheless, because ACP also intends to support non-autonomous networks, it is crucial to support IPv6-layer connectivity across the ACP to support any transport-layer and application-layer protocols.</t>
      <t>The ACP operates hop-by-hop because this interaction can be built on IPv6 link-local addressing, which is autonomic, and has no dependency on configuration (requirement <xref target="acp1" format="none">ACP1</xref>).  It may be necessary to have ACP connectivity across non-ACP nodes, for example, to link ACP nodes over the general Internet.  This is possible, but it introduces a dependency on stable and/or resilient routing over the non-ACP hops (see <xref target="remote-acp-neighbors" format="default"/>).</t>
    </section>
    <section anchor="overview" numbered="true" toc="default">
      <name>Overview (Informative)</name>
      <t>When a node has an ACP certificate (see <xref target="acp-certificates" format="default"/>) and is enabled to bring up the ACP (see <xref target="node-enable" format="default"/>), it will create its ACP without any configuration as follows. For details, see <xref target="self-creation" format="default"/> and following sections:
                        </t>
      <ol type="1" spacing="normal">
        <li>The node creates a VRF instance or a similar virtual context for the ACP.</li>
        <li>The node assigns its ULA IPv6 address (prefix) (see <xref target="addressing" format="default"/>), which is learned from the acp-node-name (see <xref target="domcert-acpinfo" format="default"/>) of its ACP certificate (see <xref target="acp-certificates" format="default"/>), to an ACP loopback interface (see <xref target="addressing" format="default"/>) and connects this interface to the ACP VRF.</li>
        <li>The node establishes a list of candidate peer adjacencies and candidate channel types to try for the adjacency. This is automatic for all candidate link-local adjacencies (see <xref target="discovery-grasp" format="default"/>) across all native interfaces (see <xref target="if-enable-auto" format="default"/>). If a candidate peer is discovered via multiple interfaces, this will result in one adjacency per interface. If the ACP node has multiple interfaces connecting to the same subnet across which it is also operating as an L2 switch in the data plane, it employs methods for ACP with L2 switching, see <xref target="acp-l2-switches" format="default"/>.</li>

        <li>For each entry in the candidate adjacency list, the node negotiates a secure tunnel using the candidate channel types.  See <xref target="channel-selection" format="default"/>.</li>

        <li>The node authenticates the peer node during secure channel setup and authorizes it to become part of the ACP according to <xref target="certcheck" format="default"/>.</li>

        <li>Unsuccessful authentication of a candidate peer results in throttled connection retries for as long as the candidate peer is discoverable. See <xref target="neighbor_verification" format="default"/>.</li>

        <li>Each successfully established secure channel is mapped to an ACP virtual interface, which is placed into the ACP VRF.  See <xref target="ACP-virtual-interfaces" format="default"/>.</li>

        <li>Each node runs a lightweight routing protocol (see <xref target="routing" format="default"/>) to announce reachability of the ACP loopback address (or prefix) across the ACP.</li>

        <li>This completes the creation of the ACP with hop-by-hop secure tunnels, auto-addressing, and auto-routing. The node is now an ACP node with a running ACP.</li>

      </ol>
      <t>Note:
                        </t>
      <ul spacing="normal">
        <li>None of the above operations (except the following explicitly configured ones) are reflected in the configuration of the node.</li>
        <li anchor="sec5bt2">Non-ACP network management systems (NMS) or SDN controllers have to be explicitly configured for connection to the ACP.</li>
        <li>Additional candidate peer adjacencies for ACP connections across non-ACP Layer 3 clouds requires explicit configuration. See <xref target="remote-acp-neighbors" format="default"/>.</li>
      </ul>
      <t><xref target="acp" format="default"/> illustrates the ACP.</t>

      <figure anchor="acp">
        <name>ACP VRF and Secure Channels</name>
        <artwork name="" type="" align="left" alt=""><![CDATA[
          ACP Node 1                          ACP Node 2
       ...................               ...................
secure .                 .   secure      .                 .  secure
channel:  +-----------+  :   channel     :  +-----------+  : channel
..--------| ACP VRF   |---------------------| ACP VRF   |---------..
       : / \         / \   <--routing-->   / \         / \ :
       : \ /         \ /                   \ /         \ / :
..--------| loopback  |---------------------| loopback  |---------..
       :  | interface |  :               :  | interface |  :
       :  +-----------+  :               :  +-----------+  :
       :                 :               :                 :
       :   Data Plane    :...............:   Data Plane    :
       :                 :    link       :                 :
       :.................:               :.................:
]]></artwork>
      </figure>
      <t>The resulting overlay network is normally based exclusively on hop-by-hop tunnels.  This is because addressing used on links is IPv6 link-local addressing, which does not require any prior setup.  In this way, the ACP can be built even if there is no configuration on the node, or if the data plane has issues such as addressing or routing problems.</t>
    </section>
    <section anchor="self-creation" numbered="true" toc="default">
      <name>Self-Creation of an Autonomic Control Plane (ACP) (Normative)</name>
      <t>This section specifies the components and steps to set up an ACP. The ACP is automatically self-creating, which makes it "indestructible" against most changes to the data plane, including misconfigurations of routing, addressing, NAT, firewall, or any other traffic policy filters that would inadvertently or otherwise unavoidably also impact the management plane traffic, such as the actual operator command-line interface (CLI) session or controller NETCONF session through which the configuration changes to the data plane are executed.</t>
      <t>Physical misconfiguration of wiring between ACP nodes will also not break the ACP. As long as there is a transitive physical path between ACP nodes, the ACP should be able to recover given that it automatically operates across all interfaces of the ACP nodes and automatically determines paths between them.</t>
      <t>Attacks against the network via incorrect routing or addressing information for the data plane will not impact the ACP. Even impaired ACP nodes will have a significantly reduced attack surface against malicious misconfiguration because only very limited ACP or interface up/down configuration can affect the ACP, and depending on their specific designs, these types of attacks could also be eliminated. See more in <xref target="enabling-acp" format="default"/> and <xref target="security" format="default"/>.</t>
      <t>An ACP node can be a router, switch, controller, NMS host, or any other IPv6-capable node.  Initially, it <bcp14>MUST</bcp14> have its ACP certificate, as well as an (empty) ACP adjacency table (described in <xref target="adj-table" format="default"/>).  It then can start to discover ACP neighbors and build the ACP.  This is described step by step in the following sections.</t>

      <section anchor="tls" numbered="true" toc="default">
        <name>Requirements for the Use of Transport Layer Security (TLS)</name>
          <t>The following requirements apply to TLS that is required or used by ACP components. Applicable ACP components include ACP certificate maintenance via EST (see <xref target="domcert-maint" format="default"/>), TLS connections for CRL Distribution Point (CRLDP) or Online Certificate Status Protocol (OCSP) responder (if used, see <xref target="certcheck" format="default"/>), and ACP GRASP (see <xref target="GRASP-substrate" format="default"/>). On ANI nodes, these requirements also apply to BRSKI.</t>

          <t>TLS <bcp14>MUST</bcp14> comply with "<xref target="RFC7525" format="title"/>" <xref target="RFC7525" format="default"/> except that TLS 1.2 ("<xref target="RFC5246" format="title"/>" <xref target="RFC5246" format="default"/>) is <bcp14>REQUIRED</bcp14> and that older versions of TLS <bcp14>MUST NOT</bcp14> be used.  TLS 1.3 ("<xref target="RFC8446" format="title"/>" <xref target="RFC8446" format="default"/>) <bcp14>SHOULD</bcp14> be supported. The choice for TLS 1.2 as the lowest common denominator for the ACP is based on the currently expected and most likely availability across the wide range of candidate ACP node types, potentially with non-agile operating system TCP/IP stacks.</t>

          <t>TLS <bcp14>MUST</bcp14> offer TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 and TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 and <bcp14>MUST NOT</bcp14> offer options with less than 256-bit symmetric key strength or hash strength of less than 384 bits.  When TLS 1.3 is  supported, TLS_AES_256_GCM_SHA384 <bcp14>MUST</bcp14> be offered and TLS_CHACHA20_POLY1305_SHA256 <bcp14>MAY</bcp14> be offered.</t>

          <t>TLS <bcp14>MUST</bcp14> also include the "Supported Elliptic Curves" extension, and it <bcp14>MUST</bcp14> support the NIST P-256 (secp256r1(22)) and P-384 (secp384r1(24)) curves "<xref target="RFC8422" format="title"/>" <xref target="RFC8422" format="default"/>.  In addition, TLS 1.2 clients <bcp14>SHOULD</bcp14> send an ec_point_format extension with a single element, "uncompressed".</t>

      </section>

      <section anchor="domcert" numbered="true" toc="default">
        <name>ACP Domain, Certificate, and Network</name>
        <t>The ACP relies on group security.  An ACP domain is a group of nodes that trust
each other to participate in ACP operations such as creating ACP secure channels
in an autonomous, peer-to-peer fashion between ACP domain members via protocols such as IPsec. 
To authenticate and authorize another ACP member node with access to the ACP domain, each ACP member requires
keying material: an ACP node <bcp14>MUST</bcp14> have an LDevID certificate
and information about one or more TAs
as required for the ACP domain membership check (<xref target="certcheck" format="default"/>).</t>
        <t>Manual keying via shared secrets is not usable for an ACP domain because it would require a single shared secret across all current and future ACP domain members to meet the expectation of autonomous, peer-to-peer establishment of ACP secure channels between any ACP domain members. Such a single shared secret would be an unacceptable security weakness. Asymmetric keying material (public keys) without certificates does not provide the mechanism to authenticate ACP domain membership in an autonomous, peer-to-peer fashion for current and future ACP domain members.</t>
        <t>The LDevID certificate is henceforth called the ACP certificate. The TA is the CA root certificate of the ACP domain.</t>
        <t>The ACP does not mandate specific mechanisms by which this keying material is provisioned into the ACP node. It only requires that the certificate comply with <xref target="acp-certificates" format="default"/>, specifically that it have the acp-node-name as specified in <xref target="domcert-acpinfo" format="default"/> in its domain certificate as well as those of candidate ACP peers.  See <xref target="bootstrap" format="default"/> for more information about enrollment or provisioning options.</t>

        <t>This document uses the term ACP in many places where the Autonomic Networking reference documents <xref target="RFC7575" format="default"/> and <xref target="RFC8993" format="default"/> use the word autonomic.  This is done because those reference documents consider (only) fully Autonomic Networks and nodes, but the support of ACP does not require the support for other components of Autonomic Networks except for the reliance on GRASP and the providing of security and transport for GRASP.  Therefore, the word autonomic might be misleading to operators interested in only the ACP.</t>
        <t><xref target="RFC7575" format="default"/> defines the term "autonomic domain" as a collection of autonomic nodes.  ACP nodes do not need to be fully autonomic, but when they are, then the ACP domain is an autonomic domain.  Likewise, <xref target="RFC8993" format="default"/> defines the term "domain certificate" as the certificate used in an autonomic domain.  The ACP certificate is that domain certificate when ACP nodes are (fully) autonomic nodes.  Finally, this document uses the term ACP network to refer to the network created by active ACP nodes in an ACP domain.  The ACP network itself can extend beyond ACP nodes through the mechanisms described in <xref target="ACPconnect" format="default"/>.</t>
        <section anchor="acp-certificates" numbered="true" toc="default">
          <name>ACP Certificates</name>
          <t>ACP certificates <bcp14>MUST</bcp14> be <xref target="RFC5280" format="default"/> compliant X.509 v3 <xref target="X.509" format="default"/> certificates.</t>
          <t>ACP nodes <bcp14>MUST</bcp14> support handling ACP certificates, TA certificates, and certificate chain certificates (henceforth just called certificates in this section) with RSA public keys and certificates with Elliptic Curve Cryptography (ECC) public keys.</t>

          <t>ACP nodes <bcp14>MUST NOT</bcp14> support certificates with RSA public keys of less than a 2048-bit modulus or curves with group order of less than 256 bits. They <bcp14>MUST</bcp14> support certificates with RSA public keys with 2048-bit modulus and <bcp14>MAY</bcp14> support longer RSA keys. They <bcp14>MUST</bcp14> support certificates with ECC public keys using NIST P-256 curves and <bcp14>SHOULD</bcp14> support P-384 and P-521 curves.</t>

          <t>ACP nodes <bcp14>MUST NOT</bcp14> support certificates with RSA public keys whose
          modulus is less than 2048 bits, or certificates whose ECC public keys
          are in groups whose order is less than 256 bits.  RSA signing
          certificates with 2048-bit public keys <bcp14>MUST</bcp14> be supported, and such
          certificates with longer public keys <bcp14>MAY</bcp14> be supported.  ECDSA
          certificates using the NIST P-256 curve <bcp14>MUST</bcp14> be supported, and such
          certificates using the P-384 and P-521 curves <bcp14>SHOULD</bcp14> be supported.</t>

          <t>ACP nodes <bcp14>MUST</bcp14> support RSA certificates that are signed by RSA
          signatures over the SHA-256 digest of the contents and <bcp14>SHOULD</bcp14>
          additionally support SHA-384 and SHA-512 digests in such signatures.
          The same requirements for digest usage in certificate signatures apply to Elliptic Curve Digital Signature Algorithm (ECDSA)
          certificates, and additionally, ACP nodes <bcp14>MUST</bcp14> support ECDSA
          signatures on ECDSA certificates.</t>

          <t>The ACP certificate <bcp14>SHOULD</bcp14> use an RSA key and an RSA signature when the ACP certificate is intended to be used not only for ACP authentication but also for other purposes. The ACP certificate <bcp14>MAY</bcp14> use an ECC key and an ECDSA signature if the ACP certificate is only used for ACP and ANI authentication and authorization.</t>

          <t>Any secure channel protocols used for the ACP as specified in this document or extensions of this document <bcp14>MUST</bcp14> therefore support authentication (e.g., signing), starting with these types of certificates. See <xref target="RFC8422" format="default"/> for more information.</t>

          <t>The reason for these choices are as follows: as of 2020, RSA is still more widely used than ECC, therefore the <bcp14>MUST</bcp14>-level requirements for RSA. ECC offers equivalent security at (logarithmically) shorter key lengths (see <xref target="RFC8422" format="default"/>). This can be beneficial especially in the presence of constrained bandwidth or constrained nodes in an ACP/ANI network. Some ACP functions such as GRASP peer-to-peer across the ACP require end-to-end/any-to-any authentication and authorization, therefore ECC can only reliably be used in the ACP when it <bcp14>MUST</bcp14> be supported on all ACP nodes. RSA signatures are mandatory to be supported also for ECC certificates because the CAs themselves may not support ECC yet.</t>

          <t>The ACP certificate <bcp14>SHOULD</bcp14> be used for any authentication between nodes with ACP
domain certificates (ACP nodes and NOC nodes) where a required authorization condition is ACP domain membership, such as ACP node to NOC/OAM end-to-end security and ASA to ASA end-to-end security.
<xref target="certcheck" format="default"/> defines this "ACP domain membership check".
The uses of this check that are standardized in this document are for the establishment of
hop-by-hop ACP secure channels (<xref target="associations" format="default"/>) and for ACP GRASP (<xref target="GRASP-substrate" format="default"/>) end to end via TLS.</t>

          <t>The ACP domain membership check requires a minimum number of elements in a certificate as described in <xref target="certcheck" format="default"/>. The identity of a node in the ACP is carried via the acp-node-name as defined in <xref target="domcert-acpinfo" format="default"/>.</t>

<t>To support Elliptic Curve Diffie-Hellman (ECDH) directly with the key in the ACP certificate,
ACP certificates with ECC keys need to indicate that they are ECDH 
capable: if the X.509 v3 keyUsage extension is present, the keyAgreement bit
must then be set. Note that this option is not required for any of the
required ciphersuites in this document and may not be supported by all CAs.</t>

          <t>Any other fields of the ACP certificate are to be populated as required by <xref target="RFC5280" format="default"/>. As long as they are compliant with <xref target="RFC5280" format="default"/>, any other field of an ACP certificate can be set as desired by the operator of the ACP domain through the appropriate ACP registrar and/or ACP CA procedures. For example, other fields may be required for purposes other than those that the ACP certificate is intended to be used for (such as elements of a SubjectName).</t>

          <t>For further certificate details, ACP certificates may follow the recommendations from <xref target="CABFORUM" format="default"/>.</t>

          <t>For diagnostic and other operational purposes, it is beneficial
	  to copy the device-identifying fields of the node's IDevID
	  certificate into the ACP certificate, such as the 
"serialNumber" attribute 
(<xref target="X.520" format="default"/>, Section 6.2.9) 
in the subject field distinguished name encoding. Note
	  that this is not the certificate serial-number.  See also <xref target="RFC8995" sectionFormat="comma" section="2.3.1"/>. This can be done, for example, if it would be acceptable for the device's "serialNumber" to be signaled via the Link Layer Discovery Protocol <xref target="LLDP" format="default"/> because, like LLDP-signaled information, the ACP certificate information can be retrieved by neighboring nodes without further authentication and can be used either for beneficial diagnostics or for malicious attacks. Retrieval of the ACP certificate is possible via a (failing) attempt to set up an ACP secure channel, and the "serialNumber" usually contains device type information that may help to more quickly determine working exploits/attacks against the device.</t>

          <t>Note that there is no intention to constrain authorization within the ACP or Autonomic Networks using the ACP to just the ACP domain membership check as defined in this document. It can be extended or modified with additional requirements. Such future authorizations can use and require additional elements in certificates or policies or even additional certificates. See <xref target="domcert-maint" format="default"/> for the additional check against the id-kp-cmcRA extended key usage attribute ("<xref target="RFC6402" format="title"/>" <xref target="RFC6402" format="default"/>), and  see <xref target="role-assignments" format="default"/> for possible future extensions.</t>

        </section>
        <section anchor="domcert-acpinfo" numbered="true" toc="default">
          <name>ACP Certificate AcpNodeName</name>

          <figure anchor="acp-dominfo-abnf">
            <name>ACP Node Name ABNF</name>
            <sourcecode name="" type="abnf"><![CDATA[
  acp-node-name = local-part "@" acp-domain-name
  local-part = [ acp-address ] [ "+" rsub extensions ]
  acp-address = 32HEXDIG / "0" ; HEXDIG as of [RFC5234], Appendix B.1
  rsub = [ <subdomain> ] ; <subdomain> as of [RFC1034], Section 3.5
  acp-domain-name = <domain> ; as of [RFC1034], Section 3.5
  extensions = *( "+" extension )
  extension  = 1*etext  ; future standard definition.
  etext      = ALPHA / DIGIT /  ; Printable US-ASCII
               "!" / "#" / "$" / "%" / "&" / "'" /
               "*" / "-" / "/" / "=" / "?" / "^" /
               "_" / "`" / "{" / "|" / "}" / "~"
                  
  routing-subdomain = [ rsub "." ] acp-domain-name
]]></sourcecode>
          </figure>

  <t>Example:</t>
  <t>Given an ACP address of fd89:b714:f3db:0:200:0:6400:0000,
    an ACP domain name of acp.example.com,
    and an rsub extension of area51.research, then this results in the following:</t>
<artwork><![CDATA[
  acp-node-name      = fd89b714f3db00000200000064000000
                       +area51.research@acp.example.com
  acp-domain-name    = acp.example.com
  routing-subdomain  = area51.research.acp.example.com
]]></artwork>
          <t>The acp-node-name in <xref target="acp-dominfo-abnf" format="default"/> is the ABNF definition ("<xref target="RFC5234" format="title"/>" <xref target="RFC5234" format="default"/>) of the ACP Node Name. An ACP certificate <bcp14>MUST</bcp14> carry this information. It <bcp14>MUST</bcp14> contain an otherName field in the X.509 Subject Alternative Name extension, and the otherName <bcp14>MUST</bcp14> contain an AcpNodeName as described in <xref target="domcert-acpinfo" format="default"/>.</t>
          <t>Nodes complying with this specification <bcp14>MUST</bcp14> be able to receive their ACP address through the domain certificate, in which case their own ACP certificate <bcp14>MUST</bcp14> have a 32HEXDIG acp-address field. The acp-address field is case insensitive because ABNF HEXDIG is. It is recommended to encode acp-address with lowercase letters. Nodes complying with this specification <bcp14>MUST</bcp14> also be able to authenticate nodes as ACP domain members or ACP secure channel peers when they have a zero-value acp-address field and as ACP domain members (but not as ACP secure channel peers) when the acp-address field is omitted from their AcpNodeName.  See <xref target="certcheck" format="default"/>.</t>
          <t>The acp-domain-name is used to indicate the ACP domain across which ACP nodes authenticate and authorize each other, for example, to build ACP secure channels to each other, see <xref target="certcheck" format="default"/>. The acp-domain-name <bcp14>SHOULD</bcp14> be the FQDN of an Internet domain owned by the network administration of the ACP and ideally reserved to only be used for the ACP. In this specification, it serves as a name for the ACP that ideally is globally unique.  When acp-domain-name is a globally unique name, collision of ACP addresses across different ACP domains can only happen due to ULA hash collisions (see <xref target="scheme" format="default"/>). Using different acp-domain-names, operators can distinguish multiple ACPs even when using the same TA.</t>
          <t>To keep the encoding simple, there is no consideration for internationalized acp-domain-names. The acp-node-name is not intended for end-user consumption. There is no protection against an operator picking any domain name for an ACP whether or not the operator can claim to own the domain name. Instead, the domain name only serves as a hash seed for the ULA and for diagnostics for the operator. Therefore, any operator owning only an internationalized domain name should be able to pick an equivalently unique 7-bit ASCII acp-domain-name string representing the internationalized domain name.</t>
          <t>The routing-subdomain is a string that can be constructed from the acp-node-name, and it is used in the hash creation of the ULA (see <xref target="scheme"/>).  The presence of the rsub component allows a single ACP domain to employ multiple /48 ULA prefixes.  See <xref target="domain-usage" format="default"/> for example use cases.</t>
          <t>The optional extensions field is used for future standardized extensions to this specification.  It <bcp14>MUST</bcp14> be ignored if present and not understood.</t>
          <t>The following points explain and justify the encoding choices described:
    </t>
          <ol type="1" spacing="normal">
            <li>
              <t>Formatting notes:
    </t>
              <ol type="1.%d" spacing="normal">
                <li>The rsub component needs to be in the local-part: if the format just had routing-subdomain as the domain part of the acp-node-name, rsub and acp-domain-name could not be separated from each other to determine in the ACP domain membership check which part is the acp-domain-name and which is solely for creating a different ULA prefix.</li>
                <li>If both acp-address and rsub are omitted from AcpNodeName, the local-part will have the format "++extension(s)". The two plus characters are necessary so the node can unambiguously parse that both acp-address and rsub are omitted.</li>
              </ol>
            </li>
            <li>
              <t>The encoding of the ACP domain name and ACP address as described in this section is used for the following reasons: 

    </t>
              <ol type="2.%d" spacing="normal">
                <li>The acp-node-name is the identifier of a node's ACP. It includes the necessary components to identify a node's ACP both from within the ACP as well as from the outside of the ACP.</li>
                <li>For manual and/or automated diagnostics and backend management of devices and ACPs, it is necessary to have an easily human-readable and software-parsable standard, single string representation of the information in the acp-node-name. For example, inventory or other backend systems can always identify an entity by one unique string field but not by a combination of multiple fields, which would be necessary if there were no single string representation.</li>
                <li>If the encoding was not such a string, it would be necessary to define a second standard encoding to provide this format (standard string encoding) for operator consumption.</li>
                <li>Addresses of the form &lt;local&gt;@&lt;domain&gt; have become the preferred format for identifiers of entities in many systems, including the majority of user identifiers in web or mobile applications such as multi-domain single-sign-on systems.</li>
              </ol>
            </li>
            <li>
              <t>Compatibilities:

    </t>
              <ol type="3.%d" spacing="normal">
                <li>It should be possible to use the ACP certificate as an LDevID certificate on the system for uses besides the ACP.  Therefore, the information element required for the ACP should be encoded so that it minimizes the possibility of creating incompatibilities with other such uses. The attributes of the subject field, for example, are often used in non-ACP applications and therefore should not be occupied by new ACP values.</li>
                <li>The element should not require additional ASN.1 encoding and/or decoding because libraries for accessing certificate information, especially for embedded devices, may not support extended ASN.1 decoding beyond predefined, mandatory fields. subjectAltName / otherName is already used with a single string parameter for several otherNames (see "<xref target="RFC6120" format="title"/>" <xref target="RFC6120" format="default"/>, "<xref target="RFC7585" format="title"/>" <xref target="RFC7585" format="default"/>, "<xref target="RFC4985" format="title"/>" <xref target="RFC4985" format="default"/>, "<xref target="RFC8398" format="title"/>" <xref target="RFC8398" format="default"/>).</li>
                <li>The element required for the ACP should minimize the risk of being misinterpreted by other uses of the LDevID certificate.  It also must not be misinterpreted as an email address, hence the use of the otherName / rfc822Name option in the certificate would be inappropriate.</li>
              </ol>
            </li>
          </ol>
          <t>See <xref target="RFC5280" sectionFormat="of" section="4.2.1.6"/> for details on the subjectAltName field.</t>
          <section anchor="asn1" numbered="true" toc="default">
            <name>AcpNodeName ASN.1 Module</name>
            <t>The following ASN.1 module normatively specifies the AcpNodeName structure.
This specification uses the ASN.1 definitions from "<xref target="RFC5912" format="title"/>" <xref target="RFC5912" format="default"/>
with the 2002 ASN.1 notation used in that document.  <xref target="RFC5912" format="default"/>
updates normative documents using older ASN.1 notation.</t>

            <figure>
              <name>AcpNodeName ASN.1 Module</name>
              <sourcecode name="" type="asn.1"><![CDATA[
ANIMA-ACP-2020
  { iso(1) identified-organization(3) dod(6)
    internet(1) security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-anima-acpnodename-2020(97) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

IMPORTS
  OTHER-NAME
  FROM PKIX1Implicit-2009
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-pkix1-implicit-02(59) }

  id-pkix
  FROM PKIX1Explicit-2009
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-pkix1-explicit-02(51) } ;

  id-on OBJECT IDENTIFIER ::= { id-pkix 8 }

  AcpNodeNameOtherNames OTHER-NAME ::= { on-AcpNodeName, ... }

  on-AcpNodeName OTHER-NAME ::= {
      AcpNodeName IDENTIFIED BY id-on-AcpNodeName
  }

  id-on-AcpNodeName OBJECT IDENTIFIER ::= { id-on 10 }

  AcpNodeName ::= IA5String (SIZE (1..MAX))
   -- AcpNodeName as specified in this document carries the
   -- acp-node-name as specified in the ABNF in Section 6.2.2

END
]]></sourcecode>
            </figure>
          </section>
        </section>
        <section anchor="certcheck" numbered="true" toc="default">
          <name>ACP Domain Membership Check</name>
          <t>The following points constitute the ACP domain membership check of a candidate peer via its certificate:
       </t>
          <ol spacing="normal" group="acp">
            <li anchor="step1">The peer has proved ownership of the private key associated
	    with the certificate's public key. This check is performed by the
	    security association protocol used, for example, Section <xref target="RFC7296" section="2.15" sectionFormat="bare"/> of <xref target="RFC7296">"Internet Key Exchange Protocol Version 2 (IKEv2)"</xref>.</li>
            <li anchor="step2">The peer's certificate passes certificate path validation as
	    defined in <xref target="RFC5280" sectionFormat="comma" section="6"/>, against one of the TAs associated with the ACP node's ACP certificate (see <xref target="trust-anchors" format="default"/>). This includes verification of the validity (lifetime) of the certificates in the path.</li>
            <li anchor="step3"><t>If the peer's certificate indicates a CRLDP
             (<xref target="RFC5280" sectionFormat="comma" section="4.2.1.13"/>) or OCSP responder
             (<xref target="RFC5280" sectionFormat="comma" section="4.2.2.1"/>), then the peer's certificate <bcp14>MUST</bcp14> be valid according to those
             mechanisms when they are available: an OCSP check for the peer's certificate across the ACP must succeed, or the peer's certificate must not be listed in the CRL retrieved from the CRLDP. These mechanisms are not available 
             when the ACP node has no ACP or non-ACP connectivity to retrieve a current CRL
             or has no access an OCSP responder, and the security association protocol itself also has no way to communicate the CRL or OCSP check.</t>
            
            <t>Retries to learn revocation via OCSP or CRL <bcp14>SHOULD</bcp14> be made using the same backoff as described in <xref target="neighbor_verification" format="default"/>. If and when the ACP node then learns that an ACP peer's certificate is invalid for which <xref target="step3" format="none">Rule 3</xref> had to be skipped during ACP secure channel establishment, then the ACP secure channel to that peer <bcp14>MUST</bcp14> be closed even if this peer is the only connectivity to access CRL/OCSP. This applies (of course) to all ACP secure channels to this peer if there are multiple.  The ACP secure channel connection <bcp14>MUST</bcp14> be retried periodically to support the case that the neighbor acquires a new, valid certificate.</t></li>
            <li anchor="step4">The peer's certificate has a syntactically valid acp-node-name field,
             and the acp-domain-name in that peer's acp-node-name is the same as in this ACP node's certificate (lowercase normalized).</li></ol>
          <t>When checking a candidate peer's certificate for the purpose of establishing an ACP secure channel,
         one additional check is performed:
       </t>
<ol group="acp">
<li anchor="step5">The acp-address field of the candidate peer certificate's AcpNodeName is not omitted but is either 32HEXDIG or 0, according to <xref target="acp-dominfo-abnf" format="default"/>.</li>
          </ol>
          <t>Technically, ACP secure channels can only be built with nodes that
         have an acp-address. <xref target="step5" format="none">Rule 5</xref> ensures that this is taken into account
         during ACP domain membership check.</t>
          <t>Nodes with an omitted acp-address field can only use their ACP domain
         certificate for non-ACP secure channel authentication purposes.
         This includes, for example, NMS type nodes permitted to communicate
         into the ACP via <xref target="ACPconnect" format="default">ACP connect</xref></t>
          <t> The special value "0" in an ACP certificate's acp-address field
          is used for nodes that can and should determine their ACP address
          through mechanisms other than learning it through the acp-address
          field in their ACP certificate. These ACP nodes are permitted
          to establish ACP secure channels. Mechanisms for those nodes to
          determine their ACP address are outside the scope of this
          specification, but this option is defined here so that any 
          ACP nodes can build ACP secure channels to them according to <xref target="step5" format="none">Rule 5.</xref></t>

          <t>The optional rsub field of the AcpNodeName is not relevant to the
          ACP domain membership check because it only serves to structure routing and 
          addressing within an ACP but not to segment mutual authentication and authorization 
          (hence the name "routing subdomain").</t>
          
          <t>In summary:
        </t>
          <ul spacing="normal">
            <li><xref target="step1" format="none">Steps 1 through 4</xref> constitute standard certificate validity verification and private key authentication as defined by <xref target="RFC5280" format="default"/> and security association protocols (such as <xref target="RFC7296" format="default">IKEv2</xref>) when leveraging certificates. </li>
            <li>Except for its public key, <xref target="step1" format="none">Steps 1 through 4</xref> do not include the verification of any preexisting
	    form of a certificate's identity
      elements, such as a web server's domain name prefix, which is
      often encoded in the certificate common name. <xref target="step5" format="none">Step 5</xref> is an equivalent step for the AcpNodeName.</li>
            <li><xref target="step4" format="none">Step 4</xref> constitutes standard CRL and OCSP checks refined for the case of missing connectivity and limited-functionality security association protocols.</li>
            <li><xref target="step1" format="none">Steps 1 through 4</xref> authorize the building of any secure connection between members of the same ACP domain except for ACP secure channels.</li>
            <li><xref target="step5" format="none">Step 5</xref> is the additional verification of the presence of an ACP address as necessary for ACP secure channels.</li>
            <li><xref target="step1" format="none">Steps 1 through 5</xref> therefore authorize the building of an ACP secure channel.</li>
          </ul>
          <t>For brevity, the remainder of this document refers to this process only as authentication instead of as authentication and authorization.</t>

          <section anchor="cert-time" numbered="true" toc="default">
            <name>Realtime Clock and Time Validation</name>
            <t>An ACP node with a realtime clock in which it has confidence <bcp14>MUST</bcp14>
            check the timestamps when performing an ACP domain membership check, such
            as checking the certificate validity period in <xref target="step1" format="none">Step 1</xref> and the respective
            times in <xref target="step4" format="none">Step 4</xref> for revocation information (e.g., signingTimes in Cryptographic Message Syntax (CMS) signatures).</t>
            <t>An ACP node without such a realtime clock <bcp14>MAY</bcp14> ignore those timestamp 
            validation steps if it does not know the current time.
            Such an ACP node <bcp14>SHOULD</bcp14> obtain the current time in a
            secured fashion, such as via NTP signaled through the ACP.
            It then ignores timestamp validation only until the current time is known.
            In the absence of implementing a secured mechanism, such an ACP node <bcp14>MAY</bcp14>
            use a current time learned in an insecure fashion in the ACP domain membership
            check.</t>
            <t>Current time <bcp14>MAY</bcp14> be learned in an unsecured fashion, for example, via NTP ("<xref target="RFC5905" format="title"/>" <xref target="RFC5905" format="default"/>)
            over the same link-local IPv6 addresses used for the ACP from neighboring ACP nodes.
            ACP nodes that do provide unsecured NTP over their link-local addresses <bcp14>SHOULD</bcp14>
            primarily run NTP across the ACP and provide NTP time across the ACP only
            when they have a trusted time source. Details for such NTP procedures are beyond the
            scope of this specification.</t>
            <t>Besides the ACP domain membership check, the ACP itself has no
            dependency on knowing the current time, but protocols
            and services using the ACP, for example, event logging, will likely need to know
            the current time.</t>
          </section>
        </section>
        <section anchor="trust-anchors" numbered="true" toc="default">
          <name>Trust Anchors (TA)</name>
          <t>ACP nodes need TA information according to <xref target="RFC5280" sectionFormat="comma" section="6.1.1"/> (d), typically in the form of one or more certificates of the TA to perform certificate
path validation as required by <xref target="step2" format="none">Section 6.2.3, Rule 2</xref>.
TA information <bcp14>MUST</bcp14> be provisioned to an ACP node (together with its ACP
domain certificate) by an ACP registrar during initial enrollment of a candidate
ACP node. ACP nodes <bcp14>MUST</bcp14> also support the renewal of TA information via 
EST as described in <xref target="domcert-maint" format="default"/>.</t>

          <t>The required information about a TA can consist of 
one or more
certificates as required for dealing with CA certificate renewals
as explained in Section <xref target="RFC4210" section="4.4" sectionFormat="bare"/> of <xref target="RFC4210">"Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)"</xref>).</t>
          <t>A certificate path is a chain of certificates starting at
the ACP certificate (the leaf and/or end entity), followed by zero or more
intermediate CA certificates, and ending with the TA information,
which is typically one or two self-signed certificates of the TA. The
CA that signs the ACP certificate is called the assigning CA.
If there are no intermediate CAs, then the assigning CA is the TA.
Certificate path validation authenticates that the TA associated with the ACP permits the ACP certificate, either directly or indirectly via one or more intermediate
CA.</t>
          <t>Note that different ACP nodes may have different intermediate CAs
in their certificate path and even different TA. The set of TAs for
an ACP domain must be consistent across all ACP members so that any ACP node
can authenticate any other ACP node.  The protocols through which the 
ACP domain membership check <xref target="step1" format="none">Rules 1 through 3</xref> are performed need to support
the exchange not only of the ACP nodes certificates but also the exchange of
the intermediate TA.</t>
          <t>For the ACP domain membership check, ACP nodes <bcp14>MUST</bcp14> support certificate path 
validation with zero or one intermediate CA. They <bcp14>SHOULD</bcp14> support two intermediate CAs
and two TAs (to permit migration from one TA to another TA).</t>
          <t>Certificates for an ACP <bcp14>MUST</bcp14> only be given to nodes that are allowed
to be members of that ACP. When the signing CA relies on an ACP registrar, 
the CA <bcp14>MUST</bcp14> only sign certificates with acp-node-name
through trusted ACP registrars. In this setup, any existing CA, unaware of the formatting
of acp-node-name, can be used.</t>
          <t>These requirements can be achieved by using a TA private to the owner of
the ACP domain or potentially through appropriate contractual agreements between
the involved parties (registrar and CA).  Using a public CA is out of scope of this
document.  </t>

          <t>A single owner can operate multiple, independent ACP domains from the same
set of TAs. Registrars must then know into which ACP a node needs to be enrolled.</t>
        </section>
        <section anchor="domcert-maint" numbered="true" toc="default">
          <name>Certificate and Trust Anchor Maintenance</name>

          <t>ACP nodes <bcp14>MUST</bcp14> support renewal of their certificate and TA information via EST
and <bcp14>MAY</bcp14> support other mechanisms.  See <xref target="tls" format="default"/> for TLS requirements.
An ACP network <bcp14>MUST</bcp14> have at least one ACP node supporting EST server functionality across the ACP so that EST
renewal is usable.</t>
<t>ACP nodes <bcp14>SHOULD</bcp14> remember the GRASP O_IPv6_LOCATOR parameters of
   the EST server with which they last renewed their ACP certificate.
They <bcp14>SHOULD</bcp14> provide the ability
for these EST server parameters to also be set by the ACP registrar
(see <xref target="acp-registrars" format="default"/>) that initially enrolled the ACP
device with its ACP certificate. When BRSKI 
is used (see <xref target="RFC8995" format="default"/>), the IPv6 locator of the BRSKI registrar from the BRSKI TLS
connection <bcp14>SHOULD</bcp14> be remembered and used for the next renewal via
EST if that registrar also announces itself as an EST server
via GRASP on its ACP address (see <xref target="domcert-grasp"/>).</t>
          <t>The EST server <bcp14>MUST</bcp14> present a certificate that passes the ACP domain
membership check in its TLS connection setup (<xref target="step1" format="none">Section 6.2.3, rules 1 through 4</xref>, not <xref target="step5" format="none">rule 5</xref> as this is not for an ACP secure channel setup).
The EST server certificate <bcp14>MUST</bcp14> also contain the id-kp-cmcRA 
extended key usage attribute <xref target="RFC6402" format="default"/>, and the EST client <bcp14>MUST</bcp14> check its presence.</t>
          <t>The additional check against the id-kp-cmcRA extended key usage extension field
ensures that clients do not fall prey to an illicit EST server.  While such
illicit EST servers should not be able to support certificate signing requests (as they
are not able to elicit a signing response from a valid CA), such an illicit EST server would
be able to provide faked CA certificates to EST clients that need to renew their
CA certificates when they expire.</t>
          <t>Note that EST servers supporting multiple ACP domains will need to have 
a separate certificate for each of these ACP domains and respond on a different transport
address (IPv6 address and/or TCP port). This is easily automated on the
EST server if the CA allows registrars to request certificates 
with the id-kp-cmcRA extended usage extension for themselves.</t>
          <section anchor="domcert-grasp" numbered="true" toc="default">
            <name>GRASP Objective for EST Server</name>

            <t>ACP nodes that are EST servers <bcp14>MUST</bcp14> announce their service in the ACP via GRASP 
Flood Synchronization (M_FLOOD) messages. See <xref target="RFC8990" sectionFormat="comma" section="2.8.11"/> for the definition of this message type
and <xref target="est-example"/> for an example.</t>
            <figure anchor="est-example">
              <name>GRASP "SRV.est" Objective Example</name>
              <sourcecode name="" type=""><![CDATA[
   [M_FLOOD, 12340815, h'fd89b714f3db0000200000064000001', 210000,
       [["SRV.est", 4, 255 ],
       [O_IPv6_LOCATOR,
            h'fd89b714f3db0000200000064000001', IPPROTO_TCP, 443]]
   ]
 ]]></sourcecode>
            </figure>
            <t> The formal definition of the objective in CDDL
   (see "<xref target="RFC8610" format="title"/>" <xref target="RFC8610" format="default"/>) is as follows: </t>
            <figure anchor="est-def-fig">
              <name>GRASP "SRV.est" Definition</name>
              <sourcecode name="" type="cddl"><![CDATA[
flood-message = [M_FLOOD, session-id, initiator, ttl,
                 +[objective, (locator-option / [])]]
                             ; See example above and explanation
                             ; below for initiator and ttl.

objective = ["SRV.est", objective-flags, loop-count,
                                       objective-value]

objective-flags = sync-only  ; As in [RFC8990].
sync-only       = 4          ; M_FLOOD only requires synchronization.
loop-count      = 255        ; Recommended as there is no mechanism
                             ; to discover network diameter.
objective-value = any        ; Reserved for future extensions.
]]></sourcecode>
            </figure>
            <t>The objective name "SRV.est" indicates that the objective is an EST server compliant with
<xref target="RFC7030" format="default"/> because "est" is a
registered service name ("<xref target="RFC6335" format="title"/>" <xref target="RFC6335" format="default"/>) for <xref target="RFC7030" format="default"/>.
The 'objective-value' field <bcp14>MUST</bcp14> be ignored if present. Backward-compatible extensions to
<xref target="RFC7030" format="default"/> <bcp14>MAY</bcp14> be indicated through 'objective-value'.
Certificate renewal options that are incompatible with <xref target="RFC7030" format="default"/> <bcp14>MUST</bcp14> use a different 'objective-name'.
Unrecognized 'objective-value' fields (or parts thereof if it is a partially understood structure) <bcp14>MUST</bcp14> be ignored.</t>
            <t>The M_FLOOD message <bcp14>MUST</bcp14> be sent periodically.  The default <bcp14>SHOULD</bcp14> be 60 seconds;
the value <bcp14>SHOULD</bcp14> be operator configurable but <bcp14>SHOULD</bcp14> be
not smaller than 60 seconds.  The frequency of sending <bcp14>MUST</bcp14> be such
that the aggregate amount of periodic M_FLOODs from all flooding sources
cause only negligible traffic across the ACP.  The time-to-live (ttl) parameter <bcp14>SHOULD</bcp14> be 3.5 times the period so that up
to three consecutive messages can be dropped before an announcement is considered expired.
In the example above, the ttl is 210000 msec, that is, 3.5 times 60 seconds. When a service announcer
using these parameters unexpectedly dies immediately after sending the M_FLOOD,
receivers would consider it expired 210 seconds later. When a receiver tries to
connect to this dead service before this timeout, it will experience a failing connection and
use that as an indication that the service instance is dead and select another instance of the
same service instead (from another GRASP announcement).</t>
<t>The "SRV.est" objective(s) <bcp14>SHOULD</bcp14> only be announced when the ACP node knows that it can successfully
communicate with a CA to perform the EST renewal and/or rekeying operations for the ACP domain. See also
<xref target="security"/>.</t>
          </section>
          <section anchor="domcert-renewal" numbered="true" toc="default">
            <name>Renewal</name>
            <t>When performing renewal, the node <bcp14>SHOULD</bcp14> attempt to connect to the remembered EST server. 
If that fails, it <bcp14>SHOULD</bcp14> attempt to connect to an EST server learned via GRASP.  The server
with which certificate renewal succeeds <bcp14>SHOULD</bcp14> be remembered for the next renewal.</t>
            <t>Remembering the last renewal server and preferring it provides stickiness
that can help diagnostics.  It also provides some protection against off-path,
compromised ACP members announcing bogus information into GRASP.</t>
            <t>Renewal of certificates <bcp14>SHOULD</bcp14> start after less than 50% of the domain certificate
lifetime so that network operations have ample time to investigate and
resolve any problems that cause a node to not renew its domain certificate
in time, and to allow prolonged periods of running parts of a network
disconnected from any CA.</t>
          </section>
          <section anchor="domcert-crl" numbered="true" toc="default">
            <name>Certificate Revocation Lists (CRLs)</name>
            <t>The ACP node <bcp14>SHOULD</bcp14> support revocation through CRL(s) via HTTP from one
or more CRL Distribution Points (CRLDP).  The CRLDP(s) <bcp14>MUST</bcp14> be indicated
in the domain certificate when used.  If the CRLDP URL uses an IPv6 address
(ULA address when using the addressing rules specified in this document),
the ACP node will connect to the CRLDP via the ACP.  If the CRLDP uses a
domain name, the ACP node will connect to the CRLDP via the data plane.</t>
            <t>It is common to use domain names for CRLDP(s), but there is no requirement
for the ACP to support DNS. Any DNS lookup in the data plane is
not only a possible security issue, but it would also not indicate whether
the resolved address is meant to be reachable across the ACP. Therefore,
the use of an IPv6 address versus the use of a DNS name doubles as an
indicator whether or not to reach the CRLDP via the ACP.</t>
<t>A CRLDP can be reachable across the ACP either by running it on a
node with ACP or by connecting its node via an ACP connect interface (see <xref target="ACPconnect" format="default"/>).</t>

<t>When using a private PKI for ACP certificates, the CRL may be need-to-know, for example,
to prohibit insight into the operational practices of the domain by tracking
the growth of the CRL.  In this case, HTTPS may be chosen to provide
confidentiality, especially when making the CRL available via the data plane.
Authentication and authorization <bcp14>SHOULD</bcp14> use ACP certificates and the ACP domain membership check (<xref target="certcheck" format="default"/>).
The CRLDP <bcp14>MAY</bcp14> omit the CRL verification during authentication of the peer to permit
CRL retrieval by an ACP node with a revoked ACP certificate, which can allow the 
(ex) ACP node to quickly discover its ACP certificate revocation. This may violate
the desired need-to-know requirement, though. ACP nodes <bcp14>MAY</bcp14> support CRLDP operations
via HTTPS.</t>

          </section>
          <section anchor="domcert-lifetime" numbered="true" toc="default">
            <name>Lifetimes</name>
            <t>The certificate lifetime may be set to shorter lifetimes than customary
(one year) because certificate renewal is fully automated via ACP and EST.
The primary limiting factor for shorter certificate lifetimes 
is the load on the EST server(s) and CA.  It is therefore recommended that
ACP certificates are managed via a CA chain where the assigning
CA has enough performance to manage short-lived certificates. See also
<xref target="sub-ca" format="default"/> for a discussion about an example setup achieving
this. See also "<xref target="RFC8739" format="title"/>" <xref target="RFC8739" format="default"/>.</t>
            <t>When certificate lifetimes are sufficiently short, such as few hours,
certificate revocation may not be necessary, allowing the simplification of the overall
certificate maintenance infrastructure.</t>
            <t>See <xref target="bootstrap" format="default"/> for further optimizations of certificate
maintenance when BRSKI can be used <xref target="RFC8995" format="default"/>.</t>
          </section>
          <section anchor="domcert-re-enroll" numbered="true" toc="default">
            <name>Reenrollment</name>
            <t>An ACP node may determine that its ACP certificate
has expired, for example, because the ACP node was powered down or
disconnected longer than its certificate lifetime. In this case, the ACP
node <bcp14>SHOULD</bcp14> convert to a role of a reenrolling candidate ACP node.</t>
            <t>In this role, the node maintains the TA and certificate
chain associated with its ACP certificate exclusively for the purpose
of reenrollment, and it attempts (or waits) to get reenrolled with a new ACP
certificate.  The details depend on the mechanisms and protocols used
by the ACP registrars.</t>
            <t>Please refer to <xref target="acp-registrars" format="default"/> and <xref target="RFC8995" format="default"/>
for explanations about ACP registrars and vouchers as used in the following text.
When ACP is intended to be used without BRSKI, the details about BRSKI and
vouchers in the following text can be skipped.</t>
            <t>When BRSKI is used (i.e., on ACP nodes that are ANI nodes), the reenrolling
candidate ACP node attempts to enroll like a candidate ACP node (BRSKI pledge), 
but instead of using the ACP node's IDevID certificate, it <bcp14>SHOULD</bcp14> first attempt to use its ACP domain
certificate in the BRSKI TLS authentication.  The BRSKI registrar <bcp14>MAY</bcp14> honor
this certificate beyond its expiration date purely for the purpose of
reenrollment. Using the ACP node's domain certificate allows the BRSKI
registrar to learn that node's acp-node-name
so that the BRSKI registrar can reassign the same ACP address information 
to the ACP node in the new ACP certificate.</t>

            <t>If the BRSKI registrar denies the use of the old ACP certificate,
the reenrolling candidate ACP node <bcp14>MUST</bcp14> reattempt reenrollment using
its IDevID certificate as defined in BRSKI during the TLS connection setup.</t>

            <t>When the BRSKI connection is attempted with either with the old ACP certificate
or the IDevID certificate, the reenrolling candidate ACP node <bcp14>SHOULD</bcp14> authenticate
the BRSKI registrar during TLS connection setup based on its existing TA
certificate chain information associated with its old ACP certificate.
The reenrolling candidate ACP node <bcp14>SHOULD</bcp14> only fall back to requesting a voucher from the BRSKI registrar 
when this authentication fails during TLS connection setup. 
As a countermeasure against attacks that attempt to force the ACP node to forget its prior (expired) certificate
and TA, the ACP node should alternate between attempting to reenroll using
its old keying material and attempting to reenroll with its IDevID and requesting
a voucher.</t>

            <t>When mechanisms other than BRSKI are used for ACP certificate 
enrollment, the principles of the reenrolling candidate ACP node are the same.
The reenrolling candidate ACP node attempts to authenticate any ACP registrar peers
using reenrollment protocols and/or mechanisms via its existing certificate chain and/or TA information
and provides its existing ACP certificate and other identification
(such as the IDevID certificate) as necessary to the registrar.</t>

            <t>Maintaining existing TA information is especially important
when using enrollment mechanisms that do not leverage
a mechanism to authenticate the ACP registrar (such as the voucher in BRSKI), 
and when the injection of certificate failures could otherwise make the ACP vulnerable to remote 
attacks by returning the ACP node to a "duckling" state in which
it accepts enrollment by any network it connects to. The (expired) ACP
certificate and ACP TA <bcp14>SHOULD</bcp14> therefore be maintained and attempted to be used as one possible credential for reenrollment
until new keying material is acquired.</t>

           <t>When using BRSKI or other protocols and/or mechanisms that support vouchers,
maintaining existing TA information allows for lighter-weight reenrollment
of expired ACP certificates, especially in
environments where repeated acquisition of vouchers during the lifetime
of ACP nodes may be operationally expensive or otherwise undesirable.</t>
          </section>
          <section anchor="domcert-failing" numbered="true" toc="default">
            <name>Failing Certificates</name>
            <t>An ACP certificate is called failing in this document
if or when the ACP node to which the certificate was issued can determine that it was revoked (or explicitly
not renewed), or in the absence of such explicit local diagnostics,
when the ACP node fails to connect to other ACP nodes in the same ACP
domain using its ACP certificate. To
determine that the ACP certificate is the culprit of a connection failure, the peer
should pass the domain membership check (<xref target="certcheck" format="default"/>),
and connection error diagnostics should exclude other reasons for the connection failure.</t>
            <t>This type of failure can happen during the setup or refreshment of a secure ACP channel
connection or during any other use of the ACP certificate, such as for the
TLS connection to an EST server for the renewal of the ACP domain
certificate.</t>
            <t>The following are examples of failing certificates that the ACP node can only
discover through connection failure: the domain certificate or
any of its signing certificates could have been revoked or may have expired,
but the ACP node cannot diagnose this condition directly by itself. Revocation
information or clock synchronization may only be available across the ACP,
but the ACP node cannot build ACP secure channels because the ACP peers reject
the ACP node's domain certificate.</t>
            <t>An ACP node <bcp14>SHOULD</bcp14> support the option to determine whether its ACP
certificate is failing, and when it does, put itself into the role of a
reenrolling candidate ACP node as explained in <xref target="domcert-re-enroll" format="default"/>.</t>
          </section>
        </section>
      </section>
      <section anchor="adj-table" numbered="true" toc="default">
        <name>ACP Adjacency Table</name>
        <t>To know to which nodes to establish an ACP channel, every ACP node maintains an adjacency table.  The adjacency table contains information about adjacent ACP nodes, at a minimum: Node-ID (the identifier of the node inside the ACP, see <xref target="zone-scheme" format="default"/> and <xref target="Vlong" format="default"/>), the interface on which neighbor was discovered (by GRASP as explained below), the link-local IPv6 address of the neighbor on that interface, and the certificate (including acp-node-name).  An ACP node <bcp14>MUST</bcp14> maintain this adjacency table.  This table is used to determine to which neighbor an ACP connection is established.</t>
        <t>When the next ACP node is not directly adjacent (i.e., not on a link
connected to this node), the information in the adjacency table can be supplemented by configuration.  For example, the Node-ID and IP address could be configured. See <xref target="remote-acp-neighbors" format="default"/>.</t>
        <t>The adjacency table <bcp14>MAY</bcp14> contain information about the validity and trust of the adjacent ACP node's certificate.  However, subsequent steps <bcp14>MUST</bcp14> always start with the ACP domain membership check against the peer (see <xref target="certcheck" format="default"/>).</t>
        <t>The adjacency table contains information about adjacent ACP nodes in general, independent of their domain and trust status.  The next step determines to which of those ACP nodes an ACP connection should be established.</t>
      </section>
      <section anchor="discovery-grasp" numbered="true" toc="default">
        <name>Neighbor Discovery with DULL GRASP</name>

        <t>Discovery Unsolicited Link-Local (DULL) GRASP is a limited subset of GRASP intended to operate across an
insecure link-local scope.  See <xref target="RFC8990" sectionFormat="of" section="2.5.2"/> for its
formal definition.  The ACP uses one instance of DULL GRASP for every L2 interface
of the ACP node to discover candidate ACP neighbors that are link-level adjacent.  Unless modified
by policy as noted earlier (<xref target="sec5bt2" format="none">Section 5, bullet point 2</xref>), native interfaces
(e.g., physical interfaces on physical nodes) <bcp14>SHOULD</bcp14> be initialized automatically to a state in which
ACP discovery can be performed, and any native interfaces with ACP neighbors can
then be brought into the ACP even if the interface is otherwise unconfigured.
Reception of packets on such otherwise unconfigured interfaces <bcp14>MUST</bcp14> be limited so that
at first only SLAAC ("<xref target="RFC4862" format="title"/>" <xref target="RFC4862" format="default"/>)
 and DULL GRASP work, and then only
the following ACP secure channel setup packets work, but not any other unnecessary traffic
(e.g., no other link-local IPv6 transport stack responders, for example).</t>
        <t>Note that the use of the IPv6 link-local multicast address (ALL_GRASP_NEIGHBORS) implies
the need to use MLDv2 (see "<xref target="RFC3810" format="title"/>" <xref target="RFC3810" format="default"/>)
to announce the desire to receive packets for
that address.  Otherwise, DULL GRASP could fail to operate correctly in the presence of
MLD-snooping switches ("<xref target="RFC4541" format="title"/>" <xref target="RFC4541" format="default"/>) that either do not support ACP or are not ACP enabled because those switches would stop forwarding DULL GRASP packets.
Switches that do not support MLD snooping simply need to operate as pure L2 bridges for
IPv6 multicast packets for DULL GRASP to work.</t>
        <t>ACP discovery <bcp14>SHOULD NOT</bcp14> be enabled by default on non-native interfaces.  In particular, ACP discovery <bcp14>MUST NOT</bcp14> run inside the ACP across ACP virtual interfaces.  See <xref target="enabling-acp" format="default"/> for further non-normative suggestions on how to enable and disable ACP at the node and interface level.  See <xref target="conf-tunnel" format="default"/> for more details about tunnels (typical non-native interfaces).  See <xref target="acp-l2-switches" format="default"/> for extending ACP on devices operating (also) as L2 bridges.</t>
        <t>Note: if an ACP node also implements BRSKI to enroll its ACP certificate
(see <xref target="bootstrap" format="default"/> for a summary), then the above considerations also apply to 
GRASP discovery for BRSKI.  Each DULL instance of GRASP
set up for ACP is then also used for the discovery of a bootstrap proxy via BRSKI when the node
does not have a domain certificate.
Discovery of ACP neighbors happens only when the node does have the certificate.  The node
therefore never needs to discover both a bootstrap proxy and an ACP neighbor at the same time.</t>

        <t>An ACP node announces itself to potential ACP peers by use of the "AN_ACP" objective.
This is a synchronization objective intended to be flooded on a single link using the
GRASP Flood Synchronization (M_FLOOD) message.  In accordance with the design of the Flood Synchronization message,
a locator consisting of a specific link-local IP address, IP protocol number, and port number
will be distributed with the flooded objective.  An example of the message is informally:</t>
        <figure anchor="an-acp-example">
          <name>GRASP "AN_ACP" Objective Example</name>
      <sourcecode name="" type=""><![CDATA[
   [M_FLOOD, 12340815, h'fe80000000000000c0011001feef0000', 210000,
     [["AN_ACP", 4, 1, "IKEv2" ],
      [O_IPv6_LOCATOR,
           h'fe80000000000000c0011001feef0000', IPPROTO_UDP, 15000]]
     [["AN_ACP", 4, 1, "DTLS" ],
      [O_IPv6_LOCATOR,
           h'fe80000000000000c0011001feef0000', IPPROTO_UDP, 17000]]
   ]
 ]]></sourcecode>
        </figure>
        <t> The formal CDDL definition is: </t>
        <figure anchor="an-acp-def">
          <name>GRASP "AN_ACP" Definition</name>
          <sourcecode name="" type="cddl"><![CDATA[
  flood-message = [M_FLOOD, session-id, initiator, ttl,
                   +[objective, (locator-option / [])]]

  objective = ["AN_ACP", objective-flags, loop-count,
                                         objective-value]

  objective-flags = sync-only ; as in [RFC8990] 
  sync-only =  4    ; M_FLOOD only requires synchronization
  loop-count = 1    ; limit to link-local operation

  objective-value = method-name / [ method, *extension ]
  method = method-name / [ method-name, *method-param ]
  method-name = "IKEv2" / "DTLS" / id
  extension = any
  method-param = any
  id = text .regexp "[A-Za-z@_$]([-.]*[A-Za-z0-9@_$])*"
 ]]></sourcecode>
        </figure>
        <t>The 'objective-flags' field is set to indicate synchronization.</t>
        <t>The 'loop-count' is fixed at 1 since this is a link-local operation.</t>
        <t>In the above example, the <bcp14>RECOMMENDED</bcp14> period of sending of the
    objective is 60 seconds. The indicated 'ttl' of 210000 msec means
    that the objective would be cached by ACP nodes even when two
     out of three messages are dropped in transit.</t>
        <t>The 'session-id' is a random number used for loop prevention (distinguishing a message from a prior instance of the same message).  In DULL this field is irrelevant but has to be set according to the GRASP specification.</t>
        <t>The originator <bcp14>MUST</bcp14> be the IPv6 link-local address of the originating ACP node on the sending interface.</t>
        <t>The 'method-name' in the 'objective-value' parameter is a string indicating the protocol available at the specified or implied locator. It is a protocol supported by the node to negotiate a secure channel. "IKEv2" as shown in <xref target="an-acp-example" format="default"/> is the protocol used to negotiate an IPsec secure channel.</t>
        <t>The 'method-param' parameter allows method-specific parameters to be carried. This specification does not define any 'method-param'(s) for "IKEv2" or "DTLS". Any method-params for these two methods that are not understood by an ACP node <bcp14>MUST</bcp14> be ignored by it.</t>
        <t>The 'extension' parameter allows the definition of method-independent parameters. This specification does not define any extensions. Extensions not understood by an ACP node <bcp14>MUST</bcp14> be ignored by it.</t>
        <t>The 'locator-option' is optional and is only required when the secure channel protocol is not offered at a well-defined port number, or if there is no well-defined port number.</t>

        <t>IKEv2 is the actual protocol used to negotiate an IPsec connection.  GRASP therefore indicates "IKEv2" and not "IPsec". If "IPsec" was used, this could mean the use of the obsolete, older version IKE (v1) ("<xref target="RFC2409" format="title"/>" <xref target="RFC2409" format="default"/>).  IKEv2 has an IANA-assigned port number 500, but in <xref target="an-acp-example" format="default"/>, the candidate ACP neighbor is offering ACP secure channel negotiation via IKEv2 on port 15000 (purely to show through the example that GRASP allows the indication of a port number, and it does not have to be IANA assigned).</t>

        <t>There is no default UDP port for DTLS, it is always locally assigned by the node. For further details about the "DTLS" secure channel protocol, see <xref target="DTLS" format="default"/>.</t>

        <t>If a locator is included, it <bcp14>MUST</bcp14> be an O_IPv6_LOCATOR, and the IPv6 address <bcp14>MUST</bcp14> be the same as the initiator address (these are DULL requirements to minimize third-party DoS attacks).</t>

        <t>The secure channel methods defined in this document use "IKEv2" and "DTLS" for 'objective-value'.  There is no distinction between IKEv2 native and GRE-IKEv2 because this is purely negotiated via IKEv2.</t>
        <t>A node that supports more than one secure channel protocol method needs to flood multiple versions
    of the "AN_ACP" objective so that each method can be accompanied by its own 'locator-option'.  This can use a single GRASP M_FLOOD message as shown in <xref target="an-acp-example" format="default"/>.</t>
        <t>The primary use of DULL GRASP is to discover the link-local IPv6 address of candidate ACP peers on subnets. The signaling of the supported secure channel option is primarily for diagnostic purposes, but it is also necessary for discovery when the protocol has no well-known transport address, such as in the case of DTLS.  </t>

        <t>Note that a node serving both as an ACP node and BRSKI Join Proxy may choose to distribute the "AN_ACP" objective and the respective BRSKI in the same M_FLOOD message, since GRASP allows multiple objectives in one message.  This may be impractical, though, if ACP and BRSKI operations are implemented via separate software modules and/or ASAs.</t>
        <t>The result of the discovery is the IPv6 link-local address of the neighbor as well as its supported secure channel protocols (and the non-standard port they are running on).  It is stored in the ACP adjacency table (see <xref target="adj-table" format="default"/>), which then drives the further building of the ACP to that neighbor.</t>
        <t>Note that the described DULL GRASP objective intentionally does not include the ACP node's ACP certificate, even though this would be useful for diagnostics and to simplify the security exchange in ACP secure channel security association protocols (see <xref target="associations" format="default"/>). The reason is that DULL GRASP messages are periodically multicast across IPv6 subnets, and full certificates could easily lead to fragmented IPv6 DULL GRASP multicast packets due to the size of a certificate.  This would be highly undesirable.</t>
      </section>
      <section anchor="selection" numbered="true" toc="default">
        <name>Candidate ACP Neighbor Selection</name>
        <t>An ACP node determines to which other ACP nodes in the adjacency table it should attempt to build an ACP connection.  This is based on the information in the ACP adjacency table.</t>
        <t>The ACP is established exclusively between nodes in the same domain.  This includes all routing subdomains. <xref target="domain-usage" format="default"/> explains how ACP connections across multiple routing subdomains are special.</t>
        <t>The result of the candidate ACP neighbor selection process is a list of adjacent or configured autonomic neighbors to which an ACP channel should be established.  The next step begins that channel establishment.</t>
      </section>
      <section anchor="channel-selection" numbered="true" toc="default">
        <name>Channel Selection</name>
        <t>To avoid attacks, the initial discovery of candidate ACP peers cannot include any unprotected negotiation.  To avoid reinventing and validating security association mechanisms, the next step after discovering the address of a candidate neighbor is to establish a security association with that neighbor using a well-known security association method.</t>
        <t>It seems clear from the use cases that not all types of ACP nodes can or need to connect directly to each other, nor are they able to support or prefer all possible mechanisms. 
  For example, IoT devices that are codespace limited may only support DTLS because that code exists already on them for end-to-end security, but low-end, in-ceiling L2 switches may only want to support Media Access Control Security (MacSec, see 802.1AE <xref target="MACSEC" format="default"/>) because that is also supported in their chips.  Only a flexible gateway device may need to support both of these mechanisms and potentially more.  Note that MacSec is not required by any profiles of the ACP in this specification. Instead, MacSec is mentioned as an interesting potential secure channel protocol.  Note also that the security model allows and requires any-to-any authentication and authorization between all ACP nodes because there is not only hop-by-hop but also end-to-end authentication for secure channels.</t>
        <t>To support extensible selection of the secure channel protocol without a single common mandatory-to-implement (MTI) protocol, an ACP node <bcp14>MUST</bcp14> try all the ACP secure channel protocols it supports and that are also announced by the candidate ACP neighbor via its "AN_ACP" GRASP parameters (these are called the "feasible" ACP secure channel protocols).</t>
        <t>To ensure that the selection of the secure channel protocols always succeeds in a predictable fashion without blocking, the following rules apply:
</t>
        <ul spacing="normal">

          <li>An ACP node may choose to attempt to initiate the different feasible ACP secure channel protocols it supports according to its local policies sequentially or in parallel, but it <bcp14>MUST</bcp14> support acting as a responder to all of them in parallel.</li>

          <li>Once the first ACP secure channel protocol connection to a specific peer IPv6 address passes peer authentication, the two peers know each other's certificate because those ACP certificates are used by all secure channel protocols for mutual authentication.  The peer with the higher Node-ID in the AcpNodeName of its ACP certificate takes on the role of the Decider towards the peer. The other peer takes on the role of the Follower. The Decider selects which secure channel protocol to ultimately use.</li>

          <li>The Follower becomes passive: it does not attempt to further initiate ACP secure channel protocol connections with the Decider and does not consider it to be an error when the Decider closes secure channels.  The Decider becomes the active party, continuing to attempt the setup of secure channel protocols with the Follower. This process terminates when the Decider arrives at the "best"
 ACP secure channel connection option that also works with the Follower ("best" from the Decider's point of view).</li>

<li>A peer with a "0" acp-address in its AcpNodeName takes on the role of Follower when peering with a node that has a non-"0" acp-address (note that this specification does not fully define the behavior of ACP secure channel negotiation for nodes with a "0" ACP address field, it only defines interoperability with such ACP nodes).</li>

        </ul>

        <t>In a simple example, ACP peer Node 1 attempts to initiate an IPsec connection via IKEv2 to peer Node 2.  The IKEv2 authentication succeeds. Node 1 has the lower ACP address and becomes the Follower. Node 2 becomes the Decider. IKEv2 might not be the preferred ACP secure channel protocol for the Decider Node 2. Node 2 would therefore proceed to attempt secure channel setups with more preferred protocol options (in its view, e.g., DTLS/UDP). If any such preferred ACP secure channel connection of the Decider succeeds, it would close the IPsec connection.  If Node 2 has no preferred protocol option over IPsec, or no such connection attempt from Node 2 to Node 1 succeeds, Node 2 would keep the IPsec connection and use it.</t>

<t>The Decider <bcp14>SHOULD NOT</bcp14> send actual payload packets across a secure channel until it has decided to use it. The Follower <bcp14>MAY</bcp14> delay linking the ACP secure channel to the ACP virtual interface until it sees the first payload packet from the Decider up to a maximum of 5 seconds to avoid unnecessarily linking a secure channel that will be terminated as undesired by the Decider shortly afterward.</t>

        <t keepWithNext="true">The following sequence of steps show this example in more detail. Each step is tagged with [&lt;step#&gt;{:&lt;connection&gt;}]. The connection is included to more easily distinguish which of the two competing connections the step belongs to, one initiated by Node 1, one initiated by Node 2.
   </t>
<dl newline="false" indent="10">
<dt>[1]</dt><dd>Node 1 sends GRASP "AN_ACP" message to announce itself.</dd>
<dt>[2]</dt><dd>Node 2 sends GRASP "AN_ACP" message to announce itself.</dd>
<dt>[3]</dt><dd>Node 2 receives [1] from Node 1.</dd>
<dt>[4:C1]</dt><dd>Because of [3], Node 2 starts as initiator on its preferred
secure channel protocol towards Node 1. Connection C1.</dd>
<dt>[5]</dt><dd>Node 1 receives [2] from Node 2.</dd>
<dt>[6:C2]</dt><dd>Because of [5], Node 1 starts as initiator on its preferred secure channel protocol towards Node 2. Connection C2.</dd>
<dt>[7:C1]</dt><dd>Node 1 and Node 2 have authenticated each other's certificate on connection C1 as valid ACP peers.</dd>
<dt>[8:C1]</dt><dd>Node 1's certificate has a lower ACP Node-ID than Node 2's, therefore Node 1 considers itself the Follower and Node 2 the Decider on connection C1. Connection setup C1 is completed.</dd>
<dt>[9]</dt><dd>Node 1 refrains from attempting any further secure channel connections to Node
2 (the Decider) as learned from [2] because it knows from [8:C1] that it is the Follower relative to Node 2.
</dd>
<dt>[10:C2]</dt><dd>Node 1 and Node 2 have authenticated each other's certificate on connection C2 (like [7:C1]).</dd>
<dt>[11:C2]</dt><dd>Node 1's certificate has a lower ACP Node-ID than Node 2's, therefore Node 1
considers itself the Follower and Node 2 the Decider on connection C2, but
they also identify that C2 is to the same mutual peer as their C1, so this has
no further impact: the roles Decider and Follower where already assigned
between these two peers by [8:C1].</dd>
<dt>[12:C2]</dt><dd>Node 2 (the Decider) closes C1. Node 1 is fine with this, because of its role as the Follower (from [8:C1]).</dd>
<dt>[13]</dt><dd>Node 2 (the Decider) and Node 1 (the Follower) start data
transfer across C2, which makes it become a secure channel for the ACP.</dd>
      </dl>
        <t>All this negotiation is in the context of an L2 interface.  The Decider and Follower will build ACP connections to each other on every L2 interface that they both connect to.  An autonomic node <bcp14>MUST NOT</bcp14> assume that neighbors with the same L2 or link-local IPv6 addresses on different L2 interfaces are the same node.  This can only be determined after examining the certificate after a successful security association attempt.</t>

<t>The Decider <bcp14>SHOULD NOT</bcp14> suppress attempting a particular ACP secure channel protocol connection on one L2 interface because this type of ACP secure channel connection has failed to the peer with the same ACP certificate on another L2 interface: not only may the supported ACP secure channel protocol options be different on the same ACP peer across different L2 interfaces, but also error conditions may cause inconsistent failures across different L2 interfaces. Avoiding such connection attempt optimizations can therefore help to increase robustness in the case of errors.</t>

      </section>
      <section anchor="neighbor_verification" numbered="true" toc="default">
        <name>Candidate ACP Neighbor Verification</name>
        <t>Independent of the security association protocol chosen, candidate ACP neighbors need to be authenticated based on their domain certificate.  This implies that any secure channel protocol <bcp14>MUST</bcp14> support certificate-based authentication that can support the ACP domain membership check as defined in <xref target="certcheck" format="default"/>.  If it fails, the connection attempt is aborted and an error logged. Attempts to reconnect <bcp14>MUST</bcp14> be throttled. The <bcp14>RECOMMENDED</bcp14> default is exponential base-two backoff with an initial retransmission time (IRT) of 10 seconds and a maximum retransmission time (MRT) of 640 seconds.</t>
        <t>Failure to authenticate an ACP neighbor when acting in the role of a responder
of the security authentication protocol <bcp14>MUST NOT</bcp14> impact the attempts of the ACP node
to attempt establishing a connection as an initiator. Only failed connection attempts as
an initiator must cause throttling. This rule is meant to increase resilience
of secure channel creation. <xref target="channel-selection" format="default"/> shows how simultaneous mutual
secure channel setup collisions are resolved.</t>
      </section>
      <section anchor="associations" numbered="true" toc="default">
        <name>Security Association (Secure Channel) Protocols</name>
        <t>This section describes how ACP nodes establish secured data connections to automatically discovered or configured peers in the ACP. <xref target="discovery-grasp" format="default"/> describes how peers that are adjacent on an IPv6 subnet are discovered automatically. <xref target="remote-acp-neighbors" format="default"/> describes how to configure peers that are not adjacent on an IPv6 subnet.</t>
        <t><xref target="ACP-virtual-interfaces" format="default"/> describes how secure channels are mapped to virtual IPv6 subnet interfaces in the ACP. The simple case is to map every ACP secure channel to a separate ACP point-to-point virtual interface (<xref target="ACP-p2p-virtual-interfaces" format="default"/>). When a single subnet has multiple ACP peers, this results in multiple ACP point-to-point virtual interfaces across that underlying multiparty IPv6 subnet. This can be optimized with ACP multi-access virtual interfaces (<xref target="ACP-ma-virtual-interfaces" format="default"/>), but the benefits of that optimization may not justify the complexity of that option.</t>
        <section anchor="general-considerations" numbered="true" toc="default">
          <name>General Considerations</name>
          <t>Due to channel selection (<xref target="channel-selection" format="default"/>), ACP can support an evolving set of security association protocols and does not require support for a single network-wide MTI.  ACP nodes only need to implement those protocols required to interoperate with their candidate peers, not with potentially any node in the ACP domain. See <xref target="Profiles" format="default"/> for an example of this.</t>
          <t>The degree of security required on every hop of an ACP network needs to be consistent across the network so that there is no designated "weakest link" because it is that "weakest link" that would otherwise become the designated point of attack. When the secure channel protection on one link is compromised, it can be used to send and/or receive packets across the whole ACP network. Therefore, even though the security association protocols can be different, their minimum degree of security should be comparable.</t>
          <t>Secure channel protocols do not need to always support arbitrary Layer 3 (L3) connectivity between peers, but can leverage the fact that the standard use case for ACP secure channels is an L2 adjacency. Hence, L2 dependent mechanisms could be adopted for use as secure channel association protocols.</t>
          <t>L2 mechanisms such as strong encrypted radio technologies or <xref target="MACSEC" format="default"/> may offer equivalent encryption, and the ACP security association protocol may only be required to authenticate ACP domain membership of a peer and/or derive a key for the L2 mechanism. Mechanisms that leverage such underlying L2 security to auto-discover and associate ACP peers are possible and desirable to avoid duplication of encryption, but none are specified in this document.</t>
          <t>Strong physical security of a link may stand in where cryptographic security is infeasible. As there is no secure mechanism to automatically discover strong physical security solely between two peers, it can only be used with explicit configuration, and that configuration too could become an attack vector. This document therefore specifies with <xref target="ACPconnect" format="default">ACP connect</xref> only one explicitly configured mechanism without any secure channel association protocol for the case where both the link and the nodes attached to it have strong physical security.</t>
        </section>
        <section anchor="common-requirements" numbered="true" toc="default">
          <name>Common Requirements</name>
          <t>The authentication of peers in any security association protocol <bcp14>MUST</bcp14> use the ACP certificate according to <xref target="certcheck" format="default"/>.  Because auto-discovery of candidate ACP neighbors via GRASP (see <xref target="discovery-grasp" format="default"/>) as specified in this document does not communicate the neighbor's ACP certificate, and ACP nodes may not (yet) have any other network connectivity to retrieve certificates, any security association protocol <bcp14>MUST</bcp14> use a mechanism to communicate the certificate directly instead of relying on a referential mechanism such as communicating only a hash and/or URL for the certificate.</t>
          <t>A security association protocol <bcp14>MUST</bcp14> use Forward Secrecy (whether inherently or as part of a profile of the security association protocol). </t>
          <t>Because the ACP payload of legacy protocol payloads inside the ACP and hop-by-hop ACP flooded GRASP information is unencrypted, the ACP secure channel protocol requires confidentiality. Symmetric encryption for the transmission of secure channel data <bcp14>MUST</bcp14> use encryption schemes considered to be security wise equal to or better than 256-bit key strength, such as AES-256. There <bcp14>MUST NOT</bcp14> be support for NULL encryption. </t>
          <t>Security association protocols typically only signal the end entity certificate
(e.g., the ACP certificate) and any possible intermediate CA certificates
for successful mutual authentication.  The TA has to be mutually known and
trusted, and therefore its certificate does not need to be signaled for successful
mutual authentication. Nevertheless, for use with ACP secure channel setup,
there <bcp14>SHOULD</bcp14> be the option to include the TA certificate in the signaling 
to aid troubleshooting, see <xref target="ta-troubleshoot" format="default"/>.</t>
          <t>Signaling of TA certificates may not be appropriate when the deployment relies on
 a security model where the TA certificate content is considered confidential, and only its hash
is appropriate for signaling. ACP nodes <bcp14>SHOULD</bcp14> have a mechanism to select whether
the TA certificate is signaled or not, assuming that both options are possible with
a specific secure channel protocol.</t>
          <t>An ACP secure channel <bcp14>MUST</bcp14> immediately be terminated when the lifetime of any certificate in the chain used to authenticate the neighbor expires or becomes revoked.  This may not be standard behavior in secure channel protocols because the certificate authentication may only influence the setup of the secure channel in these protocols, but may not be revalidated during the lifetime of the secure connection in the absence of this requirement.</t>
          <t>When specifying an additional security association protocol for ACP secure channels beyond those covered in this document, any protocol options that are unnecessary for the support of devices that are expected to be able to support the ACP <bcp14>SHOULD</bcp14> be eliminated in order to minimize implementation complexity. For example, definitions for security protocols often include old and/or inferior security options required only to interoperate with existing devices that cannot update to the currently preferred security options. Such old and/or inferior security options do not need to be supported when a security association protocol is first specified for the ACP, thus strengthening the "weakest link" and simplifying ACP implementation overhead.</t>
        </section>
        <section anchor="IPsec-group" numbered="true" toc="default">
          <name>ACP via IPsec</name>
          <t>An ACP node announces its ability to support IPsec, negotiated via IKEv2, as the ACP secure channel protocol using the "IKEv2" 'objective-value' in the "AN_ACP" GRASP objective.</t>
          <t>The ACP usage of IPsec and IKEv2 mandates a profile with a narrow set of options of the current Standards Track usage guidance for IPsec ("<xref target="RFC8221" format="title"/>" <xref target="RFC8221" format="default"/>) and IKEv2 ("<xref target="RFC8247" format="title"/>" <xref target="RFC8247" format="default"/>).  These options result in stringent security properties and can exclude deprecated and legacy algorithms because there is no need for interoperability with legacy equipment for ACP secure channels.  Any such backward compatibility would lead only to an increased attack surface and implementation complexity, for no benefit.</t>
          <section anchor="IPsec" toc="include" numbered="true">
            <name>Native IPsec</name>
            <t> An ACP node that is supporting native IPsec
	    <bcp14>MUST</bcp14> use IPsec in tunnel mode, negotiated via
	    IKEv2, and with IPv6 payload (e.g., ESP Next Header of 41). It
	    <bcp14>MUST</bcp14> use local and peer link-local IPv6 addresses
	    for encapsulation.  Manual keying <bcp14>MUST NOT</bcp14> be used,
	    see <xref target="domcert" format="default"/>. Traffic Selectors
	    are:</t>
<artwork name="" type="" align="left" alt=""><![CDATA[
TSi = (0, 0-65535, :: - FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF)
TSr = (0, 0-65535, :: - FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF)
]]></artwork>
            <t>IPsec tunnel mode is required because the ACP will route and/or forward packets received from any other ACP node across the ACP secure channels, and not only its own generated ACP packets.  With IPsec transport mode (and no additional encapsulation header in the ESP payload), it would only be possible to send packets originated by the ACP node itself because the IPv6 addresses of the ESP must be the same as that of the outer IPv6 header.</t>
            <section anchor="rfc8221req" toc="include" numbered="true">
              <name>RFC 8221 (IPsec/ESP)</name>
              <t>ACP IPsec implementations <bcp14>MUST</bcp14> comply with <xref target="RFC8221" format="default"/> and any specifications that update it. The requirements from above and this section amend and supersede its requirements.</t>
              <t>The IP Authentication Header (AH) <bcp14>MUST NOT</bcp14> be used (because it does not provide confidentiality).</t>
              <t>For the required ESP encryption algorithms in <xref target="RFC8221" sectionFormat="of" section="5"/>, the following guidance applies:
</t>
              <ul spacing="normal">
                <li>ENCR_NULL AH <bcp14>MUST NOT</bcp14> be used (because it does not provide confidentiality).</li>
                <li>ENCR_AES_GCM_16 is the only MTI ESP encryption algorithm for ACP via IPsec/ESP (it is already listed as <bcp14>MUST</bcp14> in <xref target="RFC8221" format="default"/>).</li>
                <li>ENCR_AES_CBC with AUTH_HMAC_SHA2_256_128 (as the ESP authentication algorithm) and ENCR_AES_CCM_8 <bcp14>MAY</bcp14> be supported. If either provides higher performance than ENCR_AES_GCM_16, it <bcp14>SHOULD</bcp14> be supported.</li>
                <li>ENCR_CHACHA20_POLY1305 <bcp14>SHOULD</bcp14> be supported at equal or higher performance than ENCR_AES_GCM_16. If that performance is not feasible, it <bcp14>MAY</bcp14> be supported.</li>
              </ul>
              <t>IKEv2 indicates an order for the offered algorithms.  The algorithms <bcp14>SHOULD</bcp14> be ordered by performance.  The first algorithm supported by both sides is generally chosen.</t>
              <t> Explanations:
</t>
              <ul spacing="normal">
                <li>
      There is no requirement to interoperate with legacy equipment in ACP
      secure channels, so a single MTI encryption algorithm for IPsec in ACP
      secure channels is sufficient for interoperability and allows for
      the most lightweight implementations.
    </li>
                <li>
      ENCR_AES_GCM_16 is an Authenticated Encryption with Associated Data (AEAD) cipher
      mode, so no additional ESP authentication algorithm is needed, simplifying
      the MTI requirements of IPsec for the ACP.
    </li>
                <li>There is no MTI requirement for the support of ENCR_AES_CBC because
      ENCR_AES_GCM_16 is assumed to be feasible with less cost and/or higher
      performance in modern devices' hardware-accelerated implementations
      compared to ENCR-AES_CBC.
    </li>
                <li>
      ENCR_CHACHA20_POLY1305 is mandatory in <xref target="RFC8221" format="default"/> because
      of its target use as a fallback algorithm in case weaknesses in AES are
      uncovered. Unfortunately, there is currently no way to automatically
      propagate across an ACP a policy to disallow use of AES-based algorithms,
      so this target benefit of ENCR_CHACHA20_POLY1305 cannot fully be adopted
      yet for the ACP.  Therefore, this algorithm is only recommended. Changing 
      from AES to this algorithm with a potentially big drop in performance could
      also render the ACP inoperable. Therefore, there is a performance requirement against
      this algorithm so that it could become an effective security backup to AES
      for the ACP once a policy to switch over to it or prefer it is available in an ACP framework.
    </li>
              </ul>
              <t>
  <xref target="RFC8221" format="default"/> allows for 128-bit or 256-bit AES keys.
  This document mandates that only 256-bit AES keys <bcp14>MUST</bcp14> be supported.
</t>
              <t>
When <xref target="RFC8221" format="default"/> is updated, ACP implementations will need to
consider legacy interoperability.
</t>
            </section>
            <section anchor="rfc4247req" toc="include" numbered="true">
              <name>RFC 8247 (IKEv2)</name>
              <t>
<xref target="RFC8247" format="default"/> provides a baseline recommendation for mandatory-to-implement ciphers, integrity checks, pseudorandom functions, and Diffie-Hellman mechanisms.
Those recommendations, and the recommendations of subsequent documents, apply as well to the ACP.
Because IKEv2 for ACP secure channels is sufficient to be implemented in control plane software rather than in Application-Specific Integrated Circuit (ASIC) hardware, and ACP nodes supporting IKEv2 are not assumed to be code space constrained, and because existing IKEv2 implementations are expected to support <xref target="RFC8247" format="default"/> recommendations, this document makes no attempt to simplify its recommendations for use with the ACP.
</t>
              <t>See <xref target="IKEV2IANA" format="default"/> for IANA IKEv2 parameter names used in this text.</t>
              <t>
ACP nodes supporting IKEv2 <bcp14>MUST</bcp14> comply with <xref target="RFC8247" format="default"/> amended by the following requirements, which constitute a policy statement as permitted by <xref target="RFC8247" format="default"/>.
</t>
              <t>To signal the ACP certificate chain (including TA) as required by <xref target="common-requirements" format="default"/>, the "X.509 Certificate - Signature" payload in IKEv2 can be used. It is mandatory according to <xref target="RFC7296" sectionFormat="comma" section="3.6"/>.</t>
              <t>ACP nodes <bcp14>SHOULD</bcp14> set up IKEv2 to only use the ACP certificate and TA when acting as an IKEv2 responder on the IPv6 link-local address and port number indicated in the "AN_ACP" DULL GRASP announcements (see <xref target="discovery-grasp" format="default"/>).</t>
              <t>When CERTREQ is received from a peer, and it does not indicate any of this 
ACP node's TA certificates, the ACP node <bcp14>SHOULD</bcp14> ignore the CERTREQ and 
continue sending its certificate chain including its TA as subject to 
the requirements and explanations in <xref target="common-requirements" format="default"/>. This will not result in successful mutual authentication but assists diagnostics.</t>
              <t>Note that with IKEv2, failing authentication will only result in the responder
receiving the certificate chain from the initiator, but not vice versa. Because
ACP secure channel setup is symmetric (see <xref target="neighbor_verification" format="default"/>),
every non-malicious ACP neighbor will attempt to connect as an initiator, though,
allowing it to obtain the diagnostic information about the neighbor's certificate.</t>

              <t>In IKEv2, ACP nodes are identified by their ACP addresses.
The ID_IPv6_ADDR IKEv2 identification payload <bcp14>MUST</bcp14> be used and <bcp14>MUST</bcp14> convey the ACP address.
If the peer's ACP certificate includes a 32HEXDIG ACP address in the acp-node-name (not "0" or omitted), the address in the IKEv2 identification payload <bcp14>MUST</bcp14> match it.
See <xref target="certcheck" format="default"/> for more information about "0" or omitted ACP address fields in the acp-node-name.
</t>
              <t>
IKEv2 authentication <bcp14>MUST</bcp14> use authentication method 14 ("Digital Signature") for ACP certificates; this authentication method can be used with both RSA and ECDSA certificates, indicated by an ASN.1 object AlgorithmIdentifier.
</t>
              <t>The Digital Signature hash SHA2-512 <bcp14>MUST</bcp14> be supported (in addition to SHA2-256).</t>
              <t>
The IKEv2 Diffie-Hellman key exchange group 19 (256-bit random ECP), <bcp14>MUST</bcp14> be supported.  Reason: ECC provides a similar security level to finite-field (modular exponentiation (MODP)) key exchange with a shorter key length, so is generally preferred absent other considerations.
</t>
            </section>
          </section>
          <section anchor="IPsec-GRE" toc="include" numbered="true">
            <name>IPsec with GRE Encapsulation</name>
            <t>In network devices, it is often more common to implement high-performance virtual interfaces on top of GRE encapsulation than on top of a "native" IPsec association (without any other encapsulation than those defined by IPsec).  On those devices, it may be beneficial to run the ACP secure channel on top of GRE protected by the IPsec association.</t>
            <t>The requirements for ESP/IPsec/IKEv2 with GRE are the same as
	    for native IPsec (see <xref target="IPsec" format="default"/>)
	    except that IPsec transport mode and next protocol GRE (47) are to
	    be negotiated. Tunnel mode is not required because of GRE. Traffic
	    Selectors are:</t>
<artwork name="" type="" align="left" alt=""><![CDATA[
TSi = (47, 0-65535, Initiator-IPv6-LL-addr ... Initiator-IPv6-LL-addr)
TSr = (47, 0-65535, Responder-IPv6-LL-addr ... Responder-IPv6-LL-addr)
]]></artwork>
            <t>If the IKEv2 initiator and responder support IPsec over GRE, it will be preferred over native IPsec because of how IKEv2 negotiates transport mode (as used by this IPsec over GRE profile) versus tunnel mode as used by native IPsec (see <xref target="RFC7296" sectionFormat="of" section="1.3.1"/>).  The ACP IPv6 traffic has to be carried across GRE according to "<xref target="RFC7676" format="title"/>" <xref target="RFC7676" format="default"/>.</t>
          </section>
        </section>
        <section anchor="DTLS" numbered="true" toc="default">
          <name>ACP via DTLS</name>

          <t>This document defines the use of ACP via DTLS on the assumption that it is likely the first transport encryption supported in some classes of constrained devices: DTLS is commonly used in constrained devices when IPsec is not. Code space on those devices may be also be too limited to support more than the minimum number of required protocols.</t>

          <t>An ACP node announces its ability to support DTLS version 1.2 ("<xref target="RFC6347" format="title"/>" <xref target="RFC6347" format="default"/>) compliant with the requirements defined in this document as an ACP secure channel protocol in GRASP through the "DTLS" 'objective-value' in the "AN_ACP" objective (see <xref target="discovery-grasp" format="default"/>).</t>

          <t>To run ACP via UDP and DTLS, a locally assigned UDP port is used that is announced as a parameter in the GRASP "AN_ACP" objective to candidate neighbors.  This port can also be any newer version of DTLS as long as that version can negotiate a DTLS 1.2 connection in the presence of a peer that only supports DTLS 1.2.</t>

          <t>All ACP nodes supporting DTLS as a secure channel protocol <bcp14>MUST</bcp14> adhere to the DTLS implementation recommendations and security considerations of <xref target="RFC7525" format="default">BCP 195</xref> except with respect to the DTLS version. ACP nodes supporting DTLS <bcp14>MUST</bcp14> support DTLS 1.2. They <bcp14>MUST NOT</bcp14> support older versions of DTLS.</t>

          <t>Unlike for IPsec, no attempts are made to simplify the requirements of the recommendations in <xref target="RFC7525" format="default">BCP 195</xref> because the expectation is that DTLS would use software-only implementations where the ability to reuse widely adopted implementations is more important than the ability to minimize the complexity of a hardware-accelerated implementation, which is known to be important for IPsec.</t>

          <t>DTLS 1.3 <xref target="I-D.ietf-tls-dtls13" format="default"/> is "backward compatible" with
DTLS 1.2 (see <xref target="I-D.ietf-tls-dtls13" sectionFormat="of" section="1"/>).  A DTLS implementation supporting both
DTLS 1.2 and DTLS 1.3 does comply with the above requirements of negotiating to
DTLS 1.2 in the presence of a DTLS 1.2 only peer, but using DTLS 1.3 when
booth peers support it.</t>

          <t>Version 1.2 is the MTI version of DTLS in this specification because of the following:
</t>
          <ul spacing="normal">
            <li>There is more experience with DTLS 1.2 across the spectrum of target ACP nodes.</li>
            <li>Firmware of lower-end, embedded ACP nodes may not support a newer version for a long time.</li>
            <li>There are significant changes with DTLS 1.3, such as a different record layer requiring time to gain implementation and deployment experience especially on lower-end devices with limited code space.</li>
            <li>The existing BCP <xref target="RFC7525" format="default"/> for DTLS 1.2 may take an equally longer time to be updated with experience from a newer DTLS version.</li>
            <li> There are no significant benefits of DTLS 1.3 over DTLS 1.2 that are use-case relevant in the
      context of the ACP options for DTLS. For example, signaling performance improvements for session setup in
      DTLS 1.3 is not important for the ACP given the long-lived nature of ACP secure channel connections and
      the fact that DTLS connections are mostly link local (short RTT).</li>
          </ul>
          <t>Nevertheless, newer versions of DTLS, such as DTLS 1.3, have stricter security requirements, and the use of the latest standard protocol version is in general recommended for IETF security standards. Therefore, ACP implementations are advised to support all the newer versions of DTLS that can still negotiate down to DTLS 1.2.</t>
          <t>There is no additional session setup or other security association besides this simple DTLS setup.  As soon as the DTLS session is functional, the ACP peers will exchange ACP IPv6 packets as the payload of the DTLS transport connection.  Any DTLS-defined security association mechanisms such as rekeying are used as they would be for any transport application relying solely on DTLS.</t>
        </section>
        <section anchor="Profiles" numbered="true" toc="default">
          <name>ACP Secure Channel Profiles</name>
          <t>As explained in the beginning of <xref target="channel-selection" format="default"/>, there is no single secure channel mechanism mandated for all ACP nodes. Instead, this section defines two ACP profiles, "baseline" and "constrained", for ACP nodes that do introduce such requirements.</t>
          <t>An ACP node supporting the baseline profile <bcp14>MUST</bcp14> support IPsec natively and <bcp14>MAY</bcp14> support IPsec via GRE. An ACP node supporting the constrained profile that cannot support IPsec <bcp14>MUST</bcp14> support DTLS.  An ACP node connecting an area of constrained ACP nodes with an area of baseline ACP nodes needs to support both IPsec and DTLS and therefore supports both the baseline and constrained profiles.</t>
          <t>Explanation: not all types of ACP nodes are able to or need to connect directly to each other, nor are they able to support or prefer all possible secure channel mechanisms.  For example, IoT devices with limited code space may only support DTLS because that code already exists on them for end-to-end security, but high-end core routers may not want to support DTLS because they can perform IPsec in accelerated hardware, but they would need to support DTLS in an underpowered CPU forwarding path shared with critical control plane operations. This is not a deployment issue for a single ACP across these types of nodes as long as there are also appropriate gateway ACP nodes that sufficiently support many secure channel mechanisms to allow interconnecting areas of ACP nodes with a more constrained set of secure channel protocols. On the edge between IoT areas and high-end core networks, general-purpose routers that act as those gateways and that can support a variety of secure channel protocols are the norm already.</t>
          <t>Native IPsec with tunnel mode provides the shortest encapsulation overhead. GRE may be preferred by legacy implementations because, in the past, the virtual interfaces required by ACP design in conjunction with secure channels have been implemented more often for GRE than purely for native IPsec.</t>
          <t>ACP nodes need to specify the set of secure ACP mechanisms they support in documentation and should declare which profile they support according to the above requirements.</t>
        </section>
      </section>
      <section anchor="GRASP" numbered="true" toc="default">
        <name>GRASP in the ACP</name>
        <section anchor="GRASP-core" numbered="true" toc="default">
          <name>GRASP as a Core Service of the ACP</name>
          <t>The ACP <bcp14>MUST</bcp14> run an instance of GRASP inside of it.  It is a key part of the
        ACP services.  The function in GRASP that makes it fundamental as a service of the ACP
        is the ability to provide ACP-wide service discovery (using objectives in GRASP).</t>
          <t>ACP provides IP unicast routing via RPL (see <xref target="routing" format="default"/>).</t>
          <t>The ACP does not use IP multicast routing nor does it provide generic IP multicast services
        (the handling of GRASP link-local multicast messages is explained in <xref target="GRASP-substrate" format="default"/>).
        Instead, the ACP provides service discovery via the objective discovery/announcement and
        negotiation mechanisms of the ACP GRASP instance (services are a form of objectives).
        These mechanisms use hop-by-hop reliable flooding of GRASP messages for both service discovery
        (GRASP M_DISCOVERY messages) and service announcement (GRASP M_FLOOD messages).</t>
          <t>See <xref target="acp-grasp" format="default"/> for discussion about this design choice
        of the ACP.</t>
        </section>
        <section anchor="GRASP-substrate" numbered="true" toc="default">
          <name>ACP as the Security and Transport Substrate for GRASP</name>
          <t>In the terminology of GRASP <xref target="RFC8990" format="default"/>, the ACP is the
        security and transport substrate for the GRASP instance run inside the ACP ("ACP GRASP").</t>
          <t>This means that the ACP is responsible for ensuring that this instance of GRASP is
        only sending messages across the ACP GRASP virtual interfaces.
        Whenever the ACP adds or deletes such an interface because of new ACP secure channels or
        loss thereof, the ACP needs to indicate this to the ACP instance of GRASP.  The ACP exists
        also in the absence of any active ACP neighbors.  It is created when the node has a domain
        certificate, and it continues to exist even if all of its neighbors cease operation.</t>
          <t>In this case, ASAs using GRASP running on the same node still need 
        to be able to discover each other's objectives.  When the ACP does not exist, ASAs leveraging 
        the ACP instance of GRASP via APIs <bcp14>MUST</bcp14> still be able to operate, and they <bcp14>MUST</bcp14> be able to
        understand that there is no ACP and that therefore the ACP instance of GRASP cannot
        operate.</t>
          <t>How the ACP acts as the security and transport substrate for GRASP is shown 
        in <xref target="acp-grasp-picture" format="default"/>.</t>
          <t>GRASP unicast messages inside the ACP always use the ACP address.  Link-local
        addresses from the ACP VRF <bcp14>MUST NOT</bcp14> be used inside objectives.  GRASP unicast messages inside the ACP
        are transported via TLS. See <xref target="tls" format="default"/> for TLS requirements.
        TLS mutual authentication <bcp14>MUST</bcp14> use the ACP domain membership check 
        defined in <xref target="certcheck" format="default"/>.</t>

          <t>GRASP link-local multicast messages are targeted for a specific ACP virtual interface 
        (as defined <xref target="ACP_interfaces" format="default"/>), but they are sent by the ACP to 
        an ACP GRASP virtual interface that is constructed from the TCP
        connection(s) to the IPv6 link-local neighbor address(es) on the underlying
        ACP virtual interface.  If the ACP GRASP virtual interface has two or more neighbors,
        the GRASP link-local multicast messages are replicated to all neighbor TCP connections.</t>

          <t>TCP and TLS connections for GRASP in the ACP use the IANA-assigned TCP port for GRASP (7017).
        Effectively, the transport stack is expected to be TLS for connections to and from the ACP
        address (e.g., global-scope address(es)) and TCP for connections to and from the link-local addresses
        on the ACP virtual interfaces.  The latter ones are only used for the flooding of GRASP
        messages.</t>
          <figure anchor="acp-grasp-picture">
            <name>ACP as Security and Transport Substrate for GRASP</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    ..............................ACP..............................
    .                                                             .
    .         /-GRASP-flooding-\         ACP GRASP instance       .
    .        /                  \                                 A
    .    GRASP      GRASP      GRASP                              C
    .  link-local   unicast  link-local                           P
    .   multicast  messages   multicast                           .
    .   messages      |       messages                            .
    .      |          |          |                                .
    ...............................................................
    .      v          v          v    ACP security and transport  .
    .      |          |          |    substrate for GRASP         .
    .      |          |          |                                .
    .      |       ACP GRASP     |       - ACP GRASP              A
    .      |       loopback      |         loopback interface     C
    .      |       interface     |       - ACP-cert auth          P
    .      |         TLS         |                                .
    .   ACP GRASP     |       ACP GRASP  - ACP GRASP virtual      .
    .   subnet1       |       subnet2      interfaces             .
    .     TCP         |         TCP                               .
    .      |          |          |                                .
    ...............................................................
    .      |          |          |   ^^^ Users of ACP (GRASP/ASA) .
    .      |          |          |   ACP interfaces/addressing    .
    .      |          |          |                                .
    .      |          |          |                                A
    .      | ACP loopback interf.|      <- ACP loopback interface C
    .      |      ACP-address    |       - address (global ULA)   P
    .    subnet1      |        subnet2  <- ACP virtual interfaces .
    .  link-local     |      link-local  - link-local addresses   .
    ...............................................................
    .      |          |          |   ACP VRF                      .
    .      |     RPL-routing     | virtual routing and forwarding .
    .      |   /IP-Forwarding\   |                                A
    .      |  /               \  |                                C
    .  ACP IPv6 packets   ACP IPv6 packets                        P
    .      |/                   \|                                .
    .    IPsec/DTLS        IPsec/DTLS  - ACP-cert auth            .
    ...............................................................
             |                   |   Data Plane
             |                   |     
             |                   |     - ACP secure channel
         link-local        link-local  - encapsulation addresses
           subnet1            subnet2  - data plane interfaces
             |                   |
          ACP-Nbr1            ACP-Nbr2
]]></artwork>
          </figure>
          <section anchor="GRASP-discussion" numbered="true" toc="default">
            <name>Discussion</name>
            <t>TCP encapsulation for GRASP M_DISCOVERY and M_FLOOD link-local messages is used because 
            these messages are flooded across potentially many hops to all ACP nodes, and a single
            link with even temporary packet-loss issues (e.g., a Wi-Fi or Powerline link) can reduce the
            probability for loss-free transmission so much that applications would want to increase
            the frequency with which they send these messages.  Such shorter periodic retransmission
            of datagrams would result in more traffic and processing overhead in the ACP 
            than the hop-by-hop, reliable retransmission mechanism offered by TCP and duplicate elimination
            by GRASP.</t>
            <t>TLS is mandated for GRASP non-link-local unicast because the ACP secure channel
            mandatory authentication and encryption protects only against attacks from the outside
            but not against attacks from the inside: compromised ACP members that have (not yet) been
            detected and removed (e.g., via domain certificate revocation and/or expiry).</t>
            <t>If GRASP peer connections were to use just TCP, compromised ACP members could
            simply eavesdrop passively on GRASP peer connections for which they are on-path ("man in the
            middle" or MITM) or intercept and modify messages.  With TLS, it is not possible to completely
            eliminate problems with compromised ACP members, but attacks are a lot more complex.</t>
            <t>Eavesdropping and/or spoofing by a compromised ACP node is still possible because
            in the model of the ACP and GRASP, the provider and consumer of an objective have 
            initially no unique information (such as an identity) about the other side that
            would allow them to distinguish a benevolent from a compromised peer.  The compromised
            ACP node would simply announce the objective as well, potentially filter the original
            objective in GRASP when it is a MITM and act as an application-level proxy.  This of course
            requires that the compromised ACP node understand the semantics of the GRASP negotiation
            to an extent that allows the compromised node to proxy the messages without being detected, but in an ACP environment,
            this is quite likely public knowledge or even standardized.</t>
            <t>The GRASP TLS connections are run the same as any other ACP traffic through the ACP
            secure channels.  This leads to double authentication and encryption, which has the following
            benefits:</t>
            <ul spacing="normal">
              <li>Secure channel methods such as IPsec may provide protection against additional
                attacks, for example, reset attacks.</li>
              <li>The secure channel method may leverage hardware acceleration, and there may be little
                or no gain in eliminating it.</li>
              <li>The security model for ACP GRASP is no different than other ACP traffic. Instead,
                there is just another layer of protection against certain attacks from the inside,
                which is important due to the role of GRASP in the ACP.</li>
            </ul>
          </section>
        </section>
      </section>
      <section anchor="separation" numbered="true" toc="default">
        <name>Context Separation</name>
        <t>The ACP is in a separate context from the normal data plane of the node.  This context includes the ACP channels' IPv6 forwarding and routing as well as any required higher-layer ACP functions.</t>
        <t>In a classical network system, a dedicated VRF is one logical implementation option for the ACP.  If allowed by the system's software architecture, separation options that minimize shared components, such as a logical container or virtual machine instance, are preferred.  The context for the ACP needs to be established automatically during the bootstrap of a node.  As much as possible, it should be protected from being modified unintentionally by (data plane) configuration.</t>
        <t>Context separation improves security because the ACP is not reachable from the data plane routing or forwarding table(s).  Also, configuration errors from the data plane setup do not affect the ACP.</t>
      </section>
      <section anchor="addressing" numbered="true" toc="default">
        <name>Addressing inside the ACP</name>
        <t>The channels explained above typically only establish communication between two adjacent nodes.  In order for communication to happen across multiple hops, the Autonomic Control Plane requires ACP network-wide valid addresses and routing.  Each ACP node creates a loopback interface with an ACP network-wide unique address (prefix) inside the ACP context (as explained in <xref target="separation" format="default"/>).  This address may be used also in other virtual contexts.</t>
        <t>With the algorithm introduced here, all ACP nodes in the same routing subdomain have the same /48 ULA prefix.  Conversely, ULA Global IDs from different domains are unlikely to clash, such that two ACP networks can be merged, as long as the policy allows that merge.  See also <xref target="self-healing" format="default"/> for a discussion on merging domains.</t>
        <t>Links inside the ACP only use link-local IPv6 addressing, such that each node's ACP only requires one routable address prefix.</t>
        <section anchor="addr-fundamentals" numbered="true" toc="default">
          <name>Fundamental Concepts of Autonomic Addressing</name>
          <ul spacing="normal">
            <li>Usage: autonomic addresses are exclusively used for self-management functions inside a trusted domain.  They are not used for user traffic.  Communications with entities outside the trusted domain use another address space, for example, a normally managed routable address space (called "data plane" in this document).</li>
            <li>Separation: autonomic address space is used separately from user address space and other address realms.  This supports the robustness requirement.</li>
            <li>Loopback only: only ACP loopback interfaces (and potentially those configured for ACP connect, see <xref target="ACPconnect" format="default"/>) carry routable address(es); all other interfaces (called ACP virtual interfaces) only use IPv6 link-local addresses.  The usage of IPv6 link-local addressing is discussed in "<xref target="RFC7404" format="title"/>" <xref target="RFC7404" format="default"/>.</li>
            <li>Use of ULA: for loopback interfaces of ACP nodes, we use ULA with
	   the L bit set to 1 (as defined in <xref target="RFC4193" sectionFormat="of" section="3.1"/>). Note that the random hash for ACP loopback addresses uses the definition in <xref target="scheme" format="default"/> and not the one in <xref target="RFC4193" sectionFormat="comma" section="3.2.2"/>.</li>
            <li>No external connectivity: the addresses do not provide access to the Internet.  If a node requires further connectivity, it should use another, traditionally managed addressing scheme in parallel.</li>
            <li>Addresses in the ACP are permanent and do not support temporary addresses as defined in "<xref target="RFC8981" format="title"/>" <xref target="RFC8981" format="default"/>.</li>
            <li>Addresses in the ACP are not considered sensitive on privacy grounds because ACP nodes are not expected to be end-user hosts, and therefore ACP addresses do not represent end users or groups of end users.  All ACP nodes are in one (potentially federated) administrative domain. For ACP traffic, the nodes are assumed to be either candidate hosts or transit nodes.  There are no transit nodes with fewer privileges to know the identity of other hosts in the ACP.  Therefore, ACP addresses do not need to be pseudorandom as discussed in "<xref target="RFC7721" format="title"/>" <xref target="RFC7721" format="default"/>.  Because they are not propagated to untrusted (non-ACP) nodes and stay within a domain (of trust), we also do not consider them to be subject to scanning attacks.</li>
          </ul>
          <t>The ACP is based exclusively on IPv6 addressing for a variety of reasons:
                                        </t>
          <ul spacing="normal">
            <li>Simplicity, reliability, and scale: if other network-layer protocols were supported, each would have to have its own set of security associations, routing table, and process, etc.</li>
            <li>Autonomic functions do not require IPv4: autonomic functions and autonomic service agents are new concepts.  They can be exclusively built on IPv6 from day one.  There is no need for backward compatibility.</li>
            <li>OAM protocols do not require IPv4: the ACP may carry OAM protocols.  All relevant protocols (SNMP, TFTP, SSH, SCP, RADIUS, Diameter, NETCONF, etc.) are available in IPv6. See also <xref target="RFC8368" format="default"/> for how ACP could be made to interoperate with IPv4-only OAM.</li>
          </ul>
          <t>Further explanation about the addressing and routing-related reasons for the choice of the autonomous ACP addressing can be found in <xref target="ACP-loopback" format="default"/>.</t>
        </section>
        <section anchor="scheme" numbered="true" toc="default">
          <name>The ACP Addressing Base Scheme</name>
          <t>The ULA addressing base scheme for ACP nodes has the following format:</t>
          <figure anchor="base-addr-scheme">
            <name>ACP Addressing Base Scheme</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
  8      40                     2                     78
+--+-------------------------+------+------------------------------+
|fd| hash(routing-subdomain) | Type |     (sub-scheme)             |
+--+-------------------------+------+------------------------------+
]]></artwork>
          </figure>
          <t>The first 48 bits follow the ULA scheme as defined in <xref target="RFC4193" format="default"/>, to which a Type field is added.
        </t>
<dl spacing="normal" newline="false">
            <dt>fd:</dt> <dd>Identifies a locally defined ULA address.</dd>
            <dt>hash(routing-subdomain):</dt><dd><t>The 40-bit ULA Global ID (a term from <xref target="RFC4193" format="default"/>) for ACP addresses carried in the acp-node-name in the ACP certificates are the first 40 bits of the SHA-256 hash of the routing-subdomain from the same acp-node-name.  In the example of <xref target="domcert-acpinfo" format="default"/>, the routing-subdomain is "area51.research.acp.example.com", and the 40-bit ULA Global ID is 89b714f3db.</t>
            <t>When creating a new routing-subdomain for an existing Autonomic Network, it <bcp14>MUST</bcp14> be ensured that rsub is selected so the resulting hash of the routing-subdomain does not collide with the hash of any preexisting routing-subdomains of the Autonomic Network. This ensures that ACP addresses created by registrars for different routing subdomains do not collide with each other.</t>
            <t>To allow for extensibility, the fact that the ULA Global ID is a hash of the routing-subdomain <bcp14>SHOULD NOT</bcp14> be assumed by any ACP node during normal operations.  The hash function is only executed during the creation of the certificate.  If BRSKI is used, then the BRSKI registrar will create the acp-node-name in response to the EST Certificate Signing Request (CSR) Attributes Request message sent by the pledge.</t>
            <t>Establishing connectivity between different ACPs (different acp-domain-names) is outside the scope of this specification.
 If it is being done through future extensions, then the rsub of all routing-subdomains across those Autonomic Networks needs to be selected so that the resulting routing-subdomain hashes do not collide. For example, a large cooperation with its own private TA may want to create different Autonomic Networks that initially do not connect but where the option to do so should be kept open. When taking this possibility into account, it is always easy to select rsub so that no collisions happen.</t>
</dd>
          <dt>Type:</dt> <dd>This field allows different addressing sub-schemes.  This addresses the "upgradability" requirement.  Assignment of types for this field will be maintained by IANA.</dd>
          <dt>(sub-scheme):</dt> <dd>The sub-scheme may imply a range or set of addresses assigned to the node. This is called the ACP address range/set and explained in each sub-scheme.</dd>
          </dl>
          <t>Please refer to <xref target="acp-registrars" format="default"/> and <xref target="address-spaces" format="default"/> for further explanations for why the following addressing sub-schemes are used and why multiple are necessary.</t>
          <t>
          The following summarizes the addressing sub-schemes:
</t>

<table anchor="tab-1">
  <name>Addressing Sub-Schemes</name> 
  <thead>
    <tr>
      <th>Type</th>   
      <th>Name</th>   
      <th>F-bit</th>   
      <th>Z</th>
      <th>V-bits</th>
      <th>Prefix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>ACP-Zone</td>
      <td>N/A</td>
      <td>0</td>
      <td>1 bit</td>
      <td>/127</td>
    </tr>
    <tr>
      <td>0</td>
      <td>ACP-Manual</td>
      <td>N/A</td>
      <td>1</td>
      <td>N/A</td>
      <td>/64</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ACP-Vlong-8</td>
      <td>0</td>
      <td>N/A</td>
      <td>8 bits</td>
      <td>/120</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ACP-Vlong-16</td>
      <td>1</td>
      <td>N/A</td>
      <td>16 bits</td>
      <td>/112</td>
    </tr>
    <tr>
      <td>2</td>
      <td colspan="5">Reserved / For future definition/allocation</td>
    </tr>
    <tr>
      <td>3</td>
      <td colspan="5">Reserved / For future definition/allocation</td>
    </tr>
  </tbody>
</table>
<t>The F-bit (format bit, <xref target="Vlong" format="default"/>) and Z (<xref target="manual-scheme" format="default"/>) are two encoding fields that are explained in the sections covering 
the sub-schemes that use them. V-bits is the number
of bits of addresses allocated to the ACP node.
Prefix is the prefix that the ACP node is announcing into
RPL.</t>
        </section>
        <section anchor="zone-scheme" numbered="true" toc="default">
          <name>ACP Zone Addressing Sub-Scheme (ACP-Zone)</name>
          <t>This sub-scheme is used when the Type field of the base scheme is 0 and the Z bit is 0.</t>
          <figure anchor="addr-scheme">
            <name>ACP Zone Addressing Sub-Scheme</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[

                 64                             64
+-----------------+---+---------++-----------------------------+---+
|  (base scheme)  | Z | Zone-ID ||           Node-ID               |
|                 |   |         || Registrar-ID |   Node-Number| V |
+-----------------+---+---------++--------------+--------------+---+
         50         1     13            48           15          1

]]></artwork>
          </figure>
          <t>The fields are defined as follows:</t>
          <dl spacing="normal" newline="false">
            <dt>Type:</dt><dd> <bcp14>MUST</bcp14> be 0.</dd>
            <dt>Z: </dt><dd> <bcp14>MUST</bcp14> be 0.</dd>
            <dt>Zone-ID:</dt><dd> A value for a network zone.</dd>
            <dt>Node-ID:</dt>
               <dd> 
                <t>A unique value for each node.</t>
                <t>The 64-bit Node-ID must be unique across the ACP domain for each node. It is derived and composed as follows:</t>
                <dl spacing="normal" newline="false">
                <dt>Registrar-ID (48 bits): </dt><dd>A number unique inside the domain identifying the ACP registrar that assigned the Node-ID to the node.  One or more domain-wide unique identifiers of the ACP registrar can be used for this purpose. See <xref target="registrars-unique" format="default"/>.</dd>
                <dt>Node-Number:</dt><dd> A number to make the Node-ID unique.  This can be sequentially assigned by the ACP registrar owning the Registrar-ID.</dd>
                </dl>
              </dd>
            <dt>V (1 bit):</dt>
               <dd>
                <t>Virtualization bit:</t> 
                <dl spacing="normal" newline="false">
                <dt>0:</dt><dd>Indicates the ACP itself ("ACP node base system)</dd> 
                <dt>1:</dt><dd>Indicates the optional "host" context on the ACP node (see below).</dd>
                </dl>
              </dd>
          </dl>
          <t>In the Zone Addressing Sub-Scheme, the ACP address in the certificate has V field as all zero bits.</t>
          <t>The ACP address set of the node includes addresses with any Zone-ID value and any V value. Therefore, no two nodes in the same ACP and the same hash(routing-subdomain)
  can have the same Node-ID with the Zone Addressing Sub-Scheme, for
  example, by differing only in their Zone-ID.</t>
          <t>The Virtualization bit in this sub-scheme allows the easy addition of the ACP as a component to existing systems without causing problems in the port number space between the services in the ACP and the existing system.  V=0 is the ACP router (autonomic node base system), V=1 is the host with preexisting transport endpoints on it that could collide with the transport endpoints used by the ACP router.  The ACP host could, for example, have a P2P (peer-to-peer) virtual interface with the V=0 address as its router to the ACP.  Depending on the software design of ASAs, which is outside the scope of this specification, they may use the V=0 or V=1 address.</t>
          <t>The location of the V bit(s) at the end of the address allows the announcement of a single prefix for each ACP node.  For example, in a network with 20,000 ACP nodes, this avoids 20,000 additional routes in the routing table.</t>
          <t>It is <bcp14>RECOMMENDED</bcp14> that only Zone-ID 0 is used unless it is meant to be
                used in conjunction with operational practices for partial or incremental adoption
                of the ACP as described in <xref target="incremental-adoption" format="default"/>.</t>
          <t>Note: Zones and Zone-ID as defined here are not related to zones or zone_id defined in "<xref target="RFC4007" format="title"/>" <xref target="RFC4007" format="default"/>. ACP zone addresses are not scoped (i.e., reachable only from within a zone as defined by <xref target="RFC4007" format="default"/>) but are reachable across the whole ACP. A zone_id is a zone index that has only local significance on a node <xref target="RFC4007" format="default"/>, whereas an ACP Zone-ID is an identifier for an ACP zone that is unique across that ACP.</t>
        </section>
        <section anchor="manual-scheme" numbered="true" toc="default">
          <name>ACP Manual Addressing Sub-Scheme (ACP-Manual)</name>
          <t>This sub-scheme is used when the Type field of the base scheme is 0 and the Z bit is 1.</t>
          <figure anchor="manual-scheme-pic">
            <name>ACP Manual Addressing Sub-Scheme</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[

                64                             64
+---------------------+---+----------++-----------------------------+
|    (base scheme)    | Z | Subnet-ID||     Interface Identifier    |
+---------------------+---+----------++-----------------------------+
         50             1    13 

]]></artwork>
          </figure>
          <t>The fields are defined as follows:
                </t>
          <dl spacing="normal" newline="false">
            <dt>Type:</dt><dd> <bcp14>MUST</bcp14> be 0.</dd>
            <dt>Z:</dt><dd> <bcp14>MUST</bcp14> be 1.</dd>
            <dt>Subnet-ID:</dt><dd> Configured subnet identifier.</dd>
            <dt>Interface Identifier:</dt><dd>Interface identifier according to <xref target="RFC4291" format="default"/>.</dd>
          </dl>
          <t>This sub-scheme is meant for the "manual" allocation to subnets where the other addressing schemes cannot be used.  The primary use case is for assignment to ACP connect subnets (see <xref target="NMS" format="default"/>).</t>
          <t>"Manual" means that allocations of the Subnet-ID need to be done with preexisting, non-autonomic mechanisms.  Every subnet that uses this addressing sub-scheme needs to use a unique Subnet-ID (unless some anycast setup is done).</t>
          <t>The Z bit field was added to distinguish between the Zone Addressing Sub-Scheme and the Manual Addressing Sub-Scheme without requiring one more bit in the base scheme and therefore allowing for the Vlong Addressing Sub-Scheme (described in <xref target="Vlong" format="default"/>) to have one more bit available.</t>
          <t>The Manual Addressing Sub-Scheme addresses <bcp14>SHOULD NOT</bcp14> be used in ACP certificates. Any node capable of building ACP secure channels and is permitted by registrar policy to participate in building ACP secure channels <bcp14>SHOULD</bcp14> receive an ACP address (prefix) from one of the other ACP addressing sub-schemes.  A node that cannot or is not permitted to participate in ACP secure channels can connect to the ACP via ACP connect interfaces of ACP edge nodes (see <xref target="ACPconnect" format="default"/>) without setting up an ACP secure channel. Its ACP certificate <bcp14>MUST</bcp14> omit the acp-address field to indicate that its ACP certificate is only usable for non-ACP secure channel authentication, such as end-to-end transport connections across the ACP or data plane.</t>
          <t>Address management of ACP connect subnets is done using traditional assignment methods and existing IPv6 protocols. See <xref target="ACautoconfig" format="default"/> for details. Therefore, the notion of /V-bits multiple addresses assigned to the ACP nodes does not apply to this sub-scheme.</t>
        </section>
        <section anchor="Vlong" numbered="true" toc="default">
          <name>ACP Vlong Addressing Sub-Scheme (ACP-Vlong-8/ACP-Vlong-16)</name>
          <t>This addressing sub-scheme is used when the Type field of the base scheme is 1.</t>
          <figure anchor="v8-scheme">
            <name>ACP Vlong Addressing Sub-Scheme</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[

          50                              78
+---------------------++-----------------------------+----------+
|    (base scheme)    ||           Node-ID                      |
|                     || Registrar-ID |F| Node-Number|        V |
+---------------------++--------------+--------------+----------+
          50                46         1   23/15          8/16
]]></artwork>
          </figure>
          <t>
                  This addressing sub-scheme foregoes the Zone-ID field (<xref target="zone-scheme" format="default"/>) to allow
                  for larger, flatter routed networks (e.g., as in IoT) with
                  8,421,376 Node-Numbers (2<sup>23</sup> + 2<sup>15</sup>).  It also allows for up to
                  2<sup>16</sup> (i.e., 65,536) different virtualized addresses within a
                  node, which could be used to address individual software
                components in an ACP node.
                </t>
          <t>
                The fields are the same as in the Zone Addressing Sub-Scheme (<xref target="zone-scheme" format="default"/>) with the
                following refinements:</t>
          <dl spacing="normal" newline="false">
            <dt>
                    F:</dt><dd>Format bit.  This bit determines the format of the
                    subsequent bits.
                  </dd>
            <dt>
                    V:</dt><dd>Virtualization bit: this is a field that is
                    either 8 or 16 bits.  For F=0, it is 8 bits, for F=1
                    it is 16 bits.  The V-bits are assigned by the ACP
                    node.  In the ACP certificate's ACP address (<xref target="domcert-acpinfo" format="default"/>), the V-bits are always
                    set to 0.
                  </dd>
            <dt>
                    Registrar-ID:</dt><dd> To maximize Node-Number and V, the
                    Registrar-ID is reduced to 46 bits. One or more domain-wide unique identifiers of the ACP registrar can be used for this purpose. See <xref target="registrars-unique" format="default"/>.
                  </dd>
            <dt>
                    Node-Number:</dt><dd>The Node-Number is unique to each ACP node.  There are
                    two formats for the Node-Number.   When F=0, the
                    Node-Number is 23 bits,  for F=1, it is 15 bits.
                    Each format of Node-Number is considered to be in a
                    unique number space.
                  </dd>
          </dl>
          <t>
                  The F=0 bit format addresses are intended to be used for
                  "general purpose" ACP nodes that would potentially have a
                  limited number (less than 256) of clients (ASA and/or autonomic functions
                  or legacy services) of the ACP that require separate
                  V(irtual) addresses.
                </t>
          <t>
                  The F=1 bit Node-Numbers are intended for
                  ACP nodes that are ACP edge nodes (see <xref target="NMS" format="default"/>)
                  or that have a large number of clients requiring separate
                  V(irtual) addresses, for example, large SDN controllers with
                  container modular software architecture (see <xref target="software" format="default"/>).
                </t>
          <t>
                  In the Vlong Addressing Sub-Scheme, the ACP address in the
                  certificate has all V field bits as zero.  The ACP address
                  set for the node includes any V value.
                </t>
        </section>
        <section anchor="other-sub-schemes" numbered="true" toc="default">
          <name>Other ACP Addressing Sub-Schemes</name>
          <t>Before further addressing sub-schemes are defined, experience with the schemes defined here should be collected.  The schemes defined in this document have been devised to allow hopefully a sufficiently flexible setup of ACPs for a variety of situations.  These reasons also lead to the fairly liberal use of address space: the Zone Addressing Sub-Scheme is intended to enable optimized routing in large networks by reserving bits for Zone-IDs.  The Vlong Addressing Sub-Scheme enables the allocation of 8/16-bit of addresses inside individual ACP nodes.  Both address spaces allow distributed, uncoordinated allocation of node addresses by reserving bits for the Registrar-ID field in the address.</t>

        </section>
        <section anchor="acp-registrars" numbered="true" toc="default">
          <name>ACP Registrars</name>
          <t>ACP registrars are responsible for enrolling candidate ACP nodes
   with ACP certificates and associated trust anchor(s).  They are also
   responsible for including an acp-node-name field in the ACP
   certificate. This field carries the ACP domain name and the ACP
   node's ACP address prefix.  This address
prefix is intended to persist unchanged through the lifetime of the
ACP node.</t>
          <t>Because of the ACP addressing sub-schemes, an ACP domain can have
multiple distributed ACP registrars that do not need to coordinate
for address assignment. ACP registrars can also be sub-CAs, in
which case they can also assign ACP certificates without
dependencies against a (shared) TA (except during renewals
of their own certificates).</t>
          <t>ACP registrars are PKI registration authorities (RA) enhanced with
the handling of the ACP certificate-specific fields. They 
request certificates for ACP nodes from a CA
through any appropriate mechanism (out of scope in this document,
but this mechanism is required to be BRSKI for ANI registrars). Only nodes that
are trusted to be compliant with the registrar requirements 
described in this section can be given the necessary credentials
to perform this RA function, such as the credential for the ACP registrar to connect to the CA
as a registrar.</t>
          <section anchor="registrars-protocols" numbered="true" toc="default">
            <name>Use of BRSKI or Other Mechanisms or Protocols</name>
            <t>Any protocols or mechanisms may be used by ACP registrars
as long as the resulting ACP certificate and TA certificate(s) can be used  
by other domain members to perform the ACP domain membership check described in <xref target="certcheck" format="default"/>,
and the acp-node-name meets the ACP addressing 
   requirements described in the next three sections.</t>
            <t>An ACP registrar could be a person deciding whether to
enroll a candidate ACP node and then orchestrating the
enrollment of the ACP certificate and associated TA,
using command line or web-based commands on the candidate ACP node
and TA to generate and sign the ACP certificate
and configure certificate and TA onto the node.</t>
            <t>The only currently defined protocol for ACP registrars is BRSKI
<xref target="RFC8995" format="default"/>. When BRSKI
is used, the ACP nodes are called ANI nodes, and the ACP registrars
are called BRSKI or ANI registrars.  The BRSKI specification does not define the
handling of the acp-node-name field because the rules
do not depend on BRSKI but apply equally to any protocols or mechanisms that an
ACP registrar may use.</t>
          </section>
          <section anchor="registrars-unique" numbered="true" toc="default">
            <name>Unique Address/Prefix Allocation</name>
            <t>ACP registrars <bcp14>MUST NOT</bcp14> allocate ACP address prefixes to ACP nodes
via the acp-node-name that would collide
with the ACP address prefixes of other ACP nodes in the same ACP domain.
This includes both prefixes allocated by the same ACP registrar to
different ACP nodes as well as prefixes allocated by other ACP registrars
for the same ACP domain.</t>
            <t>To support such unique address allocation, an ACP registrar <bcp14>MUST</bcp14> have
one or more 46-bit identifiers, called the Registrar-ID, that are unique across the ACP domain.
Allocation of Registrar-ID(s) to an ACP registrar can happen through
OAM mechanisms in conjunction with some database and/or allocation orchestration.</t>
            <t>ACP registrars running on physical devices with known globally unique
EUI-48 MAC address(es) (EUI stands for "Extended Unique Identifier") can use the lower 46 bits of those address(es)
as unique Registrar-IDs without requiring any external signaling and/or configuration
(the upper two bits, V and U, are not uniquely assigned but are functional).
This approach is attractive for distributed, non-centrally administered, lightweight
ACP registrar implementations. There is no mechanism to deduce from a MAC
address itself whether it is actually uniquely assigned. Implementations need
to consult additional offline information before making this assumption, for
example, by knowing that a particular physical product or Network Interface Controller (NIC) chip is 
guaranteed to use globally unique assigned EUI-48 MAC address(es).</t>
            <t>When the candidate ACP device (called pledge in BRSKI) is to be
enrolled into an ACP domain, the ACP registrar needs to allocate
a unique ACP address to the node and ensure that the ACP certificate
gets an acp-node-name field (<xref target="domcert-acpinfo" format="default"/>)
with the appropriate information: ACP domain name, ACP address,
and so on. If the ACP registrar uses BRSKI, it signals the ACP
acp-node-name field to the pledge via EST CSR Attributes
(see <xref target="RFC8995" sectionFormat="comma" section="5.9.2"/>, "EST CSR Attributes").</t>

          </section>
          <section anchor="registrars-policy" numbered="true" toc="default">
            <name>Addressing Sub-Scheme Policies</name>
            <t>The ACP registrar selects for the candidate ACP node a unique 
address prefix from an appropriate ACP addressing sub-scheme,
either a Zone Addressing Sub-Scheme prefix (see <xref target="zone-scheme" format="default"/>),
or a Vlong Addressing Sub-Scheme prefix (see <xref target="Vlong" format="default"/>). The
assigned ACP address prefix encoded in the acp-node-name field
of the ACP certificate indicates to the ACP node its ACP
address information. The addressing sub-scheme indicates the
prefix length: /127 for the Zone Addressing Sub-Scheme, /120 or /112
for the Vlong Addressing Sub-Scheme. The first address of the prefix is the ACP address.
All other addresses in the prefix are for other uses by the ACP node
as described in the Zone Addressing Sub-Scheme and Vlong Addressing Sub-Scheme sections.
The ACP address prefix itself is then signaled by the ACP node into
the ACP routing protocol (see <xref target="routing" format="default"/>) to establish
IPv6 reachability across the ACP.</t>
            <t>The choice of addressing sub-scheme and prefix length in the Vlong Addressing
Sub-Scheme is subject to ACP registrar policy. It could be an ACP domain-wide 
policy, or a per ACP node or per ACP node type policy. For example,
in BRSKI, the ACP registrar is aware of the IDevID certificate of the candidate ACP node,
which typically contains a "serialNumber" attribute in the 
subject field distinguished name encoding that often indicates the node's
vendor and device type, and it can be used to drive a policy for selecting an appropriate
addressing sub-scheme for the (class of) node(s).</t>

            <t>ACP registrars <bcp14>SHOULD</bcp14> default to allocating Zone Addressing Sub-Scheme
addresses with Zone-ID 0.</t>

            <t>ACP registrars that are aware of the IDevID certificate of a candidate ACP device
<bcp14>SHOULD</bcp14> be able to choose the Zone vs. Vlong Addressing Sub-Scheme for
ACP nodes based on the "serialNumber" attribute <xref target="X.520" format="default"/> in the 
subject field distinguished name encoding of the IDevID certificate, for example,
by the PID (Product Identifier) part, which identifies the product type,
or by the complete "serialNumber". The PID, for example, could identify 
nodes that allow for specialized ASA requiring multiple addresses or for non-autonomic virtual machines (VMs) for
services, and those nodes could receive Vlong Addressing Sub-Scheme ACP addresses.</t>
            <t>In a simple allocation scheme, an ACP registrar remembers persistently
across reboots its currently used Registrar-ID and, for each addressing
scheme (Zone with Zone-ID 0, Vlong with /112, Vlong with /120), the
next Node-Number available for allocation, and it increases the next Node-Number during successful
enrollment of an ACP node.  In this simple allocation scheme, the ACP registrar
would not recycle ACP address prefixes from ACP nodes that are no longer used.</t>
            <t>If allocated addresses cannot be remembered by registrars, then
it is necessary either to use a new value for the Register-ID field
in the ACP addresses or to determine allocated ACP addresses by determining the
addresses of reachable ACP nodes, which is not necessarily the set of all ACP nodes.
Untracked ACP addresses can be reclaimed by revoking
or not renewing their certificates and instead handing out new certificates
with new addresses (for example, with a new Registrar-ID value). Note that
such strategies may require coordination amongst registrars.</t>
          </section>
          <section anchor="registrars-renewal" numbered="true" toc="default">
            <name>Address/Prefix Persistence</name>
            <t>When an ACP certificate is renewed or rekeyed via EST or other
mechanisms, the ACP address/prefix in the acp-node-name field
<bcp14>MUST</bcp14> be maintained unless security issues or violations of the unique
 address assignment requirements exist or are suspected by the ACP registrar.</t>
            <t>ACP address information <bcp14>SHOULD</bcp14> be maintained even when the renewing and/or rekeying
ACP registrar is not the same as the one that enrolled the prior ACP certificate.
See <xref target="sub-ca" format="default"/> for an example.</t>
            <t>ACP address information <bcp14>SHOULD</bcp14> also be maintained even after an ACP
certificate expires or fails. See <xref target="domcert-re-enroll" format="default"/>
and <xref target="domcert-failing" format="default"/>.</t>
          </section>
          <section anchor="registrars-further" numbered="true" toc="default">
            <name>Further Details</name>
            <t><xref target="registrar-considerations" format="default"/> discusses further informative
details of ACP registrars: needed interactions, required
parameters, certificate renewal and limitations, use of sub-CAs on
registrars, and centralized policy control.</t>
          </section>
        </section>
      </section>
      <section anchor="routing" numbered="true" toc="default">
        <name>Routing in the ACP</name>
        <t>Once ULA addresses are set up, all autonomic entities should run a routing protocol within the ACP context.  This routing protocol distributes the ULA created in the previous section for reachability.  The use of the ACP-specific context eliminates the probable clash with data plane routing tables and also secures the ACP from interference from configuration mismatch or incorrect routing updates.</t>
        <t>The establishment of the routing plane and its parameters are automatic and strictly within the confines of the ACP.  Therefore, no explicit configuration is required.</t>
        <t>All routing updates are automatically secured in transit as the channels of the ACP are encrypted, and this routing runs only inside the ACP.</t>
        <t>The routing protocol inside the ACP is RPL <xref target="RFC6550" format="default"/>.  See <xref target="why-rpl" format="default"/> for more details on the choice of RPL.</t>
        <t>RPL adjacencies are set up across all ACP channels in the same domain including all its routing subdomains.  See <xref target="domain-usage" format="default"/> for more details.</t>
        <section anchor="rpl-profile" numbered="true" toc="default">
          <name>ACP RPL Profile</name>
          <t>The following is a description of the RPL profile that ACP nodes need to support by default.  The format of this section is derived from <xref target="I-D.ietf-roll-applicability-template" format="default"/>.</t>
          <section anchor="rpl-summary" numbered="true" toc="default">
            <name>Overview</name>
            <t>RPL Packet Information (RPI), defined in <xref target="RFC6550" sectionFormat="comma" section="11.2"/>, defines the
   data packet artifacts required or beneficial in the forwarding of packets routed by RPL.
   This profile does not use RPI for better compatibility with accelerated hardware
   forwarding planes, which most often do not support the Hop-by-Hop headers used for RPI,
   but also to avoid the overhead of the RPI header on the wire and cost of adding and/or removing them.
</t>
            <section anchor="rpl-single-instance" numbered="true" toc="default">
              <name>Single Instance</name>
              <t>
      To avoid the need for RPI, the ACP RPL profile uses a simple routing/forwarding table based on destination prefix.
      To achieve this, the profile uses only one RPL
      instanceID.  This single instanceID can contain only one Destination-Oriented 
      Directed Acyclic Graph (DODAG), and the routing/forwarding table can therefore
      only calculate a single class of service ("best effort towards the primary NOC/root")
      and cannot create optimized routing paths to accomplish latency or energy goals
      between any two nodes.
    </t>
              <t>
      This choice is a compromise. Consider a network that has multiple NOCs in different locations. 
      Only one NOC will become the DODAG root. Traffic to and from other NOCs has to be
      sent through the DODAG (shortest path tree) rooted in the primary NOC.
      Depending on topology, this can be an annoyance from a point of view of latency 
      or minimizing network path resources, but this is deemed to be acceptable
      given how ACP traffic is "only" network management/control traffic.
      See <xref target="future-rpl" format="default"/> for more details.</t>
              <t>Using a single instanceID/DODAG does not introduce a single point of
      failure, as the DODAG will reconfigure itself when it detects data plane
      forwarding failures, including choosing a different root when the primary one fails.
    </t>
              <t>The benefit of this profile, especially compared to other IGPs, is 
      that it does not calculate routes for nodes reachable through the same
      interface as the DODAG root. This RPL profile can therefore scale to
      a much larger number of ACP nodes in the same amount of computation and memory
      than other routing protocols, especially on nodes that are leafs of the topology
      or those close to those leafs.
    </t>
            </section>
            <section anchor="rpl-convergence" numbered="true" toc="default">
              <name>Reconvergence</name>
              <t>
      In RPL profiles where RPI (see <xref target="rpl-Data-Plane" format="default"/>) is present,
      it is also used to trigger reconvergence when misrouted, for example, looping packets, which
      are recognized because of their RPI data. This helps to minimize RPL signaling traffic,
      especially in networks without stable topology and slow links.
    </t>
              <t>
      The ACP RPL profile instead relies on quickly reconverging the DODAG by
      recognizing link state change (down/up) and triggering reconvergence signaling
      as described in <xref target="rpl-dodag-repair" format="default"/>.  Since links in the ACP
      are assumed to be mostly reliable (or have link-layer protection against loss)
      and because there is no stretch according to <xref target="rpl-dodag-repair" format="default"/>, 
      loops caused by loss of RPL signaling packets should be exceedingly rare.
    </t>
              <t>
      In addition, there are a variety of mechanisms possible in RPL to further
      avoid temporary loops that are <bcp14>RECOMMENDED</bcp14> to be used for the ACP RPL profile:
      DODAG Information Objects (DIOs) <bcp14>SHOULD</bcp14> be sent two or three times to inform children
      when losing the last parent. The technique in <xref target="RFC6550" sectionFormat="comma" section="8.2.2.6"/> (Detaching) <bcp14>SHOULD</bcp14> be favored over that in Section <xref target="RFC6550" sectionFormat="bare" section="8.2.2.5"/>
      (Poisoning) because it allows local connectivity. Nodes <bcp14>SHOULD</bcp14> select 
      more than one parent, at least three if possible, and send Destination Advertisement Objects (DAOs) to all
      of them in parallel.</t>
              <t>
      Additionally, failed ACP tunnels can be quickly discovered through the
      secure channel protocol mechanisms such as IKEv2 dead peer detection.
      This can function as a replacement for a Low-power and Lossy Network's
      (LLN's) Expected Transmission Count (ETX) feature, which is not used
      in this profile.  A failure of an ACP tunnel should immediately signal the RPL
      control plane to pick a different parent.
    </t>
            </section>
          </section>
          <section anchor="rpl-instances" numbered="true" toc="default">
            <name>RPL Instances</name>
            <t>There is a single RPL instance.  The default RPLInstanceID is 0.</t>
          </section>
          <section anchor="rpl-storing" numbered="true" toc="default">
            <name>Storing vs. Non-Storing Mode</name>
            <t>The RPL Mode of Operation (MOP) <bcp14>MUST</bcp14> support mode 2, "Storing Mode of Operations
        with no multicast support".  Implementations <bcp14>MAY</bcp14> support mode 3 ("... with multicast support") as that is a superset of mode 2.  Note: Root indicates mode in DIO flow.</t>
          </section>
          <section anchor="rpl-dao-policy" numbered="true" toc="default">
            <name>DAO Policy</name>
            <t>The DAO policy is proactive, aggressive DAO state maintenance:</t>
            <ul spacing="normal">
              <li>Use the 'K' flag in unsolicited DAO to indicate change from previous
               information (to require DAO-ACK).</li>
              <li>Retry such DAO DAO-RETRIES(3) times with DAO-ACK_TIME_OUT(256ms) in between.</li>
            </ul>
          </section>
          <section anchor="rpl-path-metric" numbered="true" toc="default">
            <name>Path Metrics</name>
            <t>Use Hop Count according to "<xref target="RFC6551" format="title"/>" <xref target="RFC6551" format="default"/>. Note that this is
        solely for diagnostic purposes as it is not used by the Objective Function.</t>
          </section>
          <section anchor="rpl-objective-function" numbered="true" toc="default">
            <name>Objective Function</name>
<dl>
            <dt>Objective Function (OF):</dt> <dd>Use Objective Function Zero (OF0) ("<xref target="RFC6552" format="title"/>" <xref target="RFC6552" format="default"/>).
           Metric containers are not used.</dd>
            <dt>rank_factor:</dt> <dd><t>Derived from link speed:
            if less than or equal to 100 Mbps, LOW_SPEED_FACTOR(5), else HIGH_SPEED_FACTOR(1).</t>
            <t>This is a simple rank differentiation between typical "low speed"
        or IoT links that commonly max out at 100 Mbps and typical 
        infrastructure links with speeds of 1 Gbps or higher. Given how
        the path selection for the ACP focuses only on reachability but
        not on path cost optimization, no attempts at finer-grained path
        optimization are made. </t></dd>
</dl>
          </section>
          <section anchor="rpl-dodag-repair" numbered="true" toc="default">
            <name>DODAG Repair</name>
<dl>
            <dt>Global Repair:</dt><dd>We assume stable links and ranks (metrics), so there is
              no need to periodically rebuild the DODAG.  The DODAG version is only
              incremented under catastrophic events (e.g., administrative action).</dd>
            <dt>Local Repair:</dt><dd><t>As soon as link breakage is detected, the ACP node sends
        a No-Path DAO for all the targets that were reachable only via this link.
        As soon as link repair is detected, the ACP node validates if this link provides
        a better parent.  If so, a new rank is computed by the ACP node, and it sends a new DIO
        that advertises the new rank.  Then it sends a DAO with a new path sequence about itself.</t>
            <t>When using ACP multi-access virtual interfaces, local repair can be
               triggered directly by peer breakage, see <xref target="ACP-ma-virtual-interfaces" format="default"/>.</t></dd>
            <dt>stretch_rank:</dt><dd>None provided ("not stretched").</dd>
            <dt>Data-Path Validation:</dt><dd> Not used.</dd>
            <dt>Trickle:</dt><dd>Not used.</dd>
</dl>
          </section>
          <section anchor="rpl-multicast" numbered="true" toc="default">
            <name>Multicast</name>
            <t>Multicast is not used yet, but it is possible because of the selected mode of operations.</t>
          </section>
          <section anchor="rpl-security" numbered="true" toc="default">
            <name>Security</name>
            <t>RPL security <xref target="RFC6550" format="default"/> is not used, and ACP security is substituted.</t>
            <t>Because the ACP links already include provisions for confidentiality and
         integrity protection, their usage at the RPL layer would be redundant, and 
         so RPL security is not used.</t>
          </section>
          <section anchor="rpl-p2p" numbered="true" toc="default">
            <name>P2P Communications</name>
            <t>Not used.</t>
          </section>
          <section anchor="rpl-ipv6" numbered="true" toc="default">
            <name>IPv6 Address Configuration</name>

            <t>Every ACP node (RPL node) announces an IPv6 prefix covering the addresses assigned to the ACP node via the AcpNodeName.  The prefix length depends on the addressing sub-scheme of the acp-address, /127 for the Zone Addressing Sub-Scheme and /112 or /120 for the Vlong Addressing Sub-Scheme.  See <xref target="addressing" format="default"/> for more details.</t>

            <t>Every ACP node <bcp14>MUST</bcp14> install a black hole route (also known as a null route) if there are unused parts of the ACP address space assigned to the ACP node via its AcpNodeName. This is superseded by longer prefixes assigned to interfaces for the address space actually used by the node.  For example, when the node has an ACP-Vlong-8 address space, it installs a /120 black hole route. If it then only uses the ACP address (first address from the space), for example, it would assign that address via a /128 address prefix to the ACP loopback interface (see <xref target="ACP-loopback" format="default"/>). None of those longer prefixes are announced into RPL.</t>

             <t>For ACP-Manual address prefixes configured on an ACP node, for example, for ACP connect subnets (see <xref target="NMS" format="default"/>), the node announces the /64 subnet prefix.</t>

          </section>
          <section anchor="rpl-admin" numbered="true" toc="default">
            <name>Administrative Parameters</name>
<dl>
            <dt>Administrative Preference (<xref target="RFC6550" section="3.2.6" sectionFormat="comma" format="default"/> --to become root):</dt><dd> <t>The preference is indicated in the DODAGPreference field of DIO message.
            </t>
            <dl>
              <dt>Explicitly configured "root":</dt><dd> 0b100</dd>
              <dt>ACP registrar (default):</dt><dd> 0b011</dd>
              <dt>ACP connect (non-registrar):</dt><dd> 0b010</dd>
              <dt>Default:</dt><dd> 0b001</dd>
            </dl>
           </dd>
</dl>
          </section>
          <section anchor="rpl-Data-Plane" numbered="true" toc="default">
            <name>RPL Packet Information</name>
            <t>RPI is not required in the ACP RPL profile for the following reasons.
           </t>
            <t>One RPI option is the RPL Source Routing Header (SRH) ("<xref target="RFC6554" format="title"/>" <xref target="RFC6554" format="default"/>), which is not 
           necessary because the ACP RPL profile uses storing mode where each hop has the necessary next-hop
           forwarding information.</t>
            <t>The simpler RPL Option header "<xref target="RFC6553" format="title"/>" <xref target="RFC6553" format="default"/> is also
           not necessary in this profile, because it uses a single RPL instance and data-path
           validation is also not used.</t>
          </section>
          <section anchor="rpl-unknown" numbered="true" toc="default">
            <name>Unknown Destinations</name>
            <t>Because RPL minimizes the size of the routing and forwarding table, prefixes reachable through the same interface as the RPL root are not known on every ACP node.  Therefore, traffic to unknown destination addresses can only be discovered at the RPL root.  The RPL root <bcp14>SHOULD</bcp14> have attach-safe mechanisms to operationally discover and log such packets.</t>

            <t>As this requirement places additional constraints on the data plane
              functionality of the RPL root, it does not apply to "normal" nodes
              that are not configured to have special functionality (i.e., the
              administrative parameter from <xref target="rpl-admin" format="default"/> has value 0b001).
              If the ACP network is degraded to the point where there are no nodes that
              could be configured as root, registrar, or ACP connect nodes, it is
              possible that the RPL root (and thus the ACP as a whole) would be
              unable to detect traffic to unknown destinations.  However, in the
              absence of nodes with administrative preference other than 0b001,
              there is also unlikely to be a way to get diagnostic information out
              of the ACP, so detection of traffic to unknown destinations would not
              be actionable anyway.
            </t>

          </section>
        </section>
      </section>
      <section anchor="acp_general" numbered="true" toc="default">
        <name>General ACP Considerations</name>
        <t>Since channels are established between adjacent neighbors by default, the resulting overlay network does hop-by-hop encryption.  Each node decrypts incoming traffic from the ACP and encrypts outgoing traffic to its neighbors in the ACP.  Routing is discussed in <xref target="routing" format="default"/>.</t>
        <section anchor="performance" numbered="true" toc="default">
          <name>Performance</name>
          <t>There are no performance requirements for ACP implementations defined in this document because the performance requirements depend on the intended use case.  It is expected that a fully autonomic node with a wide range of ASA can require high forwarding plane performance in the ACP, for example, for telemetry.  Implementations of ACP that solely support traditional or SDN-style use cases can benefit from ACP at lower performance, especially if the ACP is used only for critical operations, e.g., when the data plane is not available. The design of the ACP as specified in this document is intended to support a wide range of performance options: it is intended to allow software-only implementations at potentially low performance, but the design can also support high-performance options. See <xref target="RFC8368" format="default"/> for more details.</t>
        </section>
        <section anchor="general_addressing" numbered="true" toc="default">
          <name>Addressing of Secure Channels</name>
          <t>In order to be independent of the data plane routing and addressing,
the ACP secure channels discovered via GRASP use IPv6 link-local addresses between
adjacent neighbors.  Note: <xref target="remote-acp-neighbors" format="default"/> specifies
extensions in which secure channels are configured tunnels operating over
the data plane, so those secure channels cannot be independent of the
data plane.</t>
          <t>To avoid impacting the operations of the
IPv6 (link-local) interface/address used for ACP channels when configuring the data plane, appropriate
implementation considerations are required. If the IPv6 interface/link-local
address is shared with the data plane, it needs to be impossible to unconfigure and/or disable
it through configuration. Instead of sharing the IPv6 interface/link-local
address, a separate (virtual) interface with a separate IPv6 link-local
address can be used. For example, the ACP interface could be run over a separate 
MAC address of an underlying L2 (Ethernet) interface.  For more details and options,
see <xref target="dp-dependency" format="default"/>.</t>
          <t>Note that other (nonideal) implementation choices may introduce additional, undesired
dependencies against the data plane, for example, shared code and configuration
of the secure channel protocols (IPsec and/or DTLS).</t>

        </section>
        <section anchor="general_MTU" numbered="true" toc="default">
          <name>MTU</name>
          <t>The MTU for ACP secure channels <bcp14>MUST</bcp14> be derived locally from the underlying link MTU minus the secure channel encapsulation overhead.</t>
          <t>ACP secure channel protocols do not need to perform MTU discovery because they are built across L2 adjacencies: the MTUs on both sides connecting to the L2 connection are assumed to be consistent.  Extensions to ACP where the ACP is, for example, tunneled need to consider how to guarantee MTU consistency.  This is an issue of tunnels, not an issue of running the ACP across a tunnel.  Transport stacks running across ACP can perform normal PMTUD (Path MTU Discovery).  Because the ACP is meant to prioritize reliability over performance, they <bcp14>MAY</bcp14> opt to only expect IPv6 minimum MTU (1280 octets) to avoid running into PMTUD implementation bugs or underlying link MTU mismatch problems.</t>
        </section>
        <section anchor="general_multipath" numbered="true" toc="default">
          <name>Multiple Links between Nodes</name>
          <t>If two nodes are connected via several links, the ACP <bcp14>SHOULD</bcp14> be established across every link, but it is possible to establish the ACP only on a subset of links.  Having an ACP channel on every link has a number of advantages, for example, it allows for a faster failover in case of link failure, and it reflects the physical topology more closely.  Using a subset of links (for example, a single link), reduces resource consumption on the node because state needs to be kept per ACP channel.  The negotiation scheme explained in <xref target="channel-selection" format="default"/> allows the Decider (the node with the higher ACP address) to drop all but the desired ACP channels to the Follower, and the Follower will not retry to build these secure channels from its side unless the Decider appears with a previously unknown GRASP announcement (e.g., on a different link or with a different address announced in GRASP).</t>
        </section>
        <section anchor="ACP_interfaces" numbered="true" toc="default">
          <name>ACP Interfaces</name>
          <t>Conceptually, the ACP VRF has two types of interfaces: the "ACP loopback 
        interface(s)" to which the ACP ULA address(es) are assigned and the
         "ACP virtual interfaces" that are mapped to the ACP secure channels.</t>
          <section anchor="ACP-loopback" numbered="true" toc="default">
            <name>ACP Loopback Interfaces</name>
            <t>For autonomous operations of the ACP, as described in <xref target="self-creation" format="default"/>
        and <xref target="acp-l2-switches" format="default"/>, the ACP node uses the first address from
        the N bit ACP prefix assigned to the node. N = (128 - number of Vbits of the ACP address).
        This address is assigned with an address prefix of N or larger to a loopback interface.</t>
            <t>Other addresses from the prefix can be used by the ACP of the node as desired. 
        The autonomous operations of the ACP do not require additional global-scope
         IPv6 addresses, they are instead intended for ASA or non-autonomous functions.
        Components of the ACP that are not fully autonomic, such as ACP connect interfaces
        (see <xref target="acp-connect" format="default"/>), may also introduce additional
        global-scope IPv6 addresses on other types of interfaces to the ACP.</t>

            <t>The use of loopback interfaces for global-scope addresses is 
        common operational configuration practice on routers, for example, in Internal BGP (IBGP)
        connections since BGP4 (see "<xref target="RFC1654" format="title"/>" <xref target="RFC1654" format="default"/>) or earlier.
        The ACP adopts and automates this operational practice.</t>
            <t>A loopback interface for use with the ACP as described above is an interface
        that behaves according to Section <xref target="RFC6724" section="4" sectionFormat="bare"/> of <xref target="RFC6724">"Default Address Selection for Internet Protocol Version 6 (IPv6)"</xref>, paragraph 2.
        Packets sent by the host of the node from the loopback interface 
        behave as if they are looped back by the interface so that
        they look as if they originated from the loopback interface, are 
        then received by the node and forwarded by it towards the destination.</t>
            <t>The term "loopback only" indicates this behavior, but not the actual name of the
        interface type chosen in an actual implementation.
        A loopback interface for use with the ACP can be a virtual and/or software
        construct without any associated hardware, or it can be a hardware interface
        operating in loopback mode.</t>
            <t>A loopback interface used for the ACP <bcp14>MUST NOT</bcp14> have connectivity to other
        nodes.</t>
            <t>The following list reviews the reasons for the choice of loopback addresses
        for ACP addresses, which is based on the IPv6 address architecture and common challenges:
        </t>
            <ol type="1" spacing="normal">
              <li>IPv6 addresses are assigned to interfaces, not nodes. IPv6 continues
          the IPv4 model that a subnet prefix is associated with one link,
          see Section <xref target="RFC4291" section="2.1" sectionFormat="bare"/> of <xref target="RFC4291">"IP Version 6 Addressing Architecture"</xref>.</li>
              <li>IPv6 implementations commonly do not allow assignment of the same
              IPv6 global-scope address in the same VRF to more
          than one interface.</li>
              <li>Global-scope addresses assigned to interfaces that connect to other
          nodes (external interfaces) may not be stable addresses for communications
          because any such interface could fail due to reasons external to the node.
          This could render the addresses assigned to that interface unusable.</li>
              <li>If failure of the subnet does not bring down the interface and make
          the addresses unusable, it could result in unreachability of the
          address because the shortest path to the node might go through one of the
          other nodes on the same subnet, which could equally consider the subnet to
          be operational even though it is not.</li>
              <li>Many OAM service implementations on routers cannot deal with more than one peer address,
          often because they already expect that a single loopback address can be used,
          especially to provide a stable address under failure of external interfaces or links.</li>
              <li>Even when an application supports multiple addresses to a peer, it
          can only use one address at a time for a connection with the most widely deployed 
          transport protocols, TCP and UDP. While "<xref target="RFC6824" format="title"/>" <xref target="RFC6824" format="default"/>/<xref target="RFC8684" format="default"/> solves this problem,
          it is not widely adopted by implementations of router OAM services.</li>
              <li>To completely autonomously assign global-scope addresses to subnets
          connecting to other nodes, it would be necessary for every node to have 
          an amount of prefix address space on the order of the maximum number of
          subnets that the node could connect to, and then the node would have to negotiate
          with adjacent nodes across those subnets which address space to use for each subnet.</li>
              <li>Using global-scope addresses for subnets between nodes is 
          unnecessary if those subnets only connect routers, such as ACP secure channels,
          because they can communicate to remote nodes via their global-scope loopback addresses.
          Using global-scope addresses for those external subnets is therefore wasteful
          for the address space and also unnecessarily increases the size of the routing
          and forwarding tables, which, especially for the ACP, is highly undesirable because
          it should attempt to minimize the per-node overhead of the ACP VRF.</li>
              <li>For all these reasons, the ACP addressing sub-schemes do not consider
          ACP addresses for subnets connecting ACP nodes.</li>
            </ol>
            <t>Note that "<xref target="RFC8402" format="title"/>" <xref target="RFC8402" format="default"/> introduces the term Node-SID to refer
        to IGP prefix segments that identify a specific router, for example, on a loopback interface.
        An ACP loopback address prefix may similarly be called an ACP Node Identifier.</t>
          </section>
          <section anchor="ACP-virtual-interfaces" numbered="true" toc="default">
            <name>ACP Virtual Interfaces</name>
            <t>Any ACP secure channel to another ACP node is
        mapped to ACP virtual interfaces in one of the following ways.
        This is independent of the chosen secure channel protocol (IPsec, DTLS,
        or other future protocol, either standardized or not).</t>
            <t>Note that all the considerations described here assume point-to-point
        secure channel associations. Mapping multiparty secure channel associations, such as
        "<xref target="RFC6407" format="title"/>" <xref target="RFC6407" format="default"/>, is out of scope.</t>
            <section anchor="ACP-p2p-virtual-interfaces" numbered="true" toc="default">
              <name>ACP Point-to-Point Virtual Interfaces</name>
              <t>In this option, each ACP secure channel is
        mapped to a separate point-to-point ACP virtual interface.  If a
        physical subnet has more than two ACP-capable nodes (in the same domain),
        this implementation approach will lead to a full mesh of ACP virtual 
        interfaces between them.</t>
              <t>When the secure channel protocol determines a peer to be dead, this <bcp14>SHOULD</bcp14>
        result in indicating link breakage to trigger RPL DODAG repair, see
        <xref target="rpl-dodag-repair" format="default"/>.</t>
            </section>
            <section anchor="ACP-ma-virtual-interfaces" numbered="true" toc="default">
              <name>ACP Multi-Access Virtual Interfaces</name>
              <t>In a more advanced implementation approach,
        the ACP will construct a single multi-access ACP virtual interface for
        all ACP secure channels to ACP-capable nodes reachable across the same
        underlying (physical) subnet.  IPv6 link-local multicast packets
        sent to an ACP multi-access virtual interface are replicated to
        every ACP secure channel mapped to the ACP multi-access virtual
        interface.  IPv6 unicast packets sent to an ACP multi-access virtual
        interface are sent to the ACP secure channel that belongs to the
        ACP neighbor that is the next hop in the ACP forwarding table entry
        used to reach the packets' destination address.</t>
              <t>When the secure channel protocol determines that a peer is dead for a
        secure channel mapped to an ACP multi-access virtual interface,
        this <bcp14>SHOULD</bcp14> result in signaling breakage of that peer to RPL, so it can trigger
        RPL DODAG repair, see <xref target="rpl-dodag-repair" format="default"/>.</t>
              <t>There is no requirement for
        all ACP nodes on the same multi-access subnet to use the same
        type of ACP virtual interface.  This is purely a node-local
        decision.</t>
              <t>ACP nodes <bcp14>MUST</bcp14> perform standard IPv6 operations across ACP
        virtual interfaces including SLAAC 
        <xref target="RFC4862" format="default"/> to assign their IPv6 link-local address on the ACP
        virtual interface and ND ("<xref target="RFC4861" format="title"/>" <xref target="RFC4861" format="default"/>)
        to discover which IPv6 link-local neighbor address belongs to 
        which ACP secure channel mapped to the ACP virtual interface.
        This is independent of whether the ACP virtual interface is point-to-point or multi-access.</t>
              <t>Optimistic Duplicate Address Detection (DAD) according to 
        "<xref target="RFC4429" format="title"/>" <xref target="RFC4429" format="default"/> is <bcp14>RECOMMENDED</bcp14> because the likelihood for
        duplicates between ACP nodes is highly improbable as long as 
        the address can be formed from a globally unique, locally assigned identifier
        (e.g., EUI-48/EUI-64, see below).</t>
              <t>ACP nodes <bcp14>MAY</bcp14> reduce the amount of link-local IPv6 multicast
        packets from ND by learning the IPv6 link-local neighbor address
        to ACP secure channel mapping from other messages, such as the source
        address of IPv6 link-local multicast RPL messages, and therefore
        forego the need to send Neighbor Solicitation messages.</t>
              <t>The ACP virtual interface IPv6 link-local address can be derived from
        any appropriate local mechanism, such as node-local EUI-48 or EUI-64.
        It <bcp14>MUST NOT</bcp14> depend on something that is attackable from the data plane, such
        as the IPv6 link-local address of the underlying physical interface, which
        can be attacked by SLAAC, or parameters of the secure channel encapsulation header
        that may not be protected by the secure channel mechanism.</t>
              <t>The link-layer address of an ACP virtual interface is the
        address used for the underlying interface across which the secure
        tunnels are built, typically Ethernet addresses.  Because unicast IPv6
        packets sent to an ACP virtual interface are not sent to a link-layer
        destination address but rather to an ACP secure channel,
        the link-layer address fields <bcp14>SHOULD</bcp14> be ignored on reception, and
        instead the ACP secure channel from which the message was
        received should be remembered.</t>
              <t>Multi-access ACP virtual interfaces are preferable implementations
        when the underlying interface is a (broadcast) multi-access subnet because they 
        reflect the presence of the underlying multi-access subnet to the virtual
        interfaces of the ACP.  This makes it, for example, simpler to build services
        with topology awareness inside the ACP VRF in the same way as they could 
        have been built running natively on the multi-access interfaces.</t>
              <t>Consider also the impact of point-to-point vs. multi-access virtual interfaces
        on the efficiency of flooding via link-local multicast messages.</t>
              <t>Assume a LAN with three ACP neighbors, Alice, Bob, and Carol.
        Alice's ACP GRASP wants to send a link-local GRASP multicast message to
        Bob and Carol.  If Alice's ACP emulates the LAN as per-peer, point-to-point
        virtual interfaces, one to Bob and one to Carol, Alice's ACP GRASP will
        send two copies of multicast GRASP messages: one to Bob and one to Carol.
        If Alice's ACP emulates a LAN via a multipoint virtual interface, Alice's ACP GRASP will send one packet
        to that interface, and the ACP multipoint virtual interface will replicate the packet to each secure channel,
        one to Bob, one to Carol.  The result is the same.  The difference 
        happens when Bob and Carol receive their packets.  If they use ACP point-to-point
        virtual interfaces, their GRASP instance would forward the packet
        from Alice to each other as part of the GRASP flooding procedure.
        These packets are unnecessary and would be discarded by GRASP
        on receipt as duplicates (by use of the GRASP Session ID).
        If Bob and Carol's ACP emulated a multi-access
        virtual interface, then this would not happen because GRASP's flooding procedure
        does not replicate packets back to the interface from which they were received.</t>
              <t>Note that link-local GRASP multicast messages are not sent
        directly as IPv6 link-local multicast UDP messages to ACP virtual interfaces,
        but instead to ACP GRASP virtual interfaces that are layered on top of
        ACP virtual interfaces to add TCP reliability to link-local multicast
        GRASP messages.  Nevertheless, these ACP GRASP virtual interfaces perform the
        same replication of messages and therefore have the same impact on flooding.
        See <xref target="GRASP-substrate" format="default"/> for more details.</t>
              <t>RPL does support operations and correct routing table construction
        across non-broadcast multi-access (NBMA) subnets.  This is common when using many
        radio technologies.  When such NBMA subnets are used, they <bcp14>MUST NOT</bcp14> be
        represented as ACP multi-access virtual interfaces because the replication
        of IPv6 link-local multicast messages will not reach all
        NBMA subnet neighbors.  As a result, GRASP message flooding would fail.
        Instead, each ACP secure channel across such an interface <bcp14>MUST</bcp14> be
        represented as an ACP point-to-point virtual interface. See also <xref target="future-rpl" format="default"/>.</t>
              <t>Care needs to be taken when creating multi-access ACP virtual
        interfaces across ACP secure channels between ACP nodes in different domains
        or routing subdomains. If, for example, future inter-domain ACP policies
        are defined as "peer-to-peer" policies, it is easier to create ACP point-to-point
        virtual interfaces for these inter-domain secure channels.</t>
            </section>
          </section>
        </section>
      </section>
    </section>
    <section anchor="acp-l2-switches" numbered="true" toc="default">
      <name>ACP Support on L2 Switches/Ports (Normative)</name>
      <section anchor="acp-l2-switches-why" numbered="true" toc="default">
        <name>Why (Benefits of ACP on L2 Switches)</name>
        <figure anchor="acp-example">
          <name>Topology with L2 ACP Switches</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    ANrtr1 ------ ANswitch1 --- ANswitch2 ------- ANrtr2
              .../   \                   \  ...
    ANrtrM ------     \                   ------- ANrtrN
                       ANswitchM ...
]]></artwork>
        </figure>
        <t>Consider a large L2 LAN with routers ANrtr1 through ANrtrN connected via some topology of L2 switches.
Examples include large enterprise campus networks with an L2 core, IoT networks, or broadband
aggregation networks, which often have a multilevel L2-switched topology.</t>
        <t>If the discovery protocol used for the ACP operates at the subnet level, every ACP router
will see all other ACP routers on the LAN as neighbors, and a full mesh of ACP channels will be built.
If some or all of the AN switches are autonomic with the same discovery protocol, then the
full mesh would include those switches as well.</t>
        <t>A full mesh of ACP connections can create fundamental scale challenges.  The number of
security associations of the secure channel protocols will likely not scale arbitrarily,
especially when they leverage platform-accelerated encryption/decryption.  Likewise, any
other ACP operations (such as routing) need to scale to the number of direct ACP neighbors.  An
ACP router with just four physical interfaces might be deployed into a LAN with hundreds of neighbors connected
via switches.  Introducing such a new, unpredictable scaling factor requirement makes it harder
to support the ACP on arbitrary platforms and in arbitrary deployments.</t>
        <t>Predictable scaling requirements for ACP neighbors can most easily be achieved if, in
topologies such as these, ACP-capable L2 switches can ensure that discovery messages terminate
on them so that neighboring ACP routers and switches will only find the physically connected
ACP L2 switches as their candidate ACP neighbors.  With such a discovery mechanism in place, the
ACP and its security associations will only need to scale to the number of physical interfaces
instead of a potentially much larger number of "LAN-connected" neighbors, and the ACP topology
will follow directly the physical topology, something that can then also be leveraged
in management operations or by ASAs.</t>
        <t>In the example above, consider that ANswitch1 and ANswitchM are ACP capable, and ANswitch2
is not ACP capable.  The desired ACP topology is that ANrtr1 and ANrtrM only have an
ACP connection to ANswitch1, and that ANswitch1, ANrtr2, and ANrtrN have a full mesh of ACP
connections amongst each other.  ANswitch1 also has an ACP connection with ANswitchM, and
ANswitchM has ACP connections to anything else behind it.</t>
      </section>
      <section anchor="acp-l2-switches-how" numbered="true" toc="default">
        <name>How (per L2 Port DULL GRASP)</name>
        <t>To support ACP on L2 switches or L2-switched ports of an L3 device, it is necessary to
make those L2 ports look like L3 interfaces for the ACP implementation.  This primarily involves
the creation of a separate DULL GRASP instance/domain on every such L2 port.  Because GRASP
has a dedicated link-local IPv6 multicast address (ALL_GRASP_NEIGHBORS), it is sufficient that all packets
for this address are extracted at the port level and passed to that DULL GRASP instance.
Likewise, the IPv6 link-local multicast packets sent by that DULL GRASP instance need to be
sent only towards the L2 port for this DULL GRASP instance (instead of being flooded across
all ports of the VLAN to which the port belongs).</t>
        <t>When the ports/interfaces across which the ACP is expected to operate in an ACP-aware L2 switch or L2/L3 switch/router are L2-bridged, packets for the ALL_GRASP_NEIGHBORS multicast address <bcp14>MUST</bcp14> never be forwarded between these ports. If MLD snooping is used, it <bcp14>MUST</bcp14> be prohibited from bridging packets for the ALL_GRASP_NEIGHBORS IPv6 multicast address.</t>
        <t>On hybrid L2/L3 switches, multiple L2 ports are assigned to a single L3
VLAN interface. With the aforementioned changes for DULL GRASP, ACP can
simply operate on the L3 VLAN interfaces, so no further (hardware) forwarding
changes are required to make ACP operate on L2 ports. This is possible because
the ACP secure channel protocols only use link-local IPv6 unicast packets,
and these packets will be sent to the correct L2 port towards the
peer by the VLAN logic of the device.</t>
        <t>This is sufficient when P2P ACP virtual interfaces are established to
every ACP peer. When it is desired to create multi-access ACP virtual interfaces
(see <xref target="ACP-ma-virtual-interfaces" format="default"/>), it is <bcp14>REQUIRED</bcp14> not to coalesce all
 the ACP secure channels on the same L3 VLAN interface, but only all those on the same L2 port.</t>
        <t>If VLAN tagging is used, then the logic described above only applies to
untagged GRASP packets. For the purpose of ACP neighbor discovery via GRASP,
no VLAN-tagged packets <bcp14>SHOULD</bcp14> be sent or received. In a hybrid L2/L3
switch, each VLAN would therefore only create ACP adjacencies across those
ports where the VLAN is carried untagged.</t>
        <t>As a result, the simple logic is that ACP secure channels would operate 
over the same L3 interfaces that present a single, flat bridged network
across all routers, but because DULL GRASP is separated on a per-port basis,
no full mesh of ACP secure channels is created, but only per-port ACP
secure channels to per-port L2-adjacent ACP node neighbors.</t>
        <t>For example, in the above picture, ANswitch1 would run separate DULL GRASP instances on its ports
to ANrtr1, ANswitch2, and ANswitchI, even though all three ports may be in the data plane 
in the same (V)LAN and perform L2 switching between these ports, ANswitch1 would perform
ACP L3 routing between them.</t>
        <t>The description in the previous paragraph is specifically meant to illustrate that, on hybrid
L3/L2 devices that are common in enterprise, IoT, and broadband aggregation, there is only
the GRASP packet extraction (by Ethernet address) and GRASP link-local multicast per
L2-port packet injection that has to consider L2 ports at the hardware-forwarding level.
The remaining operations are purely ACP control plane and setup of secure channels across the
L3 interface.  This hopefully makes support for per-L2 port ACP on those hybrid devices easy.</t>
        <t>In devices without such a mix of L2 port/interfaces and L3 interfaces (to terminate any
transport-layer connections), implementation details will differ.  Logically and most simply every
L2 port is considered and used as a separate L3 subnet for all ACP operations.  The fact that
the ACP only requires IPv6 link-local unicast and multicast should make support for it on any
type of L2 devices as simple as possible.</t>
        <t>A generic issue with ACP in L2-switched networks is the interaction with the Spanning Tree
Protocol (STP).  Without further L2 enhancements, the ACP would run only across the active STP
topology, and the ACP would be interrupted and reconverge with STP changes.
Ideally, ACP peering <bcp14>SHOULD</bcp14> be built also across ports that are blocked in STP so
that the ACP does not depend on STP and can continue to run unaffected across STP topology
changes, where reconvergence can be quite slow.  The above described simple implementation
options are not sufficient to achieve this.</t>
      </section>
    </section>
    <section anchor="workarounds" numbered="true" toc="default">
      <name>Support for Non-ACP Components (Normative)</name>
      <section anchor="ACPconnect" numbered="true" toc="default">
        <name>ACP Connect</name>
        <section anchor="NMS" numbered="true" toc="default">
          <name>Non-ACP Controller and/or Network Management System (NMS)</name>
          <t>The ACP can be used by management systems, such as controllers or NMS hosts, to connect to devices (or other type of nodes) through it.  For this, an NMS host needs to have access to the ACP.  The ACP is a self-protecting overlay network, which allows access only to trusted, autonomic systems by default.  Therefore, a traditional, non-ACP NMS does not have access to the ACP by default, such as any other external node.</t>
          <t>If the NMS host is not autonomic, i.e., it does not support autonomic negotiation of the ACP, then it can be brought into the ACP by explicit configuration.  To support connections to adjacent non-ACP nodes, an ACP node <bcp14>SHOULD</bcp14> support "ACP connect" (sometimes also called "autonomic connect").</t>
          <t>"ACP connect" is an interface-level, configured workaround for connection of trusted non-ACP nodes to the ACP. The ACP node on which ACP connect is configured is called an "ACP edge node". With ACP connect, the ACP is accessible from those non-ACP nodes (such as NOC systems) on such an interface without those non-ACP nodes having to support any ACP discovery or ACP channel setup.  This is also called "native" access to the ACP because, to those NOC systems, the interface looks like a normal network interface without any ACP secure channel that is encapsulating the traffic.</t>
          <figure anchor="acp-connect">
            <name>ACP Connect</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[

                                 Data Plane "native" (no ACP)
                                          .
+--------+       +----------------+       .        +-------------+
| ACP    |       |ACP Edge Node   |       .        |             |
| Node   |       |                |       v        |             |
|        |-------|...[ACP VRF]....+----------------|             |+
|        |   ^   |.               |                | NOC Device  ||
|        |   .   | .[Data Plane]..+----------------| "NMS hosts" ||
|        |   .   |  [          ]  | .         ^    |             ||
+--------+   .   +----------------+  .        .    +-------------+|
             .                        .       .     +-------------+
             .                        .       .
          Data Plane "native"         .   ACP "native" (unencrypted)
        + ACP auto-negotiated         .   "ACP connect subnet"
          and encrypted               .
                                    ACP connect interface
                                    e.g., "VRF ACP native" (config)

]]></artwork>
          </figure>
          <t>ACP connect has security consequences: all systems and processes connected via ACP connect have access to all ACP nodes on the entire ACP, without further authentication.  Thus, the ACP connect interface and the NOC systems connected to it need to be physically controlled and/or secured.  For this reason, the mechanisms described here explicitly do not include options to allow for a non-ACP router to be connected across an ACP connect interface and addresses behind such a router routed inside the ACP.</t>
          <t>Physically controlled and/or secured means that attackers cannot gain access to the physical device hosting the ACP edge node, the physical interfaces and links providing the ACP connect link, nor the physical devices hosting the NOC device. In a simple case, ACP edge node and NOC device are colocated in an access-controlled room, such as a NOC, to which attackers cannot gain physical access.</t>
          <t>An ACP connect interface provides exclusive access to only the ACP.  This is likely insufficient for many NMS hosts.  Instead, they would require a second "data plane" interface outside the ACP for connections between the NMS host and administrators, or Internet-based services, or for direct access to the data plane.  The document <xref target="RFC8368" format="default">"Using Autonomic Control Plane for Stable Connectivity of Network OAM"</xref> explains in more detail how the ACP can be integrated in a mixed NOC environment.</t>
          <t>An ACP connect interface <bcp14>SHOULD</bcp14> use an IPv6 address/prefix
from the Manual Addressing Sub-Scheme (<xref target="manual-scheme" format="default"/>), letting the operator configure, for example, only the Subnet-ID and having the node automatically assign the remaining part of the prefix/address.  It <bcp14>SHOULD NOT</bcp14> use a prefix that is also routed outside the ACP so that the addresses clearly indicate whether it is used inside the ACP or not.</t>
          <t>The prefix of ACP connect subnets <bcp14>MUST</bcp14> be
	  distributed by the ACP edge node into the ACP routing protocol, RPL.
	  The NMS host <bcp14>MUST</bcp14> connect to prefixes in the ACP
	  routing table via its ACP connect interface.  In the simple case
	  where the ACP uses only one ULA prefix, and all ACP connect subnets
	  have prefixes covered by that ULA prefix, NMS hosts can rely on
	  <xref target="RFC6724" format="default"/> to determine longest match
	  prefix routes towards its different interfaces, ACP and
	  data plane. With <xref target="RFC6724"/>, the NMS host will select the ACP connect interface for all addresses in the ACP because any ACP destination address is longest matched by the address on the ACP connect interface.  If the NMS host's ACP connect interface uses another prefix, or if the ACP uses multiple ULA prefixes, then the NMS host requires (static) routes towards the ACP interface for these prefixes.</t>
          <t> When an ACP edge node receives a packet from an ACP connect interface, the ACP edge node
<bcp14>MUST</bcp14> only forward the packet to the ACP if the packet has an IPv6 source address from that interface (this is sometimes called Reverse Path Forwarding (RPF) filtering).  This filtering rule <bcp14>MAY</bcp14> be changed through administrative measures. The more any such administrative action enables reachability of non-ACP nodes to the ACP, the more this may cause security issues.</t>
          <t>To limit the security impact of ACP connect, nodes supporting it <bcp14>SHOULD</bcp14> implement a security
mechanism to allow configuration and/or use of ACP connect interfaces only on nodes explicitly targeted
to be deployed with it (those in physically secure locations such as a NOC).  For example,
the registrar could disable the ability to enable ACP connect on devices during enrollment,
and that property could only be changed through reenrollment.  See also <xref target="role-assignments" format="default"/>.</t>
          <t>ACP edge nodes <bcp14>SHOULD</bcp14> have a configurable option to prohibit packets with RPI headers (see <xref target="rpl-Data-Plane" format="default"/>) across an ACP connect interface. These headers are outside the scope of the RPL profile in this specification but may be used in future extensions of this specification.</t>
        </section>
        <section anchor="software" numbered="true" toc="default">
          <name>Software Components</name>
          <t>The previous section assumed that the ACP edge node and NOC devices are separate physical devices and that the ACP connect interface is a physical network connection. This section discusses the implication when these components are instead software components running on a single physical device.</t>
          <t>The ACP connect mechanism can be used not only to connect physically external systems (NMS hosts) to the ACP but also other applications, containers, or virtual machines.  In fact, one possible way to eliminate the security issue of the external ACP connect interface is to colocate an ACP edge node and an NMS host by making one a virtual machine or container inside the other; therefore converting the unprotected external ACP subnet into an internal virtual subnet in a single device.  This would ultimately result in a fully ACP-enabled NMS host with minimum impact to the NMS host's software architecture.  This approach is not limited to NMS hosts but could equally be applied to devices consisting of one or more VNF (virtual network functions): an internal virtual subnet connecting out-of-band management interfaces of the VNFs to an ACP edge router VNF.</t>
          <t>The core requirement is that the software components need to have a network stack that permits access to the ACP and optionally also to the data plane.  Like in the physical setup for NMS hosts, this can be realized via two internal virtual subnets: one that connects to the ACP (which could be a container or virtual machine by itself), and one (or more) connecting to the data plane.</t>
          <t>This "internal" use of the ACP connect approach should not be considered to be a "workaround" because, in this case, it is possible to build a correct security model: it is not necessary to rely on unprovable, external physical security mechanisms as in the case of external NMS hosts.  Instead, the orchestration of the ACP, the virtual subnets, and the software components can be done by trusted software that could be considered to be part of the ANI (or even an extended ACP).  This software component is responsible for ensuring that only trusted software components will get access to that virtual subnet and that only even more trusted software components will get access to both the ACP virtual subnet and the data plane (because those ACP users could leak traffic between ACP and data plane).  This trust could be established, for example, through cryptographic means such as signed software packages.</t>
        </section>
        <section anchor="ACautoconfig" numbered="true" toc="default">
          <name>Autoconfiguration</name>
          <t>ACP edge nodes, NMS hosts, and software components that, as described in the previous section, are meant to be composed via virtual interfaces <bcp14>SHOULD</bcp14> support SLAAC <xref target="RFC4862" format="default"/> on the ACP connect subnet and route autoconfiguration according to "<xref target="RFC4191" format="title"/>" <xref target="RFC4191" format="default"/>.</t>

          <t>The ACP edge node acts as the router towards the ACP on the ACP connect subnet,
          providing the (auto)configured prefix for the ACP connect subnet and
          (auto)configured routes to the ACP to NMS hosts and/or software components.</t>
         
          <t> The ACP edge node uses the Route Information Option (RIO) of <xref target="RFC4191" format="default"/> to announce
          aggregated prefixes for address prefixes used in the ACP (with normal RIO lifetimes).
          In addition, the ACP edge node also uses a RIO to announce the default route (::/0) with
          a lifetime of 0.</t>

          <t>These RIOs allow the connecting of type C hosts to the ACP via an ACP connect subnet on one interface
          and another network (Data Plane and/or NMS network) on the same or another interface of the type C host, relying on 
          routers other than the ACP edge node. The RIOs ensure that these hosts will only route the prefixes used in the ACP to
          the ACP edge node.</t>
          <t>Type A and B hosts ignore the RIOs and will consider the ACP node to be their default router for 
          all destinations.  This is sufficient when the type A or type B host only needs to connect to the ACP but not to other networks.
          Attaching a type A or type B host to both the ACP and other networks 
   requires explicit ACP prefix route configuration on either the host or 
   the combined ACP and data plane interface on the ACP edge node,
          see <xref target="SingleIF" format="default"/>.</t>
          <t>Aggregated prefix means that the ACP edge node needs to only announce
          the /48 ULA prefixes used in the ACP but none of the actual /64
           (Manual Addressing Sub-Scheme), /127 (Zone Addressing Sub-Scheme),
           /112 or /120 (Vlong Addressing Sub-Scheme) routes of actual ACP nodes.
           If ACP interfaces are configured with non-ULA prefixes, then those prefixes cannot be aggregated without further configured policy on the ACP edge node.  This explains the above recommendation to use ACP ULA prefixes for ACP connect interfaces: they allow for a shorter list of prefixes to be signaled via <xref target="RFC4191" format="default"/> to NMS hosts and software components.</t>

          <t>The ACP edge nodes that have a Vlong ACP address <bcp14>MAY</bcp14> allocate a subset of their /112 or /120 address prefix to ACP connect interface(s) to eliminate the need to non-autonomically configure and/or provision the address prefixes for such ACP connect interfaces.</t>
        </section>
        <section anchor="SingleIF" numbered="true" toc="default">
          <name>Combined ACP and Data Plane Interface (VRF Select)</name>
          <figure anchor="vrf-select">
            <name>VRF Select</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[

                     Combined ACP and data plane interface
                                             .
  +--------+       +--------------------+    .   +--------------+
  | ACP    |       |ACP Edge No         |    .   | NMS Host(s)  |
  | Node   |       |                    |    .   | / Software   |
  |        |       |  [ACP  ].          |    .   |              |+
  |        |       | .[VRF  ] .[VRF   ] |    v   | "ACP Address"||
  |        +-------+.         .[Select].+--------+ "Data Plane  ||
  |        |   ^   | .[Data ].          |        |  Address(es)"||
  |        |   .   |  [Plane]           |        |              ||
  |        |   .   |  [     ]           |        +--------------+|
  +--------+   .   +--------------------+         +--------------+
               .
        Data plane "native" and + ACP auto-negotiated/encrypted

]]></artwork>
          </figure>
          <t>Using two physical and/or virtual subnets (and therefore interfaces) to NMS hosts (as per <xref target="NMS" format="default"/>) or software (as per <xref target="software" format="default"/>) may be seen as additional complexity, for example, with legacy NMS hosts that support only one IP interface, or it may be insufficient to support type A or type B hosts <xref target="RFC4191" format="default"/> (see <xref target="ACautoconfig" format="default"/>).</t>
          <t>To provide a single subnet to both the ACP and Data plane, the ACP edge node needs to demultiplex packets from NMS hosts into ACP VRF and data plane.  This is sometimes called "VRF select".  If the ACP VRF has no overlapping IPv6 addresses with the data plane (it should have no overlapping addresses), then this function can use the IPv6 destination address.  The problem is source address selection on the NMS host(s) according to <xref target="RFC6724" format="default"/>.</t>
          <t>Consider the simple case: the ACP uses only one ULA prefix, and the ACP IPv6 prefix for the combined ACP and data plane interface is covered by that ULA prefix.  The ACP edge node announces both the ACP IPv6 prefix and one (or more) prefixes for the data plane.  Without further policy configurations on the NMS host(s), it may select its ACP address as a source address for data plane ULA destinations because of Rule 8 (<xref target="RFC6724" section="5" sectionFormat="of" format="default"/>).  The ACP edge node can pass on the packet to the data plane, but the ACP source address should not be used for data plane traffic, and return traffic may fail.</t>
          <t>If the ACP carries multiple ULA prefixes or non-ULA ACP connect prefixes, then the correct source address selection becomes even more problematic.</t>
          <t>With separate ACP connect and data plane subnets and prefix announcements <xref target="RFC4191" format="default"/> that are to be routed across the ACP connect interface, the source address selection of Rule 5 (use address of outgoing interface) (<xref target="RFC6724" section="5" sectionFormat="of" format="default"/>) will be used, so that above problems do not occur, even in more complex cases of multiple ULA and non-ULA prefixes in the ACP routing table.</t>
          <t>To achieve the same behavior with a combined ACP and data plane interface, the ACP edge node needs to behave as two separate routers on the interface: one link-local IPv6 address/router for its ACP reachability, and one link-local IPv6 address/router for its data plane reachability.  The Router Advertisements for both are as described in <xref target="ACautoconfig" format="default"/>: for the ACP, the ACP prefix is announced together with the prefix option <xref target="RFC4191" format="default"/> routed across the ACP, and the lifetime is set to zero to disqualify this next hop as a default router.  For the data plane, the data plane prefix(es) are announced together with whatever default router parameters are used for the data plane.</t>
          <t>As a result, source address selection Rule 5.5 (<xref target="RFC6724" section="5" sectionFormat="of" format="default"/>) may result in the same correct source address selection behavior of NMS hosts without further configuration as the separate ACP connect and data plane interfaces on the host.  As described in the text for Rule 5.5 (<xref target="RFC6724" section="5" sectionFormat="of" format="default"/>), this is only a <bcp14>MAY</bcp14> because IPv6 hosts are not required to track next-hop information.  If an NMS host does not do this, then separate ACP connect and data plane interfaces are the preferable method of attachment.  Hosts implementing "<xref target="RFC8028" format="title"/>" <xref target="RFC8028" format="default"/> should (instead of may) implement Rule 5.5 (<xref target="RFC6724" section="5" sectionFormat="of" format="default"/>), so it is preferred for hosts to support <xref target="RFC8028" format="default"/>.</t>
          <t>ACP edge nodes <bcp14>MAY</bcp14> support the combined ACP and data plane interface.</t>
        </section>
        <section anchor="ACgrasp" numbered="true" toc="default">
          <name>Use of GRASP</name>
          <t>GRASP can and should be possible to use across ACP connect interfaces, especially in
the architecturally correct solution when it is used as a mechanism to connect software
(e.g., ASA or legacy NMS applications) to the ACP.</t>
          <t>Given how the ACP is the security and transport substrate for GRASP, the requirements
are that those devices connected via ACP connect are equivalently (if not better)
secured against attacks than ACP nodes that do not use ACP connect, and they run only
software that is equally (if not better) protected, known (or trusted) not to be malicious,
and accordingly designed to isolate access to the ACP against external equipment.</t>
          <t>The difference in security is that cryptographic security of the
ACP secure channel is replaced by required physical security and/or control of the network connection
between an ACP edge node and the NMS or other host reachable via the ACP connect
interface. See <xref target="NMS" format="default"/>.</t>
          <t>When using the combined ACP and data plane interface, care has to be taken that
only GRASP messages received from software or
NMS hosts and intended for the ACP GRASP domain are forwarded by ACP edge nodes.  Currently there is no definition for
a GRASP security and transport substrate beside the ACP, so there is no definition
how such software/NMS host could participate in two separate GRASP domains across
the same subnet (ACP and data plane domains).  Currently it is assumed that
all GRASP packets on a combined ACP and data plane interface belong to the GRASP ACP domain.
They <bcp14>SHOULD</bcp14> all use the ACP IPv6 addresses of the software/NMS hosts.  The link-local
IPv6 addresses of software/NMS hosts (used for GRASP M_DISCOVERY and M_FLOOD messages)
are also assumed to belong to the ACP address space.</t>
        </section>
      </section>
      <section anchor="remote-acp-neighbors" numbered="true" toc="default">
        <name>Connecting ACP Islands over Non-ACP L3 Networks (Remote ACP Neighbors)</name>
        <t>Not all nodes in a network may support the ACP.  If non-ACP L2 devices are between ACP nodes, the ACP will work across them since it is IP based.  However, the autonomic discovery of ACP neighbors via DULL GRASP is only intended to work across L2 connections, so it is not sufficient to autonomically create ACP connections across non-ACP L3 devices.</t>
        <section anchor="conf-remote" numbered="true" toc="default">
          <name>Configured Remote ACP Neighbor</name>
          <t>On the ACP node, remote ACP neighbors are configured explicitly. 
    The parameters of such a "connection" are described in the following ABNF.
    The syntax shown is non-normative (as there are no standards for
  configuration) but only meant to illustrate the parameters and which
  ones can be optional.</t>
          <figure anchor="abnf">
            <name>Parameters for Remote ACP Neighbors</name>

            <sourcecode name="" type="abnf"><![CDATA[
  connection = method "," local-addr "," remote-addr [ "," pmtu ]
  method =    "any"
             / ( "IKEv2" [ ":" port ] )    
             / (  "DTLS"  [ ":"  port ] )
  port = 1*DIGIT
  local-addr  = [ address  [ ":" vrf  ] ]
  remote-addr =   address
  address =  "any"
             / IPv4address / IPv6address  ; From [RFC5954]
  vrf = system-dependent ; Name of VRF for local-address
 ]]></sourcecode>
          </figure>
          <t>Explicit configuration of a remote peer according to this
ABNF provides all the information to build a secure channel without requiring a tunnel
to that peer and running DULL GRASP inside of it.</t>
          <t>The configuration includes the parameters otherwise signaled
via DULL GRASP: local address, remote (peer) locator, and
method. The differences over DULL GRASP local neighbor
discovery and secure channel creation are as follows:</t>
          <ul spacing="normal">
            <li>The local and remote address can be IPv4 or IPv6 and are typically global-scope addresses.</li>
            <li>The VRF across which the connection is built (and in which local-addr exists) can be specified.  If vrf is not specified, it is the default VRF on the node.  In DULL GRASP, the VRF is implied by the interface across which DULL GRASP operates.</li>
            <li>If local address is "any", the local address used when initiating a secure channel connection is decided by source address selection (<xref target="RFC6724" format="default"/> for IPv6). As a responder, the connection listens on all addresses of the node in the selected VRF.</li>
            <li>Configuration of port is only required for methods where no defaults exist (e.g., "DTLS").</li>
            <li>If the remote address is "any", the connection is only a responder. It is a "hub" that can be used by multiple remote peers to connect simultaneously -- without having to know or configure their addresses, for example, a hub site for remote "spoke" sites reachable over the Internet.</li>
            <li>The pmtu parameter should be configurable to overcome issues or limitations of Path MTU Discovery (PMTUD).</li>
            <li>IKEv2/IPsec to remote peers should support the optional NAT Traversal (NAT-T) procedures.</li>
          </ul>
        </section>
        <section anchor="conf-tunnel" numbered="true" toc="default">
          <name>Tunneled Remote ACP Neighbor</name>

          <t>An IP-in-IP, GRE, or other form of preexisting tunnel is configured
        between two remote ACP peers, and the virtual interfaces representing
        the tunnel are configured for "ACP enable".  This will enable IPv6
        link-local addresses and DULL on this tunnel.  As a result,  the tunnel
        is used for normal "L2 adjacent" candidate ACP neighbor discovery
        with DULL and secure channel setup procedures described in this document.</t>

          <t>Tunneled Remote ACP Neighbor requires two encapsulations:
        the configured tunnel and the secure channel inside of that tunnel.
        This makes it in general less desirable than Configured Remote ACP Neighbor.
        Benefits of tunnels are that it may be easier to implement because
        there is no change to the ACP functionality - just running it over
        a virtual (tunnel) interface instead of only native interfaces.
        The tunnel itself may also provide PMTUD while the secure channel
        method may not.  Or the tunnel mechanism is permitted/possible through some
        firewall while the secure channel method may not.</t>

        <t>Tunneling using an insecure tunnel encapsulation increases, on average,
     the risk of a MITM downgrade attack somewhere along the underlay path.
     In such an attack, the MITM filters packets for all but the most easily
     attacked ACP secure channel option to force use of that option.
        ACP nodes supporting Tunneled Remote ACP Neighbors <bcp14>SHOULD</bcp14> support
        configuration on such tunnel interfaces to restrict or explicitly
        select the available ACP secure channel protocols 
        (if the ACP node supports more than one ACP secure channel protocol in the first place).</t>

        </section>
        <section anchor="conf-summary" numbered="true" toc="default">
          <name>Summary</name>
          <t>Configured and Tunneled Remote ACP Neighbors are less "indestructible"
        than L2 adjacent ACP neighbors based on link-local addressing, since
        they depend on more correct data plane operations, such as routing and global addressing.</t>
          <t>Nevertheless, these options may be crucial to incrementally deploying
        the ACP, especially if it is meant to connect islands across the Internet.
        Implementations <bcp14>SHOULD</bcp14> support at least Tunneled Remote ACP Neighbors
        via GRE tunnels, which is likely the most common router-to-router
        tunneling protocol in use today.</t>
        </section>
      </section>
    </section>
    <section anchor="operational" numbered="true" toc="default">
      <name>ACP Operations (Informative)</name>
      <t>The following sections document important operational aspects of the ACP. They are not normative because they do not impact the interoperability between components of the ACP, but they include recommendations and/or requirements for the internal operational model that are beneficial or necessary to achieve the desired use-case benefits of the ACP (see <xref target="usage" format="default"/>).</t>
      <ul spacing="normal">
        <li><xref target="diagnostics" format="default"/> describes the recommended capabilities of operator diagnostics of ACP nodes.</li>
        <li><xref target="registrar-considerations" format="default"/> describes at a high level how an ACP registrar needs to work, what its configuration parameters are, and specific issues impacting the choices of deployment design due to renewal and revocation issues. It describes a model where ACP registrars have their own sub-CA to provide the most distributed deployment option for ACP registrars, and it describes considerations for centralized policy control of ACP registrar operations.</li>
        <li><xref target="enabling-acp" format="default"/> describes suggested ACP node behavior and operational interfaces (configuration options) to manage the ACP in so-called greenfield devices (previously unconfigured) and brownfield devices (preconfigured).</li>
      </ul>
      <t>The recommendations and suggestions of this chapter were derived from operational experience gained with a commercially available pre-standard ACP implementation.</t>
      <section anchor="diagnostics" numbered="true" toc="default">
        <name>ACP (and BRSKI) Diagnostics</name>
        <t>Even though ACP and ANI in general are removing many manual configuration mistakes
through their automation, it is important to provide good diagnostics for them.</t>
        <t>Basic standardized diagnostics would require support for (YANG) models representing the
complete (auto)configuration and operational state of all components: GRASP,
ACP, and the infrastructure used by them, such as TLS/DTLS, IPsec, certificates, TA, time, 
VRF, and so on.  While necessary, this is not sufficient.</t>
        <t>Simply representing the state of components does not allow operators to quickly take
action -- unless they understand how to interpret the data, which can mean a
requirement for deep understanding of all components and how they interact in the ACP/ANI.</t>
        <t>Diagnostic supports should help to quickly answer the questions operators
are expected to ask, such as "Is the ACP working correctly?" or "Why is there no
ACP connection to a known neighboring node?"</t>
        <t>In current network management approaches, the logic to answer these
questions is most often built into centralized diagnostics software that leverages
the above mentioned data models.  While this approach is feasible for components
utilizing the ANI, it is not sufficient to diagnose the ANI itself:</t>
        <ul spacing="normal">
          <li>Developing the logic to identify common issues requires operational experience
with the components of the ANI.  Letting each management system define its
own analysis is inefficient.</li>
          <li>When the ANI is not operating correctly, it may not be possible to run diagnostics
remotely because of missing connectivity.  The ANI should therefore have diagnostic
capabilities available locally on the nodes themselves.</li>
          <li>Certain operations are difficult or impossible to monitor in real time, such as
initial bootstrap issues in a network location where no capabilities exist to attach
local diagnostics.  Therefore, it is important to also define how to capture (log)
diagnostics locally for later retrieval.  Ideally, these captures are also nonvolatile so
that they can survive extended power-off conditions, for example, when a device
that fails to be brought up zero-touch is sent for diagnostics at a
more appropriate location.</li>
        </ul>
        <t>The simplest form of diagnostics for answering questions such as the above
is to represent the relevant information sequentially in dependency order,
so that the first unexpected and/or nonoperational item is the most likely root
cause, or just log and/or highlight that item.  For example:</t>
        <t>Question: Is the ACP operational to accept neighbor connections?
</t>
        <ul spacing="normal">
          <li>Check if the necessary configurations to make ACP/ANI operational are correct (see <xref target="enabling-acp" format="default"/> for a discussion of such commands).</li>
          <li>Does the system time look reasonable, or could it be the default system time after battery failure of the clock chip? Certificate checks depend on reasonable notion of time.</li>
          <li>Does the node have keying material, such as domain certificate, TA certificates, etc.?</li>
          <li>If there is no keying material and the ANI is supported/enabled,
   check the state of BRSKI (not detailed in this example).</li>
          <li>
            <t>Check the validity of the domain certificate:
    </t>
            <ul spacing="normal">
              <li>Does the certificate validate against the TA?</li>
              <li>Has it been revoked?</li>
              <li>Was the last scheduled attempt to retrieve a CRL successful? (e.g., do we know that our CRL information is up to date?)</li>
              <li>Is the certificate valid? The validity start time is in the past, and the expiration time is in the future?</li>
              <li>Does the certificate have a correctly formatted acp-node-name field?</li>
            </ul>
          </li>
          <li>Was the ACP VRF successfully created?</li>
          <li>Is ACP enabled on one or more interfaces that are up and running?</li>
        </ul>
        <t>If all of the above looks good, the ACP should be running "fine" locally, but we did not check any ACP neighbor relationships.</t>
        <t>Question: Why does the node not create a working ACP connection to a neighbor on an interface?
</t>
        <ul spacing="normal">
          <li>Is the interface physically up? Does it have an IPv6 link-local address?</li>
          <li>Is it enabled for ACP?</li>
          <li>Do we successfully send DULL GRASP messages to the interface? (Are there link-layer errors?)</li>
          <li>Do we receive DULL GRASP messages on the interface? If not, some intervening L2 equipment performing bad MLD snooping could have caused problems.  Provide, e.g., diagnostics of the MLD querier IPv6 and MAC address.</li>
          <li>Do we see the ACP objective in any DULL GRASP message from that interface? Diagnose the supported secure channel methods.</li>
          <li>Do we know the MAC address of the neighbor with the ACP objective? If not, diagnose SLAAC/ND state.</li>
          <li>When did we last attempt to build an ACP secure channel to the neighbor?</li>
          <li>
            <t>If it failed:
    </t>
            <ul spacing="normal">
              <li>Did the neighbor close the connection on us, or did we close the connection on it because the domain certificate membership failed?</li>
              <li>If the neighbor closed the connection on us, provide any error diagnostics from the secure channel protocol.</li>
              <li>
                <t>If we failed the attempt, display our local reason:
        </t>
                <ul spacing="normal">
                  <li>There was no common secure channel protocol supported by the two neighbors (this could not happen on nodes supporting this specification because it mandates common support for IPsec).</li>
                  <li>
                    <t>Did the ACP certificate membership check (<xref target="certcheck" format="default"/>) fail?
            </t>
                    <ul spacing="normal">
                      <li>The neighbor's certificate is not signed directly or indirectly by one of the node's TA.  Provide diagnostics which TA it has (can identify whom the device belongs to).</li>
                      <li>The neighbor's certificate does not have the same domain (or no domain at all).  Diagnose acp-domain-name and potentially other cert info.</li>
                      <li>The neighbor's certificate has been revoked or could not be authenticated by OCSP. </li>
                      <li>The neighbor's certificate has expired, or it is not yet valid.</li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li>Are there any other connection issues, e.g., IKEv2/IPsec, DTLS?</li>
            </ul>
          </li>
        </ul>
        <t>Question: Is the ACP operating correctly across its secure channels?
</t>
        <ul spacing="normal">
          <li>Are there one or more active ACP neighbors with secure channels?</li>
          <li>Is RPL for the ACP running?</li>
          <li>Is there a default route to the root in the ACP routing table?</li>
          <li>Is there, for each direct ACP neighbor not reachable over the ACP virtual interface to the root, a route in the ACP routing table?</li>
          <li>Is ACP GRASP running?</li>
          <li>Is at least one "SRV.est" objective cached (to support certificate renewal)?</li>
          <li>Is there at least one BRSKI registrar objective cached? (If BRSKI is supported.)</li>
          <li>Is the BRSKI proxy operating normally on all interfaces where ACP is operating?</li>
        </ul>
        <t>These lists are not necessarily complete, but they illustrate the principle and show that there are variety of issues ranging from normal operational causes (a neighbor in another ACP domain) to problems in the credentials management (certificate lifetimes), to explicit security actions (revocation) or unexpected connectivity issues (intervening L2 equipment).</t>
        <t>The items so far illustrate how the ANI operations can
be diagnosed with passive observation of the operational state
of its components including historic, cached, and/or counted events.  This is
not necessarily sufficient to provide good enough diagnostics overall.</t>
        <t>The components of ACP and BRSKI are designed with security in mind,
but they do not attempt to provide diagnostics for building the
network itself.  Consider two examples:
</t>
        <ol type="1" spacing="normal">
          <li>BRSKI does not allow for a neighboring
    device to identify the pledge's IDevID certificate.  Only the selected
    BRSKI registrar can do this, but it may be difficult to disseminate
    information from those BRSKI registrars about undesired pledges to locations and/or nodes
    where information about those pledges is desired.</li>
          <li>LLDP disseminates information about nodes,
    such as node model, type, and/or software and interface name and/or number of the
    connection, to their immediate neighbors.  This information is often helpful or even necessary
    in network diagnostics.  It can equally be considered too insecure
    to make this information available unprotected to all possible neighbors.</li>
        </ol>
        <t>An "interested adjacent party" can always determine the IDevID certificate of a BRSKI pledge
by behaving like a BRSKI proxy/registrar.  Therefore, the IDevID certificate of a BRSKI pledge 
is not meant to be protected -- it just has to be queried and is not
signaled unsolicited (as it would be in LLDP) so that other observers
on the same subnet can determine who is an "interested adjacent party".</t>
        <section anchor="ta-troubleshoot" numbered="true" toc="default">
          <name>Secure Channel Peer Diagnostics</name>
          <t>When using mutual certificate authentication, the TA certificate is not required
to be signaled explicitly because its hash is sufficient for certificate
chain validation.  In the case of ACP secure channel setup, this leads
to limited diagnostics when authentication fails because of TA mismatch.
For this reason, <xref target="common-requirements" format="default"/> recommends also including the TA certificate in the
secure channel signaling. This should be possible
to do without modifying the security association protocols used by the
ACP. For example, while <xref target="RFC7296" format="default"/> does not mention this, it
also does not prohibit it.</t>
          <t>One common use case where diagnostics through the signaled
TA of a candidate peer are very helpful is the multi-tenant environment, such as
an office building, where different tenants run their own networks and ACPs.
Each tenant is given supposedly disjoint L2 connectivity through the building infrastructure.
In these environments, there are various common errors through which a device may
receive L2 connectivity into the wrong tenant's network.</t>
          <t>While the ACP itself is not impacted by this, the data plane to be built later may be
impacted. Therefore, it is important to be able to diagnose such undesirable
connectivity from the ACP so that any autonomic or non-autonomic mechanisms
to configure the data plane can treat such interfaces accordingly. 
The information in the TA of the peer can then ease
troubleshooting of such issues.</t>
          <t>Another use case is the intended or accidental reactivation of equipment,
such as redundant gear taken from storage, whose TA certificate has long expired.</t> 
          <t>A third use case is when, in a merger and acquisition case, ACP nodes have not
been correctly provisioned with the mutual TA of a previously disjoint ACP. This
assumes that the ACP domain names were already aligned so that the ACP
domain membership check is only failing on the TA.</t>
          <t>A fourth use case is when multiple registrars are set up for the same
ACP but are not correctly set up with the same TA. For example, when registrars
support also being CAs themselves but are misconfigured to become TAs instead
of intermediate CAs.</t>
        </section>
      </section>
      <section anchor="registrar-considerations" numbered="true" toc="default">
        <name>ACP Registrars</name>
        <t>As described in <xref target="acp-registrars" format="default"/>, the ACP addressing
mechanism is designed to enable lightweight, distributed, and uncoordinated
ACP registrars that provide ACP address prefixes to candidate ACP
nodes by enrolling them with an ACP certificate into an ACP domain via
any appropriate mechanism and/or protocol, automated or not.</t>
        <t>This section discusses informatively more details and options for ACP registrars.</t>
        <section anchor="reg-interact" numbered="true" toc="default">
          <name>Registrar Interactions</name>
          <t>This section summarizes and discusses the interactions with other entities required
by an ACP registrar.</t>
          <t>In a simple instance of an ACP network, no central NOC component beside
a TA is required. Typically, this is a root CA.  One or more uncoordinated acting
ACP registrars can be set up, performing the following interactions.</t>
          <t>To orchestrate enrolling a candidate ACP node autonomically,
the ACP registrar can rely on the ACP and use proxies to reach the candidate ACP node,
therefore allowing minimal, preexisting (auto)configured network services
on the candidate ACP node.  BRSKI defines the BRSKI proxy, a design that can be
adopted for various protocols that pledges and/or candidate ACP nodes could want to use,
for example, BRSKI over CoAP (Constrained Application Protocol) or the proxying of
NETCONF.</t>
          <t>To reach a TA that has no ACP connectivity, the ACP registrar uses
the data plane. The ACP and data plane in an ACP registrar could (and by default
should) be completely isolated from each other at the network level.
Only applications such as the ACP registrar would need the ability for
 their transport stacks to access both.</t>
          <t>In non-autonomic enrollment options, the data plane 
between an ACP registrar and the candidate ACP node needs to be configured
first.  This includes the ACP registrar and the candidate ACP node.
Then any appropriate set of protocols can be used between the ACP registrar and
the candidate ACP node to discover the other side, and then connect 
and enroll (configure) the candidate ACP node with an ACP certificate.
For example, NETCONF Zero Touch ("<xref target="RFC8572" format="title"/>" <xref target="RFC8572" format="default"/>)
is a protocol that could be used for this.  BRSKI using optional
discovery mechanisms is equally a possibility for candidate ACP nodes
attempting to be enrolled across non-ACP networks, such as the Internet.</t>
          <t>When a candidate ACP node, such as a BRSKI pledge, has secure bootstrap, 
it will not trust being configured and/or enrolled across the network unless
it is presented with a voucher (see "<xref target="RFC8366" format="title"/>" <xref target="RFC8366" format="default"/>) authorizing
the network to take possession of the node. An ACP registrar will then need a
method to retrieve such a voucher, either offline or online from a MASA
(Manufacturer Authorized Signing Authority). BRSKI and NETCONF
Zero Touch are two protocols that include capabilities to present the voucher
to the candidate ACP node.</t>
          <t>An ACP registrar could operate EST for ACP certificate renewal and/or
act as a CRL Distribution Point. A node performing these
services does not need to support performing (initial) enrollment, but
it does require the same above described connectivity as an ACP
registrar: via the ACP to the ACP nodes and via the data plane to the TA
and other sources of CRL information.</t>
        </section>
        <section anchor="reg-config" numbered="true" toc="default">
          <name>Registrar Parameters</name>
          <t>The interactions of an ACP registrar outlined in <xref target="acp-registrars" format="default"/> and
<xref target="reg-interact" format="default"/> depend on the following parameters:
</t>
          <ul spacing="normal">
            <li>A URL to the TA and credentials so that the ACP
   registrar can let the TA sign candidate ACP node certificates.</li>
            <li>The ACP domain name.</li>
            <li>The Registrar-ID to use. This could default to a MAC address of the ACP registrar.</li>

            <li>For recovery, the next usable Node-IDs for the Zone Addressing Sub-Scheme (Zone-ID 0)
     and for the Vlong Addressing Sub-Scheme (/112 and /120). These IDs would only need
     to be provisioned after recovering from a crash. Some other mechanism would 
     be required to remember these IDs in a backup location or to recover them
     from the set of currently known ACP nodes.</li>

            <li>Policies on whether the candidate ACP nodes should receive a domain certificate or not,
     for example, based on the device's IDevID certificate as in BRSKI. The ACP registrar may 
     whitelist or blacklist based on a device's "serialNumber" attribute <xref target="X.520" format="default"/> in the subject field distinguished name encoding of its IDevID certificate.</li>

            <li>Policies on what type of address prefix to assign to a candidate ACP device,
     likely based on the same information.</li>
            <li>For BRSKI or other mechanisms using vouchers: parameters to determine
     how to retrieve vouchers for specific types of secure bootstrap candidate
     ACP nodes (such as MASA URLs), unless this information is automatically
     learned, such as from the IDevID certificate of candidate ACP nodes (as defined in BRSKI).</li>
          </ul>
        </section>
        <section anchor="cert-renewal" numbered="true" toc="default">
          <name>Certificate Renewal and Limitations</name>
          <t>When an ACP node renews and/or rekeys its certificate, it may end up doing so via
a different registrar (e.g., EST server) than the one it originally received
its ACP certificate from, for example, because that original ACP registrar
is gone. The ACP registrar through which the renewal/rekeying is performed
would by default trust the acp-node-name from the ACP node's current
ACP certificate and maintain this information so that the ACP node
maintains its ACP address prefix. In EST renewal/rekeying, the ACP node's current
ACP certificate is signaled during the TLS handshake.</t>
          <t>This simple scenario has two limitations:
</t>
          <ol type="1" spacing="normal">
            <li>The ACP registrar cannot directly assign certificates to nodes and
     therefore needs an "online" connection to the TA.</li>
            <li>Recovery from a compromised ACP registrar is difficult.
     When an ACP registrar is compromised, it can insert, for example,
     a conflicting acp-node-name and thereby create an attack
     against other ACP nodes through the ACP routing protocol.</li>
          </ol>
          <t>Even when such a malicious ACP registrar is detected, resolving the
problem may be difficult because it would require identifying all the
wrong ACP certificates assigned via the ACP registrar after it
was compromised. Without additional centralized tracking of assigned
certificates, there is no way to do this.</t>
        </section>
        <section anchor="sub-ca" numbered="true" toc="default">
          <name>ACP Registrars with Sub-CA</name>
          <t>In situations where either of the above two limitations are an issue,
ACP registrars could also be sub-CAs. This removes the need for
connectivity to a TA whenever an ACP node is enrolled, and it reduces
the need for connectivity of such an ACP registrar to a TA to only
those times when it needs to renew its own certificate. The ACP registrar
would also now use its own (sub-CA) certificate to enroll and sign the
ACP node's certificates, and therefore it is only necessary to revoke
a compromised ACP registrar's sub-CA certificate. Alternatively, one can
let it expire and not renew it when the certificate of the sub-CA is appropriately
short-lived.</t>
          <t>As the ACP domain membership check verifies a
peer ACP node's ACP certificate trust chain, it will also verify
the signing certificate, which is the compromised and/or revoked sub-CA certificate.
Therefore, ACP domain membership for an ACP node enrolled by a
compromised and discovered ACP registrar will fail.</t>
          <t>ACP nodes enrolled by a compromised ACP registrar
would automatically fail to establish ACP channels and ACP domain
certificate renewal via EST and therefore revert to their role as 
candidate ACP members and attempt to get a new ACP certificate
from an ACP registrar, for example, via BRSKI. As a result, ACP registrars that have an
associated sub-CA make isolating and resolving issues with
compromised registrars easier.</t>
          <t>Note that ACP registrars with sub-CA functionality also can control the
lifetime of ACP certificates more easily and therefore can be used as
a tool to introduce short-lived certificates and to no longer rely on CRL,
whereas the certificates for the sub-CAs themselves could be longer
lived and subject to CRL.</t>
        </section>
        <section anchor="pms" numbered="true" toc="default">
          <name>Centralized Policy Control</name>
          <t>When using multiple, uncoordinated ACP registrars, several advanced
operations are potentially more complex than with a single, resilient
 policy control backend, for example, including but not limited to the following:
</t>
          <ul spacing="normal">
            <li>Deciding which candidate ACP node is permitted or not permitted into an
     ACP domain. This may not be a decision to be made upfront, so that
     a policy per "serialNumber" attribute in the subject field distinguished name encoding  can be loaded into every ACP registrar.
     Instead, it may better be decided in real time, potentially including
     a human decision in a NOC.</li>
            <li>Tracking all enrolled ACP nodes and their certificate information.
     For example, in support of revoking an individual ACP node's certificates.</li>
            <li>Needing more flexible policies as to which type of address prefix or even which specific
     address prefix to assign to a candidate ACP node.</li>
          </ul>
          <t>These and other operations could be introduced more easily by
introducing a centralized Policy Management System (PMS) and modifying 
ACP registrar behavior so that it queries the PMS for any policy decision
occurring during the candidate ACP node enrollment process and/or the
ACP node certificate renewal process, for example, which ACP address
prefix to assign. Likewise, the ACP registrar would report any relevant state
change information to the PMS as well, for example, when a certificate
was successfully enrolled onto a candidate ACP node.</t>
        </section>
      </section>
      <section anchor="enabling-acp" numbered="true" toc="default">
        <name>Enabling and Disabling the ACP and/or the ANI</name>
        <t> Both ACP and BRSKI require interfaces to be operational enough to support the sending and receiving of their packets.  In node types where interfaces are enabled by default (e.g., without operator configuration), such as most L2 switches, this would be less of a change in behavior than in most L3 devices (e.g., routers), where interfaces are disabled by default.  In almost all network devices, though, it is common for configuration to change interfaces to a physically disabled state, and this would break the ACP.</t>
        <t>In this section, we discuss a suggested operational model to enable and disable interfaces and nodes for ACP/ANI in a way that minimizes the risk of breaking the ACP due to operator action and also minimizes operator surprise when the ACP/ANI becomes supported in node software.</t>
        <section anchor="secure-enabling" numbered="true" toc="default">
          <name>Filtering for Non-ACP/ANI Packets</name>
          <t>Whenever this document refers to enabling an interface for ACP (or BRSKI), it only requires permitting the interface to send and receive packets necessary to operate ACP (or BRSKI) -- but not any other data plane packets.  Unless the data plane is explicitly configured and enabled, all packets that are not required for ACP/BRSKI should be filtered on input and output.</t>
          <t>Both BRSKI and ACP require link-local-only IPv6 operations on interfaces and DULL GRASP.  IPv6 link-local operations mean the minimum signaling to auto-assign an IPv6 link-local address and talk to neighbors via their link-local addresses: SLAAC <xref target="RFC4862" format="default"/> and ND <xref target="RFC4861" format="default"/>.  When the device is a BRSKI pledge, it may also require TCP/TLS connections to BRSKI proxies on the interface.  When the device has keying material, and the ACP is running, it requires DULL GRASP packets and packets necessary for the secure channel mechanism it supports, e.g., IKEv2 and IPsec ESP packets or DTLS packets to the IPv6 link-local address of an ACP neighbor on the interface.  It also requires TCP/TLS packets for its BRSKI proxy functionality if it supports BRSKI.</t>
        </section>
        <section anchor="admin-down" numbered="true" toc="default">
          <name>"admin down" State</name>
          <t>Interfaces on most network equipment have at least two states: "up" and "down".  These may have product-specific names.  For example, "down" could be called "shutdown", and "up" could be called "no shutdown".  The "down" state disables all interface operations down to the physical level.  The "up" state enables the interface enough for all possible L2/L3 services to operate on top of it, and it may also auto-enable some subset of them.  More commonly, the operations of various L2/L3 services are controlled via additional node-wide or interface-level options, but they all become active only when the interface is not "down".  Therefore, an easy way to ensure that all L2/L3 operations on an interface are inactive is to put the interface into "down" state.  The fact that this also physically shuts down the interface is just a side effect in many cases, but it may be important in other cases (see <xref target="down-fast-state-propagation" format="default"/>).</t>
          <t>A common problem of remote management is the operator or SDN controller cutting its own connectivity to the remote node via configuration, impacting its own management connection to the node. The ACP itself should have no dedicated configuration other than the aforementioned enabling of the ACP on brownfield ACP nodes. This leaves configuration that cannot distinguish between the ACP and data plane as sources of configuration mistakes as these commands will impact the ACP even though they should only impact the data plane.</t>
          <t>The one ubiquitous type of command that does this on many types of routers is the interface "down" command/configuration. When such a command is applied to the interface through which the ACP provides access for remote management, it cuts the remote management connection through the ACP because, as outlined above, the "down" command typically impacts the physical layer, too, and not only the data plane services.</t>
          <t>To provide ACP/ANI resilience against such operator misconfiguration, this document 
recommends separating the "down" state of interfaces into an "admin down" state, where the physical layer is kept running and the ACP/ANI can use the interface, and a "physical down" state.  Any existing "down" configurations would map to "admin down".  In "admin down", any existing L2/L3 services of the data plane should see no difference to "physical down" state.  To ensure that no data plane packets could be sent or received, packet filtering could be established automatically as described in <xref target="secure-enabling" format="default"/>.</t>
          <t>An example of ANI, but not ACP, traffic that should be permitted to pass even in "admin down" state is BRSKI enrollment traffic between a BRSKI pledge and a BRSKI proxy.</t>
          <t>New configuration options could be introduced as necessary (see discussion below) to issue "physical down".  The options should be provided with additional checks to minimize the risk of issuing them in a way that breaks the ACP without automatic restoration.  Examples of checks include not allowing the option to be issued from a control connection (NETCONF/SSH) that goes across the interface itself ("do not disconnect yourself") or only applying the option after additional reconfirmation.</t>
          <t>The following subsections discuss important aspects of the introduction of "admin down" state.</t>
          <section anchor="down-security" numbered="true" toc="default">
            <name>Security</name>
            <t>Interfaces are physically brought down (or left in default "down" state) as a form of security.
The "admin down" state as described above also provides also a high level of security
because it only permits ACP/ANI operations, which are both well secured.  Ultimately, it is subject to
the deployment's security review  whether "admin down" is a feasible replacement for "physical down".</t>
            <t>The need to trust the security of ACP/ANI operations needs to be weighed against
the operational benefits of permitting the following: consider the typical example of a CPE (customer
premises equipment) with no on-site network expert.  User ports are in "physical
down" state unless explicitly configured not to be.  In a misconfiguration situation, the uplink
connection is incorrectly plugged into such a user port.  The device is disconnected from the
network, and therefore diagnostics from the network side are no longer possible.
Alternatively, all ports default to "admin down".  The ACP (but not the data plane) would
still automatically form.  Diagnostics from the network side are possible, and operator
reaction could include either to make this port the operational uplink port or to instruct
re-cabling.  Security wise, only the ACP/ANI could be attacked, all other functions are filtered
on interfaces in "admin down" state.</t>
          </section>
          <section anchor="down-fast-state-propagation" numbered="true" toc="default">
            <name>Fast State Propagation and Diagnostics</name>
            <t>The "physical down" state propagates on many interface types (e.g., Ethernet) to the other side.
This can trigger fast L2/L3 protocol reaction on the other side, and "admin down" would not
have the same (fast) result.</t>
            <t>Bringing interfaces to "physical down" state is, to the best of our knowledge, always
a result of operator action and, today, never the result of autonomic L2/L3 services
running on the nodes.  Therefore, one option is to end the operator's reliance  
on interface state propagation via the subnet link or physical layer.  This may not be possible when both sides are
under the control of different operators, but in that case, it is unlikely that the ACP is running
across the link, and actually putting the interface into "physical down" state may
still be a good option.</t>
            <t>Ideally, fast physical state propagation is replaced by fast software-driven state
propagation.  For example, a DULL GRASP "admin-state" objective could be used to autoconfigure
a BFD session ("<xref target="RFC5880" format="title"/>" <xref target="RFC5880" format="default"/>) between the two sides of the link that would be used to propagate the
"up" vs. "admin down" state.</t>
            <t>Triggering "physical down" state may also be used as a means of diagnosing cabling issues
in the absence of easier methods.  It is more complex than automated neighbor diagnostics
because it requires coordinated remote access to (likely) both sides of a link to
determine whether up/down toggling will cause the same reaction on the remote side.</t>
            <t>See <xref target="diagnostics" format="default"/> for a discussion about how LLDP and/or diagnostics
via GRASP could be used to provide neighbor diagnostics and therefore hopefully
eliminate the need for "physical down" for neighbor diagnostics -- as long as both
neighbors support ACP/ANI.</t>
          </section>
          <section anchor="low-level-link" numbered="true" toc="default">
            <name>Low-Level Link Diagnostics</name>
            <t>The "physical down" state is used to diagnose low-level interface behavior when higher-layer services (e.g., IPv6) are not working.  Ethernet links are especially subject to a wide variety of possible incorrect configurations/cablings if they do not support automatic selection of variable parameters such as speed (10/100/1000 Mbps), crossover (automatic medium-dependent interface crossover (MDI-X)), and connector (fiber, copper -- when interfaces have multiple but can only enable one at a time).  The need for low-level link diagnostics can therefore be minimized by using fully autoconfiguring links.</t>
            <t>In addition to the "physical down" state, low-level diagnostics of Ethernet or other interfaces also involve the creation of other states on interfaces, such as physical loopback (internal and/or external) or the bringing down of all packet transmissions for reflection and/or cable-length measurements.  Any of these options would disrupt ACP as well.</t>
            <t>In cases where such low-level diagnostics of an operational link are desired but where the link could be a single point of failure for the ACP, the ASA on both nodes of the link could perform a negotiated diagnostic that automatically terminates in a predetermined manner without dependence on external input, ensuring the link will become operational again.</t>
          </section>
          <section anchor="power-consumption" numbered="true" toc="default">
            <name>Power Consumption Issues</name>
            <t>Power consumption of "physical down" interfaces may be significantly lower than those
in "admin down" state, for example, on long-range fiber interfaces. Bringing up
interfaces, for example, to probe reachability may also consume additional power. This
can make these types of interfaces inappropriate to operate purely for the ACP when 
they are not currently needed for the data plane.</t>
          </section>
        </section>
        <section anchor="if-enable" numbered="true" toc="default">
          <name>Enabling Interface-Level ACP and ANI</name>
          <t>The interface-level configuration option "ACP enable" enables ACP  operations on an interface, starting with ACP neighbor discovery via DULL  GRASP.  The interface-level configuration option "ANI enable" on nodes supporting BRSKI and ACP starts with BRSKI pledge operations when there is no domain certificate on the node.  On ACP/BRSKI nodes, only "ANI enable" may need to be supported and not "ACP enable".  Unless overridden by global configuration options (see <xref target="if-enable-auto"/>), either "ACP enable" or "ANI enable" (both abbreviated as "ACP/ANI enable")  will result in the "down" state on an interface behaving as "admin down".</t>
        </section>
        <section anchor="if-enable-auto" numbered="true" toc="default">
          <name>Which Interfaces to Auto-Enable?</name>
          <t><xref target="discovery-grasp" format="default"/> requires that "ACP enable" is automatically set on native interfaces, but not on non-native interfaces (reminder: a native interface is one that exists without operator configuration action, such as physical interfaces in physical devices).</t>
          <t>Ideally, "ACP enable" is set automatically on all interfaces that provide access to additional connectivity, which allows more nodes of the ACP domain to be reached.  The best set of interfaces necessary to achieve this is not possible to determine automatically.  Native interfaces are the best automatic approximation.</t>
          <t>Consider an ACP domain of ACP nodes transitively connected via native interfaces.  A data plane tunnel between two of these nodes that are nonadjacent is created, and "ACP enable" is set for that tunnel.  ACP RPL sees this tunnel as just as a single hop.  Routes in the ACP would use this hop as an attractive path element to connect regions adjacent to the tunnel nodes.  As a result, the actual hop-by-hop paths used by traffic in the ACP can become worse.  In addition, correct forwarding in the ACP now depends on correct data plane forwarding configuration including QoS, filtering, and other security on the data plane path across which this tunnel runs.  This is the main reason why "ACP/ANI enable" should not be set automatically on non-native interfaces.</t>
          <t>If the tunnel would connect two previously disjoint ACP regions, then it likely would be useful for the ACP.  A data plane tunnel could also run across nodes without ACP and provide additional connectivity for an already connected ACP network.  The benefit of this additional ACP redundancy has to be weighed against the problems of relying on the data plane.  If a tunnel connects two separate ACP regions, how many tunnels should be created to connect these ACP regions reliably enough? Between which nodes? These are all standard tunneled network design questions not specific to the ACP, and there are no generic, fully automated answers.</t>
          <t>Instead of automatically setting "ACP enable" on these types of interfaces, the decision needs to be based on the use purpose of the non-native interface, and "ACP enable" needs to be set in conjunction with the mechanism through which the non-native interface is created and/or configured.</t>
          <t>In addition to the explicit setting of "ACP/ANI enable", non-native interfaces also need to support configuration of the ACP RPL cost of the link to avoid the problems of attracting too much traffic to the link as described above.</t>
          <t>Even native interfaces may not be able to automatically perform BRSKI or ACP because they may require additional operator input to become operational.  Examples include DSL interfaces requiring Point-to-Point Protocol over Ethernet (PPPoE) credentials or mobile interfaces requiring credentials from a SIM card.  Whatever mechanism is used to provide the necessary configuration to the device to enable the interface can also be expanded to decide whether or not to set "ACP/ANI enable".</t>
          <t>The goal of automatically setting "ACP/ANI enable" on interfaces (native or not) is to eliminate unnecessary "touches" to the node to make its operation as much as possible "zero-touch" with respect to ACP/ANI.  If there are "unavoidable touches" such a creating and/or configuring a non-native interface or provisioning credentials for a native interface, then "ACP/ANI enable" should be added as an option to that "touch".  If an erroneous "touch" is easily fixed (does not create another high-cost touch), then the default should be not to enable ANI/ACP, and if it is potentially expensive or slow to fix (e.g., parameters on SIM card shipped to remote location), then the default should be to enable ACP/ANI.</t>
        </section>
        <section anchor="node-enable" numbered="true" toc="default">
          <name>Enabling Node-Level ACP and ANI</name>
          <t>A node-level command "ACP/ANI enable [up-if-only]" enables ACP or ANI on the node (ANI = ACP + BRSKI).  Without this command set, any interface-level "ACP/ANI enable" is ignored.  Once set, ACP/ANI will operate an interface where "ACP/ANI enable" is set.  Setting of interface-level "ACP/ANI enable" is either automatic (default) or explicit through operator action as described in <xref target="if-enable-auto" format="default"/>.</t>
          <t>If the option "up-if-only" is selected, the behavior of "down" interfaces is unchanged, and ACP/ANI will only operate on interfaces where "ACP/ANI enable" is set and that are "up".  When it is not set, then "down" state of interfaces with "ACP/ANI enable" is modified to behave as "admin down".</t>
          <section anchor="brownfield" numbered="true" toc="default">
            <name>Brownfield Nodes</name>
            <t>A "brownfield" node is one that already has a configured data plane.</t>
            <t>Executing global "ACP/ANI enable [up-if-only]" on each node is the only command necessary to create an ACP across a network of brownfield nodes once all the nodes have a domain certificate.  When BRSKI is used ("ANI enable"), provisioning of the certificates only requires the setup of a single BRSKI registrar node, which could also implement a CA for the network.  This is the simplest way to introduce ACP/ANI into existing (i.e., brownfield) networks.</t>
            <t>The need to explicitly enable ACP/ANI is especially important in brownfield nodes because otherwise software updates may introduce support for ACP/ANI. The automatic enabling of ACP/ANI in networks where the operator does not want ACP/ANI or has likely never even heard of it could be quite irritating to the operator, especially when "down" behavior is changed to "admin down".</t>
            <t>Automatically setting "ANI enable" on brownfield nodes where the operator is unaware of BRSKI and MASA operations 
 could also be an unlikely, but critical, security issue. If an attacker could impersonate the operator by registering
as the operator at the MASA or otherwise getting hold of vouchers and could get enough physical access to the network so
pledges would register to an attacking registrar, then the attacker could gain access to the
 ACP and, through the ACP, gain access to the data plane.</t>

            <t>In networks where the operator explicitly enables the ANI, this could not happen because the operator would create a BRSKI registrar that would discover attack attempts, and the operator would set up his registrar with the MASA.  Nodes requiring "ownership vouchers" would not be subject to that attack.  See <xref target="RFC8995" format="default"/> for more details.  Note that a global "ACP enable" alone is not subject to these types of attacks because they always depend on some other mechanism first to provision domain certificates into the device.</t>
          </section>
          <section anchor="greenfield" numbered="true" toc="default">
            <name>Greenfield Nodes</name>
            <t>An ACP "greenfield" node is one that does not have any prior configuration and that can be bootstrapped into the ACP across the network. To support greenfield nodes, ACP as described in this document needs to be combined with a bootstrap protocol and/or mechanism that will enroll the node with the ACP keying material: the ACP certificate and the TA. For ANI nodes, this protocol/mechanism is BRSKI.</t>

            <t>When such a node is powered on and determines that it is in greenfield condition, it enables the bootstrap protocol(s) and/or mechanism(s). Once the ACP keying material is enrolled, the greenfield state ends and the ACP is started. When BRSKI is used, the node's state reflects this by setting "ANI enable" upon determination of greenfield state when it is powered on.</t>

            <t>ACP greenfield nodes that, in the absence of ACP, would have their interfaces in "down" state <bcp14>SHOULD</bcp14> set all native interfaces into "admin down" state and only permit data plane traffic required for the bootstrap protocol and/or mechanisms.</t>

<t>The ACP greenfield state ends either through the successful enrollment of ACP keying material (certificate and TA) or the detection of a permitted termination of ACP greenfield operations.</t>

            <t>ACP nodes supporting greenfield operations <bcp14>MAY</bcp14> want to provide backward compatibility with other forms of configuration and/or provisioning, especially when only a subset of nodes are expected to be deployed with ACP. Such an ACP node <bcp14>SHOULD</bcp14> observe attempts to provision or configure the node via interfaces and/or methods that traditionally indicate physical possession of the node, such as a serial or USB console port or a USB memory stick with a bootstrap configuration. When such an operation is observed before enrollment of the ACP keying material has completed, the node <bcp14>SHOULD</bcp14> put itself into the state the node would have been in if ACP/ANI was disabled at boot. This terminates ACP greenfield operations.</t>
            <t>When an ACP greenfield node enables multiple, automated ACP or non-ACP enrollment and/or bootstrap protocols or mechanisms in parallel, care must be taken not to terminate any protocol/mechanism before the others either have succeeded in enrolling ACP keying material or have progressed to a point of permitted termination for ACP greenfield operations.</t>

            <t>Highly secure ACP greenfield nodes may not permit any reason to terminate ACP greenfield operations, including physical access.</t>

            <t>Nodes that claim to support ANI greenfield operations <bcp14>SHOULD NOT</bcp14> enable in parallel to BRSKI any enrollment/bootstrap protocol/mechanism that allows Trust On First Use (TOFU, "<xref target="RFC7435" format="title"/>" <xref target="RFC7435" format="default"/>) over interfaces other than those traditionally indicating physical possession of the node.  Protocols/mechanisms with published default username/password authentication are considered to suffer from TOFU. Securing the bootstrap protocol/mechanism by requiring a voucher <xref target="RFC8366" format="default"/> can be used to avoid TOFU.</t>

            <t>In summary, the goal of ACP greenfield support is to allow remote, automated enrollment of ACP keying materials, and therefore automated bootstrap into the ACP and to prohibit TOFU during bootstrap with the likely exception (for backward compatibility) of bootstrapping via interfaces traditionally indicating physical possession of the node.</t>

          </section>
        </section>
        <section anchor="disabling" numbered="true" toc="default">
          <name>Undoing "ANI/ACP enable"</name>
          <t>Disabling ANI/ACP by undoing "ACP/ANI enable" is a risk for the reliable operations of the ACP if it can be executed by mistake or without authorization.  
This behavior could be influenced through some additional (future) property in the certificate (e.g., in the acp-node-name extension field): in an ANI deployment intended for convenience, disabling it could be allowed without further constraints.  In an ANI deployment considered to be critical, more checks would be required.
One very controlled option would be to not permit these commands unless the domain certificate has been revoked or is denied renewal.  Configuring this option would be a parameter on the BRSKI registrar(s).  As long as the node did not receive a domain certificate, undoing "ANI/ACP enable" should not have any additional constraints.</t>
        </section>
        <section anchor="enable-summary" numbered="true" toc="default">
          <name>Summary</name>
          <t>Node-wide "ACP/ANI enable [up-if-only]" commands enable the operation of ACP/ANI.  This is only auto-enabled on ANI greenfield devices, otherwise it must be configured explicitly.</t>
          <t>If the option "up-if-only" is not selected, interfaces enabled for ACP/ANI interpret the "down" state as "admin down" and not "physical down".  In the "admin-down" state, all non-ACP/ANI packets are filtered, but the physical layer is kept running to permit ACP/ANI to operate.</t>
          <t>(New) commands that result in physical interruption ("physical down", "loopback") of ACP/ANI-enabled interfaces should be built to protect continuance or reestablishment of ACP as much as possible.</t>
          <t>Interface-level "ACP/ANI enable" commands control per-interface operations.  It is enabled by default on native interfaces and has to be configured explicitly on other interfaces.</t>
          <t>Disabling "ACP/ANI enable" globally and per interface should have additional checks to minimize undesired breakage of ACP.  The degree of control could be a domain-wide parameter in the domain certificates.</t>
        </section>
      </section>
      <section anchor="incremental-adoption" numbered="true" toc="default">
        <name>Partial or Incremental Adoption</name>
        <t>The Zone Addressing Sub-Scheme (see <xref target="zone-scheme" format="default"/>) allows incremental
adoption of the ACP in a network where ACP can be deployed on edge areas, but not
across the core that is connecting those edges.</t>
        <t>In such a setup, each edge network, such as a branch or campus of an enterprise network,
has a  disjoint ACP to which one or more unique Zone-IDs are assigned: ACP nodes registered for
a specific ACP zone have to receive Zone Addressing Sub-Scheme addresses, for example,
by virtue of configuring for each such zone one or more ACP registrars with that Zone-ID.
All the registrars for these ACP zones need to get ACP certificates from CAs relying on a
common set of TAs and of course the same ACP domain name.</t>
        <t>These ACP zones can first be brought up as separate networks without any connection
between them and/or they can be connected across a non-ACP enabled core network through
various non-autonomic operational practices. For example, each separate ACP zone can have an
edge node that is a L3 VPN PE (MPLS or IPv6 L3VPN), where a complete
non-autonomic ACP-Core VPN is created by using the ACP VRFs and exchanging the routes
from those ACP VRFs across the VPN's non-autonomic routing protocol(s).</t>
        <t>While such a setup is possible with any ACP addressing sub-scheme, the
Zone Addressing Sub-Scheme makes it easy to configure and scalable for any
VPN routing protocols because every ACP zone only needs to indicate one or more 
/64 ACP zone addressing prefix routes into the ACP-Core VPN as opposed to routes
for every individual ACP node as required in the other ACP addressing schemes.</t>
        <t>Note that the non-autonomous ACP-Core VPN requires additional extensions
to propagate GRASP messages when GRASP discovery is desired across the zones.</t>

<t>For example, one could set up on each zone edge router a remote ACP
tunnel to a GRASP hub. The GRASP hub could be implemented at the application level
and could run in the NOC of the network. It would serve to propagate
GRASP announcements between ACP zones and/or generate GRASP announcements for NOC 
services.</t>

        <t>Such a partial deployment may prove to be sufficient or could evolve to become more
autonomous through future standardized or nonstandard enhancements, for example,
by allowing GRASP messages to be propagated across the L3VPN, leveraging for
example L3VPN multicast support.</t>
        <t>Finally, these partial deployments can be merged into a single, contiguous
ACP that is completely autonomous (given appropriate ACP support across the core) without changes
in the cryptographic material because the node's ACP certificates are from a single ACP.</t>
      </section>
      <section anchor="configuration" numbered="true" toc="default">
        <name>Configuration and the ACP (Summary)</name>
        <t>There is no desirable configuration for the ACP. Instead, all parameters that need to be configured in support of the ACP are limitations of the solution, but they are only needed in cases where not all components are made autonomic. Wherever this is necessary, it relies on preexisting mechanisms for configuration such as CLI or YANG data models ("<xref target="RFC7950" format="title"/>" <xref target="RFC7950" format="default"/>).</t>
        <t>The most important examples of such configuration include:</t>
        <ul spacing="normal">
          <li>When ACP nodes do not support an autonomic way to receive an ACP certificate, for example, BRSKI, then such a certificate needs to be configured via some preexisting mechanisms outside the scope of this specification. Today, routers typically have a variety of mechanisms to do this.</li>
          <li>Certificate maintenance requires PKI functions. Discovery of these functions across the ACP is automated (see <xref target="domcert-maint" format="default"/>), but their configuration is not.</li>
          <li>When non-ACP-capable nodes such as preexisting NMS need to be physically connected to the ACP, the ACP node to which they attach needs to be configured with ACP connect according to <xref target="ACPconnect" format="default"/>. It is also possible to use that single physical connection to connect both to the ACP and the data plane of the network as explained in <xref target="SingleIF" format="default"/>.</li>
          <li>When devices are not autonomically bootstrapped, explicit configuration to enable the ACP needs to be applied. See <xref target="enabling-acp" format="default"/>.</li>
          <li>When the ACP needs to be extended across interfaces other than L2, the ACP as defined in this document cannot auto-discover candidate neighbors automatically. Remote neighbors need to be configured, see <xref target="remote-acp-neighbors" format="default"/>.</li>
        </ul>
        <t>Once the ACP is operating, any further configuration for the data plane can be done more reliably across the ACP itself because the ACP provides addressing and connectivity (routing) independent of the data plane. For this, the configuration methods simply need to allow operating across the ACP VRF, for example, with NETCONF, SSH, or any other method.</t>
        <t>The ACP also provides additional security through its hop-by-hop encryption for any such configuration operations. Some legacy configuration methods (for example, SNMP, TFTP, or HTTP) may not use end-to-end encryption, and most of the end-to-end secured configuration methods still allow for easy, passive observation along the path of the configuration taking place (for example, transport flows, port numbers, and/or IP addresses).</t>
        <t>The ACP can and should be used equally as the transport to configure any of the aforementioned non-autonomic components of the ACP, but in that case, the same caution needs to be exercised as with data plane configuration without the ACP. Misconfiguration may cause the configuring entity to be disconnected from the node it configures, for example, when incorrectly unconfiguring a remote ACP neighbor through which the configured ACP node is reached.</t>
      </section>
    </section>
    <section anchor="benefit" numbered="true" toc="default">
      <name>Summary: Benefits (Informative)</name>
      <section anchor="self-healing" numbered="true" toc="default">
        <name>Self-Healing Properties</name>
        <t>The ACP is self-healing:</t>
        <ul spacing="normal">
          <li>New neighbors will automatically join the ACP after successful validation and will become reachable using their unique ULA address across the ACP.</li>
          <li>When any changes happen in the topology, the routing protocol used in the ACP will automatically adapt to the changes and will continue to provide reachability to all nodes.</li>
          <li>The ACP tracks the validity of peer certificates and tears down ACP secure channels when a peer certificate has expired. When short-lived certificates with lifetimes on the order of OCSP/CRL refresh times are used, then this allows for removal of invalid peers (whose certificate was not renewed) at similar speeds as when using OCSP/CRL. The same benefit can be achieved when using CRL/OCSP,  periodically refreshing the revocation information and also tearing down ACP secure channels when the peer's (long-lived) certificate is revoked. There is no requirement for ACP implementations to require this enhancement, though, in order to keep the mandatory implementations simpler.</li>
        </ul>
        <t>The ACP can also sustain network partitions and mergers.  Practically all ACP operations are link local, where a network partition has no impact.  Nodes authenticate each other using the domain certificates to establish the ACP locally.  Addressing inside the ACP remains unchanged, and the routing protocol inside both parts of the ACP will lead to two working (although partitioned) ACPs.</t>
        <t>There are a few central dependencies: a CRL may not be available during a network partition. This can be addressed by a suitable policy to not immediately disconnect neighbors when no CRL is available.  Also, an ACP registrar or CA might not be available during a partition.  This may delay renewal of certificates that are to expire in the future, and it may prevent the enrollment of new nodes during the partition.</t>
        <t>Highly resilient ACP designs can be built by using ACP registrars with embedded sub-CAs, as outlined in <xref target="sub-ca" format="default"/>. As long as a partition is left with one or more of such ACP registrars, it can continue to enroll new candidate ACP nodes as long as the ACP registrar's sub-CA certificate does not expire. Because the ACP addressing relies on unique Registrar-IDs, a later merging of partitions will not cause problems with ACP addresses assigned during partitioning.</t>
        <t>After a network partition, merging will just establish the previous status: certificates can be renewed, the CRL is available, and new nodes can be enrolled everywhere.  Since all nodes use the same TA, the merging will be smooth.</t>
        <t>Merging two networks with different TAs requires the ACP nodes to trust the union of TAs.  As long as the routing-subdomain hashes are different, the addressing will not overlap. Overlaps will only happen accidentally in the unlikely event of a 40-bit hash collision in SHA-256 (see <xref target="addressing" format="default"/>).
Note that the complete mechanisms to merge networks is out of scope of this specification.</t>
        <t>It is also highly desirable for an implementation of the ACP to be able to run it over interfaces that are administratively down.  If this is not feasible, then it might instead be possible to request explicit operator override upon administrative actions that would administratively bring down an interface across which the ACP is running, especially if bringing down the ACP is known to disconnect the operator from the node.  For example, any such administrative down action could perform a dependency check to see if the transport connection across which this action is performed is affected by the down action (with default RPL routing used, packet forwarding will be symmetric, so this is actually possible to check).</t>
      </section>
      <section anchor="self-protecting" numbered="true" toc="default">
        <name>Self-Protection Properties</name>
        <section anchor="self-protecting-outside" numbered="true" toc="default">
          <name>From the Outside</name>
          <t>As explained in <xref target="self-creation" format="default"/>, the ACP is based on secure channels built between nodes that have mutually authenticated each other with their domain certificates.  The channels themselves are protected using standard encryption technologies such as DTLS or IPsec, which provide additional authentication during channel establishment, data integrity, and data confidentiality protection inside the ACP, and also provide replay protection.</t>
          <t>An attacker will not be able to join the ACP unless it has a valid ACP certificate. An on-path attacker without a valid ACP certificate cannot inject packets into the ACP due to ACP secure channels. An attacker also cannot decrypt ACP traffic unless it can crack the encryption. It can attempt behavioral traffic analysis on the encrypted ACP traffic.</t>
          <t>The degree to which compromised ACP nodes can impact the ACP depends on the implementation of the ACP nodes and their impairment. When an attacker has only gained administrative privileges to configure ACP nodes remotely, the attacker can disrupt the ACP only through one of the few configuration options to disable it (see <xref target="enabling-acp" format="default"/>) or by the configuring of non-autonomic ACP options if those are supported on the impaired ACP nodes (see <xref target="workarounds" format="default"/>). Injecting traffic into or extracting traffic from an impaired ACP node is only possible when an impaired ACP node supports ACP connect (see <xref target="ACPconnect" format="default"/>), and the attacker can control traffic into/from one of the ACP node's interfaces, such as by having physical access to the ACP node.</t>
          <t>The ACP also serves as protection (through authentication and encryption) for protocols relevant to OAM that may not have secured protocol stack options or where implementation or deployment of those options fail due to some vendor, product, or customer limitations.  This includes protocols such as SNMP ("<xref target="RFC3411" format="title"/>" <xref target="RFC3411" format="default"/>), NTP <xref target="RFC5905" format="default"/>, PTP (Precision Time Protocol <xref target="IEEE-1588-2008" format="default"/>), DNS ("<xref target="RFC3596" format="title"/>" <xref target="RFC3596" format="default"/>), DHCPv6 ("<xref target="RFC3315" format="title"/>" <xref target="RFC3315" format="default"/>), syslog ("<xref target="RFC3164" format="title"/>" <xref target="RFC3164" format="default"/>), RADIUS ("<xref target="RFC2865" format="title"/>" <xref target="RFC2865" format="default"/>), Diameter ("<xref target="RFC6733" format="title"/>" <xref target="RFC6733" format="default"/>), TACACS ("<xref target="RFC1492" format="title"/>" <xref target="RFC1492" format="default"/>), IPFIX ("<xref target="RFC7011" format="title"/>" <xref target="RFC7011" format="default"/>), NetFlow ("<xref target="RFC3954" format="title"/>" <xref target="RFC3954" format="default"/>) -- just to name a few. Not all of these protocol references are necessarily the latest version of protocols, but they are versions that are still widely deployed.</t>
          <t>Protection via the ACP secure hop-by-hop channels for these protocols is meant to be only a stopgap, though: the ultimate goal is for these and other protocols to use end-to-end encryption utilizing the domain certificate and to rely on the ACP secure channels primarily for zero-touch reliable connectivity, but not primarily for security.</t>
          <t>The remaining attack vector would be to attack the underlying ACP protocols themselves, either via directed attacks or by denial-of-service attacks.  However, as the ACP is built using link-local IPv6 addresses, remote attacks from the data plane are impossible as long as the data plane has no facilities to remotely send IPv6 link-local packets.  The only exceptions are ACP-connected interfaces, which require greater physical protection.  The ULA addresses are only reachable inside the ACP context and therefore unreachable from the data plane.  Also, the ACP protocols should be implemented to be attack resistant and to not consume unnecessary resources even while under attack.</t>
        </section>
        <section anchor="self-protecting-inside" numbered="true" toc="default">
          <name>From the Inside</name>
          <t>The security model of the ACP is based on trusting all members of the group of nodes
 that receive an ACP certificate for the same domain.  Attacks from the inside by
a compromised group member are therefore the biggest challenge.</t>
          <t>Group members must be protected against attackers so that there is no easy way to compromise them
or use them as a proxy for attacking other devices across the ACP. For example, management plane
functions (transport ports) should be reachable only from the ACP and not from the data plane.
This applies especially to those management plane functions that lack
secure end-to-end transport and to which the ACP provides both automatic, reliable
 connectivity and protection against attacks.  Protection across all potential
attack vectors is typically easier to do in devices whose software is designed from the beginning with
the ACP in mind than in legacy, software-based systems where the ACP is added on as another feature.</t>
          <t>As explained above, traffic across the ACP should still be end-to-end encrypted whenever
possible.  This includes traffic such as GRASP, EST, and BRSKI inside the ACP.  This minimizes
man-in-the-middle attacks by compromised ACP group members.  Such attackers cannot eavesdrop
or modify communications, but they can just filter them (which is unavoidable by any means).</t>
          <t>See <xref target="compromised" format="default"/> for further considerations on avoiding and dealing with
compromised nodes.</t>
        </section>
      </section>
      <section anchor="admin-view" numbered="true" toc="default">
        <name>The Administrator View</name>
        <t>An ACP is self-forming, self-managing, and self-protecting; therefore, it has minimal dependencies on the administrator of the network.  Specifically, since it is (intended to be) independent of configuration, there is only limited scope for configuration errors on the ACP itself.  The administrator may have the option to enable or disable the entire approach, but detailed configuration is not possible.  This means that the ACP must not be reflected in the running configuration of nodes, except for a possible on/off switch (and even that is undesirable).</t>
        <t>While configuration (except for <xref target="workarounds" format="default"/> and  <xref target="registrar-considerations" format="default"/>)
 is not possible, an administrator must have full visibility into the ACP and all its parameters to be able to troubleshoot.  Therefore, an ACP must support all show and debug options, as with any other network function.  Specifically, an NMS or controller must be able to discover the ACP and monitor its health.  This visibility into ACP operations must clearly be separated from the visibility of the data plane so automated systems will never have to deal with ACP aspects unless they explicitly desire to do so.</t>
        <t>Since an ACP is self-protecting, a node that does not support the ACP or that does not have a valid domain certificate cannot connect to it.  This means that by default a traditional controller or NMS cannot connect to an ACP.  See <xref target="NMS" format="default"/> for details on how to connect an NMS host to the ACP.</t>
      </section>
    </section>
    <section anchor="security" numbered="true" toc="default">
      <name>Security Considerations</name>
      <t>A set of ACP nodes with ACP certificates for the same ACP domain and with ACP functionality enabled is automatically "self-building": the ACP is automatically established between neighboring ACP nodes. It is also self-protecting: the ACP secure channels are authenticated and encrypted. No configuration is required for this.</t>
      <t>The self-protecting property does not include workarounds for non-autonomic components as explained in <xref target="workarounds" format="default"/>. See <xref target="self-protecting" format="default"/> for details of how the ACP protects itself against attacks from the outside and, to a more limited degree, from the inside as well.</t>
      <t>However, the security of the ACP depends on a number of other factors:
                                </t>
      <ul spacing="normal">
        <li>The usage of domain certificates depends on a valid supporting PKI infrastructure.  If the chain of trust of this PKI infrastructure is compromised, the security of the ACP is also compromised.  This is typically under the control of the network administrator.</li>
        <li>ACP nodes receive their certificates from ACP registrars. These ACP registrars are security-critical dependencies of the ACP.  Procedures and protocols for ACP registrars are outside the scope of this specification as explained in <xref target="registrars-protocols" format="default"/>; only the requirements for the resulting ACP certificates are specified.</li>

        <li>Every ACP registrar (for enrollment of ACP certificates) and ACP EST server (for renewal of ACP certificates) is a security-critical entity and its protocols are security-critical protocols. Both need to be hardened against attacks, similar to a CA and its protocols. A malicious registrar can enroll malicious nodes to an ACP network (if the CA delegates this policy to the registrar) or break ACP routing, for example, by assigning duplicate ACP addresses to ACP nodes via their ACP certificates.</li>

        <li>ACP nodes that are ANI nodes rely on BRSKI as the protocol for ACP registrars. For ANI-type ACP nodes, the security considerations of BRSKI apply. It enables automated, secure enrollment of ACP certificates.</li>

        <li>BRSKI and potentially other ACP registrar protocol options require that nodes have an (X.509 v3 based) IDevID. IDevIDs are an option for ACP registrars to securely identify candidate ACP nodes that should be enrolled into an ACP domain.</li>

        <li>For IDevIDs to securely identify the node to which its IDevID is assigned, the node needs (1) to utilize hardware support such as a Trusted Platform Module (TPM) to protect against extraction and/or cloning of the private key of the IDevID and (2) a hardware/software infrastructure to prohibit execution of unauthenticated software to protect against malicious use of the IDevID.</li>

        <li>Like the IDevID, the ACP certificate should equally be protected from extraction or other abuse by the same ACP node infrastructure. This infrastructure for IDevID and ACP certificate is beneficial independent of the ACP registrar protocol used (BRSKI or other).</li>

        <li>Renewal of ACP certificates requires support for EST; therefore, the security considerations of <xref target="RFC7030" format="default"/> related to certificate renewal and/or rekeying and TP renewal apply to the ACP. EST security considerations when using other than mutual certificate authentication do not apply, nor do considerations for initial enrollment via EST apply, except for ANI-type ACP nodes because BRSKI leverages EST.</li>

        <li>A malicious ACP node could declare itself to be an EST server via GRASP across the ACP if malicious software could be executed on it. The CA should therefore authenticate only known trustworthy EST servers, such as nodes with hardware protections against malicious software. When registrars use their ACP certificate to authenticate towards a CA, the id-kp-cmcRA <xref target="RFC6402" format="default"/> extended key usage attribute allows the CA to determine that the ACP node was permitted during enrollment to act as an ACP registrar.  Without the ability to talk to the CA, a malicious EST server can still attract ACP nodes attempting to renew their keying material, but they will fail to perform successful renewal of a valid ACP certificate. The ACP node attempting to use the malicious EST server can then continue to use a different EST server and log a failure against a malicious EST server.</li>

        <li>Malicious on-path ACP nodes may filter valid EST server announcements across the ACP, but such malicious ACP nodes could equally filter any ACP traffic such as the EST traffic itself. Either attack requires the ability to execute malicious software on an impaired ACP node, though.</li>

        <li>In the absence of malicious software injection, an attacker that can misconfigure an ACP node that supports EST server functionality could attempt to configure a malicious CA. This would not result in the ability to successfully renew ACP certificates, but it could result in DoS attacks by becoming an EST server and by making ACP nodes attempt their ACP certificate renewal via this impaired ACP node. This problem can be avoided when the EST server implementation can verify that the configured CA is indeed providing renewal for certificates of the node's ACP. The ability to do so depends on the protocol between the EST server and the CA, which is outside the scope of this document.</li>
      </ul>

<t>In summary, attacks against the PKI/certificate dependencies of the ACP can be minimized by a variety of hardware and/or software components, including options such as TPM for IDevID and/or ACP certificate, prohibitions against the execution of untrusted software, and design aspects of the EST server functionality for the ACP that eliminate configuration-level impairment.</t>

      <t>Because ACP peers select one out of potentially more than one mutually supported ACP secure channel protocols via the approach described in <xref target="channel-selection"/>, ACP secure channel setup is subject to downgrade attacks by MITM attackers. This can be discovered after such an attack by additional mechanisms described in <xref target="downgrade"/>. Alternatively, more advanced channel selection mechanisms can be devised.</t>

<t>The security model of the ACP as defined in this document is tailored for use with private PKI. The TA of a private PKI provides the security against maliciously created ACP certificates that give access to an ACP. Such attacks can create fake ACP certificates with correct-looking AcpNodeNames, but those certificates would not pass the certificate path validation of the ACP domain membership check (see <xref target="certcheck"/>, point 2).</t>

      <t>There is no prevention of source-address spoofing inside the ACP.  This implies that if an attacker gains access to the ACP, it can spoof all addresses inside the ACP and fake messages from any other node. New protocols and/or services running across the ACP should therefore use end-to-end authentication inside the ACP. This is already done by GRASP as specified in this document.</t>

      <t>The ACP is designed to enable automation of current network management and the management of future autonomic peer-to-peer/distributed networks. Any ACP member can send ACP IPv6 packets to other ACP members and announce via ACP GRASP services to all ACP members without depending on centralized components.</t>

      <t>The ACP relies on peer-to-peer authentication and authorization using ACP certificates.  This security model is necessary to enable the autonomic ad hoc, any-to-any connectivity between ACP nodes. It provides infrastructure protection through hop-by-hop authentication and encryption -- without relying on third parties. For any services where this complete autonomic peer-to-peer group security model is appropriate, the ACP certificate can also be used unchanged, for example, for any type of data plane routing protocol security.</t>

      <t>This ACP security model is designed primarily to protect against attack from the outside, not against attacks from the inside.  To protect against spoofing attacks from compromised on-path ACP nodes, end-to-end encryption inside the ACP is used by new ACP signaling: GRASP across the ACP using TLS. The same is expected from any non-legacy services or protocols using the ACP. Because no group keys are used, there is no risk of impacted nodes accessing end-to-end encrypted traffic from other ACP nodes.</t>

      <t>Attacks from impacted ACP nodes against the ACP are more difficult than against the data plane because of the autoconfiguration of the ACP and the absence of configuration options that could be abused to change or break ACP behavior. This is excluding configuration for workaround in support of non-autonomic components.</t>

      <t>Mitigation against compromised ACP members is possible through standard automated certificate management mechanisms including revocation and nonrenewal of short-lived certificates. In this specification, there are no further optimizations of these mechanisms defined for the ACP (but see <xref target="compromised" format="default"/>).</t>

      <t>Higher-layer service built using ACP certificates should not solely rely on undifferentiated group security when another model is more appropriate or more secure. For example, central network configuration relies on a security model where only a few especially trusted nodes are allowed to configure the data plane of network nodes (CLI, NETCONF). This can be done through ACP certificates by differentiating them and introducing roles. See <xref target="role-assignments" format="default"/>.</t>
      <t>Operators and developers of provisioning software need to be aware of how the provisioning and configuration of network devices impacts the ability of the operator and/or provisioning software to remotely access the network nodes. By using the ACP, most of the issues of provisioning/configuration causing connectivity loss of remote provisioning and configuration will be eliminated, see <xref target="self-creation" format="default"/>. Only a few exceptions, such as explicit physical interface down configuration, will be left. See <xref target="admin-down" format="default"/>.</t>

      <t>Many details of ACP are designed with security in mind and discussed elsewhere in the document.</t>
      <t>IPv6 addresses used by nodes in the ACP are covered as part of the node's domain certificate as described in <xref target="domcert-acpinfo" format="default"/>.  This allows even verification of ownership of a peer's IPv6 address when using a connection authenticated with the domain certificate.</t>
      <t>The ACP acts as a security (and transport) substrate for GRASP inside the ACP such that GRASP is not only protected by attacks from the outside, but also by attacks from compromised inside attackers -- by relying not only on hop-by-hop security of ACP secure channels, but also by adding end-to-end security for those GRASP messages.  See <xref target="GRASP-substrate" format="default"/>.</t>
      <t>ACP provides for secure, resilient zero-touch discovery of EST servers for certificate renewal.  See <xref target="domcert-maint" format="default"/>.</t>
      <t>ACP provides extensible, autoconfiguring hop-by-hop protection of the ACP infrastructure via the negotiation of hop-by-hop secure channel protocols.  See <xref target="channel-selection" format="default"/>.</t>

      <t>The ACP is designed to minimize attacks from the outside by minimizing its dependency on any non-ACP (data plane) operations and/or configuration on a node.  See also <xref target="general_addressing" format="default"/>.</t>

      <t>In combination with BRSKI, ACP enables a resilient, fully zero-touch network solution for short-lived certificates that can be renewed or reenrolled even after unintentional expiry (e.g., due to interrupted connectivity).  See <xref target="bootstrap" format="default"/>.</t>

      <t>Because ACP secure channels can be long lived, but certificates used may be short-lived, secure channels, for example, built via IPsec, need to be terminated when peer certificates expire. See <xref target="Profiles" format="default"/>.</t>

      <t><xref target="acp-l2-switches-how" format="default"/> describes how to implement a routed
ACP topology operating on what effectively is a large bridge domain when using
L3/L2 routers that operate at L2 in the data plane. In this case, the ACP is
subject to a much higher likelihood of attacks by other nodes "stealing"
L2 addresses than in the actual routed case, especially when the bridged network
includes untrusted devices such as hosts.  This is a generic issue in L2 LANs.
L2/L3 devices often already have some form of "port security" to prohibit this.  They rely on
Neighbor Discovery Protocol (NDP) or DHCP learning which port/MAC-address and IPv6 address belong together and blocking
MAC/IPv6 source addresses from wrong ports.  This type of function needs to be
enabled to prohibit DoS attacks and specifically to protect the ACP.  Likewise, the
GRASP DULL instance needs to ensure that the IPv6 address in the locator-option matches the source IPv6 address of the DULL GRASP packet.</t>
    </section>
    <section anchor="iana" numbered="true" toc="default">
      <name>IANA Considerations</name>
      <t>This document defines the "Autonomic Control Plane".</t>
      <t>For the ANIMA-ACP-2020 ASN.1 module, IANA has assigned 
value 97 for "id-mod-anima-acpnodename-2020" in the "SMI
Security for PKIX Module Identifier" (1.3.6.1.5.5.7.0) registry.</t>
      <t>For the otherName / AcpNodeName, IANA has assigned value 10 for
id-on-AcpNodeName in the "SMI Security for PKIX Other Name
Forms" (1.3.6.1.5.5.7.8) registry.</t>

      <t>IANA has registered the names in <xref target="iana-objnames"/> in 
the "GRASP Objective Names" subregistry of the "GeneRic Autonomic Signaling Protocol (GRASP) Parameters" registry.</t>
<table anchor="iana-objnames">
  <name>GRASP Objective Names</name>    
  <thead>
    <tr>
      <th>Objective Name</th>    
      <th>Reference</th>
    </tr>
  </thead>
  <tbody>         
    <tr>
      <td>AN_ACP</td>
      <td>RFC 8994 (<xref target="discovery-grasp" format="default"/>)</td>
    </tr>
    <tr>
      <td>SRV.est</td>
      <td>RFC 8994 (<xref target="domcert-maint" format="default"/>)</td>
    </tr>
  </tbody>
</table>
      <t>Explanation: this document chooses the initially strange looking format "SRV.&lt;service-name&gt;" because these objective names would be in line with potential future simplification of the GRASP objective registry. Today, every name in the GRASP objective registry needs to be explicitly allocated by IANA. In the future, this type of objective names could be considered to be automatically registered in that registry for the same service for which a &lt;service-name&gt; is registered according to <xref target="RFC6335" format="default"/>. This explanation is solely informational and has no impact on the requested registration.</t>

      <t>IANA has created an "Autonomic Control Plane (ACP)" registry with
the subregistry, "ACP Address Type" (<xref target="iana-acpaddresstype"/>).</t>
<table anchor="iana-acpaddresstype"> 
  <name>Initial Values in the "ACP Address Type" Subregistry</name> 
  <thead>
    <tr>
      <th>Value</th>    
      <th>Description</th>
      <th>Reference</th>
    </tr>
  </thead>
  <tbody>         
    <tr>
      <td>0</td>
      <td>ACP Zone Addressing Sub-Scheme/ACP Manual Addressing Sub-Scheme</td>
      <td>RFC 8994 (<xref target="zone-scheme" format="default"/>, <xref target="manual-scheme" format="default"/>)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>ACP Vlong Addressing Sub-Scheme</td>
      <td>RFC 8994 (<xref target="Vlong" format="default"/>)</td>
    </tr>
    <tr>
      <td>2-3</td>
      <td>Unassigned</td>
      <td/>
    </tr>
  </tbody>
</table>


      <t>The values in the "ACP Address Type" subregistry are numeric values 0..3 paired with a name (string).  Future values <bcp14>MUST</bcp14> be assigned using the Standards Action policy defined by "<xref target="RFC8126" format="title"/>" <xref target="RFC8126" format="default"/>.</t>
    </section>

  </middle>
  <back>

<displayreference target="I-D.ietf-tls-dtls13" to="TLS-DTLS13"/>
<displayreference target="I-D.eckert-anima-noc-autoconfig" to="NOC-AUTOCONFIG"/>
<displayreference target="I-D.ietf-roll-applicability-template" to="ROLL-APPLICABILITY"/>

  <references>
      <name>References</name>
    <references>
      <name>Normative References</name>

<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1034.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3810.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4191.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4193.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4291.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4301.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4861.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4862.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5234.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5246.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5280.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6347.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6550.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6551.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6552.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6553.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7030.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7296.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7525.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7676.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8221.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8247.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8422.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8446.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8610.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5954.xml"/>

<reference anchor="RFC8995" target="https://www.rfc-editor.org/info/rfc8995">
<front>
<title>Bootstrapping Remote Secure Key Infrastructure (BRSKI)</title>

<author initials="M" surname="Pritikin" fullname="Max Pritikin">
    <organization/>
</author>

<author initials="M" surname="Richardson" fullname="Michael C. Richardson">
    <organization/>
</author>

<author initials="T" surname="Eckert" fullname="Toerless Eckert">
    <organization/>
</author>

<author initials="M" surname="Behringer" fullname="Michael H. Behringer">
    <organization/>
</author>

<author initials="K" surname="Watsen" fullname="Kent Watsen">
    <organization/>
</author>

<date month="May" year="2021"/>

</front>
<seriesInfo name="RFC" value="8995"/>
<seriesInfo name="DOI" value="10.17487/RFC8995"/>
</reference>

<reference anchor="RFC8990" target="https://www.rfc-editor.org/info/rfc8990">
<front>
<title>GeneRic Autonomic Signaling Protocol (GRASP)</title>

<author initials="C" surname="Bormann" fullname="Carsten Bormann">
    <organization/>
</author>

<author initials="B" surname="Carpenter" fullname="Brian Carpenter" role="editor">
    <organization/>
</author>

<author initials="B" surname="Liu" fullname="Bing Liu" role="editor">
    <organization/>
</author>

<date month="May" year="2021"/>

</front>
<seriesInfo name="RFC" value="8990"/>
<seriesInfo name="DOI" value="10.17487/RFC8990"/>
</reference>

      <reference anchor="IKEV2IANA" target="https://www.iana.org/assignments/ikev2-parameters">
        <front>
          <title>Internet Key Exchange Version 2 (IKEv2) Parameters</title>
          <author fullname="IANA">
            <organization/>
          </author>
          <date/>
        </front>
      </reference>
    </references>
    <references>
      <name>Informative References</name>

<reference anchor="RFC8992" target="https://www.rfc-editor.org/info/rfc8992">
<front>
<title>Autonomic IPv6 Edge Prefix Management in Large-Scale Networks</title>

<author initials="S" surname="Jiang" fullname="Sheng Jiang" role="editor">
    <organization/>
</author>

<author initials="Z" surname="Du" fullname="Zongpeng Du">
    <organization/>
</author>

<author initials="B" surname="Carpenter" fullname="Brian Carpenter">
    <organization/>
</author>

<author initials="Q" surname="Sun" fullname="Qiong Sun">
    <organization/>
</author>

<date month="May" year="2021"/>

</front>
<seriesInfo name="RFC" value="8992"/>
<seriesInfo name="DOI" value="10.17487/RFC8992"/>
</reference>

<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8739.xml"/>

<xi:include href="https://datatracker.ietf.org/doc/bibxml3/reference.I-D.ietf-tls-dtls13.xml"/>

<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1112.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1492.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1654.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1918.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2315.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2409.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2865.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3164.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3315.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3411.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3596.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6120.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3954.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4007.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4210.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4364.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4429.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4541.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4604.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4607.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4610.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8981.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4985.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5790.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5880.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5905.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5912.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6241.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6335.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6402.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6407.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6554.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6724.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6733.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6762.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6763.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6824.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6830.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7011.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7404.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7426.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7435.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7575.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7576.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7585.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7721.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7761.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7950.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8028.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8126.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8366.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8316.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8368.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8398.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8402.xml"/>
<xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8572.xml"/>

<reference anchor="RFC8993" target="https://www.rfc-editor.org/info/rfc8993">
<front>
<title>A Reference Model for Autonomic Networking</title>

<author initials="M" surname="Behringer" fullname="Michael H. Behringer" role="editor">
    <organization/>
</author>

<author initials="B" surname="Carpenter" fullname="Brian Carpenter">
    <organization/>
</author>

<author initials="T" surname="Eckert" fullname="Toerless Eckert">
    <organization/>
</author>

<author initials="L" surname="Ciavaglia" fullname="Laurent Ciavaglia">
    <organization/>
</author>

<author initials="J" surname="Nobre" fullname="Jéferson Campos Nobre">
    <organization/>
</author>

<date month="May" year="2021"/>

</front>
<seriesInfo name="RFC" value="8993"/>
<seriesInfo name="DOI" value="10.17487/RFC8993"/>
</reference>

<reference anchor="I-D.eckert-anima-noc-autoconfig">
<front>
<title>
Autoconfiguration of NOC services in ACP networks via GRASP
</title>
<author fullname="Toerless Eckert" role="editor">
<organization>Futurewei Technologies Inc.</organization>
</author>
<date month="July" day="2" year="2018"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-eckert-anima-noc-autoconfig-00"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-eckert-anima-noc-autoconfig-00.txt"/>
</reference>

      <reference anchor="IEEE-1588-2008" target="https://standards.ieee.org/standard/1588-2008.html">
        <front>
          <title>IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems</title>
          <author>
            <organization>IEEE</organization>
          </author>
          <date month="July" year="2008"/>
        </front>
<seriesInfo name="DOI" value="10.1109/IEEESTD.2008.4579760"/>
<seriesInfo name="IEEE" value="1588-2008"/>
      </reference>

      <reference anchor="AR8021" target="https://1.ieee802.org/security/802-1ar">
        <front>
          <title>IEEE Standard for Local and metropolitan area networks - Secure Device Identity </title>
          <author>
            <organization>IEEE</organization>
          </author>
        </front>
<seriesInfo name="IEEE" value="802.1AR"/>
      </reference>

      <reference anchor="IEEE-802.1X" target="https://standards.ieee.org/standard/802_1X-2010.html">
        <front>
          <title>IEEE Standard for Local and metropolitan area networks--Port-Based Network Access Control</title>
          <author>
            <organization>IEEE</organization>
          </author>
          <date month="February" year="2010"/>
        </front>
<seriesInfo name="DOI" value="10.1109/IEEESTD.2010.5409813"/>
<seriesInfo name="IEEE" value="802.1X-2010"/>
      </reference>

      <reference anchor="MACSEC" target="https://standards.ieee.org/standard/802_1AE-2006.html">
	                                 
     <front>
          <title>IEEE Standard for Local and Metropolitan Area Networks: Media Access Control (MAC) Security</title>
          <author>
            <organization>IEEE</organization>
          </author>
          <date month="August" year="2006"/>
        </front>
<seriesInfo name="DOI" value="10.1109/IEEESTD.2006.245590"/>
<seriesInfo name="IEEE" value="802.1AE-2006"/>
      </reference>

      <reference anchor="LLDP" target="https://standards.ieee.org/standard/802_1AB-2016.html">
        <front>
          <title>IEEE Standard for Local and metropolitan area networks: Station and Media Access Control Connectivity Discovery</title>
          <author>
            <organization>IEEE</organization>
          </author>
          <date month="March" year="2016"/>
        </front>
<seriesInfo name="DOI" value="10.1109/IEEESTD.2016.7433915"/>
<seriesInfo name="IEEE" value="802.1AB-2016"/>
      </reference>

      <reference anchor="CABFORUM" target="https://cabforum.org/baseline-requirements-certificate-contents/">
        <front>
          <title>Certificate Contents for Baseline SSL</title>
          <author>
            <organization>CA/Browser Forum</organization>
          </author>
          <date month="Nov" year="2019"/>
        </front>
      </reference>

      <reference anchor="X.509" target="https://www.itu.int/rec/T-REC-X.509">
        <front>
          <title>Information technology - Open Systems Interconnection - The Directory: Public-key and attribute certificate frameworks</title>
          <seriesInfo name="ITU-T Recommendation" value="X.509"/>
          <author>
            <organization>ITU-T</organization>
          </author>
          <date month="October" year="2016"/>
        </front>
      </reference>

      <reference anchor="X.520" target="https://www.itu.int/rec/T-REC-X.520">
        <front>
          <title>Information technology - Open Systems Interconnection - The Directory: Selected attribute types</title>
          <seriesInfo name="ITU-T Recommendation" value="X.520"/>
          <author>
            <organization>ITU-T</organization>
          </author>
          <date month="October" year="2016"/>
        </front>
      </reference>

      <reference anchor="FCC" target="https://docs.fcc.gov/public/attachments/DOC-367699A1.docx">
        <front>
          <title>June 15, 2020 T-Mobile Network Outage Report</title>
          <author>
            <organization>FCC</organization>
          </author>
          <date year="2020" month="October"/>
        </front>
<seriesInfo name="PS Docket No." value="20-183"/>
        <refcontent>A Report of the Public Safety and Homeland Security Bureau
	Federal Communications Commission</refcontent>
      </reference>

<reference anchor="I-D.ietf-roll-applicability-template">
<front>
<title>ROLL Applicability Statement Template</title>
<author initials="M" surname="Richardson" fullname="Michael Richardson">
    <organization/>
</author>
<date month="May" day="3" year="2016"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-ietf-roll-applicability-template-09"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-ietf-roll-applicability-template-09.txt"/>
</reference>

      <reference anchor="OP-TECH" target="https://en.wikipedia.org/w/index.php?title=Operational_technology&amp;oldid=986363045">
        <front>
          <title>Operational technology</title>
          <author>
            <organization>Wikipedia</organization>
          </author>
          <date month="October" year="2020"/>
        </front>
      </reference>

      <reference anchor="SR" target="https://en.wikipedia.org/w/index.php?title=Single-root_input/output_virtualization&amp;oldid=978867619">
        <front>
          <title>Single-root input/output virtualization</title>
          <author>
            <organization>Wikipedia</organization>
          </author>
          <date month="September" year="2020"/>
        </front>
      </reference>

    <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8684.xml"/>

    </references>
  </references>
    <section anchor="further" numbered="true" toc="default">
      <name>Background and Future (Informative)</name>
      <t>The following sections provide background information about aspects of the normative parts of this document or associated mechanisms such as BRSKI (such as why specific choices were made by the ACP), and they discuss possible future variations of the ACP.</t>
      <section anchor="address-spaces" numbered="true" toc="default">
        <name>ACP Address Space Schemes</name>
        <t>This document defines the Zone, Vlong, and Manual Addressing Sub-Schemes primarily to support address prefix assignment
via distributed, potentially uncoordinated ACP registrars as defined
in <xref target="acp-registrars" format="default"/>. This
costs a 48/46-bit identifier so that these ACP registrars can assign
nonconflicting address prefixes. This design does not leave enough
bits to simultaneously support a large number of nodes (Node-ID),
plus a large prefix of local addresses for every node, plus a
large enough set of bits to identify a routing zone. As a result,
the Zone and Vlong 8/16 Addressing Sub-Schemes attempt to support all features but via 
separate prefixes.</t>
        <t>In networks that expect always to rely on a centralized PMS
as described <xref target="pms" format="default"/>, the 48/46-bits for
the Registrar-ID could be saved. Such variations of the ACP
addressing mechanisms could be introduced through future work
in different ways. If a new otherName was introduced, 
incompatible ACP variations could be created
where every design aspect of the ACP could be changed, including
all addressing choices. If instead a new addressing sub-scheme
would be defined, it could be a backward-compatible extension
of this ACP specification. Information such as the size of a
zone prefix and the length of the prefix assigned to the ACP
node itself could be encoded via the extension field of the
acp-node-name.</t>
        <t>Note that an explicitly defined Manual Addressing Sub-Scheme
is always beneficial to provide an easy way for ACP nodes to prohibit
incorrect non-autonomic configuration of any non-"Manual" ACP address spaces
and therefore ensure that such non-autonomic operations will never impact 
correct routing for any non-"Manual" ACP addresses assigned via
ACP certificates.</t>
      </section>
      <section anchor="bootstrap" numbered="true" toc="default">
        <name>BRSKI Bootstrap (ANI)</name>
        <t>BRSKI describes how nodes with an IDevID certificate can securely and zero-touch enroll with an LDevID certificate to support the ACP.  BRSKI also leverages the ACP to enable zero-touch bootstrap of new nodes across networks without any configuration requirements across the transit nodes (e.g., no DHCP, DNS forwarding, and/or server setup).  This includes otherwise unconfigured networks as described in <xref target="secure-bootstrap" format="default"/>.  Therefore, BRSKI in conjunction with ACP provides for a secure and zero-touch management solution for complete networks.  Nodes supporting such an infrastructure (BRSKI and ACP) are called ANI nodes (Autonomic Networking Infrastructure), see <xref target="RFC8993" format="default"/>.  Nodes that do not support an IDevID certificate but only an (insecure) vendor-specific Unique Device Identifier (UDI) or nodes whose manufacturer does not support a MASA could use some future, reduced-security version of BRSKI.</t>
        <t>When BRSKI is used to provision a domain certificate (which is called enrollment), the BRSKI registrar (acting as an enhanced EST server) must include the otherName / AcpNodeName encoded ACP address and domain name to the enrolling node (called a pledge) via its response to the pledge's EST CSR Attributes Request that is mandatory in BRSKI.</t>
        <t>The CA in an ACP network must not change the otherName / AcpNodeName in the certificate.  The ACP nodes can therefore find their ACP addresses and domain using this field in the domain certificate, both for themselves as well as for other nodes.</t>
        <t>The use of BRSKI in conjunction with the ACP can also help to further simplify maintenance and renewal of domain certificates.  Instead of relying on CRL, the lifetime of certificates can be made extremely small, for example, on the order of hours.  When a node fails to connect to the ACP within its certificate lifetime, it cannot connect to the ACP to renew its certificate across it (using just EST), but it can still renew its certificate as an "enrolled/expired pledge" via the BRSKI bootstrap proxy.  This requires only that the BRSKI registrar honors expired domain certificates and that the pledge attempts to perform TLS authentication for BRSKI bootstrap using its expired domain certificate before falling back to attempting to use its IDevID certificate for BRSKI.  This mechanism could also render CRLs unnecessary because the BRSKI registrar in conjunction with the CA would not renew revoked certificates -- only a "Do-not-renew" list would be necessary on the BRSKI registrar/CA.</t>
        <t>In the absence of BRSKI or less secure variants thereof, the provisioning of certificates may involve one or more touches or nonstandardized automation.  Node vendors usually support the provisioning of certificates into nodes via PKCS #7 (see "<xref target="RFC2315" format="title"/>" <xref target="RFC2315" format="default"/>) and may support this provisioning through vendor-specific models via NETCONF ("<xref target="RFC6241" format="title"/>" <xref target="RFC6241" format="default"/>).  If such nodes also support NETCONF Zero Touch <xref target="RFC8572" format="default"/>, then this can be combined with zero-touch provisioning of domain certificates into nodes.  Unless there is the equivalent integration of NETCONF connections across the ACP as there is in BRSKI, this combination would not support zero-touch bootstrap across an unconfigured network, though.</t>
      </section>
      <section anchor="discovery" numbered="true" toc="default">
        <name>ACP Neighbor Discovery Protocol Selection</name>
        <t>This section discusses why GRASP DULL was chosen as the discovery protocol
for L2-adjacent candidate ACP neighbors.  The contenders that were considered were GRASP, mDNS, and LLDP.</t>
        <section anchor="discovery-lldp" numbered="true" toc="default">
          <name>LLDP</name>
          <t>LLDP and Cisco's earlier Cisco Discovery Protocol (CDP) are examples of L2 discovery protocols that terminate
their messages on L2 ports.  If those protocols had been chosen for ACP neighbor discovery,
ACP neighbor discovery would also have terminated on L2 ports.  This would have prevented ACP construction
over non-ACP-capable, but LLDP- or CDP-enabled L2 switches.  LLDP has extensions using different MAC
addresses, and this could have been an option for ACP discovery as well, but the additional required
IEEE standardization and definition of a profile for such a modified instance of LLDP seemed to be
more work than the benefit of "reusing the existing protocol" LLDP for this very simple purpose.</t>
        </section>
        <section anchor="discovery-mdns" numbered="true" toc="default">
          <name>mDNS and L2 Support</name>
          <t>Multicast DNS (mDNS) "<xref target="RFC6762" format="title"/>" <xref target="RFC6762" format="default"/> with DNS Service Discovery (DNS-SD) Resource Records (RRs) as defined in "<xref target="RFC6763" format="title"/>" <xref target="RFC6763" format="default"/>
was a key contender as an ACP discovery protocol. Because it relies on link-local IP multicast,
it operates at the subnet level and is also found in L2 switches.  The authors
of this document are not aware of an mDNS implementation that terminates its mDNS messages
on L2 ports instead of on the subnet level.  If mDNS was used as the ACP discovery mechanism on
an ACP-capable (L3)/L2 switch as outlined in <xref target="acp-l2-switches" format="default"/>, then this would
be necessary to implement.  It is likely that termination of mDNS messages could only be applied to
all mDNS messages from such a port, which would then make it necessary to software forward any non-ACP-related 
mDNS messages to maintain prior non-ACP mDNS functionality.  Adding support for ACP to such
 L2 switches with mDNS could therefore create regression problems for prior mDNS functionality on those nodes.
With low performance of software forwarding in many L2 switches, this could also make the ACP
risky to support on such L2 switches.</t>
        </section>
        <section anchor="discovery-comparison" numbered="true" toc="default">
          <name>Why DULL GRASP?</name>
          <t>LLDP was not considered because of the above mentioned issues. mDNS was not selected
because of the above L2 mDNS considerations and because of the following additional points.</t>
          <t>If mDNS was not already existing in a node, it would be more work to implement than
DULL GRASP, and if an existing implementation of mDNS was used, it would likely be more code
space than a separate implementation of DULL GRASP or a shared implementation of DULL
GRASP and GRASP in the ACP.</t>
        </section>
      </section>
      <section anchor="why-rpl" numbered="true" toc="default">
        <name>Choice of Routing Protocol (RPL)</name>
        <t>This section motivates why RPL ("IPv6 Routing Protocol for Low-Power and Lossy Networks <xref target="RFC6550" format="default"/>) was chosen as the default (and in this specification only) routing protocol for the ACP.  The choice and above explained profile were derived from a pre-standard implementation of ACP that was successfully deployed in operational networks.</t>
        <t>The requirements for routing in the ACP are the following:
                        </t>
        <ul spacing="normal">
          <li>Self-management: the ACP must build automatically, without human
	  intervention.  Therefore, the routing protocol must also work completely
	  automatically.  RPL is a simple, self-managing protocol, which does
	  not require zones or areas; it is also self-configuring, since
	  configuration is carried as part of the protocol (see <xref target="RFC6550" sectionFormat="of" section="6.7.6"/>).</li>
          <li>Scale: the ACP builds over an entire domain, which could be a large enterprise or service provider network.  The routing protocol must therefore support domains of 100,000 nodes or more, ideally without the need for zoning or separation into areas.  RPL has this scale property.  This is based on extensive use of default routing.</li>
          <li>Low resource consumption: the ACP supports traditional network infrastructure, thus runs in addition to traditional protocols.  The ACP, and specifically the routing protocol, must have low resource consumption requirements, both in terms of memory and CPU.  Specifically, at edge nodes, where memory and CPU are scarce, consumption should be minimal.  RPL builds a DODAG, where the main resource consumption is at the root of the DODAG.  The closer to the edge of the network, the less state needs to be maintained.  This adapts nicely to the typical network design.  Also, all changes below a common parent node are kept below that parent node.</li>
          <li>Support for unstructured address space: in the ANI, node addresses are identifiers, they and may not be assigned in a topological way.  Also, nodes may move topologically, without changing their address.  Therefore, the routing protocol must support completely unstructured address space.  RPL is specifically made for mobile, ad hoc networks, with no assumptions on topologically aligned addressing.</li>
          <li>Modularity: to keep the initial implementation small, yet allow for more complex methods later, it is highly desirable that the routing protocol has a simple base functionality, but can import new functional modules if needed.  RPL has this property with the concept of "Objective Function", which is a plugin to modify routing behavior.</li>
          <li anchor="extens">Extensibility: since the ANI is a new concept, it is likely that changes to the way of operation will happen over time.  RPL allows for new Objective Functions to be introduced later, which allow changes to the way the routing protocol creates the DAGs.</li>
          <li>Multi-topology support: it may become necessary in the future to support more than one DODAG for different purposes, using different Objective Functions.  RPL allow for the creation of several parallel DODAGs should this be required.  This could be used to create different topologies to reach different roots.</li>
          <li>No need for path optimization: RPL does not necessarily compute the optimal path between any two nodes.  However, the ACP does not require this today, since it carries mainly delay-insensitive feedback loops.  It is possible that different optimization schemes will become necessary in the future, but RPL can be expanded (see <xref target="extens" format="none">"Extensibility"</xref> above).</li>
        </ul>
      </section>
      <section anchor="acp-grasp" numbered="true" toc="default">
        <name>ACP Information Distribution and Multicast</name>
        <t>IP multicast is not used by the ACP because the ANI itself does not require IP multicast 
        but only service announcement/discovery.  Using IP multicast for that would have made it
        necessary to develop a zero-touch autoconfiguring solution for ASM (Any Source Multicast - the original form of IP multicast defined in "<xref target="RFC1112" format="title"/>" <xref target="RFC1112" format="default"/>), which
        would be quite complex and difficult to justify.  One aspect of complexity
        where no attempt at a solution has been described
        in IETF documents is the automatic selection of 
        routers that should be PIM Sparse Mode (PIM-SM) Rendezvous Points (RPs) (see "<xref target="RFC7761" format="title"/>" <xref target="RFC7761" format="default"/>).  The other aspects of complexity
        are the implementation of MLD ("<xref target="RFC4604" format="title"/>" <xref target="RFC4604" format="default"/>), PIM-SM, and Anycast-RP (see "<xref target="RFC4610" format="title"/>" <xref target="RFC4610" format="default"/>).  If those implementations already
        exist in a product, then they would be very likely tied to accelerated forwarding,
        which consumes hardware resources, and that in turn is difficult to justify as a cost
        of performing only service discovery.</t>
        <t>Some future ASA may need high-performance, in-network data replication.  That is the case
        when the use of IP multicast is justified.  Such an ASA can then use service discovery
        from ACP GRASP, and then they do not need ASM but only SSM (see "<xref target="RFC4607" format="title"/>" <xref target="RFC4607" format="default"/>)
        for the IP multicast replication.  SSM itself can simply be enabled in the data plane
        (or even in an update to the ACP) without any configuration other than just enabling it
        on all nodes, and it only requires a simpler version of MLD (see "<xref target="RFC5790" format="title"/>" <xref target="RFC5790" format="default"/>).</t>
        <t>IGP routing protocols based on LSP (Link State Protocol) typically have a mechanism to
        flood information, and such a mechanism could be used to flood GRASP objectives by
        defining them to be information of that IGP.  This would be a possible optimization
        in future variations of the ACP that do use an LSP-based routing protocol.  Note though that 
        such a mechanism would not work easily for GRASP M_DISCOVERY messages, which are intelligently
        (constrained) flooded not across the whole ACP, but only up to a node where a responder is found.
        We expect that many future services in the ASA will have only a few consuming ASAs, and for those cases,
        the M_DISCOVERY method is more efficient than flooding across the whole domain.</t>
        <t>Because the ACP uses RPL, one desirable future extension is to use RPL's existing 
        notion of DODAG, which are loop-free distribution trees, to make GRASP flooding more efficient
        both for M_FLOOD and M_DISCOVERY. See <xref target="ACP_interfaces" format="default"/> for how this will be
        specifically beneficial when using NBMA interfaces.  This
        is not currently specified in this document because it is not quite clear yet what
        exactly the implications are to make GRASP flooding depend on RPL DODAG convergence
        and how difficult it would be to let GRASP flooding access the DODAG information.</t>
      </section>

      <section anchor="domain-usage" numbered="true" toc="default">
        <name>CAs, Domains, and Routing Subdomains</name>
        <t>There is a wide range of setting up different ACP solutions by appropriately using CAs and the domain and rsub elements in the acp-node-name in the domain certificate.  We summarize these options here as they have been explained in different parts of the document and discuss possible and desirable extensions.</t>
        <t>An ACP domain is the set of all ACP nodes that can authenticate each other as belonging to the same ACP network using the ACP domain membership check (<xref target="certcheck" format="default"/>).  GRASP inside the ACP is run across all transitively connected ACP nodes in a domain.</t>
        <t>The rsub element in the acp-node-name permits the use of addresses from different ULA prefixes.  One use case is the creation of multiple physical networks that initially may be separated with one ACP domain but different routing subdomains, so that all nodes can mutually trust their ACP certificates (not depending on rsub) and so that they could connect later together into a contiguous ACP network.</t>
        <t>One instance of such a use case is an ACP for regions interconnected via a non-ACP enabled core, for example, due to the absence of product support for ACP on the core nodes. ACP connect configurations as defined in this document can be used to extend and interconnect those ACP islands to the NOC and merge them into a single ACP when later that product support gap is closed.</t>
        <t>Note that RPL scales very well.  It is not necessary to use multiple routing subdomains to scale ACP domains in a way that would be required if other routing protocols where used.  They exist only as options for the above mentioned reasons.</t>
        <t> If ACP domains need to be created that are not allowed to connect to each other by default, simply use different domain elements in the acp-node-name.  These domain elements can be arbitrary, including subdomains of one another: domains "example.com" and "research.example.com" are separate domains if both are domain elements in the acp-node-name of certificates.</t>
        <t>It is not necessary to have a separate CA for different ACP domains: an operator can use a single CA to sign certificates for multiple ACP domains that are not allowed to connect to each other because the checks for ACP adjacencies include the comparison of the domain part.</t>
        <t>If multiple, independent networks chose the same domain name but had their own CAs, these would not form a single ACP domain because of CA mismatch.  Therefore, there is no problem in choosing domain names that are potentially also used by others.  Nevertheless, it is highly recommended to use domain names that have a high probability of being unique.  It is recommended to use domain names that start with a DNS domain name owned by the assigning organization and unique within it, for example, "acp.example.com" if you own "example.com".</t>
      </section>
      <section anchor="intent" numbered="true" toc="default">
        <name>Intent for the ACP</name>
        <t>Intent is the architecture component of Autonomic Networks according to
 <xref target="RFC8993" format="default"/> that allows operators to issue policies to
the network.  Its applicability for use is quite  flexible and freeform, with potential applications including
policies flooded across ACP GRASP and interpreted on every ACP node.</t>
        <t>One concern for future definitions of Intent solutions is the problem of circular dependencies
when expressing Intent policies about the ACP itself.</t>
        <t>For example, Intent could indicate the desire to build an ACP across all domains
that have a common parent domain (without relying on the rsub/routing-subdomain
solution defined in this document): ACP nodes with the domains "example.com",
 "access.example.com", "core.example.com", and "city.core.example.com"
should all establish one single ACP.</t>
        <t>If each domain has its own source of Intent, then the Intent would simply have to
allow adding the peer domain's TA and domain names to the parameters for the ACP domain membership check
(<xref target="certcheck" format="default"/>) so that nodes from those other domains are accepted as ACP peers.</t>
        <t>If this Intent was to be originated only from one domain, it could likely not be made
to work because the other domains will not build any ACP connections amongst each other,
whether they use the same or different CA due to the ACP domain membership check.</t>
        <t>If the  domains use the same CA, one could change the ACP setup to permit the
ACP to be established between two ACP nodes with different acp-domain-names, but only
 for the purpose of disseminating limited information,
such as Intent, but not to set up full ACP connectivity, specifically not RPL routing
and passing of arbitrary GRASP information, unless the Intent policies permit this
 to happen across domain boundaries.</t>
        <t>This type of approach, where the ACP first allows Intent to operate and only then
sets up the rest of ACP connectivity based on Intent policy, could also be used to
enable Intent policies that would limit functionality across the ACP inside a domain,
as long as no policy would disturb the distribution of Intent, for example, to limit
reachability across the ACP to certain types of nodes or locations of nodes.</t>
      </section>
      <section anchor="reuse-acp" numbered="true" toc="default">
        <name>Adopting ACP Concepts for Other Environments</name>
        <t>The ACP as specified in this document is very explicit about the choice of options to
allow interoperable implementations.  The choices made may not be the best for all environments,
but the concepts used by the ACP can be used to build derived solutions.</t>
        <t>The ACP specifies the use of ULA and the derivation of its prefix from the domain name
so that no address allocation is required to deploy the ACP. The ACP will equally
work using any other /48 IPv6 prefix and not ULA.  This prefix could simply be a configuration 
of the ACP registrars (for example, when using BRSKI) to enroll the domain certificates, instead
of the ACP registrar deriving the /48 ULA prefix from the AN domain name.</t>
        <t>Some solutions may already have an auto-addressing scheme, for example, derived from 
existing, unique device identifiers (e.g., MAC addresses).  In those cases, it may not be desirable
to assign addresses to devices via the ACP address information field in the way described
in this document.  The certificate may simply serve to identify the ACP domain, 
and the address field could be omitted. The only fix required in the remaining
way the ACP operates is to define another element in the domain certificate for
the two peers to decide who is the Decider and who is the Follower during secure channel building. 
Note though that future work may leverage the ACP address to authenticate "ownership"
of the address by the device.  If the ACP address used by a device is derived from some preexisting,
permanent local ID (such as MAC address), then it would be useful
to store that local ID also in the certificate.</t>

        <t>The ACP is defined as a separate VRF because it intends to support well-managed
networks with a wide variety of configurations.  Therefore, reliable,
configuration-indestructible connectivity cannot be achieved from the data plane itself.
In solutions where all functions that impact transit connectivity are fully automated (including security),
indestructible, and resilient, it would be possible to eliminate the need for the ACP to be a separate VRF.
Consider the most simple example system in which there is no separate data plane, but the ACP is the data plane.  Add
BRSKI, and it becomes a fully Autonomic Network -- except that it does not support
automatic addressing for user equipment.  This gap can then be closed, for example, by adding a
solution derived from "<xref target="RFC8992" format="title"/>" <xref target="RFC8992" format="default"/>.</t>
        <t>TCP/TLS as the protocols to provide reliability and security to GRASP in the ACP
may not be the preferred choice in constrained networks. For example, CoAP/DTLS
(Constrained Application Protocol) may be preferred where they are already used, 
which would reduce the additional code space footprint for the ACP on
those devices. Hop-by-hop reliability for ACP GRASP messages could be made
to support protocols like DTLS by adding the same type of
negotiation as defined in this document for ACP secure channel protocol negotiation.
In future ACP extensions meant to better support constrained devices, 
end-to-end GRASP connections can be made to select their transport protocol
by indicating the supported transport protocols (e.g. TLS/DTLS) via GRASP parameters
of the GRASP objective through which the transport endpoint is discovered.</t>
        <t>RPL, the routing protocol used for the ACP, explicitly does not optimize
for shortest paths and fastest convergence.  Variations of the ACP may want to use a
different routing protocol or introduce more advanced RPL profiles.</t>
        <t>Variations such as which routing protocol to use, or whether to instantiate an ACP
in a VRF or (as suggested above) as the actual data plane, can be automatically chosen
in implementations built to support multiple options by deriving them from future parameters
in the certificate.  Parameters in certificates should be limited to those that would
not need to be changed more often than that certificates would need to be updated,
or it should be ensured that these parameters can be provisioned before the
variation of an ACP is activated in a node.  Using BRSKI, this could be done, for example,
as additional follow-up signaling directly after the certificate enrollment, still 
leveraging the BRSKI TLS connection and therefore not introducing any additional
connectivity requirements.</t>
        <t>Last but not least, secure channel protocols including their encapsulations are
easily added to ACP solutions.  ACP hop-by-hop network-layer secure channels could
also be replaced by end-to-end security plus other means for infrastructure
protection.  Any future network OAM should always use end-to-end security. By
leveraging the domain certificates, it would not be dependent on security
provided by ACP secure channels.</t>
      </section>
      <section anchor="futures" numbered="true" toc="default">
        <name>Further (Future) Options</name>
        <section anchor="auto-aggregation" numbered="true" toc="default">
          <name>Auto-Aggregation of Routes</name>
          <t>Routing in the ACP according to this specification only leverages the
standard RPL mechanism of route optimization, e.g., keeping only the routes that
are not towards the RPL root. This is known to scale to networks with 20,000 or more nodes.
There is no auto-aggregation of routes for /48 ULA prefixes (when using rsub
in the acp-node-name) and/or Zone-ID based prefixes.</t>
          <t>Automatic assignment of Zone-ID and auto-aggregation of routes could
be achieved, for example, by configuring zone boundaries, announcing via GRASP
into the zones the zone parameters (Zone-ID and /48 ULA prefix), and auto-aggregating
routes on the zone boundaries. Nodes would assign their Zone-ID and potentially
even the /48 prefix based on the GRASP announcements.</t>
        </section>
        <section anchor="dp-dependency" numbered="true" toc="default">
          <name>More Options for Avoiding IPv6 Data Plane Dependencies</name>
          <t>As described in <xref target="general_addressing" format="default"/>, the ACP depends on the
data plane to establish IPv6 link-local addressing on interfaces. Using a separate
MAC address for the ACP allows the full isolation of the ACP from the data plane in
a way that is compatible with this specification. It is also an ideal option
when using single-root input/output virtualization (SR-IOV, see 
<xref target="SR"/>)
 in an implementation to isolate the ACP because
different SR-IOV interfaces use different MAC addresses.</t>
          <t>When additional MAC address(es) are not available, separation of the
ACP could be done at different demux points. The same subnet interface could have
a separate IPv6 interface for the ACP and data plane and therefore separate
link-local addresses for both, where the ACP interface is not configurable on
the data plane. This too would be compatible with this specification and not
impact interoperability.</t>
          <t>An option that would require additional specification is to use a different
Ethertype from 0x86DD (IPv6) to encapsulate IPv6 packets for the ACP. This would
be a similar approach as used for IP authentication packets in <xref target="IEEE-802.1X" format="default"/>,
which uses the Extensible Authentication Protocol over Local Area Network (EAPoL) 
Ethertype (0x88A2).</t>
          <t>Note that in the case of ANI nodes, all of the above considerations equally
apply to the encapsulation of BRSKI packets including GRASP used for BRSKI.</t>
        </section>
        <section anchor="acp-api" numbered="true" toc="default">
          <name>ACP APIs and Operational Models (YANG)</name>
          <t>Future work should define a YANG data model <xref target="RFC7950" format="default"/> 
and/or node-internal APIs to monitor and manage the ACP.</t>
          <t>Support for the ACP adjacency table (<xref target="adj-table" format="default"/>) and ACP GRASP needs to
be included in such model and/or API.</t>
        </section>
        <section anchor="future-rpl" numbered="true" toc="default">
          <name>RPL Enhancements</name>
          <figure anchor="dual-noc">
            <name>Dual NOC</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[

   ..... USA ......              ..... Europe ......

        NOC1                           NOC2
         |                              |
         |            metric 100        |
       ACP1 --------------------------- ACP2  .
         |                              |     . WAN
         | metric 10          metric 20 |     . Core
         |                              |     . 
       ACP3 --------------------------- ACP4  .
         |            metric 100        |
         |                              |     .
         |                              |     . Sites
       ACP10                           ACP11  .
      
]]></artwork>
          </figure>
          <t>The profile for RPL specified in this document builds only one spanning-tree path set to a root, typically a registrar in one NOC. In the presence of multiple NOCs, routing toward the non-root NOCs may be suboptimal. <xref target="dual-noc" format="default"/> shows an extreme example. Assuming that node ACP1 becomes the RPL root, traffic between ACP11 and NOC2 will pass through ACP4-ACP3-ACP1-ACP2 instead of ACP4-ACP2 because the RPL-calculated DODAG and routes are shortest paths towards the RPL root.</t>
          <t>To overcome these limitations, extensions and/or modifications to the RPL profile can optimize for multiple NOCs.  This requires utilizing data plane artifacts, including IP-in-IP encapsulation/decapsulation on ACP routers and processing of IPv6 RPI headers.  Alternatively, (Src,Dst) routing table entries could be used.</t>
          <t>Flooding of ACP GRASP messages can be further constrained and therefore optimized by flooding only via links that are part of the RPL DODAG.</t>
        </section>
        <section anchor="role-assignments" numbered="true" toc="default">
          <name>Role Assignments</name>
          <t>ACP connect is an explicit mechanism to "leak" ACP traffic explicitly (for example,
in a NOC). It is therefore also a possible security gap when it is easy to enable ACP
 connect on arbitrary compromised ACP nodes.</t>
          <t>One simple solution is to define an extension in the ACP certificate's ACP information
field indicating the permission for ACP connect to be configured on that ACP node. This
could similarly be done to decide whether a node is permitted to be a registrar or not.</t>
          <t>Tying the permitted "roles" of an ACP node to the ACP certificate provides
fairly strong protection against misconfiguration, but it is still subject to code
modifications.</t>
          <t>Another interesting role to assign to certificates is that of a NOC node. This would allow the
limiting of certain types of connections, such as OAM TLS connections to only the NOC initiators
or responders.</t>
        </section>
        <section anchor="l3-transit" numbered="true" toc="default">
          <name>Autonomic L3 Transit</name>
          <t>In this specification, the ACP can only establish autonomic connectivity across L2
hops  but requires non-autonomic configuration to tunnel across L3 paths. Future work should
specify mechanisms to automatically tunnel ACP across L3 networks. A hub-and-spoke
option would allow tunneling across the Internet to a cloud or central instance of the ACP;
a peer-to-peer tunneling mechanism could tunnel ACP islands across an L3VPN infrastructure.</t>
        </section>
        <section anchor="future-diag" numbered="true" toc="default">
          <name>Diagnostics</name>
          <t><xref target="diagnostics" format="default"/> describes diagnostics options that can be applied
without changing the external, interoperability-affecting characteristics of ACP implementations.</t>
          <t>Even better diagnostics of ACP operations are possible with additional
signaling extensions, such as the following:</t>
          <ol type="1" spacing="normal">
            <li>Consider if LLDP should be a recommended functionality for ANI devices
    to improve diagnostics, and if so, which information elements it should
    signal (noting that such information is conveyed in an insecure manner). This includes potentially new information elements.</li>
            <li>As an alternative to LLDP, a DULL GRASP diagnostics objective could
    be defined to carry these information elements.</li>
            <li>The IDevID certificate of BRSKI pledges should be included in the selected
    insecure diagnostics option. This may be undesirable when exposure of device information is seen as too much of a security issue (the ability to deduce possible attack vectors from device model, for example).</li>
            <li>A richer set of diagnostics information should be made available
    via the secured ACP channels, using either single-hop GRASP or
    network-wide "topology discovery" mechanisms.</li>
          </ol>
        </section>

        <section anchor="compromised" numbered="true" toc="default">
          <name>Avoiding and Dealing with Compromised ACP Nodes</name>
          <t>Compromised ACP nodes pose the biggest risk to the operations of the network.
The most common types of compromise are the leakage of credentials to manage and/or configure
the device and the application of malicious configuration, including the change
of access credentials, but not the change of software. Most of today's networking
equipment should have secure boot/software infrastructure anyhow, so attacks
that introduce malicious software should be a lot harder.</t>
          <t>The most important aspect of security design against these types of attacks is
to eliminate password-based configuration access methods and instead rely on
certificate-based credentials handed out only to nodes where it is clear that
the private keys cannot leak. This limits unexpected propagation of credentials.</t>
          <t>If password-based credentials to configure devices still need to be supported, they must not be
locally configurable, but only be remotely provisioned or verified (through
protocols like RADIUS or Diameter), and there must be no local configuration
permitting the change of these authentication mechanisms, but ideally they should
be autoconfiguring across the ACP. See <xref target="I-D.eckert-anima-noc-autoconfig" format="default"/>.</t>
          <t>Without physical access to the compromised device, attackers with access to
configuration should not be able to break the ACP connectivity, even when they
can break or otherwise manipulate (spoof) the data plane connectivity through configuration.
To achieve this, it is necessary to avoid providing configuration options for the
ACP, such as enabling/disabling it on interfaces. For example, there could be an
ACP configuration that locks down the current ACP configuration unless factory reset is done.</t>
          <t>With such means, the valid administration has the best chances to maintain
access to ACP nodes, to discover malicious configuration though ongoing configuration
tracking from central locations, for example, and to react accordingly.</t>
          <t>The primary reaction is to withdraw or change credentials, terminate malicious
existing management sessions, and fix the configuration. Ensuring that management
sessions using invalidated credentials are terminated automatically without recourse will
likely require new work.</t>
          <t>Only when these steps are infeasible, would it be necessary
to revoke or expire the ACP certificate credentials and consider the node kicked off the network
until the situation can be further rectified, likely requiring direct physical access to the node.</t>
          <t>Without extensions, compromised ACP nodes can only be removed from the ACP
at the speed of CRL/OCSP information refresh or expiry (and non-removal)
of short-lived  certificates. Future extensions to the ACP could, for
example, use the GRASP flooding distribution of triggered updates of CRL/OCSP or
the explicit removal indication of the compromised node's domain certificate.</t>
        </section>

        <section anchor="downgrade" numbered="true" toc="default">
          <name>Detecting ACP Secure Channel Downgrade Attacks</name>
          <t>The following text proposes a mechanism to protect against downgrade attacks without introducing a new specialized GRASP secure channel mechanism. Instead, it relies on running GRASP after establishing a secure channel protocol to verify if the established secure channel option could have been the result of a MITM downgrade attack.</t>

          <t>MITM attackers can force downgrade attacks for ACP secure channel selection by filtering and/or modifying DULL GRASP messages and/or actual secure channel data packets. For example, if at some point in time, DTLS traffic could be more easily decrypted than traffic of IKEv2, the MITM could filter all IKEv2 packets to force ACP nodes to use DTLS (assuming that the ACP nodes in question supported both DTLS and IKEv2).</t>
          <t>For cases where such MITM attacks are not capable of injecting malicious traffic (but only of decrypting the traffic), a downgrade attack could be discovered after a secure channel connection is established, for example, by using the following type of mechanism.</t>
          <t>After the secure channel connection is established, the two ACP peers negotiate, via an appropriate (to be defined) GRASP negotiation, which ACP secure channel protocol should have been selected between them (in the absence of a MITM attacker). This negotiation would signal the ACP secure channel options announced by DULL GRASP by each peer followed by an announcement of the preferred secure channel protocol by the ACP peer that is the Decider in the secure channel setup, i.e., the ACP peer that decides which secure channel protocol to use.  If that chosen secure channel protocol is different from the one that actually was chosen, then this mismatch is an indication that there is a MITM attacker or other similar issue (e.g., a firewall prohibiting the use of specific protocols) that caused a non-preferred secure channel protocol to be chosen. This discovery could then result in mitigation options such as logging and ensuing investigations.</t>
        </section>

      </section>
    </section>

    <section anchor="ack" numbered="false" toc="default">
      <name>Acknowledgements</name>
      <t>This work originated from an Autonomic Networking project at Cisco
      Systems, which started in early 2010. Many people contributed to this project and the idea of the Autonomic Control Plane, amongst whom (in alphabetical order): <contact fullname="Ignas Bagdonas"/>, <contact fullname="Parag Bhide"/>, <contact fullname="Balaji BL"/>, <contact fullname="Alex Clemm"/>, <contact fullname="Yves Hertoghs"/>, <contact fullname="Bruno Klauser"/>, <contact fullname="Max Pritikin"/>, <contact fullname="Michael Richardson"/>, and <contact fullname="Ravi Kumar Vadapalli"/>.</t>
      <t>Special thanks to <contact fullname="Brian Carpenter"/>, <contact fullname="Elwyn Davies"/>, <contact fullname="Joel Halpern"/>, and <contact fullname="Sheng Jiang"/> for their thorough reviews.</t>
      <t>Many thanks to <contact fullname="Ben Kaduk"/>, <contact fullname="Roman Danyliw"/>, and <contact fullname="Eric Rescorla"/> for their thorough SEC AD reviews, <contact fullname="Russ Housley"/> and <contact fullname="Erik Kline"/> for their reviews, and to <contact fullname="Valery Smyslov"/>, <contact fullname="Tero Kivinen"/>, <contact fullname="Paul Wouters"/>, and <contact fullname="Yoav Nir"/> for review of IPsec and IKEv2 parameters and helping to understand those and other security protocol details better. Thanks to <contact fullname="Carsten Bormann"/> for CBOR/CDDL help.</t>
      <t>Further input, review, or suggestions were received from <contact fullname="Rene Struik"/>, <contact fullname="Benoit Claise"/>, <contact fullname="William Atwood"/>, and <contact fullname="Yongkang Zhang"/>.</t>
    </section>

    <section anchor="contributors" numbered="false" toc="default">
      <name>Contributors</name>

        <t>For all things GRASP including validation code, ongoing document text support, and technical input:</t>

        <contact fullname="Brian Carpenter" initials="B. E." surname="Carpenter">
          <organization abbrev="Univ. of Auckland"/>
          <address>
            <postal>
              <street>School of Computer Science</street>
              <street>University of Auckland</street>
              <street>PB 92019</street>
              <city>Auckland</city>
              <code>1142</code>
              <country>New Zealand</country>
            </postal>
            <email>brian.e.carpenter@gmail.com</email>
          </address>
        </contact>

        <t>For RPL contributions and all things BRSKI/bootstrap including validation code, ongoing document text support, and technical input:</t>

    <contact fullname="Michael C. Richardson" initials="M." surname="Richardson">
      <organization abbrev="Sandelman">Sandelman Software Works</organization>
      <address>
        <email>mcr+ietf@sandelman.ca</email>
        <uri>http://www.sandelman.ca/mcr/</uri>
      </address>
    </contact>

        <t>For the RPL technology choices and text:</t>

   <contact initials="P" surname="Thubert" fullname="Pascal Thubert">
      <organization abbrev="Cisco Systems">Cisco Systems, Inc</organization>
      <address>
         <postal>
            <street>Building D</street>
            <street>45 Allee des Ormes - BP1200 </street>
            <city>Mougins - Sophia Antipolis</city>
            <code>06254</code>
            <country>France</country>
         </postal>
         <phone>+33 497 23 26 34</phone>
         <email>pthubert@cisco.com</email>
      </address>
   </contact>

    </section>



  </back>
</rfc>
