<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM "rfc2629-xhtml.ent">

<rfc xmlns:xi="http://www.w3.org/2001/XInclude" 
     docName="draft-ietf-mmusic-msrp-usage-data-channel-24" 
     number="8873" 
     ipr="trust200902" 
     updates="4975" 
     obsoletes="" 
     submissionType="IETF" 
     category="std" 
     consensus="true" 
     xml:lang="en" 
     tocInclude="true" 
     tocDepth="4" 
     symRefs="true" 
     sortRefs="true" 
     version="3">

  <!-- xml2rfc v2v3 conversion 3.2.1 -->

 <front>
  <title abbrev="MSRP over Data Channels">
                 Message Session Relay Protocol (MSRP) over Data Channels
    </title>
    <seriesInfo name="RFC" value="8873"/>

  <author initials="JM." surname="Recio" fullname="Jose M. Recio" role="editor">
      <organization>Unaffiliated</organization>
      <address>
        <email>jose@ch3m4.com</email>
      </address>
    </author>
    <author initials="C." surname="Holmberg" fullname="Christer Holmberg">
      <organization>Ericsson</organization>
      <address>
        <postal>
          <street>Hirsalantie 11</street>
          <city>Jorvas</city>
	  <code> 02420</code>
          <country>Finland</country>
        </postal>
        <email>christer.holmberg@ericsson.com</email>
      </address>
    </author>
    <date year="2021" month="January" />

  <area>ART</area>
    <workgroup>MMUSIC</workgroup>

<keyword>webrtc</keyword>

  <abstract>
      <t>
      This document specifies how a Web Real-Time Communication (WebRTC)
      data channel can be used as a transport mechanism for the Message Session Relay Protocol (MSRP)
      and how the Session Description Protocol (SDP) offer/answer mechanism can be used to negotiate
      such a data channel, referred to as an MSRP data channel. Two network configurations are supported:
      the connection of two MSRP data channel endpoints; and a gateway configuration, which connects an MSRP data channel
      endpoint with an MSRP endpoint that uses either TCP or TLS.  This document updates RFC 4975.
      </t>
    </abstract>
  </front>
  <middle>
    <section anchor="introduction" numbered="true" toc="default">
      <name>Introduction</name>
      <t>
      The Message Session Relay Protocol (MSRP) <xref target="RFC4975" format="default"/> is a protocol for transmitting a series
      of related instant messages in the context of a session. In addition to instant messaging, MSRP can also be
      used for image sharing or file transfer. MSRP was initially defined in <xref target="RFC4975" format="default"/> to work over
      TCP and TLS connections, and over a WebSocket subprotocol specified by <xref target="RFC7977" format="default"/>.
      </t>
      <t>
      This document specifies how a Web Real-Time Communication (WebRTC)
      data channel <xref target="RFC8831" format="default"/> can be used as a transport mechanism for MSRP
      without the TCP and TLS layers, and how the Session Description Protocol (SDP) offer/answer
      mechanism for data channels <xref target="RFC8864" format="default"/> can be used
      to negotiate such a data channel.
      </t>
      <t>
      In this document, an MSRP data channel refers to a WebRTC data
      channel for which the instantiated subprotocol is "msrp" and 
      the data channel is negotiated using the SDP offer/answer mechanism
      <xref target="RFC8864" format="default"/>.
      </t>
      <t>Defining MSRP as a data channel subprotocol has many benefits:
      </t>
      <ul spacing="normal">
        <li>provides to applications a proven protocol enabling instant messaging, file transfer, image sharing</li>
        <li>integrates those features with other WebRTC voice, video, and data features</li>
        <li>leverages the SDP-based negotiation already defined for MSRP</li>
        <li>allows the interworking with MSRP endpoints running on a TCP or TLS connection</li>
      </ul>
      <t>
      Compared to the WebSocket protocol, which provides a message-passing protocol to applications with no direct access to
      TCP or TLS sockets, data channels provide a low-latency transport and leverage NAT-aware connectivity and
      the security features of WebRTC.
      </t>
      <t>
   This document defines an MSRP data channel endpoint as an MSRP application that 
   uses a WebRTC data channel for MSRP transport.  This document describes
   configurations for connecting such endpoint to another MSRP data channel endpoint,
   or to an MSRP endpoint that uses either TCP or TLS transport.
      </t>
      <t>
      This document updates <xref target="RFC4975" format="default"/> as described in <xref target="updates-to-rfc4975" format="default"/>.
      </t>
    </section>
    <section numbered="true" toc="default">
      <name>Conventions</name>
      <t>
      The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", 
"<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", 
"<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", 
"<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>", 
"<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be 
interpreted as described in BCP 14 <xref target="RFC2119" format="default"/> <xref 
target="RFC8174" format="default"/> when, and only when, they appear in all capitals, as 
shown here. 
      </t>
    </section>
    <section numbered="true" toc="default">
      <name>WebRTC Data Channel Considerations</name>
      <section anchor="msrp-data-channel" numbered="true" toc="default">
        <name>MSRP Data Channel</name>
        <t>The following WebRTC data channel property values 
<xref target="RFC8831" format="default"/> apply to an MSRP data channel:</t>
        <table align="center">
          <thead>
            <tr>
              <th align="left">Property</th>
              <th align="left">Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Subprotocol Identifier</td>
              <td align="left">msrp</td>
            </tr>
            <tr>
              <td align="left">Transmission reliability</td>
              <td align="left">reliable</td>
            </tr>
            <tr>
              <td align="left">Transmission order</td>
              <td align="left">in-order</td>
            </tr>
            <tr>
              <td align="left">Label</td>
              <td align="left">See 
        <xref target="use-of-dcmap-attribute" format="default"/>
              </td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
    <section anchor="sdp-cons" numbered="true" toc="default">
      <name>SDP Considerations</name>
      <t>The generic SDP considerations, including the SDP offer/answer
        procedures <xref target="RFC3264" format="default"/>, for negotiating a WebRTC data channel are
        defined in <xref target="RFC8864" format="default"/>. This section
        and its subsections define the SDP considerations that are specific to an MSRP data channel,
        identified by the "subprotocol" attribute parameter, with an "msrp" parameter value
        in the 'dcmap' attribute.</t>
      <section numbered="true" toc="default">
        <name>MSRP URI</name>
        <t>This document extends the MSRP URI syntax <xref target="RFC4975" format="default"/> by defining the new transport parameter value "dc" (an abbreviation of data channel):</t>
	
        <sourcecode type="abnf"><![CDATA[
    transport  /= "dc"
    ; Add "dc" to existing transports per Section 9 of [RFC4975] ]]>
	</sourcecode>
	
        <t>MSRP design provides for new transport bindings (see <xref target="RFC4975" section="6" sectionFormat="of"/>). 
MSRP implementations are expected to allow unrecognized transports for which 
there is no need to establish a connection to the resource described by the URI, 
as is the case of data channels (<xref target="use-of-dcsa-attribute" format="default"/>).</t>
      </section>
      <section numbered="true" toc="default">
        <name>MSRP URI msrp-scheme</name>
        <t>The msrp-scheme portion of the MSRP URI that represents an MSRP data channel endpoint (used in the SDP 'path' attribute and in the MSRP message headers) is always "msrps", which indicates that the MSRP data channel is always secured using DTLS as described in <xref target="RFC8831" format="default"/>.</t>
      </section>
      <section anchor="use-of-dcmap-attribute" numbered="true" toc="default">
        <name>Use of the 'dcmap' Attribute</name>
        <t>An offerer and answerer <bcp14>SHALL</bcp14>, in each offer and answer, 
include a 'dcmap' attribute <xref target="RFC8864" format="default"/> in the SDP 
media description ("m=" section) <xref target="RFC4566" format="default"/> describing the SCTP association <xref target="RFC4960" format="default"/> used to realize the MSRP data channel.</t>
        <t>The attribute includes the following data channel parameters:
        </t>
        <ul spacing="normal">
          <li>"label=" labelstring</li>
          <li>"subprotocol=" "msrp"</li>
        </ul>
        <t>The labelstring is set by the MSRP application according to <xref target="RFC8864" format="default"/>.</t>
        <t>The offerer and answerer <bcp14>SHALL NOT</bcp14> include the 
"max-retr" and the "max-time" attribute parameters in the 'dcmap' attribute.</t>
        <t>The offerer and answerer <bcp14>MAY</bcp14> include the "ordered" attribute parameter in the 'dcmap' attribute. If included, the attribute parameter value <bcp14>SHALL</bcp14> be set to "true".</t>
        <t>Below is an example of a 'dcmap' attribute for an MSRP session to be 
negotiated with the "dcmap-stream-id" parameter set to 2 and the "label" parameter set to "chat":</t>
	
        <sourcecode type="sdp"><![CDATA[
a=dcmap:2 label="chat";subprotocol="msrp"
]]></sourcecode>
	
      </section>
      <section anchor="use-of-dcsa-attribute" numbered="true" toc="default">
        <name>Use of the 'dcsa' Attribute</name>
        <t>        
        An offerer and answerer can, in each offer and answer, include one or
        more data channel subprotocol attributes ('dcsa' attributes) <xref target="RFC8864" format="default"/> in
        the "m=" section describing the SCTP association used to realize the
        MSRP data channel. An SDP attribute included in a 'dcsa' attribute is referred
        to as a DCSA-embedded attribute.
        </t>
        <t>
        If an offerer or answerer receives a 'dcsa' attribute that contains
        an SDP attribute for which usage has not been defined for an MSRP data
        channel, the offerer or answerer should ignore the 'dcsa' attribute,
        following the rules in <xref target="RFC8864" section="6.7" sectionFormat="of"/>.
        </t>
        <t>
        An offerer and answerer <bcp14>SHALL</bcp14> include a 'dcsa' attribute for each of the following MSRP-specific SDP attributes:
        </t>
        <ul spacing="normal">
          <li>defined in <xref target="RFC4975" format="default"/>: 'path'.</li>
          <li>defined in <xref target="RFC6714" format="default"/>: 'msrp-cema'.</li>
          <li>defined in <xref target="RFC6135" format="default"/>: 'setup'. 
              See <xref target="use-of-setup-attribute" format="default"/>.</li>
        </ul>
        <t>
        It is considered a protocol error if one or more of the DCSA-embedded attributes listed above are not included in an offer or answer.
        </t>
        <t>An offerer and answerer <bcp14>MAY</bcp14> include a 'dcsa' attribute for any of the following MSRP-specific SDP attributes, following the procedures defined for each attribute:
        </t>
        <ul spacing="normal">
          <li>defined in <xref target="RFC4975" format="default"/>: 'accept-types', 'accept-wrapped-types', and 'max-size'.</li>
          <li>defined in <xref target="RFC4566" format="default"/>: 'sendonly', 'recvonly', 'inactive', and 'sendrecv'.</li>
          <li>defined in <xref target="RFC5547" format="default"/>: all the parameters related to MSRP file transfer. See <xref target="file_transfer_sdp" format="default"/>.</li>
        </ul>
        <t>
        A subsequent offer or answer <bcp14>MAY</bcp14> update the previously negotiated MSRP subprotocol attributes
        while keeping the 'dcmap' attribute associated with the MSRP data channel unchanged. The semantics
        for newly negotiated MSRP subprotocol attributes are per <xref target="RFC4975" format="default"/>.
        </t>
        <t>
        When MSRP messages are transported on a data channel, the 'path' attribute is not used for the routing
        of the messages. The MSRP data channel is established using the SDP offer/answer procedures defined
        in <xref target="RFC8864" format="default"/>, and the MSRP messages are then transported
        on that data channel. This is different from legacy MSRP <xref target="RFC4975" format="default"/> but similar to
        MSRP Connection Establishment for Media Anchoring  (MSRP CEMA) <xref target="RFC6714" format="default"/>. 
        Because of this, a DCSA-embedded 'msrp-cema' attribute is
        mandated for MSRP sessions over data channels. However, when an endpoint receives an MSRP message
        over a data channel, it <bcp14>MUST</bcp14> still perform the MSRP URI comparison procedures defined in
        <xref target="RFC4975" format="default"/>.
        </t>
      </section>
      <section anchor="use-of-setup-attribute" numbered="true" toc="default">
        <name>Use of the DCSA-Embedded 'setup' Attribute</name>
        <t>
        As described in <xref target="use-of-dcsa-attribute" format="default"/>, the usage of a 
DCSA-embedded 'setup' attribute is mandated for MSRP sessions over data channels. 
        It is used to negotiate which MSRP data channel endpoint assumes the active role as per 
        <xref target="RFC6135" section="4.2.2" sectionFormat="of"/> and
        <xref target="RFC4975" section="5.4" sectionFormat="of"/>. It has no relationship with the DTLS connection establishment roles <xref target="RFC8841" format="default"/>.
        </t>
        <t>
        The DCSA-embedded 'setup' attribute is of the form 
        "a=dcsa:x setup:&lt;role&gt;", with x being the data channel's SCTP stream identifier, so that
        the 'setup' attribute is explicitly associated with an MSRP session over a specific data channel.
        </t>
      </section>
      <section anchor="session-closing-sdp" numbered="true" toc="default">
        <name>Session Closing</name>
        <t>An MSRP session is closed by closing the associated data channel 
following the procedures in <xref target="RFC8864" format="default"/>.</t>
        <t>The port value for the "m=" line <bcp14>SHOULD NOT</bcp14> 
be changed (e.g., to zero) when closing an MSRP session (unless all data 
channels are being closed and the SCTP association is no longer needed) 
since this would close the SCTP association and impact all of the data channels. 
In all cases in <xref target="RFC4975" format="default"/> where the procedure 
calls for setting the port to zero in the MSRP "m=" line in an SDP offer 
for TCP transport, the SDP offerer of an MSRP session with data channel transport 
<bcp14>SHALL</bcp14> remove the corresponding 'dcmap' and 'dcsa' attributes.</t>
      </section>
      <section anchor="file_transfer_sdp" numbered="true" toc="default">
        <name>Support for MSRP File Transfer Function</name>
        <t>SDP attributes specified in <xref target="RFC5547" format="default"/> for a file transfer "m=" line are embedded as subprotocol-specific attributes using the syntax defined in <xref target="RFC8864" format="default"/>.</t>
      </section>
      <section anchor="example-sdp-negotiation" numbered="true" toc="default">
        <name>Example</name>
        <t>Below is an example of an offer and an answer that include the attributes needed to establish two MSRP sessions: one for chat and one for file transfer. The example is derived from a combination of examples in <xref target="RFC4975" format="default"/> and <xref target="RFC5547" format="default"/>.</t>
       
<t>Offer:</t>
 <sourcecode type="sdp"><![CDATA[

   m=application 54111 UDP/DTLS/SCTP webrtc-datachannel
   c=IN IP6 2001:db8::3
   a=max-message-size:100000
   a=sctp-port:5000
   a=setup:actpass
   a=fingerprint:SHA-256 12:DF:3E:5D:49:6B:19:E5:7C:AB:4A:AD:B9:B1:\
      3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB:4A:AD
   a=tls-id:4a756565cddef001be82
   a=dcmap:0 label="chat";subprotocol="msrp"
   a=dcsa:0 msrp-cema
   a=dcsa:0 setup:active
   a=dcsa:0 accept-types:message/cpim text/plain
   a=dcsa:0 path:msrps://2001:db8::3:54111/si438dsaodes;dc
   a=dcmap:2 label="file transfer";subprotocol="msrp"
   a=dcsa:2 sendonly
   a=dcsa:2 msrp-cema
   a=dcsa:2 setup:active
   a=dcsa:2 accept-types:message/cpim
   a=dcsa:2 accept-wrapped-types:*
   a=dcsa:2 path:msrps://2001:db8::3:54111/jshA7we;dc
   a=dcsa:2 file-selector:name:"picture1.jpg" type:image/jpeg \
      size:1463440 hash:sha-256:7C:DF:3E:5D:49:6B:19:E5:12:AB:4A:AD:\
      4A:B1:3F:82:3E:3B:54:12:02:5D:18:DF:49:6B:19:E5:7C:AB:B9:AD
   a=dcsa:2 file-transfer-id:rjEtHAcYVZ7xKwGYpGGwyn5gqsSaU7Ep
   a=dcsa:2 file-disposition:attachment
   a=dcsa:2 file-date:creation:"Tue, 11 Aug 2020 19:05:30 +0200"
   a=dcsa:2 file-icon:cid:id2@bob.example.com
   a=dcsa:2 file-range:1-1463440

]]></sourcecode>

 <t>Answer:</t>

  <sourcecode type="sdp"><![CDATA[

   m=application 51444 UDP/DTLS/SCTP webrtc-datachannel
   c=IN IP6 IP6 2001:db8::1
   a=max-message-size:100000
   a=sctp-port:6000
   a=setup:passive
   a=fingerprint:SHA-256 5D:02:3E:AD:49:6B:19:E5:7C:AB:4A:AD:B9:\
      B1:3F:82:18:3B:54:DF:12:6B:3E:5D:49:DF:19:E5:7C:AB:4A:5D
   a=tls-id:65cd4a7565debe82f100
   a=dcmap:0 label="chat";subprotocol="msrp"
   a=dcsa:0 msrp-cema
   a=dcsa:0 setup:passive
   a=dcsa:0 accept-types:message/cpim text/plain
   a=dcsa:0 path:msrps://2001:db8::1:51444/di551fsaodes;dc
   a=dcmap:2 label="file transfer";subprotocol="msrp"
   a=dcsa:2 recvonly
   a=dcsa:2 msrp-cema
   a=dcsa:2 setup:passive
   a=dcsa:2 accept-types:message/cpim
   a=dcsa:2 accept-wrapped-types:*
   a=dcsa:2 path:msrps://2001:db8::1:51444/jksh7Bwc;dc
   a=dcsa:2 file-selector:name:"picture1.jpg" type:image/jpeg \
      size:1463440
   a=dcsa:2 file-transfer-id:rjEtHAcYVZ7xKwGYpGGwyn5gqsSaU7Ep
   a=dcsa:2 file-range:1-1463440

   ]]></sourcecode>
  
        <t>
   Note that due to RFC formatting conventions, this document splits 
   SDP content that exceeds 72 characters across lines, marking this 
   line folding with a backslash character.  This backslash and its 
   trailing CRLF and whitespace would not appear in actual SDP content.
        </t>
      </section>
    </section>
    <section anchor="msrp-cons" numbered="true" toc="default">
      <name>MSRP Considerations</name>
      <t>The procedures specified in <xref target="RFC4975" format="default"/> apply except when this document specifies otherwise. This section describes the MSRP considerations specific to an MSRP data channel.</t>
      <section numbered="true" toc="default">
        <name>Session Mapping</name>
        <t>In this document, each MSRP session maps to one data channel exactly.</t>
      </section>
      <section anchor="session-opening-msrp" numbered="true" toc="default">
        <name>Session Opening</name>
        <t><xref target="use-of-setup-attribute" format="default"/> describes how the active MSRP data channel endpoint role is negotiated. The active MSRP data channel endpoint uses the data channel established for this MSRP session by the generic data channel opening procedure defined in <xref target="RFC8864" format="default"/>.</t>
        <t>As soon as the WebRTC data channel is opened, the MSRP session is actually opened by the active MSRP data channel endpoint. 
In order to do this, the active MSRP data channel endpoint sends an MSRP SEND message (empty or not) to the peer (passive) MSRP data channel endpoint.</t>
      </section>
      <section anchor="session-closing" numbered="true" toc="default">
        <name>Session Closing</name>
        <t>The closure of an MSRP session <bcp14>SHALL</bcp14> be signaled via 
SDP following the requirements in <xref target="session-closing-sdp" format="default"/>.</t>
        <t>If the data channel used to transport the MSRP session fails and is torn down, the MSRP data channel endpoints <bcp14>SHALL</bcp14> consider the MSRP session failed. An MSRP data channel endpoint <bcp14>MAY</bcp14>, based on local policy, try to negotiate a new MSRP data channel.</t>
      </section>
      <section anchor="data-framing" numbered="true" toc="default">
        <name>Data Framing</name>
        <t>Each text-based MSRP message is sent on the corresponding data channel using standard MSRP framing and chunking procedures, as defined in <xref target="RFC4975" format="default"/>, with each MSRP chunk delivered in a single SCTP user message. Therefore all sent MSRP chunks <bcp14>SHALL</bcp14> have lengths of less than or equal to the value of the peer's 'max-message-size' attribute <xref target="RFC8841" format="default"/> associated with the SCTP association.</t>
      </section>
      <section numbered="true" toc="default">
        <name>Data Sending, Receiving, and Reporting</name>
        <t>Data sending, receiving, and reporting procedures <bcp14>SHALL</bcp14> conform to <xref target="RFC4975" format="default"/>.</t>
      </section>
      <section anchor="file_transfer_msrp" numbered="true" toc="default">
        <name>Support for MSRP File Transfer Function</name>
        <t><xref target="RFC5547" format="default"/> defines an end-to-end 
file transfer method based on MSRP and the SDP offer/answer mechanism. 
This file transfer method is also usable by MSRP data channel endpoints  
with the following considerations:
        </t>
        <ul spacing="normal">
          <li>As an MSRP session maps to one data channel, a file transfer session maps also to one data channel.</li>
          <li>SDP attributes are negotiated as specified in <xref target="file_transfer_sdp" format="default"/>.</li>
          <li>Once the file transfer is complete, the same data channel <bcp14>MAY</bcp14> be reused for another file transfer.</li>
        </ul>
      </section>
    </section>
    <section anchor="gateway-cons" numbered="true" toc="default">
      <name>Gateway Considerations</name>
      <t>This section describes the network configuration where one MSRP endpoint uses an MSRP data channel as MSRP transport, the other MSRP endpoint uses TLS/TCP connections as MSRP transport, and the two MSRP endpoints interwork via a gateway.</t>
      <t>Specifically, a gateway can be configured to interwork an MSRP session over a data channel with a peer that does not support data channel transport in one of two ways.</t>
      <t>In one model, the gateway performs as an MSRP Back-to-Back User Agent (B2BUA) to interwork all the procedures as necessary between the endpoints.  No further specification is needed for this model.</t>
      <t>Alternately, the gateway can provide transport-level interworking between MSRP endpoints using different transport protocols. In accordance with <xref target="use-of-dcsa-attribute" format="default"/>, 
'path' attributes <bcp14>SHALL NOT</bcp14> be used for transport-level interworking.</t>
      <t>When the gateway performs transport-level interworking between 
MSRP endpoints, all of the procedures in <xref target="sdp-cons" format="default"/> and 
<xref target="msrp-cons" format="default"/> apply to each peer, with the following additions:

      </t>
      <ul spacing="normal">
        <li>The gateway <bcp14>SHALL</bcp14> use the MSRP CEMA mechanism <xref target="RFC6714" format="default"/> towards the non-data channel endpoint.</li>
        <li>If the non-data channel endpoint does not support MSRP CEMA, 
transport-level interworking mode is not possible, and the gateway needs to act as an MSRP B2BUA.</li>
        <li>The gateway <bcp14>SHALL NOT</bcp14> modify the 'path' attribute received from data channel or from non-data channel endpoints.</li>
        <li>The gateway <bcp14>SHALL NOT</bcp14> modify the 'setup' value 
received from data channel or from non-data channel endpoints.</li>
        <li>The endpoint establishing an MSRP session using data channel transport <bcp14>SHALL NOT</bcp14> request inclusion of any relays, although it <bcp14>MAY</bcp14> interoperate with a peer that signals the use of relays.</li>
      </ul>
    </section>
    <section anchor="updates-to-rfc4975" numbered="true" toc="default">
      <name>Updates to RFC 4975</name>
      <t>This document updates <xref target="RFC4975" format="default"/>
by allowing the usage of the "msrps" scheme when the underlying connection is protected with DTLS.</t>
    </section>
    <section anchor="Security" numbered="true" toc="default">
      <name>Security Considerations</name>
      <t>MSRP traffic over data channels, including confidentiality, integrity, and source authentication, 
is secured as specified by <xref target="RFC8831" format="default"/>.
      However, <xref target="RFC4975" format="default"/> allows transport of 
MSRP traffic over nonsecured TCP connections and does not provide a mechanism to guarantee usage of TLS end to end.
      As described in <xref target="RFC4975" format="default"/>, even if TLS is used between some hops,
TCP might still be used between other hops.
      Operators need to establish proper policies  
in order to ensure that the MSRP traffic is protected between endpoints.</t>
      <t><xref target="RFC5547" format="default"/> specifies security considerations related to the usage of MSRP for file transfer.</t>
      <t><xref target="RFC7092" format="default"/> specifies security considerations related to B2BUAs.</t>
      <t>Note that the discussion in <xref target="RFC4975" section="14.5" sectionFormat="of"/> on MSRP message attribution to remote identities applies to data channel transport.</t>
      <t>If the Session Initiation Protocol (SIP) <xref target="RFC3261" format="default"/> is used to implement the offer/answer transactions for establishing the MSRP data channel, the SIP security considerations specified in <xref target="RFC3261" format="default"/> apply.</t>
    </section>
    <section anchor="IANA" numbered="true" toc="default">
      <name>IANA Considerations</name>
      <section anchor="IANA-reg-msrps" numbered="true" toc="default">
        <name>"msrps" URI scheme</name>
        <t>This document modifies the usage of the "msrps" URI scheme, 
registered by <xref target="RFC4975" format="default"/>, 
by adding DTLS as a protected transport indicated by the URI scheme.</t>
        <t>A reference to RFC 8873 has been added to the URI scheme "msrps" 
in the "Uniform Resource Identifier (URI) Schemes" registry.</t>
      </section>
      <section anchor="IANA-reg-MSRP" numbered="true" toc="default">
        <name>Subprotocol Identifier "msrp"</name>
        <t>A reference to RFC 8873 has been added to the subprotocol identifier 
"msrp" in the "WebSocket Subprotocol Name Registry".</t>
      </section>
      <section anchor="IANA-reg-other-sdp" numbered="true" toc="default">
        <name>SDP Attributes</name>
        <t>
      This document modifies the usage of a set of SDP attributes if any of those
      attributes is included in an SDP 'dcsa' attribute associated with an
      MSRP data channel. The modified usage of the SDP 'setup' attribute is
      described in <xref target="use-of-setup-attribute" format="default"/>. The usage of the other
      SDP attributes is described in <xref target="use-of-dcsa-attribute" format="default"/>.
        </t>
        <ul spacing="normal">
          <li>'accept-types'</li>
          <li>'accept-wrapped-types'</li>
          <li>'file-date'</li>
          <li>'file-disposition'</li>
          <li>'file-icon'</li>
          <li>'file-range'</li>
          <li>'file-selector'</li>
          <li>'file-transfer-id'</li>
          <li>'inactive'</li>
          <li>'max-size'</li>
          <li>'msrp-cema'</li>
          <li>'path'</li>
          <li>'recvonly'</li>
          <li>'sendonly'</li>
          <li>'sendrecv'</li>
        </ul>

            
        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'accept-types' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>accept-types</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Contain the list of media types that the endpoint is willing to receive.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>
            
          
        </dl>


        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'accept-wrapped-types' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>accept-wrapped-types</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Contain the list of media types that the endpoint is willing to receive in an MSRP message with multipart content.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>
            
        </dl>

 
        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'file-date' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">

              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>file-date</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Indicate one or more dates related to the file in an MSRP file transfer negotiation.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>
            
            </dl>


	        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'file-disposition' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>file-disposition</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Provide a suggestion to the other endpoint about the intended disposition of the file in an MSRP file transfer negotiation.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>
            
        </dl>

    
        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'file-icon' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">

              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>file-icon</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Contain a pointer to a small preview icon representing the contents of the file in an MSRP file transfer negotiation.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>
            
            </dl>

	    
        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'file-range' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>file-range</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Contain the range of transferred octets of the file in an MSRP file transfer negotiation.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>   
              
        </dl>

 
        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'file-selector' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>file-selector</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Indicate a file in an MSRP file transfer negotiation.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>
          
        </dl>


        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'file-transfer-id' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>file-transfer-id</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Indicate a unique identifier of the file transfer operation in an MSRP file transfer negotiation.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>
          
        </dl>

         
        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'inactive' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>inactive</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Negotiate the direction of the media flow on an MSRP data channel.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>
          
        </dl>


        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'max-size' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>max-size</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Indicate the largest message an MSRP endpoint wishes to accept.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>
            
        </dl>


        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'msrp-cema' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>msrp-cema</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Indicate that the routing of MSRP messages transported on a data channel is more similar to the MSRP CEMA mechanism than the legacy MSRP routing mechanism.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>

        </dl>
 

        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'path' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>path</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Indicate an endpoint, but not used for routing, as described in 
<xref target="use-of-dcsa-attribute" format="default"/>.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>

        </dl>


        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'recvonly' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>recvonly</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Negotiate the direction of the media flow on an MSRP data channel.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>
 
        </dl>


        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'sendonly' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>sendonly</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Negotiate the direction of the media flow on an MSRP data channel.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>
            
        </dl>


        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'setup' attribute in the "att-field" subregistry as follows:</t>

         <dl spacing="compact" indent="18">
      
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>setup</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Negotiate the active role of an MSRP session over a data channel as per 
       <xref target="use-of-setup-attribute" format="default"/>.
              </dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>

         </dl>


        <t>The usage level "dcsa (msrp)" has been added to the registration of the SDP 
'sendrecv' attribute in the Session Description Protocol (SDP) Parameters "att-field" subregistry as follows:</t>
         <dl spacing="compact" indent="18">
 
              <dt>Contact name:</dt>
              <dd>IESG</dd>
            
            
              <dt>Contact email:</dt>
              <dd>iesg@ietf.org</dd>
            
            
              <dt>Attribute name:</dt>
              <dd>sendrecv</dd>
            
            
              <dt>Usage level:</dt>
              <dd>dcsa (msrp)</dd>
            
            
              <dt>Purpose:</dt>
              <dd>Negotiate the direction of the media flow on an MSRP data channel.</dd>
            
            
              <dt>Reference:</dt>
              <dd>RFC 8873</dd>
          
        </dl>
      </section>
    </section>
  </middle>

<back>

 <references>
      <name>References</name>
      <references>
        <name>Normative References</name>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>

<reference anchor="RFC8831" target="https://www.rfc-editor.org/info/rfc8831">
<front>
<title>WebRTC Data Channels</title>
<author initials="R" surname="Jesup" fullname="Randell Jesup">
  <organization/>
</author>
<author initials="S" surname="Loreto" fullname="Salvatore Loreto">
  <organization/>
</author>
<author initials="M" surname="Tüxen" fullname="Michael Tüxen">
  <organization/>
</author>
<date month='January' year='2021'/>
</front>
<seriesInfo name="RFC" value="8831"/>
<seriesInfo name="DOI" value="10.17487/RFC8831"/>
</reference>

  <reference anchor="RFC8864" target="https://www.rfc-editor.org/info/rfc8864">
    <front>
      <title>Negotiation Data Channels Using the Session Description
 Protocol (SDP)</title>
      <author fullname="Keith Drage" initials="K." surname="Drage">
        <organization>Unaffiliated</organization>
      </author>
      <author fullname="Raju Makaraju" initials="M." surname="Makaraju">
        <organization>Nokia</organization>
      </author>
      <author fullname="Richard Ejzak" initials="R." surname="Ejzak">
        <organization>Unaffiliated</organization>
      </author>
      <author fullname="Jerome Marcon" initials="J." surname="Marcon">
        <organization>Unaffiliated</organization>
      </author>
      <author fullname="Roni Even" initials="R." surname="Even" role="editor">
        <organization>Huawei</organization>
      </author>
      <date month="January" year="2021"/>
    </front>
    <seriesInfo name="RFC" value="8864"/>
    <seriesInfo name="DOI" value="10.17487/RFC8864"/>
  </reference>

<reference anchor="RFC8841" target="https://www.rfc-editor.org/info/rfc8841">

  <front>
    <title>Session Description Protocol (SDP) Offer/Answer Procedures for
    Stream Control Transmission Protocol (SCTP) over Datagram Transport Layer
    Security (DTLS) Transport</title>

    <author initials="C." surname="Holmberg" fullname="Christer Holmberg">
      <organization />
    </author>

    <author initials="R." surname="Shpount" fullname="Roman Shpount">
      <organization />
    </author>

    <author initials="S." surname="Loreto" fullname="Salvatore Loreto">
      <organization />
    </author>

    <author initials="G." surname="Camarillo" fullname="Gonzalo Camarillo">
      <organization />
    </author>

    <date month="January" year="2021" />
  </front>
  <seriesInfo name="RFC" value="8841" />
  <seriesInfo name="DOI" value="10.17487/RFC8841"/>

</reference>

        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3264.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4566.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4960.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4975.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5547.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6135.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6714.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7977.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
      </references>
      <references>
        <name>Informative References</name>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3261.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7092.xml"/>
      </references>
    </references>

    <section numbered="false" toc="default">
      <name>Acknowledgments</name>

      <t>The authors wish to acknowledge the borrowing of ideas from
      another Internet-Draft by <contact fullname="Peter Dunkley"/> and
      <contact fullname="Gavin Llewellyn"/>, and to thank 
      <contact fullname="Flemming Andreasen"/>, <contact fullname="Christian Groves"/>, 
      <contact fullname="Paul Kyzivat"/>, <contact fullname="Jonathan Lennox"/>, 
      <contact fullname="Uwe Rauschenbach"/>, <contact fullname="Albrecht Schwarz"/>, and 
      <contact fullname="Keith Drage"/> for their invaluable comments.</t>
   <t><contact fullname="Richard Ejzak"/>, <contact fullname="Keith Drage"/>, and 
      <contact fullname="Juergen Stoetzer-Bradler"/> contributed to an earlier draft version
      of this document before the draft was readopted.</t>
   <t><contact fullname="Julien Maisonneuve"/> helped with the readoption of this document, and  
      <contact fullname="Maridi R. Makaraju (Raju)"/> contributed valuable comments 
      after the document was readopted.</t>

    </section>


  </back>
</rfc>
