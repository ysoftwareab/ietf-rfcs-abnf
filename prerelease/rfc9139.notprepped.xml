<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>

<rfc xmlns:xi="http://www.w3.org/2001/XInclude" docName="draft-irtf-icnrg-icnlowpan-11" number="9139" ipr="trust200902" submissionType="IRTF" category="exp" consensus="true" obsoletes="" updates="" xml:lang="en" tocInclude="true" symRefs="true" sortRefs="true" version="3">

  <!-- xml2rfc v2v3 conversion 3.9.1 -->
  <front>
    <title abbrev="ICN Adaptation to LoWPANs">Information-Centric Networking (ICN) Adaptation to Low-Power Wireless Personal Area Networks (LoWPANs)</title>
    <seriesInfo name="RFC" value="9139"/>
    <author fullname="Cenk Gündoğan" initials="C." surname="Gündoğan">
      <organization abbrev="HAW Hamburg">HAW Hamburg</organization>
      <address>
        <postal>
          <street>Berliner Tor 7</street>
          <city>Hamburg</city>
          <code>D-20099</code>
          <country>Germany</country>
        </postal>
        <phone>+4940428758067</phone>
        <email>cenk.guendogan@haw-hamburg.de</email>
        <uri>http://inet.haw-hamburg.de/members/cenk-gundogan</uri>
      </address>
    </author>
    <author fullname="Thomas C. Schmidt" initials="T." surname="Schmidt">
      <organization abbrev="HAW Hamburg">HAW Hamburg</organization>
      <address>
        <postal>
          <street>Berliner Tor 7</street>
          <city>Hamburg</city>
          <code>D-20099</code>
          <country>Germany</country>
        </postal>
        <email>t.schmidt@haw-hamburg.de</email>
        <uri>http://inet.haw-hamburg.de/members/schmidt</uri>
      </address>
    </author>
    <author fullname="Matthias Wählisch" initials="M." surname="Wählisch">
      <organization abbrev="link-lab &amp; FU Berlin">link-lab &amp; FU
      Berlin</organization>
      <address>
        <postal>
          <street>Hoenower Str. 35</street>
          <city>Berlin</city>
          <code>D-10318</code>
          <country>Germany</country>
        </postal>
        <email>mw@link-lab.net</email>
        <uri>https://www.mi.fu-berlin.de/en/inf/groups/ilab/members/waehlisch.html</uri>
      </address>
    </author>
    <author fullname="Christopher Scherb" initials="C." surname="Scherb">
      <organization abbrev="FHNW">University of
      Applied Sciences and Arts Northwestern Switzerland</organization>
      <address>
        <postal>
          <street>Peter Merian-Str. 86</street>
          <city>Basel</city>
          <code>4002</code>
          <country>Switzerland</country>
        </postal>
        <email>christopher.scherb@fhnw.ch</email>
      </address>
    </author>
    <author fullname="Claudio Marxer" initials="C." surname="Marxer">
      <organization abbrev="University of Basel">University of
      Basel</organization>
      <address>
        <postal>
          <street>Spiegelgasse 1</street>
          <city>Basel</city>
          <code>4051</code>
          <country>Switzerland</country>
        </postal>
        <email>claudio.marxer@unibas.ch</email>
      </address>
    </author>
    <author fullname="Christian Tschudin" initials="C." surname="Tschudin">
      <organization abbrev="University of Basel">University of
      Basel</organization>
      <address>
        <postal>
          <street>Spiegelgasse 1</street>
          <city>Basel</city>
          <code>4051</code>
          <country>Switzerland</country>
        </postal>
        <email>christian.tschudin@unibas.ch</email>
      </address>
    </author>
    <date year="2021" month="November" />
    <workgroup>Information-Centric Networking</workgroup>

    <keyword>Content-Centric Networking (CCNx)</keyword>
    <keyword>Named Data Networking (NDN)</keyword>
    <keyword>header compression</keyword>
    <keyword>fragmentation</keyword>
    <keyword>6LoWPAN</keyword>
    <keyword>Internet of Things (IoT)</keyword>

    <abstract>
      <t>This document defines a convergence layer for Content-Centric Networking
      (CCNx) and Named Data Networking (NDN) over IEEE
      802.15.4 Low-Power Wireless Personal Area Networks (LoWPANs). A 
      new frame format is specified to adapt CCNx
      and NDN packets to the small MTU size of IEEE 802.15.4. For that,
      syntactic and semantic changes to the TLV-based header formats are
      described. To support compatibility with other LoWPAN technologies that
      may coexist on a wireless medium, the dispatching scheme provided by
      IPv6 over LoWPAN (6LoWPAN) is extended 
      to include new dispatch types for CCNx and NDN.
      Additionally, the fragmentation component of the 6LoWPAN
      dispatching framework is applied to Information-Centric Network (ICN) 
      chunks. In its second part, the
      document defines stateless and stateful compression schemes to improve
      efficiency on constrained links. Stateless compression reduces TLV
      expressions to static header fields for common use cases. Stateful
      compression schemes elide states local to the LoWPAN and replace names in
      Data packets by short local identifiers.</t>
      <t>This document is a product of the IRTF Information-Centric
      Networking Research Group (ICNRG).</t>
    </abstract>
  </front>
  <middle>
    <section anchor="intro" numbered="true" toc="default">
      <name>Introduction</name>
      <t>The Internet of Things (IoT) has been identified as a promising
      deployment area for Information-Centric Networking (ICN), as
      infrastructureless access to content, resilient forwarding, and
      in-network data replication demonstrates notable advantages over the
      Internet host-to-host approach <xref target="NDN-EXP1"
      format="default"/> <xref target="NDN-EXP2" format="default"/>. Recent studies <xref
      target="NDN-MAC" format="default"/> have shown that an appropriate mapping to
      link-layer technologies has a large impact on the practical performance of an ICN.
      This will be even more relevant in the context of IoT communication
      where nodes often exchange messages via low-power wireless links under
      lossy conditions. In this memo, we address the base adaptation of data
      chunks to such link layers for the ICN flavors NDN <xref target="NDN"
      format="default"/> and CCNx <xref target="RFC8569" format="default"/> <xref
      target="RFC8609" format="default"/>.</t>
      <t>The IEEE 802.15.4 <xref target="ieee802.15.4" format="default"/> link layer is
      used in low-power and lossy networks (see <tt>LLN</tt> in
      <xref target="RFC7228" format="default"/>), in which devices are typically
      battery operated and constrained in resources. Characteristics of LLNs
      include an unreliable environment, low-bandwidth transmissions, and
      increased latencies. IEEE 802.15.4 admits a maximum physical-layer
      packet size of 127 bytes. The maximum frame header size is 25 bytes,
      which leaves 102 bytes for the payload. IEEE 802.15.4 security features
      further reduce this payload length by up to 21 bytes, yielding a net of
      81 bytes for CCNx or NDN packet headers, signatures, and content.</t>
      <t>6LoWPAN <xref target="RFC4944" format="default"/> <xref target="RFC6282"
      format="default"/> is a
      convergence layer that provides frame formats, header compression, and
      adaptation-layer fragmentation for IPv6 packets in IEEE 802.15.4 networks. The
      6LoWPAN adaptation introduces a dispatching framework that prepends
      further information to 6LoWPAN packets, including a protocol identifier
      for payload and meta information about fragmentation.</t>
      <t>Prevalent packet formats based on Type-Length-Value (TLV), such as in
      CCNx and NDN, are designed to be generic and extensible.  This leads to
      header verbosity, which is inappropriate in constrained environments of
      IEEE 802.15.4 links. This document presents ICN LoWPAN, a convergence
      layer for IEEE 802.15.4 motivated by 6LoWPAN. ICN LoWPAN compresses
      packet headers of CCNx, as well as NDN, and allows for an increased
      effective payload size per packet. Additionally, reusing the dispatching
      framework defined by 6LoWPAN enables compatibility between coexisting
      wireless deployments of competing network technologies. This also allows reuse of
      the adaptation-layer fragmentation scheme specified by 6LoWPAN for ICN LoWPAN.</t>
      <t>ICN LoWPAN defines a more space-efficient representation of CCNx and
      NDN packet formats. This syntactic change is described for CCNx and NDN
      separately, as the header formats and TLV encodings differ notably. For
      further reductions, default header values suitable for constrained IoT
      networks are selected in order to elide corresponding TLVs. Experimental
      evaluations of the ICN LoWPAN header compression schemes in <xref target="ICNLOWPAN" format="default"/> illustrate a reduced message overhead, a shortened
      message airtime, and an overall decline in power consumption for typical
      Class 2 devices <xref target="RFC7228" format="default"/> compared to uncompressed ICN messages.</t>
      <t>In a typical IoT scenario (see <xref target="fig-iot_network" format="default">
        </xref>), embedded devices are interconnected via a quasi-stationary
      infrastructure using a border router (BR) that connects the constrained
      LoWPAN network by some gateway with the public Internet. In ICN-based
      IoT networks, nonlocal Interest and Data messages transparently travel
      through the BR up and down between a gateway and the embedded devices
      situated in the constrained LoWPAN.</t>
      <figure anchor="fig-iot_network">
        <name>IoT Stub Network</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  |Gateway Services|
  -------------------------
        |
    ,--------,
    |        |
    |   BR   |
    |        |
    '--------'
                 LoWPAN
  O            O
         O
O                O   embedded
  O      O     O     devices
   O         O
]]></artwork>
      </figure>
      <t>
        The document has received fruitful reviews by members of the ICN community and the research group (see the Acknowledgments section) for a period of two years.
        It is the consensus of ICNRG that this document should be published in the IRTF Stream of the RFC series.
        This document does not constitute an IETF standard.
      </t>
    </section>
    <section numbered="true" toc="default">
      <name>Terminology</name>
        <t>
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL
    NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP&nbsp;14 <xref target="RFC2119"/> <xref target="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
      <t>This document uses the terminology of <xref target="RFC7476" format="default"/>, <xref target="RFC7927" format="default"/>, and <xref target="RFC7945" format="default"/> for ICN entities.</t>
      <t>The following terms are used in the document and defined as follows:
      </t>
      <dl newline="false" spacing="normal" indent="14">
        <dt>ICN LoWPAN:</dt>
        <dd>Information-Centric Networking over
          Low-Power Wireless Personal Area Network</dd>
        <dt>LLN:</dt>
        <dd>Low-Power and Lossy Network</dd>
        <dt>CCNx:</dt>
        <dd>Content-Centric Networking</dd>
        <dt>NDN:</dt>
        <dd>Named Data Networking</dd>
        <dt>byte:</dt>
        <dd>synonym for octet</dd>
        <dt>nibble:</dt>
        <dd>synonym for 4 bits</dd>
        <dt>time-value:</dt>
        <dd>a time offset measured in seconds</dd>
        <dt>time-code:</dt>
        <dd>an 8-bit encoded time-value</dd>
      </dl>
    </section>
    <section anchor="ICNLoWPAN" numbered="true" toc="default">
      <name>Overview of ICN LoWPAN</name>
      <section numbered="true" toc="default">
        <name>Link-Layer Convergence</name>
        <t>ICN LoWPAN provides a convergence layer that maps ICN packets onto
        constrained link-layer technologies. This includes features such as
        link-layer fragmentation, protocol separation on the link-layer level,
        and link-layer address mappings. The stack traversal is visualized in
        <xref target="fig.intro.hbh" format="default"/>.</t>
        <figure anchor="fig.intro.hbh">
          <name>ICN LoWPAN Convergence Layer for IEEE 802.15.4</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
      Device 1                                         Device 2
,------------------,           Router            ,------------------,
|  Application   . |     __________________      | ,-> Application  |
|----------------|-|    |    NDN / CCNx    |     |-|----------------|
|  NDN / CCNx    | |    | ,--------------, |     | |    NDN / CCNx  |
|----------------|-|    |-|--------------|-|     |-|----------------|
|  ICN LoWPAN    | |    | |  ICN LoWPAN  | |     | |    ICN LoWPAN  |
|----------------|-|    |-|--------------|-|     |-|----------------|
|  Link Layer    | |    | |  Link Layer  | |     | |    Link Layer  |
'----------------|-'    '-|--------------|-'     '-|----------------'
                 '--------'              '---------'
]]></artwork>
        </figure>
        <t><xref target="sec.lowpan_adaptation" format="default"/> of this document defines the
        convergence layer for IEEE 802.15.4.</t>
      </section>
      <section numbered="true" toc="default">
        <name>Stateless Header Compression</name>
        <t>ICN LoWPAN also defines a stateless header compression scheme with
        the main purpose of reducing header overhead of ICN packets. This is
        of particular importance for link layers with small MTUs. The
        stateless compression does not require preconfiguration of a global
        state.</t>
        <t>The CCNx and NDN header formats are composed of Type-Length-Value
        (TLV) fields to encode header data. The advantage of the TLV format is its
        support of variably structured data. The main disadvantage of the
        TLV format is the verbosity that results from storing the type and length of
        the encoded data.</t>
        <t>The stateless header compression scheme makes use of compact bit
        fields to indicate the presence of optional TLVs in the uncompressed
        packet. The order of set bits in the bit fields corresponds to the
        order of each TLV in the packet. Further compression is achieved by
        specifying default values and reducing the range of certain header
        fields.</t>
        <t><xref target="fig.TLV.compressed" format="default"/> demonstrates the stateless
        header compression idea. In this example, the first type of the first
        TLV is removed and the corresponding bit in the bit field is set. The
        second TLV represents a fixed-length TLV (e.g., the Nonce TLV in NDN),
        so that the Type and Length fields are removed. The third TLV
        represents a boolean TLV (e.g., the MustBeFresh selector in NDN) for
        which the Type, Length, and Value fields are elided.</t>
        <figure anchor="fig.TLV.compressed">
          <name>Compression Using a Compact Bit Field -- Bits Encode the Inclusion of
	  TLVs</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
Uncompressed:

   Variable-length TLV      Fixed-length TLV      Boolean TLV
,-----------------------,-----------------------,-------------,
+-------+-------+-------+-------+-------+-------+------+------+
|  TYP  |  LEN  |  VAL  |  TYP  |  LEN  |  VAL  |  TYP | LEN  |
+-------+-------+-------+-------+-------+-------+------+------+

Compressed:

  +---+---+---+---+---+---+---+---+
  | 1 | 0 | 1 | 0 | 0 | 0 | 0 | 1 |  Bit Field
  +---+---+---+---+---+---+---+---+
    |       |                   |
 ,--'       '----,              '- Boolean Value
 |               |
+-------+-------+-------+
|  LEN  |  VAL  |  VAL  |
+-------+-------+-------+
'---------------'-------'
  Var-len Value  Fixed-len Value
]]></artwork>
        </figure>
        <t>Stateless TLV compression for NDN is defined in <xref target="sec.ndn" format="default"/>. <xref target="sec.ccnx" format="default"/> defines the stateless
        TLV compression for CCNx.</t>
        <t>The extensibility of this compression is described in <xref target="sec.dispatch.ext" format="default"/> and allows future documents to update the
        compression rules outlined in this document.</t>
      </section>
      <section numbered="true" toc="default">
        <name>Stateful Header Compression</name>
        <t>ICN LoWPAN further employs two orthogonal, stateful compression
        schemes for packet size reductions, which are defined in <xref target="stateful.compression" format="default"/>. These mechanisms rely on shared
        contexts that are either distributed and maintained in the entire
        LoWPAN or are generated on demand hop-wise on a particular
        Interest-Data path.</t>
        <t>The shared context identification is defined in <xref target="stateful.compression.local" format="default"/>. The hop-wise name compression
        "en route" is specified in <xref target="stateful.compression.en-route" format="default"/>.</t>
      </section>
    </section>
    <section anchor="sec.lowpan_adaptation" numbered="true" toc="default">
      <name>IEEE 802.15.4 Adaptation</name>
      <section anchor="sec.lowpan_encap" numbered="true" toc="default">
        <name>LoWPAN Encapsulation</name>
        <t>The IEEE 802.15.4 frame header does not provide a protocol
        identifier for its payload. This causes problems of misinterpreting
        frames when several network layers coexist on the same link. To
        mitigate errors, 6LoWPAN defines dispatches as encapsulation headers
        for IEEE 802.15.4 frames (see <xref target="RFC4944" section="5" sectionFormat="of" format="default"/>).
        Multiple LoWPAN encapsulation headers can precede the actual payload,
        and each encapsulation header is identified by a dispatch type.</t>
        <t><xref target="RFC8025" format="default"/> further specifies dispatch Pages to
	switch between different contexts. When a LoWPAN parser encounters a <tt>Page
	switch</tt> LoWPAN encapsulation header, all
        following encapsulation headers are interpreted by using a dispatch
        Page, as specified by the <tt>Page switch</tt>
        header. Pages 0 and 1 are reserved for 6LoWPAN. This document uses
        Page 14 (<tt>1111 1110 (0xFE)</tt>) for ICN LoWPAN.</t>
        <t>The base dispatch format (<xref target="fig.disp.base" format="default"/>) is
	used and extended by CCNx and NDN in Sections <xref target="sec.ndn" format="counter"/> and
	<xref target="sec.ccnx" format="counter"/>.</t>
        <figure anchor="fig.disp.base">
          <name>Base Dispatch Format for ICN LoWPAN</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0   1   2   3   ...
+---+---+---+---+---
| 0 | P | M | C |
+---+---+---+---+---
]]></artwork>
        </figure>
        <dl newline="true" spacing="normal" indent="4">
          <dt>P: Protocol</dt>
          <dd>
            <dl newline="false" spacing="normal" indent="4">
              <dt>0:</dt>
              <dd>The included protocol is NDN.</dd>
              <dt>1:</dt>
              <dd>The included protocol is CCNx.</dd>
            </dl>
          </dd>
          <dt>M: Message Type</dt>
          <dd>
            <dl newline="false" spacing="normal" indent="4">
              <dt>0:</dt>
              <dd>The payload contains an Interest message.</dd>
              <dt>1:</dt>
              <dd>The payload contains a Data message.</dd>
            </dl>
          </dd>
          <dt>C: Compression</dt>
          <dd>
            <dl newline="false" spacing="normal" indent="4">
              <dt>0:</dt>
              <dd>The message is uncompressed.</dd>
              <dt>1:</dt>
              <dd>The message is compressed.</dd>
            </dl>
          </dd>
        </dl>
        <t>ICN LoWPAN frames with compressed CCNx and NDN messages (C=1) use
        the extended dispatch format in <xref target="fig.disp.base.compr" format="default"/>.</t>
        <figure anchor="fig.disp.base.compr">
          <name>Extended Dispatch Format for Compressed ICN LoWPAN</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0   1   2   3      ... ...
+---+---+---+---+...+---+---+
| 0 | P | M | 1 |   |CID|EXT|
+---+---+---+---+...+---+---+
]]></artwork>
        </figure>
        <dl newline="true" spacing="normal" indent="4">
          <dt>CID: Context Identifier</dt>
          <dd>
            <dl newline="false" spacing="normal" indent="4">
              <dt>0:</dt>
              <dd>No context identifiers are present.</dd>
              <dt>1:</dt>
              <dd>Context identifier(s) are present (see <xref target="stateful.compression.local" format="default"/>).</dd>
            </dl>
          </dd>
          <dt>EXT: Extension</dt>
          <dd>
            <dl newline="false" spacing="normal" indent="4">
              <dt>0:</dt>
              <dd>No extension bytes are present.</dd>
              <dt>1:</dt>
              <dd>Extension byte(s) are present (see <xref target="sec.dispatch.ext" format="default"/>).</dd>
            </dl>
          </dd>
        </dl>
        <t>The encapsulation format for ICN LoWPAN is displayed in <xref target="fig.ICN-LoWPAN.header" format="default"/>.</t>
        <figure anchor="fig.ICN-LoWPAN.header">
          <name>LoWPAN Encapsulation with ICN LoWPAN</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
+------...------+------...-----+--------+-------...-------+-----...
| IEEE 802.15.4 | RFC4944 Disp.|  Page  | ICN LoWPAN Disp.| Payl. /
+------...------+------...-----+--------+-------...-------+-----...
]]></artwork>
        </figure>
        <dl newline="false" spacing="normal" indent="16">
          <dt>IEEE 802.15.4:</dt>
          <dd>The IEEE 802.15.4 header.</dd>
          <dt>RFC4944 Disp.:</dt>
          <dd>Optional additional dispatches
            defined in <xref target="RFC4944" section="5.1" sectionFormat="of" format="default"/>.</dd>
          <dt>Page:</dt>
          <dd><tt>Page switch</tt>. 14 for ICN LoWPAN.</dd>
          <dt>ICN LoWPAN:</dt>
          <dd>Dispatches as defined in Sections <xref target="sec.ndn" format="counter"/> and <xref target="sec.ccnx" format="counter"/>.</dd>
          <dt>Payload:</dt>
          <dd>The actual (un-)compressed CCNx or NDN
            message.</dd>
        </dl>
        <section anchor="sec.dispatch.ext" numbered="true" toc="default">
          <name>Dispatch Extensions</name>
          <t>Extension bytes allow for the extensibility of the initial
          compression rule set. The base format for an extension byte is
          depicted in <xref target="fig.ext.base" format="default"/>.</t>
          <figure anchor="fig.ext.base">
            <name>Base Format for Dispatch Extensions</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| - | - | - | - | - | - | - |EXT|
+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
          <dl newline="true" spacing="normal" indent="4">
            <dt>EXT: Extension</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>No other extension byte follows.</dd>
                <dt>1:</dt>
                <dd>A further extension byte follows.</dd>
              </dl>
            </dd>
          </dl>
          <t>Extension bytes are numbered according to their order. Future
          documents <bcp14>MUST</bcp14> follow the naming scheme <tt>EXT_0, EXT_1, ...</tt>
          when updating or referring to a specific dispatch extension byte.
          Amendments that require an exchange of configurational parameters
          between devices <bcp14>SHOULD</bcp14> use manifests to encode structured data in a
          well-defined format, e.g., as outlined in <xref target="I-D.irtf-icnrg-flic" format="default"/>.</t>
        </section>
      </section>
      <section anchor="sec.Fragmentation" numbered="true" toc="default">
        <name>Adaptation-Layer Fragmentation</name>
        <t>Small payload sizes in the LoWPAN require fragmentation for various
        network layers. Therefore, <xref target="RFC4944" section="5.3" sectionFormat="of" format="default"/>
        defines a protocol-independent fragmentation dispatch type, a
        fragmentation header for the first fragment, and a separate
        fragmentation header for subsequent fragments. ICN LoWPAN adopts this
        fragmentation handling of <xref target="RFC4944" format="default"/>.</t>
        <t>The fragmentation LoWPAN header can encapsulate other dispatch
        headers. The order of dispatch types is defined in <xref target="RFC4944" section="5" sectionFormat="of" format="default"/>. <xref target="fig.fr_first" format="default"/> shows the
        fragmentation scheme. The reassembled ICN LoWPAN frame does not
        contain any fragmentation headers and is depicted in <xref target="fig.fr_done" format="default"/>.</t>
        <figure anchor="fig.fr_first">
          <name>Fragmentation Scheme</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
+------...------+----...----+--------+------...-------+--------...
| IEEE 802.15.4 | Frag. 1st |  Page  |   ICN LoWPAN   | Payload  /
+------...------+----...----+--------+------...-------+--------...

+------...------+----...----+--------...
| IEEE 802.15.4 | Frag. 2nd | Payload  /
+------...------+----...----+--------...

                .
                .
                .

+------...------+----...----+--------...
| IEEE 802.15.4 | Frag. Nth | Payload  /
+------...------+----...----+--------...
]]></artwork>
        </figure>
        <figure anchor="fig.fr_done">
          <name>Reassembled ICN LoWPAN Frame</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
+------...------+--------+------...-------+--------...
| IEEE 802.15.4 |  Page  |   ICN LoWPAN   | Payload  /
+------...------+--------+------...-------+--------...
]]></artwork>
        </figure>
        <t>The 6LoWPAN Fragment Forwarding (6LFF) <xref target="RFC8930" format="default"/> is an alternative
        approach that enables forwarding of fragments without
        reassembling packets on every intermediate hop. By reusing the
        6LoWPAN dispatching framework, 6LFF integrates into ICN LoWPAN
        as seamlessly as the conventional hop-wise
        fragmentation. However, experimental evaluations <xref target="SFR-ICNLOWPAN"
	format="default"/> suggest that a more-refined
        integration can increase the cache utilization of forwarders
        on a request path.</t>
      </section>
    </section>
    <section anchor="sec.ndn" numbered="true" toc="default">
      <name>Space-Efficient Message Encoding for NDN</name>
      <section anchor="sec.tlvencoding" numbered="true" toc="default">
        <name>TLV Encoding</name>
        <t>The NDN packet format consists of TLV fields using the TLV encoding
        that is described in <xref target="NDN-PACKET-SPEC" format="default"/>. Type and Length
        fields are of variable size, where numbers greater than 252 are
        encoded using multiple bytes.</t>
        <t>If the type or length number is less than <tt>253</tt>,
        then that number is encoded into the actual Type or Length field. If
        the number is greater or equals <tt>253</tt> and
        fits into 2 bytes, then the Type or Length field is set to <tt>253</tt> and the number is encoded in the next
        following 2 bytes in network byte order, i.e., from the most
        significant byte (MSB) to the least significant byte (LSB). If the
        number is greater than 2 bytes and fits into 4 bytes, then the Type
        or Length field is set to <tt>254</tt> and the
        number is encoded in the subsequent 4 bytes in network byte order.
        For larger numbers, the Type or Length field is set to <tt>255</tt> and the number is encoded in the subsequent 8
        bytes in network byte order.</t>
        <t>In this specification, compressed NDN TLVs encode Type and
        Length fields using self-delimiting numeric values (SDNVs)
        <xref target="RFC6256" format="default"/> commonly known from Delay-Tolerant
	Networking (DTN) protocols.
        Instead of using the first byte as a marker for the number of
        following bytes, SDNVs use a single bit to indicate subsequent
        bytes.</t>
        <table anchor="tab.sdnvperformance" align="center">
          <name>NDN TLV Encoding Compared to SDNVs</name>
          <thead>
            <tr>
              <th align="left">Value</th>
              <th align="left">NDN TLV Encoding</th>
              <th align="left">SDNV Encoding</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">0x00</td>
              <td align="left">0x00</td>
            </tr>
            <tr>
              <td align="left">127</td>
              <td align="left">0x7F</td>
              <td align="left">0x7F</td>
            </tr>
            <tr>
              <td align="left">128</td>
              <td align="left">0x80</td>
              <td align="left">0x81 0x00</td>
            </tr>
            <tr>
              <td align="left">253</td>
              <td align="left">0xFD 0x00 0xFD</td>
              <td align="left">0x81 0x7D</td>
            </tr>
            <tr>
              <td align="left">2<sup>14</sup> - 1</td>
              <td align="left">0xFD 0x3F 0xFF</td>
              <td align="left">0xFF 0x7F</td>
            </tr>
            <tr>
              <td align="left">2<sup>14</sup></td>
              <td align="left">0xFD 0x40 0x00</td>
              <td align="left">0x81 0x80 0x00</td>
            </tr>
            <tr>
              <td align="left">2<sup>16</sup></td>
              <td align="left">0xFE 0x00 0x01 0x00 0x00</td>
              <td align="left">0x84 0x80 0x00</td>
            </tr>
            <tr>
              <td align="left">2<sup>21</sup> - 1</td>
              <td align="left">0xFE 0x00 0x1F 0xFF 0xFF</td>
              <td align="left">0xFF 0xFF 0x7F</td>
            </tr>
            <tr>
              <td align="left">2<sup>21</sup></td>
              <td align="left">0xFE 0x00 0x20 0x00 0x00</td>
              <td align="left">0x81 0x80 0x80 0x00</td>
            </tr>
            <tr>
              <td align="left">2<sup>28</sup> - 1</td>
              <td align="left">0xFE 0x0F 0xFF 0xFF 0xFF</td>
              <td align="left">0xFF 0xFF 0xFF 0x7F</td>
            </tr>
            <tr>
              <td align="left">2<sup>28</sup></td>
              <td align="left">0xFE 0x1F 0x00 0x00 0x00</td>
              <td align="left">0x81 0x80 0x80 0x80 0x00</td>
            </tr>
            <tr>
              <td align="left">2<sup>32</sup></td>
              <td align="left">0xFF 0x00 0x00 0x00 0x01 0x00 0x00 0x00 0x00</td>
              <td align="left">0x90 0x80 0x80 0x80 0x00</td>
            </tr>
            <tr>
              <td align="left">2<sup>35</sup> - 1</td>
              <td align="left">0xFF 0x00 0x00 0x00 0x07 0xFF 0xFF 0xFF 0xFF</td>
              <td align="left">0xFF 0xFF 0xFF 0xFF 0x7F</td>
            </tr>
            <tr>
              <td align="left">2<sup>35</sup></td>
              <td align="left">0xFF 0x00 0x00 0x00 0x08 0x00 0x00 0x00 0x00</td>
              <td align="left">0x81 0x80 0x80 0x80 0x80 0x00</td>
            </tr>
          </tbody>
        </table>
        <t>
          <xref target="tab.sdnvperformance" format="default"/> compares the required
          bytes for encoding a few selected values using the NDN TLV
          encoding and SDNVs. For values up to 127, both methods
          require a single byte. Values in the range (128...252) encode
          as one byte for the NDN TLV scheme, while SDNVs require two
          bytes.  Starting at value 253, SDNVs require a less or equal
          amount of bytes compared to the NDN TLV encoding.
        </t>
      </section>
      <section anchor="sec.ndn.namecompression" numbered="true" toc="default">
        <name>Name TLV Compression</name>
        <t>This Name TLV compression encodes Length fields of two consecutive
        NameComponent TLVs into one byte, using a nibble for each.
        The most significant nibble indicates the length of an immediately following NameComponent TLV.
        The least significant nibble denotes the length of a subsequent NameComponent TLV.
        A length of 0 marks the end of the compressed Name TLV.
        The last Length field of an encoded NameComponent is either 0x00 for a name with an even number of components
        and 0xYF (Y &gt; 0) if an odd number of components are present.
        This process limits the length of a NameComponent TLV to 15 bytes but allows for an unlimited number of components.
        An example for this encoding is presented in <xref target="fig.ndnshortnco" format="default"/>.</t>
        <figure anchor="fig.ndnshortnco">
          <name>Name TLV Compression for /HAW/Room/481/Humid/99</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
                Name: /HAW/Room/481/Humid/99

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0 0 1 1|0 1 0 0|       H       |       A       |       W       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       R       |       o       |       o       |       m       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0 0 1 1|0 1 0 1|       4       |       8       |       1       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       H       |       u       |       m       |       i       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       d       |0 0 1 0|0 0 0 0|       9       |       9       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
      </section>
      <section numbered="true" toc="default">
        <name>Interest Messages</name>
        <section numbered="true" toc="default">
          <name>Uncompressed Interest Messages</name>
          <t>An uncompressed Interest message uses the base dispatch format
          (see <xref target="fig.disp.base" format="default"/>) and sets the C, P, and M
          flags to <tt>0</tt> (<xref target="fig.ndn.int.uncompr" format="default"/>).
          The Interest message is handed to the NDN stack without modifications.</t>
          <figure anchor="fig.ndn.int.uncompr">
            <name>Dispatch Format for Uncompressed NDN Interest Messages</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
        </section>
        <section numbered="true" toc="default">
          <name>Compressed Interest Messages</name>
          <t>The compressed Interest message uses the extended dispatch format
          (<xref target="fig.disp.base.compr" format="default"/>) and sets the C flag to
	  <tt>1</tt> and the P and M flags to <tt>0</tt>.
          If an Interest message contains TLVs that are not mentioned in the
          following compression rules, then this message <bcp14>MUST</bcp14> be sent
          uncompressed.</t>
          <t>This specification assumes that a HopLimit TLV is part of the
          original Interest message. If such a HopLimit TLV is not present, it
          will be inserted with a default value of DEFAULT_NDN_HOPLIMIT prior to
          the compression.</t>
          <t>In the default use case, the Interest message is compressed with
          the following minimal rule set: </t>
          <ol spacing="normal" type="1">
	    <li>The <tt>Type</tt> field of the outermost
            MessageType TLV is removed.</li>
            <li>The Name TLV is compressed according to <xref
	    target="sec.ndn.namecompression" format="default"/>. For this, all
	    NameComponents are expected to be of type GenericNameComponent with a length
            greater than 0. An ImplicitSha256DigestComponent or
            ParametersSha256DigestComponent <bcp14>MAY</bcp14> appear at the end of the
            name. In any other case, the message <bcp14>MUST</bcp14> be sent
            uncompressed.</li>
            <li>The Nonce TLV and InterestLifetime TLV are moved to
            the end of the compressed Interest, as illustrated in
            <xref target="fig.ndn.int.newformat" format="default"/>.  The
            InterestLifetime is encoded as described in <xref
	    target="sec.compressedtime" format="default"/>.  On
            decompression, this encoding may yield an
            InterestLifetime that is smaller than the original
            value.</li>
            <li>The Type and Length fields of Nonce TLV, HopLimit TLV, and
            InterestLifetime TLV are elided. The Nonce value has a length of
            4 bytes, and the HopLimit value has a length of 1 byte. The
            compressed InterestLifetime (<xref target="sec.compressedtime"
	    format="default"/>) has a
            length of 1 byte. The presence of a Nonce TLV and InterestLifetime TLV is
            deduced from the remaining length to parse.
            A remaining length of <tt>1</tt> indicates the
            presence of an InterestLifetime, a length of <tt>4</tt> indicates
            the presence of a nonce, and a length of <tt>5</tt> indicates
            the presence of both TLVs.</li>
          </ol>
          <t>The compressed NDN LoWPAN Interest message is visualized in <xref target="fig.ndn.int.newformat" format="default"/>.</t>
          <figure anchor="fig.ndn.int.newformat">
            <name>Compression of NDN LoWPAN Interest Message</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
T = Type, L = Length, V = Value
Lc = Compressed Length, Vc = Compressed Value
: = optional field, | = mandatory field

+---------+---------+                 +---------+
|  Msg T  |  Msg L  |                 |  Msg Lc |
+---------+---------+---------+       +---------+
| Name T  | Name L  | Name V  |       | Name Vc |
+---------+---------+---------+       +---------+---------+
: CBPfx T : CBPfx L :                 : FWDH Lc : FWDH Vc :
+---------+---------+                 +---------+---------+
: MBFr T  : MBFr L  :                 |  HPL V  |
+---------+---------+---------+  ==>  +---------+---------+
: FWDH T  : FWDH L  : FWDH V  :       :  APM Lc : APM Vc  :
+---------+---------+---------+       +---------+---------+
: NONCE T : NONCE L : NONCE V :       : NONCE V :
+---------+---------+---------+       +---------+
:  ILT T  :  ILT L  :  ILT V  :       :  ILT Vc :
+---------+---------+---------+       +---------+
:  HPL T  :  HPL L  :  HPL V  :
+---------+---------+---------+
:  APM T  :  APM L  :  APM V  :
+---------+---------+---------+
]]></artwork>
          </figure>
          <t>Further TLV compression is indicated by the ICN LoWPAN dispatch
          in <xref target="fig.ndn.intcompr" format="default"/>.</t>
          <figure anchor="fig.ndn.intcompr">
            <name>Dispatch Format for Compressed NDN Interest Messages</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0                                       1
  0   1   2   3   4   5   6   7   8   9   0   1   2   3   4   5
+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
| 0 | 0 | 0 | 1 |PFX|FRE|FWD|APM|DIG|        RSV        |CID|EXT|
+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
          <dl newline="true" spacing="normal" indent="4">
            <dt>PFX: CanBePrefix TLV</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The uncompressed message does not include a
                  CanBePrefix TLV.</dd>
                <dt>1:</dt>
                <dd>The uncompressed message does include a
                  CanBePrefix TLV and is removed from the compressed
                  message.</dd>
              </dl>
            </dd>
            <dt>FRE: MustBeFresh TLV</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The uncompressed message does not include a
                  MustBeFresh TLV.</dd>
                <dt>1:</dt>
                <dd>The uncompressed message does include a
                  MustBeFresh TLV and is removed from the compressed
                  message.</dd>
              </dl>
            </dd>
            <dt>FWD: ForwardingHint TLV</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The uncompressed message does not include a
                  ForwardingHint TLV.</dd>
                <dt>1:</dt>
                <dd>The uncompressed message does include a
                  ForwardingHint TLV. The Type field is removed from the
                  compressed message. Further, all link delegation types and
                  link preference types are removed. All included names are
                  compressed according to <xref target="sec.ndn.namecompression" format="default"/>. If any name is not
                  compressible, the message <bcp14>MUST</bcp14> be sent uncompressed.</dd>
              </dl>
            </dd>
            <dt>APM: ApplicationParameters TLV</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The uncompressed message does not include
                  an ApplicationParameters TLV.</dd>
                <dt>1:</dt>
                <dd>The uncompressed message does include an
                  ApplicationParameters TLV. The Type field is removed from
                  the compressed message.</dd>
              </dl>
            </dd>
            <dt>DIG: ImplicitSha256DigestComponent TLV</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The name does not include an
                  ImplicitSha256DigestComponent as the last TLV.</dd>
                <dt>1:</dt>
                <dd>The name does include an
                  ImplicitSha256DigestComponent as the last TLV. The Type and
                  Length fields are omitted.</dd>
              </dl>
            </dd>
            <dt>RSV: Reserved</dt>
            <dd>Must be set to 0.</dd>
           <dt>CID: Context Identifier</dt>
            <dd>See <xref target="fig.disp.base.compr" format="default"/>.</dd>
            <dt>EXT: Extension</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>No extension byte follows.</dd>
                <dt>1:</dt>
                <dd>Extension byte <tt>EXT_0</tt>
                  follows immediately. See <xref target="sec.ndn.interest.ext0" format="default"/>.</dd>
              </dl>
            </dd>
          </dl>
        </section>
        <section anchor="sec.ndn.interest.ext0" numbered="true" toc="default">
          <name>Dispatch Extension</name>
          <t>The <tt>EXT_0</tt> byte follows the
          description in <xref target="sec.dispatch.ext" format="default"/> and is illustrated
          in <xref target="fig.ndn.interest.ext0" format="default"/>.</t>
          <figure anchor="fig.ndn.interest.ext0">
            <name>EXT_0 Format</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
|  NCS  |        RSV        |EXT|
+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
          <dl newline="true" spacing="normal" indent="4">
            <dt>NCS: Name Compression Strategy</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>00:</dt>
                <dd>Names are compressed with the default name
                  compression strategy (see <xref target="sec.ndn.namecompression" format="default"/>).</dd>
                <dt>01:</dt>
                <dd>Reserved.</dd>
                <dt>10:</dt>
                <dd>Reserved.</dd>
                <dt>11:</dt>
                <dd>Reserved.</dd>
              </dl>
            </dd>
            <dt>RSV: Reserved</dt>
            <dd>Must be set to 0.</dd>
            <dt>EXT: Extension</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>No extension byte follows.</dd>
                <dt>1:</dt>
                <dd>A further extension byte follows
                  immediately.</dd>
              </dl>
            </dd>
          </dl>
        </section>
      </section>
      <section numbered="true" toc="default">
        <name>Data Messages</name>
        <section numbered="true" toc="default">
          <name>Uncompressed Data Messages</name>
          <t>An uncompressed Data message uses the base dispatch
          format and sets the C and P flags to <tt>0</tt> and the M flag
          to <tt>1</tt> (<xref target="fig.ndn.data.uncompr" format="default"/>).  The Data message is
          handed to the NDN stack without modifications.</t>
          <figure anchor="fig.ndn.data.uncompr">
            <name>Dispatch Format for Uncompressed NDN Data Messages</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 |
+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
        </section>
        <section numbered="true" toc="default">
          <name>Compressed Data Messages</name>
          <t>The compressed Data message uses the extended dispatch
          format (<xref target="fig.disp.base.compr" format="default"/>) and sets the C
          and M flags to <tt>1</tt>. The
          P flag is set to <tt>0</tt>. If a Data
          message contains TLVs that are not mentioned in the
          following compression rules, then this message <bcp14>MUST</bcp14> be sent
          uncompressed.</t>
          <t>By default, the Data message is compressed with the following
          base rule set: </t>
          <ol spacing="normal" type="1">
	    <li>The <tt>Type</tt> field of the outermost
              MessageType TLV is removed.</li>
            <li>The Name TLV is compressed according to <xref target="sec.ndn.namecompression" format="default"/>. For this, all NameComponents
              are expected to be of type GenericNameComponent and to have a
              length greater than 0. In any other case, the message <bcp14>MUST</bcp14> be
              sent uncompressed.</li>
            <li>The MetaInfo TLV Type and Length fields are elided from the
              compressed Data message.</li>
            <li>The FreshnessPeriod TLV <bcp14>MUST</bcp14> be moved to the end of the
              compressed Data message. Type and
              Length fields are elided, and the value is encoded as described
              in <xref target="sec.compressedtime" format="default"/> as a 1-byte
	      time-code. If the freshness period is not
              a valid time-value, then the message <bcp14>MUST</bcp14> be sent uncompressed
              in order to preserve the security envelope of the Data message.
              The presence of a FreshnessPeriod TLV is deduced from the
              remaining one-byte length to parse.</li>
            <li>The Type fields of the SignatureInfo TLV, SignatureType TLV,
              and SignatureValue TLV are removed.</li>
          </ol>
          <t>The compressed NDN LoWPAN Data message is visualized in <xref target="fig.ndn.data.newformat" format="default"/>.</t>
          <figure anchor="fig.ndn.data.newformat">
            <name>Compression of NDN LoWPAN Data Message</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
T = Type, L = Length, V = Value
Lc = Compressed Length, Vc = Compressed Value
: = optional field, | = mandatory field

+---------+---------+                 +---------+
|  Msg T  |  Msg L  |                 |  Msg Lc |
+---------+---------+---------+       +---------+
| Name T  | Name L  | Name V  |       | Name Vc |
+---------+---------+---------+       +---------+---------+
: Meta T  : Meta L  :                 : CTyp Lc : CTyp V  :
+---------+---------+---------+       +---------+---------+
: CTyp T  : CTyp L  : CTyp V  :       : FBID V  :
+---------+---------+---------+  ==>  +---------+---------+
: FrPr T  : FrPr L  : FrPr V  :       : CONT Lc : CONT V  :
+---------+---------+---------+       +---------+---------+
: FBID T  : FBID L  : FBID V  :       |  Sig Lc |
+---------+---------+---------+       +---------+---------+
: CONT T  : CONT L  : CONT V  :       | SInf Lc | SInf Vc |
+---------+---------+---------+       +---------+---------+
|  Sig T  |  Sig L  |                 | SVal Lc | SVal Vc |
+---------+---------+---------+       +---------+---------+
| SInf T  | SInf L  | SInf V  |       : FrPr Vc :
+---------+---------+---------+       +---------+
| SVal T  | SVal L  | SVal V  |
+---------+---------+---------+
]]></artwork>
          </figure>
          <t>Further TLV compression is indicated by the ICN LoWPAN dispatch
          in <xref target="fig.ndn.datacompr" format="default"/>.</t>
          <figure anchor="fig.ndn.datacompr">
            <name>Dispatch Format for Compressed NDN Data Messages</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0                                       1
  0   1   2   3   4   5   6   7   8   9   0   1   2   3   4   5
+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
| 0 | 0 | 1 | 1 |FBI|CON|KLO|            RSV            |CID|EXT|
+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
          <dl newline="true" spacing="normal" indent="4">
            <dt>FBI: FinalBlockId TLV</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The uncompressed message does not include a
                  FinalBlockId TLV.</dd>
                <dt>1:</dt>
                <dd>The uncompressed message does include a
                  FinalBlockId, and it is encoded according to <xref
		  target="sec.ndn.namecompression" format="default"/>. If the FinalBlockId
		  TLV is not compressible, then the message <bcp14>MUST</bcp14> be sent
                  uncompressed.</dd>
              </dl>
            </dd>
            <dt>CON: ContentType TLV</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The uncompressed message does not include a
                  ContentType TLV.</dd>
                <dt>1:</dt>
                <dd>The uncompressed message does include a
                  ContentType TLV. The Type field is removed from the
                  compressed message.</dd>
              </dl>
            </dd>
            <dt>KLO: KeyLocator TLV</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>If the included SignatureType requires a
                  KeyLocator TLV, then the KeyLocator represents a name and is
                  compressed according to <xref
		  target="sec.ndn.namecompression" format="default"/>. If the
		  name is not compressible, then the message
		  <bcp14>MUST</bcp14> be sent uncompressed.</dd>
                <dt>1:</dt>
                <dd>If the included SignatureType requires a
                KeyLocator TLV, then the KeyLocator represents a KeyDigest.
                The Type field of this KeyDigest is removed.</dd>
              </dl>
            </dd>
            <dt>RSV: Reserved</dt>
            <dd>Must be set to 0.</dd>
            <dt>CID: Context Identifier</dt>
            <dd>See <xref target="fig.disp.base.compr" format="default"/>.</dd>
            <dt>EXT: Extension</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>No extension byte follows.</dd>
                <dt>1:</dt>
                <dd>Extension byte <tt>EXT_0</tt>
                  follows immediately. See <xref target="sec.ndn.data.ext0"
		  format="default"/>.</dd>
              </dl>
            </dd>

          </dl>
        </section>
        <section anchor="sec.ndn.data.ext0" numbered="true" toc="default">
          <name>Dispatch Extension</name>
          <t>The <tt>EXT_0</tt> byte follows the
          description in <xref target="sec.dispatch.ext" format="default"/> and is illustrated
          in <xref target="fig.ndn.data.ext0" format="default"/>.</t>
          <figure anchor="fig.ndn.data.ext0">
            <name>EXT_0 Format</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
|  NCS  |        RSV        |EXT|
+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
          <dl newline="true" spacing="normal" indent="4">
            <dt>NCS: Name Compression Strategy</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>00:</dt>
                <dd>Names are compressed with the default name
                  compression strategy (see <xref target="sec.ndn.namecompression" format="default"/>).</dd>
                <dt>01:</dt>
                <dd>Reserved.</dd>
                <dt>10:</dt>
                <dd>Reserved.</dd>
                <dt>11:</dt>
                <dd>Reserved.</dd>
              </dl>
            </dd>
            <dt>RSV: Reserved</dt>
            <dd>Must be set to 0.</dd>
            <dt>EXT: Extension</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>No extension byte follows.</dd>
                <dt>1:</dt>
                <dd>A further extension byte follows
                  immediately.</dd>
              </dl>
            </dd>
          </dl>
        </section>
      </section>
    </section>
    <section anchor="sec.ccnx" numbered="true" toc="default">
      <name>Space-Efficient Message Encoding for CCNx</name>
      <section numbered="true" toc="default">
        <name>TLV Encoding</name>
        <t>The generic CCNx TLV encoding is described in <xref target="RFC8609"
	format="default"/>. Type and Length fields attain the common fixed
        length of 2 bytes.</t>
        <t>The TLV encoding for CCNx LoWPAN is changed to the more space-efficient
	encoding described in <xref target="sec.tlvencoding" format="default"/>.
        Hence, NDN and CCNx use the same compressed format for writing
        TLVs.</t>
      </section>
      <section numbered="true" toc="default">
        <name>Name TLV Compression</name>
        <t>Name TLVs are compressed using the scheme already defined in <xref target="sec.ndn.namecompression" format="default"/> for NDN. If a Name TLV contains
        T_IPID, T_APP, or organizational TLVs, then the name remains
        uncompressed.</t>
      </section>
      <section numbered="true" toc="default">
        <name>Interest Messages</name>
        <section numbered="true" toc="default">
          <name>Uncompressed Interest Messages</name>
          <t>An uncompressed Interest message uses the base dispatch format
          (see <xref target="fig.disp.base" format="default"/>) and sets the C and M flags to <tt>0</tt>.
          The P flag is set to <tt>1</tt> (<xref target="fig.ccnx.int.uncompr" format="default"/>).
          The Interest message is handed to the CCNx stack without modifications.</t>
          <figure anchor="fig.ccnx.int.uncompr">
            <name>Dispatch Format for Uncompressed CCNx Interest Messages</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 | 0 | 0 | 0 | 0 | 0 | 0 |
+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
        </section>
        <section anchor="sec.ccnxintcompbaseheader" numbered="true" toc="default">
          <name>Compressed Interest Messages</name>
          <t>The compressed Interest message uses the extended dispatch format
          (<xref target="fig.disp.base.compr" format="default"/>) and sets the C and P flags to <tt>1</tt>. The M flag is set to <tt>0</tt>.
          If an Interest message contains TLVs that are not mentioned in the
          following compression rules, then this message <bcp14>MUST</bcp14> be sent
          uncompressed.</t>
          <t>In the default use case, the Interest message is compressed with
          the following minimal rule set: </t>
          <ol spacing="normal" type="1">
	    <li>The version is elided from the fixed header and assumed to be
	    1.</li>
	    <li>The Type and Length fields of the CCNx Message TLV are elided
            and are obtained from the fixed header on decompression.</li>
          </ol>
          <t>The compressed CCNx LoWPAN Interest message is visualized in
          <xref target="fig.ccnx.int.newformat" format="default"/>.</t>
          <figure anchor="fig.ccnx.int.newformat">
            <name>Compression of CCNx LoWPAN Interest Message</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
T = Type, L = Length, V = Value
Lc = Compressed Length, Vc = Compressed Value
: = optional field, | = mandatory field

+-----------------------------+           +-------------------------+
|    Uncompr. Fixed Header    |           |   Compr. Fixed Header   |
+-----------------------------+           +-------------------------+
+---------+---------+---------+           +---------+
: ILT T   : ILT L   : ILT V   :           : ILT Vc  :
+---------+---------+---------+           +---------+
: MSGH T  : MSGH L  : MSGH V  :           : MSGH Vc :
+---------+---------+---------+           +---------+
+---------+---------+                     +---------+
| MSGT T  | MSGT L  |                     | Name Vc |
+---------+---------+---------+           +---------+
| Name T  | Name L  | Name V  |    ==>    : KIDR Vc :
+---------+---------+---------+           +---------+
: KIDR T  : KIDR L  : KIDR V  :           : OBHR Vc :
+---------+---------+---------+           +---------+---------+
: OBHR T  : OBHR L  : OBHR V  :           : PAYL Lc : PAYL V  :
+---------+---------+---------+           +---------+---------+
: PAYL T  : PAYL L  : PAYL V  :           : VALG Lc : VALG Vc :
+---------+---------+---------+           +---------+---------+
: VALG T  : VALG L  : VALG V  :           : VPAY Lc : VPAY V  :
+---------+---------+---------+           +---------+---------+
: VPAY T  : VPAY L  : VPAY V  :
+---------+---------+---------+
]]></artwork>
          </figure>
          <t>Further TLV compression is indicated by the ICN LoWPAN dispatch
          in <xref target="fig.ccnx.intcompr" format="default"/>.</t>
          <figure anchor="fig.ccnx.intcompr">
            <name>Dispatch Format for Compressed CCNx Interest Messages</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0                                       1
  0   1   2   3   4   5   6   7   8   9   0   1   2   3   4   5
+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
| 0 | 1 | 0 | 1 |FLG|PTY|HPL|FRS|PAY|ILT|MGH|KIR|CHR|VAL|CID|EXT|
+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
          <dl newline="true" spacing="normal" indent="4">
            <dt>FLG: Flags field in the fixed header</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The Flags field equals 0 and is removed
                  from the Interest message.</dd>
                <dt>1:</dt>
                <dd>The Flags field appears in the fixed header.</dd>
              </dl>
            </dd>
            <dt>PTY: PacketType field in the fixed header</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The PacketType field is elided and assumed
                  to be <tt>PT_INTEREST</tt>.</dd>
                <dt>1:</dt>
                <dd>The PacketType field is elided and assumed
                  to be <tt>PT_RETURN</tt>.</dd>
              </dl>
            </dd>
            <dt>HPL: HopLimit field in the fixed header</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The HopLimit field appears in the fixed header.</dd>
                <dt>1:</dt>
                <dd>The HopLimit field is elided and assumed to
                  be <tt>1</tt>.</dd>
              </dl>
            </dd>
            <dt>FRS: Reserved field in the fixed header</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The Reserved field appears in the fixed header.</dd>
                <dt>1:</dt>
                <dd>The Reserved field is elided and assumed to
                  be <tt>0</tt>.</dd>
              </dl>
            </dd>
            <dt>PAY: Optional Payload TLV</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The Payload TLV is absent.</dd>
                <dt>1:</dt>
                <dd>The Payload TLV is present, and the Type
                  field is elided.</dd>
              </dl>
            </dd>
            <dt>ILT: Optional hop-by-hop InterestLifetime TLV</dt>
            <dd>
	      <t>See <xref target="sec.ccnxhbhint" format="default"/> for further details
                  on the ordering of hop-by-hop TLVs.</t>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>No InterestLifetime TLV is present in the
                  Interest message.</dd>
                <dt>1:</dt>
                <dd>An InterestLifetime TLV is present
                  with a fixed length of 1 byte and is encoded as
                  described in <xref target="sec.compressedtime" format="default"/>. The
		  Type and Length fields are elided.</dd>
              </dl>
            </dd>
            <dt>MGH: Optional hop-by-hop MessageHash TLV</dt>
            <dd>
                <t>See <xref target="sec.ccnxhbhint" format="default"/> for further
		details on the ordering of hop-by-hop TLVs.</t>
                <t>This TLV is expected to contain a T_SHA-256 TLV. If
                  another hash is contained, then the Interest <bcp14>MUST</bcp14> be sent
                  uncompressed.</t>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The MessageHash TLV is absent.</dd>
                <dt>1:</dt>
                <dd>A T_SHA-256 TLV is present, and the Type and
                  Length fields are removed. The Length field is
                  assumed to represent 32 bytes. The outer Message Hash TLV
                  is omitted.</dd>
              </dl>
            </dd>
            <dt>KIR: Optional KeyIdRestriction TLV</dt>
            <dd>
                <t>This TLV is expected to contain a T_SHA-256 TLV. If
                  another hash is contained, then the Interest <bcp14>MUST</bcp14> be sent
                  uncompressed.</t>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The KeyIdRestriction TLV is absent.</dd>
                <dt>1:</dt>
                <dd>A T_SHA-256 TLV is present, and the Type and
                  Length fields are removed. The Length field is
                  assumed to represent 32 bytes. The outer KeyIdRestriction
                  TLV is omitted.</dd>
              </dl>
            </dd>
            <dt>CHR: Optional ContentObjectHashRestriction TLV</dt>
            <dd>
                <t>This TLV is expected to contain a T_SHA-256 TLV. If
                  another hash is contained, then the Interest <bcp14>MUST</bcp14> be sent
                  uncompressed.</t>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The ContentObjectHashRestriction TLV is
                  absent.</dd>
                <dt>1:</dt>
                <dd>A T_SHA-256 TLV is present, and the Type and Length fields are
		removed. The Length field is assumed to represent 32 bytes. The outer
                ContentObjectHashRestriction TLV is omitted.</dd>
              </dl>
            </dd>
            <dt>VAL: Optional ValidationAlgorithm and ValidationPayload
	    TLVs</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>No validation-related TLVs are present in
                  the Interest message.</dd>
                <dt>1:</dt>
                <dd>Validation-related TLVs are present in the
                Interest message. An additional byte follows immediately
                that handles validation-related TLV compressions and is
                described in <xref target="sec.ccnx.intval"
		format="default"/>.</dd>
              </dl>
            </dd>
           <dt>CID: Context Identifier</dt>
            <dd><t>See <xref target="fig.disp.base.compr"
	    format="default"/>.</t></dd>
            <dt>EXT: Extension</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>No extension byte follows.</dd>
                <dt>1:</dt>
                <dd>Extension byte <tt>EXT_0</tt>
                follows immediately. See <xref target="sec.ccnx.interest.ext0"
		format="default"/>.</dd>
              </dl>
            </dd>
 
          </dl>
          <section anchor="sec.ccnxhbhint" toc="exclude" numbered="true">
            <name>Hop-By-Hop Header TLVs Compression</name>
            <t>Hop-by-hop header TLVs are unordered. For an Interest message,
            two optional hop-by-hop header TLVs are defined in <xref
	    target="RFC8609"
	    format="default"/>, but several more can be defined in higher-level
	    specifications. For the compression specified in the
            previous section, the hop-by-hop TLVs are ordered as follows:
            </t>
            <ol spacing="normal" type="1">
	      <li>InterestLifetime TLV</li>
              <li>Message Hash TLV</li>
            </ol>
            <t>Note: All hop-by-hop header TLVs other than the InterestLifetime and
            MessageHash TLVs remain uncompressed in the encoded message, and they
            appear after the InterestLifetime and MessageHash TLVs in the same
            order as in the original message.</t>
          </section>
          <section anchor="sec.ccnx.intval" toc="exclude" numbered="true">
            <name>Validation</name>
            <figure anchor="fig.ccnx.dispatchintval">
              <name>Dispatch for Interest Validations</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
0       1       2       3       4       5       6       7       8
+-------+-------+-------+-------+-------+-------+-------+-------+
|         ValidationAlg         |     KeyID     |      RSV      |
+-------+-------+-------+-------+-------+-------+-------+-------+
]]></artwork>
            </figure>
            <dl newline="true" spacing="normal" indent="4">
              <dt>ValidationAlg: Optional ValidationAlgorithm TLV</dt>
              <dd>
                <dl newline="false" spacing="normal" indent="8">
                  <dt>0000:</dt>
                  <dd>An uncompressed ValidationAlgorithm
                    TLV is included.</dd>
                  <dt>0001:</dt>
                  <dd>A T_CRC32C ValidationAlgorithm TLV is
                    assumed, but no ValidationAlgorithm TLV is included.</dd>
                  <dt>0010:</dt>
                  <dd>A T_CRC32C ValidationAlgorithm TLV is
                    assumed, but no ValidationAlgorithm TLV is included.
                    Additionally, a SignatureTime TLV is inlined without a Type and
                    a Length field.</dd>
                  <dt>0011:</dt>
                  <dd>A T_HMAC-SHA256 ValidationAlgorithm
                    TLV is assumed, but no ValidationAlgorithm TLV is
                    included.</dd>
                  <dt>0100:</dt>
                  <dd>A T_HMAC-SHA256 ValidationAlgorithm
                    TLV is assumed, but no ValidationAlgorithm TLV is included.
                    Additionally, a SignatureTime TLV is inlined without a Type and
                    a Length field.</dd>
                  <dt>0101:</dt>
                  <dd>Reserved.</dd>
                  <dt>0110:</dt>
                  <dd>Reserved.</dd>
                  <dt>0111:</dt>
                  <dd>Reserved.</dd>
                  <dt>1000:</dt>
                  <dd>Reserved.</dd>
                  <dt>1001:</dt>
                  <dd>Reserved.</dd>
                  <dt>1010:</dt>
                  <dd>Reserved.</dd>
                  <dt>1011:</dt>
                  <dd>Reserved.</dd>
                  <dt>1100:</dt>
                  <dd>Reserved.</dd>
                  <dt>1101:</dt>
                  <dd>Reserved.</dd>
                  <dt>1110:</dt>
                  <dd>Reserved.</dd>
                  <dt>1111:</dt>
                  <dd>Reserved.</dd>
                </dl>
              </dd>
              <dt>KeyID: Optional KeyID TLV within the ValidationAlgorithm TLV</dt>
              <dd>
                <dl newline="false" spacing="normal" indent="4">
                  <dt>00:</dt>
                  <dd>The KeyID TLV is absent.</dd>
                  <dt>01:</dt>
                  <dd>The KeyID TLV is present and
                    uncompressed.</dd>
                  <dt>10:</dt>
                  <dd>A T_SHA-256 TLV is present, and the Type
                    and Length fields are removed. The Length
                    field is assumed to represent 32 bytes. The outer KeyID
                    TLV is omitted.</dd>
                  <dt>11:</dt>
                  <dd>A T_SHA-512 TLV is present, and the Type
                    and Length fields are removed. The Length
                    field is assumed to represent 64 bytes. The outer KeyID
                    TLV is omitted.</dd>
                </dl>
              </dd>
              <dt>RSV: Reserved</dt>
              <dd>Must be set to 0.</dd>
            </dl>
            <t>The ValidationPayload TLV is present if the ValidationAlgorithm
            TLV is present. The Type field is omitted.</t>
          </section>
        </section>
        <section anchor="sec.ccnx.interest.ext0" numbered="true" toc="default">
          <name>Dispatch Extension</name>
          <t>The <tt>EXT_0</tt> byte follows the
          description in <xref target="sec.dispatch.ext" format="default"/> and is illustrated
          in <xref target="fig.ccnx.interest.ext0" format="default"/>.</t>
          <figure anchor="fig.ccnx.interest.ext0">
            <name>EXT_0 Format</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
|  NCS  |        RSV        |EXT|
+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
          <dl newline="true" spacing="normal" indent="4">
            <dt>NCS: Name Compression Strategy</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>00:</dt>
                <dd>Names are compressed with the default name
                  compression strategy (see <xref target="sec.ndn.namecompression" format="default"/>).</dd>
                <dt>01:</dt>
                <dd>Reserved.</dd>
                <dt>10:</dt>
                <dd>Reserved.</dd>
                <dt>11:</dt>
                <dd>Reserved.</dd>
              </dl>
            </dd>
            <dt>RSV: Reserved</dt>
            <dd>Must be set to 0.</dd>
            <dt>EXT: Extension</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>No extension byte follows.</dd>
                <dt>1:</dt>
                <dd>A further extension byte follows
                  immediately.</dd>
              </dl>
            </dd>
          </dl>
        </section>
      </section>
      <section numbered="true" toc="default">
        <name>Content Objects</name>
        <section numbered="true" toc="default">
          <name>Uncompressed Content Objects</name>
          <t>An uncompressed Content Object uses the base dispatch format (see
          <xref target="fig.disp.base" format="default"/>) and sets the C flag to
	  <tt>0</tt> and the P and M flags to
          <tt>1</tt> (<xref target="fig.ccnx.data.uncompr" format="default"/>).
          The Content Object is handed to the CCNx stack without modifications.</t>
          <figure anchor="fig.ccnx.data.uncompr">
            <name>Dispatch Format for Uncompressed CCNx Content Objects</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| 0 | 1 | 1 | 0 | 0 | 0 | 0 | 0 |
+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
        </section>
        <section numbered="true" toc="default">
          <name>Compressed Content Objects</name>
          <t>The compressed Content Object uses the extended dispatch format
          (<xref target="fig.disp.base.compr" format="default"/>) and sets the C, P, and M
	  flags to <tt>1</tt>. If a Content Object contains TLVs that are not mentioned in
	  the following compression
          rules, then this message <bcp14>MUST</bcp14> be sent uncompressed.</t>
          <t>By default, the Content Object is compressed with the following
          base rule set: </t>
          <ol spacing="normal" type="1">
	    <li>The version is elided from the fixed header and assumed to be
	    1.</li>
	    <li>The PacketType field is elided from the fixed header.</li>
            <li>The Type and Length fields of the CCNx Message TLV are elided
              and are obtained from the fixed header on decompression.</li>
          </ol>
          <t>The compressed CCNx LoWPAN Data message is visualized in <xref target="fig.ccnx.data.newformat" format="default"/>.</t>
          <figure anchor="fig.ccnx.data.newformat">
            <name>Compression of CCNx LoWPAN Data Message</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
T = Type, L = Length, V = Value
Lc = Compressed Length, Vc = Compressed Value
: = optional field, | = mandatory field

+-----------------------------+           +-------------------------+
|    Uncompr. Fixed Header    |           |   Compr. Fixed Header   |
+-----------------------------+           +-------------------------+
+---------+---------+---------+           +---------+
: RCT T   : RCT L   : RCT V   :           : RCT Vc  :
+---------+---------+------.--+           +---------+
: MSGH T  : MSGH L  : MSGH V  :           : MSGH Vc :
+---------+---------+---------+           +---------+
+---------+---------+                     +---------+
| MSGT T  | MSGT L  |                     | Name Vc |
+---------+---------+---------+           +---------+
| Name T  | Name L  | Name V  |    ==>    : EXPT Vc :
+---------+---------+---------+           +---------+---------+
: PTYP T  : PTYP L  : PTYP V  :           : PAYL Lc : PAYL V  :
+---------+---------+---------+           +---------+---------+
: EXPT T  : EXPT L  : EXPT V  :           : VALG Lc : VALG Vc :
+---------+---------+---------+           +---------+---------+
: PAYL T  : PAYL L  : PAYL V  :           : VPAY Lc : VPAY V  :
+---------+---------+---------+           +---------+---------+
: VALG T  : VALG L  : VALG V  :
+---------+---------+---------+
: VPAY T  : VPAY L  : VPAY V  :
+---------+---------+---------+
]]></artwork>
          </figure>
          <t>Further TLV compression is indicated by the ICN LoWPAN dispatch
          in <xref target="fig.ccnx.datacompr" format="default"/>.</t>
          <figure anchor="fig.ccnx.datacompr">
            <name>Dispatch Format for Compressed CCNx Content Objects</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0                                       1
  0   1   2   3   4   5   6   7   8   9   0   1   2   3   4   5
+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
| 0 | 1 | 1 | 1 |FLG|FRS|PAY|RCT|MGH| PLTYP |EXP|VAL|RSV|CID|EXT|
+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
          <dl newline="true" spacing="normal" indent="4">
            <dt>FLG: Flags field in the fixed header</dt>
            <dd>See <xref target="sec.ccnxintcompbaseheader"
	    format="default"/>.</dd>
            <dt>FRS: Reserved field in the fixed header</dt>
            <dd>See <xref target="sec.ccnxintcompbaseheader"
	    format="default"/>.</dd>
            <dt>PAY: Optional Payload TLV</dt>
            <dd>See <xref target="sec.ccnxintcompbaseheader"
	    format="default"/>.</dd>
            <dt>RCT: Optional hop-by-hop Recommended Cache Time TLV</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The Recommended Cache Time TLV is
                  absent.</dd>
                <dt>1:</dt>
                <dd>The Recommended Cache Time TLV is present,
                  and the Type and Length fields are elided.</dd>
              </dl>
            </dd>
            <dt>MGH: Optional hop-by-hop MessageHash TLV</dt>
            <dd>
	      <t>See <xref target="sec.ccnxhbhdata" format="default"/> for
	      further details on the ordering of hop-by-hop TLVs.</t>
              <t>This TLV is expected to contain a T_SHA-256 TLV. If
              another hash is contained, then the Content Object
	      <bcp14>MUST</bcp14> be sent uncompressed.</t>
		  <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The MessageHash TLV is absent.</dd>
                <dt>1:</dt>
                <dd>A T_SHA-256 TLV is present, and the Type and
                  Length fields are removed. The Length field is
                  assumed to represent 32 bytes. The outer Message Hash TLV
                  is omitted.</dd>
              </dl>
            </dd>
            <dt>PLTYP: Optional PayloadType TLV</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>00:</dt>
                <dd>The PayloadType TLV is absent.</dd>
                <dt>01:</dt>
                <dd>The PayloadType TLV is absent, and
                  T_PAYLOADTYPE_DATA is assumed.</dd>
                <dt>10:</dt>
                <dd>The PayloadType TLV is absent, and
                  T_PAYLOADTYPE_KEY is assumed.</dd>
                <dt>11:</dt>
                <dd>The PayloadType TLV is present and
                  uncompressed.</dd>
              </dl>
            </dd>
            <dt>EXP: Optional ExpiryTime TLV</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>The ExpiryTime TLV is absent.</dd>
                <dt>1:</dt>
                <dd>The ExpiryTime TLV is present, and the Type
                  and Length fields are elided.</dd>
              </dl>
            </dd>
            <dt>VAL: Optional ValidationAlgorithm and ValidationPayload
	    TLVs</dt>
            <dd>See
              <xref target="sec.ccnxintcompbaseheader" format="default"/>.</dd>
            <dt>RSV: Reserved</dt>
            <dd>Must be set to 0.</dd>
            <dt>CID: Context Identifier</dt>
            <dd>See <xref target="fig.disp.base.compr" format="default"/>.</dd>
            <dt>EXT: Extension</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>No extension byte follows.</dd>
                <dt>1:</dt>
                <dd>Extension byte <tt>EXT_0</tt>
                  follows immediately. See <xref target="sec.ccnx.data.ext0" format="default"/>.</dd>
              </dl>
            </dd>

          </dl>
          <section anchor="sec.ccnxhbhdata" toc="exclude" numbered="true">
            <name>Hop-By-Hop Header TLVs Compression</name>
            <t>Hop-by-hop header TLVs are unordered. For a Content Object
            message, two optional hop-by-hop header TLVs are defined in 
	    <xref target="RFC8609" format="default"/>, but several more can be defined in
	    higher-level specifications. For the compression specified in the
            previous section, the hop-by-hop TLVs are ordered as follows:
            </t>
            <ol spacing="normal" type="1">
	      <li>Recommended Cache Time TLV</li>
              <li>Message Hash TLV</li>
            </ol>
            <t>Note: All hop-by-hop header TLVs other than the RecommendedCacheTime
            and MessageHash TLVs remain uncompressed in the encoded message, and
            they appear after the RecommendedCacheTime and MessageHash TLVs in
            the same order as in the original message.</t>
          </section>
        </section>
        <section anchor="sec.ccnx.data.ext0" numbered="true" toc="default">
          <name>Dispatch Extension</name>
          <t>The <tt>EXT_0</tt> byte follows the
          description in <xref target="sec.dispatch.ext" format="default"/> and is illustrated
          in <xref target="fig.ccnx.data.ext0" format="default"/>.</t>
          <figure anchor="fig.ccnx.data.ext0">
            <name>EXT_0 Format</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
|  NCS  |        RSV        |EXT|
+---+---+---+---+---+---+---+---+
]]></artwork>
          </figure>
          <dl newline="true" spacing="normal" indent="4">
            <dt>NCS: Name Compression Strategy</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>00:</dt>
                <dd>Names are compressed with the default name
                  compression strategy (see <xref target="sec.ndn.namecompression" format="default"/>).</dd>
                <dt>01:</dt>
                <dd>Reserved.</dd>
                <dt>10:</dt>
                <dd>Reserved.</dd>
                <dt>11:</dt>
                <dd>Reserved.</dd>
              </dl>
            </dd>
            <dt>RSV: Reserved</dt>
            <dd>Must be set to 0.</dd>
            <dt>EXT: Extension</dt>
            <dd>
              <dl newline="false" spacing="normal" indent="4">
                <dt>0:</dt>
                <dd>No extension byte follows.</dd>
                <dt>1:</dt>
                <dd>A further extension byte follows
                  immediately.</dd>
              </dl>
            </dd>
          </dl>
        </section>
      </section>
    </section>
    <section anchor="sec.compressedtime" numbered="true" toc="default">
      <name>Compressed Time Encoding</name>
      <t>
        This document adopts the 8-bit compact time representation for
        relative time-values described in <xref target="RFC5497" section="5" sectionFormat="of" format="default"/> with the constant factor <tt>C</tt> set to <tt>C :=
        1/32</tt>.
      </t>
      <t>
        Valid time offsets in CCNx and NDN range from a few
        milliseconds (e.g., lifetime of low-latency Interests) to
        several years (e.g., content freshness periods in caches).
        Therefore, this document adds two modifications to the
        compression algorithm.
      </t>
      <t>
        The first modification is the inclusion of a subnormal form
        <xref target="IEEE.754.2019" format="default"/> for time-codes with exponent
        0 to provide an increased precision and a gradual underflow
        for the smallest numbers. The formula is changed as
        follows (a := mantissa, b := exponent):

      </t>
      <dl newline="false" spacing="normal">
        <dt>Subnormal (b == 0):</dt>
        <dd> (0 + a/8) * 2 * C
          </dd>
        <dt>Normalized (b &gt; 0):</dt>
        <dd> (1 + a/8) * 2<sup>b</sup> * C (see <xref target="RFC5497" format="default"/>)
          </dd>
      </dl>
      <t>This configuration allows for the following ranges:</t>
      <ul spacing="compact">
        <li>Minimum subnormal number: 0 seconds</li>
        <li>2nd minimum subnormal number: ~0.007812 seconds</li>
        <li>Maximum subnormal number: ~0.054688 seconds</li>
        <li>Minimum normalized number: ~0.062500 seconds</li>
        <li>2nd minimum normalized number: ~0.070312 seconds</li>
        <li>Maximum normalized number: ~3.99 years</li>
      </ul>
      <t>
        The second modification only applies to uncompressible time
        offsets that are outside any security envelope. An invalid
        time-value <bcp14>MUST</bcp14> be set to the largest valid time-value that is
        smaller than the invalid input value before compression.
      </t>
    </section>
    <section anchor="stateful.compression" numbered="true" toc="default">
      <name>Stateful Header Compression</name>
      <t>Stateful header compression in ICN LoWPAN enables packet size
      reductions in two ways. First, common information that is shared
      throughout the local LoWPAN may be memorized in the context state at all
      nodes and omitted from communication. Second, redundancy in a single
      Interest-Data exchange may be removed from ICN stateful forwarding on a
      hop-by-hop basis and memorized in en route state tables.</t>
      <section anchor="stateful.compression.local" numbered="true" toc="default">
        <name>LoWPAN-Local State</name>
        <t>A Context Identifier (CID) is a byte that refers to a particular
        conceptual context between network devices and <bcp14>MAY</bcp14> be used to replace
        frequently appearing information, such as name prefixes, suffixes, or
        meta information, such as Interest lifetime.</t>
        <figure anchor="fig.cid">
          <name>Context Identifier</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| X |            CID            |
+---+---+---+---+---+---+---+---+
]]></artwork>
        </figure>
        <t>The 7-bit CID is a locally scoped unique identifier that
        represents the context state shared between the sender and receiver of the
        corresponding frame (see <xref target="fig.cid" format="default"/>).
        If set, the most significant bit indicates the presence of another, subsequent
        CID byte (see <xref target="fig.cid.chain" format="default"/>).</t>
        <t>The context state shared between senders and receivers is removed from the
        compressed packet prior to sending and reinserted after reception
        prior to passing to the upper stack.</t>
        <t>The actual information in a context and how it is encoded are out of scope of this document.
        The initial distribution and maintenance of shared context is out
        of scope of this document. Frames containing unknown or invalid CIDs <bcp14>MUST</bcp14> be silently discarded.</t>
      </section>
      <section anchor="stateful.compression.en-route" numbered="true" toc="default">
        <name>En Route State</name>
        <t>In CCNx and NDN, Name TLVs are included in Interest messages, and
        they return in Data messages. Returning Name TLVs either equal the
        original Name TLV or contain the original Name TLV as a prefix.
        ICN LoWPAN reduces this redundancy in responses by replacing Name TLVs
        with single bytes that represent link-local HopIDs. HopIDs are
        carried as Context Identifiers (see <xref target="stateful.compression.local" format="default"/>) of link-local scope, as shown in <xref target="fig.hopid" format="default"/>.</t>
        <figure anchor="fig.hopid">
          <name>Context Identifier as HopID</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
  0   1   2   3   4   5   6   7
+---+---+---+---+---+---+---+---+
| X |          HopID            |
+---+---+---+---+---+---+---+---+
]]></artwork>
        </figure>
        <t>A HopID is valid if not all ID bits are set to zero and invalid
        otherwise. This yields 127 distinct HopIDs. If this range (1...127) is
        exhausted, the messages <bcp14>MUST</bcp14> be sent without en route state
        compression until new HopIDs are available. An ICN LoWPAN node that
        forwards without replacing the Name TLV with a HopID (without en route
        compression) <bcp14>MUST</bcp14> invalidate the HopID by setting all ID bits to
        zero.</t>
        <t>While an Interest is traversing, a forwarder generates an ephemeral
        HopID that is tied to a Pending Interest Table (PIT) entry. Each HopID
	<bcp14>MUST</bcp14> be unique within
        the local PIT and only exists during the lifetime of a PIT entry. To
        maintain HopIDs, the local PIT is extended by two new columns: HIDi
        (inbound HopIDs) and HIDo (outbound HopIDs).</t>
        <t>HopIDs are included in Interests and stored on the next hop with
        the resulting PIT entry in the HIDi column. The HopID is replaced with
        a newly generated local HopID before the Interest is forwarded. This
        new HopID is stored in the HIDo column of the local PIT (see <xref target="fig.enroute-a" format="default"/>). </t>
        <figure anchor="fig.enroute-a">
          <name>Setting Compression State En Route (Interest)</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
    PIT of B      PIT Extension          PIT of C      PIT Extension
+--------+------++------+------+     +--------+------++------+------+
| Prefix | Face || HIDi | HIDo |     | Prefix | Face || HIDi | HIDo |
+========+======++======+======+     +========+======++======+======+
|  /p0   | F_A  || h_A  | h_B  |     |  /p0   | F_A  || h_A  |      |
+--------+------++------+------+     +--------+------++------+------+
                    ^       |                            ^
              store |       '----------------------, ,---' store
                    |                 send         v |
,---,         /p0, h_A          ,---,         /p0, h_B          ,---,
| A | ------------------------> | B | ------------------------> | C |
'---'                           '---'                           '---'
]]></artwork>
        </figure>
        <t>Responses include HopIDs that were obtained from Interests. If the
        returning Name TLV equals the original Name TLV, then the name is
        entirely elided. Otherwise, only the matching name prefix is elided, and
        the distinct name suffix is included along with
        the HopID. When a response is forwarded, the contained HopID is
        extracted and used to match against the correct PIT entry by
        performing a lookup on the HIDo column. The HopID is then replaced
        with the corresponding HopID from the HIDi column prior to forwarding
        the response (<xref target="fig.enroute-b" format="default"/>). </t>
        <figure anchor="fig.enroute-b">
          <name>Eliding Name TLVs Using En Route State (Data)</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
    PIT of B      PIT Extension          PIT of C      PIT Extension
+--------+------++------+------+     +--------+------++------+------+
| Prefix | Face || HIDi | HIDo |     | Prefix | Face || HIDi | HIDo |
+========+======++======+======+     +========+======++======+======+
|  /p0   | F_A  || h_A  | h_B  |     |  /p0   | F_A  || h_A  |      |
+--------+------++------+------+     +--------+------++------+------+
                    |       ^                            |
               send |       '----------------------, ,---' send
                    v                 match        | v
,---,              h_A          ,---,              h_B          ,---,
| A | <------------------------ | B | <------------------------ | C |
'---'                           '---'                           '---'
]]></artwork>
        </figure>
        <t>It should be noted that each forwarder of an Interest in an ICN
        LoWPAN network can individually decide whether to participate in
        en route compression or not. However, an ICN LoWPAN node <bcp14>SHOULD</bcp14> use
        en route compression whenever the stateful compression mechanism is
        activated.</t>
        <t>Note also that the extensions of the PIT data structure are
        required only at ICN LoWPAN nodes, while regular NDN/CCNx forwarders
        outside of an ICN LoWPAN domain do not need to implement these
        extensions.</t>
      </section>
      <section numbered="true" toc="default">
        <name>Integrating Stateful Header Compression</name>
        <t>A CID appears whenever the CID flag is set (see <xref target="fig.disp.base.compr" format="default"/>). The CID is appended to the last ICN
        LoWPAN dispatch byte, as shown in <xref target="fig.cid.loc" format="default"/>.</t>
        <figure anchor="fig.cid.loc">
          <name>LoWPAN Encapsulation with ICN LoWPAN and CIDs</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
...-------+--------+-------...-------+--...-+-------...
/  ...    |  Page  | ICN LoWPAN Disp.| CIDs | Payload /
...-------+--------+-------...-------+--...-+-------...
]]></artwork>
        </figure>
        <t>Multiple CIDs are chained together, with the most significant bit
        indicating the presence of a subsequent CID (<xref target="fig.cid.chain" format="default"/>). This allows the use of multiple shared contexts in compressed messages.</t>
        <t>The HopID is always included as the very first CID.</t>
        <figure anchor="fig.cid.chain">
          <name>Chaining of Context Identifiers</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
+-+-+-+-+-+-+-+-+     +-+-+-+-+-+-+-+-+     +-+-+-+-+-+-+-+-+
|1| CID / HopID | --> |1|     CID     | --> |0|     CID     |
+-+-+-+-+-+-+-+-+     +-+-+-+-+-+-+-+-+     +-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
      </section>
    </section>
    <section anchor="sec.ndn.constvars" numbered="true" toc="default">
      <name>ICN LoWPAN Constants and Variables</name>
      <t>This is a summary of all ICN LoWPAN constants and variables. </t>
      <dl newline="false" spacing="normal" indent="8">
        <dt>DEFAULT_NDN_HOPLIMIT:</dt>
        <dd>255</dd>
      </dl>
    </section>
    <section anchor="implementationnotice" numbered="true" toc="default">
      <name>Implementation Report and Guidance</name>
      <t>The ICN LoWPAN scheme defined in this document has been implemented as
      an extension of the NDN/CCNx software stack <xref target="CCN-LITE" format="default"/> in
      its IoT version on RIOT <xref target="RIOT" format="default"/>. An experimental
      evaluation for NDN over ICN LoWPAN with varying configurations has been
      performed in <xref target="ICNLOWPAN" format="default"/>.  Energy profiling and
      processing time measurements indicate significant energy savings, and the 
      amortized costs for processing show no penalties.</t>
      <section numbered="true" toc="default">
        <name>Preferred Configuration</name>
        <t>The header compression performance depends on certain aspects and
        configurations. It works best for the following cases: </t>
        <ul spacing="normal">
          <li>Signed time offsets compress, per <xref target="sec.compressedtime"
	  format="default"/>, without the need for rounding.</li>
          <li>The context state (e.g., prefixes) is distributed such that
            long names can be elided from Interest and Data messages.</li>
          <li>Frequently used TLV type numbers for CCNx and NDN stay
            in the lower range (&lt; 255).</li>
        </ul>
        <t>
          Name components are of type GenericNameComponent and are limited to a
        length of 15 bytes to enable compression for all messages.</t>
      </section>
      <section numbered="true" toc="default">
        <name>Further Experimental Deployments</name>
        <t>An investigation of ICN LoWPAN in large-scale deployments
        with varying traffic patterns using larger samples of the
        different board types available remains as future work. This
        document will be revised to progress it to the Standards
        Track, once sufficient operational experience has been
        acquired. Experience reports are encouraged, particularly in
        the following areas:
        </t>
        <ul spacing="normal">
          <li>The name compression scheme (<xref target="sec.ndn.namecompression" format="default"/>) is optimized for short
          name components of type GenericNameComponent. An empirical
          study on name lengths in different deployments of selected
          use cases, such as smart home, smart city, and industrial
          IoT can provide meaningful reports on necessary name
          component types and lengths. A conclusive outcome helps to
          understand whether and how extension mechanisms are needed
          (<xref target="sec.ndn.interest.ext0" format="default"/>). As a preliminary
          analysis, <xref target="ICNLOWPAN" format="default"/> investigates the
          effectiveness of the proposed compression scheme with URLs
          obtained from the WWW. Studies on deployments of Constrained Application Protocol (CoAP) <xref target="RFC7252" format="default"/> can offer additional insights
          on naming schemes in the IoT.</li>
          <li>The fragmentation scheme (<xref target="sec.Fragmentation" format="default"/>) inherited from 6LoWPAN allows
          for a transparent, hop-wise reassembly of CCNx or NDN
          packets. Fragment forwarding <xref target="RFC8930" format="default"/> with selective
          fragment recovery <xref target="RFC8931" format="default"/> can improve the
          end-to-end latency and reliability while it reduces buffer
          requirements on forwarders. Initial evaluations <xref target="SFR-ICNLOWPAN"
	  format="default"/> show that a naive integration of
          these upcoming fragmentation features into ICN LoWPAN
          renders the hop-wise content replication inoperative, since
          Interest and Data messages are reassembled end-to-end. More
          deployment experiences are necessary to gauge the
          feasibility of different fragmentation schemes in ICN
          LoWPAN.
          </li>
          <li>The context state (<xref target="stateful.compression.local"
 format="default"/>) holds information
          that is shared between a set of devices in a LoWPAN. Fixed
          name prefixes and suffixes are good candidates to be
          distributed to all nodes in order to elide them from request
          and response messages. More experience and a deeper
          inspection of currently available and upcoming protocol
          features is necessary to identify other protocol fields.</li>
          <li>The distribution and synchronization of the context state
          can potentially be adopted from <xref target="RFC6775" section="7.2" sectionFormat="of" format="default"/> but requires further evaluations. While
          6LoWPAN uses the Neighbor Discovery protocol to disseminate
          state, CCNx and NDN deployments are missing out on a
          standard mechanism to bootstrap and manage
          configurations.</li>
          <li>The stateful en route compression (<xref target="stateful.compression.en-route" format="default"/>) supports a limited
          number of 127 distinct HopIDs that can be simultaneously in
          use on a single node. Complex deployment scenarios that make
          use of multiple, concurrent requests can provide a better
          insight on the number of open requests stored in the 
          PIT of memory-constrained devices. This number
          can serve as an upper bound and determines whether the HopID
          length needs to be resized to fit more HopIDs at the cost of
          additional header overhead.</li>
          <li>Multiple implementations that generate and deploy the
          compression options of this memo in different ways will also
          add to the experience and understanding of the benefits and
          limitations of the proposed schemes. Different reports can
          help to illuminate the complexity of implementing ICN
          LoWPAN for constrained devices, as well as on maintaining
          interoperability with other implementations.</li>
        </ul>
      </section>
    </section>
    <section anchor="security.considerations" numbered="true" toc="default">
      <name>Security Considerations</name>
      <t>Main memory is typically a scarce resource of constrained networked
      devices. Fragmentation, as described in this memo, preserves fragments and
      purges them only after a packet is reassembled, which requires a
      buffering of all fragments. This scheme is able to handle fragments for
      distinctive packets simultaneously, which can lead to overflowing packet
      buffers that cannot hold all necessary fragments for packet reassembly.
      Implementers are thus urged to make use of appropriate buffer
      replacement strategies for fragments. Minimal fragment forwarding
      <xref target="RFC8930" format="default"/> can potentially prevent fragment buffer saturation in forwarders.</t>
      <t>The stateful header compression generates ephemeral HopIDs for
      incoming and outgoing Interests and consumes them on returning Data
      packets. Forged Interests can deplete the number of available HopIDs,
      thus leading to a denial of compression service for subsequent content
      requests.</t>
      <t>To further alleviate the problems caused by forged fragments or
      Interest initiations, proper protective mechanisms for accessing the
      link layer should be deployed. IEEE 802.15.4, e.g., provides capabilities to protect frames and restrict them to a point-to-point link or a group of devices.</t>
    </section>
    <section anchor="iana" numbered="true" toc="default">
      <name>IANA Considerations</name>
      <section numbered="true" toc="default">
        <name>Updates to the 6LoWPAN Dispatch Type Field Registry</name>
        <t>IANA has assigned dispatch values for ICN LoWPAN in the "Dispatch Type Field"
        subregistry <xref target="RFC4944" format="default"/> <xref target="RFC8025" format="default"/> of 
        the "IPv6 Low Power Personal Area Network Parameters" registry.
        <xref target="tab.iana.dispatches" format="default"/> represents the updates to the registry.</t>
        <table anchor="tab.iana.dispatches" align="center">
          <name>Dispatch Types for NDN and CCNx</name>
          <thead>
            <tr>
              <th align="center">Bit Pattern</th>
              <th align="center">Page</th>
              <th align="left">Header Type</th>
              <th align="left">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">00 000000</td>
              <td align="center">14</td>
              <td align="left">Uncompressed NDN Interest messages</td>
              <td align="left">RFC 9139</td>
            </tr>
            <tr>
              <td align="center">00 01xxxx</td>
              <td align="center">14</td>
              <td align="left">Compressed NDN Interest messages</td>
              <td align="left">RFC 9139</td>
            </tr>
            <tr>
              <td align="center">00 100000</td>
              <td align="center">14</td>
              <td align="left">Uncompressed NDN Data messages</td>
              <td align="left">RFC 9139</td>
            </tr>
            <tr>
              <td align="center">00 11xxxx</td>
              <td align="center">14</td>
              <td align="left">Compressed NDN Data messages</td>
              <td align="left">RFC 9139</td>
            </tr>
            <tr>
              <td align="center">01 000000</td>
              <td align="center">14</td>
              <td align="left">Uncompressed CCNx Interest messages</td>
              <td align="left">RFC 9139</td>
            </tr>
            <tr>
              <td align="center">01 01xxxx</td>
              <td align="center">14</td>
              <td align="left">Compressed CCNx Interest messages</td>
              <td align="left">RFC 9139</td>
            </tr>
            <tr>
              <td align="center">01 100000</td>
              <td align="center">14</td>
              <td align="left">Uncompressed CCNx Content Object messages</td>
              <td align="left">RFC 9139</td>
            </tr>
            <tr>
              <td align="center">01 11xxxx</td>
              <td align="center">14</td>
              <td align="left">Compressed CCNx Content Object messages</td>
              <td align="left">RFC 9139</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
  </middle>
  <back>

<displayreference target="I-D.irtf-icnrg-flic" to="ICNRG-FLIC"/>

    <references>
      <name>References</name>
      <references>
        <name>Normative References</name>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4944.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5497.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6256.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6282.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6775.xml"/>

        <reference anchor="ieee802.15.4" target="https://standards.ieee.org/standard/802_15_4-2020.html">
          <front>
            <title>IEEE Standard for Low-Rate Wireless
	    Networks</title>
            <author><organization>IEEE</organization></author>
          </front>
	  <seriesInfo name="IEEE Std" value="802.15.4-2020"/>
        </reference>


        <reference anchor="IEEE.754.2019" target="https://standards.ieee.org/content/ieee-standards/en/standard/754-2019.html">
          <front>
            <title>IEEE Standard for Floating-Point Arithmetic</title>
            <author><organization>IEEE</organization></author>
          </front>
	  <seriesInfo name="IEEE Std" value="754-2019"/>
        </reference>
      </references>

      <references>
        <name>Informative References</name>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7252.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7476.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7927.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7945.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7228.xml"/>

        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8025.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8609.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8569.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8930.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8931.xml"/>

<reference anchor="I-D.irtf-icnrg-flic">
<front>
<title>File-Like ICN Collections (FLIC)</title>
<author initials="C." surname="Tschudin" fullname="Christian Tschudin">
<organization>University of Basel</organization>
</author>
<author initials="C." surname="Wood" fullname="Christopher A. Wood">
<organization>University of California Irvine</organization>
</author>
<author initials="M." surname="Mosko" fullname="Marc Mosko">
<organization>PARC, Inc.</organization>
</author>
<author initials="D." surname="Oran" fullname="David R. Oran" role="editor">
<organization>Network Systems Research &amp; Design</organization>
</author>
<date month="November" day="4" year="2019"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-irtf-icnrg-flic-02"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-irtf-icnrg-flic-02.txt"/>
</reference>

        <reference anchor="CCN-LITE" target="https://github.com/cn-uofbasel/ccn-lite">
          <front>
            <title>CCN-lite, a lightweight implementation of the CCNx protocol and its variations</title>
            <author/>
          </front>
        </reference>

        <reference anchor="RIOT" target="https://doi.org/10.1109/JIOT.2018.2815038">
          <front>
            <title>RIOT: An Open Source Operating System for Low-End Embedded
          Devices in the IoT</title>
            <author initials="E." surname="Baccelli">
              <organization>INRIA</organization>
            </author>
            <author initials="C." surname="Gündoğan">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="O." surname="Hahm">
              <organization>INRIA and FU Berlin</organization>
            </author>
            <author initials="P." surname="Kietzmann">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="MS." surname="Lenders">
              <organization>FU Berlin</organization>
            </author>
            <author initials="H." surname="Petersen">
              <organization>FU Berlin</organization>
            </author>
            <author initials="K." surname="Schleiser">
              <organization>INRIA and FU Berlin</organization>
            </author>
            <author initials="TC." surname="Schmidt">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="M." surname="Wählisch">
              <organization>FU Berlin</organization>
            </author>
            <date month="December" year="2018"/>
          </front>
          <refcontent>IEEE Internet of Things Journal Vol. 5, No. 6, p.
	  4428-4440</refcontent>
        </reference>

        <reference anchor="NDN-EXP1" target="http://dx.doi.org/10.1145/2660129.2660144">
          <front>
            <title>Information centric networking in the IoT: experiments with
          NDN in the wild</title>
            <author initials="E." surname="Baccelli">
              <organization>INRIA</organization>
            </author>
            <author initials="C." surname="Mehlis">
              <organization>FU Berlin</organization>
            </author>
            <author initials="O." surname="Hahm">
              <organization>INRIA</organization>
            </author>
            <author initials="TC." surname="Schmidt">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="M." surname="Wählisch">
              <organization>FU Berlin</organization>
            </author>
            <date month="September" year="2014"/>
          </front>
          <refcontent>Proc. of 1st ACM Conf. on Information-Centric Networking (ICN-2014)
	  ACM DL, pp. 77-86</refcontent>
        </reference>

        <reference anchor="NDN-EXP2" target="https://doi.org/10.1145/3267955.3267967">
          <front>
            <title>NDN, CoAP, and MQTT: a comparative measurement study in the
          IoT</title>
            <author initials="C." surname="Gündoğan">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="P." surname="Kietzmann">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="M." surname="Lenders">
              <organization>FU Berlin</organization>
            </author>
            <author initials="H." surname="Petersen">
              <organization>FU Berlin</organization>
            </author>
            <author initials="TC." surname="Schmidt">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="M." surname="Wählisch">
              <organization>FU Berlin</organization>
            </author>
            <date month="September" year="2018"/>
          </front>
          <refcontent>Proc. of 5th ACM Conf. on Information-Centric Networking (ICN-2018)
	  ACM DL, pp. 159-171</refcontent>
        </reference>

        <reference anchor="NDN-MAC" target="https://doi.org/10.1145/3125719.3125737">
          <front>
            <title>The need for a name to MAC address mapping in NDN: towards
            quantifying the resource gain</title>
            <author initials="P." surname="Kietzmann">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="C." surname="Gündoğan">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="TC." surname="Schmidt">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="O." surname="Hahm">
              <organization>riot-os.org</organization>
            </author>
            <author initials="M." surname="Wählisch">
              <organization>FU Berlin</organization>
            </author>
            <date month="September" year="2017"/>
          </front>
          <refcontent>Proc. of 4th ACM Conf. on Information-Centric Networking (ICN-2017)
	  ACM DL, pp. 36-42</refcontent>
        </reference>

        <reference anchor="SFR-ICNLOWPAN" target="https://doi.org/10.1145/3405656.3418719">
          <front>
            <title>Connecting the Dots: Selective Fragment Recovery in
          ICNLoWPAN</title>
            <author initials="M." surname="Lenders">
              <organization>FU Berlin</organization>
            </author>
            <author initials="C." surname="Gündoğan">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="TC." surname="Schmidt">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="M." surname="Wählisch">
              <organization>FU Berlin</organization>
            </author>
            <date month="September" year="2020"/>
          </front>
          <refcontent>Proc. of 7th ACM Conf. on Information-Centric Networking (ICN-2020)
	  ACM DL, pp. 70-76</refcontent>
        </reference>

        <reference anchor="NDN" target="https://doi.org/10.1145/1658939.1658941">
          <front>
            <title>Networking named content</title>
            <author initials="V." surname="Jacobson"/>
            <author initials="D." surname="Smetters"/>
            <author initials="J." surname="Thornton"/>
            <author initials="M." surname="Plass"/>
	    <author initials="N." surname="Briggs"/>
	    <author initials="R." surname="Braynard"/>
            <date month="December" year="2009"/>
          </front>
          <refcontent>5th Int. Conf. on emerging Networking Experiments and Technologies
	  (ACM CoNEXT)</refcontent>
        </reference>

        <reference anchor="NDN-PACKET-SPEC" target="https://named-data.net/doc/NDN-packet-spec/0.3/">
          <front>
            <title>NDN Packet Format Specification</title>
            <author/>
          </front>
        </reference>

        <reference anchor="TLV-ENC-802.15.4" target="https://datatracker.ietf.org/meeting/interim-2015-icnrg-01/materials/slides-interim-2015-icnrg-1-2">
          <front>
            <title>CCN and NDN TLV encodings in 802.15.4 packets</title>
            <author initials="M." surname="Mosko"/>
	    <author initials="C." surname="Tschudin"/>
            <date month="January" year="2015"/>
          </front>
        </reference>

        <reference anchor="WIRE-FORMAT-CONSID" target="https://datatracker.ietf.org/meeting/interim-2015-icnrg-01/materials/slides-interim-2015-icnrg-1-8">
          <front>
            <title>CCN/NDN Protocol Wire Format and Functionality
          Considerations</title>
            <author initials="G." surname="Wang"/>
	    <author initials="C." surname="Tschudin"/>
	    <author initials="R." surname="Ravindran"/>
            <date month="January" year="2015"/>
          </front>
        </reference>

        <reference anchor="ICNLOWPAN" target="https://doi.org/10.1016/j.comcom.2020.10.002">
          <front>
            <title>Designing a LoWPAN convergence layer for the Information Centric Internet of Things</title>
            <author initials="C." surname="Gündoğan">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="P." surname="Kietzmann">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="T." surname="Schmidt">
              <organization>HAW Hamburg</organization>
            </author>
            <author initials="M." surname="Wählisch">
              <organization>FU Berlin</organization>
            </author>
            <date month="December" year="2020"/>
          </front>
          <refcontent>Computer Communications, Vol. 164, No. 1, p. 114–123, Elsevier</refcontent>
        </reference>
      </references>
    </references>
    <section anchor="sec.EstimatedSizeReduction" numbered="true" toc="default">
      <name>Estimated Size Reduction</name>
      <t>In the following, a theoretical evaluation is given to estimate the
      gains of ICN LoWPAN compared to uncompressed CCNx and NDN messages.</t>
      <t>We assume that <tt>n</tt> is the number of name
      components; <tt>comps_n</tt> denotes the sum of n
      name component lengths. We also assume that the length of each name
      component is lower than 16 bytes. The length of the content is given by
      <tt>clen</tt>. The lengths of TLV components are 
      specific to the CCNx or NDN encoding and are outlined below.</t>
      <section numbered="true" toc="default">
        <name>NDN</name>
        <t>The NDN TLV encoding has variable-sized TLV fields. For simplicity,
        the 1-byte form of each TLV component is assumed. A typical TLV
        component therefore is of size 2 (Type field + Length field) + the
        actual value.</t>
        <section numbered="true" toc="default">
          <name>Interest</name>
          <t><xref target="fig.Size.NDN.interest.uncompressed" format="default"/> depicts the
          size requirements for a basic, uncompressed NDN Interest containing
          a CanBePrefix TLV, a MustBeFresh TLV, an InterestLifetime TLV set to
          4 seconds, and a HopLimit TLV set to 6. Numbers below represent the
          amount of bytes.</t>
          <figure anchor="fig.Size.NDN.interest.uncompressed">
            <name>Estimated Size of an Uncompressed NDN Interest</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
------------------------------------,
Interest TLV            = 2         |
  ---------------------,            |
  Name                 |  2 +       |
    NameComponents      = 2n +      |
                       |  comps_n   |
  ---------------------'             = 21 + 2n + comps_n
  CanBePrefix           = 2         |
  MustBeFresh           = 2         |
  Nonce                 = 6         |
  InterestLifetime      = 4         |
  HopLimit              = 3         |
------------------------------------'
]]></artwork>
          </figure>
          <t><xref target="fig.Size.NDN.interest.compressed" format="default"/> depicts the
          size requirements after compression.</t>
          <figure anchor="fig.Size.NDN.interest.compressed">
            <name>Estimated Size of a Compressed NDN Interest</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
------------------------------------,
Dispatch Page Switch    = 1         |
NDN Interest Dispatch   = 2         |
Interest TLV            = 1         |
-----------------------,            |
Name                   |            |
  NameComponents        = n/2 +      = 10 + n/2 + comps_n
                       |  comps_n   |
-----------------------'            |
Nonce                   = 4         |
HopLimit                = 1         |
InterestLifetime        = 1         |
------------------------------------'
]]></artwork>
          </figure>
          <t>The size difference is 11 + 1.5n bytes.</t>
          <t>For the name <tt>/DE/HH/HAW/BT7</tt>, the
          total size gain is 17 bytes, which is 43% of the uncompressed
          packet.</t>
        </section>
        <section numbered="true" toc="default">
          <name>Data</name>
          <t><xref target="fig.Size.NDN.Data.uncompressed" format="default"/> depicts the size
          requirements for a basic, uncompressed NDN Data containing a
          FreshnessPeriod as MetaInfo. A FreshnessPeriod of 1 minute is
          assumed, and the value is encoded using 1 byte. An HMACWithSha256 is
          assumed as a signature. The key locator is assumed to contain a Name
          TLV of length klen.</t>
          <figure anchor="fig.Size.NDN.Data.uncompressed">
            <name>Estimated Size of an Uncompressed NDN Data</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
------------------------------------,
Data TLV                = 2         |
  ---------------------,            |
  Name                 |  2 +       |
    NameComponents      = 2n +      |
                       |  comps_n   |
  ---------------------'            |
  ---------------------,            |
  MetaInfo             |            |
    FreshnessPeriod     = 6         |
                       |             = 53 + 2n + comps_n +
  ---------------------'            |  clen + klen
  Content               = 2 + clen  |
  ---------------------,            |
  SignatureInfo        |            |
    SignatureType      |            |
      KeyLocator        = 41 + klen |
  SignatureValue       |            |
    DigestSha256       |            |
  ---------------------'            |
------------------------------------'
]]></artwork>
          </figure>
          <t><xref target="fig.Size.NDN.Data.compressed" format="default"/> depicts the size
          requirements for the compressed version of the above Data
          packet.</t>
          <figure anchor="fig.Size.NDN.Data.compressed">
            <name>Estimated Size of a Compressed NDN Data</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
------------------------------------,
Dispatch Page Switch    = 1         |
NDN Data Dispatch       = 2         |
-----------------------,            |
Name                   |            |
  NameComponents        = n/2 +     |
                       |  comps_n    = 38 + n/2 + comps_n +
-----------------------'            |  clen + klen
Content                 = 1 + clen  |
KeyLocator              = 1 + klen  |
DigestSha256            = 32        |
FreshnessPeriod         = 1         |
------------------------------------'
]]></artwork>
          </figure>
          <t>The size difference is 15 + 1.5n bytes.</t>
          <t>For the name <tt>/DE/HH/HAW/BT7</tt>, the
          total size gain is 21 bytes.</t>
        </section>
      </section>
      <section numbered="true" toc="default">
        <name>CCNx</name>
        <t>The CCNx TLV encoding defines a 2-byte encoding for Type and
        Length fields, summing up to 4 bytes in total without a value.</t>
        <section numbered="true" toc="default">
          <name>Interest</name>
          <t><xref target="fig.Size.CCNx.interest.uncompressed" format="default"/> depicts
	  the size requirements for a basic, uncompressed CCNx Interest. No
          hop-by-hop TLVs are included, the protocol version is assumed to be
          1, and the Reserved field is assumed to be 0. A KeyIdRestriction TLV
          with T_SHA-256 is included to limit the responses to Content Objects
          containing the specific key.</t>
          <figure anchor="fig.Size.CCNx.interest.uncompressed">
            <name>Estimated Size of an Uncompressed CCNx Interest</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
------------------------------------,
Fixed Header            = 8         |
Message                 = 4         |
  ---------------------,            |
  Name                 |  4 +        = 56 + 4n + comps_n
    NameSegments        = 4n +      |
                       |  comps_n   |
  ---------------------'            |
  KeyIdRestriction      = 40        |
------------------------------------'
]]></artwork>
          </figure>
          <t><xref target="fig.Size.CCNx.interest.compressed" format="default"/> 
	  depicts the size requirements after compression.</t>
          <figure anchor="fig.Size.CCNx.interest.compressed">
            <name>Estimated Size of a Compressed CCNx Interest</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
------------------------------------,
Dispatch Page Switch    = 1         |
CCNx Interest Dispatch  = 2         |
Fixed Header            = 3         |
-----------------------,            |
Name                   |             = 38 + n/2 + comps_n
  NameSegments          = n/2 +     |
                       |  comps_n   |
-----------------------'            |
T_SHA-256               = 32        |
------------------------------------'
]]></artwork>
          </figure>
          <t>The size difference is 18 + 3.5n bytes.</t>
          <t>For the name <tt>/DE/HH/HAW/BT7</tt>, the size
          is reduced by 53 bytes, which is 53% of the uncompressed
          packet.</t>
        </section>
        <section numbered="true" toc="default">
          <name>Content Object</name>
          <t><xref target="fig.Size.CCNx.Data.uncompressed" format="default"/> 
	  depicts the size
          requirements for a basic, uncompressed CCNx Content Object
          containing an ExpiryTime Message TLV, an HMAC_SHA-256 signature, the
          signature time, and a hash of the shared secret key. In the fixed
          header, the protocol version is assumed to be 1 and the Reserved
          field is assumed to be 0</t>
          <figure anchor="fig.Size.CCNx.Data.uncompressed">
            <name>Estimated Size of an Uncompressed CCNx Content Object</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
------------------------------------,
Fixed Header            = 8         |
Message                 = 4         |
  ---------------------,            |
  Name                 |  4 +       |
    NameSegments        = 4n +      |
                       |  comps_n   |
  ---------------------'            |
  ExpiryTime            = 12         = 124 + 4n + comps_n + clen
  Payload               = 4 + clen  |
  ---------------------,            |
  ValidationAlgorithm  |            |
    T_HMAC-256          = 56        |
      KeyID            |            |
    SignatureTime      |            |
  ---------------------'            |
  ValidationPayload     = 36        |
------------------------------------'
]]></artwork>
          </figure>
          <t><xref target="fig.Size.CCNx.Data.compressed" format="default"/> 
	  depicts the size
          requirements for a basic, compressed CCNx Data.</t>
          <figure anchor="fig.Size.CCNx.Data.compressed">
            <name>Estimated Size of a Compressed CCNx Data Object</name>
<artwork align="center" name="" type="" alt=""><![CDATA[
------------------------------------,
Dispatch Page Switch    = 1         |
CCNx Content Dispatch   = 3         |
Fixed Header            = 2         |
-----------------------,            |
Name                   |            |
  NameSegments          = n/2 +     |
                       |  comps_n    = 89 + n/2 + comps_n + clen
-----------------------'            |
ExpiryTime              = 8         |
Payload                 = 1 + clen  |
T_HMAC-SHA256           = 32        |
SignatureTime           = 8         |
ValidationPayload       = 34        |
------------------------------------'
]]></artwork>
          </figure>
          <t>The size difference is  35 + 3.5n bytes.</t>
          <t>For the name <tt>/DE/HH/HAW/BT7</tt>, the size
          is reduced by 70 bytes, which is 40% of the uncompressed packet
          containing a 4-byte payload.</t>
        </section>
      </section>
    </section>
    <section numbered="false" toc="default">
      <name>Acknowledgments</name>
      <t>This work was stimulated by fruitful discussions in the ICNRG
      and the communities of RIOT and CCNlite. We would like to
      thank all active members for constructive thoughts and feedback. In
      particular, the authors would like to thank (in alphabetical order)
      <contact fullname="Peter Kietzmann"/>, <contact fullname="Dirk Kutscher"/>, 
      <contact fullname="Martine Lenders"/>, <contact fullname="Colin Perkins"/>, 
      and <contact fullname="Junxiao Shi"/>. The
      hop-wise stateful name compression was brought up in a discussion by
      <contact fullname="Dave Oran"/>, which is gratefully acknowledged. 
      Larger parts of this work
      are inspired by <xref target="RFC4944" format="default"/> and 
      <xref target="RFC6282" format="default"/>.
      Special mention goes to <contact fullname="Mark Mosko"/>, as well as 
      <contact fullname="G.Q. Wang"/> and <contact fullname="Ravi Ravindran"/>, 
      as their previous work in <xref target="TLV-ENC-802.15.4" format="default"/>
      and <xref target="WIRE-FORMAT-CONSID" format="default"/> provided a good base for our
      discussions on stateless header compression mechanisms.
      Many thanks also to <contact fullname="Carsten Bormann"/> and 
      <contact fullname="Lars Eggert"/>, who contributed in-depth comments during 
      the IRSG review.
      This work was supported in part by the German Federal Ministry of Research and
      Education within the projects I3 and RAPstore.</t>
    </section>
  </back>
</rfc>
