<?xml version='1.0' encoding='utf-8'?>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
<!DOCTYPE rfc SYSTEM "rfc2629-xhtml.ent">

<rfc xmlns:xi="http://www.w3.org/2001/XInclude" ipr="trust200902"
     category="std" updates="4855" number="8851" submissionType="IETF"
     consensus="true" obsoletes="" xml:lang="en" tocInclude="true"
     sortRefs="true" symRefs="true" version="3"
     docName="draft-ietf-mmusic-rid-15">

  <!-- xml2rfc v2v3 conversion 2.30.0 -->
  <front>
    <title abbrev="RTP Restrictions">RTP Payload Format Restrictions</title>
    <seriesInfo name="RFC" value="8851"/>
    <author initials="A.B." surname="Roach" fullname="Adam Roach" role="editor">
      <organization>Mozilla</organization>
      <address>
        <email>adam@nostrum.com</email>
      </address>
    </author>
    <date month="January" year="2021"/>

    <keyword>WebRTC</keyword>
    <keyword>Multiplexing</keyword>
    <abstract>
      <t>In this specification, we define a framework for specifying restrictions
on RTP streams in the Session Description Protocol (SDP).
This framework defines a new "rid" ("restriction identifier") SDP attribute to
unambiguously identify the RTP streams within an RTP session and restrict the
streams' payload format parameters in a codec-agnostic way beyond what is
provided with the regular payload types.</t>
      <t>This specification updates RFC 4855 to give additional guidance on choice of
Format Parameter (fmtp) names and their relation to the restrictions
defined by this document.</t>
    </abstract>
  </front>
  <middle>
    <section anchor="terminology" numbered="true" toc="default">
      <name>Terminology</name>
      <t>The terms "source RTP stream", "endpoint", "RTP session", and "RTP stream"
are used as defined in <xref target="RFC7656" format="default"/>.</t>
      <t><xref target="RFC4566" format="default"/> and <xref target="RFC3264" format="default"/> terminology is also used where appropriate.</t>
    </section>
    <section anchor="sec-intro" numbered="true" toc="default">
      <name>Introduction</name>
      <t>The payload type (PT) field in RTP provides a mapping between the RTP payload
format and the associated SDP media description. For a given PT, the SDP
rtpmap and/or fmtp attributes are used to describe the properties of
the media that is carried in the RTP payload.</t>
      <t>Recent advances in standards have given rise to rich
multimedia applications requiring support for either multiple RTP streams within an
RTP session <xref target="RFC8843" format="default"/> <xref target="RFC8853" format="default"/> or a
large number of codecs.
These demands have unearthed challenges inherent with:</t>
      <ul spacing="normal">
        <li>The restricted RTP PT space in specifying the various payload
configurations</li>
        <li>The codec-specific constructs for the payload formats in SDP</li>
        <li>Missing or underspecified payload format parameters</li>
        <li>Overloading of PTs to indicate not just codec configurations, but
individual streams within an RTP session</li>
      </ul>
      <t>To expand on these points: <xref target="RFC3550" format="default"/>
      assigns 7 bits for the PT in the RTP header.  However, the assignment of
      static mapping of RTP payload type numbers to payload formats and
      multiplexing of RTP with other protocols (such as the RTP Control
      Protocol (RTCP)) could result in a limited number of payload type
      numbers available for application usage. In scenarios where the number
      of possible RTP payload configurations exceeds the available PT space
      within an RTP session, there is a need for a way to represent the
      additional restrictions on payload configurations and effectively map an
      RTP stream to its corresponding restrictions. This issue is exacerbated
      by the increase in techniques -- such as simulcast and layered codecs --
      that introduce additional streams into RTP sessions.</t>
      <t>This specification defines a new SDP framework for restricting source RTP
streams (Section 2.1.10 of <xref target="RFC7656" format="default"/>), along with
the SDP attributes to restrict payload formats in a codec-agnostic way.
This framework can be thought of as a complementary extension to the way
the media format parameters are specified in SDP today, via the "a=fmtp"
attribute.</t>
      <t>The additional restrictions on individual streams are indicated with a new
"a=rid" ("restriction identifier") SDP attribute. Note that the restrictions communicated via this
attribute only serve to further restrict the parameters that are established
on a PT format. They do not relax any restrictions imposed by other mechanisms.</t>
      <t>This specification makes use of the RTP Stream Identifier Source Description
(SDES) RTCP item defined in <xref target="RFC8852" format="default"/>  to provide correlation
between the RTP packets and their format specification in the SDP.</t>
      <t>As described in <xref target="sec-rid_unaware" format="default"/>, this mechanism achieves backwards
compatibility via the normal SDP processing rules, which require unknown "a="
lines to be ignored. This means that implementations need to be prepared
to handle successful offers and answers from other implementations that
neither indicate nor honor the restrictions requested by this mechanism.</t>
      <t>Further, as described in <xref target="sec-sdp_o_a" format="default"/> and its subsections, this mechanism
achieves extensibility by: (a) having offerers include all supported
restrictions in their offer, and (b) having answerers ignore "a=rid" lines that
specify unknown restrictions.</t>
    </section>
    <section anchor="key-words-for-requirements" numbered="true" toc="default">
      <name>Key Words for Requirements</name>
      <t>
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL
    NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP&nbsp;14 <xref target="RFC2119" format="default"/> <xref target="RFC8174" format="default"/> 
    when, and only when, they appear in all capitals, as shown here.
      </t>
    </section>
    <section anchor="sec-rid_attribute" numbered="true" toc="default">
      <name>SDP "a=rid" Media Level Attribute</name>
      <t>This section defines new SDP media-level attribute <xref
      target="RFC4566" format="default"/>, "a=rid",
used to communicate a set of restrictions to be
applied to an identified RTP stream.  Roughly speaking, this attribute takes
the following form (see <xref target="sec-abnf" format="default"/> for a
formal definition):</t>

<sourcecode type="sdp"><![CDATA[
a=rid:<rid-id> <direction> [pt=<fmt-list>;]<restriction>=<value>...
]]></sourcecode>

      <t>An "a=rid" SDP media attribute specifies restrictions defining a unique
RTP payload configuration identified via the "rid-id" field. This
value binds the restriction to the RTP stream identified by its RTP
Stream Identifier Source Description (SDES) item <xref target="RFC8852" format="default"/>.
Implementations that use the "a=rid" parameter in SDP <bcp14>MUST</bcp14> support
the RtpStreamId SDES item described in <xref target="RFC8852" format="default"/>. Such
implementations <bcp14>MUST</bcp14> send that SDES item for all streams in an SDP media description
("m=") that have "a=rid" lines remaining after applying the rules in
<xref target="sec-sdp_o_a" format="default"/> and its subsections.</t>
      <t>Implementations that use the "a=rid" parameter in SDP and make use of
redundancy RTP streams <xref target="RFC7656" format="default"/> -- e.g., RTP RTX
<xref target="RFC4588" format="default"/> or Forward Error Correction (FEC) <xref target="RFC5109" format="default"/> -- for any of the
source RTP streams that have "a=rid" lines remaining
after applying the rules in <xref target="sec-sdp_o_a" format="default"/> and its subsections <bcp14>MUST</bcp14>
support the RepairedRtpStreamId SDES item described in
<xref target="RFC8852" format="default"/> for those redundancy RTP streams. RepairedRtpStreamId
<bcp14>MUST</bcp14> be used for redundancy RTP streams to which it can be applied.

Use of RepairedRtpStreamId is not applicable for
redundancy formats that directly associate RTP streams
through shared synchronization sources (SSRCs) -- for example, <xref
target="RFC8627" format="default"/> --
or other cases that RepairedRtpStreamId cannot support, such as referencing
multiple source streams.</t>
      <t>RepairedRtpStreamId is used to provide the binding between the redundancy RTP
stream and its source RTP stream by setting the RepairedRtpStreamId value for
the redundancy RTP stream to the RtpStreamId value of the source RTP stream.
The redundancy RTP stream <bcp14>MAY</bcp14> (but need not) have an "a=rid" line of its own,
in which case the RtpStreamId SDES item value will be different from the
corresponding source RTP stream.</t>
      <t>It is important to note that this indirection may result in the temporary
inability to correctly associate source and redundancy data when the SSRC
associated with the RtpStreamId or RepairedRtpStreamId is dynamically changed
during the RTP session.  This can be avoided if all RTP packets, source and
repair, include their RtpStreamId or RepairedRtpStreamId,
respectively, after the change.  To maximize the probability of reception and utility of
redundancy information after such a change, all the source packets referenced
by the first several repair packets <bcp14>SHOULD</bcp14> include such information.  It is
<bcp14>RECOMMENDED</bcp14> that the number of such packets is large enough to give a high
probability of actual updated association. Section 4.1.1 of <xref target="RFC8285" format="default"/>
provides relevant guidance for RTP header extension transmission
considerations.  Alternatively, to avoid this issue, redundancy mechanisms
that directly reference its source data may be used, such as
<xref target="RFC8627" format="default"/>.</t>
      <t>The "direction" field identifies the direction of the RTP stream packets to
which the indicated restrictions are applied. It may be either "send" or
"recv". Note that these restriction directions are expressed independently of
any "inactive", "sendonly", "recvonly", or "sendrecv" attributes associated
with the media section.  It is, for example, valid to indicate "recv"
restrictions on a "sendonly" stream; those restrictions would apply if, at a
future point in time, the stream were changed to "sendrecv" or "recvonly".</t>
      <t>The optional "pt=&lt;fmt-list&gt;" lists one or more PT values that can be used
in the associated RTP stream. If the "a=rid" attribute contains
no "pt", then any of the PT values specified in the corresponding "m="
line may be used.</t>
      <t>The list of zero or more codec-agnostic restrictions
(<xref target="sec-rid_level_restrictions" format="default"/>) describes the restrictions that the
corresponding RTP stream will conform to.</t>
      <t>This framework <bcp14>MAY</bcp14> be used in combination with the "a=fmtp" SDP attribute
for describing the media format parameters for a given RTP payload type.  In
such scenarios, the "a=rid" restrictions (<xref target="sec-rid_level_restrictions" format="default"/>)
further restrict the equivalent "a=fmtp" attributes.</t>
      <t>A given SDP media description <bcp14>MAY</bcp14> have zero or more "a=rid" lines describing
various possible RTP payload configurations. A given "rid-id" <bcp14>MUST NOT</bcp14>
be repeated in a given media description ("m=" section).</t>
      <t>The "a=rid" media attribute <bcp14>MAY</bcp14> be used for any RTP-based media transport.  It
is not defined for other transports, although other documents may extend its
semantics for such transports.</t>
      <t>Though the restrictions specified by the "rid" restrictions follow a
syntax similar to session-level and media-level parameters, they are defined
independently.  All "rid" restrictions <bcp14>MUST</bcp14> be registered with IANA, using
the registry defined in <xref target="sec-iana" format="default"/>.</t>
      <t><xref target="sec-abnf" format="default"/> gives a formal Augmented Backus-Naur Form (ABNF) <xref target="RFC5234" format="default"/>
grammar for the "rid" attribute. The "a=rid" media attribute is not dependent
on charset.</t>
    </section>
    <section anchor="sec-rid_level_restrictions" numbered="true" toc="default">
      <name>"a=rid" Restrictions</name>

      <t>
This section defines the "a=rid" restrictions that can be used to restrict the
RTP payload encoding format in a codec-agnostic way. Please also see 
the preceding section for a description of how the "pt" parameter is used.
      </t>

      <t>The following restrictions are intended to apply to video codecs in a
codec-independent fashion.</t>
      <ul spacing="normal">
        <li><strong>max-width</strong>, for spatial resolution in pixels.  In the case that
  stream-orientation signaling is used to modify the intended display
  orientation, this attribute refers to the width of the stream when a
  rotation of zero degrees is encoded.</li>
        <li><strong>max-height</strong>, for spatial resolution in pixels.  In the case that
  stream-orientation signaling is used to modify the intended display
  orientation,
this attribute refers to the height of the stream when a rotation of zero
degrees is encoded.</li>
        <li><strong>max-fps</strong>, for frame rate in frames per second.  For encoders that do not use
a fixed frame rate for encoding, this value is used to restrict the minimum
amount of time between frames: the time between any two consecutive frames
<bcp14>SHOULD NOT</bcp14> be less than 1/max-fps seconds.</li>
        <li><strong>max-fs</strong>, for frame size in pixels per frame. This is the product of frame
width and frame height, in pixels, for rectangular frames.</li>
        <li><strong>max-br</strong>, for bitrate in bits per second.  The restriction applies to the
media payload only and does not include overhead introduced by other layers
(e.g., RTP, UDP, IP, or Ethernet).  The exact means of keeping within this
limit are left up to the implementation, and instantaneous excursions
outside the limit are permissible. For any given one-second sliding window,
however, the total number of bits in the payload portion of RTP <bcp14>SHOULD NOT</bcp14>
exceed the value specified in "max-br."</li>
        <li><strong>max-pps</strong>, for pixel rate in pixels per second.  This value <bcp14>SHOULD</bcp14> be handled
identically to max-fps, after performing the following conversion: max-fps =
max-pps / (width * height). If the stream resolution changes, this value is
recalculated. Due to this recalculation, excursions outside the specified
maximum are possible near resolution-change boundaries.</li>
        <li><strong>max-bpp</strong>, for maximum number of bits per pixel, calculated as an average of
all samples of any given coded picture. This is expressed as
a floating point value, with an allowed range of 0.0001 to 48.0. These
values <bcp14>MUST NOT</bcp14> be encoded with more than four digits to the right of the
decimal point.</li>
        <li><strong>depend</strong>, to identify other streams that the stream depends on. The value
is a comma-separated list of rid-ids. These rid-ids identify RTP streams
that this stream depends on in order to allow for proper interpretation.
The mechanism defined in this document allows for such dependencies
to be expressed only when the streams are in the same media section.</li>
      </ul>
      <t>All the restrictions are optional and subject to negotiation based on the
SDP offer/answer rules described in <xref target="sec-sdp_o_a" format="default"/>.</t>
      <t>This list is intended to be an initial set of restrictions. Future documents
may define additional restrictions; see <xref target="sec-iana_rid" format="default"/>.  While this document
does not define restrictions for audio codecs or any media types other than
video, there is no reason such
restrictions should be precluded from definition and registration by other
documents.</t>
      <t><xref target="sec-abnf" format="default"/> provides formal Augmented Backus-Naur Form (ABNF) <xref target="RFC5234" format="default"/>
grammar for each of the "a=rid" restrictions defined in this section.</t>
    </section>
    <section anchor="sec-sdp_o_a" numbered="true" toc="default">
      <name>SDP Offer/Answer Procedures</name>
      <t>This section describes the SDP offer/answer procedures <xref target="RFC3264" format="default"/> when
using this framework.</t>
      <t>Note that "rid-id" values are only required to be unique within a
media section ("m=" line); they do not necessarily need to be unique within an
entire RTP session. In traditional usage, each media section is sent on its
own unique 5-tuple (that is: combination of sending address, sending port,
receiving address, receiving port, and transport protocol), which provides an
unambiguous scope. 

Similarly, when using BUNDLE <xref target="RFC8843" format="default"/>,
Media Identification (MID) values associate RTP streams
uniquely to a single media description.

 When restriction identifier (RID) is used with the BUNDLE
mechanism, streams will be associated with both MID and RID SDES items.</t>
      <section anchor="sec-gen_offer" numbered="true" toc="default">
        <name>Generating the Initial SDP Offer</name>
        <t>For each RTP media description in the offer, the offerer <bcp14>MAY</bcp14> choose to include one
or more "a=rid" lines to specify a configuration profile for the given set of
RTP payload types.</t>
        <t>In order to construct a given "a=rid" line, the offerer must follow these
steps:</t>
        <ol spacing="normal" type="1">
          <li>It <bcp14>MUST</bcp14> generate a "rid-id" that is unique within a media
description.</li>
          <li>It <bcp14>MUST</bcp14> set the direction for the "rid-id" to one of
"send" or "recv".</li>
          <li>It <bcp14>MAY</bcp14> include a listing of SDP media formats (usually corresponding to RTP
payload types) allowed to appear in the RTP stream. Any payload type
chosen <bcp14>MUST</bcp14> be a valid payload type for the media section (that is, it must
be listed on the "m=" line).  The order of the listed formats is
significant; the alternatives are listed from (left) most preferred to
(right) least preferred.  When using RID, this preference overrides the
normal codec preference as expressed by format type ordering on the
"m=" line, using regular SDP rules.</li>
          <li>The offerer then chooses zero or more "a=rid" restrictions
(<xref target="sec-rid_level_restrictions" format="default"/>) to be applied to the RTP stream and
adds them to the "a=rid" line.</li>
          <li>If the offerer wishes the answerer to have the ability to specify a
restriction but does not wish to set a value itself, it includes the
name of the restriction in the "a=rid" line, but without any indicated
value.</li>
        </ol>
        <t>Note: If an "a=fmtp" attribute is also used to provide media-format-specific
parameters, then the "a=rid" restrictions will further restrict the
equivalent "a=fmtp" parameters for the given payload type for the specified
RTP stream.</t>
        <t>If a given codec would require an "a=fmtp" line when used without "a=rid", then
the offer <bcp14>MUST</bcp14> include a valid corresponding "a=fmtp" line even when using
"a=rid".</t>
      </section>
      <section anchor="answerer-processing-the-sdp-offer" numbered="true" toc="default">
        <name>Answerer Processing the SDP Offer</name>
        <section anchor="sec-rid_unaware" numbered="true" toc="default">
          <name>"a=rid"-Unaware Answerer</name>
          <t>If the receiver doesn't support the framework defined in this
specification, the entire "a=rid" line is ignored following the standard
offer/answer rules <xref target="RFC3264" format="default"/>.</t>
          <t><xref target="sec-gen_offer" format="default"/> requires the offer to include a valid "a=fmtp" line
for any media formats that otherwise require it (in other words, the "a=rid"
line cannot be used to replace "a=fmtp" configuration). As a result,
ignoring the "a=rid" line is always guaranteed to result in a valid
session description.</t>
        </section>
        <section anchor="sec-rid_offer_recv" numbered="true" toc="default">
          <name>"a=rid"-Aware Answerer</name>
          <t>If the answerer supports the "a=rid" attribute, the following verification
steps are executed, in order, for each "a=rid" line in a received offer:</t>
          <ol spacing="normal" type="1">
            <li>The answerer ensures that the "a=rid" line is syntactically well
formed. In the case of a syntax error, the "a=rid" line is discarded.</li>
            <li>The answerer extracts the rid-id from the "a=rid" line and verifies its
uniqueness within a media section.  In the case of a duplicate, the entire
"a=rid" line, and all "a=rid" lines with rid-ids that duplicate this line,
are discarded and <bcp14>MUST NOT</bcp14> be included in the SDP answer.</li>
            <li>If the "a=rid" line contains a "pt=", the list of payload types
is verified against the list of valid payload types for the media section
(that is, those listed on the "m=" line). Any PT missing from the "m=" line
is discarded from the set of values in the "pt=". If no values are left
in the "pt=" parameter after this processing, then the "a=rid" line is discarded.</li>
            <li>If the "direction" field is "recv", the answerer ensures that the specified
"a=rid" restrictions are supported.  In the case of an unsupported
restriction, the "a=rid" line is discarded.</li>
            <li>If the "depend" restriction is included, the answerer <bcp14>MUST</bcp14> make
sure that the listed rid-ids unambiguously match the
rid-ids in the media description.  Any "depend" "a=rid" lines that do not are
discarded.</li>
            <li>The answerer verifies that the restrictions are consistent
with at least one of the codecs to be used with the RTP stream. If the
"a=rid" line contains a "pt=", it contains the list of such
codecs; otherwise, the list of such codecs is taken from the associated
"m=" line.  See <xref target="sec-feature_interactions" format="default"/> for more detail. If the
"a=rid" restrictions are incompatible with the other codec properties
for all codecs, then the "a=rid" line is discarded.</li>
          </ol>
          <t>Note that the answerer does not need to understand every restriction present
in a "send" line: if a stream sender restricts the stream in a way that the
receiver does not understand, this causes no issues with interoperability.</t>
        </section>
      </section>
      <section anchor="sec-rid_answer_send" numbered="true" toc="default">
        <name>Generating the SDP Answer</name>
        <t>Having performed verification of the SDP offer as described in
<xref target="sec-rid_offer_recv" format="default"/>, the answerer shall perform the following steps to
generate the SDP answer.</t>
        <t>For each "a=rid" line that has not been discarded by previous processing:</t>
        <ol spacing="normal" type="1">
          <li>The value of the "direction" field is reversed: "send" is changed
to "recv", and "recv" is changed to "send".</li>
          <li>The answerer <bcp14>MAY</bcp14> choose to modify specific "a=rid" restriction values in
the answer SDP. In such a case, the modified value <bcp14>MUST</bcp14> be more restrictive
than the ones specified in the offer.  The answer <bcp14>MUST NOT</bcp14> include any
restrictions that were not present in the offer.</li>
          <li>The answerer <bcp14>MUST NOT</bcp14> modify the "rid-id" present in the offer.</li>
          <li>If the "a=rid" line contains a "pt=", the answerer is allowed to
discard one or more media formats from a given "a=rid" line. If the answerer
chooses to discard all the media formats from an "a=rid" line, the
answerer <bcp14>MUST</bcp14> discard the entire "a=rid" line. If the offer did not contain
a "pt=" for a given "a=rid" line, then the answer <bcp14>MUST NOT</bcp14>
contain a "pt=" in the corresponding line.</li>
          <li>In cases where the answerer is unable to support the payload configuration
specified in a given "a=rid" line with a direction of "recv" in the offer,
the answerer <bcp14>MUST</bcp14> discard the corresponding "a=rid" line.  This includes
situations in which the answerer does not understand one or more of the
restrictions in an "a=rid" line with a direction of "recv".</li>
        </ol>
        <t>Note: In the case that the answerer uses different PT values to represent a
codec than the offerer did, the "a=rid" values in the answer use the PT values
that are present in its answer.</t>
      </section>
      <section anchor="sec-rid_answer_recv" numbered="true" toc="default">
        <name>Offerer Processing of the SDP Answer</name>
        <t>The offerer <bcp14>SHALL</bcp14> follow these steps when processing the answer:</t>
        <ol spacing="normal" type="1">
          <li>The offerer matches the "a=rid" line in the answer to the "a=rid" line
in the offer using the "rid-id". If no matching line can be located
in the offer, the "a=rid" line is ignored.</li>
          <li>If the answer contains any restrictions that were not present in the offer,
then the offerer <bcp14>SHALL</bcp14> discard the "a=rid" line.</li>
          <li>If the restrictions have been changed between the offer and the
answer, the offerer <bcp14>MUST</bcp14> ensure that the modifications are more restrictive
than they were in the original offer and that they can be supported; if
not, the offerer <bcp14>SHALL</bcp14> discard the "a=rid" line.</li>
          <li>If the "a=rid" line in the answer contains a "pt=" but the
offer did not, the offerer <bcp14>SHALL</bcp14> discard the "a=rid" line.</li>
          <li>If the "a=rid" line in the answer contains a "pt=" and the
offer did as well, the offerer verifies that the list of payload types is a
subset of those sent in the corresponding "a=rid" line in the offer. Note
that this matching must be performed semantically rather than on literal PT
values, as the remote end may not be using symmetric PTs. For the purpose
of this comparison: for each PT listed on the "a=rid" line in the answer,
the offerer looks up the corresponding "a=rtpmap" and "a=fmtp" lines in the
answer.  It then searches the list of "pt=" values indicated in the offer
and attempts to find one with an equivalent set of "a=rtpmap" and "a=fmtp"
lines in the offer. If all PTs in the answer can be matched, then the "pt="
values pass validation; otherwise, it fails.  If this validation fails, the
offerer <bcp14>SHALL</bcp14> discard the "a=rid" line. Note that this semantic comparison
necessarily requires an understanding of the meaning of codec parameters,
rather than a rote byte-wise comparison of their values.</li>
          <li>If the "a=rid" line contains a "pt=", the offerer verifies that
the attribute values provided in the "a=rid" attributes are consistent
with the corresponding codecs and their other parameters. See
<xref target="sec-feature_interactions" format="default"/> for more detail. If the "a=rid" restrictions
are incompatible with the other codec properties, then the offerer
<bcp14>SHALL</bcp14> discard the "a=rid" line.</li>
          <li>The offerer verifies that the restrictions are consistent
with at least one of the codecs to be used with the RTP stream. If the
"a=rid" line contains a "pt=", it contains the list of such
codecs; otherwise, the list of such codecs is taken from the associated
"m=" line.  See <xref target="sec-feature_interactions" format="default"/> for more detail. If the
"a=rid" restrictions are incompatible with the other codec properties
for all codecs, then the offerer <bcp14>SHALL</bcp14> discard the "a=rid" line.</li>
        </ol>
        <t>Any "a=rid" line present in the offer that was not matched by step 1 above
has been discarded by the answerer and does not form part of the negotiated
restrictions on an RTP stream. The offerer <bcp14>MAY</bcp14> still apply any restrictions
it indicated in an "a=rid" line with a direction field of "send", but
it is not required to do so.</t>
        <t>It is important to note that there are several ways in which an offer can
contain a media section with "a=rid" lines, although the corresponding media
section in the response does not. This includes situations in which the
answerer does not support "a=rid" at all or does not support the indicated
restrictions. Under such circumstances, the offerer <bcp14>MUST</bcp14> be prepared to
receive a media stream to which no restrictions have been applied.</t>
      </section>
      <section anchor="modifying-the-session" numbered="true" toc="default">
        <name>Modifying the Session</name>
        <t>Offers and answers inside an existing session follow the rules for initial
session negotiation.  Such an offer <bcp14>MAY</bcp14> propose a change in the number of RIDs
in use. To avoid race conditions with media, any RIDs with proposed changes
<bcp14>SHOULD</bcp14> use a new ID rather than reusing one from the previous offer/answer
exchange. RIDs without proposed changes <bcp14>SHOULD</bcp14> reuse the ID from the previous
exchange.</t>
      </section>
    </section>
    <section anchor="sec-declarative_sdp" numbered="true" toc="default">
      <name>Use with Declarative SDP</name>
      <t>This document does not define the use of a RID in declarative SDP. If
concrete use cases for RID in declarative SDP use are identified
in the future, we expect that additional specifications will address
such use.</t>
    </section>
    <section anchor="sec-feature_interactions" numbered="true" toc="default">
      <name>Interaction with Other Techniques</name>
      <t>Historically, a number of other approaches have been defined that allow
restricting media streams via SDP. These include:</t>
      <ul spacing="normal">
        <li>Codec-specific configuration set via format parameters ("a=fmtp") -- for
example, the H.264 "max-fs" format parameter <xref target="RFC6184" format="default"/></li>
        
        <li>Size restrictions imposed by the "a=imageattr" attribute
<xref target="RFC6236" format="default"/></li>
      </ul>
      <t>When the mechanism described in this document is used in conjunction with
these other restricting mechanisms, it is intended to impose additional
restrictions beyond those communicated in other techniques.</t>
      <t>In an offer, this means that "a=rid" lines, when combined with other
restrictions on the media stream, are expected to result in a non-empty intersection.
For example, if image attributes are used to indicate that a PT has a minimum
width of 640, then specification of "max-width=320" in an "a=rid" line that is
then applied to that PT is nonsensical. According to the rules of
<xref target="sec-rid_offer_recv" format="default"/>, this will result in the corresponding "a=rid" line
being ignored by the recipient.</t>
      <t>In an answer, the "a=rid" lines, when combined with the other
restrictions on the media stream, are also expected to result in a non-empty
intersection. If the implementation generating an answer wishes to restrict a
property of the stream below that which would be allowed by other parameters
(e.g., those specified in "a=fmtp" or "a=imageattr"), its only recourse is to
discard the "a=rid" line altogether, as described in <xref target="sec-rid_answer_send" format="default"/>.
If it instead attempts to restrict the stream beyond what is allowed by other
mechanisms, then the offerer will ignore the corresponding "a=rid" line, as
described in <xref target="sec-rid_answer_recv" format="default"/>.</t>
      <t>The following subsections demonstrate these interactions using commonly used
video codecs. These descriptions are illustrative of the interaction principles
outlined above and are not normative.</t>
      <section anchor="interaction-with-vp8-format-parameters" numbered="true" toc="default">
        <name>Interaction with VP8 Format Parameters</name>
        <t><xref target="RFC7741" format="default"/> defines two format parameters for the VP8 codec.
Both correspond to restrictions on receiver capabilities and never
indicate sending restrictions.</t>
        <section anchor="max-fr-maximum-framerate" numbered="true" toc="default">
          <name>max-fr - Maximum Frame Rate</name>
          <t>The VP8 "max-fr" format parameter corresponds to the "max-fps" restriction
defined in this specification.  If an RTP sender is generating a stream using
a format defined with this format parameter, and the sending restrictions
defined via "a=rid" include a "max-fps" parameter, then the sent stream
will conform to the smaller of the two values.</t>
        </section>
        <section anchor="max-fs-maximum-framesize-in-vp8-macroblocks" numbered="true" toc="default">
          <name>max-fs - Maximum Frame Size, in VP8 Macroblocks</name>
          <t>The VP8 "max-fs" format parameter corresponds to the "max-fs"
restriction defined in this document, by way of a conversion factor of the
number of pixels per macroblock (typically 256).  If an RTP sender is
generating a stream using a format defined with this format parameter, and
the sending restrictions defined via "a=rid" include a "max-fs" parameter,
then the sent stream will conform to the smaller of the two values;
that is, the number of pixels per frame will not exceed:</t>

<sourcecode>
  min(rid_max_fs, fmtp_max_fs * macroblock_size)
</sourcecode>
          <t>This fmtp parameter also has bearing on the
max-height and max-width parameters.  

<xref section="6.1" sectionFormat="of" target="RFC7741" format="default"/> requires that the width and height of the frame in
macroblocks be less than int(sqrt(fmtp_max_fs * 8)).
Accordingly, the maximum width of a transmitted stream will be limited to:</t>

<sourcecode>
  min(rid_max_width, int(sqrt(fmtp_max_fs * 8)) * macroblock_width)
</sourcecode>

          <t>Similarly, the stream's height will be limited to:</t>

<sourcecode>
  min(rid_max_height, int(sqrt(fmtp_max_fs * 8)) * macroblock_height)
</sourcecode>
        </section>
      </section>
      <section anchor="interaction-with-h264-format-parameters" numbered="true" toc="default">
        <name>Interaction with H.264 Format Parameters</name>
        <t><xref target="RFC6184" format="default"/> defines format parameters for the H.264 video codec. The majority
of these parameters do not correspond to codec-independent restrictions:</t>
        <ul spacing="normal">
          <li>deint-buf-cap</li>
          <li>in-band-parameter-sets</li>
          <li>level-asymmetry-allowed</li>
          <li>max-rcmd-nalu-size</li>
          <li>max-cpb</li>
          <li>max-dpb</li>
          <li>packetization-mode</li>
          <li>redundant-pic-cap</li>
          <li>sar-supported</li>
          <li>sar-understood</li>
          <li>sprop-deint-buf-req</li>
          <li>sprop-init-buf-time</li>
          <li>sprop-interleaving-depth</li>
          <li>sprop-level-parameter-sets</li>
          <li>sprop-max-don-diff</li>
          <li>sprop-parameter-sets</li>
          <li>use-level-src-parameter-sets</li>
        </ul>
        <t>Note that the max-cpb and max-dpb format parameters for H.264 correspond to
restrictions on the stream, but they are specific to the way the H.264 codec
operates, and do not have codec-independent equivalents.</t>
        <t>The <xref target="RFC6184" format="default"/> codec format parameters covered in the following sections
correspond to restrictions on receiver capabilities and never indicate
sending restrictions.</t>
        <section anchor="profile-level-id-and-max-recv-level-negotiated-sub-profile" numbered="true" toc="default">
          <name>profile-level-id and max-recv-level - Negotiated Subprofile</name>
          <t>These parameters include a "level" indicator, which acts as an index
into Table A-1 of <xref target="H264" format="default"/>. This table contains a number of parameters,
several of which correspond to the restrictions defined in this
document. <xref target="RFC6184" format="default"/> also defines format parameters for the H.264
codec that may increase the maximum values indicated by the negotiated
level. The following sections describe the interaction between these
parameters and the restrictions defined by this document. In all cases,
the H.264 parameters being discussed are the maximum of those indicated
by <xref target="H264" format="default"/> Table A-1 and those indicated in the corresponding "a=fmtp" line.</t>
        </section>
        <section anchor="max-br-maxbr-maximum-video-bitrate" numbered="true" toc="default">
          <name>max-br / MaxBR - Maximum Video Bitrate</name>
          <t>The H.264 "MaxBR" parameter (and its equivalent "max-br" format
parameter) corresponds to the "max-bps" restriction
defined in this specification, by way of a conversion factor of 1000
or 1200; see <xref target="RFC6184" format="default"/> for details regarding which factor gets
used under differing circumstances.</t>
          <t>If an RTP sender is generating a stream using
a format defined with this format parameter, and the sending restrictions
defined via "a=rid" include a "max-fps" parameter, then the sent stream
will conform to the smaller of the two values -- that is:</t>

<sourcecode>
  min(rid_max_br, h264_MaxBR * conversion_factor)
</sourcecode>
        </section>
        <section anchor="max-fs-maxfs-maximum-framesize-in-h264-macroblocks" numbered="true" toc="default">
          <name>max-fs / MaxFS - Maximum Frame Size, in H.264 Macroblocks</name>
          <t>The H.264 "MaxFs" parameter (and its equivalent "max-fs"
format parameter) corresponds roughly to the "max-fs" restriction
defined in this document, by way of a conversion factor of 256
(the number of pixels per macroblock).</t>
          <t>If an RTP sender is generating a stream using
a format defined with this format parameter, and the sending restrictions
defined via "a=rid" include a "max-fs" parameter, then the sent stream
will conform to the smaller of the two values -- that is:</t>
<sourcecode>
  min(rid_max_fs, h264_MaxFs * 256)
</sourcecode>
        </section>
        <section anchor="sec-h264_max_mbps" numbered="true" toc="default">
          <name>max-mbps / MaxMBPS - Maximum Macroblock Processing Rate</name>
          <t>The H.264 "MaxMBPS" parameter (and its equivalent "max-mbps"
format parameter) corresponds roughly to the "max-pps" restriction
defined in this document, by way of a conversion factor of 256
(the number of pixels per macroblock).</t>
          <t>If an RTP sender is generating a stream using
a format defined with this format parameter, and the sending restrictions
defined via "a=rid" include a "max-pps" parameter, then the sent stream
will conform to the smaller of the two values -- that is:</t>
          <sourcecode>
  min(rid_max_pps, h264_MaxMBPS * 256)
</sourcecode>
        </section>
        <section anchor="max-smbps-maximum-decoded-picture-buffer" numbered="true" toc="default">
          <name>max-smbps - Maximum Decoded Picture Buffer</name>
          <t>The H.264 "max-smbps" format parameter operates the same way as the
"max-mbps" format parameter, under the hypothetical assumption that all
macroblocks are static macroblocks. It is handled by applying the
conversion factor described in Section 8.1 of <xref target="RFC6184" format="default"/>, and the
result of this conversion is applied as described in
<xref target="sec-h264_max_mbps" format="default"/>.</t>
        </section>
      </section>
      <section anchor="redundancy-formats-and-payload-type-restrictions" numbered="true" toc="default">
        <name>Redundancy Formats and Payload Type Restrictions</name>
        <t><xref target="sec-rid_attribute" format="default"/> specifies that redundancy formats using redundancy RTP streams bind
the redundancy RTP stream to the source RTP stream with either the
RepairedRtpStreamId SDES item or other mechanisms.  However, there exist
redundancy RTP payload formats that result in the redundancy being included in
the source RTP stream. An example of this is "RTP Payload for Redundant Audio
Data" <xref target="RFC2198" format="default"/>, which encapsulates one source stream with one or more
redundancy streams in the same RTP payload. Formats defining the source and
redundancy encodings as regular RTP payload types require some consideration
for how the "a=rid" restrictions are defined. The "a=rid" line "pt=" parameter
can be used to indicate whether the redundancy RTP payload type and/or the
individual source RTP payload type(s) are part of the restriction.</t>
        <t>Example (SDP excerpt):</t>
        <sourcecode type="sdp">
   m=audio 49200 RTP/AVP 97 98 99 100 101 102
   a=mid:foo
   a=rtpmap:97 G711/8000
   a=rtpmap:98 LPC/8000
   a=rtpmap:99 OPUS/48000/1
   a=rtpmap:100 RED/8000/1
   a=rtpmap:101 CN/8000
   a=rtpmap:102 telephone-event/8000
   a=fmtp:99 useinbandfec=1; usedtx=0
   a=fmtp:100 97/98
   a=fmtp:102 0-15
   a=ptime:20
   a=maxptime:40
   a=rid:5 send pt=99,102;max-br=64000
   a=rid:6 send pt=100,97,101,102
</sourcecode>

        <t>The RID with ID=6 restricts the payload types for this RID to 100
        (the redundancy format), 97 (G.711), 101 (Comfort Noise), and 102
        (dual-tone multi-frequency (DTMF) tones). This means that RID 6 can
        either contain the Redundant Audio Data (RED) format, encapsulating
        encodings of the source media stream using payload type 97 and 98, 97
        without RED encapsulation, Comfort noise, or DTMF tones.  Payload type
        98 is not included in the RID, and can thus not be sent except as
        redundancy information in RED encapsulation. If 97 were to be excluded
        from the pt parameter, it would instead mean that payload types 97 and
        98 are only allowed via RED encapsulation.</t>
      </section>
    </section>
    <section anchor="format-parameters-for-future-payloads" numbered="true" toc="default">
      <name>Format Parameters for Future Payloads</name>
      <t>Registrations of future RTP payload format specifications that define media
types that have parameters matching the RID restrictions specified in this memo
<bcp14>SHOULD</bcp14> name those parameters in a manner that matches the names of those RID
restrictions and <bcp14>SHOULD</bcp14> explicitly state what media-type parameters are
restricted by what RID restrictions.</t>
    </section>
    <section anchor="sec-abnf" numbered="true" toc="default">
      <name>Formal Grammar</name>
      <t>This section gives a formal Augmented Backus-Naur Form (ABNF) <xref target="RFC5234" format="default"/>
grammar, with the case-sensitive extensions described in <xref target="RFC7405" format="default"/>, for each
of the new media and "a=rid" attributes defined in this document.</t>

      <sourcecode type="abnf"><![CDATA[ 
rid-syntax        = %s"a=rid:" rid-id SP rid-dir
                    [ rid-pt-param-list / rid-param-list ]

rid-id            = 1*(alpha-numeric / "-" / "_")

alpha-numeric     = < as defined in [RFC4566] >

rid-dir           = %s"send" / %s"recv"

rid-pt-param-list = SP rid-fmt-list *(";" rid-param)

rid-param-list    = SP rid-param *(";" rid-param)

rid-fmt-list      = %s"pt=" fmt *( "," fmt )

fmt               = < as defined in [RFC4566] >

rid-param         = rid-width-param
                    / rid-height-param
                    / rid-fps-param
                    / rid-fs-param
                    / rid-br-param
                    / rid-pps-param
                    / rid-bpp-param
                    / rid-depend-param
                    / rid-param-other

rid-width-param   = %s"max-width" [ "=" int-param-val ]

rid-height-param  = %s"max-height" [ "=" int-param-val ]

rid-fps-param     = %s"max-fps" [ "=" int-param-val ]

rid-fs-param      = %s"max-fs" [ "=" int-param-val ]

rid-br-param      = %s"max-br" [ "=" int-param-val ]

rid-pps-param     = %s"max-pps" [ "=" int-param-val ]

rid-bpp-param     = %s"max-bpp" [ "=" float-param-val ]

rid-depend-param  = %s"depend=" rid-list

rid-param-other   = 1*(alpha-numeric / "-") [ "=" param-val ]

rid-list          = rid-id *( "," rid-id )

int-param-val     = 1*DIGIT

float-param-val   = 1*DIGIT "." 1*DIGIT

param-val         = *(%x20-3A / %x3C-7E)
                    ; Any printable character except semicolon
]]></sourcecode>

    </section>
    <section anchor="sdp-examples" numbered="true" toc="default">
      <name>SDP Examples</name>
      <t>Note: See <xref target="RFC8853" format="default"/> for examples of RID used
in simulcast scenarios.</t>
      <section anchor="many-bundled-streams-using-many-codecs" numbered="true" toc="default">
        <name>Many Bundled Streams Using Many Codecs</name>
        <t>In this scenario, the offerer supports the Opus, G.722, G.711, and DTMF audio
codecs and VP8, VP9, H.264 (CBP/CHP, mode 0/1), H.264-SVC (SCBP/SCHP), and
H.265 (MP/M10P) for video. An 8-way video call (to a mixer) is supported (send
1 and receive 7 video streams) by offering 7 video media sections (1 sendrecv
at max resolution and 6 recvonly at smaller resolutions), all bundled on the
same port, using 3 different resolutions.  The resolutions include:</t>
        <ul spacing="normal">
          <li>1 receive stream of 720p resolution is offered for the active speaker.</li>
          <li>2 receive streams of 360p resolution are offered for the prior 2 active
speakers.</li>
          <li>4 receive streams of 180p resolution are offered for others in the call.</li>
        </ul>

        <t>NOTE: The SDP given below skips a few lines to
        keep the example short and focused, as indicated by either the "..."
        or the comments inserted.</t>
	<t>The offer for this scenario is shown
        below.</t>

        <sourcecode type="sdp">
...
m=audio 10000 RTP/SAVPF 96 9 8 0 123
a=rtpmap:96 OPUS/48000
a=rtpmap:9 G722/8000
a=rtpmap:8 PCMA/8000
a=rtpmap:0 PCMU/8000
a=rtpmap:123 telephone-event/8000
a=mid:a1
...
m=video 10000 RTP/SAVPF 98 99 100 101 102 103 104 105 106 107
a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
a=rtpmap:98 VP8/90000
a=fmtp:98 max-fs=3600; max-fr=30
a=rtpmap:99 VP9/90000
a=fmtp:99 max-fs=3600; max-fr=30
a=rtpmap:100 H264/90000
a=fmtp:100 profile-level-id=42401f; packetization-mode=0
a=rtpmap:101 H264/90000
a=fmtp:101 profile-level-id=42401f; packetization-mode=1
a=rtpmap:102 H264/90000
a=fmtp:102 profile-level-id=640c1f; packetization-mode=0
a=rtpmap:103 H264/90000
a=fmtp:103 profile-level-id=640c1f; packetization-mode=1
a=rtpmap:104 H264-SVC/90000
a=fmtp:104 profile-level-id=530c1f
a=rtpmap:105 H264-SVC/90000
a=fmtp:105 profile-level-id=560c1f
a=rtpmap:106 H265/90000
a=fmtp:106 profile-id=1; level-id=93
a=rtpmap:107 H265/90000
a=fmtp:107 profile-id=2; level-id=93
a=sendrecv
a=mid:v1 (max resolution)
a=rid:1 send max-width=1280;max-height=720;max-fps=30
a=rid:2 recv max-width=1280;max-height=720;max-fps=30
...
m=video 10000 RTP/SAVPF 98 99 100 101 102 103 104 105 106 107
a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
...same rtpmap/fmtp as above...
a=recvonly
a=mid:v2 (medium resolution)
a=rid:3 recv max-width=640;max-height=360;max-fps=15
...
m=video 10000 RTP/SAVPF 98 99 100 101 102 103 104 105 106 107
a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
...same rtpmap/fmtp as above...
a=recvonly
a=mid:v3 (medium resolution)
a=rid:3 recv max-width=640;max-height=360;max-fps=15
...
m=video 10000 RTP/SAVPF 98 99 100 101 102 103 104 105 106 107
a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
...same rtpmap/fmtp as above...
a=recvonly
a=mid:v4 (small resolution)
a=rid:4 recv max-width=320;max-height=180;max-fps=15
...
m=video 10000 RTP/SAVPF 98 99 100 101 102 103 104 105 106 107
a=extmap 1 urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id
...same rtpmap/fmtp as above...
...same rid:4 as above for mid:v5,v6,v7 (small resolution)...
...
</sourcecode>
      </section>
      <section anchor="scalable-layers" numbered="true" toc="default">
        <name>Scalable Layers</name>
        <t>Adding scalable layers to a session within a multiparty conference gives a
selective forwarding unit (SFU) further flexibility to selectively forward
packets from a source that best match the bandwidth and capabilities of
diverse receivers. Scalable encodings have dependencies between layers, unlike
independent simulcast streams. RIDs can be used to express these dependencies
using the "depend" restriction. In the example below, the highest resolution is
offered to be sent as 2 scalable temporal layers (using 
Multiple RTP Streams on a Single Media Transport (MRST)).
See <xref target="RFC8853" format="default"/> for additional detail about simulcast usage.</t>
        <sourcecode type="sdp">
Offer:
...
m=audio ...same as previous example ...
...
m=video ...same as previous example ...
...same rtpmap/fmtp as previous example ...
a=sendrecv
a=mid:v1 (max resolution)
a=rid:0 send max-width=1280;max-height=720;max-fps=15
a=rid:1 send max-width=1280;max-height=720;max-fps=30;depend=0
a=rid:2 recv max-width=1280;max-height=720;max-fps=30
a=rid:5 send max-width=640;max-height=360;max-fps=15
a=rid:6 send max-width=320;max-height=180;max-fps=15
a=simulcast: send rid=0;1;5;6 recv rid=2
...
...same m=video sections as previous example for mid:v2-v7...
...
</sourcecode>
      </section>
    </section>
    <section anchor="sec-iana" numbered="true" toc="default">
      <name>IANA Considerations</name>

      <t>This specification updates <xref target="RFC4855" format="default"/>
      to give additional guidance on choice of Format Parameter (fmtp) names
      and their relation to RID restrictions.</t>
      
      <section anchor="new-sdp-media-level-attribute" numbered="true" toc="default">
        <name>New SDP Media-Level Attribute</name>
      
  <t>This document defines "rid" as an SDP media-level attribute. This
  attribute has been registered by IANA under "Session Description Protocol
  (SDP) Parameters" under "att-field (media level only)".</t>
        <t>The "rid" attribute is used to identify the properties of an RTP
	stream within an RTP session. Its format is defined in <xref
	target="sec-abnf" format="default"/>.</t>
        <t>The formal registration information for this attribute follows.</t>

	<dl newline="true">
	  <dt>
	    Contact name, email address, and telephone number
	  </dt>
	  <dd>IETF MMUSIC Working Group<br/>mmusic@ietf.org<br/>+1 510 492 4080</dd>
	  <dt>
	    Attribute name (as it will appear in SDP)
	  </dt>
	  <dd>
	    rid
	  </dd>
	  <dt>
	    Long-form attribute name in English
	  </dt>
	  <dd>
	    Restriction Identifier
	  </dd>
	  <dt>
	    Type of attribute (session level, media level, or both)
	  </dt>
	  <dd>
	    Media Level
	  </dd>
	  <dt>
	    Whether the attribute value is subject to the charset attribute
	  </dt>
	  <dd>
	    The attribute is not dependent on charset.
	  </dd>
	  <dt>
	    A one-paragraph explanation of the purpose of the attribute
	  </dt>
	  <dd>
	    The "rid" SDP attribute is used to unambiguously identify
	    the RTP streams within an RTP session and restrict the
	    streams' payload format parameters in a codec-agnostic way
	    beyond what is provided with the regular payload types.
	  </dd>
	  <dt>
	    A specification of appropriate attribute values for this attribute
	  </dt>
	  <dd>
	    Valid values are defined by the ABNF in RFC 8851
	  </dd>
	  <dt>
	    Multiplexing (Mux) Category
	  </dt>
	  <dd>
	    SPECIAL
	  </dd>
	</dl>
	
      </section>
      <section anchor="sec-iana_rid" numbered="true" toc="default">
        <name>Registry for RID-Level Parameters</name>
        <t>This specification creates a new IANA registry named "RID Attribute Parameters"
within the SDP parameters registry.  The "a=rid" restrictions <bcp14>MUST</bcp14> be
registered with IANA and documented under the same rules as for SDP
session-level and media-level attributes as specified in <xref target="RFC4566" format="default"/>.</t>
        <t>Parameters for "a=rid" lines that modify the nature of encoded media <bcp14>MUST</bcp14> be
of the form that the result of applying the modification to the stream results
in a stream that still complies with the other parameters that affect the
media. In other words, restrictions always have to restrict the definition to be
a subset of what is otherwise allowable, and never expand it.</t>


        <t>New restriction registrations are accepted according to the "Specification
Required" policy of <xref target="RFC8126" format="default"/>. The registration <bcp14>MUST</bcp14> contain the RID
parameter name and a reference to the corresponding specification. The
specification itself must contain the following information (not all of which
appears in the registry):</t>
        <ul spacing="normal">
          <li>restriction name (as it will appear in SDP)</li>
          <li>an explanation of the purpose of the restriction</li>
          <li>a specification of appropriate attribute values for this restriction</li>
          <li>an ABNF definition of the restriction</li>
        </ul>

        <t>The initial set of "a=rid" restriction names, with definitions in
<xref target="sec-rid_level_restrictions" format="default"/> of this document,
        is given below:</t>

<table anchor="RID-params">
  <name>"a=rid" restriction names</name>
  <thead>
    <tr>
      <th>RID Parameter Name</th>
      <th>Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>pt</td>
      <td>RFC 8851</td>
    </tr>
    <tr>
      <td>max-width</td>
      <td>RFC 8851</td>
    </tr>
    <tr>
      <td>max-height</td>
      <td>RFC 8851</td>
    </tr>
    <tr>
      <td>max-fps</td>
      <td>RFC 8851</td>
    </tr>
    <tr>
      <td>max-fs</td>
      <td>RFC 8851</td>
    </tr>
    <tr>
      <td>max-br</td>
      <td>RFC 8851</td>
    </tr>
    <tr>
      <td>max-pps</td>
      <td>RFC 8851</td>
    </tr>
    <tr>
      <td>max-bpp</td>
      <td>RFC 8851</td>
    </tr>
    <tr>
      <td>depend</td>
      <td>RFC 8851</td>
    </tr>
  </tbody>
    </table>

        <t>It is conceivable that a future document will want to define RID-level
restrictions that contain string values. These extensions need to take care to
conform to the ABNF defined for rid-param-other. In particular, this means
that such extensions will need to define escaping mechanisms if they
want to allow semicolons, unprintable characters, or byte values
greater than 127 in the string.</t>
      </section>
    </section>
    <section anchor="security-considerations" numbered="true" toc="default">
      <name>Security Considerations</name>

      <t>As with most SDP parameters, a failure to provide integrity protection over
the "a=rid" attributes gives attackers a way to modify the session in
potentially unwanted ways. This could result in an implementation sending
greater amounts of data than a recipient wishes to receive. In general,
however, since the "a=rid" attribute can only restrict a stream to be a subset
of what is otherwise allowable, modification of the value cannot result in a
stream that is of higher bandwidth than would be sent to an implementation
that does not support this mechanism.</t>
      <t>The actual identifiers used for RIDs are expected to be opaque. As such, they
are not expected to contain information that would be sensitive, were it
observed by third parties.</t>
    </section>
  </middle>
  <back>
    <references>
      <name>References</name>
      <references>
        <name>Normative References</name>

<!-- draft-ietf-avtext-rid-09 (RFC 8852) -->
<reference anchor="RFC8852" target="https://www.rfc-editor.org/info/rfc8852">
  <front>
    <title>RTP Stream Identifier Source Description (SDES)</title>
    <author initials="A.B." surname="Roach" fullname="Adam Roach"/>
    <author initials="S" surname="Nandakumar" fullname="Suhas Nandakumar"/>
    <author initials="P" surname="Thatcher" fullname="Peter Thatcher"/>
    <date month="January" year="2021"/>
  </front>
    <seriesInfo name="RFC" value="8852"/>
    <seriesInfo name="DOI" value="10.17487/RFC8852"/>
</reference>

        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3264.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3550.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4566.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4855.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5234.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7405.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
      </references>
      <references>
        <name>Informative References</name>

<!-- draft-ietf-mmusic-sdp-bundle-negotiation (RFC 8843) -->
    <reference anchor="RFC8843" target="https://www.rfc-editor.org/info/rfc8843">
      <front>
        <title>Negotiating Media Multiplexing Using the Session Description Protocol (SDP)</title>
        <author initials="C" surname="Holmberg" fullname="Christer Holmberg">
          <organization/>
        </author>
        <author initials="H" surname="Alvestrand" fullname="Harald Alvestrand">
          <organization/>
        </author>
        <author initials="C" surname="Jennings" fullname="Cullen Jennings">
          <organization/>
        </author>
        <date month="January" year="2021"/>
      </front>
        <seriesInfo name="RFC" value="8843"/>
        <seriesInfo name="DOI" value="10.17487/RFC8843"/>
    </reference>


<!-- draft-ietf-mmusic-sdp-simulcast (RFC 8853) -->
<reference anchor="RFC8853" target="https://www.rfc-editor.org/info/rfc8853">
  <front>
    <title>Using Simulcast in Session Description Protocol (SDP) and RTP
    Sessions</title>

    <author initials="B" surname="Burman" fullname="Bo Burman">
      <organization/>
    </author>
    <author initials="M" surname="Westerlund" fullname="Magnus Westerlund">
      <organization/>
    </author>
    <author initials="S" surname="Nandakumar" fullname="Suhas Nandakumar">
      <organization/>
    </author>
    <author initials="M" surname="Zanaty" fullname="Mo Zanaty">
      <organization/>
    </author>
    <date month="January" year="2021"/>
  </front>
    <seriesInfo name="RFC" value="8853"/>
    <seriesInfo name="DOI" value="10.17487/RFC8853"/>
</reference>

        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8627.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2198.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4588.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5109.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8126.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6184.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6236.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7656.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7741.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8285.xml"/>

<reference anchor="H264" target="https://www.itu.int/rec/T-REC-H.264">
          <front>
            <title>Advanced video coding for generic audiovisual services</title>
            <seriesInfo name="ITU-T Recommendation" value="H.264"/>
            <author>
              <organization>International Telecommunication Union</organization>
            </author>
            <date year="2019" month="June"/>
          </front>
        </reference>
      </references>
    </references>
    <section anchor="acknowledgements" numbered="false" toc="default">
      <name>Acknowledgements</name>

      <t>Many thanks to <contact fullname="Cullen Jennings"/>, <contact
      fullname="Magnus Westerlund"/>, and <contact fullname="Paul Kyzivat"/>
      for reviewing. Thanks to <contact fullname="Colin Perkins"/> for input
      on future payload type handling.</t>
    </section>
    <section anchor="contributors" numbered="false" toc="default">
      <name>Contributors</name>
      <t>The following individuals have contributed significant text to this document.</t>

      <contact fullname="Peter Thatcher">
	<organization>Google</organization>
	<address>
          <email>pthatcher@google.com</email>
	</address>
      </contact>
      
      <contact fullname="Mo Zanaty">
	<organization>Cisco Systems</organization>
	<address>
	  <email>mzanaty@cisco.com</email>
	</address>
      </contact>
      
      <contact fullname="Suhas Nandakumar">
	<organization>Cisco Systems</organization>
	<address>
	  <email>snandaku@cisco.com</email>
	</address>
      </contact>
      
      <contact fullname="Bo Burman">
	<organization>Ericsson</organization>
	<address>
	  <email>bo.burman@ericsson.com
	  </email>
	</address>
      </contact>
      
      <contact fullname="Byron Campen">
	<organization>Mozilla</organization>
	<address>
	  <email>bcampen@mozilla.com</email>
	</address>
      </contact>
    </section>
  </back>
</rfc>
