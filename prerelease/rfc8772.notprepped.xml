<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE rfc SYSTEM "rfc2629-xhtml.ent">

<rfc xmlns:xi="http://www.w3.org/2001/XInclude" 
submissionType="independent" 
docName="draft-chz-simple-cu-separation-bng-protocol-06" 
number="8772" 
category="info" 
ipr="trust200902" 
obsoletes="" 
updates="" 
xml:lang="en" 
sortRefs="false" 
symRefs="true" 
tocInclude="true" 
version="3">

  <front>
    <title abbrev="Simple BNG CUSP">The China Mobile, Huawei, and ZTE Broadband Network Gateway (BNG) Simple Control and User Plane Separation Protocol (S-CUSP)</title>
    <seriesInfo name="RFC" value="8772" />

    <author fullname="Shujun Hu" initials="S." surname="Hu">
      <organization>China Mobile</organization>
      <address>
        <postal>
          <street>32 Xuanwumen West Ave</street>
	  <cityarea>Xicheng District</cityarea>
          <city>Beijing</city><code> 100053</code>
          <country>China</country>
        </postal>
        <email>hushujun@chinamobile.com</email>
      </address>
    </author>

    <author fullname="Donald Eastlake 3rd" initials="D." surname="Eastlake 3rd">
      <organization>Futurewei Technologies</organization>
      <address>
        <postal>
          <street>2386 Panoramic Circle</street>
          <city>Apopka</city> <region>FL</region> <code> 32703</code>
          <country>US</country>
        </postal>
        <phone>+1-508-333-2270</phone>
        <email>d3e3e3@gmail.com</email>
      </address>
    </author>
    <author fullname="Fengwei Qin" initials="F." surname="Qin">
      <organization>China Mobile</organization>
      <address>
        <postal>
          <street>32 Xuanwumen West Ave</street>
	  <cityarea>Xicheng District</cityarea>
          <city>Beijing</city><code>100053</code>
          <country>China</country>
        </postal>
        <email>qinfengwei@chinamobile.com</email>
      </address>
    </author>
    <author fullname="Tee Mong Chua" initials="T." surname="Chua">
      <organization abbrev="Singapore Telecommunications">Singapore Telecommunications Limited</organization>
      <address>
        <postal>
          <street>31 Exeter Road, #05-04 Comcentre Podium Block</street>
          <city>Singapore</city> <code> 239732</code>
          <country>Singapore</country>
        </postal>
        <email>teemong@singtel.com</email>
      </address>
    </author>
    <author fullname="Daniel Huang" initials="D." surname="Huang">
      <organization>ZTE</organization>
      <address>
        <email>huang.guangping@zte.com.cn</email>
      </address>
    </author>
    <date month="May" year="2020"/>

<keyword>CUPS</keyword>
<keyword>CUSP</keyword>
<keyword>BRAS</keyword>
<keyword>BBRAS</keyword>

    <abstract>

      <t>
   A Broadband Network Gateway (BNG) in a fixed wireline access network is an
   Ethernet-centric IP edge router and the aggregation point for subscriber
   traffic. Control and User Plane Separation (CUPS) for such a BNG improves
   flexibility and scalability but requires various communication between the
   User Plane (UP) and the Control Plane (CP).  China Mobile, Huawei
   Technologies, and ZTE have developed a simple CUPS control channel protocol
   to support such communication: the
   Simple Control and User Plane Separation Protocol (S-CUSP). S-CUSP is
   defined in this document.
</t>
      <t>
   This document is not an IETF standard and does not have IETF
   consensus.  S-CUSP is presented here to make its specification
   conveniently available to the Internet community to enable diagnosis
   and interoperability.</t>
    </abstract>
  </front>
  <middle>
    <section anchor="sect-1" numbered="true" toc="default">
      <name>Introduction</name>
      <t>
   A Broadband Network Gateway (BNG) in a fixed wireline access network is an
   Ethernet-centric IP edge router and the aggregation point for subscriber
   traffic.  To provide centralized session management, flexible address
   allocation, high scalability for subscriber management capacity, and
   cost-efficient redundancy, the CU-separated (CP/UP-separated) BNG framework is
   described in a technical report <xref target="TR-384" format="default"/>
   from the Broadband Forum (BBF). The CU-separated service CP, which is
   responsible for user access authentication and setting forwarding entries
   in UPs, can be virtualized and centralized.  The routing
   control and forwarding plane, i.e., the BNG UP (local), can be distributed
   across the infrastructure.  Other structures can also be supported, such as
   the CP and UP being virtual or both being physical.</t>
      <t>
   Note: In this document, the terms "user" and "subscriber" are used
   interchangeably.</t>
      <t>
    This document specifies the Simple CU Separation Protocol (S-CUSP) for
    communications over the BNG control channel between a BNG CP
    and a set of UPs.  S-CUSP is designed to be flexible
   and extensible so as to allow for easy addition of messages and data
   items, should further requirements be expressed in the future.</t>
      <t>
   This document is not an IETF standard and does not have IETF
   consensus.  S-CUSP was designed by China Mobile, Huawei Technologies,
   and ZTE. It is presented here to make the S-CUSP specification
   conveniently available to the Internet community to enable diagnosis
   and interoperability.</t>
      <t>
   At the time of writing this document, the BBF is
   working to produce <xref target="WT-459" format="default"/>, which will describe an architecture and
   requirements for a CP and UP separation of a
   disaggregated BNG.  Future work may attempt to show how the protocol
   described in this document addresses those requirements and may
   modify this specification to handle unaddressed requirements.</t>
    </section>
    <section anchor="sect-2" numbered="true" toc="default">
      <name>Terminology</name>
      <t>
   This section specifies implementation requirement keywords and terms
   used in this document. S-CUSP messages are described in this document
   using Routing Backus-Naur Form (RBNF) as defined in <xref target="RFC5511" format="default"/>.</t>
      <section anchor="sect-2.1" numbered="true" toc="default">
        <name>Implementation Requirement Keywords</name>
        <t>
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL
    NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP&nbsp;14 <xref target="RFC2119"/> <xref target="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
      </section>
      <section anchor="sect-2.2" numbered="true" toc="default">
        <name>Terms</name>
        <t>
   This section specifies terms used in this document.</t>
        <dl newline="false" spacing="normal" indent="13">
          <dt>AAA:</dt>
          <dd> Authentication Authorization Accounting.</dd>
          <dt>ACK:</dt>
          <dd> Acknowledgement message.</dd>
          <dt>BAS:</dt>
          <dd> Broadband Access Server, also known as a BBRAS, BNG, or BRAS.</dd>
          <dt>BNG:</dt>
          <dd> Broadband Network Gateway.  A BNG (or Broadband Remote Access
       Server (BRAS)) routes traffic to and from broadband remote
       access devices such as digital subscriber line access
       multiplexers (DSLAM) on an Internet Service Provider's (ISP)
       network.  BNG / BRAS can also be referred to as a BAS or BBRAS.</dd>
          <dt>BRAS:</dt>
          <dd> Broadband Remote Access Server, also known as a BAS, BBRAS, or BNG.</dd>
          <dt>CAR:</dt>
          <dd> Committed Access Rate.</dd>
          <dt>CBS:</dt>
          <dd> Committed Burst Size.</dd>
          <dt>CGN:</dt>
          <dd> Carrier Grade NAT.</dd>
          <dt>Ci:</dt>
          <dd> Control Interface.</dd>
          <dt>CIR:</dt>
          <dd> Committed Information Rate.</dd>
          <dt>CoA:</dt>
          <dd> Change of Authorization.</dd>
          <dt>CP:</dt>
          <dd> Control Plane. CP is a user control management
	component that supports the management of the UP's resources such as
	the user entry and forwarding policy.</dd>
          <dt>CU:</dt>
          <dd> Control Plane / User Plane.</dd>
          <dt>CUSP:</dt>
          <dd> Control and User Plane Separation Protocol.</dd>
          <dt>DEI:</dt>
          <dd> Drop Eligibility Indicator as defined in 
      <xref target="IEEE-802.1Q" format="default"/>.  A bit in a VLAN
      tag after the priority and before the VLAN ID.  (This bit was formerly
      the CFI (Canonical Format Indicator).)</dd> 
          <dt>DHCP:</dt>
          <dd> Dynamic Host Configuration Protocol <xref target="RFC2131" format="default"/>.</dd>
          <dt>dial-up:</dt>
          <dd> This refers to the initial connection messages
	when a new subscriber appears. The name is left over from when
	subscribers literally dialed up on a modem-equipped phone line but
	herein is applied to other initial connection techniques. Initial
	connection is frequently indicated by the receipt of packets over
	PPPoE <xref target="RFC2516" format="default"/> or IPoE.</dd>
          <dt>EMS:</dt>
          <dd> Element Management System.</dd>
          <dt>IPoE:</dt>
          <dd> IP over Ethernet.</dd>
          <dt>L2TP:</dt>
          <dd> Layer 2 Tunneling Protocol <xref target="RFC2661" format="default"/>.</dd>
          <dt>LAC:</dt>
          <dd> L2TP Access Concentrator.</dd>
          <dt>LNS:</dt>
          <dd> L2TP Network Server.</dd>
          <dt>MAC:</dt>
          <dd> 48-bit Media Access Control address <xref target="RFC7042" format="default"/>.</dd>
          <dt>MANO:</dt>
          <dd> Management and Orchestration.</dd>
          <dt>Mi:</dt>
          <dd> Management Interface.</dd>
          <dt>MSS:</dt>
          <dd> Maximum Segment Size.</dd>
          <dt>MRU:</dt>
          <dd> Maximum Receive Unit.</dd>
          <dt>NAT:</dt>
          <dd> Network Address Translation <xref target="RFC3022" format="default"/>.</dd>
          <dt>ND:</dt>
          <dd> Neighbor Discovery.</dd>
          <dt>NFV:</dt>
          <dd> Network Function Virtualization.</dd>
          <dt>NFVI:</dt>
          <dd> NFV Infrastructure.</dd>
          <dt>PBS:</dt>
          <dd> Peak Burst Size.</dd>
          <dt>PD:</dt>
          <dd> Prefix Delegation.</dd>
          <dt>PIR:</dt>
          <dd> Peak Information Rate.</dd>
          <dt>PPP:</dt>
          <dd> Point-to-Point Protocol <xref target="RFC1661" format="default"/>.</dd>
          <dt>PPPoE:</dt>
          <dd> PPP over Ethernet <xref target="RFC2516" format="default"/>.</dd>
          <dt>RBNF:</dt>
          <dd> Routing Backus-Naur Form <xref target="RFC5511" format="default"/>.</dd>
          <dt>RG:</dt>
          <dd> Residential Gateway.</dd>
          <dt>S-CUSP:</dt>
          <dd> Simple Control and User Plane Separation Protocol.</dd>
          <dt>Subscriber:</dt>
          <dd> The remote user gaining network accesses
	via a BNG.</dd>
          <dt>Si:</dt>
          <dd> Service Interface.</dd>
          <dt>TLV:</dt>
          <dd> Type-Length-Value.  See Sections <xref target="sect-7.1" format="counter"/> and <xref target="sect-7.3" format="counter"/>.</dd>
          <dt>UP:</dt>
          <dd> User Plane.  UP is a network edge and user policy
	implementation component.  The traditional router's control plane and
	forwarding plane are both preserved on BNG devices in the form of a
	user plane.</dd>
          <dt>URPF:</dt>
          <dd> Unicast Reverse Path Forwarding.</dd>
          <dt>User:</dt>
          <dd> Equivalent to "customer" or "subscriber".</dd>
          <dt>VRF:</dt>
          <dd> Virtual Routing and Forwarding.</dd>
        </dl>
      </section>
    </section>
    <section anchor="sect-3" numbered="true" toc="default">
      <name>BNG CUPS Overview</name>
      <section anchor="sect-3.1" numbered="true" toc="default">
        <name>BNG CUPS Motivation</name>
        <t>
   The rapid development of new services, such as 4K TV, Internet of Things (IoT), etc., and
   increasing numbers of home broadband service users present some new
   challenges for BNGs such as:</t>
        <dl newline="false" spacing="normal" indent="3">
          <dt>Low resource  utilization:</dt>
          <dd> The traditional BNG acts as both a gateway for user
	access authentication and accounting and also an IP network's Layer 3
	edge. The mutually affecting nature of the tightly coupled control
	plane and forwarding plane makes it difficult to achieve the maximum
	performance of either plane.
	</dd>
          <dt>Complex management and maintenance:</dt>
          <dd> Due to the large
	numbers of traditional BNGs, configuring each device in a network is
	very tedious when deploying global service policies. As the network
	expands and new services are introduced, this deployment mode will
	cease to be feasible as it is unable to manage services effectively
	and to rectify faults rapidly.
	</dd>
          <dt>Slow service provisioning:</dt>
          <dd> The coupling of the CP and the forwarding plane, in addition to being a distributed network
	control mechanism, means that any new technology has to rely heavily
	on the existing network devices.
	</dd>
        </dl>
        <t>
   The framework for a cloud-based BNG with 
   CU separation to address these challenges for fixed networks is
   described in <xref target="TR-384" format="default"/>.  The main idea of CU separation is to extract
   and centralize the user management functions of multiple BNG devices,
   forming a unified and centralized CP. The
   traditional router's CP and forwarding plane are both
   preserved on BNG devices in the form of a UP.</t>
      </section>
      <section anchor="sect-3.2" numbered="true" toc="default">
        <name>BNG CUPS Architecture Overview</name>
        <t>
    The functions in a traditional BNG can be divided into two parts:
    (1) the user access management function and (2) the routing
    function.  The user access management function can be deployed as
    a centralized module or device, called the BNG Control Plane
    (BNG-CP).  The routing function, which includes routing control
    and the forwarding engine, can be deployed in the form of the BNG
    User Plane (BNG-UP).
</t>
        <t>
    <xref target="fig1" format="default"/> shows the architecture of a CU-separated BNG:</t>
        <figure anchor="fig1">
          <name>Architecture of a CU-Separated BNG</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
 +------------------------------------------------------------------+
 |        Neighboring policy and resource management systems        |
 |                                                                  |
 |   +-------------+   +-----------+   +---------+   +----------+   |
 |   | AAA Server  |   |DHCP Server|   |   EMS   |   |   MANO   |   |
 |   +-------------+   +-----------+   +---------+   +----------+   |
 +------------------------------------------------------------------+

 +------------------------------------------------------------------+
 |                       CU-separated BNG system                    |
 | +--------------------------------------------------------------+ |
 | |   +----------+  +----------+ +------++------++-----------+   | |
 | |   | Address  |  |Subscriber| | AAA  ||Access||    UP     |   | |
 | |   |management|  |management| |      || mgt  ||management |   | |
 | |   +----------+  +----------+ +------++------++-----------+   | |
 | |                              CP                              | |
 | +--------------------------------------------------------------+ |
 |                                                                  |
 |                                                                  |
 |                                                                  |
 | +---------------------------+      +--------------------------+  |
 | |  +------------------+     |      |  +------------------+    |  |
 | |  | Routing control  |     |      |  | Routing control  |    |  |
 | |  +------------------+     | ...  |  +------------------+    |  |
 | |  +------------------+     |      |  +------------------+    |  |
 | |  |Forwarding engine |     |      |  |Forwarding engine |    |  |
 | |  +------------------+  UP |      |  +------------------+  UP|  |
 | +---------------------------+      +--------------------------+  |
+------------------------------------------------------------------+
]]></artwork>
        </figure>
        <t>
   As shown in <xref target="fig1" format="default"/>, the BNG-CP could be
   virtualized and centralized, which provides benefits such as centralized
   session management, flexible address allocation, high scalability for
   subscriber management capacity, cost-efficient redundancy, etc.  The
   functional components inside the BNG-CP can be implemented as
   Virtual Network Functions (VNFs) and hosted in an NFVI.</t>
        <t>
   The UP management module in the BNG-CP centrally manages
   the distributed BNG-UPs (e.g., load balancing), as well as the
   setup, deletion, and maintenance of channels between CPs and
   UPs.  Other modules in the BNG-CP, such as address
   management, AAA, etc., are responsible for the connection with external
   subsystems in order to fulfill those services. Note that the UP
   <bcp14>SHOULD</bcp14> support both physical and virtual network functions. For example,
   network functions related to BNG-UP L3 forwarding can be disaggregated
   and distributed across the physical infrastructure, and the other CP 
   management functions in the CU-separated BNG can be moved
   into the NFVI for virtualization <xref target="TR-384" format="default"/>.</t>
        <t>
   The details of the CU-separated BNG's function components are as follows:</t>
        <t>
   The CP is responsible for the following:</t>

        <ul spacing="normal">
          <li>Address  management: Unified address pool management and CGN subscriber
	address traceability management.
	</li>
          <li>AAA: This component performs Authentication,
	Authorization, and Accounting, together with RADIUS/Diameter. The BNG
	communicates with the AAA server to check whether the subscriber who
	sent an access request has network access authority.  Once the
	subscriber goes online, this component (together with the Service
	Control component) implements accounting, data capacity limitation, and
	QoS enforcement policies.
	</li>
          <li>Subscriber management: User entry management and
	forwarding policy management.
	</li>
          <li>Access management: Process user dial-up packets, such
	as PPPoE, DHCP, L2TP, etc.
	</li>
          <li>UP management: Management of UP interface status and
	the setup, deletion, and maintenance of channels between CP and UP.
	</li>
        </ul>

        <t>
   The UP is responsible for the following:</t>
        <ul spacing="normal">
          <li>Routing control functions: Responsible for instantiating routing forwarding plane
	(e.g., routing, multicast, MPLS, etc.).
	</li>
          <li>Routing and service forwarding plane functions: Responsibilities
          include traffic forwarding, QoS, and traffic statistics collection.
	</li>
          <li>Subscriber detection: Responsible for detecting whether
	a subscriber is still online.
	</li>
        </ul>
      </section>
      <section anchor="sect-3.3" numbered="true" toc="default">
        <name>BNG CUPS Interfaces</name>
        <t>
   The three interfaces defined below support the communication between the
   CP and UP.  These are referred to as the Service
   Interface (Si), Control Interface (Ci), and Management Interface (Mi)
   as shown in <xref target="fig2" format="default"/>.</t>
        <figure anchor="fig2">
          <name>Interfaces between the CP and UP of the BNG</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
          +-----------------------------------+
          |                                   |
          |               BNG-CP              |
          |                                   |
          +--+--------------+--------------+--+
             |              |              |
  1. Service |   2. Control | 3. Management|
   Interface |    Interface |    Interface |
        (Si) |         (Ci) |         (Mi) |
             |              |              |
             |           ___|___           |
             |       ___(       )___       |
            _|______(               )______|_
           (                                 )
          (         Network/Internet         )
           (________                 ________)
             |      (___         ___)      |
             |          (_______)          |
             |              |              |
             |              |              |
          +--+--------------+--------------+--+
          |                                   |
          |               BNG-UP              |
          |                                   |
          +-----------------------------------+
]]></artwork>
        </figure>
        <section anchor="sect-3.3.1" numbered="true" toc="default">
          <name>Service Interface (Si)</name>
          <t>
   For a traditional BNG (without CU separation), the user dial-up
   signals are terminated and processed by the CP of a BNG.
   When the CP and UP of a BNG are separated, there needs to be a way to
   relay these signals between the CP and the UP.</t>
          <t>
   The Si is used to establish tunnels between the
   CP and UP. The tunnels are responsible for relaying the PPPoE-, IPoE-,
   and L2TP-related control packets that are received from a Residential
   Gateway (RG) over those tunnels. An appropriate tunnel type is 
   Virtual eXtensible Local Area Network (VXLAN)
   <xref target="RFC7348" format="default"/>.</t>
          <t>
   The detailed definition of Si is out of scope for this document.</t>
        </section>
        <section anchor="sect-3.3.2" numbered="true" toc="default">
          <name>Control Interface (Ci)</name>
          <t>
   The CP uses the Ci to deliver subscriber session
   states, network routing entries, etc., to the UP (see <xref target="sect-6.2.7" format="default"/>).
   The UP uses this interface to report subscriber service statistics,
   subscriber detection results, etc., to the CP (see Sections <xref target="sect-6.3" format="counter"/> and
   <xref target="sect-6.4" format="counter"/>). A carrying protocol for this interface is specified in this
   document.</t>
        </section>
        <section anchor="sect-3.3.3" numbered="true" toc="default">
          <name>Management Interface (Mi)</name>
          <t>
   The Network Configuration Protocol (NETCONF) <xref target="RFC6241"
   format="default"/> is the protocol used on the Mi between a CP and UP. It
   is used to configure the parameters of the Ci, Si, access interfaces,
   and QoS/ACL Templates. It is expected that implementations will make use of
   existing YANG models where possible but that new YANG models specific to
   S-CUSP will need to be defined. The definitions of the parameters that can
   be configured are out of scope for this document.</t>
        </section>
      </section>
      <section anchor="sect-3.4" numbered="true" toc="default">
        <name>BNG CUPS Procedure Overview</name>
        <t>
   The following numbered sequences (<xref target="fig3" format="default"/>) give a high-level view
   of the main BNG CUPS procedures.</t>

        <figure anchor="fig3">
          <name>BNG CUPS Procedures Overview</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
   RG              UP                      CP              AAA
   |               |Establish S-CUSP Channel|               |
   |              1|<---------------------->|               |
   |               |                        |               |
   |               | Report board interface |               |
   |               |      information       |               |
   |              2|------to CP via Ci----->|               |
   |               |                        |               |
   |               |  Update BAS function   |               |
   |              3|    request/response    |               |
   |               |<-----on UP via Ci----->|               |
   |               |                        |               |
   |               | Update network routing |               |
   |               |    request/response    |               |
   |              4|<------- via Ci-------->|               |
   |  Online Req   |                        |               |
5.1|-------------->|                        |               |
   |               | Relay the Online Req   |               |
   |            5.2|-----to CP via Si------>| Authentication|
   |               |                        |    Req/Rep    |
   |               |                     5.3|<------------->|
   |               | Send the Online Rep    |               |
   |            5.4|<----to UP via Si-------|               |
   |               |                        |               |
   |               | Create subscriber      |               |
   |               |    session on UP       |               |
   |            5.5|<--------via Ci-------->|               |
   |  Online Rep   |                        |               |
5.6|<--------------|                        |               |
   |               |                        |  CoA Request  |
   |               |                     6.1|<--------------|
   |               | Update session on UP   |               |
   |            6.2|<--------via Ci-------->|               |
   |               |                        |  CoA Response |
   |  Offline Req  |                     6.3|-------------->|
7.1|-------------->|                        |               |
   |               | Relay the Offline Req  |               |
   |            7.2|------to CP via Si----->|               |
   |               |                        |               |
   |               | Send the Offline Rep   |               |
   |            7.3|<-----to UP via Si------|               |
   |  Offline Rep  |                        |               |
7.4|<--------------|                        |               |
   |               | Delete session on UP   |               |
   |            7.5|<--------via Ci-------->|               |
   |               |                        |               |
   |               |      Event report      |               |
   |              8|---------via Ci-------->|               |
   |               |                        |               |
   |               | Data synchronization   |               |
   |              9|<--------via Ci-------->|               |
   |               |                        |               |
   |               | CGN address allocation |               |
   |             10|<--------via Ci-------->|               |
   |               |                        |               |]]></artwork>
        </figure>

        <ol spacing="normal" type="(%d)">
          <li> S-CUSP session establishment: This is the first step of the BNG
	CUPS procedures. Once the Ci parameters are
	configured on a UP, it will start to set up S-CUSP sessions with the
	specified CPs. The detailed definition of S-CUSP session establishment
	can be found in <xref target="sect-4.1.1" format="default"/>.
	</li>
          <li> Board and interface report: Once the S-CUSP session is
          established between the UP and a CP, the UP will report status
          information on the boards and subscriber-facing interfaces of this
          UP to the CP. A board can also be called a Line/Service Process Unit
          (LPU/SPU) card. The subscriber-facing interfaces refer to the
          interfaces that connect the access network nodes (e.g., Optical Line
          Terminal (OLT), DSLAM, etc.). The CP can use this information to
          enable the Broadband Access Server (BAS) function (e.g., IPoE,
          PPPoE, etc.) on the specified interfaces. See Sections <xref
          target="sect-4.2.1" format="counter"/> and <xref target="sect-7.10"
          format="counter"/> for more details on resource reporting.
	</li>
          <li> BAS function enable: To enable the BAS
	function on the specified interfaces of a UP.
	</li>
          <li> Subscriber network route advertisement: The CP will allocate one
	or more IP address blocks to a UP. Each address block contains a
	series of IP addresses. Those IP addresses will be allocated to
	subscribers who are dialing up from the UP. To enable other nodes in
	the network to learn how to reach the subscribers, the CP needs to
	notify the UP to advertise to the network the routes that can reach
	those IP addresses.
	</li>
          <li> 5.1-5.6 is a complete call flow of a subscriber dial-up (as
	defined in <xref target="sect-4.3.1" format="default"/>) process.  When a UP receives a
	dial-up request, it will relay the request packet to a CP through the
	Si. The CP will parse the request. If everything is OK,
	it will send an authentication request to the AAA server to
	authenticate the subscriber. Once the subscriber passes the
	authentication, the AAA server will return a positive response to the
	CP. Then the CP will send the dial-up response packet to the UP, and
	the UP will forward the response packet to the subscriber (RG). At the
	same time, the CP will create a subscriber session on the UP, 
	enabling the subscriber to access the network.  For different access
	types, the process may be a bit different, but the high-level process
	is similar. For each access type, the detailed process can be found in
	<xref target="sect-5" format="default"/>.
	</li>
          <li> 6.1-6.3 is the sequence when updating an existing subscriber
	session. The AAA server initiates a Change of Authorization (CoA) and
	sends the CoA to the CP. The CP will then update the session according
	to the CoA.  See <xref target="sect-4.3.2" format="default"/> for more detail on CP
	messages updating UP tables.
	</li>
          <li> 7.1-7.5 is the sequence for deleting an existing subscriber
	session. When a UP receives an Offline Request, it will relay the
	request to a CP through the Si. The CP will send back a
	response to the UP through the Si. The UP will then
	forward the Offline Response to the subscriber.  Then the CP will
	delete the session on the UP through the Ci.
	</li>
          <li>
            <t> Event reports include the following two parts (more detail can
            be found in <xref target="sect-4.3.4" format="default"/>). Both
            are reported using the Event message: </t>

          <ul empty="true" spacing="normal">
            <li>
        8.1. Subscriber Traffic Statistics Report
            </li>
            <li>
	8.2.  Subscriber Detection Result Report
            </li>
</ul>
          </li>
          <li> Data synchronization: See <xref target="sect-4.2.5" format="default"/> for more detail on CP and
	UP synchronization.
	</li>
          <li> CGN address allocation: See <xref target="sect-4.2.4" format="default"/> for more detail on CGN
	address allocation.
	</li>
        </ol>
      </section>
    </section>
    <section anchor="sect-4" numbered="true" toc="default">
      <name>S-CUSP Protocol Overview</name>
      <section anchor="sect-4.1" numbered="true" toc="default">
        <name>Control Channel Procedures</name>
        <section anchor="sect-4.1.1" numbered="true" toc="default">
          <name>S-CUSP Session Establishment</name>
          <t>
   A UP is associated with a CP and is controlled by that CP. In the
   case of a hot-standby or cold-standby, a UP is associated with two
   CPs: the master CP and standby CP.
   The association between a UP and its CPs is implemented by dynamic
   configuration.</t>
          <t>
   Once a UP knows its CPs, the UP starts to establish S-CUSP sessions
   with those CPs, as shown in <xref target="fig4" format="default"/>.</t>
          <figure anchor="fig4">
            <name>S-CUSP Session Establishment</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
                 UP                               CP
                 |   TCP Session Establishment     |
                 |<------------------------------->|
                 |                                 |
                 |   Hello (version, capability)   |
                 |-------------------------------->|
                 |                                 |
                 |   Hello (version, capability)   |
                 |<--------------------------------|
                 |                                 |]]></artwork>
          </figure>
          <t>
   The S-CUSP session establishment consists of two successive steps:</t>
          <ol spacing="normal" type="(%d)">
            <li> Establishment of a TCP connection (3-way handshake) <xref target="RFC0793" format="default"/> between the CP and
            the UP using a configured port from the dynamic port range
            (49152-65535).
	</li>
            <li> Establishment of an S-CUSP session over the TCP connection.</li>
          </ol>
          <t> Once the TCP connection is established, the CP and the UP initialize
   the S-CUSP session, during which the version and Keepalive timers are
   negotiated.</t>
          <t>
   The version information (Hello TLV, see <xref target="sect-7.4" format="default"/>) is carried
   within Hello messages (see <xref target="sect-6.2.1" format="default"/>).  A CP can support multiple
   versions, but a UP can only support one version; thus the version
   negotiation is based on whether a version can be supported by both
   the CP and the UP.  
   If a CP or UP receives a Hello message that does not indicate 
   a version supported by both, it responds with a Hello message  
   containing an Error Information TLV to notify the peer of the 
   Version-Mismatch error, and the session establishment phase 
   fails.</t>
          <t>
   Keepalive negotiation is performed by carrying a Keepalive TLV in the
   Hello message.  The Keepalive TLV includes a Keepalive timer and 
   DeadTimer field. The CP and UP have to agree on the Keepalive Timer and
   DeadTimer.  Otherwise, a subsequent Hello message with an Error
   Information TLV will be sent to its peer, and the session
   establishment phase fails.</t>
          <t>
   The S-CUSP session establishment phase fails if the CP or UP disagree
   on the version and keepalive parameters or if one of the CP or UP
   does not answer after the expiration of the Establishment timer.
   When the S-CUSP session establishment fails, the TCP connection is
   promptly closed. Successive retries are permitted, but an
   implementation <bcp14>SHOULD</bcp14> make use of an exponential backoff session
   establishment retry procedure.</t>
          <t>
   The S-CUSP session timer values that need to be configured are
   summarized in <xref target="tab-sess-timers"/>.</t>
<table anchor="tab-sess-timers">
<name>S-CUSP Session Timers</name>
 <thead>
   <tr>
    <th>Timer Name</th><th>Range in Seconds</th><th>Default Value</th>
   </tr>
 </thead>
 <tbody>
  <tr>
    <td>Establishment Timer</td><td>1-32767</td><td>45</td>
  </tr>
  <tr>
    <td>Keepalive Timer</td><td>0-255</td><td>30</td>
  </tr>
  <tr>
    <td>DeadTimer</td><td>1-32767</td><td>4 * Keepalive</td>
  </tr>
 </tbody>
</table>
        </section>
        <section anchor="sect-4.1.2" numbered="true" toc="default">
          <name>Keepalive Timer and DeadTimer</name>
          <t>
   Once an S-CUSP session has been established, a UP or CP may want to
   know that its S-CUSP peer is still connected.</t>
          <t>
   Each end of an S-CUSP session runs a Keepalive timer.  It restarts
   the timer every time it sends a message on the session.  When the
   timer expires, it sends a Keepalive message. Thus, a message is
   transmitted at least as often as the value to which the Keepalive timer is
   reset, unless, as explained below, that value is the special value
   zero.</t>
          <t>
   Each end of an S-CUSP session also runs a DeadTimer and restarts that
   DeadTimer whenever a message is received on the session.  If the
   DeadTimer expires at an end of the session, that end declares the
   session dead and the session will be closed, unless their DeadTimer
   is set to the special value zero, in which case the session will not
   time out.</t>
          <t>
   The minimum value of the Keepalive timer is 1 second, and it is
   specified in units of 1 second.  The <bcp14>RECOMMENDED</bcp14> default value is 30
   seconds.  The recommended default for the DeadTimer is four times the
   value of the Keepalive timer used by the remote peer.  As above, the
   timers may be disabled by setting them to zero.</t>
          <t>
   The Keepalive timer and DeadTimer are negotiated through the
   Keepalive TLV carried in the Hello message.</t>
        </section>
      </section>
      <section anchor="sect-4.2" numbered="true" toc="default">
        <name>Node Procedures</name>
        <section anchor="sect-4.2.1" numbered="true" toc="default">
          <name>UP Resource Report</name>
          <t>
   Once an S-CUSP session has been established between a CP and a UP, the UP
   reports the state information of the boards and access-facing interfaces on
   the UP to the CP, as shown in <xref target="fig5" format="default"/>. Report messages are
   unacknowledged and are assumed to be delivered because the session runs
   over TCP.</t>
          <t>
   The CP can use that information to activate/enable the
   BAS functions (e.g., IPoE, PPPoE, etc.) on the
   specified interfaces.</t>
          <t>
   In addition, the UP resource report may trigger a UP warm-standby
   process.  In the case of warm-standby, a failure on a UP may trigger
   the CP to start a warm-standby process, by moving the online
   subscriber sessions to a standby UP and then directing the affected
   subscribers to access the Internet through the standby UP.</t>
          <figure anchor="fig5">
            <name>UP Board and Interface Report</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
                     UP                      CP
                     |  Report Board Status   |
                     |------to CP via Ci----->|
                     |                        |
                     | Report Interface Status|
                     |------to CP via Ci----->|
                     |                        |]]></artwork>
          </figure>
          <t>
   Board status information is carried in the Board Status TLV (<xref target="sect-7.10.2" format="default"/>), 
   and interface status information is carried in the 
   Interface Status TLV (<xref target="sect-7.10.1" format="default"/>). Both Board Status and
   Interface Status TLVs are carried in the Report message (<xref target="sect-6.4" format="default"/>).</t>
        </section>
        <section anchor="sect-4.2.2" numbered="true" toc="default">
          <name>Update BAS Function on Access Interface</name>
          <t> Once the CP collects the interface status of a
	UP, it will activate/deactivate/modify the BAS functions on specified
	interfaces through the Update_Request and Update_Response message exchanges
	(<xref target="sect-6.2" format="default"/>), carrying the BAS Function TLV
	(<xref target="sect-7.7" format="default"/>).</t>
          <figure anchor="fig6">
            <name>Update BAS Function</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
                     UP                       CP
                     |   Update BAS Function   |
                     |         Request         |
                     |<-----on UP via Ci-------|
                     |                         |
                     |   Update BAS Function   |
                     |         Response        |
                     |------on UP via Ci------>|
                     |                         |]]></artwork>
          </figure>
        </section>
        <section anchor="sect-4.2.3" numbered="true" toc="default">
          <name>Update Network Routing</name>
          <t>
   The CP will allocate one or more address blocks to a UP. Each address
   block contains a series of IP addresses. Those IP addresses will be
   assigned to subscribers who are dialing up to the UP. To enable the
   other nodes in the network to learn how to reach the subscribers, the
   CP needs to install the routes on the UP and notify the UP to
   advertise the routes to the network.</t>
          <figure anchor="fig7">
            <name>Update Network Routing</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
                     UP                       CP
                     | Subscriber network route|
                     |      update request     |
                     |<------- via Ci----------|
                     |                         |
                     | Subscriber network route|
                     |      update response    |
                     |-------- via Ci--------->|
                     |                         | ]]></artwork>
          </figure>
          <t>
   The Update_Request and Update_Response message exchanges, carrying the
   IPv4/IPv6 Routing TLVs (<xref target="sect-7.8" format="default"/>), update the
   subscriber's network routing information.</t>
        </section>
        <section anchor="sect-4.2.4" numbered="true" toc="default">
          <name>CGN Public IP Address Allocation</name>
          <t>
   The following sequences (<xref target="fig8" format="default"/>) describe the procedures related to CGN address
   management.  Three independent procedures are defined: one each
   for CGN address allocation request/response, CGN address renewal
   request/response, and CGN address release request/response.</t>
          <t>
   CGN address allocation/renew/release procedures are designed for the case
   where the CGN function is running on the UP.  The UP has to map the
   subscriber private IP addresses to public IP addresses, and such mapping
   is performed by the UP locally when a subscriber dials up.  That means the
   UP has to ask for public IPv4 address blocks for CGN subscribers from the
   CP.</t>
          <t>
   In addition, when a public IP address is allocated to a UP, there
   will be a lease time (e.g., one day). Before the lease time expires,
   the UP can ask for renewal of the IP address lease from the CP. It is
   achieved by the exchange of the Addr_Renew_Req and Addr_Renew_Ack
   messages.</t>
          <t>
   If the public IP address will not be used anymore, the UP <bcp14>SHOULD</bcp14>
   release the address by sending an Addr_Release_Req message to the CP.</t>
          <t>
   If the CP wishes to withdraw addresses that it has previously leased
   to a UP, it uses the same procedures as above.  The Oper code 
   (see <xref target="sect-7.1" format="default"/>) in the IPv4/IPv6 Routing TLV 
   (see <xref target="sect-7.8" format="default"/>) determines whether the
   request is an update or withdraw.</t>
          <t>
   The relevant messages are defined in <xref target="sect-6.5" format="default"/>.</t>
          <figure anchor="fig8">
            <name>CGN Public IP Address Allocation</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
                 UP                       CP
                 | CGN Address Allocation  |
                 |         Request         |
              1.1|-------- via Ci--------->|
                 | CGN Address Allocation  |
                 |         Response        |
              1.2|<------- via Ci----------|
                 |                         |
                 | CGN Address Renew       |
                 |         Request         |
              2.1|-------- via Ci--------->|
                 | CGN Address Renew       |
                 |         Response        |
              2.2|<------- via Ci----------|
                 |                         |
                 | CGN Address Release     |
                 |         Request         |
              3.1|-------- via Ci--------->|
                 | CGN Address Release     |
                 |         Response        |
              3.3|<------- via Ci----------|
                 |                         |]]></artwork>
          </figure>
        </section>
        <section anchor="sect-4.2.5" numbered="true" toc="default">
          <name>Data Synchronization between the CP and UP</name>
          <t>
   For a CU-separated BNG, the UP will continue to function using the
   state that has been installed in it even if the CP fails or the
   session between the UP and CP fails.</t>
          <t>
   Under some circumstances, it is necessary to synchronize state
   between the CP and UP, for example, if a CP fails and the UP is
   switched to a different CP.</t>
          <t>
   Synchronization includes two directions.  One direction is from UP to
   CP; in that case, the synchronization information is mainly about the
   board/interface status of the UP.  The other direction is from CP to
   UP; in that case, the subscriber sessions, subscriber network routes,
   L2TP tunnels, etc., will be synchronized to the UP.</t>
          <t>
   The synchronization is triggered by a Sync_Request message, to which
   the receiver will (1) reply with a Sync_Begin message to notify the
   requester that synchronization will begin and (2) then start the
   synchronization using the Sync_Data message.  When synchronization
   finishes, a Sync_End message will be sent.</t>
          <t>
   <xref target="fig9" format="default"/> shows the process of data synchronization
   between a UP and a CP.</t>
          <figure anchor="fig9">
            <name>Data Synchronization</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
                     UP                       CP
                     | Synchronization Request |
                     |<------- via Ci----------|
                     |                         |
                     | Synchronization Begin   |
                     |-------- via Ci--------->|
                     |                         |
                     | Board/Interface Report  |
                     |-------- via Ci--------->|
                     |                         |
                     | Synchronization End     |
                     |-------- via Ci--------->|
                     |                         |
                    1) Synchronization from UP to CP

                     UP                       CP
                     | Synchronization Request |
                     |-------- via Ci--------->|
                     |                         |
                     | Synchronization Begin   |
                     |<-------- via Ci---------|
                     |                         |
                     |      Synchronizes       |
                     |Subscriber Session States|
                     |  Network Route Entries  |
                     |<------- via Ci----------|
                     |                         |
                     | Synchronization End     |
                     |<-------- via Ci---------|
                     |                         |
                    2) Synchronization from CP to UP ]]></artwork>
          </figure>
        </section>
      </section>
      <section anchor="sect-4.3" numbered="true" toc="default">
        <name>Subscriber Session Procedures</name>
        <t>
   A subscriber session consists of a set of forwarding states, policies, and
   security rules that are applied to the subscriber.  It is used for
   forwarding subscriber traffic in a UP.  To initialize a session on a UP, a
   collection of hardware resources (e.g., NP, TCAM, etc.) has to be allocated to
   a session on a UP as part of its initiation.</t>
        <t>
   Procedures related to subscriber sessions include subscriber session creation,
   update, deletion, and statistics reporting.  The following subsections give a
   high-level view of the procedures.</t>
        <section anchor="sect-4.3.1" numbered="true" toc="default">
          <name>Create Subscriber Session</name>
          <t>
   The sequence below (<xref target="fig10" format="default"/>) describes the DHCP IPv4 dial-up process. It is an
   example that shows how a subscriber session is created. (An example
   for IPv6 appears in <xref target="sect-5.1.2" format="default"/>.)</t>

          <figure anchor="fig10">
            <name>Creating a Subscriber Session</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG              UP                       CP             AAA
     | Online Request|                        |               |
    1|-------------->|                        |               |
     |               |Relay the Online Request|               |
     |              2|-----to CP via Si------>| Authentication|
     |               |                        |    Req/Rep    |
     |               |                       3|<------------->|
     |               |  Create Subscriber     |               |
     |               |   Session Request      |               |
     |              4|<--------via Ci---------|               |
     |               |                        |               |
     |               |  Create Subscriber     |               |
     |               |   Session Response     |               |
     |              5|---------via Ci-------->|               |
     |               |                        |   Accounting  |
     |               |                       6|<------------->|
     |               |  Send Online Response  |               |
     |              7|<----to UP via Si-------|               |
     |               |                        |               |
     |Online Response|                        |               |
    8|<--------------|                        |               |
     |               |                        |               |]]></artwork>
          </figure>
          <t>
   The request starts from an Online Request message (step 1) from the
   RG (for example, a DHCP Discovery packet).  When the UP receives the
   Online Request from the RG, it will tunnel the Online Request to the
   CP through the Si (step 2). A tunneling technology
   implements the Si.</t>
          <t>
   When the CP receives the Online Request from the UP, it will send an
   authentication request to the AAA server to authenticate and
   authorize the subscriber (step 3).  When a positive reply is received
   from the AAA server, the CP starts to create a subscriber session for
   the request.  Relevant resources (e.g., IP address, bandwidth, etc.)
   will be allocated to the subscriber. Policies and security rules will
   be generated for the subscriber. Then the CP sends a request to
   create a session to the UP through the Ci (step
   4), and a response is expected from the UP to confirm the creation
   (step 5).</t>
          <t>
   Finally, the CP will notify the AAA server to start accounting (step
   6).  At the same time, an Online Response message (for example, a
   DHCP Ack packet) will be sent to the UP through the Si (step 7).  
   The UP will then forward the Online Response to the RG (step 8).</t>
          <t>
   That completes the subscriber activation process.</t>
        </section>
        <section anchor="sect-4.3.2" numbered="true" toc="default">
          <name>Update Subscriber Session</name>
          <t>
   The following numbered sequence (<xref target="fig11" format="default"/>) shows the process of updating the
   subscriber session.</t>
          <figure anchor="fig11">
            <name>Updating a Subscriber Session</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
            UP                       CP             AAA
            |                        |  CoA Request  |
            |                       1|<--------------|
            | Session Update Request |               |
           2|<--------via Ci---------|               |
            |                        |               |
            | Session Update Response|               |
           3|---------via Ci-------->|               |
            |                        |  CoA Response |
            |                       4|-------------->|
            |                        |               |]]></artwork>
          </figure>
          <t>
   When a subscriber session has been created on a UP, there may be
   requirements to update the session with new parameters (e.g.,
   bandwidth, QoS, policies, etc.).</t>
          <t>
   This procedure is triggered by a Change of Authorization (CoA)
   request message sent by the AAA server.  The CP will update the
   session on the UP according to the new parameters through the Ci.</t>
        </section>
        <section anchor="sect-4.3.3" numbered="true" toc="default">
          <name>Delete Subscriber Session</name>
          <t>
   The call flow below shows how S-CUSP deals with a subscriber Offline
   Request.</t>
          <figure anchor="fig12">
            <name>Deleting a Subscriber Session</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
           RG               UP                       CP
            |Offline Request |                        |
           1|--------------->|                        |
            |                |    Relay the Offline   |
            |                |        Request         |
            |               2|------to CP via Si----->|
            |                |                        |
            |                |    Send the Offline    |
            |                |        Response        |
            |               3|<-----to UP via Si------|
            |Offline Response|                        |
           4|<---------------|                        |
            |                |     Session Delete     |
            |                |        Request         |
            |                |<--------via Ci---------|
            |                |     Session Delete     |
            |                |       Response         |
            |                |---------via Ci-------->|
            |                |                        |]]></artwork>
          </figure>
          <t>
   Similar to the session creation process, when a UP receives an
   Offline Request from an RG, it will tunnel the request to a CP
   through the Si.</t>
          <t>
   When the CP receives the Offline Request, it will withdraw/release
   the resources (e.g., IP address, bandwidth) that have been allocated
   to the subscriber.  It then sends a reply to the UP through the
   Si, and the UP will forward the reply to the RG.  At
   the same time, it will delete all the status of the session on the UP
   through the Ci.</t>
        </section>
        <section anchor="sect-4.3.4" numbered="true" toc="default">
          <name>Subscriber Session Events Report</name>
          <figure anchor="fig13">
            <name>Events Report</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
                     UP                       CP
                     | Statistic/Detect Report|
                     |---------via Ci-------->|
                     |                        |]]></artwork>
          </figure>
          <t>
   When a session is created on a UP, the UP will periodically report statistics 
   information and subscriber detection results of the session to the CP. </t>
        </section>
      </section>
    </section>
    <section anchor="sect-5" numbered="true" toc="default">
      <name>S-CUSP Call Flows</name>
      <t>
   The subsections below give an overview of various "dial-up"
   interactions over the Si followed by an overview of
   the setting of information in the UP by the CP using S-CUSP over the
   Ci.</t>
      <t>
   S-CUSP messages are described in this document using Routing Backus
   Naur Form (RBNF) as defined in <xref target="RFC5511" format="default"/>.</t>
      <section anchor="sect-5.1" numbered="true" toc="default">
        <name>IPoE</name>
        <section anchor="sect-5.1.1" numbered="true" toc="default">
          <name>DHCPv4 Access</name>
          <t>The following sequence (<xref target="fig14" format="default"/>) shows detailed procedures for DHCPv4 access.</t>
          <figure anchor="fig14">
            <name>DHCPv4 Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG              UP                       CP             AAA
     | DHCP Discovery|                        |               |
    1|-------------->|                        |               |
     |               |Relay the DHCP Discovery|               |
     |              2|-----to CP via Si------>|      AAA      |
     |               |                        |    Req/Rep    |
     |               |                       3|<------------->|
     |               |  Send the DHCP Offer   |               |
     |              4|<----to UP via Si-------|               |
     |  DHCP Offer   |                        |               |
    5|<--------------|                        |               |
     |  DHCP Request |                        |               |
    6|-------------->|                        |               |
     |               | Relay the DHCP Request |               |
     |              7|-----to CP via Si------>|               |
     |               |                        |               |
     |               |  Create Subscriber     |               |
     |               |   Session Request      |               |
     |              8|<--------via Ci---------|               |
     |               |  Create Subscriber     |               |
     |               |   Session Response     |               |
     |              9|---------via Ci-------->|               |
     |               |                        |   Accounting  |
     |               |                      10|<------------->|
     |               |  Send DHCP ACK         |               |
     |             11|<----to UP via Si-------|               |
     |               |                        |               |
     |  DHCP ACK     |                        |               |
   12|<--------------|                        |               |
     |               |                        |               |]]></artwork>
          </figure>
          <t>
   S-CUSP implements steps 8 and 9.</t>
          <t>
   After a subscriber is authenticated and authorized by the AAA server,
   the CP creates a new subscriber session on the UP.  This is achieved
   by sending an Update_Request message to the UP.</t>
          <t>
   The format of the Update_Request message is shown as follows using
   RBNF:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]
]]></sourcecode>
          <t>
   The UP will reply with an Update_Response message. The format of the
   Update_Response message is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
]]></sourcecode>
        </section>
        <section anchor="sect-5.1.2" numbered="true" toc="default">
          <name>DHCPv6 Access</name>
          <t> The following sequence (<xref target="fig15" format="default"/>) shows detailed procedures for DHCPv6 access.
          </t>
          <figure anchor="fig15">
            <name>DHCPv6 Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG              UP                       CP             AAA
     |  Solicit      |                        |               |
    1|-------------->|                        |               |
     |               |  Relay the Solicit     |               |
     |              2|-----to CP via Si------>|      AAA      |
     |               |                        |    Req/Rep    |
     |               |                       3|<------------->|
     |               |  Send the Advertise    |               |
     |              4|<----to UP via Si-------|               |
     |  Advertise    |                        |               |
    5|<--------------|                        |               |
     |               |                        |               |
     |  Request      |                        |               |
    6|-------------->|                        |               |
     |               |  Relay the Request     |               |
     |              7|-----to CP via Si------>|               |
     |               |                        |               |
     |               |  Create Subscriber     |               |
     |               |   Session Request      |               |
     |              8|<--------via Ci-------->|               |
     |               |                        |               |
     |               |  Create Subscriber     |               |
     |               |   Session Response     |               |
     |              9|---------via Ci-------->|               |
     |               |                        |   Accounting  |
     |               |                      10|<------------->|
     |               |  Send Reply            |               |
     |             11|<----to UP via Si-------|               |
     |  Reply        |                        |               |
   12|<--------------|                        |               |
     |               |                        |               |]]></artwork>
          </figure>
          <t>
   Steps 1-7 are a standard DHCP IPv6 access process.  The subscriber
   creation is triggered by a DHCP IPv6 request message.  When this
   message is received, it means that the subscriber has passed the AAA
   authentication and authorization.  Then the CP will create a
   subscriber session on the UP.  This is achieved by sending an
   Update_Request message to the UP (step 8).</t>
          <t>
   The format of the Update_Request message is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]
]]></sourcecode>
          <t>
   The UP will reply with an Update_Response message (step 9). The
   format of the Update_Response message is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
        </section>
        <section anchor="sect-5.1.3" numbered="true" toc="default">
          <name>IPv6 Stateless Address Autoconfiguration (SLAAC) Access</name>
          <t>The following flow (<xref target="fig16" format="default"/>) shows the IPv6 SLAAC access process.</t>
          <figure anchor="fig16">
            <name>IPv6 SLAAC Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG              UP                       CP             AAA
     |      RS       |                        |               |
    1|-------------->|                        |               |
     |               |  Relay the Router      |               |
     |               |    Solicit (RS)        |               |
     |              2|-----to CP via Si------>|      AAA      |
     |               |                        |    Req/Rep    |
     |               |                       3|<------------->|
     |               |  Create Subscriber     |               |
     |               |   Session Request      |               |
     |              4|<--------via Ci---------|               |
     |               |                        |               |
     |               |  Create Subscriber     |               |
     |               |   Session Response     |               |
     |              5|---------via Ci-------->|               |
     |               |                        |               |
     |               |  Send Router Advertise |               |
     |               |         (RA)           |               |
     |              6|<----to UP via Si-------|               |
     |      RA       |                        |               |
    7|<--------------|                        |               |
     |               |                        |               |
     |      NS       |                        |               |
    8|-------------->|                        |               |
     |               |  Relay the Neighbor    |               |
     |               |     Solicit (NS)       |               |
     |              9|-----to CP via Si------>|               |
     |               |                        |   Accounting  |
     |               |                      10|<------------->|
     |               |  Send a Neighbor       |               |
     |               |     Advertise (NA)     |               |
     |             11|<----to UP via Si-------|               |
     |      NA       |                        |               |
   12|<--------------|                        |               |
     |               |                        |               |]]></artwork>
          </figure>
          <t>
   It starts with a Router Solicit (RS) request from an RG that is
   tunneled to the CP by the UP.  After the AAA authentication and
   authorization, the CP will create a subscriber session on the UP.</t>
          <t>
   This is achieved by sending an Update_Request message to the UP (step
   4).</t>
          <t>
   The format of the Update_Request message is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]
]]></sourcecode>
          <t>
   The UP will reply with an Update_Response message (step 5). The
   format of the Update_Response message is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
        </section>
        <section anchor="sect-5.1.4" numbered="true" toc="default">
          <name>DHCPv6 and SLAAC Access</name>
          <t> The following call flow (<xref target="fig17" format="default"/>) shows the DHCP IPv6 and SLAAC access
        process.</t>
          <figure anchor="fig17">
            <name>DHCPv6 and SLAAC Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG              UP                       CP             AAA
     |      RS       |                        |               |
    1|-------------->|                        |               |
     |               |  Relay the RS          |               |
     |              2|-----to CP via Si------>|      AAA      |
     |               |                        |    Req/Rep    |
     |               |                       3|<------------->|
     |               |  Create Subscriber     |               |
     |               |   Session Request      |               |
     |              4|<--------via Ci---------|               |
     |               |                        |               |
     |               |  Create Subscriber     |               |
     |               |   Session Response     |               |
     |              5|---------via Ci-------->|               |
     |               |                        |               |
     |               |  Send RA               |               |
     |              6|<----to UP via Si-------|               |
     |      RA       |                        |               |
    7|<--------------|                        |               |
     |               |                        |               |
     |DHCPv6 Solicit |                        |               |
    8|-------------->|                        |               |
     |               |  Relay DHCPv6 Solicit  |               |
     |              9|-----to CP via Si------>|               |
     |               |                        |               |
     |               |  Update Subscriber     |               |
     |               |   Session Request      |               |
     |             10|<--------via Ci---------|               |
     |               |                        |               |
     |               |  Update Subscriber     |               |
     |               |   Session Response     |               |
     |             11|---------via Ci-------->|               |
     |               |                        |   Accounting  |
     |               |                      12|<------------->|
     |               |  Send DHCPv6 Reply     |               |
     |             13|<----to UP via Si-------|               |
     |               |                        |               |
     | DHCPv6 Reply  |                        |               |
   14|<--------------|                        |               |
     |               |                        |               |]]></artwork>
          </figure>
          <t>
   When a subscriber passes AAA authentication, the CP will create a
   subscriber session on the UP.  This is achieved by sending an
   Update_Request message to the UP (step 4).</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]
]]></sourcecode>
          <t>
   The UP will reply with an Update_Response message (step 5). The
   format of the Update_Response is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
          <t>
   After receiving a DHCPv6 Solicit, the CP will update the subscriber
   session by sending an Update_Request message with new parameters to
   the UP (step 10).</t>
          <t>
   The format of the Update_Request message is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]
]]></sourcecode>
          <t>
   The UP will reply with an Update_Response message (step 11).  The
   format of the Update_Response is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
        </section>
        <section anchor="sect-5.1.5" numbered="true" toc="default">
          <name>DHCP Dual-Stack Access</name>
          <t>
   The following sequence (<xref target="fig18" format="default"/>) is a combination of DHCP IPv4 and DHCP IPv6
   access processes.</t>
          <figure anchor="fig18">
            <name>DHCP Dual-Stack Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG              UP                       CP             AAA
     | DHCP Discovery|                        |               |
    1|-------------->|                        |               |
     |               |Relay the DHCP Discovery|               |
     |              2|-----to CP via Si------>|     AAA       |
     |               |                        |   Req/Resp    |
     |               |                       3|<------------->|
     |               |  Send the DHCP Offer   |               |
     |              4|<----to UP via Si-------|               |
     |  DHCP Offer   |                        |               |
    5|<--------------|                        |               |
     |  DHCP Request |                        |               |
    6|-------------->|                        |               |
     |               |  Relay the DHCP Request|               |
     |              7|-----to CP via Si------>|               |
     |               |                        |               |
     |               |  Create Subscriber     |               |
     |               |   Session Request      |               |
     |              8|<--------via Ci-------->|               |
     |               |  Create Subscriber     |               |
     |               |   Session Response     |               |
     |              9|---------via Ci-------->|               |
     |               |                        |   Accounting  |
     |               |                      10|<------------->|
     |               |  Send DHCP ACK         |               |
     |             11|<----to UP via Si-------|               |
     |  DHCP ACK     |                        |               |
   12|<--------------|                        |               |
     |      RS       |                        |               |
   13|-------------->|                        |               |
     |               |  Relay the RS          |               |
     |             14|-----to CP via Si------>|      AAA      |
     |               |                        |    Req/Rep    |
     |               |                      15|<------------->|
     |               |  Create Subscriber     |               |
     |               |   Session Request      |               |
     |             16|<--------via Ci---------|               |
     |               |  Create Subscriber     |               |
     |               |   Session Response     |               |
     |             17|---------via Ci-------->|               |
     |               |                        |               |
     |               |  Send the RA           |               |
     |             18|<----to UP via Si-------|               |
     |      RA       |                        |               |
   19|<--------------|                        |               |
     |DHCPv6 Solicit |                        |               |
   20|-------------->|                        |               |
     |               |  Relay DHCPv6 Solicit  |               |
     |             21|-----to CP via Si------>|               |
     |               |                        |               |
     |               |  Update Subscriber     |               |
     |               |   Session Request      |               |
     |             22|<--------via Ci---------|               |
     |               |  Update Subscriber     |               |
     |               |   Session Response     |               |
     |             23|---------via Ci-------->|               |
     |               |                        |   Accounting  |
     |               |                      24|<------------->|
     |               |  Send DHCPv6 Reply     |               |
     |             25|<----to UP via Si-------|               |
     | DHCPv6 Reply  |                        |               |
   26|<--------------|                        |               |
     |               |                        |               |]]></artwork>
          </figure>
          <t>
   The DHCP dual-stack access includes three sets of
   Update_Request/Update_Response exchanges to create/update a DHCPv4/v6
   subscriber session.</t>
          <ol spacing="normal" type="(%d)">
            <li>
              <t>Create a DHCPv4 session (steps 8 and 9):

              </t>
              <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
]]></sourcecode>
            </li>
            <li>
              <t>Create a DHCPv6 session (steps 16 and 17):

              </t>
              <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
            </li>
            <li>
              <t>Update DHCPv6 session (steps 22 and 23):

              </t>
              <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
            </li>
          </ol>
        </section>
        <section anchor="sect-5.1.6" numbered="true" toc="default">
          <name>L2 Static Subscriber Access</name>
          <t>L2 static subscriber access processes are as follows:</t>
          <figure anchor="fig19">
            <name>L2 Static Subscriber Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG              UP                      CP              AAA
     |               |    Static Subscriber   |               |
     |               |     Detection Req.     |               |
     |              1|<-----to UP via Ci------|               |
     |               |    Static Subscriber   |               |
     |               |     Detection Rep.     |               |
     |              2|------to UP via Ci----->|               |
     |  ARP/ND(REQ)  |                        |               |
  3.1|<--------------|                        |               |
     |  ARP/ND(ACK)  |                        |               |
  3.2|-------------->|                        |               |
     |               |  Relay the ARP/ND      |               |
     |            3.3|-----to CP via Si------>|       AAA     |
     |               |                        |    Req/Rep    |
     |               |                     3.4|<------------->|
     |               |  Create Subscriber     |               |
     |               |   Session Request      |               |
     |            3.5|<--------via Ci---------|               |
     |               |  Create Subscriber     |               |
     |               |   Session Response     |               |
     |            3.6|---------via Ci-------->|               |
     |  ARP/ND(REQ)  |                        |               |
  4.1|-------------->|                        |               |
     |               |  Relay the ARP/ND      |               |
     |            4.2|-----to CP via Si------>|      AAA      |
     |               |                        |    Req/Rep    |
     |               |                     4.3|<------------->|
     |               |  Create Subscriber     |               |
     |               |   Session Request      |               |
     |            4.4|<--------via Ci---------|               |
     |               |  Create Subscriber     |               |
     |               |   Session Response     |               |
     |            4.5|---------via Ci-------->|               |
     |  ARP/ND(ACK)  |                        |               |
  4.6|<--------------|                        |               |
     |   IP Traffic  |                        |               |
  5.1|-------------->|                        |               |
     |               |  Relay the IP Traffic  |               |
     |            5.2|-----to CP via Si------>|      AAA      |
     |               |                        |    Req/Rep    |
     |               |                     5.3|<------------->|
     |               |  Create Subscriber     |               |
     |               |   Session Request      |               |
     |            5.4|<--------via Ci-------->|               |
     |               |  Create Subscriber     |               |
     |               |   Session Response     |               |
     |            5.5|---------via Ci-------->|               |
     |  ARP/ND(REQ)  |                        |               |
  5.6|<--------------|                        |               |
     |  ARP/ND(ACK)  |                        |               |
  5.7|-------------->|                        |               |
     |               |                        |               |]]></artwork>
          </figure>
          <t>
   For L2 static subscriber access, the process starts with a CP
   installing a static subscriber detection list on a UP.  The list
   determines which subscribers will be detected.  That is implemented
   by exchanging Update_Request and Update_Response messages between CP
   and UP.  The formats of the messages are as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <IPv4 Static Subscriber Detect TLVs>
                  <IPv6 Static Subscriber Detect TLVs>

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
          <t>
   For L2 static subscriber access, there are three ways to trigger the
   access process:</t>
          <ol spacing="normal" type="(%d)">
            <li> Triggered by UP (steps 3.1-3.6): This assumes that the UP knows the IP
       address, the access interface, and the VLAN of the RG.  The UP will
       actively trigger the access flow by sending an ARP/ND packet to the RG.
       If the RG is online, it will reply with an ARP/ND to the UP.  The UP
       will tunnel the ARP/ND to the CP through the Si.  The CP then triggers
       the authentication process.  If the authentication result is positive,
       the CP will create a corresponding subscriber session on the UP.
	</li>
            <li> Triggered by RG ARP/ND (steps 4.1-4.6): Most of the process is the same as
	option 1 (triggered by UP).  The difference is that the RG will
	actively send the ARP/ND to trigger the process.
	</li>
            <li> Triggered by RG IP traffic (steps 5.1-5.7): This is for the case where
	the RG has the ARP/ND information, but the subscriber session on the
	UP is lost (e.g., due to failure on the UP or the UP restarting).
	That means the RG may keep sending IP packets to the UP.  The packets
	will trigger the UP to start a new access process.
	</li>
          </ol>
          <t>
   From a subscriber session point of view, the procedures and the
   message formats for the three cases above are the same, as follows.</t>

<t>IPv4 Case:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
]]></sourcecode>

<t>IPv6 Case:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
        </section>
      </section>
      <section anchor="sect-5.2" numbered="true" toc="default">
        <name>PPPoE</name>
        <section anchor="sect-5.2.1" numbered="true" toc="default">
          <name>IPv4 PPPoE Access</name>
          <t><xref target="fig20" format="default"/> shows the IPv4 PPPoE access call flow.
          </t>
          <figure anchor="fig20">
            <name>IPv4 PPPoE Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG              UP                      CP              AAA
     |  PPPoE Disc   |        PPPoE Disc      |               |
    1|<------------->|<---------via Si------->|               |
     |               |                        |               |
     |  PPP LCP      |        PPP LCP         |               |
    2|<------------->|<---------via Si------->|               |
     |               |                        |      AAA      |
     |  PPP PAP/CHAP |        PPP PAP/CHAP    |    Req/Rep    |
    3|<------------->|<---------via Si------->|<------------->|
     |               |                        |               |
     |  PPP IPCP     |        PPP IPCP        |               |
    4|<------------->|<---------via Si------->|               |
     |               |                        |               |
     |               |  Create Subscriber     |               |
     |               |   Session Request      |               |
     |              5|<--------via Ci---------|               |
     |               |  Create Subscriber     |               |
     |               |   Session Response     |               |
     |              6|---------via Ci-------->|               |
     |               |                        |   Accounting  |
     |               |                       7|<------------->|
     |               |                        |               |]]></artwork>
          </figure>
          <t>
   In the above sequence, steps 1-4 are the standard PPPoE call flow.
   The UP is responsible for redirecting the PPPoE control packets to
   the CP or RG.  The PPPoE control packets are transmitted between the
   CP and UP through the Si.</t>
          <t>
   After the PPPoE call flow, if the subscriber passed the AAA
   authentication and authorization, the CP will create a corresponding
   session on the UP through the Ci.  The formats of the messages are as
   follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
]]></sourcecode>
        </section>
        <section anchor="sect-5.2.2" numbered="true" toc="default">
          <name>IPv6 PPPoE Access</name>
          <t><xref target="fig21" format="default"/> describes the IPv6 PPPoE access call flow.</t>
          <figure anchor="fig21">
            <name>IPv6 PPPoE Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG              UP                      CP              AAA
     |  PPPoE Disc   |        PPPoE Disc      |               |
    1|<------------->|<--------via Si-------->|               |
     |               |                        |               |
     |  PPP LCP      |        PPP LCP         |               |
    2|<------------->|<---------via Si------->|               |
     |               |                        |      AAA      |
     |  PPP PAP/CHAP |        PPP PAP/CHAP    |    Req/Rep    |
    3|<------------->|<---------via Si------->|<------------->|
     |               |                        |               |
     |  PPP IP6CP    |        PPP IP6CP       |               |
    4|<------------->|<---------via Si------->|               |
     |               |                        |               |
     |               |  Create Subscriber     |               |
     |               |   Session Request      |               |
     |              5|<--------via Ci---------|               |
     |               |  Create Subscriber     |               |
     |               |   Session Response     |               |
     |              6|---------via Ci-------->|               |
     |               |                        |               |
     | ND Negotiation|        ND Negotiation  |               |
    7|<------------->|<---------via Si------->|               |
     |               |                        |               |
     |               |  Update Subscriber     |               |
     |               |   Session Request      |               |
     |              8|<--------via Ci---------|               |
     |               |  Update Subscriber     |               |
     |               |   Session Response     |               |
     |              9|---------via Ci-------->|               |
     |               |                        |   Accounting  |
     |               |                      10|<------------->|
     |    DHCPv6     |        DHCPv6          |               |
     |  Negotiation  |      Negotiation       |               |
   7'|<------------->|<---------via Si------->|               |
     |               |                        |               |
     |               |  Update Subscriber     |               |
     |               |   Session Request      |               |
     |             8'|<---------via Ci--------|               |
     |               |  Update Subscriber     |               |
     |               |   Session Response     |               |
     |             9'|---------via Ci-------->|               |
     |               |                        |   Accounting  |
     |               |                     10'|<------------->|
     |               |                        |               |]]></artwork>
          </figure>
          <t>
   From the above sequence, steps 1-4 are the standard PPPoE call flow.
   The UP is responsible for redirecting the PPPoE control packets to
   the CP or RG.  The PPPoE control packets are transmitted between the
   CP and UP through the Si.</t>
          <t>
   After the PPPoE call flow, if the subscriber passed the AAA
   authentication and authorization, the CP will create a corresponding
   session on the UP through the Ci.  The formats of the messages are as
   follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
          <t>
   Then, the RG will initialize an ND/DHCPv6 negotiation process with
   the CP (see steps 7 and 7'); after that, it will trigger an update
   (steps 8-9 and 8'-9') to the subscriber session. The formats of the update
   messages are as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
        </section>
        <section anchor="sect-5.2.3" numbered="true" toc="default">
          <name>PPPoE Dual-Stack Access</name>
          <t>
   <xref target="fig22" format="default"/> shows a combination of IPv4 and IPv6 PPPoE
   access call flows.</t>
          <figure anchor="fig22">
            <name>PPPoE Dual-Stack Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG              UP                      CP              AAA
     |PPPoE Discovery|      PPPoE Discovery   |               |
    1|<------------->|<---------via Si------->|               |
     |               |                        |               |
     |  PPP LCP      |        PPP LCP         |               |
    2|<------------->|<---------via Si------->|               |
     |               |                        |      AAA      |
     |  PPP PAP/CHAP |        PPP PAP/CHAP    |    Req/Rep    |
    3|<------------->|<---------via Si------->|<------------->|
     |               |                        |               |
     |  PPP IPCP     |        PPP IPCP        |               |
    4|<------------->|<---------via Si------->|               |
     |               |                        |               |
     |               |  Create v4 Subscriber  |               |
     |               |   Session Request      |               |
     |              5|<--------via Ci---------|               |
     |               |  Create v4 Subscriber  |               |
     |               |   Session Response     |               |
     |              6|---------via Ci-------->|               |
     |               |                        |   Accounting  |
     |               |                       7|<------------->|
     |  PPP IP6CP    |        PPP IP6CP       |               |
   4'|<------------->|<---------via Si------->|               |
     |               |                        |               |
     |               |  Create V6 Subscriber  |               |
     |               |   Session Request      |               |
     |             5'|<--------via Ci---------|               |
     |               |  Create v6 Subscriber  |               |
     |               |   Session Response     |               |
     |             6'|---------via Ci-------->|               |
     |               |                        |               |
     | ND Negotiation|     ND Negotiation     |               |
    8|<------------->|<---------via Si------->|               |
     |               |                        |               |
     |               |  Update v6 Subscriber  |               |
     |               |   Session Request      |               |
     |              9|<---------via Ci--------|               |
     |               |  Update v6 Subscriber  |               |
     |               |   Session Response     |               |
     |             10|---------via Ci-------->|               |
     |               |                        |   Accounting  |
     |               |                      7'|<------------->|
     |    DHCPv6     |        DHCPv6          |               |
     |  Negotiation  |      Negotiation       |               |
   8'|<------------->|<---------via Si------->|               |
     |               |                        |               |
     |               |  Update v6 Subscriber  |               |
     |               |   Session Request      |               |
     |             9'|<--------via Ci---------|               |
     |               |  Update v6 Subscriber  |               |
     |               |   Session Response     |               |
     |            10'|---------via Ci-------->|               |
     |               |                        |   Accounting  |
     |               |                      7"|<------------->|
     |               |                        |               |]]></artwork>
          </figure>
          <t>
   PPPoE dual stack is a combination of IPv4 PPPoE and IPv6 PPPoE
   access.  The process is as above.  The formats of the messages are as
   follows:</t>
          <ol spacing="normal" type="(%d)">
            <li>
              <t> Create an IPv4 PPPoE subscriber session (steps 5-6):

              </t>
              <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
]]></sourcecode>
            </li>
            <li>
              <t> Create an IPv6 PPPoE subscriber session (steps 5'-6'):

              </t>
              <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
            </li>
            <li>
              <t> Update the IPv6 PPPoE subscriber session (steps 9-10 and 9'-10'):

              </t>
              <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
            </li>
          </ol>
        </section>
      </section>
      <section anchor="sect-5.3" numbered="true" toc="default">
        <name>WLAN Access</name>
        <t><xref target="fig23" format="default"/> shows the WLAN access call flow.</t>
        <figure anchor="fig23">
          <name>WLAN Access</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
     RG            UP              CP         AAA      Web Server
     |    DHCP     |                |          |           |
     |  Discovery  |                |          |           |
    1|------------>|                |          |           |
     |             | DHCP Discovery |          |           |
     |            2|-----via Si---->|   AAA    |           |
     |             |   DHCP Offer   |<-------->|           |
     |            3|<----via Si-----|          |           |
     |  DHCP Offer |                |          |           |
    4|<------------|                |          |           |
     | DHCP Request|                |          |           |
    5|------------>|                |          |           |
     |             |  DHCP Request  |          |           |
     |            6|-----via Si---->|          |           |
     |             |                |          |           |
     |             | Create Session |          |           |
     |             |    Request     |          |           |
     |            7|<----via Ci-----|          |           |
     |             | Create Session |          |           |
     |             |    Response    |          |           |
     |            8|----via Ci----->|          |           |
     |             |                |          |           |
     |             |  DHCP ACK      |          |           |
     |            9|<----via Si-----|          |           |
     |  DHCP ACK   |                |          |           |
   10|<------------|                |          |           |
     |             |                |          |           |
     | Subscriber  |                |          |           |
     | HTTP Traffic|                |          |           |
   11|------------>|-->             |          |           |
     |             |  | Web URL     |          |           |
     |  Traffic    |  | Redirect    |          |           |
     | Redirection |  |             |          |           |
   12|<------------|<-+             |          |           |
     |                                                     |
   13|-----------------Redirect to Web Server------------->|
     |                                                     |
   14|<----------------Push HTTP Log-in Page---------------|
     |                                                     |
   15|-----------------User Authentication---------------->|
     |                                                     |
     |             |                |  Portal Interchange  |
     |             |              16|<-------------------->|
     |             |                |                      |
     |             |                |   AAA    |           |
     |             |                |  Req/Rep |           |
     |             |              17|<-------->|           |
     |             |                |          |           |
     |             | Update Session |          |           |
     |             |    Request     |          |           |
     |           18|<----via Ci-----|          |           |
     |             | Update Session |          |           |
     |             |    Response    |          |           |
     |           19|-----via Ci---->|          |           |
     |             |                |          |           |]]></artwork>
        </figure>
        <t>
   WLAN access starts with the DHCP dial-up process (steps 1-6). After
   that, the CP will create a subscriber session on the UP (steps 7-8).
   The formats of the session creation messages are as follows:</t>

<t>IPv4 Case:</t>
        <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
]]></sourcecode>

<t>IPv6 Case:</t>
<sourcecode type="rbnf"><![CDATA[ 
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
        <t>
   After step 10, the RG will be allocated an IP address, and its first
   HTTP packet will be redirected to a web server for subscriber
   authentication (steps 11-17).  After the web authentication, if the
   result is positive, the CP will update the subscriber session by
   using the following message exchanges:</t>

<t>IPv4 Case:</t>
        <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
]]></sourcecode>

<t>IPv6 Case:</t>
        <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
      </section>
      <section anchor="sect-5.4" numbered="true" toc="default">
        <name>L2TP</name>
        <section anchor="sect-5.4.1" numbered="true" toc="default">
          <name>L2TP LAC Access</name>
          <figure anchor="fig24">
            <name>L2TP LAC Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG         UP(LAC)      CP(LAC)     AAA        LNS
     |    PPPoE   |    PPPoE     |        |          |
     |  Discovery |   Discovery  |        |          |
    1|<---------->|<---via Si--->|        |          |
     |            |              |        |          |
     |  PPP LCP   |   PPP LCP    |        |          |
    2|<---------->|<---via Si--->|        |          |
     |            |              |   AAA  |          |
     |PPP PAP/CHAP| PPP PAP/CHAP | Req/Rep|          |
    3|<---------->|<---via Si--->|<------>|          |
     |            |              |        |          |
     |  PPP IPCP  |  PPP IPCP    |        |          |
    4|<---------->|<---via Si--->|        |          |
     |            |              |        |          |
     |            | L2TP Tunnel  |        |          |
     |            | Negotiation  |        |          |
     |            |   SCCRQ/     |        |          |
     |            |   SCCRP/     |        |          |
     |            |   SCCCN      |        |          |
     |           5|<---via Si--->|        |          |
     |            | /\                               |
     |            | || Forward                       |
     |            | \/                               |
     |            |<-----------via Routing---------->|
     |            |                                  |
     |            | L2TP Session |        |          |
     |            | Negotiation  |        |          |
     |            |    ICRQ/     |        |          |
     |            |    ICRP/     |        |          |
     |            |    ICCN      |        |          |
     |           6|<---via Si--->|        |          |
     |            | /\                               |
     |            | || Forward                       |
     |            | \/                               |
     |            |<-----------via Routing---------->|
     |            |                                  |
     |            |    Create    |         |         |
     |            |  Subscriber  |         |         |
     |            |  Session Req |         |         |
     |           7|<---via Ci----|         |         |
     |            |    Create    |         |         |
     |            |  Subscriber  |         |         |
     |            |  Session Rep |         |         |
     |           8|----via Ci--->|         |         |
     |            |              |         |         |
     |                                               |
     |         PAP/CHAP (Triggered by LNS)           |
    9|<-----------------via Routing----------------->|
     |                                               |]]></artwork>
          </figure>
          <t>
   Steps 1-4 are a standard PPPoE access process.  After that, the LAC-CP
   starts to negotiate an L2TP session and tunnel with the LNS.  After the
   negotiation, the CP will create an L2TP LAC subscriber session on the UP
   through the following messages:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <L2TP-LAC Subscriber TLV>
                  <L2TP-LAC Tunnel TLV>

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
        </section>
        <section anchor="sect-5.4.2" numbered="true" toc="default">
          <name>L2TP LNS IPv4 Access</name>
          <figure anchor="fig25">
            <name>L2TP LNS IPv4 Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG          LAC            UP(LNS)  AAA      CP(LNS)
     |    PPPoE   |              |        |          |
     |  Discovery |              |        |          |
    1|<---------->|              |        |          |
     |            |              |        |          |
     |  PPP LCP   |              |        |          |
    2|<---------->|                       |          |
     |            |          AAA          |          |
     |PPP PAP/CHAP|        Req/Rep        |          |
    3|<---------->|<--------------------->|          |
     |            |                                  |
     |            | L2TP Tunnel  |     L2TP Tunnel   |
     |            | Negotiation  |     Negotiation   |
     |            |   SCCRQ/     |       SCCRQ/      |
     |            |   SCCRP/     |       SCCRP/      |
     |            |   SCCCN      |       SCCCN       |
     |           4|<------------>|<------via Si----->|
     |            |              |                   |
     |            | L2TP Session |     L2TP Session  |
     |            | Negotiation  |     Negotiation   |
     |            |    ICRQ/     |        ICRQ/      |
     |            |    ICRP/     |        ICRP/      |
     |            |    ICCN      |        ICCN       |
     |           5|<------------>|<------via Si----->|
     |            |              |                   |
     |            |              | Create Subscriber |
     |            |              | Session Request   |
     |            |             6|<-----via Ci-------|
     |            |              | Create Subscriber |
     |            |              | Session Response  |
     |            |             7|------via Ci------>|
     |                                               |
     |          PAP/CHAP (Triggered by LNS)          |
    8|<--------------------------------------------->|
     |                                               |
     |            |              |        |    AAA   |
     |            |              |        |  Req/Rep |
     |            |              |       9|<-------->|
     |            |              |                   |
     |                                               |
     |                   PPP IPCP                    |
   10|<--------------------------------------------->|
     |                                               |
     |            |              | Update Subscriber |
     |            |              | Session Request   |
     |            |            11|<-----via Ci-------|
     |            |              | Update Subscriber |
     |            |              | Session Response  |
     |            |            12|------via Ci------>|
     |            |              |                   |]]></artwork>
          </figure>
          <t>
   In this case, the BNG is running as an LNS and separated into LNS-CP
   and LNS-UP.  Steps 1-5 finish the normal L2TP dial-up process.  When
   the L2TP session and tunnel negotiations are finished, the LNS-CP
   will create an L2TP LNS subscriber session on the LNS-UP.  The format
   of the messages is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <L2TP-LNS Subscriber TLV>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  <L2TP-LNS Tunnel TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
]]></sourcecode>
          <t>
   After that, the LNS-CP will trigger a AAA authentication.  If the
   authentication result is positive, a PPP IP Control Protocol (IPCP) process
   will follow, and
   then the CP will update the session with the following message
   exchanges:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <L2TP-LNS Subscriber TLV>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  <L2TP-LNS Tunnel TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
]]></sourcecode>
        </section>
        <section anchor="sect-5.4.3" numbered="true" toc="default">
          <name>L2TP LNS IPv6 Access</name>
          <figure anchor="fig26">
            <name>L2TP LNS IPv6 Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG          LAC          UP(LNS)    AAA      CP(LNS)
     |    PPPoE   |              |        |          |
     |  Discovery |              |        |          |
    1|<---------->|              |        |          |
     |            |              |        |          |
     |  PPP LCP   |              |        |          |
    2|<---------->|                       |          |
     |            |          AAA          |          |
     |PPP PAP/CHAP|        Req/Rep        |          |
    3|<---------->|<--------------------->|          |
     |            |                                  |
     |            | L2TP Tunnel  |     L2TP Tunnel   |
     |            | Negotiation  |     Negotiation   |
     |            |   SCCRQ/     |       SCCRQ/      |
     |            |   SCCRP/     |       SCCRP/      |
     |            |   SCCCN      |       SCCCN       |
     |           4|<------------>|<------via Si----->|
     |            |              |                   |
     |            | L2TP Session |     L2TP Session  |
     |            | Negotiation  |     Negotiation   |
     |            |    ICRQ/     |        ICRQ/      |
     |            |    ICRP/     |        ICRP/      |
     |            |    ICCN      |        ICCN       |
     |           5|<------------>|<------via Si----->|
     |            |              |                   |
     |            |              | Create Subscriber |
     |            |              | Session Request   |
     |            |             6|<-----via Ci-------|
     |            |              | Create Subscriber |
     |            |              | Session Response  |
     |            |             7|------via Ci------>|
     |                                               |
     |          PAP/CHAP (Triggered by LNS)          |
    8|<--------------------------------------------->|
     |                                               |
     |            |              |        |    AAA   |
     |            |              |        |  Req/Rep |
     |            |              |       9|<-------->|
     |            |              |        |          |
     |                                               |
     |                   PPP IP6CP                   |
   10|<--------------------------------------------->|
     |                                               |
     |            |              | Update Subscriber |
     |            |              | Session Request   |
     |            |            11|<-----via Ci-------|
     |            |              | Update Subscriber |
     |            |              | Session Response  |
     |            |            12|------via Ci------>|
     |                           |                   |
     |       ND Negotiation      |   ND Negotiation  |
   13|<------------------------->|<-----via Si------>|
     |                           |                   |
     |            |              | Update Subscriber |
     |            |              | Session Request   |
     |            |            14|<-----via Ci-------|
     |            |              | Update Subscriber |
     |            |              | Session Response  |
     |            |            15|------via Ci------>|
     |            |              |                   |]]></artwork>
          </figure>

          <t>
   Steps 1-12 are the same as L2TP LNS IPv4 access.  Steps 1-5
   finish the normal L2TP dial-up process.  When the L2TP session and
   tunnel negotiations are finished, the LNS-CP will create an L2TP LNS
   subscriber session on the LNS-UP.  The format of the messages is as
   follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <L2TP-LNS Subscriber TLV>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  <L2TP-LNS Tunnel TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
          <t>
   After that, the LNS-CP will trigger a AAA authentication. If the
   authentication result is positive, a PPP IP6CP process will follow, and
   then the CP will update the session with the following message
   exchanges:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <L2TP-LNS Subscriber TLV>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  <L2TP-LNS Tunnel TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
          <t>
   Then, an ND negotiation will be triggered by the RG.  After the ND
   negotiation, the CP will update the session with the following
   message exchanges:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <L2TP-LAC Subscriber TLV>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  <L2TP-LNS Tunnel TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
        </section>
      </section>
      <section anchor="sect-5.5" numbered="true" toc="default">
        <name>CGN (Carrier Grade NAT)</name>
        <figure anchor="fig27">
          <name>CGN Access</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
       RG              UP                       CP             AAA
       |               |  Public Address Block  |               |
       |               |   Allocation Request   |               |
       |              1|<--------via Ci-------->|               |
       |               |  Public Address Block  |               |
       |               |   Allocation Reply     |               |
       |              2|---------via Ci-------->|               |
       |   Subscriber  |                        |               |
       | Access Request|        Subscriber      |               |
      3|-------------->|      Access Request    |               |
       |              4|----------via Si------->|               |
       |               |                        |      AAA      |
       |               |       Subscriber       |    Req/Rep    |
       |  Subscriber   |      Access Reply     5|<------------->|
       | Access Reply 6|<---------via Si--------|               |
      7|<--------------|                        |               |
       |               |  Create Subscriber     |               |
       |               |   Session Request      |               |
       |              8|<--------via Ci---------|               |
       |               |                        |               |
       |               |  Create Subscriber     |               |
       |               |   Session Response     |               |
       |               | (with NAT information) |               |
       |              9|---------via Ci-------->|               |
       |               |                        |   Accounting  |
       |               |                        |  with source  |
       |               |                        |   information |
       |               |                      10|<------------->|
       |               |                        |  Public IP +  |
       |               |                        |  Port Range   |
       |               |                        |  to Private IP|
       |               |                        |  Mapping      |
       |               |                        |               |]]></artwork>
        </figure>
        <t>
   The first steps allocate one or more CGN address blocks to the UP
   (steps 1-2).  This is achieved by the following message exchanges
   between CP and UP:</t>
        <sourcecode type="rbnf"><![CDATA[
<Addr_Allocation_Req Message> ::= <Common Header>
                  <Address Allocation Request TLV>

<Addr_Allocation_Ack Message> ::= <Common Header>
                 <Address Allocation Response TLV>
]]></sourcecode>
        <t>
   Steps 3-9 show the general dial-up process in the case of CGN mode.
   The specific processes (e.g., IPoE, PPPoE, L2TP, etc.) are defined in
   above sections.</t>
        <t>
   If a subscriber is a CGN subscriber, once the subscriber session is
   created/updated, the UP will report the NAT information to the CP.
   This is achieved by carrying the Subscriber CGN Port Range TLV in
   the Update_Response message.</t>
      </section>
      <section anchor="sect-5.6" numbered="true" toc="default">
        <name>L3 Leased Line Access</name>
        <section anchor="sect-5.6.1" numbered="true" toc="default">
          <name>Web Authentication</name>
          <figure anchor="fig28">
            <name>Web Authentication-Based L3 Leased Line Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG            UP              CP         AAA      Web Server
     | User traffic|                |          |           |
    1|------------>|                |          |           |
     |             | User traffic   |          |           |
     |            2|-----via Si---->|    AAA   |           |
     |             |                |  Req/Rep |           |
     |             |               3|<-------->|           |
     |             | Create Session |          |           |
     |             |    Request     |          |           |
     |            4|<----via Ci-----|          |           |
     |             | Create Session |          |           |
     |             |    Response    |          |           |
     |            5|----via Ci----->|          |           |
     |             |                |          |           |
     | HTTP traffic|                |          |           |
    6|------------>|                |          |           |
     |             |                |          |           |
     | Redirect to |                |          |           |
     |   Web URL   |                |          |           |
    7|<------------|                |          |           |
     |             |                |          |           |
     |                                                     |
    8|-----------------Redirected to Web Server----------->|
     |                                                     |
    9|<----------------Push HTTP Log-in Page---------------|
     |                                                     |
   10|-----------------User Authentication---------------->|
     |                                                     |
     |             |                |  Portal Interchange  |
     |             |              11|<-------------------->|
     |             |                |                      |
     |             |                |   AAA    |           |
     |             |                |  Req/Rep |           |
     |             |              12|<-------->|           |
     |             |                |          |           |
     |             | Update Session |          |           |
     |             |    Request     |          |           |
     |           13|<----via Ci-----|          |           |
     |             | Update Session |          |           |
     |             |    Response    |          |           |
     |           14|----via Ci----->|          |           |
     |             |                |          |           |]]></artwork>
          </figure>
          <t>
   In this case, IP traffic from the RG will trigger the CP to
   authenticate the RG by checking the source IP and the exchanges with
   the AAA server.  Once the RG has passed the authentication, the CP will
   create a corresponding subscriber session on the UP through the
   following message exchanges:</t>

<t>IPv4 Case:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>

                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
]]></sourcecode>

<t>IPv6 Case:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
          <t>
   Then, the HTTP traffic from the RG will be redirected to a web server
   to finish the web authentication.  Once the web authentication is
   passed, the CP will trigger another AAA authentication.  After the
   AAA authentication, the CP will update the session with the following
   message exchanges:</t>

<t>IPv4 Case:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
]]></sourcecode>

<t>IPv6 Case:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
        </section>
        <section anchor="sect-5.6.2" numbered="true" toc="default">
          <name>User Traffic Trigger</name>
          <figure anchor="fig29">
            <name>User Traffic Triggered L3 Leased Line Access</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     RG            UP              CP         AAA
     |             |   L3 access    |          |
     |             |  control list  |          |
     |            1|<----via Ci-----|          |
     |    User     |                |          |
     |   traffic   |                |          |
    2|------------>|                |          |
     |             |  User traffic  |          |
     |            3|-----via Si---->|          |
     |             |                |   AAA    |
     |             |                |  Req/Rep |
     |             |               4|<-------->|
     |             |                |          |
     |             | Create Session |          |
     |             |    Request     |          |
     |            5|<----via Ci-----|          |
     |             | Create Session |          |
     |             |    Response    |          |
     |            6|----via Ci----->|          |
     |             |                |          |]]></artwork>
          </figure>
          <t>
   In this case, the CP must install on the UP an access
   control list, which is used by the UP to determine whether or not
   an RG is legal.  If the traffic is from a legal RG, it will be
   redirected to the CP though the Si.  The CP will trigger a AAA
   interchange with the AAA server.  After that, the CP will create a
   corresponding subscriber session on the UP with the following message
   exchanges:</t>

<t>IPv4 Case:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
]]></sourcecode>

<t>IPv6 Case:</t>
          <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
]]></sourcecode>
        </section>
      </section>
      <section anchor="sect-5.7" numbered="true" toc="default">
        <name>Multicast Service Access</name>
        <figure anchor="fig30">
          <name>Multicast Access</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
           RG            UP              CP         AAA
           | User Access |  User Access   |   AAA    |
           |   Request   |    Request     |  Req/Rep |
          1|<----------->|<----via Si---->|<-------->|
           |             |                |          |
           |             | Create Session |          |
           |             |    Request     |          |
           |            2|<----via Ci---->|          |
           |             |                |          |
           |             | Create Session |          |
           |             |    Response    |          |
           |            3|----via Ci----->|          |
           |             |                |          |
           |  Multicast  |                |          |
           | negotiation |                |          |
          4|<----------->|                |          |
           |             |                |          |]]></artwork>
        </figure>
        <t>
   Multicast access starts with a user access request from the RG. The
   request will be redirected to the CP by the Si.  A follow-up AAA
   interchange between the CP and the AAA server will be triggered.
   After the authentication, the CP will create a multicast subscriber
   session on the UP through the following messages:</t>

<t>IPv4 Case, there will be a Multicast-ProfileV4 sub-TLV present in
   the Subscriber Policy TLV:</t>
        <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
               <Basic Subscriber TLV>
               <IPv4 Subscriber TLV>
               <IPv4 Routing TLV>
               <Subscriber Policy TLV>

<Update_Response Message> ::= <Common Header>
              <Update Response TLV>
              [<Subscriber CGN Port Range TLV>]
]]></sourcecode>

<t>IPv6 Case, there will be a Multicast-ProfileV6 sub-TLV present in
   the Subscriber Policy TLV:</t>
        <sourcecode type="rbnf"><![CDATA[ 
<Update_Request Message> ::= <Common Header>
               <Basic Subscriber TLV>
               <IPv6 Subscriber TLV>
               <IPv6 Routing TLV>
               <Subscriber Policy TLV>

<Update_Response Message> ::= <Common Header>
              <Update Response TLV>
]]></sourcecode>
      </section>
    </section>
    <section anchor="sect-6" numbered="true" toc="default">
      <name>S-CUSP Message Formats</name>
      <t>
   An S-CUSP message consists of a common header followed by a variable-length
   body consisting entirely of TLVs.  Receiving an S-CUSP message with an
   unknown message type or missing mandatory TLV <bcp14>MUST</bcp14> trigger an Error message
   (see <xref target="sect-6.7" format="default"/>) or a Response message with an Error Information TLV (see
   <xref target="sect-7.6" format="default"/>).</t>
      <t>
   Conversely, if a TLV is optional, the TLV may or may not be present.
   Optional TLVs are indicated in the message formats shown in this document
   by being enclosed in square brackets.</t>
      <t>
   This section specifies the format of the common S-CUSP message header
   and lists the defined messages.</t>
      <t>
   Network byte order is used for all multi-byte fields.</t>
      <section anchor="sect-6.1" numbered="true" toc="default">
        <name>Common Message Header</name>
        <figure anchor="fig31">
          <name>S-CUSP Message Common Header</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Ver  |  Resv | Message-Type  |        Message-Length         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |            Reserved           |        Transaction-ID         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <dl newline="false" spacing="normal" indent="3">
          <dt>Ver (4 bits):</dt>
          <dd> The major version of the protocol. This
      document specifies version 1. Different major versions of the protocol
      may have significantly different message structures and formats except
      that the Ver field will always be in the same place at the beginning of
      each message. A successful S-CUSP session depends on the CP and the UP
      both using the same major version of the protocol.
	</dd>
          <dt>Resv (4 bits):</dt>
          <dd> Reserved. <bcp14>MUST</bcp14> be sent as zero and
	ignored on receipt.
	</dd>
          <dt>Message-Type (8 bits):</dt>
          <dd> The set of message types
	specified in this document is listed in <xref target="sect-9.1" format="default"/>.
	</dd>
          <dt>Message-Length (16 bits):</dt>
          <dd> Total length of the S-CUSP
	message including the common header, expressed in number of bytes as
	an unsigned integer.
	</dd>
          <dt>Transaction-ID (16 bits):</dt>
          <dd> This field is used to
	identify requests. It is echoed back in any corresponding
	ACK/Response/Error message. It is <bcp14>RECOMMENDED</bcp14> that a monotonically
	increasing value be used in successive messages and that the value wraps
	back to zero after 0xFFFF.  The content of this field is an opaque
	value that the receiver <bcp14>MUST NOT</bcp14> use for any purpose except to echo
	back in a corresponding response and, optionally, for logging.
	</dd>
        </dl>
      </section>
      <section anchor="sect-6.2" numbered="true" toc="default">
        <name>Control Messages</name>
        <t>
   This document defines the following control messages:</t>

        <table>
	<name>Control Messages</name>
	<thead>
	<tr>
		<th>Type</th>
		<th>Name</th>
		<th>Notes and TLVs that can be carried</th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td>1</td>
		<td>Hello</td>
		<td>Hello TLV, Keepalive TLV</td>
	</tr>
	<tr>
		<td>2</td>
		<td>Keepalive</td>
		<td>A common header with the Keepalive message type</td>
	</tr>
	<tr>
		<td>3</td>
		<td>Sync_Request</td>
		<td>Synchronization request</td>
	</tr>
	<tr>
		<td>4</td>
		<td>Sync_Begin</td>
		<td>Synchronization starts</td>
	</tr>
	<tr>
		<td>5</td>
		<td>Sync_Data</td>
		<td>Synchronization data: TLVs specified in <xref target="sect-7" format="default"/></td>
	</tr>
	<tr>
		<td>6</td>
		<td>Sync_End</td>
		<td>End synchronization</td>
	</tr>
	<tr>
		<td>7</td>
		<td>Update_Request</td>
		<td>TLVs specified in Sections <xref target="sect-7.6" format="counter"/>-<xref target="sect-7.9" format="counter"/></td>
	</tr>
	<tr>
		<td>8</td>
		<td>Update_Response</td>
		<td>TLVs specified in Sections <xref target="sect-7.6" format="counter"/>-<xref target="sect-7.9" format="counter"/></td>
	</tr>
	</tbody>
</table>
        <section anchor="sect-6.2.1" numbered="true" toc="default">
          <name>Hello Message</name>
          <t>
   The Hello message is used for S-CUSP session establishment and version
   negotiation.  The details of S-CUSP session establishment and version
   negotiation can be found in <xref target="sect-4.1.1" format="default"/>.</t>
          <t>
   The format of the Hello message is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Hello Message> ::= <Common Header>
                     <Hello TLV>
                     <Keepalive TLV>
                     [<Error Information TLV>]
]]></sourcecode>
          <t>
   The return code and negotiation result will be carried in the Error
   Information TLV.  They are listed as follows:</t>
          <dl newline="false" spacing="normal" indent="3">
            <dt>0:</dt> 
          <dd> Success. Version negotiation success.
        </dd>
            <dt>1:</dt> 
            <dd> Failure. Malformed message received.
         </dd>
            <dt>2:</dt>
            <dd> TLV-Unknown. One or more of the TLVs was not understood.
         </dd>
            <dt>1001:</dt>
            <dd> Version-Mismatch. The
	version negotiation fails.  The S-CUSP session establishment phase
	fails.
	</dd>
            <dt>1002:</dt>
            <dd> Keepalive Error. The keepalive negotiation fails.  The S-CUSP
	session establishment phase fails.
	</dd>
            <dt>1003:</dt>
            <dd> Timer Expires. The establishment timer expired.  Session
	establishment phase fails.
	</dd>
          </dl>
        </section>
        <section anchor="sect-6.2.2" numbered="true" toc="default">
          <name>Keepalive Message</name>
          <t>
   Each end of an S-CUSP session periodically sends a Keepalive message.
   It is used to detect whether the peer end is still alive.  The
   Keepalive procedures are defined in <xref target="sect-4.1.2" format="default"/>.</t>
          <t>
   The format of the Keepalive message is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Keepalive Message> ::= <Common Header>
]]></sourcecode>
        </section>
        <section anchor="sect-6.2.3" numbered="true" toc="default">
          <name>Sync_Request Message</name>
          <t>
   The Sync_Request message is used to request synchronization from an
   S-CUSP peer.  Both CP and UP can request their peer to synchronize
   data.</t>
          <t>
   The format of the Sync_Request message is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Sync_Request Message> ::= <Common Header>
]]></sourcecode>
          <t>
   A Sync_Request message may result in a Sync_Begin message from its
   peer.  The Sync_Begin message is defined in <xref target="sect-6.2.4" format="default"/>.</t>
        </section>
        <section anchor="sect-6.2.4" numbered="true" toc="default">
          <name>Sync_Begin Message</name>
          <t>
   The Sync_Begin message is a reply to a Sync_Request message.  It is
   used to notify the synchronization requester whether the
   synchronization can be started.</t>
          <t>
   The format of the Sync_Begin message is as follows:</t>
          <sourcecode type="rbnf"><![CDATA[
<Sync_Begin Message> ::= <Common Header>
                        <Error Information TLV>
]]></sourcecode>
          <t>
   The return codes are carried in the Error Information TLV.  The codes
   are listed below:</t>
          <dl newline="false" spacing="normal" indent="3">
          <dt>
   0:</dt><dd> Success. Be ready to synchronize.</dd>
          <dt>
   1:</dt><dd> Failure. Malformed message received.</dd>
          <dt>
   2:</dt><dd> TLV-Unknown. One or more of the TLVs was not understood.</dd>
          <dt>
   2001:</dt><dd> Synch-NoReady.  The data to be synchronized is not ready.</dd>
          <dt>
   2002:</dt><dd> Synch-Unsupport.  The data synchronization is not supported.</dd>
         </dl>
        </section>
        <section anchor="sect-6.2.5" numbered="true" toc="default">
          <name>Sync_Data Message</name>
          <t>
   The Sync_Data message is used to send data being synchronized between
   the CP and UP.  The Sync_Data message has the same function and
   format as the Update_Request message.  The difference is that there
   is no ACK for a Sync_Data message.  An error caused by the Sync_Data
   message will result in a Sync_End message.</t>
          <t>
   There are two scenarios:

          </t>
          <ul spacing="normal">
            <li>
              <t>Synchronization from UP to CP: Synchronize the resource data to CP.

              </t>
              <sourcecode type="rbnf"><![CDATA[
      <Sync_Data Message> ::= <Common Header>
                              [<Interface Status TLV>]
                              [<Board Status TLV>]
]]></sourcecode>
            </li>
            <li>
              <t>Synchronization from CP to UP: Synchronize all subscriber
   sessions to the UP.  The Subscriber TLVs carried are those appearing in 
   <xref target="sect-7.9" format="default"/>. As for which TLVs should be carried, it depends on the
   specific session data to be synchronized.  The process is equivalent to the
   creation of a particular session.  Refer to <xref target="sect-5" format="default"/> to see
   more details.
   
              </t>
<sourcecode type="rbnf"><![CDATA[
      <Sync_Data Message> ::= <Common Header>
                           [<IPv4 Routing TLV>]
                           [<IPv6 Routing TLV>]
                           [<Subscriber TLVs>]
]]></sourcecode>
            </li>
          </ul>
        </section>
        <section anchor="sect-6.2.6" numbered="true" toc="default">
          <name>Sync_End Message</name>
          <t>
   The Sync_End message is used to indicate the end of a synchronization
   process.  The format of a Sync_End message is as follows:</t>
<sourcecode type="rbnf"><![CDATA[
<Sync_End Message> ::= <Common Header>
                        <Error Information TLV>
]]></sourcecode>
          <t>The return/error codes are listed as follows:

</t>
          <dl newline="false" spacing="normal" indent="3">
            <dt>0:</dt><dd> Success. Synchronization finished.</dd>
            <dt>1:</dt><dd> Failure. Malformed message received.</dd>
            <dt>2:</dt><dd> TLV-Unknown. One or more of the TLVs was not understood.</dd>
          </dl>
        </section>
        <section anchor="sect-6.2.7" numbered="true" toc="default">
          <name>Update_Request Message</name>
          <t>
   The Update_Request message is a multipurpose message; it can be used
   to create, update, and delete subscriber sessions on a UP.</t>
          <t>
   For session operations, the specific operation is controlled by the
   Oper field of the carried TLVs.  As defined in <xref target="sect-7.1" format="default"/>, the
   Oper field can be set to either Update or Delete when a TLV is
   carried in an Update_Request message.</t>
          <t>
   When the Oper field is set to Update, it means to create or update a
   subscriber session. If the Oper field is set to Delete, it is a request to
   delete a corresponding session.</t>
          <t>
   The format of the Update_Request message is as follows:</t>
              <sourcecode type="rbnf"><![CDATA[
<Update_Request Message> ::= <Common Header>
                        [<IPv4 Routing TLV>]
                        [<IPv6 Routing TLV>]
                        [<Subscriber TLVs>]
]]></sourcecode>
          <t>
   Where the Subscriber TLVs are those appearing in
   <xref target="sect-7.9" format="default"/>.
   Each Update_Request message will result in an Update_Response message,
   which is defined in <xref target="sect-6.2.8" format="default"/>.</t>
        </section>
        <section anchor="sect-6.2.8" numbered="true" toc="default">
          <name>Update_Response Message</name>
          <t>
   The Update_Response message is a response to an Update_Request
   message.  It is used to confirm the update request (or reject it in
   the case of an error).  The format of an Update_Response message is
   as follows:</t>
              <sourcecode type="rbnf"><![CDATA[
<Update_Response Message> ::= <Common Header>
                        [<Subscriber CGN Port Range TLV>]
                        <Error Information TLV>
]]></sourcecode>
          <t>
   The return/error codes are carried in the Error Information TLV.
   They are listed as follows:</t>
          <dl newline="false" spacing="normal" indent="3">
            <dt>0:</dt>
            <dd> Success.</dd>
            <dt>1:</dt>
            <dd> Failure. Malformed message received.</dd>
            <dt>2:</dt>
            <dd> TLV-Unknown. One or more of the TLVs was not understood.</dd>
            <dt>3001:</dt>
            <dd> Pool-Mismatch. The corresponding address pool
        cannot be found.</dd>
            <dt>3002:</dt>
            <dd> Pool-Full. The address pool is fully allocated,
	and no address segment is available.</dd>
            <dt>3003:</dt>
            <dd> Subnet-Mismatch. The address pool subnet cannot
	be found.</dd>
            <dt>3004:</dt>
            <dd> Subnet-Conflict. Subnets in the address pool
	have been classified into other clients.</dd>
            <dt>4001:</dt>
            <dd> Update-Fail-No-Res. The forwarding table fails
	to be delivered because the forwarding resources are insufficient.</dd>
            <dt>4002:</dt>
            <dd> QoS-Update-Success. The QoS policy takes effect.</dd>
            <dt>4003:</dt>
            <dd> QoS-Update-Sq-Fail. Failed to process the queue
	in the QoS policy.</dd>
            <dt>4004:</dt>
            <dd> QoS-Update-CAR-Fail. Processing of the CAR in
	the QoS policy fails.</dd>
            <dt>4005:</dt>
            <dd> Statistic-Fail-No-Res. Statistics processing
	failed due to insufficient statistics resources.</dd>
          </dl>
        </section>
      </section>
      <section anchor="sect-6.3" numbered="true" toc="default">
        <name>Event Message</name>
        <t>
   The Event message is used to report subscriber session traffic
   statistics and detection information.  The format of the Event message is
   as follows:</t>
              <sourcecode type="rbnf"><![CDATA[
<Event Message> ::= <Common Header>
                        [<Subscriber Traffic Statistics Report TLV>]
                        [<Subscriber Detection Result Report TLV>]
]]></sourcecode>
      </section>
      <section anchor="sect-6.4" numbered="true" toc="default">
        <name>Report Message</name>
        <t>
   The Report message is used to report board and interface status on a
   UP.  The format of the Report message is as follows:</t>
              <sourcecode type="rbnf"><![CDATA[
<Report Message> ::= <Common Header>
                        [<Board Status TLVs>]
                        [<Interface Status TLVs>]
]]></sourcecode>
      </section>
      <section anchor="sect-6.5" numbered="true" toc="default">
        <name>CGN Messages</name>
        <t>
   This document defines the following resource allocation messages:</t>
<table>
  <name>Resource Allocation Messages</name>
  <thead>
    <tr>
      <th>Type</th><th>Message Name</th><th>TLV that is carried</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>200</td><td>Addr_Allocation_Req</td><td>Address Allocation Request</td>
    </tr>
    <tr>
      <td>201</td><td>Addr_Allocation_Ack</td><td>Address Allocation Response</td>
    </tr>
    <tr>
      <td>202</td><td>Addr_Renew_Req</td><td>Address Renewal Request</td>
    </tr>
    <tr>
      <td>203</td><td>Addr_Renew_Ack</td><td>Address Renewal Response</td>
    </tr>
    <tr>
      <td>204</td><td>Addr_Release_Req</td><td>Address Release Request</td>
    </tr>
    <tr>
      <td>205</td><td>Addr_Release_Ack</td><td>Address Release Response</td>
    </tr>
  </tbody>
</table>
        <section anchor="sect-6.5.1" numbered="true" toc="default">
          <name>Addr_Allocation_Req Message</name>
          <t>
   The Addr_Allocation_Req message is used to request CGN address
   allocation.  The format of the Addr_Allocation_Req message is as follows:</t>
              <sourcecode type="rbnf"><![CDATA[
<Addr_Allocation_Req Message> ::= <Common Header>
                        <Address Allocation Request TLV>
]]></sourcecode>
        </section>
        <section anchor="sect-6.5.2" numbered="true" toc="default">
          <name>Addr_Allocation_Ack Message</name>
          <t>
   The Addr_Allocation_Ack message is a response to an
   Addr_Allocation_Req message.  The format of the Addr_Allocation_Ack
   message is as follows:</t>
              <sourcecode type="rbnf"><![CDATA[
<Addr_Allocation_Ack Message> ::= <Common Header>
                        <Address Allocation Response TLV>
]]></sourcecode>
        </section>
        <section anchor="sect-6.5.3" numbered="true" toc="default">
          <name>Addr_Renew_Req Message</name>
          <t>
   The Addr_Renew_Req message is used to request address renewal.  The
   format of the Addr_Renew_Req message is as follows:</t>
              <sourcecode type="rbnf"><![CDATA[
<Addr_Renew_Req Message> ::= <Common Header>
                        <Address Renewal Request TLV>
]]></sourcecode>
        </section>
        <section anchor="sect-6.5.4" numbered="true" toc="default">
          <name>Addr_Renew_Ack Message</name>
          <t>
   The Addr_Renew_Ack message is a response to an Addr_Renew_Req
   message.  The format of the Addr_Renew_Req message is as follows:</t>
              <sourcecode type="rbnf"><![CDATA[
<Addr_Renew_Ack Message> ::= <Common Header>
                        <Address Renewal Response TLV>
]]></sourcecode>
        </section>
        <section anchor="sect-6.5.5" numbered="true" toc="default">
          <name>Addr_Release_Req Message</name>
          <t>
   The Addr_Release_Req message is used to request address release.  The
   format of the Addr_Release_Req message is as follows:</t>
              <sourcecode type="rbnf"><![CDATA[
<Addr_Release_Req Message> ::= <Common Header>
                        <Address Release Request TLV>
]]></sourcecode>
        </section>
        <section anchor="sect-6.5.6" numbered="true" toc="default">
          <name>Addr_Release_Ack Message</name>
          <t>
   The Addr_Release_Ack message is a response to an Addr_Release_Req
   message.  The format of the Addr_Release_Ack message is as follows:</t>
              <sourcecode type="rbnf"><![CDATA[
<Addr_Release_Ack Message> ::= <Common Header>
                        <Address Release Response TLV>
]]></sourcecode>
        </section>
      </section>
      <section anchor="sect-6.6" numbered="true" toc="default">
        <name>Vendor Message</name>
        <t>
   The Vendor message, in conjunction with the Vendor TLV and Vendor
   sub-TLV, can be used by vendors to extend S-CUSP. The
   Message-Type is 11. If the receiver does not recognize the message,
   an Error message will be returned to the sender.</t>
        <t>
   The format of the Vendor message is as follows:</t>
              <sourcecode type="rbnf"><![CDATA[
<Vendor Message> ::= <Common Header>
                     <Vendor TLV>
                     [<any other TLVs as specified by the vendor>]
]]></sourcecode>
      </section>
      <section anchor="sect-6.7" numbered="true" toc="default">
        <name>Error Message</name>
        <t>
   The Error message is defined to return some critical error
   information to the sender.  If a receiver does not support the type
   of the received message, it <bcp14>MUST</bcp14> return an Error message to the
   sender.</t>
        <t>
   The format of the Error message is as below:</t>
              <sourcecode type="rbnf"><![CDATA[
<Error Message> ::= <Common Header>
                    <Error Information TLV>
]]></sourcecode>
      </section>
    </section>

    <section anchor="sect-7" numbered="true" toc="default">
      <name>S-CUSP TLVs and Sub-TLVs</name>
      <t>
   This section specifies the following:</t>
      <ul spacing="normal">
        <li>The format of the TLVs that appear in S-CUSP messages,</li>
        <li>The format of the sub-TLVs that appear within the values of some
     TLVs, and</li>
        <li>The format of some basic data fields that appear within TLVs or
     sub-TLVs.</li>
      </ul>
      <t>
   See <xref target="sect-9" format="default"/> for a list of all defined TLVs and sub-TLVs.</t>
      <section anchor="sect-7.1" numbered="true" toc="default">
        <name>Common TLV Header</name>
        <t>
   S-CUSP messages consist of the common header specified in <xref target="sect-6.1" format="default"/>
   followed by TLVs formatted as specified in this section.</t>
        <figure anchor="fig32">
          <name>Common TLV Header</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Oper  |      TLV-Type         |       TLV-Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                             Value                             ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <dl newline="false" spacing="normal" indent="3">
          <dt>Oper (4 bits):</dt>
          <dd> For Message-Types that specify an
        operation on a data set, the Oper field is interpreted as Update,
        Delete, or Reserved as specified in <xref target="sect-9.3" format="default"/>. For all
        other Message-Types, the Oper field <bcp14>MUST</bcp14> be sent as zero and ignored
        on receipt.</dd>
          <dt>TLV-Type (12 bits):</dt>
          <dd> The type of a TLV. TLV-Type
	specifies the interpretation and format of the Value field of the TLV.
	See <xref target="sect-9.2" format="default"/>.</dd>
          <dt>TLV-Length (2 bytes):</dt>
          <dd> The length of the Value portion
	of the TLV in bytes as an unsigned integer.
	</dd>
          <dt>Value (variable length):</dt>
          <dd> This is the portion of
	the TLV whose size is given by TLV-Length. It consists
	of fields, frequently using one of the basic data field types (see
	<xref target="sect-7.2" format="default"/>) and sub-TLVs (see <xref target="sect-7.3" format="default"/>).
	</dd>
        </dl>
      </section>
      <section anchor="sect-7.2" numbered="true" toc="default">
        <name>Basic Data Fields</name>
        <t>
   This section specifies the binary format of several standard basic
   data fields that are used within other data structures in this
   specification.</t>
        <dl newline="false" spacing="normal" indent="3">
          <dt>STRING:</dt>
          <dd> 0 to 255 octets. Will be encoded as a sub-TLV
        (see <xref target="sect-7.3" format="default"/>) to provide the length. The use of this data type in
        S-CUSP is to provide convenient labels for use by network operators in
        configuring and debugging their networks and interpreting S-CUSP
        messages.  Subscribers will not normally see these labels. They are
        normally interpreted as ASCII <xref target="RFC0020" format="default"/>. </dd>
          <dt>MAC-Addr:</dt>
          <dd> 6 octets. Ethernet MAC address <xref target="RFC7042" format="default"/>.</dd>
          <dt>IPv4-Address:</dt>
          <dd> 8 octets. 4 octets of the IPv4 address
	value followed by a 4-octet address mask in the format
	XXX.XXX.XXX.XXX.</dd>
          <dt>IPv6-Address:</dt>
          <dd> 20 octets. 16 octets of the IPv6 address
	followed by a 4-octet integer n in the range of 0 to 128, which gives
	the address mask as the one's complement of 2**(128-n) - 1.
	</dd>
          <dt>VLAN ID:</dt>
          <dd> <t>2 octets. As follows <xref target="IEEE-802.1Q" format="default"/>:</t>
        <artwork name="" type="" align="left" alt=""><![CDATA[
       0                   1
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | PRI |D|      VLAN-ID          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        <dl newline="false" spacing="normal" indent="3">
          <dt>PRI:</dt>
          <dd> Priority. Default value 7.</dd>
          <dt>D:</dt>
          <dd> Drop Eligibility Indicator (DEI). Default value 0.</dd>
          <dt>VLAN-ID:</dt>
          <dd> Unsigned integer in the range 1-4094. (0 and
      4095 are not valid VLAN IDs <xref target="IEEE-802.1Q" format="default"/>.)</dd>
        </dl></dd>
        </dl>
      </section>
      <section anchor="sect-7.3" numbered="true" toc="default">
        <name>Sub-TLV Format and Sub-TLVs</name>
        <t>
   In some cases, the Value portion of a TLV, as specified in <xref target="sect-7.1" format="default"/>, can
   contain one or more sub-TLVs formatted as follows:</t>
        <figure anchor="fig33">
          <name>Sub-TLV Header</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |              Type             |          Length               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Value                                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...
]]></artwork>
        </figure>
        <dl newline="false" spacing="normal" indent="3">
          <dt>Type (2 bytes):</dt>
          <dd> The type of a sub-TLV. The Type field
        specifies the interpretation and format of the Value field of the TLV.
        Sub-TLV type values have the same meaning regardless of the TLV type of
        the TLV within which the sub-TLV occurs. See <xref target="sect-9.4" format="default"/>.</dd>
          <dt>Length (2 bytes):</dt>
          <dd> The length of the Value portion of
        the sub-TLV in bytes as an unsigned integer.</dd>
          <dt>Value (variable length):</dt>
          <dd> This is the Value portion of
	the sub-TLV whose size is given by Length.</dd>
        </dl>
        <t>
   The sub-TLVs currently specified are defined in the following
   subsections.</t>
        <section anchor="sect-7.3.1" numbered="true" toc="default">
          <name>Name Sub-TLVs</name>
          <t>
   This document defines the following name sub-TLVs that are used to
   carry the name of the corresponding object.  The length of each of
   these sub-TLVs is variable from 1 to 255 octets. The value is of 
   type STRING padded with zero octets to a length in octets that is 
   an integer multiple of 4.</t>
<table>
  <name>Name Sub-TLVs</name>
  <thead>
    <tr>
      <th>Type</th><th>Sub-TLV Name</th><th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
       <td>1</td><td>VRF-Name</td><td>The name of a VRF</td>
    </tr>
    <tr>
       <td>2</td><td>Ingress-QoS-Profile</td><td>The name of an ingress QoS profile</td>
    </tr>
    <tr>
       <td>3</td><td>Egress-QoS-Profile</td><td>The name of an egress QoS profile</td>
    </tr>
    <tr>
       <td>4</td><td>User-ACL-Policy</td><td>The name of an ACL policy</td>
    </tr>
    <tr>
       <td>5</td><td>Multicast-ProfileV4</td><td>The name of an IPv4 multicast profile</td>
    </tr>
    <tr>
       <td>6</td><td>Multicast-ProfileV6</td><td>The name of an IPv6 multicast profile</td>
    </tr>
    <tr>
       <td>9</td><td>NAT-Instance</td><td>The name of a NAT instance</td>
    </tr>
    <tr>
       <td>10</td><td>Pool-Name</td><td>The name of an address pool</td>
    </tr>
  </tbody>
</table>
        </section>

        <section anchor="sect-7.3.2" numbered="true" toc="default">
          <name>Ingress-CAR Sub-TLV</name>
          <t>
   The Ingress-CAR sub-TLV indicates the authorized upstream Committed
   Access Rate (CAR) parameters. The sub-TLV type of the Ingress-CAR
   sub-TLV is 7. The sub-TLV length is 16. The format is as shown in
   <xref target="fig34" format="default"/>.</t>
          <figure anchor="fig34">
            <name>Ingress-CAR Sub-TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  CIR (Committed Information Rate)             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  PIR (Peak Information Rate)                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  CBS (Committed Burst Size)                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  PBS (Peak Burst Size)                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>

          <t> Where:
          </t>

<ul empty="true"><li>
          <dl newline="false" spacing="normal">
            <dt>CIR (4 bytes):</dt><dd>Guaranteed rate in bits/second.</dd>
            <dt>PIR (4 bytes):</dt><dd>Burst rate in bits/second.</dd>
            <dt>CBS (4 bytes):</dt><dd>The token bucket in bytes.</dd>
            <dt>PBS (4 bytes):</dt><dd>Burst token bucket in bytes.</dd>
          </dl>
</li></ul>
          <t>
   These fields are unsigned integers. More details about CIR, PIR, CBS,
   and PBS can be found in <xref target="RFC2698" format="default"/>.</t>
        </section>
        <section anchor="sect-7.3.3" numbered="true" toc="default">
          <name>Egress-CAR Sub-TLV</name>
          <t>
   The Egress-CAR sub-TLV indicates the authorized downstream Committed Access
   Rate (CAR) parameters. The sub-TLV type of the Egress-CAR sub-TLV is
   8. Its sub-TLV length is 16 octets. The format of the value part is as
   defined below.</t>
          <figure anchor="fig35">
            <name>Egress-CAR Sub-TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  CIR (Committed Information Rate)             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  PIR (Peak Information Rate)                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  CBS (Committed Burst Size)                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  PBS (Peak Burst Size)                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

          
<ul empty="true"><li>
          <dl newline="false" spacing="normal">
            <dt>CIR (4 bytes):</dt><dd>Guaranteed rate in bits/second.</dd>
            <dt>PIR (4 bytes):</dt><dd>Burst rate in bits/second.</dd>
            <dt>CBS (4 bytes):</dt><dd>The token bucket in bytes.</dd>
            <dt>PBS (4 bytes):</dt><dd>Burst token bucket in bytes.</dd>
          </dl>

</li></ul>

          <t>
   These fields are unsigned integers. More details about CIR, PIR, CBS,
   and PBS can be found in <xref target="RFC2698" format="default"/>.</t>
        </section>
        <section anchor="sect-7.3.4" numbered="true" toc="default">
          <name>If-Desc Sub-TLV</name>
          <t>
   The If-Desc sub-TLV is defined to designate an interface.  It is an
   optional sub-TLV that may be carried in those TLVs that have an If-Index
   or Out-If-Index field. The If-Desc sub-TLV is used as a locally unique
   identifier within a BNG.</t>
          <t>
   The sub-TLV type is 11.  The sub-TLV length is 12 octets.  The format
   depends on the If-Type (<xref target="sect-9.6" format="default"/>). 
   The format of the value part is as follows:</t>
          <figure anchor="fig36">
            <name>If-Desc Sub-TLV Formats</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  If-Type (1-5)|    Chassis    |             Slot              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Sub-Slot            |            Port Number        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Sub-Port Number                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                 If-Desc Sub-TLV (Physical Port)

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| If-Type (6-7) |                Reserved                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            Logic-ID                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Sub-Port Number                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                  If-Desc Sub-TLV (Virtual Port)
]]></artwork>
          </figure>

          <t>Where:
          </t>
          
<ul empty="true"><li>
          <dl newline="false" spacing="normal">
            <dt>If-Type:</dt><dd>8 bits in length. The value of this field indicates the
      type of an interface.  The If-Type values defined in this document
      are listed in <xref target="sect-9.6" format="default"/>.</dd>
            <dt>Chassis (8 bits):</dt><dd>Identifies the chassis that the interface
      belongs to.</dd>
            <dt>Slot (16 bits):</dt><dd>Identifies the slot that the interface belongs to.</dd>
            <dt>Sub-Slot (16 bits):</dt><dd>Identifies the sub-slot the interface belongs to.</dd>
            <dt>Port Number (16 bits):</dt><dd>An identifier of a physical port/interface
      (e.g., If-Type: 1-5). It is locally significant within the
      slot/sub-slot.</dd>
            <dt>Sub-Port Number (32 bits):</dt><dd>An identifier of the sub-port. Locally
      significant within its "parent" port (physical or virtual).</dd>
            <dt>Logic-ID (32 bits):</dt><dd>An identifier of a virtual interface (e.g.,
      If-Type: 6-7).</dd>

          </dl>
</li></ul>

        </section>
        <section anchor="sect-7.3.5" numbered="true" toc="default">
          <name>IPv6 Address List Sub-TLV</name>
          <t>
   The IPv6 Address List sub-TLV is used to convey one or more IPv6
   addresses.  It is carried in the IPv6 Subscriber TLV.  The sub-TLV
   type is 12. The sub-TLV length is variable.</t>
          <t>The format of the value part of the IPv6 Address List sub-TLV is as follows:</t>
          <figure anchor="fig37">
            <name>IPv6 Address List Sub-TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                        IPv6 Address                           ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                        IPv6 Address                           ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                            ...                                ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                        IPv6 Address                           ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>
<ul empty="true"><li>
          <dl newline="false" spacing="normal">

            <dt>IPv6 Address (IPv6-Address):</dt><dd>Each IP Address is of
            type IP-Address and carries an IPv6 address and length.</dd>

          </dl>
</li></ul>

        </section>
        <section anchor="sect-7.3.6" numbered="true" toc="default">
          <name>Vendor Sub-TLV</name>
          <t>
   The Vendor sub-TLV is intended to be used inside the Value portion of
   the Vendor TLV (<xref target="sect-7.13" format="default"/>). It provides a Sub-Type that
   effectively extends the sub-TLV type in the sub-TLV header and
   provides for versioning of Vendor sub-TLVs.</t>
          <t>The value part of the Vendor sub-TLV is formatted as follows:</t>
          <figure anchor="fig38">
            <name>Vendor Sub-TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Vendor-ID                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           Sub-Type            |       Sub-Type-Version        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~             Value (other as specified by vendor)              ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>
          <dl newline="false" spacing="normal">

            <dt>Sub-TLV type:</dt><dd>13.</dd>
            <dt>Sub-TLV length:</dt><dd>Variable.</dd>
            <dt>Vendor-ID (4 bytes):</dt><dd>Vendor ID as defined in RADIUS <xref target="RFC2865" format="default"/>.</dd>
            <dt>Sub-Type (2 bytes):</dt><dd>Used by the vendor to distinguish multiple
	different sub-TLVs.</dd>
            <dt>Sub-Type-Version (2 bytes):</dt><dd>Used by the vendor to distinguish
	different versions of a vendor-defined sub-TLV Sub-Type.</dd>
            <dt>Value:</dt><dd>As specified by the vendor.</dd>
          </dl>
</li></ul>

          <t>
   Since vendor code will be handling the sub-TLV after the Vendor-ID
   field is recognized, the remainder of the sub-TLV can be organized
   however the vendor wants. But it desirable for a vendor to be able to
   define multiple different Vendor sub-TLVs and to keep track of
   different versions of its vendor-defined sub-TLVs. Thus, it is
   <bcp14>RECOMMENDED</bcp14> that the vendor assign a Sub-Type value for each of that
   vendor's sub-TLVs that is different from other Sub-Type values that
   vendor has used. Also, when modifying a vendor-defined sub-TLV in a
   way potentially incompatible with a previous definition, the vendor
   <bcp14>SHOULD</bcp14> increase the value it is using in the Sub-Type-Version field.</t>
        </section>
      </section>
      <section anchor="sect-7.4" numbered="true" toc="default">
        <name>Hello TLV</name>
        <t>
   The Hello TLV is defined to be carried in the Hello message for version and
   capabilities negotiation.  It indicates the S-CUSP sub-version and
   capabilities supported.  The format of the value part of the Hello TLV is as follows:</t>
        <figure anchor="fig39">
          <name>Hello TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          VerSupported                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Vendor-ID                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Capabilities                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <t>Where:
        </t>

<ul empty="true"><li>
          <dl newline="false" spacing="normal">
          <dt>TLV type:</dt><dd>100.</dd>
          <dt>TLV length:</dt><dd>12 octets.</dd>
          <dt>VerSupported:</dt><dd>32 bits in length. It is a bit map of the
              Sub-Versions of S-CUSP that the sender supports.  This document
              specifies Sub-Version zero of Major Version 1, that is, Version
              1.0. The VerSupported field <bcp14>MUST</bcp14> be nonzero. The
              VerSupported bits are numbered from 0 as the most significant
              bit. Bit 0 indicates support of Sub-Version zero, bit 1
              indicates support of Sub-Version one, etc.</dd>
          <dt>Vendor-ID:</dt><dd>4 bytes in length. Vendor ID, as defined in RADIUS
              <xref target="RFC2865" format="default"/>.</dd>
          <dt>Capabilities:</dt><dd>32 bits in length. Flags that indicate the
              support of particular capabilities by the sender of the Hello.
              No capabilities are defined in this document, so implementations
              of the version specified herein will set this field to zero. The
              Capabilities field of the Hello TLV <bcp14>MUST</bcp14> be
              checked before any other TLVs in the Hello because capabilities
              defined in the future might extend existing TLVs or permit new
              TLVs.</dd>
          </dl>
</li></ul>

        <t>
   After the exchange of Hello messages, the CP and UP each perform a
   logical AND of the Sub-Version supported by the CP and the UP and
   separately perform a logical AND of the Capabilities field for
   the CP and the UP.</t>
        <t>
   If the result of the AND of the Sub-Versions supported is zero, then
   no session can be established, and the connection is torn down. If the
   result of the AND of the Sub-Versions supported is nonzero, then the
   session uses the highest Sub-Version supported by both the CP and UP.</t>
        <t>
   For example, if one side supports Sub-Versions 1, 3, 4, and 5
   (VerSupported = 0x5C000000) and the other side supports 2, 3, and 4
   (VerSupported = 0x38000000), then 3 and 4 are the Sub-Versions in
   common, and 4 is the highest Sub-Version supported by both sides. So
   Sub-Version 4 is used for the session that has been negotiated.</t>
        <t>
   The result of the logical AND of the Capabilities bits will show what
   additional capabilities both sides support. If this result is zero,
   there are no such capabilities, so none can be used during the
   session. If this result is nonzero, it shows the additional
   capabilities that can be used during the session. The CP and the UP
   <bcp14>MUST NOT</bcp14> use a capability unless both advertise support.</t>
      </section>
      <section anchor="sect-7.5" numbered="true" toc="default">
        <name>Keepalive TLV</name>
        <t>
   The Keepalive TLV is carried in the Hello message.  It provides
   timing information for this feature.  The format of the value part of 
   the Keepalive TLV is as follows:</t>
        <figure anchor="fig40">
          <name>Keepalive TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Keepalive   | DeadTimer     |            Reserved           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <t>Where:
        </t>

<ul empty="true"><li>
          <dl newline="false" spacing="normal">

          <dt>TLV type:</dt><dd>102.</dd>
          <dt>TLV length:</dt><dd>4 octets.</dd> 

<dt>Keepalive (8 bits):</dt><dd>Indicates the maximum interval (in seconds)
between two consecutive S-CUSP messages sent by the sender of the message
containing this TLV as an unsigned integer. The minimum value for the
Keepalive field is 1 second. When set to 0, once the session is established,
no further Keepalive messages are sent to the remote peer. A
<bcp14>RECOMMENDED</bcp14> value for the Keepalive frequency is 30
seconds.</dd> 

<dt>DeadTimer (8 bits in length):</dt><dd>Specifies the amount
of time as an unsigned integer number of seconds, after the expiration of
which, the S-CUSP peer can declare the session with the sender of the Hello
message to be down if no S-CUSP message has been received.  The DeadTimer
<bcp14>SHOULD</bcp14> be set to 0 and <bcp14>MUST</bcp14> be ignored if the
Keepalive is set to 0. A <bcp14>RECOMMENDED</bcp14> value for the DeadTimer is
4 times the value of the Keepalive.</dd>

          <dt>Reserved:</dt><dd>The Reserved bits <bcp14>MUST</bcp14> be sent as zero and
          ignored on receipt.</dd>

          </dl>
</li></ul>

      </section>

      <section anchor="sect-7.6" numbered="true" toc="default">
        <name>Error Information TLV</name>
        <t>
   The Error Information TLV is a common TLV that can be used in many
   responses (e.g., Update_Response message) and ACK messages (e.g.,
   Addr_Allocation_Ack message).  It is used to convey the
   information about an error in the received S-CUSP message.  The
   format of the value part of the Error Information TLV is as follows:</t>
        <figure anchor="fig41">
          <name>Error Information TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Message-Type  |  Reserved             |  TLV-Type             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Error Code                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <t>Where:
        </t>

<ul empty="true"><li>
          <dl newline="false" spacing="normal">

          <dt>TLV type:</dt><dd>101.</dd>
          <dt>TLV length:</dt><dd>8 octets.</dd>
          <dt>Message-Type (1 byte):</dt><dd>This parameter is the message type of the
	message containing an error.</dd>
          <dt>Reserved (1 byte):</dt><dd><bcp14>MUST</bcp14> be sent as zero and ignored on receipt.</dd>
          <dt>TLV-Type (2 bytes):</dt><dd>Indicates which TLV caused the error.</dd>
          <dt>Error Code:</dt><dd>4 bytes in length.  Indicate the specific Error Code
	(see <xref target="sect-9.5" format="default"/>).</dd>

          </dl>
</li></ul>

      </section>
      <section anchor="sect-7.7" numbered="true" toc="default">
        <name>BAS Function TLV</name>
        <t>
   The BAS Function TLV is used by a CP to control the access mode,
   authentication methods, and other related functions of an interface
   on a UP.</t>
        <t>The format of the BAS Function TLV value part is as follows:</t>
        <figure anchor="fig42">
          <name>BAS Function TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          If-Index                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Access-Mode  |  Auth-Method4 |  Auth-Method6 |    Reserved   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                             Flags                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         Sub-TLVs (optional)                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>

        <t>Where:
        </t>

<ul empty="true"><li>
          <dl newline="false" spacing="normal">

          <dt>TLV type:</dt><dd>1.</dd>

          <dt>TLV length:</dt><dd>Variable.</dd>

          <dt>If-Index:</dt><dd>4 bytes in length, a unique identifier of an interface of
	a BNG.</dd>

          <dt>Access-Mode:</dt><dd>1 byte in length. It indicates the access mode of the
	interface.  The defined values are listed in <xref target="sect-9.7"
	format="default"/>.</dd>

          <dt>Auth-Method4:</dt><dd>1 byte in length. It indicates the authentication on
	this interface for the IPv4 scenario. This field is defined as a
	bitmap.  The bits defined in this document are listed in <xref target="sect-9.8" format="default"/>. Other bits are reserved and <bcp14>MUST</bcp14> be sent as zero
	and ignored on receipt.</dd>

          <dt>Auth-Method6:</dt><dd>1 byte in length. It indicates the authentication on
	this interface for the IPv6 scenario. This field is defined as a
	bitmap.  The bits defined in this document are listed in <xref target="sect-9.8" format="default"/>. Other bits are reserved and <bcp14>MUST</bcp14> be sent as zero
	and ignored on receipt.</dd>

          <dt>Sub-TLVs:</dt><dd><t>The IF-Desc sub-TLV can be carried.</t>

          <dl newline="false" spacing="normal">
          <dt>If-Desc sub-TLV:</dt><dd>Carries the interface information.</dd>
          </dl>
        </dd>


          <dt>Flags:</dt><dd>The Flags field is defined as follows:</dd>

	</dl>
</li></ul>

        <figure anchor="fig43">
          <name>Interface Flags</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                MBZ                            |Y|X|P|I|N|A|S|F|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>

        <t>Where:
        </t>

<ul empty="true">
  <li>
    <dl newline="false" spacing="normal">

      <dt>F (IPv4 Trigger) bit:</dt>
         <dd>
           <t>Indicates whether IPv4 packets can trigger a
	      subscriber to go online.</t>
           <dl newline= "false" spacing="normal">
              <dt>1:</dt><dd>Enabled.</dd>
              <dt>0:</dt><dd>Disabled.</dd>
           </dl>
         </dd>

      <dt>S (IPv6 Trigger) bit:</dt><dd><t>Indicates whether IPv6 packets can trigger a
	subscriber to go online.</t>

          <dl newline= "false" spacing="normal">
            <dt>1:</dt><dd>Enabled.</dd>
            <dt>0:</dt><dd>Disabled.</dd>
          </dl>

        </dd>

     <dt>A (ARP Trigger) bit:</dt><dd><t>Indicates whether ARP packets can trigger
	a subscriber to go online.</t>

          <dl newline= "false" spacing="normal">
            <dt>1:</dt><dd>Enabled.</dd>
            <dt>0:</dt><dd>Disabled.</dd>
          </dl>

        </dd>

      <dt>N (ND Trigger) bit:</dt><dd><t>Indicates whether ND packets can trigger a
	subscriber to go online.</t>

          <dl newline= "false" spacing="normal">
            <dt>1:</dt><dd>Enabled.</dd>
            <dt>0:</dt><dd>Disabled.</dd>
          </dl>

        </dd>

      <dt>I (IPoE-Flow-Check):</dt><dd><t>Used for UP detection.</t>

          <dl newline= "false" spacing="normal">
            <dt>1:</dt><dd>Enable traffic detection.</dd>
            <dt>0:</dt><dd>Disable traffic detection.</dd>
          </dl>

        </dd>

      <dt>P (PPP-Flow-Check) bit:</dt><dd><t>Used for UP detection.</t>

          <dl newline= "false" spacing="normal">
            <dt>1:</dt><dd>Enable traffic detection.</dd>
            <dt>0:</dt><dd>Disable traffic detection.</dd>
          </dl>

        </dd>
       <dt>X (ARP-Proxy) bit:</dt><dd><t>Indicates whether ARP proxy is enabled on the interface.</t>
          <dl newline= "false" spacing="normal">
            <dt>1:</dt><dd>The interface is enabled with ARP proxy and can
            process ARP requests across different network ports and VLANs.</dd>
            <dt>0:</dt><dd>The ARP proxy is not enabled on the interface and
            only the ARP requests of the same network port and VLAN are processed.</dd>
          </dl>

        </dd>

       <dt>Y (ND-Proxy) bit:</dt><dd><t>Indicates whether ND proxy is enabled on the interface.</t>
          <dl newline= "false" spacing="normal">
            <dt>1:</dt><dd>The interface is enabled with ND proxy and can
            process ND requests across different network ports and VLANs.</dd>
            <dt>0:</dt><dd>The ND proxy is not enabled on the interface and
            only the ND requests of the same network port and VLAN are processed.</dd>
          </dl>

        </dd>
   
       <dt>MBZ:</dt><dd>Reserved bits that <bcp14>MUST</bcp14> be sent as
          zero and ignored on receipt.</dd>
          </dl>

  </li>
</ul>

      </section>
      <section anchor="sect-7.8" numbered="true" toc="default">
        <name>Routing TLVs</name>
        <t>
   Typically, after an S-CUSP session is established between a UP and a
   CP, the CP will allocate one or more blocks of IP addresses to the
   UP.  Those IP addresses will be allocated to subscribers who will
   dial-up (as defined in <xref target="sect-4.3.1" format="default"/>) to the UP.  To make sure that
   other nodes within the network learn how to reach those IP addresses,
   the CP needs to install one or more routes that can reach those IP
   addresses on the UP and notify the UP to advertise the routes to the
   network.</t>
        <t>
   The Routing TLVs are used by a CP to notify a UP of the updates to
   network routing information.  They can be carried in the
   Update_Request message and Sync_Data message.</t>
        <section anchor="sect-7.8.1" numbered="true" toc="default">
          <name>IPv4 Routing TLV</name>
          <t>
   The IPv4 Routing TLV is used to carry information related to IPv4
   network routing.</t>
          <t>The format of the TLV value part is as below:</t>
          <figure anchor="fig44">
            <name>IPv4 Routing TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-ID                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Dest-Address                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Next-Hop                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Out-If-Index                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Cost                                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Tag                                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Route-Type             |          Reserved           |A|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                          Sub-TLVs  (optional)                 ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>
          <dl newline="false" spacing="normal">
            <dt>TLV type:</dt><dd>7.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>User-ID:</dt><dd>4 bytes in length.  This field carries the user
	identifier.  It is filled with all Fs when a non-user route is
	delivered to the UP.</dd>
            <dt>Dest-Address (IPv4-Address type):</dt><dd>Identifies the destination
	address.</dd>
            <dt>Next-Hop (IPv4-Address type):</dt><dd>Identifies the next-hop address.</dd>
            <dt>Out-If-Index (4 bytes):</dt><dd>Indicates the interface index.</dd>
            <dt>Cost (4 bytes):</dt><dd>The cost value of the route.</dd>
            <dt>Tag (4 bytes):</dt><dd>The tag value of the route.</dd>
            <dt>Route-Type (2 bytes):</dt><dd>The value of this field
            indicates the route type.  The values defined in this document are
            listed in <xref target="sect-9.9" format="default"/>.</dd>
            <dt>Advertise-Flag:</dt><dd><t>1 bit shown as "A" in the figure above
            (<xref target="fig44" format="default"/>).  Indicates whether the
            UP should advertise the route.  The following flag values are
            defined:</t>

              <dl newline="false" spacing="normal">
                <dt>0:</dt><dd>Not advertised.</dd>
                <dt>1:</dt><dd>Advertised.</dd>
              </dl>
            </dd>

              <dt>Sub-TLVs:</dt><dd><t>The VRF-Name and/or If-Desc sub-TLVs
              can be carried.</t>
	
              <dl newline="false" spacing="normal">
                <dt>VRF-Name sub-TLV:</dt><dd>Indicates which VRF the route
                belongs to.</dd>
                <dt>If-Desc sub-TLV:</dt><dd>Carries the interface information.</dd>
              </dl>
            </dd>
            <dt>Reserved:</dt><dd>The Reserved field <bcp14>MUST</bcp14> be
            sent as zero and ignored on receipt.</dd>

          </dl>
</li></ul>
        </section>
        <section anchor="sect-7.8.2" numbered="true" toc="default">
          <name>IPv6 Routing TLV</name>
          <t>
   The IPv6 Routing TLV is used to carry IPv6 network routing
   information.</t>
          <t>The format of the value part of this TLV is as follows:</t>
          <figure anchor="fig45">
            <name>IPv6 Routing TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-ID                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                          IPv6 Dest-Address                    ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                          IPv6 Next-Hop                        ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Out-If-Index                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Cost                                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Tag                                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Route-Type             |          Reserved           |A|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                          Sub-TLVs (optional)                  ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>



<ul empty="true"><li>
          <dl newline="false" spacing="normal">

            <dt>TLV type:</dt><dd>8.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>User-ID:</dt><dd>4 bytes in length. This field carries the user identifier.
	This field is filled with all Fs when a non-user route is delivered to
	the UP.</dd>
            <dt>IPv6 Dest-Address (IPv6-Address type):</dt><dd>Identifies the destination
	address.</dd>
            <dt>IPv6 Next-Hop (IPv6-Address type):</dt><dd>Identifies the next-hop
	address.</dd>
            <dt>Out-If-Index (4 bytes):</dt><dd>Indicates the interface index.</dd>
            <dt>Cost (4 bytes):</dt><dd>This is the cost value of the route.</dd>
            <dt>Tag (4 bytes):</dt><dd>The tag value of the route.</dd>
            <dt>Route-Type (2 bytes):</dt><dd>The value of this field
            indicates the route type. The values defined in this document are
            listed in <xref target="sect-9.9" format="default"/>.</dd>
            
            <dt>Advertise-Flag:</dt><dd><t>1 bit shown as "A" in the figure
            above (<xref target="fig45" format="default"/>).  Indicates
            whether the UP should advertise the route.  The following flags
            are defined:</t>

              <dl newline="false" spacing="normal">
                <dt>0:</dt><dd>Not advertised.</dd>
                <dt>1:</dt><dd>Advertised.</dd>
              </dl>
            </dd>

            <dt>Sub-TLVs:</dt><dd><t>The If-Desc and VRF-Name sub-TLVs can be carried.</t>

              <dl newline="false" spacing="normal">
                <dt>VRF-Name sub-TLV:</dt><dd>Indicates the VRF to which the subscriber
	belongs.</dd>
                <dt>If-Desc sub-TLV:</dt><dd>Carries the interface information.</dd>
              </dl>
            </dd>

            <dt>Reserved:</dt><dd>The Reserved field <bcp14>MUST</bcp14> be sent as zero and ignored on receipt.</dd>

          </dl>
</li></ul>

        </section>
      </section>
      <section anchor="sect-7.9" numbered="true" toc="default">
        <name>Subscriber TLVs</name>
        <t>
   The Subscriber TLVs are defined for a CP to send the basic
   information about a user to a UP.</t>
        <section anchor="sect-7.9.1" numbered="true" toc="default">
          <name>Basic Subscriber TLV</name>
          <t>
   The Basic Subscriber TLV is used to carry the common
   information for all kinds of access subscribers.  It is carried in an
   Update_Request message.</t>
          <t>The format of the Basic Subscriber TLV value part is as follows:</t>
          <figure anchor="fig46">
            <name>Basic Subscriber TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-ID                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Session-ID                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-MAC                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        User-MAC (cont.)       |   Oper-ID     |    Reserved   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Access-Type   |Sub-Access-Type|  Account-Type | Address Family|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |               C-VID           |          P-VID                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |               Detect-Times    |          Detect-Interval      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            If-Index                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                            Sub-TLVs (optional)                ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true">
  <li>
    <dl newline="false" spacing="normal">
      <dt>TLV type:</dt><dd>2.</dd>
      <dt>TLV length:</dt><dd>Variable.</dd>
      <dt>User-ID (4 bytes):</dt><dd>The identifier of a subscriber.</dd>
      <dt>Session-ID (4 bytes):</dt><dd>Session ID of a PPPoE subscriber.  
           The value zero identifies a non-PPPoE subscriber.</dd>
      <dt>User-MAC (MAC-Addr type):</dt><dd>The MAC address of a subscriber.</dd>
      <dt>Oper-ID (1 byte):</dt><dd>Indicates the ID of an operation performed by a
	   user. This field is carried in the response from the UP.</dd>
      <dt>Reserved (1 byte):</dt><dd><bcp14>MUST</bcp14> be sent as zero
           and ignored on receipt.</dd>
      <dt>Access-Type (1 byte):</dt><dd>Indicates the type of subscriber
           access. Values defined in this document are listed in <xref
           target="sect-9.10" format="default"/>.</dd>
      <dt>Sub-Access-Type (1 byte):</dt>
          <dd>
            <t>Indicates whether PPP termination or PPP relay is used.</t>
            <dl newline="false" spacing="normal">
                  <dt>0:</dt><dd>Reserved.</dd>
                  <dt>1:</dt><dd>PPP Relay (for LAC).</dd>
                  <dt>2:</dt><dd>PPP termination (for LNS).</dd>
            </dl>
	  </dd>
    
      <dt>Account-Type (1 byte):</dt>
          <dd>
          <t>Indicates whether traffic statistics are collected independently. </t>
            <dl newline="false" spacing="normal">
                  <dt>0:</dt><dd>Collects statistics on IPv4 and 
                                 IPv6 traffic of terminals independently.</dd>
                  <dt>1:</dt><dd>Collects statistics on IPv4 and IPv6 
                                 traffic of terminals.</dd>
             </dl>
           </dd>

       <dt>Address Family (1 byte):</dt>
          <dd>
          <t>The type of IP address.</t>
            <dl newline="false" spacing="normal">
                  <dt>1:</dt><dd>IPv4.</dd>
                  <dt>2:</dt><dd>IPv6.</dd>
                  <dt>3:</dt><dd>Dual stack.</dd>
            </dl>
         </dd>

      <dt>C-VID (VLAN-ID):</dt><dd>Indicates the inner VLAN ID.  The value 0
	indicates that the VLAN ID is invalid.  The default value of PRI is 7,
	the value of DEI is 0, and the value of VID is 1-4094.  The PRI value
	can also be obtained by parsing terminal packets.</dd>

      <dt>P-VID (VLAN-ID):</dt><dd>Indicates the outer VLAN ID.  The value 0
	indicates that the VLAN ID is invalid.  The format is the same as that
	for C-VID.</dd>

      <dt>Detect-Times (2 bytes):</dt><dd>Number of detection timeout times.  The
	    value 0 indicates that no detection is performed.</dd>

      <dt>Detect-Interval (2 bytes):</dt><dd>Detection interval in
	    seconds.</dd>

      <dt>If-Index (4 bytes):</dt><dd>Interface index.</dd>

      <dt>Sub-TLVs:</dt>
         <dd>
           <t>The VRF-Name sub-TLV and If-Desc sub-TLV can
              be carried.</t>
           <dl newline="false" spacing="normal">
                 <dt>VRF-Name sub-TLV:</dt><dd>Indicates the VRF to which the
                     subscriber belongs.</dd>
                 <dt>If-Desc sub-TLV:</dt><dd>Carries the interface information.</dd>
           </dl>
         </dd>

      <dt>Reserved:</dt><dd>The Reserved field <bcp14>MUST</bcp14> be sent as 
                            zero and ignored on receipt.</dd>
    </dl>
  </li>
</ul>

        </section>
        <section anchor="sect-7.9.2" numbered="true" toc="default">
          <name>PPP Subscriber TLV</name>
          <t>
   The PPP Subscriber TLV is defined to carry PPP information of a user
   from a CP to a UP. It will be carried in an Update_Request message
   when PPPoE or L2TP access is used.</t>
          <t>The format of the TLV value part is as follows:</t>
          <figure anchor="fig47">
            <name>PPP Subscriber TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-ID                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        MSS-Value              |        Reserved             |M|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        MRU                    |        Reserved               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Magic-Number                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Peer-Magic-Number                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>
          <dl newline="false" spacing="normal">

            <dt>TLV type:</dt><dd>3.</dd>
            <dt>TLV length:</dt><dd>12 octets.</dd>
            <dt>User-ID (4 bytes):</dt><dd>The identifier of a subscriber.</dd>
            <dt>MSS-Value (2 bytes):</dt><dd>Indicates the MSS value (in
            bytes).</dd>

            <dt>MSS-Enable (M) (1 bit):</dt><dd><t>Indicates whether the MSS
            is enabled.</t>

              <dl newline="false" spacing="normal">
                <dt>0:</dt><dd>Disabled.</dd>
                <dt>1:</dt><dd>Enabled.</dd>
              </dl>
            </dd>

            <dt>MRU (2 bytes):</dt><dd>PPPoE local MRU (in bytes).</dd>
            <dt>Magic-Number (4 bytes):</dt><dd>Local magic number in PPP negotiation
	packets.</dd>
            <dt>Peer-Magic-Number (4 bytes):</dt><dd>Remote peer magic number.</dd>
            <dt>Reserved:</dt><dd>The Reserved fields <bcp14>MUST</bcp14> be
            sent as zero and ignored on receipt.</dd>

          </dl>
</li></ul>

        </section>
        <section anchor="sect-7.9.3" numbered="true" toc="default">
          <name>IPv4 Subscriber TLV</name>
          <t>
   The IPv4 Subscriber TLV is defined to carry IPv4-related information
   for a BNG user.  It will be carried in an Update_Request message when
   IPv4 IPoE or PPPoE access is used.</t>
          <t>The format of the TLV value part is as follows:</t>
          <figure anchor="fig48">
            <name>IPv4 Subscriber TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-ID                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-IPv4                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Gateway-IPv4                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          MTU                  |   Reserved            |U|E|W|P|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                          VRF-Name Sub-TLV                     ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>
          <dl newline="false" spacing="normal">
            <dt>TLV type:</dt><dd>4.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>User-ID (4 bytes):</dt><dd>The identifier of a subscriber.</dd>
            <dt>User-IPv4 (IPv4-Address):</dt><dd>The IPv4 address of the subscriber.</dd>
            <dt>Gateway-IPv4 (IPv4-Address):</dt><dd>The gateway address of the
	subscriber.</dd>

            <dt>Portal-Force (P) (1 bit):</dt><dd><t>Push advertisement.</t>

          <dl newline= "false" spacing="normal">
            <dt>0:</dt><dd>Off.</dd>
            <dt>1:</dt><dd>On.</dd>
          </dl>

          </dd>

            <dt>Web-Force (W) (1 bit):</dt><dd><t>Push IPv4 Web.</t>

          <dl newline= "false" spacing="normal">
            <dt>0:</dt><dd>Off.</dd>
            <dt>1:</dt><dd>On.</dd>
          </dl>

        </dd>

            <dt>Echo-Enable (E) (1 bit):</dt><dd><t>UP returns ARP Req or PPP Echo.</t>

          <dl newline= "false" spacing="normal">
            <dt>0:</dt><dd>Off.</dd>
            <dt>1:</dt><dd>On.</dd>
          </dl>

        </dd>

            <dt>IPv4-URPF (U) (1 bit):</dt><dd><t>User Unicast Reverse Path Forwarding (URPF)
	flag.</t>

          <dl newline= "false" spacing="normal">
            <dt>0:</dt><dd>Off.</dd>
            <dt>1:</dt><dd>On.</dd>
          </dl>

          </dd>

            <dt>MTU (2 bytes):</dt><dd>MTU value.  The default value is 1500.</dd>
            <dt>VRF-Name Sub-TLV:</dt><dd>Indicates the subscriber belongs to which VRF.</dd>
            <dt>Reserved:</dt><dd>The Reserved field <bcp14>MUST</bcp14> be sent as zero and ignored on receipt.</dd>

          </dl>
</li></ul>

        </section>
        <section anchor="sect-7.9.4" numbered="true" toc="default">
          <name>IPv6 Subscriber TLV</name>
          <t>
   The IPv6 Subscriber TLV is defined to carry IPv6-related information
   for a BNG user.  It will be carried in an Update_Request message when
   IPv6 IPoE or PPPoE access is used.</t>
          <t>The format of the TLV value part is as follows:</t>
          <figure anchor="fig49">
            <name>IPv6 Subscriber TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-ID                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~           User PD-Address (IPv6 Address List Sub-TLV)         ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~        Gateway ND-Address (IPv6 Address List Sub-TLV)         ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User Link-Local-Address              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          IPv6 Interface ID                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          IPv6 Interface ID (cont.)            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          MTU                  |   Reserved            |U|E|W|P|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                    VRF Name Sub-TLV (optional)                ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>
          <dl newline="false" spacing="normal">

            <dt>TLV type:</dt><dd>5.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>User-ID (4 bytes):</dt><dd>The identifier of a subscriber.</dd>
            <dt>User PD-Addresses (IPv6 Address List):</dt><dd>Carries a list of Prefix
	Delegation (PD) addresses of the subscriber.</dd>
            <dt>User ND-Addresses (IPv6 Address List):</dt><dd>Carries a list of Neighbor
	Discovery (ND) addresses of the subscriber.</dd>
            <dt>User Link-Local-Address (IPv6-Address):</dt><dd>The link-local address of
	the subscriber.</dd>
            <dt>IPv6 Interface ID (8 bytes):</dt><dd>The identifier of an IPv6
	interface.</dd>

            <dt>Portal-Force 1 bit (P):</dt><dd><t>Push advertisement.</t>

          <dl newline= "false" spacing="normal">
            <dt>0:</dt><dd>Off.</dd>
            <dt>1:</dt><dd>On.</dd>
          </dl>

        </dd>

            <dt>Web-Force 1 bit (W):</dt><dd><t>Push IPv6 Web.</t>

          <dl newline= "false" spacing="normal">
            <dt>0:</dt><dd>Off.</dd>
            <dt>1:</dt><dd>On.</dd>
          </dl>

          </dd>

            <dt>Echo-Enable 1 bit (E):</dt><dd><t>The UP returns ARP Req or
            PPP Echo.</t>

          <dl newline= "false" spacing="normal">
            <dt>0:</dt><dd>Off.</dd>
            <dt>1:</dt><dd>On.</dd>
          </dl>

          </dd>

            <dt>IPv6-URPF 1 bit (U):</dt><dd><t>User Reverse Path Forwarding
            (URPF) flag.</t>

          <dl newline= "false" spacing="normal">
            <dt>0:</dt><dd>Off.</dd>
            <dt>1:</dt><dd>On.</dd>
          </dl>

          </dd>

            <dt>MTU (2 bytes):</dt><dd>The MTU value. The default value is 1500.</dd>
            <dt>VRF-Name Sub-TLV:</dt><dd>Indicates the VRF to which the subscriber
	belongs.</dd>
            <dt>Reserved:</dt><dd>The Reserved field <bcp14>MUST</bcp14> be sent as zero and ignored on
	receipt.</dd>

          </dl>
</li></ul>

        </section>
        <section anchor="sect-7.9.5" numbered="true" toc="default">
          <name>IPv4 Static Subscriber Detect TLV</name>
          <t>
   The IPv4 Static Subscriber Detect TLV is defined to carry IPv4-related 
   information for a static access subscriber.  It will be
   carried in an Update_Request message when IPv4 static access on a UP
   needs to be enabled.</t>
          <t>The format of the TLV value part is as follows:</t>
          <figure anchor="fig50">
            <name>IPv4 Static Subscriber TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          If-Index                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           C-VID               |           P-VID               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User Address                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Gateway Address                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-MAC                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        User-MAC (cont.)       |           Reserved            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                       Sub-TLVs (optional)                     ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>
          <dl newline="false" spacing="normal">

            <dt>TLV type:</dt><dd>9.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>If-Index (4 bytes):</dt><dd>The interface index of the interface from which
	the subscriber will dial-up.</dd>
            <dt>C-VID (VLAN-ID):</dt><dd>Indicates the inner VLAN ID.  The value 0
	indicates that the VLAN ID is invalid.  A valid value is 1-4094.</dd>
            <dt>P-VID (VLAN-ID):</dt><dd>Indicates the outer VLAN ID.  The value 0
	indicates that the VLAN ID is invalid.  The format is the same as that
	of the C-VID.  A valid value is 1-4094. </dd>
            <dt>User Address (IPv4-Addr):</dt><dd>The user's IPv4 address.</dd>
            <dt>Gateway Address (IPv4-Addr):</dt><dd>The gateway's IPv4 address.</dd>
            <dt>User-MAC (MAC-Addr type):</dt><dd>The MAC address of the subscriber.</dd>

            <dt>Sub-TLVs:</dt><dd><t>The VRF-Name and If-Desc sub-TLVs may be
	    carried.</t>

          <dl newline="false" spacing="normal">
                <dt>VRF-Name sub-TLV:</dt><dd>Indicates the VRF to which the subscriber
	belongs.</dd>
                <dt>If-Desc sub-TLV:</dt><dd>Carries the interface information.</dd>
          </dl>
           </dd>

            <dt>Reserved:</dt><dd>The Reserved field <bcp14>MUST</bcp14> be
            sent as zero and ignored on receipt.</dd>

          </dl>
</li></ul>


        </section>
        <section anchor="sect-7.9.6" numbered="true" toc="default">
          <name>IPv6 Static Subscriber Detect TLV</name>
          <t>
   The IPv6 Static Subscriber Detect TLV is defined to carry IPv6-related 
   information for a static access subscriber.  It will be
   carried in an Update_Request message when needed to enable IPv6
   static subscriber detection on a UP.</t>
          <t>The format of the TLV value part is as follows:</t>
          <figure anchor="fig51">
            <name>IPv6 Static Subscriber Detect TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          If-Index                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           C-VID               |           P-VID               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                          User Address                         ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                          Gateway Address                      ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-MAC                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        User-MAC (cont.)       |           Reserved            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                        Sub-TLVs (optional)                     ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>
          <dl newline="false" spacing="normal">
            <dt>TLV type:</dt><dd>10.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>If-Index (4 bytes):</dt><dd>The interface index of the interface from which
	the subscriber will dial-up.</dd>
            <dt>C-VID (VLAN-ID):</dt><dd>Indicates the inner VLAN ID.  The value 0
	indicates that the VLAN ID is invalid.  A valid value is 1-4094.</dd>
            <dt>P-VID (VLAN-ID):</dt><dd>Indicates the outer VLAN ID.  The value 0
	indicates that the VLAN ID is invalid.  The format is the same as that
	the of C-VID.  A valid value is 1-4094.</dd>
            <dt>User Address (IPv6-Address type):</dt><dd>The subscriber's IPv6 address.</dd>
            <dt>Gateway Address (IPv6-Address type):</dt><dd>The gateway's
            IPv6 Address.</dd>
            <dt>User-MAC (MAC-Addr type):</dt><dd>The MAC
            address of the subscriber.</dd>

            <dt>Sub-TLVs:</dt><dd><t>VRF-Name and If-Desc sub-TLVs may be carried</t>

          <dl newline="false" spacing="normal">
                <dt>VRF-Name sub-TLV:</dt><dd>Indicates the VRF to which the
                subscriber belongs.</dd>
                <dt>If-Desc sub-TLV:</dt><dd>Carries the interface information.</dd>
          </dl>

            </dd>

            <dt>Reserved:</dt><dd>The Reserved field <bcp14>MUST</bcp14> be
            sent as zero and ignored on receipt.</dd>

          </dl>
</li></ul>

        </section>
        <section anchor="sect-7.9.7" numbered="true" toc="default">
          <name>L2TP-LAC Subscriber TLV</name>
          <t>
   The L2TP-LAC Subscriber TLV is defined to carry the related
   information for an L2TP LAC access subscriber.  It will be carried in
   an Update_Request message when L2TP LAC access is used.</t>
          <t>The format of the TLV value part is as follows:</t>
          <figure anchor="fig52">
            <name>L2TP-LAC Subscriber TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-ID                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Local-Tunnel-ID          |     Local-Session-ID          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Remote-Tunnel-ID         |     Remote-Session-ID         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>



<ul empty="true"><li>

          <dl newline="false" spacing="normal">

            <dt>TLV type:</dt><dd>11.</dd>
            <dt>TLV length:</dt><dd>12 octets.</dd>
            <dt>User-ID (4 bytes):</dt><dd>The identifier of a user/subscriber.</dd>
            <dt>Local-Tunnel-ID (2 bytes):</dt><dd>The local ID of the L2TP tunnel.</dd>
            <dt>Local-Session-ID (2 bytes):</dt><dd>The local session ID with the L2TP
	tunnel.</dd>
            <dt>Remote-Tunnel-ID (2 bytes):</dt><dd>The identifier of the L2TP tunnel at
	the remote endpoint.</dd>
            <dt>Remote-Session-ID (2 bytes):</dt><dd>The session ID of the L2TP tunnel at
	the remote endpoint.</dd>
          </dl>
	</li></ul>


        </section>
        <section anchor="sect-7.9.8" numbered="true" toc="default">
          <name>L2TP-LNS Subscriber TLV</name>
          <t>
   The L2TP-LNS Subscriber TLV is defined to carry the related
   information for a L2TP LNS access subscriber.  It will be carried in
   an Update_Request message when L2TP LNS access is used.</t>
          <t>The format of the TLV value part is as follows:</t>
          <figure anchor="fig53">
            <name>L2TP-LNS Subscriber TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-ID                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Local-Tunnel-ID          |     Local-Session-ID          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Remote-Tunnel-ID         |     Remote-Session-ID         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline="false" spacing="normal">
            <dt>TLV type:</dt><dd>12.</dd>
            <dt>TLV length:</dt><dd>12 octets.</dd>
            <dt>User-ID (4 bytes):</dt><dd>The identifier of a user/subscriber.</dd>
            <dt>Local-Tunnel-ID (2 bytes):</dt><dd>The local ID of the L2TP tunnel.</dd>
            <dt>Local-Session-ID (2 bytes):</dt><dd>The local session ID with the L2TP tunnel.</dd>
            <dt>Remote-Tunnel-ID (2 bytes):</dt><dd>The identifier of the L2TP tunnel at
	the remote endpoint.</dd>
            <dt>Remote-Session-ID (2 bytes):</dt><dd>The session ID of the L2TP tunnel at
	the remote endpoint.</dd>

          </dl>

	</li></ul>

        </section>
        <section anchor="sect-7.9.9" numbered="true" toc="default">
          <name>L2TP-LAC Tunnel TLV</name>
          <t>
   The L2TP-LAC Tunnel TLV is defined to carry information related to the L2TP LAC tunnel.  
   It will be carried in the Update_Request
   message when L2TP LAC access is used.</t>
          <t>The format of the TLV value part is as follows:</t>
          <figure anchor="fig54">
            <name>L2TP-LAC Tunnel TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |       Local-Tunnel-ID         |       Remote-Tunnel-ID        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           Source-Port         |           Dest-Port           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                          Source-IP                            ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                          Dest-IP                              ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                          VRF-Name Sub-TLV                     ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>13.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>Local-Tunnel-ID (2 bytes):</dt><dd>The local ID of the L2TP tunnel.</dd>
            <dt>Remote-Tunnel-ID (2 bytes):</dt><dd>The remote ID of the L2TP tunnel.</dd>
            <dt>Source-Port (2 bytes):</dt><dd>The source UDP port number of an L2TP subscriber.</dd>
            <dt>Dest-Port (2 bytes):</dt><dd>The destination UDP port number of an L2TP
	subscriber.</dd>
            <dt>Source-IP (IPv4/v6):</dt><dd>The source IP address of the tunnel.</dd>
            <dt>Dest-IP (IPv4/v6):</dt><dd>The destination IP address of the tunnel.</dd>
            <dt>VRF-Name Sub-TLV:</dt><dd>The VRF name to which the L2TP subscriber tunnel
	belongs.</dd>

          </dl>

</li></ul>

        </section>
        <section anchor="sect-7.9.10" numbered="true" toc="default">
          <name>L2TP-LNS Tunnel TLV</name>
          <t>
   The L2TP-LNS Tunnel TLV is defined to carry information related to the L2TP LNS tunnel. 
   It will be carried in the Update_Request
   message when L2TP LNS access is used.</t>
          <t>The format of the TLV value part is as follows:</t>
          <figure anchor="fig55">
            <name>L2TP-LNS Tunnel TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Local-Tunnel-ID        |       Remote-Tunnel-ID        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Source-Port            |         Dest-Port             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                       Source-IP                               ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                       Dest-IP                                 ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                       VRF-Name Sub-TLV                        ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>


<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>14.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>Local-Tunnel-ID (2 bytes):</dt><dd>The local ID of the L2TP tunnel.</dd>
            <dt>Remote-Tunnel-ID (2 bytes):</dt><dd>The remote ID of the L2TP tunnel.</dd>
            <dt>Source-Port (2 bytes):</dt><dd>The source UDP port number of an L2TP subscriber.</dd>
            <dt>Dest-Port (2 bytes):</dt><dd>The destination UDP port number of an L2TP subscriber.</dd>
            <dt>Source-IP (IPv4/v6):</dt><dd>The source IP address of the tunnel.</dd>
            <dt>Dest-IP (IPv4/v6):</dt><dd>The destination IP address of the tunnel.</dd>
            <dt>VRF-Name Sub-TLV:</dt><dd>The VRF name to which the L2TP subscriber tunnel
	belongs.</dd>

          </dl>

</li></ul>

        </section>
        <section anchor="sect-7.9.11" numbered="true" toc="default">
          <name>Update Response TLV</name>
          <t>
   The Update Response TLV is used to return the operation result of an
   update request.  It is carried in the Update_Response message as a
   response to the Update_Request message.</t>
          <t>The format of the value part of the Update Response TLV 
   is as follows:</t>
          <figure anchor="fig56">
            <name>Update Response TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          User-ID                              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | User-Trans-ID |   Oper-Code   |   Oper-Result |  Reserved     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Error-Code                            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>302.</dd>
            <dt>TLV length:</dt><dd>12.</dd>
            <dt>User-ID (4 bytes):</dt><dd>A unique identifier of a user/subscriber.</dd>
            <dt>User-Trans-ID (1 byte):</dt><dd>In the case of dual-stack access or when
	modifying a session, User-Trans-ID is used to identify a user
	operation transaction. It is used by the CP to correlate a response to
	a specific request.</dd>

            <dt>Oper-Code (1 byte):</dt><dd><t>Operation code.</t>

          <dl newline= "false" spacing="normal">
            <dt>1:</dt><dd>Update.</dd>
            <dt>2:</dt><dd>Delete.</dd>
          </dl>

          </dd>

            <dt>Oper-Result (1 byte):</dt><dd><t>Operation Result.</t>

          <dl newline= "false" spacing="normal">
            <dt>0:</dt><dd>Success.</dd>
            <dt>Others:</dt><dd>Failure.</dd>
          </dl>

          </dd>

            <dt>Error-Code (4 bytes):</dt><dd>Operation failure cause code.  For details,
	see <xref target="sect-9.5" format="default"/>.</dd>
            <dt>Reserved:</dt><dd>The Reserved field <bcp14>MUST</bcp14> be sent as zero and ignored on receipt.</dd>

          </dl>

	</li></ul>

        </section>
        <section anchor="sect-7.9.12" numbered="true" toc="default">
          <name>Subscriber Policy TLV</name>
          <t>
   The Subscriber Policy TLV is used to carry the policies that will be
   applied to a subscriber.  It is carried in the Update_Request
   message.</t>
          <t>The format of the TLV value part is as follows:</t>
          <figure anchor="fig57">
            <name>Subscriber Policy TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-ID                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   I-Priority  |   E-Priority  |   Reserved                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                          Sub-TLVs                             ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>


<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>6.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>User-ID (4 bytes):</dt><dd>The identifier of a user/subscriber.</dd>
            <dt>Ingress-Priority (1 byte):</dt><dd>Indicates the upstream priority. The
	value range is 0~7.</dd>
            <dt>Egress-Priority (1 byte):</dt><dd>Indicates the downstream priority. The
	value range is 0~7.</dd>
            <dt>Sub-TLVs:</dt><dd><t>The sub-TLVs that are present can occur
            in any order.</t>

          <dl newline= "false" spacing="normal">
                <dt>Ingress-CAR sub-TLV:</dt><dd>Upstream CAR.</dd>
                <dt>Egress-CAR sub-TLV:</dt><dd>Downstream CAR.</dd>
                <dt>Ingress-QoS-Profile sub-TLV:</dt><dd>Indicates the name of
                the QoS-Profile that is the profile in the upstream
                direction.</dd>
                <dt>Egress-QoS-Profile sub-TLV:</dt><dd>Indicates the name of
                the QoS-Profile that is the profile in the downstream
                direction.</dd>
                <dt>User-ACL-Policy sub-TLV:</dt><dd>All ACL user policies,
                including v4ACLIN, v4ACLOUT, v6ACLIN, v6ACLOUT, v4WEBACL,
                v6WEBACL, v4SpecialACL, and v6SpecialACL.</dd>
                <dt>Multicast-Profile4 sub-TLV:</dt><dd>IPv4 multicast policy name.</dd>
                <dt>Multicast-Profile6 sub-TLV:</dt><dd>IPv6 multicast policy name.</dd>
                <dt>NAT-Instance sub-TLV:</dt><dd>Indicates the instance ID of
                a NAT user. </dd>

          </dl>

            </dd>

            <dt>Reserved:</dt><dd>The Reserved field <bcp14>MUST</bcp14> be sent as
            zero and ignored on receipt.</dd>

          </dl>

	</li></ul>

        </section>
        <section anchor="sect-7.9.13" numbered="true" toc="default">
          <name>Subscriber CGN Port Range TLV</name>
          <t>
   The Subscriber CGN Port Range TLV is used to carry the NAT public
   address and port range. It will be carried in the Update_Response
   message when CGN is used.</t>
          <t>The format of the value part of this TLV is as follows:</t>
          <figure anchor="fig58">
            <name>Subscriber CGN Port Range TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            User-ID                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           NAT-Port-Start      |          NAT-Port-End         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            NAT-Address                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>15.</dd>
            <dt>TLV length:</dt><dd>12 octets.</dd>
            <dt>User-ID (4 bytes):</dt><dd>The identifier of a user/subscriber.</dd>
            <dt>NAT-Port-Start (2 bytes):</dt><dd>The start port number.</dd>
            <dt>NAT-Port-End (2 bytes):</dt><dd>The end port number.</dd>
            <dt>NAT-Address (4 bytes):</dt><dd>The NAT public network address.</dd>

          </dl>

</li></ul>

        </section>
      </section>
      <section anchor="sect-7.10" numbered="true" toc="default">
        <name>Device Status TLVs</name>
        <t>
   The TLVs in this section are for reporting interface and board-level
   information from the UP to the CP.</t>
        <section anchor="sect-7.10.1" numbered="true" toc="default">
          <name>Interface Status TLV</name>
          <t>
   The Interface Status TLV is used to carry the status information of
   an interface on a UP.  It is carried in a Report message.</t>
          <t>The format of the value part of this TLV is as follows:</t>
          <figure anchor="fig59">
            <name>Interface Status TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          If-Index                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          MAC-Address (upper part)             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   MAC-Address (lower part)    |   Phy-State   |   Reserved    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          MTU                                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Sub-TLVs (optional)                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>200.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>If-Index (4 bytes):</dt><dd>Indicates the interface index.</dd>
            <dt>MAC-Address (MAC-Addr type):</dt><dd>Interface MAC address.</dd>

            <dt>Phy-State (1 byte):</dt><dd><t>Physical status of the
            interface.</t>

          <dl newline= "false" spacing="normal">
            <dt>0:</dt><dd>Down.</dd>
            <dt>1:</dt><dd>Up.</dd>
          </dl>

          </dd>


            <dt>MTU (4 bytes):</dt><dd>Interface MTU value.</dd>
            <dt>Sub-TLVs:</dt><dd>The If-Desc and VRF-Name sub-TLVs can be carried.</dd>
            <dt>Reserved:</dt><dd>The Reserved field <bcp14>MUST</bcp14> be
            sent as zero and ignored on receipt.</dd>

          </dl>

	</li></ul>

        </section>
        <section anchor="sect-7.10.2" numbered="true" toc="default">
          <name>Board Status TLV</name>
          <t>
   The Board Status TLV is used to carry the status information of a
   board on an UP.  It is carried in a Report message.</t>
          <t>The format of the value part of the Board Status TLV is as follows:</t>

          <figure anchor="fig60">
            <name>Board Status TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Board-Type  | Board-State   |   Reserved    |   Chassis     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |               Slot            |           Sub-Slot            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>


<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>201.</dd>
            <dt>TLV length:</dt><dd>8 octets.</dd>
            <dt>Chassis (1 byte):</dt><dd>The chassis number of the board.</dd>
            <dt>Slot (16 bits):</dt><dd>The slot number of the board.</dd>
            <dt>Sub-Slot (16 bits):</dt><dd>The sub-slot number of the board.</dd>
            <dt>Board-Type (1 byte):</dt><dd>
              <t>The type of board used.</t>
              <dl newline= "false" spacing="normal">
                <dt>1:</dt><dd>CGN Service Process Unit (SPU) board.</dd>
                <dt>2:</dt><dd>Line Process Unit (LPU) board.</dd>
             </dl>
            </dd>

            <dt>Board-State (1 byte):</dt><dd>
                <t>Indicates whether there are issues with the board.</t>
                <dl newline= "false" spacing="normal">
                  <dt>0:</dt><dd>Normal.</dd>
                  <dt>1:</dt><dd>Abnormal.</dd>
                </dl>
              </dd>

            <dt>Reserved:</dt><dd>The Reserved field <bcp14>MUST</bcp14> be sent as zero and ignored on receipt.</dd>

          </dl>

	</li></ul>

        </section>
      </section>
      <section anchor="sect-7.11" numbered="true" toc="default">
        <name>CGN TLVs</name>
        <section anchor="sect-7.11.1" numbered="true" toc="default">
          <name>Address Allocation Request TLV</name>
          <t>
   The Address Allocation Request TLV is used to request address
   allocation from the CP.  A Pool-Name sub-TLV is carried to
   indicate from which address pool to allocate addresses.  The Address
   Allocation Request TLV is carried in the Addr_Allocation_Req message.</t>
          <t>The format of the value part of this TLV is as follows:</t>
          <figure anchor="fig61">
            <name>Address Allocation Request TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                          Pool-Name Sub-TLV                    ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>400.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>Pool-Name sub-TLV:</dt><dd>Indicates from which address pool
            to allocate address.</dd>

          </dl>
	
</li></ul>

        </section>
        <section anchor="sect-7.11.2" numbered="true" toc="default">
          <name>Address Allocation Response TLV</name>
          <t>
   The Address Allocation Response TLV is used to return the address
   allocation result; it is carried in the Addr_Allocation_Ack message.</t>
          <t>
   The value part of the Address Allocation Response TLV is formatted as
   follows:</t>
          <figure anchor="fig62">
            <name>Address Allocation Response TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Lease Time                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Client-IP                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Client-IP (cont.)                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Error-Code                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                        Pool-Name Sub-TLV                      ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>401.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd> 

            <dt>Lease Time (4 bytes):</dt><dd>Duration of address lease in seconds.</dd>
            <dt>Client-IP (IPv4-Address type):</dt><dd>The allocated
            IPv4 address and mask.</dd>
            <dt>Error-Code (4 bytes):</dt><dd><t>Indicates success or an error.</t>

          <dl newline= "false" spacing="normal">
                <dt>0:</dt><dd>Success.</dd>
                <dt>1:</dt><dd>Failure.</dd>
                <dt>3001:</dt><dd>Pool-Mismatch. The corresponding address pool cannot be
	   found.</dd>
                <dt>3002:</dt><dd>Pool-Full. The address pool is fully allocated, and no
	   address segment is available.</dd>

          </dl>
        </dd>

            <dt>Pool-Name sub-TLV:</dt><dd>Indicates from which
	address pool the address is allocated.</dd>

          </dl>

</li></ul>

        </section>
        <section anchor="sect-7.11.3" numbered="true" toc="default">
          <name>Address Renewal Request TLV</name>
          <t>
   The Address Renewal Request TLV is used to request address renewal
   from the CP.  It is carried in the Addr_Renew_Req message.</t>
          <t>The format of this TLV value is as follows:</t>
          <figure anchor="fig63">
            <name>Address Renewal Request TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Client-IP                                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Client-IP (cont.)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                     Pool-Name Sub-TLV                         ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>402.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>Client-IP (IPv4-Address type):</dt><dd>The IPv4 address and mask to be
            renewed.</dd>
            <dt>Pool-Name sub-TLV:</dt><dd>Indicates from which
	address pool to renew the address.</dd>

          </dl>

</li></ul>

        </section>
        <section anchor="sect-7.11.4" numbered="true" toc="default">
          <name>Address Renewal Response TLV</name>
          <t>
   The Address Renewal Response TLV is used to return the address
   renewal result.  It is carried in the Addr_Renew_Ack message.</t>
          <t>The format of this TLV value is as follows:</t>

          <figure anchor="fig64">
            <name>Address Renewal Response TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Client-IP                                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Client-IP (cont.)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Error-Code                                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                     Pool-Name Sub-TLV                         ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>403.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>Client-IP (IPv4-Address type):</dt><dd>The renewed IPv4 address and mask.</dd>
            <dt>Error-Code (4 bytes):</dt><dd><t>Indicates success or an error:</t>

          <dl newline= "false" spacing="normal">
                <dt>0:</dt><dd>Success.</dd>
                <dt>1:</dt><dd>Failure.</dd>
                <dt>3001:</dt><dd>Pool-Mismatch. The corresponding address
                pool cannot be found.</dd>
                <dt>3002:</dt><dd>Pool-Full. The address pool is fully allocated, and no
	   address segment is available.</dd>
                <dt>3003:</dt><dd>Subnet-Mismatch. The address pool subnet
                cannot be found.</dd>
                <dt>3004:</dt><dd>Subnet-Conflict. Subnets in the address pool have been
	   assigned to other clients.</dd>

          </dl>
            </dd>

            <dt>Pool-Name sub-TLV:</dt><dd>Indicates from which
	address pool to renew the address.</dd>

          </dl>

</li></ul>

        </section>
        <section anchor="sect-7.11.5" numbered="true" toc="default">
          <name>Address Release Request TLV</name>
          <t>
   The Address Release Request TLV is used to release an IPv4 address.
   It is carried in the Addr_Release_Req message.</t>
          <t>The value part of this TLV is formatted as follows:</t>
          <figure anchor="fig65">
            <name>Address Release Request TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Client-IP                                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Client-IP (cont.)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                     Pool-Name sub-TLV                         ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>404.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>Client-IP (IPv4-Address type):</dt><dd>The IPv4
            address and mask to be released.</dd>
            <dt>Pool-Name sub-TLV:</dt><dd>Indicates from which
	address pool to release the address.</dd>

          </dl>

</li></ul>

        </section>
        <section anchor="sect-7.11.6" numbered="true" toc="default">
          <name>Address Release Response TLV</name>
          <t>
   The Address Release Response TLV is used to return the address
   release result.  It is carried in the Addr_Release_Ack message.</t>
          <t>The format of the value part of this TLV is as follows:</t>
          <figure anchor="fig66">
            <name>Address Release Response TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Client-IP                                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Client-IP (cont.)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     Error-Code                                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                     Pool-Name sub-TLV                         ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>405.</dd>
            <dt>TLV length:</dt><dd>Variable.</dd>
            <dt>Client-IP (IPv4-Address type):</dt><dd>The released IPv4 address and mask.</dd>
            <dt>Error-Code (4 bytes):</dt><dd><t>Indicates success or an error.</t>

          <dl newline= "false" spacing="normal">
                <dt>0:</dt><dd>Success. Address release success.</dd>
                <dt>1:</dt><dd>Failure. Address release failed.</dd>
                <dt>3001:</dt><dd>Pool-Mismatch. The corresponding address
                pool cannot be found.</dd>


                <dt>3003:</dt><dd>Subnet-Mismatch. The address cannot be found.</dd>


                <dt>3004:</dt><dd>Subnet-Conflict. The address has been
                allocated to another subscriber.</dd>
          </dl>
            </dd>

            <dt>Pool-Name sub-TLV:</dt><dd>Indicates from which
	address pool to release the address.</dd>

          </dl>

</li></ul>


        </section>
      </section>
      <section anchor="sect-7.12" numbered="true" toc="default">
        <name>Event TLVs</name>
        <section anchor="sect-7.12.1" numbered="true" toc="default">
          <name>Subscriber Traffic Statistics TLV</name>
          <t>
   The Subscriber Traffic Statistics TLV is used to return the traffic
   statistics of a user/subscriber.  The format of the value part of this TLV is as
   follows:</t>
          <figure anchor="fig67">
            <name>Subscriber Traffic Statistics TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                User-ID                                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Statistics-Type                                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Ingress Packets (upper part)                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Ingress Packets (lower part)                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Ingress Bytes (upper part)                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Ingress Bytes (lower part)                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Ingress Loss Packets (upper part)              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Ingress Loss Packets (lower part)              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Ingress Loss Bytes (upper part)                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Ingress Loss Bytes (lower part)                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Egress Packets (upper part)                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Egress Packets (lower part)                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Egress Bytes (upper part)                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Egress Bytes (lower part)                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Egress Loss Packets (upper part)               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Egress Loss Packets (lower part)               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Egress Loss Bytes (upper part)                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                Egress Loss Bytes (lower part)                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>300.</dd>
            <dt>TLV length:</dt><dd>72 octets.</dd>
            <dt>User-ID (4 bytes):</dt><dd>The subscriber identifier.</dd>
            <dt>Statistics-Type (4 bytes):</dt><dd><t>Traffic type.  It can be one of the
	following options:</t>

          <dl newline= "false" spacing="normal">
                <dt>0:</dt><dd>IPv4 traffic.</dd>
                <dt>1:</dt><dd>IPv6 traffic.</dd>
                <dt>2:</dt><dd>Dual-stack traffic.</dd>
          </dl>
            </dd>

            <dt>Ingress Packets (8 bytes):</dt><dd>The number of the packets
            in the upstream direction.</dd>
            <dt>Ingress Bytes (8 bytes):</dt><dd>The bytes of the upstream traffic.</dd>
            <dt>Ingress Loss Packets (8 bytes):</dt><dd>The number of the lost
            packets in the upstream direction.</dd>
            <dt>Ingress Loss Bytes (8 bytes):</dt><dd>The bytes of the lost
            upstream packets.</dd>
            <dt>Egress Packets (8 bytes):</dt><dd>The number of the packets in
            the downstream direction.</dd>
            <dt>Egress Bytes (8 bytes):</dt><dd>The bytes of the downstream traffic.</dd>
            <dt>Egress Loss Packets (8 bytes):</dt><dd>The number of the lost
            packets in the downstream direction.</dd>
            <dt>Egress Loss Bytes (8 bytes):</dt><dd>The bytes of the lost downstream
	packets.</dd>

          </dl>

</li></ul>

        </section>
        <section anchor="sect-7.12.2" numbered="true" toc="default">
          <name>Subscriber Detection Result TLV</name>
          <t>
   The Subscriber Detection Result TLV is used to return the detection
   result of a subscriber.  Subscriber detection is a function to detect
   whether or not a subscriber is online.  The result can be used by the
   CP to determine how to deal with the subscriber session (e.g.,
   delete the session if detection failed).</t>
          <t>The format of this TLV value part is as follows:</t>
          <figure anchor="fig68">
            <name>Subscriber Detection Result TLV</name>
            <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          User-ID                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Detect-Type   | Detect-Result |          Reserved             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure>
          <t>Where:
          </t>

<ul empty="true"><li>

          <dl newline= "false" spacing="normal">

            <dt>TLV type:</dt><dd>301.</dd>
            <dt>TLV length:</dt><dd>8 octets.</dd>
            <dt>User-ID (4 bytes):</dt><dd>The subscriber identifier.</dd>
            <dt>Detect-Type (1 byte):</dt><dd>
                <t>Type of traffic detected.</t>
                <dl newline= "false" spacing="normal">
                  <dt>0:</dt><dd>IPv4 detection.</dd>
                  <dt>1:</dt><dd>IPv6 detection.</dd>
                  <dt>2:</dt><dd>PPP detection.</dd>
               </dl>
              </dd>

            <dt>Detect-Result (1 byte):</dt><dd>
                <t>Indicates whether the detection was successful. </t>
                <dl newline= "false" spacing="normal">
                  <dt>0:</dt><dd>Indicates that the detection is successful.</dd>
                  <dt>1:</dt><dd>Detection failure.  The UP needs to report only
                                  when the detection fails.</dd>
                </dl>
            </dd>

            <dt>Reserved:</dt><dd>The Reserved field <bcp14>MUST</bcp14> be sent as zero and ignored on receipt.</dd>

          </dl>

	</li></ul>

        </section>
      </section>
      <section anchor="sect-7.13" numbered="true" toc="default">
        <name>Vendor TLV</name>
        <t>
   The Vendor TLV occurs as the first TLV in the Vendor message
   (<xref target="sect-6.6" format="default"/>). It provides a Sub-Type that effectively extends the
   message type in the message header, provides for versioning of vendor
   TLVs, and can accommodate sub-TLVs.</t>
        <t>The value part of the Vendor TLV is formatted as follows:</t>
        <figure anchor="fig69">
          <name>Vendor TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Vendor-ID                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           Sub-Type            |       Sub-Type-Version        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                      Sub-TLVs (optional)                      ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <t>Where:
        </t>

<ul empty="true"><li>

          <dl newline="false" spacing="normal" indent="3">

          <dt>TLV type:</dt><dd>1024.</dd>
          <dt>TLV length:</dt><dd>Variable.</dd>
          <dt>Vendor-ID (4 bytes):</dt><dd>Vendor ID as defined in RADIUS
          <xref target="RFC2865" format="default"/>.</dd>
          <dt>Sub-Type (2 bytes):</dt><dd>Used by the vendor to distinguish multiple
	different vendor messages.</dd>
          <dt>Sub-Type-Version (2 bytes):</dt><dd>Used by the vendor to distinguish
	different versions of a vendor-defined message Sub-Type.</dd>
          <dt>Sub-TLVs (variable):</dt><dd>Sub-TLVs as specified by the vendor.</dd>
          </dl>

	</li></ul>

        <t>
   Since vendor code will be handling the TLV after the Vendor-ID field
   is recognized, the remainder of the TLV values can be organized
   however the vendor wants. But it is desirable for a vendor to be able
   to define multiple different vendor messages and to keep track of
   different versions of its vendor-defined messages. Thus, it is
   <bcp14>RECOMMENDED</bcp14> that the vendor assign a Sub-Type value for each vendor
   message that it defines different from other Sub-Type values that
   vendor has used. Also, when modifying a vendor-defined message in a
   way potentially incompatible with a previous definition, the vendor
   <bcp14>SHOULD</bcp14> increase the value it is using in the Sub-Type-Version field.</t>
      </section>
    </section>

    <section anchor="sect-9" numbered="true" toc="default">
      <name>Tables of S-CUSP Codepoints</name>

      <t>
   This section provides tables of the S-CUSP codepoints, particularly
   message types, TLV types, TLV operation codes, sub-TLV types, and
   error codes. In most cases, references are provided to relevant
   sections elsewhere in this document.</t>
      <section anchor="sect-9.1" numbered="true" toc="default">
        <name>Message Types</name>
<table>
	<name>Message Types</name>
	<thead>
	<tr>
		<th>Type</th>
		<th>Name</th>
		<th>Section of This Document</th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td>0</td>
		<td>Reserved</td>
		<td></td>
	</tr>
	<tr>
		<td>1</td>
		<td>Hello</td>
		<td><xref target="sect-6.2.1" format="counter"/></td>
	</tr>
	<tr>
		<td>2</td>
		<td>Keepalive</td>
		<td><xref target="sect-6.2.2" format="counter"/></td>
	</tr>
	<tr>
		<td>3</td>
		<td>Sync_Request</td>
		<td><xref target="sect-6.2.3" format="counter"/></td>
	</tr>
	<tr>
		<td>4</td>
		<td>Sync_Begin</td>
		<td><xref target="sect-6.2.4" format="counter"/></td>
	</tr>
	<tr>
		<td>5</td>
		<td>Sync_Data</td>
		<td><xref target="sect-6.2.5" format="counter"/></td>
	</tr>
	<tr>
		<td>6</td>
		<td>Sync_End</td>
		<td><xref target="sect-6.2.6" format="counter"/></td>
	</tr>
	<tr>
		<td>7</td>
		<td>Update_Request</td>
		<td><xref target="sect-6.2.7" format="counter"/></td>
	</tr>
	<tr>
		<td>8</td>
		<td>Update_Response</td>
		<td><xref target="sect-6.2.8" format="counter"/></td>
	</tr>
	<tr>
		<td>9</td>
		<td>Report</td>
		<td><xref target="sect-6.4" format="counter"/></td>
	</tr>
	<tr>
		<td>10</td>
		<td>Event</td>
		<td><xref target="sect-6.3" format="counter"/></td>
	</tr>
	<tr>
		<td>11</td>
		<td>Vendor</td>
		<td><xref target="sect-6.6" format="counter"/></td>
	</tr>
	<tr>
		<td>12</td>
		<td>Error</td>
		<td><xref target="sect-6.7" format="counter"/></td>
	</tr>
	<tr>
		<td>13-199</td>
		<td>Unassigned</td>
		<td></td>
	</tr>
	<tr>
		<td>200</td>
		<td>Addr_Allocation_Req</td>
		<td><xref target="sect-6.5.1" format="counter"/></td>
	</tr>
	<tr>
		<td>201</td>
		<td>Addr_Allocation_Ack</td>
		<td><xref target="sect-6.5.2" format="counter"/></td>
	</tr>
	<tr>
		<td>202</td>
		<td>Addr_Renew_Req</td>
		<td><xref target="sect-6.5.3" format="counter"/></td>
	</tr>
	<tr>
		<td>203</td>
		<td>Addr_Renew_Ack</td>
		<td><xref target="sect-6.5.4" format="counter"/></td>
	</tr>
	<tr>
		<td>204</td>
		<td>Addr_Release_Req</td>
		<td><xref target="sect-6.5.5" format="counter"/></td>
	</tr>
	<tr>
		<td>205</td>
		<td>Addr_Release_Ack</td>
		<td><xref target="sect-6.5.6" format="counter"/></td>
	</tr>
	<tr>
		<td>206-254</td>
		<td>Unassigned</td>
		<td></td>
	</tr>
	<tr>
		<td>255</td>
		<td>Reserved</td>
		<td></td>
	</tr>
	</tbody>
</table>
      </section>
      <section anchor="sect-9.2" numbered="true" toc="default">
        <name>TLV Types</name>

<table>
<name>TLV Types</name>
  <thead>
    <tr>
      <th>Type</th><th>Name</th><th>Usage Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td><td>Reserved</td><td>-</td>
    </tr>
    <tr>
      <td>1</td><td>BAS Function</td><td>Carries the BNG access functions to be enabled or disabled on specified interfaces.</td>
    </tr>
    <tr>
      <td>2</td><td>Basic Subscriber</td><td>Carries the basic information about a BNG subscriber.</td>
    </tr>
    <tr>
      <td>3</td><td>PPP Subscriber</td><td>Carries the PPP information about a BNG subscriber.</td>
    </tr>
    <tr>
      <td>4</td><td>IPv4 Subscriber</td><td>Carries the IPv4 address of a BNG subscriber.</td>
    </tr>
    <tr>
      <td>5</td><td>IPv6 Subscriber</td><td>Carries the IPv6 address of a BNG subscriber.</td>
    </tr>
    <tr>
      <td>6</td><td>Subscriber Policy</td><td>Carries the policy information applied to a BNG subscriber.</td>
    </tr>
    <tr>
      <td>7</td><td>IPv4 Routing</td><td>Carries the IPv4 network routing information.</td>
    </tr>
    <tr>
      <td>8</td><td>IPv6 Routing</td><td>Carries the IPv6 network routing information.</td>
    </tr>
    <tr>
      <td>9</td><td>IPv4 Static Subscriber Detect</td><td>Carries the IPv4 static subscriber detect information.</td>
    </tr>
    <tr>
     <td>10</td><td>IPv6 Static Subscriber Detect</td><td>Carries the IPv6 static subscriber detect information.</td>
    </tr>
    <tr>
     <td>11</td><td>L2TP-LAC Subscriber</td><td>Carries the L2TP LAC subscriber information.</td>
    </tr>
    <tr>
     <td>12</td><td>L2TP-LNS Subscriber</td><td>Carries the L2TP LNS subscriber information.</td>
    </tr>
    <tr>
     <td>13</td><td>L2TP-LAC Tunnel</td><td>Carries the L2TP LAC tunnel subscriber information.</td>
    </tr>
    <tr>
     <td>14</td><td>L2TP-LNS Tunnel</td><td>Carries the L2TP LNS tunnel subscriber information.</td>
    </tr>
    <tr>
     <td>15</td><td>Subscriber CGN Port Range</td><td>Carries the public IPv4 address and related port range of a BNG subscriber.</td>
    </tr>
    <tr>
     <td>16-99</td><td>Unassigned</td><td>-</td>
    </tr>
    <tr>
     <td>100</td><td>Hello</td><td>Used for version and Keepalive timers negotiation.</td>
    </tr>
    <tr>
     <td>101</td><td>Error Information</td><td>Carried in the Ack of the control message.  Carries the processing result, success, or error.</td>
    </tr>
    <tr>
     <td>102</td><td>Keepalive</td><td>Carried in the Hello message for Keepalive timers negotiation.</td>
    </tr>
    <tr>
  <td>103-199</td><td>Unassigned</td><td> -</td>
    </tr>
    <tr>
    <td>200</td><td>Interface Status</td><td>Interfaces status reported by the UP including physical interfaces, sub-interfaces, trunk interfaces, and tunnel interfaces.</td>
    </tr>
    <tr>
    <td>201</td><td>Board Status</td><td>Board information reported by the UP including the board type and in-position status.</td>
    </tr>
    <tr>
  <td>202-299</td><td>Unassigned</td><td>-</td>
    </tr>
    <tr>
    <td>300</td><td>Subscriber Traffic Statistics</td><td>User traffic statistics.</td>
    </tr>
    <tr>
    <td>301</td><td>Subscriber Detection Result</td><td>User detection information.</td>
    </tr>
    <tr>
    <td>302</td><td>Update Response</td><td>The processing result of a subscriber session update.</td>
    </tr>
    <tr>
  <td>303-299</td><td>Unassigned</td><td> -</td>
    </tr>
    <tr>
    <td>400</td><td>Address Allocation Request</td><td>Request address allocation.</td>
    </tr>
    <tr>
    <td>401</td><td>Address Allocation Response</td><td>Address allocation response.</td>
    </tr>
    <tr>
    <td>402</td><td>Address Renewal Request</td><td>Request for address lease renewal.</td>
    </tr>
    <tr>
    <td>403</td><td>Address Renewal Response</td><td>Response to a request for extending an IP address lease.</td>
    </tr>
    <tr>
    <td>404</td><td>Address Release Request</td><td>Request to release the address.</td>
    </tr>
    <tr>
    <td>405</td><td>Address Release Response</td><td>Ack of a message releasing an IP address.</td>
    </tr>
    <tr>
  <td>406-1023</td><td>Unassigned</td><td> -</td>
    </tr>
    <tr>
   <td>1024</td><td>Vendor</td><td>As implemented by the vendor.</td>
    </tr>
    <tr>
  <td>1039-4095</td><td>Unassigned</td><td> -</td>
    </tr>
</tbody>
</table>
      </section>
      <section anchor="sect-9.3" numbered="true" toc="default">
        <name>TLV Operation Codes</name>
        <t>
   TLV operation codes appear in the Oper field in the header of some
   TLVs. See <xref target="sect-7.1" format="default"/>.</t>

<table>
<name>TLV Operation Codes</name>	
       <thead>
	<tr>
		<th>Code</th>
		<th>Operation</th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td>0</td>
		<td>Reserved</td>
	</tr>
	<tr>
		<td>1</td>
		<td>Update</td>
	</tr>
	<tr>
		<td>2</td>
		<td>Delete</td>
	</tr>
	<tr>
		<td>3-15</td>
		<td>Unassigned</td>
	</tr>
	</tbody>
</table>
      </section>
      <section anchor="sect-9.4" numbered="true" toc="default">
        <name>Sub-TLV Types</name>
        <t>See <xref target="sect-7.3" format="default"/>.</t>
<table>
        <name>Sub-TLV Types</name>
        <thead>
        <tr>
                <th>Type</th>
                <th>Name</th>
                <th>Section of This Document</th>
        </tr>
        </thead>
        <tbody>
        <tr>
                <td>0</td>
                <td>Reserved</td>
                <td></td>
        </tr>
        <tr>
                <td>1</td>
                <td>VRF Name</td>
                <td><xref target="sect-7.3.1" format="counter"/></td>
        </tr>
        <tr>
                <td>2</td>
                <td>Ingress-QoS-Profile</td>
                <td><xref target="sect-7.3.1" format="counter"/></td>
        </tr>
        <tr>
                <td>3</td>
                <td>Egress-QoS-Profile</td>
                <td><xref target="sect-7.3.1" format="counter"/></td>
        </tr>
        <tr>
                <td>4</td>
                <td>User-ACL-Policy</td>
                <td><xref target="sect-7.3.1" format="counter"/></td>
        </tr>
        <tr>
                <td>5</td>
                <td>Multicast-ProfileV4</td>
                <td><xref target="sect-7.3.1" format="counter"/></td>
        </tr>
        <tr>
                <td>6</td>
                <td>Multicast-ProfileV6</td>
                <td><xref target="sect-7.3.1" format="counter"/></td>
        </tr>
        <tr>
                <td>7</td>
                <td>Ingress-CAR</td>
                <td><xref target="sect-7.3.2" format="counter"/></td>
        </tr>
        <tr>
                <td>8</td>
                <td>Egress-CAR</td>
                <td><xref target="sect-7.3.3" format="counter"/></td>
        </tr>
        <tr>
                <td>9</td>
                <td>NAT-Instance</td>
                <td><xref target="sect-7.3.1" format="counter"/></td>
        </tr>
        <tr>
                <td>10</td>
                <td>Pool-Name</td>
                <td><xref target="sect-7.3.1" format="counter"/></td>
        </tr>
        <tr>
                <td>11</td>
                <td>If-Desc</td>
                <td><xref target="sect-7.3.4" format="counter"/></td>
        </tr>
        <tr>
                <td>12</td>
                <td>IPv6-Address List</td>
                <td><xref target="sect-7.3.5" format="counter"/></td>
        </tr>
        <tr>
                <td>13</td>
                <td>Vendor</td>
                <td><xref target="sect-7.3.6" format="counter"/></td>
        </tr>
        <tr>
                <td>12-64534</td>
                <td>Unassigned</td>
                <td></td>
        </tr>
        <tr>
                <td>65535</td>
                <td>Reserved</td>
                <td></td>
        </tr>
        </tbody>
</table>
      </section>
      <section anchor="sect-9.5" numbered="true" toc="default">

        <name>Error Codes</name>
<table>
        <name>Error Codes</name>
<thead>
	<tr>
		<th>Value</th>
		<th>Name</th>
		<th>Remarks</th>
	</tr>
</thead>
<tbody>
        <tr>
                <td>0</td><td>Success</td><td>Success</td>
        </tr>
        <tr>
                <td>1</td><td>Failure</td><td>Malformed message received.</td>
        </tr>
        <tr>
                 <td>2</td><td>TLV-Unknown</td><td>One or more of the TLVs was not understood.</td>
        </tr>
        <tr>
                 <td>3</td><td>TLV-Length</td><td>The TLV length is abnormal.</td>
        </tr>
        <tr>     
                 <td>4-999</td><td>Unassigned</td><td>Unassigned basic error codes.</td>
        </tr>
        <tr> 
                 <td>1000</td><td>Reserved</td><td></td>
        </tr>
        <tr>
                 <td>1001</td><td>Version-Mismatch</td><td>The version negotiation fails. Terminate.  The subsequent service processes corresponding to the UP are suspended.</td>
        </tr>
        <tr>     
                 <td>1002</td><td>Keepalive Error</td><td>The keepalive negotiation fails.</td>
        </tr>
        <tr>     
                 <td>1003</td><td>Timer Expires</td><td>The establishment timer expired.</td>
        </tr>
        <tr>
                 <td>1004-1999</td><td>Unassigned</td><td>Unassigned error codes for version negotiation.</td>
        </tr>
        <tr>
                 <td>2000</td><td>Reserved</td><td></td>
        </tr>
        <tr>
                 <td>2001</td><td>Synch-NoReady</td><td>The data to be smoothed is not ready.</td>
        </tr>
        <tr>
                 <td>2002</td><td>Synch-Unsupport</td><td>The request for smooth data is not supported.</td>
        </tr>
        <tr>
                 <td>2003-2999</td><td>Unassigned</td><td>Unassigned data synchronization error codes.</td>
        </tr>
        <tr>
                 <td>3000</td><td>Reserved</td><td></td>
        </tr>
        <tr>
                 <td>3001</td><td>Pool-Mismatch</td><td>The corresponding address pool cannot be found.</td>
        </tr>
        <tr>
                 <td>3002</td><td>Pool-Full</td><td>The address pool is fully allocated, and no address segment is available.</td>
        </tr>
        <tr>
                 <td>3003</td><td>Subnet-Mismatch</td><td>The address pool subnet cannot be found.</td></tr>
        <tr>
                 <td>3004</td><td>Subnet-Conflict</td><td>Subnets in the address pool have been classified into other clients.</td>
        </tr>
        <tr>
                 <td>3005-3999</td><td>Unassigned</td><td>Unassigned error codes for address allocation.</td>
        </tr>
        <tr>    
                 <td>4000</td><td>Reserved</td><td></td>
        </tr>
        <tr>     
                 <td>4001</td><td>Update-Fail-No-Res</td><td>The forwarding table fails to be delivered because the forwarding resources are insufficient.</td>
        </tr>
        <tr>      
                 <td>4002</td><td>QoS-Update-Success</td><td>The QoS policy takes effect.</td>
        </tr>
        <tr>     
                 <td>4003</td><td>QoS-Update-Sq-Fail</td><td>Failed to process the queue in the QoS policy.</td>
        </tr>
        <tr>
                 <td>4004</td><td>QoS-Update-CAR-Fail</td><td>Processing of the CAR in the QoS policy fails.</td>
        </tr>
        <tr>
                 <td>4005</td><td>Statistic-Fail-No-Res</td><td>Statistics processing failed due to insufficient statistics resources.</td>
        </tr>
        <tr>
                 <td>4006-4999</td><td>Unassigned </td><td>Unassigned forwarding table delivery error codes.</td>
        </tr>
        <tr>
                 <td>5000-4294967295</td><td>Reserved</td><td></td>
        </tr>
</tbody>
</table>
      </section>
      <section anchor="sect-9.6" numbered="true" toc="default">
        <name>If-Type Values</name>
        <t>
   Defined values of the If-Type field in the If-Desc sub-TLV (see
   <xref target="sect-7.3.4" format="default"/>) are as follows:</t>

<table>
        <name>If-Type Values</name>
        <thead>
        <tr>
                <th>Value</th> <th>Meaning</th>
        </tr>
        </thead>
        <tbody>
        <tr>
                <td>0</td><td>Reserved</td>
        </tr>
        <tr>
                <td>1</td><td>Fast Ethernet (FE)</td>
        </tr>
        <tr>
                <td>2</td><td>GE</td>
        </tr>
        <tr>
                <td>3</td><td>10GE</td>
        </tr>
        <tr>
                <td>4</td><td>100GE</td>
        </tr>
        <tr>
                <td>5</td><td>Eth-Trunk</td>
        </tr>
        <tr>
                <td>6</td><td>Tunnel</td>
        </tr>
        <tr>
                <td>7</td><td>VE</td>
        </tr>
        <tr>
                <td>8-254</td><td>Unassigned</td>
        </tr>
        <tr>
                <td>255</td><td>Reserved</td>
        </tr>
        </tbody>
</table>
      </section>
      <section anchor="sect-9.7" numbered="true" toc="default">
        <name>Access-Mode Values</name>
        <t>
   Defined values of the Access-Mode field in the BAS Function TLV (see
   <xref target="sect-7.7" format="default"/>) are as follows:</t>
<table>
	<name>Access-Mode Values</name>
	<thead>
	<tr>
		<th>Value</th> <th>Meaning</th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td>0</td><td>Layer 2 subscriber</td>
	</tr>
	<tr>
		<td>1</td><td>Layer 3 subscriber</td>
	</tr>
	<tr>
		<td>2</td><td>Layer 2 leased line</td>
	</tr>
	<tr>
		<td>3</td><td>Layer 3 leased line</td>
	</tr>
	<tr>
		<td>4-254</td><td>Unassigned</td>
	</tr>
	<tr>
		<td>255</td><td>Reserved</td>
	</tr>
	</tbody>
</table>
      </section>
      <section anchor="sect-9.8" numbered="true" toc="default">
        <name>Access Method Bits</name>
        <t>
   Defined values of the Auth-Method4 and Auth-Method6 fields in the BAS
   Function TLV (see <xref target="sect-7.7" format="default"/>) are defined as bit fields as follows:</t>
<table>
	<name>Auth-Method4 Values</name>
	<thead>
	<tr>
		<th>Bit</th>
		<th>Meaning</th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td>0x01</td><td>PPPoE authentication</td>
	</tr>
	<tr>
		<td>0x02</td><td>DOT1X authentication</td>
	</tr>
	<tr>
		<td>0x04</td><td>Web authentication</td>
	</tr>
	<tr>
		<td>0x08</td><td>Web fast authentication</td>
	</tr>
	<tr>
		<td>0x10</td><td>Binding authentication</td>
	</tr>
	<tr>
		<td>0x20</td><td>Reserved</td>
	</tr>
	<tr>
		<td>0x40</td><td>Reserved</td>
	</tr>
	<tr>
		<td>0x80</td><td>Reserved</td>
	</tr>
	</tbody>
</table>

<table>
	<name>Auth-Method6 Values</name>
	<thead>
	<tr>
		<th>Bit</th>
		<th>Meaning</th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td>0x01</td><td>PPPoE authentication</td>
	</tr>
	<tr>
		<td>0x02</td><td>DOT1X authentication</td>
	</tr>
	<tr>
		<td>0x04</td><td>Web authentication</td>
	</tr>
	<tr>
		<td>0x08</td><td>Web fast authentication</td>
	</tr>
	<tr>
		<td>0x10</td><td>Binding authentication</td>
	</tr>
	<tr>
		<td>0x20</td><td>Reserved</td>
	</tr>
	<tr>
		<td>0x40</td><td>Reserved</td>
	</tr>
	<tr>
		<td>0x80</td><td>Reserved</td>
	</tr>
	</tbody>
</table>
      </section>
      <section anchor="sect-9.9" numbered="true" toc="default">
        <name>Route-Type Values</name>
        <t>
   Values of the Route-Type field in the IPv4 and IPv6 Routing TLVs (see Sections
   <xref target="sect-7.8.1" format="counter"/> and <xref target="sect-7.8.2" format="counter"/>) defined in this document are as follows:</t>
<table>
	<name>Route-Type Values</name>
	<thead>
	<tr>
		<th>Value</th> <th>Meaning</th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td>0</td><td>User host route</td>
	</tr>
	<tr>
		<td>1</td><td>Radius authorization FrameRoute</td>
	</tr>
	<tr>
		<td>2</td><td>Network segment route</td>
	</tr>
	<tr>
		<td>3</td><td>Gateway route</td>
	</tr>
	<tr>
		<td>4</td><td>Radius authorized IP route</td>
	</tr>
	<tr>
		<td>5</td><td>L2TP LNS side user route</td>
	</tr>
	<tr>
		<td>6-65534</td><td>Unassigned</td>
	</tr>
	<tr>
		<td>65535</td><td>Reserved</td>
	</tr>
	</tbody>
</table>
      </section>
      <section anchor="sect-9.10" numbered="true" toc="default">
        <name>Access-Type Values</name>
        <t>
   Values of the Access-Type field in the Basic Subscriber TLV (see
   <xref target="sect-7.9.1" format="default"/>) defined in this document are as follows:</t>
<table>
 <name>Access-Type Values</name>
 <thead>
   <tr>
      <th>Value</th><th>Meaning</th>
   </tr>
 </thead>
 <tbody>
   <tr>
       <td>0</td><td>Reserved</td>
   </tr>
   <tr>
       <td>1</td><td>PPP access (PPP <xref target="RFC1661" format="default"/>)</td>
   </tr>
   <tr>
       <td>2</td><td>PPP over Ethernet over ATM access (PPPoEoA)</td>
   </tr>
   <tr>
       <td>3</td><td>PPP over ATM access (PPPoA <xref target="RFC3336" format="default"/>)</td>
   </tr>
   <tr>
       <td>4</td><td>PPP over Ethernet access (PPPoE <xref target="RFC2516" format="default"/>)</td>
   </tr>
   <tr>
       <td>5</td><td>PPPoE over VLAN access (PPPoEoVLAN <xref target="RFC2516" format="default"/>)</td>
   </tr>
   <tr>
       <td>6</td><td>PPP over LNS access (PPPoLNS)</td>
   </tr>
   <tr>
       <td>7</td><td>IP over Ethernet DHCP access (IPoE_DHCP)</td>
   </tr>
   <tr>
       <td>8</td><td>IP over Ethernet EAP authentication access (IPoE_EAP)</td>
   </tr>
   <tr>
       <td>9</td><td>IP over Ethernet Layer 3 access (IPoE_L3)</td>
   </tr>
   <tr>
       <td>10</td><td>IP over Ethernet Layer 2 Static access (IPoE_L2_STATIC)</td>
   </tr>
   <tr>
       <td>11</td><td>Layer 2 Leased Line access (L2_Leased_Line)</td>
   </tr>
   <tr>
       <td>12</td><td>Layer 2 VPN Leased Line access (L2VPN_Leased_Line)</td>
   </tr>
   <tr>
       <td>13</td><td>Layer 3 Leased Line access (L3_Leased_Line)</td>
   </tr>
   <tr>
       <td>14</td><td>Layer 2 Leased line Sub-User access
               (L2_Leased_Line_SUB_USER)</td>
   </tr>
   <tr>
       <td>15</td><td>L2TP LAC tunnel access (L2TP_LAC)</td>
   </tr>
   <tr>
       <td>16</td><td>L2TP LNS tunnel access (L2TP_LNS)</td>
   </tr>
   <tr>
       <td>17-254</td><td>Unassigned</td>
   </tr>
   <tr>
       <td>255</td><td>Reserved</td>
   </tr>
 </tbody>
</table>
      </section>
    </section>
    <section anchor="sect-10" numbered="true" toc="default">
      <name>IANA Considerations</name>
      <t>
   This document has no IANA actions.</t>
    </section>
    <section anchor="sect-11" numbered="true" toc="default">
      <name>Security Considerations</name>
      <t>
   The Service, Control, and Management Interfaces between the CP and UP
   might be across the general Internet or other hostile environment.
   The ability of an adversary to block or corrupt messages or introduce
   spurious messages on any one or more of these interfaces would give
   the adversary the ability to stop subscribers from accessing network
   services, disrupt existing subscriber sessions, divert traffic, mess
   up accounting statistics, and generally cause havoc. Damage would not
   necessarily be limited to one or a few subscribers but could disrupt
   routing or deny service to one or more instances of the CP or
   otherwise cause extensive interference. If the adversary knows the
   details of the UP equipment and its forwarding rule capabilities, the
   adversary may be able to cause a copy of most or all user data to be
   sent to an address of the adversary's choosing, thus enabling
   eavesdropping.</t>
      <t>
   Thus, appropriate protections <bcp14>MUST</bcp14> be implemented to provide
   integrity, authenticity, and secrecy of traffic over those
   interfaces. Whether such protection is used is the decision of the network operator.
   See <xref target="RFC6241" format="default"/> for Mi/NETCONF security.
   Security on the Si is dependent on the tunneling
   protocol used, which is out of scope for this document.  Security for
   the Ci, over which S-CUSP flows, is
   further discussed below.</t>
      <t>
   S-CUSP messages do not provide security. Thus, if these messages are
   exchanged in an environment where security is a concern, that
   security <bcp14>MUST</bcp14> be provided by another protocol such as TLS 1.3
   <xref target="RFC8446" format="default"/> or IPsec. TLS 1.3 is the mandatory-to-implement protocol
   for interoperability. The use of a particular security protocol on
   the Ci is determined by configuration. Such security
   protocols need not always be used, and lesser security precautions
   might be appropriate because, in some cases, the communication
   between the CP and UP is in a benign environment.</t>
    </section>
  </middle>
  <back>

<displayreference target="RFC0020" to="RFC20"/>
<displayreference target="RFC0793" to="RFC793"/>
<displayreference target="IEEE-802.1Q" to="802.1Q"/>

    <references>
      <name>References</name>
      <references>
        <name>Normative References</name>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.0020.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.0793.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2661.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2865.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6241.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
      </references>
      <references>

        <name>Informative References</name>

<reference anchor="IEEE-802.1Q" >
  <front>
    <title>IEEE Standard for Local and metropolitan area networks--Bridges and Bridged Networks</title>
    <author>
      <organization>IEEE</organization>
    </author>
  <date month="July" year="2018" />
  </front>
  <seriesInfo name="IEEE" value="802.1Q-2018"/>
  <seriesInfo name="DOI" value="10.1109/IEEESTD.2018.8403927"/>
</reference>

        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.1661.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2131.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2516.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2698.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3022.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3336.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5511.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7042.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7348.xml"/>
        <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8446.xml"/>



        <reference anchor="TR-384">
          <front>
            <title>Cloud Central Office Reference Architectural Framework</title>
            <seriesInfo name="BBF" value="TR-384"/>
            <author>
              <organization>Broadband Forum</organization>
            </author>
            <date month="January" year="2018"/>
          </front>
        </reference>


        <reference anchor="WT-459">
          <front>
            <title>Control and User Plane Separation for a Disaggregated BNG</title>
            <seriesInfo name="BBF" value="WT-459"/>
            <author>
              <organization>Broadband Forum</organization>
            </author>
            <date year="2019"/>
          </front>
        </reference>
      </references>
    </references>
    <section numbered="false" anchor="acknowledgements" toc="default">
      <name>Acknowledgements</name>
      <t>
   The helpful comments and suggestions from the following individuals are hereby
   acknowledged:

      </t>
      <ul spacing="normal">
        <li><t><contact fullname="Loa Andersson"/></t></li>
        <li><t><contact fullname="Greg Mirsky"/></t></li>
      </ul>
    </section>

    <section numbered="false" anchor="contributors" toc="default">
      <name>Contributors</name>


      <contact fullname="Zhenqiang Li" >
        <organization>China Mobile</organization>
        <address>
          <postal>
            <street>32 Xuanwumen West Ave</street>
            <cityarea>Xicheng District</cityarea>
            <city>Beijing</city>
            <region></region><code>100053</code>
            <country>China</country>
          </postal>
          <email>lizhenqiang@chinamobile.com</email>
        </address>
	</contact>

      <contact fullname="Mach(Guoyi) Chen" >
        <organization>Huawei Technologies</organization>
        <address>
          <postal>
            <street>Huawei Bldg., No. 156 Beiqing Road</street>
            <city>Beijing</city>
            <region></region><code>100095</code>
            <country>China</country>
          </postal>
          <email>mach.chen@huawei.com</email>
        </address>
	</contact>

      <contact fullname="Zhouyi Yu" >
        <organization>Huawei Technologies</organization>
        <address>
          <postal>
            <street></street>
            <city></city>
            <region></region><code></code>
            <country></country>
          </postal>
          <email>yuzhouyi@huawei.com</email>
        </address>
	</contact>

      <contact fullname="Chengguang Niu" >
        <organization>Huawei Technologies</organization>
        <address>
          <postal>
            <street></street>
            <city></city>
            <region></region><code></code>
            <country></country>
          </postal>
          <email>chengguang.niu@huawei.com</email>
        </address>
	</contact>

      <contact fullname="Zitao Wang" >
        <organization>Huawei Technologies</organization>
        <address>
          <postal>
            <street></street>
            <city></city>
            <region></region><code></code>
            <country></country>
          </postal>
          <email>wangzitao@huawei.com</email>
        </address>
	</contact>

      <contact fullname="Jun Song" >
        <organization>Huawei Technologies</organization>
        <address>
          <postal>
            <street></street>
            <city></city>
            <region></region><code></code>
            <country></country>
          </postal>
          <email>song.jun@huawei.com</email>
        </address>
	</contact>

      <contact fullname="Dan Meng" >
        <organization>H3C Technologies</organization>
        <address>
          <postal>
            <extaddr>No. 1 Lixing Center</extaddr>
            <street>No. 8 Guangxun South Street</street>
            <cityarea>Chaoyang District</cityarea>
            <city>Beijing</city>
            <region></region><code>100102</code>
            <country>China</country>
          </postal>
          <email>mengdan@h3c.com</email>
        </address>
	</contact>

      <contact fullname="Hanlei Liu" >
        <organization>H3C Technologies</organization>
        <address>
          <postal>
            <extaddr>No. 1 Lixing Center</extaddr>
            <street>No. 8 Guangxun South Street</street>
            <cityarea>Chaoyang District</cityarea>
            <city>Beijing</city>
            <region></region><code>100102</code>
            <country>China</country>
          </postal>
          <email>hanlei_liu@h3c.com</email>
        </address>
	</contact>

      <contact fullname="Victor Lopez" >
        <organization>Telefonica</organization>
        <address>
          <postal>
            <street></street>
            <city></city>
            <region></region><code></code>
            <country>Spain</country>
          </postal>
          <email>victor.lopezalvarez@telefonica.com</email>
        </address>
	</contact>

    </section>
  </back>
</rfc>
