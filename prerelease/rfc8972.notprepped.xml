<?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE rfc SYSTEM "rfc2629-xhtml.ent">

<rfc xmlns:xi="http://www.w3.org/2001/XInclude" 
     docName="draft-ietf-ippm-stamp-option-tlv-10" 
     number="8972"
     ipr="trust200902" 
     updates="8762" 
     obsoletes="" 
     submissionType="IETF" 
     category="std" 
     consensus="true"
     xml:lang="en" 
     tocInclude="true" 
     tocDepth="3" 
     symRefs="true" 
     sortRefs="true" 
     version="3">

<front>
    <title abbrev="STAMP Extensions">Simple Two-Way Active Measurement Protocol Optional Extensions</title>
    <seriesInfo name="RFC" value="8972"/>
    <author fullname="Greg Mirsky" initials="G." surname="Mirsky">
      <organization>ZTE Corp.</organization>
      <address>
        <postal>
          <street/>
          <city/>
          <code/>
          <country/>
        </postal>
        <email>gregimirsky@gmail.com</email>
      </address>
    </author>
    <author fullname="Xiao Min" initials="X." surname="Min">
      <organization>ZTE Corp.</organization>
      <address>
        <postal>
          <street/>
          <city/>
          <code/>
          <country/>
        </postal>
        <email>xiao.min2@zte.com.cn</email>
      </address>
    </author>
      <author fullname="Henrik Nydell" initials="H." surname="Nydell">
      <organization>Accedian Networks</organization>
      <address>
        <postal>
          <street/>
          <city/>
          <code/>
          <country/>
        </postal>
        <email>hnydell@accedian.com</email>
      </address>
    </author>
    <author initials="R." surname="Foote" fullname="Richard Foote">
      <organization>Nokia</organization>
      <address>
        <email>footer.foote@nokia.com </email>
      </address>
    </author>
    <author initials="A." surname="Masputra" fullname="Adi Masputra">
      <organization>Apple Inc.</organization>
      <address>
        <postal>
          <street>One Apple Park Way</street>
          <city>Cupertino</city>
          <region>CA</region>
          <code>95014</code>
          <country>United States of America</country>
        </postal>
        <email>adi@apple.com</email>
      </address>
    </author>
    <author fullname="Ernesto Ruffini" initials="E." surname="Ruffini">
      <organization>OutSys</organization>
      <address>
        <postal>
          <street>via Caracciolo, 65</street>
          <city>Milan</city>
          <code>20155</code>
          <country>Italy</country>
        </postal>
        <email>eruffini@outsys.org</email>
      </address>
    </author>
    <date year="2021" month="January" />
    <area>Transport</area>
    <workgroup>IPPM</workgroup>
    <keyword>IPPM</keyword>
    <keyword>Performance Measurement</keyword>
    <abstract>
      <t>
	This document describes optional extensions to Simple
	Two-way Active Measurement Protocol (STAMP) that enable
	measurement of performance metrics. The document also defines
	a STAMP Test Session Identifier and thus updates RFC 8762.
      </t>
    </abstract>
  </front>
  <middle>
    <section anchor="intro" numbered="true" toc="default">
      <name>Introduction</name>
      <t>
The Simple Two-way Active Measurement Protocol (STAMP) <xref target="RFC8762" format="default"/> defines the STAMP base functionalities.
This document specifies the use of
optional extensions that use Type-Length-Value (TLV) encoding.
Such extensions enhance the STAMP base functions,
   such as measurement of one-way and round-trip delay,
   latency, packet loss, packet duplication, and
   out-of-order delivery of test packets. This specification defines
optional STAMP extensions, their formats, and the theory of operation.
Also, a STAMP Test Session Identifier is defined
as an update of the base STAMP specification <xref target="RFC8762" format="default"/>.
      </t>
    </section>
    <section numbered="true" toc="default">
      <name>Conventions Used in This Document</name>
      <section numbered="true" toc="default">
        <name>Acronyms</name>

<dl newline="false" indent="12">
        <dt>BDS</dt><dd>BeiDou Navigation Satellite System</dd>
<dt>BITS</dt><dd>Building Integrated Timing Supply</dd>
<dt>CoS</dt><dd>Class of Service</dd>
<dt>DSCP</dt><dd>Differentiated Services Code Point</dd>
<dt>ECN</dt><dd>Explicit Congestion Notification</dd>
<dt>GLONASS</dt><dd>Global Orbiting Navigation Satellite System</dd>
<dt>GPS</dt><dd>Global Positioning System <xref target="GPS" format="default"/></dd>
<dt>HMAC</dt><dd>Hashed Message Authentication Code</dd>
<dt>LORAN-C</dt><dd>Long Range Navigation System Version C</dd>
<dt>MBZ</dt><dd>Must Be Zero</dd>
<dt>NTP</dt><dd>Network Time Protocol <xref target="RFC5905" format="default"/></dd>
<dt>PMF</dt><dd>Performance Measurement Function</dd>
<dt>PTP</dt><dd>Precision Time Protocol <xref target="IEEE.1588.2008" format="default"/></dd>
<dt>RP</dt><dd>Reverse Path</dd>
<dt>SMI</dt><dd>Structure of Management Information</dd>
<dt>SSID</dt><dd>STAMP Session Identifier</dd>
<dt>SSU</dt><dd>Synchronization Supply Unit</dd>
<dt>STAMP</dt><dd>Simple Two-way Active Measurement Protocol</dd>
<dt>TLV</dt><dd>Type-Length-Value</dd>
</dl>
      </section>
      <section numbered="true" toc="default">
        <name>Requirements Language</name>
        <t>
    The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL
    NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
    "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
    described in BCP&nbsp;14 <xref target="RFC2119"/> <xref target="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
      </section>
    </section>
    <section anchor="test-identifier-sec" numbered="true" toc="default">
      <name>STAMP Test Session Identifier</name>
      <t>
The STAMP Session-Sender transmits test packets to the STAMP Session-Reflector. The STAMP Session-Reflector
receives the Session-Sender's packet and acts according to the configuration and optional control information
communicated in the Session-Sender's test packet. STAMP defines two different test packet formats: one for
   packets transmitted by the STAMP Session-Sender and one for packets
   transmitted by the STAMP Session-Reflector. STAMP supports two modes:
   unauthenticated and authenticated. Unauthenticated STAMP test packets
   are compatible on the wire with unauthenticated TWAMP-Test <xref target="RFC5357" format="default"/>
   packets.
</t>
      <t>
By default, STAMP uses symmetrical packets, i.e., the size of the packet
transmitted by the Session-Reflector equals the size of
the packet received by the Session-Reflector.
</t>
      <t>
  A STAMP Session is identified by the 4-tuple (source and destination IP addresses,
  source and destination UDP port numbers). A STAMP Session-Sender
  <bcp14>MAY</bcp14> generate a locally unique STAMP Session Identifier (SSID).
  The SSID is a two-octet, non-zero unsigned integer. The SSID generation
   policy is implementation specific. <xref target="I-D.irtf-pearg-numeric-ids-generation" format="default"/> thoroughly analyzes common algorithms for identifier generation and their vulnerabilities.
   For example, an implementation can use the algorithms described in <xref target="I-D.irtf-pearg-numeric-ids-generation" sectionFormat="of" section="7.1"/>.
   An implementation <bcp14>MUST NOT</bcp14> assign the same identifier to different STAMP test sessions.
  A Session-Sender <bcp14>MAY</bcp14> use the SSID to identify
  a STAMP test session. If the SSID is used, it <bcp14>MUST</bcp14> be present in each test packet of the given test session.
  In the unauthenticated mode, the SSID is located as displayed in <xref target="session-sender-unauthenticated-format" format="default"/>.
      </t>
      <figure anchor="session-sender-unauthenticated-format">
        <name>The Format of an Extended STAMP Session-Sender Test Packet in Unauthenticated Mode</name>
        <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Sequence Number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Timestamp                            |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Error Estimate        |             SSID              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                                                               |
   |                         MBZ (28 octets)                       |
   |                                                               |
   |                                                               |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                            TLVs                               ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
      </figure>
      <t>
  An implementation of the STAMP Session-Reflector that supports this specification <bcp14>MUST</bcp14>
   identify a STAMP Session using the SSID in combination with elements of the usual 4-tuple
   for the session. Before a test session commences, a Session-Reflector <bcp14>MUST</bcp14> be provisioned
   with all the elements that identify the STAMP Session. A STAMP Session-Reflector <bcp14>MUST</bcp14> discard
   non-matching STAMP test packets. The means of provisioning the STAMP Session identification
   is outside the scope of this specification.

   A conforming implementation of a STAMP Session-Reflector <bcp14>MUST</bcp14> copy
  the SSID value from the received test packet and put it into the reflected packet,
  as displayed in <xref target="session-reflector-unauthenticated-format" format="default"/>.
      </t>
      <figure anchor="session-reflector-unauthenticated-format">
        <name>The Format of an Extended STAMP Session-Reflector Test Packet in Unauthenticated Mode</name>
        <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sequence Number                        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          Timestamp                            |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         Error Estimate        |           SSID                |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          Receive Timestamp                    |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                 Session-Sender Sequence Number                |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                  Session-Sender Timestamp                     |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | Session-Sender Error Estimate |           MBZ                 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |Ses-Sender TTL |                   MBZ                         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 ~                            TLVs                               ~
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
      </figure>
      <t>
        A STAMP Session-Reflector that does not support this specification
will return the zeroed SSID field in the reflected STAMP test packet.
 The Session-Sender <bcp14>MAY</bcp14> stop the session if it receives a zeroed SSID field. An implementation
 of a Session-Sender <bcp14>MUST</bcp14> support control of its behavior in such a scenario.
 If the test session is not stopped, the Session-Sender can, for example,
 send a base STAMP packet <xref target="RFC8762" format="default"/> or continue transmitting STAMP test packets with the SSID.
</t>
      <t>
 The location of the SSID field in the authenticated mode
  is shown in Figures <xref target="session-sender-authenticated-format" format="counter"/> and <xref target="session-reflector-authenticated-format" format="counter"/>.
      </t>
      <figure anchor="session-sender-authenticated-format">
        <name>The Format of an Extended STAMP Session-Sender Test Packet in Authenticated Mode</name>
        <artwork name="" type="" align="left" alt=""><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                      Sequence Number                          |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                      MBZ (12 octets)                          |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Timestamp                              |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |        Error Estimate         |            SSID               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 ~                                                               ~
 |                         MBZ (68 octets)                       |
 ~                                                               ~
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 |                       HMAC (16 octets)                        |
 |                                                               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 ~                            TLVs                               ~
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork></figure>
      <figure anchor="session-reflector-authenticated-format">
        <name>The Format of an Extended STAMP Session-Reflector Test Packet in Authenticated Mode</name>
        <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Sequence Number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        MBZ (12 octets)                        |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Timestamp                            |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Error Estimate        |            SSID               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        MBZ (4 octets)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Receive Timestamp                      |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        MBZ (8 octets)                         |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 Session-Sender Sequence Number                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        MBZ (12 octets)                        |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 Session-Sender Timestamp                      |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Session-Sender Error Estimate |                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
   |                        MBZ (6 octets)                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Ses-Sender TTL |                                               |
   +-+-+-+-+-+-+-+-+                                               +
   |                                                               |
   |                        MBZ (15 octets)                        |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        HMAC (16 octets)                       |
   |                                                               |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                            TLVs                               ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  ]]></artwork>
      </figure>
    </section>
    <section anchor="stamp-extension-section" numbered="true" toc="default">
      <name>TLV Extensions to STAMP</name>

      <t>
The Type-Length-Value (TLV) encoding scheme provides a flexible
extension mechanism for optional informational elements.
 TLV is an optional field in the STAMP test packet. Multiple TLVs
 <bcp14>MAY</bcp14> be placed in a STAMP test packet. Additional TLVs
may be enclosed within a given TLV, subject to the semantics of the
(outer) TLV in question.
 TLVs have a one-octet STAMP TLV Flags field, a one-octet Type field, and
  a two-octet Length field that is equal to the length of the Value field in octets.
   If a Type value for a TLV or sub-TLV is in the range for
   Private Use <xref target="RFC8126"/>, the length <bcp14>MUST</bcp14> be at least 4, and the first four octets
   <bcp14>MUST</bcp14> be that vendor's Structure of
   Management Information (SMI) Private Enterprise Code, as recorded in
   IANA's "SMI Network Management Private Enterprise Codes" subregistry, in network octet
   order. The rest of the Value field is private to the vendor.
The following sections describe the use of TLVs for STAMP
that extend the STAMP capability beyond its base specification.
      </t>
      <figure anchor="tlv-format">
        <name>TLV Format in a STAMP Extended Packet</name>
        <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |STAMP TLV Flags|     Type      |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                            Value                              ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
      </figure>
      <t>
       The fields are defined as follows:
      </t>
      <dl spacing="normal" newline="false">
        <dt>STAMP TLV Flags:</dt><dd>An eight-bit field. The detailed format and interpretation of flags defined in this specification are below.</dd>
        <dt>Type:</dt><dd>A one-octet field that characterizes the interpretation of
        the Value field. It is allocated by IANA, as specified in <xref target="iana-stamp-tlv-registry" format="default"/>.</dd>
        <dt>Length:</dt><dd>A two-octet field equal to the length of the Value field in octets.</dd>
        <dt>Value:</dt><dd>A variable-length field. Its interpretation and encoding are determined by the value of the Type field.</dd>
      </dl>
      <t>
       All multi-byte fields in TLVs defined in this specification are in network byte order.
      </t>

      <t>
The format of the STAMP TLV Flags is displayed in <xref target="tlv-flags-format" format="default"/>, and the location of flags is defined in <xref target="iana-tlv-flags-reg" format="default"/>.
      </t>
      <figure anchor="tlv-flags-format">
        <name>STAMP TLV Flags Format</name>
        <artwork name="" type="" align="left" alt=""><![CDATA[
    0 1 2 3 4 5 6 7
   +-+-+-+-+-+-+-+-+
   |U|M|I|R|R|R|R|R|
   +-+-+-+-+-+-+-+-+
]]></artwork>
      </figure>
      <t>
      The fields are defined as follows:
      </t> 
      <dl newline="false" spacing="normal">
        <dt>U (Unrecognized):</dt><dd>A one-bit flag.
        A Session-Sender <bcp14>MUST</bcp14> set the U flag to 1 before transmitting an extended STAMP test packet.
        A Session-Reflector <bcp14>MUST</bcp14> set the U flag to 1 if the Session-Reflector has not understood the TLV.
        Otherwise, the Session-Reflector <bcp14>MUST</bcp14> set the U flag in the reflected packet to 0.</dd>
        <dt>M (Malformed):</dt><dd>A one-bit flag.
        A Session-Sender <bcp14>MUST</bcp14> set the M flag to 0 before transmitting an extended STAMP test packet.
        A Session-Reflector <bcp14>MUST</bcp14> set the M flag to 1 if the Session-Reflector determined the TLV is malformed,
        i.e., the Length field value is not valid for the particular type, or
        the remaining length of the extended STAMP packet is less than the size of the TLV.
        Otherwise, the Session-Reflector <bcp14>MUST</bcp14> set the M flag in the reflected packet to 0.
        </dd>
        <dt>I (Integrity):</dt><dd>A one-bit flag.
        A Session-Sender <bcp14>MUST</bcp14> set the I flag to 0 before transmitting an extended STAMP test packet.
        A Session-Reflector <bcp14>MUST</bcp14> set the I flag to 1 if the STAMP extensions have failed HMAC verification (<xref target="hmac-sec" format="default"/>).
        Otherwise, the Session-Reflector <bcp14>MUST</bcp14> set the I flag in the reflected packet to 0.</dd>
        <dt>R:</dt><dd>Reserved flags for future use. These flags <bcp14>MUST</bcp14> be zeroed on transmit and ignored on receipt.</dd>
      </dl>
      <t>
A STAMP node, whether Session-Sender or Session-Reflector, receiving a test packet <bcp14>MUST</bcp14>
determine whether the packet is a base STAMP packet or whether it includes one or more TLVs.
The node <bcp14>MUST</bcp14> compare the value in the Length field of the UDP header and
the length of the base STAMP test packet in the mode, unauthenticated or authenticated, based
on the configuration of the particular STAMP test session. If the difference between the two values is
greater than the length of the UDP header, then the test packet includes one or more STAMP TLVs
that immediately follow the base STAMP test packet.
A Session-Reflector that does not support STAMP extensions will not process but
copy them into the reflected packet, as defined in <xref
target="RFC8762" sectionFormat="of" section="4.3"/>.
A Session-Reflector that supports TLVs will indicate specific TLVs that
it did not process by setting the U flag to 1 in those TLVs.
</t>
      <t>
A STAMP Session-Sender that has received a reflected STAMP test packet with extension TLVs <bcp14>MUST</bcp14> validate each TLV:
</t>
      <ul spacing="normal">
        <li>
If the U flag is set, the STAMP system <bcp14>MUST</bcp14> skip the processing of the TLV.
</li>
        <li>
If the M flag is set, the STAMP system <bcp14>MUST</bcp14> stop processing the remainder of the extended STAMP packet.
</li>
        <li>
If the I flag is set, the STAMP system <bcp14>MUST</bcp14> discard all TLVs and
<bcp14>MUST</bcp14> stop processing the remainder of the extended STAMP packet.
</li>
        <li>
If an implementation of a Session-Reflector does not recognize the Type field value,
it <bcp14>MUST</bcp14> include a copy of the TLV in the reflected STAMP packet.
The Session-Reflector <bcp14>MUST</bcp14> set the U flag to 1.
The Session-Reflector <bcp14>MUST</bcp14> skip the processing of the unrecognized TLV.
 </li>
        <li>
If a TLV is malformed, the processing of extension TLVs <bcp14>MUST</bcp14> be
stopped. The Session-Reflector <bcp14>MUST</bcp14> copy the remainder of the received extended STAMP packet into the reflected STAMP packet.
The Session-Reflector <bcp14>MUST</bcp14> set the M flag to 1.
</li>
      </ul>
      <t>
</t>
      <section anchor="padding-tlv-section" numbered="true" toc="default">
        <name>Extra Padding TLV</name>

        <figure anchor="padding-tlv-figuret">
          <name>Extra Padding TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |STAMP TLV Flags|      Type     |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                         Extra Padding                         ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <t> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal" newline="false">
          <dt>STAMP TLV Flags:</dt><dd>An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default"/>.</dd>
          <dt>Type:</dt><dd>A one-octet field. Value 1 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default"/>).</dd>
          <dt>Length:</dt><dd>A two-octet field equal to the length of the Extra Padding field in octets.</dd>
          <dt>Extra Padding:</dt><dd>This field <bcp14>SHOULD</bcp14> be filled by a sequence of pseudorandom numbers. The field <bcp14>MAY</bcp14> be filled with all zeros.
       An implementation <bcp14>MUST</bcp14> control the content of the Extra Padding field.</dd>
        </dl>
        <t>
  The Extra Padding TLV is similar to the Packet Padding field in a TWAMP-Test packet <xref target="RFC5357" format="default"/>.
  The use of the Extra Padding TLV is <bcp14>RECOMMENDED</bcp14> to perform a STAMP test using 
  test packets that are larger than the base STAMP packet
  <xref target="RFC8762" format="default"/>. The length of the base STAMP packet is 44 octets
  in the unauthenticated mode or 112 octets in the authenticated mode.
  The Extra Padding TLV <bcp14>MAY</bcp14> be present more than one time in an extended STAMP test packet.
        </t>
      </section>
      <section anchor="location-info-section" numbered="true" toc="default">
        <name>Location TLV</name>

        <t>
  STAMP Session-Senders <bcp14>MAY</bcp14> include the variable-size Location TLV to query location information from the Session-Reflector.
  The Session-Sender <bcp14>MUST NOT</bcp14> fill any information fields except for the STAMP TLV Flags, Type, and Length fields.
  The Session-Reflector <bcp14>MUST</bcp14> verify that the TLV is well formed. If it is not, the Session-Reflector follows the procedure defined in <xref target="stamp-extension-section" format="default"/>
  for a malformed TLV.
        </t>
        <figure anchor="location-tlv-figuret">
          <name>Location TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |STAMP TLV Flags|      Type     |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Destination Port       |          Source Port          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                         Sub-TLVs                              ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <t> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal" newline="false">
          <dt>STAMP TLV Flags:</dt><dd>An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default"/>.</dd>
          <dt>Type:</dt><dd>A one-octet field. Value 2 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default"/>).</dd>
          <dt>Length:</dt><dd>A two-octet field equal to the length of the Value field in octets.</dd>
          <dt>Destination Port:</dt><dd>A two-octet UDP destination port number of the received STAMP packet.</dd>
          <dt>Source Port:</dt><dd>A two-octet UDP source port number of the received STAMP packet.</dd>
          <dt>Sub-TLVs:</dt><dd>A sequence of sub-TLVs, as defined further in this section. The sub-TLVs are used by the
        Session-Sender to request location information with generic sub-TLV types, and the
        Session-Reflector responds with the corresponding more-specific sub-TLVs
        for the type of address (e.g., IPv4 or IPv6) used at the Session-Reflector.</dd>
        </dl>
        <t>Note that all fields not filled by either a Session-Sender or Session-Reflector are transmitted with all bits set to zero.</t>
        <section anchor="location-sub-tlv-sec" numbered="true" toc="default">
          <name>Location Sub-TLVs</name>
          <t>
  A sub-TLV in the Location TLV uses the format displayed in <xref target="tlv-format" format="default"/>.
  Handling of the U and M flags in the sub-TLV is as defined in <xref target="stamp-extension-section" format="default"/>.
  The I flag <bcp14>MUST</bcp14> be set by a Session-Sender and Session-Reflector to 0 before transmission and its value ignored on receipt.
  The following types of sub-TLVs for the Location TLV are defined in this specification
  (<xref target="sub-tlv-type-tbl" format="default"/> lists the Type values):
          </t>
          <dl newline="false" spacing="normal">
 <dt>Source MAC Address sub-TLV:</dt><dd>A 12-octet sub-TLV.
  The Type value is 1.
  The value of the Length field <bcp14>MUST</bcp14> be equal to 8.
  The Value field is an 8-octet MBZ field that <bcp14>MUST</bcp14> be zeroed on transmission and ignored on receipt.
  </dd>
       <dt>
    Source EUI-48 Address sub-TLV:</dt><dd><t>A 12-octet sub-TLV that includes the EUI-48 source MAC address.
  The Type value is 2.
  The value of the Length field <bcp14>MUST</bcp14> be equal to 8.</t>

              <figure anchor="eui-48-tlv-figure">
                <name>The Value Field of the Source EUI-48 Address Sub-TLV</name>
                <artwork name="" type="" align="left" alt=""><![CDATA[
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|                        EUI-48  Address                        |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |            MBZ                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
              </figure>
              <t> 
  The Value field consists of the following fields (<xref target="eui-48-tlv-figure" format="default"/>):
              </t>
              <dl spacing="normal">
                <dt>EUI-48 Address:</dt><dd>A six-octet field.</dd>
                <dt>MBZ:</dt><dd>A two-octet field. It <bcp14>MUST</bcp14> be zeroed on transmission and ignored on receipt.</dd>
              </dl>
              </dd>
           
            <dt>Source EUI-64 Address sub-TLV:</dt><dd>A 12-octet sub-TLV that includes the EUI-64 source MAC address.
  The Type value is 3.
  The value of the Length field <bcp14>MUST</bcp14> be equal to 8.
  The Value field consists of an eight-octet EUI-64 field.
  </dd>
            <dt>
        Destination IP Address sub-TLV:</dt><dd>A 20-octet sub-TLV.
        The Type value is 4.
        The value of the Length field <bcp14>MUST</bcp14> be equal to 16.
        The Value field consists of a 16-octet  MBZ field that <bcp14>MUST</bcp14> be zeroed on transmit and ignored on receipt.
        </dd>
            <dt>            
        Destination IPv4 Address sub-TLV:</dt><dd><t>A 20-octet sub-TLV that includes the IPv4 destination address.
        The Type value is 5.
        The value of the Length field <bcp14>MUST</bcp14> be equal to 16.</t>

              <figure anchor="ipv4-value-figure">
                <name>IPv4 Address in a Sub-TLV's Value Field</name>
                <artwork name="" type="" align="left" alt=""><![CDATA[
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|                         IPv4 Address                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
~                        MBZ (12 octets)                        ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
              </figure>
              <t> 
        The Value field consists of the following fields (<xref target="ipv4-value-figure" format="default"/>):
              </t>
              <dl spacing="normal">
                <dt>IPv4 Address:</dt><dd>A four-octet field.</dd>
                <dt>MBZ:</dt><dd>A 12-octet field. It <bcp14>MUST</bcp14> be zeroed on transmit and ignored on receipt.</dd>
              </dl>
            </dd>

            <dt>
        Destination IPv6 Address sub-TLV:</dt><dd>A 20-octet sub-TLV that includes the IPv6 destination address.
        The Type value is 6.
        The value of the Length field <bcp14>MUST</bcp14> be equal to 16.
        The Value field is a 16-octet IPv6 Address field.
        </dd>
            <dt>
        Source IP Address sub-TLV:</dt><dd>A 20-octet sub-TLV.
        The Type value is 7.
        The value of the Length field <bcp14>MUST</bcp14> be equal to 16.
        The Value field is a 16-octet MBZ field that <bcp14>MUST</bcp14> be zeroed on transmit and ignored on receipt.
        </dd>
              <dt>
        Source IPv4 Address sub-TLV:</dt><dd><t>A 20-octet sub-TLV that includes the IPv4 source address.
        The Type value is 8.
        The value of the Length field <bcp14>MUST</bcp14> be equal to 16.
        The Value field consists of the following fields (<xref target="ipv4-value-figure" format="default"/>):</t>

              <dl spacing="normal">
                <dt>IPv4 Address:</dt><dd>A four-octet field.</dd>
                <dt>MBZ:</dt><dd>A 12-octet field. It <bcp14>MUST</bcp14> be zeroed on transmit and ignored on receipt.</dd>
              </dl>
            </dd>

            <dt>
        Source IPv6 Address sub-TLV:</dt><dd>A 20-octet sub-TLV that includes the IPv6 source address.
        The Type value is 9.
        The value of the Length field <bcp14>MUST</bcp14> be equal to 16.
        The Value field is a 16-octet IPv6 Address field.
        </dd>
</dl>
        </section>
        <section anchor="location-operation-sec" numbered="true" toc="default">
          <name>Theory of Operation of Location TLV</name>
          <t>

  The Session-Reflector that received an extended STAMP packet with
  the Location TLV <bcp14>MUST</bcp14> include in the reflected packet the Location TLV with a length equal
  to the Location TLV length in the received packet.
  Based on the local policy, the Session-Reflector <bcp14>MAY</bcp14> leave some fields unreported by filling them with zeroes.
  An implementation of the stateful Session-Reflector <bcp14>MUST</bcp14> provide control for managing such policies.
          </t>
          <t>
  A Session-Sender <bcp14>MAY</bcp14> include the Source MAC Address sub-TLV in the Location TLV.
  If the Session-Reflector receives the Location TLV that includes the Source MAC Address sub-TLV, it
  <bcp14>MUST</bcp14> include the Source EUI-48 Address sub-TLV if the source MAC address of the
  received extended test packet is in EUI-48 format. And the Session-Reflector <bcp14>MUST</bcp14>
  copy the value of the source MAC address in the EUI-48 field.
  Otherwise, the Session-Reflector <bcp14>MUST</bcp14> use the Source EUI-64 Address sub-TLV and <bcp14>MUST</bcp14> copy the value
  of the Source MAC Address from the received packet into the EUI-64 field.
  If the received extended STAMP test packet does not have the Source MAC Address,
  the Session-Reflector <bcp14>MUST</bcp14> zero the EUI-64 field before transmitting the reflected packet.
          </t>
          <t>
  A Session-Sender <bcp14>MAY</bcp14> include the Destination IP Address sub-TLV in the Location TLV.
  If the Session-Reflector receives the Location TLV that includes the Destination IP Address sub-TLV, it
  <bcp14>MUST</bcp14> include the Destination IPv4 Address sub-TLV if the source IP address of the
  received extended test packet is of the IPv4 address family. And the Session-Reflector <bcp14>MUST</bcp14>
  copy the value of the destination IP address in the IPv4 Address field.
  Otherwise, the Session-Reflector <bcp14>MUST</bcp14> use the Destination IPv6 Address sub-TLV and <bcp14>MUST</bcp14> copy the value
  of the destination IP address from the received packet into the IPv6 Address field.
          </t>

          <t>
  A Session-Sender <bcp14>MAY</bcp14> include the Source IP Address sub-TLV in the Location TLV.
  If the Session-Reflector receives the Location TLV that includes the Source IP Address sub-TLV, it
  <bcp14>MUST</bcp14> include the Source IPv4 Address sub-TLV if the source IP address of the
  received extended test packet is of the IPv4 address family. And the Session-Reflector <bcp14>MUST</bcp14>
  copy the value of the source IP address in the IPv4 Address field.
  Otherwise, the Session-Reflector <bcp14>MUST</bcp14> use the Source IPv6 Address sub-TLV and <bcp14>MUST</bcp14> copy the value
  of the source IP address from the received packet into the IPv6 Address field.
          </t>
          <t>
The Location TLV <bcp14>MAY</bcp14> be used to determine the last-hop IP addresses, ports, and
  last-hop MAC address for STAMP packets. The MAC address can indicate a path switch
  on the last hop. The IP addresses and UDP ports will indicate
  if there is a NAT router on the path. It allows the Session-Sender to identify the IP address
  of the Session-Reflector behind the NAT and detect changes in the NAT mapping that could result in sending the STAMP packets to the wrong Session-Reflector.
          </t>
        </section>
      </section>
      <section anchor="timestamp-info-section" numbered="true" toc="default">
        <name>Timestamp Information TLV</name>
        <t>
  The STAMP Session-Sender <bcp14>MAY</bcp14> include the Timestamp Information TLV to request information from the Session-Reflector.
  The Session-Sender <bcp14>MUST NOT</bcp14> fill any information fields except for STAMP TLV Flags, Type, and Length.
  All other fields <bcp14>MUST</bcp14> be filled with zeroes.
  The Session-Reflector <bcp14>MUST</bcp14> validate the Length value of the TLV.
  If the value of the Length field is invalid, the Session-Reflector follows the procedure defined in <xref target="stamp-extension-section" format="default"/> for a malformed TLV.
  
        </t>
        <figure anchor="timestamp-tlv-figuret">
          <name>Timestamp Information TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |STAMP TLV Flags|      Type     |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Sync Src In  | Timestamp In  | Sync Src Out  | Timestamp Out |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                    Optional sub-TLVs                          ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <t> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal">
          <dt>STAMP TLV Flags:</dt><dd>An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default"/>.</dd>
          <dt>Type:</dt><dd>A one-octet field. Value 3 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default"/>).</dd>
          <dt>Length:</dt><dd>A two-octet field, set equal to the length of the Value field in octets (<xref target="tlv-format" format="default"/>).</dd>
          <dt>Sync Src In:</dt><dd>A one-octet field that characterizes the source of clock synchronization at the ingress of a Session-Reflector. 
       There are several methods for synchronizing the clock, e.g., the Network Time Protocol (NTP) <xref target="RFC5905" format="default"/>.

       <xref target="ssync-source-new-tbl" format="default"/> lists the possible values.</dd>
          <dt>Timestamp In:</dt><dd>A one-octet field that characterizes the
       method by which the ingress of the Session-Reflector obtained the timestamp T2.
       A timestamp may be obtained with hardware assistance via a software API from a local wall clock or from a remote clock (the latter is referred to as a "control plane").
<xref target="timestamp-method-new-tbl" format="default"/> lists the possible values.</dd>
          <dt>Sync Src Out:</dt><dd>A one-octet field that characterizes the source of clock synchronization at the egress of the Session-Reflector. 
<xref target="ssync-source-new-tbl" format="default"/> lists the possible values.</dd>
          <dt>Timestamp Out:</dt><dd>A one-octet field that characterizes the
       method by which the egress of the Session-Reflector obtained the timestamp T3.
<xref target="timestamp-method-new-tbl" format="default"/> lists the possible values.</dd>
          <dt>Optional sub-TLVs:</dt><dd>An optional variable-length field.</dd>
        </dl>
      </section>



      <section anchor="cos-info-section" numbered="true" toc="default">
        <name>Class of Service TLV</name>
        <t>
  The STAMP Session-Sender <bcp14>MAY</bcp14> include  a Class of Service (CoS) TLV in the STAMP test packet.
  The format of the CoS TLV is presented in <xref target="cos-tlv-figure" format="default"/>.

        </t>
        <figure anchor="cos-tlv-figure">
          <name>Class of Service TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |STAMP TLV Flags|      Type     |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |   DSCP1   |   DSCP2   |ECN| RP|          Reserved             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <t> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal">
          <dt>STAMP TLV Flags:</dt><dd>An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default"/>.</dd>
          <dt>Type:</dt><dd>A one-octet field. Value 4 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default"/>).</dd>
          <dt>Length:</dt><dd>A two-octet field, set equal to the value 4.</dd>
          <dt>DSCP1:</dt><dd>The Differentiated Services Code Point (DSCP) intended by the Session-Sender
        to be used as the DSCP value of the reflected test packet.</dd>
          <dt>DSCP2:</dt><dd>The received value in the DSCP field at the ingress of the Session-Reflector.</dd>
          <dt>ECN:</dt><dd>The received value in the ECN field at the ingress of the Session-Reflector.</dd>
          <dt>RP (Reverse Path):</dt><dd>A two-bit field. A Session-Sender <bcp14>MUST</bcp14> set the value of the RP field to 0 on transmission.</dd>
          <dt>Reserved:</dt><dd>A 16-bit field that <bcp14>MUST</bcp14> be zeroed on transmission and ignored on receipt.</dd>
        </dl>
        <t>
  A STAMP Session-Reflector that receives a test packet with the CoS TLV <bcp14>MUST</bcp14> include
  the CoS TLV in the reflected test packet. Also, the Session-Reflector <bcp14>MUST</bcp14> copy
  the value of the DSCP and ECN fields of the IP header of the received STAMP test packet into the DSCP2 field in
  the reflected test packet. Finally, the Session-Reflector <bcp14>MUST</bcp14> use the local policy to verify whether
  the CoS corresponding to the value of the DSCP1 field is permitted in the domain. If it is, the Session-Reflector
  <bcp14>MUST</bcp14> set the DSCP field's value in the IP header
  of the reflected test packet equal to the value of the DSCP1 field of the received test packet. Otherwise, the Session-Reflector <bcp14>MUST</bcp14> use
  the DSCP value of the received STAMP packet and set the value of the RP field to 1.
  Upon receiving the reflected packet, if the value of the RP field is 0,
  the Session-Sender will save the DSCP and ECN values for analysis of the CoS in the reverse direction.
  If the value of the RP field in the received reflected packet is 1, only CoS in the forward direction can be analyzed.
        </t>
        <t>
Re-mapping of CoS can be used to provide multiple services (e.g., 2G, 3G, LTE in mobile backhaul networks)
over the same network.&nbsp; But if it is misconfigured, then it is often difficult to diagnose the root cause of
excessive packet drops of higher-level service while packet drops
for lower service packets are at a normal level.&nbsp; Using a CoS TLV in
STAMP testing helps to troubleshoot the existing problem and also verify
whether Diffserv policies are processing CoS as required by the configuration.
        </t>
      </section>
      <section anchor="direct-measurement-section" numbered="true" toc="default">
        <name>Direct Measurement TLV</name>
        <t>
  The Direct Measurement TLV enables collection of the number of in-profile packets,
  i.e., packets that form a specific data flow, that had been transmitted and received
  by the Session-Sender and Session-Reflector, respectively. The definition of "in-profile packet" is outside the
  scope of this document and is left to the test operators to determine.
        </t>
        <figure anchor="direct-tlv-figuret">
          <name>Direct Measurement TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |STAMP TLV Flags|      Type     |           Length              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |              Session-Sender Tx counter  (S_TxC)               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             Session-Reflector Rx counter  (R_RxC)             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             Session-Reflector Tx counter  (R_TxC)             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <t> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal" newline="false">
          <dt>STAMP TLV Flags:</dt><dd>An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default"/>.</dd>
          <dt>Type:</dt><dd>A one-octet field. Value 5 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default"/>).</dd>
          <dt>Length:</dt><dd>A two-octet field equal to the length of the Value field in octets. The Length field value <bcp14>MUST</bcp14> equal 12 octets.</dd>
          <dt>Session-Sender Tx counter (S_TxC):</dt><dd>A four-octet field. The Session-Sender <bcp14>MUST</bcp14> set its value equal to the number of the transmitted in-profile packets.</dd>
          <dt>Session-Reflector Rx counter (R_RxC):</dt><dd>A four-octet field. It <bcp14>MUST</bcp14> be zeroed  by the Session-Sender on transmit and
       ignored by the Session-Reflector on receipt. The Session-Reflector <bcp14>MUST</bcp14> fill it with the value of in-profile packets received.</dd>
          <dt>Session-Reflector Tx counter (R_TxC):</dt><dd>A four-octet field. It <bcp14>MUST</bcp14> be zeroed by the Session-Sender and ignored by the Session-Reflector on receipt.
       The Session-Reflector <bcp14>MUST</bcp14> fill it with the value of the transmitted in-profile packets.</dd>
        </dl>
        <t>
    A Session-Sender <bcp14>MAY</bcp14> include the Direct Measurement TLV in a STAMP test packet.
    If the received STAMP test packet includes the Direct Measurement TLV, the Session-Reflector <bcp14>MUST</bcp14> include it in the reflected test packet.
    The Session-Reflector <bcp14>MUST</bcp14> copy the value from the S_TxC field of the received test packet into the same field of the reflected packet before its transmission.
        </t>
      </section>
      <section anchor="access-avail-sec" numbered="true" toc="default">
        <name>Access Report TLV</name>
        <t>
    A STAMP Session-Sender <bcp14>MAY</bcp14> include an Access Report TLV (<xref target="access-tlv-fig" format="default"/>) to indicate
  changes to the access network status to the Session-Reflector. The
  definition of an access network is outside the scope of this document.
        </t>
        <figure anchor="access-tlv-fig">
          <name>Access Report TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |STAMP TLV Flags|     Type      |           Length              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   ID  |  Resv |  Return Code  |          Reserved             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <t> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal" newline="false">
          <dt>STAMP TLV Flags:</dt><dd>An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default"/>.</dd>
          <dt>Type:</dt><dd>A one-octet field. Value 6 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default"/>).</dd>
          <dt>Length:</dt><dd>A two-octet field, set equal to the value 4.</dd>
            <dt>ID (Access ID):</dt><dd><t>A four-bit field that identifies the access network,
     e.g., 3GPP (Radio Access Technologies specified by 3GPP) or non-3GPP
     (accesses that are not specified by 3GPP) <xref target="TS23501" format="default"/>.
     The value is one of the following:</t>
            <dl spacing="normal" newline="false">
              <dt>1:</dt><dd>3GPP Network</dd>
              <dt>2:</dt><dd>Non-3GPP Network</dd>
            </dl>
         <t>
     All other values are invalid; a TLV that contains values other than '1' or '2' <bcp14>MUST</bcp14> be discarded.</t>
      </dd>
          <dt>Resv:</dt><dd>A four-bit field that <bcp14>MUST</bcp14> be zeroed on transmission
      and ignored on receipt.</dd>
          <dt>Return Code:</dt><dd>A one-octet field that identifies the report signal,
     e.g., available or unavailable. The value is supplied to the STAMP
     endpoint through some mechanism that is outside the scope of this document.
<xref target="iana-return-code-reg" format="default"/> lists the possible values.</dd>
          <dt>Reserved:</dt><dd>A two-octet field that <bcp14>MUST</bcp14> be zeroed on transmission
      and ignored on receipt.</dd>
        </dl>
        <t>
           The STAMP Session-Sender that includes the Access Report TLV sets
   the value of the Access ID field according to the type of access network it reports on.
   Also, the Session-Sender sets the value of the Return Code field to reflect the operational state of the
   access network. The mechanism to determine the state of the access network is outside the scope
   of this specification.  A STAMP Session-Reflector
   that received the test packet with the Access Report TLV <bcp14>MUST</bcp14> include
   the Access Report TLV in the reflected test packet.  The Session-Reflector <bcp14>MUST</bcp14> set the value of the Access ID and Return Code fields
   equal to the values of the corresponding fields from the test packet
   it has received.
        </t>
        <t>
   The Session-Sender <bcp14>MUST</bcp14> also arm a retransmission timer after sending
   a test packet that includes the Access Report TLV.  This timer <bcp14>MUST</bcp14>
   be disarmed upon reception of the reflected
   STAMP test packet that includes the Access Report TLV.
   In the event the timer expires before such a packet
   is received, the Session-Sender <bcp14>MUST</bcp14> retransmit the STAMP test packet
   that contains the Access Report TLV. This retransmission <bcp14>SHOULD</bcp14> be
   repeated up to four times before the procedure is aborted. Setting the value
   for the retransmission timer is based on local policies and the network environment.
   The default value of the retransmission timer for the Access Report TLV
   <bcp14>SHOULD</bcp14> be three seconds. An implementation <bcp14>MUST</bcp14> provide control
   of the retransmission timer value and the number of retransmissions.
        </t>
        <t>
  The Access Report TLV is used by the Performance Measurement
   Function (PMF) components of the Access Steering, Switching, and
   Splitting feature for 5G networks <xref target="TS23501" format="default"/>.  The PMF
   component in the User Equipment acts as the STAMP Session-Sender,
   and the PMF component in the User Plane Function
   acts as the STAMP Session-Reflector.
        </t>
      </section>
      <section anchor="follow-up-tlv" numbered="true" toc="default">
        <name>Follow-Up Telemetry TLV</name>
        <t>
    A Session-Reflector might be able to put only an "SW Local"
    (see <xref target="timestamp-method-new-tbl" format="default"/>) timestamp in the Follow-Up Timestamp field. But the hosting
    system might provide a timestamp closer to the start of the actual packet transmission
    even though it is not possible to deliver the information to the Session-Sender in time for the packet itself.
    This timestamp might nevertheless be important for the Session-Sender, as it
    improves the accuracy of network delay measurement by minimizing the impact of egress queuing delays
    on the measurement.
        </t>

        <t>
  A STAMP Session-Sender <bcp14>MAY</bcp14> include the Follow-Up Telemetry TLV to
   request information from the Session-Reflector. The Session-Sender
   <bcp14>MUST</bcp14> set the Follow-Up Telemetry Type and Length fields to their appropriate values.
   The Sequence Number and Follow-Up Timestamp fields <bcp14>MUST</bcp14> be zeroed on transmission by the Session-Sender
   and ignored by the Session-Reflector upon receipt of the STAMP test packet that includes the Follow-Up Telemetry TLV.
   The Session-Reflector <bcp14>MUST</bcp14> validate the Length value of the STAMP
   test packet.  If the value of the Length field is invalid, the
   Session-Reflector <bcp14>MUST</bcp14> zero the Sequence Number and Follow-Up Timestamp fields and set the M flag in the STAMP TLV Flags field
   in the reflected packet. If the Session-Reflector is in the
   stateless mode (defined in <xref target="RFC8762" sectionFormat="of" section="4.2"/>),
   it <bcp14>MUST</bcp14> zero the Sequence Number and Follow-Up Timestamp fields.
        </t>
        <figure anchor="follow-up-tlv-fig">
          <name>Follow-Up Telemetry TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |STAMP TLV Flags|      Type     |           Length              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Sequence Number                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Follow-Up Timestamp                      |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Timestamp M  |                     Reserved                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <t> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal">
          <dt>STAMP TLV Flags:</dt><dd>An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default"/>.</dd>
          <dt>Type:</dt><dd>A one-octet field. Value 7 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default"/>).</dd>
          <dt>Length:</dt><dd>A two-octet field, set equal to the value 16 octets.</dd>
          <dt>
        Sequence Number:</dt><dd>A four-octet field indicating the sequence
number of the last packet reflected in the same STAMP test session.
Since the Session-Reflector runs in the stateful mode
(defined in <xref target="RFC8762" sectionFormat="of" section="4.2"/>),
it is the Session-Reflector's Sequence Number of the previous reflected packet.
</dd>
          <dt>
     Follow-Up Timestamp:</dt><dd>An eight-octet field, with the format indicated by
      the Z flag of the Error Estimate field of the STAMP base packet, which is contained
      in this reflected test packet transmitted by a Session-Reflector,
      as described in <xref target="RFC8762" sectionFormat="of" section="4.2.1"/>.
      It carries the timestamp when the reflected packet with the
      specified sequence number was sent.
</dd>
          <dt>
Timestamp M(ode):</dt><dd>A one-octet field that characterizes the
method by which the entity that transmits a reflected STAMP packet obtained the Follow-Up Timestamp.
<xref target="timestamp-method-new-tbl" format="default"/> lists the possible values.
</dd>
          <dt>Reserved:</dt><dd>A three-octet field. Its value <bcp14>MUST</bcp14> be zeroed on transmission and ignored on receipt.</dd>
        </dl>
      </section>
      <section anchor="hmac-sec" numbered="true" toc="default">
        <name>HMAC TLV</name>

        <t>
The STAMP authenticated mode protects the integrity of data collected in the STAMP base packet.
STAMP extensions are designed to provide valuable information about the condition of a network,
and protecting the integrity of that data is also essential. 
All authenticated STAMP base packets (per Sections <xref target="RFC8762"
sectionFormat="bare" section="4.2.2"/> and <xref target="RFC8762"
sectionFormat="bare" section="4.3.2"/> of <xref target="RFC8762" format="default"/>)
compatible with this specification <bcp14>MUST</bcp14> additionally authenticate the
optional TLVs by including the keyed Hashed Message Authentication Code (HMAC) TLV, with the sole exception of when
there is only one TLV present and it is the Extended Padding TLV.
The HMAC TLV <bcp14>MUST</bcp14> follow all TLVs included in a STAMP test packet except for the Extra Padding TLV.
If the HMAC TLV appears in any other position in a STAMP extended test packet, then the situation
<bcp14>MUST</bcp14> be processed as HMAC verification failure, as defined below in this section.
The HMAC TLV <bcp14>MAY</bcp14> be used to protect the integrity of STAMP extensions in the STAMP unauthenticated mode.
An implementation of STAMP extensions <bcp14>MUST</bcp14> provide controls to enable
the integrity protection of STAMP extensions in the STAMP unauthenticated mode.
</t>
        <t>
        </t>
        <figure anchor="hmac-tlv-fig">
          <name>HMAC TLV</name>
          <artwork name="" type="" align="left" alt=""><![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |STAMP TLV Flags|      Type     |             Length            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                              HMAC                             |
   |                                                               |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure>
        <t> 
        The fields are defined as follows:
        </t>
        <dl spacing="normal">
          <dt>STAMP TLV Flags:</dt><dd>An eight-bit field. Its format is presented in <xref target="tlv-flags-format" format="default"/>.</dd>
          <dt>Type:</dt><dd>A one-octet field. Value 8 has been allocated by IANA (<xref target="iana-stamp-tlv-registry" format="default"/>).</dd>
          <dt>Length:</dt><dd>A two-octet field, set equal to the value 16 octets.</dd>
          <dt>HMAC:</dt><dd>A 16-octet field that carries the HMAC digest of the text of all preceding TLVs.</dd>
        </dl>
        <t>
As defined in <xref target="RFC8762" format="default"/>, STAMP uses HMAC-SHA-256 truncated to 128 bits (see <xref target="RFC4868" format="default"/>).
All considerations regarding using the key listed in <xref target="RFC8762" sectionFormat="of" section="4.4"/>
are fully applicable to the use of the HMAC TLV. Key management and the mechanisms to
distribute the HMAC key are outside the scope of this specification.
The HMAC TLV is anticipated to track updates in the base STAMP protocol <xref target="RFC8762" format="default"/>,
including the use of more advanced cryptographic algorithms. HMAC is calculated as defined in <xref target="RFC2104" format="default"/>
over text as the concatenation of the Sequence Number field of the base STAMP packet and
all  preceding TLVs. The digest then <bcp14>MUST</bcp14> be truncated to 128 bits and written into the HMAC field.
If the HMAC TLV is present in the extended STAMP test packet, e.g., in the authenticated mode,
HMAC <bcp14>MUST</bcp14> be verified before using any data in the included STAMP TLVs. If HMAC verification
by the Session-Reflector fails, then the Session-Reflector <bcp14>MUST</bcp14> stop processing the received extended STAMP test packet.
The Session-Reflector <bcp14>MUST</bcp14> copy the TLVs from the received  STAMP test packet into the
reflected packet. The Session-Reflector <bcp14>MUST</bcp14> set the I flag in each TLV copied over into
the reflected packet to 1 before transmitting the reflected test packet.
If the Session-Sender receives the extended STAMP test packet with I flag set to 1,
then the Session-Sender <bcp14>MUST</bcp14> stop processing TLVs in the reflected test packet.
If HMAC verification by the Session-Sender fails, then the Session-Sender <bcp14>MUST</bcp14>
stop processing TLVs in the reflected extended STAMP packet.
</t>
      </section>
    </section>
    <section anchor="iana-consider" numbered="true" toc="default">

      <name>IANA Considerations</name>
<t>IANA has created the following subregistries under the "Simple Two-way Active Measurement Protocol (STAMP) TLV Types" registry.</t>
      <section anchor="iana-stamp-tlv-registry" numbered="true" toc="default">
        <name>STAMP TLV Types Subregistry</name>
        <t>
   IANA has created the "STAMP TLV Types" subregistry. The code
   points in this registry are allocated according to the registration
   procedures <xref target="RFC8126" format="default"/> described in <xref
   target="iana-stamp-type-tbl" format="default"/>.
        </t>
        <table anchor="iana-stamp-type-tbl" align="center">
          <name>Registration Procedures for the STAMP TLV Types Subregistry</name>
          <thead>
            <tr>
              <th align="left">Range</th>
              <th align="center">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">1 - 175</td>
              <td align="center">IETF Review</td>
            </tr>
            <tr>
              <td align="left">176 - 239</td>
              <td align="center">First Come First Served</td>
            </tr>
            <tr>
              <td align="left">240 - 251</td>
              <td align="center">Experimental Use</td>
            </tr>
            <tr>
              <td align="left">252 - 254</td>
              <td align="center">Private Use</td>
            </tr>
          </tbody>
        </table>
        <t>Per this document, IANA has allocated the following values in the "STAMP TLV Types" subregistry:
</t>

        <table anchor="stamp-new-type-tbl" align="center">
          <name>STAMP TLV Types</name>
          <thead>
            <tr>
              <th align="left">Value</th>
              <th align="center">Description</th>
              <th align="left">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="center">Reserved</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="center">Extra Padding</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="center">Location</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">3</td>
              <td align="center">Timestamp&nbsp;Information</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">4</td>
              <td align="center">Class of&nbsp;Service</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">5</td>
              <td align="center">Direct&nbsp;Measurement</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">6</td>
              <td align="center">Access&nbsp;Report</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">7</td>
              <td align="center">Follow-Up&nbsp;Telemetry</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">8</td>
              <td align="center">HMAC</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">255</td>
              <td align="center">Reserved</td>
              <td align="left">RFC 8972</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section anchor="iana-tlv-flags-reg" numbered="true" toc="default">
        <name>STAMP TLV Flags Subregistry</name>
        <t>
      IANA has created the "STAMP TLV Flags" subregistry.
      The registration procedure is "IETF Review" <xref target="RFC8126" format="default"/>. The flags are 8 bits.
      Per this document, IANA has allocated the following bit positions in the "STAMP TLV Flags" subregistry.
        </t>
        <table anchor="tlv-flags-new-tbl" align="center">
          <name>STAMP TLV Flags</name>
          <thead>
            <tr>
              <th align="center">Bit position</th>
              <th align="center">Symbol</th>
              <th align="center">Description</th>
              <th align="center">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">0</td>
              <td align="center">U</td>
              <td align="center">Unrecognized TLV</td>
              <td align="center">RFC 8972</td>
            </tr>
            <tr>
              <td align="center">1</td>
              <td align="center">M</td>
              <td align="center">Malformed TLV</td>
              <td align="center">RFC 8972</td>
            </tr>
            <tr>
              <td align="center">2</td>
              <td align="center">I</td>
              <td align="center">Integrity check failed</td>
              <td align="center">RFC 8972</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="iana-sub-tlv-registry" numbered="true" toc="default">
        <name>STAMP Sub-TLV Types Subregistry</name>
        <t>
   IANA has created the "STAMP Sub-TLV Types" subregistry.
   The code points in this registry are allocated according to the
   registration procedures <xref target="RFC8126" format="default"/> described
   in <xref target="iana-sub-type-tbl" format="default"/>.
        </t>
        <table anchor="iana-sub-type-tbl" align="center">
          <name>Registration Procedures for the STAMP Sub-TLV Types Subregistry</name>
          <thead>
            <tr>
              <th align="center">Range</th>
              <th align="center">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">1 - 175</td>
              <td align="center">IETF Review</td>
            </tr>
            <tr>
              <td align="left">176 - 239</td>
              <td align="center">First Come First Served</td>
            </tr>
            <tr>
              <td align="left">240 - 251</td>
              <td align="center">Experimental Use</td>
            </tr>
            <tr>
              <td align="left">252 - 254</td>
              <td align="center">Private Use</td>
            </tr>
          </tbody>
        </table>
        <t>Per this document, IANA has allocated the following values in the "STAMP Sub-TLV Types" subregistry:</t>
        <table anchor="sub-tlv-type-tbl" align="center">
          <name>STAMP Sub-TLV Types</name>
          <thead>
            <tr>
              <th align="center">Value</th>
              <th align="center">Description</th>
              <th align="left">TLV Used</th>
              <th align="left">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="center">Reserved</td>
              <td></td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="center">Source MAC Address</td>
              <td align="left">Location</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="center">Source EUI-48 Address</td>
              <td align="left">Location</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">3</td>
              <td align="center">Source EUI-64 Address</td>
              <td align="left">Location</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">4</td>
              <td align="center">Destination IP Address</td>
              <td align="left">Location</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">5</td>
              <td align="center">Destination IPv4 Address</td>
              <td align="left">Location</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">6</td>
              <td align="center">Destination IPv6 Address</td>
              <td align="left">Location</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">7</td>
              <td align="center">Source&nbsp;IP Address</td>
              <td align="left">Location</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">8</td>
              <td align="center">Source&nbsp;IPv4 Address</td>
              <td align="left">Location</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">9</td>
              <td align="center">Source&nbsp;IPv6 Address</td>
              <td align="left">Location</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">255</td>
              <td align="center">Reserved</td>
              <td></td>
              <td align="left">RFC 8972</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section anchor="iana-sync-source-reg" numbered="true" toc="default">
        <name>STAMP Synchronization Sources Subregistry</name>
        <t>
   IANA has created the "STAMP Synchronization Sources" subregistry.
The code points in this registry are allocated according
   to the registration procedures
<xref target="RFC8126" format="default"/> described in 
<xref target="iana-sync-source-tbl" format="default"/>.
        </t>
        <table anchor="iana-sync-source-tbl" align="center">
          <name>Registration Procedures for the STAMP Synchronization Sources Subregistry</name>
          <thead>
            <tr>
              <th align="left">Range</th>
              <th align="center">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">1 - 127</td>
              <td align="center">IETF Review</td>
            </tr>
            <tr>
              <td align="left">128 - 239</td>
              <td align="center">First Come First Served</td>
            </tr>
            <tr>
              <td align="left">240 - 249</td>
              <td align="center">Experimental Use</td>
            </tr>
            <tr>
              <td align="left">250 - 254</td>
              <td align="center">Private Use</td>
            </tr>
          </tbody>
        </table>
        <t>Per this document, IANA has allocated the following values in the "STAMP Synchronization Sources" subregistry:
</t>
        <table anchor="ssync-source-new-tbl" align="center">
          <name>STAMP Synchronization Sources</name>
          <thead>
            <tr>
              <th align="left">Value</th>
              <th align="center">Description</th>
              <th align="left">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="center">Reserved</td>
              <td align="left">RFC 8972</td>
            </tr>

            <tr>
              <td align="left">1</td>
              <td align="center">NTP</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="center">PTP</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">3</td>
              <td align="center">SSU/BITS</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">4</td>
              <td align="center">GPS/GLONASS/LORAN-C/BDS/Galileo</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">5</td>
              <td align="center">Local free-running</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">255</td>
              <td align="center">Reserved</td>
              <td align="left">RFC 8972</td>
            </tr>

          </tbody>
        </table>
      </section>
      <section anchor="iana-tiemstamp-methog-reg" numbered="true" toc="default">
        <name>STAMP Timestamping Methods Subregistry</name>
        <t>
   IANA has created the "STAMP Timestamping Methods" subregistry.
The code points in this registry are allocated
   according to the registration procedures
<xref target="RFC8126" format="default"/>
described in
<xref target="iana-timestamp-method-tbl" format="default"/>.
        </t>
        <table anchor="iana-timestamp-method-tbl" align="center">
          <name>Registration Procedures for the STAMP Timestamping Methods Subregistry</name>
          <thead>
            <tr>
              <th align="left">Range</th>
              <th align="center">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">1 - 127</td>
              <td align="center">IETF Review</td>
            </tr>
            <tr>
              <td align="left">128 - 239</td>
              <td align="center">First Come First Served</td>
            </tr>
            <tr>
              <td align="left">240 - 249</td>
              <td align="center">Experimental Use</td>
            </tr>
            <tr>
              <td align="left">250 - 254</td>
              <td align="center">Private Use</td>
            </tr>
          </tbody>
        </table>
        <t>Per this document, IANA has allocated the following values in the "STAMP Timestamping Methods" subregistry:</t>
        <table anchor="timestamp-method-new-tbl" align="center">
          <name>STAMP Timestamping Methods</name>
          <thead>
            <tr>
              <th align="left">Value</th>
              <th align="center">Description</th>
              <th align="left">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="center">Reserved</td>
              <td align="left">RFC 8972</td>
            </tr>

            <tr>
              <td align="left">1</td>
              <td align="center">HW Assist</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="center">SW Local</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">3</td>
              <td align="center">Control Plane</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">255</td>
              <td align="center">Reserved</td>
              <td align="left">RFC 8972</td>
            </tr>
          </tbody>
        </table>
      </section>
   <section anchor="iana-return-code-reg" numbered="true" toc="default">
        <name>STAMP Return Codes Subregistry</name>
        <t>
   IANA has created the "STAMP Return Codes" subregistry.
The code points in this registry are allocated
   according to the registration procedures <xref target="RFC8126" format="default"/> described in
<xref target="iana-return-code-tbl" format="default"/>.
        </t>
        <table anchor="iana-return-code-tbl" align="center">
          <name>Registration Procedures for the STAMP Return Codes Subregistry</name>
          <thead>
            <tr>
              <th align="left">Range</th>
              <th align="center">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">1 - 127</td>
              <td align="center">IETF Review</td>
            </tr>
            <tr>
              <td align="left">128 - 239</td>
              <td align="center">First Come First Served</td>
            </tr>
            <tr>
              <td align="left">240 - 249</td>
              <td align="center">Experimental Use</td>
            </tr>
            <tr>
              <td align="left">250 - 254</td>
              <td align="center">Private Use</td>
            </tr>
          </tbody>
        </table>
        <t>Per this document, IANA has allocated the following values in the "STAMP Return Codes" subregistry:</t>
        <table anchor="return-code-new-tbl" align="center">
          <name>STAMP Return Codes</name>
          <thead>
            <tr>
              <th align="left">Value</th>
              <th align="center">Description</th>
              <th align="left">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="center">Reserved</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="center">Network&nbsp;available</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">2</td>
              <td align="center">Network&nbsp;unavailable</td>
              <td align="left">RFC 8972</td>
            </tr>
            <tr>
              <td align="left">255</td>
              <td align="center">Reserved</td>
              <td align="left">RFC 8972</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>
    <section anchor="security" numbered="true" toc="default">
      <name>Security Considerations</name>
      <t>
This document defines extensions to STAMP <xref target="RFC8762" format="default"/> and inherits all the security considerations
applicable to the base protocol. Additionally, the HMAC TLV is defined in this document.
Though the HMAC TLV protects the integrity of STAMP extensions, it does not protect against a replay attack.
The use of the HMAC TLV is discussed in detail in <xref target="hmac-sec" format="default"/>.
      </t>
      <t>
     To protect against a malformed TLV, an implementation of a Session-Sender and Session-Reflector <bcp14>MUST</bcp14>:
      </t>
      <ul spacing="normal">
        <li>check the setting of the M flag and</li>
        <li>validate the Length field value.</li>
      </ul>
      <t>
     As this specification defines the mechanism to test DSCP mapping,
   this document inherits all the security considerations discussed in <xref target="RFC2474" format="default"/>.
   Monitoring and optional control of DSCP using the CoS TLV may be used across the Internet so that
     the Session-Sender and the Session-Reflector are located in domains that use different CoS profiles. Thus,
     it is essential that an operator verify the set of CoS values that is used in the Session-Reflector's domain.
     Also, an implementation of a Session-Reflector <bcp14>SHOULD</bcp14> support a local policy to confirm whether the value sent by the Session-Sender
     can be used as the value of the DSCP field. <xref target="cos-info-section" format="default"/> defines the use of that local policy.
      </t>
    </section>
  </middle>
  <back>

<displayreference target="I-D.irtf-pearg-numeric-ids-generation" to="NUM-IDS-GEN"/>

    <references>
      <name>References</name>
      <references>
        <name>Normative References</name>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8126.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8762.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2104.xml"/>
      </references>
      <references>
        <name>Informative References</name>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5905.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4868.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2474.xml"/>
        <xi:include href="https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5357.xml"/>

        <xi:include href="https://datatracker.ietf.org/doc/bibxml3/reference.I-D.irtf-pearg-numeric-ids-generation-06.xml"/>

        <reference anchor="IEEE.1588.2008">
          <front>
            <title>IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems</title>
            <author>
              <organization/>
            </author>
            <date month="July" year="2008"/>
          </front>
          <seriesInfo name="IEEE Std." value="1588-2008"/>
<seriesInfo name="DOI" value="10.1109/IEEESTD.2008.4579760"/>
        </reference>

        <reference anchor="TS23501">
          <front>
            <title>Technical
              Specification Group Services and System Aspects; System
              Architecture for the 5G System (5GS); Stage 2 (Release 16)</title>
            <author>
              <organization>3GPP</organization>
            </author>
            <date year="2019"/>
          </front>
          <seriesInfo name="3GPP TS" value="23.501"/>
        </reference>


        <reference anchor="GPS">
          <front>
            <title>Global Positioning System (GPS) Standard Positioning Service (SPS) Performance Standard</title>
            <author>
              <organization/>
            </author>
            <date month="April" year="2020"/>
          </front>
          <seriesInfo name="GPS SPS" value="5th Edition"/>
        </reference>
      </references>
    </references>
    <section numbered="false" toc="default">
      <name>Acknowledgments</name>
      <t>
         The authors very much appreciate the thorough review and thoughtful comments received from <contact fullname="Tianran Zhou"/>, <contact fullname="Rakesh Gandhi"/>, <contact fullname="Yuezhong Song"/>, and <contact fullname="Yali Wang"/>.
         The authors express their gratitude to <contact fullname="Al Morton"/> for his comments and valuable suggestions.
         The authors greatly appreciate the comments and thoughtful suggestions received from <contact fullname="Martin Duke"/>.
      </t>
    </section>
    <section numbered="false" toc="default">
      <name>Contributors</name>
      <t>
 The following individual contributed text to this document:
      </t>
  <contact fullname="Guo Jun">
        <organization>ZTE Corporation</organization>
        <address>
          <postal>
            <street>68# Zijinghua Road</street>
            <city>Nanjing</city>
            <region>Jiangsu</region>
            <code>210012</code>
            <country>China</country>
          </postal>
<phone>+86 18105183663</phone>   
       <email>guo.jun2@zte.com.cn</email>
        </address>
  </contact>
    </section>
  </back>

</rfc>
