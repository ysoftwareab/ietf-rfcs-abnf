                                     			  Himanshu Shah
							       Ping Pan 
                                                             Ciena Corp 
   PWE3 Working Group                                                   
   Internet Draft                                     Hamid Ould-Brahim 
                                                        Nortel Networks 
                                                                        
   April 2004                                                Chris Metz 
   Expires: October 2004                                  Cisco Systems 
                                                      
                                                      
                                                                        
 
    
 
                                      
                            Qos Signaling for PW 
                                      
                  draft-shah-pwe3-pw-qos-signaling-00.txt 
                                      
                                      
 
   Status of this Memo 
 
   This document is an Internet-Draft and is in full conformance with 
   all provisions of Section 10 of RFC2026. 
    
    
   Internet-Drafts are working documents of the Internet Engineering 
   Task Force (IETF), its areas, and its working groups.  Note that      
   other groups may also distribute working documents as Internet-
   Drafts. 
    
   Internet-Drafts are draft documents valid for a maximum of six 
   months and may be updated, replaced, or obsoleted by other documents 
   at any time.  It is inappropriate to use Internet-Drafts as 
   reference material or to cite them other than as "work in progress." 
    
   The list of current Internet-Drafts can be accessed at 
        http://www.ietf.org/ietf/1id-abstracts.txt 
   The list of Internet-Draft Shadow Directories can be accessed at 
        http://www.ietf.org/shadow.html. 
    
   Abstract 
    
   This document discusses how a tail-end PE can signal the Quality of 
   Service parameters of the local Attachment Circuit to the head-end 
   PE for appropriate Pseudowire generation from head to tail end PE. 
    
   The Pseudowires traditionally provide connectivity between two 
   Attachment Circuits that are on the edges of a service provider∆s 
   network. A service provider assigns specific QOS parameters to these 
   Attachment Circuits based on the service sold to the customer. In 
   order to interconnect and maintain the same level of service 
     
   Shah, et al.          Expires August 2004                        1 
   Internet Draft  draft-shah-pwe3-PW-Qos-Signaling-00.txt 
                                   
    
   parameters across the service provider network, it is prudent that 
   the Provider Edge devices that are endpoints of the Pseudowires, 
   select or create a suitable transport path that meets the 
   Pseudowire∆s quality of service requirements. It is also possible 
   that a PE may use appropriate policing for traffic entering 
   Pseudowire that match remote Attachment Circuit∆s capabilities. 
    
   In order to accomplish an integrated service delivery it becomes 
   necessary that each PE understand the QOS requirements of the remote 
   Attachment Circuit. 
    
   This draft proposes an extension to the PWE3 control signaling to 
   enable a PE to exchange QOS parameters of the local Attachment 
   Circuit at the time of the PW establishment. 
    
   1.0 Specification of Requirements 
    
   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 
   document are to be interpreted as described in RFC 2119. 
    
   2.0 Introduction 
    
   The [PWE3-CONTROL] draft describes how two PEs signal PW-FEC to each 
   other in order to establish a pseudowire. The PW-FEC is exchanged 
   over the targeted LDP session and contains Pseudowire signaling 
   information that includes interface parameters of the local 
   Attachment Circuit.  
    
   This draft describes a mechanism whereby additional information, 
   such as QOS parameters of the local Attachment Circuit can be 
   dispatched with the VC-FEC in a backward compatible fashion. 
    
   This document specifies QOS TLV that can be included in the initial 
   Label Mapping Message and subsequently in LDP notification message 
   for conveying up-to-date information about the Pseudowire.  
    
   This proposal is orthogonal to the type of PW-FEC used. Both PWid 
   FEC and Generalized ID FEC can make use of the new additions. In the 
   case of PWid FEC the signaled QOS information can be related to the 
   GROUP_ID value when this field is used in signaling.  
    
   It is expected that capability of exchanging QOS information 
   dynamically would facilitate various applications to optimize the 
   use of core resources effectively. For example, a PE may use this 
   signaling for backpressure when Êforward congestion∆ is detected on 
   its local AC. 
    
   3.0 Capability Learning for QOS exchange 
    
   For the purpose of learning remote end capabilities and for the 
   purpose of signaling to the remote end the local capabilities, this 
   draft suggests that the QOS TLV be included initially in the Label 
     
   Shah, et al.         Expires October 2004                        2 
   Internet Draft  draft-shah-pwe3-PW-Qos-Signaling-00.txt 
                                   
    
   Mapping message and particularly in the Optional Parameter field of 
   Label Mapping Message. When subsequent updates are required (after 
   the PW is established), the sender PE will use the LDP notification 
   message to convey an update of the new information. 
    
   Note that the mechanism described in this draft allows a given PE 
   that does not support the QOS TLV to be able to establish a 
   Pseudowire using normal operations. Indeed, the PEs that are 
   upgraded with such new functionality, examine the optional 
   parameters and note QOS TLV to learn the capability of the sending 
   peer. The sender must include the QOS TLV that it intends to use 
   later as an update, in the Label Mapping message that is used to 
   setup the FIB. Typically, such Label Mapping message is either the 
   first Label Mapping message or the one right after the Label 
   Withdraw/Release message and is referred to in this document as a 
   ÙLearning Label Mappingˆ message.  
    
   The absence of a given TLV in the Learning Label Mapping message 
   indicates to the receiver that the sending PE is either not capable 
   of processing such TLV or does not wish to engage in dynamic update 
   exchange for that TLV. The absence of QOS TLV indicates to the 
   receiving PE that normal PW signaling procedures should be used to 
   establish the PW (i.e., no inclusion of the optional TLVs in the 
   reverse label mapping). Similarly, the receiving PE that has not 
   been upgraded with the new TLVs and receives a label mapping with 
   the new TLVs will just ignore these TLVs during label mapping 
   processing phase.  
    
   The capability learning aspect of the PW QOS is only applicable for 
   the use of QOS TLV for dynamic update notifications. It does not 
   change the need to send the initial QOS TLV, irrespective of whether 
   remote PE is capable of processing the optional TLV or not. 
    
   It is also possible that the receiving PE is capable of processing 
   QOS TLV and uses unacceptable QOS requirement as a criterion to 
   release the VC-FEC. In such event, a status TLV is defined to be 
   included in the optional parameter field of the label release 
   message that informs the remote PE about the reasons for the 
   rejection. 
    
    
   4.0 Pseudowire QOS TLV 
    
   The pseudowire QOS TLV is used to notify the remote PE about Quality 
   of Service requirements of the local Attachment Circuit. 
    
   As stated earlier, this information can also be passed as an update. 
   It is possible that receiver may either adjust QOS parameters of the 
   existing tunnel or may respond to the update by first withdrawing 
   the advertised PW label and re-advertise new PW label with same VC-
   FEC. 
    
    
     
   Shah, et al.         Expires October 2004                        3 
   Internet Draft  draft-shah-pwe3-PW-Qos-Signaling-00.txt 
                                   
    
       0                   1                   2                   3 
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |1|0| PW QOS TLV  (TBD)         |      Length                   | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |                   Committed Information Rate (CIR)            | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |                    Peak Information Rate (PIR)                | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |                    Committed Burst Size (CBS)                 | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |                    Peak Burst Size (PBS)                      | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |  Number of Sub-TLVs           |       Reserved                | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |                    Sub-TLVs (1-n)                             | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
    
      
   Traffic Engineering Parameters 
     Each TE parameter is encoded as a 32-bit IEEE single precision 
     floating-point number. The CIR and PIR are in units of bytes per 
     second while CBS and PBS are in units of bytes. 
      
   Number of Sub-TLVs 
     This field identifies the number of Sub-TLVs that follow. In 
     absence of any Sub-TLVs, this field should be set to zero. This 
     field is mandatory. 
      
   Reserved 
     This field is set to zero. 
     
   Sub-TLVs (1-n) 
     The n number of Type-Length-Value fields where Ên∆ is equal to 
     ÊNumber of Sub-TLVs∆ field. The presence of field facilitates 
     future/proprietary extensions 
     
    
5.0 New LDP Status Codes 
    
   The PW Status TLV described in this document is the status code 
   point that may be used by the receiving PE to inform the sender the 
   specific reasons for not accepting the Label Mapping message. The 
   status TLV should be included in the Êoptional parameter∆ field of 
   the Label Release message. 
     
   Shah, et al.         Expires October 2004                        4 
   Internet Draft  draft-shah-pwe3-PW-Qos-Signaling-00.txt 
                                   
    
    
    
      The format of the PW Status TLV is: 
       0                   1                   2                   3 
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |1|0|     PW Status (0x096A)    |            Length             | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |                         Status Code                           | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
    
    
   Where the status code is a 4 octet bit field is specified in the PW 
   IANA Allocations document [13]. 
    
   According to Section 4.4 in RFC3036, we can define new status codes  
      in the range of 0x20000000-0x3effffff. Here are the new status 
   codes: 
    
        - 0x20000003 "TC is OK" 
        - 0x20000004 "Cannot accept the TC parameters" 
        - 0x20000005 "Preempted due to TC processing" 
    
    
6.0 General Procedures 
    
   The PW QOS TLV is included in the Optional Parameter Field of the 
   Label Mapping Message and the LDP Notification Message. In case of 
   Label Mapping Message, Optional Parameter Field follows the Label 
   TLV object. In LDP Notification Message, Optional Parameter Field 
   must include PW-FEC TLV before QOS-TLV. As described above, exchange 
   of QOS TLV in Notification Message is determined by the capability 
   learning during the initial Label Mapping exchange. 
    
   The PW QOS TLV conveys Quality of Service parameters that 
   advertising PE would like remote PE to consider when 
   selecting/creating  appropriate transport tunnel to carry the 
   Pseudowire from remote PE to the advertising PE. The Quality of 
   Service parameters can also be used by the receiving PE to select 
   appropriate policer for his Attached Circuit. 
    
   The QOS TLV is optional. The received PE uses this information as a 
   suggestion.  
    
   Note that use of PW QOS exchange helps utilize core resources 
   effectively in the following manner. 
     . Head end PE selects a transport tunnel that best suits remote 
        Attachment Circuit∆s QOS requirement 
     . More PWs can be multiplexed over a transport tunnel 
     . Transport tunnel can be right-sized with various upsize and 
        downsize thresholds 
     
   Shah, et al.         Expires October 2004                        5 
   Internet Draft  draft-shah-pwe3-PW-Qos-Signaling-00.txt 
                                   
    
     . Eliminates the wastage of packet forwarding resources in the 
        core when received traffic exceeds the Attachment Circuit QOS 
        criteria at the tail end. 
    
7.0 Security Considerations 
    
   The security aspects of this solution will be discussed at a later 
   time. 
    
    
8.0 References 
    
   [PWE3-CONTROL] Martini et. Al., ÙTransport of Layer 2 Frames Over 
   MPLSˆ, draft-ietf-pwe3-control-protocol-01.txt, August 2002 (work in 
   progress) 
    
    
Acknowledgement 
    
    
    
    
Author's Address 
    
   Himanshu Shah 
   Ciena Corp 
   35 Nagog Park 
   Acton, MA 01720 
   Email: hshah@ciena.com 
    
   Ping Pan 
   Ciena Corp 
   10480 Ridgeview Court 
   Cupertino, CA 95014 
   e-mail: ppan@ciena.com 
   phone: +1 408.366.4700 
    
    
   Hamid Ould-Brahim                         
   Nortel Networks   
   P O Box 3511 Station C                    
   Ottawa, ON K1Y 4H7, Canada                       
   Email: hbrahim@nortelnetworks.com                             
    
   Chris Metz 
   Cisco Systems, Inc. 
   3700 Cisco Way  
   San Jose, Ca. 95134  
   Email: chmetz@cisco.com 
    
    
   Full copyright statement 
    
     
   Shah, et al.         Expires October 2004                        6 
   Internet Draft  draft-shah-pwe3-PW-Qos-Signaling-00.txt 
                                   
    
      Copyright (C) The Internet Society (1999).  All Rights Reserved. 
    
    
   This document and translations of it may be copied and furnished to   
   others, and derivative works that comment on or otherwise explain it   
   or assist its implementation may be prepared, copied, published and   
   distributed, in whole or in part, without restriction of any kind, 
   provided that the above copyright notice and this paragraph are   
   included on all such copies and derivative works. However, this   
   document itself may not be modified in any way, such as by removing   
   the copyright notice or references to the Internet Society or other   
   Internet organizations, except as needed for the purpose of   
   developing Internet standards in which case the procedures for   
   copyrights defined in the Internet Standards process must be   
   followed, or as required to translate it into languages other than   
   English. 
    
   The limited permissions granted above are perpetual and will not be   
   revoked by the Internet Society or its successors or assigns. 
   This document and the information contained herein is provided on an   
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING   
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING   
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION   
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF    
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. 
     
   Shah, et al.         Expires October 2004                        7 
