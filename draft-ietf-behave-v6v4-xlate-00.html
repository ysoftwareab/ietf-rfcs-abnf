<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>IP/ICMP Translation
    Algorithm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="IP/ICMP Translation
    Algorithm">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">behave</td><td class="header">X. Li, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">C. Bao, Ed.</td></tr>
<tr><td class="header">Obsoletes: <a href='http://tools.ietf.org/html/rfc2765'>2765</a> (if&nbsp;approved)</td><td class="header">CERNET Center/Tsinghua University</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">F. Baker, Ed.</td></tr>
<tr><td class="header">Expires: January 1, 2010</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 30, 2009</td></tr>
</table></td></tr></table>
<h1><br />IP/ICMP Translation
    Algorithm<br />draft-ietf-behave-v6v4-xlate-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 1, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document specifies an update to the Stateless IP/ICMP
      Translation Algorithm (SIIT) described in RFC 2765. The algorithm
      translates between IPv4 and IPv6 packet headers (including ICMP
      headers).
</p>
<p>This specification addresses both a stateless and a stateful mode. In
      the stateless mode, translation information is carried in the address
      itself, permitting both IPv4-&gt;IPv6 and IPv6-&gt;IPv4 session
      establishment with neither state nor configuration in the IP/ICMP
      translator. In the stateful mode, translation state is maintained
      between IPv4 address/transport port tuples and IPv6 address/transport
      port tuples, enabling IPv6 systems to open sessions with IPv4 systems.
      The choice of operational mode is made by the operator deploying the
      network and is critical to the operation of the applications using
      it.
</p>
<p>Significant issues exist in the stateless and stateful modes that are
      not addressed in this document, related to the address assignment and
      the maintenance of the translation tables, respectively. This document
      confines itself to the actual translation.
</p>
<h3>Acknowledgement of previous work</h3>

<p>This document is a product of the 2008-2009 effort to define a
      replacement for NAT-PT. It is an update to and directly derivative from
      Erik Nordmark's <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a>, which similarly provides
      both stateless and stateful translation between IPv4 <a class='info' href='#RFC0791'>[RFC0791]<span> (</span><span class='info'>Postel, J., &ldquo;Internet Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> and IPv6 <a class='info' href='#RFC2460'>[RFC2460]<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a>, and
      between ICMPv4 <a class='info' href='#RFC0792'>[RFC0792]<span> (</span><span class='info'>Postel, J., &ldquo;Internet Control Message Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> and ICMPv6 <a class='info' href='#RFC4443'>[RFC4443]<span> (</span><span class='info'>Conta, A., Deering, S., and M. Gupta, &ldquo;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification,&rdquo; March&nbsp;2006.</span><span>)</span></a>. The original document was a product of the
      NGTRANS working group.
</p>
<p>The changes in this document reflect five components:</p>
<ol class="text">
<li>Redescribing the network model to map to present and projected
          usage.
</li>
<li>Moving the address format to the framework document, to
          coordinate with other drafts on the topic.
</li>
<li>Description of both stateful and stateless operation.
</li>
<li>Some changes in ICMP.
</li>
<li>Updating references.
</li>
</ol>

<h3>Requirements</h3>

<p>
      The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
      NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in
      RFC 2119.

</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#section1">1.</a>&nbsp;
Introduction and Motivation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section1.0">1.1.</a>&nbsp;
Translation Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section1.12">1.2.</a>&nbsp;
Applicability and Limitations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prefix-stateless">1.3.</a>&nbsp;
Stateless vs. Stateful Mode<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#address">1.4.</a>&nbsp;
IPv4-embedded IPv6 addresses and IPv4-related IPv6 addresses<br />
<a href="#section3">2.</a>&nbsp;
Translating from IPv4 to IPv6<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section3.1">2.1.</a>&nbsp;
Translating IPv4 Headers into IPv6 Headers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section3.2">2.2.</a>&nbsp;
Translating UDP over IPv4<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section3.3">2.3.</a>&nbsp;
Translating ICMPv4 Headers into ICMPv6 Headers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section3.4">2.4.</a>&nbsp;
Translating ICMPv4 Error Messages into ICMPv6<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#transport">2.5.</a>&nbsp;
Transport-layer Header Translation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section3.5">2.6.</a>&nbsp;
Knowing when to Translate<br />
<a href="#section4">3.</a>&nbsp;
Translating from IPv6 to IPv4<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section4.1">3.1.</a>&nbsp;
Translating IPv6 Headers into IPv4 Headers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section4.2">3.2.</a>&nbsp;
Translating ICMPv6 Headers into ICMPv4 Headers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section4.3">3.3.</a>&nbsp;
Translating ICMPv6 Error Messages into ICMPv4<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#transport2">3.4.</a>&nbsp;
Transport-layer Header Translation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section4.4">3.5.</a>&nbsp;
Knowing when to Translate<br />
<a href="#IANA">4.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">5.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">6.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="section1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction and Motivation</h3>

<p>An understanding of the framework presented in <a class='info' href='#I-D.ietf-behave-v6v4-framework'>[I&#8209;D.ietf&#8209;behave&#8209;v6v4&#8209;framework]<span> (</span><span class='info'>Baker, F., Li, X., Bao, C., and K. Yin, &ldquo;Framework for IPv4/IPv6 Translation,&rdquo; March&nbsp;2010.</span><span>)</span></a> is presumed in this
      document. With that remark...
</p>
<p>The transition mechanisms specified in <a class='info' href='#RFC4213'>[RFC4213]<span> (</span><span class='info'>Nordmark, E. and R. Gilligan, &ldquo;Basic Transition Mechanisms for IPv6 Hosts and Routers,&rdquo; October&nbsp;2005.</span><span>)</span></a>
      handle the case of dual IPv4/IPv6 hosts interoperating with both dual
      hosts and IPv4-only hosts, which is needed early in the transition to
      IPv6. The dual hosts are assigned both an IPv4 and one or more IPv6
      addresses. The number of available globally unique IPv4 addresses are
      becoming smaller and smaller as the Internet grows; we expect that there
      will be a desire to take advantage of the large IPv6 address and not
      require that every new Internet node have a permanently assigned IPv4
      address.
</p>
<p>The SIIT <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a> is designed for the case for
      small networks (e.g., a single subnet) and for a site that has IPv6-only
      hosts in a dual IPv4/IPv6 network. This use assumes a mechanism for the
      IPv6 nodes to acquire a temporary address from the pool of IPv4
      addresses. However, SIIT is not to be useful in the case when the IPv6
      nodes to acquire temporary IPv4 addresses from a "distant" SIIT box
      operated by a different administration, or require that the IPv6 routing
      contain routes for IPv6-mapped addresses (The latter is known to be a
      very bad idea due to the size of the IPv4 routing table that would
      potentially be injected into IPv6 routing in the form of IPv4-mapped
      addresses.)
</p>
<p>In addition, due to the IPv4 address deletion problem, it is
      desirable that a single IPv4 address needs to be shared via transport
      port multiplexing technique for different IPv6 nodes when they
      communicate with other IPv4 hosts.
</p>
<p>Furthermore, in the SIIT <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a>
      implementation, an IPv6-only node that works through SIIT translators
      needs some modifications beyond a normal IPv6-only node. These
      modifications are not strictly implied in this document, since the
      normal IPv6 addresses can be used in the IPv6 end nodes.
</p>
<p>The detailed discussion of the transition scenarios is presented in
      <a class='info' href='#I-D.ietf-behave-v6v4-framework'>[I&#8209;D.ietf&#8209;behave&#8209;v6v4&#8209;framework]<span> (</span><span class='info'>Baker, F., Li, X., Bao, C., and K. Yin, &ldquo;Framework for IPv4/IPv6 Translation,&rdquo; March&nbsp;2010.</span><span>)</span></a>, the technical
      specifications of the translation algorithm itself is illustrated in
      this document.
</p>
<a name="section1.0"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Translation Model</h3>

<p>This document specifies the translation algorithm that is one of
        the components described in <a class='info' href='#I-D.ietf-behave-v6v4-framework'>[I&#8209;D.ietf&#8209;behave&#8209;v6v4&#8209;framework]<span> (</span><span class='info'>Baker, F., Li, X., Bao, C., and K. Yin, &ldquo;Framework for IPv4/IPv6 Translation,&rdquo; March&nbsp;2010.</span><span>)</span></a> needed to make
        IPv6-only nodes interoperate with IPv4-only nodes as shown in Figure
        1.
</p><br /><hr class="insert" />
<a name="cloud1"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
           --------          --------
         //  IPv4  \\      //  IPv6  \\
        /   Domain   \    /   Domain   \
       /             +----+      +--+   \
      |              |XLAT|      |S2|    |  Sn: Servers
      | +--+         +----+      +--+    |  Hn: Clients
      | |S1|         +----+              |
      | +--+         |DNS |      +--+    |  XLAT: V4/V6 Translator
       \     +--+    +----+      |H2|   /   DNS:  DNS Server
        \    |H1|    /    \      +--+  /
         \\  +--+  //      \\        //
           --------          --------
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Translation Model&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The translation model consists of two or more network domains
        connected by one or more IP/ICMP translators. One of those networks
        either routes IPv4 but not IPv6, or contains some hosts that only
        implement IPv4. The other network either routes IPv6 but not IPv4, or
        contains some hosts that only implement IPv6. Both networks contain
        clients, servers, and peers.
</p>
<a name="section1.12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Applicability and Limitations</h3>

<p>The use of this translation algorithm assumes that the IPv6 network
        is somehow well connected i.e. when an IPv6 node wants to communicate
        with another IPv6 node there is an IPv6 path between them. Various
        tunneling schemes exist that can provide such a path, but those
        mechanisms and their use is outside the scope of this document <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a>.
</p>
<p>The translation algorithm can be used no only in a subnet or small
        networks, but can also be used in the autonomous system scope.
</p>
<p>The translating function as specified in this document does not
        translate any IPv4 options and it does not translate IPv6 routing
        headers, hop-by-hop extension headers, destination options headers or
        source routing headers <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a>.
</p>
<p>The issues and algorithms in the translation of datagram containing
        TCP segments are described in <a class='info' href='#RFC5382'>[RFC5382]<span> (</span><span class='info'>Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;NAT Behavioral Requirements for TCP,&rdquo; October&nbsp;2008.</span><span>)</span></a>. The
        considerations of that document are applicable in this case as
        well.
</p>
<p>Fragmented IPv4 UDP packets that do not contain a UDP checksum
        (i.e. the UDP checksum field is zero) are not of significant use over
        wide-areas in the Internet and will not be translated by the IP/ICMP
        translator <a class='info' href='#Miller'>[Miller]<span> (</span><span class='info'>Miller, G., &ldquo;Email to the ngtrans mailing list,&rdquo; March&nbsp;1999.</span><span>)</span></a>.
</p>
<p>The considerations of The IPSec <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>
        <a class='info' href='#RFC4302'>[RFC4302]<span> (</span><span class='info'>Kent, S., &ldquo;IP Authentication Header,&rdquo; December&nbsp;2005.</span><span>)</span></a> <a class='info' href='#RFC4303'>[RFC4303]<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a>
        functionality discussed in <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a> are
        applicable in this case as well.
</p>
<p>IPv4 multicast addresses <a class='info' href='#RFC3171'>[RFC3171]<span> (</span><span class='info'>Albanna, Z., Almeroth, K., Meyer, D., and M. Schipper, &ldquo;IANA Guidelines for IPv4 Multicast Address Assignments,&rdquo; August&nbsp;2001.</span><span>)</span></a> cannot be
        mapped to IPv6 multicast addresses <a class='info' href='#RFC3307'>[RFC3307]<span> (</span><span class='info'>Haberman, B., &ldquo;Allocation Guidelines for IPv6 Multicast Addresses,&rdquo; August&nbsp;2002.</span><span>)</span></a>
        based on the unicast mapping rule. However, a special rule for address
        translation can be created for the multicast packet translation
        algorithm; if that is done, the IP/ICMP header translation aspect of
        this memo works.
</p>
<a name="prefix-stateless"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Stateless vs. Stateful Mode</h3>

<p>The IP/ICMP translator has two possible modes of operation:
        stateless and stateful. In both cases, we assume that a system that
        has an IPv4 address but not an IPv6 address is communicating with a
        system that has an IPv6 address but no IPv4 address, or that the two
        systems do not have contiguous routing connectivity in either domain
        and hence are forced to have their communications translated.
</p>
<p>In the stateless mode, one system has an IPv4 address and one has
        an address of the form specified in <a class='info' href='#I-D.xli-behave-v4v6-prefix'>[I&#8209;D.xli&#8209;behave&#8209;v4v6&#8209;prefix]<span> (</span><span class='info'>Bao, C., Baker, F., and X. Li, &ldquo;IPv4/IPv6 Translation Prefix Recommendation,&rdquo; April&nbsp;2009.</span><span>)</span></a>, which is explicitly
        mapped to an IPv4 address. In this mode, there is no need to concern
        oneself with port translation or translation tables, as the IPv4 and
        IPv6 counterparts are algorithmically related.
</p>
<p>In the stateful mode, the same address type will represent the
        system with the IPv4 address, but the IPv6 system may use any <a class='info' href='#RFC4291'>[RFC4291]<span> (</span><span class='info'>Hinden, R. and S. Deering, &ldquo;IP Version 6 Addressing Architecture,&rdquo; February&nbsp;2006.</span><span>)</span></a> address except one in that range. In this
        case, a translation table is required.
</p>
<a name="address"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4"></a><h3>1.4.&nbsp;
IPv4-embedded IPv6 addresses and IPv4-related IPv6 addresses</h3>

<p>In SIIT <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a> an IPv6 node should send an
        IPv6 packet where the destination address is the IPv4-mapped address
        and the source address is the node's temporarily assigned
        IPv4-translated address. If the node does not have a temporarily
        assigned IPv4-translated address it should acquire one. Different from
        the SIIT model, as described in <a class='info' href='#I-D.xli-behave-v4v6-prefix'>[I&#8209;D.xli&#8209;behave&#8209;v4v6&#8209;prefix]<span> (</span><span class='info'>Bao, C., Baker, F., and X. Li, &ldquo;IPv4/IPv6 Translation Prefix Recommendation,&rdquo; April&nbsp;2009.</span><span>)</span></a> the new forms of the
        IPv6 addresses are introduced.
</p>
<p>IPv4-embedded IPv6 addresses are the IPv6 addresses which have
        unique relationship to specific IPv4 addresses. This relationship is
        self-described by embedding IPv4 address in the IPv6 address. The
        IPv4-embedded IPv6 addresses are used for both the stateless and the
        stateful modes.
</p>
<p>IPv4-related IPv6 addresses are the IPv6 addresses which have
        unique relationship to specific IPv4 addresses. This relationship is
        maintained as session-initiated dynamic state (mapping between IPv4
        address/transport port and IPv6 address/transport port) in the IP/ICMP
        translator. IPv4-related IPv6 addresses are used for the stateful mode
        only.
</p>
<a name="section3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Translating from IPv4 to IPv6</h3>

<p>When an IP/ICMP translator receives an IPv4 datagram addressed to a
      destination towards the IPv6 domain, it translates the IPv4 header of
      that packet into an IPv6 header. Since the ICMP <a class='info' href='#RFC0792'>[RFC0792]<span> (</span><span class='info'>Postel, J., &ldquo;Internet Control Message Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a><a class='info' href='#RFC4443'>[RFC4443]<span> (</span><span class='info'>Conta, A., Deering, S., and M. Gupta, &ldquo;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification,&rdquo; March&nbsp;2006.</span><span>)</span></a>, TCP <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> and UDP <a class='info' href='#RFC0768'>[RFC0768]<span> (</span><span class='info'>Postel, J., &ldquo;User Datagram Protocol,&rdquo; August&nbsp;1980.</span><span>)</span></a> headers
      contain checksums that include IP header information, the ICMP and
      transport-layer headers MUST be updated. This is different from <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a>, since <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a> uses
      special prefix (0::ffff:0:a:b:c:d) to avoid the recalculation of the
      transport-layer header checksum. The data portion of the packet is left
      unchanged. The IP/ICMP translator then forwards the packet based on the
      IPv6 destination address. The original IPv4 header on the packet is
      removed and replaced by an IPv6 header.
</p><br /><hr class="insert" />
<a name="v4v6xlat"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
+-------------+                 +-------------+
|    IPv4     |                 |    IPv6     |
|   Header    |                 |   Header    |
+-------------+                 +-------------+
|  Transport  |                 |  Fragment   |
|   Layer     |      ===&gt;       |   Header    |
|   Header    |                 |(not always) |
+-------------+                 +-------------+
|             |                 |  Transport  |
~    Data     ~                 |   Layer     |
|             |                 |   Header    |
+-------------+                 +-------------+
                               |             |
                               ~    Data     ~
                               |             |
                               +-------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: IPv4-to-IPv6 Translation&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>One of the differences between IPv4 and IPv6 is that in IPv6 path MTU
      discovery is mandatory but it is optional in IPv4. This implies that
      IPv6 routers will never fragment a packet - only the sender can do
      fragmentation.
</p>
<p>When the IPv4 node performs path MTU discovery (by setting the DF bit
      in the header) the path MTU discovery can operate end-to-end i.e. across
      the translator. In this case either IPv4 or IPv6 routers might send back
      ICMP "packet too big" messages to the sender. When the IPv6 routers send
      these ICMP errors they will pass through a translator that will
      translate the ICMP error to a form that the IPv4 sender can understand.
      In this case an IPv6 fragment header is only included if the IPv4 packet
      is already fragmented.
</p>
<p>However, when the IPv4 sender does not perform path MTU discovery the
      translator has to ensure that the packet does not exceed the path MTU on
      the IPv6 side. This is done by fragmenting the IPv4 packet so that it
      fits in 1280 byte IPv6 packets accomplishes this, since that is the
      minimum IPv6 packet size. Also, when the IPv4 sender does not perform
      path MTU discovery the translator MUST always include an IPv6 fragment
      header to indicate that the sender allows fragmentation. That is needed
      should the packet pass through an IP/ ICMP translator.
</p>
<p>The above rules ensure that when packets are fragmented, either by
      the sender or by IPv4 routers, the low-order 16 bits of the fragment
      identification is carried end-end, ensuring that packets are correctly
      reassembled. In addition, the rules use the presence of an IPv6 fragment
      header to indicate that the sender might not be using path MTU discovery
      i.e. the packet should not have the DF flag set should it later be
      translated back to IPv4.
</p>
<p>Other than the special rules for handling fragments and path MTU
      discovery the actual translation of the packet header consists of a
      simple mapping as defined below. Note that ICMP packets require special
      handling in order to translate the content of ICMP error message and
      also to add the ICMP pseudo-header checksum.
</p>
<a name="section3.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Translating IPv4 Headers into IPv6 Headers</h3>

<p>If the DF flag is not set and the IPv4 packet will result in an
        IPv6 packet larger than 1280 bytes the IPv4 packet MUST be fragmented
        prior to translating it. Since IPv4 packets with DF not set will
        always result in a fragment header being added to the packet the IPv4
        packets must be fragmented so that their length, excluding the IPv4
        header, is at most 1232 bytes (1280 minus 40 for the IPv6 header and 8
        for the Fragment header). The resulting fragments are then translated
        independently using the logic described below.
</p>
<p>If the DF bit is set and the packet is not a fragment (i.e., the MF
        flag is not set and the Fragment Offset is zero) then there is no need
        to add a fragment header to the packet. The IPv6 header fields are set
        as follows: </p>
<blockquote class="text"><dl>
<dt>Version:</dt>
<dd>6
</dd>
<dt>Traffic Class:</dt>
<dd>By default, copied from IP Type Of
            Service octet. According to <a class='info' href='#RFC2474'>[RFC2474]<span> (</span><span class='info'>Nichols, K., Blake, S., Baker, F., and D. Black, &ldquo;Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers,&rdquo; December&nbsp;1998.</span><span>)</span></a> the
            semantics of the bits are identical in IPv4 and IPv6. However, in
            some IPv4 environments these fields might be used with the old
            semantics of "Type Of Service and Precedence". An implementation
            of a translator SHOULD provide the ability to ignore the IPv4
            "TOS" and always set the IPv6 traffic class to zero. In addition,
            if the translator is at an administrative boundary, the filtering
            and update considerations of <a class='info' href='#RFC2475'>[RFC2475]<span> (</span><span class='info'>Blake, S., Black, D., Carlson, M., Davies, E., Wang, Z., and W. Weiss, &ldquo;An Architecture for Differentiated Services,&rdquo; December&nbsp;1998.</span><span>)</span></a> may be
            applicable.
</dd>
<dt>Flow Label:</dt>
<dd>0 (all zero bits)
</dd>
<dt>Payload Length:</dt>
<dd>Total length value from IPv4 header,
            minus the size of the IPv4 header and IPv4 options, if
            present.
</dd>
<dt>Next Header:</dt>
<dd>Protocol field copied from IPv4
            header
</dd>
<dt>Hop Limit:</dt>
<dd>TTL value copied from IPv4 header. Since
            the translator is a router, as part of forwarding the packet it
            needs to decrement either the IPv4 TTL (before the translation) or
            the IPv6 Hop Limit (after the translation). As part of
            decrementing the TTL or Hop Limit the translator (as any router)
            needs to check for zero and send the ICMPv4 or ICMPv6 "ttl
            exceeded" error.
</dd>
<dt>Source Address:</dt>
<dd>The source address is derived from
            the IPv4 source address to form an IPv4-embedded IPv6 address.
</dd>
<dt>Destination Address:</dt>
<dd>In stateless mode, which is to
            say that if the IPv4 destination address is within the range of
            the stateless translation prefix, the destination address is
            derived from the IPv4 destination address. <br />
 In stateful mode, which is to say that if the
            IPv4 destination address is not within the range of the stateless
            translation prefix, the IPv4-related IPv6 address and
            corresponding transport layer destination port are derived from
            the database reflecting current session state in the
            translator.
Database maintanence is as descrbed in <a class='info' href='#I-D.ietf-behave-v6v4-xlate-stateful'>[I&#8209;D.ietf&#8209;behave&#8209;v6v4&#8209;xlate&#8209;stateful]<span> (</span><span class='info'>Bagnulo, M., Matthews, P., and I. Beijnum, &ldquo;Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers,&rdquo; March&nbsp;2010.</span><span>)</span></a>.
</dd>
</dl></blockquote>

<p>If IPv4 options are present in the IPv4 packet, they are ignored
        i.e., there is no attempt to translate them. However, if an unexpired
        source route option is present then the packet MUST instead be
        discarded, and an ICMPv4 "destination unreachable/source route failed"
        (Type 3/Code 5) error message SHOULD be returned to the sender.
</p>
<p>If there is need to add a fragment header (the DF bit is not set or
        the packet is a fragment) the header fields are set as above with the
        following exceptions: </p>
<blockquote class="text"><dl>
<dt>IPv6 fields:</dt>
<dd>
<blockquote class="text"><dl>
<dt>Payload Length:</dt>
<dd>Total length value from IPv4
                header, plus 8 for the fragment header, minus the size of the
                IPv4 header and IPv4 options, if present.
</dd>
<dt>Next Header:</dt>
<dd>Fragment Header (44).
</dd>
</dl></blockquote>
</dd>
<dt>Fragment header fields:</dt>
<dd>
<blockquote class="text"><dl>
<dt>Next Header:</dt>
<dd>Protocol field copied from IPv4
                header.
</dd>
<dt>Fragment Offset:</dt>
<dd>Fragment Offset copied from the
                IPv4 header.
</dd>
<dt>M flag</dt>
<dd>More Fragments bit copied from the IPv4
                header.
</dd>
<dt>Identification</dt>
<dd>The low-order 16 bits copied from
                the Identification field in the IPv4 header. The high-order 16
                bits set to zero.
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>

<a name="section3.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Translating UDP over IPv4</h3>

<p>If a UDP packet has a zero UDP checksum then a valid checksum must
        be calculated in order to translate the packet. A stateless translator
        cannot do this for fragmented packets but <a class='info' href='#Miller'>[Miller]<span> (</span><span class='info'>Miller, G., &ldquo;Email to the ngtrans mailing list,&rdquo; March&nbsp;1999.</span><span>)</span></a> indicates that fragmented UDP packets with a
        zero checksum appear to only be used for malicious purposes. Thus this
        is not believed to be a noticeable limitation.
</p>
<p>When a translator receives the first fragment of a fragmented UDP
        IPv4 packet and the checksum field is zero the translator SHOULD drop
        the packet and generate a system management event specifying at least
        the IP addresses and port numbers in the packet. When it receives
        fragments other than the first it SHOULD silently drop the packet,
        since there is no port information to log.
</p>
<p>When a translator receives an unfragmented UDP IPv4 packet and the
        checksum field is zero the translator MUST compute the missing UDP
        checksum as part of translating the packet. Also, the translator
        SHOULD maintain a counter of how many UDP checksums are generated in
        this manner.
</p>
<a name="section3.3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Translating ICMPv4 Headers into ICMPv6 Headers</h3>

<p>All ICMP messages that are to be translated require that the ICMP
        checksum field be updated as part of the translation since ICMPv6
        unlike ICMPv4 has a pseudo-header checksum just like UDP and TCP.
</p>
<p>In addition all ICMP packets need to have the Type value translated
        and for ICMP error messages the included IP header also needs
        translation.
</p>
<p>The actions needed to translate various ICMPv4 messages are: </p>
<blockquote class="text"><dl>
<dt>ICMPv4 query messages:</dt>
<dd>
<blockquote class="text"><dl>
<dt>Echo and Echo Reply (Type 8 and Type 0)</dt>
<dd>Adjust
                the type to 128 and 129, respectively, and adjust the ICMP
                checksum both to take the type change into account and to
                include the ICMPv6 pseudo-header.
</dd>
<dt>Information Request/Reply (Type 15 and Type 16)</dt>
<dd>Obsoleted
                in ICMPv4 Silently drop.
</dd>
<dt>Timestamp and Timestamp Reply (Type 13 and Type 14)</dt>
<dd>Obsoleted
                in ICMPv6 Silently drop.
</dd>
<dt>Address Mask Request/Reply (Type 17 and Type 18)</dt>
<dd>Obsoleted
                in ICMPv6 Silently drop.
</dd>
<dt>ICMP Router Advertisement (Type 9)</dt>
<dd>Single hop
                message. Silently drop.
</dd>
<dt>ICMP Router Solicitation (Type 10)</dt>
<dd>Single hop
                message. Silently drop.
</dd>
<dt>Unknown ICMPv4 types</dt>
<dd>Silently drop.
</dd>
<dt>IGMP messages:</dt>
<dd>While the MLD messages <a class='info' href='#RFC2710'>[RFC2710]<span> (</span><span class='info'>Deering, S., Fenner, W., and B. Haberman, &ldquo;Multicast Listener Discovery (MLD) for IPv6,&rdquo; October&nbsp;1999.</span><span>)</span></a><a class='info' href='#RFC3590'>[RFC3590]<span> (</span><span class='info'>Haberman, B., &ldquo;Source Address Selection for the Multicast Listener Discovery (MLD) Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a><a class='info' href='#RFC3810'>[RFC3810]<span> (</span><span class='info'>Vida, R. and L. Costa, &ldquo;Multicast Listener Discovery Version 2 (MLDv2) for IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> are the logical IPv6 counterparts for
                the IPv4 IGMP messages all the "normal" IGMP messages are
                single-hop messages and should be silently dropped by the
                translator. Other IGMP messages might be used by multicast
                routing protocols and, since it would be a configuration error
                to try to have router adjacencies across IP/ICMP translators
                those packets should also be silently dropped.
</dd>
<dt> ICMPv4 error messages:</dt>
<dd>
<blockquote class="text"><dl>
<dt>Destination Unreachable (Type 3)</dt>
<dd>For all
                    that are not explicitly listed below set the Type to 1.
                    <br />
 Translate the code field as
                    follows: 
<blockquote class="text"><dl>
<dt>Code 0, 1 (net, host unreachable):</dt>
<dd>Set
                        Code to 0 (no route to destination).
</dd>
<dt>Code 2 (protocol unreachable):</dt>
<dd>Translate
                        to an ICMPv6 Parameter Problem (Type 4, Code 1) and
                        make the Pointer point to the IPv6 Next Header
                        field.
</dd>
<dt>Code 3 (port unreachable):</dt>
<dd>Set Code to 4
                        (port unreachable).
</dd>
<dt>Code 4 (fragmentation needed and DF set):</dt>
<dd>Translate
                        to an ICMPv6 Packet Too Big message (Type 2) with code
                        0. The MTU field needs to be adjusted for the
                        difference between the IPv4 and IPv6 header sizes.
                        Note that if the IPv4 router did not set the MTU field
                        i.e. the router does not implement <a class='info' href='#RFC1191'>[RFC1191]<span> (</span><span class='info'>Mogul, J. and S. Deering, &ldquo;Path MTU discovery,&rdquo; November&nbsp;1990.</span><span>)</span></a>, then the translator must use
                        the plateau values specified in <a class='info' href='#RFC1191'>[RFC1191]<span> (</span><span class='info'>Mogul, J. and S. Deering, &ldquo;Path MTU discovery,&rdquo; November&nbsp;1990.</span><span>)</span></a> to determine a likely path
                        MTU and include that path MTU in the ICMPv6 packet.
                        (Use the greatest plateau value that is less than the
                        returned Total Length field.)
</dd>
<dt>Code 5 (source route failed):</dt>
<dd>Set Code
                        to 0 (no route to destination). Note that this error
                        is unlikely since source routes are not
                        translated.
</dd>
<dt>Code 6,7:</dt>
<dd>Set Code to 0 (no route to
                        destination).
</dd>
<dt>Code 8:</dt>
<dd>Set Code to 0 (no route to
                        destination).
</dd>
<dt>Code 9, 10 (communication with destination host administratively prohibited):</dt>
<dd>Set
                        Code to 1 (communication with destination
                        administratively prohibited)
</dd>
<dt>Code 11, 12:</dt>
<dd>Set Code to 0 (no route to
                        destination).
</dd>
</dl></blockquote>
</dd>
<dt>Redirect (Type 5)</dt>
<dd>Single hop message.
                    Silently drop.
</dd>
<dt>Source Quench (Type 4)</dt>
<dd>Obsoleted in ICMPv6
                    Silently drop.
</dd>
<dt>Time Exceeded (Type 11)</dt>
<dd>Set the Type field
                    to 3. The Code field is unchanged.
</dd>
<dt>Parameter Problem (Type 12)</dt>
<dd>Set the Type
                    field to 4. The Pointer needs to be updated to point to
                    the corresponding field in the translated include IP
                    header.
</dd>
<dt>ICMP Error Payload</dt>
<dd>The <a class='info' href='#RFC4884'>[RFC4884]<span> (</span><span class='info'>Bonica, R., Gan, D., Tappan, D., and C. Pignataro, &ldquo;Extended ICMP to Support Multi-Part Messages,&rdquo; April&nbsp;2007.</span><span>)</span></a> length field should be updated to
                    reflect the changed length of the datagram. At the time of
                    this writing, the authors are not aware of any standard
                    ICMP extension objects containing realm specific
                    information.
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>

<a name="section3.4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Translating ICMPv4 Error Messages into ICMPv6</h3>

<p>There are some differences between the IPv4 and the IPv6 ICMP error
        message formats as detailed above. In addition, the ICMP error
        messages contain the IP header for the packet in error, which needs to
        be translated just like a normal IP header. The translation of this
        "packet in error" is likely to change the length of the datagram thus
        the Payload Length field in the outer IPv6 header might need to be
        updated.
</p><br /><hr class="insert" />
<a name="v4v6icmp"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
+-------------+                 +-------------+
|    IPv4     |                 |    IPv6     |
|   Header    |                 |   Header    |
+-------------+                 +-------------+
|   ICMPv4    |                 |   ICMPv6    |
|   Header    |                 |   Header    |
+-------------+                 +-------------+
|    IPv4     |      ===&gt;       |    IPv6     |
|   Header    |                 |   Header    |
+-------------+                 +-------------+
|   Partial   |                 |   Partial   |
|  Transport  |                 |  Transport  |
|   Layer     |                 |   Layer     |
|   Header    |                 |   Header    |
+-------------+                 +-------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: IPv4-to-IPv6 ICMP Error Translation&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The translation of the inner IP header can be done by recursively
        invoking the function that translated the outer IP headers.
</p>
<a name="transport"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Transport-layer Header Translation</h3>

<p>For the IPv6 addresses described in <a class='info' href='#I-D.xli-behave-v4v6-prefix'>[I&#8209;D.xli&#8209;behave&#8209;v4v6&#8209;prefix]<span> (</span><span class='info'>Bao, C., Baker, F., and X. Li, &ldquo;IPv4/IPv6 Translation Prefix Recommendation,&rdquo; April&nbsp;2009.</span><span>)</span></a>, the recalculation
        and updating of the transport-layer headers MUST be performed.
        UDP/IPv4 datagrams with a checksum of zero MAY be dropped and MAY have
        their checksum calculated for injection into the IPv6 domain. This
        choice SHOULD be under configuration control.
</p>
<a name="section3.5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.6"></a><h3>2.6.&nbsp;
Knowing when to Translate</h3>

<p>If the IP/ICMP translator is implemented in a router providing both
        translation and normal forwarding, and the address is reachable by a
        more specific route without translation, the router should forward it
        without translating it. Otherwise, when an IP/ICMP translator receives
        an IPv4 datagram addressed to a destination towards the IPv6 domain,
        the packet will be translated to IPv6.
</p>
<a name="section4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Translating from IPv6 to IPv4</h3>

<p>When an IP/ICMP translator receives an IPv6 datagram addressed to a
      destination towards the IPv4 domain, it translates the IPv6 header of
      that packet into an IPv4 header. Since the ICMP <a class='info' href='#RFC0792'>[RFC0792]<span> (</span><span class='info'>Postel, J., &ldquo;Internet Control Message Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a><a class='info' href='#RFC4443'>[RFC4443]<span> (</span><span class='info'>Conta, A., Deering, S., and M. Gupta, &ldquo;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification,&rdquo; March&nbsp;2006.</span><span>)</span></a>, TCP <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> and UDP <a class='info' href='#RFC0768'>[RFC0768]<span> (</span><span class='info'>Postel, J., &ldquo;User Datagram Protocol,&rdquo; August&nbsp;1980.</span><span>)</span></a> headers
      consist of check sums, which include the IP header, the recalculation
      and updating of the ICMP header and the transport-layer headers MUST be
      performed. This is different from <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a>, since
      <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a> uses special prefix (0::ffff:0:a:b:c:d)
      to avoid the recalculation of the transport-layer header checksum. The
      data portion of the packet is left unchanged. The IP/ICMP translator
      then forwards the packet based on the IPv4 destination address. The
      original IPv6 header on the packet is removed and replaced by an IPv4
      header.
</p><br /><hr class="insert" />
<a name="v6v4xlat"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
+-------------+                 +-------------+
|    IPv6     |                 |    IPv4     |
|   Header    |                 |   Header    |
+-------------+                 +-------------+
|  Fragment   |                 |  Transport  |
|   Header    |      ===&gt;       |   Layer     |
|(if present) |                 |   Header    |
+-------------+                 +-------------+
|  Transport  |                 |             |
|   Layer     |                 ~    Data     ~
|   Header    |                 |             |
+-------------+                 +-------------+
|             |
~    Data     ~
|             |
+-------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: IPv6-to-IPv4 Translation&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>There are some differences between IPv6 and IPv4 in the area of
      fragmentation and the minimum link MTU that effect the translation. An
      IPv6 link has to have an MTU of 1280 bytes or greater. The corresponding
      limit for IPv4 is 68 bytes. Thus, unless there were special measures, it
      would not be possible to do end-to-end path MTU discovery when the path
      includes an translator since the IPv6 node might receive ICMP "packet
      too big" messages originated by an IPv4 router that report an MTU less
      than 1280. However, <a class='info' href='#RFC2460'>[RFC2460]<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> section 5 requires
      that IPv6 nodes handle such an ICMP "packet too big" message by reducing
      the path MTU to 1280 and including an IPv6 fragment header with each
      packet. This allows end-to-end path MTU discovery across the translator
      as long as the path MTU is 1280 bytes or greater. When the path MTU
      drops below the 1280 limit the IPv6 sender will originate 1280 byte
      packets that will be fragmented by IPv4 routers along the path after
      being translated to IPv4.
</p>
<p>The only drawback with this scheme is that it is not possible to use
      PMTU to do optimal UDP fragmentation (as opposed to completely avoiding
      fragmentation) at sender since the presence of an IPv6 Fragment header
      is interpreted that is it OK to fragment the packet on the IPv4 side.
      Thus if a UDP application wants to send large packets independent of the
      PMTU, the sender will only be able to determine the path MTU on the IPv6
      side of the translator. If the path MTU on the IPv4 side of the
      translator is smaller then the IPv6 sender will not receive any ICMP
      "too big" errors and cannot adjust the size fragments it is sending.
</p>
<p>Other than the special rules for handling fragments and path MTU
      discovery the actual translation of the packet header consists of a
      simple mapping as defined below. Note that ICMP packets require special
      handling in order to translate the content of ICMP error message and
      also to add the ICMP pseudo-header checksum.
</p>
<a name="section4.1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Translating IPv6 Headers into IPv4 Headers</h3>

<p>If there is no IPv6 Fragment header the IPv4 header fields are set
        as follows: </p>
<blockquote class="text"><dl>
<dt>Version:</dt>
<dd>4
</dd>
<dt>Internet Header Length:</dt>
<dd>5 (no IPv4 options)
</dd>
<dt>Type of Service (TOS) Octet:</dt>
<dd>By default, copied from
            the IPv6 Traffic Class (all 8 bits). According to <a class='info' href='#RFC2474'>[RFC2474]<span> (</span><span class='info'>Nichols, K., Blake, S., Baker, F., and D. Black, &ldquo;Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers,&rdquo; December&nbsp;1998.</span><span>)</span></a> the semantics of the bits are identical
            in IPv4 and IPv6. However, in some IPv4 environments these bits
            might be used with the old semantics of "Type Of Service and
            Precedence". An implementation of a translator SHOULD provide the
            ability to ignore the IPv6 traffic class and always set the IPv4
            TOS Octet to a specified value. In addition, if the translator is
            at an administrative boundary, the filtering and update
            considerations of <a class='info' href='#RFC2475'>[RFC2475]<span> (</span><span class='info'>Blake, S., Black, D., Carlson, M., Davies, E., Wang, Z., and W. Weiss, &ldquo;An Architecture for Differentiated Services,&rdquo; December&nbsp;1998.</span><span>)</span></a> may be
            applicable.
</dd>
<dt>Total Length:</dt>
<dd>Payload length value from IPv6 header,
            plus the size of the IPv4 header.
</dd>
<dt>Identification:</dt>
<dd>All zero.
</dd>
<dt>Flags:</dt>
<dd>The More Fragments flag is set to zero. The
            Don't Fragments flag is set to one.
</dd>
<dt>Fragment Offset:</dt>
<dd>All zero.
</dd>
<dt>Time to Live:</dt>
<dd>Hop Limit value copied from IPv6
            header. Since the translator is a router, as part of forwarding
            the packet it needs to decrement either the IPv6 Hop Limit (before
            the translation) or the IPv4 TTL (after the translation). As part
            of decrementing the TTL or Hop Limit the translator (as any
            router) needs to check for zero and send the ICMPv4 or ICMPv6 "ttl
            exceeded" error.
</dd>
<dt>Protocol:</dt>
<dd>Next Header field copied from IPv6
            header.
</dd>
<dt>Header Checksum:</dt>
<dd>Computed once the IPv4 header has
            been created.
</dd>
<dt>Source Address:</dt>
<dd>In stateless mode, which is to say
            that if the IPv6 source address is within the range of the
            stateless translation prefix, the source address is derived from
            the IPv4-embedded IPv6 address. <br />
 In
            stateful mode, which is to say that if the IPv6 source address is
            not within the range of the stateless translation prefix, the IPv4
            source address and transport layer source port corresponding to
            the IPv4-related IPv6 source address and source port are derived
            from the database reflecting current session state in the
            translator.
Database maintanence is as descrbed in <a class='info' href='#I-D.ietf-behave-v6v4-xlate-stateful'>[I&#8209;D.ietf&#8209;behave&#8209;v6v4&#8209;xlate&#8209;stateful]<span> (</span><span class='info'>Bagnulo, M., Matthews, P., and I. Beijnum, &ldquo;Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers,&rdquo; March&nbsp;2010.</span><span>)</span></a>.

</dd>
<dt>Destination Address:</dt>
<dd>
The IPv4 destination address is extracted from the
            IPv4-mapped destination address of the datagram being translated.
</dd>
</dl></blockquote>

<p>If any of an IPv6 hop-by-hop options header, destination options
        header, or routing header with the Segments Left field equal to zero
        are present in the IPv6 packet, they are ignored i.e., there is no
        attempt to translate them. However, the Total Length field and the
        Protocol field would have to be adjusted to "skip" these extension
        headers.
</p>
<p>If a routing header with a non-zero Segments Left field is present
        then the packet MUST NOT be translated, and an ICMPv6 "parameter
        problem/ erroneous header field encountered" (Type 4/Code 0) error
        message, with the Pointer field indicating the first byte of the
        Segments Left field, SHOULD be returned to the sender.
</p>
<p>If the IPv6 packet contains a Fragment header the header fields are
        set as above with the following exceptions: </p>
<blockquote class="text"><dl>
<dt>Total Length:</dt>
<dd>Payload length value from IPv6 header,
            minus 8 for the Fragment header, plus the size of the IPv4
            header.
</dd>
<dt>Identification:</dt>
<dd>Copied from the low-order 16-bits in
            the Identification field in the Fragment header.
</dd>
<dt>Flags:</dt>
<dd>The More Fragments flag is copied from the M
            flag in the Fragment header. The Don't Fragments flag is set to
            zero allowing this packet to be fragmented by IPv4 routers.
</dd>
<dt>Fragment Offset:</dt>
<dd>Copied from the Fragment Offset
            field in the Fragment Header.
</dd>
<dt>Protocol:</dt>
<dd>Next Header value copied from Fragment
            header.
</dd>
</dl></blockquote>

<a name="section4.2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Translating ICMPv6 Headers into ICMPv4 Headers</h3>

<p>All ICMP messages that are to be translated require that the ICMP
        checksum field be updated as part of the translation since ICMPv6
        unlike ICMPv4 has a pseudo-header checksum just like UDP and TCP.
</p>
<p>In addition all ICMP packets need to have the Type value translated
        and for ICMP error messages the included IP header also needs
        translation.
</p>
<p>The actions needed to translate various ICMPv6 messages are: </p>
<blockquote class="text"><dl>
<dt>ICMPv6 informational messages:</dt>
<dd>
<blockquote class="text"><dl>
<dt>Echo Request and Echo Reply (Type 128 and 129)</dt>
<dd>Adjust
                the type to 0 and 8, respectively, and adjust the ICMP
                checksum both to take the type change into account and to
                exclude the ICMPv6 pseudo-header.
</dd>
<dt>MLD Multicast Listener Query/Report/Done (Type 130, 131, 132)</dt>
<dd>Single
                hop message. Silently drop.
</dd>
<dt>Neighbor Discover messages (Type 133 through 137)</dt>
<dd>Single
                hop message. Silently drop.
</dd>
<dt>Unknown informational messages</dt>
<dd>Silently
                drop.
</dd>
</dl></blockquote>
</dd>
<dt>ICMPv6 error messages:</dt>
<dd>
<blockquote class="text"><dl>
<dt>Destination Unreachable (Type 1)</dt>
<dd>Set the Type
                field to 3. Translate the code field as follows: 
<blockquote class="text"><dl>
<dt>Code 0 (no route to destination):</dt>
<dd>Set Code
                    to 1 (host unreachable).
</dd>
<dt>Code 1 (communication with destination administratively prohibited):</dt>
<dd>Set
                    Code to 10 (communication with destination host
                    administratively prohibited).
</dd>
<dt>Code 2 (beyond scope of source address):</dt>
<dd>Set
                    Code to 1 (host unreachable). Note that this error is very
                    unlikely since the IPv4-translatable source address is
                    considered to have global scope.
</dd>
<dt>Code 3 (address unreachable):</dt>
<dd>Set Code to 1
                    (host unreachable).
</dd>
<dt>Code 4 (port unreachable):</dt>
<dd>Set Code to 3
                    (port unreachable).
</dd>
</dl></blockquote>
</dd>
<dt>Packet Too Big (Type 2)</dt>
<dd>Translate to an ICMPv4
                Destination Unreachable with code 4. The MTU field needs to be
                adjusted for the difference between the IPv4 and IPv6 header
                sizes taking into account whether or not the packet in error
                includes a Fragment header.
</dd>
<dt>Time Exceeded (Type 3)</dt>
<dd>Set the Type to 11. The
                Code field is unchanged.
</dd>
<dt>Parameter Problem (Type 4)</dt>
<dd>If the Code is 1,
                translate this to an ICMPv4 protocol unreachable (Type 3, Code
                2). Otherwise set the Type to 12 and the Code to zero. The
                Pointer needs to be updated to point to the corresponding
                field in the translated include IP header.
</dd>
<dt>Unknown error messages</dt>
<dd>Silently drop.
</dd>
<dt>ICMP Error Payload</dt>
<dd>The <a class='info' href='#RFC4884'>[RFC4884]<span> (</span><span class='info'>Bonica, R., Gan, D., Tappan, D., and C. Pignataro, &ldquo;Extended ICMP to Support Multi-Part Messages,&rdquo; April&nbsp;2007.</span><span>)</span></a> length field should be updated to
                reflect the changed length of the datagram. At the time of
                this writing, the authors are not aware of any standard ICMP
                extension objects containing realm specific information.
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>

<a name="section4.3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Translating ICMPv6 Error Messages into ICMPv4</h3>

<p>There are some differences between the IPv4 and the IPv6 ICMP error
        message formats as detailed above. In addition, the ICMP error
        messages contain the IP header for the packet in error, which needs to
        be translated just like a normal IP header. The translation of this
        "packet in error" is likely to change the length of the datagram thus
        the Total Length field in the outer IPv4 header might need to be
        updated.
</p><br /><hr class="insert" />
<a name="v6v4icmp"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
+-------------+                 +-------------+
|    IPv6     |                 |    IPv4     |
|   Header    |                 |   Header    |
+-------------+                 +-------------+
|   ICMPv6    |                 |   ICMPv4    |
|   Header    |                 |   Header    |
+-------------+                 +-------------+
|    IPv6     |      ===&gt;       |    IPv4     |
|   Header    |                 |   Header    |
+-------------+                 +-------------+
|   Partial   |                 |   Partial   |
|  Transport  |                 |  Transport  |
|   Layer     |                 |   Layer     |
|   Header    |                 |   Header    |
+-------------+                 +-------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: IPv6-to-IPv4 ICMP Error Translation&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The translation of the inner IP header can be done by recursively
        invoking the function that translated the outer IP headers.
</p>
<a name="transport2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Transport-layer Header Translation</h3>

<p>Stateless and stateful translation using the IPv6 addresses
        described in <a class='info' href='#I-D.xli-behave-v4v6-prefix'>[I&#8209;D.xli&#8209;behave&#8209;v4v6&#8209;prefix]<span> (</span><span class='info'>Bao, C., Baker, F., and X. Li, &ldquo;IPv4/IPv6 Translation Prefix Recommendation,&rdquo; April&nbsp;2009.</span><span>)</span></a>
        requires the recalculation and updating of the transport-layer
        checksums.
</p>
<a name="section4.4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Knowing when to Translate</h3>

<p>If the IP/ICMP translator is implemented in a router providing both
        translation and normal forwarding, and the address is reachable by a
        more specific route without translation, the router should forward it
        without translating it. When an IP/ICMP translator receives an IPv6
        datagram addressed to a destination towards the IPv4 domain, the
        packet will be translated to IPv4.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
IANA Considerations</h3>

<p>This memo adds no new IANA considerations.
</p>
<p>Note to RFC Editor: This section will have served its purpose if it
      correctly tells IANA that no new assignments or registries are required,
      or if those assignments or registries are created during the RFC
      publication process. From the author's perspective, it may therefore be
      removed upon publication as an RFC at the RFC Editor's discretion.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>The use of stateless IP/ICMP translators does not introduce any new
      security issues beyond the security issues that are already present in
      the IPv4 and IPv6 protocols and in the routing protocols that are used
      to make the packets reach the translator.
</p>
<p>As the Authentication Header <a class='info' href='#RFC4302'>[RFC4302]<span> (</span><span class='info'>Kent, S., &ldquo;IP Authentication Header,&rdquo; December&nbsp;2005.</span><span>)</span></a> is
      specified to include the IPv4 Identification field and the translating
      function not being able to always preserve the Identification field, it
      is not possible for an IPv6 endpoint to compute AH on received packets
      that have been translated from IPv4 packets. Thus AH does not work
      through a translator.
</p>
<p>Packets with ESP can be translated since ESP does not depend on
      header fields prior to the ESP header. Note that ESP transport mode is
      easier to handle than ESP tunnel mode; in order to use ESP tunnel mode
      the IPv6 node needs to be able to generate an inner IPv4 header when
      transmitting packets and remove such an IPv4 header when receiving
      packets.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgements</h3>

<p>This is under development by a large group of people. Those who have
      posted to the list during the discussion include Andrew Sullivan, Andrew
      Yourtchenko, Brian Carpenter, Dan Wing, Ed Jankiewicz, Fred Baker,
      Hiroshi Miyata, Iljitsch van Beijnum, John Schnizlein, Kevin Yin, Magnus
      Westerlund, Marcelo Bagnulo Braun, Margaret Wasserman, Masahito Endo,
      Phil Roberts, Philip Matthews, Remi Denis-Courmont, Remi Despres, and
      Xing Li.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.xli-behave-v4v6-prefix">[I-D.xli-behave-v4v6-prefix]</a></td>
<td class="author-text">Bao, C., Baker, F., and X. Li, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-xli-behave-v4v6-prefix-00.txt">IPv4/IPv6 Translation Prefix Recommendation</a>,&rdquo; draft-xli-behave-v4v6-prefix-00 (work in progress), April&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-xli-behave-v4v6-prefix-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0768">[RFC0768]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc768">User Datagram Protocol</a>,&rdquo; STD&nbsp;6, RFC&nbsp;768, August&nbsp;1980 (<a href="http://www.rfc-editor.org/rfc/rfc768.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0791">[RFC0791]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc791">Internet Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;791, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc791.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0792">[RFC0792]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc792">Internet Control Message Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;792, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc792.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0793">[RFC0793]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc793">Transmission Control Protocol</a>,&rdquo; STD&nbsp;7, RFC&nbsp;793, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc793.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2460">[RFC2460]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a> and <a href="mailto:hinden@iprg.nokia.com">R. Hinden</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;2460, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2460.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2460.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2460.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2765">[RFC2765]</a></td>
<td class="author-text"><a href="mailto:nordmark@sun.com">Nordmark, E.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2765">Stateless IP/ICMP Translation Algorithm (SIIT)</a>,&rdquo; RFC&nbsp;2765, February&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2765.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4291">[RFC4291]</a></td>
<td class="author-text">Hinden, R. and S. Deering, &ldquo;<a href="http://tools.ietf.org/html/rfc4291">IP Version 6 Addressing Architecture</a>,&rdquo; RFC&nbsp;4291, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4291.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4443">[RFC4443]</a></td>
<td class="author-text">Conta, A., Deering, S., and M. Gupta, &ldquo;<a href="http://tools.ietf.org/html/rfc4443">Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;4443, March&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4443.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4884">[RFC4884]</a></td>
<td class="author-text">Bonica, R., Gan, D., Tappan, D., and C. Pignataro, &ldquo;<a href="http://tools.ietf.org/html/rfc4884">Extended ICMP to Support Multi-Part Messages</a>,&rdquo; RFC&nbsp;4884, April&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4884.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5382">[RFC5382]</a></td>
<td class="author-text">Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;<a href="http://tools.ietf.org/html/rfc5382">NAT Behavioral Requirements for TCP</a>,&rdquo; BCP&nbsp;142, RFC&nbsp;5382, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5382.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-behave-v6v4-framework">[I-D.ietf-behave-v6v4-framework]</a></td>
<td class="author-text">Baker, F., Li, X., Bao, C., and K. Yin, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-v6v4-framework-08.txt">Framework for IPv4/IPv6 Translation</a>,&rdquo; draft-ietf-behave-v6v4-framework-08 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-v6v4-framework-08.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-behave-v6v4-xlate-stateful">[I-D.ietf-behave-v6v4-xlate-stateful]</a></td>
<td class="author-text">Bagnulo, M., Matthews, P., and I. Beijnum, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-v6v4-xlate-stateful-11.txt">Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers</a>,&rdquo; draft-ietf-behave-v6v4-xlate-stateful-11 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-v6v4-xlate-stateful-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="Miller">[Miller]</a></td>
<td class="author-text">Miller, G., &ldquo;Email to the ngtrans mailing list,&rdquo; March&nbsp;1999.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1191">[RFC1191]</a></td>
<td class="author-text"><a href="mailto:mogul@decwrl.dec.com">Mogul, J.</a> and <a href="mailto:deering@xerox.com">S. Deering</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1191">Path MTU discovery</a>,&rdquo; RFC&nbsp;1191, November&nbsp;1990 (<a href="http://www.rfc-editor.org/rfc/rfc1191.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2474">[RFC2474]</a></td>
<td class="author-text"><a href="mailto:kmn@cisco.com">Nichols, K.</a>, <a href="mailto:slblake@torrentnet.com">Blake, S.</a>, <a href="mailto:fred@cisco.com">Baker, F.</a>, and <a href="mailto:black_david@emc.com">D. Black</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2474">Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers</a>,&rdquo; RFC&nbsp;2474, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2474.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2474.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2474.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2475">[RFC2475]</a></td>
<td class="author-text"><a href="mailto:slblake@torrentnet.com">Blake, S.</a>, <a href="mailto:black_david@emc.com">Black, D.</a>, <a href="mailto:mark.carlson@sun.com">Carlson, M.</a>, <a href="mailto:elwynd@nortel.co.uk">Davies, E.</a>, <a href="mailto:zhwang@bell-labs.com">Wang, Z.</a>, and <a href="mailto:wweiss@lucent.com">W. Weiss</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2475">An Architecture for Differentiated Services</a>,&rdquo; RFC&nbsp;2475, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2475.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2475.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2475.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2710">[RFC2710]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a>, <a href="mailto:fenner@research.att.com">Fenner, W.</a>, and <a href="mailto:haberman@raleigh.ibm.com">B. Haberman</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2710">Multicast Listener Discovery (MLD) for IPv6</a>,&rdquo; RFC&nbsp;2710, October&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2710.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3171">[RFC3171]</a></td>
<td class="author-text">Albanna, Z., Almeroth, K., Meyer, D., and M. Schipper, &ldquo;<a href="http://tools.ietf.org/html/rfc3171">IANA Guidelines for IPv4 Multicast Address Assignments</a>,&rdquo; RFC&nbsp;3171, August&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3171.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3307">[RFC3307]</a></td>
<td class="author-text">Haberman, B., &ldquo;<a href="http://tools.ietf.org/html/rfc3307">Allocation Guidelines for IPv6 Multicast Addresses</a>,&rdquo; RFC&nbsp;3307, August&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3307.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3590">[RFC3590]</a></td>
<td class="author-text">Haberman, B., &ldquo;<a href="http://tools.ietf.org/html/rfc3590">Source Address Selection for the Multicast Listener Discovery (MLD) Protocol</a>,&rdquo; RFC&nbsp;3590, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3590.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3810">[RFC3810]</a></td>
<td class="author-text">Vida, R. and L. Costa, &ldquo;<a href="http://tools.ietf.org/html/rfc3810">Multicast Listener Discovery Version 2 (MLDv2) for IPv6</a>,&rdquo; RFC&nbsp;3810, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3810.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4213">[RFC4213]</a></td>
<td class="author-text">Nordmark, E. and R. Gilligan, &ldquo;<a href="http://tools.ietf.org/html/rfc4213">Basic Transition Mechanisms for IPv6 Hosts and Routers</a>,&rdquo; RFC&nbsp;4213, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4213.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4301">[RFC4301]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4301.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4302">[RFC4302]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4302">IP Authentication Header</a>,&rdquo; RFC&nbsp;4302, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4302.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4303">[RFC4303]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4303">IP Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;4303, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4303.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Xing Li (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">CERNET Center/Tsinghua University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Room 225, Main Building, Tsinghua University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Beijing,   100084</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86 62785983</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:xing@cernet.edu.cn">xing@cernet.edu.cn</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Congxiao Bao (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">CERNET Center/Tsinghua University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Room 225, Main Building, Tsinghua University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Beijing,   100084</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86 62785983</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:congxiao@cernet.edu.cn">congxiao@cernet.edu.cn</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fred Baker (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Santa Barbara, California  93117</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-408-526-4257</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:fred@cisco.com">fred@cisco.com</a></td></tr>
</table>
</body></html>
