<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Spam Score for SIP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Spam Score for SIP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">RUCUS Exploratory Working Group</td><td class="header">D. Wing</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco</td></tr>
<tr><td class="header">Intended status:  Experimental</td><td class="header">S. Niccolini</td></tr>
<tr><td class="header">Expires:  August 27, 2008</td><td class="header">M. Stiemerling</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">NEC</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 24, 2008</td></tr>
</table></td></tr></table>
<h1><br />Spam Score for SIP<br />draft-wing-sipping-spam-score-02</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 27, 2008.</p>

<h3>Abstract</h3>

<p>This document defines a mechanism for SIP proxies to communicate a
      spam score to downstream SIP proxies and to SIP user agents. This
      information can then be used as input to other decision making engines,
      for example, to provide alternate call routing or call handling.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
Calculation of the Spam Score<br />
<a href="#anchor4">4.</a>&nbsp;
Information passed downstream<br />
<a href="#anchor5">5.</a>&nbsp;
Operation of Spam-Scoring Proxy<br />
<a href="#anchor6">6.</a>&nbsp;
Operation of Downtream Proxy or User Agent<br />
<a href="#anchor7">7.</a>&nbsp;
Grammar<br />
<a href="#examples">8.</a>&nbsp;
Examples<br />
<a href="#security_considerations">9.</a>&nbsp;
Security Considerations<br />
<a href="#anchor8">10.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor9">11.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informational References<br />
<a href="#anchor12">Appendix&nbsp;A.</a>&nbsp;
Changes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">A.1.</a>&nbsp;
Changes from -00 to -01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">A.2.</a>&nbsp;
Changes from -01 to -02<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>It is desirable for SIP proxies to insert a spam score so that
      downstream SIP proxies and downstream SIP user agents can use a high
      score to decide that special handling is required. For example, a score
      above 20 might cause one of the spam avoidance techniques described in
      <a class='info' href='#RFC5039'>[RFC5039]<span> (</span><span class='info'>Rosenberg, J. and C. Jennings, &ldquo;The Session Initiation Protocol (SIP) and Spam,&rdquo; January&nbsp;2008.</span><span>)</span></a> to be triggered for this call.
</p>
<p>This specification allows each SIP proxy to contribute spam scoring
      information that can be useful to downstream SIP proxies and the SIP
      user agent (UA). The downstream SIP proxies or SIP UA might ignore that
      information (e.g., it doesn't trust the SIP proxy that generated the
      spam score) or might use it.
</p>
<p>Note that this document does not make the attempt to define how the
      spam score was derived nor to distribute information that could be used
      to verify the spam score generation. Furthermore, this document does not
      attempt to cryptographically bind the identity of the entity generating
      the score to the value itself. Hence, its usage is likely to be useful
      only between neighboring administrative domains communicating such a
      score.
</p>
<p>One may wonder why bother marking a message that appears to be SPAM
      when the same process that detected the SPAM can also automatically
      block it. The answer is that contractual as well as regulatory issues
      may prevent blocking and in these cases while not able to block, the
      detecting proxy can nonetheless notify downstream elements of the
      potential threat.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Calculation of the Spam Score</h3>

<p>A SIP proxy evaluates an incoming SIP request and generates a spam
      score using a local mechanism. In order to allow for whitelisting as
      well as blacklisting the scoring is between 0 and 100, 0 indicating
      absolute acceptance (e.g., whitelist), 100 indicating absolute SPAM
      (e.g., blacklist) and scores between 0 and 100 can be considered to
      represent the percentage likelyhood of spam.
</p>
<p>The actual calculation is governed by algorithms (one example is
      found in examples section below) which MAY be agreed upon by the
      upstream and downstrem domains. The algorithm MAY be conveyed by the
      downstream doamins to the upstream one out of band prior to the upstream
      domain marking a message for transport downstream. Alternatively, a
      default algorithm can be used if no alternate algorithm was established
      a-priori between upstream and downstream domains. The mechanism for
      conveyance of algorithm to upstream domain is out of scope for this
      document but can be seen as an extension to <a class='info' href='#I-D.tschofenig-sipping-framework-spit-reduction'>[I&#8209;D.tschofenig&#8209;sipping&#8209;framework&#8209;spit&#8209;reduction]<span> (</span><span class='info'>Tschofenig, H., Schulzrinne, H., Wing, D., Rosenberg, J., and D. Schwartz, &ldquo;A Framework to tackle Spam and Unwanted Communication for Internet  Telephony,&rdquo; July&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Information passed downstream</h3>

<p>In addition to the score the following other pieces of information
      should be passed downstream as well: </p>
<blockquote class="text">
<p>Realm - Indicating the upstream domain or realm making the
          claim
</p>
<p>Algorithm - The name of the agreed upon algorithm
</p>
<p>Strength - An integer indicating the confidence of the score
          (0-100)
</p>
<p>Info - A text field containing any arbitrary information
</p>
<p>Param[1..3] - 3 general purpose parameters for futureproofing
</p>
<p>IsSpam - A boolean for convenience purposes alone.
</p>
</blockquote>

<p>The Relam is shared by all proxies in a domain and enables the
      downstream proxy to determine whether or not the score is to be
      trusted.
</p>
<p>The Algorithm is the name of the algorithm used and can be
      standardized in the same way encryption algorithm names (e.g. sha-1)
      have been standardized.
</p>
<p>The Strength field inidicates the confidence level of the Score. This
      is generated by the same entity which generates the Score, and is an
      output from the algorithim, which is based on a number of factors,
      including for example volume of calls, call type etc. It is meant to
      quantify the score. A calling party that makes many calls and has an
      average score of 85 is preferable to calling party who made 1 or 2 calls
      only and has an average score of 95.
</p>
<p>Info is a text field (which can be limited to 64 bytes if we are
      concerned about the MTU) that is there to provide more complete
      information on the SPIT scoring etc, and can be used for diagnosis etc.
      (which is useful for off line analysis reporting etc.). For example, it
      could provide an explanation of the score such as is done in one
      particular email spam package.
</p><br /><hr class="insert" />
<a name="rule-example"></a>

<p>In this email example the threshold for SPAM is 7 and this
        message scored a 9.5. The sample text info below could be used to
        explain how the score was calculated.
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
points  rule-name          rule-description
------  ----------------   ------------------------------
 2.5    SUBJ_CAPS          Subject lind is capitalized
 1.8    INLINE_GIF         inline GIF detected in message
 3.0    NON_PREF_LANG      Non default language
 2.0    HONEYPOT           Honeypot address in cc
 0.2    KEYWORD_MATCH      suspicious words in message
</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Email Spam Rule example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>As expected in this example, different tests have different scores
      depending on their contribution to the potential of SPAM. Similarly in
      the case of SPIT there can be many rules applied and having this info
      can enable the receiving party to analyze the results (non realtime)
</p>
<p>Params 1,2 and 3 are just general purpose placeholders (containing
      Param_Desc, Param_Value pairs) for future proofing capabilities. Since
      so much is still unknown about IP communications SPAM this is seen as a
      wise approach.
</p>
<p>Finally, as an option it may be wise to have a boolean yes/no kind of
      indicator for all those downstream who do not care to know why the
      upstream element assumes it is spit only that it is.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Operation of Spam-Scoring Proxy</h3>

<p>A SIP proxy evaluates an incoming SIP request and generates a spam
      score using a local mechanism. This score is between 0 (indicating the
      message is not spam) and 100 (indicating the message is spam). Values
      between 0 and 100 indicate the 'likelihood' that the SIP request is
      spam, with higher values indicating a higher likelihood the message is
      spam.
</p>
<p>This spam score is inserted into the new "Spam-Score" header. This
      header field contains a summary spam score and optionally contains
      detail information. The detail information is implementation dependent.
      The detail information is valuable for debugging and to provide the SIP
      user agent or SIP proxy with additional information regarding how the
      spam-scoring SIP proxy's local mechanism arrived at the summary spam
      score.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Operation of Downtream Proxy or User Agent</h3>

<p>A downstream proxy or the SIP user agent MAY use the spam score or
      spam-detail information to change call routing or call handling. It is
      envisioned that some form of policies indicate the trusted proxies in
      order to decide which spam scores to consider for special call
      treatment. </p>
<blockquote class="text">
<p>In some jurisdictions, the end user needs to authorize call
          handling, including rejection of a call based on a spam score.
          Mechanisms to allow users to authorize such policies are, however,
          out of scope of this document.
</p>
</blockquote>

<p>The behavior of the SIP proxy or user agent when the spam score is
      above a certain value is a local policy matter. Examples of behavior
      include: </p>
<ul class="text">
<li>a SIP request with a high spam score might cause a proxy or user
          agent to redirect the SIP request to company's main telephone
          extension or to the user's voicemail
</li>
<li>a user agent might alert the user by flashing the phone (without
          audible ringing)
</li>
<li>a user agent might allow calls with a spam score below a certain
          value during daylight hours, but deny such calls at night.
</li>
<li>a proxy might challenge the caller to complete a Turing test.
</li>
</ul>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Grammar</h3>
<br /><hr class="insert" />
<a name="ABNF"></a>

<p>ABNF using the ABNF syntax of <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  extension-header   = "Spam-Score:" SP
                       spam-score *[ SP ";" spam-detail ]

  spam-score         = score SP "by" SP hostname
  score              = 1*3DIGIT [ "." 1*3DIGIT ]

  spam-detail    = spam-strength / spam-algorithm / spam-param

  spam-algorithm = "spam-algorithm" EQUAL quoted-string

  spam-strength  = "spam-score-strength" EQUAL strength
  strength       = 1*3DIGIT [ "." 0*3DIGIT ]

  spam-info      = "spam-info" EQUAL info-value
  info-value     = quoted-string

  spam-param1    = "spam-param1" EQUAL param-value
  param-value    = quoted-string

  spam-param2    = "spam-param2" EQUAL param-value
  param-value    = quoted-string

  spam-param3    = "spam-param3" EQUAL param-value
  param-value    = quoted-string

  spam-isspam    = [ "isSpam" ]

</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: ABNF&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="examples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Examples</h3>
<br /><hr class="insert" />
<a name="example"></a>

<p>The following example shows a SIP score generated and
        inserted by two SIP proxies, sip.example.com and sip.example.net. In
        this example, sip.example.com is owned by a spammer who is trying to
        fool downstream systems with their low spam score (0). However, the
        example.net proxies and user agents only pay attention to spam scores
        from Spam-Score headers generated by example.net proxies, so
        example.com's attempts to fool the downstream proxies (with its low
        spam score) are in vain. Note also the sample Session Duration Time
        (SDT) algorithm <a class='info' href='#I-D.malas-performance-metrics'>SDT<span> (</span><span class='info'>Malas, D., &ldquo;SIP End-to-End Performance Metrics,&rdquo; December&nbsp;2007.</span><span>)</span></a> [I&#8209;D.malas&#8209;performance&#8209;metrics] simply compares the
        given callers previous session duration time with the expected session
        duration time over all destinations.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  INVITE sip:bob@example.net SIP/2.0
  Via: SIP/2.0/UDP sip.example.net;branch=z9hG4bKnashds8
    ;received=192.0.2.1
  Spam-Score: 75 by sip.example.net
    ;detail="SIPfilter-1.0;call_volume=75"
    ;spam-algorithm="SDT"
    ;spam-score-strength=50
    ;spam-info="High call volume"
    ;spam-isSpam
  Via: SIP/2.0/UDP sip.example.com;branch=z9hG4bKfjzc
    ;received=192.0.2.127
  Max-Forwards: 70
  To: Bob &lt;sip:bob@example.net&gt;
  From: Alice &lt;sip:alice@example.com&gt;;tag=1928301774
  Call-ID: a84b4c76e66710@pc33.example.com
  CSeq: 314159 INVITE
  Contact: &lt;sip:alice@pc33.example.com&gt;
  Content-Type: application/sdp
  Content-Length: 142

  [... SDP elided from this example...]
</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Example with spam scores&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="security_considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>SIP proxies and SIP user agents need to ignore spam scores generated
      by proxies that aren't trusted. As the spam scores are inserted along
      with Via: headers, the last Via header inserted by a trusted proxy
      indicates the last trusted spam score.
</p>
<p>In addition, the entire issue of securing the channel between the
      upstream and downstream domains MUST be addressed via mechanisms such as
      TLS.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgements</h3>

<p>Thanks to Joachim Charzinski, Daniel Quinlan, and S. Moonesamy for
      their suggestions to improve this document. Thanks to David Schwartz for
      his contributed text and to Eli Katz for editing assistance.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
IANA Considerations</h3>

<p>[[This section will be completed in a later version of this
      document.]]
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informational References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC5039">[RFC5039]</a></td>
<td class="author-text">Rosenberg, J. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc5039">The Session Initiation Protocol (SIP) and Spam</a>,&rdquo; RFC&nbsp;5039, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5039.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.tschofenig-sipping-framework-spit-reduction">[I-D.tschofenig-sipping-framework-spit-reduction]</a></td>
<td class="author-text">Tschofenig, H., Schulzrinne, H., Wing, D., Rosenberg, J., and D. Schwartz, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-tschofenig-sipping-framework-spit-reduction-04.txt">A Framework to tackle Spam and Unwanted Communication for Internet  Telephony</a>,&rdquo; draft-tschofenig-sipping-framework-spit-reduction-04 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-tschofenig-sipping-framework-spit-reduction-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.malas-performance-metrics">[I-D.malas-performance-metrics]</a></td>
<td class="author-text">Malas, D., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-malas-performance-metrics-08.txt">SIP End-to-End Performance Metrics</a>,&rdquo; draft-malas-performance-metrics-08 (work in progress), December&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-malas-performance-metrics-08.txt">TXT</a>).</td></tr>
</table>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Changes</h3>

<p>Note to RFC Editor: please remove this section prior to
      publication.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Changes from -00 to -01</h3>

<p></p>
<ul class="text">
<li>Changed scoring from positive/negative to 0-100 range.
</li>
<li>Moved score from a "Via:" extension to a new header
            "Spam-Score:".
</li>
<li>Changed from Standards Track to Experimental.
</li>
</ul>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Changes from -01 to -02</h3>

<p></p>
<ul class="text">
<li>Describe how spam score could be computed
</li>
<li>Added more descripive text describing how the header is passed
            downstream towards the user agent
</li>
</ul>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dan Wing</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 West Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dwing@cisco.com">dwing@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Saverio Niccolini</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Network Laboratories, NEC Europe
      Ltd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kurfuersten-Anlage 36</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Heidelberg  69115</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 (0) 6221 4342 118</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:saverio.niccolini@netlab.nec.de">saverio.niccolini@netlab.nec.de</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.netlab.nec.de">http://www.netlab.nec.de</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Martin Stiemerling</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Network Laboratories, NEC Europe
      Ltd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kurfuersten-Anlage 36</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Heidelberg  69115</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 (0) 6221 4342 113</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:stiemerling@netlab.nec.de">stiemerling@netlab.nec.de</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.netlab.nec.de">http://www.netlab.nec.de</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@nsn.com">Hannes.Tschofenig@nsn.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.com">http://www.tschofenig.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
<h3>Acknowledgment</h3>
<p class='copyright'>
This document was produced
using xml2rfc&nbsp;v1.35 (of <a href='http://xml.resource.org/'>http://xml.resource.org/</a>)
from a source in RFC-2629 XML format.</p>
</body></html>
