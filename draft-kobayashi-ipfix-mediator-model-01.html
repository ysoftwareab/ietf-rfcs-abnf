<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Reference Model for IPFIX Mediators</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Reference Model for IPFIX Mediators">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">IPFIX Working Group</td><td class="header">A. Kobayashi</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">K. Ishibashi</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">T. Kondoh</td></tr>
<tr><td class="header">Expires: May 22, 2008</td><td class="header">NTT PF Lab.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">D. Matsubara</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Hitachi</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">November 19, 2007</td></tr>
</table></td></tr></table>
<h1><br />Reference Model for IPFIX Mediators<br />draft-kobayashi-ipfix-mediator-model-01.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 22, 2008.</p>

<h3>Abstract</h3>

<p>
An IPFIX Mediator is an intermediate device between IPFIX Exporting Processes and IPFIX Collecting Processes. IPFIX Mediators act as an IPFIX Proxy, IPFIX Firewall, and IPFIX concentrator. IPFIX Mediators mediate IPFIX protocol using several functions. That enables the flow-based measurement system to become a high-capacity system and accommodate a variety of monitoring methods. This document describes each function that is provided by IPFIX Mediators and the method of handling the Flow Records of each function. In addition, this document describes a model of an applicable scenario using IPFIX Mediators.

</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
Framework for IPFIX Mediators<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Internal Components Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.1.1.</a>&nbsp;
Collecting Process<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.1.2.</a>&nbsp;
Metering Process<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.1.3.</a>&nbsp;
Exporting Process<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.1.4.</a>&nbsp;
Storing Process<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.2.</a>&nbsp;
IPFIX Protocol Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.2.1.</a>&nbsp;
Export Time Issue<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.2.2.</a>&nbsp;
Observation Domain ID Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">3.2.3.</a>&nbsp;
Template Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">3.2.4.</a>&nbsp;
Transport Session Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">3.2.5.</a>&nbsp;
Option Template Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">3.2.6.</a>&nbsp;
Reporting of Exporter Information<br />
<a href="#anchor19">4.</a>&nbsp;
Solution Scenarios with IPFIX Mediators<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">4.1.</a>&nbsp;
Flexible Aggregation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">4.2.</a>&nbsp;
Distributed Aggregation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.3.</a>&nbsp;
Duplication of Flow Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.4.</a>&nbsp;
Distribution of Flow Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">4.5.</a>&nbsp;
Extraction of Suspicious Flow<br />
<a href="#anchor25">5.</a>&nbsp;
Mediator Option Template Presentation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">5.1.</a>&nbsp;
Exporter Information Option Template<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">5.2.</a>&nbsp;
Usage of Scope Field<br />
<a href="#anchor28">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor29">7.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Several problems regarding flow-based measurement systems have occurred in several networks, as follows. In particular, problems in large-scale networks and integrated networks are described in detail in <a class='info' href='#I-D.kobayashi-ipfix-large-ps'>[I&#8209;D.kobayashi&#8209;ipfix&#8209;large&#8209;ps]<span> (</span><span class='info'>Kobayashi, A., Nishida, H., Sommer, C., Dressler, F., and E. Stephan, &ldquo;Problems with Flow Collection in Large-Scale Networks,&rdquo; October&nbsp;2007.</span><span>)</span></a>. 

</p>
<ul class="text">
<li>Scalability of Collector in large-scale networks<br />
<br />

As sizes of networks become larger, the number of Flow Records becomes greater. Large numbers of Flow Records have been burdening management networks and the Collecting Process. Maintaining scalability is difficult as a network grows. Generally, network operators need to monitor overall wide-scale traffic behavior and investigate detailed traffic information when traffic incidents happen. Meeting these requirements seems to be difficult for a single Collector device because of large numbers of Flow Records.
</li>
<li>Flow-based measurement in integrated networks<br />
<br />

On the other hand, networks such as IPv4, IPv6, and VPN on MPLS have recently become more integrated. These sorts of traffic need to be analyzed separately from a different perspective. However, handling them separately without improving the capability of the Collector is difficult. 

</li>
<li>Exchanging traffic information between different networks<br />
<br />

Exchanging traffic information is considered to be necessary for network providers as well as each customer. To that end, the network provider needs to export specified Flow Records while avoiding privacy violations. In addition, exchanging traffic information between associated networks could be necessary when traffic incidents happen. In that case, Flow Records should be checked according to the network operator's policy before exporting. Therefore, Flow Records exported from an Exporter directly without modification can not be fed to each customer or associated network operators without modification.

</li>
</ul><p>
IPFIX Mediators enable network operators to overcome these problems by preprocessing Flow Records. By defining IPFIX Mediators, network operators can take increasing advantage of an extensive template format, and handle Flow Records in accordance with their preference.  This document describes a model of applicable scenarios by using IPFIX Mediator and its key component.

</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL","SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The definitions of basic IPFIX and PSAMP terms are identical with those in <a class='info' href='#I-D.ietf-psamp-framework'>[I&#8209;D.ietf&#8209;psamp&#8209;framework]<span> (</span><span class='info'>Duffield, N., &ldquo;A Framework for Packet Selection and Reporting,&rdquo; June&nbsp;2007.</span><span>)</span></a>, <a class='info' href='#RFC3917'>[RFC3917]<span> (</span><span class='info'>Quittek, J., Zseby, T., Claise, B., and S. Zander, &ldquo;Requirements for IP Flow Information Export(IPFIX),&rdquo; October&nbsp;2004.</span><span>)</span></a>, <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;IPFIX Protocol Specification,&rdquo; September&nbsp;2007.</span><span>)</span></a>, <a class='info' href='#I-D.ietf-ipfix-info'>[I&#8209;D.ietf&#8209;ipfix&#8209;info]<span> (</span><span class='info'>Quittek, J., Bryant, S., Claise, B., and J. Meyer, &ldquo;Information Model for IP Flow Information Export,&rdquo; February&nbsp;2007.</span><span>)</span></a>, and <a class='info' href='#I-D.ietf-ipfix-architecture'>[I&#8209;D.ietf&#8209;ipfix&#8209;architecture]<span> (</span><span class='info'>Sadasivan, G., Brownlee, N., Claise, B., and J. Quittek, &ldquo;Architecture for IP Flow Information Export,&rdquo; September&nbsp;2006.</span><span>)</span></a>. Other than the above terminology, the following terminology related to IPFIX Mediator is used in this document. Therefore, terms defined in the IPFIX terminology are capitalized in this document.

</p>
<blockquote class="text"><dl>
<dt>IPFIX Mediator</dt>
<dd><br />
 
An IPFIX Mediator hosts at least one Exporting Process and one Collecting Process. IPFIX Mediator is a generic name of several devices, such as an IPFIX Proxy, an IPFIX Firewall, an IPFIX Distributor, and an IPFIX concentrator. 

</dd>
<dt>Original Exporter</dt>
<dd><br />
 
An Original Exporter hosts Observation Points where IP packets can be observed.

</dd>
<dt>IPFIX Proxy</dt>
<dd><br />
 
An IPFIX Proxy acts as a proxy for Original Exporters, which host Observation Points.
An IPFIX Proxy may receive Flow Records from one or several Exporting Processes, and send them to one or several Collecting Processes. An IPFIX Proxy does not send information about an Original Exporter, such as "exporterIPv{4|6}Address", to the Collector to act as an Original Exporter.

</dd>
<dt>IPFIX Distributor</dt>
<dd><br />
 
An IPFIX Distributor replicates Flow Records and forwards them to multiple Collectors. In addition, an IPFIX Distributor classifies Flow Records and forwards the classified Flow Records to dedicated Collectors. An IPFIX Distributor does not change the value or template of Data Records.

</dd>
<dt>IPFIX Firewall</dt>
<dd><br />
 
An IPFIX Firewall exports Flow Records to a different network domain at the edge of a network domain. From a Collector's point of view, an IPFIX Firewall acts as an Original Exporter, just like an IPFIX Proxy. In addition, an IPFIX Firewall reviews whether received Flow Records are passed forward to a Collector to hide the network topology or privacy information. An IPFIX Firewall has at least one function of filtering, modifying, and anonymizing functions.

</dd>
<dt>Metering Process</dt>
<dd><br />

The Metering Process in IPFIX Mediators can be considered as a partial Metering Process separated from the Metering Process in the Original Exporter. The Metering Process in IPFIX Mediators consists of a set of subprocesses that include the Selecting Process, Aggregating Process, and Modifying Process. The Metering Process generates the final Flow Records that should be exported.

</dd>
<dt>Selecting Process</dt>
<dd><br />
 
The Selecting Process in an IPFIX Mediator is similar to that of PSAMP Devices, which is described in <a class='info' href='#I-D.ietf-psamp-framework'>[I&#8209;D.ietf&#8209;psamp&#8209;framework]<span> (</span><span class='info'>Duffield, N., &ldquo;A Framework for Packet Selection and Reporting,&rdquo; June&nbsp;2007.</span><span>)</span></a>. However, the Selecting Process in an IPFIX Mediator only has field-match filtering functions. This filtering function blocks Flow Records based on the values of specified Information Elements to forward them to the next process. The Selecting Process is one of the subprocesses in the Metering Process.

</dd>
<dt>Aggregating Process</dt>
<dd><br />

The Aggregating Process creates aggregated Flow Records from input Flow Records in accordance with aggregation rules that are described in <a class='info' href='#I-D.dressler-ipfix-aggregation'>[I&#8209;D.dressler&#8209;ipfix&#8209;aggregation]<span> (</span><span class='info'>Dressler, F., Sommer, C., and G. Munz, &ldquo;IPFIX Aggregation,&rdquo; June&nbsp;2006.</span><span>)</span></a>. The Aggregating Process is one of the subprocesses in the Metering Process.

</dd>
<dt>Modifying Process</dt>
<dd><br />

The Modifying Process carries out two different kinds of modification, as follows.


<blockquote class="text"><dl>
<dt></dt>
<dd>
The Modifying Process changes the Template and record structure by adding/deleting specific Information Elements. For example, the Modifying Process adds Information Elements like derived packet properties that cannot be extracted in the Original Exporters. Information Elements related to derived packet properties are described in <a class='info' href='#I-D.ietf-ipfix-info'>[I&#8209;D.ietf&#8209;ipfix&#8209;info]<span> (</span><span class='info'>Quittek, J., Bryant, S., Claise, B., and J. Meyer, &ldquo;Information Model for IP Flow Information Export,&rdquo; February&nbsp;2007.</span><span>)</span></a>. 

</dd>
<dt></dt>
<dd>The Modifying Process changes the value of the specific Information Elements. For example, the values of specific Information Elements are anonymized to avoid violating privacy. 

</dd>
</dl></blockquote>

The Modifying Process is a key part of a IPFIX Firewall. The Modifying Process is one of the subprocesses in the Metering Process. 

</dd>
<dt>Storing Process</dt>
<dd><br />

The Storing Process stores the input Flow Records from any process in a storage system such as a database or flat-file system. Stored data may be retrieved from the Storing Process in different ways, which are outside the scope of this document.

</dd>
<dt>Distributing Function</dt>
<dd><br />

The Distributing Function classifies input Flow Records based on the value of specified Information Elements. The classified Flow Records are exported to the specified Collectors. The Distributing Function is carried out by the Exporting Process.

</dd>
<dt>Observation Domain ID</dt>
<dd><br />

An IPFIX Mediator does not host the Observation Points and Observation Domain. The Observation Domain ID in the IPFIX header sent by IPFIX Mediator also indicates the largest set of Observation Points in the Original Exporter, but this value does not indicate the physical entity of the Original Exporter. If an IPFIX Mediator handles one Collecting session and one Exporting session, the IPFIX Mediator does not need to change the value of the Observation Domain ID. If an IPFIX Mediator handles multiple sessions on the collecting and exporting side, the IPFIX Mediator needs to assign a new value.

</dd>
<dt>Transport Session Information</dt>
<dd><br />

In SCTP, the Transport Session Information is the SCTP association. In TCP and UDP, the Transport Session Information corresponds to a 5-tuple {exporter IP address, collector IP address, exporter transport port, collector transport port, transport protocol}. In IPFIX Mediator, the Collecting Process manages this information.

</dd>
</dl></blockquote><p>

</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Framework for IPFIX Mediators</h3>

<p>
An IPFIX Mediator is located between one or more Exporting Processes and one or more Collecting Processes. An IPFIX Mediator acts as a Collector by receiving Flow Records, and it acts as an Exporter by sending Flow Records. This dual-role architecture enables cascading IPFIX Mediators and building a combination of several solutions.<br />
<br />

The internal model of an IPFIX Mediator is composed of Collecting Processes, Metering Processes, Storing Processes, and Exporting Processes. An IPFIX Mediator may optionally have Metering Processes and Storing Processes. Basically, the allocation of these Processes depends on the role of devices, such as IPFIX Proxy, IPFIX Firewall, IPFIX Distributor, and IPFIX concentrator. "IPFIX Mediator" is a generic term for these devices. Basically, IPFIX Mediators have two types of mediation functions, as follows.

</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>IPFIX Protocol Mediation<br />

An IPFIX Mediator forwards input Flow Records to upstream Collectors. An IPFIX Mediator does not change the set of Flow Records nor the value or Template of Flow Records. This function applies to an IPFIX Proxy and IPFIX Distributor.

</dd>
<dt></dt>
<dd>Flow Mediation<br />

An IPFIX Mediator creates a new set of Flow Records from input Flow records. A Flow Mediation indicates Flow aggregation, selection, and modification. A Flow modification indicates two different kinds of modifications. One is changing the value of specified Information Elements. The second is changing the Template and record structure by adding/deleting specified Information Elements. This function applies to IPFIX Firewall and IPFIX concentrator.

</dd>
</dl></blockquote><p>
Surely, the composite of these functions can be considered in many ways as one of the devices of IPFIX Mediators.

</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Internal Components Model</h3>

<p>
The following figure indicates four components (Collecting Process, Metering Process, Exporting Process, and Storing Process) within the IPFIX Mediator that are referred to in <a class='info' href='#RFC3917'>[RFC3917]<span> (</span><span class='info'>Quittek, J., Zseby, T., Claise, B., and S. Zander, &ldquo;Requirements for IP Flow Information Export(IPFIX),&rdquo; October&nbsp;2004.</span><span>)</span></a>. The Metering Process can have one or multiple subprocesses. These subprocesses are the Selecting Process, Aggregating Process, and Modifying Process that can be connected to each other in any sequence defined by the user. The Metering Process and Storing Process are options.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  +--------------------------------------------------------------+
  |                        IPFIX Mediator                        |
  | .----------.                                     .---------. |
  | |          |  .-------------------------------.  |         | |
  | |Collecting|  |        Metering Process       |  |Exporting| |
  | |Process   |  |.-------.  .-------.  .-------.|  |Process  | |
  | |          |---&gt;sub    |--&gt;sub    |-&gt;|sub    |--&gt;|         | |
IPFIX          |  ||process|  |process|  |process||  |         IPFIX
--&gt; |          |.-&gt;|#1     |  |#2     |  |#3     ||  |         |--&gt;
  | |          || |'-------'  '-------'  '-------'|  |         | |
  | |          || '----|----------|----------|----'  |         | |
  | |          ||      |          |          |       |         | |
  | |          ||   .--\/---------\/---------\/--.   |         | |
  | |          |'---|       Storing Process      |&lt;--|         | |
  | |          |---&gt;|                            |--&gt;|         | |
  | |          |    '----------------------------'   |         | |
  | |          |------------------------------------&gt;|         | |
  | '----------'                                     '---------' |
  +--------------------------------------------------------------+


Figure A: Key components within IPFIX Mediator.
</pre></div>
<p>
Each process is associated with a common identifier in the IPFIX Mediator. This method is similar to PSAMP associations in <a class='info' href='#I-D.ietf-psamp-sample-tech'>[I&#8209;D.ietf&#8209;psamp&#8209;sample&#8209;tech]<span> (</span><span class='info'>Zseby, T., Molina, M., Duffield, N., Niccolini, S., and F. Raspall, &ldquo;Sampling and Filtering Techniques for IP Packet Selection,&rdquo; June&nbsp;2007.</span><span>)</span></a>.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Collecting Process</h3>

<p>The Collecting Process receives Flow Records from the previous Exporter. An instance of the process is created according to the IPFIX session. Functions of the process are described in <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;IPFIX Protocol Specification,&rdquo; September&nbsp;2007.</span><span>)</span></a>. The process also forwards received Flow Records with IPFIX header information and Transport Session Information to multiple Metering Processes or Storing Processes. In other words, Flow Records can be duplicated by forwarding multiple Metering Processes or Exporting Processes. In addition, the process can directly forward Flow Records to the Exporting Process.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Metering Process</h3>

<p>The Metering Process generates a new set of Flow Records from input Flow Records with received IPFIX header information, such as "Export Time" and "Observation Domain ID". The process hosts several subprocesses. The processing order of these functions, which could be configured by user definitions would create a different set of Flow Records.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.1"></a><h3>3.1.2.1.&nbsp;
Selecting Process</h3>

<p>The Selecting Process decides whether a Flow Record passes through to the next process. The process has a filtering function and selects Flow Records that are matched under given conditions. Prior to receiving Flow Records, the user configures a filter pattern  in Selecting Process, which specifies how the Flow Records are treated by the process. If the values of some Information Elements in the Flow Record match the filter pattern, this process selects Flow Records with all fields and forwards these Flow Records to the next process. For example, the process selects Flow Records that are included in the specified destination IP address.

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.2"></a><h3>3.1.2.2.&nbsp;
Aggregating Process</h3>

<p>The Aggregating Process gathers Flow Records within a given time interval and then distinguishes Flow Records that have common properties. If values of a given key field are the same, that means those Flow Records have common properties. This process merges Flow Records that have a common property and creates an aggregated Flow Record. Therefore, for example, aggregated Flow Records have an aggregation counter that indicates the number of packets. These functions are defined in accordance with the IPFIX aggregation rule in <a class='info' href='#I-D.dressler-ipfix-aggregation'>[I&#8209;D.dressler&#8209;ipfix&#8209;aggregation]<span> (</span><span class='info'>Dressler, F., Sommer, C., and G. Munz, &ldquo;IPFIX Aggregation,&rdquo; June&nbsp;2006.</span><span>)</span></a>. 

</p>
<p>The process has aggregation rule defined by the user prior to receiving Flow Records. The process indicates Information Elements that should become aggregated flow keys and other Information Elements that should be kept or discarded. In addition, these instruction rules include Information Elements that should be added to aggregated Flow Records.  Aggregated Flow Records may need to complement information that is discarded during the Aggregating Process. They help the Collector to analyze aggregated Flow Records. For example, these Information Elements correspond to "averageActiveTime", "synCount", and "flowCount" elements, as follows.

</p>
<p>
</p>
<ul class="text">
<li>averageActiveTime<br />
<br />

This Information Element indicates the average active time of an input Flow Record in the aggregated Flow Records. This Information Element is created from flow time stamp Information Elements. There are "flowStartSeconds", "flowEndSeconds", "flowStartMilliSeconds", "flowEndMilliSeconds", "flowStartSysUpTime", and "flowEndSysUpTime". Moreover, "minimumActiveTime" and "maxmumActiveTime" might be considered in addition to the element.

</li>
<li>synCount<br />
<br />

This Information Element indicates the number of input Flow Records that have "tcpControlBits", which the SYN bit sets to 1 in an aggregated Flow Record. Using this element, Collector can determine the number of SYN packets throughout the network. Moreover, "ackCount", "finCount", "pshCount", "urgCount", and "rstCount" might be considered in addition to this element.

</li>
<li>flowCount<br />
<br />

This Information Element  is the number of input Flow Records included in an aggregated Flow Record.

</li>
</ul><p>

</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2.3"></a><h3>3.1.2.3.&nbsp;
Modifying Process</h3>

<p>The Modifying Process modifies the input Flow Records. The process can add new Information Elements, delete included Information Elements, or modify the value of included Information Elements, as follows. If this process modifies the original template, it SHOULD revise the received "flowKeyIndicator".

</p>
<blockquote class="text"><dl>
<dt>Adding new Information Elements</dt>
<dd><br />
 
This function adds specified Information Elements into the input Flow Records. The values of Information Elements are extracted by searching some database based on the input value of other specified Information Elements. The added Information Elements and used Information Elements are configured according to instructions by the user to obtain the value. The method to obtain a value from some Information Elements is outside the scope of this document.<br />
<br />


This function, instead of the Original Exporter, adds a derived packet property parameter, which is useful for the traffic-monitoring technique. Doing that can compensate for the inability of some Exporters to add a derived packet property parameter. Therefore, the Collector does not need to recognize the difference between implementations of routers from several vendors. For example, the addition of "bgpNextHop{IPv4|IPv6}Address" and "bgpCommunity" Information Elements is useful for making a traffic matrix that covers the whole network domain. "bgpNextHop{IPv4|IPv6}Address" can indicate the egress router of some network domain. In addition, "bgpCommunity" can indicate the same group of destination or source IP addresses. This value can be given by looking for the BGP route database based on the destination or source IP address. In addition, "mplsVpnRouteDistinguisher", which cannot be extracted from the core router in MPLS networks, indicates the customer's identification. Network Operators can monitor the traffic behavior of each customer by adding "mplsVpnRouteDistinguisher" to the Flow Records. This value can be given by looking for the BGP route database based on the "mplsTopLabelStackSection" and "mplsTopLabel{IPv4|IPv6}Address".

</dd>
<dt>Deleting Information Elements</dt>
<dd><br />
 
This function deletes specified Information Elements according to instructions that are configured by the user, which indicate whether an Information Element should be removed. Hiding network topology information and private information by using this function is possible.<br />
<br />

In the case of exchanging Flow Records with different network domains or customers, this function can avoid making a vulnerability by deleting unnecessary Information Elements. By deleting unnecessary Information Elements, this function can hide the network topology and another customer's information. In particular, "ipNextHopIP{v4|v6}Address", "bgpNextHopIP{v4|v6}Address", and "bgp{Next|Prev}AdjacentAsNumber" correspond to network topology information. In addition, MPLS-related Information Elements, such as "mplsLabelStackSection", that are useless for customers might be removed in the case of feeding Flow Records to VPN customers.

</dd>
<dt>Modifying the value of Information Elements</dt>
<dd><br />

This function modifies the value of specified Information Elements according to instructions configured by the user. <br />
<br />

For example, this function enables IPFIX Mediator to overwrite private information with zeros or the maximum value. In particular, IP address and port number is sensitive private information. In the case of monitoring traffic trends and traffic engineering, these Information Elements are not essential factors for those purposes. In that case, this function anonymizes the relevant Information Elements to prevent a violation of privacy. If modification can anonymize some Information Elements, the function might need to report which Information Elements are anonymized. For example, "anonymizationIndicator" indicates which Information Elements have been anonymized as a bitmap, just like the "flowKeyIndicator". The anonymization method is outside the scope of this document.

</dd>
</dl></blockquote><p>

</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
Exporting Process</h3>

<p>The Exporting Process forwards Flow Records to the next Collector. The process manages the reporting Template and makes an IPFIX datagram. 
</p>
<p>In addition, the process carries out the Distributing Function as an option. If this function is enabled, the process classifies Flow Records based on the value of specified Information Elements and then exports each classified Flow Record to the appropriate Collector.

</p>
<p>
For example, the Exporting Process classifies Flow Records on the basis of the peering AS, as shown in the following figure. The set of classified Flow Records is exported to a dedicated Collector on the basis of the Peering AS.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    +-------------------------------------------+
    | IPFIX Mediator               .----------. |
    |                              |Exporting | |
    |                              |Process   | |
    |   .----------.  .---------.  |          | | PeerAS#100
Flow --&gt;|Collecting|-&gt;|Metering |-----&gt;/------------&gt; Collector#A
Records |Process   |  |Process  |  |   |      | | PeerAS#200
    |   '----------'  '---------'  |   /------------&gt; Collector#B
    |                              |   |      | | PeerAS#300
    |                              |   /------------&gt; Collector#C
    |                              |   |      | | PeerAS#400
    |                              |   /------------&gt; Collector#D
    |                              |          | |
    |                              '----------' |
    +-------------------------------------------+

Figure B: Exporting each classified Flow Record to dedicated Collector.
</pre></div>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.4"></a><h3>3.1.4.&nbsp;
Storing Process</h3>

<p>
The Storing Process stores the input Flow Records from any Processes in a storage system, such as a database or flat-file system. If the storing record structure that user wants is different from the template of input Flow Records, this process selects specified Information Elements from the input Flow Records using the instruction rules. Instruction rules configured by user indicate whether the Information Elements should be stored by using a field modifier. The field modifier that indicates "keep" or "discard" is applied to Information Elements within Flow Record and IPFIX header, such as "Observation Domain ID" and "Export time". This header information MAY be used when IPFIX datagrams are made of past Flow Records. That procedure is similar to the instruction of the Aggregating Process.

</p>
<p>
When another device retrieves past Flow Records on the basis of a time period given by a user, the retrieving method can be considered in many ways. One solution is that another device gets a specified flat file from a Mediator and decodes that flat file by itself. Other solutions are that another device sends out a query command to the IPFIX Mediator through XML-RPC, SNMP, or NETCONF, and then, the IPFIX Mediator exports the specified past Flow Records. This method is outside the scope of this document.

</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
IPFIX Protocol Considerations</h3>

<p>
This section describes IPFIX Protocol considerations with regard to IPFIX Mediator.

</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Export Time Issue</h3>

<p>
If the Exporting Process writes the "Export Time" of the IPFIX message when an IPFIX message leaves, an IPFIX Mediator needs to compensate for any delta time, which is the difference from "Export Time" of Information Elements contained in each Flow Record by performing calculations. An IPFIX Proxy MUST reuse the "Export Time" of received IPFIX messages from the Original Exporter.

</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
Observation Domain ID Management</h3>

<p>
The Observation Domain ID is locally unique to the Exporting Process in IPFIX Mediator. To comply with the IPFIX Protocol, the Observation Domain ID value is RECOMMENDED to be assigned a unique value per IPFIX Mediator. If an IPFIX Mediator relays an IPFIX datagram from a transport session to a transport session, IPFIX Mediator does not need to overwrite the Observation Domain ID with another value. If an IPFIX Mediator relays an IPFIX datagram from multiple transport sessions to a single transport session, IPFIX Mediator needs to overwrite the Observation Domain ID. In that case, IPFIX Mediator assigns the Observation Domain ID based on received Transport Session Information and the original Observation Domain ID. The renewed Observation Domain ID SHOULD be managed using the received Transport Session Information and original Observation Domain ID. This linkage information is available for overwriting the scope field of the Option Template.<br />
<br />


Note<br />

If the Metering Process aggregates input Flow Records, the value of the Observation Domain ID should be 0 to comply with the description in <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;IPFIX Protocol Specification,&rdquo; September&nbsp;2007.</span><span>)</span></a>.

</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.3"></a><h3>3.2.3.&nbsp;
Template Management</h3>

<p>The Template ID of a generated Template SHOULD be unique on the basis of the Observation Domain ID assigned by an IPFIX Mediator. The Template ID needs to be unique on the basis of IPFIX Mediator when the Observation Domain ID is 0. If the IPFIX Mediator overwrites the received Template ID to relay a received Template or modified Template, the renewed Template ID SHOULD be managed using received Transport Session Information and the received Observation Domain ID. This linkage information is available for overwriting the scope field of an Option Template and Template handling. If IPFIX Mediator receives a "Template Withdraw Message", it SHOULD modify this message to indicate relevant Templates, and send a "Template Withdraw Message". 
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.4"></a><h3>3.2.4.&nbsp;
Transport Session Management</h3>

<p>Each session of the Collecting Process and Exporting Process should operate independently. Even if one session is reset, the status of the other session is kept current. However, Templates for resetting the Collecting Session SHOULD be withdrawn for the Exporting Session.

</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.5"></a><h3>3.2.5.&nbsp;
Option Template Management</h3>

<p>IPFIX Mediator MUST check whether the scope field is applicable, if Data Records associated with Option Templates are exported. If an IPFIX Mediator rewrites the Observation Domain ID or Template ID, these values included in scope fields SHOULD be rewritten before exporting. Instead of exporting Option Template Records and associated Data Records, Information Elements, such as sampling rate or sampling method, exported using the Option template Record from the Original Exporter could be merged in a Flow Record in an IPFIX Mediator. In that case, IPFIX Mediator MUST modify the relevant Template Record. Several sorts of received Statistics Option Template Records and associated Data Records could be exported in different ways as other Templates. In IPFIX Mediator, the Data Record associated by Statistics Option Template Records can be exported after merging its counter. In addition, Statistics Option Template Records and associated Data Records can be exported by indicating the source of the statistics data as a scope field instead of merging the counter. This method is described in Section 5. The user policy determines whether IPFIX Mediator and the above methods should export Option Templates Records and associated Data Records.

</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.6"></a><h3>3.2.6.&nbsp;
Reporting of Exporter Information</h3>

<p>
If IPFIX Mediator acts as an IPFIX Firewall or IPFIX Proxy, reporting the Original Exporter IP address increases the vulnerability. On the other hand, if IPFIX Mediator acts as other devices, such as IPFIX concentrator, the Exporter IP address is important information for traffic analysis such as traffic engineering. In the case of making a traffic matrix, the Exporter IP address can indicate the ingress router of a network domain. Therefore, reporting of Exporter Information, such as Exporter IP address, is useful to identify the Original Exporter. There are various methods as follows.<br />
<br />


 An IPFIX Mediator can directly merge Exporter Information into Flow Records or use Option Templates described in Section 5. If an IPFIX Mediator receives Information Elements related to the Exporter information, IPFIX Mediator SHOULD NOT rewrite its own previous Exporter information. The IPFIX Mediator can append its own previous Exporter Information instead of rewriting. In the Collecting Process, the order of the Exporter information indicates the Original Exporter and the route of IPFIX Mediator. These methods defined by user policy determine whether IPFIX Mediator should report Exporter Information.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Solution Scenarios with IPFIX Mediators</h3>

<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Flexible Aggregation</h3>

<p>An IPFIX Mediator can aggregate Flow Records in the same manner as that of IPFIX concentrator and reduce the number of Flow Records received by a Collector.
</p>
<p>
The following figure indicates a cascade connection of IPFIX Mediators. If a Collector measures a traffic matrix to obtain traffic demand, the Collector needs Flow Records of the whole network domain, but does not need detailed Flow Records. In the first step, a first level Mediator receives Flow Records from IPFIX Devices and then creates aggregated low-level Flow Records. For example, this step is prefix mask aggregation. Next, a second level Mediator receives aggregated Flow Records and aggregates them further. For example, the second step is the aggregation of the BGP next-hop address and exporter address. After this, the Collector receives high-level aggregated Flow Records and then stores them. This method enables step-by-step aggregation of Flow Records without overloading a single node.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
.--------.     .--------.
|IPFIX   |     |IPFIX   |
|router#1|----&gt;|Mediator|---.
|        |     |*1      |   |
'--------'     '--------'   |    .--------.     .---------.
                            '---&gt;|IPFIX   |     |Traffic  |
.--------.     .--------.   .---&gt;|Mediator|----&gt;|Collector|
|IPFIX   |     |IPFIX   |   |    |*2      |     |         |
|router#2|----&gt;|Mediator|---'    '--------'     '---------'
|        |     |*1      |
'--------'     '--------'

Figure C: Flexible Aggregation with cascading IPFIX Mediators.
</pre></div>
<p>

</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Distributed Aggregation</h3>

<p>When the network is used globally, the distances between PoPs become longer, and the maintenance of a dedicated management network is very expensive. Therefore, the huge number of Flow Records has burdened management networks of global ISPs. If network operators place Mediators at each PoP, the number of Flow Records exported from each PoP can be reduced. Mediators can minimize the number of Flow Records exported to the Collector. If the Collector needs detailed information, it can retrieve Flow Records from Mediators that store original Flow Records.
</p>
<p>
A management network of a global ISP is shown in the following figure. The Mediators are located at each PoP of the network, and they collect Flow Records from routers in each PoP domain. The Mediator reduces the number of Flow Records by aggregating or filtering, so this system reduces the load of a management network.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
             POP#Asia
     .--------.
   .--------. |      .---------.
 .--------. | |-----&gt;|IPFIX    |
 |IPFIX   | |-------&gt;|Mediator |----.
 |router  |---'-----&gt;|#1       |    |
 |#1      |-'        '---------'    |
 '--------'                         |
                                    |
             POP#America            |
     .--------.                     |
   .--------. |      .---------.    |     .---------.
 .--------. | |-----&gt;|IPFIX    |    '----&gt;|Traffic  |
 |IPFIX   | |-------&gt;|Mediator |---------&gt;|Collector|
 |router  |---'-----&gt;|#2       |    .----&gt;|         |
 |#4      |-'        '---------'    |     '---------'
 '--------'                         |
                                    |
             POP#Europe             |
     .--------.                     |
   .--------. |      .---------.    |
 .--------. | |-----&gt;|IPFIX    |    |
 |IPFIX   | |-------&gt;|Mediator |----'
 |router  |---'-----&gt;|#3       |
 |#7      |-'        '---------'
 '--------'

Figure D: Traffic monitoring architecture in global network.
</pre></div>
<p>

</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Duplication of Flow Records</h3>

<p>An IPFIX Mediator duplicates Flow Records to achieve redundant storage or utilizes them for several purposes. The pair of Collecting Process and Metering Process is similar to the pair of the Observation Point and Metering Process. The Collecting Process duplicates Flow Records by forwarding them to the multi-Metering Process.
</p>
<p>
Several departments in an ISP want to use the same traffic information for each intended purpose. The network design department measures the traffic matrix to obtain traffic demand. The customer service division uses traffic information for performing accounting services for each customer while network operators use traffic information for trouble shooting analysis. That situation is shown in the following figure. An IPFIX Mediator distributes Flow Records to several Collectors that have the appropriate aggregated granularity. In addition, when network operators conduct troubleshooting, past Flow Records from Mediators can be retrieved.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                      Measurement traffic matrix.
.--------.                               .---------.
|IPFIX   |                               |Traffic  |
|router#1|----.                    .----&gt;|Collector|
|        |    |                    |     |#1       |
'--------'    |                    |     '---------'
              |                    |  Using Accounting info.
.--------.    |     .---------.    |     .---------.
|IPFIX   |    '----&gt;|IPFIX    |----'     |Traffic  |
|router#2|---------&gt;|Mediator |---------&gt;|Collector|
|        |    .----&gt;|         |----.     |#2       |
'--------'    |     '---------'    |     '---------'
              |                    |  Using Trouble shooting.
.--------.    |                    |     .---------.
|IPFIX   |    |                    |     |Traffic  |
|router#3|----'                    '----&gt;|Collector|
|        |                               |#3       |
'--------'                               '---------'

Figure E: Duplication of Flow Records for several purposes.
</pre></div>
<p>

</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Distribution of Flow Records</h3>

<p>An IPFIX Mediator MAY distribute Flow Records based on the value of specified Information Elements. This function enables load balancing of Collector and sorting Flow Records without extra Collector functions. If Flow Records are used as accounting information, Mediator can distribute Flow Records to the dedicated Collector of each customer.

</p>
<p>
When network operators disclose traffic information to each customer, security or the privacy policy should be considered. In that case, the IPFIX Mediator hides private information about each customer. In addition, Mediator distributes traffic information based on RD (Route Distinguisher), ingress IF, peering AS number, or BGP next hop, which identify the customer. In the following figure, the IPFIX Mediator distributes Flow Records based on RD. The system securely allows each customer to access only their own records. 

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
.--------.                               .---------.
|IPFIX   |                               |Traffic  |
|router#1|----.                    .----&gt;|Collector|&lt;===&gt; Customer#A
|        |    |                    |     |#1       |
'--------'    |                    |     '---------'
              |                 RD=100:1
              |     .---------.    |
.--------.    '----&gt;|IPFIX    |----'     .---------.
|IPFIX   |          |Mediator | RD=100:2 |Traffic  |
|router#2|---------&gt;|         |---------&gt;|Collector|&lt;===&gt; Customer#B
|        |          |         |          |#2       |
'--------'    .----&gt;|         |----.     '---------'
              |     '---------'    |
              |                 RD=100:3
.--------.    |                    |     .---------.
|IPFIX   |    |                    |     |Traffic  |
|router#3|----'                    '----&gt;|Collector|&lt;===&gt; Customer#C
|        |                               |#3       |
'--------'                               '---------'

Figure F: Distribution of Flow Records for each customer.
</pre></div>
<p>

</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Extraction of Suspicious Flow</h3>

<p>An IPFIX Mediator performs filtering based on the value of specified Information Elements. Filter conditions are set depending on a suspicious flow as follows. The Collector receives the specified suspicious flow and detects an anomalous flow by simply monitoring the traffic volume of each suspicious flow.
<br />

</p>
<ul class="text">
<li>TCP Flow Records whose "tcpControlBits" value is set to "null"
</li>
<li>TCP Flow Records whose "tcpControlBits" value is set to the SYN bit only and the packet counter is only 1.
</li>
<li>ICMP Flow Records whose length is too long.
</li>
</ul><p>

</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Mediator Option Template Presentation</h3>

<p>This section describes Option Templates that are used by IPFIX Mediators.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Exporter Information Option Template</h3>

<p>Each IPFIX Mediator and final destination Collector needs to know the Original Exporter and route of IPFIX Mediators. Therefore, each IPFIX Mediator informs the next Collector about previous Exporter information, which is the Exporter Information Option Template that specified the Original Exporter and the route of the IPFIX Mediator. The final destination Collector can recognize them by receiving this template. This template is composed of the following Information Elements.
</p>
<ul class="text">
<li>exporter{IPv4|IPv6}Address
</li>
<li>collector{IPv4|IPv6}Address
</li>
<li>exporterTransportPort
</li>
<li>collectorTransportPort
</li>
<li>collectorTransportProtocol
</li>
<li>observationDomainId
</li>
</ul><p>
The Observation Domain ID of the Original Exporter or IPFIX Mediator is identified by specifying Exporter/Collector Information Elements, such as "collector{IPv4|IPv6}Address", "collectorTransportPort", "collectorTransportProtocol", "exporter{IPv4|IPv6}Address", "exporterTransportPort", and "observationDomainId". The set of "observationDomainId" and "templateId" or "observationDomainId" might be used as a scope field. Not all Information Elements are necessary. For example, the exporter{IPv4|IPv6}Address is necessary to inform the next Collector about the Original Exporter that created Flow Records. 
If the IPFIX Mediator receives this Template, it SHOULD not overwrite each field. The IPFIX Mediator appends its own previous Exporter information onto received Data Records specified by the Exporter Option Template and sends that information to the Collector. In this manner, the route is maintained until the final destination Collector.
</p>
<p>
The following example describes the cascade connection of IPFIX Mediators. Each Mediator informs the next Collector about previous Exporter information. 

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       Session#a            Session#b            Session#c
Router --------&gt; Mediator#1 --------&gt; Mediator#2 --------&gt;Collector
IP:10.1.1.1      IP:10.1.1.2          IP:10.1.1.3
SrcPort:6666     DstPort:4739         DstPort:4739
ODID:10          SrcPort:7777         SrcPort:8888
                 ODID:0               ODID:0

Figure G: Cascade connection of IPFIX Mediators.
</pre></div>
<p>Mediator#1 or Mediator#2 sends a Data Record specified by the Exporter Option Template. The Data records are shown in Session#b or Session#c, as follows.
</p>
<blockquote class="text"><dl>
<dt>Session#b Data Record:</dt>
<dd>
Field Count = 7<br />

Scope Count = 1<br />

templateId = XXX<br />

exporterIPv4Address = 10.1.1.1<br />

collectorIPv4Address = 10.1.1.2<br />

collectorTransportProtocol = 132<br />

exporterTransportPort = 6666<br />

collectorTransportPort = 4739<br />

observationDomainId = 10
</dd>
<dt>Session#c Data Record:</dt>
<dd>
Field Count = 13<br />

Scope Count = 1<br />

templateId = XXX<br />

exporterIPv4Address = 10.1.1.1<br />

collectorIPv4Address = 10.1.1.2<br />

collectorTransportProtocol = 132<br />

exporterTransportPort = 6666<br />

collectorTransportPort = 4739<br />

observationDomainId = 10<br />

exporterIPv4Address = 10.1.1.2<br />

collectorIPv4Address = 10.1.1.3<br />

collectorTransportProtocol = 132<br />

exporterTransportPort = 7777<br />

collectorTransportPort = 4739<br />

observationDomainId = 0
</dd>
</dl></blockquote><p>


</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Usage of Scope Field</h3>

<p>An IPFIX Mediator needs to send Options Template Records and associated Data Records from the Original Exporter. However, IPFIX Mediator cannot export original Option Template Records and associated Data Records without modification because changing a session from an Exporting Process to a Collecting Process causes the scope fields to have a useless values. When an IPFIX Mediator relays the Option Template Records that included Observation Domain ID as a scope field and associated Data Records, an IPFIX Mediator uses the Exporter Information Option Template. Option Template Records that were created from an Original Exporter can use all fields of the Exporter Information Option template as multiple scope fields. Option Template Records that were created from an IPFIX Mediator can use some fields of the Exporter Information Option Template as multiple scope fields. An IPFIX Mediator needs to modify associated Data Records according to the modified Options Template Record. However, if each node uses another field, except for the Observation Domain ID, as the scope, the scope field should be considered on a case-by-case basis.


<p>
The following example describes the cascade connection of IPFIX Mediators. Router#1 and Mediator#1 export the Metering Process Statistics Option Template. 

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

       Session#a            Session#b            Session#c
Router --------&gt; Mediator#1 --------&gt; Mediator#2 --------&gt;Collector
IP:10.1.1.1      IP:10.1.1.2         IP:10.1.1.3
SrcPort:6666     DstPort:4739        DstPort:4739
ODID:10          SrcPort:7777        SrcPort:8888
                 ODID:0              ODID:0

Figure H: Cascade connection of IPFIX Mediators.
</pre></div>
<p>
</p>
Mediator#2 exports each Option Template and its Data Record with a suitable scope.


<blockquote class="text"><dl>
<dt>Session#c Metering Process Statistics Data Records from the Original Exporter:</dt>
<dd>
Field Count = 15<br />

Scope  Count = 12<br />

exporterIPv4Address = 10.1.1.1<br />

collectorIPv4Address = 10.1.1.2<br />

collectorTransportProtocol = 132<br />

exporterTransportPort = 6666<br />

collectorTransportPort = 4739<br />

observationDomainId = 10<br />

exporterIPv4Address = 10.1.1.2<br />

collectorIPv4Address = 10.1.1.3<br />

collectorTransportProtocol = 132<br />

exporterTransportPort = 7777<br />

collectorTransportPort = 4739<br />

observationDomainId = 0<br />

exportedMessageTotalCount<br />

exportedFlowTotalCount<br />

exportedOctetTotalCount
</dd>
</dl></blockquote><p>

</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>The IPFIX concentrator uses the IPFIX protocol. Security considerations about flow information are described in <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;IPFIX Protocol Specification,&rdquo; September&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This document has no actions for IANA.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.dressler-ipfix-aggregation">[I-D.dressler-ipfix-aggregation]</a></td>
<td class="author-text">Dressler, F., Sommer, C., and G. Munz, &ldquo;IPFIX Aggregation,&rdquo; draft-dressler-ipfix-aggregation-03.txt (work in progress)&nbsp;, June&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-architecture">[I-D.ietf-ipfix-architecture]</a></td>
<td class="author-text">Sadasivan, G., Brownlee, N., Claise, B., and J. Quittek, &ldquo;Architecture for IP Flow Information Export,&rdquo; draft-ietf-ipfix-architecture-12.txt(work in progress)&nbsp;, September&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-info">[I-D.ietf-ipfix-info]</a></td>
<td class="author-text">Quittek, J., Bryant, S., Claise, B., and J. Meyer, &ldquo;Information Model for IP Flow Information Export,&rdquo; draft-ietf-ipfix-info-15.txt(work in progress)&nbsp;, February&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-protocol">[I-D.ietf-ipfix-protocol]</a></td>
<td class="author-text">Claise, B., &ldquo;IPFIX Protocol Specification,&rdquo; draft-ietf-ipfix-protocol-26 (work in progress)&nbsp;, September&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-psamp-framework">[I-D.ietf-psamp-framework]</a></td>
<td class="author-text">Duffield, N., &ldquo;A Framework for Packet Selection and Reporting,&rdquo; draft-ietf-psamp-framework-12.txt&nbsp;, June&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-psamp-sample-tech">[I-D.ietf-psamp-sample-tech]</a></td>
<td class="author-text">Zseby, T., Molina, M., Duffield, N., Niccolini, S., and F. Raspall, &ldquo;Sampling and Filtering Techniques for IP Packet Selection,&rdquo; draft-ietf-psamp-sample-tech-10.txt&nbsp;, June&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.kobayashi-ipfix-large-ps">[I-D.kobayashi-ipfix-large-ps]</a></td>
<td class="author-text">Kobayashi, A., Nishida, H., Sommer, C., Dressler, F., and E. Stephan, &ldquo;Problems with Flow Collection in Large-Scale Networks,&rdquo; draft-kobayashi-ipfix-large-ps-00.txt(work in progress)&nbsp;, October&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3917">[RFC3917]</a></td>
<td class="author-text">Quittek, J., Zseby, T., Claise, B., and S. Zander, &ldquo;Requirements for IP Flow Information Export(IPFIX),&rdquo; October&nbsp;2004.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Atsushi Kobayashi</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NTT Information Sharing Platform Laboratories</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3-9-11 Midori-cho</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Musashino-shi, Tokyo  180-8585</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Japan</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+81-422-59-3978</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:akoba@nttv6.net">akoba@nttv6.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Keisuke Ishibashi</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NTT Information Sharing Platform Laboratories</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3-9-11 Midori-cho</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Musashino-shi, Tokyo  180-8585</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Japan</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+81-422-59-3407</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ishibashi.keisuke@lab.ntt.co.jp">ishibashi.keisuke@lab.ntt.co.jp</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kondoh Tsuyoshi</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NTT Information Sharing Platform Laboratories</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3-9-11 Midori-cho</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Musashino-shi, Tokyo  180-8585</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Japan</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+81-422-59-2419</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:kondoh.tsuyoshi@lab.ntt.co.jp">kondoh.tsuyoshi@lab.ntt.co.jp</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Daisuke Matsubara</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hitachi, Ltd., Central Reseach Laboratory</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1-280 Higashi-koigakubo</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kokubunji-shi, Tokyo  185-8601</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Japan</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+81-42-323-1111</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:daisuke.matsubara.pj@hitachi.com">daisuke.matsubara.pj@hitachi.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
