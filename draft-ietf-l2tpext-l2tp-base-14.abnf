shared_key = HMAC_MD5 (shared_secret, 1)

b_1 = MD5 (A + S + RV)   c_1 = p_1 xor b_1
b_2 = MD5 (S + c_1)      c_2 = p_2 xor b_2
                       .                      .
                       .                      .
                       .                      .
b_i = MD5 (S + c_i-1)    c_i = p_i xor b_i

shared_key = HMAC_MD5 (shared_secret, 2)

Digest = HMAC_Hash (shared_key, local_nonce + remote_nonce +
Digest = HMAC_Hash (shared_key, control_message)

