<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Mathematical Mesh 3.0 Part VI: Reliable User Datagram</title>
<meta content="Phillip Hallam-Baker" name="author">
<meta content="
       A presentation layer suitable for use in conjunction with HTTP and UDP transports is described. 
       https://mailarchive.ietf.org/arch/browse/mathmesh/ Discussion of this draft should take place on the MathMesh mailing list (mathmesh@ietf.org), which is archived at . 
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="Threshold Cryptography" name="keyword">
<meta content="Elliptic Curve" name="keyword">
<meta content="Threshold Encryption" name="keyword">
<meta content="Threshold Key Generation" name="keyword">
<meta content="Ceremony" name="keyword">
<meta content="draft-hallambaker-mesh-rud-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-hallambaker-mesh-rud-00-lfav7kmd.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Reliable User Datagram</td>
<td class="right">August 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hallam-Baker</td>
<td class="center">Expires 6 February 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hallambaker-mesh-rud</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-08-05" class="published">5 August 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-02-06">6 February 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. M. Hallam-Baker</div>
<div class="org">ThresholdSecrets.com</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Mathematical Mesh 3.0 Part VI: Reliable User Datagram</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">A presentation layer suitable for use in conjunction with HTTP and UDP transports is described.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2"><a href="http://whatever">https://mailarchive.ietf.org/arch/browse/mathmesh/</a>Discussion of this draft should take place on the MathMesh mailing list (mathmesh@ietf.org), which is archived at .<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 6 February 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-background" class="xref">Background</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1" class="keepWithNext"><a href="#section-1.1.1" class="xref">1.1.1</a>.  <a href="#name-protocol-elements" class="xref">Protocol Elements</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.1.2.1.2.2">
                    <p id="section-toc.1-1.1.2.1.2.2.1" class="keepWithNext"><a href="#section-1.1.2" class="xref">1.1.2</a>.  <a href="#name-application-interface" class="xref">Application Interface</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-use-cases" class="xref">Use Cases</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.1.2.2.2.1">
                    <p id="section-toc.1-1.1.2.2.2.1.1"><a href="#section-1.2.1" class="xref">1.2.1</a>.  <a href="#name-network-agility" class="xref">Network Agility</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.1.2.2.2.2">
                    <p id="section-toc.1-1.1.2.2.2.2.1"><a href="#section-1.2.2" class="xref">1.2.2</a>.  <a href="#name-connection-transfer-and-del" class="xref">Connection Transfer and Delegation</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.1.2.2.2.3">
                    <p id="section-toc.1-1.1.2.2.2.3.1"><a href="#section-1.2.3" class="xref">1.2.3</a>.  <a href="#name-presence" class="xref">Presence</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.1.2.2.2.4">
                    <p id="section-toc.1-1.1.2.2.2.4.1"><a href="#section-1.2.4" class="xref">1.2.4</a>.  <a href="#name-nat-transit" class="xref">NAT Transit</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.1.2.2.2.5">
                    <p id="section-toc.1-1.1.2.2.2.5.1"><a href="#section-1.2.5" class="xref">1.2.5</a>.  <a href="#name-ipv6-agility" class="xref">IPv6 Agility</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.1.2.2.2.6">
                    <p id="section-toc.1-1.1.2.2.2.6.1"><a href="#section-1.2.6" class="xref">1.2.6</a>.  <a href="#name-tunneling" class="xref">Tunneling</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-definitions" class="xref">Definitions</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-defined-terms" class="xref">Defined Terms</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-related-specifications" class="xref">Related Specifications</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-implementation-status" class="xref">Implementation Status</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-architecture" class="xref">Architecture</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-connections" class="xref">Connections</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-ports" class="xref">Ports</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-stream" class="xref">Stream</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-transactional-stream" class="xref">Transactional stream</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="xref">3.3.2</a>.  <a href="#name-asynchronous-stream" class="xref">Asynchronous stream</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-credentials" class="xref">Credentials</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-device" class="xref">Device</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-principal" class="xref">Principal</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-datagram-format" class="xref">Datagram Format</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="xref">3.5.1</a>.  <a href="#name-stream-identifier" class="xref">Stream Identifier</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="xref">3.5.2</a>.  <a href="#name-nonce" class="xref">Nonce</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.5.2.3">
                    <p id="section-toc.1-1.3.2.5.2.3.1"><a href="#section-3.5.3" class="xref">3.5.3</a>.  <a href="#name-ciphertext" class="xref">Ciphertext</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.5.2.4">
                    <p id="section-toc.1-1.3.2.5.2.4.1"><a href="#section-3.5.4" class="xref">3.5.4</a>.  <a href="#name-authentication-tag" class="xref">Authentication Tag</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-packet-format-and-packetize" class="xref">Packet Format and Packetized Datagrams</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="xref">3.6.1</a>.  <a href="#name-packet-header" class="xref">Packet Header</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="xref">3.6.2</a>.  <a href="#name-flow-control" class="xref">Flow Control</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-connection-datagrams" class="xref">Connection Datagrams</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-connection-establishment-an" class="xref">Connection Establishment and Maintenance</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-key-exchange-modes" class="xref">Key Exchange modes</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-first-contact" class="xref">First Contact</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-immediate" class="xref">Immediate</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="xref">4.1.3</a>.  <a href="#name-deferred-trip" class="xref">Deferred Trip</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-ticketed-connection" class="xref">Ticketed Connection</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-connection-forward-secrecy-" class="xref">Connection Forward Secrecy Rekeying</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-stream-establishment-and-ma" class="xref">Stream Establishment and Maintenance</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-stream-creation-and-binding" class="xref">Stream Creation and Binding</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-stream-close" class="xref">Stream Close</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-one-time-stream-identifier" class="xref">One Time Stream Identifier</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-stream-rekey" class="xref">Stream Rekey</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-schema" class="xref">Schema</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-connection-datagrams-2" class="xref">Connection Datagrams</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-packet-extensions" class="xref">Packet Extensions</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="n-introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Reliable User Datagram (RUD) is a lightweight key exchange, authentication and encryption protocol that provides a transactional presentation when layered over a HTTP transport and transactional and streaming presentations when layered over a UDP transport.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The UDP binding of RUD provides much of the functionality normally provided through use of TCP, TLS, HTTP and Web Sockets with considerably less complexity. RUD does not attempt to reproduce all the functionality of these protocols, only the functionality required by Web Services and streaming applications is provided.<a href="#section-1-2" class="pilcrow">¶</a></p>
<span id="name-mesh-presentation-layer-pro"></span><figure id="figure-1">
        <div class="artwork art-svg alignLeft" id="section-1-3.1">
<svg xmlns="http://www.w3.org/2000/svg" width="464" height="249" viewBox="0 0 464.0 249.0">
            <g transform="translate(8,16)">
              <path d="M 0,0 L 160,0" fill="none" stroke="black"></path>
              <path d="M 288,0 L 448,0" fill="none" stroke="black"></path>
              <path d="M 160,16 L 280,16" fill="none" stroke="black"></path>
              <path d="M 0,32 L 160,32" fill="none" stroke="black"></path>
              <path d="M 0,64 L 160,64" fill="none" stroke="black"></path>
              <path d="M 160,80 L 280,80" fill="none" stroke="black"></path>
              <path d="M 0,96 L 160,96" fill="none" stroke="black"></path>
              <path d="M 0,128 L 160,128" fill="none" stroke="black"></path>
              <path d="M 160,144 L 280,144" fill="none" stroke="black"></path>
              <path d="M 0,160 L 160,160" fill="none" stroke="black"></path>
              <path d="M 0,192 L 160,192" fill="none" stroke="black"></path>
              <path d="M 160,208 L 280,208" fill="none" stroke="black"></path>
              <path d="M 0,224 L 160,224" fill="none" stroke="black"></path>
              <path d="M 288,224 L 448,224" fill="none" stroke="black"></path>
              <path d="M 0,0 L 0,32" fill="none" stroke="black"></path>
              <path d="M 0,64 L 0,96" fill="none" stroke="black"></path>
              <path d="M 0,128 L 0,160" fill="none" stroke="black"></path>
              <path d="M 0,192 L 0,224" fill="none" stroke="black"></path>
              <path d="M 160,0 L 160,16" fill="none" stroke="black"></path>
              <path d="M 160,16 L 160,32" fill="none" stroke="black"></path>
              <path d="M 160,64 L 160,80" fill="none" stroke="black"></path>
              <path d="M 160,80 L 160,96" fill="none" stroke="black"></path>
              <path d="M 160,128 L 160,144" fill="none" stroke="black"></path>
              <path d="M 160,144 L 160,160" fill="none" stroke="black"></path>
              <path d="M 160,192 L 160,208" fill="none" stroke="black"></path>
              <path d="M 160,208 L 160,224" fill="none" stroke="black"></path>
              <path d="M 288,0 L 288,224" fill="none" stroke="black"></path>
              <path d="M 448,0 L 448,224" fill="none" stroke="black"></path>
              <polygon points="288.000000,16.000000 276.000000,10.400000 276.000000,21.600000" fill="black" transform="rotate(0.000000, 280.000000, 16.000000)"></polygon>
              <polygon points="288.000000,80.000000 276.000000,74.400002 276.000000,85.599998" fill="black" transform="rotate(0.000000, 280.000000, 80.000000)"></polygon>
              <polygon points="288.000000,144.000000 276.000000,138.399994 276.000000,149.600006" fill="black" transform="rotate(0.000000, 280.000000, 144.000000)"></polygon>
              <polygon points="288.000000,208.000000 276.000000,202.399994 276.000000,213.600006" fill="black" transform="rotate(0.000000, 280.000000, 208.000000)"></polygon>
              <text text-anchor="middle" font-family="sans-serif" x="80" y="84">L</text>
              <text text-anchor="middle" font-family="sans-serif" x="360" y="100">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="88" y="20">P</text>
              <text text-anchor="middle" font-family="sans-serif" x="88" y="84">S</text>
              <text text-anchor="middle" font-family="sans-serif" x="336" y="116">r</text>
              <text text-anchor="middle" font-family="sans-serif" x="368" y="116">n</text>
              <text text-anchor="middle" font-family="sans-serif" x="72" y="212">S</text>
              <text text-anchor="middle" font-family="sans-serif" x="112" y="212">t</text>
              <text text-anchor="middle" font-family="sans-serif" x="72" y="84">T</text>
              <text text-anchor="middle" font-family="sans-serif" x="80" y="20">C</text>
              <text text-anchor="middle" font-family="sans-serif" x="376" y="116">t</text>
              <text text-anchor="middle" font-family="sans-serif" x="392" y="116">t</text>
              <text text-anchor="middle" font-family="sans-serif" x="56" y="212">b</text>
              <text text-anchor="middle" font-family="sans-serif" x="96" y="212">k</text>
              <text text-anchor="middle" font-family="sans-serif" x="72" y="20">T</text>
              <text text-anchor="middle" font-family="sans-serif" x="360" y="132">a</text>
              <text text-anchor="middle" font-family="sans-serif" x="376" y="132">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="80" y="148">T</text>
              <text text-anchor="middle" font-family="sans-serif" x="88" y="212">c</text>
              <text text-anchor="middle" font-family="sans-serif" x="104" y="212">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="416" y="116">n</text>
              <text text-anchor="middle" font-family="sans-serif" x="352" y="116">s</text>
              <text text-anchor="middle" font-family="sans-serif" x="352" y="132">L</text>
              <text text-anchor="middle" font-family="sans-serif" x="368" y="132">y</text>
              <text text-anchor="middle" font-family="sans-serif" x="64" y="148">H</text>
              <text text-anchor="middle" font-family="sans-serif" x="48" y="212">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="376" y="100">h</text>
              <text text-anchor="middle" font-family="sans-serif" x="360" y="116">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="400" y="116">i</text>
              <text text-anchor="middle" font-family="sans-serif" x="72" y="148">T</text>
              <text text-anchor="middle" font-family="sans-serif" x="88" y="148">P</text>
              <text text-anchor="middle" font-family="sans-serif" x="80" y="212">o</text>
              <text text-anchor="middle" font-family="sans-serif" x="368" y="100">s</text>
              <text text-anchor="middle" font-family="sans-serif" x="408" y="116">o</text>
              <text text-anchor="middle" font-family="sans-serif" x="40" y="212">W</text>
              <text text-anchor="middle" font-family="sans-serif" x="352" y="100">M</text>
              <text text-anchor="middle" font-family="sans-serif" x="344" y="116">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="384" y="116">a</text>
              <text text-anchor="middle" font-family="sans-serif" x="384" y="132">r</text>
              <text text-anchor="middle" font-family="sans-serif" x="120" y="212">s</text>
              <text text-anchor="middle" font-family="sans-serif" x="328" y="116">P</text>
            </g>
          </svg>
        </div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-mesh-presentation-layer-pro" class="selfRef">Mesh Presentation Layer provides a combination of necessary functionality from TCP, TLS, HTTP and Web Sockets.</a>
        </figcaption></figure>
<p id="section-1-4">As recognized in the design of QUIC, combining these protocols allows greater efficiency and security. But QUIC is the product of one set of design choices optimized to meet an important but specific set of needs. RUD makes a different set of choices to meet a different set of needs. A natural consequence of moving TCP functionality from a platform capability implemented in the OS kernel to an application level resource it that applications are now free to chose the transport and security capabilities that best fit their needs rather than being limited to a single size fits all.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The reduction in complexity afforded by combining four protocols into one allows entirely new communications patterns to be supported that are poorly supported by traditional approaches. HTTP is built on the Remote Procedure Call model of transactions that consist of a single request followed by a response. Using this communication pattern, a device attempting to synchronize a local store with a store at a remote service is required to periodically poll the service for updates:<a href="#section-1-5" class="pilcrow">¶</a></p>
<span id="name-limiting-communications-to-"></span><figure id="figure-2">
        <div class="artwork art-svg alignLeft" id="section-1-6.1">
<svg xmlns="http://www.w3.org/2000/svg" width="464" height="233" viewBox="0 0 464.0 233.0">
            <g transform="translate(8,16)">
              <path d="M 0,16 L 160,16" fill="none" stroke="black"></path>
              <path d="M 288,16 L 448,16" fill="none" stroke="black"></path>
              <path d="M 0,48 L 80,48" fill="none" stroke="black"></path>
              <path d="M 80,48 L 160,48" fill="none" stroke="black"></path>
              <path d="M 288,48 L 376,48" fill="none" stroke="black"></path>
              <path d="M 376,48 L 448,48" fill="none" stroke="black"></path>
              <path d="M 80,80 L 200,80" fill="none" stroke="black"></path>
              <path d="M 256,80 L 368,80" fill="none" stroke="black"></path>
              <path d="M 88,96 L 176,96" fill="none" stroke="black"></path>
              <path d="M 272,96 L 376,96" fill="none" stroke="black"></path>
              <path d="M 80,128 L 200,128" fill="none" stroke="black"></path>
              <path d="M 256,128 L 368,128" fill="none" stroke="black"></path>
              <path d="M 88,144 L 176,144" fill="none" stroke="black"></path>
              <path d="M 272,144 L 376,144" fill="none" stroke="black"></path>
              <path d="M 80,176 L 200,176" fill="none" stroke="black"></path>
              <path d="M 256,176 L 368,176" fill="none" stroke="black"></path>
              <path d="M 88,192 L 192,192" fill="none" stroke="black"></path>
              <path d="M 264,192 L 376,192" fill="none" stroke="black"></path>
              <path d="M 0,16 L 0,48" fill="none" stroke="black"></path>
              <path d="M 80,48 L 80,80" fill="none" stroke="black"></path>
              <path d="M 80,80 L 80,128" fill="none" stroke="black"></path>
              <path d="M 80,128 L 80,176" fill="none" stroke="black"></path>
              <path d="M 80,176 L 80,208" fill="none" stroke="black"></path>
              <path d="M 160,16 L 160,48" fill="none" stroke="black"></path>
              <path d="M 288,16 L 288,48" fill="none" stroke="black"></path>
              <path d="M 376,48 L 376,96" fill="none" stroke="black"></path>
              <path d="M 376,96 L 376,144" fill="none" stroke="black"></path>
              <path d="M 376,144 L 376,192" fill="none" stroke="black"></path>
              <path d="M 376,192 L 376,208" fill="none" stroke="black"></path>
              <path d="M 448,16 L 448,48" fill="none" stroke="black"></path>
              <polygon points="96.000000,96.000000 84.000000,90.400002 84.000000,101.599998" fill="black" transform="rotate(180.000000, 88.000000, 96.000000)"></polygon>
              <polygon points="96.000000,144.000000 84.000000,138.399994 84.000000,149.600006" fill="black" transform="rotate(180.000000, 88.000000, 144.000000)"></polygon>
              <polygon points="96.000000,192.000000 84.000000,186.399994 84.000000,197.600006" fill="black" transform="rotate(180.000000, 88.000000, 192.000000)"></polygon>
              <polygon points="376.000000,80.000000 364.000000,74.400002 364.000000,85.599998" fill="black" transform="rotate(0.000000, 368.000000, 80.000000)"></polygon>
              <polygon points="376.000000,128.000000 364.000000,122.400002 364.000000,133.600006" fill="black" transform="rotate(0.000000, 368.000000, 128.000000)"></polygon>
              <polygon points="376.000000,176.000000 364.000000,170.399994 364.000000,181.600006" fill="black" transform="rotate(0.000000, 368.000000, 176.000000)"></polygon>
              <text text-anchor="middle" font-family="sans-serif" x="256" y="100">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="240" y="132">l</text>
              <text text-anchor="middle" font-family="sans-serif" x="232" y="148">a</text>
              <text text-anchor="middle" font-family="sans-serif" x="88" y="36">c</text>
              <text text-anchor="middle" font-family="sans-serif" x="376" y="36">i</text>
              <text text-anchor="middle" font-family="sans-serif" x="232" y="84">l</text>
              <text text-anchor="middle" font-family="sans-serif" x="240" y="84">l</text>
              <text text-anchor="middle" font-family="sans-serif" x="248" y="100">g</text>
              <text text-anchor="middle" font-family="sans-serif" x="232" y="180">l</text>
              <text text-anchor="middle" font-family="sans-serif" x="80" y="36">i</text>
              <text text-anchor="middle" font-family="sans-serif" x="216" y="100">C</text>
              <text text-anchor="middle" font-family="sans-serif" x="216" y="148">C</text>
              <text text-anchor="middle" font-family="sans-serif" x="248" y="148">g</text>
              <text text-anchor="middle" font-family="sans-serif" x="96" y="36">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="216" y="84">P</text>
              <text text-anchor="middle" font-family="sans-serif" x="192" y="148">N</text>
              <text text-anchor="middle" font-family="sans-serif" x="232" y="100">a</text>
              <text text-anchor="middle" font-family="sans-serif" x="240" y="180">l</text>
              <text text-anchor="middle" font-family="sans-serif" x="208" y="196">U</text>
              <text text-anchor="middle" font-family="sans-serif" x="224" y="180">o</text>
              <text text-anchor="middle" font-family="sans-serif" x="248" y="196">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="344" y="36">S</text>
              <text text-anchor="middle" font-family="sans-serif" x="368" y="36">v</text>
              <text text-anchor="middle" font-family="sans-serif" x="392" y="36">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="192" y="100">N</text>
              <text text-anchor="middle" font-family="sans-serif" x="232" y="132">l</text>
              <text text-anchor="middle" font-family="sans-serif" x="240" y="196">t</text>
              <text text-anchor="middle" font-family="sans-serif" x="352" y="36">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="224" y="84">o</text>
              <text text-anchor="middle" font-family="sans-serif" x="200" y="100">o</text>
              <text text-anchor="middle" font-family="sans-serif" x="224" y="148">h</text>
              <text text-anchor="middle" font-family="sans-serif" x="240" y="148">n</text>
              <text text-anchor="middle" font-family="sans-serif" x="224" y="132">o</text>
              <text text-anchor="middle" font-family="sans-serif" x="216" y="180">P</text>
              <text text-anchor="middle" font-family="sans-serif" x="56" y="36">D</text>
              <text text-anchor="middle" font-family="sans-serif" x="64" y="36">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="72" y="36">v</text>
              <text text-anchor="middle" font-family="sans-serif" x="224" y="100">h</text>
              <text text-anchor="middle" font-family="sans-serif" x="240" y="100">n</text>
              <text text-anchor="middle" font-family="sans-serif" x="216" y="196">p</text>
              <text text-anchor="middle" font-family="sans-serif" x="224" y="196">d</text>
              <text text-anchor="middle" font-family="sans-serif" x="232" y="196">a</text>
              <text text-anchor="middle" font-family="sans-serif" x="360" y="36">r</text>
              <text text-anchor="middle" font-family="sans-serif" x="384" y="36">c</text>
              <text text-anchor="middle" font-family="sans-serif" x="216" y="132">P</text>
              <text text-anchor="middle" font-family="sans-serif" x="200" y="148">o</text>
              <text text-anchor="middle" font-family="sans-serif" x="256" y="148">e</text>
            </g>
          </svg>
        </div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-limiting-communications-to-" class="selfRef">Limiting communications to a request/response communication requires inefficient polling for updates.</a>
        </figcaption></figure>
<p id="section-1-7">RUD allows a client device with this particular requirement to subscribe to a continuous stream of updates. There is no need for the device to poll the remote store for updates as it will be notified every time an update occurs.<a href="#section-1-7" class="pilcrow">¶</a></p>
<span id="name-rud-supports-asynchronous-s"></span><figure id="figure-3">
        <div class="artwork art-svg alignLeft" id="section-1-8.1">
<svg xmlns="http://www.w3.org/2000/svg" width="464" height="249" viewBox="0 0 464.0 249.0">
            <g transform="translate(8,16)">
              <path d="M 0,0 L 160,0" fill="none" stroke="black"></path>
              <path d="M 288,0 L 448,0" fill="none" stroke="black"></path>
              <path d="M 0,32 L 80,32" fill="none" stroke="black"></path>
              <path d="M 80,32 L 160,32" fill="none" stroke="black"></path>
              <path d="M 288,32 L 376,32" fill="none" stroke="black"></path>
              <path d="M 376,32 L 448,32" fill="none" stroke="black"></path>
              <path d="M 88,64 L 176,64" fill="none" stroke="black"></path>
              <path d="M 272,64 L 368,64" fill="none" stroke="black"></path>
              <path d="M 88,80 L 168,80" fill="none" stroke="black"></path>
              <path d="M 280,80 L 368,80" fill="none" stroke="black"></path>
              <path d="M 88,144 L 192,144" fill="none" stroke="black"></path>
              <path d="M 264,144 L 368,144" fill="none" stroke="black"></path>
              <path d="M 88,192 L 192,192" fill="none" stroke="black"></path>
              <path d="M 264,192 L 368,192" fill="none" stroke="black"></path>
              <path d="M 88,208 L 192,208" fill="none" stroke="black"></path>
              <path d="M 264,208 L 368,208" fill="none" stroke="black"></path>
              <path d="M 0,0 L 0,32" fill="none" stroke="black"></path>
              <path d="M 80,32 L 80,224" fill="none" stroke="black"></path>
              <path d="M 160,0 L 160,32" fill="none" stroke="black"></path>
              <path d="M 288,0 L 288,32" fill="none" stroke="black"></path>
              <path d="M 376,32 L 376,224" fill="none" stroke="black"></path>
              <path d="M 448,0 L 448,32" fill="none" stroke="black"></path>
              <polygon points="96.000000,80.000000 84.000000,74.400002 84.000000,85.599998" fill="black" transform="rotate(180.000000, 88.000000, 80.000000)"></polygon>
              <polygon points="96.000000,144.000000 84.000000,138.399994 84.000000,149.600006" fill="black" transform="rotate(180.000000, 88.000000, 144.000000)"></polygon>
              <polygon points="96.000000,192.000000 84.000000,186.399994 84.000000,197.600006" fill="black" transform="rotate(180.000000, 88.000000, 192.000000)"></polygon>
              <polygon points="96.000000,208.000000 84.000000,202.399994 84.000000,213.600006" fill="black" transform="rotate(180.000000, 88.000000, 208.000000)"></polygon>
              <polygon points="376.000000,64.000000 364.000000,58.400002 364.000000,69.599998" fill="black" transform="rotate(0.000000, 368.000000, 64.000000)"></polygon>
              <text text-anchor="middle" font-family="sans-serif" x="384" y="20">c</text>
              <text text-anchor="middle" font-family="sans-serif" x="224" y="148">d</text>
              <text text-anchor="middle" font-family="sans-serif" x="232" y="148">a</text>
              <text text-anchor="middle" font-family="sans-serif" x="224" y="196">d</text>
              <text text-anchor="middle" font-family="sans-serif" x="240" y="84">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="208" y="148">U</text>
              <text text-anchor="middle" font-family="sans-serif" x="80" y="20">i</text>
              <text text-anchor="middle" font-family="sans-serif" x="88" y="20">c</text>
              <text text-anchor="middle" font-family="sans-serif" x="96" y="20">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="200" y="68">u</text>
              <text text-anchor="middle" font-family="sans-serif" x="208" y="68">b</text>
              <text text-anchor="middle" font-family="sans-serif" x="248" y="68">b</text>
              <text text-anchor="middle" font-family="sans-serif" x="248" y="148">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="232" y="212">a</text>
              <text text-anchor="middle" font-family="sans-serif" x="248" y="212">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="72" y="20">v</text>
              <text text-anchor="middle" font-family="sans-serif" x="192" y="68">S</text>
              <text text-anchor="middle" font-family="sans-serif" x="224" y="84">w</text>
              <text text-anchor="middle" font-family="sans-serif" x="232" y="84">l</text>
              <text text-anchor="middle" font-family="sans-serif" x="208" y="196">U</text>
              <text text-anchor="middle" font-family="sans-serif" x="216" y="196">p</text>
              <text text-anchor="middle" font-family="sans-serif" x="56" y="20">D</text>
              <text text-anchor="middle" font-family="sans-serif" x="360" y="20">r</text>
              <text text-anchor="middle" font-family="sans-serif" x="216" y="68">s</text>
              <text text-anchor="middle" font-family="sans-serif" x="192" y="84">c</text>
              <text text-anchor="middle" font-family="sans-serif" x="208" y="84">n</text>
              <text text-anchor="middle" font-family="sans-serif" x="216" y="212">p</text>
              <text text-anchor="middle" font-family="sans-serif" x="368" y="20">v</text>
              <text text-anchor="middle" font-family="sans-serif" x="240" y="68">i</text>
              <text text-anchor="middle" font-family="sans-serif" x="200" y="84">k</text>
              <text text-anchor="middle" font-family="sans-serif" x="256" y="84">g</text>
              <text text-anchor="middle" font-family="sans-serif" x="232" y="196">a</text>
              <text text-anchor="middle" font-family="sans-serif" x="344" y="20">S</text>
              <text text-anchor="middle" font-family="sans-serif" x="224" y="68">c</text>
              <text text-anchor="middle" font-family="sans-serif" x="264" y="84">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="216" y="148">p</text>
              <text text-anchor="middle" font-family="sans-serif" x="240" y="212">t</text>
              <text text-anchor="middle" font-family="sans-serif" x="352" y="20">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="376" y="20">i</text>
              <text text-anchor="middle" font-family="sans-serif" x="256" y="68">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="216" y="84">o</text>
              <text text-anchor="middle" font-family="sans-serif" x="248" y="84">d</text>
              <text text-anchor="middle" font-family="sans-serif" x="208" y="212">U</text>
              <text text-anchor="middle" font-family="sans-serif" x="248" y="196">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="224" y="212">d</text>
              <text text-anchor="middle" font-family="sans-serif" x="64" y="20">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="392" y="20">e</text>
              <text text-anchor="middle" font-family="sans-serif" x="232" y="68">r</text>
              <text text-anchor="middle" font-family="sans-serif" x="184" y="84">A</text>
              <text text-anchor="middle" font-family="sans-serif" x="240" y="148">t</text>
              <text text-anchor="middle" font-family="sans-serif" x="240" y="196">t</text>
            </g>
          </svg>
        </div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-rud-supports-asynchronous-s" class="selfRef">RUD supports asynchronous streaming of updates as they occur.</a>
        </figcaption></figure>
<p id="section-1-9">While it is possible to achieve the same functionality in TCP, this requires that the device and service maintain a TCP connection for the duration of the connection. This consumes communication resources and operating system resources.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">As is shown in later sections, the 'blank slate' design approach of RUD allows completely new approaches to service discovery, network agility, presence, NAT tunneling and many other requirements that are critical in modern network use.<a href="#section-1-10" class="pilcrow">¶</a></p>
<div id="n-background">
<section id="section-1.1">
        <h3 id="name-background">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-background" class="section-name selfRef">Background</a>
        </h3>
<p id="section-1.1-1">Web Services have traditionally made use of HTTP bindings over TCP or TLS transports. While this approach is functional, it is less than satisfactory. The HTTP and TLS stacks are designed to meet the needs of Web browsing but fail to provide significant capabilities required by a service. Modern implementations of these stacks are large and cumbersome but little of that complexity addresses needs relevant to Web Services.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">A basic requirement for a Web Service is the need to authenticate requests and the party making them. In particular, a Web Service requires the ability to authenticate the source of a request and verify that authentication of the request data is complete before acting on it. As its original name, 'Secure Socket Layer' implies, TLS is designed to present an abstract socket layer that hides this information from the application layer. In many large enterprise deployments, TLS processing and Web Service transactions are performed on separate machines and information from the TLS session is only visible to the transaction processor if special provision is made.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">HTTP provides a wide range of protocol capabilities but almost none of this complexity is relevant to Web Services needs.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">Providing access to multiple Web Services through a single TCP/IP port.<a href="#section-1.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.2">Delineating the beginning and end of request and response data.<a href="#section-1.1-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-5">Recognizing these needs, the DARE envelope format was originally conceived as a JSON equivalent of the XML Signature and Encryption protocols applied to provide message layer security in the WS-Security stack. Consideration of the resource requirements needed to verify each transaction request and sign each response led to the need for a key exchange mechanism and that this should be separate from the Mesh Service Protocol. This in turn led to the realization that in most circumstances, an AEAD scheme such as AES-GCM or AES-CFB would provide encryption with the same or less overhead than use of a MAC.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6">Having taken these considerations into account, a new lightweight envelope format was designed to allow authentication and encryption of Web Services messages as the payload of HTTP requests and responses. The success of this approach led to the realization that the same format could be modified to enable direct binding to UDP, allowing provision of HTTP support to be made optional.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<div id="n-protocol-elements">
<section id="section-1.1.1">
          <h4 id="name-protocol-elements">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-protocol-elements" class="section-name selfRef">Protocol Elements</a>
          </h4>
<p id="section-1.1.1-1">A TCP connection provides a single pair of bidirectional communication streams between two devices connected to the network. While the TCP connection is symmetric from the application layer point of view, the HTTP presentation layer is not. HTTP limits communications to a request/response communication pattern in which the initiator device makes all the requests and the responder device makes all the responses.<a href="#section-1.1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1.1-2">RUD affords greater communication flexibility requiring distinctions to be made between terms which may be used interchangeably in the HTTP over TCP/IP case.<a href="#section-1.1.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1.1-3">
            <dt id="section-1.1.1-3.1">Connection</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-3.2">
              <p id="section-1.1.1-3.2.1">An RUD connection is a bidirectional relationship between a pair of endpoints established through a cryptographic key exchange establishing a shared secret called the Connection Origin Key.<a href="#section-1.1.1-3.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-3.3">Stream</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-3.4">
              <p id="section-1.1.1-3.4.1">An RUD stream is an individual communication channel established within a connection. An RUD connection comprises one or more streams.<a href="#section-1.1.1-3.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-3.5">Port</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-3.6">
              <p id="section-1.1.1-3.6.1">An RUD port is a network interface through which data is exchanged. Currently only UDP and HTTP ports are supported. Each end of an RUD Connection accepts packets through one or more ports.<a href="#section-1.1.1-3.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-1.1.1-4">The distinction between connections and streams is analogous to that made between processes and threads. While any task that is performed by a separate thread may be performed by a separate process, use of threads consumes fewer platform resources and greater convenience to the programmer.<a href="#section-1.1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1.1-5">In the TCP/IP model, each stream is bound to a single pair of IP port. In the RUD model, any stream <span class="bcp14">MAY</span> make use of any available destination port to send traffic. This allows Alice to move from her home to her car to her office without dropping the connection to her conference call.<a href="#section-1.1.1-5" class="pilcrow">¶</a></p>
<span id="name-an-rud-connection-comprises"></span><figure id="figure-4">
            <div class="artwork art-svg alignLeft" id="section-1.1.1-6.1">
<svg xmlns="http://www.w3.org/2000/svg" width="528" height="217" viewBox="0 0 528.0 217.0">
                <g transform="translate(8,16)">
                  <path d="M 0,0 L 512,0" fill="none" stroke="black"></path>
                  <path d="M 24,48 L 144,48" fill="none" stroke="black"></path>
                  <path d="M 168,48 L 288,48" fill="none" stroke="black"></path>
                  <path d="M 368,48 L 488,48" fill="none" stroke="black"></path>
                  <path d="M 304,80 L 312,80" fill="none" stroke="black"></path>
                  <path d="M 320,80 L 328,80" fill="none" stroke="black"></path>
                  <path d="M 336,80 L 344,80" fill="none" stroke="black"></path>
                  <path d="M 352,80 L 360,80" fill="none" stroke="black"></path>
                  <path d="M 24,112 L 144,112" fill="none" stroke="black"></path>
                  <path d="M 168,112 L 288,112" fill="none" stroke="black"></path>
                  <path d="M 368,112 L 488,112" fill="none" stroke="black"></path>
                  <path d="M 0,128 L 128,128" fill="none" stroke="black"></path>
                  <path d="M 128,128 L 256,128" fill="none" stroke="black"></path>
                  <path d="M 256,128 L 384,128" fill="none" stroke="black"></path>
                  <path d="M 384,128 L 512,128" fill="none" stroke="black"></path>
                  <path d="M 0,192 L 128,192" fill="none" stroke="black"></path>
                  <path d="M 128,192 L 256,192" fill="none" stroke="black"></path>
                  <path d="M 256,192 L 384,192" fill="none" stroke="black"></path>
                  <path d="M 384,192 L 512,192" fill="none" stroke="black"></path>
                  <path d="M 0,0 L 0,128" fill="none" stroke="black"></path>
                  <path d="M 0,128 L 0,192" fill="none" stroke="black"></path>
                  <path d="M 24,48 L 24,112" fill="none" stroke="black"></path>
                  <path d="M 128,128 L 128,192" fill="none" stroke="black"></path>
                  <path d="M 144,48 L 144,112" fill="none" stroke="black"></path>
                  <path d="M 168,48 L 168,112" fill="none" stroke="black"></path>
                  <path d="M 256,128 L 256,192" fill="none" stroke="black"></path>
                  <path d="M 288,48 L 288,112" fill="none" stroke="black"></path>
                  <path d="M 368,48 L 368,112" fill="none" stroke="black"></path>
                  <path d="M 384,128 L 384,192" fill="none" stroke="black"></path>
                  <path d="M 488,48 L 488,112" fill="none" stroke="black"></path>
                  <path d="M 512,0 L 512,128" fill="none" stroke="black"></path>
                  <path d="M 512,128 L 512,192" fill="none" stroke="black"></path>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="164">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="84">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="164">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="164">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="164">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="164">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="164">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="20">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="84">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="48" y="164">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="164">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="164">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="164">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="84">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="164">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="84">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="20">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="20">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="84">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="104" y="84">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="84">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="408" y="84">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="84">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="84">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="164">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="164">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="456" y="164">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="80" y="84">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="176" y="164">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="164">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="20">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="84">e</text>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-an-rud-connection-comprises" class="selfRef">An RUD connection comprises one or more streams and one or more ports.</a>
            </figcaption></figure>
<p id="section-1.1.1-7">New streams may be created at any time by either party in a connection for many different reasons:<a href="#section-1.1.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.1-8.1">To establish a client/service relationship to a different Web Service.<a href="#section-1.1.1-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.2">To establish a new asynchronous streaming relationship<a href="#section-1.1.1-8.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.3">To signal changes to the cryptographic context (e.g., forward secrecy rachet operation).<a href="#section-1.1.1-8.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.4">Exhaustion of the datagram counter identifier space.<a href="#section-1.1.1-8.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.5">To make use of traffic analysis avoidance techniques.<a href="#section-1.1.1-8.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.1-8.6">To enable datagrams to be sent at different priorities.<a href="#section-1.1.1-8.6" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-1.1.1-9"> A device connected to three separate Web Services provided by the same host establishes a separate stream for each service. This enables the device to present different application-level credentials top the different services. If permitted by the service, separate tasks on the same device <span class="bcp14">MAY</span> establish separate streams to the same service. This allows separate threads to wait on transactions taking a long time to complete without contention.<a href="#section-1.1.1-9" class="pilcrow">¶</a></p>
<p id="section-1.1.1-10">Each stream presents a sequence of datagrams spanning one or more packets according to a declared characteristic. The datagram represents the unit of payload data that is authenticated and thus the unit of payload data that is presented to the calling API.<a href="#section-1.1.1-10" class="pilcrow">¶</a></p>
<span id="name-an-rud-stream-presents-a-se"></span><figure id="figure-5">
            <div class="artwork art-svg alignLeft" id="section-1.1.1-11.1">
<svg xmlns="http://www.w3.org/2000/svg" width="552" height="121" viewBox="0 0 552.0 121.0">
                <g transform="translate(8,16)">
                  <path d="M 0,0 L 536,0" fill="none" stroke="black"></path>
                  <path d="M 0,32 L 72,32" fill="none" stroke="black"></path>
                  <path d="M 72,32 L 144,32" fill="none" stroke="black"></path>
                  <path d="M 144,32 L 216,32" fill="none" stroke="black"></path>
                  <path d="M 216,32 L 288,32" fill="none" stroke="black"></path>
                  <path d="M 288,32 L 360,32" fill="none" stroke="black"></path>
                  <path d="M 360,32 L 432,32" fill="none" stroke="black"></path>
                  <path d="M 432,32 L 504,32" fill="none" stroke="black"></path>
                  <path d="M 504,32 L 536,32" fill="none" stroke="black"></path>
                  <path d="M 0,64 L 72,64" fill="none" stroke="black"></path>
                  <path d="M 72,64 L 144,64" fill="none" stroke="black"></path>
                  <path d="M 144,64 L 216,64" fill="none" stroke="black"></path>
                  <path d="M 216,64 L 288,64" fill="none" stroke="black"></path>
                  <path d="M 288,64 L 360,64" fill="none" stroke="black"></path>
                  <path d="M 360,64 L 432,64" fill="none" stroke="black"></path>
                  <path d="M 432,64 L 504,64" fill="none" stroke="black"></path>
                  <path d="M 504,64 L 536,64" fill="none" stroke="black"></path>
                  <path d="M 0,96 L 72,96" fill="none" stroke="black"></path>
                  <path d="M 72,96 L 144,96" fill="none" stroke="black"></path>
                  <path d="M 144,96 L 216,96" fill="none" stroke="black"></path>
                  <path d="M 216,96 L 288,96" fill="none" stroke="black"></path>
                  <path d="M 288,96 L 360,96" fill="none" stroke="black"></path>
                  <path d="M 360,96 L 432,96" fill="none" stroke="black"></path>
                  <path d="M 432,96 L 504,96" fill="none" stroke="black"></path>
                  <path d="M 504,96 L 536,96" fill="none" stroke="black"></path>
                  <path d="M 0,0 L 0,32" fill="none" stroke="black"></path>
                  <path d="M 0,32 L 0,64" fill="none" stroke="black"></path>
                  <path d="M 0,64 L 0,96" fill="none" stroke="black"></path>
                  <path d="M 72,64 L 72,96" fill="none" stroke="black"></path>
                  <path d="M 144,64 L 144,96" fill="none" stroke="black"></path>
                  <path d="M 216,32 L 216,64" fill="none" stroke="black"></path>
                  <path d="M 216,64 L 216,96" fill="none" stroke="black"></path>
                  <path d="M 288,32 L 288,64" fill="none" stroke="black"></path>
                  <path d="M 288,64 L 288,96" fill="none" stroke="black"></path>
                  <path d="M 360,64 L 360,96" fill="none" stroke="black"></path>
                  <path d="M 432,32 L 432,64" fill="none" stroke="black"></path>
                  <path d="M 432,64 L 432,96" fill="none" stroke="black"></path>
                  <path d="M 504,64 L 504,96" fill="none" stroke="black"></path>
                  <polygon points="544.000000,0.000000 532.000000,-5.600000 532.000000,5.600000" fill="black" transform="rotate(0.000000, 536.000000, 0.000000)"></polygon>
                  <polygon points="544.000000,32.000000 532.000000,26.400000 532.000000,37.599998" fill="black" transform="rotate(0.000000, 536.000000, 32.000000)"></polygon>
                  <polygon points="544.000000,64.000000 532.000000,58.400002 532.000000,69.599998" fill="black" transform="rotate(0.000000, 536.000000, 64.000000)"></polygon>
                  <polygon points="544.000000,96.000000 532.000000,90.400002 532.000000,101.599998" fill="black" transform="rotate(0.000000, 536.000000, 96.000000)"></polygon>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="520" y="52">4</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="400" y="84">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="52">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="52">D</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="52">D</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="52">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="32" y="84">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="376" y="84">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="480" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="20">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="120" y="52">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="52">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="84">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="84">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="84">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="392" y="84">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="52">2</text>
                  <text text-anchor="middle" font-family="sans-serif" x="480" y="52">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="16" y="84">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="52">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="472" y="52">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="128" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="472" y="84">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="128" y="52">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="104" y="84">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="112" y="52">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="392" y="52">3</text>
                  <text text-anchor="middle" font-family="sans-serif" x="488" y="52">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="84">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="408" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="52">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="52">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="360" y="52">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="368" y="52">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="112" y="84">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="464" y="84">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="144" y="52">1</text>
                  <text text-anchor="middle" font-family="sans-serif" x="504" y="52">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="84">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="488" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="52">D</text>
                  <text text-anchor="middle" font-family="sans-serif" x="496" y="52">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="40" y="84">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="176" y="84">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="84">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="20">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="20">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="80" y="52">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="456" y="52">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="168" y="84">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="48" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="84">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="52">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="52">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="456" y="84">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="104" y="52">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="52">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="52">D</text>
                  <text text-anchor="middle" font-family="sans-serif" x="24" y="84">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="52">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="376" y="52">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="464" y="52">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="84">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="120" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="160" y="84">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="84">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="84">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="384" y="84">a</text>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-an-rud-stream-presents-a-se" class="selfRef">An RUD stream presents a sequence of datagrams, each of which may span multiple packets.</a>
            </figcaption></figure>
<p id="section-1.1.1-12">Two stream characteristics are currently defined, both of which are asymmetric.<a href="#section-1.1.1-12" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1.1-13">
            <dt id="section-1.1.1-13.1">Transactional Stream</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-13.2">
              <p id="section-1.1.1-13.2.1">Each request sent in the forward direction is followed by a response returned in the reverse direction.<a href="#section-1.1.1-13.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.1-13.3">Asynchronous Stream</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.1-13.4">
              <p id="section-1.1.1-13.4.1">A sequence of frames is received in the forward direction as directed by control messages sent in the reverse direction.<a href="#section-1.1.1-13.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-1.1.1-14">Thus, a bidirectional voice call between Alice and Bob requires a minimum of two Asynchronous Content streams, from Alice to Bob and from Bob to Alice.<a href="#section-1.1.1-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-application-interface">
<section id="section-1.1.2">
          <h4 id="name-application-interface">
<a href="#section-1.1.2" class="section-number selfRef">1.1.2. </a><a href="#name-application-interface" class="section-name selfRef">Application Interface</a>
          </h4>
<p id="section-1.1.2-1">The traditional TCP/IP programming API exposes only an undifferentiated stream of bytes to the application program context. Information such as packet latency, packet loss rate, error rate, etc. are only available through proprietary platform specific APIs, if at all.<a href="#section-1.1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.1.2-2">RUD is designed to provide application programs with relevant connection information including:<a href="#section-1.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.2-3.1">Time since the most recent forward secrecy exchange<a href="#section-1.1.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-3.2">Average round trip latency (per port)<a href="#section-1.1.2-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-3.3">Packet loss (per port)<a href="#section-1.1.2-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-1.1.2-4">Providing this information allows applications to adapt to changing network conditions.<a href="#section-1.1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.2-5.1">Forcing a forward secrecy exchange when a participant leaves a shared chat context<a href="#section-1.1.2-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-5.2">Making use of an outbound port with a different physical network connection.<a href="#section-1.1.2-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-5.3">Establishing communication to a different host.<a href="#section-1.1.2-5.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.1.2-5.4">Pre-empt (i.e. abandon) transfer of large datagrams in mid transfer.<a href="#section-1.1.2-5.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-1.1.2-6">The API exposes the following object classes:<a href="#section-1.1.2-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1.2-7">
            <dt id="section-1.1.2-7.1">Connection</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.2-7.2">
              <p id="section-1.1.2-7.2.1">Reports the connection status, supports creation of new Streams.<a href="#section-1.1.2-7.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.2-7.3">Transactional Stream Initiator</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.2-7.4">
              <p id="section-1.1.2-7.4.1">Supports the Post method comprising sending a request to the service to which the stream is bound and waiting for a response.<a href="#section-1.1.2-7.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.2-7.5">Transactional Stream Responder</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.2-7.6">
              <p id="section-1.1.2-7.6.1">Is generated on receipt of a service request to which it is dispatched to obtain the service response.<a href="#section-1.1.2-7.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.2-7.7">Asynchronous Stream Sender</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.2-7.8">
              <p id="section-1.1.2-7.8.1">Allows transmission of a sequence of datagrams to a receiver. Reports stream properties set by the receiver.<a href="#section-1.1.2-7.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.2-7.9">Asynchronous Stream Receiver</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.2-7.10">
              <p id="section-1.1.2-7.10.1">Receives a continuous sequence of datagrams from the sender. Allows setting of stream properties.<a href="#section-1.1.2-7.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.2-7.11">Datagram</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.2-7.12">
              <p id="section-1.1.2-7.12.1">Exposes the packet data relevant transmission information.<a href="#section-1.1.2-7.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.1.2-7.13">Stream Creation Ticket</dt>
            <dd style="margin-left: 1.5em" id="section-1.1.2-7.14">
              <p id="section-1.1.2-7.14.1">A stream creation ticket is a record created by an issuer device consisting of a stream identifier, a set of network endpoints, a shared secret and the issuer device's credential.<a href="#section-1.1.2-7.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-1.1.2-8">The details of the RUD API are out of scope for this specification.<a href="#section-1.1.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-use-cases">
<section id="section-1.2">
        <h3 id="name-use-cases">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
        </h3>
<p id="section-1.2-1">Despite representing a modest incremental advance on the complexity of TCP and a substantial reduction in complexity compared to TLS, RUD provides support for a wide range of use cases outside the scope of either.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<div id="n-network-agility">
<section id="section-1.2.1">
          <h4 id="name-network-agility">
<a href="#section-1.2.1" class="section-number selfRef">1.2.1. </a><a href="#name-network-agility" class="section-name selfRef">Network Agility</a>
          </h4>
<p id="section-1.2.1-1">The separation of RUD streams from the network ports through which they are realized allows network agility to be supported without any additional complexity.<a href="#section-1.2.1-1" class="pilcrow">¶</a></p>
<p id="section-1.2.1-2">For example, Alice joins a conference call from her mobile phone in her home office. When she leaves for work in her car, the connection to her conference call is transferred seamlessly from hew home WiFi service to her mobile carrier.<a href="#section-1.2.1-2" class="pilcrow">¶</a></p>
<span id="name-alice-maintains-connection-"></span><figure id="figure-6">
            <div class="artwork art-svg alignLeft" id="section-1.2.1-3.1">
<svg xmlns="http://www.w3.org/2000/svg" width="512" height="345" viewBox="0 0 512.0 345.0">
                <g transform="translate(8,16)">
                  <path d="M 0,0 L 160,0" fill="none" stroke="black"></path>
                  <path d="M 336,0 L 496,0" fill="none" stroke="black"></path>
                  <path d="M 32,48 L 128,48" fill="none" stroke="black"></path>
                  <path d="M 368,48 L 464,48" fill="none" stroke="black"></path>
                  <path d="M 216,64 L 280,64" fill="none" stroke="black"></path>
                  <path d="M 32,80 L 128,80" fill="none" stroke="black"></path>
                  <path d="M 368,80 L 464,80" fill="none" stroke="black"></path>
                  <path d="M 32,112 L 80,112" fill="none" stroke="black"></path>
                  <path d="M 80,112 L 128,112" fill="none" stroke="black"></path>
                  <path d="M 368,112 L 416,112" fill="none" stroke="black"></path>
                  <path d="M 416,112 L 464,112" fill="none" stroke="black"></path>
                  <path d="M 0,128 L 80,128" fill="none" stroke="black"></path>
                  <path d="M 80,128 L 160,128" fill="none" stroke="black"></path>
                  <path d="M 336,128 L 416,128" fill="none" stroke="black"></path>
                  <path d="M 416,128 L 496,128" fill="none" stroke="black"></path>
                  <path d="M 80,160 L 224,160" fill="none" stroke="black"></path>
                  <path d="M 280,160 L 416,160" fill="none" stroke="black"></path>
                  <path d="M 168,192 L 224,192" fill="none" stroke="black"></path>
                  <path d="M 224,192 L 280,192" fill="none" stroke="black"></path>
                  <path d="M 280,192 L 328,192" fill="none" stroke="black"></path>
                  <path d="M 200,208 L 224,208" fill="none" stroke="black"></path>
                  <path d="M 224,208 L 280,208" fill="none" stroke="black"></path>
                  <path d="M 280,208 L 296,208" fill="none" stroke="black"></path>
                  <path d="M 200,240 L 296,240" fill="none" stroke="black"></path>
                  <path d="M 200,272 L 248,272" fill="none" stroke="black"></path>
                  <path d="M 248,272 L 296,272" fill="none" stroke="black"></path>
                  <path d="M 168,320 L 328,320" fill="none" stroke="black"></path>
                  <path d="M 0,0 L 0,128" fill="none" stroke="black"></path>
                  <path d="M 32,48 L 32,80" fill="none" stroke="black"></path>
                  <path d="M 32,80 L 32,112" fill="none" stroke="black"></path>
                  <path d="M 80,112 L 80,128" fill="none" stroke="black"></path>
                  <path d="M 80,128 L 80,160" fill="none" stroke="black"></path>
                  <path d="M 128,48 L 128,80" fill="none" stroke="black"></path>
                  <path d="M 128,80 L 128,112" fill="none" stroke="black"></path>
                  <path d="M 160,0 L 160,128" fill="none" stroke="black"></path>
                  <path d="M 168,192 L 168,320" fill="none" stroke="black"></path>
                  <path d="M 200,208 L 200,240" fill="none" stroke="black"></path>
                  <path d="M 200,240 L 200,272" fill="none" stroke="black"></path>
                  <path d="M 224,160 L 224,192" fill="none" stroke="black"></path>
                  <path d="M 224,192 L 224,208" fill="none" stroke="black"></path>
                  <path d="M 280,160 L 280,192" fill="none" stroke="black"></path>
                  <path d="M 280,192 L 280,208" fill="none" stroke="black"></path>
                  <path d="M 296,208 L 296,240" fill="none" stroke="black"></path>
                  <path d="M 296,240 L 296,272" fill="none" stroke="black"></path>
                  <path d="M 328,192 L 328,320" fill="none" stroke="black"></path>
                  <path d="M 336,0 L 336,128" fill="none" stroke="black"></path>
                  <path d="M 368,48 L 368,80" fill="none" stroke="black"></path>
                  <path d="M 368,80 L 368,112" fill="none" stroke="black"></path>
                  <path d="M 416,112 L 416,128" fill="none" stroke="black"></path>
                  <path d="M 416,128 L 416,160" fill="none" stroke="black"></path>
                  <path d="M 464,48 L 464,80" fill="none" stroke="black"></path>
                  <path d="M 464,80 L 464,112" fill="none" stroke="black"></path>
                  <path d="M 496,0 L 496,128" fill="none" stroke="black"></path>
                  <polygon points="288.000000,64.000000 276.000000,58.400002 276.000000,69.599998" fill="black" transform="rotate(0.000000, 280.000000, 64.000000)"></polygon>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="36">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="52">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="104" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="400" y="36">I</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="36">)</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="52">L</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="100">F</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="228">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="260">9</text>
                  <text text-anchor="middle" font-family="sans-serif" x="408" y="36">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="400" y="100">G</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="228">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="260">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="52">v</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="68">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="100">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="36">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="68">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="68">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="100">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="228">L</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="308">B</text>
                  <text text-anchor="middle" font-family="sans-serif" x="48" y="36">(</text>
                  <text text-anchor="middle" font-family="sans-serif" x="392" y="36">(</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="52">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="52">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="68">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="48" y="100">W</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="260">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="36">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="36">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="392" y="68">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="100">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="260">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="260">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="400" y="20">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="52">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="52">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="408" y="68">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="68">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="68">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="104" y="100">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="260">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="408" y="20">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="36">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="52">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="68">3</text>
                  <text text-anchor="middle" font-family="sans-serif" x="392" y="100">4</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="228">N</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="52">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="68">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="100">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="228">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="112" y="68">3</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="100">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="100">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="308">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">h</text>
                  <text text-anchor="middle" font-family="sans-serif" x="112" y="36">)</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="260">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="52">h</text>
                  <text text-anchor="middle" font-family="sans-serif" x="112" y="100">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="100">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="228">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="68">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="80" y="68">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="400" y="68">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="100">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="228">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="308">b</text>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-alice-maintains-connection-" class="selfRef">Alice maintains connection to her conference call when moving from her home to her office.</a>
            </figcaption></figure>
<p id="section-1.2.1-4">The same approach <span class="bcp14">MAY</span> be employed to provide fault tolerance in an enterprise server hosting environment.<a href="#section-1.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-connection-transfer-and-delegation">
<section id="section-1.2.2">
          <h4 id="name-connection-transfer-and-del">
<a href="#section-1.2.2" class="section-number selfRef">1.2.2. </a><a href="#name-connection-transfer-and-del" class="section-name selfRef">Connection Transfer and Delegation</a>
          </h4>
<p id="section-1.2.2-1">It is frequently desirable for a device to negotiate delivery of a service with one host that will ultimately be delivered by another. RUD supports the issue of a 'ticket' credential by a host providing a discovery service that <span class="bcp14">MAY</span> be used to establish a connection with the host that will deliver the requested service:<a href="#section-1.2.2-1" class="pilcrow">¶</a></p>
<span id="name-connection-establishment-by"></span><figure id="figure-7">
            <div class="artwork art-svg alignLeft" id="section-1.2.2-2.1">
<svg xmlns="http://www.w3.org/2000/svg" width="552" height="185" viewBox="0 0 552.0 185.0">
                <g transform="translate(8,16)">
                  <path d="M 0,0 L 128,0" fill="none" stroke="black"></path>
                  <path d="M 208,0 L 336,0" fill="none" stroke="black"></path>
                  <path d="M 400,0 L 528,0" fill="none" stroke="black"></path>
                  <path d="M 0,48 L 64,48" fill="none" stroke="black"></path>
                  <path d="M 64,48 L 128,48" fill="none" stroke="black"></path>
                  <path d="M 208,48 L 272,48" fill="none" stroke="black"></path>
                  <path d="M 272,48 L 336,48" fill="none" stroke="black"></path>
                  <path d="M 400,48 L 464,48" fill="none" stroke="black"></path>
                  <path d="M 464,48 L 528,48" fill="none" stroke="black"></path>
                  <path d="M 64,80 L 72,80" fill="none" stroke="black"></path>
                  <path d="M 256,80 L 264,80" fill="none" stroke="black"></path>
                  <path d="M 72,96 L 104,96" fill="none" stroke="black"></path>
                  <path d="M 224,96 L 272,96" fill="none" stroke="black"></path>
                  <path d="M 64,128 L 168,128" fill="none" stroke="black"></path>
                  <path d="M 368,128 L 472,128" fill="none" stroke="black"></path>
                  <path d="M 72,144 L 184,144" fill="none" stroke="black"></path>
                  <path d="M 360,144 L 480,144" fill="none" stroke="black"></path>
                  <path d="M 0,0 L 0,48" fill="none" stroke="black"></path>
                  <path d="M 64,48 L 64,80" fill="none" stroke="black"></path>
                  <path d="M 64,80 L 64,128" fill="none" stroke="black"></path>
                  <path d="M 64,128 L 64,160" fill="none" stroke="black"></path>
                  <path d="M 128,0 L 128,48" fill="none" stroke="black"></path>
                  <path d="M 208,0 L 208,48" fill="none" stroke="black"></path>
                  <path d="M 272,48 L 272,96" fill="none" stroke="black"></path>
                  <path d="M 272,96 L 272,112" fill="none" stroke="black"></path>
                  <path d="M 272,152 L 272,168" fill="none" stroke="black"></path>
                  <path d="M 336,0 L 336,48" fill="none" stroke="black"></path>
                  <path d="M 400,0 L 400,48" fill="none" stroke="black"></path>
                  <path d="M 480,64 L 480,144" fill="none" stroke="black"></path>
                  <path d="M 480,144 L 480,160" fill="none" stroke="black"></path>
                  <path d="M 528,0 L 528,48" fill="none" stroke="black"></path>
                  <path d="M 480,56 L 480,64" fill="none" stroke="black"></path>
                  <polygon points="80.000000,96.000000 68.000000,90.400002 68.000000,101.599998" fill="black" transform="rotate(180.000000, 72.000000, 96.000000)"></polygon>
                  <polygon points="80.000000,144.000000 68.000000,138.399994 68.000000,149.600006" fill="black" transform="rotate(180.000000, 72.000000, 144.000000)"></polygon>
                  <polygon points="272.000000,80.000000 260.000000,74.400002 260.000000,85.599998" fill="black" transform="rotate(0.000000, 264.000000, 80.000000)"></polygon>
                  <polygon points="480.000000,128.000000 468.000000,122.400002 468.000000,133.600006" fill="black" transform="rotate(0.000000, 472.000000, 128.000000)"></polygon>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="84">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="160" y="100">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="148">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="160" y="84">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="84">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="132">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="20">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">p</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="36">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="128" y="84">v</text>
                  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">D</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="36">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="84">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="148">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="132">h</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="132">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="36">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="144" y="84">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">(</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="132">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="36">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="36">v</text>
                  <text text-anchor="middle" font-family="sans-serif" x="152" y="100">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="148">x</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="20">y</text>
                  <text text-anchor="middle" font-family="sans-serif" x="488" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="128" y="100">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="20">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="20">p</text>
                  <text text-anchor="middle" font-family="sans-serif" x="120" y="100">T</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="100">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="148">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="148">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="148">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="100">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="132">E</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="132">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="456" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="148">E</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="20">v</text>
                  <text text-anchor="middle" font-family="sans-serif" x="104" y="84">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="84">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="132">)</text>
                  <text text-anchor="middle" font-family="sans-serif" x="496" y="20">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="456" y="36">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="472" y="36">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="168" y="84">p</text>
                  <text text-anchor="middle" font-family="sans-serif" x="136" y="100">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="480" y="36">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="148">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="464" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="132">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="148">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="148">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="488" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="148">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="100">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="132">y</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="84">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="112" y="84">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="132">K</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="148">)</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="20">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="84">D</text>
                  <text text-anchor="middle" font-family="sans-serif" x="136" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="168" y="100">,</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="132">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="144" y="100">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="132">T</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="148">p</text>
                  <text text-anchor="middle" font-family="sans-serif" x="120" y="84">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="84">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="100">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="464" y="36">v</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="148">h</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="132">x</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="480" y="20">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="36">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="176" y="84">p</text>
                  <text text-anchor="middle" font-family="sans-serif" x="504" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="148">(</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="148">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="132">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="148">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">v</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">D</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="472" y="20">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="132">,</text>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-connection-establishment-by" class="selfRef">Connection establishment by means of a discovery service.</a>
            </figcaption></figure>
<p id="section-1.2.2-3">The same capability <span class="bcp14">MAY</span> be applied to enable hosts to direct connected devices to seek service from a different host, either immediately or in case of service interruption. This allows for greater flexibility in configuring systems to provide fault tolerance and to effect load balancing strategies.<a href="#section-1.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-presence">
<section id="section-1.2.3">
          <h4 id="name-presence">
<a href="#section-1.2.3" class="section-number selfRef">1.2.3. </a><a href="#name-presence" class="section-name selfRef">Presence</a>
          </h4>
<p id="section-1.2.3-1">Presence is a particular form of connection transfer. A presence service facilitates creation of a voice or video connection between the device used by the initiator to make the request to one of the multiple receiver devices on which it might be accepted.<a href="#section-1.2.3-1" class="pilcrow">¶</a></p>
<p id="section-1.2.3-2">Each receiver device maintains a connection to the presence service that is active whenever the receiver device is available to accept calls. To request a connection, the initiator device contacts the presence service which determines if the request is authorized and if so, returns the ticket and network endpoint information required to  establish a connection.<a href="#section-1.2.3-2" class="pilcrow">¶</a></p>
<p id="section-1.2.3-3">For example, Bob's phone connects to the presence service and provides a ticket and network endpoint information to enable calls to be placed. When Alice attempts to place a call, her device contacts the presence service, which checks that Bob has authorized Alice to interrupt her work. Alice's device uses the information from the presence service to perform a forward secrecy operation against Bob's phone and thus achieve full end-to-end secure communication.<a href="#section-1.2.3-3" class="pilcrow">¶</a></p>
<span id="name-alice-contacts-bob-through-"></span><figure id="figure-8">
            <div class="artwork art-svg alignLeft" id="section-1.2.3-4.1">
<svg xmlns="http://www.w3.org/2000/svg" width="536" height="281" viewBox="0 0 536.0 281.0">
                <g transform="translate(8,16)">
                  <path d="M 0,0 L 128,0" fill="none" stroke="black"></path>
                  <path d="M 192,0 L 320,0" fill="none" stroke="black"></path>
                  <path d="M 384,0 L 512,0" fill="none" stroke="black"></path>
                  <path d="M 0,48 L 64,48" fill="none" stroke="black"></path>
                  <path d="M 64,48 L 128,48" fill="none" stroke="black"></path>
                  <path d="M 192,48 L 256,48" fill="none" stroke="black"></path>
                  <path d="M 256,48 L 320,48" fill="none" stroke="black"></path>
                  <path d="M 384,48 L 448,48" fill="none" stroke="black"></path>
                  <path d="M 448,48 L 512,48" fill="none" stroke="black"></path>
                  <path d="M 264,80 L 288,80" fill="none" stroke="black"></path>
                  <path d="M 64,96 L 88,96" fill="none" stroke="black"></path>
                  <path d="M 192,128 L 256,128" fill="none" stroke="black"></path>
                  <path d="M 256,128 L 320,128" fill="none" stroke="black"></path>
                  <path d="M 192,160 L 256,160" fill="none" stroke="black"></path>
                  <path d="M 256,160 L 320,160" fill="none" stroke="black"></path>
                  <path d="M 72,192 L 96,192" fill="none" stroke="black"></path>
                  <path d="M 64,224 L 160,224" fill="none" stroke="black"></path>
                  <path d="M 72,240 L 176,240" fill="none" stroke="black"></path>
                  <path d="M 0,0 L 0,48" fill="none" stroke="black"></path>
                  <path d="M 64,48 L 64,96" fill="none" stroke="black"></path>
                  <path d="M 64,96 L 64,224" fill="none" stroke="black"></path>
                  <path d="M 64,224 L 64,256" fill="none" stroke="black"></path>
                  <path d="M 128,0 L 128,48" fill="none" stroke="black"></path>
                  <path d="M 192,0 L 192,48" fill="none" stroke="black"></path>
                  <path d="M 192,128 L 192,160" fill="none" stroke="black"></path>
                  <path d="M 256,48 L 256,128" fill="none" stroke="black"></path>
                  <path d="M 256,160 L 256,192" fill="none" stroke="black"></path>
                  <path d="M 256,192 L 256,208" fill="none" stroke="black"></path>
                  <path d="M 256,248 L 256,264" fill="none" stroke="black"></path>
                  <path d="M 320,0 L 320,48" fill="none" stroke="black"></path>
                  <path d="M 320,128 L 320,160" fill="none" stroke="black"></path>
                  <path d="M 384,0 L 384,48" fill="none" stroke="black"></path>
                  <path d="M 448,48 L 448,80" fill="none" stroke="black"></path>
                  <path d="M 448,80 L 448,240" fill="none" stroke="black"></path>
                  <path d="M 448,240 L 448,256" fill="none" stroke="black"></path>
                  <path d="M 512,0 L 512,48" fill="none" stroke="black"></path>
                  <polygon points="80.000000,192.000000 68.000000,186.399994 68.000000,197.600006" fill="black" transform="rotate(180.000000, 72.000000, 192.000000)"></polygon>
                  <polygon points="80.000000,240.000000 68.000000,234.399994 68.000000,245.600006" fill="black" transform="rotate(180.000000, 72.000000, 240.000000)"></polygon>
                  <polygon points="272.000000,80.000000 260.000000,74.400002 260.000000,85.599998" fill="black" transform="rotate(180.000000, 264.000000, 80.000000)"></polygon>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="244">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="244">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="112" y="100">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="148">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="196">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="228">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="376" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="392" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="100">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="100">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="100">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="196">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="36">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="84">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="100">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="176" y="228">T</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="228">x</text>
                  <text text-anchor="middle" font-family="sans-serif" x="152" y="196">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="228">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="228">&gt;</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="244">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="36">v</text>
                  <text text-anchor="middle" font-family="sans-serif" x="152" y="100">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="196">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="228">,</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="128" y="100">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="148">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="36">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="196">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="148">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="148">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="120" y="196">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="408" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="84">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="136" y="100">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="228">E</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="244">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="244">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="112" y="196">T</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="228">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="244">E</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="244">h</text>
                  <text text-anchor="middle" font-family="sans-serif" x="392" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="100">)</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="244">x</text>
                  <text text-anchor="middle" font-family="sans-serif" x="408" y="84">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="100">B</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="148">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="136" y="196">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="228">K</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="228">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="84">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="368" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="100">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="104" y="100">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="160" y="196">,</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="228">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="228">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="228">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="84">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="84">,</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="148">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="228">h</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="384" y="84">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="100">&gt;</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="228">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="168" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="384" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="84">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="84">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="148">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="148">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="196">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="244">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">B</text>
                  <text text-anchor="middle" font-family="sans-serif" x="376" y="84">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="148">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="228">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="244">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="128" y="196">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="176" y="196">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="20">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="84">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="84">T</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="84">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="120" y="100">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="196">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="392" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="376" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="36">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="368" y="84">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="400" y="84">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="244">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="244">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="400" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="20">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="104" y="196">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="408" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="176" y="100">(</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="100">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="148">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="228">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="244">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="368" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="456" y="20">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="144" y="196">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="228">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="400" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="196">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="196">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="384" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="144" y="100">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="148">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="244">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="360" y="228">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="244">p</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="36">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="160" y="100">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="100">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="196">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="228">y</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="244">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="360" y="244">-</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="148">n</text>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-alice-contacts-bob-through-" class="selfRef">Alice contacts Bob through a presence service.</a>
            </figcaption></figure>
<p id="section-1.2.3-5">Contrawise, when Suzy spammer attempts to contact Bob to tell him the warranty on his rocket ship is about to expire, the presence service notes that Suzy spammer is not in Bob's contact list and refuses to allow the interruption. Bob's access control policy may allow Suzy spammer to make a contact exchange request, but it is rather likely that her reputation for wasting people's time will result in that request being rejected.<a href="#section-1.2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-nat-transit">
<section id="section-1.2.4">
          <h4 id="name-nat-transit">
<a href="#section-1.2.4" class="section-number selfRef">1.2.4. </a><a href="#name-nat-transit" class="section-name selfRef">NAT Transit</a>
          </h4>
<p id="section-1.2.4-1">The deployment of Network Address Translation (NAT) devices in the network represents a real world constraint that every modern network application has to work around if it is to be successful. NAT devices may be broadly regarded as belonging to two distinct categories.<a href="#section-1.2.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.2.4-2">
            <dt id="section-1.2.4-2.1">Wide Cone NAT</dt>
            <dd style="margin-left: 1.5em" id="section-1.2.4-2.2">
              <p id="section-1.2.4-2.2.1">When a device inside the network attempts to establish a UDP connection to a remote device, the NAT selects an outbound UDP source port for forwarding. All inbound UDP packets specifying that port are forwarded to that device regardless of the source address.<a href="#section-1.2.4-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-1.2.4-2.3">Narrow Cone NAT + Firewall NAT</dt>
            <dd style="margin-left: 1.5em" id="section-1.2.4-2.4">
              <p id="section-1.2.4-2.4.1">All NAT devices that present a more restrictive policy. These include enterprise firewalls that require devices inside the network to explicitly request forwarding from external UDP ports (pinhole routing).<a href="#section-1.2.4-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-1.2.4-3">Since the protocols used to support NAT devices other than Wide Cone are typically proprietary, these are outside the scope of this specification.<a href="#section-1.2.4-3" class="pilcrow">¶</a></p>
<p id="section-1.2.4-4">One of the many inconveniences of being required to support NAT is that the external port binding may change without notice. In some cases, an external port is only kept open for as long as it is in use with timeouts of a second or less being common.<a href="#section-1.2.4-4" class="pilcrow">¶</a></p>
<p id="section-1.2.4-5">Enabling NAT transit during reconfiguration represents a special case of network agility. The network endpoint can change but the stream identifiers remain constant. A change to the NAT configuration causes inbound packets to be dropped temporarily but the stream is quickly re-established when an outbound packet is sent.<a href="#section-1.2.4-5" class="pilcrow">¶</a></p>
<span id="name-wide-cone-nat-configuration"></span><figure id="figure-9">
            <div class="artwork art-svg alignLeft" id="section-1.2.4-6.1">
<svg xmlns="http://www.w3.org/2000/svg" width="528" height="281" viewBox="0 0 528.0 281.0">
                <g transform="translate(8,16)">
                  <path d="M 0,0 L 128,0" fill="none" stroke="black"></path>
                  <path d="M 152,0 L 216,0" fill="none" stroke="black"></path>
                  <path d="M 384,0 L 512,0" fill="none" stroke="black"></path>
                  <path d="M 0,32 L 64,32" fill="none" stroke="black"></path>
                  <path d="M 64,32 L 128,32" fill="none" stroke="black"></path>
                  <path d="M 152,32 L 184,32" fill="none" stroke="black"></path>
                  <path d="M 184,32 L 216,32" fill="none" stroke="black"></path>
                  <path d="M 384,32 L 448,32" fill="none" stroke="black"></path>
                  <path d="M 448,32 L 512,32" fill="none" stroke="black"></path>
                  <path d="M 64,64 L 136,64" fill="none" stroke="black"></path>
                  <path d="M 168,64 L 176,64" fill="none" stroke="black"></path>
                  <path d="M 192,64 L 400,64" fill="none" stroke="black"></path>
                  <path d="M 432,64 L 440,64" fill="none" stroke="black"></path>
                  <path d="M 72,80 L 80,80" fill="none" stroke="black"></path>
                  <path d="M 112,80 L 176,80" fill="none" stroke="black"></path>
                  <path d="M 192,80 L 200,80" fill="none" stroke="black"></path>
                  <path d="M 232,80 L 448,80" fill="none" stroke="black"></path>
                  <path d="M 64,96 L 136,96" fill="none" stroke="black"></path>
                  <path d="M 168,96 L 176,96" fill="none" stroke="black"></path>
                  <path d="M 192,96 L 400,96" fill="none" stroke="black"></path>
                  <path d="M 432,96 L 440,96" fill="none" stroke="black"></path>
                  <path d="M 72,112 L 80,112" fill="none" stroke="black"></path>
                  <path d="M 112,112 L 176,112" fill="none" stroke="black"></path>
                  <path d="M 192,112 L 200,112" fill="none" stroke="black"></path>
                  <path d="M 232,112 L 448,112" fill="none" stroke="black"></path>
                  <path d="M 72,128 L 80,128" fill="none" stroke="black"></path>
                  <path d="M 112,128 L 176,128" fill="none" stroke="black"></path>
                  <path d="M 192,128 L 200,128" fill="none" stroke="black"></path>
                  <path d="M 232,128 L 448,128" fill="none" stroke="black"></path>
                  <path d="M 192,192 L 200,192" fill="none" stroke="black"></path>
                  <path d="M 232,192 L 448,192" fill="none" stroke="black"></path>
                  <path d="M 192,208 L 200,208" fill="none" stroke="black"></path>
                  <path d="M 232,208 L 448,208" fill="none" stroke="black"></path>
                  <path d="M 64,224 L 136,224" fill="none" stroke="black"></path>
                  <path d="M 168,224 L 176,224" fill="none" stroke="black"></path>
                  <path d="M 192,224 L 400,224" fill="none" stroke="black"></path>
                  <path d="M 432,224 L 440,224" fill="none" stroke="black"></path>
                  <path d="M 72,240 L 80,240" fill="none" stroke="black"></path>
                  <path d="M 112,240 L 176,240" fill="none" stroke="black"></path>
                  <path d="M 192,240 L 200,240" fill="none" stroke="black"></path>
                  <path d="M 232,240 L 448,240" fill="none" stroke="black"></path>
                  <path d="M 0,0 L 0,32" fill="none" stroke="black"></path>
                  <path d="M 64,32 L 64,64" fill="none" stroke="black"></path>
                  <path d="M 64,64 L 64,96" fill="none" stroke="black"></path>
                  <path d="M 64,96 L 64,224" fill="none" stroke="black"></path>
                  <path d="M 64,224 L 64,256" fill="none" stroke="black"></path>
                  <path d="M 128,0 L 128,32" fill="none" stroke="black"></path>
                  <path d="M 152,0 L 152,32" fill="none" stroke="black"></path>
                  <path d="M 184,32 L 184,144" fill="none" stroke="black"></path>
                  <path d="M 184,176 L 184,256" fill="none" stroke="black"></path>
                  <path d="M 216,0 L 216,32" fill="none" stroke="black"></path>
                  <path d="M 384,0 L 384,32" fill="none" stroke="black"></path>
                  <path d="M 448,32 L 448,80" fill="none" stroke="black"></path>
                  <path d="M 448,80 L 448,112" fill="none" stroke="black"></path>
                  <path d="M 448,112 L 448,128" fill="none" stroke="black"></path>
                  <path d="M 448,128 L 448,192" fill="none" stroke="black"></path>
                  <path d="M 448,192 L 448,208" fill="none" stroke="black"></path>
                  <path d="M 448,208 L 448,240" fill="none" stroke="black"></path>
                  <path d="M 448,240 L 448,256" fill="none" stroke="black"></path>
                  <path d="M 512,0 L 512,32" fill="none" stroke="black"></path>
                  <polygon points="80.000000,80.000000 68.000000,74.400002 68.000000,85.599998" fill="black" transform="rotate(180.000000, 72.000000, 80.000000)"></polygon>
                  <polygon points="80.000000,112.000000 68.000000,106.400002 68.000000,117.599998" fill="black" transform="rotate(180.000000, 72.000000, 112.000000)"></polygon>
                  <polygon points="80.000000,128.000000 68.000000,122.400002 68.000000,133.600006" fill="black" transform="rotate(180.000000, 72.000000, 128.000000)"></polygon>
                  <polygon points="80.000000,240.000000 68.000000,234.399994 68.000000,245.600006" fill="black" transform="rotate(180.000000, 72.000000, 240.000000)"></polygon>
                  <polygon points="184.000000,64.000000 172.000000,58.400002 172.000000,69.599998" fill="black" transform="rotate(0.000000, 176.000000, 64.000000)"></polygon>
                  <polygon points="184.000000,96.000000 172.000000,90.400002 172.000000,101.599998" fill="black" transform="rotate(0.000000, 176.000000, 96.000000)"></polygon>
                  <polygon points="184.000000,224.000000 172.000000,218.399994 172.000000,229.600006" fill="black" transform="rotate(0.000000, 176.000000, 224.000000)"></polygon>
                  <polygon points="200.000000,80.000000 188.000000,74.400002 188.000000,85.599998" fill="black" transform="rotate(180.000000, 192.000000, 80.000000)"></polygon>
                  <polygon points="200.000000,112.000000 188.000000,106.400002 188.000000,117.599998" fill="black" transform="rotate(180.000000, 192.000000, 112.000000)"></polygon>
                  <polygon points="200.000000,128.000000 188.000000,122.400002 188.000000,133.600006" fill="black" transform="rotate(180.000000, 192.000000, 128.000000)"></polygon>
                  <polygon points="200.000000,192.000000 188.000000,186.399994 188.000000,197.600006" fill="black" transform="rotate(180.000000, 192.000000, 192.000000)"></polygon>
                  <polygon points="200.000000,208.000000 188.000000,202.399994 188.000000,213.600006" fill="black" transform="rotate(180.000000, 192.000000, 208.000000)"></polygon>
                  <polygon points="200.000000,240.000000 188.000000,234.399994 188.000000,245.600006" fill="black" transform="rotate(180.000000, 192.000000, 240.000000)"></polygon>
                  <polygon points="448.000000,64.000000 436.000000,58.400002 436.000000,69.599998" fill="black" transform="rotate(0.000000, 440.000000, 64.000000)"></polygon>
                  <polygon points="448.000000,96.000000 436.000000,90.400002 436.000000,101.599998" fill="black" transform="rotate(0.000000, 440.000000, 96.000000)"></polygon>
                  <polygon points="448.000000,224.000000 436.000000,218.399994 436.000000,229.600006" fill="black" transform="rotate(0.000000, 440.000000, 224.000000)"></polygon>
                  <text text-anchor="middle" font-family="sans-serif" x="152" y="100">4</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="228">4</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">v</text>
                  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="20">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="152" y="68">4</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="68">4</text>
                  <text text-anchor="middle" font-family="sans-serif" x="176" y="20">N</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">v</text>
                  <text text-anchor="middle" font-family="sans-serif" x="472" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="132">9</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="164">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="20">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="456" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="84">9</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="116">9</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="116">9</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="164">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="164">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="196">9</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="20">T</text>
                  <text text-anchor="middle" font-family="sans-serif" x="152" y="164">N</text>
                  <text text-anchor="middle" font-family="sans-serif" x="168" y="164">T</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="164">h</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="464" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">9</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">9</text>
                  <text text-anchor="middle" font-family="sans-serif" x="160" y="164">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="152" y="228">4</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="244">9</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="100">4</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="164">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="212">9</text>
                  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">D</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="164">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="244">9</text>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-wide-cone-nat-configuration" class="selfRef">Wide cone NAT configuration.</a>
            </figcaption></figure>
<p id="section-1.2.4-7">The interaction of NAT transit with presence service presents a particular concern when interactions between the parties are infrequent.<a href="#section-1.2.4-7" class="pilcrow">¶</a></p>
<p id="section-1.2.4-8">For example, consider the case in which a digital camera is connected to a photo archive on a remote host that is behind a NAT device. This would commonly occur in situations in which Alice wants photographs to be automatically uploaded to the file storage in her house as soon as they are captured.<a href="#section-1.2.4-8" class="pilcrow">¶</a></p>
<p id="section-1.2.4-9">Rather than requiring the Archive device to maintain a constant RUD stream to every device that might possibly require access, the Archive device maintains a constant stream to the presence service which can then provide devices it has helped establish a connection with the necessary information to resume the stream:<a href="#section-1.2.4-9" class="pilcrow">¶</a></p>
<span id="name-brokered-nat-transit"></span><figure id="figure-10">
            <div class="artwork art-svg alignLeft" id="section-1.2.4-10.1">
<svg xmlns="http://www.w3.org/2000/svg" width="536" height="265" viewBox="0 0 536.0 265.0">
                <g transform="translate(8,16)">
                  <path d="M 0,0 L 128,0" fill="none" stroke="black"></path>
                  <path d="M 192,0 L 320,0" fill="none" stroke="black"></path>
                  <path d="M 384,0 L 512,0" fill="none" stroke="black"></path>
                  <path d="M 0,48 L 64,48" fill="none" stroke="black"></path>
                  <path d="M 64,48 L 128,48" fill="none" stroke="black"></path>
                  <path d="M 192,48 L 256,48" fill="none" stroke="black"></path>
                  <path d="M 256,48 L 320,48" fill="none" stroke="black"></path>
                  <path d="M 384,48 L 448,48" fill="none" stroke="black"></path>
                  <path d="M 448,48 L 512,48" fill="none" stroke="black"></path>
                  <path d="M 264,80 L 320,80" fill="none" stroke="black"></path>
                  <path d="M 376,80 L 448,80" fill="none" stroke="black"></path>
                  <path d="M 72,112 L 88,112" fill="none" stroke="black"></path>
                  <path d="M 240,112 L 248,112" fill="none" stroke="black"></path>
                  <path d="M 72,128 L 168,128" fill="none" stroke="black"></path>
                  <path d="M 328,128 L 440,128" fill="none" stroke="black"></path>
                  <path d="M 264,192 L 320,192" fill="none" stroke="black"></path>
                  <path d="M 376,192 L 448,192" fill="none" stroke="black"></path>
                  <path d="M 72,208 L 128,208" fill="none" stroke="black"></path>
                  <path d="M 184,208 L 256,208" fill="none" stroke="black"></path>
                  <path d="M 72,224 L 168,224" fill="none" stroke="black"></path>
                  <path d="M 328,224 L 440,224" fill="none" stroke="black"></path>
                  <path d="M 0,0 L 0,48" fill="none" stroke="black"></path>
                  <path d="M 64,48 L 64,240" fill="none" stroke="black"></path>
                  <path d="M 128,0 L 128,48" fill="none" stroke="black"></path>
                  <path d="M 192,0 L 192,48" fill="none" stroke="black"></path>
                  <path d="M 256,48 L 256,112" fill="none" stroke="black"></path>
                  <path d="M 256,144 L 256,208" fill="none" stroke="black"></path>
                  <path d="M 256,232 L 256,248" fill="none" stroke="black"></path>
                  <path d="M 320,0 L 320,48" fill="none" stroke="black"></path>
                  <path d="M 384,0 L 384,48" fill="none" stroke="black"></path>
                  <path d="M 448,48 L 448,80" fill="none" stroke="black"></path>
                  <path d="M 448,80 L 448,144" fill="none" stroke="black"></path>
                  <path d="M 448,176 L 448,192" fill="none" stroke="black"></path>
                  <path d="M 448,192 L 448,240" fill="none" stroke="black"></path>
                  <path d="M 512,0 L 512,48" fill="none" stroke="black"></path>
                  <polygon points="80.000000,112.000000 68.000000,106.400002 68.000000,117.599998" fill="black" transform="rotate(180.000000, 72.000000, 112.000000)"></polygon>
                  <polygon points="80.000000,128.000000 68.000000,122.400002 68.000000,133.600006" fill="black" transform="rotate(180.000000, 72.000000, 128.000000)"></polygon>
                  <polygon points="80.000000,208.000000 68.000000,202.399994 68.000000,213.600006" fill="black" transform="rotate(180.000000, 72.000000, 208.000000)"></polygon>
                  <polygon points="80.000000,224.000000 68.000000,218.399994 68.000000,229.600006" fill="black" transform="rotate(180.000000, 72.000000, 224.000000)"></polygon>
                  <polygon points="256.000000,112.000000 244.000000,106.400002 244.000000,117.599998" fill="black" transform="rotate(0.000000, 248.000000, 112.000000)"></polygon>
                  <polygon points="272.000000,80.000000 260.000000,74.400002 260.000000,85.599998" fill="black" transform="rotate(180.000000, 264.000000, 80.000000)"></polygon>
                  <polygon points="272.000000,192.000000 260.000000,186.399994 260.000000,197.600006" fill="black" transform="rotate(180.000000, 264.000000, 192.000000)"></polygon>
                  <polygon points="448.000000,128.000000 436.000000,122.400002 436.000000,133.600006" fill="black" transform="rotate(0.000000, 440.000000, 128.000000)"></polygon>
                  <polygon points="448.000000,224.000000 436.000000,218.399994 436.000000,229.600006" fill="black" transform="rotate(0.000000, 440.000000, 224.000000)"></polygon>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="132">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="132">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="228">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="84">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="116">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="20">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="168" y="212">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="228">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="164">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="164">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="228">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="228">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="128" y="116">u</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="196">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="132">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="132">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="408" y="164">N</text>
                  <text text-anchor="middle" font-family="sans-serif" x="168" y="116">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">h</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="84">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="132">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="132">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="164">h</text>
                  <text text-anchor="middle" font-family="sans-serif" x="160" y="212">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="36">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="132">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="164">T</text>
                  <text text-anchor="middle" font-family="sans-serif" x="360" y="196">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="84">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="152" y="116">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="116">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="144" y="212">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="228">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="132">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="196">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="228">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="112" y="116">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="472" y="164">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="120" y="116">q</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="132">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="472" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="36">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="152" y="212">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="228">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="20">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="36">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="132">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="40" y="20">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="20">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="20">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="228">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="228">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="228">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="228">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="228">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="464" y="20">v</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="196">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="480" y="164">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="228">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="360" y="84">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="116">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="456" y="164">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="176" y="116">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="116">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="116">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="132">D</text>
                  <text text-anchor="middle" font-family="sans-serif" x="464" y="164">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="456" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="104" y="116">R</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="228">D</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="228">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="228">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="144" y="116">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="116">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="36">v</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="36">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="136" y="116">e</text>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-brokered-nat-transit" class="selfRef">Brokered NAT transit.</a>
            </figcaption></figure>
<p id="section-1.2.4-11">Another important concern is the interaction between network agility and NAT transit. Mobile devices frequently operate inside and outside a NAT gated network. Care is required to ensure that a device that establishes a direct connection to another device within the same NAT gated local area network can maintain that connection when it moves to a different network.<a href="#section-1.2.4-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-ipv6-agility">
<section id="section-1.2.5">
          <h4 id="name-ipv6-agility">
<a href="#section-1.2.5" class="section-number selfRef">1.2.5. </a><a href="#name-ipv6-agility" class="section-name selfRef">IPv6 Agility</a>
          </h4>
<p id="section-1.2.5-1">RUD makes no distinction between IPv4 and IPv6 transport. In normal circumstances, an application program does not need to be aware of either the initiator or receiver's address(es).<a href="#section-1.2.5-1" class="pilcrow">¶</a></p>
<p id="section-1.2.5-2">RUD connections <span class="bcp14">MAY</span> be established against either or both simultaneously. RUD is equally tolerant of 4-to-6 and 6-to-4 transmission gateways.<a href="#section-1.2.5-2" class="pilcrow">¶</a></p>
<p id="section-1.2.5-3">In the interest of reducing the impact of IPv4 address exhaustion, public facing RUD services <span class="bcp14">SHOULD</span> provide discovery and service to initiators that only have connection to an IPv6 network.<a href="#section-1.2.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-tunneling">
<section id="section-1.2.6">
          <h4 id="name-tunneling">
<a href="#section-1.2.6" class="section-number selfRef">1.2.6. </a><a href="#name-tunneling" class="section-name selfRef">Tunneling</a>
          </h4>
<p id="section-1.2.6-1">Establishment of an IP tunnel connecting one device to another is required for applications such as onion routing and VPN access.<a href="#section-1.2.6-1" class="pilcrow">¶</a></p>
<p id="section-1.2.6-2">While the broader requirements of these applications is outside the scope of RUD, consideration has been given for allowing this use case to be supported without causing 'packet inflation' in which every packet submitted as an input results in multiple packets being sent over the network.<a href="#section-1.2.6-2" class="pilcrow">¶</a></p>
<p id="section-1.2.6-3">Provision for onion routing is likely to be of particular interest. The RUD packet format allows for every bit of the UDP payload to be either encrypted data or an opaque authentication tag.<a href="#section-1.2.6-3" class="pilcrow">¶</a></p>
<p id="section-1.2.6-4">For example, an observer tapping the network at point A, point B or point C gains no information that allows them to determine that Alice is communicating with Bob. Even correlation of data from all three locations provides limited information through the timing of arrival and almost none that is likely to be of any benefit to the observer.<a href="#section-1.2.6-4" class="pilcrow">¶</a></p>
<span id="name-rud-tunnelling"></span><figure id="figure-11">
            <div class="artwork art-svg alignLeft" id="section-1.2.6-5.1">
<svg xmlns="http://www.w3.org/2000/svg" width="544" height="185" viewBox="0 0 544.0 185.0">
                <g transform="translate(8,16)">
                  <path d="M 0,0 L 96,0" fill="none" stroke="black"></path>
                  <path d="M 144,0 L 240,0" fill="none" stroke="black"></path>
                  <path d="M 288,0 L 384,0" fill="none" stroke="black"></path>
                  <path d="M 432,0 L 528,0" fill="none" stroke="black"></path>
                  <path d="M 0,32 L 48,32" fill="none" stroke="black"></path>
                  <path d="M 48,32 L 96,32" fill="none" stroke="black"></path>
                  <path d="M 144,32 L 192,32" fill="none" stroke="black"></path>
                  <path d="M 192,32 L 240,32" fill="none" stroke="black"></path>
                  <path d="M 288,32 L 336,32" fill="none" stroke="black"></path>
                  <path d="M 336,32 L 384,32" fill="none" stroke="black"></path>
                  <path d="M 432,32 L 480,32" fill="none" stroke="black"></path>
                  <path d="M 480,32 L 528,32" fill="none" stroke="black"></path>
                  <path d="M 56,96 L 184,96" fill="none" stroke="black"></path>
                  <path d="M 344,144 L 472,144" fill="none" stroke="black"></path>
                  <path d="M 0,0 L 0,32" fill="none" stroke="black"></path>
                  <path d="M 48,32 L 48,160" fill="none" stroke="black"></path>
                  <path d="M 96,0 L 96,32" fill="none" stroke="black"></path>
                  <path d="M 144,0 L 144,32" fill="none" stroke="black"></path>
                  <path d="M 192,32 L 192,160" fill="none" stroke="black"></path>
                  <path d="M 240,0 L 240,32" fill="none" stroke="black"></path>
                  <path d="M 288,0 L 288,32" fill="none" stroke="black"></path>
                  <path d="M 336,32 L 336,160" fill="none" stroke="black"></path>
                  <path d="M 384,0 L 384,32" fill="none" stroke="black"></path>
                  <path d="M 432,0 L 432,32" fill="none" stroke="black"></path>
                  <path d="M 480,32 L 480,160" fill="none" stroke="black"></path>
                  <path d="M 528,0 L 528,32" fill="none" stroke="black"></path>
                  <polygon points="192.000000,96.000000 180.000000,90.400002 180.000000,101.599998" fill="black" transform="rotate(0.000000, 184.000000, 96.000000)"></polygon>
                  <polygon points="480.000000,144.000000 468.000000,138.399994 468.000000,149.600006" fill="black" transform="rotate(0.000000, 472.000000, 144.000000)"></polygon>
                  <text text-anchor="middle" font-family="sans-serif" x="408" y="132">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="472" y="20">B</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="100">B</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="20">O</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="20">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="480" y="20">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="120" y="84">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="40" y="20">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="32" y="20">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="488" y="20">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="68">&gt;</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="116">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="68">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="164">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="164">&gt;</text>
                  <text text-anchor="middle" font-family="sans-serif" x="176" y="20">O</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="116">&gt;</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="304" y="132">=</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="132">&gt;</text>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-rud-tunnelling" class="selfRef">RUD Tunnelling.</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="n-definitions">
<section id="section-2">
      <h2 id="name-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
      </h2>
<p id="section-2-1">This section presents the related specifications and standard, the terms that are used as terms of art within the documents and the terms used as requirements language.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="n-requirements-language">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-defined-terms">
<section id="section-2.2">
        <h3 id="name-defined-terms">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-defined-terms" class="section-name selfRef">Defined Terms</a>
      </h3>
</section>
</div>
<div id="n-related-specifications">
<section id="section-2.3">
        <h3 id="name-related-specifications">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-related-specifications" class="section-name selfRef">Related Specifications</a>
      </h3>
</section>
</div>
<div id="n-implementation-status">
<section id="section-2.4">
        <h3 id="name-implementation-status">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
        </h3>
<p id="section-2.4-1">The implementation status of the reference code base is described in the companion document <span>[<a href="#draft-hallambaker-mesh-developer" class="xref">draft-hallambaker-mesh-developer</a>]</span>.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-architecture">
<section id="section-3">
      <h2 id="name-architecture">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-architecture" class="section-name selfRef">Architecture</a>
      </h2>
<p id="section-3-1">Data Encoding<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">[This part of the specification describes the encodings to be used in the next release. The data encodings in the current reference code used to generate the examples do not match. These should be aligned with QUIC where appropriate.  ]<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Encoding at the packet level presents different requirements to those at higher levels. These needs are better met by the compactness afforded by a place-value approach than the JSON/JSON-B Tag-Value encoding used in the upper layers of the Mesh specifications.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">As at the application layer, the use of nested length encodings is avoided on account of the risk that bounds overflow vulnerabilities are introduced into applications.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Integer<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">Integer values are presented using the same variable length encoding described in section 16 <span>[<a href="#draft-ietf-quic-transport" class="xref">draft-ietf-quic-transport</a>]</span><a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">The first two most significant bits of the first byte are reserved to encode the base 2 logarithm of the integer encoding length in bytes. The integer value is encoded on the remaining bits, in network byte order.<a href="#section-3-7" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">
2 Bit</th>
            <th class="text-left" rowspan="1" colspan="1">
Length</th>
            <th class="text-left" rowspan="1" colspan="1">
Usable Bits</th>
            <th class="text-left" rowspan="1" colspan="1">
Range</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
00</td>
            <td class="text-left" rowspan="1" colspan="1">
1</td>
            <td class="text-left" rowspan="1" colspan="1">
6</td>
            <td class="text-left" rowspan="1" colspan="1">
0-63</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
01</td>
            <td class="text-left" rowspan="1" colspan="1">
2</td>
            <td class="text-left" rowspan="1" colspan="1">
14</td>
            <td class="text-left" rowspan="1" colspan="1">
0-16383</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
10</td>
            <td class="text-left" rowspan="1" colspan="1">
4</td>
            <td class="text-left" rowspan="1" colspan="1">
30</td>
            <td class="text-left" rowspan="1" colspan="1">
0-1073741823</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
11</td>
            <td class="text-left" rowspan="1" colspan="1">
8</td>
            <td class="text-left" rowspan="1" colspan="1">
62</td>
            <td class="text-left" rowspan="1" colspan="1">
0-4611686018427387903</td>
          </tr>
        </tbody>
      </table>
<p id="section-3-9">Values do not need to be encoded on the minimum number of bytes necessary.<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">String<a href="#section-3-10" class="pilcrow">¶</a></p>
<p id="section-3-11">String values are Unicode strings encoded as a sequence of UTF-8 bytes preceded by an integer length specifier.<a href="#section-3-11" class="pilcrow">¶</a></p>
<p id="section-3-12">Binary data<a href="#section-3-12" class="pilcrow">¶</a></p>
<p id="section-3-13">Binary data consists of a sequence of opaque bytes encoded as the sequence of byte values preceded by  an integer length specifier.<a href="#section-3-13" class="pilcrow">¶</a></p>
<p id="section-3-14">Packet Extension List<a href="#section-3-14" class="pilcrow">¶</a></p>
<p id="section-3-15">Packet extensions <span class="bcp14">MAY</span> be specified in any data section of a datagram.<a href="#section-3-15" class="pilcrow">¶</a></p>
<p id="section-3-16">Each extension is a tag-length-value sequence:<a href="#section-3-16" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-17">
        <dt id="section-3-17.1">Tag</dt>
        <dd style="margin-left: 1.5em" id="section-3-17.2">
          <p id="section-3-17.2.1">A sequence of 1 to 16 octets, the leading octets of which are in the range 0-127 and the final octet of which is in the range 128-255.<a href="#section-3-17.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-17.3">Length </dt>
        <dd style="margin-left: 1.5em" id="section-3-17.4">
          <p id="section-3-17.4.1">The number of octets in the Value encoded as an Integer.<a href="#section-3-17.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-17.5">Value</dt>
        <dd style="margin-left: 1.5em" id="section-3-17.6">
          <p id="section-3-17.6.1">An opaque sequence of the specified number of octets.<a href="#section-3-17.6.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-18">The tag 255 is reserved to signal the end of the packet extension list.<a href="#section-3-18" class="pilcrow">¶</a></p>
<p id="section-3-19">Stream Identifier<a href="#section-3-19" class="pilcrow">¶</a></p>
<p id="section-3-20">Every RUD packet begins with a <strong>stream identifier</strong>. Stream identifiers consist of an opaque sequence of zero to 16 bytes.<a href="#section-3-20" class="pilcrow">¶</a></p>
<p id="section-3-21">Stream identifiers are used to allow their issuer to distinguish packets arriving from different streams in circumstances where the stream cannot be inferred from the port. Initiators and responders both issue stream identifiers for their own use during Connection Establishment. Additional stream identifiers <span class="bcp14">MAY</span> be issued as a means of defeating some forms of traffic analysis attack.<a href="#section-3-21" class="pilcrow">¶</a></p>
<p id="section-3-22">The semantics and encoding of stream identifiers including determining the length of the stream identifier is sole concern of the issuer which <span class="bcp14">MUST</span> ensure that it can correctly interpret the stream identifiers they issue for streams received on a specified port without ambiguity.<a href="#section-3-22" class="pilcrow">¶</a></p>
<p id="section-3-23">Stream identifiers are issued as binary data sequences specified in Connection Establishment packets and as Packet Extensions in Data Packets.<a href="#section-3-23" class="pilcrow">¶</a></p>
<p id="section-3-24">Issuers <span class="bcp14">MUST</span> accept every stream identifier issued as a valid identifier for that stream for the lifetime of the connection in which the stream was created.<a href="#section-3-24" class="pilcrow">¶</a></p>
<div id="n-connections">
<section id="section-3.1">
        <h3 id="name-connections">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-connections" class="section-name selfRef">Connections</a>
        </h3>
<p id="section-3.1-1">An RUD connection is a bidirectional relationship between two devices secured by a <em>Connection Shared Secret</em> established through a key agreement between the devices. Once established a connection <span class="bcp14">MAY</span> be persisted for as long as the devices are willing to assign memory resources at each end. Unlike TCP connections, maintaining an RUD connection does not require communication overhead (but maintaining a NAT transit capability might).<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-ports">
<section id="section-3.2">
        <h3 id="name-ports">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-ports" class="section-name selfRef">Ports</a>
        </h3>
<p id="section-3.2-1">An RUD port is a synonym for network endpoint. Only ports at which traffic is received are of concern.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Currently two port types are defined:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2-3">
          <dt id="section-3.2-3.1">HTTP Web Service Endpoint</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.2">
            <p id="section-3.2-3.2.1">A port type that is limited to supporting transactional streams<a href="#section-3.2-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.3">UDP Network Endpoint</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-3.4">
            <p id="section-3.2-3.4.1">A network endpoint that receives Internet communications directed at a particular IP Address and Port.<a href="#section-3.2-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-4">The collection of ports associated with a connection <span class="bcp14">MAY</span> change over time. Connections <span class="bcp14">MAY</span> make use of multiple ports simultaneously.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">For example, a virtual reality streaming game might establish a single connection to a game coordination host and make use of separate ports to achieve the desired latency and bandwidth characteristics.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-stream">
<section id="section-3.3">
        <h3 id="name-stream">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-stream" class="section-name selfRef">Stream</a>
        </h3>
<p id="section-3.3-1">An RUD stream is an asymmetric bidirectional channel that transmits a sequence of datagrams according to a defined characteristic. Two characteristics are currently defined:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.3-2">
          <dt id="section-3.3-2.1">Transactional Stream</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-2.2"></dd>
          <dd class="break"></dd>
<dt id="section-3.3-2.3">Asynchronous Stream</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-2.4"></dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.3-3">The stream characteristic and cryptographic parameters of a stream are immutable for the lifetime of a stream. To effect a forward secrecy exchange, a new stream is created and the existing stream closed.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">Each stream is separately identified by one or more Stream Identifiers at each end specified by the party that receives data at that end.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">Stream identifiers <span class="bcp14">MUST</span> be unique for the lifetime of a stream. Stream identifiers <span class="bcp14">MAY</span> be reused after the stream has been closed.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<div id="n-transactional-stream">
<section id="section-3.3.1">
          <h4 id="name-transactional-stream">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-transactional-stream" class="section-name selfRef">Transactional stream</a>
          </h4>
<p id="section-3.3.1-1">Streams with a transactional characteristic are used to engage in a request/response communication pattern with a service specified during stream negotiation:<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<span id="name-transactional-stream-charac"></span><figure id="figure-12">
            <div class="artwork art-svg alignLeft" id="section-3.3.1-2.1">
<svg xmlns="http://www.w3.org/2000/svg" width="464" height="233" viewBox="0 0 464.0 233.0">
                <g transform="translate(8,16)">
                  <path d="M 0,0 L 160,0" fill="none" stroke="black"></path>
                  <path d="M 288,0 L 448,0" fill="none" stroke="black"></path>
                  <path d="M 0,32 L 80,32" fill="none" stroke="black"></path>
                  <path d="M 80,32 L 160,32" fill="none" stroke="black"></path>
                  <path d="M 288,32 L 376,32" fill="none" stroke="black"></path>
                  <path d="M 376,32 L 448,32" fill="none" stroke="black"></path>
                  <path d="M 80,64 L 184,64" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 368,64" fill="none" stroke="black"></path>
                  <path d="M 88,80 L 184,80" fill="none" stroke="black"></path>
                  <path d="M 272,80 L 376,80" fill="none" stroke="black"></path>
                  <path d="M 80,112 L 184,112" fill="none" stroke="black"></path>
                  <path d="M 264,112 L 368,112" fill="none" stroke="black"></path>
                  <path d="M 88,128 L 184,128" fill="none" stroke="black"></path>
                  <path d="M 272,128 L 376,128" fill="none" stroke="black"></path>
                  <path d="M 80,176 L 184,176" fill="none" stroke="black"></path>
                  <path d="M 264,176 L 368,176" fill="none" stroke="black"></path>
                  <path d="M 88,192 L 184,192" fill="none" stroke="black"></path>
                  <path d="M 272,192 L 376,192" fill="none" stroke="black"></path>
                  <path d="M 0,0 L 0,32" fill="none" stroke="black"></path>
                  <path d="M 80,32 L 80,64" fill="none" stroke="black"></path>
                  <path d="M 80,64 L 80,112" fill="none" stroke="black"></path>
                  <path d="M 80,112 L 80,176" fill="none" stroke="black"></path>
                  <path d="M 80,176 L 80,208" fill="none" stroke="black"></path>
                  <path d="M 160,0 L 160,32" fill="none" stroke="black"></path>
                  <path d="M 288,0 L 288,32" fill="none" stroke="black"></path>
                  <path d="M 376,32 L 376,80" fill="none" stroke="black"></path>
                  <path d="M 376,80 L 376,128" fill="none" stroke="black"></path>
                  <path d="M 376,128 L 376,192" fill="none" stroke="black"></path>
                  <path d="M 376,192 L 376,208" fill="none" stroke="black"></path>
                  <path d="M 448,0 L 448,32" fill="none" stroke="black"></path>
                  <polygon points="96.000000,80.000000 84.000000,74.400002 84.000000,85.599998" fill="black" transform="rotate(180.000000, 88.000000, 80.000000)"></polygon>
                  <polygon points="96.000000,128.000000 84.000000,122.400002 84.000000,133.600006" fill="black" transform="rotate(180.000000, 88.000000, 128.000000)"></polygon>
                  <polygon points="96.000000,192.000000 84.000000,186.399994 84.000000,197.600006" fill="black" transform="rotate(180.000000, 88.000000, 192.000000)"></polygon>
                  <polygon points="376.000000,64.000000 364.000000,58.400002 364.000000,69.599998" fill="black" transform="rotate(0.000000, 368.000000, 64.000000)"></polygon>
                  <polygon points="376.000000,112.000000 364.000000,106.400002 364.000000,117.599998" fill="black" transform="rotate(0.000000, 368.000000, 112.000000)"></polygon>
                  <polygon points="376.000000,176.000000 364.000000,170.399994 364.000000,181.600006" fill="black" transform="rotate(0.000000, 368.000000, 176.000000)"></polygon>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="84">p</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="116">R</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="116">u</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="196">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="68">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="180">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="196">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="84">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="116">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="196">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="116">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">p</text>
                  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="180">u</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="180">R</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="180">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="68">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="116">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">R</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="180">q</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="180">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="196">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="196">p</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="384" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="196">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">v</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="68">u</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="116">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="68">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="68">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="68">q</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="116">q</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="68">R</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="132">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="132">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="196">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="84">R</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="132">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="196">R</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="392" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="180">e</text>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-transactional-stream-charac" class="selfRef">Transactional stream characteristic.</a>
            </figcaption></figure>
<p id="section-3.3.1-3">Each transactional stream is asymmetric, but a connection <span class="bcp14">MAY</span> contain separate transactional streams going in each direction.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">For example, in a notary application, two hosts might offer notary service to the other through the same connection but through separate streams.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-asynchronous-stream">
<section id="section-3.3.2">
          <h4 id="name-asynchronous-stream">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-asynchronous-stream" class="section-name selfRef">Asynchronous stream</a>
          </h4>
<p id="section-3.3.2-1">Streams with an asynchronous characteristic deliver a stream of datagrams created by the stream originator to the stream receiver. Datagrams carrying control information sent in the reverse direction <span class="bcp14">MAY</span> be used to control the flow.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<span id="name-asynchronous-stream-charact"></span><figure id="figure-13">
            <div class="artwork art-svg alignLeft" id="section-3.3.2-2.1">
<svg xmlns="http://www.w3.org/2000/svg" width="464" height="281" viewBox="0 0 464.0 281.0">
                <g transform="translate(8,16)">
                  <path d="M 0,0 L 160,0" fill="none" stroke="black"></path>
                  <path d="M 288,0 L 448,0" fill="none" stroke="black"></path>
                  <path d="M 0,48 L 80,48" fill="none" stroke="black"></path>
                  <path d="M 80,48 L 160,48" fill="none" stroke="black"></path>
                  <path d="M 288,48 L 376,48" fill="none" stroke="black"></path>
                  <path d="M 376,48 L 448,48" fill="none" stroke="black"></path>
                  <path d="M 80,80 L 176,80" fill="none" stroke="black"></path>
                  <path d="M 272,80 L 368,80" fill="none" stroke="black"></path>
                  <path d="M 88,96 L 168,96" fill="none" stroke="black"></path>
                  <path d="M 280,96 L 376,96" fill="none" stroke="black"></path>
                  <path d="M 88,128 L 184,128" fill="none" stroke="black"></path>
                  <path d="M 264,128 L 376,128" fill="none" stroke="black"></path>
                  <path d="M 88,144 L 184,144" fill="none" stroke="black"></path>
                  <path d="M 264,144 L 376,144" fill="none" stroke="black"></path>
                  <path d="M 88,160 L 184,160" fill="none" stroke="black"></path>
                  <path d="M 264,160 L 376,160" fill="none" stroke="black"></path>
                  <path d="M 88,176 L 184,176" fill="none" stroke="black"></path>
                  <path d="M 264,176 L 376,176" fill="none" stroke="black"></path>
                  <path d="M 80,208 L 176,208" fill="none" stroke="black"></path>
                  <path d="M 272,208 L 368,208" fill="none" stroke="black"></path>
                  <path d="M 88,240 L 184,240" fill="none" stroke="black"></path>
                  <path d="M 264,240 L 376,240" fill="none" stroke="black"></path>
                  <path d="M 88,256 L 184,256" fill="none" stroke="black"></path>
                  <path d="M 264,256 L 376,256" fill="none" stroke="black"></path>
                  <path d="M 0,0 L 0,48" fill="none" stroke="black"></path>
                  <path d="M 80,48 L 80,80" fill="none" stroke="black"></path>
                  <path d="M 80,80 L 80,208" fill="none" stroke="black"></path>
                  <path d="M 80,208 L 80,256" fill="none" stroke="black"></path>
                  <path d="M 160,0 L 160,48" fill="none" stroke="black"></path>
                  <path d="M 288,0 L 288,48" fill="none" stroke="black"></path>
                  <path d="M 376,48 L 376,96" fill="none" stroke="black"></path>
                  <path d="M 376,96 L 376,128" fill="none" stroke="black"></path>
                  <path d="M 376,128 L 376,144" fill="none" stroke="black"></path>
                  <path d="M 376,144 L 376,160" fill="none" stroke="black"></path>
                  <path d="M 376,160 L 376,176" fill="none" stroke="black"></path>
                  <path d="M 376,176 L 376,240" fill="none" stroke="black"></path>
                  <path d="M 376,240 L 376,256" fill="none" stroke="black"></path>
                  <path d="M 448,0 L 448,48" fill="none" stroke="black"></path>
                  <polygon points="96.000000,96.000000 84.000000,90.400002 84.000000,101.599998" fill="black" transform="rotate(180.000000, 88.000000, 96.000000)"></polygon>
                  <polygon points="96.000000,128.000000 84.000000,122.400002 84.000000,133.600006" fill="black" transform="rotate(180.000000, 88.000000, 128.000000)"></polygon>
                  <polygon points="96.000000,144.000000 84.000000,138.399994 84.000000,149.600006" fill="black" transform="rotate(180.000000, 88.000000, 144.000000)"></polygon>
                  <polygon points="96.000000,160.000000 84.000000,154.399994 84.000000,165.600006" fill="black" transform="rotate(180.000000, 88.000000, 160.000000)"></polygon>
                  <polygon points="96.000000,176.000000 84.000000,170.399994 84.000000,181.600006" fill="black" transform="rotate(180.000000, 88.000000, 176.000000)"></polygon>
                  <polygon points="96.000000,240.000000 84.000000,234.399994 84.000000,245.600006" fill="black" transform="rotate(180.000000, 88.000000, 240.000000)"></polygon>
                  <polygon points="96.000000,256.000000 84.000000,250.399994 84.000000,261.600006" fill="black" transform="rotate(180.000000, 88.000000, 256.000000)"></polygon>
                  <polygon points="376.000000,80.000000 364.000000,74.400002 364.000000,85.599998" fill="black" transform="rotate(0.000000, 368.000000, 80.000000)"></polygon>
                  <polygon points="376.000000,208.000000 364.000000,202.399994 364.000000,213.600006" fill="black" transform="rotate(0.000000, 368.000000, 208.000000)"></polygon>
                  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="260">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="260">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="100">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="180">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="180">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="180">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="212">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="392" y="36">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="100">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="260">F</text>
                  <text text-anchor="middle" font-family="sans-serif" x="392" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="36">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="84">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="148">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="180">4</text>
                  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="100">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="132">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="244">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="360" y="36">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="100">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="148">F</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="244">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="260">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="260">6</text>
                  <text text-anchor="middle" font-family="sans-serif" x="384" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="84">u</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="84">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="100">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="180">F</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="180">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="212">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="244">F</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="212">C</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="212">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="100">d</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="100">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="164">3</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="164">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="164">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="212">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="100">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="100">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">F</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="84">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="164">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="212">f</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="244">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="100">w</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">1</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="148">2</text>
                  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="384" y="36">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="148">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="148">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="212">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="212">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="244">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="368" y="36">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="84">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="100">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="260">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="84">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">h</text>
                  <text text-anchor="middle" font-family="sans-serif" x="376" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="248" y="244">5</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="164">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="212">u</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="164">F</text>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-asynchronous-stream-charact" class="selfRef">Asynchronous stream characteristic.</a>
            </figcaption></figure>
<p id="section-3.3.2-3">Asynchronous streams <span class="bcp14">MAY</span> be used for intermittent communications as well as real time streaming media. For example, a network server might use an asynchronous stream to log transaction data to another machine.<a href="#section-3.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-credentials">
<section id="section-3.4">
        <h3 id="name-credentials">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-credentials" class="section-name selfRef">Credentials</a>
        </h3>
<p id="section-3.4-1">RUD follows the Mesh approach of using separate credentials for devices and principals.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">For example, the service offered by provider (@provider) is delivered by a fault tolerant collection of three separate hosts. Alice (@alice) can access those services through any one of her four personal devices.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<span id="name-mesh-layered-credential-mod"></span><figure id="figure-14">
          <div class="artwork art-svg alignLeft" id="section-3.4-3.1">
<svg xmlns="http://www.w3.org/2000/svg" width="520" height="185" viewBox="0 0 520.0 185.0">
              <g transform="translate(8,16)">
                <path d="M 0,0 L 160,0" fill="none" stroke="black"></path>
                <path d="M 296,0 L 456,0" fill="none" stroke="black"></path>
                <path d="M 168,16 L 288,16" fill="none" stroke="black"></path>
                <path d="M 0,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 80,32 L 160,32" fill="none" stroke="black"></path>
                <path d="M 296,32 L 384,32" fill="none" stroke="black"></path>
                <path d="M 384,32 L 456,32" fill="none" stroke="black"></path>
                <path d="M 0,80 L 496,80" fill="none" stroke="black"></path>
                <path d="M 0,128 L 80,128" fill="none" stroke="black"></path>
                <path d="M 80,128 L 160,128" fill="none" stroke="black"></path>
                <path d="M 296,128 L 384,128" fill="none" stroke="black"></path>
                <path d="M 384,128 L 456,128" fill="none" stroke="black"></path>
                <path d="M 168,144 L 288,144" fill="none" stroke="black"></path>
                <path d="M 0,160 L 160,160" fill="none" stroke="black"></path>
                <path d="M 296,160 L 456,160" fill="none" stroke="black"></path>
                <path d="M 0,0 L 0,32" fill="none" stroke="black"></path>
                <path d="M 0,128 L 0,160" fill="none" stroke="black"></path>
                <path d="M 160,0 L 160,32" fill="none" stroke="black"></path>
                <path d="M 160,128 L 160,160" fill="none" stroke="black"></path>
                <path d="M 296,0 L 296,32" fill="none" stroke="black"></path>
                <path d="M 296,128 L 296,160" fill="none" stroke="black"></path>
                <path d="M 456,0 L 456,32" fill="none" stroke="black"></path>
                <path d="M 456,128 L 456,160" fill="none" stroke="black"></path>
                <polygon points="176.000000,16.000000 164.000000,10.400000 164.000000,21.600000" fill="black" transform="rotate(180.000000, 168.000000, 16.000000)"></polygon>
                <polygon points="176.000000,144.000000 164.000000,138.399994 164.000000,149.600006" fill="black" transform="rotate(180.000000, 168.000000, 144.000000)"></polygon>
                <polygon points="296.000000,16.000000 284.000000,10.400000 284.000000,21.600000" fill="black" transform="rotate(0.000000, 288.000000, 16.000000)"></polygon>
                <polygon points="296.000000,144.000000 284.000000,138.399994 284.000000,149.600006" fill="black" transform="rotate(0.000000, 288.000000, 144.000000)"></polygon>
                <text text-anchor="middle" font-family="sans-serif" x="360" y="20">S</text>
                <text text-anchor="middle" font-family="sans-serif" x="384" y="20">v</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="68">:</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="132">l</text>
                <text text-anchor="middle" font-family="sans-serif" x="88" y="20">c</text>
                <text text-anchor="middle" font-family="sans-serif" x="384" y="116">:</text>
                <text text-anchor="middle" font-family="sans-serif" x="96" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="100">:</text>
                <text text-anchor="middle" font-family="sans-serif" x="208" y="132">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="424" y="68">p</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="52">:</text>
                <text text-anchor="middle" font-family="sans-serif" x="384" y="68">:</text>
                <text text-anchor="middle" font-family="sans-serif" x="416" y="68">A</text>
                <text text-anchor="middle" font-family="sans-serif" x="472" y="100">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="200" y="4">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="64" y="148">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="368" y="148">H</text>
                <text text-anchor="middle" font-family="sans-serif" x="440" y="68">l</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="116">:</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="148">v</text>
                <text text-anchor="middle" font-family="sans-serif" x="64" y="20">A</text>
                <text text-anchor="middle" font-family="sans-serif" x="384" y="52">:</text>
                <text text-anchor="middle" font-family="sans-serif" x="224" y="132">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="240" y="132">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="392" y="148">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="504" y="100">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="376" y="20">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="392" y="20">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="432" y="68">p</text>
                <text text-anchor="middle" font-family="sans-serif" x="480" y="68">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="440" y="100">s</text>
                <text text-anchor="middle" font-family="sans-serif" x="96" y="148">c</text>
                <text text-anchor="middle" font-family="sans-serif" x="224" y="4">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="4">l</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="20">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="456" y="68">c</text>
                <text text-anchor="middle" font-family="sans-serif" x="472" y="68">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="496" y="68">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="384" y="148">s</text>
                <text text-anchor="middle" font-family="sans-serif" x="240" y="4">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="400" y="20">c</text>
                <text text-anchor="middle" font-family="sans-serif" x="488" y="68">o</text>
                <text text-anchor="middle" font-family="sans-serif" x="488" y="100">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="20">l</text>
                <text text-anchor="middle" font-family="sans-serif" x="464" y="100">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="232" y="132">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="376" y="148">o</text>
                <text text-anchor="middle" font-family="sans-serif" x="432" y="100">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="232" y="4">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="248" y="4">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="4">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="448" y="68">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="424" y="100">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="448" y="100">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="456" y="100">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="208" y="4">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="480" y="100">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="464" y="68">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="148">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="368" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="216" y="132">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="248" y="132">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="132">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="88" y="148">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="104" y="148">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="216" y="4">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="408" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="384" y="100">:</text>
                <text text-anchor="middle" font-family="sans-serif" x="416" y="100">P</text>
                <text text-anchor="middle" font-family="sans-serif" x="496" y="100">o</text>
                <text text-anchor="middle" font-family="sans-serif" x="192" y="132">C</text>
                <text text-anchor="middle" font-family="sans-serif" x="200" y="132">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="192" y="4">C</text>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-mesh-layered-credential-mod" class="selfRef">Mesh Layered Credential Model.</a>
          </figcaption></figure>
<p id="section-3.4-4">RUD makes use of the keys specified in device credentials to perform key agreement and enables user and service credential(s) to be presented for authentication and authorization of the principals.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<div id="n-device">
<section id="section-3.4.1">
          <h4 id="name-device">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-device" class="section-name selfRef">Device</a>
          </h4>
<p id="section-3.4.1-1">An RUD device credential is a credential that specifies a public key of one of the supported key agreement algorithms. Two forms of device credential are currently defined:<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.1-2.1">Raw Key (e.g. X.448 key)<a href="#section-3.4.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.4.1-2.2">Mesh Device Connection Assertion.<a href="#section-3.4.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.4.1-3">It might well be the case that it is more appropriate to pass the Device Connection Assertion as part of the Principal Credential.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-principal">
<section id="section-3.4.2">
          <h4 id="name-principal">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-principal" class="section-name selfRef">Principal</a>
          </h4>
<p id="section-3.4.2-1">Principal credentials are used to authenticate and authorize a device to act on behalf of the specified principal.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2-2">Presentation of Principal Credentials <span class="bcp14">MAY</span> be performed at the application layer (i.e. by means of credentials carried in an RUD payload) or as an RUD Packet Extension when a <strong>stream service binding</strong> is requested.<a href="#section-3.4.2-2" class="pilcrow">¶</a></p>
<p id="section-3.4.2-3">In either case, validation of Principal Credentials is an application concern and thus outside the scope of RUD.<a href="#section-3.4.2-3" class="pilcrow">¶</a></p>
<p id="section-3.4.2-4">Different streams <span class="bcp14">MAY</span> involve the use of different principal credentials. Alice might be authenticated through her Mesh profile in one stream, a PKIX client cert bound to a smartcard in another and a SAML authorization token in a third.<a href="#section-3.4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-datagram-format">
<section id="section-3.5">
        <h3 id="name-datagram-format">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-datagram-format" class="section-name selfRef">Datagram Format</a>
        </h3>
<p id="section-3.5-1">An RUD Datagram is by definition the smallest unit of payload data passed from the application layer to the presentation layer or vice versa. A Datagram <span class="bcp14">MAY</span> be as large as a complete frame of 4K or 8K video or as small as a single key press or movement of a game controller.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">Use of HTTP ports places no upper limit on the size of an RUD Datagram but UDP Datagrams are limited to a maximum number of packets.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<span id="name-datagram-format-2"></span><figure id="figure-15">
          <div class="artwork art-svg alignLeft" id="section-3.5-3.1">
<svg xmlns="http://www.w3.org/2000/svg" width="536" height="169" viewBox="0 0 536.0 169.0">
              <g transform="translate(8,16)">
                <path d="M 0,0 L 120,0" fill="none" stroke="black"></path>
                <path d="M 120,0 L 240,0" fill="none" stroke="black"></path>
                <path d="M 240,0 L 416,0" fill="none" stroke="black"></path>
                <path d="M 416,0 L 520,0" fill="none" stroke="black"></path>
                <path d="M 248,32 L 280,32" fill="none" stroke="black"></path>
                <path d="M 376,32 L 408,32" fill="none" stroke="black"></path>
                <path d="M 0,48 L 120,48" fill="none" stroke="black"></path>
                <path d="M 120,48 L 240,48" fill="none" stroke="black"></path>
                <path d="M 240,48 L 416,48" fill="none" stroke="black"></path>
                <path d="M 416,48 L 520,48" fill="none" stroke="black"></path>
                <path d="M 136,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 416,80 L 520,80" fill="none" stroke="black"></path>
                <path d="M 120,112 L 224,112" fill="none" stroke="black"></path>
                <path d="M 224,112 L 344,112" fill="none" stroke="black"></path>
                <path d="M 344,112 L 520,112" fill="none" stroke="black"></path>
                <path d="M 120,144 L 224,144" fill="none" stroke="black"></path>
                <path d="M 224,144 L 344,144" fill="none" stroke="black"></path>
                <path d="M 344,144 L 520,144" fill="none" stroke="black"></path>
                <path d="M 0,0 L 0,48" fill="none" stroke="black"></path>
                <path d="M 120,0 L 120,48" fill="none" stroke="black"></path>
                <path d="M 120,96 L 120,112" fill="none" stroke="black"></path>
                <path d="M 120,112 L 120,144" fill="none" stroke="black"></path>
                <path d="M 224,112 L 224,144" fill="none" stroke="black"></path>
                <path d="M 240,0 L 240,48" fill="none" stroke="black"></path>
                <path d="M 240,48 L 240,64" fill="none" stroke="black"></path>
                <path d="M 344,112 L 344,144" fill="none" stroke="black"></path>
                <path d="M 416,0 L 416,48" fill="none" stroke="black"></path>
                <path d="M 416,48 L 416,80" fill="none" stroke="black"></path>
                <path d="M 520,0 L 520,48" fill="none" stroke="black"></path>
                <path d="M 520,80 L 520,112" fill="none" stroke="black"></path>
                <path d="M 520,112 L 520,144" fill="none" stroke="black"></path>
                <polygon points="256.000000,32.000000 244.000000,26.400000 244.000000,37.599998" fill="black" transform="rotate(180.000000, 248.000000, 32.000000)"></polygon>
                <path d="M 320,56 L 320,64" fill="none" stroke="black"></path>
                <polygon points="336.000000,64.000000 324.000000,58.400002 324.000000,69.599998" fill="black" transform="rotate(270.000000, 320.000000, 64.000000)"></polygon>
                <path d="M 320,96 L 320,104" fill="none" stroke="black"></path>
                <polygon points="336.000000,96.000000 324.000000,90.400002 324.000000,101.599998" fill="black" transform="rotate(90.000000, 320.000000, 96.000000)"></polygon>
                <polygon points="416.000000,32.000000 404.000000,26.400000 404.000000,37.599998" fill="black" transform="rotate(0.000000, 408.000000, 32.000000)"></polygon>
                <path d="M 136,80 A 16,16 0 0,0 120,96" fill="none" stroke="black"></path>
                <path d="M 240,64 A 16,16 0 0,1 224,80" fill="none" stroke="black"></path>
                <text text-anchor="middle" font-family="sans-serif" x="496" y="36">s</text>
                <text text-anchor="middle" font-family="sans-serif" x="152" y="132">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="296" y="132">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="408" y="132">o</text>
                <text text-anchor="middle" font-family="sans-serif" x="40" y="20">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="56" y="20">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="160" y="20">N</text>
                <text text-anchor="middle" font-family="sans-serif" x="168" y="20">o</text>
                <text text-anchor="middle" font-family="sans-serif" x="144" y="36">1</text>
                <text text-anchor="middle" font-family="sans-serif" x="200" y="36">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="208" y="36">s</text>
                <text text-anchor="middle" font-family="sans-serif" x="464" y="36">B</text>
                <text text-anchor="middle" font-family="sans-serif" x="64" y="20">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="440" y="20">A</text>
                <text text-anchor="middle" font-family="sans-serif" x="464" y="20">h</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="36">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="488" y="36">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="176" y="20">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="272" y="132">y</text>
                <text text-anchor="middle" font-family="sans-serif" x="448" y="132">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="304" y="20">p</text>
                <text text-anchor="middle" font-family="sans-serif" x="320" y="36">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="400" y="132">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="304" y="36">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="360" y="36">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="360" y="20">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="24" y="36">0</text>
                <text text-anchor="middle" font-family="sans-serif" x="480" y="36">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="456" y="132">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="480" y="132">g</text>
                <text text-anchor="middle" font-family="sans-serif" x="184" y="36">y</text>
                <text text-anchor="middle" font-family="sans-serif" x="176" y="132">s</text>
                <text text-anchor="middle" font-family="sans-serif" x="184" y="132">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="132">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="312" y="36">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="440" y="36">1</text>
                <text text-anchor="middle" font-family="sans-serif" x="392" y="132">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="24" y="20">S</text>
                <text text-anchor="middle" font-family="sans-serif" x="328" y="20">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="36">y</text>
                <text text-anchor="middle" font-family="sans-serif" x="96" y="36">s</text>
                <text text-anchor="middle" font-family="sans-serif" x="448" y="36">6</text>
                <text text-anchor="middle" font-family="sans-serif" x="168" y="132">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="464" y="132">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="456" y="20">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="48" y="36">6</text>
                <text text-anchor="middle" font-family="sans-serif" x="296" y="36">R</text>
                <text text-anchor="middle" font-family="sans-serif" x="336" y="36">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="88" y="36">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="160" y="36">8</text>
                <text text-anchor="middle" font-family="sans-serif" x="176" y="36">B</text>
                <text text-anchor="middle" font-family="sans-serif" x="352" y="36">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="344" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="496" y="20">g</text>
                <text text-anchor="middle" font-family="sans-serif" x="32" y="36">-</text>
                <text text-anchor="middle" font-family="sans-serif" x="64" y="36">B</text>
                <text text-anchor="middle" font-family="sans-serif" x="312" y="84">A</text>
                <text text-anchor="middle" font-family="sans-serif" x="200" y="132">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="480" y="20">T</text>
                <text text-anchor="middle" font-family="sans-serif" x="344" y="36">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="144" y="132">x</text>
                <text text-anchor="middle" font-family="sans-serif" x="32" y="20">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="40" y="36">1</text>
                <text text-anchor="middle" font-family="sans-serif" x="320" y="84">E</text>
                <text text-anchor="middle" font-family="sans-serif" x="432" y="132">P</text>
                <text text-anchor="middle" font-family="sans-serif" x="280" y="132">l</text>
                <text text-anchor="middle" font-family="sans-serif" x="48" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="352" y="20">x</text>
                <text text-anchor="middle" font-family="sans-serif" x="488" y="20">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="328" y="36">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="328" y="84">S</text>
                <text text-anchor="middle" font-family="sans-serif" x="136" y="132">E</text>
                <text text-anchor="middle" font-family="sans-serif" x="160" y="132">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="208" y="132">s</text>
                <text text-anchor="middle" font-family="sans-serif" x="296" y="20">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="448" y="20">u</text>
                <text text-anchor="middle" font-family="sans-serif" x="192" y="36">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="472" y="36">y</text>
                <text text-anchor="middle" font-family="sans-serif" x="384" y="132">Z</text>
                <text text-anchor="middle" font-family="sans-serif" x="320" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="132">P</text>
                <text text-anchor="middle" font-family="sans-serif" x="288" y="132">o</text>
                <text text-anchor="middle" font-family="sans-serif" x="304" y="132">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="20">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="88" y="20">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="184" y="20">c</text>
                <text text-anchor="middle" font-family="sans-serif" x="288" y="20">C</text>
                <text text-anchor="middle" font-family="sans-serif" x="472" y="132">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="192" y="132">o</text>
                <text text-anchor="middle" font-family="sans-serif" x="440" y="132">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="192" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="312" y="20">h</text>
                <text text-anchor="middle" font-family="sans-serif" x="336" y="20">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="152" y="36">-</text>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-datagram-format-2" class="selfRef">Datagram format.</a>
          </figcaption></figure>
<p id="section-3.5-4">Requests and Responses <span class="bcp14">MAY</span> be split into multiple Datagrams. In this case every datagram except the final one is marked with the continuation flag.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<p id="section-3.5-5">APIs <span class="bcp14">MAY</span> choose to present the individual datagrams to applications or reconstruct the complete datagram according to what best fits their circumstances.<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<div id="n-stream-identifier">
<section id="section-3.5.1">
          <h4 id="name-stream-identifier">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-stream-identifier" class="section-name selfRef">Stream Identifier</a>
          </h4>
<p id="section-3.5.1-1">A sequence of bytes as specified by the recipient during establishment of the connection or stream.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-nonce">
<section id="section-3.5.2">
          <h4 id="name-nonce">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-nonce" class="section-name selfRef">Nonce</a>
          </h4>
<p id="section-3.5.2-1">The keys used to encrypt and authenticate each datagram are derived by applying a key derivation function to the Stream Primary Key, the Stream identifier and a nonce value specified in the datagram itself.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
<p id="section-3.5.2-2">The nonce is the value of a monotonically increasing datagram counter.<a href="#section-3.5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-ciphertext">
<section id="section-3.5.3">
          <h4 id="name-ciphertext">
<a href="#section-3.5.3" class="section-number selfRef">3.5.3. </a><a href="#name-ciphertext" class="section-name selfRef">Ciphertext</a>
          </h4>
<p id="section-3.5.3-1">Ciphertext is the plaintext payload encrypted under a key derived from the active primary key and the initialization vector. Keys are only used to encrypt a single Datagram or continuation Datagram.<a href="#section-3.5.3-1" class="pilcrow">¶</a></p>
<p id="section-3.5.3-2">Plaintext of a data Datagram consists of a list of packet extension entries followed by a payload followed by zero padding.<a href="#section-3.5.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-authentication-tag">
<section id="section-3.5.4">
          <h4 id="name-authentication-tag">
<a href="#section-3.5.4" class="section-number selfRef">3.5.4. </a><a href="#name-authentication-tag" class="section-name selfRef">Authentication Tag</a>
          </h4>
<p id="section-3.5.4-1">Associated data is entire Datagram from the first byte to the start of the Initialization vector.<a href="#section-3.5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-packet-format-and-packetized-datagrams">
<section id="section-3.6">
        <h3 id="name-packet-format-and-packetize">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-packet-format-and-packetize" class="section-name selfRef">Packet Format and Packetized Datagrams</a>
        </h3>
<p id="section-3.6-1">UDP provides unreliable transport of datagrams no larger than the maximum IP payload size of 64KB. In practice the largest datagram payload is typically limited to no more than 1260 bytes because the Ethernet specification is stuck in the Middle Ages. It is thus necessary to split large Datagrams into multiple packets and provide sufficient control information that the receiver can reassemble the packets in the right order and request any lost packets be re-sent.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">Similar constraints are imposed by a wide range of wireless and wired physical and network transports.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<p id="section-3.6-3">When using Packetized Datagrams, each packet in the Datagram specifies the stream identifier and a packet identifier. Only the last packet in the Datagram presents an authentication tag.<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<span id="name-datagram-packetization-acro"></span><figure id="figure-16">
          <div class="artwork art-svg alignLeft" id="section-3.6-4.1">
<svg xmlns="http://www.w3.org/2000/svg" width="504" height="281" viewBox="0 0 504.0 281.0">
              <g transform="translate(8,16)">
                <path d="M 0,16 L 104,16" fill="none" stroke="black"></path>
                <path d="M 104,16 L 208,16" fill="none" stroke="black"></path>
                <path d="M 208,16 L 336,16" fill="none" stroke="black"></path>
                <path d="M 352,16 L 360,16" fill="none" stroke="black"></path>
                <path d="M 376,16 L 384,16" fill="none" stroke="black"></path>
                <path d="M 384,16 L 488,16" fill="none" stroke="black"></path>
                <path d="M 0,48 L 104,48" fill="none" stroke="black"></path>
                <path d="M 104,48 L 208,48" fill="none" stroke="black"></path>
                <path d="M 208,48 L 336,48" fill="none" stroke="black"></path>
                <path d="M 352,48 L 360,48" fill="none" stroke="black"></path>
                <path d="M 376,48 L 384,48" fill="none" stroke="black"></path>
                <path d="M 384,48 L 488,48" fill="none" stroke="black"></path>
                <path d="M 0,96 L 104,96" fill="none" stroke="black"></path>
                <path d="M 104,96 L 208,96" fill="none" stroke="black"></path>
                <path d="M 208,96 L 448,96" fill="none" stroke="black"></path>
                <path d="M 0,128 L 104,128" fill="none" stroke="black"></path>
                <path d="M 104,128 L 208,128" fill="none" stroke="black"></path>
                <path d="M 208,128 L 448,128" fill="none" stroke="black"></path>
                <path d="M 0,160 L 104,160" fill="none" stroke="black"></path>
                <path d="M 104,160 L 208,160" fill="none" stroke="black"></path>
                <path d="M 208,160 L 448,160" fill="none" stroke="black"></path>
                <path d="M 0,192 L 104,192" fill="none" stroke="black"></path>
                <path d="M 104,192 L 208,192" fill="none" stroke="black"></path>
                <path d="M 208,192 L 448,192" fill="none" stroke="black"></path>
                <path d="M 0,224 L 104,224" fill="none" stroke="black"></path>
                <path d="M 104,224 L 208,224" fill="none" stroke="black"></path>
                <path d="M 208,224 L 344,224" fill="none" stroke="black"></path>
                <path d="M 344,224 L 448,224" fill="none" stroke="black"></path>
                <path d="M 0,256 L 104,256" fill="none" stroke="black"></path>
                <path d="M 104,256 L 208,256" fill="none" stroke="black"></path>
                <path d="M 208,256 L 344,256" fill="none" stroke="black"></path>
                <path d="M 344,256 L 448,256" fill="none" stroke="black"></path>
                <path d="M 0,16 L 0,48" fill="none" stroke="black"></path>
                <path d="M 0,96 L 0,128" fill="none" stroke="black"></path>
                <path d="M 0,160 L 0,192" fill="none" stroke="black"></path>
                <path d="M 0,224 L 0,256" fill="none" stroke="black"></path>
                <path d="M 104,16 L 104,48" fill="none" stroke="black"></path>
                <path d="M 104,96 L 104,128" fill="none" stroke="black"></path>
                <path d="M 104,160 L 104,192" fill="none" stroke="black"></path>
                <path d="M 104,224 L 104,256" fill="none" stroke="black"></path>
                <path d="M 208,16 L 208,48" fill="none" stroke="black"></path>
                <path d="M 208,96 L 208,128" fill="none" stroke="black"></path>
                <path d="M 208,160 L 208,192" fill="none" stroke="black"></path>
                <path d="M 208,224 L 208,256" fill="none" stroke="black"></path>
                <path d="M 344,224 L 344,256" fill="none" stroke="black"></path>
                <path d="M 384,16 L 384,48" fill="none" stroke="black"></path>
                <path d="M 448,96 L 448,128" fill="none" stroke="black"></path>
                <path d="M 448,160 L 448,192" fill="none" stroke="black"></path>
                <path d="M 448,224 L 448,256" fill="none" stroke="black"></path>
                <path d="M 488,16 L 488,48" fill="none" stroke="black"></path>
                <text text-anchor="middle" font-family="sans-serif" x="48" y="244">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="368" y="244">A</text>
                <text text-anchor="middle" font-family="sans-serif" x="48" y="116">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="56" y="180">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="24" y="244">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="32" y="4">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="304" y="180">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="296" y="244">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="168" y="244">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="312" y="244">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="376" y="244">u</text>
                <text text-anchor="middle" font-family="sans-serif" x="16" y="84">c</text>
                <text text-anchor="middle" font-family="sans-serif" x="40" y="116">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="304" y="116">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="184" y="116">1</text>
                <text text-anchor="middle" font-family="sans-serif" x="168" y="116">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="180">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="8" y="4">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="36">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="304" y="36">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="244">h</text>
                <text text-anchor="middle" font-family="sans-serif" x="280" y="244">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="328" y="36">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="24" y="116">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="280" y="116">h</text>
                <text text-anchor="middle" font-family="sans-serif" x="128" y="116">H</text>
                <text text-anchor="middle" font-family="sans-serif" x="40" y="244">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="272" y="244">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="384" y="244">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="152" y="36">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="168" y="36">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="280" y="36">h</text>
                <text text-anchor="middle" font-family="sans-serif" x="32" y="180">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="48" y="180">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="168" y="180">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="180">C</text>
                <text text-anchor="middle" font-family="sans-serif" x="456" y="36">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="464" y="36">g</text>
                <text text-anchor="middle" font-family="sans-serif" x="16" y="180">S</text>
                <text text-anchor="middle" font-family="sans-serif" x="272" y="116">p</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="180">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="56" y="116">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="184" y="180">2</text>
                <text text-anchor="middle" font-family="sans-serif" x="448" y="36">T</text>
                <text text-anchor="middle" font-family="sans-serif" x="8" y="84">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="16" y="116">S</text>
                <text text-anchor="middle" font-family="sans-serif" x="40" y="84">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="328" y="116">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="244">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="240" y="244">C</text>
                <text text-anchor="middle" font-family="sans-serif" x="288" y="244">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="24" y="4">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="36">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="272" y="36">p</text>
                <text text-anchor="middle" font-family="sans-serif" x="128" y="180">H</text>
                <text text-anchor="middle" font-family="sans-serif" x="248" y="244">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="408" y="244">T</text>
                <text text-anchor="middle" font-family="sans-serif" x="24" y="84">k</text>
                <text text-anchor="middle" font-family="sans-serif" x="32" y="84">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="24" y="180">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="392" y="244">h</text>
                <text text-anchor="middle" font-family="sans-serif" x="16" y="36">S</text>
                <text text-anchor="middle" font-family="sans-serif" x="40" y="180">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="244">p</text>
                <text text-anchor="middle" font-family="sans-serif" x="24" y="36">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="32" y="36">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="36">C</text>
                <text text-anchor="middle" font-family="sans-serif" x="32" y="244">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="40" y="36">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="136" y="116">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="152" y="180">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="116">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="288" y="180">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="136" y="244">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="48" y="36">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="312" y="36">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="416" y="36">u</text>
                <text text-anchor="middle" font-family="sans-serif" x="136" y="180">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="184" y="244">3</text>
                <text text-anchor="middle" font-family="sans-serif" x="320" y="36">x</text>
                <text text-anchor="middle" font-family="sans-serif" x="144" y="116">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="328" y="180">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="48" y="84">s</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="116">C</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="180">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="0" y="4">F</text>
                <text text-anchor="middle" font-family="sans-serif" x="144" y="244">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="152" y="244">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="312" y="116">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="244">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="160" y="180">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="312" y="180">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="36">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="152" y="116">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="320" y="116">x</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="116">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="16" y="4">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="144" y="36">o</text>
                <text text-anchor="middle" font-family="sans-serif" x="288" y="36">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="296" y="116">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="16" y="244">S</text>
                <text text-anchor="middle" font-family="sans-serif" x="424" y="244">g</text>
                <text text-anchor="middle" font-family="sans-serif" x="408" y="36">A</text>
                <text text-anchor="middle" font-family="sans-serif" x="432" y="36">h</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="116">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="296" y="180">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="56" y="244">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="136" y="36">N</text>
                <text text-anchor="middle" font-family="sans-serif" x="0" y="84">P</text>
                <text text-anchor="middle" font-family="sans-serif" x="280" y="180">h</text>
                <text text-anchor="middle" font-family="sans-serif" x="424" y="36">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="304" y="244">x</text>
                <text text-anchor="middle" font-family="sans-serif" x="160" y="244">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="56" y="36">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="32" y="116">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="320" y="180">x</text>
                <text text-anchor="middle" font-family="sans-serif" x="144" y="180">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="128" y="244">H</text>
                <text text-anchor="middle" font-family="sans-serif" x="416" y="244">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="296" y="36">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="288" y="116">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="272" y="180">p</text>
                <text text-anchor="middle" font-family="sans-serif" x="160" y="36">c</text>
                <text text-anchor="middle" font-family="sans-serif" x="160" y="116">e</text>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-datagram-packetization-acro" class="selfRef">Datagram packetization across multiple packets.</a>
          </figcaption></figure>
<p id="section-3.6-5">RUD Datagram packetization is analogous to IP packet fragmentation except that it actually works.<a href="#section-3.6-5" class="pilcrow">¶</a></p>
<div id="n-packet-header">
<section id="section-3.6.1">
          <h4 id="name-packet-header">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-packet-header" class="section-name selfRef">Packet Header</a>
          </h4>
<p id="section-3.6.1-1">The packet header block appears immediately after the Stream identifier. It specifies the information used to reassemble packets in order to form a complete datagram, to acknowledge packet receipt, and other control information.<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.6.1-2">
            <dt id="section-3.6.1-2.1">Datagram index</dt>
            <dd style="margin-left: 1.5em" id="section-3.6.1-2.2">
              <p id="section-3.6.1-2.2.1">Integer counter beginning at 0 and incremented by 1 for each partial or final datagram sent in the stream.<a href="#section-3.6.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.6.1-2.3">Packet count</dt>
            <dd style="margin-left: 1.5em" id="section-3.6.1-2.4">
              <p id="section-3.6.1-2.4.1">Integer specifying the number of packets in the datagram<a href="#section-3.6.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.6.1-2.5">Packet sent index</dt>
            <dd style="margin-left: 1.5em" id="section-3.6.1-2.6">
              <p id="section-3.6.1-2.6.1">Integer counter beginning at 0 and incremented by 1 for each packet sent wrapping at 15 bits.<a href="#section-3.6.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.6.1-2.7">Retransmit index</dt>
            <dd style="margin-left: 1.5em" id="section-3.6.1-2.8">
              <p id="section-3.6.1-2.8.1">Integer incremented each time a packet is resent. Since the resent data is identical, it is only necessary to acknowledge data once even if multiple copies are received.<a href="#section-3.6.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.6.1-2.9">Continuation Datagram flag.</dt>
            <dd style="margin-left: 1.5em" id="section-3.6.1-2.10">
              <p id="section-3.6.1-2.10.1">Integer containing flags information. The low order bit (0) is 0 for a partial datagram and 1 for a final datagram.<a href="#section-3.6.1-2.10.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.6.1-2.11">Received index</dt>
            <dd style="margin-left: 1.5em" id="section-3.6.1-2.12">
              <p id="section-3.6.1-2.12.1">Integer index of the first packet being acknowledged.<a href="#section-3.6.1-2.12.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.6.1-2.13">Acknowledgements</dt>
            <dd style="margin-left: 1.5em" id="section-3.6.1-2.14">
              <p id="section-3.6.1-2.14.1">Bitfield containing the value 1 for packets that have been received and 0 otherwise.<a href="#section-3.6.1-2.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-flow-control-packet-header"></span><figure id="figure-17">
            <div class="artwork art-svg alignLeft" id="section-3.6.1-3.1">
<svg xmlns="http://www.w3.org/2000/svg" width="536" height="217" viewBox="0 0 536.0 217.0">
                <g transform="translate(8,16)">
                  <path d="M 0,0 L 80,0" fill="none" stroke="black"></path>
                  <path d="M 80,0 L 160,0" fill="none" stroke="black"></path>
                  <path d="M 160,0 L 240,0" fill="none" stroke="black"></path>
                  <path d="M 240,0 L 320,0" fill="none" stroke="black"></path>
                  <path d="M 320,0 L 400,0" fill="none" stroke="black"></path>
                  <path d="M 400,0 L 520,0" fill="none" stroke="black"></path>
                  <path d="M 0,64 L 80,64" fill="none" stroke="black"></path>
                  <path d="M 80,64 L 160,64" fill="none" stroke="black"></path>
                  <path d="M 160,64 L 240,64" fill="none" stroke="black"></path>
                  <path d="M 240,64 L 264,64" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 320,64" fill="none" stroke="black"></path>
                  <path d="M 320,64 L 400,64" fill="none" stroke="black"></path>
                  <path d="M 400,64 L 520,64" fill="none" stroke="black"></path>
                  <path d="M 0,128 L 520,128" fill="none" stroke="black"></path>
                  <path d="M 0,192 L 520,192" fill="none" stroke="black"></path>
                  <path d="M 0,0 L 0,64" fill="none" stroke="black"></path>
                  <path d="M 0,128 L 0,192" fill="none" stroke="black"></path>
                  <path d="M 80,0 L 80,64" fill="none" stroke="black"></path>
                  <path d="M 160,0 L 160,64" fill="none" stroke="black"></path>
                  <path d="M 240,0 L 240,64" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 264,112" fill="none" stroke="black"></path>
                  <path d="M 320,0 L 320,64" fill="none" stroke="black"></path>
                  <path d="M 400,0 L 400,64" fill="none" stroke="black"></path>
                  <path d="M 520,0 L 520,64" fill="none" stroke="black"></path>
                  <path d="M 520,128 L 520,192" fill="none" stroke="black"></path>
                  <path d="M 264,112 L 264,120" fill="none" stroke="black"></path>
                  <polygon points="280.000000,112.000000 268.000000,106.400002 268.000000,117.599998" fill="black" transform="rotate(90.000000, 264.000000, 112.000000)"></polygon>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="52">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="52">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="20">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="480" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="52">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="148">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="180">1</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="36">x</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="100">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="148">y</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="180">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="472" y="52">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">p</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="148">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="488" y="20">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="36">I</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="100">)</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="20">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="20">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="408" y="20">A</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="52">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="52">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="52">6</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="180">6</text>
                  <text text-anchor="middle" font-family="sans-serif" x="504" y="20">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="24" y="36">I</text>
                  <text text-anchor="middle" font-family="sans-serif" x="360" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="52">1</text>
                  <text text-anchor="middle" font-family="sans-serif" x="32" y="20">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="416" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="240" y="148">d</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="180">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="148">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="180">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="40" y="20">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">w</text>
                  <text text-anchor="middle" font-family="sans-serif" x="48" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="376" y="52">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="148">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="20">F</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="20">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="376" y="36">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="360" y="52">y</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="52">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="464" y="52">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="148">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="112" y="20">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="36">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="488" y="36">d</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="52">y</text>
                  <text text-anchor="middle" font-family="sans-serif" x="136" y="20">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="120" y="52">y</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="148">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="180">y</text>
                  <text text-anchor="middle" font-family="sans-serif" x="496" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="32" y="36">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="480" y="36">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="148">H</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="384" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="52">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="448" y="52">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="456" y="52">y</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="148">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="20">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="456" y="20">l</text>
                  <text text-anchor="middle" font-family="sans-serif" x="424" y="36">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="472" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="176" y="36">L</text>
                  <text text-anchor="middle" font-family="sans-serif" x="128" y="52">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="100">E</text>
                  <text text-anchor="middle" font-family="sans-serif" x="176" y="148">E</text>
                  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">F</text>
                  <text text-anchor="middle" font-family="sans-serif" x="96" y="52">1</text>
                  <text text-anchor="middle" font-family="sans-serif" x="264" y="148">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="320" y="100">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="24" y="20">F</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="20">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="40" y="52">y</text>
                  <text text-anchor="middle" font-family="sans-serif" x="128" y="20">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="456" y="36">f</text>
                  <text text-anchor="middle" font-family="sans-serif" x="480" y="52">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="36">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="48" y="52">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">o</text>
                  <text text-anchor="middle" font-family="sans-serif" x="464" y="36">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="40" y="36">d</text>
                  <text text-anchor="middle" font-family="sans-serif" x="16" y="52">6</text>
                  <text text-anchor="middle" font-family="sans-serif" x="312" y="100">(</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="148">P</text>
                  <text text-anchor="middle" font-family="sans-serif" x="56" y="36">x</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="52">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="148">r</text>
                  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="512" y="20">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="344" y="36">q</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="148">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="36">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="192" y="36">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="216" y="36">h</text>
                  <text text-anchor="middle" font-family="sans-serif" x="328" y="36">S</text>
                  <text text-anchor="middle" font-family="sans-serif" x="368" y="52">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="224" y="148">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="148">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="336" y="148">d</text>
                  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="288" y="36">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="32" y="52">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="136" y="52">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="180">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="440" y="36">t</text>
                  <text text-anchor="middle" font-family="sans-serif" x="64" y="52">s</text>
                  <text text-anchor="middle" font-family="sans-serif" x="200" y="52">y</text>
                  <text text-anchor="middle" font-family="sans-serif" x="272" y="20">c</text>
                  <text text-anchor="middle" font-family="sans-serif" x="368" y="36">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="176" y="52">1</text>
                  <text text-anchor="middle" font-family="sans-serif" x="472" y="20">g</text>
                  <text text-anchor="middle" font-family="sans-serif" x="280" y="36">d</text>
                  <text text-anchor="middle" font-family="sans-serif" x="432" y="36">i</text>
                  <text text-anchor="middle" font-family="sans-serif" x="120" y="20">a</text>
                  <text text-anchor="middle" font-family="sans-serif" x="256" y="52">1</text>
                  <text text-anchor="middle" font-family="sans-serif" x="232" y="148">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">k</text>
                  <text text-anchor="middle" font-family="sans-serif" x="464" y="20">e</text>
                  <text text-anchor="middle" font-family="sans-serif" x="112" y="52">b</text>
                  <text text-anchor="middle" font-family="sans-serif" x="184" y="148">n</text>
                  <text text-anchor="middle" font-family="sans-serif" x="208" y="20">m</text>
                  <text text-anchor="middle" font-family="sans-serif" x="352" y="36">u</text>
                  <text text-anchor="middle" font-family="sans-serif" x="296" y="100">S</text>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-flow-control-packet-header" class="selfRef">Flow control packet header</a>
            </figcaption></figure>
</section>
</div>
<div id="n-flow-control">
<section id="section-3.6.2">
          <h4 id="name-flow-control">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-flow-control" class="section-name selfRef">Flow Control</a>
          </h4>
<p id="section-3.6.2-1">TCP flow control is designed to meet the needs of the day. Modern networks have very different needs.<a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
<p id="section-3.6.2-2">Congestion avoidance is still important and implementations <span class="bcp14">MUST</span> take steps to avoid overburdening network resources.<a href="#section-3.6.2-2" class="pilcrow">¶</a></p>
<p id="section-3.6.2-3">May require additional packets that only contain flow control info. This <span class="bcp14">MAY</span> be used to communicate One time Stream IDs.<a href="#section-3.6.2-3" class="pilcrow">¶</a></p>
<p id="section-3.6.2-4">Congestion control limits <span class="bcp14">MAY</span> be specified for the connection as a whole and for individual ports. In situations where multiple Internet connections are available, applications <span class="bcp14">MUST</span> enforce flow control limits on each port.<a href="#section-3.6.2-4" class="pilcrow">¶</a></p>
<p id="section-3.6.2-5">[Here describe the feedback characteristics determined through experimentation.]<a href="#section-3.6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-connection-datagrams">
<section id="section-3.7">
        <h3 id="name-connection-datagrams">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-connection-datagrams" class="section-name selfRef">Connection Datagrams</a>
        </h3>
<p id="section-3.7-1">Connection Datagrams are used during the key exchange used to establish a connection. Unlike data Datagrams in which have a single data section, all of which is encrypted, connection Datagrams may contain three separate types of data section:<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.7-2">
          <dt id="section-3.7-2.1">Plaintext data</dt>
          <dd style="margin-left: 1.5em" id="section-3.7-2.2">
            <p id="section-3.7-2.2.1">Unencrypted data section. This is used to pass the information needed to perform the 'mezzanine' key exchange to the responder's credential and to present and respond to challenges.<a href="#section-3.7-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.7-2.3">Mezzanine data</dt>
          <dd style="margin-left: 1.5em" id="section-3.7-2.4">
            <p id="section-3.7-2.4.1">Data encrypted under 'mezzanine' key exchange authenticated by the responder's credential alone. This is used to pass information related to the initiator credential.<a href="#section-3.7-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.7-2.5">Ciphertext data</dt>
          <dd style="margin-left: 1.5em" id="section-3.7-2.6">
            <p id="section-3.7-2.6.1">Data encrypted under the mutual key exchange authenticated to the credentials of the initiator and the responder.<a href="#section-3.7-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.7-3">The <code>ClientCompleteDeferred</code> Datagram contains all three data sections. The ciphertext data section is encapsulated inside the Mezzanine data section and is thus encrypted twice. Only the Mezzanine section is padded.<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<span id="name-connection-datagram-format"></span><figure id="figure-18">
          <div class="artwork art-svg alignLeft" id="section-3.7-4.1">
<svg xmlns="http://www.w3.org/2000/svg" width="536" height="89" viewBox="0 0 536.0 89.0">
              <g transform="translate(8,16)">
                <path d="M 0,0 L 96,0" fill="none" stroke="black"></path>
                <path d="M 96,0 L 192,0" fill="none" stroke="black"></path>
                <path d="M 192,0 L 520,0" fill="none" stroke="black"></path>
                <path d="M 192,32 L 328,32" fill="none" stroke="black"></path>
                <path d="M 328,32 L 416,32" fill="none" stroke="black"></path>
                <path d="M 416,32 L 472,32" fill="none" stroke="black"></path>
                <path d="M 472,32 L 520,32" fill="none" stroke="black"></path>
                <path d="M 0,64 L 96,64" fill="none" stroke="black"></path>
                <path d="M 96,64 L 192,64" fill="none" stroke="black"></path>
                <path d="M 192,64 L 328,64" fill="none" stroke="black"></path>
                <path d="M 328,64 L 416,64" fill="none" stroke="black"></path>
                <path d="M 416,64 L 472,64" fill="none" stroke="black"></path>
                <path d="M 472,64 L 520,64" fill="none" stroke="black"></path>
                <path d="M 0,0 L 0,64" fill="none" stroke="black"></path>
                <path d="M 96,0 L 96,64" fill="none" stroke="black"></path>
                <path d="M 192,0 L 192,32" fill="none" stroke="black"></path>
                <path d="M 192,32 L 192,64" fill="none" stroke="black"></path>
                <path d="M 328,32 L 328,64" fill="none" stroke="black"></path>
                <path d="M 472,32 L 472,64" fill="none" stroke="black"></path>
                <path d="M 520,0 L 520,32" fill="none" stroke="black"></path>
                <path d="M 520,32 L 520,64" fill="none" stroke="black"></path>
                <text text-anchor="middle" font-family="sans-serif" x="376" y="20">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="48" y="36">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="272" y="52">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="384" y="52">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="392" y="20">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="144" y="36">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="288" y="52">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="344" y="52">C</text>
                <text text-anchor="middle" font-family="sans-serif" x="368" y="52">h</text>
                <text text-anchor="middle" font-family="sans-serif" x="448" y="52">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="296" y="52">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="52">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="384" y="20">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="152" y="36">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="456" y="52">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="24" y="36">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="32" y="36">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="52">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="408" y="52">x</text>
                <text text-anchor="middle" font-family="sans-serif" x="440" y="52">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="36">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="112" y="36">P</text>
                <text text-anchor="middle" font-family="sans-serif" x="160" y="36">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="232" y="52">z</text>
                <text text-anchor="middle" font-family="sans-serif" x="304" y="52">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="352" y="52">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="432" y="52">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="352" y="20">z</text>
                <text text-anchor="middle" font-family="sans-serif" x="120" y="36">l</text>
                <text text-anchor="middle" font-family="sans-serif" x="128" y="36">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="376" y="52">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="392" y="52">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="368" y="20">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="248" y="52">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="496" y="52">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="168" y="36">x</text>
                <text text-anchor="middle" font-family="sans-serif" x="240" y="52">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="400" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="40" y="36">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="136" y="36">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="208" y="52">M</text>
                <text text-anchor="middle" font-family="sans-serif" x="216" y="52">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="400" y="52">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="504" y="52">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="16" y="36">S</text>
                <text text-anchor="middle" font-family="sans-serif" x="56" y="36">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="36">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="360" y="52">p</text>
                <text text-anchor="middle" font-family="sans-serif" x="344" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="336" y="20">M</text>
                <text text-anchor="middle" font-family="sans-serif" x="176" y="36">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="224" y="52">z</text>
                <text text-anchor="middle" font-family="sans-serif" x="312" y="52">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="488" y="52">P</text>
                <text text-anchor="middle" font-family="sans-serif" x="360" y="20">z</text>
                <text text-anchor="middle" font-family="sans-serif" x="416" y="52">t</text>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-connection-datagram-format" class="selfRef">Connection Datagram Format.</a>
          </figcaption></figure>
<p id="section-3.7-5">A connection Datagram <span class="bcp14">MAY</span> contain a payload. This is always carried in the last data section.<a href="#section-3.7-5" class="pilcrow">¶</a></p>
<p id="section-3.7-6">Connection Datagrams that only contain plaintext data <span class="bcp14">MUST NOT</span> contain confidential data. This requirement may be enforced in a future revision of the specification by limiting use to a 'service discovery' protocol.<a href="#section-3.7-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-connection-establishment-and-maintenance">
<section id="section-4">
      <h2 id="name-connection-establishment-an">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-connection-establishment-an" class="section-name selfRef">Connection Establishment and Maintenance</a>
      </h2>
<div id="n-key-exchange-modes">
<section id="section-4.1">
        <h3 id="name-key-exchange-modes">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-key-exchange-modes" class="section-name selfRef">Key Exchange modes</a>
        </h3>
<p id="section-4.1-1">Three key exchange mechanisms are supported. The choice of mechanism depending on whether the initiator knows the credentials of the host and on whether the host is willing to perform a key exchange operation without challenge:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-2">
          <dt id="section-4.1-2.1">First Contact</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">The only key exchange mode supported when the client does not know the responder credential. This is a two-round exchange in which the payload of the first round is limited to plaintext data.<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-2.3">Immediate</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-2.4">
            <p id="section-4.1-2.4.1">A key exchange in which the initiator knows the responder and offers a complete mutual key exchange in the first message. If accepted by the responder, this exchange requires only a single round which <span class="bcp14">MAY</span> carry ciphertext payload.<a href="#section-4.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-2.5">Deferred</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-2.6">
            <p id="section-4.1-2.6.1">A variation of the zero round trip exchange in which the responder returns a plaintext challenge to the initiator instead of immediately accepting the key exchange. This permits mitigation of denial-of-service attacks.<a href="#section-4.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-3">Unlike other RUD interactions, the response to a connection establishment request <span class="bcp14">MUST</span> be returned to the network endpoint from which it was received.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">The <code>InitiatorHello</code> datagram and <code>InitiatorExchange</code> datagram are special in that they <span class="bcp14">MUST</span> be presented in a single packet and <span class="bcp14">MUST</span> use the Stream Identifier consisting of sixteen zero bytes.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<div id="n-first-contact">
<section id="section-4.1.1">
          <h4 id="name-first-contact">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-first-contact" class="section-name selfRef">First Contact</a>
          </h4>
<p id="section-4.1.1-1">The first contact exchange comprises two round trips:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1.1-2">
            <dt id="section-4.1.1-2.1"><code>InitiatorHello</code></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.2">
              <p id="section-4.1.1-2.2.1">[Plaintext] Stream ID, Payload<a href="#section-4.1.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-2.3"><code>ResponderChallenge</code></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.4">
              <p id="section-4.1.1-2.4.1">[Plaintext] Responder credential,<a href="#section-4.1.1-2.4.1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2.4.2">[Plaintext] Set of responder ephemeral keys<a href="#section-4.1.1-2.4.2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2.4.3">[Plaintext] Challenge<a href="#section-4.1.1-2.4.3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2.4.4">[Plaintext] Stream ID, Payload<a href="#section-4.1.1-2.4.4" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-2.5"><code>InitiatorComplete</code></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.6">
              <p id="section-4.1.1-2.6.1">[Plaintext] Responder key identifier<a href="#section-4.1.1-2.6.1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2.6.2">[Plaintext] Initiator Ephemeral<a href="#section-4.1.1-2.6.2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2.6.3">[Plaintext] Response to Challenge<a href="#section-4.1.1-2.6.3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2.6.4">[Mezzanine] Initiator Credential + Initiator key identifier<a href="#section-4.1.1-2.6.4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2.6.5">[Encrypted] Stream ID, Payload<a href="#section-4.1.1-2.6.5" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.1-2.7"><code>Data</code></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.1-2.8">
              <p id="section-4.1.1-2.8.1">[Encrypted] Stream ID, Payload<a href="#section-4.1.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.1.1-3">For example...<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">Key exchange example TBS<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-5">Since the InitiatorHello and InitiatorComplete payloads are always sent <em>en clair</em>, these are only available for use in querying the public capabilities exposed by the responder. For example, the set of services offered.<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-immediate">
<section id="section-4.1.2">
          <h4 id="name-immediate">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-immediate" class="section-name selfRef">Immediate</a>
          </h4>
<p id="section-4.1.2-1">The immediate exchange comprises a single round trip:<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1.2-2">
            <dt id="section-4.1.2-2.1"><code>InitiatorExchange</code></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.2-2.2">
              <p id="section-4.1.2-2.2.1">[Plaintext] Responder key identifier<a href="#section-4.1.2-2.2.1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2.2.2">[Plaintext] Initiator Ephemeral<a href="#section-4.1.2-2.2.2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2.2.3">[Mezzanine] Initiator Credential + Initiator key identifier<a href="#section-4.1.2-2.2.3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2.2.4">[Mezzanine] Stream ID, Payload<a href="#section-4.1.2-2.2.4" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.2-2.3"><code>ResponderComplete</code></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.2-2.4">
              <p id="section-4.1.2-2.4.1">[Mezzanine] Initiator key identifier<a href="#section-4.1.2-2.4.1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2.4.2">[Mezzanine] Responder Ephemeral<a href="#section-4.1.2-2.4.2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2.4.3">[Encrypted] Stream ID, Payload<a href="#section-4.1.2-2.4.3" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.1.2-3">Note that in this case the initial initiator payload is only encrypted, it is only authenticated to the responder since the responder has not contributed any form of challenge data to the initiator.<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-4">For example...<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.2-5">Key exchange example TBS<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.1.2-6"></p>
</section>
</div>
<div id="n-deferred-trip">
<section id="section-4.1.3">
          <h4 id="name-deferred-trip">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-deferred-trip" class="section-name selfRef">Deferred Trip</a>
          </h4>
<p id="section-4.1.3-1">The deferred exchange is an alternative to the immediate exchange that is performed at the option of the responder. Instead of accepting the connection request immediately, the initiator defers acceptance of the request until the initiator has given a correct response to a challenge:<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1.3-2">
            <dt id="section-4.1.3-2.1"><code>InitiatorExchange</code></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.3-2.2">
              <p id="section-4.1.3-2.2.1">(As for the Immediate case)<a href="#section-4.1.3-2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.3-2.3"><code>ResponderDefer</code></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.3-2.4">
              <p id="section-4.1.3-2.4.1">[Plaintext] Responder credential,<a href="#section-4.1.3-2.4.1" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2.4.2">[Plaintext] Set of responder ephemeral keys<a href="#section-4.1.3-2.4.2" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2.4.3">[Plaintext] Challenge<a href="#section-4.1.3-2.4.3" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2.4.4">[Plaintext] Stream ID, Payload<a href="#section-4.1.3-2.4.4" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.1.3-2.5"><code>InitiatorComplete</code></dt>
            <dd style="margin-left: 1.5em" id="section-4.1.3-2.6">
              <p id="section-4.1.3-2.6.1">(As for the First Contact case)<a href="#section-4.1.3-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.1.3-3">Key exchange example TBS<a href="#section-4.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-ticketed-connection">
<section id="section-4.2">
        <h3 id="name-ticketed-connection">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-ticketed-connection" class="section-name selfRef">Ticketed Connection</a>
        </h3>
<p id="section-4.2-1">For supporting presence and discovery services.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Ticket specifies a shared secret, session ID, network end point.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Example discovery, Alice's device connects to the provider's discovery service, is authenticated and receives a ticket to connect to a specific host. This allows a connection to be established to that host without the need to perform a connection key exchange.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Example presence, Alice wants to talk to Bob, contacts his discovery service, gets a ticket back allowing Bob to establish a direct, encrypted connection.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">In either case, a client <span class="bcp14">SHOULD</span> perform a rekey operation as indicated by requirements for perfect forward secrecy, security policy, yada yada.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-connection-forward-secrecy-rekeying">
<section id="section-4.3">
        <h3 id="name-connection-forward-secrecy-">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-connection-forward-secrecy-" class="section-name selfRef">Connection Forward Secrecy Rekeying</a>
        </h3>
<p id="section-4.3-1">Rekeying is only necessary to provide forward secrecy. The data encrypted under a single symmetric key is a small fraction of the maximum. But a connection that persists for several years still represents a liability.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">[Should we reintroduce the mezzanine packet so we can use the remainder of a packet without rekeying?]<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">[Packet extension contains the rekey data]<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-stream-establishment-and-maintenance">
<section id="section-5">
      <h2 id="name-stream-establishment-and-ma">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-stream-establishment-and-ma" class="section-name selfRef">Stream Establishment and Maintenance</a>
      </h2>
<div id="n-stream-creation-and-binding">
<section id="section-5.1">
        <h3 id="name-stream-creation-and-binding">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-stream-creation-and-binding" class="section-name selfRef">Stream Creation and Binding</a>
        </h3>
<p id="section-5.1-1">Streams are created by sending a packet containing a <code>StreamClient</code> or <code>StreamReceiver</code> Packet extension.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The Restart Packet extension is a special stream creation extension that causes the stream in which it is declared to be closed and a new stream opened. The Restart extension is used when restarting the stream datagram index and to change cryptographic parameters.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">An Initiator <span class="bcp14">MUST</span> specify a stream creation extension in any connection packet containing either a ciphertext extensions or mezannine extensions section.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">Senders <span class="bcp14">MUST NOT</span> specify more than one  stream creation extension in a single datagram. Should a packet with multiple  stream creation extensions be received, the recipient <span class="bcp14">MUST</span> reject the request.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">When a packet contains a  stream creation extension, all the extensions specified in that datagram are interpreted as applying to the stream being created. If the request is accepted, it is treated as if it is the first datagram in the newly created stream.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">Certain packet extensions are only valid in stream creation.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7"></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-8">
          <dt id="section-5.1-8.1">SID</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-8.2">
            <p id="section-5.1-8.2.1">Canonical Stream Identifier. Streams <span class="bcp14">MAY</span> be assigned any number of One time use IDs but there <span class="bcp14">MUST</span> be exactly one Stream Id.<a href="#section-5.1-8.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-8.3">PKIXC, PKIXO, MMMP, MMMC</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-8.4">
            <p id="section-5.1-8.4.1">Used to specify additional stream credentials.<a href="#section-5.1-8.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-8.5">X448, (other ephemeral keys)</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-8.6">
            <p id="section-5.1-8.6.1">Perform ephemeral key exchange.<a href="#section-5.1-8.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-8.7">Roll,</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-8.8">
            <p id="section-5.1-8.8.1">Make use of the primary exchange key specified of the specified canonical stream ID (as assigned by the recipient).<a href="#section-5.1-8.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-8.9">Encrypt</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-8.10">
            <p id="section-5.1-8.10.1">Set packet encryption parameters.<a href="#section-5.1-8.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-8.11"></dt>
          <dd style="margin-left: 1.5em" id="section-5.1-8.12"></dd>
          <dd class="break"></dd>
<dt id="section-5.1-8.13"></dt>
          <dd style="margin-left: 1.5em" id="section-5.1-8.14"></dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-9"></p>
<p id="section-5.1-10"></p>
<p id="section-5.1-11"></p>
<p id="section-5.1-12"></p>
<p id="section-5.1-13"></p>
<p id="section-5.1-14">When a stream is created, it is typically bound to a service.<a href="#section-5.1-14" class="pilcrow">¶</a></p>
<p id="section-5.1-15">A host might offer Mesh, Callsign and Discovery services. After connecting to the host, a device requests a stream to each of the services in turn. Each stream <span class="bcp14">MAY</span> be separately authorized.<a href="#section-5.1-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-stream-close">
<section id="section-5.2">
        <h3 id="name-stream-close">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-stream-close" class="section-name selfRef">Stream Close</a>
        </h3>
<p id="section-5.2-1">Streams <span class="bcp14">MAY</span> be closed when no longer needed. This allows reuse of the stream identifier(s) associated with the stream provided that no ambiguity can arise.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-one-time-stream-identifier">
<section id="section-5.3">
        <h3 id="name-one-time-stream-identifier">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-one-time-stream-identifier" class="section-name selfRef">One Time Stream Identifier</a>
        </h3>
<p id="section-5.3-1">In cases where defeating traffic analysis is of particular importance, a recipient <span class="bcp14">MAY</span> assign multiple identifiers to a single stream.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">For example, a device connecting issues a set of three stream identifiers to a service. The device receives two packets which are acknowledged together with a further three one-time use identifiers.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<span id="name-use-of-one-time-stream-iden"></span><figure id="figure-19">
          <div class="artwork art-svg alignLeft" id="section-5.3-3.1">
<svg xmlns="http://www.w3.org/2000/svg" width="464" height="265" viewBox="0 0 464.0 265.0">
              <g transform="translate(8,16)">
                <path d="M 0,0 L 160,0" fill="none" stroke="black"></path>
                <path d="M 288,0 L 448,0" fill="none" stroke="black"></path>
                <path d="M 0,32 L 80,32" fill="none" stroke="black"></path>
                <path d="M 80,32 L 160,32" fill="none" stroke="black"></path>
                <path d="M 288,32 L 376,32" fill="none" stroke="black"></path>
                <path d="M 376,32 L 448,32" fill="none" stroke="black"></path>
                <path d="M 80,64 L 152,64" fill="none" stroke="black"></path>
                <path d="M 288,64 L 368,64" fill="none" stroke="black"></path>
                <path d="M 88,96 L 160,96" fill="none" stroke="black"></path>
                <path d="M 296,96 L 376,96" fill="none" stroke="black"></path>
                <path d="M 88,128 L 160,128" fill="none" stroke="black"></path>
                <path d="M 296,128 L 376,128" fill="none" stroke="black"></path>
                <path d="M 80,160 L 160,160" fill="none" stroke="black"></path>
                <path d="M 296,160 L 368,160" fill="none" stroke="black"></path>
                <path d="M 88,192 L 160,192" fill="none" stroke="black"></path>
                <path d="M 296,192 L 376,192" fill="none" stroke="black"></path>
                <path d="M 88,224 L 160,224" fill="none" stroke="black"></path>
                <path d="M 296,224 L 376,224" fill="none" stroke="black"></path>
                <path d="M 0,0 L 0,32" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,64" fill="none" stroke="black"></path>
                <path d="M 80,64 L 80,160" fill="none" stroke="black"></path>
                <path d="M 80,160 L 80,240" fill="none" stroke="black"></path>
                <path d="M 160,0 L 160,32" fill="none" stroke="black"></path>
                <path d="M 288,0 L 288,32" fill="none" stroke="black"></path>
                <path d="M 376,32 L 376,96" fill="none" stroke="black"></path>
                <path d="M 376,96 L 376,128" fill="none" stroke="black"></path>
                <path d="M 376,128 L 376,192" fill="none" stroke="black"></path>
                <path d="M 376,192 L 376,224" fill="none" stroke="black"></path>
                <path d="M 376,224 L 376,240" fill="none" stroke="black"></path>
                <path d="M 448,0 L 448,32" fill="none" stroke="black"></path>
                <polygon points="96.000000,96.000000 84.000000,90.400002 84.000000,101.599998" fill="black" transform="rotate(180.000000, 88.000000, 96.000000)"></polygon>
                <polygon points="96.000000,128.000000 84.000000,122.400002 84.000000,133.600006" fill="black" transform="rotate(180.000000, 88.000000, 128.000000)"></polygon>
                <polygon points="96.000000,192.000000 84.000000,186.399994 84.000000,197.600006" fill="black" transform="rotate(180.000000, 88.000000, 192.000000)"></polygon>
                <polygon points="96.000000,224.000000 84.000000,218.399994 84.000000,229.600006" fill="black" transform="rotate(180.000000, 88.000000, 224.000000)"></polygon>
                <polygon points="376.000000,64.000000 364.000000,58.400002 364.000000,69.599998" fill="black" transform="rotate(0.000000, 368.000000, 64.000000)"></polygon>
                <polygon points="376.000000,160.000000 364.000000,154.399994 364.000000,165.600006" fill="black" transform="rotate(0.000000, 368.000000, 160.000000)"></polygon>
                <text text-anchor="middle" font-family="sans-serif" x="360" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="248" y="68">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="184" y="132">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="192" y="228">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="240" y="164">5</text>
                <text text-anchor="middle" font-family="sans-serif" x="224" y="196">3</text>
                <text text-anchor="middle" font-family="sans-serif" x="272" y="228">5</text>
                <text text-anchor="middle" font-family="sans-serif" x="176" y="228">F</text>
                <text text-anchor="middle" font-family="sans-serif" x="184" y="228">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="240" y="228">(</text>
                <text text-anchor="middle" font-family="sans-serif" x="64" y="20">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="400" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="176" y="100">F</text>
                <text text-anchor="middle" font-family="sans-serif" x="192" y="100">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="224" y="164">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="272" y="132">2</text>
                <text text-anchor="middle" font-family="sans-serif" x="216" y="164">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="280" y="164">6</text>
                <text text-anchor="middle" font-family="sans-serif" x="248" y="228">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="280" y="132">)</text>
                <text text-anchor="middle" font-family="sans-serif" x="192" y="164">#</text>
                <text text-anchor="middle" font-family="sans-serif" x="184" y="196">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="216" y="68">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="200" y="100">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="248" y="100">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="272" y="100">1</text>
                <text text-anchor="middle" font-family="sans-serif" x="280" y="100">)</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="228">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="184" y="100">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="240" y="100">(</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="100">#</text>
                <text text-anchor="middle" font-family="sans-serif" x="224" y="100">1</text>
                <text text-anchor="middle" font-family="sans-serif" x="272" y="164">#</text>
                <text text-anchor="middle" font-family="sans-serif" x="176" y="196">F</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="196">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="280" y="228">)</text>
                <text text-anchor="middle" font-family="sans-serif" x="88" y="20">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="132">#</text>
                <text text-anchor="middle" font-family="sans-serif" x="200" y="164">4</text>
                <text text-anchor="middle" font-family="sans-serif" x="240" y="196">(</text>
                <text text-anchor="middle" font-family="sans-serif" x="280" y="196">)</text>
                <text text-anchor="middle" font-family="sans-serif" x="200" y="228">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="176" y="68">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="208" y="68">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="68">#</text>
                <text text-anchor="middle" font-family="sans-serif" x="208" y="132">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="248" y="132">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="224" y="228">4</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="20">v</text>
                <text text-anchor="middle" font-family="sans-serif" x="352" y="20">S</text>
                <text text-anchor="middle" font-family="sans-serif" x="376" y="20">v</text>
                <text text-anchor="middle" font-family="sans-serif" x="232" y="164">#</text>
                <text text-anchor="middle" font-family="sans-serif" x="192" y="132">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="200" y="132">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="272" y="196">4</text>
                <text text-anchor="middle" font-family="sans-serif" x="184" y="164">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="368" y="20">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="392" y="20">c</text>
                <text text-anchor="middle" font-family="sans-serif" x="192" y="68">1</text>
                <text text-anchor="middle" font-family="sans-serif" x="176" y="132">F</text>
                <text text-anchor="middle" font-family="sans-serif" x="176" y="164">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="132">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="164">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="192" y="196">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="96" y="20">c</text>
                <text text-anchor="middle" font-family="sans-serif" x="384" y="20">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="168" y="68">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="184" y="68">#</text>
                <text text-anchor="middle" font-family="sans-serif" x="272" y="68">3</text>
                <text text-anchor="middle" font-family="sans-serif" x="208" y="196">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="248" y="196">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="196">#</text>
                <text text-anchor="middle" font-family="sans-serif" x="224" y="68">#</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="68">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="224" y="132">2</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="164">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="200" y="196">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="104" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="256" y="100">D</text>
                <text text-anchor="middle" font-family="sans-serif" x="240" y="132">(</text>
                <text text-anchor="middle" font-family="sans-serif" x="232" y="68">2</text>
                <text text-anchor="middle" font-family="sans-serif" x="208" y="100">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="208" y="228">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="264" y="228">#</text>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-use-of-one-time-stream-iden" class="selfRef">Use of one time Stream identifiers.</a>
          </figcaption></figure>
<p id="section-5.3-4">A block cipher <span class="bcp14">MAY</span> be employed to construct one time IDs that require no state to interpret. The issuer generates a fixed symmetric key. To create a new one time StreamID, the issuer encrypts a block containing a salt (e.g. a unique sequence number) and the stream ID to which the encrypted Id is to be mapped.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<p id="section-5.3-5">To interpret a one time ID, the service simply decrypts the encrypted form to recover the original stream ID, the salt is ignored.<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3-6">Note that when using this approach it is absolutely critical that the cipher used is a block cipher and not a stream cipher or a block cipher used in a streaming mode (e.g. AES-GCM).<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<span id="name-use-of-a-block-cipher-to-cr"></span><figure id="figure-20">
          <div class="artwork art-svg alignLeft" id="section-5.3-7.1">
<svg xmlns="http://www.w3.org/2000/svg" width="208" height="185" viewBox="0 0 208.0 185.0">
              <g transform="translate(8,16)">
                <path d="M 0,0 L 96,0" fill="none" stroke="black"></path>
                <path d="M 96,0 L 192,0" fill="none" stroke="black"></path>
                <path d="M 0,48 L 96,48" fill="none" stroke="black"></path>
                <path d="M 96,48 L 192,48" fill="none" stroke="black"></path>
                <path d="M 0,112 L 192,112" fill="none" stroke="black"></path>
                <path d="M 0,160 L 192,160" fill="none" stroke="black"></path>
                <path d="M 0,0 L 0,48" fill="none" stroke="black"></path>
                <path d="M 0,112 L 0,160" fill="none" stroke="black"></path>
                <path d="M 96,0 L 96,48" fill="none" stroke="black"></path>
                <path d="M 96,48 L 96,96" fill="none" stroke="black"></path>
                <path d="M 192,0 L 192,48" fill="none" stroke="black"></path>
                <path d="M 192,112 L 192,160" fill="none" stroke="black"></path>
                <path d="M 96,96 L 96,104" fill="none" stroke="black"></path>
                <polygon points="112.000000,96.000000 100.000000,90.400002 100.000000,101.599998" fill="black" transform="rotate(90.000000, 96.000000, 96.000000)"></polygon>
                <text text-anchor="middle" font-family="sans-serif" x="160" y="84">)</text>
                <text text-anchor="middle" font-family="sans-serif" x="56" y="132">T</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="148">2</text>
                <text text-anchor="middle" font-family="sans-serif" x="96" y="148">B</text>
                <text text-anchor="middle" font-family="sans-serif" x="56" y="20">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="136" y="20">u</text>
                <text text-anchor="middle" font-family="sans-serif" x="120" y="20">C</text>
                <text text-anchor="middle" font-family="sans-serif" x="128" y="20">o</text>
                <text text-anchor="middle" font-family="sans-serif" x="48" y="20">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="152" y="36">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="40" y="132">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="112" y="148">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="128" y="84">S</text>
                <text text-anchor="middle" font-family="sans-serif" x="24" y="132">O</text>
                <text text-anchor="middle" font-family="sans-serif" x="152" y="132">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="148">8</text>
                <text text-anchor="middle" font-family="sans-serif" x="32" y="132">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="152" y="20">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="120" y="36">6</text>
                <text text-anchor="middle" font-family="sans-serif" x="160" y="36">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="104" y="132">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="120" y="148">s</text>
                <text text-anchor="middle" font-family="sans-serif" x="160" y="132">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="32" y="20">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="20">I</text>
                <text text-anchor="middle" font-family="sans-serif" x="144" y="20">n</text>
                <text text-anchor="middle" font-family="sans-serif" x="152" y="84">k</text>
                <text text-anchor="middle" font-family="sans-serif" x="96" y="132">S</text>
                <text text-anchor="middle" font-family="sans-serif" x="120" y="132">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="24" y="20">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="24" y="36">6</text>
                <text text-anchor="middle" font-family="sans-serif" x="56" y="36">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="64" y="132">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="128" y="132">a</text>
                <text text-anchor="middle" font-family="sans-serif" x="168" y="36">s</text>
                <text text-anchor="middle" font-family="sans-serif" x="104" y="148">i</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="20">d</text>
                <text text-anchor="middle" font-family="sans-serif" x="32" y="36">4</text>
                <text text-anchor="middle" font-family="sans-serif" x="128" y="36">4</text>
                <text text-anchor="middle" font-family="sans-serif" x="120" y="84">E</text>
                <text text-anchor="middle" font-family="sans-serif" x="16" y="20">S</text>
                <text text-anchor="middle" font-family="sans-serif" x="40" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="160" y="20">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="168" y="20">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="48" y="36">B</text>
                <text text-anchor="middle" font-family="sans-serif" x="112" y="84">A</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="132">m</text>
                <text text-anchor="middle" font-family="sans-serif" x="112" y="132">r</text>
                <text text-anchor="middle" font-family="sans-serif" x="64" y="148">1</text>
                <text text-anchor="middle" font-family="sans-serif" x="64" y="36">t</text>
                <text text-anchor="middle" font-family="sans-serif" x="72" y="36">s</text>
                <text text-anchor="middle" font-family="sans-serif" x="144" y="36">B</text>
                <text text-anchor="middle" font-family="sans-serif" x="144" y="84">(</text>
                <text text-anchor="middle" font-family="sans-serif" x="80" y="132">e</text>
                <text text-anchor="middle" font-family="sans-serif" x="136" y="132">m</text>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-use-of-a-block-cipher-to-cr" class="selfRef">Use of a block cipher to create stateless stream identifiers.</a>
          </figcaption></figure>
</section>
</div>
<div id="n-stream-rekey">
<section id="section-5.4">
        <h3 id="name-stream-rekey">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-stream-rekey" class="section-name selfRef">Stream Rekey</a>
        </h3>
<p id="section-5.4-1">Rekeying the stream requires us to change the stream ID. No other characteristics of the stream are changed.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">Stream can rekey by specifying its own rekey data or say 'use the same keydata as this stream Id'.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">Thus, a connection with four separate streams only needs to perform one rekey to refresh the crypto for all four.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-schema">
<section id="section-6">
      <h2 id="name-schema">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-schema" class="section-name selfRef">Schema</a>
      </h2>
<div id="n-connection-datagrams-0">
<section id="section-6.1">
        <h3 id="name-connection-datagrams-2">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-connection-datagrams-2" class="section-name selfRef">Connection Datagrams</a>
      </h3>
</section>
</div>
<div id="n-packet-extensions">
<section id="section-6.2">
        <h3 id="name-packet-extensions">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-packet-extensions" class="section-name selfRef">Packet Extensions</a>
      </h3>
</section>
</div>
</section>
</div>
<div id="n-security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
    </h2>
</section>
</div>
<div id="n-iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document requires no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-acknowledgements">
<section id="section-9">
      <h2 id="name-acknowledgements">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-9-1"></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-normative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="draft-ietf-quic-transport">[draft-ietf-quic-transport]</dt>
      <dd>
<span class="refAuthor">Iyengar, J.</span> and <span class="refAuthor">M. Thomson</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-transport-34</span>, <time datetime="2021-01-14" class="refDate">14 January 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-transport-34">https://datatracker.ietf.org/doc/html/draft-ietf-quic-transport-34</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
    <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11">
      <h2 id="name-informative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="draft-hallambaker-mesh-developer">[draft-hallambaker-mesh-developer]</dt>
    <dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh: Reference Implementation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-developer-10</span>, <time datetime="2020-07-27" class="refDate">27 July 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-hallambaker-mesh-developer-10">https://datatracker.ietf.org/doc/html/draft-hallambaker-mesh-developer-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
