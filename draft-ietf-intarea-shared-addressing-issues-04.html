<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Issues with IP Address Sharing</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Shared Addressing Solutions">
<link href="#rfc.section.3" rel="Chapter" title="3 Analysis of Issues as they Relate to First and Third Parties">
<link href="#rfc.section.4" rel="Chapter" title="4 Content Provider Example">
<link href="#rfc.section.5" rel="Chapter" title="5 Port Allocation">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Outgoing Ports">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Incoming Ports">
<link href="#rfc.section.5.2.1" rel="Chapter" title="5.2.1 Port Negotiation">
<link href="#rfc.section.5.2.1.1" rel="Chapter" title="5.2.1.1 Universal Plug and Play (UPnP)">
<link href="#rfc.section.5.2.1.2" rel="Chapter" title="5.2.1.2 NAT Port Mapping Protocol (NAT-PMP)">
<link href="#rfc.section.5.2.2" rel="Chapter" title="5.2.2 Connection to a Well-Known Port Number">
<link href="#rfc.section.5.2.3" rel="Chapter" title="5.2.3 Port Discovery Mechanisms">
<link href="#rfc.section.6" rel="Chapter" title="6 Impact on Applications">
<link href="#rfc.section.7" rel="Chapter" title="7 Geo-location and Geo-proximity">
<link href="#rfc.section.8" rel="Chapter" title="8 Tracking Service Usage">
<link href="#rfc.section.9" rel="Chapter" title="9 ICMP">
<link href="#rfc.section.10" rel="Chapter" title="10 MTU">
<link href="#rfc.section.11" rel="Chapter" title="11 Fragmentation">
<link href="#rfc.section.12" rel="Chapter" title="12 Traceability">
<link href="#rfc.section.13" rel="Chapter" title="13 Security">
<link href="#rfc.section.13.1" rel="Chapter" title="13.1 Abuse Logging and Penalty Boxes">
<link href="#rfc.section.13.2" rel="Chapter" title="13.2 Authentication">
<link href="#rfc.section.13.3" rel="Chapter" title="13.3 SPAM">
<link href="#rfc.section.13.4" rel="Chapter" title="13.4 Port Randomisation">
<link href="#rfc.section.13.5" rel="Chapter" title="13.5 IPsec">
<link href="#rfc.section.13.6" rel="Chapter" title="13.6 Policing Forwarding Behaviour">
<link href="#rfc.section.14" rel="Chapter" title="14 Transport Issues">
<link href="#rfc.section.14.1" rel="Chapter" title="14.1 Parallel connections">
<link href="#rfc.section.14.2" rel="Chapter" title="14.2 Serial connections">
<link href="#rfc.section.14.3" rel="Chapter" title="14.3 TCP Control Block Sharing">
<link href="#rfc.section.15" rel="Chapter" title="15 Reverse DNS">
<link href="#rfc.section.16" rel="Chapter" title="16 Load Balancing">
<link href="#rfc.section.17" rel="Chapter" title="17 IPv6 Transition Issues">
<link href="#rfc.section.18" rel="Chapter" title="18 Introduction of Single Points of Failure">
<link href="#rfc.section.19" rel="Chapter" title="19 State Maintenance Reduces Battery Life">
<link href="#rfc.section.20" rel="Chapter" title="20 Support of Multicast">
<link href="#rfc.section.21" rel="Chapter" title="21 Support of Mobile-IP">
<link href="#rfc.section.22" rel="Chapter" title="22 IANA Considerations">
<link href="#rfc.section.23" rel="Chapter" title="23 Security Considerations">
<link href="#rfc.section.24" rel="Chapter" title="24 Contributors">
<link href="#rfc.section.25" rel="Chapter" title="25 Acknowledgments">
<link href="#rfc.section.26" rel="Chapter" title="26 Annex">
<link href="#rfc.section.26.1" rel="Chapter" title="26.1 Classes of Address Sharing Solution">
<link href="#rfc.section.26.2" rel="Chapter" title="26.2 Address Space Multiplicative Factor">
<link href="#rfc.references" rel="Chapter" title="27 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The completion of IPv4 address allocations from IANA and the RIRs is causing service providers around the world to question how they will continue providing IPv4 connectivity service to their subscribers when there are no longer sufficient IPv4 addresses to allocate them one per subscriber. Several possible solutions to this problem are now emerging based around the idea of shared IPv4 addressing. These solutions give rise to a number of issues and this memo identifies those common to all such address sharing approaches. Such issues include application failures, additional service monitoring complexity, new security vulnerabilities and so on. Solution-specific discussions are out of scope." />
  <meta name="description" content="The completion of IPv4 address allocations from IANA and the RIRs is causing service providers around the world to question how they will continue providing IPv4 connectivity service to their subscribers when there are no longer sufficient IPv4 addresses to allocate them one per subscriber. Several possible solutions to this problem are now emerging based around the idea of shared IPv4 addressing. These solutions give rise to a number of issues and this memo identifies those common to all such address sharing approaches. Such issues include application failures, additional service monitoring complexity, new security vulnerabilities and so on. Solution-specific discussions are out of scope." />
  <meta name="keywords" content="IPv4 address exhaustion completion shared sharing issues" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">M. Ford, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Internet Society</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">M. Boucadair</td>
</tr>
<tr>
<td class="left">Expires: August 26, 2011</td>
<td class="right">France Telecom</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">A. Durand</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Juniper Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">P. Levis</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">France Telecom</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">P. Roberts</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Internet Society</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">February 22, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Issues with IP Address Sharing<br />
  <span class="filename">draft-ietf-intarea-shared-addressing-issues-04</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The completion of IPv4 address allocations from IANA and the RIRs is causing service providers around the world to question how they will continue providing IPv4 connectivity service to their subscribers when there are no longer sufficient IPv4 addresses to allocate them one per subscriber. Several possible solutions to this problem are now emerging based around the idea of shared IPv4 addressing. These solutions give rise to a number of issues and this memo identifies those common to all such address sharing approaches. Such issues include application failures, additional service monitoring complexity, new security vulnerabilities and so on. Solution-specific discussions are out of scope.</p>
<p>Deploying IPv6 is the only perennial way to ease pressure on the public IPv4 address pool without the need for address sharing mechanisms that give rise to the issues identified herein.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on August 26, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Shared Addressing Solutions</a>
</li>
<li>3.   <a href="#rfc.section.3">Analysis of Issues as they Relate to First and Third Parties</a>
</li>
<li>4.   <a href="#rfc.section.4">Content Provider Example</a>
</li>
<li>5.   <a href="#rfc.section.5">Port Allocation</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Outgoing Ports</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Incoming Ports</a>
</li>
<li>5.2.1.   <a href="#rfc.section.5.2.1">Port Negotiation</a>
</li>
<li>5.2.1.1.   <a href="#rfc.section.5.2.1.1">Universal Plug and Play (UPnP)</a>
</li>
<li>5.2.1.2.   <a href="#rfc.section.5.2.1.2">NAT Port Mapping Protocol (NAT-PMP)</a>
</li>
<li>5.2.2.   <a href="#rfc.section.5.2.2">Connection to a Well-Known Port Number</a>
</li>
<li>5.2.3.   <a href="#rfc.section.5.2.3">Port Discovery Mechanisms</a>
</li>
<li>6.   <a href="#rfc.section.6">Impact on Applications</a>
</li>
<li>7.   <a href="#rfc.section.7">Geo-location and Geo-proximity</a>
</li>
<li>8.   <a href="#rfc.section.8">Tracking Service Usage</a>
</li>
<li>9.   <a href="#rfc.section.9">ICMP</a>
</li>
<li>10.   <a href="#rfc.section.10">MTU</a>
</li>
<li>11.   <a href="#rfc.section.11">Fragmentation</a>
</li>
<li>12.   <a href="#rfc.section.12">Traceability</a>
</li>
<li>13.   <a href="#rfc.section.13">Security</a>
</li>
<li>13.1.   <a href="#rfc.section.13.1">Abuse Logging and Penalty Boxes</a>
</li>
<li>13.2.   <a href="#rfc.section.13.2">Authentication</a>
</li>
<li>13.3.   <a href="#rfc.section.13.3">SPAM</a>
</li>
<li>13.4.   <a href="#rfc.section.13.4">Port Randomisation</a>
</li>
<li>13.5.   <a href="#rfc.section.13.5">IPsec</a>
</li>
<li>13.6.   <a href="#rfc.section.13.6">Policing Forwarding Behaviour</a>
</li>
<li>14.   <a href="#rfc.section.14">Transport Issues</a>
</li>
<li>14.1.   <a href="#rfc.section.14.1">Parallel connections</a>
</li>
<li>14.2.   <a href="#rfc.section.14.2">Serial connections</a>
</li>
<li>14.3.   <a href="#rfc.section.14.3">TCP Control Block Sharing</a>
</li>
<li>15.   <a href="#rfc.section.15">Reverse DNS</a>
</li>
<li>16.   <a href="#rfc.section.16">Load Balancing</a>
</li>
<li>17.   <a href="#rfc.section.17">IPv6 Transition Issues</a>
</li>
<li>18.   <a href="#rfc.section.18">Introduction of Single Points of Failure</a>
</li>
<li>19.   <a href="#rfc.section.19">State Maintenance Reduces Battery Life</a>
</li>
<li>20.   <a href="#rfc.section.20">Support of Multicast</a>
</li>
<li>21.   <a href="#rfc.section.21">Support of Mobile-IP</a>
</li>
<li>22.   <a href="#rfc.section.22">IANA Considerations</a>
</li>
<li>23.   <a href="#rfc.section.23">Security Considerations</a>
</li>
<li>24.   <a href="#rfc.section.24">Contributors</a>
</li>
<li>25.   <a href="#rfc.section.25">Acknowledgments</a>
</li>
<li>26.   <a href="#rfc.section.26">Annex</a>
</li>
<li>26.1.   <a href="#rfc.section.26.1">Classes of Address Sharing Solution</a>
</li>
<li>26.2.   <a href="#rfc.section.26.2">Address Space Multiplicative Factor</a>
</li>
<li>27.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">Allocations of IPv4 addresses from the Internet Assigned Numbers Authority (IANA) were completed on February 3, 2011 <a href="#IPv4_Pool">[IPv4_Pool]</a>. Allocations from Regional Internet Registries (RIRs) are anticipated to be complete around a year later, although the exact date will vary from registry to registry. This is causing service providers around the world to start to question how they will continue providing IPv4 connectivity service to their subscribers when there are no longer sufficient IPv4 addresses to allocate them one per subscriber. Several possible solutions to this problem are now emerging based around the idea of shared IPv4 addressing. These solutions give rise to a number of issues and this memo identifies those common to all such address sharing approaches and collects them in a single document.</p>
<p id="rfc.section.1.p.2">Deploying IPv6 is the only perennial way to ease pressure on the public IPv4 address pool without the need for address sharing mechanisms that give rise to the issues identified herein. In the short term, maintaining growth of IPv4 services in the presence of IPv4 address depletion will require address sharing. Address sharing will cause issues for end-users, service providers and third parties such as law enforcement agencies and content providers. This memo is intended to highlight and briefly discuss these issues.</p>
<p id="rfc.section.1.p.3">Increased IPv6 deployment should reduce the burden being placed on an address sharing solution, and should reduce the costs of operating that solution. Increasing IPv6 deployment should cause a reduction in the number of concurrent IPv4 sessions per subscriber. If the percentage of end-to-end IPv6 traffic significantly increases, so that the volume of IPv4 traffic begins decreasing, then the number of IPv4 sessions will decrease. The smaller the number of concurrent IPv4 sessions per subscriber, the higher the number of subscribers able to share the same IPv4 public address, and consequently, the lower the number of IPv4 public addresses required. However, this effect will only occur for subscribers who have both an IPv6 access and a shared IPv4 access. This motivates a strategy to systematically bind a shared IPv4 access to an IPv6 access. It is difficult to foresee to what extent growing IPv6 traffic will reduce the number of concurrent IPv4 sessions, but in any event, IPv6 deployment and use should reduce the pressure on the available public IPv4 address pool.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Shared Addressing Solutions</h1>
<p id="rfc.section.2.p.1">In many networks today a subscriber is provided with a single public IPv4 address at their home or small business. For instance, in fixed broadband access, an IPv4 public address is assigned to each CPE (Customer Premises Equipment). CPEs embed a NAT function which is responsible for translating private IPv4 addresses (<a href="#RFC1918">[RFC1918]</a> addresses) assigned to hosts within the local network, to the public IPv4 address assigned by the service provider (and vice versa). Therefore, devices located with the LAN share the single public IPv4 address and they are all associated with a single subscriber account and a single network operator.</p>
<p id="rfc.section.2.p.2">A number of proposals currently under consideration in the IETF rely upon the mechanism of multiplexing multiple subscribers' connections over a smaller number of shared IPv4 addresses. This is a significant change. These proposals include Carrier Grade NAT (CGN. a.k.a., LSN for Large Scale NAT) <a href="#I-D.ietf-behave-lsn-requirements">[I-D.ietf-behave-lsn-requirements]</a>, Dual-Stack Lite <a href="#I-D.ietf-softwire-dual-stack-lite">[I-D.ietf-softwire-dual-stack-lite]</a>, NAT64 <a href="#I-D.ietf-behave-v6v4-xlate-stateful">[I-D.ietf-behave-v6v4-xlate-stateful]</a> <a href="#I-D.ietf-behave-v6v4-xlate">[I-D.ietf-behave-v6v4-xlate]</a>, Address+Port (A+P) proposals <a href="#I-D.ymbk-aplusp">[I-D.ymbk-aplusp]</a>, <a href="#I-D.boucadair-port-range">[I-D.boucadair-port-range]</a> and SAM <a href="#I-D.despres-sam">[I-D.despres-sam]</a>. <a href="#Annex">Section 26</a> provides a classification of these different types of solutions and discusses some of the design considerations to be borne in mind when deploying large-scale address sharing. Whether we're talking about DS-Lite, A+P, NAT64 or CGN isn't especially important - it's the view from the outside that matters, and given that, most of the issues identified below apply regardless of the specific address sharing scenario in question. Issues specific to A+P proposals are addressed in <a href="#I-D.thaler-port-restricted-ip-issues">[I-D.thaler-port-restricted-ip-issues]</a>.</p>
<p id="rfc.section.2.p.3">In these new proposals, a single public IPv4 address would be shared by multiple homes or small businesses (i.e., multiple subscribers) so the operational paradigm described above would no longer apply. In this document we refer to this new paradigm as large-scale address sharing.  All these proposals extend the address space by adding port information, they differ in the way they manage the port value.</p>
<p id="rfc.section.2.p.4">Security issues associated with NAT have long been documented (see <a href="#RFC2663">[RFC2663]</a> and <a href="#RFC2993">[RFC2993]</a> ).  However, sharing IPv4 addresses across multiple subscribers by any means, either moving the NAT functionality from the home gateway to the core of the service provider network, or restricting the port choice in the subscriber's NAT, creates additional issues for subscribers, content providers and network operators. Many of these issues are created today by public Wi-Fi hotspot deployments. As such large-scale address sharing solutions become more widespread in the face of IPv4 address depletion, these issues will become both more severe and more commonly felt. NAT issues in the past typically only applied to a single legal entity; as large-scale address sharing becomes more prevalent these issues will increasingly span across multiple legal entities simultaneously.</p>
<p id="rfc.section.2.p.5">All large-scale address sharing proposals share technical and operational issues and these are addressed in the sections that follow.  These issues are common to any service-provider NAT, enterprise NAT, and also non-NAT solutions that share individual IPv4 addresses across multiple subscribers. This document is intended to bring all of these issues together in one place.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Analysis of Issues as they Relate to First and Third Parties</h1>
<p id="rfc.section.3.p.1">In this section we present an analysis of whether the issues identified in the remainder of this document are applicable to the organization deploying the shared addressing mechanism (and by extension their subscribers) and/or whether these issues impact third parties (e.g., content providers, law enforcement agencies, etc.). In this analysis, issues that affect end-users are deemed to affect 1st parties, as end-users can be expected to complain to their service provider when problems arise. Where issues can expect to be foreseen and addressed by the party deploying the shared addressing solution, they are not attributed.</p>
<p id="rfc.section.3.p.2">In <a href="#Figure1">Figure 1</a> we have also tried to indicate (with 'xx') where issues are newly created in addition to what could be expected from the introduction of a traditional NAT device. Issues marked with a single 'x' are already present today in the case of typical CPE NAT, however they can be expected to be more severe and widespread in the case of large-scale address sharing.</p>
<div id="#rfc.figure.1"></div>
<div id="#Figure1"></div>
<pre>
+------------------------------------------------+--------+---------+
|                   Issue                        |   1st  |   3rd   |
|                                                |  party | parties |
+------------------------------------------------+--------+---------+
| Restricted allocations of outgoing             |    x   |         |
| ports will impact performance for end users    |        |         |
|                                                |        |         |
| Incoming port negotiation mechanisms may fail  |    xx  |         |
|                                                |        |         |
| Incoming connections to Assigned Ports will    |    x   |         |
| not work                                       |        |         |
|                                                |        |         |
| Port discovery mechanisms will not work        |    x   |         |
|                                                |        |         |
| Some applications will fail to operate         |    x   |    x    |
|                                                |        |         |
| Assumptions about parallel/serial connections  |    x   |    x    |
| may fail                                       |        |         |
|                                                |        |         |
+------------------------------------------------+--------+---------+

+------------------------------------------------+--------+---------+
|                   Issue                        |   1st  |   3rd   |
|                                                |  party | parties |
+------------------------------------------------+--------+---------+
| TCP control block sharing will be affected     |    x   |    x    |
|                                                |        |         |
| Reverse DNS will be affected                   |    x   |    x    |
|                                                |        |         |
| Inbound ICMP will fail in many cases           |    x   |    x    |
|                                                |        |         |
| Amplification of security issues               |    xx  |    xx   |
|                                                |        |         |
| Fragmentation will require special handling    |    x   |         |
|                                                |        |         |
| Single points of failure and increased         |    x   |         |
| network instability                            |        |         |
|                                                |        |         |
| Port randomization will be affected            |    x   |         |
|                                                |        |         |
| Service usage monitoring and abuse logging     |    xx  |    xx   |
| will be impacted for all elements in the chain |        |         |
| between service provider and content provider  |        |         |
|                                                |        |         |
| Penalty boxes will no longer work              |    xx  |    xx   |
|                                                |        |         |
| Spam blacklisting will be affected             |    xx  |    xx   |
|                                                |        |         |
| Geo-location services will be impacted         |    xx  |    xx   |
|                                                |        |         |
| Geo-proximity mechanisms will be impacted      |    xx  |    xx   |
|                                                |        |         |
| Load balancing algorithms may be impacted      |        |    xx   |
|                                                |        |         |
| Authentication mechanisms may be impacted      |        |    x    |
|                                                |        |         |
| Traceability of network usage and abusage will |        |    xx   |
| be affected                                    |        |         |
|                                                |        |         |
| IPv6 transition mechanisms will be affected    |    xx  |         |
|                                                |        |         |
| Frequent keep-alives reduce battery life       |    x   |         |
|                                                |        |         |
+------------------------------------------------+--------+---------+					</pre>
<p id="rfc.section.3.p.3">As can be seen from <a href="#Figure1">Figure 1</a>, deployment of large-scale address sharing will create almost as many problems for third parties as it does for the service provider deploying the address sharing mechanism. Several of these issues are specific to the introduction of large-scale address sharing as well. All of these issues are discussed in further detail below.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Content Provider Example</h1>
<p id="rfc.section.4.p.1">Taking a content provider as an example of a third-party, and focusing on the issues that are created specifically by the presence of large-scale address sharing, we identify the following issues as being of particular concern:</p>

<ul>
<li>Degraded geolocation for targeted advertising and licensed content restrictions (see <a href="#Geoloc">Section 7</a>).</li>
<li>Additional latency due to indirect routing and degraded geoproximity (see <a href="#Geoloc">Section 7</a>).</li>
<li>Exposure to new amplification attacks (see <a href="#Security">Section 13</a>).</li>
<li>Service usage monitoring is made more complicated (see <a href="#Usage">Section 8</a>).</li>
<li>Incoming port negotiation mechanisms may fail (see <a href="#PortNegotiation">Section 5.2.1</a>).</li>
<li>IP blocking for abuse/spam will cause collateral damage (see <a href="#Security">Section 13</a>).</li>
<li>Load balancing algorithms may be impacted (see <a href="#LoadBalancing">Section 16</a>).</li>
<li>Traceability of network usage and abuse will be impacted (see <a href="#Traceability">Section 12</a>).</li>
</ul>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Port Allocation</h1>
<p id="rfc.section.5.p.1">When we talk about port numbers we need to make a distinction between outgoing connections and incoming connections. For outgoing connections, the actual source port number used is usually irrelevant. (While this is true today, in a port-range solution it is necessary for the source port to be within the allocated range). But for incoming connections, the specific port numbers allocated to subscribers matter because they are part of external referrals (used by third parties to contact services run by the subscribers).</p>
<p id="rfc.section.5.p.2">The total number of subscribers able to share a single IPv4 address will depend upon assumptions about the average number of ports required per active subscriber, and the average number of simultaneously active subscribers. It is important to realize that the TCP design makes it undesirable for clients to re-use ports while they remain in the TIME-WAIT state (typically 4 minutes after the connection has concluded). TIME-WAIT state removes the hazard of old duplicates for "fast" or "long" connections, in which clock-driven Initial Sequence Number selection is unable to prevent overlap of the old and new sequence spaces. The TIME-WAIT delay allows all old duplicate segments time enough to die in the Internet before the connection is reopened <a href="#RFC1337">[RFC1337]</a>. Therefore ports in this state must be included in calculations concerning port usage per subscriber.</p>
<p id="rfc.section.5.p.3">Most of the time the source port selected by a client application will be translated (unless there is direct knowledge of a port-range restriction in the client's stack), either by a NAT in the subscriber's device, or by a CPE NAT, or by a CPE NAT and a CGN.</p>
<p><a href="#RFC1700">[RFC1700]</a> defines the Assigned Ports (both System and User). IANA has further classified the whole port space into three categories, as defined in <a href="#IANA_Ports">[IANA_Ports]</a> </p>

<ul>
<li>The Well-Known Ports are those from 0 through 1023.</li>
<li>The Registered Ports are those from 1024 through 49151.</li>
<li>The Dynamic and/or Private Ports are those from 49152 through 65535.</li>
</ul>
<p><a href="#RFC4787">[RFC4787]</a> notes that current NATs have different policies with regard to this classification; some NATs restrict their translations to the use of dynamic ports, some also include registered ports, some preserve the port if it is in the well-known range. <a href="#RFC4787">[RFC4787]</a> makes it clear that the use of port space (1024-65535) is safe: "mapping a source port to a source port that is already registered is unlikely to have any bad effects". Therefore, for all address sharing solutions, there is no reason to only consider a subset of the port space (1024-65535) for outgoing source ports.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#OutgoingPorts" id="OutgoingPorts">Outgoing Ports</a>
</h1>
<p id="rfc.section.5.1.p.1">According to measurements the average number of outgoing ports consumed per active subscriber is much, much smaller than the maximum number of ports a subscriber can use at any given time. However, the distribution is heavy-tailed, so there are typically a small number of subscribers who use a very high number of ports <a href="#CGN_Viability">[CGN_Viability]</a>. This means that an algorithm that dynamically allocates outgoing port numbers from a central pool will typically allow more subscribers to share a single IPv4 address than algorithms that statically divide the resource by pre-allocating a fixed number of ports to each subscriber. Similarly, such an algorithm should be more able to accommodate subscribers wishing to use a relatively high number of ports.</p>
<p id="rfc.section.5.1.p.2">It is important to note here that the desire to dynamically allocate outgoing port numbers will make a service provider's job of maintaining records of subscriber port number allocations considerably more onerous (see <a href="#Traceability">Section 12</a>). The number of records per subscriber will increase from 1 in a scheme where ports are statically allocated, to a much larger number equivalent to the total number of outgoing ports consumed by that subscriber during the time period for which detailed logs must be kept.</p>
<p id="rfc.section.5.1.p.3">A potential problem with dynamic allocation occurs when one of the subscriber devices behind such a port-shared IPv4 address becomes infected with a worm, which then quickly sets about opening many outbound connections in order to propagate itself. Such an infection could rapidly exhaust the shared resource of the single IPv4 address for all connected subscribers. It is therefore necessary to impose limits on the total number of ports available to an individual subscriber to ensure that the shared resource (the IPv4 address) remains available in some capacity to all the subscribers using it.  However, static schemes for ports assignment may introduce security issues <a href="#RFC6056">[RFC6056]</a> when small contiguous port ranges are statically assigned to subscribers. Another way to mitigate this issue is to kill off (randomly) established connections when the port space runs out. A user with many connections will be proportionally more likely to get impacted.</p>
<p id="rfc.section.5.1.p.4">Session failure due to NAT state overflow or timeout (when the NAT discards session state because it's run out of resource) can be experienced when the configured quota per user is reached or if the NAT is out of recourses.</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#IncomingPorts" id="IncomingPorts">Incoming Ports</a>
</h1>
<p id="rfc.section.5.2.p.1">It is desirable to ensure that incoming ports remain stable over time. This is challenging as the network doesn't know anything in particular about the applications that it is supporting and therefore has no real notion of how long an application/service session is still ongoing and therefore requiring port stability.</p>
<p id="rfc.section.5.2.p.2">Early measurements <a href="#CGN_Viability">[CGN_Viability]</a> also seem to indicate that, on average, only very few ports are used by subscribers for incoming connections. However, a majority of subscribers accept at least one inbound connection.</p>
<p id="rfc.section.5.2.p.3">This means that it is not necessary to pre-allocate a large number of incoming ports to each subscriber. It is possible to either pre-allocate a small number of ports for incoming connections or do port allocation on demand when the application wishing to receive a connection is initiated. The bulk of incoming ports can be reserved as a centralized resource shared by all subscribers using a given public IPv4 address.</p>
<h1 id="rfc.section.5.2.1">
<a href="#rfc.section.5.2.1">5.2.1.</a> <a href="#PortNegotiation" id="PortNegotiation">Port Negotiation</a>
</h1>
<p id="rfc.section.5.2.1.p.1">In current deployments, one important and widely used feature of many CPE devices is the ability to open incoming ports (port forwarding) either manually, or with a protocol such as Universal Plug and Play Internet Gateway Device (UPnP IGD) <a href="#UPnP-IGD">[UPnP-IGD]</a>. If a CGN is present, the port must also be opened in the CGN. CGN makes subscribers dependent on their service provider for this functionality.</p>
<p id="rfc.section.5.2.1.p.2">If the CPE and the CGN are required to co-operate in order for port forwarding functionality to work, protocol development will be required to provide an automated solution. If the CGN architecture is composed of only one NAT level (no NAT in the CPE) as for DS-Lite, the service provider will still be required to offer some means for configuring incoming ports by their subscribers. This may be either via a PCP <a href="#I-D.ietf-pcp-base">[I-D.ietf-pcp-base]</a>, UPnP or NAT-PMP proxy over a tunneled direct connection between the CPE and CGN, or a web interface to configure the incoming port mapping on the CGN. Note, that such an interface effectively makes public what was previously a private management interface and this raises security concerns that must be addressed.</p>
<p id="rfc.section.5.2.1.p.3">For port-range solutions, port forwarding capabilities may still be present at the CPE, with the limitation that the open incoming port must be within the allocated port-range (for instance it is not possible to open port 5002 for incoming connections if port 5002 is not within the allocated port-range).</p>
<h1 id="rfc.section.5.2.1.1">
<a href="#rfc.section.5.2.1.1">5.2.1.1.</a> Universal Plug and Play (UPnP)</h1>
<p id="rfc.section.5.2.1.1.p.1">Using the UPnP semantic, an application asks "I want to use port number X, is that OK?" and the answer is yes or no. If the answer is no, the application will typically try the next port in sequence, until it either finds one that works or gives up after a limited number of attempts. UPnP IGD 1.0 has no way to redirect the application to use another port number. UPnP IGD 2.0 improves this situation and allows for allocation of any available port.</p>
<h1 id="rfc.section.5.2.1.2">
<a href="#rfc.section.5.2.1.2">5.2.1.2.</a> NAT Port Mapping Protocol (NAT-PMP)</h1>
<p id="rfc.section.5.2.1.2.p.1">NAT-PMP enables the NAT to redirect the requesting application to a port deemed to be available for use by the NAT state mapping table.</p>
<h1 id="rfc.section.5.2.2">
<a href="#rfc.section.5.2.2">5.2.2.</a> <a href="#WKP" id="WKP">Connection to a Well-Known Port Number</a>
</h1>
<p id="rfc.section.5.2.2.p.1">Once an IPv4 address sharing mechanism is in place, inbound connections to well-known port numbers will not work in the general case. Any application that is not port-agile cannot be expected to work. Some workaround (e.g., redirects to a port-specific URI) could be deployed given sufficient incentives. There exist several proposals for 'application service location' protocols which would provide a means of addressing this problem, but historically these proposals have not gained much deployment traction.</p>
<p id="rfc.section.5.2.2.p.2">For example, the use of DNS SRV records <a href="#RFC2782">[RFC2782]</a> provides a potential solution for subscribers wishing to host services in the presence of a shared-addressing scheme. SRV records make it possible to specify a port value related to a service, thereby making services accessible on ports other than the Well-Known ports. It is worth noting that this mechanism is not applicable to HTTP and many other protocols.</p>
<h1 id="rfc.section.5.2.3">
<a href="#rfc.section.5.2.3">5.2.3.</a> Port Discovery Mechanisms</h1>
<p id="rfc.section.5.2.3.p.1">Port discovery using a UDP port to discover a service available on a corresponding TCP port, either through broadcast, multicast or unicast, is a commonly deployed mechanism. Unsolicited inbound UDP will be dropped by address sharing mechanisms as they have no live mapping to enable them to forward the packet to the appropriate host. Address sharing thereby breaks this service discovery technique.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Impact on Applications</h1>
<p id="rfc.section.6.p.1">Address sharing solutions will have an impact on the following types of applications: </p>

<ul>
<li>Applications that establish inbound communications - these applications will have to ensure that ports selected for inbound communications are either within the allocated range (for port-range solutions) or are forwarded appropriately by the CGN (for CGN-based solutions). See <a href="#IncomingPorts">Section 5.2</a> for more discussion of this;</li>
<li>Applications that carry address and/or port information in their payload - where translation of port and/or address information is performed at the IP and transport layers by the address sharing solution, an ALG will also be required to ensure application layer data is appropriately modified. Note that ALGs are required in some cases, and in many other cases end-to-end protocol mechanisms have developed to work around a lack of ALGs in address translators, to the point of it being preferable to avoid any support in the NAT;</li>
<li>Applications that use fixed ports - see <a href="#WKP">Section 5.2.2</a> for more discussion of this;</li>
<li>Applications that do not use any port (e.g., ICMP echo) - will require special handling - see <a href="#ICMP">Section 9</a> for more discussion of this;</li>
<li>Applications that assume the uniqueness of source addresses (e.g., IP address as identifier) - such applications will fail to operate correctly in the presence of multiple, discrete, simultaneous connections from the same source IP address;</li>
<li>Applications that explicitly prohibit concurrent connections from the same address - such applications will fail when multiple subscribers sharing an IP address attempt to use them simultaneously.</li>
<li>Applications that do not use TCP or UDP for transport - All IP address sharing mechanisms proposed to date are limited to TCP, UDP, and ICMP, thereby preventing end users from fully utilizing the Internet (e.g., SCTP, DCCP, RSVP, protocol 41 (IPv6-over-IPv4), protocol 50 (IPsec ESP)).</li>
</ul>
<p id="rfc.section.6.p.2">Applications already frequently implement mechanisms in order to circumvent the presence of NATs (typically CPE NATs): </p>

<ul>
<li>Application Layer Gateways (ALGs): Many CPE devices today embed ALGs that allow applications to behave correctly despite the presence of NAT on the CPE. When the NAT belongs to the subscriber, the subscriber has flexibility to tailor the device to his or her needs. For CGNs, subscribers will be dependent on the set of ALGs that their service provider makes available. For port-range solutions, ALGs will require modification to deal with the port-range restriction, but will otherwise have the same capabilities as today. Note that ALGs are required in some cases, and in many other cases end-to-end protocol mechanisms have developed to work around lack of ALGs, to the point of it being preferable to avoid any support in the NAT.</li>
<li>NAT Traversal Techniques: There are several commonly-deployed mechanisms that support operating servers behind a NAT by forwarding specific TCP or UDP ports to specific internal hosts (<a href="#UPnP-IGD">[UPnP-IGD]</a>, <a href="#I-D.cheshire-nat-pmp">[I-D.cheshire-nat-pmp]</a>, and manual configuration).  All of these mechanisms assume the NAT's WAN address is a publicly-routable IP address, and fail to work normally when that assumption is wrong. There have been attempts to avoid that problem by automatically disabling the NAT function and bridging traffic instead upon assignment of a private IP address to the WAN interface (as is required for <a href="#Windows-Logo">[Windows-Logo]</a> certification). Bridging (rather than NATting) has other side effects (DHCP requests are served by an upstream DHCP server which can increase complexity of in-home networking).</li>
</ul>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#Geoloc" id="Geoloc">Geo-location and Geo-proximity</a>
</h1>
<p id="rfc.section.7.p.1">IP addresses are frequently used to indicate, with some level of granularity and some level of confidence, where a host is physically located. Using IP addresses in this fashion is a heuristic at best, and is already challenged today by other deployed capabilities, e.g., tunnels. Geo-location services are used by content providers to allow them to conform with regional content licensing restrictions, to target advertising at specific geographic areas, or to provide customized content. Geo-location services are also necessary for emergency services provision. In some deployment contexts (e.g., centralized CGN), shared addressing will reduce the level of confidence and level of location granularity that IP-based geo-location services can provide. Viewed from the content provider, a subscriber behind a CGN geolocates to wherever the prefix of the CGN appears to be; very often that will be in a different city than the subscriber. </p>
<p id="rfc.section.7.p.2">IP addresses are also used as input to geolocation services that resolve an IP address to a physical location using information from the network infrastructure. Current systems rely on resources such as RADIUS databases and DHCP lease tables. The use of address sharing will prevent these systems from resolving the location of a host based on IP address alone. It will be necessary for users of such systems to provide more information (e.g., TCP or UDP port numbers), and for the systems to use this information to query additional network resources (e.g., NAT-PT binding tables). Since these new data elements tend to be more ephemeral than those currently used for geolocation, their use by geolocation systems may require them to be cached for some period of time.</p>
<p id="rfc.section.7.p.3">Other forms of geo-location will still work as usual.</p>
<p id="rfc.section.7.p.4">A slightly different use of an IP address is to calculate the proximity of a connecting host to a particular service delivery point.  This use of IP address information impacts the efficient delivery of content to an end-user. If a CGN is introduced in communications and it is far from an end-user connected to it, application performance may be degraded insofar as IP-based geo-proximity is a factor.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#Usage" id="Usage">Tracking Service Usage</a>
</h1>
<p id="rfc.section.8.p.1">As large-scale address sharing becomes more commonplace, monitoring the number of unique users of a service will become more complex than simply counting the number of connections from unique IP addresses.  While this is a somewhat inexact methodology today due to the widespread use of CPE NAT, it will become a much less useful approach in the presence of widespread large-scale address sharing solutions. In general, all elements that monitor usage or abusage in the chain between a service provider that has deployed address sharing and a content provider will need to be upgraded to take account of the port value in addition to IP addresses.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#ICMP" id="ICMP">ICMP</a>
</h1>
<p id="rfc.section.9.p.1">ICMP does not include a port field and is consequently problematic for address sharing mechanisms. Some ICMP message types include a fragment of the datagram that triggered the signal to be sent, which is assumed to include port numbers. For some ICMP message types, the Identifier field has to be used as a de-multiplexing token. Sourcing ICMP echo messages from hosts behind an address sharing solution does not pose problems, although responses to outgoing ICMP echo messages will require special handling, such as making use of the ICMP identifier value to route the response appropriately.</p>
<p id="rfc.section.9.p.2">For inbound ICMP there are two cases. The first case is that of ICMP sourced from outside the network of the address sharing solution provider. Where ICMP messages include a fragment of an outgoing packet including port numbers it may be possible to forward the packet appropriately. In addition to these network signaling messages, several applications (e.g., P2P applications) make use of ICMP echo messages which include no hints that could be used to route the packet correctly.  Measurements derived by such applications in the presence of an address sharing solution will be erroneous or fail altogether. The second case is that of ICMP sourced from within the network of the address sharing solution provider (e.g., for network management, signaling and diagnostic purposes). In this case ICMP can be routed normally for CGN-based solutions owing to the presence of locally unique private IP addresses for each CPE device. For port-range solutions, ICMP echo messages will not be routable without special handling, e.g., placing a port number in the ICMP identifier field, and having port-range routers make routing decisions based upon that field.</p>
<p id="rfc.section.9.p.3">Considerations related to ICMP message handling in NAT-based environments are specified in <a href="#RFC5508">[RFC5508]</a>.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#MTU" id="MTU">MTU</a>
</h1>
<p id="rfc.section.10.p.1">In applications where the end hosts are attempting to use path MTU Discovery <a href="#RFC1191">[RFC1191]</a> to optimize transmitted packet size with underlying network MTU, shared addressing has a number of items which must be considered. As covered in <a href="#ICMP">Section 9</a>, ICMP "Packet Too Big" messages must be properly translated through the address sharing solution in both directions.  However, even when this is done correctly, MTU can be a concern. Many end hosts cache PMTUd information for a certain period of time. If the MTU behind the address sharing solution is inconsistent, the public end host may have the incorrect MTU value cached. This may cause it to send packets that are too large, causing them to be dropped if the DF (Don't Fragment) bit is set, or causing them to be fragmented by the network, increasing load and overhead. Because the host eventually will reduce MTU to the lowest common value for all hosts behind a given public address, it may also send packets that are below optimal size for the specific connection, increasing overhead and reducing throughput.</p>
<p id="rfc.section.10.p.2">This issue also generates a potential attack vector, that a malevolent user could send an ICMP "Packet Too Big" (Type 3, Code 4) message indicating a Next-Hop MTU of anything down to 68 octets. This value will be cached by the off-net server for all subscribers sharing the address of the malevolent user. This could lead to a DoS against both the remote server and the large-scale NAT device itself (as they will both have to handle many more packets per second).</p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> Fragmentation</h1>
<p id="rfc.section.11.p.1">When a packet is fragmented, transport-layer port information (either UDP or TCP) is only present in the first fragment. Subsequent fragments will not carry the port information and so will require special handling. In addition, the IP Identifier may no longer be unique as required by the receiver to aid in assembling the fragments of a datagram.</p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#Traceability" id="Traceability">Traceability</a>
</h1>
<p id="rfc.section.12.p.1">In many jurisdictions, service providers are legally obliged to provide the identity of a subscriber upon request to the appropriate authorities. Such legal requests have traditionally included the source IPv4 address and date (and usually the time), which is sufficient information when subscribers are assigned IPv4 addresses for a long duration.</p>
<p id="rfc.section.12.p.2">However, where one public IPv4 address is shared between several subscribers, the IPv4 address no longer uniquely identifies a subscriber. There are two solutions to this problem: </p>

<ul>
<li>The first solution is for servers to additionally log the source port of incoming connections and for the legal request to include the source port. The legal request should include the information: [Source IP address, Source Port, Timestamp] (and possibly other information). Accurate time-keeping (e.g., use of NTP or SNTP) is vital because port assignments are dynamic. A densely populated CGN could mean even very small amounts of clock skew between a third party's server and the CGN operator will result in ambiguity about which customer was using a specific port at a given time.</li>
<li>The second solution considers it is unrealistic to expect all servers to log the source port number of incoming connections. To deal with this, service providers using IPv4 address sharing may need to log IP destination addresses.</li>
</ul>
<p id="rfc.section.12.p.3">Destination logging is imperfect if multiple subscribers are accessing the same (popular) server at nearly the same time, it can be impossible to disambiguate which subscriber accessed the server, especially with protocols that involve several connections (e.g., HTTP).  Thus, logging the destination address on the NAT is inferior to logging the source port at the server.</p>
<p id="rfc.section.12.p.4">If neither solution is used (that is, the server is not logging source port numbers and the NAT is not logging destination IP addresses), the service provider cannot trace a particular activity to a specific subscriber. In this circumstance, the service provider would need to disclose the identity of all subscribers who had active sessions on the NAT during the time period in question. This may be a large number of subscribers.</p>
<p id="rfc.section.12.p.5">Address sharing solutions must record and store all mappings (typically during 6-12 months, depending on the local jurisdiction) that they create. If we consider one mapping per session, a service provider should record and retain traces of all sessions created by all subscribers during one year (if the legal storage duration is one year).  This may be challenging due to the volume of data requiring storage, the volume of data to repeatedly transfer to the storage location, and the volume of data to search in response to a query.</p>
<p id="rfc.section.12.p.6">Address sharing solutions may mitigate these issues to some extent by pre-allocating groups of ports. Then only the allocation of the group needs to be recorded, and not the creation of every session binding within that group. There are trade-offs to be made between the sizes of these port groups, the ratio of public addresses to subscribers, whether or not these groups timeout, the impact on logging requirements and port randomization security <a href="#RFC6056">[RFC6056]</a>.</p>
<h1 id="rfc.section.13">
<a href="#rfc.section.13">13.</a> <a href="#Security" id="Security">Security</a>
</h1>
<p id="rfc.section.13.p.1">Before noting some specific security-related issues caused by large-scale address sharing, it is perhaps worth noting that, in general, address sharing creates a vector for attack amplification in numerous ways. See <a href="#MTU">Section 10</a> for one example.</p>
<h1 id="rfc.section.13.1">
<a href="#rfc.section.13.1">13.1.</a> Abuse Logging and Penalty Boxes</h1>
<p id="rfc.section.13.1.p.1">When an abuse is reported today, it is usually done in the form: IPv4 address X has done something bad at time T0. This is not enough information to uniquely identify the subscriber responsible for the abuse when that IPv4 address is shared by more than one subscriber.  Law enforcement authorities may be particularly impacted because of this. This particular issue can be fixed by logging port numbers, although this will increase logging data storage requirements.</p>
<p id="rfc.section.13.1.p.2">A number of services on the network today log the IPv4 source addresses used in connection attempts to protect themselves from certain attacks. For example, if a server sees too many requests from the same IPv4 address in a short period of time, it may decide to put that address in a penalty box for a certain time during which requests are denied, or it may require completion of a CAPTCHA for future requests. If an IPv4 address is shared by multiple subscribers, this would have unintended consequences in a couple of ways. First it may become the natural behavior to see many login attempts from the same address because it is now shared across a potentially large number of subscribers. Second and more likely is that one user who fails a number of login attempts may block out other users who have not made any previous attempts but who will now fail on their first attempt. In the presence of widespread large-scale address sharing, penalty box solutions to service abuse simply will not work.</p>
<p id="rfc.section.13.1.p.3">In addition, there are web tie-ins into different blacklists that web administrators subscribe to redirect users with infected machines (e.g., detect the presence of a worm) to a URL that says "Hey, your machine is infected!". With address sharing, someone else's worm can interfere with the ability to access the service for other subscribers sharing the same IP address.</p>
<h1 id="rfc.section.13.2">
<a href="#rfc.section.13.2">13.2.</a> Authentication</h1>
<p id="rfc.section.13.2.p.1">Simple address-based identification mechanisms that are used to populate access control lists will fail when an IP address is no longer sufficient to identify a particular subscriber. Including port numbers in access control list definitions may be possible at the cost of extra complexity, and may also require the service provider to make static port assignments, which conflicts with the requirement for dynamic assignments discussed in <a href="#OutgoingPorts">Section 5.1</a>.</p>
<p id="rfc.section.13.2.p.2">Address or DNS-name based signatures (e.g., some X.509 signatures) may also be affected by address sharing as the address itself is now a shared token, and the name to address mapping may not be current.</p>
<h1 id="rfc.section.13.3">
<a href="#rfc.section.13.3">13.3.</a> SPAM</h1>
<p id="rfc.section.13.3.p.1">Another case of identifying abusers has to do with SPAM blacklisting. When a spammer is behind a CGN or using a port-shared address, blacklisting of their IP address will result in all other subscribers sharing that address having their ability to source SMTP packets restricted to some extent.</p>
<h1 id="rfc.section.13.4">
<a href="#rfc.section.13.4">13.4.</a> <a href="#random" id="random">Port Randomisation</a>
</h1>
<p id="rfc.section.13.4.p.1">A blind attack that can be performed against TCP relies on the attacker's ability to guess the 5-tuple (Protocol, Source Address, Destination Address, Source Port, Destination Port) that identifies the transport protocol instance to be attacked. <a href="#RFC6056">[RFC6056]</a> describes a number of methods for the random selection of the source port number, such that the ability of an attacker to correctly guess the 5-tuple is reduced. With shared IPv4 addresses, the port selection space is reduced. Preserving port randomization is important and may be more or less difficult depending on the address sharing solution and the size of the port space that is being manipulated. Allocation of non-contiguous port ranges could help to mitigate this issue.</p>
<p id="rfc.section.13.4.p.2">It should be noted that guessing the port information may not be sufficient to carry out a successful blind attack. An in-window TCP Sequence Number (SN) should also be known or guessed. A TCP segment is processed only if all previous segments have been received, except for some Reset segment implementations which immediately process the Reset as long as it is within the Window. If SN is randomly chosen it will be difficult to guess it (SN is 32 bits long); port randomization is one protection among others against blind attacks. There is more detailed discussion of improving TCP's robustness to Blind In-Window Attacks in <a href="#RFC5961">[RFC5961]</a>.</p>
<h1 id="rfc.section.13.5">
<a href="#rfc.section.13.5">13.5.</a> IPsec</h1>
<p id="rfc.section.13.5.p.1">The impact of large-scale IP address sharing for IPsec operation should be evaluated and assessed. <a href="#RFC3947">[RFC3947]</a> proposes a solution to solve issues documented in <a href="#RFC3715">[RFC3715]</a>. <a href="#RFC5996">[RFC5996]</a> specifies Internet Key Exchange (IKE) Protocol Version 2 which includes NAT traversal mechanisms that are now widely used to enable IPsec to work in the presence of NATs in many cases. Nevertheless, service providers may wish to ensure that CGN deployments do not inadvertently block NAT traversal for security protocols such as IKE (refer to <a href="#I-D.gont-behave-nat-security">[I-D.gont-behave-nat-security]</a> for more information).</p>
<h1 id="rfc.section.13.6">
<a href="#rfc.section.13.6">13.6.</a> Policing Forwarding Behaviour</h1>
<p><a href="#RFC2827">[RFC2827]</a> motivates and discusses a simple, effective, and straightforward method for using ingress traffic filtering to prohibit Denial-of-Service (DoS) attacks which use forged IP addresses. Following this recommendation, service providers operating shared-addressing mechanisms should ensure that source addresses, or source ports in the case of port-range schemes, are set correctly in outgoing packets from their subscribers or they should drop the packets.</p>
<p id="rfc.section.13.6.p.2">If some form of IPv6 ingress filtering is deployed in the broadband network and DS-Lite service is restricted to those subscribers, then tunnels terminating at the CGN and coming from registered subscriber IPv6 addresses cannot be spoofed. Thus a simple access control list on the tunnel transport source address is all that is required to accept traffic on the internal interface of a CGN.</p>
<h1 id="rfc.section.14">
<a href="#rfc.section.14">14.</a> Transport Issues</h1>
<h1 id="rfc.section.14.1">
<a href="#rfc.section.14.1">14.1.</a> Parallel connections</h1>
<p id="rfc.section.14.1.p.1">Systems that assume that multiple simultaneous connections to a single IP address implies connectivity to a single host - such systems may experience unexpected results.</p>
<h1 id="rfc.section.14.2">
<a href="#rfc.section.14.2">14.2.</a> Serial connections</h1>
<p id="rfc.section.14.2.p.1">Systems that assume that returning to a given IP address means returning to the same physical host, as with stateful transactions.  This may also affect cookie-based systems.</p>
<h1 id="rfc.section.14.3">
<a href="#rfc.section.14.3">14.3.</a> TCP Control Block Sharing</h1>
<p><a href="#RFC2140">[RFC2140]</a> defines a performance optimization for TCP based on sharing state between TCP control blocks that pertain to connections to the same host, as opposed to maintaining state for each discrete connection. This optimization assumes that an address says something about the properties of the path between two hosts, which is clearly not the case if the address in question is shared by multiple hosts at different physical network locations. While CPE NAT today causes problems for sharing TCP control block state across multiple connections to a given IP address, large-scale address sharing will make these issues more severe and more widespread.</p>
<h1 id="rfc.section.15">
<a href="#rfc.section.15">15.</a> Reverse DNS</h1>
<p id="rfc.section.15.p.1">Many service providers populate forward and reverse DNS zones for the public IPv4 addresses that they allocate to their subscribers. In the case where public addresses are shared across multiple subscribers, such strings are, by definition, no longer sufficient to identify an individual subscriber without additional information.</p>
<h1 id="rfc.section.16">
<a href="#rfc.section.16">16.</a> <a href="#LoadBalancing" id="LoadBalancing">Load Balancing</a>
</h1>
<p id="rfc.section.16.p.1">Algorithms used to balance traffic load for popular destinations may be affected by the introduction of address sharing. Where balancing is achieved by deterministically routing traffic from specific source IP addresses to specific servers, imbalances in load may be experienced as address sharing is enabled for some of those source IP addresses. This will require re-evaluation of the algorithms used in the load-balancing design. In general, as the scale of address sharing grows, load-balancing designs will need to be re-evaluated and any assumptions about average load per source IP address revisited.</p>
<h1 id="rfc.section.17">
<a href="#rfc.section.17">17.</a> IPv6 Transition Issues</h1>
<p id="rfc.section.17.p.1">IPv4 address sharing solutions may interfere with existing IPv4 to IPv6 transition mechanisms, which were not designed with IPv4 shortage considerations in mind. With port-range solutions for instance, incoming 6to4 packets should be able to find their way from a 6to4 relay to the appropriate 6to4 CPE router, despite the lack of direct port range information (UDP/TCP initial source port did not pass through the CPE port range translation process). One solution would be for a 6to4 IPv6 address to embed not only an IPv4 address but also a port range value.</p>
<p id="rfc.section.17.p.2">Subscribers allocated with private addresses will not be able to utilize 6to4 <a href="#RFC3056">[RFC3056]</a> to access IPv6, but may be able to utilize Teredo <a href="#RFC4380">[RFC4380]</a>.</p>
<p id="rfc.section.17.p.3">Some routers enable 6to4 on their WAN link. 6to4 requires a publicly-routable IPv4 address. Enabling 6to4 when the apparently public IPv4 WAN address is in fact behind a NAT creates a disconnected IPv6 island. Issues created by assigning the same public address space across multiple hosts are specifically addressed in <a href="#I-D.thaler-port-restricted-ip-issues">[I-D.thaler-port-restricted-ip-issues]</a>.</p>
<h1 id="rfc.section.18">
<a href="#rfc.section.18">18.</a> Introduction of Single Points of Failure</h1>
<p id="rfc.section.18.p.1">In common with all deployments of new network functionality, the introduction of new nodes or functions to handle the multiplexing of multiple subscribers across shared IPv4 addresses could create single points of failure in the network. Any IP address sharing solution should consider the opportunity to add redundancy features in order to alleviate the impact on the robustness of the offered IP connectivity service. The ability of the solution to allow hot swapping from one machine to another should be considered. This is especially important where the address sharing solution in question requires the creation of per-flow state in the network.</p>
<h1 id="rfc.section.19">
<a href="#rfc.section.19">19.</a> State Maintenance Reduces Battery Life</h1>
<p id="rfc.section.19.p.1">In order for hosts to maintain network state in the presence of NAT, keep-alive messages have to be sent at frequent intervals. For battery-powered devices, sending these keep-alive messages can result in significantly reduced battery performance than would otherwise be the case <a href="#Mobile_Energy_Consumption">[Mobile_Energy_Consumption]</a>.</p>
<h1 id="rfc.section.20">
<a href="#rfc.section.20">20.</a> Support of Multicast</h1>
<p><a href="#RFC5135">[RFC5135]</a> specifies requirements for a NAT that supports Any Source IP Multicast or Source-Specific IP Multicast.  Port-range routers that form part of port-range solutions will need to support similar requirements if multicast support is required.</p>
<h1 id="rfc.section.21">
<a href="#rfc.section.21">21.</a> Support of Mobile-IP</h1>
<p id="rfc.section.21.p.1">IP address sharing within the context of Mobile-IP deployments (in the home network and/or in the visited network), will require Home Agents and/or Foreign Agents to be updated so as to take into account the relevant port information. There may also be issues raised when an additional layer of encapsulation is required thereby causing, or increasing the need for, fragmentation and reassembly.</p>
<p id="rfc.section.21.p.2">Issues for Mobile-IP in the presence of NAT are discussed in <a href="#I-D.haddad-mext-nat64-mobility-harmful">[I-D.haddad-mext-nat64-mobility-harmful]</a></p>
<h1 id="rfc.section.22">
<a href="#rfc.section.22">22.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.22.p.1">This memo includes no request to IANA.</p>
<h1 id="rfc.section.23">
<a href="#rfc.section.23">23.</a> Security Considerations</h1>
<p id="rfc.section.23.p.1">This memo does not define any protocol and therefore creates no new security issues. <a href="#Security">Section 13</a> discusses some of the security and identity-related implications of IP address sharing.</p>
<h1 id="rfc.section.24">
<a href="#rfc.section.24">24.</a> Contributors</h1>
<p id="rfc.section.24.p.1">This document is based on sources co-authored by J.L. Grimault and A.  Villefranque of France Telecom.</p>
<h1 id="rfc.section.25">
<a href="#rfc.section.25">25.</a> <a href="#Acknowledgments" id="Acknowledgments">Acknowledgments</a>
</h1>
<p id="rfc.section.25.p.1">This memo was partly inspired by conversations that took place as part of Internet Society (ISOC) hosted roundtable events for operators and content providers deploying IPv6. Participants in those discussions included John Brzozowski, Leslie Daigle, Tom Klieber, Yiu Lee, Kurtis Lindqvist, Wes George, Lorenzo Colliti, Erik Kline, Igor Gashinsky, Jason Fesler, Rick Reed, Adam Bechtel, Larry Campbell, Tom Coffeen, David Temkin, Pete Gelbman, Mark Winter, Will Charnock, Martin Levy, Greg Wood and Christian Jacquenet.</p>
<p id="rfc.section.25.p.2">The authors are also grateful to Christian Jacquenet, Iain Calder, Joel Halpern, Brian Carpenter, Gregory Lebovitz, Bob Briscoe, Marcelo Bagnulo, Dan Wing and Wes George for their helpful comments and suggestions for improving the document.</p>
<p id="rfc.section.25.p.3">This memo was created using the xml2rfc tool.</p>
<h1 id="rfc.section.26">
<a href="#rfc.section.26">26.</a> <a href="#Annex" id="Annex">Annex</a>
</h1>
<h1 id="rfc.section.26.1">
<a href="#rfc.section.26.1">26.1.</a> Classes of Address Sharing Solution</h1>
<p id="rfc.section.26.1.p.1">IP address sharing solutions fall into two classes. Either a service-provider operated NAT function is introduced and subscribers are allocated addresses from <a href="#RFC1918">[RFC1918]</a> space, or public IPv4 addresses are shared across multiple subscribers by restricting the range of ports available to each subscriber. These classes of solution are described in a bit more detail below. </p>

<ul>
<li>CGN-based solutions: These solutions propose the introduction of a NAPT function in the service provider's network, denoted also as Carrier Grade NAT (CGN), or Large Scale NAT (LSN) <a href="#I-D.ietf-behave-lsn-requirements">[I-D.ietf-behave-lsn-requirements]</a>, or Provider NAT. The CGN is responsible for translating private addresses to publicly routable addresses. Private addresses are assigned to subscribers, a pool of public addresses is assigned to the CGN, and the number of public addresses is smaller than the number of subscribers. A public IPv4 address in the CGN pool is shared by several subscribers at the same time. Solutions making use of a service provider-based NAT include <a href="#I-D.shirasaki-nat444">[I-D.shirasaki-nat444]</a> (two layers of NAT) and <a href="#I-D.ietf-softwire-dual-stack-lite">[I-D.ietf-softwire-dual-stack-lite]</a> (a single layer of NAT).</li>
<li>Port-range solutions: These solutions avoid the presence of a CGN function. A single public IPv4 address is assigned to several subscribers at the same time. A restricted port range is also assigned to each subscriber so that two subscribers with the same IPv4 address have two different port ranges that do not overlap.  These solutions are called A+P (Address+Port) <a href="#I-D.ymbk-aplusp">[I-D.ymbk-aplusp]</a>, or Port Range <a href="#I-D.boucadair-port-range">[I-D.boucadair-port-range]</a>, or SAM (Stateless Address Mapping) <a href="#I-D.despres-sam">[I-D.despres-sam]</a>.</li>
</ul>
<h1 id="rfc.section.26.2">
<a href="#rfc.section.26.2">26.2.</a> <a href="#asmf" id="asmf">Address Space Multiplicative Factor</a>
</h1>
<p id="rfc.section.26.2.p.1">The purpose of sharing public IPv4 addresses is to increase the addressing space. A key parameter is the factor by which service providers want or need to multiply their IPv4 public address space; and the consequence is the number of subscribers sharing the same public IPv4 address. We refer to this parameter as the address space multiplicative factor, the inverse is called the compression ratio.</p>
<p id="rfc.section.26.2.p.2">The multiplicative factor can only be applied to the subset of subscribers that are eligible for a shared address. The reasons a subscriber cannot have a shared address can be: </p>

<ul>
<li>It would not be compatible with the service they are currently subscribed to (for example: business subscriber).</li>
<li>Subscriber CPE is not compatible with the address sharing solution selected by the service provider (for example it does not handle port restriction for port-range solutions or it does not allow IPv4 in IPv6 encapsulation for the DS-Lite solution), and its replacement is not easy.</li>
</ul>
<p id="rfc.section.26.2.p.3">Different service providers may have very different needs. A long-lived service provider, whose number of subscribers is rather stable, may have an existing address pool that will only need a small extension to cope with the next few years, assuming that this address pool can be re-purposed for an address sharing solution (small multiplicative factor, less than 10). A new entrant or a new line of business will need a much bigger multiplicative factor (e.g., 1000). A mobile operator may see its addressing needs grow dramatically as the IP-enabled mobile handset market grows.</p>
<p id="rfc.section.26.2.p.4">When the multiplicative factor is large, the average number of ports per subscriber is small. Given the large measured disparity between average and peak port consumption <a href="#CGN_Viability">[CGN_Viability]</a>, this will create service problems in the event that ports are allocated statically. In this case, it is essential for port allocation to map to need as closely as possible, and to avoid allocating ports for longer than necessary. Therefore, the larger the multiplicative factor, the more dynamic the port assignment has to be.</p>
<h1 id="rfc.references">
<a href="#rfc.references">27.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1337">[RFC1337]</b></td>
<td class="top">
<a href="mailto:EMail:%20Braden@ISI.EDU" title="University of Southern California (USC), Information Sciences Institute">Braden, B.</a>, "<a href="http://tools.ietf.org/html/rfc1337">TIME-WAIT Assassination Hazards in TCP</a>", RFC 1337, May 1992.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2140">[RFC2140]</b></td>
<td class="top">
<a href="mailto:touch@isi.edu" title="University of Southern California/Information Sciences Institute">Touch, J.</a>, "<a href="http://tools.ietf.org/html/rfc2140">TCP Control Block Interdependence</a>", RFC 2140, April 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2663">[RFC2663]</b></td>
<td class="top">
<a href="mailto:srisuresh@lucent.com" title="Lucent Technologies">Srisuresh, P.</a> and <a href="mailto:holdrege@lucent.com" title="Lucent Technologiesv">M. Holdrege</a>, "<a href="http://tools.ietf.org/html/rfc2663">IP Network Address Translator (NAT) Terminology and Considerations</a>", RFC 2663, August 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2993">[RFC2993]</b></td>
<td class="top">
<a>Hain, T.</a>, "<a href="http://tools.ietf.org/html/rfc2993">Architectural Implications of NAT</a>", RFC 2993, November 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2782">[RFC2782]</b></td>
<td class="top">
<a href="mailto:arnt@troll.no" title="Troll Tech">Gulbrandsen, A.</a>, <a title="Internet Software Consortium">Vixie, P.</a> and <a href="mailto:levone@microsoft.com" title="Microsoft Corporation">L. Esibov</a>, "<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>", RFC 2782, February 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5135">[RFC5135]</b></td>
<td class="top">
<a>Wing, D.</a> and <a>T. Eckert</a>, "<a href="http://tools.ietf.org/html/rfc5135">IP Multicast Requirements for a Network Address Translator (NAT) and a Network Address Port Translator (NAPT)</a>", BCP 135, RFC 5135, February 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2827">[RFC2827]</b></td>
<td class="top">
<a>Ferguson, P.</a> and <a>D. Senie</a>, "<a href="http://tools.ietf.org/html/rfc2827">Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing</a>", BCP 38, RFC 2827, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3947">[RFC3947]</b></td>
<td class="top">
<a>Kivinen, T.</a>, <a>Swander, B.</a>, <a>Huttunen, A.</a> and <a>V. Volpe</a>, "<a href="http://tools.ietf.org/html/rfc3947">Negotiation of NAT-Traversal in the IKE</a>", RFC 3947, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1918">[RFC1918]</b></td>
<td class="top">
<a href="mailto:yakov@cisco.com" title="Cisco systems">Rekhter, Y.</a>, <a href="mailto:rgm3@is.chrysler.com" title="Chrysler Corporation">Moskowitz, R.</a>, <a href="mailto:Daniel.Karrenberg@ripe.net" title="RIPE Network Coordination Centre">Karrenberg, D.</a>, <a href="mailto:GeertJan.deGroot@ripe.net" title="RIPE Network Coordination Centre">Groot, G.</a> and <a href="mailto:lear@sgi.com" title="Silicon Graphics, Inc.">E. Lear</a>, "<a href="http://tools.ietf.org/html/rfc1918">Address Allocation for Private Internets</a>", BCP 5, RFC 1918, February 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3715">[RFC3715]</b></td>
<td class="top">
<a>Aboba, B.</a> and <a>W. Dixon</a>, "<a href="http://tools.ietf.org/html/rfc3715">IPsec-Network Address Translation (NAT) Compatibility Requirements</a>", RFC 3715, March 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4787">[RFC4787]</b></td>
<td class="top">
<a>Audet, F.</a> and <a>C. Jennings</a>, "<a href="http://tools.ietf.org/html/rfc4787">Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</a>", BCP 127, RFC 4787, January 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3056">[RFC3056]</b></td>
<td class="top">
<a>Carpenter, B.</a> and <a>K. Moore</a>, "<a href="http://tools.ietf.org/html/rfc3056">Connection of IPv6 Domains via IPv4 Clouds</a>", RFC 3056, February 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1191">[RFC1191]</b></td>
<td class="top">
<a href="mailto:mogul@decwrl.dec.com" title="Digital Equipment Corporation (DEC) , Western Research Laboratory">Mogul, J.</a> and <a href="mailto:deering@xerox.com" title="Xerox Palo Alto Research Center">S. Deering</a>, "<a href="http://tools.ietf.org/html/rfc1191">Path MTU discovery</a>", RFC 1191, November 1990.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.gont-behave-nat-security">[I-D.gont-behave-nat-security]</b></td>
<td class="top">
<a>Gont, F</a> and <a>P Srisuresh</a>, "<a href="http://tools.ietf.org/html/draft-gont-behave-nat-security-03">Security implications of Network Address Translators (NATs)</a>", Internet-Draft draft-gont-behave-nat-security-03, October 2009.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-behave-lsn-requirements">[I-D.ietf-behave-lsn-requirements]</b></td>
<td class="top">
<a>Perreault, S</a>, <a>Yamagata, I</a>, <a>Miyakawa, S</a>, <a>Nakagawa, A</a> and <a>H Ashida</a>, "<a href="http://tools.ietf.org/html/draft-ietf-behave-lsn-requirements-04">Common requirements for Carrier Grade NAT (CGN)</a>", Internet-Draft draft-ietf-behave-lsn-requirements-04, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-softwire-dual-stack-lite">[I-D.ietf-softwire-dual-stack-lite]</b></td>
<td class="top">
<a>Durand, A</a>, <a>Droms, R</a>, <a>Woodyatt, J</a> and <a>Y Lee</a>, "<a href="http://tools.ietf.org/html/draft-ietf-softwire-dual-stack-lite-11">Dual-Stack Lite Broadband Deployments Following IPv4 Exhaustion</a>", Internet-Draft draft-ietf-softwire-dual-stack-lite-11, May 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ymbk-aplusp">[I-D.ymbk-aplusp]</b></td>
<td class="top">
<a>Bush, R</a>, "<a href="http://tools.ietf.org/html/draft-ymbk-aplusp-10">The A+P Approach to the IPv4 Address Shortage</a>", Internet-Draft draft-ymbk-aplusp-10, May 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-behave-v6v4-xlate-stateful">[I-D.ietf-behave-v6v4-xlate-stateful]</b></td>
<td class="top">
<a>Bagnulo, M</a>, <a>Matthews, P</a> and <a>I Beijnum</a>, "<a href="http://tools.ietf.org/html/draft-ietf-behave-v6v4-xlate-stateful-12">Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers</a>", Internet-Draft draft-ietf-behave-v6v4-xlate-stateful-12, July 2010.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.despres-sam">[I-D.despres-sam]</b></td>
<td class="top">
<a>Despres, R</a>, "<a href="http://tools.ietf.org/html/draft-despres-sam-03">Scalable Multihoming across IPv6 Local-Address Routing Zones Global-Prefix/Local-Address Stateless Address Mapping (SAM)</a>", Internet-Draft draft-despres-sam-03, July 2009.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-behave-v6v4-xlate">[I-D.ietf-behave-v6v4-xlate]</b></td>
<td class="top">
<a>Li, X</a>, <a>Bao, C</a> and <a>F Baker</a>, "<a href="http://tools.ietf.org/html/draft-ietf-behave-v6v4-xlate-23">IP/ICMP Translation Algorithm</a>", Internet-Draft draft-ietf-behave-v6v4-xlate-23, September 2010.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.shirasaki-nat444">[I-D.shirasaki-nat444]</b></td>
<td class="top">
<a>Yamagata, I</a>, <a>Shirasaki, Y</a>, <a>Nakagawa, A</a>, <a>Yamaguchi, J</a> and <a>H Ashida</a>, "<a href="http://tools.ietf.org/html/draft-shirasaki-nat444-04">NAT444</a>", Internet-Draft draft-shirasaki-nat444-04, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.boucadair-port-range">[I-D.boucadair-port-range]</b></td>
<td class="top">
<a>Boucadair, M</a>, <a>Levis, P</a>, <a>Bajko, G</a> and <a>T Savolainen</a>, "<a href="http://tools.ietf.org/html/draft-boucadair-port-range-02">IPv4 Connectivity Access in the Context of IPv4 Address Exhaustion: Port Range based IP Architecture</a>", Internet-Draft draft-boucadair-port-range-02, July 2009.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.haddad-mext-nat64-mobility-harmful">[I-D.haddad-mext-nat64-mobility-harmful]</b></td>
<td class="top">
<a>Haddad, W</a> and <a>C Perkins</a>, "<a href="http://tools.ietf.org/html/draft-haddad-mext-nat64-mobility-harmful-02">A Note on NAT64 Interaction with Mobile IPv6</a>", Internet-Draft draft-haddad-mext-nat64-mobility-harmful-02, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.cheshire-nat-pmp">[I-D.cheshire-nat-pmp]</b></td>
<td class="top">
<a>Cheshire, S</a>, "<a href="http://tools.ietf.org/html/draft-cheshire-nat-pmp-03">NAT Port Mapping Protocol (NAT-PMP)</a>", Internet-Draft draft-cheshire-nat-pmp-03, April 2008.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.thaler-port-restricted-ip-issues">[I-D.thaler-port-restricted-ip-issues]</b></td>
<td class="top">
<a>Thaler, D</a>, "<a href="http://tools.ietf.org/html/draft-thaler-port-restricted-ip-issues-00">Issues With Port-Restricted IP Addresses</a>", Internet-Draft draft-thaler-port-restricted-ip-issues-00, February 2010.</td>
</tr>
<tr>
<td class="reference"><b id="IANA_Ports">[IANA_Ports]</b></td>
<td class="top">
<a title="Geoff Huston">, </a>, "<a>IANA Port Number Assignments</a>", February 2011.</td>
</tr>
<tr>
<td class="reference"><b id="IPv4_Pool">[IPv4_Pool]</b></td>
<td class="top">
<a title="Geoff Huston">, </a>, "<a>Available Pool of Unallocated IPv4 Internet Addresses Now Completely Emptied</a>", 2011.</td>
</tr>
<tr>
<td class="reference"><b id="CGN_Viability">[CGN_Viability]</b></td>
<td class="top">
<a title="WAND Network Research Group">Alcock, S</a>, "<a>Research into the Viability of Service-Provider NAT</a>", 2008.</td>
</tr>
<tr>
<td class="reference"><b id="Mobile_Energy_Consumption">[Mobile_Energy_Consumption]</b></td>
<td class="top">
<a>Haverinen, H</a>, <a>Siren, J</a> and <a>P Eronen</a>, "<a>Energy Consumption of Always-On Applications in WCDMA Networks</a>", 2007.</td>
</tr>
<tr>
<td class="reference"><b id="UPnP-IGD">[UPnP-IGD]</b></td>
<td class="top">
<a>UPnP Forum, </a>, "<a>Universal Plug and Play (UPnP) Internet Gateway Device (IGD) V 2.0</a>", December 2010.</td>
</tr>
<tr>
<td class="reference"><b id="Windows-Logo">[Windows-Logo]</b></td>
<td class="top">
<a>Microsoft, </a>, "<a>Windows Logo Program Device Requirements</a>", 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5508">[RFC5508]</b></td>
<td class="top">
<a>Srisuresh, P.</a>, <a>Ford, B.</a>, <a>Sivakumar, S.</a> and <a>S. Guha</a>, "<a href="http://tools.ietf.org/html/rfc5508">NAT Behavioral Requirements for ICMP</a>", BCP 148, RFC 5508, April 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4380">[RFC4380]</b></td>
<td class="top">
<a>Huitema, C.</a>, "<a href="http://tools.ietf.org/html/rfc4380">Teredo: Tunneling IPv6 over UDP through Network Address Translations (NATs)</a>", RFC 4380, February 2006.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-pcp-base">[I-D.ietf-pcp-base]</b></td>
<td class="top">
<a>Wing, D</a>, <a>Cheshire, S</a>, <a>Boucadair, M</a>, <a>Penno, R</a> and <a>P Selkirk</a>, "<a href="http://tools.ietf.org/html/draft-ietf-pcp-base-17">Port Control Protocol (PCP)</a>", Internet-Draft draft-ietf-pcp-base-17, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1700">[RFC1700]</b></td>
<td class="top">
<a href="mailto:jkrey@isi.edu" title="USC/Information Sciences Institute">Reynolds, J.</a> and <a href="mailto:postel@isi.edu" title="USC/Information Sciences Institute">J. Postel</a>, "<a href="http://tools.ietf.org/html/rfc1700">Assigned Numbers</a>", RFC 1700, October 1994.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6056">[RFC6056]</b></td>
<td class="top">
<a>Larsen, M.</a> and <a>F. Gont</a>, "<a href="http://tools.ietf.org/html/rfc6056">Recommendations for Transport-Protocol Port Randomization</a>", BCP 156, RFC 6056, January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5961">[RFC5961]</b></td>
<td class="top">
<a>Ramaiah, A.</a>, <a>Stewart, R.</a> and <a>M. Dalal</a>, "<a href="http://tools.ietf.org/html/rfc5961">Improving TCP's Robustness to Blind In-Window Attacks</a>", RFC 5961, August 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5996">[RFC5996]</b></td>
<td class="top">
<a>Kaufman, C.</a>, <a>Hoffman, P.</a>, <a>Nir, Y.</a> and <a>P. Eronen</a>, "<a href="http://tools.ietf.org/html/rfc5996">Internet Key Exchange Protocol Version 2 (IKEv2)</a>", RFC 5996, September 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mat Ford</span> editor
	  <span class="n hidden">
		<span class="family-name">Ford</span>
	  </span>
	</span>
	<span class="org vcardline">Internet Society</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Geneva</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">Switzerland</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ford@isoc.org">ford@isoc.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mohamed Boucadair</span> 
	  <span class="n hidden">
		<span class="family-name">Boucadair</span>
	  </span>
	</span>
	<span class="org vcardline">France Telecom</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Rennes</span>,  
		<span class="region"></span>
		<span class="code">35000</span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mohamed.boucadair@orange-ftgroup.com">mohamed.boucadair@orange-ftgroup.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Alain Durand</span> 
	  <span class="n hidden">
		<span class="family-name">Durand</span>
	  </span>
	</span>
	<span class="org vcardline">Juniper Networks</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:adurand@juniper.net">adurand@juniper.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Pierre Levis</span> 
	  <span class="n hidden">
		<span class="family-name">Levis</span>
	  </span>
	</span>
	<span class="org vcardline">France Telecom</span>
	<span class="adr">
	  <span>42 rue des Coutures</span>
<span>BP 6243</span>

	  <span class="vcardline">
		<span class="locality">Caen Cedex 4</span>,  
		<span class="region"></span>
		<span class="code">14066</span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:pierre.levis@orange-ftgroup.com">pierre.levis@orange-ftgroup.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Phil Roberts</span> 
	  <span class="n hidden">
		<span class="family-name">Roberts</span>
	  </span>
	</span>
	<span class="org vcardline">Internet Society</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Reston, VA</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:roberts@isoc.org">roberts@isoc.org</a></span>

  </address>
</div>

</body>
</html>