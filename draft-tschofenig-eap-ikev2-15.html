<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>EAP-IKEv2 Method</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="EAP-IKEv2 Method">
<meta name="keywords" content="Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">D. Kroeselberg</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">Expires: March 30, 2008</td><td class="header">A. Pashalidis</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">NEC</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Y. Ohba</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Toshiba</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">F. Bersani</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">France Telecom</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">September 27, 2007</td></tr>
</table></td></tr></table>
<h1><br />EAP-IKEv2 Method<br />draft-tschofenig-eap-ikev2-15.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on March 30, 2008.</p>

<h3>Abstract</h3>

<p> This document specifies EAP-IKEv2, an Extensible Authentication Protocol (EAP)
                method that is based on the Internet Key Exchange (IKEv2) protocol. EAP-IKEv2
                provides mutual authentication and session key establishment between an EAP peer and
                an EAP server. It supports authentication techniques that are based on passwords,
                high-entropy shared keys, and public key certificates. EAP-IKEv2 further provides
                support for cryptographic ciphersuite negotiation, hash function agility, identity
                confidentiality (in certain modes of operation), fragmentation, and an optional
                "fast reconnect" mode. EAP-IKEv2 has sucessfully passed Designated Expert Review as
                mandated by RFC 3748. 
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#overview">3.</a>&nbsp;
Protocol Overview<br />
<a href="#fastrec">4.</a>&nbsp;
Fast Reconnect<br />
<a href="#keyderivation">5.</a>&nbsp;
Key Derivation<br />
<a href="#elementexport">6.</a>&nbsp;
Session ID, Peer ID, and Server ID<br />
<a href="#errorhandling">7.</a>&nbsp;
Error Handling<br />
<a href="#formats">8.</a>&nbsp;
Specification of Protocol Fields<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#flagsfield">8.1.</a>&nbsp;
The Flags, Message Length, and Integrity Checksum Data fields<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#header">8.2.</a>&nbsp;
EAP-IKEv2 header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sapayload">8.3.</a>&nbsp;
Security Association Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#kepayload">8.4.</a>&nbsp;
Key Exchange Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#npayload">8.5.</a>&nbsp;
Nonce Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#idpayload">8.6.</a>&nbsp;
Identification Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certpayload">8.7.</a>&nbsp;
Certificate Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certreqpayload">8.8.</a>&nbsp;
Certificate Request Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#encpayload">8.9.</a>&nbsp;
Encrypted Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#authpayload">8.10.</a>&nbsp;
Authentication Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#notifypayload">8.11.</a>&nbsp;
Notify Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#nfidpayload">8.12.</a>&nbsp;
Next Fast-ID Payload<br />
<a href="#extensibility">9.</a>&nbsp;
Payload Types and Extensibility<br />
<a href="#sec">10.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ciphersuite">10.1.</a>&nbsp;
Protected Ciphersuite Negotiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mutualauth">10.2.</a>&nbsp;
Mutual Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#intprot">10.3.</a>&nbsp;
Integrity Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#replayprot">10.4.</a>&nbsp;
Replay Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#confidentiality">10.5.</a>&nbsp;
Confidentiality<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#kstr">10.6.</a>&nbsp;
Key Strength<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dictattack">10.7.</a>&nbsp;
Dictionary Attack Resistance<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#fastr">10.8.</a>&nbsp;
Fast Reconnect<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#crbinding">10.9.</a>&nbsp;
Cryptographic Binding<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sessionind">10.10.</a>&nbsp;
Session Independence<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#fragmntn">10.11.</a>&nbsp;
Fragmentation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#chanbind">10.12.</a>&nbsp;
Channel Binding<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">10.13.</a>&nbsp;
Summary<br />
<a href="#iabcs">11.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor2">12.</a>&nbsp;
Contributors<br />
<a href="#acks">13.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">14.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">14.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">14.2.</a>&nbsp;
Informative References<br />
<a href="#failedruns">Appendix&nbsp;A.</a>&nbsp;
EAP-IKEv2 Protocol Runs with Failed Authentication<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> This document specifies EAP-IKEv2, an EAP method that is based on the Internet Key
                Exchange Protocol version 2 (IKEv2) <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. The IKEv2 protocol is
                also able to carry AP exchanges inside IKEv2 but this method does not inherit the
                capabilites to tunnel EAP methods inside this EAP method. EAP-IKEv2 provides mutual
                authentication and session key establishment between an EAP peer and an EAP server.
                It supports authentication techniques that are based on the following types of
                credential. 
</p>
<p>
                </p>
<ul class="text">
<li> Asymmetric key pairs: these are public/private key pairs where the public
                        key is embedded into a digital certificate, and the corresponding private
                        key is known only to a single party.
</li>
<li> Passwords: these are low-entropy bit strings that are known to both the
                        server and the peer.
</li>
<li> Symmetric keys: these are high-entropy bit strings that known to both the
                        server and the peer.
</li>
</ul><p>
            
</p>
<p> It is possible to use a different authentication credential (and thereby technique)
                for each direction, e.g., the EAP server may authenticate itself using a
                public/private key pair and the EAP client may authenticate itself using a symmetric
                key. In particular, the following combinations are expected to be used in practice.
                These are referred to as "use cases or modes" in the remainder of this document. 
</p>
<p>
                </p>
<ol class="text">
<li> EAP server: asymmetric key pair, EAP peer: asymmetric key pair
</li>
<li> EAP server: asymmetric key pair, EAP peer: symmetric key
</li>
<li> EAP server: asymmetric key pair, EAP peer: password
</li>
<li> EAP server: symmetric key, EAP peer: symmetric key
</li>
</ol><p>
            
</p>
<p> Note that, in use cases 2 and 4, a symmetric key is assumed to be chosen uniformly
                at random from its key space; it is therefore assumed that symmetric keys are not
                derived from passwords. Deriving a symmetric key from a password is insecure when
                used with mode 4 since the exchange is vulnerable to dictionary attacks, as
                described in more detail in <a class='info' href='#dictattack'>Section&nbsp;10.7<span> (</span><span class='info'>Dictionary Attack Resistance</span><span>)</span></a>. Also note that, in use case
                3, the EAP server must either have access to all passwords in plaintext, or,
                alternatively, for each password store the value prf(password,"Key Pad for
                EAP-IKEv2") for all supported pseudorandom functions (also see <a class='info' href='#authpayload'>Section&nbsp;8.10<span> (</span><span class='info'>Authentication Payload</span><span>)</span></a> below and Section 2.15 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>). Other
                conceivable use cases are not expected to be used in practice due to key management
                issues, and have not been considered in this document. 
</p>
<p> The remainder of this document is structured as follows.
</p>
<p>
                </p>
<ul class="text">
<li>
                        <a class='info' href='#terminology'>Section&nbsp;2<span> (</span><span class='info'>Terminology</span><span>)</span></a> provides an overview of the terminology and the
                        abbreviations used in this document.
</li>
<li>
                        <a class='info' href='#overview'>Section&nbsp;3<span> (</span><span class='info'>Protocol Overview</span><span>)</span></a> provides an overview of the full EAP-IKEv2
                        exchange and thereby specifies the protocol message composition. 
</li>
<li>
                        <a class='info' href='#fastrec'>Section&nbsp;4<span> (</span><span class='info'>Fast Reconnect</span><span>)</span></a> specifies the optional EAP-IKEv2 "fast reconnect"
                        mode of operation.
</li>
<li>
                        <a class='info' href='#keyderivation'>Section&nbsp;5<span> (</span><span class='info'>Key Derivation</span><span>)</span></a> specifies how exportable session keys are
                        derived. 
</li>
<li>
                        <a class='info' href='#elementexport'>Section&nbsp;6<span> (</span><span class='info'>Session ID, Peer ID, and Server ID</span><span>)</span></a> specifies how the Session-ID, Peer-ID, and
                        Server-ID elements are derived. 
</li>
<li>
                        <a class='info' href='#errorhandling'>Section&nbsp;7<span> (</span><span class='info'>Error Handling</span><span>)</span></a> specifies how errors that may potentially
                        occur during protocol execution are handled. 
</li>
<li>
                        <a class='info' href='#formats'>Section&nbsp;8<span> (</span><span class='info'>Specification of Protocol Fields</span><span>)</span></a> specifies the format of the EAP-IKEv2 data fields.
                            <a class='info' href='#flagsfield'>Section&nbsp;8.1<span> (</span><span class='info'>The Flags, Message Length, and Integrity Checksum Data fields</span><span>)</span></a> describes how fragmentation is handled in
                        EAP-IKEv2. 
</li>
<li>
                        <a class='info' href='#extensibility'>Section&nbsp;9<span> (</span><span class='info'>Payload Types and Extensibility</span><span>)</span></a> specifies the payload type values and
                        describes protocol extensibility. 
</li>
<li>
                        <a class='info' href='#sec'>Section&nbsp;10<span> (</span><span class='info'>Security Considerations</span><span>)</span></a> provides a list of claimed security properties. 
</li>
</ul><p>
            
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p> This document makes use of terms defined in <a class='info' href='#EAP'>[2]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP) (RFC 3748),&rdquo; June&nbsp;2004.</span><span>)</span></a> and <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. In addition, the keywords MUST, MUST NOT, REQUIRED, SHALL,
                SHALL NOT, SHOULD, SHOULD NOT, RECOMMENDED, MAY, and OPTIONAL, when they appear in
                this document, are to be interpreted as described in <a class='info' href='#2119'>[3]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>. 
</p>
<p> A list of abbreviations that are used in this document follows. 
</p>
<p>
                </p>
<blockquote class="text"><dl>
<dt>AUTH:</dt>
<dd><br />
 Denotes a data field containing
                        either a MAC or a signature. This field is in embedded into an
                        Authentication payload, defined in <a class='info' href='#authpayload'>Section&nbsp;8.10<span> (</span><span class='info'>Authentication Payload</span><span>)</span></a>. 
</dd>
<dt>CERT:</dt>
<dd><br />
 Public key certificate or similar
                        structure. 
</dd>
<dt>CERTREQ:</dt>
<dd><br />
 Certificate Request.
</dd>
<dt>NFID:</dt>
<dd><br />
 Next Fast-ID payload (see <a class='info' href='#nfidpayload'>Section&nbsp;8.12<span> (</span><span class='info'>Next Fast-ID Payload</span><span>)</span></a> and <a class='info' href='#fastrec'>Section&nbsp;4<span> (</span><span class='info'>Fast Reconnect</span><span>)</span></a>)
</dd>
<dt>EMSK:</dt>
<dd><br />
 Extended Master Session Key,
                        defined in <a class='info' href='#EAP'>[2]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP) (RFC 3748),&rdquo; June&nbsp;2004.</span><span>)</span></a>. 
</dd>
<dt>HDR:</dt>
<dd><br />
 EAP-IKEv2 header, defined in <a class='info' href='#header'>Section&nbsp;8.2<span> (</span><span class='info'>EAP-IKEv2 header</span><span>)</span></a>. 
</dd>
<dt>I:</dt>
<dd><br />
 Initiator, the party that sends the
                        first message of an EAP-IKEv2 protocol run. This is always the EAP server. 
</dd>
<dt>MAC:</dt>
<dd><br />
 Message Authentication Code. The
                        result of a cryptographic operation that involves a symmetric key. 
</dd>
<dt>MSK:</dt>
<dd><br />
 Master Session Key, defined in <a class='info' href='#EAP'>[2]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP) (RFC 3748),&rdquo; June&nbsp;2004.</span><span>)</span></a>. 
</dd>
<dt>prf:</dt>
<dd><br />
 Pseudorandom function: a
                        cryptographic function whose output is assumed to be indistinguishable from
                        that of a truly random function. 
</dd>
<dt>R:</dt>
<dd><br />
 Responder, the party that sends the
                        second message of an EAP-IKEv2 protocol run. This is always the EAP peer. 
</dd>
<dt>SA:</dt>
<dd><br />
 Security Association. In this
                        document SA denotes a type of payload that is used for the negotiation of
                        the cryptographic algorithms that are to be used within an EAP-IKEv2
                        protocol run. Specifically, SAi denotes a set of choices that are accepted
                        by an initiator, and SAr denotes the choice of the responder.
</dd>
<dt>Signature:</dt>
<dd><br />
 The result of a cryptographic
                        operation that involves an asymmetric key. In particular, it involves the
                        private part of a public/private key pair. 
</dd>
<dt>SK:</dt>
<dd><br />
 Session Key. In this document, the
                        notation SK{x} denotes that x is embedded within an Encrypted payload,
                        i.e.,, that x is encrypted and integrity-protected using EAP-IKEv2 internal
                        keys. These keys are different in each direction.
</dd>
<dt>SK_xx:</dt>
<dd><br />
 EAP-IKEv2 internal key, defined in
                        Section 2.14 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.
</dd>
<dt>SKEYSEED:</dt>
<dd><br />
 Keying material, defined in
                        Section 2.14 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. 
</dd>
</dl></blockquote><p>
            
</p>
<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Protocol Overview</h3>

<p> In this section, the full EAP-IKEv2 protocol run is specified. All messages are sent
                between two parties, namely an EAP peer and an EAP server. In EAP-IKEv2, the EAP
                server always assumes the role of the initiator (I), and the EAP peer that of the
                responder (R) of an exchange. 
</p>
<p> The semantics and formats of EAP-IKEv2 messages are similar, albeit not identical,
                to those specified in IKEv2 <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> for the establishment of an IKE
                Security Association. The full EAP-IKEv2 protocol run consists of two roundtrips
                that are followed by either an EAP-Success or an EAP-Failure message. An optional
                roundtrip for exchanging EAP identities may precede the two exchanges. 
</p>
<p>
                <br /><hr class="insert" />
<a name="fullsuccess"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
1. R&lt;-I: EAP-Request/Identity

2. R-&gt;I: EAP-Response/Identity(Id)

3. R&lt;-I: EAP-Req (HDR, SAi, KEi, Ni)

4. R-&gt;I: EAP-Res (HDR, SAr, KEr, Nr, [CERTREQ], [SK{IDr}])

5. R&lt;-I: EAP-Req (HDR, SK{IDi, [CERT], [CERTREQ], [NFID], AUTH})

6. R-&gt;I: EAP-Res (HDR, SK{IDr, [CERT], AUTH})

7. R&lt;-I: EAP-Success
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: EAP-IKEv2 full, successful protocol run&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<p>
                <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a> shows the full EAP-IKEv2 protocol run, including the
                optional EAP identity exchange (messages 1 and 2). A detailed specification of the
                message composition follows.
</p>
<p> Messages 1 and 2 are a standard EAP Identity Request and Response, as defined in
                    <a class='info' href='#EAP'>[2]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP) (RFC 3748),&rdquo; June&nbsp;2004.</span><span>)</span></a>. Message 3 is the first EAP-IKEv2-specific message. With
                this, the server starts the actual EAP authentication exchange. It contains the
                initiator SPI in the EAP-IKEv2 header (HDR) (the initiator selects this value on a
                per-protocol run basis), the set of cryptographic algorithms the server is willing
                to accept for the protection of EAP-IKEv2 traffic (encryption and integrity
                protection) and the derivation of the session key. This set is encoded in the
                Security Association payload (SAi). It also contains a Diffie-Hellman payload (KEi),
                and a Nonce payload (Ni).
</p>
<p> When the peer receives message 3, it selects a set of cryptographic algorithms from
                the ones that are proposed in the message. In this overview, it is assumed that an
                acceptable such set exists (and is thus selected), and that the Diffie-Hellman value
                KEi belongs to an acceptable group. The peer then generates a non-zero Responder SPI
                value for this protocol run, its own Diffie-Hellman value (KEr) and nonce (Nr), and
                calculates the keys SKEYSEED, SK_d, SK_ai, SK_ar, SK_ei, SK_er, SK_pi, and SK_pr
                according to Section 2.14 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. The peer then constructs
                message 4. In the context of use cases 1, 2 and 3, the peer's local policy MAY
                dictate the inclusion of the optional CERTREQ payload in that message, which gives a
                hint to the server to include a certificate for its public key in its next message.
                In the context of use case 4, the peer MUST include the optional SK{IDr} payload,
                which contains its EAP-IKEv2 identifier, encrypted and integrity-protected within an
                Encrypted payload. The keys used to construct this Encrypted payload are SK_er (for
                encryption) and SK_ar (for integrity protection), in accordance with <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. The responder's EAP-IKEv2 identifier (IDr) is likely to be
                needed in these use cases by the server in order to select the correct symmetric key
                or password for the construction of the AUTH payload of message 5. 
</p>
<p> Upon reception of message 4, the server also computes SKEYSEED, SK_d, SK_ai, SK_ar,
                SK_ei, SK_er, SK_pi, and SK_pr according to Section 2.14 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.
                If an SK{IDr} payload is included, the server decrypts it and verifies its integrity
                with the corresponding keys. In this overview, decryption and verification is
                assumed to succeed. The server then constructs message 5 which contains only the
                EAP-IKEv2 header followed by a single Encrypted payload. The keys used to generate
                the encrypted payload MUST be SK_ei (for encryption) and SK_ai (for integrity
                protection), in accordance with <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. The initiator MUST embed at
                least two payloads in the Encrypted Payload, as follows. An Identification payload
                with the initiator's EAP-IKEv2 identifer MUST be embedded in the Encrypted payload.
                The Authentication payload MUST be embedded in the Encrypted payload. A Certificate
                payload, and/or a Certificate Request payload MAY also be embedded in the Encrypted
                payload. Moreover, a Next Fast-Reconnect Identifier payload MAY also be embedded in
                the Encrypted payload. Message 5 is sent to the responder.
</p>
<p> Upon reception of message 5, the responder (EAP peer) authenticates the initiator
                (EAP server). The checks that are performed to this end depend on the use case,
                local policies, and are specified in <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. These checks include
                (but may not be limited to) decrypting the Encrypted payload, verifying its
                integrity, and checking that the Authentication payload contains the expected value.
                If all checks succeed (which is assumed in this overview), then the responder
                constructs message 6. That message MUST contain the EAP-IKEv2 header followed by a
                single Encrypted payload, in which at least two further payloads MUST be embedded,
                as shown in <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a>. 
</p>
<p> Upon reception of message 6, the initiator (EAP server) authenticates the responder
                (EAP peer). As above, the checks that are performed to this end depend on the use
                case, local policies, and MUST include decryption and verification of the Encrypted
                payload, as well as checking that the Authentication payload contains the expected
                value. If the optional SK{IDr} payload was included in message 4, the EAP server
                MUST also ensure that the IDr payload in message 6 is identical to that in message
                4. 
</p>
<p> If authentication succeeds, an EAP-Success message is sent to the responder as
                message 7. The EAP server and the EAP peer generate a Master Session Key (MSK) and
                an Extended Master Session Key (EMSK) after a successful EAP-IKEv2 protocol run,
                according to <a class='info' href='#keyderivation'>Section&nbsp;5<span> (</span><span class='info'>Key Derivation</span><span>)</span></a>.
</p>
<a name="fastrec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Fast Reconnect</h3>

<p> This section specifies a "fast reconnect" mode of operation for EAP-IKEv2. This mode
                is mandatory to implement, but optional to use. The purpose of fast reconnect is to
                enable an efficient re-authentication procedure that also results in a fresh MSK and
                EMSK. The "fast reconnect" mode can only be used where an EAP-IKEv2 security context
                already exists at both the server and the peer, and its usage is subject to the
                local policies. In other words, it can only be used by an EAP server/EAP peer pair
                that has already performed mutual authentication in a previous EAP-IKEv2 protocol
                run. 
</p>
<p> The fast reconnect mode makes use of dedicated "fast reconnect EAP identifiers". The
                idea is that the server indicates its willingness to engage in "fast reconnect"
                protocol runs in the future by including the optional "Next Fast-ID" (NFID) payload
                in message 5 of a "full" protocol run (see <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a>), or in
                message 3 of a "fast reconnect" protocol run (see <a class='info' href='#fast'>Figure&nbsp;2<span> (</span><span class='info'>Fast Reconnect Protocol Run</span><span>)</span></a>). This NFID
                payload contains a special EAP identity, denoted Fast Reconnect Identity (FRID) as
                the NAI in the EAP-Response/Identity message. The FRID contains an obfuscated
                username part and a realm part. When generating a FRID the following aspects should
                be considered:
</p>
<p>
                </p>
<blockquote class="text">
<p> The FRID and therefore the pseudonym usernames are generated by the EAP
                        server. The EAP server produces pseudonym usernames in an
                        implementation-dependent manner. Only the EAP server needs to be able to map
                        the pseudonym username to the permanent identity. 
</p>
<p> EAP-IKEv2 includes no provisions to ensure that the same EAP server that
                        generated a pseudonym username will be used on the authentication exchange
                        when the pseudonym username is used. It is recommended that the EAP servers
                        implement some centralized mechanism to allow all EAP servers of the home
                        operator to map pseudonyms generated by other severs to the permanent
                        identity. If no such mechanism is available, then the EAP server, failing to
                        understand a pseudonym issued by another server, can request the peer to
                        send the permanent identity. 
</p>
<p> When generating FRIDs, the server SHOULD choose a fresh and unique FRID that
                        is different from the previous ones that were used after the same full
                        authentication exchange. The FRID SHOULD include a random component in the
                        username part. The random component works as a reference to the security
                        context. Regardless of the construction method, the pseudonym username MUST
                        conform to the grammar specified for the username portion of an NAI. Also,
                        the FRID MUST conform to the NAI grammar <a class='info' href='#NAI'>[4]<span> (</span><span class='info'>Aboba, B., Beadles, M., Arkko, J., and P. Eronen, &ldquo;The Network Access Identifier,&rdquo; December&nbsp;2005.</span><span>)</span></a>. The EAP
                        servers, which subscribers of an operator can use, MUST ensure that the
                        username part of a FRIDs that they generate are unique. 
</p>
</blockquote><p>
            
</p>
<p> The peer MAY use the FRID to indicate to start a "fast reconnect" protocol run. The
                EAP Identity Response MUST be sent at the beginning of a "fast reconnect" protocol
                run. If, in the previous successful "full" EAP-IKEv2 protocol execution, the server
                had not included an NFID payload in message 5 (resp. 3), then the peer MUST NOT
                start a fast reconnect protocol run. On reception of FRID, the server maps it to an
                existing EAP-IKEv2 security context. Depending on local policy, the server either
                proceeds with the "fast reconnect" protocol run, or proceeds with message 3 of a
                "full" protocol run. If the server had advertised the FRID in the previous EAP-IKEv2
                protocol execution, it SHOULD proceed with a "fast reconnect" protocol run. The peer
                MUST be able to correctly handle a message 3 of a "full" protocol run, even if it
                indicated a FRID in its EAP Identity Response. 
</p>
<p> Because the peer may fail to save a FRID that was sent in the NFID payload (for
                example, due to malfunction), the EAP server SHOULD maintain, at least, the most
                recently used FRID in addition to the most recently issued FRID. If the
                authentication exchange is not completed successfully, then the server MUST NOT
                overwrite the FRID that was issued during the most recent successful authentication
                exchange.
</p>
<p> The EAP-IKEv2 fast reconnect exchange is similar to the IKE-SA rekeying procedure as
                specified in Section 2.18 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. Thus, it uses a CREATE_CHILD_SA
                request and response. The SPIs on those two messages would be the SPI's negotiated
                on the previous exchange. During fast reconnect, the server and the peer MAY
                exchange fresh Diffie-Hellman values. 
</p>
<p>
                <br /><hr class="insert" />
<a name="fast"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
1. R&lt;-I: EAP-Request/Identity

2. R-&gt;I: EAP-Response/Identity(FRID)

3. R&lt;-I: EAP-Req(HDR, SK{SA, Ni, [KEi], [NFID]})

4. R-&gt;I: EAP-Res(HDR, SK{SA, Nr, [KEr]})

5. R&lt;-I: EAP-Success
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Fast Reconnect Protocol Run&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<p>
                <a class='info' href='#fast'>Figure&nbsp;2<span> (</span><span class='info'>Fast Reconnect Protocol Run</span><span>)</span></a> shows the message exchange for the EAP-IKEv2 fast reconnect
                mode. As in the full mode, the EAP server is the initiator and the EAP peer is the
                responder. The first two messages constitute the standard EAP identity exchange.
                Note that, in order to use the "fast reconnect" mode, message 2 MUST be sent. This
                is in order to enable the peer to indicate its "fast reconnect" identity FRID in
                message 2. If the server can map the FRID to an existing EAP-IKEv2 context it
                proceeds with message 3. Note that, in this message, the server MAY embed a NFID
                payload into the encrypted payload to provide a new FRID to the peer. The server MAY
                choose to perform a full EAP-IKEv2 run, in which case it would respond with a
                message that conforms to the format of message 3 in <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a>. 
</p>
<p> Messages 3 and 4 establish a new EAP-IKEv2 security context. In message 3, the
                initiator MUST select a new (non-zero) value for the SPI field in each proposal
                substructure in the SA payload (see Section 3.3 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>). The
                value of the IKE_SA Responder's SPI field in HDR MUST be the one from the previous
                successful EAP-IKEv2 protocol run. The nonce inside the Nonce payload (Ni) MUST be
                fresh, and the Diffie-Hellman value inside the Diffie-Hellman payload (if present,
                KEi) MUST also be fresh. If present, the Diffie-Hellman value MUST be drawn from the
                same group as the Diffie-Hellman value in the previous successful full EAP-IKEv2
                protocol run. Note that the algorithms and keys that are used to construct the
                Encrypted payload in message 3, are the same as in the previous successful EAP-IKEv2
                protocol run.
</p>
<p> Upon reception of message 3, the responder (EAP peer) decrypts and verifies the
                Encrypted payload. If successful (as assumed in <a class='info' href='#fast'>Figure&nbsp;2<span> (</span><span class='info'>Fast Reconnect Protocol Run</span><span>)</span></a>), it
                constructs message 4 in a fashion similar to the construction of message 3. The
                responder MUST choose a new (non-zero) value for the SPI field in each proposal
                substructure. Upon reception of message 4, the initiator (EAP server) decrypts and
                verifies the Encrypted payload.
                
                If a correct message 4 is received, then this protocol run is deemed successful, and
                the server responds with an EAP-Success message (message 5). 
</p>
<p> After successful EAP-IKEv2 fast reconnect protocol run, both the initiator and the
                responder generate fresh keying material, that is used for the protection of
                subsequent EAP-IKEv2 traffic. Furthermore, both the initiator and the responder MUST
                generate a fresh MSK and EMSK and export them. 
</p>
<p> The new EAP-IKEv2-specific keying material is computed in the same way as in the
                full EAP-IKEv2 protocol run, and in accordance with Section 2.18 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. That is, SKEYSEED is computed as SKEYSEED = prf(SK_d (old),
                [g^ir (new)] | Ni | Nr), where SK_d (old) is the key SK_d from the previous
                successful EAP-IKEv2 protocol run, Ni and Nr are the nonces (without the Nonce
                payload headers) that were exchanged in messages 3 and 4, and g^ir (new) is the
                newly computed Diffie-Hellman key, if both the values KEi and KEr were present in
                messages 3 and 4. The remaining EAP-IKEv2-specific keys (SK_d, SK_ai, SK_ar, SK_ei,
                SK_er, SK_pi, and SK_pr) are generated as in the full EAP-IKEv2 protocol run.
</p>
<p> The generation of a fresh MSK and EMSK follows the generation of the
                EAP-IKEv2-specific keys and adheres to the rules in <a class='info' href='#keyderivation'>Section&nbsp;5<span> (</span><span class='info'>Key Derivation</span><span>)</span></a>. 
</p>
<p> Note 1: In EAP-IKEv2, the EAP server initiates the fast reconnect mode and thereby
                causes fresh session keys to be established.
</p>
<p> Note 2: It is conceivable that an adversary tries to launch a replay attack against
                the EAP-IKEv2 fast reconnect mode of operation. In particular, the adversary may try
                to send a previously captured message 3 in a subsequent fast reconnect protocol run.
                This replay attempt will, however, fail because the keys that the responder will use
                to verify and decrypt the Encrypted payload are changed with every successful
                reconnect protocol run. 
</p>
<a name="keyderivation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Key Derivation</h3>

<p> This section describes how the Master Session Key (MSK) and the Extended Master
                Session Key (EMSK) are derived in EAP-IKEv2. It is expected that the MSK and the
                EMSK are exported by the EAP-IKEv2 process and be used in accordance with the EAP
                keying framework <a class='info' href='#I-D.ietf-eap-keying'>[7]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; November&nbsp;2007.</span><span>)</span></a>. 
</p>
<p> During an EAP-IKEv2 protocol run, the initiator and the responder generate a number
                of keys, as described above and in accordance with Section 2.14 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. The generation of these keys is based on a pseudorandom
                function (prf) that both parties have agreed to use and which is applied in an
                iterative fashion. This iterative fashion is specified in Section 2.13 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> and is denoted by prf+. 
</p>
<p> In particular, following a successful EAP-IKEv2 protocol run, both parties generate
                128 octets of keying material, denoted KEYMAT, as KEYMAT = prf+(SK_d, Ni | Nr),
                where Ni and Nr are the nonces (just payload without headers) from messages 3 and 4
                shown in <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a> (in the context of a full EAP-IKEv2 protocol
                run) or <a class='info' href='#fast'>Figure&nbsp;2<span> (</span><span class='info'>Fast Reconnect Protocol Run</span><span>)</span></a> (in the context of a fast reconnect EAP-IKEv2 protocol
                run). Note that only the nonces are used, i.e., not the entire Nonce payload that
                contains them. 
</p>
<p> The first 64 octets of KEYMAT are exported as the EAP MSK, and the second 64 octets
                are exported as the EMSK.
</p>
<p> The MSK and EMSK MUST NOT be generated unless an EAP-IKEv2 protocol run completes
                successfully. Note that the EAP-IKEv2 method does not produce an initialisation
                vector <a class='info' href='#I-D.ietf-eap-keying'>[7]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; November&nbsp;2007.</span><span>)</span></a>. 
</p>
<a name="elementexport"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Session ID, Peer ID, and Server ID</h3>

<p> The EAP key management framework <a class='info' href='#I-D.ietf-eap-keying'>[7]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; November&nbsp;2007.</span><span>)</span></a> requires that
                EAP methods export three information elements, called the Session-ID, the Peer-ID,
                and the Server-ID. In EAP-IKEv2 these elements are derived as follows.
</p>
<p>
                </p>
<ul class="text">
<li> The Session-ID is constructed and exported as the concatenation of the
                        following three elements, in this order: (a) the EAP Code Type for EAP-IKEv2
                        (to be defined by IANA), (b) the contents of the Nonce Data field of the
                        Nonce Payload Ni from message 3, (c) the contents of the Nonce Data field of
                        the Nonce Payload Nr from message 4.
</li>
<li> In case of a full EAP-IKEv2 protocol run, the Peer-ID is constructed and
                        exported as the content of the Identification Data field of the
                        Identification Payload IDr from message 6. Note that only the "actual"
                        identification data is exported, as indicated in the Payload Length field;
                        if the Identification Data field contains any padding, this padding is
                        ignored. In case of a "fast reconnect" protocol run, the Peer-ID field is
                        constructed in exactly the same manner, where message 6 refers to the full
                        EAP-IKEv2 protocol run that originally established the security context
                        between the EAP peer and EAP server. 
</li>
<li> In case of a full EAP-IKEv2 protocol run, the Server-ID is constructed and
                        exported as the contents of the Identification Data field of the
                        Identification Payload IDi from message 5. Note that only the "actual"
                        identification data is exported, as indicated in the Payload Length field;
                        if the Identification Data field contains any padding, this padding is
                        ignored. In case of a "fast reconnect" protocol run, the Server-ID field is
                        constructed in exactly the same manner, where message 5 refers to the full
                        EAP-IKEv2 protocol run that originally established the security context
                        between the EAP peer and EAP server. 
</li>
</ul><p>
            
</p>
<a name="errorhandling"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Error Handling</h3>

<p> This section specifies how errors are handled within EAP-IKEv2. For conveying error
                information from one party to the other, the Notify payload is defined and used (see
                    <a class='info' href='#notifypayload'>Section&nbsp;8.11<span> (</span><span class='info'>Notify Payload</span><span>)</span></a>). 
</p>
<p> If, in a full EAP-IKEv2 protocol run, authentication fails (i.e., the verification
                of the AUTH field fails at the server or the peer), but no other errors have
                occurred, the message flow deviates from that described in <a class='info' href='#overview'>Section&nbsp;3<span> (</span><span class='info'>Protocol Overview</span><span>)</span></a>. The message flows in the presence of authentication failures are specified in
                    <a class='info' href='#failedruns'>Appendix&nbsp;A<span> (</span><span class='info'>EAP-IKEv2 Protocol Runs with Failed Authentication</span><span>)</span></a>. 
</p>
<p> If, in message 3 of a full EAP-IKEv2 protocol run (see <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a>), the responder receives a Diffie-Hellman value (KEi) that belongs to a group
                that is not supported (and in the absence of other errors), then the responder MUST
                send a message of the form shown in <a class='info' href='#wrongdh'>Figure&nbsp;3<span> (</span><span class='info'>Error handling in case of unsupported D-H value</span><span>)</span></a> to the initiator. This
                effectively becomes message 4 in the full protocol run.
</p>
<p>
                <br /><hr class="insert" />
<a name="wrongdh"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
1. R&lt;-I: EAP-Request/Identity

2. R-&gt;I: EAP-Response/Identity(Id)

3. R&lt;-I: EAP-Req (HDR, SAi, KEi, Ni)

4. R-&gt;I: EAP-Res (HDR, N(INVALID_KE_PAYLOAD))
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Error handling in case of unsupported D-H value&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<p> The above message consists of the EAP-IKEv2 header and a Notification payload with
                the value of the Notify Message Type field value set to 17 (INVALID_KE_PAYLOAD).
                There are two octets of data associated with this notification: the number of the
                selected DH Group in big endian order, as specified in Section 3.10.1 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. This number MUST represent a DH group that is supported by
                both the initiator and the responder. 
</p>
<p> If, during a full EAP-IKEv2 protocol run (see <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a>), the
                initiator receives a message conforming to <a class='info' href='#wrongdh'>Figure&nbsp;3<span> (</span><span class='info'>Error handling in case of unsupported D-H value</span><span>)</span></a> instead of the
                usual message 4, then it MUST check whether or not the indicated DH group was
                proposed in message 3. If it was not, then the initiator MUST silently discard the
                message. Otherwise, the protocol continues with a new message 3 that the initiator
                sends to the peer. In this new message 3 the initiator MUST use a Diffie-Hellman
                value that is drawn from the group that is indicated in the Notify payload of
                message 4 in <a class='info' href='#wrongdh'>Figure&nbsp;3<span> (</span><span class='info'>Error handling in case of unsupported D-H value</span><span>)</span></a>.
                
            
</p>
<p> If, in the context of use case 4 and during a full EAP-IKEv2 protocol run (see <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a>), the initiator receives, in message 4, an SK{IDr}
                payload that decrypts to a non-existent or unauthorised EAP-IKEv2 responder
                identifier IDr*, then the server SHOULD continue the protocol with a message
                conforming to the format of message 5. The AUTH payload in that message SHOULD
                contain a value that is computationally indistinguishable from a value that it would
                contain if IDr* was valid and authorised. This can be accomplished, for example, by
                generating a random key and calculate AUTH as usual (however, this document does not
                mandate a specific mechanism). Only after receiving message 6, the server SHOULD
                respond with an authentication failure notification, i.e., a message conforming to
                message 6 in <a class='info' href='#fullsauthfailed'>Figure&nbsp;7<span> (</span><span class='info'>EAP-IKEv2 with failed server authentication</span><span>)</span></a>. The purpose of this behaviour is to
                prevent an adversary from probing the EAP-IKEv2 peer identifier space. 
</p>
<p> If, in the context of use cases 1, 2, or 3 and during a full EAP-IKEv2 protocol run
                (see <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a>), the initiator receives, in message 4, an SK{IDr}
                payload that decrypts to an EAP-IKEv2 responder identifier IDr*, then the server
                MUST continue the protocol as usual (note that such a payload would not be required
                in these use cases). The server MUST compare IDr* with the IDr received in message 6
                and, in case of a mismatch, MUST respond with an authentication failure
                notification, i.e., a message conforming to message 6 in <a class='info' href='#fullsauthfailed'>Figure&nbsp;7<span> (</span><span class='info'>EAP-IKEv2 with failed server authentication</span><span>)</span></a>. If no mismatch is detected, normal processing
                applies.
</p>
<p> Other errors do not trigger messages with Notification payloads to be sent, and MUST
                be treated as if nothing happened (i.e., the erroneous EAP-IKEv2 packet MUST be
                silently discarded). This includes situations where at least one of the following
                conditions is met, with respect to an incoming EAP-IKEv2 packet.
</p>
<p>
                </p>
<ul class="text">
<li> The packet contains an Encrypted payload that, when decrypted with the
                        appropriate key, yields an invalid decryption. 
</li>
<li> The packet contains an Encrypted payload with a Checksum field that does not
                        verify with the appropriate key.
</li>
<li> The packet contains an Integrity Checksum Data field (see <a class='info' href='#genformat'>Figure&nbsp;4<span> (</span><span class='info'>General packet format of EAP-IKEv2</span><span>)</span></a>) that is incorrect.
</li>
<li> The packet does not contain a compulsory field. 
</li>
<li> A field in the packet contains an invalid value (e.g., an invalid
                        combination of flags, a length field that is inconsistent with the real
                        length of the field or packet, or the responder's choice of a cryptographic
                        algorithm is different to NONE and any of those that were offered by the
                        initiator). 
</li>
<li> The packet contains an invalid combination of fields (e.g., it contains two
                        or more Notify payloads with the same Notify Message Type value, or two or
                        more Transform substructures with the same Transform Type and Transform ID
                        value).
</li>
<li> The packet causes a defragmentation error. 
</li>
<li> The format of the packet is invalid.
</li>
<li> The identity provided by the EAP peer in the EAP-Response/Identity cannot be
                        associated with either an established security context (in case of a fast
                        reconnect) or with a real user account (in case of a full protocol exchange)
                        then the packet is silently discarded. With an outstanding message from the
                        EAP server the client may either retransmit the previous request or, in case
                        of a fast reconnect, assume that state information was deleted (e.g., due to
                        garbage collection) at the EAP server and to fall back to a previously used
                        FRID or to the full protocol exchange. 
</li>
</ul><p>
            
</p>
<p> If an incoming packet contains an error for which behaviour is specified in this
                section, and an error that, in the absence of the former error, would cause the
                packet to be silently discarded, then the packet MUST be silently discarded. 
</p>
<a name="formats"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Specification of Protocol Fields</h3>

<p> In this section, the format of the EAP-IKEv2 data fields and applicable processing
                rules are specified. <a class='info' href='#genformat'>Figure&nbsp;4<span> (</span><span class='info'>General packet format of EAP-IKEv2</span><span>)</span></a> shows the general packet format of
                EAP-IKEv2 messages, and the embedding of EAP-IKEv2 into EAP. The EAP-IKEv2 messages
                are embedded in the Data field of the standard EAP Request/Response packets. The
                Code, Identifier, Length and Type fields are described in <a class='info' href='#EAP'>[2]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP) (RFC 3748),&rdquo; June&nbsp;2004.</span><span>)</span></a>. The
                EAP Type for this EAP method is TBD by IANA. 
</p>
<p>
                <br /><hr class="insert" />
<a name="genformat"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Code      |   Identifier  |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |   Flags       |       Message Length          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |       Message Length          |       HDR + payloads          ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Integrity Checksum Data                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: General packet format of EAP-IKEv2&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<p> The Flags field is always present and is used for fragmentation support, as
                described in <a class='info' href='#flagsfield'>Section&nbsp;8.1<span> (</span><span class='info'>The Flags, Message Length, and Integrity Checksum Data fields</span><span>)</span></a>. The Message Length field is not always
                present; it's presence is determined by a certain flag in the Flags field, as
                described in <a class='info' href='#flagsfield'>Section&nbsp;8.1<span> (</span><span class='info'>The Flags, Message Length, and Integrity Checksum Data fields</span><span>)</span></a>. The field denoted as "HDR + payloads" in
                    <a class='info' href='#genformat'>Figure&nbsp;4<span> (</span><span class='info'>General packet format of EAP-IKEv2</span><span>)</span></a> contains the EAP-IKEv2 header (see <a class='info' href='#header'>Section&nbsp;8.2<span> (</span><span class='info'>EAP-IKEv2 header</span><span>)</span></a>), followed by a number of payloads, in accordance with the
                composition of EAP-IKEv2 messages, as described in the previous sections. Note that
                each payload begins with a generic payload header that is specified in Section 3.2
                of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. 
</p>
<p> The Integrity Checksum Data field is not always present; its presence is determined
                by a certain flag in the Flags field, as described in <a class='info' href='#flagsfield'>Section&nbsp;8.1<span> (</span><span class='info'>The Flags, Message Length, and Integrity Checksum Data fields</span><span>)</span></a>. 
</p>
<p> In the remainder of this section, the protocol fields that are used in EAP-IKEv2 are
                specified. This specification heavily relies on the IKEv2 specification <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>, and many fields are constructed, formatted and processed in
                way that is almost identical to that in IKEv2. However, certain deviations from
                standard IKEv2 formatting and processing exist. These deviations are highlighted in
                the remainder of this section.
</p>
<a name="flagsfield"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
The Flags, Message Length, and Integrity Checksum Data fields</h3>

<p> This section describes EAP-IKEv2 fragmentation, and specifies the encoding and
                    processing rules for the Flags, Message Length, and Integrity Checksum Data
                    field shown in <a class='info' href='#genformat'>Figure&nbsp;4<span> (</span><span class='info'>General packet format of EAP-IKEv2</span><span>)</span></a>. 
</p>
<p> Fragmentation support in EAP-IKEv2 is provided by the Flags and Message Length
                    fields shown in <a class='info' href='#genformat'>Figure&nbsp;4<span> (</span><span class='info'>General packet format of EAP-IKEv2</span><span>)</span></a>. These are encoded and used as
                    follows.
</p>
<p>
                    <br /><hr class="insert" />
<a name="fragsup"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+-+
|L M I 0 0 0 0 0|
+-+-+-+-+-+-+-+-+

L = Length included
M = More fragments
I = Integrity Checksum Data included

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Flags field&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

                
</p>
<p> The Flags field is defined in <a class='info' href='#fragsup'>Figure&nbsp;5<span> (</span><span class='info'>Flags field</span><span>)</span></a>. Only the first three
                    bits (0-2) are used; all remaining bits MUST be set to zero and and ignored on
                    receipt. The L flag indicates the presence of a Message Length field, and the M
                    flag indicates whether or not the current EAP message has more fragments. In
                    particular, if the L bit is set, then a Message Length field MUST be present in
                    the EAP message, as shown in <a class='info' href='#genformat'>Figure&nbsp;4<span> (</span><span class='info'>General packet format of EAP-IKEv2</span><span>)</span></a>. The Message Length
                    field is four octets long and contains the length of the entire message (i.e.,
                    the length of the EAP Data field.). Note that, in contrast, the Length field
                    shown in <a class='info' href='#genformat'>Figure&nbsp;4<span> (</span><span class='info'>General packet format of EAP-IKEv2</span><span>)</span></a> contains the length of only the current
                    fragment. (Note that there exist two fields that are related to length: the
                    Length field, which is a generic EAP field, and the Message Length field, which
                    is an EAP-IKEv2-specific field.) If the L bit is not set, then the Message
                    Length field MUST NOT be present.
</p>
<p> The M flag MUST be set on all fragments except the last one. In the last
                    fragment, the M flag MUST NOT be set. Reliable fragment delivery is provided by
                    the retransmission mechanism of EAP. 
</p>
<p> The Integrity Checksum Data field contains a cryptographic checksum that covers
                    the entire EAP message, starting with the Code field, and ending at the end of
                    the EAP Data field. This field, shown in <a class='info' href='#genformat'>Figure&nbsp;4<span> (</span><span class='info'>General packet format of EAP-IKEv2</span><span>)</span></a>, is present
                    only if the I bit is set in the Flags field. The Integrity Checksum Data field
                    immediately follows the EAP Data field without padding. 
</p>
<p> Whenever possible, the Integrity Checksum Data field MUST be present (and the I
                    bit set) for each fragment, including the case where the entire EAP-IKEv2
                    message is carried in a single fragment. The algorithm and keys that are used to
                    compute the Integrity Checksum Data field MUST be identical to those used to
                    compute the Integrity Checksum Data field of the Encrypted Payload (see <a class='info' href='#encpayload'>Section&nbsp;8.9<span> (</span><span class='info'>Encrypted Payload</span><span>)</span></a>). That is, the algorithm and keys that were negotiated
                    and established during this EAP-IKEv2 protocol run are used. Note that this
                    means that different keys are used to compute the Integrity Checksum Data field
                    in each direction. Also note that, for messages where this algorithm and the
                    keys are not yet established, the Integrity Checksum Data field cannot be
                    computed and is therefore not included. This applies, for example, to messages 3
                    and 4 in <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a>. 
</p>
<p> In order to minimize the exposure to denial-of-service attacks on fragmented
                    packets, messages that are not protected with an Integrity Checksum Data field
                    SHOULD NOT be fragmented. Note, however, that those packets are not likely to be
                    fragmented anyway since they do not carry certificates. 
</p>
<a name="header"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
EAP-IKEv2 header</h3>

<p> The EAP-IKEv2 header, denoted HDR in this specification, is constructed and
                    formatted according to the rules specified in Section 3.1 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. 
</p>
<p> In the first EAP-IKEv2 message that is sent by the initiator (message 3 in <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a>), the IKE_SA Responder's SPI field is set to zero.
                    This is because, at this point in time, the initiator does not know what SPI
                    value the responder will choose for this protocol run. In all other messages,
                    both SPI fields MUST contain non-zero values that reflect the initiator and
                    responder-chosen SPI values. 
</p>
<p> In accordance with <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>, for this version of EAP-IKEv2, the
                    MjVer (major version) and MnVer (minor version) fields in the header MUST be 2
                    and 0 respectively. The value of the Exchange Type field MUST be set to 34
                    (IKE_SA_INIT) in messages 3 and 4, and to 35 (IKE_SA_AUTH) in messages 5 and 6
                    in <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a>. In messages 3 and 4 in <a class='info' href='#fast'>Figure&nbsp;2<span> (</span><span class='info'>Fast Reconnect Protocol Run</span><span>)</span></a>
                    this value MUST be set to 36 (CREATE_CHILD_SA). 
</p>
<p> The Flags field of the EAP-IKEv2 header is also constructed according to Section
                    3.1 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. Note that this is not the same field as the Flags
                    field shown in <a class='info' href='#genformat'>Figure&nbsp;4<span> (</span><span class='info'>General packet format of EAP-IKEv2</span><span>)</span></a>. 
</p>
<p> The Message ID field is constructed as follows. Messages 3 and 4 in a full
                    protocol run MUST carry Message ID value 0. Messages 5 and 6 in a full protocol
                    run (see Figure 1) MUST carry Message ID value 1. Messages 3 and 4 in a fast
                    reconnect protocol run MUST carry Message ID value 2.
</p>
<a name="sapayload"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Security Association Payload</h3>

<p> The SA payload is used for the negotiation of cryptographic algorithms between
                    the initiator and the responder. The rules for its construction adhere to <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>, in particular sections 2.7 and 3.3. 
</p>
<p> In EAP-IKEv2, all Proposal Substructures in the SA payload MUST carry Protocol
                    ID value 1 (IKE).
</p>
<a name="kepayload"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Key Exchange Payload</h3>

<p> The Key Exchange payload, denoted KEi if constructed by the initiator and KEr if
                    constructed by the responder, is formatted according to the rules specified in
                    Section 3.4 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. 
</p>
<a name="npayload"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.5"></a><h3>8.5.&nbsp;
Nonce Payload</h3>

<p> The Nonce payload, denoted Ni if constructed by the initiator and Nr if
                    constructed by the responder, is constructed and formatted according to the
                    rules specified in Section 3.9 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. 
</p>
<a name="idpayload"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.6"></a><h3>8.6.&nbsp;
Identification Payload</h3>

<p> The Identification payload, denoted IDi if it contains an identifier for the
                    initiator and IDr if it contains an identifier for the responder, is constructed
                    and formatted according to the rules specified in Section 3.5 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. 
</p>
<a name="certpayload"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.7"></a><h3>8.7.&nbsp;
Certificate Payload</h3>

<p> The Certificate payload, denoted CERT, is constructed and formatted according to
                    the rules specified in Section 3.6 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. Note that certain
                    certificate encodings for the EAP server certificate, e.g., those that need to
                    be resolved via another network protocol, cannot be used in some typical
                    EAP-IKEv2 deployment scenarios. A user, for example, that authenticates himself
                    by means of EAP-IKEv2 in order to obtain network access, cannot resolve the
                    server certificate at the time of EAP-IKEv2 protocol execution. 
</p>
<a name="certreqpayload"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.8"></a><h3>8.8.&nbsp;
Certificate Request Payload</h3>

<p> The Certificate payload, denoted CERTREQ, is constructed and formatted according
                    to the rules specified in Section 3.7 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. 
</p>
<a name="encpayload"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.9"></a><h3>8.9.&nbsp;
Encrypted Payload</h3>

<p> The Encrypted payload, denoted SK{...}, is constructed and formatted according
                    to the rules specified in Section 3.14 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. 
</p>
<a name="authpayload"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.10"></a><h3>8.10.&nbsp;
Authentication Payload</h3>

<p> The Authentication payload, denoted AUTH, is constructed and formatted according
                    to the rules specified in Section 2.15 and Section 3.8 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. 
</p>
<p> The contents of the Authentication payload depend on which party generates this
                    field, the use case, and the algorithm that corresponds to the credential
                    (asymmetric key, symmetric key, or password) that this party uses to
                    authenticate itself. The Authentication payload contains either a MAC or a
                    signature. 
</p>
<p> If the party that generates the Authentication payload authenticates itself
                    based on a shared secret (i.e., a password or a symmetric key), then the
                    Authentication payload MUST contain a MAC. This MAC is calculated using a key
                    that is derived from the shared secret, according to Section 2.15 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. According to that section, the shared secret is padded
                    with the string "Key Pad for IKEv2" as part of this key derivation. For the
                    EAP-IKEv2 method, this rule is overridden, in that the padding string is
                    redefined as "Key Pad for EAP-IKEv2". The latter padding string MUST be used for
                    the derivation of the MAC key from a shared secret in the context of EAP-IKEv2.
                    This is done in order to avoid the same MAC key to be used for both IKEv2 and
                    EAP-IKEv2 in scenarios where the same shared secret is used for both. Note that
                    using a shared secret (e.g., a password) in the context EAP-IKEv2 that is
                    identical or similar to a shared secret that is used in another context
                    (including IKEv2) is nevertheless NOT RECOMMENDED.
</p>
<a name="notifypayload"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.11"></a><h3>8.11.&nbsp;
Notify Payload</h3>

<p> The Notify payload, denoted N(...), is constructed and formatted according to
                    the rules specified in Section 3.10 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. The Protocol ID
                    field of this payload MUST be set to 1 (IKE_SA). 
</p>
<a name="nfidpayload"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.12"></a><h3>8.12.&nbsp;
Next Fast-ID Payload</h3>

<p> The Next Fast-ID Payload is defined as follows. 
</p>
<p>
                    <br /><hr class="insert" />
<a name="nfidp"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                           1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      ! Next Payload  !C!  RESERVED   !         Payload Length        !
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      !                                                               !
      ~                     Fast-Reconnect-ID (FRID)                  ~
      !                                                               !
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: NFID payload format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

                
</p>
<p> The Next Fast-ID payload, denoted NFID, does not have an equivalent in IKEv2.
                    Nevertheless, the Next Payload, C, RESERVED, and Payload Length fields of this
                    payload are constructed according to Section 3.2 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. The
                    payload ID is registered in <a class='info' href='#iabcs'>Section&nbsp;11<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>. The Fast-Reconnect-ID field
                    contains a fast reconnect identifer that the peer can use in the next fast
                    reconnect protocol run, as described in <a class='info' href='#fastrec'>Section&nbsp;4<span> (</span><span class='info'>Fast Reconnect</span><span>)</span></a>. In
                    environments where a realm portion is required, Fast-Reconnect-ID includes both
                    a username portion and a realm name portion. The Fast-Reconnect-ID MUST NOT
                    include any terminating null characters. The encoding of the Fast-Reconnect-ID
                    field MUST follow the NAI format <a class='info' href='#NAI'>[4]<span> (</span><span class='info'>Aboba, B., Beadles, M., Arkko, J., and P. Eronen, &ldquo;The Network Access Identifier,&rdquo; December&nbsp;2005.</span><span>)</span></a>. 
</p>
<a name="extensibility"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Payload Types and Extensibility</h3>

<p> In EAP-IKEv2, each payload is identified by means of a type field which, as
                specified in <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>, is indicated in the "Next Payload" field of the
                preceding payload. However, the identifer space from which EAP-IKEv2 payload types
                are drawn is independent from the payload type space of IKEv2. This is because
                EAP-IKEv2 and IKEv2 may evolve in a different way and, as such, payload types that
                appear in one protocol do not necessary appear in the other. An example of this is
                the "Next Fast-ID" (NFID) payload which does not exist in IKEv2.
</p>
<p> The values for the payload types defined in this document are listed in <a class='info' href='#iabcs'>Section&nbsp;11<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>. Payload type values 13-127 are reserved to IANA for future
                assignment in EAP-IKEv2. Payload type values 128-255 are for private use among
                mutually consenting parties. 
</p>
<a name="sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p> As mentioned in <a class='info' href='#overview'>Section&nbsp;3<span> (</span><span class='info'>Protocol Overview</span><span>)</span></a>, in EAP-IKEv2, the EAP server always
                assumes the role of the initiator (I), and the EAP peer takes on the role of the
                responder (R) of an exchange. This is in order to ensure that, in scenarios where
                the peer authenticates itself based on a password (i.e., in use case 3), operations
                that involve this password only take place after the server has been successfully
                authenticated. In other words, this assignment of initiator and responder roles
                results in protection against offline dictionary attacks on the password that is
                used by the peer to authenticate itself (see <a class='info' href='#dictattack'>Section&nbsp;10.7<span> (</span><span class='info'>Dictionary Attack Resistance</span><span>)</span></a>). 
</p>
<p> In order for two EAP-IKEv2 implementations to be interoperable, they must support at
                least one common set of cryptographic algorithms. In order to promote
                interoperability, EAP-IKEv2 implementations MUST support the following algorithms
                based on the "MUST/MUST-" recommendations given in <a class='info' href='#cryptomust'>[5]<span> (</span><span class='info'>Schiller, J., &ldquo;Cryptographic Algorithms for Use in the Internet Key Exchange Version 2                         (IKEv2),&rdquo; December&nbsp;2005.</span><span>)</span></a>:
</p>
<p>
                </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Diffie-Hellman Groups: 1024 MODP Group
    IKEv2 Transform Type 1 Algorithms: ENCR_3DES
    IKEv2 Transform Type 2 Algorithms: PRF_HMAC_SHA1
    IKEv2 Transform Type 3 Algorithms: AUTH_HMAC_SHA1_96
</pre></div><p>

            
</p>
<p>All other options of <a class='info' href='#cryptomust'>[5]<span> (</span><span class='info'>Schiller, J., &ldquo;Cryptographic Algorithms for Use in the Internet Key Exchange Version 2                         (IKEv2),&rdquo; December&nbsp;2005.</span><span>)</span></a> MAY be implemented.
</p>
<p> The remainder of this section describes EAP-IKEv2 in terms of specific security
                terminology as required by <a class='info' href='#EAP'>[2]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP) (RFC 3748),&rdquo; June&nbsp;2004.</span><span>)</span></a>. The discussion makes reference to
                the use cases defined in <a class='info' href='#introduction'>Section&nbsp;1<span> (</span><span class='info'>Introduction</span><span>)</span></a>. 
</p>
<a name="ciphersuite"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
Protected Ciphersuite Negotiation</h3>

<p> In message 3, the EAP server provides the set of ciphersuites it is willing to
                    accept in an EAP-IKEv2 protocol run. Hence, the server is in control of the
                    ciphersuite. An EAP peer that does not support any of the indicated ciphersuites
                    is not able to authenticate. The local security policy of the peer MUST specify
                    the set of ciphersuites that the peer accepts. The server MUST verify that the
                    ciphersuite that is indicated as being chosen by the peer in message 4, belongs
                    to the set of ciphersuites that were offered in message 3. If this verification
                    fails, the server MUST silently discard the packet. 
</p>
<a name="mutualauth"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
Mutual Authentication</h3>

<p> EAP-IKEv2 supports mutual authentication. 
</p>
<a name="intprot"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.3"></a><h3>10.3.&nbsp;
Integrity Protection</h3>

<p> EAP-IKEv2 provides integrity protection of EAP-IKEv2 traffic. This protection is
                    offered after authentication is completed and is facilitated by inclusion of two
                    Integrity Checksum Data fields: one at the end of the EAP packet (see <a class='info' href='#genformat'>Figure&nbsp;4<span> (</span><span class='info'>General packet format of EAP-IKEv2</span><span>)</span></a>), and one as part of an Encrypted payload (see <a class='info' href='#encpayload'>Section&nbsp;8.9<span> (</span><span class='info'>Encrypted Payload</span><span>)</span></a>). 
</p>
<a name="replayprot"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.4"></a><h3>10.4.&nbsp;
Replay Protection</h3>

<p> EAP-IKEv2 provides protection against replay attacks by a variety of means. This
                    includes the requirement that the Authentication payload is computed as a
                    function of, among other things, a server-provided nonce and a peer-provided
                    nonce. These nonces are required to be practically unpredictable by an
                    adversary. Assuming that the algorithm that is used to compute the
                    Authentication payload does not contain cryptographic weaknesses, the
                    probability that an Authentication payload that is valid in a particular
                    protocol run, will also be valid in a subsequent run, is therefore negligible. 
</p>
<a name="confidentiality"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.5"></a><h3>10.5.&nbsp;
Confidentiality</h3>

<p> EAP-IKEv2 provides confidentiality of certain EAP-IKEv2 fields, namely those
                    included in Encrypted payloads. With respect to identity confidentiality, the
                    following claims are made. Note that identity confidentiality refers to the
                    EAP-IKEv2 identity of the EAP peer.
</p>
<p> Identity confidentiality is provided in the face of a passive adversary, i.e.,
                    an adversary that does not modify traffic as it is in transit. Whenever the
                    optional SK{IDr} payload in message 4 of a full EAP-IKEv2 protocol (see <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a>) is not included, identity confidentiality is also
                    provided in the face of an active adversary. This payload MUST NOT be included
                    in use cases 1, 2, and 3. In use case 4 this payload MUST be included.
                    Therefore, in use case 4, EAP-IKEv2 does not provide identity confidentiality in
                    the face of an active adversary.
</p>
<p>Note, however, that the EAP peer provides it's identity in message 2 in <a class='info' href='#fullsuccess'>Figure&nbsp;1<span> (</span><span class='info'>EAP-IKEv2 full, successful protocol run</span><span>)</span></a> in cleartext. In order to provide identity
                    confidentiality as discussed in the previous paragraphs it is necessary to
                    obfuscated the username part of the identity (the realm part must stay intact to
                    allow correct message routing by the AAA infrastructure). The EAP server then
                    uses the identity information in message 4. The same mechanism is also used by
                    other EAP methods to provide identity confidentiality, for example EAP-TTLS
                        <a class='info' href='#I-D.ietf-pppext-eap-ttls'>[8]<span> (</span><span class='info'>Funk, P. and S. Blake-Wilson, &ldquo;EAP Tunneled TLS Authentication Protocol (EAP-TTLS),&rdquo; July&nbsp;2004.</span><span>)</span></a>. 
</p>
<a name="kstr"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.6"></a><h3>10.6.&nbsp;
Key Strength</h3>

<p> EAP-IKEv2 supports the establishment of session keys (MSK and EMSK) of a variety
                    of key strengths, with the theoretical maximum at 512 bits per key (since this
                    is the size of the MSK and the EMSK). However, in practice the effective key
                    strength is likely to be significantly lower, and depends on the authentication
                    credentials used, the negotiated ciphersuite (including the output size of the
                    pseudorandom function), the Diffie-Hellman group used, and on the extent to
                    which the assumptions on which the underlying cryptographic algorithms depend
                    really hold. Of the above mechanisms, the one that offers the lowest key
                    strength can be regarded as a measure of the effective key strength of the
                    resulting session keys. Note that this holds for other EAP methods, too.
</p>
<p> Due to the large variety of possible combinations, no indication of a practical
                    effective key strength for MSK or EMSK is given here. However, those responsible
                    for the deployment of EAP-IKEv2 in a particular environment should consider the
                    threats this environment may be exposed to, and configure the EAP-IKEv2 server
                    and peer policies and authentication credentials such that the established
                    session keys are of a sufficiently high effective key strength.
</p>
<a name="dictattack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.7"></a><h3>10.7.&nbsp;
Dictionary Attack Resistance</h3>

<p> EAP-IKEv2 can be used in a variety of use cases, as explained in <a class='info' href='#introduction'>Section&nbsp;1<span> (</span><span class='info'>Introduction</span><span>)</span></a>. In some of these uses cases, namely use case 1, 2,
                    and 4, dictionary attacks cannot be launched since no passwords are used. In use
                    case 3, EAP-IKEv2 provides protection against offline dictionary attacks, since
                    operations that involve the password are executed only after the server has
                    authenticated itself (based on a credential other than a password). 
</p>
<p> In order to reduce exposure against online dictionary attacks, in use case 3,
                    the server SHOULD provide the capability to log failed peer authentication
                    events, and SHOULD implement a suitable policy in case of consecutive failed
                    peer authentication attempts within a short period of time (such as responding
                    with an EAP-Failure instead of message 5 for a predetermined amount of time).
</p>
<p>When passwords are used with method 4 (instead of using an key with high entropy)
                    then dictionary attacks are possible, as described in Section 8 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>:
</p>
<p>
                    </p>
<blockquote class="text">
<p>" When using pre-shared keys, a critical consideration is how to assure
                            the randomness of these secrets. The strongest practice is to ensure
                            that any pre-shared key contain as much randomness as the strongest key
                            being negotiated. Deriving a shared secret from a password, name, or
                            other low-entropy source is not secure. These sources are subject to
                            dictionary and social engineering attacks, among others. " 
</p>
</blockquote><p>
                
</p>
<p>Hence, the usage of passwords with mode 4 where the EAP peer and the EAP server
                    rely on a shared secret that was derived from a password is insecure. It is
                    strongly recommended to use mode 3 when passwords are used by the EAP peer. 
</p>
<a name="fastr"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.8"></a><h3>10.8.&nbsp;
Fast Reconnect</h3>

<p> EAP-IKEv2 supports a "fast reconnect" mode of operation, as described in <a class='info' href='#fastrec'>Section&nbsp;4<span> (</span><span class='info'>Fast Reconnect</span><span>)</span></a>.
</p>
<a name="crbinding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.9"></a><h3>10.9.&nbsp;
Cryptographic Binding</h3>

<p> EAP-IKEv2 is not a tunnel EAP method. Thus, cryptographic binding does not apply
                    to EAP-IKEv2.
</p>
<a name="sessionind"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.10"></a><h3>10.10.&nbsp;
Session Independence</h3>

<p> EAP-IKEv2 provides session independence in a number of ways, as follows.
                    Firstly, knowledge of captured EAP-IKEv2 conversations (i.e., the information
                    that a passive adversary may obtain) does not enable the adversary to compute
                    the Master Session Key (MSK) and Extended Master Session Key (EMSK) that
                    resulted from these conversations. This holds even in the case where the
                    adversary later obtains access to the server and/or the peer's long-term
                    authentication credentials that were used in these conversations. That is,
                    EAP-IKEv2 provides support for "perfect forward secrecy". However, whether or
                    not this support is made use of in a particular EAP-IKEv2 protocol run, depends
                    on when the peer and the server delete the Diffie-Hellman values that they used
                    in that run, and on whether or not they use fresh Diffie-Hellman values in each
                    protocol run. The discussion in Section 2.12 of <a class='info' href='#IKEv2'>[1]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> applies. 
</p>
<p> Secondly, an active adversary that does not know the peer's and the server's
                    long-term authentication credentials cannot learn the MSK and EMSK that were
                    established in a particular protocol run of EAP-IKEv2, even if it obtains access
                    to the MSK and EMSK that were established in other protocol runs of EAP-IKEv2.
                    This is because the MSK and the EMSK are a function of, among other things, data
                    items that are assumed to be generated independently at random in each protocol
                    run. 
</p>
<a name="fragmntn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.11"></a><h3>10.11.&nbsp;
Fragmentation</h3>

<p> EAP-IKEv2 provides support for fragmentation, as described in <a class='info' href='#flagsfield'>Section&nbsp;8.1<span> (</span><span class='info'>The Flags, Message Length, and Integrity Checksum Data fields</span><span>)</span></a>.
</p>
<a name="chanbind"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.12"></a><h3>10.12.&nbsp;
Channel Binding</h3>

<p> Channel binding is not supported in EAP-IKEv2.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.13"></a><h3>10.13.&nbsp;
Summary</h3>

<p> EAP security claims are defined in Section 7.2.1 of <a class='info' href='#EAP'>[2]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP) (RFC 3748),&rdquo; June&nbsp;2004.</span><span>)</span></a>. The
                    security claims for EAP-IKEv2 are as follows:
</p>
<p>
                    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
            Ciphersuite negotiation:   Yes
            Mutual authentication:     Yes
            Integrity protection:      Yes
            Replay protection:         Yes
            Confidentiality:           Yes
            Key derivation:            Yes; see Section 5
            Key strength:              Variable
            Dictionary attack prot.:   Yes; see Section 10.7
            Fast reconnect:            Yes; see Section 4
            Crypt. binding:            N/A
            Session independence:      Yes; see Section 10.10
            Fragmentation:             Yes; see Section 10.11
            Channel binding:           No
</pre></div><p>

                
</p>
<a name="iabcs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
IANA Considerations</h3>

<p> IANA should allocate a value for the EAP method type indicating EAP-IKEv2.
</p>
<p>In addition, IANA is requested to create a new registry for EAP-IKEv2 payloads, and
                populate it with the following initial entries listed below.
</p>
<p>The following payload type values are used by this document. </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Next Payload Type                  | Value
  -----------------------------------+----------------------------------
  No Next payload                    | TBD by IANA (suggested value: 0)
  Security Association payload       | TBD by IANA (suggested value: 1)
  Key Exchange payload               | TBD by IANA (suggested value: 2)
  Identification payload             |
      (when sent by initiator, IDi)  | TBD by IANA (suggested value: 3)
  Identification payload             |
      (when sent by responder, IDr)  | TBD by IANA (suggested value: 4)
  Certificate payload                | TBD by IANA (suggested value: 5)
  Certificate Request payload        | TBD by IANA (suggested value: 6)
  Authentication payload             | TBD by IANA (suggested value: 7)
  Nonce payload                      | TBD by IANA (suggested value: 8)
  Notification payload               | TBD by IANA (suggested value: 9)
  Vendor ID payload                  | TBD by IANA (suggested value: 10)
  Encrypted payload                  | TBD by IANA (suggested value: 11)
  Next Fast-ID payload               | TBD by IANA (suggested value: 12)
  RESERVED TO IANA                   | 13-127
  PRIVATE USE                        | 128-255
</pre></div><p>
 Payload type values 13-127 are reserved to IANA for future assignment in
                EAP-IKEv2. Payload type values 128-255 are for private use among mutually consenting
                parties. 
</p>
<p>The semantic of the above-listed payloads is provided in this document and refer to
                IKEv2 when necessary. 
</p>
<p>Following the policies outline in <a class='info' href='#RFC3575'>[9]<span> (</span><span class='info'>Aboba, B., &ldquo;IANA Considerations for RADIUS (Remote Authentication Dial In User Service),&rdquo; July&nbsp;2003.</span><span>)</span></a> new payload type values
                with a description of their semantic will be assigned after Expert Review initiated
                by the Security Area Directors in consultation with the EMU working group chairs or
                the working group chairs of a designated successor working group. Updates can be
                provided based on expert approval only. A designated expert will be appointed by the
                Security Area Directors. Based on expert approval it is possible to delete entries
                from the registry or to mark entries as "deprecated".
</p>
<p>Each registration must include the payload type value and the semantic of the
                payload.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Contributors</h3>

<p> The authors are grateful to Krzysztof Rzecki, Rafal Mijal, Piotr Marnik, and Pawel
                Matejski, who, during their implementation of EAP-IKEv2 (see
                http://eap-ikev2.sourceforge.net/), provided invaluable feedback and identified a
                number of errors in previous versions of this draft. 
</p>
<a name="acks"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Acknowledgements</h3>

<p>The authors also thank Pasi Eronen for his invaluable comments as expert reviewer
                assigned by the EAP working group chairs Jari Arkko and Bernard Aboba. The authors
                would also like to thank Guenther Horn, Thomas Otto, Paulo Pagliusi and John
                Vollbrecht for their insightful comments and suggestions. The members of the PANA
                design team, in particular D. Forsberg and A. Yegin, also provided comments on the
                initial version of this draft. We would like to thank Hugo Krawczyk for his feedback
                regarding the usage of the password based authentication.
</p>
<p> The authors are grateful to the members of the EAP keying design team for their
                discussion in the area of the EAP Key Management Framework.
</p>
<p>We would like to thank Jari Arkko for his support and for his comments. Finally, we
                would like to thank Charlie Kaufman, Bernard Aboba, and Paul Hoffman for their
                comments during IETF Last Call.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>14.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="IKEv2">[1]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.ietf.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="EAP">[2]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://www.ietf.org/rfc/rfc3748.txt">Extensible Authentication Protocol (EAP) (RFC 3748)</a>,&rdquo; Request For Comments&nbsp;3748, June&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="2119">[3]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.ietf.org/rfc/rfc2119.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NAI">[4]</a></td>
<td class="author-text">Aboba, B., Beadles, M., Arkko, J., and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc4282">The Network Access Identifier</a>,&rdquo; RFC&nbsp;4282, December&nbsp;2005 (<a href="http://www.ietf.org/rfc/rfc4282.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="cryptomust">[5]</a></td>
<td class="author-text">Schiller, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4307">Cryptographic Algorithms for Use in the Internet Key Exchange Version 2
                        (IKEv2)</a>,&rdquo; RFC&nbsp;4307, December&nbsp;2005 (<a href="http://www.ietf.org/rfc/rfc4307.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="utf8">[6]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; RFC&nbsp;3629 (<a href="http://www.ietf.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>14.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-eap-keying">[7]</a></td>
<td class="author-text">Aboba, B., Simon, D., and P. Eronen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-eap-keying-22.txt">Extensible Authentication Protocol (EAP) Key Management Framework</a>,&rdquo; draft-ietf-eap-keying-22 (work in progress), November&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-eap-keying-22.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-pppext-eap-ttls">[8]</a></td>
<td class="author-text">Funk, P. and S. Blake-Wilson, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-pppext-eap-ttls-05.txt">EAP Tunneled TLS Authentication Protocol (EAP-TTLS)</a>,&rdquo; draft-ietf-pppext-eap-ttls-05 (work in progress), July&nbsp;2004 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-pppext-eap-ttls-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3575">[9]</a></td>
<td class="author-text">Aboba, B., &ldquo;<a href="http://tools.ietf.org/html/rfc3575">IANA Considerations for RADIUS (Remote Authentication Dial In User Service)</a>,&rdquo; RFC&nbsp;3575, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3575.txt">TXT</a>).</td></tr>
</table>

<a name="failedruns"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
EAP-IKEv2 Protocol Runs with Failed Authentication</h3>

<p> This appendix illustrates how authentication failures are handled within EAP-IKEv2.
                Note that authentication failures only occur in full EAP-IKEv2 protocol runs.
</p>
<p>
                <a class='info' href='#fullsauthfailed'>Figure&nbsp;7<span> (</span><span class='info'>EAP-IKEv2 with failed server authentication</span><span>)</span></a> shows the message flow in case the EAP peer fails
                to authenticate the EAP server. 
</p>
<p>
                <br /><hr class="insert" />
<a name="fullsauthfailed"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
1. R&lt;-I: EAP-Request/Identity

2. R-&gt;I: EAP-Response/Identity(Id)

3. R&lt;-I: EAP-Req (HDR, SAi1, KEi, Ni)

4. R-&gt;I: EAP-Res (HDR, SAr1, KEr, Nr, [CERTREQ], [SK{IDr}])

5. R&lt;-I: EAP-Req (HDR, SK {IDi, [CERT], [CERTREQ], [IDr], AUTH})

6. R-&gt;I: EAP-Res(HDR, SK {N(AUTHENTICATION_FAILED)})

7. R&lt;-I: EAP-Failure

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: EAP-IKEv2 with failed server authentication&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<p> The difference to the full successful exchange described in <a class='info' href='#overview'>Section&nbsp;3<span> (</span><span class='info'>Protocol Overview</span><span>)</span></a> is that, in message 6, the EAP peer MUST answer the EAP server with an Encrypted
                payload that contains a Notify payload with the Notify Message Type value set to 24
                (AUTHENTICATION_FAILED). In that message, the Message ID field in the EAP-IKEv2
                header (HDR), MUST carry Message ID value 2. In message 7, an EAP-Failure message
                MUST be returned by the EAP server. 
</p>
<p>
                <a class='info' href='#fullpauthfailed'>Figure&nbsp;8<span> (</span><span class='info'>EAP-IKEv2 with failed peer authentication</span><span>)</span></a> shows the message flow in case the EAP server fails
                to authenticate the EAP peer. 
</p>
<p>
                <br /><hr class="insert" />
<a name="fullpauthfailed"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

1. R&lt;-I: EAP-Request/Identity

2. R-&gt;I: EAP-Response/Identity(Id)

3. R&lt;-I: EAP-Req (HDR, SAi1, KEi, Ni)

4. R-&gt;I: EAP-Res (HDR, SAr1, KEr, Nr, [CERTREQ], [SK{IDr}])

5. R&lt;-I: EAP-Req (HDR, SK {IDi, [CERT], [CERTREQ], AUTH})

6. R-&gt;I: EAP-Res (HDR, SK {IDr, [CERT], AUTH})

7. R&lt;-I: EAP-Req (HDR, SK {N(AUTHENTICATION_FAILED)})

8. R-&gt;I: EAP-Res (HDR, SK {})

9. R&lt;-I: EAP-Failure


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: EAP-IKEv2 with failed peer authentication&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<p> Compared to the full successful exchange, one additional roundtrip is required. In
                message 7 the EAP server MUST send an EAP request with Encrypted payload that
                contains a Notify payload with the Notify Message Type value set to 24
                (AUTHENTICATION_FAILED), instead of sending an EAP-Success message. The EAP peer,
                upon receiving message 7, MUST send an empty EAP-IKEv2 (informational) message in
                reply to the EAP server's error indication, as shown in message 8. In both message 7
                and 8, the Message ID field in the EAP-IKEv2 header (HDR), MUST carry Message ID
                value 2. Finally, by means of message 9, the EAP server answers with an EAP-Failure. 
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Otto-Hahn-Ring 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Munich, Bavaria  81739</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@nsn.com">Hannes.Tschofenig@nsn.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.com">http://www.tschofenig.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dirk Kroeselberg</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Otto-Hahn-Ring 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Munich, Bavaria  81739</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Dirk.Kroeselberg@nsn.com">Dirk.Kroeselberg@nsn.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Andreas Pashalidis</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NEC</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kurfuersten-Anlage 36</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Heidelberg  69115</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Andreas.Pashalidis@netlab.nec.de">Andreas.Pashalidis@netlab.nec.de</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yoshihiro Ohba</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Toshiba America Research, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1 Telcordia Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Piscataway, NJ  08854</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:yohba@tari.toshiba.com">yohba@tari.toshiba.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Florent Bersani</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France Telecom R&D</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">38, rue du General Leclerc</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Issy-Les-Moulineaux, Cedex  92794</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:bersani_florent@yahoo.fr">bersani_florent@yahoo.fr</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
