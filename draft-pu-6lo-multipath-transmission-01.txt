6lo                                                               C. Pu
Internet Draft                                                  Y. Wang
Intended status: Standards Track                                H. Wang
Expires: March 11, 2018                                         Y. Yang
                                                                P. Wang
                                                Chongqing University of
                                           Posts and Telecommunications
                                                      September 7, 2017


                Multipath Transmission for 6LoWPAN Networks
                  draft-pu-6lo-multipath-transmission-01


Abstract

   This document provides a multipath transmission method for 6LoWPAN
   Networks, which can effectively offer the transmission redundancy of
   packets. It is applicable for high-reliability networks,especially 
   for IPv6-based wireless industrial scenarios.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six
   months and may be updated, replaced, or obsoleted by other documents
   at any time. It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   This Internet-Draft will expire on March 11, 2018.








Pu, et al.                Expires March 11, 2018              [Page 1]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2017


Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors. All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with
   respect to this document. Code Components extracted from this
   document must include Simplified BSD License text as described in
   Section 4.e of the Trust Legal Provisions and are provided without
   warranty as described in the Simplified BSD License.

Table of Contents

   1. Introduction ................................................ 2
   2. 6LoWPAN Multipath Header Format ............................. 3
   3. Architecture ................................................ 3
   4. Multipath Distribution ...................................... 4
   5. Packet Replication and Elimination .......................... 6
   6. Security Considerations ..................................... 7
   7. IANA Considerations ......................................... 7
   8. References .................................................. 7
      8.1. Normative References ................................... 7
      8.2. Informative References ................................. 8
   Authors' Addresses ............................................. 9

1. Introduction

   6LoWPAN has high popularity and applicability, and has more address
   space that can realize the deployment of large-scale and high-
   density wireless personal area network devices. However, due to the
   low processing power, limited energy and poor communication
   environment in 6LoWPAN, packets are prone to be lost during
   transmission, which results in transmission failure. In order to
   increase the communication reliability and improve the transmission
   performance, it is significant to introduce multipath packet
   transmission technology in 6LoWPAN. It is well known that RPL as a
   routing protocol standardized by IETF, is an efficient distance
   vector protocol for wireless sensor networks, which has designed a
   series of new mechanisms [RFC6550], and is widely used in 6LoWPAN.
   Aiming at the explicit demand for 6LoWPAN adopting multipath packet
   transmission, this document proposes a multipath transmission method
   based on RPL, which improves the success rate of packets



 Pu, et al.              Expires March 11, 2018                [Page 2]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2017


   transmission in uplink networks and further enhances the
   transmission reliability.

2. 6LoWPAN Multipath Header Format

   6LoWPAN multipath header designed at the adaptation layer contains
   the multipath header type field, the sequence number field of the
   multipath package (SequenceNumber) and the path number field
   (PathCount) [RFC4944], as depicted in Figure 1.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Multipath   |         Sequence Number       |  Path Number  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                Figure 1: 6LoWPAN Multipath Header Format

   Field definitions are as follows.

   Multipath: Headers of different types at the adaptation layer must
      have a length of 8-bit header type field. The multipath field is
      the header type field of 6LoWPAN Multipath Header that uses the
      Dispatch Value Bit Pattern of 11101000.

   Sequence Number: This field contains the unique sequence number
      SequenceNumber of packets, and its length is 16 bits.

   Path Number: This field includes the number of paths PathCount that
      needs to be filled in the packet, and its length is 8 bit.

3. Architecture

   The following figure 2 shows the architecture of the 6LoWPAN
   protocol stack. In this architecture, the IP layer uses RPL to
   realize the multipath transmission. Moreover, at the adaptation
   layer, the multipath transmission entity is achieved by designing a
   multipath header. The encapsulation of multipath packets and the
   transmission of multipath packets can be implemented by using above
   methods.









 Pu, et al.              Expires March 11, 2018                [Page 3]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2017


          +---------------------------------------------------+
          |   COAP           Application Layer           XMPP |
          |---------------------------------------------------|
          |   UDP             Transport Layer                 |
          |---------------------------------------------------|
          |  -----                              --------------|
          |  |RPL|               IP Layer       |   Multipath||
          |  -----                              |Transmission||
          |                                     --------------|
          |---------------------------------------------------|
          |                                 ------------------|
          |   Header       Adaptation Layer |       Multipath||
          |   Compression                   |Transport Entity||
          |                                 ------------------|
          |---------------------------------------------------|
          |   CSMA/CA            Mac Layer                    |
          |---------------------------------------------------|
          |   Channel Detection     Physical Layer            |
          +---------------------------------------------------+
               Figure 2: 6LoWPAN Protocol Stack Architecture

   Before the source node sends a message, it is necessary to determine
   the number of paths P according to reliability requirements. Then we
   need to assign one or more paths for each parent node at the IP
   layer through the rank value. The rank value is calculated according
   to the residual energy value and the hop value to the sink node from
   the source node [RFC6551], [RFC6552]. The number of paths is
   encapsulated into the multipath header of the message at the
   adaptation layer before sending the message to the parent node.
   Moreover, each intermediate routing node forwards the message
   according to the above method until it reaches the sink node.

4. Multipath Distribution

   If the required number of paths P is greater than the total number
   of parent nodes N in the collection of RPL parent nodes, multiple
   paths are assigned to each parent node according to the size
   relation among the rank values of all parent nodes. The following
   formula is used.

   Pm = round (P/Rm/R)     where     R = 1/R1 + 1/R2 +...+ 1/Rn

   Here, round() presents the rounding function, rounding for the
   calculation result of (P/Rm/R). P is the total number of paths. Pm
   shows the number of paths allocated for parent node m. Rm represents


 Pu, et al.              Expires March 11, 2018                [Page 4]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2017


   the Rank value corresponding to the parent node m (m=1,2,...,n). The
   above situation is shown as Figure 3.

          +---------------------------------------------------+
          |  rank2=500 P2=1                                   |
          | +------------>(R1)----> .....                     |
          | |                                                 |
          | |                                                 |
          | |               /---->(R3)---->(R4)----> .....\   |
          | |rank1=100 P1=5/                               \  |
          |(S) ---------->(R2).....--->(R5)--->(R6)---> ...(D)|
          | |P=8           \                               /  |
          | |               \---->(R7)---->(R8)----> ...../   |
          | |                                                 |
          | |rank3=200 P3=2     /----> .....                  |
          | +---------------->(R9)                            |
          |                     \----> .....                  |
          +---------------------------------------------------+
               Figure 3: The Transmission Process of P>N

   If the number of paths P is less than or equal to the total number
   of parent nodes, P rank values are selected according to the rise
   order of rank values, and one path is assigned to the parent node
   corresponding to each rank value, as shown in Figure 4.

          +---------------------------------------------------+
          |   rank2=500 P2=1                                  |
          | +---------------->(R1)---->(R2)---->(R3)......... |
          | |                                               | |
          | | rank1=100 P1=1                                | |
          | | /-------------->(R4)---->(R5)---->(R6)......\ | |
          | |/                                             \| |
          |(S)P=3                                          (D)|
          | .\rank3=200 P3=1                               /. |
          | . \-------------->(R7)---->(R8)---->(R9)....../ . |
          | .                                               . |
          | . rank4=600 P4=0                                . |
          | ..................(10)....(R11)....(R12)......... |
          |                                                   |
          +---------------------------------------------------+
               Figure 4: The Transmission Process of P<=N








 Pu, et al.              Expires March 11, 2018                [Page 5]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2017


5. Packet Replication and Elimination

   The process of packet multipath transmission also includes packet
   replication and elimination. A detailed description is given as
   following five steps.

     1) When the multipath transport entity of the adaptation layer
   receives the packet from the upper layer of the protocol stack, it
   first determines the total number of paths P to transmit the packet
   according to the reliability requirements of the packet. When P is
   less than or equal to 1, indicating that the packet does not need to
   use multipath transmission, then the packet can be forwarded
   directly.

     2) When the total number of paths P is larger than 1, the multipath
   packet allocation method is used to allocate the number of the
   replicated packets PathCount that needs to be forwarded by each
   parent node in the collection of RPL parent nodes [I-D.ietf-detnet-
   architecture], [I-D.ietf-detnet-problem-statement].

     3) For the parent node that PathCount is greater than or equal to
   1, the multipath transport entity replicates the packet and adds the
   multipath header at the adaptation layer, and then sends the packet
   to the parent node. In this case, the packet sequence number
   SequenceNumber of the multipath header in all replicated packets
   must be consistent and it can be accumulated when the next new
   packet is sent. The path number field is filled with the
   corresponding number of copies PathCount. For the parent node whose
   number of copies PathCount is less than 1, the source node does not
   send the packet.

     4) After the intermediate routing node receives the packet
   containing the multipath header, it judges whether the number of
   paths PathCount in the multipath header is equal to 1. If PathCount
   is equal to 1, the intermediate node sends the packet directly with
   the value of each field in the multipath header constant. If
   PathCount is greater than 1, the node has to replicate PathCount
   copies of the packet and distributes them to multiple paths.
   Repeating step 2 and 3, and in step 2, P is equal to PathCount. In
   step 3, the new multipath header is not added, the SequenceNumber of
   the packet is unchanged, and the path number field is filled with
   the new corresponding number of copies.

     5) When a destination node receives a packet containing the
   multipath header, it can distinguish whether the packet has been
   received according to the source address and the packet sequence



 Pu, et al.              Expires March 11, 2018                [Page 6]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2017


   number in the multipath header. If the destination node has not
   received the packet before, the node forwards the packet to its
   upper layer protocol directly. Otherwise, the node discards the
   packet [I-D.ietf-detnet-architecture], [I-D.ietf-detnet-problem-
   statement].

6. Security Considerations

   This document does not add any new security considerations beyond
   what the referenced technologies already have.

7. IANA Considerations

   This document creates an IANA registry for 6LoWPAN Multipath Header
   Type, and assigns the following dispatch type values:

   11101000: for 6LoWPAN Multipath Header Type.

8. References

8.1. Normative References

[RFC6550]  Winter, T., Ed., Thubert, P., Ed., Brandt, A., Hui, J.,
           Kelsey, R., Levis, P., Pister, K., Struik, R., Vasseur, JP.,
           and R. Alexander, "RPL: IPv6 Routing Protocol for Low-Power
           and Lossy Networks", RFC 6550, March 2012,
           <http://www.rfc-editor.org/info/rfc6550>.

[RFC4944]  Montenegro, G., Kushalnagar, N., Hui, J., and D. Culler,
           "Transmission of IPv6 Packets over IEEE 802.15.4 Networks",
           RFC 4944, September 2007,
           <http://www.rfc-editor.org/info/rfc4944>.

[RFC6551]  Vasseur, JP., Ed., Kim, M., Ed., Pister, K., Dejean, N., and
           D. Barthel, "Routing Metrics Used for Path Calculation in
           Low-Power and Lossy Networks", RFC 6551, March 2012,
           <http://www.rfc-editor.org/info/rfc6551>.

[RFC6552]  Thubert, P., Ed., "Objective Function Zero for the Routing
           Protocol for Low-Power and Lossy Networks (RPL)", RFC 6552,
           March 2012, <http://www.rfc-editor.org/info/rfc6552>.








 Pu, et al.              Expires March 11, 2018                [Page 7]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2017


8.2. Informative References

 [I-D.ietf-detnet-architecture]
           Finn, N. and P. Thubert, "Deterministic Networking
           Architecture", draft-ietf-detnet-architecture-03 (work in
           progress), August 2017.

 [I-D.ietf-detnet-problem-statement]
           Finn, N. and P. Thubert, "Deterministic Networking Problem
           Statement", draft-ietf-detnet-problem-statement-01 (work in
           progress), September 2016.





































 Pu, et al.              Expires March 11, 2018                [Page 8]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2017


Authors' Addresses

   Chenggen Pu
   Chongqing University of Posts and Telecommunications
   2 Chongwen Road
   Chongqing, 400065
   China

   Phone: (86)-23-6246-1061
   Email: mentospcg@163.com

   Yadong Wang
   Chongqing University of Posts and Telecommunications
   2 Chongwen Road
   Chongqing, 400065
   China

   Phone: (86)-23-6246-1061
   Email: 13618266302@163.com

   Heng Wang
   Chongqing University of Posts and Telecommunications
   2 Chongwen Road
   Chongqing, 400065
   China

   Phone: (86)-23-6248-7845
   Email: wangheng@cqupt.edu.cn

   Yi Yang
   Chongqing University of Posts and Telecommunications
   2 Chongwen Road
   Chongqing, 400065
   China

   Phone: (86)-23-6246-1061
   Email: 15023705316@163.com

   Ping Wang
   Chongqing University of Posts and Telecommunications
   2 Chongwen Road
   Chongqing, 400065
   China

   Phone: (86)-23-6246-1061
   Email: wangping@cqupt.edu.cn



 Pu, et al.              Expires March 11, 2018                [Page 9]

