command-def      = command-name "::=" diameter-message

diameter-name    = ALPHA *(ALPHA / DIGIT / "-")

command-name     = diameter-name
                          ; The command-name has to be Command name,
                          ; defined in the base or extended Diameter
                          ; specifications.

diameter-message = header  [ *fixed] [ *required] [ *optional] [ *fixed]

header           = "<Diameter-Header:" command-id ">"

fixed            = [qual] "<" avp-spec ">"

required         = [qual] "{" avp-spec "}"

optional         = [qual] "[" avp-name "]"
                          ; The avp-name in the 'optional' rule cannot
                          ; evaluate to any AVP Name which is included
                          ; in a fixed or required rule.

qual             = [min] "*" [max]
                          ; See ABNF conventions, RFC 2234 section 3.6.
                          ; The absence of any qualifiers implies that one
                          ; and only one such AVP MUST be present.
                          ;
                          ; NOTE:  "[" and "]" have a different meaning
                          ; than in ABNF (see the optional rule, above).
                          ; These braces cannot be used to express an
                          ; optional fixed rules (such as an optional
                          ; ICV at the end.)  To do this, the convention
                          ; is '0*1fixed'.

min              = 1*DIGIT
                          ; The minimum number of times the element may
                          ; be present.

max              = 1*DIGIT
                          ; The maximum number of times the element may
                          ; be present.

avp-spec         = diameter-name
                          ; The avp-spec has to be an AVP Name, defined
                          ; in the base or extended Diameter
                          ; specifications.

avp-name         = avp-spec | "AVP"
                          ; The string "AVP" stands for *any* arbitrary
                          ; AVP Name, which does not conflict with the
                          ; required or fixed position AVPs defined in
                          ; the command code definition.

example-avp-val = Host-Name Host-IP-Address
Host-Name       = ; See Section 2.4.1
Host-IP-Address = ; See Section 2.6.4

Host-IP-Address = "10.10.10.10" would be encoded as follows:

          0       1       2       3       4       5       6       7
      +-------+-------+-------+-------+-------+-------+-------+-------+
    0 |     Example AVP Header (AVP Code = 999999), Length = 40       |
      +-------+-------+-------+-------+-------+-------+-------+-------+
    8 |      Host-Name AVP Header (AVP Code = 265), Length = 19       |
      +-------+-------+-------+-------+-------+-------+-------+-------+
Redirect-Host   = Redirect-Host-Address Redirect-Host-Port
Redirect-Host-Address = ; See Section 6.3.2
Redirect-Host-Port    = ; See Section 6.3.3

Proxy-State   = Proxy-Address Proxy-Info
Proxy-Address = ; See Section 6.4.5
Proxy-Info    = ; See Section 6.4.6

Integrity-Check-Value = Nonce Time Auth-Trans-Id Key-ID Digest
Nonce           = ; Nonce, See Section 7.2
Timestamp       = ; Timestamp, See Section 7.3
Auth-Trans-Id   = ; Authentication-Transform-Id, /
                           ; See Section 7.1.1.1
Key-ID          = ; Key-ID, See Section 7.4
Digest          = ; Digest, See Section 7.1.1.2
Encrypted-Payload = Enc-Trans-Id Key-ID ptextlen data
Enc-Trans-Id    = ; Encryption-Transform-Id, /
                           ; See Section 7.1.2.1
Key-ID          = ; See Section 7.4
ptextlen        = ; Plaintext-Data-Length, See Section 7.1.2.2
data            = ; Encrypted-Data, See Section 7.1.2.3

template-type=service:diameter

template-version=0.0

template-description=
     The Diameter protocol is defined by draft-calhoun-diameter-18.txt

template-url-syntax=
url-path= ; The standard service URL syntax is used.
               ; For example: 'service:diameter://aaa.example.com:1812
supported-extensions= string L M
supported-transports= string L M
