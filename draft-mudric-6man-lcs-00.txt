



6MAN Working Group                                             D. Mudric
Internet-Draft                                                     Ciena
Updates: RFC5014, RFC6724 (if approved)                      A. Petrescu
Intended status: Standards Track                               CEA, LIST
Expires: February 19, 2021                               August 18, 2020


                   Least-Common Scope Communications
                        draft-mudric-6man-lcs-00

Abstract

   This draft formulates a security problem statement.  The problem
   arises when a Host uses its Global Unicast Address (GUA) to
   communicate with another Host situated on the same link.

   To address this problem, we suggest to select and use addresses of a
   least scope that are common.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on February 19, 2021.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of



Mudric & Petrescu       Expires February 19, 2021               [Page 1]

Internet-Draft             Least Common Scope                August 2020


   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Problem Statement . . . . . . . . . . . . . . . . . . . . . .   2
   3.  Least Common Scope Communications . . . . . . . . . . . . . .   3
   4.  LL Address Resolution . . . . . . . . . . . . . . . . . . . .   3
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .   4
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   4
   7.  Contributors  . . . . . . . . . . . . . . . . . . . . . . . .   4
   8.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   4
   9.  Normative References  . . . . . . . . . . . . . . . . . . . .   4
   Appendix A.  ChangeLog  . . . . . . . . . . . . . . . . . . . . .   4
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   4

1.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

2.  Problem Statement

   Sockets listening on a global addresses are exposed to attacks.
   RFC6724 Rule 8 selects a candidate address with the smallest scope.
   Applications don't always have LL candidate address.  They usually
   have a GUA address.  If GUA is on a local link, an application will
   open a socket using GUA.  To avoid using GUA on the local link, a
   sender needs to find a destination LL address.  Currently SASA
   algorithm (RFC 6724 "Default Address Selection for Internet Protocol
   Version 6 (IPv6)") cannot use the smallest common scope, given
   destination GUA.

   For security reasons, hosts should use an address with the smallest
   scope.  To avoid these attacks, the host should use LL or ULA
   addresses.

   These security reasons, in more detail, are described next.  There is
   a security problem when a Host uses (one of) its Global Unicast
   Address(es) (GUA) to communicate to another Host situated on the same
   link.  The problem appears even if that second Host uses its link-
   local address (LL) for this communication.

   The problem is that the Host that uses the GUA to actively
   communicate with another Host situated on the same link opens a
   globally reachable entry point in its operating system kernel.  This



Mudric & Petrescu       Expires February 19, 2021               [Page 2]

Internet-Draft             Least Common Scope                August 2020


   entry point appears when the GUA is assigned to a socket structure.
   Were that address be a LL, and not a GUA, that entry would not be
   globally reachable.

   To realize communications between Hosts on the same link, it is
   sufficient to rather use LL addresses on both Hosts.

   When a Host uses a GUA to communicate to another Host situated on the
   same link, it unnecessarily becomes an easy attack target.  The
   attacker might be situated anywhere in the Internet (globally).

3.  Least Common Scope Communications

   It is recommended that a Host that needs to communicate with another
   Host that is situated in a particular scope, to use addresses of same
   scope, or of the least common scope.

   For example, two Hosts situated on the same link should ideally use
   LL addresses to communicate to each other.  An interpretation
   suggests that, given GUA and ULA, a least common 'scope' is the ULA
   scope (even though, formally, both ULA and GUA are of same global
   scope).  But the global unicast addresses (GUAs) should not be used
   for two Hosts on the same link: the global scope is unnecessarily
   large; it unnecessarily opens doors to attacks.

4.  LL Address Resolution

   To facilitate LL communication on the local link, given a destination
   GUA or ULA:

   o  SASA needs to check if a destination is ON-LINK

   o  for ON-LINK destination, a host needs to resolve the GUA or ULA
      destination address into a destination host LL address,

   o  a socket needs to open a port for the source LL address, and

   o  send packets to the destination LL address.

   If both GUA and ULA destinations are known, and ULA destination is
   not on the link, SASA SHOULD use ULA address.

   The document RFC 6724 [RFC6724] SASA needs to be updated to check ON-
   LINK status.  The request for comments number 5014 [RFC5014], which
   treats about socket APIs, needs to be updated to use the given
   destination GUA or ULA addresses for ON-LINK determination, prior to
   SASA address selection; it also needs to be be updated to specify to
   send packets using LL address while talking to ON-LINK destinations.



Mudric & Petrescu       Expires February 19, 2021               [Page 3]

Internet-Draft             Least Common Scope                August 2020


5.  Security Considerations

   Security

6.  IANA Considerations

   IANA

7.  Contributors

   Contributors.

8.  Acknowledgements

   Acks.

9.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC5014]  Nordmark, E., Chakrabarti, S., and J. Laganier, "IPv6
              Socket API for Source Address Selection", RFC 5014,
              DOI 10.17487/RFC5014, September 2007,
              <https://www.rfc-editor.org/info/rfc5014>.

   [RFC6724]  Thaler, D., Ed., Draves, R., Matsumoto, A., and T. Chown,
              "Default Address Selection for Internet Protocol Version 6
              (IPv6)", RFC 6724, DOI 10.17487/RFC6724, September 2012,
              <https://www.rfc-editor.org/info/rfc6724>.

Appendix A.  ChangeLog

   The changes are listed in reverse chronological order, most recent
   changes appearing at the top of the list.

   -00: initial version, with Dusan's comments.

Authors' Addresses










Mudric & Petrescu       Expires February 19, 2021               [Page 4]

Internet-Draft             Least Common Scope                August 2020


   Dusan Mudric
   Ciena



             ,



               Canada


   Phone:
             +1-613-670-2425

   Email:
             dmudric@ciena.com


   Alexandre Petrescu
   CEA, LIST

               CEA Saclay


               Gif-sur-Yvette
             ,
               Ile-de-France

               91190


               France


   Phone:
             +33169089223

   Email:
             Alexandre.Petrescu@cea.fr











Mudric & Petrescu       Expires February 19, 2021               [Page 5]
