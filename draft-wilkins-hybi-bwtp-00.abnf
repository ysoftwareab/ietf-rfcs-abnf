BWTP-Version   = "BWTP" "/" 1*DIGIT "." 1*DIGIT

media-type     = type "/" subtype *( ";" parameter )
type           = token
subtype        = token


BWTP-Frame   = Start-Line  CRLF
                            Frame-Body

Start-Line   = Frame-Type  SP
                            Channel-ID  SP
                            Frame-Size [ '/' Message-Size ]
                            *(SP Frame-Field)

Frame-Body   = *OCTECT

Frame-Type   = "BWH" | "BWM"

Channel-ID   = "*" | 1*DIGIT

Frame-Size   = 1*DIGIT

Message-Size = "*" | 1*DIGIT

Frame-Field  = token

Header-Frame     = Header-Line CRLF
                                Header-Body

Header-Line      = "BWH" SP
                              Channel-ID SP
                              Frame-Size SP
                              Header-Fields
                              URI

Header-Fields    = "OPEN" URI
                              | "OPENED"
                              | "MESSAGE"
                              | "CLOSE"
                              | "CLOSED"
                              | *(SP Frame-Field)

Header-Body    = *( Message-Header CRLF )

Message-Header = Field-Name ":" [ Field-Value ]

Field-Name     = Content-Header
                              | token

Field-Value    = *( Field-Content | LWS )

Field-Content  = <the OCTETs making up the field-value
                              and consisting of either *TEXT or
                              combinations of token, separators,
                              and quoted-string>

Message-Frame   = Message-Line CRLF
                               Frame-Body [CRLF]

Message-Line    = "BWM" SP
                               Channel-ID SP
                               Frame-Size [ '/' Message-Size ]

Frame-Body      = *OCTECT

BWTP-Message  = [Message-Header-Frame] Message-Frame *Message-Frame

Message-Header-Frame = <Header-Frame conforming to 4.1.1>

BWTP-Channel-Opener = Open-Header-Frame
                           *( BWTP-Message | Header-Frame )
                           [Closed-Header-Frame]

Open-Header-Frame   = <Header-Frame conforming to 4.1.1>
Closed-Header-Frame = <Header-Frame conforming to 4.1.5>


BWTP-Channel        = [Origin-Header-Frame]
                           *( BWTP-Message | Header-Frame )
                           [Closed-Header-Frame]

Origin-Header-Frame = <Header-Frame conforming to 4.1.2>


BWTP-Connection     = *( *CRLF BWTP-Frame )
BWTP-Upgrade-Request = "GET" SP URI SP "HTTP/1.1" CRLF
                                  *(message-header CRLF)
                                  "Upgrade" ":" BWTP-Version
                                  *(message-header CRLF)
                                  CRLF
                                  [ message-body ]


BWTP-Upgrade-Response = "HTTP/1.1" SP 101 SP "BWTP/1.0" CRLF
                           *(message-header CRLF)
                           "Upgrade" ":" BWTP-Version
                           *(message-header CRLF)
                           CRLF


Content-Header = "Content-Encoding"
                            | "Content-Language"
                            | "Content-Location"
                            | "Content-MD5"
                            | "Content-Origin"
                            | "Content-Type"
                         | "Access-Control-Allow-Origin"
                         | Token



