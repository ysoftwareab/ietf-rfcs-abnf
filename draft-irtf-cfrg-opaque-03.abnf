response = CreateCredentialResponse(request, server_public_key, credential_file)

                               response
                      <-------------------------

server_mac_key =
     HKDF-Expand-Label(handshake_secret, "server mac", "", Nh)
client_mac_key =
     HKDF-Expand-Label(handshake_secret, "client mac", "", Nh)
handshake_encrypt_key =
     HKDF-Expand-Label(handshake_secret, "handshake enc", "", Nh)

preamble = concat("3DH",
                     I2OSP(len(client_identity), 2), client_identity,
                     KE1,
                     I2OSP(len(server_identity), 2), server_identity,
                     KE2.inner_ke2)
IKM = concat(epkS^eskU, pkS^eskU, epkS^skU)

IKM = concat(epkU^eskS, epkU^skS, pkU^eskS)

info_pad = HKDF-Expand(Ke2, "encryption pad", len(server_info))
enc_server_info = xor(info_pad, server_info)

client_identity = client_public_key and server_identity =
preamble = concat("HMQV",
                     I2OSP(len(client_identity), 2), client_identity,
                     KE1,
                     I2OSP(len(server_identity), 2), server_identity,
                     KE2.inner_ke2)
IKM = (epkS \* pkS^s)^u'

IKM = (epkU \* pkU^u)^s'

hashInput = concat(I2OSP(len(epkU), 2), epkU,
                      I2OSP(len(info), 2), info,
                      I2OSP(len("client"), 2), "client")
u = Hash(hashInput) mod L

hashInput = concat(I2OSP(len(epkS), 2), epkS,
                      I2OSP(len(info), 2), info,
                      I2OSP(len("server"), 2), "server")
s = Hash(hashInput) mod L

