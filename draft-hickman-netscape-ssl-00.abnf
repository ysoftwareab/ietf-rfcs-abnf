RECORD-LENGTH = ((byte[0] & 0x7f) << 8)) | byte[1];

RECORD-LENGTH = ((byte[0] & 0x3f) << 8)) | byte[1];
IS-ESCAPE = (byte[0] & 0x40) != 0;
PADDING = byte[2];

MAC-DATA = HASH[ SECRET, ACTUAL-DATA, PADDING-DATA,
KEY-MATERIAL-0 = MD5[ MASTER-KEY, "0", CHALLENGE, 
KEY-MATERIAL-1 = MD5[ MASTER-KEY, "1", CHALLENGE, 
CLIENT-READ-KEY = KEY-MATERIAL-0[0-15]
CLIENT-WRITE-KEY = KEY-MATERIAL-1[0-15]

KEY-MATERIAL-0 = MD5[ MASTER-KEY, CHALLENGE, 
CLIENT-READ-KEY = KEY-MATERIAL-0[0-7]
CLIENT-WRITE-KEY = KEY-MATERIAL-0[8-15]

KEY-MATERIAL-0 = MD5[ MASTER-KEY, "0", CHALLENGE, 
KEY-MATERIAL-1 = MD5[ MASTER-KEY, "1", CHALLENGE, 
KEY-MATERIAL-2 = MD5[ MASTER-KEY, "2", CHALLENGE, 
CLIENT-READ-KEY-0 = KEY-MATERIAL-0[0-7]
CLIENT-READ-KEY-1 = KEY-MATERIAL-0[8-15]
CLIENT-READ-KEY-2 = KEY-MATERIAL-1[0-7]
CLIENT-WRITE-KEY-0 = KEY-MATERIAL-1[8-15]
CLIENT-WRITE-KEY-1 = KEY-MATERIAL-2[0-7]
CLIENT-WRITE-KEY-2 = KEY-MATERIAL-2[8-15]

SERVER-READ-KEY = CLIENT-WRITE-KEY
SERVER-WRITE-KEY = CLIENT-READ-KEY

