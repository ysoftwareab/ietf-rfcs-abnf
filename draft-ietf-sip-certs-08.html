<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Certificate Management Service for The
    Session Initiation Protocol (SIP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Certificate Management Service for The
    Session Initiation Protocol (SIP)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">C. Jennings</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">J. Fischl, Ed.</td></tr>
<tr><td class="header">Expires: January 14, 2010</td><td class="header">Skype</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 13, 2009</td></tr>
</table></td></tr></table>
<h1><br />Certificate Management Service for The
    Session Initiation Protocol (SIP)<br />draft-ietf-sip-certs-08</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 14, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This draft defines a Credential Service that allows Session
      Initiation Protocol (SIP) User Agents (UAs) to use a SIP event package
      to discover the certificates of other users. This mechanism allows user
      agents that want to contact a given Address-of-Record (AOR) to retrieve
      that AOR's certificate by subscribing to the Credential Service, which
      returns an authenticated response containing that certificate. The
      Credential Service also allows users to store and retrieve their own
      certificates and private keys.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Definitions<br />
<a href="#anchor3">3.</a>&nbsp;
Overview<br />
<a href="#anchor4">4.</a>&nbsp;
UA Behavior with Certificates<br />
<a href="#ua.cred">5.</a>&nbsp;
UA Behavior with Credentials<br />
<a href="#certificate">6.</a>&nbsp;
Event Package Formal Definition for &quot;certificate&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">6.1.</a>&nbsp;
Event Package Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">6.2.</a>&nbsp;
Event Package Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">6.3.</a>&nbsp;
SUBSCRIBE Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">6.4.</a>&nbsp;
Subscription Duration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">6.5.</a>&nbsp;
NOTIFY Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#gen.sub">6.6.</a>&nbsp;
Subscriber Generation of SUBSCRIBE Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">6.7.</a>&nbsp;
Notifier Processing of SUBSCRIBE Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">6.8.</a>&nbsp;
Notifier Generation of NOTIFY Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">6.9.</a>&nbsp;
Subscriber Processing of NOTIFY Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">6.10.</a>&nbsp;
Handling of Forked Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">6.11.</a>&nbsp;
Rate of Notifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">6.12.</a>&nbsp;
State Agents and Lists<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#proxy">6.13.</a>&nbsp;
Behavior of a Proxy Server<br />
<a href="#credential">7.</a>&nbsp;
Event Package Formal Definition for &quot;credential&quot; <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">7.1.</a>&nbsp;
Event Package Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#package-params">7.2.</a>&nbsp;
Event Package Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">7.3.</a>&nbsp;
SUBSCRIBE Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">7.4.</a>&nbsp;
Subscription Duration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">7.5.</a>&nbsp;
NOTIFY Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#subscriber.behavior">7.6.</a>&nbsp;
Subscriber Generation of SUBSCRIBE Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#notifier.subscribe.behavior">7.7.</a>&nbsp;
Notifier Processing of SUBSCRIBE Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">7.8.</a>&nbsp;
Notifier Generation of NOTIFY Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#gen.pub">7.9.</a>&nbsp;
Generation of PUBLISH Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#notifier.publish.behavior">7.10.</a>&nbsp;
Notifier Processing of PUBLISH Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">7.11.</a>&nbsp;
Subscriber Processing of NOTIFY Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">7.12.</a>&nbsp;
Handling of Forked Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">7.13.</a>&nbsp;
Rate of Notifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">7.14.</a>&nbsp;
State Agents and Lists<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">7.15.</a>&nbsp;
Behavior of a Proxy Server<br />
<a href="#anchor26">8.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">8.1.</a>&nbsp;
Encrypted Page Mode IM Message <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">8.2.</a>&nbsp;
Setting and Retrieving UA Credentials<br />
<a href="#anchor29">9.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.revocation">9.1.</a>&nbsp;
Certificate Revocation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#section.replacement">9.2.</a>&nbsp;
Certificate Replacement<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#trust">9.3.</a>&nbsp;
Trusting the Identity of a Certificate<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">9.4.</a>&nbsp;
SACRED Framework<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">9.5.</a>&nbsp;
Crypto Profiles<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#cert.gen">9.6.</a>&nbsp;
User Certificate Generation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">9.7.</a>&nbsp;
Compromised Authentication Service<br />
<a href="#anchor33">10.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">10.1.</a>&nbsp;
Certificate Event Package<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">10.2.</a>&nbsp;
Credential Event Package<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">10.3.</a>&nbsp;
PKCS#8<br />
<a href="#anchor37">11.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informational References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p><a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>, as ammended by <a class='info' href='#RFC3853'>[RFC3853]<span> (</span><span class='info'>Peterson, J., &ldquo;S/MIME Advanced Encryption Standard (AES) Requirement for the Session Initiation Protocol (SIP),&rdquo; July&nbsp;2004.</span><span>)</span></a>, provides a mechanism for end-to-end encryption
      and integrity using <a class='info' href='#RFC3851'>S/MIME<span> (</span><span class='info'>Ramsdell, B., &ldquo;Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification,&rdquo; July&nbsp;2004.</span><span>)</span></a> [RFC3851]. Several
      security properties of <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> depend on S/MIME,
      and yet it has not been widely deployed. One reason is the complexity of
      providing a reasonable certificate distribution infrastructure. This
      specification proposes a way to address discovery, retrieval, and
      management of certificates for SIP deployments. Combined with the <a class='info' href='#RFC4474'>SIP Identity<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4474] specification, this specification
      allows users to have certificates that are not signed by any well known
      certificate authority while still strongly binding the user's identity
      to the certificate.
</p>
<p>In addition, this specification provides a mechanism that allows SIP
      User Agents such as IP phones to enroll and get their credentials
      without any more configuration information than they commonly have
      today. The end user expends no extra effort.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Definitions</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Certificate:</dt>
<dd>A <a class='info' href='#RFC5280'>PKIX<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> [RFC5280]
          style certificate containing a public key and a list of identities
          in the SubjectAltName that are bound to this key. The certificates
          discussed in this draft are generally self signed and use the
          mechanisms in the <a class='info' href='#RFC4474'>SIP Identity<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4474]
          specification to vouch for their validity. Certificates that are
          signed by a certificate authority can also be used with all the
          mechanisms in this draft, but it is expected that they are used
          purely as a key carrier and that their validity is not checked.
</dd>
<dt>Credential:</dt>
<dd>For this document, credential means the
          combination of a certificate and the associated private key.
</dd>
<dt>Password Phrase:</dt>
<dd>A password used to encrypt a PKCS#8
          private key.
</dd>
</dl></blockquote>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Overview</h3>

<p>The general approach is to provide a new SIP service referred to as a
      "credential service" that allows SIP User Agents (UAs) to subscribe to
      other users' certificates using a new <a class='info' href='#RFC3265'>SIP event
      package<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3265]. The certificate is delivered to the subscribing UA in a
      corresponding SIP NOTIFY request. An Authentication Service as described
      in the <a class='info' href='#RFC4474'>SIP Identity<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4474] specification can be
      used to vouch for the identity of the sender of the certificate by using
      the sender's proxy domain certificate to sign the NOTIFY request. The
      Authentication Service is vouching that the sender is allowed to
      populate the SIP From header field value. The sender of the message is
      vouching that this is an appropriate certificate for the user identified
      in the SIP from header field value. The credential service can manage
      public certificates as well as the user's private keys. Users can update
      their credentials, as stored on the credential service, using a SIP
      <a class='info' href='#RFC3903'>PUBLISH<span> (</span><span class='info'>Niemi, A., &ldquo;Session Initiation Protocol (SIP) Extension for Event State Publication,&rdquo; October&nbsp;2004.</span><span>)</span></a> [RFC3903] request. The UA authenticates to
      the credential service using a shared secret when a UA is updating a
      credential. Typically the shared secret will be the same one that is
      used by the UA to authenticate a REGISTER request with the Registrar for
      the domain (usually with SIP Digest Authentication).
</p>
<p>The following figure shows Bob publishing his credentials from one of
      his User Agents (e.g. his laptop software client), retrieving his
      credentials from another of his User Agents (e.g. his mobile phone), and
      then Alice retrieving Bob's certificate and sending a message to Bob.
      SIP 200-class responses are omitted from the diagram to make the figure
      easier to understand.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
             example.com domain
             ------------------
 Alice       Proxy  Auth   Cred               Bob1  Bob2
   |           |      |      | TLS Handshake    |    |
   |  [ Bob generates   ]    |&lt;---------------------&gt;|
   |  [ credentials and ]    | PUBLISH (credential)  |
   |  [ publishes them  ]    |&lt;----------------------|
   |           |      |      | Digest Challenge      |
   |           |      |      |----------------------&gt;|
   |           |      |      | PUBLISH + Digest      |
   |           |      |      |&lt;----------------------|
   |           |      |      |                  |
   |           |      |      | time passes...   |
   |           |      |      |                  |
   |           |      |      | TLS Handshake    |
   |   [ Bob later gets ]    |&lt;----------------&gt;|
   |   [ back his own   ]    | SUBSCRIBE        |
   |   [ credentials    ]    | (credential)     |
   |   [ at another     ]    |&lt;-----------------|
   |   [ User Agent     ]    | SUBSCRIBE+Digest |
   |           |      |      |&lt;-----------------|
   |           |      |      | NOTIFY           |
   |           |      |      |-----------------&gt;|
   |           |      |      | Bob Decrypts key |
   |           |      |      |                  |
   |           |      |      |                  |
   | SUBSCRIBE (certificate) |    Alice fetches |
   |----------&gt;|-----&gt;|-----&gt;|    Bob's cert    |
   |           |      |NOTIFY|                  |
   | NOTIFY+Identity  |&lt;-----|                  |
   |&lt;----------+------|      |  Alice uses cert |
   |           |      |      |  to encrypt      |
   | MESSAGE   |      |      |  message to Bob  |
   |----------&gt;|------+------+-----------------&gt;|
</pre></div>
<p>Bob's UA (Bob2) does a <a class='info' href='#RFC5246'>TLS<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246] handshake
      with the credential server to authenticate that the UA is connected to
      the correct credential server. Then Bob's UA publishes his newly created
      or updated credentials. The credential server digest challenges the UA
      to authenticate that the UA knows Bob's shared secret. Once the UA is
      authenticated, the credential server stores Bob's credentials.
</p>
<p>Another of Bob's User Agents (Bob1) wants to fetch its current
      credentials. It does a <a class='info' href='#RFC5246'>TLS<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246] handshake with
      the credential server to authenticate that the UA is connected to the
      correct credential server. Then Bob's UA subscribes for the credentials.
      The credential server digest challenges the UA to authenticate that the
      UA knows Bob's shared secret. Once the UA is authenticated, the
      credential server sends a NOTIFY that contains Bob's credentials. The
      private key portion of the credential may have been encrypted with a
      secret that only Bob's UA (and not the credential server) knows. In this
      case, once Bob's UA decrypts the private key it will be ready to go.
      Typically Bob's UA would do this when it first registered on the
      network.
</p>
<p>Some time later Alice decides that she wishes to discover Bob's
      certificate so that she can send him an encrypted message or so that she
      can verify the signature on a message from Bob. Alice's UA sends a
      SUBSCRIBE message to Bob's AOR. The proxy in Bob's domain routes this to
      the credential server via an "authentication service" as defined in
      <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>. The credential server returns a NOTIFY
      that contains Bob's public certificate in the body. This is routed
      through an authentication service that signs that this message really
      can validly claim to be from the AOR "sip:bob@example.com". Alice's UA
      receives the certificate and can use it to encrypt a message to Bob.
</p>
<p>It is critical to understand that the only way that Alice can trust
      that the certificate really is the one for Bob and that the NOTIFY has
      not been spoofed is for Alice to check that the <a class='info' href='#RFC4474'>Identity<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4474] header field value is correct.
</p>
<p>The mechanism described in this document works for both self signed
      certificates and certificates signed by well known certificate
      authorities. In order to deploy certificates signed by well known
      certificate authorities, certificate authorities would have to support
      adding SIP URIs to the subjectAltName of the certificates they generate.
      This is something which has been rarely implemented by commercial
      certificate authorities. However, most UAs would only use self signed
      certificates and would use an Authentication Service as described in
      <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> to provide a strong binding of an AOR to
      the certificates.
</p>
<p>The mechanisms described in this draft allow for three different
      styles of deployment:
</p>
<p></p>
<ol class="text">
<li>Deployments where the credential server only stores certificates
          and does not store any private key information. If the deployment
          had users with multiple devices, some other scheme (perhaps even
          manual provisioning) would be used to get the right private keys
          onto all the devices that a user uses.
</li>
<li>Deployments where the credential server stores certificates and
          also stores an encrypted version of the private keys. The credential
          server would not know or need the password phrase for decrypting the
          private key. The credential server would help move the private keys
          between devices but the user would need to enter a password phrase
          on each device to allow that device to decrypt (and encrypt) the
          private key information.
</li>
<li>Deployments where the credential server generates and stores the
          certificates and private keys. Deployments such as these may not use
          password phrases. Consequently, the private keys are not encrypted
          inside the PKCS#8 objects.  This style of deployment would often have
          the credential server, instead of the devices, create the
          credentials.
</li>
</ol>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
UA Behavior with Certificates</h3>

<p>When a User Agent wishes to discover some other user's certificate it
      subscribes to the "certificate" SIP event package as described in <a class='info' href='#certificate'>Section&nbsp;6<span> (</span><span class='info'>Event Package Formal Definition for &quot;certificate&quot;</span><span>)</span></a> to get the certificate. While the
      subscription is active, if the certificate is updated, the Subscriber
      will receive the updated certificate in a notification.
</p>
<p>The Subscriber needs to decide how long it is willing to trust that
      the certificate it receives is still valid. If the certificate is
      revoked before it expires, the Notifier will send a notification with an
      empty body to indicate that the certificate is no longer valid. If the
      certificate is renewed before it expires, the Notifier will send a
      notification with a body containing the new certificate. Note that the
      Subscriber might not receive the notification if an attacker blocks this
      traffic. The amount of time that the Subscriber caches a certificate
      SHOULD be configurable. A default of one day is RECOMMENDED.
</p>
<p>Note that the actual duration of the subscription is unrelated to the
      caching time or validity time of the corresponding certificate. Allowing
      subscriptions to persist after a certificate is no longer valid ensures
      that Subscribers receive the replacement certificate in a timely
      fashion. The Notifier could return an immediate notification with the
      certificate in response to subscribe and then immediately terminate
      subscription, setting the reason parameter to "probation". The
      Subscriber will have to periodically poll the Notifier to verify
      validity of the certificate.
</p>
<p>If the UA uses a cached certificate in a request and receives a 437
      (Unsupported Certificate) response, it SHOULD remove the certificate it
      used from the cache, attempt to fetch the certificate again. If the
      certificate is changed, then the UA SHOULD retry the original request
      again with the new certificate. This situation usually indicates that
      the certificate was recently updated, and that the Subscriber has not
      received a corresponding notification. If the certificate fetched is the
      same as the one that was previously in the cache, then the UA SHOULD NOT
      try the request again. This situation can happened when the request was
      retargeted to a different user than the original request. The 437
      response is defined in <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>.
</p>
<p></p>
<blockquote class="text">
<p>Note: A UA that has a presence list MAY want to subscribe to the
          certificates of all the presentities in the list when the UA
          subscribes to their presence, so that when the user wishes to
          contact a presentity, the UA will already have the appropriate
          certificate. Future specifications might consider the possibility of
          retrieving the certificates along with the presence documents.
</p>
</blockquote>

<p>The details of how a UA deals with receiving encrypted messages is
      outside the scope of this specification. It is worth noting that if
      Charlie's UAS receives a request that is encrypted to Bob, it would be
      valid and legal for that UA to send a 302 redirecting the call to
      Bob.
</p>
<a name="ua.cred"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
UA Behavior with Credentials</h3>

<p>UAs discover their own credentials by subscribing to their AOR with
      an event type of credential as described in <a class='info' href='#credential'>Section&nbsp;7<span> (</span><span class='info'>Event Package Formal Definition for &quot;credential&quot; </span><span>)</span></a>. After a UA registers, it SHOULD retrieve
      its credentials by subscribing to them as described in <a class='info' href='#gen.sub'>Section&nbsp;6.6<span> (</span><span class='info'>Subscriber Generation of SUBSCRIBE Requests</span><span>)</span></a>.
</p>
<p>When a UA discovers its credential, the private key information might
      be encrypted with a password phrase. The UA SHOULD request that the user
      enter the password phrase on the device, and the UA MAY cache this
      password phrase for future use.
</p>
<p>There are several different cases in which a UA should generate a new
      credential: </p>
<ul class="text">
<li>If the UA receives a NOTIFY with no body for the credential
          package.
</li>
<li>If the certificate has expired.
</li>
<li>If the certificate's notAfter date is within the next 600
          seconds, the UA SHOULD attempt to create replacement credentials.
          The UA does this by waiting a random amount of time between 0 and
          300 seconds. If no new credentials have been received in that time,
          the UA creates new credentials to replace the expiring ones and
          sends them in a PUBLISH request (with a SIP-If-Match header field
          set to the current etag). This makes credential collisions both
          unlikely and harmless.
</li>
<li>If the user of the device has indicated via the user interface
          that they wish to revoke the current certificate and issue a new
          one.
</li>
</ul><p> Credentials are created by creating a new key pair which will
      require appropriate randomness, and then creating a certificate as
      described in <a class='info' href='#cert.gen'>Section&nbsp;9.6<span> (</span><span class='info'>User Certificate Generation</span><span>)</span></a>. The UA MAY encrypt the
      private key with a password phrase supplied by the user. Next, the UA
      updates the user's credential by sending a <a class='info' href='#RFC3903'>PUBLISH<span> (</span><span class='info'>Niemi, A., &ldquo;Session Initiation Protocol (SIP) Extension for Event State Publication,&rdquo; October&nbsp;2004.</span><span>)</span></a> [RFC3903] request with the credentials or just the
      certificate as described in <a class='info' href='#gen.pub'>Section&nbsp;7.9<span> (</span><span class='info'>Generation of PUBLISH Requests</span><span>)</span></a>.
</p>
<p>If a UA wishes to revoke the existing certificate without publishing
      a new one, it MUST send a PUBLISH with an empty body to the credential
      server.
</p>
<a name="certificate"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Event Package Formal Definition for &quot;certificate&quot;</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Event Package Name</h3>

<p>This document defines a SIP Event Package as defined in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>. The event-package token name for this
        package is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       certificate
</pre></div>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Event Package Parameters</h3>

<p>This package defines the "etag" Event header parameter which is
        valid only in NOTIFY requests. It contains a token which represents
        the SIP etag value at the time the notification was sent. Considering
        how infrequently credentials are updated, this hint is very likely to
        be the correct etag to use in the SIP-If-Match header in a SIP PUBLISH
        request to update the current credentials.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
          etag-param = "etag" EQUAL token
</pre></div>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
SUBSCRIBE Bodies</h3>

<p>This package does not define any SUBSCRIBE bodies.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Subscription Duration</h3>

<p>Subscriptions to this event package can range from no time to
        weeks. Subscriptions in days are more typical and are RECOMMENDED. The
        default subscription duration for this event package is one day.
</p>
<p>The credential service is encouraged to keep the subscriptions
        active for AORs that are communicating frequently, but the credential
        service MAY terminate the subscription at any point in time.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
NOTIFY Bodies</h3>

<p>The body of a NOTIFY request for this package MUST either be empty
        or contain an application/pkix-cert body (as defined in <a class='info' href='#RFC2585'>[RFC2585]<span> (</span><span class='info'>Housley, R. and P. Hoffman, &ldquo;Internet X.509 Public Key Infrastructure Operational Protocols: FTP and HTTP,&rdquo; May&nbsp;1999.</span><span>)</span></a>) that contains the certificate, unless an
        Accept header field has negotiated some other type. The
        Content-Disposition MUST be set to "signal" as defined in <a class='info' href='#RFC3204'>[RFC3204]<span> (</span><span class='info'>Zimmerer, E., Peterson, J., Vemuri, A., Ong, L., Audet, F., Watson, M., and M. Zonoun, &ldquo;MIME media types for ISUP and QSIG Objects,&rdquo; December&nbsp;2001.</span><span>)</span></a>.
</p>
<p>A future extension MAY define other NOTIFY bodies. If no "Accept"
        header field is present in the SUBSCRIBE, the body type defined in
        this document MUST be assumed.
</p>
<p>Implementations which generate large notifications are reminded to
        follow the message size restrictions for unreliable transports
        articulated in Section 18.1.1 of SIP.
</p>
<a name="gen.sub"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
Subscriber Generation of SUBSCRIBE Requests</h3>

<p>A UA discovers a certificate by sending a SUBSCRIBE request with an
        event type of "certificate" to the AOR for which a certificate is
        desired. In general, the UA stays subscribed to the certificate for as
        long as it plans to use and cache the certificate, so that the UA can
        be notified about changes or revocations to the certificate.
</p>
<p>Subscriber User Agents will typically subscribe to certificate
        information for a period of hours or days, and automatically attempt
        to re-subscribe just before the subscription is completely
        expired.
</p>
<p>When a user de-registers from a device (logoff, power down of a
        mobile device, etc.), subscribers SHOULD unsubscribe by sending a
        SUBSCRIBE request with an Expires header field of zero.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7"></a><h3>6.7.&nbsp;
Notifier Processing of SUBSCRIBE Requests</h3>

<p>When a SIP credential server receives a SUBSCRIBE request with the
        certificate event-type, it is not necessary to authenticate the
        subscription request. The Notifier MAY limit the duration of the
        subscription to an administrator-defined period of time. The duration
        of the subscription does not correspond in any way to the period for
        which the certificate will be valid.
</p>
<p>When the credential server receives a SUBSCRIBE request for a
        certificate, it first checks to see if it has credentials for the
        requested URI. If it does not have a certificate, it returns a NOTIFY
        request with an empty message body.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.8"></a><h3>6.8.&nbsp;
Notifier Generation of NOTIFY Requests</h3>

<p>Immediately after a subscription is accepted, the Notifier MUST
        send a NOTIFY with the current certificate, or an empty body if no
        certificate is available for the target user. In either case it forms
        a NOTIFY with the From header field value set to the value of the To
        header field in the SUBSCRIBE request. This server sending the NOTIFY
        needs either to implement an Authentication Service (as described in
        <a class='info' href='#RFC4474'>SIP Identity<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4474]) or else the server needs
        to be set up such that the NOTIFY request will be sent through an
        Authentication Service. Sending the NOTIFY request through the
        Authentication Service requires the SUBSCRIBE request to have been
        routed through the Authentication Service, since the NOTIFY is sent
        within the dialog formed by the subscription.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.9"></a><h3>6.9.&nbsp;
Subscriber Processing of NOTIFY Requests</h3>

<p>The resulting NOTIFY will contain an application/pkix-cert body
        that contains the requested certificate. The UA MUST follow the
        procedures in <a class='info' href='#trust'>Section&nbsp;9.3<span> (</span><span class='info'>Trusting the Identity of a Certificate</span><span>)</span></a> to decide if the received
        certificate can be used. The UA needs to cache this certificate for
        future use. The maximum length of time it should be cached for is
        discussed in <a class='info' href='#section.revocation'>Section&nbsp;9.1<span> (</span><span class='info'>Certificate Revocation</span><span>)</span></a>. The
        certificate MUST be removed from the cache if the certificate has been
        revoked (if a NOTIFY with an empty body is received), or if it is
        updated by a subsequent NOTIFY. The UA MUST check that the NOTIFY is
        correctly signed by an Authentication Service as described in <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>. If the identity asserted by the
        Authentication Service does not match the AOR that the UA subscribed
        to, the certificate in the NOTIFY is discarded and MUST NOT be
        used.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.10"></a><h3>6.10.&nbsp;
Handling of Forked Requests</h3>

<p>This event package does not permit forked requests. At most one
        subscription to this event type is permitted per resource.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.11"></a><h3>6.11.&nbsp;
Rate of Notifications</h3>

<p>Notifiers SHOULD NOT generate NOTIFY requests more frequently than
        once per minute.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.12"></a><h3>6.12.&nbsp;
State Agents and Lists</h3>

<p>The certificate server described in this section which serves
        certificates is a state agent and implementations of the certificate
        server MUST be implemented as a state agent.
</p>
<p>Implementers MUST NOT use the <a class='info' href='#RFC4662'>event list
        extension<span> (</span><span class='info'>Roach, A., Campbell, B., and J. Rosenberg, &ldquo;A Session Initiation Protocol (SIP) Event Notification Extension for Resource Lists,&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4662] with this event type. It is not possible to make such
        an approach work, because the Authentication service would have to
        simultaneously assert several different identities.
</p>
<a name="proxy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.13"></a><h3>6.13.&nbsp;
Behavior of a Proxy Server</h3>

<p>There are no additional requirements on a SIP Proxy, other than to
        transparently forward the SUBSCRIBE and NOTIFY requests as required in
        SIP. This specification describes the Proxy, Authentication service,
        and credential service as three separate services, but it is certainly
        possible to build a single SIP network element that performs all of
        these services at the same time.
</p>
<a name="credential"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Event Package Formal Definition for &quot;credential&quot; </h3>

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Event Package Name</h3>

<p>This document defines a SIP Event Package as defined in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>. The event-package token name for this
        package is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      credential
</pre></div>
<a name="package-params"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Event Package Parameters</h3>

<p>This package defines the "etag" Event header parameter which is
        valid only in NOTIFY requests. It contains a token which represents
        the SIP etag value at the time the notification was sent. Considering
        how infrequently credentials are updated, this hint is very likely to
        be the correct etag to use in the SIP-If-Match header field in a SIP
        PUBLISH request to update the current credentials.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    etag-param = "etag" EQUAL token
</pre></div>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
SUBSCRIBE Bodies</h3>

<p>This package does not define any SUBSCRIBE bodies.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Subscription Duration</h3>

<p>Subscriptions to this event package can range from hours to one
        week. Subscriptions in days are more typical and are RECOMMENDED. The
        default subscription duration for this event package is one day.
</p>
<p>The credential service SHOULD keep subscriptions active for UAs
        that are currently registered.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
NOTIFY Bodies</h3>

<p>The NOTIFY MUST contain a multipart/mixed (see <a class='info' href='#RFC2046'>[RFC2046]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types,&rdquo; November&nbsp;1996.</span><span>)</span></a>) body that contains both an
        application/pkix-cert body with the certificate and an
        application/pkcs8 body that has the associated private key information
        for the certificate. The Content-Disposition MUST be set to "signal"
        as defined in <a class='info' href='#RFC3204'>[RFC3204]<span> (</span><span class='info'>Zimmerer, E., Peterson, J., Vemuri, A., Ong, L., Audet, F., Watson, M., and M. Zonoun, &ldquo;MIME media types for ISUP and QSIG Objects,&rdquo; December&nbsp;2001.</span><span>)</span></a>.
</p>
<p>A future extension MAY define other NOTIFY bodies. If no "Accept"
        header field is present in the SUBSCRIBE, the body type defined in
        this document MUST be assumed.
</p>
<p>The application/pkix-cert body is a DER encoded X.509v3 certificate
        <a class='info' href='#RFC2585'>[RFC2585]<span> (</span><span class='info'>Housley, R. and P. Hoffman, &ldquo;Internet X.509 Public Key Infrastructure Operational Protocols: FTP and HTTP,&rdquo; May&nbsp;1999.</span><span>)</span></a>. The application/pkcs8 body contains a
        DER-encoded <a class='info' href='#PKCS.8.1993'>PKCS#8<span> (</span><span class='info'>RSA Laboratories, &ldquo;Private-Key Information Syntax Standard, Version 1.2,&rdquo; November&nbsp;1993.</span><span>)</span></a> [PKCS.8.1993] object that
        contains the private key. The PKCS#8 objects MUST be of type
        PrivateKeyInfo. The integrity and confidentiality of the PKCS#8
        objects is provided by the TLS transport. The transport encoding of
        all the MIME bodies is binary.
</p>
<a name="subscriber.behavior"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.6"></a><h3>7.6.&nbsp;
Subscriber Generation of SUBSCRIBE Requests</h3>

<p>A Subscriber User Agent will subscribe to its credential
        information for a period of hours or days and will automatically
        attempt to re-subscribe before the subscription has completely
        expired.
</p>
<p>The Subscriber SHOULD subscribe to its credentials whenever a new
        user becomes associated with the device (a new login). The subscriber
        SHOULD also renew its subscription immediately after a reboot, or when
        the subscriber's network connectivity has just been
        re-established.
</p>
<p>The UA needs to authenticate with the credential service for these
        operations. The UA MUST use TLS to directly connect to the server
        acting as the credential service or to a server that is authoritative
        for the domain of the credential service. The UA MUST NOT connect
        through an intermediate proxy to the credential service. The UA may be
        configured with a specific name for the credential service; otherwise
        normal SIP routing is used. As described in RFC 3261, the TLS
        connection needs to present a certificate that matches the expected
        name of the server to which the connection was formed, so that the UA
        knows it is talking to the correct server. Failing to do this may
        result in the UA publishing its private key information to an
        attacker. The credential service will authenticate the UA using the
        usual SIP Digest mechanism, so the UA can expect to receive a SIP
        challenge to the SUBSCRIBE or PUBLISH requests.
</p>
<a name="notifier.subscribe.behavior"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.7"></a><h3>7.7.&nbsp;
Notifier Processing of SUBSCRIBE Requests</h3>

<p>When a credential service receives a SUBSCRIBE for a credential,
        the credential service has to authenticate and authorize the UA and
        validate that adequate transport security is being used. Only a UA
        that can authenticate as being able to register as the AOR is
        authorized to receive the credentials for that AOR. The credential
        Service MUST digest challenge the UA to authenticate the UA and then
        decide if it is authorized to receive the credentials. If
        authentication is successful, the Notifier MAY limit the duration of
        the subscription to an administrator-defined period of time. The
        duration of the subscription MUST NOT be larger than the length of
        time for which the certificate is still valid. The Expires header
        field SHOULD be set so that it is not longer than the notAfter date in
        the certificate.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.8"></a><h3>7.8.&nbsp;
Notifier Generation of NOTIFY Requests</h3>

<p>Once the UA has authenticated with the credential service and the
        subscription is accepted, the credential service MUST immediately send
        a Notify request. The Notifier SHOULD include the current etag value
        in the "etag" Event package parameter in the NOTIFY request. The
        Authentication Service is applied to this NOTIFY request in the same
        way as the certificate subscriptions. If the credential is revoked,
        the credential service MUST terminate any current subscriptions and
        force the UA to re-authenticate by sending a NOTIFY with its
        Subscription-State header field set to "terminated" and a reason
        parameter of "deactivated". (This causes a Subscriber to retry the
        subscription immediately.) This is so that if a secret for retrieving
        the credentials gets compromised, the rogue UA will not continue to
        receive credentials after the compromised secret has been changed.
</p>
<p>Any time the credentials for this URI change, the credential
        service MUST send a new NOTIFY to any active subscriptions with the
        new credentials.
</p>
<p>The notification MUST be sent over TLS so that it is integrity
        protected and the TLS needs to be directly connected between the UA
        and the credential service with no intermediaries.
</p>
<p>
</p>
<a name="gen.pub"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.9"></a><h3>7.9.&nbsp;
Generation of PUBLISH Requests</h3>

<p>A user agent SHOULD be configurable to control whether it publishes
        the credential for a user or just the user's certificate.
</p>
<p>When publishing just a certificate, the body contains an
        application/pkix-cert. When publishing a credential, the body contains
        a multipart/mixed containing both an application/pkix-cert and an
        application/pkcs8 body.
</p>
<p>When the UA sends the <a class='info' href='#RFC3903'>PUBLISH<span> (</span><span class='info'>Niemi, A., &ldquo;Session Initiation Protocol (SIP) Extension for Event State Publication,&rdquo; October&nbsp;2004.</span><span>)</span></a> [RFC3903]
        request, it needs to do the following: </p>
<ul class="text">
<li>The UA MUST use TLS to directly connect to the server acting as
            the credential service or to a server that is authoritative for
            the domain of the credential service. The UA MUST NOT connect
            through an intermediate proxy to the credential service.
</li>
<li>The Expires header field value in the PUBLISH request SHOULD be
            set to match the time for which the certificate is valid.
</li>
<li>If the certificate includes Basic Constraints, it SHOULD set
            the CA flag to false.
</li>
</ul>

<a name="notifier.publish.behavior"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.10"></a><h3>7.10.&nbsp;
Notifier Processing of PUBLISH Requests</h3>

<p>When the credential service receives a PUBLISH to update
        credentials, it MUST authenticate and authorize this request the same
        way as for subscriptions for credentials. If the authorization
        succeeds, then the credential service MUST perform the following check
        on the certificate: </p>
<ul class="text">
<li>One of the names in the SubjectAltName of the certificate
            matches the authorized user making the request.
</li>
<li>The notBefore validity time MUST NOT be in the future.
</li>
<li>The notAfter validity time MUST be in the future.
</li>
<li>If a CA Basic Constraint is set in the certificate, it is set
            to false.
</li>
</ul><p> If all of these succeed, the credential service updates the
        credential for this URI, processes all the active certificates and
        credential subscriptions to this URI, and generates a NOTIFY request
        with the new credential or certificate.
</p>
<p>If the Subscriber submits a PUBLISH request with no body, this
        revokes the current credentials and causes all subscriptions to the
        credential package to be deactivated as described in the previous
        section. (Note that subscriptions to the certificate package are NOT
        terminated; each subscriber to the certificate package receives a
        notification with an empty body.)
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.11"></a><h3>7.11.&nbsp;
Subscriber Processing of NOTIFY Requests</h3>

<p>When the UA receives a valid NOTIFY request, it should replace its
        existing credentials with the new received ones. If the UA cannot
        decrypt the PKCS#8 object, it MUST send a 437 (Unsupported
        Certificate) response. Later if the user provides a new password
        phrase for the private key, the UA can subscribe to the credentials
        again and attempt to decrypt with the new password phrase.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.12"></a><h3>7.12.&nbsp;
Handling of Forked Requests</h3>

<p>This event package does not permit forked requests.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.13"></a><h3>7.13.&nbsp;
Rate of Notifications</h3>

<p>Notifiers SHOULD NOT generate NOTIFY requests more frequently than
        once per minute.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.14"></a><h3>7.14.&nbsp;
State Agents and Lists</h3>

<p>The credential server described in this section which serves
        credentials is a state agent and implementations of the credential
        server MUST be implemented as a state agent.
</p>
<p>Implementers MUST NOT use the <a class='info' href='#RFC4662'>event list
        extension<span> (</span><span class='info'>Roach, A., Campbell, B., and J. Rosenberg, &ldquo;A Session Initiation Protocol (SIP) Event Notification Extension for Resource Lists,&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4662] with this event type.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.15"></a><h3>7.15.&nbsp;
Behavior of a Proxy Server</h3>

<p>The behavior is identical to behavior described for certificate
        subscriptions described in <a class='info' href='#proxy'>Section&nbsp;6.13<span> (</span><span class='info'>Behavior of a Proxy Server</span><span>)</span></a>.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Examples</h3>

<p>In all these examples, large parts of the messages are omitted to
      highlight what is relevant to this draft. The lines in the examples that
      are prefixed by $ represent encrypted blocks of data.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Encrypted Page Mode IM Message </h3>

<p>In this example, Alice sends Bob an encrypted page mode instant
        message. Alice does not already have Bob's public key from previous
        communications, so she fetches Bob's public key from Bob's credential
        service:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SUBSCRIBE sip:bob@biloxi.example.com SIP/2.0
...
Event: certificate
</pre></div>
<p>The credential service responds with the certificate in a
        NOTIFY.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
NOTIFY alice@atlanta.example.com  SIP/2.0
Subscription-State: active; expires=7200
....
From: &lt;sip:bob@biloxi.example.com&gt;;tag=1234
Identity: "NJguAbpmYXjnlxFmlOkumMI+MZXjB2iV/NW5xsFQqzD/p4yiovrJBqhd3T
           ZkegnsmoHryzk9gTBH7Gj/erixEFIf82o3Anmb+CIbrgdl03gGaD6ICvkp
           VqoMXZZjdvSpycyHOhh1cmUx3b9Vr3pZuEh+cB01pbMQ8B1ch++iMjw="
Identity-Info: &lt;https://atlanta.example.com/cert&gt;;alg=rsa-sha1
....
Event: certificate
Content-Type: application/pkix-cert
Content-Disposition: signal

&lt; certificate data &gt;
</pre></div>
<p>Next, Alice sends a SIP MESSAGE message to Bob and can encrypt the
        body using Bob's public key as shown below.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 MESSAGE sip:bob@biloxi.example.com SIP/2.0
 ...
 Content-Type: application/pkcs7-mime
 Content-Disposition: render

 $ Content-Type: text/plain
 $
 $ &lt; encrypted version of "Hello" &gt;
</pre></div>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Setting and Retrieving UA Credentials</h3>

<p>When Alice's UA wishes to publish Alice's public and private keys
        to the credential service, it sends a PUBLISH request like the one
        below. This must be sent over a TLS connection directly to the domain
        of the credential service. The credential service presents a
        certificate where the subjectAltName contains an entry that matches
        the domain name in the request line of the PUBLISH request and digest
        challenges the request to authenticate her.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 PUBLISH sips:alice@atlanta.example.com SIP/2.0
 ...
 Event: credential
 Content-Type: multipart/mixed;boundary=boundary
 Content-Disposition: signal

 --boundary
 Content-ID: 123
 Content-Type: application/pkix-cert


 &lt; Public certificate for Alice &gt;
 --boundary
 Content-ID: 456
 Content-Type: application/pkcs8

 &lt; Private Key for Alice &gt;
 --boundary
</pre></div>
<p>If one of Alice's UAs subscribes to the credential event, the UA
        will be digest challenged, and the NOTIFY will include a body similar
        to the one in the PUBLISH section above.
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>The high level message flow from a security point of view is
      summarized in the following figure. The 200 responses are removed from
      the figure as they do not have much to do with the overall security.
</p>
<p>In this figure, authC refers to authentication and authZ refers to
      authorization.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Alice     Server              Bob UA
 |           | TLS Handshake    | 1) Client authC/Z server
 |           |&lt;----------------&gt;|
 |           | PUBLISH          | 2) Client sends request
 |           |&lt;-----------------|    (write credential)
 |           | Digest Challenge | 3) Server challenges client
 |           |-----------------&gt;|
 |           | PUBLISH + Digest | 4) Server authC/Z client
 |           |&lt;-----------------|
 |           |      time...     |
 |           |                  |
 |           | TLS Handshake    | 5) Client authC/Z server
 |           |&lt;----------------&gt;|
 |           | SUBSCRIBE        | 6) Client sends request
 |           |&lt;-----------------|    (read credential)
 |           | Digest Challenge | 7) Server challenges client
 |           |-----------------&gt;|
 |           | SUBSCRIBE+Digest | 8) Server authC/Z client
 |           |&lt;-----------------|
 |           | NOTIFY           | 9) Server returns credential
 |           |-----------------&gt;|
 |           |
 | SUBSCRIBE |   10) Client requests certificate
 |----------&gt;|
 |           |
 |NOTIFY+AUTH|   11) Server returns user's certificate and signs that
 |&lt;----------|       it is valid using certificate for the domain
 |           |
</pre></div>
<p>When the UA, labeled Bob, first created a credential for Bob, it
      would store this on the credential server. The UA authenticated the
      Server using the certificates from the TLS handshake. The Server
      authenticated the UA using a digest style challenge with a shared
      secret.
</p>
<p>The UA, labeled Bob, wishes to request its credentials from the
      server. First it forms a TLS connection to the Server, which provides
      integrity and privacy protection and also authenticates the server to
      Bob's UA. Next the UA requests its credentials using a SUBSCRIBE
      request. The Server digest challenges this to authenticate Bob's UA. The
      server and Bob's UA have a shared secret that is used for this. If the
      authentication is successful, the server sends the credentials to Bob's
      UA. The private key in the credentials may have been encrypted using a
      shared secret that the server does not know.
</p>
<p>A similar process would be used for Bob's UA to publish new
      credentials to the server. Bob's UA would send a PUBLISH request
      containing the new credentials. When this happened, all the other UAs
      that were subscribed to Bob's credentials would receive a NOTIFY with
      the new credentials.
</p>
<p>Alice wishes to find Bob's certificate and sends a SUBSCRIBE to the
      server. The server sends the response in a NOTIFY. This does not need to
      be sent over a privacy or integrity protected channel, as the
      Authentication service described in <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>
      provides integrity protection of this information and signs it with the
      certificate for the domain.
</p>
<p>This whole scheme is highly dependent on trusting the operators of
      the credential service and trusting that the credential service will not
      be compromised. The security of all the users will be compromised if the
      credential service is compromised.
</p>
<p></p>
<blockquote class="text">
<p>Note: There has been significant discussion of the topic of
          avoiding deployments in which the credential servers store the
          private keys, even in some encrypted form that the credential server
          does not know how to decrypt. Various schemes were considered to
          avoid this but they all result in either moving the problem to some
          other server, which does not seem to make the problem any better, or
          having a different credential for each device. For some deployments
          where each user has only one device this is fine but for deployments
          with multiple devices, it would require that when Alice went to
          contact Bob, Alice would have to provide messages encrypted for all
          of Bob's devices. The sipping working group did consider this
          architecture and decided it was not appropriate due both to the
          information it revealed about the devices and users and the amount
          of signaling required to make it work.
</p>
</blockquote>

<p>This specification requires that TLS be used for the SIP
      communications to place and retrieve a UA's private key. This provides
      security in two ways: </p>
<ol class="text">
<li>Confidentiality is provided for the digest authentication
          exchange, thus protecting it from dictionary attacks.
</li>
<li>Confidentiality is provided for the private key, thus protecting
          it from being exposed to passive attackers.
</li>
</ol><p> In order to prevent man-in-the-middle attacks, TLS clients
      MUST check that the SubjectAltName of the certificate for the server
      they connected to exactly matches the server they were trying to connect
      to. The connection must be directly connected to the correct server or
      any intermediaries in the TLS path can compromise the certificate and
      instead provide a certificate for which the attacker knows the private
      key. This may lead the UA that relies on this compromised certificate to
      lose confidential information. Failing to use TLS or selecting a poor
      cipher suite (such as NULL encryption) may result in credentials,
      including private keys, being sent unencrypted over the network and will
      render the whole system useless.
</p>
<p>The correct checking of chained certificates as specified in <a class='info' href='#RFC5246'>TLS<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246] is critical for the client to authenticate
      the server. If the client does not authenticate that it is talking to
      the correct credential service, a man in the middle attack is
      possible.
</p>
<a name="section.revocation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Certificate Revocation</h3>

<p>If a particular credential needs to be revoked, the new credential
        is simply published to the credential service. Every device with a
        copy of the old credential or certificate in its cache will have a
        subscription and will rapidly (order of seconds) be notified and
        replace its cache. Clients that are not subscribed will subscribe when
        they next need to use the certificate and will get the new
        certificate.
</p>
<p>It is possible that an attacker could mount a DOS attack such that
        the UA that had cached a certificate did not receive the NOTIFY with
        its revocation. To protect against this attack, the UA needs to limit
        how long it caches certificates. After this time, the UA would
        invalidate the cached information even though no NOTIFY had ever been
        received due to the attacker blocking it.
</p>
<p>The duration of this cached information is in some ways similar to
        a device deciding how often to check a CRL list. For many
        applications, a default time of 1 day is suggested, but for some
        applications it may be desirable to set the time to zero so that no
        certificates are cached at all and the credential is checked for
        validity every time the certificate is used.
</p>
<p>The UA MUST NOT cache the certificates for a period longer than that
        of the subscription duration. This is to avoid the UA using invalid
        cached credentials when the notifier of the new credentials has been
        prevented from updating the UA.
</p>
<a name="section.replacement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
Certificate Replacement</h3>

<p>The UAs in the system replace the certificates close to the time
        that the certificates would expire. If a UA has used the same key pair
        to encrypt a very large volume of traffic, the UA MAY choose to
        replace the credential with a new one before the normal
        expiration.
</p>
<a name="trust"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
Trusting the Identity of a Certificate</h3>

<p>When a UA wishes to discover the certificate for
        sip:alice@example.com, the UA subscribes to the certificate for
        alice@example.com and receives a certificate in the body of a SIP
        NOTIFY request. The term original URI is used to describe the URI that
        was in the To header field value of the SUBSCRIBE request. So in this
        case the original URI would be sip:alice@example.com.
</p>
<p>If the certificate is signed by a trusted CA, and one of the names
        in the SubjectAltName matches the original URI, then this certificate
        MAY be used but only for exactly the original URI and not for other
        identities found in the SubjectAltName. Otherwise, there are several
        steps the UA MUST perform before using this certificate. </p>
<ul class="text">
<li>The From header field in the NOTIFY request MUST match the
            original URI that was subscribed to.
</li>
<li>The UA MUST check the Identity header field as described in the
            <a class='info' href='#RFC4474'>Identity<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4474] specification to validate
            that bodies have not been tampered with and that an Authentication
            Service has validated this From header field.
</li>
<li>The UA MUST check the validity time of the certificate and stop
            using the certificate if it is invalid. (Implementations are
            reminded to verify both the notBefore and notAfter validity
            times.)
</li>
<li>The certificate MAY have several names in the SubjectAltName
            but the UA MUST only use this certificate when it needs the
            certificate for the identity asserted by the Authentication
            Service in the NOTIFY. This means that the certificate should only
            be indexed in the certificate cache by the AOR that the
            Authentication Service asserted and not by the value of all the
            identities found in the SubjectAltName list.
</li>
</ul><p> These steps result in a chain of bindings that result in a
        trusted binding between the original AOR that was subscribed to and a
        public key. The original AOR is forced to match the From. The
        Authentication Service validates that this request did come from the
        identity claimed in the From header field value and that the bodies in
        the request that carry the certificate have not been tampered with.
        The certificate in the body contains the public key for the identity.
        Only the UA that can authenticate as this AOR, or devices with access
        to the private key of the domain, can tamper with this body. This
        stops other users from being able to provide a false public key. This
        chain of assertion from original URI, to From, to body, to public key
        is critical to the security of the mechanism described in this
        specification. If any of the steps above are not followed, this chain
        of security will be broken and the system will not work.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.4"></a><h3>9.4.&nbsp;
SACRED Framework</h3>

<p>This specification includes a mechanism that allows end users to
        share the same credentials across different end-user devices. This
        mechanism is based on the one presented in the <a class='info' href='#RFC3760'>SACRED Framework<span> (</span><span class='info'>Gustafson, D., Just, M., and M. Nystrom, &ldquo;Securely Available Credentials (SACRED) - Credential Server Framework,&rdquo; April&nbsp;2004.</span><span>)</span></a> [RFC3760]. While this mechanism is
        fully described in this document, the requirements and background are
        more thoroughly discussed in <a class='info' href='#RFC3760'>[RFC3760]<span> (</span><span class='info'>Gustafson, D., Just, M., and M. Nystrom, &ldquo;Securely Available Credentials (SACRED) - Credential Server Framework,&rdquo; April&nbsp;2004.</span><span>)</span></a>.
</p>
<p>Specifically, <a class='info' href='#subscriber.behavior'>Section&nbsp;7.6<span> (</span><span class='info'>Subscriber Generation of SUBSCRIBE Requests</span><span>)</span></a>, <a class='info' href='#notifier.subscribe.behavior'>Section&nbsp;7.7<span> (</span><span class='info'>Notifier Processing of SUBSCRIBE Requests</span><span>)</span></a> and <a class='info' href='#notifier.publish.behavior'>Section&nbsp;7.10<span> (</span><span class='info'>Notifier Processing of PUBLISH Requests</span><span>)</span></a> follow the cTLS
        architecture described in section 4.2.2 of <a class='info' href='#RFC3760'>[RFC3760]<span> (</span><span class='info'>Gustafson, D., Just, M., and M. Nystrom, &ldquo;Securely Available Credentials (SACRED) - Credential Server Framework,&rdquo; April&nbsp;2004.</span><span>)</span></a>. The client authenticates the server using
        the server's TLS certificate. The server authenticates the client
        using a SIP digest transaction inside the TLS session. The TLS
        sessions form a strong session key that is used to protect the
        credentials being exchanged.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.5"></a><h3>9.5.&nbsp;
Crypto Profiles</h3>

<p>Credential services SHOULD implement the server name indication
        extensions in <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> and they MUST support a
        TLS profile of TLS_RSA_WITH_AES_128_CBC_SHA as described in <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> as a profile of
        TLS_RSA_WITH_3DES_EDE_CBC_SHA.
</p>
<p>The PKCS#8 in the clients MUST implement PBES2 with a key
        derivation algorithm of PBKDF2 using HMAC with SHA1 and an encryption
        algorithm of DES-EDE2-CBC-Pad as defined in <a class='info' href='#RFC2898'>[RFC2898]<span> (</span><span class='info'>Kaliski, B., &ldquo;PKCS #5: Password-Based Cryptography Specification Version 2.0,&rdquo; September&nbsp;2000.</span><span>)</span></a>. It is RECOMMENDED that this profile be used
        when using PKCS#8. A different passphrase SHOULD be used for the
        PKCS#8 encryption than is used for server authentication.
</p>
<a name="cert.gen"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.6"></a><h3>9.6.&nbsp;
User Certificate Generation</h3>

<p>The certificates should be consistent with <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>. A signatureAlgorithm of
        sha1WithRSAEncryption MUST be implemented. The Issuers SHOULD be the
        same as the subject. Given the ease of issuing new certificates with
        this system, the Validity can be relatively short. A Validity of one
        year or less is RECOMMENDED. The subjectAltName must have a URI type
        that is set to the SIP URL corresponding to the user AOR. It MAY be
        desirable to put some randomness into the length of time for which the
        certificates are valid so that it does not become necessary to renew
        all the certificates in the system at the same time.
</p>
<p>It is worth noting that a UA can discover the current time by
        looking at the Date header field value in the 200 response to a
        REGISTER request.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.7"></a><h3>9.7.&nbsp;
Compromised Authentication Service</h3>

<p>One of this worst attacks against this system would be if the
        Authentication Service were compromised. This attack is somewhat
        analogous to a CA being compromised in traditional PKI systems. The
        attacker could make a fake certificate for which it knows the private
        key, use it to receive any traffic for a given use, and then
        re-encrypt that traffic with the correct key and forward the
        communication to the intended receiver. The attacker would thus become
        a man in the middle in the communications.
</p>
<p>There is not too much that can be done to protect against this. A
        UA MAY subscribe to its own certificate under some other identity to
        try to detect whether the credential server is handing out the correct
        certificates. It will be difficult to do this in a way that does not
        allow the credential server to recognize the user's UA.
</p>
<p>The UA MAY also save the fingerprints of the cached certificates
        and warn users when the certificates change significantly before their
        expiry date.
</p>
<p>The UA MAY also allow the user to see the fingerprints for the
        cached certificates so that they can be verified by some other out of
        band means.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>This specification defines two new event packages that IANA is
      requested to add the registry at: </p>
<blockquote class="text">
<p>http://www.iana.org/assignments/sip-events
</p>
</blockquote><p> It also defines a new mime type that IANA is requested to add
      to the registry at: </p>
<blockquote class="text">
<p>http://www.iana.org/assignments/media-types/application
</p>
</blockquote>

<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
Certificate Event Package</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
To: ietf-sip-events@iana.org
Subject: Registration of new SIP event package

Package Name: certificate

Is this registration for a Template Package: No

Published Specification(s): This document

New Event header parameters: This package defines no
                             new parameters

Person &amp; email address to contact for further information:
  Cullen Jennings &lt;fluffy@cisco.com&gt;
</pre></div>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
Credential Event Package</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
To: ietf-sip-events@iana.org
Subject: Registration of new SIP event package

Package Name: credential

Is this registration for a Template Package: No

Published Specification(s): This document

New Event header parameters: "etag"

Person &amp; email address to contact for further information:
  Cullen Jennings &lt;fluffy@cisco.com&gt;
</pre></div>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.3"></a><h3>10.3.&nbsp;
PKCS#8</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
To: ietf-types@iana.org
Subject: Registration of MIME media type application/pkcs8

MIME media type name: application

MIME subtype name: pkcs8

Required parameters: None

Optional parameters: None

Encoding considerations: binary

Security considerations: Carries a cryptographic private key

Interoperability considerations:
     The PKCS#8 object inside this MIME type MUST be DER-encoded

Published specification:
     RSA Laboratories, "Private-Key Information Syntax Standard,
     Version 1.2", PKCS 8, November 1993.

Applications which use this media type: Any MIME-compliant transport

Additional information:
  Magic number(s): None
  File extension(s): .p8
  Macintosh File Type Code(s): none

Person &amp; email address to contact for further information:
  Cullen Jennings &lt;fluffy@cisco.com&gt;

Intended usage: COMMON

Author/Change controller:
  the IESG
</pre></div>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgments</h3>

<p>Many thanks to Eric Rescorla, Jim Schaad, Rohan Mahy for significant
      help and discussion. Many others provided useful comments, including
      Kumiko Ono, Peter Gutmann, Russ Housley, Yaron Pdut, Aki Niemi, Magnus
      Nystrom, Paul Hoffman, Adina Simu, Dan Wing, Mike Hammer and Lyndsay
      Campbell. Rohan Mahy, John Elwell, and Jonathan Rosenberg provided
      detailed review and text.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="PKCS.8.1993">[PKCS.8.1993]</a></td>
<td class="author-text">RSA Laboratories, &ldquo;Private-Key Information Syntax Standard, Version 1.2,&rdquo; PKCS&nbsp;8, November&nbsp;1993.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2046">[RFC2046]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com">N. Borenstein</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2046">Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types</a>,&rdquo; RFC&nbsp;2046, November&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2046.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2585">[RFC2585]</a></td>
<td class="author-text"><a href="mailto:housley@spyrus.com">Housley, R.</a> and <a href="mailto:phoffman@imc.org">P. Hoffman</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2585">Internet X.509 Public Key Infrastructure Operational Protocols: FTP and HTTP</a>,&rdquo; RFC&nbsp;2585, May&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2585.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2898">[RFC2898]</a></td>
<td class="author-text">Kaliski, B., &ldquo;<a href="http://tools.ietf.org/html/rfc2898">PKCS #5: Password-Based Cryptography Specification Version 2.0</a>,&rdquo; RFC&nbsp;2898, September&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2898.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3204">[RFC3204]</a></td>
<td class="author-text">Zimmerer, E., Peterson, J., Vemuri, A., Ong, L., Audet, F., Watson, M., and M. Zonoun, &ldquo;<a href="http://tools.ietf.org/html/rfc3204">MIME media types for ISUP and QSIG Objects</a>,&rdquo; RFC&nbsp;3204, December&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3204.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3265">[RFC3265]</a></td>
<td class="author-text">Roach, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3265">Session Initiation Protocol (SIP)-Specific Event Notification</a>,&rdquo; RFC&nbsp;3265, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3265.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3903">[RFC3903]</a></td>
<td class="author-text">Niemi, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3903">Session Initiation Protocol (SIP) Extension for Event State Publication</a>,&rdquo; RFC&nbsp;3903, October&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3903.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4474">[RFC4474]</a></td>
<td class="author-text">Peterson, J. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4474">Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4474, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4474.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5280">[RFC5280]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5280.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informational References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3760">[RFC3760]</a></td>
<td class="author-text">Gustafson, D., Just, M., and M. Nystrom, &ldquo;<a href="http://tools.ietf.org/html/rfc3760">Securely Available Credentials (SACRED) - Credential Server Framework</a>,&rdquo; RFC&nbsp;3760, April&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3760.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3851">[RFC3851]</a></td>
<td class="author-text">Ramsdell, B., &ldquo;<a href="http://tools.ietf.org/html/rfc3851">Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification</a>,&rdquo; RFC&nbsp;3851, July&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3851.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3853">[RFC3853]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://tools.ietf.org/html/rfc3853">S/MIME Advanced Encryption Standard (AES) Requirement for the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;3853, July&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3853.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4662">[RFC4662]</a></td>
<td class="author-text">Roach, A., Campbell, B., and J. Rosenberg, &ldquo;<a href="http://tools.ietf.org/html/rfc4662">A Session Initiation Protocol (SIP) Event Notification Extension for Resource Lists</a>,&rdquo; RFC&nbsp;4662, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4662.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cullen Jennings</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 West Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">MS: SJC-21/2</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 421-9990</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:fluffy@cisco.com">fluffy@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jason Fischl (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Skype</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2145 Hamilton Ave.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95125</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-408-786-5919</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jason.fischl@skype.net">jason.fischl@skype.net</a></td></tr>
</table>
</body></html>
