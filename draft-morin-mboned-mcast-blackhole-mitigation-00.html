<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Multicast blackhole
    mitigation with PIM adjacency conditions on routing announcements</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Multicast blackhole
    mitigation with PIM adjacency conditions on routing announcements">
<meta name="keywords" content="draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">T. Morin</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">G. Cauchie</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">France Telecom - Orange Labs</td></tr>
<tr><td class="header">Expires: May 15, 2008</td><td class="header">November 12, 2007</td></tr>
</table></td></tr></table>
<h1><br />Multicast blackhole
    mitigation with PIM adjacency conditions on routing announcements<br />draft-morin-mboned-mcast-blackhole-mitigation-00</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 15, 2008.</p>

<h3>Abstract</h3>

<p>In a network running PIM-SM, multicast traffic can fail to be
      properly routed and forwarded during some period of time after a
      topology change, when unicast routing converges to a new path using a
      new next-hop before multicast routing adjacencies are fully setup with
      this new next-hop. At this point, a blackhole appears in the multicast
      topology and persists until the PIM adjacency become fully setup. This
      document describes different procedures aiming at avoiding such
      blackholes, focusing on the use of non-congruent unicast routing that
      takes into account the status of PIM adjacencies.
</p>
<h3>Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#pb">3.</a>&nbsp;
Problem statement<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.</a>&nbsp;
Ineffective PIM Adjacency<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.2.</a>&nbsp;
Problem description<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.3.</a>&nbsp;
Applicability to SSM and non-SSM multicast<br />
<a href="#sol">4.</a>&nbsp;
PIM-adjacency-based non-congruent MRIB<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.1.</a>&nbsp;
Strategy description<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.2.</a>&nbsp;
Criterias<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.2.1.</a>&nbsp;
Prune links on which PIM is not enabled<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.2.2.</a>&nbsp;
Prune links with no received PIM Hello<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.2.3.</a>&nbsp;
Prune links with no sent PIM Hello<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.2.4.</a>&nbsp;
Other criteria<br />
<a href="#alt-sol">5.</a>&nbsp;
Alternative proposal<br />
<a href="#anchor13">6.</a>&nbsp;
Interoperability considerations<br />
<a href="#anchor14">7.</a>&nbsp;
Recommandations<br />
<a href="#IANA">8.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">9.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">10.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">11.</a>&nbsp;
 References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>In a network running <a class='info' href='#RFC4601'>PIM-SM<span> (</span><span class='info'>Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4601], multicast
      traffic can fail to be routed during some period of time after a
      topology change, when unicast routing protocols converge before the
      PIM-SM multicast routing protocol adjacencies are fully setup, causing
      blackholing of multicast traffic. This document describes different
      procedures aiming at avoiding such blackholes.
</p>
<p><a class='info' href='#pb'>Section&nbsp;3<span> (</span><span class='info'>Problem statement</span><span>)</span></a> describes the problem statement, and
      following <a class='info' href='#sol'>Section&nbsp;4<span> (</span><span class='info'>PIM-adjacency-based non-congruent MRIB</span><span>)</span></a> and <a class='info' href='#alt-sol'>Section&nbsp;5<span> (</span><span class='info'>Alternative proposal</span><span>)</span></a>
      describe possible solutions to mitigate theses blackholes.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>This document is essentially using terminology from unicast routing
      protocols and from the <a class='info' href='#RFC4601'>PIM-SM
      specifications<span> (</span><span class='info'>Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4601].
</p>
<p>Moreover, throughout this document the "MT-IGP" term designates an
      IGP able to carry information about multiple network topology. Example
      of such IGP are: <a class='info' href='#I-D.ietf-isis-wg-multi-topology'>MT-ISIS<span> (</span><span class='info'>Przygienda, T., &ldquo;M-ISIS: Multi Topology (MT) Routing in IS-IS,&rdquo; October&nbsp;2005.</span><span>)</span></a> [I&#8209;D.ietf&#8209;isis&#8209;wg&#8209;multi&#8209;topology], <a class='info' href='#I-D.previdi-isis-mi'>MI-ISIS<span> (</span><span class='info'>Previdi, S., &ldquo;IS-IS Multi-instance,&rdquo; May&nbsp;2007.</span><span>)</span></a> [I&#8209;D.previdi&#8209;isis&#8209;mi], <a class='info' href='#RFC4915'>MT-OSPFv2<span> (</span><span class='info'>Psenak, P., Mirtorabi, S., Roy, A., Nguyen, L., and P. Pillay-Esnault, &ldquo;Multi-Topology (MT) Routing in OSPF,&rdquo; June&nbsp;2007.</span><span>)</span></a> [RFC4915], <a class='info' href='#I-D.ietf-ospf-mt-ospfv3'>MT-OSPFv3<span> (</span><span class='info'>Mirtorabi, S. and A. Roy, &ldquo;Multi-topology routing in OSPFv3 (MT-OSPFv3),&rdquo; July&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ospf&#8209;mt&#8209;ospfv3], <a class='info' href='#I-D.acee-ospf-multi-instance'>MI-OSPF<span> (</span><span class='info'>Lindem, A., &ldquo;OSPF Multi-Instance Extensions,&rdquo; September&nbsp;2007.</span><span>)</span></a> [I&#8209;D.acee&#8209;ospf&#8209;multi&#8209;instance].
</p>
<a name="pb"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Problem statement</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Ineffective PIM Adjacency</h3>

<p>In a number of situations a link status can be up without the PIM
        adjacency to be fully setup. Possible causes for this kind of
        situations are :</p>
<ul class="text">
<li>PIM is unconfigured on one end of the link (not yet configured,
            or misconfigured)
</li>
<li>a bug or hardware failure is inducing unreliability or delay in
            sending or receiving PIM Hello messages
</li>
<li>no PIM Hello has been received yet by one of the routers, but
            that router would require having received a PIM Hello before
            sending PIM Join to a neighbor
</li>
</ul><p>On this last point, note that it seems that <a class='info' href='#RFC4601'>[RFC4601]<span> (</span><span class='info'>Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised),&rdquo; August&nbsp;2006.</span><span>)</span></a> does not clearly tell if a router should or
        should not delay sending PIM Joins on a link toward a router from
        which it hasn't yet received any PIM Hello message. The procedures
        described in <a class='info' href='#RFC4601'>[RFC4601]<span> (</span><span class='info'>Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised),&rdquo; August&nbsp;2006.</span><span>)</span></a> are so that it can take up
        to &lt;Triggered_Hello_Delay&gt; seconds (up to 5s, by default) before
        a neighbor will send a PIM Hello triggered by a Hello sent by a new
        neighbor on the link.
</p>
<p>Operational experience shows that all of these situations occur,
        even frequently for some of them.
</p>
<p>A similar problem affects the LDP protocol, for which a solution is
        also being studied<a class='info' href='#I-D.ietf-mpls-igp-sync'>[I&#8209;D.ietf&#8209;mpls&#8209;igp&#8209;sync]<span> (</span><span class='info'>Jork, M., &ldquo;LDP IGP Synchronization,&rdquo; September&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Problem description</h3>

<p>The generic problem targeted by this document is when the unicast
        routing protocol starts to consider a link as available for unicast
        routing (e.g.. a new link, or a flapping link coming up) but the PIM
        adjacency on this link is ineffective (see section above), causing PIM
        Joins to fail to be propagated further, and resulting in a blackhole
        for the corresponding multicast traffic.
</p>
<p>This problem can occur in a few distinct situations:</p>
<ul class="text">
<li>IGP case : in an autonomous system, the IGP can disseminate
            information relative to a new link before PIM-SM is fully setup on
            this link
</li>
<li>EGP case : when a link between two ASBRs comes up, the EGP
            (typically BGP) can possibly advertise the new routes received
            from the neighbor ASBR before PIM is fully effective on this
            link
</li>
<li>multicast BGP/MPLS VPN case : similar to the EGP case
</li>
</ul><p>Partial solutions to the issues presented above do exist
        based on implementation or unicast routing tuning, but fail to cover
        all plausible blackhole causes.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Applicability to SSM and non-SSM multicast</h3>

<p>The PIM-SM multicast routing protocol is using unicast routes (the
        MRIB) to decide how PIM Join messages should be routed toward the
        source (in the SPT case) or the RP (in the RPT case). In this document
        we will only describe the SSM/SPT case, for the sake of clarity, but
        all statements equally apply to the non-SSM/RPT case, using the RP
        instead of the multicast source.
</p>
<a name="sol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
PIM-adjacency-based non-congruent MRIB</h3>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Strategy description</h3>

<p>Most unicast routing protocols have been extended, or are being
        extended to support semantic extensions to advertise unicast routes
        that will be used specifically for multicast routing : <a class='info' href='#I-D.ietf-isis-wg-multi-topology'>MT-ISIS<span> (</span><span class='info'>Przygienda, T., &ldquo;M-ISIS: Multi Topology (MT) Routing in IS-IS,&rdquo; October&nbsp;2005.</span><span>)</span></a> [I&#8209;D.ietf&#8209;isis&#8209;wg&#8209;multi&#8209;topology], <a class='info' href='#I-D.previdi-isis-mi'>MI-ISIS<span> (</span><span class='info'>Previdi, S., &ldquo;IS-IS Multi-instance,&rdquo; May&nbsp;2007.</span><span>)</span></a> [I&#8209;D.previdi&#8209;isis&#8209;mi], <a class='info' href='#RFC4915'>MT-OSPF<span> (</span><span class='info'>Psenak, P., Mirtorabi, S., Roy, A., Nguyen, L., and P. Pillay-Esnault, &ldquo;Multi-Topology (MT) Routing in OSPF,&rdquo; June&nbsp;2007.</span><span>)</span></a> [RFC4915], <a class='info' href='#RFC4760'>MP-BGP SAFI
        2<span> (</span><span class='info'>Bates, T., Chandra, R., Katz, D., and Y. Rekhter, &ldquo;Multiprotocol Extensions for BGP-4,&rdquo; January&nbsp;2007.</span><span>)</span></a> [RFC4760], <a class='info' href='#I-D.ietf-l3vpn-2547bis-mcast-bgp'>MP-BGP SAFI
        129 VPNv4 routes<span> (</span><span class='info'>Aggarwal, R., &ldquo;BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs,&rdquo; July&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;l3vpn&#8209;2547bis&#8209;mcast&#8209;bgp]. When one or more of these extensions are in
        use, PIM-SM will be configured to use the distinct RIB populated by
        them as its MRIB (the RIB used for RPF lookups). In such a case, the
        MRIB is said to be "non-congruent" to the unicast RIB.
</p>
<p>The issues described in this document can be fully or partially
        addressed by the use of a non-congruent MRIB that takes into account
        the status of the PIM-SM adjcencies. A link or the associated next hop
        won't populate the MRIB based only on the status of the link for the
        unicast routing protocol, but only if conditions are verified on the
        status of the PIM adjacency. To do this, a router would keep an
        adjacent link out of the multicast-specific routing topology until the
        PIM status on this link is ok:</p>
<ul class="text">
<li>in the case of a link where a link-state protocol (typically an
            IGP) is used, the link (and the routes directed routed through it)
            will not be advertised in the multicast-specific topology if it is
            known that the PIM adjacency is not ready.
</li>
<li>in the case of a link where a distance vector protocol (e.g..
            BGP) is used, the routes received from a neighbor on that link,
            that pertain to the multicast-specific RIB (e.g.. SAFI 2 routes in
            the case of BGP) will not be re-advertised.
</li>
</ul>

<p>Different facts can be taken into account by the local router to
        decide whether the PIM adjacency is ready or not. Different routers in
        a domain can have a different policy for this decision process : the
        more specific is the information taken into account, the more
        black-holes are expected to be avoided ; but in any case, there will
        always be some improvements over just using non-congruent routing.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Criterias</h3>

<p>This sections details the different facts that can be taken into
        account to decide that a PIM adjacency is effective or not.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Prune links on which PIM is not enabled</h3>

<p>This is the most basic criteria, which consist in including in
          the multicast topology, only links on which PIM is administratively
          enabled.
</p>
<p>It typically allows to cover cases of PIM misconfiguration where
          PIM is not enabled on both sides of a link.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Prune links with no received PIM Hello</h3>

<p>This consists in not including in the multicast topology, links
          on which no PIM Hello was received yet.
</p>
<p>This is particularly relevant if the local PIM-SM implementation
          requires having received PIM Hellos from a neighbor before sending a
          Join toward this neighbor.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2.1"></a><h3>4.2.2.1.&nbsp;
IGP on LAN specific case</h3>

<p>In the case of an IGP on a LAN the "prune links with no
            received PIM Hello" criteria need to be further specified.
</p>
<p>Indeed, an IGP like OSPF or ISIS elects a node that will be
            responsible of creating a pseudo nodes for the LAN and each node
            on the LAN will then announce an adjacency with this pseudo-node.
            There is not such notion as a pseudo-node in PIM-SM, PIM
            adjacencies on a LAN being setup between all PIM routers on the
            LAN.
</p>
<p>[TBC]
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Prune links with no sent PIM Hello</h3>

<p>This consists in not including in the multicast topology, the
          links on which no PIM Hello was sent yet.
</p>
<p>This is particularly relevant during the randomized period of
          time between a Hello being received by a new neighbor and a
          triggered Hello being sent.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
Other criteria</h3>

<p>Other criteria may be considered, like not including links the
          received PIM Hello would lack the indication of a required Hello
          option, or an unknown PIM protocol version, etc.
</p>
<a name="alt-sol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Alternative proposal</h3>

<p>An alternative mechanism to the one described in previous section
      would consist in using infinite metrics for a link until where PIM is
      enabled until the PIM adjacency is fully setup. This alternative has the
      advantage of not requiring the use of a multi-topology IGP (in the IGP
      case) or of SAFI 2 routing (in the EGP case), but has the drawback of
      impacting unicast traffic, causing perturbations of unicast routing
      during the period of time where the PIM adjacency is not fully setup
      yet. For this reason, this alternative is not favored and not described
      further in this document.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Interoperability considerations</h3>

<p>Both mechanisms described in this memo do not cause any
      interoperability issue.
</p>
<p>The decision to use or not use non-congruent unicast routing for
      multicast routing has to be made consistently across a routing domain,
      but the decision to apply or not apply the specific procedures described
      in this document, and the policy to decide whether or not a link will be
      used for multicast routing, can be a purely local procedure. The worst
      situation that could occur is not seeing any improvement over the
      initial situation where no specific procedure is used, and where
      blackholing of multicast traffic is more likely to occur.
</p>
<p>For these reason, this document is only intended as a guideline for
      implementors, and only target the informational status.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Recommandations</h3>

<p>[ To be completed based on discussion on the above.]
</p>
<p>Logging is RECOMMENDED when a router choses to not include a link for
      multicast routing.
</p>
<p>Operator feedback through the router management interface is
      RECOMMENDED, both in the management interface section related to unicast
      protocols which are used to implement the non-congruency, and in the
      section related to PIM-SM.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>This document makes no request of IANA.
</p>
<p>Note to RFC Editor: this section may be removed on publication as an
      RFC.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>The procedures in this document are believed to not introduce any
      specific issue introduced compared to multicast routing done with <a class='info' href='#RFC4601'>PIM-SM<span> (</span><span class='info'>Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4601].
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgements</h3>

<p>The authors want to thank Bruno Decraene and Toerless Eckert for
      discussions that helped to shape this proposal.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.&nbsp; References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.acee-ospf-multi-instance">[I-D.acee-ospf-multi-instance]</a></td>
<td class="author-text">Lindem, A., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-acee-ospf-multi-instance-00.txt">OSPF Multi-Instance Extensions</a>,&rdquo; draft-acee-ospf-multi-instance-00 (work in progress), September&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-acee-ospf-multi-instance-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-isis-wg-multi-topology">[I-D.ietf-isis-wg-multi-topology]</a></td>
<td class="author-text">Przygienda, T., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-isis-wg-multi-topology-11.txt">M-ISIS: Multi Topology (MT) Routing in IS-IS</a>,&rdquo; draft-ietf-isis-wg-multi-topology-11 (work in progress), October&nbsp;2005 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-isis-wg-multi-topology-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-l3vpn-2547bis-mcast-bgp">[I-D.ietf-l3vpn-2547bis-mcast-bgp]</a></td>
<td class="author-text">Aggarwal, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-l3vpn-2547bis-mcast-bgp-03.txt">BGP Encodings and Procedures for Multicast in MPLS/BGP IP VPNs</a>,&rdquo; draft-ietf-l3vpn-2547bis-mcast-bgp-03 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-l3vpn-2547bis-mcast-bgp-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mpls-igp-sync">[I-D.ietf-mpls-igp-sync]</a></td>
<td class="author-text">Jork, M., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mpls-igp-sync-00.txt">LDP IGP Synchronization</a>,&rdquo; draft-ietf-mpls-igp-sync-00 (work in progress), September&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mpls-igp-sync-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ospf-mt-ospfv3">[I-D.ietf-ospf-mt-ospfv3]</a></td>
<td class="author-text">Mirtorabi, S. and A. Roy, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ospf-mt-ospfv3-03.txt">Multi-topology routing in OSPFv3 (MT-OSPFv3)</a>,&rdquo; draft-ietf-ospf-mt-ospfv3-03 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ospf-mt-ospfv3-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.previdi-isis-mi">[I-D.previdi-isis-mi]</a></td>
<td class="author-text">Previdi, S., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-previdi-isis-mi-00.txt">IS-IS Multi-instance</a>,&rdquo; draft-previdi-isis-mi-00 (work in progress), May&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-previdi-isis-mi-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4601">[RFC4601]</a></td>
<td class="author-text">Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;<a href="http://tools.ietf.org/html/rfc4601">Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised)</a>,&rdquo; RFC&nbsp;4601, August&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4601.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4760">[RFC4760]</a></td>
<td class="author-text">Bates, T., Chandra, R., Katz, D., and Y. Rekhter, &ldquo;<a href="http://tools.ietf.org/html/rfc4760">Multiprotocol Extensions for BGP-4</a>,&rdquo; RFC&nbsp;4760, January&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4760.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4915">[RFC4915]</a></td>
<td class="author-text">Psenak, P., Mirtorabi, S., Roy, A., Nguyen, L., and P. Pillay-Esnault, &ldquo;<a href="http://tools.ietf.org/html/rfc4915">Multi-Topology (MT) Routing in OSPF</a>,&rdquo; RFC&nbsp;4915, June&nbsp;2007 (<a href="ftp://ftp.isi.edu/in-notes/rfc4915.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Thomas Morin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France Telecom - Orange Labs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2, avenue Pierre Marzin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lannion  22307</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:thomas.morin@orange-ftgroup.com">thomas.morin@orange-ftgroup.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gregory Cauchie</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France Telecom - Orange Labs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">38-40 rue du Gnral Leclerc</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Issy Les Moulineaux  92794</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gregory.cauchie@orange-ftgroup.com">gregory.cauchie@orange-ftgroup.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
