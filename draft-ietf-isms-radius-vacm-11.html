<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Using Authentication, Authorization, and Accounting services
to Dynamically Provision
View-based Access Control Model
User-to-Group Mappings</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Using Authentication, Authorization, and Accounting services
to Dynamically Provision
View-based Access Control Model
User-to-Group Mappings">
<meta name="keywords" content="Network Management, Security, Management Information Base, MIB, SMIv2, RADIUS, AAA, VACM">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">K. Narayan</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">D. Nelson</td></tr>
<tr><td class="header">Expires: March 18, 2011</td><td class="header">Elbrys Networks, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">R. Presuhn, Ed.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">None</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">September 14, 2010</td></tr>
</table></td></tr></table>
<h1><br />Using Authentication, Authorization, and Accounting services
to Dynamically Provision
View-based Access Control Model
User-to-Group Mappings<br />draft-ietf-isms-radius-vacm-11.txt</h1>

<h3>Abstract</h3>

<p>
This memo defines a portion of the Management Information Base (MIB)
for use with network management protocols.
It describes the use of information provided by
Authentication, Authorization, and Accounting (AAA) services,
such as the Remote Authentication Dial-In User Service (RADIUS),
to dynamically update user-to-group mappings in
the View-Based Access Control Model (VACM).
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on March 18, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
The Internet-Standard Management Framework<br />
<a href="#anchor3">3.</a>&nbsp;
Conventions<br />
<a href="#anchor4">4.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
Using AAA services with SNMP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Applicability">4.2.</a>&nbsp;
Applicability<br />
<a href="#anchor6">5.</a>&nbsp;
Structure of the MIB Module<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.1.</a>&nbsp;
Textual Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.2.</a>&nbsp;
The Table Structure<br />
<a href="#anchor9">6.</a>&nbsp;
Relationship to Other MIB Modules<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">6.1.</a>&nbsp;
Relationship to the VACM MIB<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">6.2.</a>&nbsp;
MIB modules required for IMPORTS<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">6.3.</a>&nbsp;
Documents required for REFERENCE clauses<br />
<a href="#anchor13">7.</a>&nbsp;
Elements of Procedure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">7.1.</a>&nbsp;
Sequencing Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">7.2.</a>&nbsp;
Actions Upon Session Establishment Indication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">7.2.1.</a>&nbsp;
Required Information<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">7.2.2.</a>&nbsp;
Creation of Entries in vacmAaaSecurityToGroupTable<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">7.2.3.</a>&nbsp;
Creation of Entries in vacmSecurityToGroupTable<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">7.2.4.</a>&nbsp;
Update of vacmGroupName<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">7.3.</a>&nbsp;
Actions Upon Session Termination Indication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">7.3.1.</a>&nbsp;
Deletion of Entries from vacmAaaSecurityToGroupTable<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">7.3.2.</a>&nbsp;
Deletion of Entries from vacmSecurityToGroupTable<br />
<a href="#anchor23">8.</a>&nbsp;
Definitions<br />
<a href="#Security">9.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">9.1.</a>&nbsp;
Principal Identity Naming<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">9.2.</a>&nbsp;
Management Information Considerations<br />
<a href="#IANA">10.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor26">11.</a>&nbsp;
Contributors<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
This memo specifies a way to
dynamically provision 
selected View-Based Access Control Model
(VACM) <a class='info' href='#RFC3415'>[RFC3415]<span> (</span><span class='info'>Wijnen, B., Presuhn, R., and K. McCloghrie, &ldquo;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>
Management Information Base (MIB) objects,
based on information received from an 
Authentication, Authorization, and Accounting (AAA) service,
such as RADIUS <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>
and <a class='info' href='#RFC5607'>[RFC5607]<span> (</span><span class='info'>Nelson, D. and G. Weber, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management,&rdquo; July&nbsp;2009.</span><span>)</span></a>.
It reduces the need for security administrators
to manually update VACM configurations due to user churn,
allowing a centralized AAA service to provide
the information associating a given user with the access control policy
(known as a "group" in VACM)
governing that user's access to management information.
      
</p>
<p>
This memo requires no changes to the
Abstract Service Interface for the Access Control Subsystem,
and requires no changes to the Elements of Procedure for VACM.
It provides a MIB module that reflects the information
provided by the AAA service,
along with elements of procedure for maintaining
that information and performing corresponding updates to VACM MIB data.
      
</p>
<p>
The reader is expected to be familiar with
<a class='info' href='#RFC3415'>[RFC3415]<span> (</span><span class='info'>Wijnen, B., Presuhn, R., and K. McCloghrie, &ldquo;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>,
<a class='info' href='#RFC5607'>[RFC5607]<span> (</span><span class='info'>Nelson, D. and G. Weber, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management,&rdquo; July&nbsp;2009.</span><span>)</span></a>,
<a class='info' href='#RFC5608'>[RFC5608]<span> (</span><span class='info'>Narayan, K. and D. Nelson, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Usage for Simple Network Management Protocol (SNMP) Transport Models,&rdquo; August&nbsp;2009.</span><span>)</span></a>,
and their supporting specifications.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
The Internet-Standard Management Framework</h3>

<p>
For a detailed overview of the documents that describe the current
Internet-Standard Management Framework,
please refer to section 7 of RFC 3410 <a class='info' href='#RFC3410'>[RFC3410]<span> (</span><span class='info'>Case, J., Mundy, R., Partain, D., and B. Stewart, &ldquo;Introduction and Applicability Statements for Internet-Standard Management Framework,&rdquo; December&nbsp;2002.</span><span>)</span></a>.
      
</p>
<p>
Managed objects are accessed via a virtual information store,
termed the Management Information Base or MIB.
MIB objects are generally accessed through
the Simple Network Management Protocol (SNMP).
Objects in the MIB are defined
using the mechanisms defined
in the Structure of Management Information (SMI).
This memo specifies a MIB module that is
compliant to the SMIv2, which is described in
STD 58, RFC 2578 <a class='info' href='#RFC2578'>[RFC2578]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Structure of Management Information Version 2 (SMIv2),&rdquo; April&nbsp;1999.</span><span>)</span></a>,
STD 58, RFC 2579 <a class='info' href='#RFC2579'>[RFC2579]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Textual Conventions for SMIv2,&rdquo; April&nbsp;1999.</span><span>)</span></a>
and STD 58, RFC 2580 <a class='info' href='#RFC2580'>[RFC2580]<span> (</span><span class='info'>McCloghrie, K., Perkins, D., and J. Schoenwaelder, &ldquo;Conformance Statements for SMIv2,&rdquo; April&nbsp;1999.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Conventions</h3>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT",
"RECOMMENDED",
"NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this
document are to be interpreted as described in
RFC 2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
      
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Overview</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Using AAA services with SNMP</h3>

<p>
There are two use cases for AAA support of management access via SNMP.
These are (a) service authorization and (b) access control authorization.
The former is discussed in detail in <a class='info' href='#RFC5608'>[RFC5608]<span> (</span><span class='info'>Narayan, K. and D. Nelson, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Usage for Simple Network Management Protocol (SNMP) Transport Models,&rdquo; August&nbsp;2009.</span><span>)</span></a>.
The latter is the subject of this memo.
        
</p>
<p>
The use case assumption here is that
roles within an organization,
which are reflected in VACM as groups, naming access control policies,
change infrequently,
while the users assigned to those roles change much more frequently.
This memo describes how the user-to-role (group) mapping 
can be delegated to the RADIUS server,
avoiding the need to re-provision managed devices
as users are added, deleted, or assigned new roles in an organization.
        
</p>
<p>
This memo assumes that the detailed access control policies
are pre-configured in VACM, and does not attempt to address the
question of how the policy associated with a given role is
put in place.
        
</p>
<p>
The only additional information obtained from the AAA service 
is the mapping of the authenticated user's identifier to
a specific role (or "group" in VACM terminology) in the
access control policy.
Dynamic user authorization for MIB database access control,
as defined herein,
is limited to mapping the authenticated user to a group,
which in turn is mapped to whatever access control policies
are already in place in VACM.
        
</p>
<p>
The SNMP architecture <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>
maintains strong modularity and separation
of concerns, separating user identity (authentication)
from user database access rights (authorization).
RADIUS, on the other hand, allows for no
such separation of authorization from authentication.
Consequently, the approach here is to leverage existing RADIUS usage
for identifying a principal, 
documented in <a class='info' href='#RFC5608'>[RFC5608]<span> (</span><span class='info'>Narayan, K. and D. Nelson, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Usage for Simple Network Management Protocol (SNMP) Transport Models,&rdquo; August&nbsp;2009.</span><span>)</span></a>,
along with the
RADIUS Management-Policy-Id Attribute <a class='info' href='#RFC5607'>[RFC5607]<span> (</span><span class='info'>Nelson, D. and G. Weber, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management,&rdquo; July&nbsp;2009.</span><span>)</span></a>.
        
</p>
<p>
A unique identifier is needed
for each AAA-authorized "session",
corresponding to a communication channel, such as a transport session,
for which a principal has been AAA-authenticated and
which is authorized to offer SNMP service.
How these identifiers are assigned is implementation-dependent.
When a RADIUS Management-Policy-Id Attribute (or equivalent)
is bound to such a session and principal authentication,
this binding provides sufficient information to 
compute dynamic updates to VACM.
How this information is communicated
within an implementation is implementation dependent;
this memo is only concerned with externally observable behavior.
        
</p>
<p>
The key concept here is that what we will informally call
a "AAA binding" binds:
          </p>
<ol class="text">
<li>a communications channel
</li>
<li>an authenticated principal
</li>
<li>service authorization
</li>
<li>an access control policy name
</li>
</ol><p>
Some of the binding is done via other specifications.
A transport model,
such as  the Secure Shell Transport Model <a class='info' href='#RFC5592'>[RFC5592]<span> (</span><span class='info'>Harrington, D., Salowey, J., and W. Hardaker, &ldquo;Secure Shell Transport Model for the Simple Network Management Protocol (SNMP),&rdquo; June&nbsp;2009.</span><span>)</span></a>,
provides a binding between 1) and 2) and 3), providing a securityName.
In turn, <a class='info' href='#RFC5607'>[RFC5607]<span> (</span><span class='info'>Nelson, D. and G. Weber, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management,&rdquo; July&nbsp;2009.</span><span>)</span></a> provides
a binding between (1+2+3) and 4).
This document extends that further, to create a binding between
(1+2+3+4) and the local (VACM MIB) definition of the named policy,
called a group in VACM.
        
</p>
<a name="Applicability"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Applicability</h3>

<p>
Though this memo was motivated to support the use of specific
Transport Models,
such as  the Secure Shell Transport Model <a class='info' href='#RFC5592'>[RFC5592]<span> (</span><span class='info'>Harrington, D., Salowey, J., and W. Hardaker, &ldquo;Secure Shell Transport Model for the Simple Network Management Protocol (SNMP),&rdquo; June&nbsp;2009.</span><span>)</span></a>,
it MAY be used with other implementation environments
satisfying these requirements:
          <br />
<br />

          </p>
<ul class="text">
<li>
use an AAA service for sign-on service and data access authorization;
            
</li>
<li>
provide an indication of the start of
a session for a particular authenticated principal,
identified using an SNMP securityName <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>,
and provide
the corresponding value to be used to identify a VACM group to be
used, based on information provided by the AAA
service in use;
            
</li>
<li>
provide an indication of the end of
the need for being able to make access decisions
for a particular authenticated principal,
as at the end of a
session, whether due to disconnection,
termination due to timeout, or any other reason.
            
</li>
</ul><p>
        
</p>
<p>
Likewise, although this memo specifically refers to RADIUS,
it MAY be used with other AAA services satisfying these requirements:
          <br />
<br />

          </p>
<ul class="text">
<li>
the service provides information semantically
equivalent to the RADIUS Management-Policy-Id
Attribute <a class='info' href='#RFC5607'>[RFC5607]<span> (</span><span class='info'>Nelson, D. and G. Weber, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management,&rdquo; July&nbsp;2009.</span><span>)</span></a>,
which corresponds to the name of a VACM group;
            
</li>
<li>
the service provides an authenticated principal identifier
(e.g., the RADIUS User-Name Attribute <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>)
which can be transformed to an equivalent principal
identifier in the form of a securityName <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>.
            
</li>
</ul><p>
        
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Structure of the MIB Module</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Textual Conventions</h3>

<p>
This MIB module makes use of the
SnmpAdminString <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>
and SnmpSecurityModel <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>
textual conventions.
        
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
The Table Structure</h3>

<p>
This MIB module defines a single table, the vacmAaaSecurityToGroupTable.
This table is indexed by the integer assigned to each security model,
the protocol-independent securityName corresponding to a principal,
and the unique identifier of a session.
        
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Relationship to Other MIB Modules</h3>

<p>
This MIB module has a close operational relationship
with the SNMP-VIEW-BASED-ACM-MIB (more commonly known
as the "VACM MIB") from <a class='info' href='#RFC3415'>[RFC3415]<span> (</span><span class='info'>Wijnen, B., Presuhn, R., and K. McCloghrie, &ldquo;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>.
It also relies on IMPORTS from several other modules.
      
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Relationship to the VACM MIB</h3>

<p>
Although the MIB module defined here has a close relationship
with the VACM MIB's vacmSecurityToGroupTable,
it in no way changes the elements of procedure for VACM,
nor does it affect any other tables defined in VACM.
See the elements of procedure (below) for details
of how the contents of the vacmSecurityToGroupTable
are affected by this MIB module.
        
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
MIB modules required for IMPORTS</h3>

<p>
This MIB module employs definitions from
<a class='info' href='#RFC2578'>[RFC2578]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Structure of Management Information Version 2 (SMIv2),&rdquo; April&nbsp;1999.</span><span>)</span></a>,
<a class='info' href='#RFC2579'>[RFC2579]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Textual Conventions for SMIv2,&rdquo; April&nbsp;1999.</span><span>)</span></a> and
<a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>.
        
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Documents required for REFERENCE clauses</h3>

<p>
This MIB module contains REFERENCE clauses making reference to
<a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>,
<a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>,
and
<a class='info' href='#RFC5590'>[RFC5590]<span> (</span><span class='info'>Harrington, D. and J. Schoenwaelder, &ldquo;Transport Subsystem for the Simple Network Management Protocol (SNMP),&rdquo; June&nbsp;2009.</span><span>)</span></a>.
        
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Elements of Procedure</h3>

<p>
The following elements of procedure are formulated
in terms of two types of events: an indication of
the establishment of a session,
and an indication that one has ended.
These can result in the creation of entries in
the vacmAaaSecurityToGroupTable, which can in turn trigger
creation, update, or deletion
of entries in the vacmSecurityToGroupTable.
      
</p>
<p>
There are various possible implementation-dependent
error cases not spelled out here, such as running
out of memory.
By their nature, recovery in such cases will be implementation-dependent.
Implementors are advised to consider fail-safe strategies, e.g.,
prematurely terminating access in preference to
erroneously perpetuating access.
      
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Sequencing Requirements</h3>

<p>
These procedures assume that a transport model,
such as <a class='info' href='#RFC5592'>[RFC5592]<span> (</span><span class='info'>Harrington, D., Salowey, J., and W. Hardaker, &ldquo;Secure Shell Transport Model for the Simple Network Management Protocol (SNMP),&rdquo; June&nbsp;2009.</span><span>)</span></a>,
coordinates session establishment with
AAA authentication and authorization.
They rely on the receipt by the AAA client of
the RADIUS Management-Policy-Id <a class='info' href='#RFC5607'>[RFC5607]<span> (</span><span class='info'>Nelson, D. and G. Weber, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management,&rdquo; July&nbsp;2009.</span><span>)</span></a>
Attribute (or its equivalent)
from the RADIUS Access-Accept message (or equivalent).
They also assume that the User-Name <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>
from the RADIUS Access-Request message (or equivalent)
corresponds to a securityName <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>.
        
</p>
<p>
To ensure correct processing of SNMP PDUs,
the handling of the indication of the
establishment of a session in accordance with the elements of
procedure below MUST be completed before
the isAccessAllowed() abstract service interface
<a class='info' href='#RFC3415'>[RFC3415]<span> (</span><span class='info'>Wijnen, B., Presuhn, R., and K. McCloghrie, &ldquo;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>
is invoked for any SNMP PDUs from that session.
        
</p>
<p>
If a session termination indication occurs
before all invocations of the isAccessAllowed() abstract
service interface
<a class='info' href='#RFC3415'>[RFC3415]<span> (</span><span class='info'>Wijnen, B., Presuhn, R., and K. McCloghrie, &ldquo;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>
have completed for all SNMP PDUs
from that session, those remaining invocations MAY result
in denial of access.
        
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Actions Upon Session Establishment Indication</h3>

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2.1"></a><h3>7.2.1.&nbsp;
Required Information</h3>

<p>
Four pieces of information are needed to process the
session establishment indication:
            </p>
<ul class="text">
<li>
the SnmpSecurityModel <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>
needed as an index into the vacmSecurityToGroupTable;
              
</li>
<li>
the RADIUS User-Name Attribute;
              
</li>
<li>
a session identifier,
as a unique, definitive identifier of the session
that the AAA authorization is tied to;
              
</li>
<li>
the RADIUS Management-Policy-Id Attribute.

              
</li>
</ul><p>
All four of these pieces of information are REQUIRED.
In particular, if either the User-Name or Management-Policy-Id is
absent, invalid, or a zero-length string, no further processing
of the session establishment indication is undertaken.
          
</p>
<p>
As noted in <a class='info' href='#Applicability'>Section&nbsp;4.2<span> (</span><span class='info'>Applicability</span><span>)</span></a>,
the above text refers specifically to RADIUS attributes.
Other AAA services can be substituted,
but the requirements imposed on the User-Name and
the Management-Policy-Id-Attribute MUST be
satisfied using the equivalent fields for those services.
          
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2.2"></a><h3>7.2.2.&nbsp;
Creation of Entries in vacmAaaSecurityToGroupTable</h3>

<p>
Whenever an indication arrives that a new 
session has been established, determine whether a corresponding entry
exists in the vacmAaaSecurityToGroupTable.
If one does not, create a new row with the columns populated as follows:

            </p>
<ul class="text">
<li>
vacmAaaSecurityModel = value of SnmpSecurityModel
corresponding to the security model in use;
              
</li>
<li>
vacmAaaSecurityName = RADIUS User-Name Attribute or equivalent,
the securityName that will be used in invocations of the
isAccessAllowed() abstract service interface
<a class='info' href='#RFC3415'>[RFC3415]<span> (</span><span class='info'>Wijnen, B., Presuhn, R., and K. McCloghrie, &ldquo;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>;
              
</li>
<li>
vacmAaaSessionID = session identifier,
unique across
all open sessions of all of this SNMP engine's
transport models;
              
</li>
<li>
vacmAaaGroupName = RADIUS Management-Policy-Id Attribute or equivalent.
              
</li>
</ul><p>

Otherwise, if the row already exists, update the vacmAaaGroupName with the
the RADIUS Management-Policy-Id Attribute or equivalent supplied.
          
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2.3"></a><h3>7.2.3.&nbsp;
Creation of Entries in vacmSecurityToGroupTable</h3>

<p>
Whenever an entry is created in the vacmAaaSecurityToGroupTable,
the vacmSecurityToGroupTable is examined to determine whether
a corresponding entry exists there,
using the value of vacmAaaSecurityModel for vacmSecurityModel,
and the value of vacmAaaSecurityName for vacmSecurityName.
If no corresponding entry exists,
create one, using the vacmAaaGroupName of the newly created
entry to fill in vacmGroupName,
using a value of "volatile" for the row's StorageType,
and  a value of "active" for its RowStatus.
          
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2.4"></a><h3>7.2.4.&nbsp;
Update of vacmGroupName</h3>

<p>
Whenever the value of an instance of vacmAaaGroupName is updated,
if a corresponding entry exists in the vacmSecurityToGroupTable,
and that entry's StorageType is "volatile"
and its RowStatus is "active", 
update the value of vacmGroupName
with the value from vacmAaaGroupName.
          
</p>
<p>
If a corresponding entry already exists in the
vacmSecurityToGroupTable,
and that row's StorageType is anything other than "volatile",
or its RowStatus is anything other than "active",
then that instance of vacmGroupName MUST NOT be modified.
          
</p>
<p>
The operational assumption here is that if the
row's StorageType is "volatile",
then this entry was probably dynamically created;
an entry created by a security administrator
would not normally be given a StorageType of "volatile".
If value being provided by RADIUS (or other AAA service)
is the same as what is already there, this is a no-op.
If the value is different, the
new information is understood as a more recent role (group)
assignment for the user, which should supersede the one
currently held there.
The structure of the vacmSecurityToGroupTable makes it
impossible for a (vacmSecurityModel, vacmSecurityName) tuple to
map to more than one group.
          
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Actions Upon Session Termination Indication</h3>

<p>
Whenever a RADIUS (or other AAA) authenticated
session ends for any reason,
an indication is provided.
This indication MUST provide means of determining the SnmpSecurityModel, 
and an identifier for the transport session
tied to the AAA authorization.
The manner in which this occurs is implementation dependent.
        
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3.1"></a><h3>7.3.1.&nbsp;
Deletion of Entries from vacmAaaSecurityToGroupTable</h3>

<p>
Entries in the vacmAaaSecurityToGroupTable MUST NOT persist across
system reboots.
          
</p>
<p>
When a session has been terminated, the
vacmAaaSecurityToGroupTable is searched for a corresponding entry.
A "matching" entry is any entry
for which the SnmpSecurityModel and session ID match the
information associated with the session termination indication.
Any matching entries are deleted.
It is possible that no entries will match;
this is not an error,
and no special processing is required in this case.
          
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3.2"></a><h3>7.3.2.&nbsp;
Deletion of Entries from vacmSecurityToGroupTable</h3>

<p>
Whenever the last remaining row bearing a particular
(vacmAaaSecurityModel, vacmAaaSecurityName) pair is deleted
from the vacmAaaSecurityToGroupTable,
the vacmSecurityToGroupTable is examined for a corresponding row.
If one exists, and if its StorageType is "volatile" and its
RowStatus is "active", that row MUST be deleted as well.
The mechanism to accomplish this task is implementation-dependent.
          
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Definitions</h3>

<p></p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

SNMP-VACM-AAA-MIB DEFINITIONS ::= BEGIN

IMPORTS
    MODULE-COMPLIANCE, OBJECT-GROUP       FROM SNMPv2-CONF
    MODULE-IDENTITY, OBJECT-TYPE,
    mib-2,
    Unsigned32                            FROM SNMPv2-SMI
    SnmpAdminString,
    SnmpSecurityModel                     FROM SNMP-FRAMEWORK-MIB;

vacmAaaMIB    MODULE-IDENTITY
    LAST-UPDATED "201009010000Z"          -- 1 September, 2010
    ORGANIZATION "ISMS Working Group"
    CONTACT-INFO "WG-email:   isms@ietf.org"

    DESCRIPTION  "The management and local datastore information
                  definitions for the AAA-Enabled View-based Access
                  Control Model for SNMP.

                  Copyright (c) 2010 IETF Trust and the persons
                  identified as the document authors.  All rights
                  reserved.

                  Redistribution and use in source and binary forms,
                  with or without modification, is permitted pursuant
                  to, and subject to the license terms contained in,
                  the Simplified BSD License set forth in Section
                  4.c of the IETF Trust's Legal Provisions Relating
                  to IETF Documents
                  (http://trustee.ietf.org/license-info).

                  This version of this MIB module is part of RFC XXXX;
                  see the RFC itself for full legal notices."

    REVISION "201009010000Z"
    DESCRIPTION "Initial version, published as RFC XXXX."
     ::= { mib-2 XXX }
-- RFC Ed.: replace XXX with IANA-assigned number &amp; remove this note
-- RFC Ed.: replace XXXX with the RFC number &amp; remove this note

vacmAaaMIBObjects   OBJECT IDENTIFIER ::= { vacmAaaMIB 1 }

vacmAaaMIBConformance OBJECT IDENTIFIER ::= { vacmAaaMIB 2 }

vacmAaaSecurityToGroupTable OBJECT-TYPE
    SYNTAX       SEQUENCE OF VacmAaaSecurityToGroupEntry
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION "This table provides a listing of all currently active
                 sessions for which a mapping of the combination of
                 SnmpSecurityModel and securityName into the name of
                 a VACM group which has been provided by an AAA service.
                 The group name (in VACM) in turn identifies an access
                 control policy to be used for the corresponding
                 principals."
    REFERENCE   "RFC 3411 section 3.2.2 defines securityName"
    ::= { vacmAaaMIBObjects 1 }

vacmAaaSecurityToGroupEntry OBJECT-TYPE
    SYNTAX       VacmAaaSecurityToGroupEntry
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION "An entry in this table maps the combination of a
                 SnmpSecurityModel and securityName into the name
                 of a VACM group defining the access control policy
                 which is to govern a particular session.

                 Each entry corresponds to a session.

                 Entries do not persist across reboots.

                 An entry is created whenever an indication occurs
                 that a new session has been established that would
                 not have the same index values as an existing entry.

                 When a session is torn down, disconnected, timed out
                 (e.g., following the RADIUS Session-Timeout Attribute),
                 or otherwise terminated for any reason, the
                 corresponding vacmAaaSecurityToGroupEntry is deleted."
    REFERENCE   "RFC 3411 section 3.2.2 defines securityName"
    INDEX       {
                  vacmAaaSecurityModel,
                  vacmAaaSecurityName,
                  vacmAaaSessionID
                }
    ::= { vacmAaaSecurityToGroupTable 1 }

VacmAaaSecurityToGroupEntry ::= SEQUENCE
    {
        vacmAaaSecurityModel            SnmpSecurityModel,
        vacmAaaSecurityName             SnmpAdminString,
        vacmAaaSessionID                Unsigned32,
        vacmAaaGroupName                SnmpAdminString
    }

vacmAaaSecurityModel OBJECT-TYPE
    SYNTAX       SnmpSecurityModel(1..2147483647)
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION "The security model associated with the AAA binding
                 represented by this entry.

                 This object cannot take the 'any' (0) value."
    ::= { vacmAaaSecurityToGroupEntry 1 }

vacmAaaSecurityName OBJECT-TYPE
    SYNTAX       SnmpAdminString (SIZE(1..32))
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION "The securityName of the principal associated with the
                 AAA binding represented by this entry.  In RADIUS
                 environments, this corresponds to the User-Name
                 Attribute."
    REFERENCE   "RFC 3411 section 3.2.2 defines securityName, and
                 RFC 2865 section 5.1 defines User-Name."
    ::= { vacmAaaSecurityToGroupEntry 2 }

vacmAaaSessionID OBJECT-TYPE
    SYNTAX       Unsigned32
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION "An implementation-dependent identifier of the session.

                 This value MUST be unique among all currently open
                 sessions of all of this SNMP engine's transport models.
                 The value has no particular significance other than to
                 distinguish sessions.

                 Implementations in which tmSessionID has a compatible
                 syntax and is unique across all transport models MAY
                 use that value."
    REFERENCE   "The abstract service interface parameter tmSessionID
                 is defined in RFC 5590 section 5.2.4."
    ::= { vacmAaaSecurityToGroupEntry 3 }

vacmAaaGroupName    OBJECT-TYPE
    SYNTAX       SnmpAdminString (SIZE(1..32))
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The name of the group to which this entry is to belong.
                 In RADIUS environments this comes from the RADIUS
                 Management-Policy-Id Attribute.

                 When the appropriate conditions are met,
                 the value of this object is applied the vacmGroupName
                 in the corresponding vacmSecurityToGroupEntry."
    REFERENCE    "RFC 3415"
    ::= { vacmAaaSecurityToGroupEntry 4 }


-- Conformance information ******************************************

vacmAaaMIBCompliances
               OBJECT IDENTIFIER ::= {vacmAaaMIBConformance 1}
vacmAaaMIBGroups
               OBJECT IDENTIFIER ::= {vacmAaaMIBConformance 2}

-- compliance statements

vacmAaaMIBBasicCompliance MODULE-COMPLIANCE
    STATUS       current
    DESCRIPTION "The compliance statement for SNMP engines implementing
                 the AAA-Enabled View-based Access Control Model for
                 SNMP."
    MODULE    -- this module
        MANDATORY-GROUPS { vacmAaaGroup }

    ::= { vacmAaaMIBCompliances 1 }

-- units of conformance

vacmAaaGroup OBJECT-GROUP
    OBJECTS {
              vacmAaaGroupName
            }
    STATUS       current
    DESCRIPTION "A collection of objects for supporting the use of AAA
                 services to provide user / group mappings for VACM."
    ::= { vacmAaaMIBGroups 1 }


END
</pre></div><p>

</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>
The algorithms in this memo make heuristic use of the StorageType
of entries in the vacmSecurityToGroupTable to distinguish
those provisioned by a security administrator
(which would presumably not be configured as "volatile") from
those dynamically generated.
In making this distinction,
it assumes that those entries explicitly provisioned by
a security administrator and given a non-"volatile" status
are not to be dynamically overridden.
Furthermore,
it assumes that any active entries with "volatile" status
can be treated as dynamic,
and deleted or updated as needed.
Users of this memo need to be aware of this operational assumption,
which, while reasonable, is not necessarily universally valid.
For example,
this situation could also occur if the SNMP security administrator
had mistakenly created these non-volatile entries in error.
      
</p>
<p>
The design of VACM ensures that if an unknown policy (group name)
is used in the vacmSecurityToGroupTable, no access is granted.
A consequence of this is that no matter what information
is provided by the AAA server,
no user can gain SNMP access rights
not already granted to some group through the VACM configuration.
      
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Principal Identity Naming</h3>

<p>
In order to ensure that the access control policy
ultimately applied as a result of the mechanisms
described here is indeed the intended policy for a given principal
using a particular security model,
care needs to be applied in the mapping
of the authenticated user (principal) identity
to the securityName used to make the access control decision.
Broadly speaking,
there are two approaches to ensure consistency of identity:
               
          </p>
<ul class="text">
<li>
Entries for the vacmSecurityToGroupTable corresponding
to a given security model are created only through the
operation of the procedures described in this memo.
A consequence of this would be that all such entries
would have been created using
the RADIUS User-Name (or other AAA-authenticated identity)
and RADIUS Management-Policy-Id Attribute (or equivalent).
            
</li>
<li>
Administrative policy allows
a matching pre-configured entry to exist
in the vacmSecurityToGroupTable,
i.e., an entry with the corresponding vacmSecurityModel
and with a vacmSecurityName matching the
authenticated principal's RADIUS User-Name.
In this case, administrative policy also needs to ensure
consistency of identity between each authenticated
principal's RADIUS User-Name and the administratively configured
vacmSecurityName in the vacmSecurityToGroupTable row entries
for that particular security model.
            
</li>
</ul><p>

In the later case, inconsistent re-use of the same name
for different entities or individuals (principals)
can cause the incorrect access control policy to be
applied for the authenticated principal, depending on
whether the policy configured using SNMP, or the policy
applied using the procedures of this memo, is the intended policy.
This may result in greater or lesser access rights than
the administrative policy intended.
Inadvertent mis-identification in such cases
may be undetectable by the SNMP engine or other
software elements of the managed entity.
        
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
Management Information Considerations</h3>

<p>
There are no management objects defined in this MIB module that have
a MAX-ACCESS clause of read-write and/or read-create.
So, if this MIB module is implemented correctly,
then there is no risk that an
intruder can alter or create any management objects of this MIB
module via direct SNMP SET operations.
        
</p>
<p>
Some of the readable objects in this MIB module (including
some objects with a MAX-ACCESS of not-accessible, whose values
are exposed as a result access to indexed objects)
may be considered sensitive or
vulnerable in some network environments.
It is thus important to control
even GET and/or NOTIFY access to these objects and possibly to even
encrypt the values of these objects when sending them over the network
via SNMP.
These are the tables and objects and their
sensitivity/vulnerability:
          <br />
<br />

          </p>
<ul class="text">
<li>
vacmAaaSecurityToGroupTable - the entire table is potentially sensitive,
since walking the table will reveal user names,
security models in use, session identifiers, and group names;
            
</li>
<li>
vacmAaaSecurityModel - though not-accessible, this is exposed
as an index of vacmAaaGroupName;
            
</li>
<li>
vacmAaaSecurityName - though not-accessible, this is exposed
as an index of vacmAaaGroupName;
            
</li>
<li>
vacmAaaSessionID - though not-accessible, this is exposed
as an index of vacmAaaGroupName;
            
</li>
<li>
vacmAaaGroupName - since this identifies a security policy and
associates it with a particular user, this is potentially sensitive.
            
</li>
</ul><p>
        
</p>
<p>
SNMP versions prior to SNMPv3 did not include adequate security.
Even if the network itself is secure
(for example by using IPsec), even then,
there is no control as to who on the secure network is allowed to access
and GET/SET (read/change/create/delete) the objects in this MIB module.
        
</p>
<p>
It is RECOMMENDED that implementers consider the security features as
provided by the SNMPv3 framework (see <a class='info' href='#RFC3410'>[RFC3410]<span> (</span><span class='info'>Case, J., Mundy, R., Partain, D., and B. Stewart, &ldquo;Introduction and Applicability Statements for Internet-Standard Management Framework,&rdquo; December&nbsp;2002.</span><span>)</span></a>,
section 8), including full support for the SNMPv3 cryptographic
mechanisms (for authentication and privacy).
        
</p>
<p>
Further, deployment of SNMP versions prior to SNMPv3 is NOT RECOMMENDED.
Instead, it is RECOMMENDED to deploy SNMPv3
and to enable cryptographic security.
It is then a customer/operator responsibility to
ensure that the SNMP entity giving access to an instance of this MIB
module is properly configured to give access to the objects only to
those principals (users) that have legitimate rights to indeed GET or
SET (change/create/delete) them.
        
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>
The MIB module in this document uses the following IANA-assigned
OBJECT IDENTIFIER value recorded in the SMI Numbers registry:
      
</p>
<p></p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   Descriptor        OBJECT IDENTIFIER value
   ----------        -----------------------
   vacmAaaMIB        { mib-2 XXX }

</pre></div><p>

</p>
<p>
Editor's Note
(to be removed prior to publication):
the IANA is requested to assign a value for "XXX" under the 'mib-2' subtree
and to record the assignment in the SMI Numbers registry.
When the assignment has been made, the RFC Editor is asked to replace
"XXX" (here and in the MIB module) with the assigned value and to
remove this note.
      
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Contributors</h3>

<p>The following participants from the isms working group
      contributed to the development of this document:
        </p>
<ul class="text">
<li>Andrew Donati
</li>
<li>David Harrington
</li>
<li>Jeffrey Hutzelman
</li>
<li>J&uuml;rgen Sch&ouml;nw&auml;lder
</li>
<li>Tom Petch
</li>
<li>Wes Hardaker
</li>
</ul><p>
      
</p>
<p>
During the IESG review additional comments were
received from:
        </p>
<ul class="text">
<li>Adrian Farrel
</li>
<li>Amanda Baber
</li>
<li>Dan Romescanu
</li>
<li>David Kessens
</li>
<li>Francis Dupont
</li>
<li>Glenn Keeni
</li>
<li>Jari Arkko
</li>
<li>Joel Jaeggli
</li>
<li>Magnus Nystr&ouml;m
</li>
<li>Mike Heard
</li>
<li>Robert Story
</li>
<li>Russ Housley
</li>
<li>Sean Turner
</li>
<li>Tim Polk
</li>
</ul><p>
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2578">[RFC2578]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K., Ed.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D., Ed.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder, Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2578">Structure of Management Information Version 2 (SMIv2)</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2578, April&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2578.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2579">[RFC2579]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K., Ed.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D., Ed.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder, Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2579">Textual Conventions for SMIv2</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2579, April&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2579.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2580">[RFC2580]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2580">Conformance Statements for SMIv2</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2580, April&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2580.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2865">[RFC2865]</a></td>
<td class="author-text">Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;2865, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2865.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3411">[RFC3411]</a></td>
<td class="author-text">Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;<a href="http://tools.ietf.org/html/rfc3411">An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3411, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3411.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3415">[RFC3415]</a></td>
<td class="author-text">Wijnen, B., Presuhn, R., and K. McCloghrie, &ldquo;<a href="http://tools.ietf.org/html/rfc3415">View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP)</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3415, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3415.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5590">[RFC5590]</a></td>
<td class="author-text">Harrington, D. and J. Schoenwaelder, &ldquo;<a href="http://tools.ietf.org/html/rfc5590">Transport Subsystem for the Simple Network Management Protocol (SNMP)</a>,&rdquo; RFC&nbsp;5590, June&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5590.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5607">[RFC5607]</a></td>
<td class="author-text">Nelson, D. and G. Weber, &ldquo;<a href="http://tools.ietf.org/html/rfc5607">Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management</a>,&rdquo; RFC&nbsp;5607, July&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5607.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5608">[RFC5608]</a></td>
<td class="author-text">Narayan, K. and D. Nelson, &ldquo;<a href="http://tools.ietf.org/html/rfc5608">Remote Authentication Dial-In User Service (RADIUS) Usage for Simple Network Management Protocol (SNMP) Transport Models</a>,&rdquo; RFC&nbsp;5608, August&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5608.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3410">[RFC3410]</a></td>
<td class="author-text">Case, J., Mundy, R., Partain, D., and B. Stewart, &ldquo;<a href="http://tools.ietf.org/html/rfc3410">Introduction and Applicability Statements for Internet-Standard Management Framework</a>,&rdquo; RFC&nbsp;3410, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3410.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5592">[RFC5592]</a></td>
<td class="author-text">Harrington, D., Salowey, J., and W. Hardaker, &ldquo;<a href="http://tools.ietf.org/html/rfc5592">Secure Shell Transport Model for the Simple Network Management Protocol (SNMP)</a>,&rdquo; RFC&nbsp;5592, June&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5592.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kaushik Narayan</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10 West Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jos&eacute;, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408-526-8168</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:kaushik_narayan@yahoo.com">kaushik_narayan@yahoo.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David Nelson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Elbrys Networks, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">282 Corporate Drive, Unit #1,</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Portsmouth, NH  03801</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 603-570-2636</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:d.b.nelson@comcast.net">d.b.nelson@comcast.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Randy Presuhn (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">None</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jos&eacute;, CA  95120</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:randy_presuhn@mindspring.com">randy_presuhn@mindspring.com</a></td></tr>
</table>
</body></html>
