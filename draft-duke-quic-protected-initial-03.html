<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Protected QUIC Initial Packets</title>
<meta content="Martin Duke" name="author">
<meta content="David Schinazi" name="author">
<meta content="
       QUIC encrypts its Initial Packets using keys derived from well-known constants,
meaning that observers can inspect the contents of these packets and
successfully spoof them. This document proposes a new version of QUIC that
encrypts Initial Packets more securely by leveraging a Public Key distributed
via the Domain Name System (DNS) or other out-of-band system. 
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="draft-duke-quic-protected-initial-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.2.0
    six 1.16.0
-->
<link href="/tmp/draft-duke-quic-protected-initial-03-w_bvr8on.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">protected-initial</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Duke &amp; Schinazi</td>
<td class="center">Expires 28 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">quic</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-duke-quic-protected-initial-03</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-25" class="published">25 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-28">28 April 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Duke</div>
<div class="org">F5 Networks, Inc.</div>
</div>
<div class="author">
      <div class="author-name">D. Schinazi</div>
<div class="org">Google LLC</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Protected QUIC Initial Packets</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">QUIC encrypts its Initial Packets using keys derived from well-known constants,
meaning that observers can inspect the contents of these packets and
successfully spoof them. This document proposes a new version of QUIC that
encrypts Initial Packets more securely by leveraging a Public Key distributed
via the Domain Name System (DNS) or other out-of-band system.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    mailing list (quic@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/quic/">https://mailarchive.ietf.org/arch/browse/quic/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/martinduke/quic-version-aliasing">https://github.com/martinduke/quic-version-aliasing</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-relationship-to-ech-and-ver" class="xref">Relationship to ECH and Version Aliasing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions" class="xref">Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-differences-with-quic-versi" class="xref">Differences with QUIC Version 1</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-version-number" class="xref">Version Number</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-key-configuration" class="xref">Key Configuration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-key-derivation-labels" class="xref">Key Derivation Labels</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-initial-packet-header" class="xref">Initial Packet Header</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-encryption-context" class="xref">Encryption Context</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-client-packet-protection-pr" class="xref">Client Packet Protection Procedure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-server-packet-protection-pr" class="xref">Server Packet Protection Procedure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-retry-integrity-tag" class="xref">Retry Integrity Tag</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="xref">3.8</a>.  <a href="#name-fallback" class="xref">Fallback</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="xref">3.9</a>.  <a href="#name-the-fallback-packet" class="xref">The Fallback Packet</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10">
                <p id="section-toc.1-1.3.2.10.1"><a href="#section-3.10" class="xref">3.10</a>. <a href="#name-new-transport-parameters" class="xref">New Transport Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10.2.1">
                    <p id="section-toc.1-1.3.2.10.2.1.1"><a href="#section-3.10.1" class="xref">3.10.1</a>.  <a href="#name-public_key_failed" class="xref">public_key_failed</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10.2.2">
                    <p id="section-toc.1-1.3.2.10.2.2.1"><a href="#section-3.10.2" class="xref">3.10.2</a>.  <a href="#name-echconfig" class="xref">ECHConfig</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10.2.3">
                    <p id="section-toc.1-1.3.2.10.2.3.1"><a href="#section-3.10.3" class="xref">3.10.3</a>.  <a href="#name-initial_encryption_context" class="xref">initial_encryption_context</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-intermediaries" class="xref">Intermediaries</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-client-facing-server" class="xref">Client-Facing Server</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-back-end-server" class="xref">Back-End Server</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-applicability" class="xref">Applicability</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-and-privacy-consid" class="xref">Security and Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-forcing-downgrade" class="xref">Forcing Downgrade</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-initial-packet-injection" class="xref">Initial Packet Injection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-retry-injection" class="xref">Retry Injection</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-quic-version-registry" class="xref">QUIC Version Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-quic-transport-parameter-re" class="xref">QUIC Transport Parameter Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-quic-transport-error-codes-" class="xref">QUIC Transport Error Codes Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-change-log" class="xref">Change Log</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-since-draft-duke-quic-prote" class="xref">since draft-duke-quic-protected-initials-01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-since-draft-duke-quic-protec" class="xref">since draft-duke-quic-protected-initials-00</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">DISCLAIMER: This draft is a preliminary proposal with insufficient security
analysis. It should not be used in production systems.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The QUIC Initial Packet <span>[<a href="#RFC9000" class="xref">RFC9000</a>]</span> is encrypted using a key derived from the
Destination Connection ID in the packet cleartext and a well-known salt (see
Section 5.2 of <span>[<a href="#RFC9001" class="xref">RFC9001</a>]</span>). Section 7 of that draft describes security
vulnerabilities resulting from the resulting lack of authentication.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This also has privacy implications, as observers can decrypt the packet and
inspect the contents, which contain the TLS Client Hello and Server Hello
Messages (<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>). The former contains QUIC Transport Parameters, which
reveal even more information about the traffic.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Furthermore, packets vulnerable to deep inspection create an ossification
vector. Intermediaries that expect the contents of these messages to match a
certain format and template might drop packets that do not, preventing the use
of new protocol extensions or improved security protocols.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This document proposes a new version of QUIC where the client obtains a public
key generated by the server and uses it to encrypt a shared secret, sent in the
Initial packet header, that both endpoints can then use to protect Initial
packets.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">This mechanism leverages the public key that would be distributed via DNS (or
other out-of-band mechanism) to support Encrypted Client Hello
<span>[<a href="#ECHO" class="xref">ECHO</a>]</span>. That design uses Hybrid Public Key Exchange (HPKE)
<span>[<a href="#HPKE" class="xref">HPKE</a>]</span> to authenticate some HPKE configuration
information and the "outer client hello" that is in plaintext, while encrypting
the "inner client hello" that contains privacy-sensitive information. This
document uses the widespread configuration that will exist if ECHO is widely
deployed, but only sends the subset of information necessary to seed the QUIC
key generation process.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="relationship-to-ech-and-version-aliasing">
<section id="section-1.1">
        <h3 id="name-relationship-to-ech-and-ver">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-relationship-to-ech-and-ver" class="section-name selfRef">Relationship to ECH and Version Aliasing</a>
        </h3>
<p id="section-1.1-1">Encrypted Client Hello <span>[<a href="#ECHO" class="xref">ECHO</a>]</span> and QUIC Version Aliasing
<span>[<a href="#VERSION-ALIASING" class="xref">VERSION-ALIASING</a>]</span> also exist in the solution
space of concealing parts of the Initial packet exchange from observers. The
following table summarizes the advantages and disadvantages of each.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Property</th>
              <th class="text-center" rowspan="1" colspan="1">ECH</th>
              <th class="text-center" rowspan="1" colspan="1">Protected Initials</th>
              <th class="text-center" rowspan="1" colspan="1">Version Aliasing</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Fields Protected</td>
              <td class="text-center" rowspan="1" colspan="1">Some of Client Hello</td>
              <td class="text-center" rowspan="1" colspan="1">All Initial Payloads</td>
              <td class="text-center" rowspan="1" colspan="1">All Initial Payloads</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Delay when server loses its keys</td>
              <td class="text-center" rowspan="1" colspan="1">1 RTT</td>
              <td class="text-center" rowspan="1" colspan="1">2 RTT</td>
              <td class="text-center" rowspan="1" colspan="1">2 RTT</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Works with TLS over TCP</td>
              <td class="text-center" rowspan="1" colspan="1">Yes</td>
              <td class="text-center" rowspan="1" colspan="1">No</td>
              <td class="text-center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">First-connection protection</td>
              <td class="text-center" rowspan="1" colspan="1">Yes</td>
              <td class="text-center" rowspan="1" colspan="1">Yes</td>
              <td class="text-center" rowspan="1" colspan="1">No</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Prevents Initial packet injection attacks</td>
              <td class="text-center" rowspan="1" colspan="1">No</td>
              <td class="text-center" rowspan="1" colspan="1">Yes</td>
              <td class="text-center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Symmetric Encryption Only</td>
              <td class="text-center" rowspan="1" colspan="1">No</td>
              <td class="text-center" rowspan="1" colspan="1">No</td>
              <td class="text-center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Greases the Version Field</td>
              <td class="text-center" rowspan="1" colspan="1">No</td>
              <td class="text-center" rowspan="1" colspan="1">No</td>
              <td class="text-center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Prevents Retry injection attacks</td>
              <td class="text-center" rowspan="1" colspan="1">No</td>
              <td class="text-center" rowspan="1" colspan="1">No</td>
              <td class="text-center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">No trial decryption</td>
              <td class="text-center" rowspan="1" colspan="1">No</td>
              <td class="text-center" rowspan="1" colspan="1">No</td>
              <td class="text-center" rowspan="1" colspan="1">Yes</td>
            </tr>
          </tbody>
        </table>
<p id="section-1.1-3">The more complex properties in the table are discussed in
<a href="#security-considerations" class="xref">Section 6</a>.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">Both ECH and Protected Initials are complimentary with Version Aliasing: they
provide a computationally expensive way to protect parts of the Initial packet
during the first connection between client and server, after which Version
Aliasing can protect future exchanges with several additional desirable
properties.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conventions">
<section id="section-2">
      <h2 id="name-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
interpreted as described in RFC 2119 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="differences-with-quic-version-1">
<section id="section-3">
      <h2 id="name-differences-with-quic-versi">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-differences-with-quic-versi" class="section-name selfRef">Differences with QUIC Version 1</a>
      </h2>
<p id="section-3-1">The version of QUIC described in this specification is identical to QUIC version
1 <span>[<a href="#RFC9000" class="xref">RFC9000</a>]</span> except where described in this document.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="version-number">
<section id="section-3.1">
        <h3 id="name-version-number">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-version-number" class="section-name selfRef">Version Number</a>
        </h3>
<p id="section-3.1-1">The version field in long headers is TBD. Note: for interoperability
exercises, use the provisional value 0xff454900.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-configuration">
<section id="section-3.2">
        <h3 id="name-key-configuration">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-key-configuration" class="section-name selfRef">Key Configuration</a>
        </h3>
<p id="section-3.2-1">The client obtains the Encrypted ClientHello Configuration (ECHConfig) described
in Section 4 of <span>[<a href="#ECHO" class="xref">ECHO</a>]</span>, which provides the context that allows protection of
Initial packets. The ECHConfig is available via a DNS record or other out-of-
band system.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="labels">
<section id="section-3.3">
        <h3 id="name-key-derivation-labels">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-key-derivation-labels" class="section-name selfRef">Key Derivation Labels</a>
        </h3>
<p id="section-3.3-1">The labels used to derive keying material in <span>[<a href="#RFC9001" class="xref">RFC9001</a>]</span> change from "quic key",
"quic iv", "quic hp", and "quic ku" to "quicpi key", "quicpi iv", "quicpi hp",
 and "quicpi ku", respectively.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initial-packet-header">
<section id="section-3.4">
        <h3 id="name-initial-packet-header">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-initial-packet-header" class="section-name selfRef">Initial Packet Header</a>
        </h3>
<p id="section-3.4-1">The figure below is presented in the format from <span>[<a href="#RFC9000" class="xref">RFC9000</a>]</span>, and adds a
variable-length Encryption Context preceded by a length field:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-2">
<pre>
Initial Packet {
   Header From (1) = 1,
   Fixed Big (1) = 1,
   Long Packet Type (2) = 0,
   Reserved Bits (2),
   Packet Number Length (2),
   Version (32),
   Destination Connection ID Length (8),
   Destination Connection ID (0..160),
   Source Connection ID Length (8),
   Source Connection ID (0..160),
   Token Length (i),
   Token (..),
   Encryption Context Length (8),
   Encryption Context (..),
   Length (i),
   Packet Number (8..32),
}
</pre><a href="#section-3.4-2" class="pilcrow">¶</a>
</div>
<p id="section-3.4-3">Encryption Context Length: A variable-length integer specifying the length of
the encryption context, in bytes. Servers MUST set this field to zero; a client
that receives a non-zero length MUST either discard the packet or generate a
connection error of type PROTOCOL_VIOLATION.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">Clients MUST include a nonzero Encryption Context Length in all Initial packets,
unless executing fallback procedures (see <a href="#fallback" class="xref">Section 3.8</a>).<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">When the client includes a non-zero-length Encryption Context, it MUST include
an initial_encryption_context in its Client Hello, so that this header field
is included in the TLS handshake transcript.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<div id="encryption-context">
<section id="section-3.4.1">
          <h4 id="name-encryption-context">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-encryption-context" class="section-name selfRef">Encryption Context</a>
          </h4>
<p id="section-3.4.1-1">The encryption context, if nonzero length, has the following format:<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.1-2">
<pre>
Encryption Context {
    Config ID (8),
    SCKDF (16),
    SCAEADID (16),
    Encapsulated Secret (..),
}
</pre><a href="#section-3.4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.4.1-3">Config ID: An 8-bit integer identifying the configuration parameters, obtained
from the ECHConfig. This ID implicitly identifies the public key, Key
Encapsulation Mechanism, and the set of symmetric suites from which the
following fields are selected.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
<p id="section-3.4.1-4">SCKDF: Symmetric Cipher Key Derivation Function. The client selects this from
the cipher suites listed in the ECHConfig. This is the cipher used to encrypt
the Initial Packet. The values are listed in Section 7.2 of <span>[<a href="#HPKE" class="xref">HPKE</a>]</span>. All
endpoints MUST support HKDF-SHA256 (0x0001), which is used for QUIC Version 1
Initial packets.<a href="#section-3.4.1-4" class="pilcrow">¶</a></p>
<p id="section-3.4.1-5">SCAEADID: Symmetric Cipher Key Derivation Function. The client selects this
from the cipher suites listed in the ECHConfig. This is the cipher used to
encrypt the Initial Packet. The values are listed in Section 7.3 of <span>[<a href="#HPKE" class="xref">HPKE</a>]</span>.
All endpoints MUST support AES-128-GCM (0x0001), which is used for QUIC Version
1 Initial packets.<a href="#section-3.4.1-5" class="pilcrow">¶</a></p>
<p id="section-3.4.1-6">The Encapsulated Secret is HPKE encapsulated. Its length is inferred from the
Encryption Context Length field.<a href="#section-3.4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="client-packet-protection-procedure">
<section id="section-3.5">
        <h3 id="name-client-packet-protection-pr">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-client-packet-protection-pr" class="section-name selfRef">Client Packet Protection Procedure</a>
        </h3>
<p id="section-3.5-1">An client extracts the public key pkR and uses it to generate a shared_secret:<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5-2">
<pre>
pkR = Deserialize(ECHConfig.contents.public_key)
shared_secret, enc = Encap(pkR)
initial_secret = HKDF-Extract(shared_secret,
        client_dst_connection_id || ECHConfig)
</pre><a href="#section-3.5-2" class="pilcrow">¶</a>
</div>
<p id="section-3.5-3">enc is the Encapsulated Secret, and is written into that subfield of the
Encryption Context Field.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">The initial_secret above is used to generate client_initial_secret and
server_initial_secret as described in Section 5.2 of <span>[<a href="#RFC9001" class="xref">RFC9001</a>]</span>.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<p id="section-3.5-5">When applying header protection, the Context Length and Encryption Context are
not Protected.<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<p id="section-3.5-6">This derivation is performed once per connection. Subsequent Initial Packets
use the same keys and the same offset to the packet number, regardless of
additional Encryption Context fields or changed connection IDs.<a href="#section-3.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-procedure">
<section id="section-3.6">
        <h3 id="name-server-packet-protection-pr">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-server-packet-protection-pr" class="section-name selfRef">Server Packet Protection Procedure</a>
        </h3>
<p id="section-3.6-1">The server reads the Config ID and Encapsulated Secret (enc) from the Initial
Packet. It looks up its private key (skR) associated with the Config ID.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">Otherwise, the server generates the Initial secrets:<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.6-3">
<pre>
shared_secret = Decap(enc, skR)
initial_secret = HKDF-Extract(shared_secret,
        client_dst_connection_id || ECHConfig)
</pre><a href="#section-3.6-3" class="pilcrow">¶</a>
</div>
<p id="section-3.6-4">The remainder is identical to the client procedure. All server-generated
Initial packets use the keys generated in this process.<a href="#section-3.6-4" class="pilcrow">¶</a></p>
<p id="section-3.6-5">If packet decryption fails, see <a href="#fallback" class="xref">Section 3.8</a>.<a href="#section-3.6-5" class="pilcrow">¶</a></p>
<p id="section-3.6-6">The server terminates the connection with a TRANSPORT_PARAMETER_ERROR under the
following conditions:<a href="#section-3.6-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-7.1">There is a zero-length Encryption Context field, but the
initial_encryption_context transport parameter is present<a href="#section-3.6-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.6-7.2">There is a non-zero-length Encryption Context field, but the
initial_encryption_context transport parameter is absent or does not match the
header.<a href="#section-3.6-7.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.6-8">However, see <a href="#intermediaries" class="xref">Section 4</a> for exceptions to this transport parameter
processing rule.<a href="#section-3.6-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="retry">
<section id="section-3.7">
        <h3 id="name-retry-integrity-tag">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-retry-integrity-tag" class="section-name selfRef">Retry Integrity Tag</a>
        </h3>
<p id="section-3.7-1">The Retry packet is identical to QUIC version 1, except that the key and nonce
used for the Retry Integrity Tag (Sec 5.8 of <span>[<a href="#RFC9001" class="xref">RFC9001</a>]</span> change to:<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7-2">
<pre>
secret = 0xe453a2e22377289f08a4458ee1c9a90a4e39696e026372ffc33190b8de5a0123
key = 0xbe0c690b9f66575a1d766b54e368c84e
nonce = 0x461599d35d632bf2239825bb
</pre><a href="#section-3.7-2" class="pilcrow">¶</a>
</div>
<p id="section-3.7-3">This key and nonce are also used in Fallback packets (<a href="#fallback-packet" class="xref">Section 3.9</a>).<a href="#section-3.7-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fallback">
<section id="section-3.8">
        <h3 id="name-fallback">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-fallback" class="section-name selfRef">Fallback</a>
        </h3>
<p id="section-3.8-1">If decryption fails, the client may not have the server's correct configuration.
In this case, the server replies with a Fallback packet (see
<a href="#fallback-packet" class="xref">Section 3.9</a>), and discards the Initial.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<p id="section-3.8-2">The client checks the Integrity Tag in the packet against the received Fallback
Packet and its own record of the Initial Packet. If they do not match, the
packet may have been corrupted, and the client SHOULD treat the packet as lost.
If they do match, the client MUST assume that it does not have the correct
ECHConfig.<a href="#section-3.8-2" class="pilcrow">¶</a></p>
<p id="section-3.8-3">When it has the incorrect config, the client composes a new Client Hello. It
MUST include the public_key_failed transport parameter with the Config ID and
public key it attempted to use. It MUST use an Encryption Context Length of
zero, and encrypt it with keys derived from the "fallback salt"
0xbd62319ad6eeb17a9ed0d3bf75e37e4a8e7e6ac7, instead of the shared secret that
the server cannot decode. The Client Hello also MUST include any Retry Token the
previous Initial contained and MAY include a token from a NEW_TOKEN frame.<a href="#section-3.8-3" class="pilcrow">¶</a></p>
<p id="section-3.8-4">This new Initial packet is part of the same connection and MUST use the same
Connection IDs and packet number space.<a href="#section-3.8-4" class="pilcrow">¶</a></p>
<p id="section-3.8-5">Note that the fallback salt does not provide confidentiality to the client, and
the client SHOULD NOT include privacy-sensitive information there. See
<a href="#downgrade" class="xref">Section 6.1</a> for further discussion of this.<a href="#section-3.8-5" class="pilcrow">¶</a></p>
<p id="section-3.8-6">A server interprets a client Initial with a zero-length Encryption Context as
an Initial encrypted with keys derived from the fallback salt and decrypts it
accordingly.<a href="#section-3.8-6" class="pilcrow">¶</a></p>
<p id="section-3.8-7">The server checks the Config ID and public key from the public_key_failed
transport parameter to see if it should successfully process a Protected Initial
with these parameters. If it would have, it MUST terminate the connection with
an INVALID_PROTECTED_INITIAL_DOWNGRADE error to indicate that there has been an
attack.<a href="#section-3.8-7" class="pilcrow">¶</a></p>
<p id="section-3.8-8">If the server would not have successfully decoded the packet with those
parameters, it MUST send its own public_key_failed transport parameter to
acknowledge the parameter was successfully processed. It MAY also send a
ECHConfig transport parameter to allow use of Protected Initials in subsequent
connections, a Version Aliasing transport parameter (see <span>[<a href="#VERSION-ALIASING" class="xref">VERSION-ALIASING</a>]</span>)
to enable a different means of Initial Protection, both, or neither.<a href="#section-3.8-8" class="pilcrow">¶</a></p>
<p id="section-3.8-9">If the client does not receive a public_key_failed transport parameter in
response to sending a public_key_failed transport parameter, it MUST terminate
the connection with a TRANSPORT_PARAMETER_ERROR.<a href="#section-3.8-9" class="pilcrow">¶</a></p>
<p id="section-3.8-10">The client MUST NOT include the original client hello in its TLS transcript
hash for key computation, as the server has no access to this message. However,
the client hello is an input to the Integrity tag in the public_key_failed
transport parameter, which will be in the transcript.<a href="#section-3.8-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fallback-packet">
<section id="section-3.9">
        <h3 id="name-the-fallback-packet">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-the-fallback-packet" class="section-name selfRef">The Fallback Packet</a>
        </h3>
<p id="section-3.9-1">The Fallback packet uses the 0x1 packet type code, which it shares with 0-RTT.
Since 0-RTT is only sent by clients and Fallback is only sent by servers, these
two types are distinguished by the endpoint's role in the handshake.<a href="#section-3.9-1" class="pilcrow">¶</a></p>
<p id="section-3.9-2">The Fallback packet has the following format:<a href="#section-3.9-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.9-3">
<pre>
Fallback Packet {
  Header Form (1) = 1,
  Fixed Bit (1) = 1,
  Long Packet Type (2) = 1,
  Unused (4),
  Version (32),
  Destination Connection ID Length (8),
  Destination Connection ID (0..160),
  Source Connection ID Length (8),
  Source Connection ID (0..160),
  Integrity Tag (128),
}
</pre><a href="#section-3.9-3" class="pilcrow">¶</a>
</div>
<p id="section-3.9-4">The server computes the Integrity Tag by prepending the entire UDP payload that
contained the client Initial to the Fallback packet contents (minus the tag
itself, of course) to form a pseudo-packet. The server then computes the
Integrity Tag as the output of AEAD_AES_128_GCM with the key and nonce from
<a href="#retry" class="xref">Section 3.7</a>, no plaintext, and the pseudo-packet as the Additional Data. This
thus confirms the integrity of both packets in the exchange.<a href="#section-3.9-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-transport-parameters">
<section id="section-3.10">
        <h3 id="name-new-transport-parameters">
<a href="#section-3.10" class="section-number selfRef">3.10. </a><a href="#name-new-transport-parameters" class="section-name selfRef">New Transport Parameters</a>
        </h3>
<div id="publickeyfailed">
<section id="section-3.10.1">
          <h4 id="name-public_key_failed">
<a href="#section-3.10.1" class="section-number selfRef">3.10.1. </a><a href="#name-public_key_failed" class="section-name selfRef">public_key_failed</a>
          </h4>
<p id="section-3.10.1-1">The public_key_failed transport parameter allows detection of an attacker
injecting messages to force use of the fallback salt. For details on use,
see <a href="#fallback" class="xref">Section 3.8</a>.<a href="#section-3.10.1-1" class="pilcrow">¶</a></p>
<p id="section-3.10.1-2">Its provisional type is 0x706b66.<a href="#section-3.10.1-2" class="pilcrow">¶</a></p>
<p id="section-3.10.1-3">When sent by a client, the content of the transport parameter is as follows:<a href="#section-3.10.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.10.1-4">
<pre>
{
    Integrity Tag (128),
    Config ID (8),
    Public Key (..),
}
</pre><a href="#section-3.10.1-4" class="pilcrow">¶</a>
</div>
<p id="section-3.10.1-5">The Integrity Tag is copied from the Fallback packet.<a href="#section-3.10.1-5" class="pilcrow">¶</a></p>
<p id="section-3.10.1-6">The other fields are populated using the ECHConfig that the client attempted to
use.  The length of the Public Key is inferred from the length field of the
transport parameter.<a href="#section-3.10.1-6" class="pilcrow">¶</a></p>
<p id="section-3.10.1-7">When sent by a server, the transport parameter has no value field.<a href="#section-3.10.1-7" class="pilcrow">¶</a></p>
<p id="section-3.10.1-8">Endpoints MUST respond to a malformed transport parameter by closing the
connection with a TRANSPORT_PARAMETER_ERROR.<a href="#section-3.10.1-8" class="pilcrow">¶</a></p>
<p id="section-3.10.1-9">Note that this transport parameter is always sent as a result of a fallback from
a Protected Initial, and therefore with a zero-length Encryption Context in the
packet header. Therefore, if received with non-zero-length Encryption Context,
the receiving endpoint MUST terminate the connection with a
TRANSPORT_PARAMETER_ERROR.<a href="#section-3.10.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="echconfig">
<section id="section-3.10.2">
          <h4 id="name-echconfig">
<a href="#section-3.10.2" class="section-number selfRef">3.10.2. </a><a href="#name-echconfig" class="section-name selfRef">ECHConfig</a>
          </h4>
<p id="section-3.10.2-1">The ECHConfig transport parameter allows servers to directly provide clients a
valid configuration.<a href="#section-3.10.2-1" class="pilcrow">¶</a></p>
<p id="section-3.10.2-2">Its provisional type is 0x454348.<a href="#section-3.10.2-2" class="pilcrow">¶</a></p>
<p id="section-3.10.2-3">Its format is equivalent to ECHConfigList, as defined in Section 4 of <span>[<a href="#ECHO" class="xref">ECHO</a>]</span>.<a href="#section-3.10.2-3" class="pilcrow">¶</a></p>
<p id="section-3.10.2-4">If this transport parameter does not match this format, is received by a server,
or is received in a connection where the client's most recent Initial had a
non-zero-length Encryption Context, the receiver MUST terminate the connection
with a TRANSPORT_PARAMETER_ERROR.<a href="#section-3.10.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initialencryptioncontext">
<section id="section-3.10.3">
          <h4 id="name-initial_encryption_context">
<a href="#section-3.10.3" class="section-number selfRef">3.10.3. </a><a href="#name-initial_encryption_context" class="section-name selfRef">initial_encryption_context</a>
          </h4>
<p id="section-3.10.3-1">The format of this transport parameter is identical to the Encryption Context
described in <a href="#encryption-context" class="xref">Section 3.4.1</a>.<a href="#section-3.10.3-1" class="pilcrow">¶</a></p>
<p id="section-3.10.3-2">Its provisional type is 0x696563.<a href="#section-3.10.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="intermediaries">
<section id="section-4">
      <h2 id="name-intermediaries">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-intermediaries" class="section-name selfRef">Intermediaries</a>
      </h2>
<p id="section-4-1">In the topology proposed in Section 3.1 of <span>[<a href="#ECHO" class="xref">ECHO</a>]</span>, where a client-facing
server has its own public name and potentially fronts a number of independent
domains, only the client-facing server has the private keys. Thus, it modifies
incoming Initial Packets before forwarding to the back-end server.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">A common use case of this topology is a load balancer fronting multiple domains
using the same IP address, which makes routing decisions based on the SNI in the
Client Hello.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="client-facing-server">
<section id="section-4.1">
        <h3 id="name-client-facing-server">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-client-facing-server" class="section-name selfRef">Client-Facing Server</a>
        </h3>
<p id="section-4.1-1">The client-facing server is responsible for verifying the Initial packet is
decryptable, sending a Fallback packet (and dropping the Initial) if it is not,
and otherwise forwarding the packet encrypted with a different key.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">If an incoming Initial packet is not decryptable, the client-facing server
sends a Fallback packet and drops the Initial.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">If an incoming client Initial has a non-zero length Encryption Context field,
the client-facing server MUST delete the Encryption Context field. When
forwarding to the back-end server, it encrypts the plaintext version of this
modified packet with keys derived from the fallback salt. Thus, between
client-facing server and back-end server the packet is inspectable by observers.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">Similarly, if the client is using the shared secret, the client-facing server
MUST decrypt server Initial packets encrypted with keys derived from the
fallback secret, and re-encrypt them with keys derived from the shared secret.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">The client-facing server MUST enforce correct use of the
initial_encryption_context parameter, as described in <a href="#server-procedure" class="xref">Section 3.6</a>, and
terminate the connection if necessary.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">Non-Initial packets pass unmodified through the client-facing server. Note that
client-facing servers cannot inspect any packet payloads except for Initial
packets.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="back-end-server">
<section id="section-4.2">
        <h3 id="name-back-end-server">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-back-end-server" class="section-name selfRef">Back-End Server</a>
        </h3>
<p id="section-4.2-1">Back-end servers MUST have an up-to-date copy of the ECHConfigList the client-
facing server is using, though it need not hold the private key, in order to
properly process and generate the relevant transport parameters.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Back-end servers MUST NOT take any action based on the presence or contents of
the initial_encryption_context transport parameter, as the client-facing server
has likely stripped the Encryption Context out of the header.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">In all other respects, they operate as Protected Initial servers.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="applicability">
<section id="section-5">
      <h2 id="name-applicability">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-applicability" class="section-name selfRef">Applicability</a>
      </h2>
<p id="section-5-1">This version of QUIC provides no change from QUIC version 1 relating to the
capabilities available to applications. Therefore, all Application Layer
Protocol Negotiation (ALPN) (<span>[<a href="#RFC7301" class="xref">RFC7301</a>]</span>) codepoints specified to operate over
QUICv1 can also operate over this version of QUIC.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-and-privacy-consid">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-and-privacy-consid" class="section-name selfRef">Security and Privacy Considerations</a>
      </h2>
<p id="section-6-1">Sections 10.2, 10.3, 10.4, and 10.6 of <span>[<a href="#ECHO" class="xref">ECHO</a>]</span> apply to QUIC Protected Initials
as well.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Section 7.8 of <span>[<a href="#VERSION-ALIASING" class="xref">VERSION-ALIASING</a>]</span> is also applicable.<a href="#section-6-2" class="pilcrow">¶</a></p>
<div id="downgrade">
<section id="section-6.1">
        <h3 id="name-forcing-downgrade">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-forcing-downgrade" class="section-name selfRef">Forcing Downgrade</a>
        </h3>
<p id="section-6.1-1">An attacker attempts to force a client to send an Initial that uses unprotected
Initials by injecting a Version Negotiation packet (which implies the server no
longer supports Protected Initials) or a Fallback packet (which implies the
server has a new cryptographic context).<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The weak form of this attack observes the Initial and injects the Version
Negotiation or Fallback packet, but cannot drop the Initial. To counteract this,
a client SHOULD NOT respond to these packets until they have waited for Probe
Timeout (PTO) for a valid server Initial to arrive.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">The strong form features an attacker that can drop Initial packets. In this
case, the client can either abandon the connection attempt or connect with a
unprotected Initial: using the fallback salt in response to a Fallback packet,
or a different version in response to Version Negotiation.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">If connecting with an unprotected Initial, the client MAY alter it to sanitize
sensitive information and obtain either a correct ECHConfig or an aliased
version before proceeding with its true connection attempt. However, the client
Initial MUST lead to the authentication of a domain name the client trusts to
provide accurate cryptographic information (usually the public_name from the
ECHConfig). Advice for the Outer ClientHello in Section 10.5 of <span>[<a href="#ECHO" class="xref">ECHO</a>]</span> applies
here.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">Furthermore, if it received a Fallback packet, the client sends a
public_key_failed transport parameter to detect the downgrade attack, and the
server will terminate the connection if the Fallback packet was an attack.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">If the client received a Version Negotiation packet, it MUST implement a
downgrade detection mechanism such as <span>[<a href="#I-D.ietf-quic-version-negotiation" class="xref">I-D.ietf-quic-version-negotiation</a>]</span> or
abandon the connection attempt. If it subsequently detects a downgrade
detection, or discovers that the server does not support the same mechanism, it
terminates the connection attempt.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">Note that ECH is able to retrieve an up-to-date cryptographic context in 1 RTT,
because the client hello has enough plaintext information to begin a handshake
with the public_name. Protected Initials require reconnection with the public
name, incurring a 2 RTT penalty to achieve the same result.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initial-packet-injection">
<section id="section-6.2">
        <h3 id="name-initial-packet-injection">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-initial-packet-injection" class="section-name selfRef">Initial Packet Injection</a>
        </h3>
<p id="section-6.2-1">QUIC version 1 handshakes are vulnerable to DoS from observers for the short
interval that endpoints keep Initial keys (usually ~1.5 RTTS), since Initial
Packets are not authenticated. With version aliasing, attackers do not have
the necessary keys to launch such an attack.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">QUIC version 1 can use a fixed symmetric cipher for its Initial Packets because
the encryption is not providing true security. As this design aspires to
stonger guarantees, the Encryption Context field of the Initial header provides
the codepoints to enable use of other symmetric ciphers should AES-128-GCM be
compromised in the future. This is to provide cryptographic agility in
accordance with <span>[<a href="#RFC7696" class="xref">RFC7696</a>]</span>.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="retry-injection">
<section id="section-6.3">
        <h3 id="name-retry-injection">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-retry-injection" class="section-name selfRef">Retry Injection</a>
        </h3>
<p id="section-6.3-1">This version of QUIC does not improve the security of Retry packets with
respect to QUIC version 1. The Retry Integrity Tag uses a well-known key and
relies on data in the Initial that triggered the Retry. It therefore protects
against transmission errors and injection of Retry packets by off-path attackers
that cannot observe the Initial. To detect Retry packets injected by observers,
it relies on the subsequent exchange of transport parameters.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">An attacker that consistently injects Retry packets in front of a server that
also consistently sends Retry can result in a Denial of Service, as clients
cannot accept two Retries in the same connection.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">An alternate design would use the shared secret derived from the Client Initial
Packet to generate keys for the Retry Integrity Tag, which would allow the
client to immediately discard Retries injected by other parties. Unfortunately,
this would require servers to perform an asymmetric crypto operation to send a
Retry packet, when in a state where it is likely computationally limited.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">It is possible to enhance the security of Retry by assuming this added
computational cost. Such a design could also eliminate the complexity associated
with adding an arbitrary value to the Packet Length field. The purpose of this
addition is to avoid trial decryption to verify the configuration is correct,
but this cost is negligible compared to extracting the shared secret.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="quic-version-registry">
<section id="section-7.1">
        <h3 id="name-quic-version-registry">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-quic-version-registry" class="section-name selfRef">QUIC Version Registry</a>
        </h3>
<p id="section-7.1-1">This document requests that IANA add the following entry to the QUIC version
registry:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Value: TBD<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">Status: permanent<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">Specification: This document<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">Change Controller: IETF<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">Contact: QUIC WG<a href="#section-7.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="quic-transport-parameter-registry">
<section id="section-7.2">
        <h3 id="name-quic-transport-parameter-re">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-quic-transport-parameter-re" class="section-name selfRef">QUIC Transport Parameter Registry</a>
        </h3>
<p id="section-7.2-1">This document requests that IANA add the following three entries to the QUIC
Transport Parameters registry:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Value</th>
              <th class="text-center" rowspan="1" colspan="1">Parameter Name</th>
              <th class="text-center" rowspan="1" colspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">TBD</td>
              <td class="text-center" rowspan="1" colspan="1">public_key_failed</td>
              <td class="text-center" rowspan="1" colspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">TBD</td>
              <td class="text-center" rowspan="1" colspan="1">ECHConfig</td>
              <td class="text-center" rowspan="1" colspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">TBD</td>
              <td class="text-center" rowspan="1" colspan="1">initial_encryption_context</td>
              <td class="text-center" rowspan="1" colspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="quic-transport-error-codes-registry">
<section id="section-7.3">
        <h3 id="name-quic-transport-error-codes-">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-quic-transport-error-codes-" class="section-name selfRef">QUIC Transport Error Codes Registry</a>
        </h3>
<p id="section-7.3-1">This document requests that IANA add the following entry to the QUIC Transport
Error Codes registry:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">Value: TBD<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">Code: INVALID_PROTECTED_INITIAL_DOWNGRADE<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">Description: Attacker is forcing insecure Initial<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5">Specification: This document<a href="#section-7.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="ECHO">[ECHO]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Oku, K.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"TLS Encrypted Client Hello"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-esni-13</span>, <time datetime="2021-08-12" class="refDate">12 August 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-13">https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HPKE">[HPKE]</dt>
        <dd>
<span class="refAuthor">Barnes, R. L.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hpke-12</span>, <time datetime="2021-09-02" class="refDate">2 September 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hpke-12">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hpke-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-quic-version-negotiation">[I-D.ietf-quic-version-negotiation]</dt>
        <dd>
<span class="refAuthor">Schinazi, D.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Compatible Version Negotiation for QUIC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-version-negotiation-04</span>, <time datetime="2021-05-26" class="refDate">26 May 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-version-negotiation-04">https://datatracker.ietf.org/doc/html/draft-ietf-quic-version-negotiation-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9001">[RFC9001]</dt>
      <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">S. Turner, Ed.</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="seriesInfo">RFC 9001</span>, <span class="seriesInfo">DOI 10.17487/RFC9001</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9001">https://www.rfc-editor.org/rfc/rfc9001</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7301">[RFC7301]</dt>
        <dd>
<span class="refAuthor">Friedl, S.</span>, <span class="refAuthor">Popov, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Stephan</span>, <span class="refTitle">"Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension"</span>, <span class="seriesInfo">RFC 7301</span>, <span class="seriesInfo">DOI 10.17487/RFC7301</span>, <time datetime="2014-07" class="refDate">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7301">https://www.rfc-editor.org/rfc/rfc7301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7696">[RFC7696]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Guidelines for Cryptographic Algorithm Agility and Selecting Mandatory-to-Implement Algorithms"</span>, <span class="seriesInfo">BCP 201</span>, <span class="seriesInfo">RFC 7696</span>, <span class="seriesInfo">DOI 10.17487/RFC7696</span>, <time datetime="2015-11" class="refDate">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7696">https://www.rfc-editor.org/rfc/rfc7696</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VERSION-ALIASING">[VERSION-ALIASING]</dt>
      <dd>
<span class="refAuthor">Duke, M.</span>, <span class="refTitle">"QUIC Version Aliasing"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-duke-quic-version-aliasing-06</span>, <time datetime="2021-05-13" class="refDate">13 May 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-duke-quic-version-aliasing-06">https://datatracker.ietf.org/doc/html/draft-duke-quic-version-aliasing-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="change-log">
<section id="appendix-A">
      <h2 id="name-change-log">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-A-1.1">
          <p id="appendix-A-1.1.1"><strong>RFC Editor's Note:</strong> Please remove this section prior to
publication of a final version of this document.<a href="#appendix-A-1.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="since-draft-duke-quic-protected-initials-01">
<section id="appendix-A.1">
        <h3 id="name-since-draft-duke-quic-prote">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-since-draft-duke-quic-prote" class="section-name selfRef">since draft-duke-quic-protected-initials-01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.1-1.1">Redesigned fallback again without Version Negotiation<a href="#appendix-A.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-1.2">Added the initial_encryption_context transport parameter<a href="#appendix-A.1-1.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="since-draft-duke-quic-protected-initials-00">
<section id="appendix-A.2">
        <h3 id="name-since-draft-duke-quic-protec">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-since-draft-duke-quic-protec" class="section-name selfRef">since draft-duke-quic-protected-initials-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.2-1.1">Additional text comparing ECH, Version Aliasing<a href="#appendix-A.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.2">Adapted to foreground the split-mode use case<a href="#appendix-A.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.3">Clarified server initials are encrypted<a href="#appendix-A.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.4">Retry keys are no longer generated from the shared secret<a href="#appendix-A.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.5">Complete Rewrite of Fallback<a href="#appendix-A.2-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.6">New transport parameters<a href="#appendix-A.2-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-1.7">Added crypto agility<a href="#appendix-A.2-1.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Martin Duke</span></div>
<div dir="auto" class="left"><span class="org">F5 Networks, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:martin.h.duke@gmail.com" class="email">martin.h.duke@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Schinazi</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div dir="auto" class="left"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div dir="auto" class="left">
<span class="locality">Mountain View, California 94043</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dschinazi.ietf@gmail.com" class="email">dschinazi.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
