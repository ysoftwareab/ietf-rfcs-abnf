<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Rogue IPv6 Router Advertisement Problem Statement</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Rogue IPv6 Router Advertisement Problem Statement">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">IPv6 Operations</td><td class="header">T. Chown</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">University of Southampton</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">S. Venaas</td></tr>
<tr><td class="header">Expires: January 15, 2009</td><td class="header">UNINETT</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 14, 2008</td></tr>
</table></td></tr></table>
<h1><br />Rogue IPv6 Router Advertisement Problem Statement<br />draft-chown-v6ops-rogue-ra-01</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 15, 2009.</p>

<h3>Abstract</h3>

<p>
When deploying IPv6 networks, whether IPv6-only or dual-stack, routers
are configured to use IPv6 Router Advertisements to convey information
to on link nodes that enable them to autoconfigure on the network.  This
information includes the implied default router address taken from the
observed source address of the Router Advertisement (RA) message.   
However, in some networks 'bogus' RAs are observed, which may be
present due to misconfigurations or possibly malicious attacks on the
network.   In this draft we summarise the scenarios in which rogue RAs
may be observed, and we present a list of possible solutions to the
problem.    The goal of this draft is to present a framework around which
solutions can be proposed and discussed.

</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Bogus RA Scenarios<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Administrator misconfiguration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
User misconfiguration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Malicious misconfiguration<br />
<a href="#anchor6">3.</a>&nbsp;
Methods to Mitigate against Rogue RAs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.1.</a>&nbsp;
Manual configuration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.2.</a>&nbsp;
Secure Neighbor Discovery<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.3.</a>&nbsp;
Introduce RA snooping<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.4.</a>&nbsp;
Use the Router Preference Option<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.5.</a>&nbsp;
Rely on Layer 2 admission control<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.6.</a>&nbsp;
Use host-based packet filters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.7.</a>&nbsp;
Use an 'intelligent' deprecation tool<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.8.</a>&nbsp;
Wait before using new advertisements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">3.9.</a>&nbsp;
Add a Default Gateway Option to DHCPv6<br />
<a href="#anchor16">4.</a>&nbsp;
Other considerations<br />
<a href="#Conclusions">5.</a>&nbsp;
Conclusions<br />
<a href="#Security">6.</a>&nbsp;
Security Considerations<br />
<a href="#IANA">7.</a>&nbsp;
IANA Considerations<br />
<a href="#Acknowledgments">8.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">9.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
The <a class='info' href='#RFC4861'>Neighbor Discovery protocol<span> (</span><span class='info'>Narten, T., Nordmark, E., Simpson, W., and H. Soliman, &ldquo;Neighbor Discovery for IP version 6 (IPv6),&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4861] describes
the operation of IPv6 Router Advertisements (RAs), which are used during
the IPv6 autoconfiguration process, whether stateful (via 
<a class='info' href='#RFC3315'>DHCPv6<span> (</span><span class='info'>Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6),&rdquo; July&nbsp;2003.</span><span>)</span></a> [RFC3315] or
<a class='info' href='#RFC3736'>DHCPv6 Light<span> (</span><span class='info'>Droms, R., &ldquo;Stateless Dynamic Host Configuration Protocol (DHCP) Service for IPv6,&rdquo; April&nbsp;2004.</span><span>)</span></a> [RFC3736])
or stateless (as
per <a class='info' href='#RFC4862'>RFC4862<span> (</span><span class='info'>Thomson, S., Narten, T., and T. Jinmei, &ldquo;IPv6 Stateless Address Autoconfiguration,&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4862]).   In either case, the default
router address is drawn directly from the source address of the RA message.   
In contrast to IPv4, there is no DHCPv6 option to configure a default 
gateway address.
	
</p>
<p>
In observing the operation of deployed IPv6 networks, it is apparent that
there is a problem with undesired or 'bogus' IPv6 Router Advertisements (RAs)
appearing on network links or subnets.    By 'bogus' we mean RAs that
were not the intended configured RAs, rather RAs that have appeared for
some other reason.
	
</p>
<p>
The problem with rogue RAs is that they can cause partial or complete
failure of operation on an IPv6 link.   As such they are an operational
issue for which solution(s) are required, and for which best practice needs
to be conveyed.   
	
</p>
<p>
In the next section, we discuss
the scenarios that may give rise to rogue RAs being present.   In the
following section we present some candidate solutions for the problem,
some of which may be more practical to deploy than others.   
	
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Bogus RA Scenarios</h3>

<p>
There are three broad classes of scenario in which bogus RAs may be introduced to an IPv6 network.   
	
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Administrator misconfiguration</h3>

<p>
Here an administrator incorrectly configures RAs on a router interface,
causing incorrect RAs to appear on links and hosts to generate incorrect
IPv6 address or other information.    In this case the default gateway
may be correct, but a host might for example become multi-addressed,
possibly with a correct and incorrect address based on a correct and
incorrect prefix.    There is also
the possibility of bad lifetime information being configured.
	
</p>
<p>
In the case of a Layer 2 VLAN misconfiguration,
RAs may 'flood' to unintended links, causing hosts or more than one link
to potentially become incorrectly multiaddressed, with possibly two different
default routers available.    
	
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
User misconfiguration</h3>

<p>
In this case a user's device 'accidentally' transmits RAs onto the local
link, adding an addition default gateway and prefix information.   This
is typically seen on wireless (though sometimes wired) networks where
a laptop has been used as a home gateway (e.g. a 6to4 gateway) and has
then been attached to another network with the gateway configuration still
active.   A not infrequent cause here is the Windows Internet Connection 
Sharing service (ICS) which turns a host into a 6to4 gateway; this can be
a useful feature, unless it is run when not intended.   We have had reports
that hosts may not see the genuine RAs on link due to host firewalls, and
then turning on a connection sharing service and 6to4 as a result.
	
</p>
<p>
There are also reported incidents in enterprise networks of users physically 
plugging Ethernet cables into the wrong sockets and bridging two subnets
together, causing an problem similar to VLAN flooding.
	
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Malicious misconfiguration</h3>

<p>
Here an attacker is deliberately generating RAs on the local network in 
an attempt to perform some form of denial of service or man-in-the-middle
attack.
	
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Methods to Mitigate against Rogue RAs</h3>

<p>
In this section we present a summary of methods suggested to date
for reducing or removing the possibility of rogue RAs being seen on
a network.
	
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Manual configuration</h3>

<p>
The default gateway can usually be manually configured on a device.
This is of course a resource intensive solution, and also prone to
mistakes in itself.
	
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Secure Neighbor Discovery</h3>

<p>

The <a class='info' href='#RFC3971'>SEND<span> (</span><span class='info'>Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;SEcure Neighbor Discovery (SEND),&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC3971] protocol provides a method for
hosts and routers to perform secure Neighbor Discovery.   At present
there are very few SEND implementations available, and SEND is perceived
as a complex protocol to deploy.   It is also likely that not all scenarios
will be able to use SeND, for various reasons.
	
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Introduce RA snooping</h3>

<p>
It should be possible to implement 'RA snooping' in Layer 2 switches in
a similar way to DHCP snooping, such that RAs observed from incorrect
sources are blocked or dropped, and not propagated through a subnet.
One candidate solution in this space called RA-Guard
<a class='info' href='#ra-guard'>[ra&#8209;guard]<span> (</span><span class='info'>Van de Velde, G., Levy-Abegnoli, E., Popoviciu, C., and J. Mohacsi, &ldquo;IPv6 RA-Guard (draft-ietf-v6ops-ra-guard-00),&rdquo; July&nbsp;2008.</span><span>)</span></a> has recently been proposed.
This type of solution has appeal because it is a familiar model for
enterprise network managers, but it can also be used to complement SeND.
	
</p>
<p>
It is interesting to note that the Windows
ICS that runs a 6to4 gateway also starts an IPv4 DHCP service, so any
snooping solution is mitigating against both these issues.
	
</p>
<p>
This type of solution may not be applicable everywhere, e.g. in environments
where there are not centrally controlled switches.
	
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Use the Router Preference Option</h3>

<p>
<a class='info' href='#RFC4191'>RFC4191<span> (</span><span class='info'>Draves, R. and D. Thaler, &ldquo;Default Router Preferences and More-Specific Routes,&rdquo; November&nbsp;2005.</span><span>)</span></a> [RFC4191] introduced router preference
options, such that an RA could carry one of three router preference
values: High, Medium (default) or Low.   Thus an administrator could
use High settings for managed RAs, and hope that 'accidental' RAs
would be medium priority, and that hosts implemented this optional
protocol.   
	
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Rely on Layer 2 admission control</h3>

<p>
In principle, if a technology such as IEEE 802.1x is used, devices
would first need to authenticate to the network before being able to
send or receive IPv6 traffic.    Ideally authentication would be
mutual.   This may mitigate against a malicious
attacker, but doesn't address the misconfiguration issues.
	
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Use host-based packet filters</h3>

<p>
In a managed environment hosts could be configured via their 'personal
firewall' to only accept RAs from trusted sources.    However, the
problem is then pushed to keeping this configuration maintained and
correct.   If a router fails and is replaced, possibly with a new Layer 2
interface address, the link local source address in the filter may be
incorrect and no network exists to push the new information to the 
host.
	
</p>
<p>
Also, hosts could potentially be configured to discard 6to4-based RAs in
a managed enterprise environment.
	
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Use an 'intelligent' deprecation tool</h3>

<p>
It could be possible to run a daemon on a link (perhaps on the router
on the link) to watch for incorrect RAs and to send a deprecating RA
with router lifetime of zero when such an RA is observed.
The KAME rafixd is an
example of such a tool, which has been used at IETF meetings with
some success.    Whether or not such a tool is the preferred method,
monitoring a link for observed RAs seems prudent from a network management
perspective.   Some such tools exist already, e.g. ndpmon.
	
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.8"></a><h3>3.8.&nbsp;
Wait before using new advertisements</h3>

<p>
It might be possible, in generally static networks, to configure an option
such that any new RAs that are seen are not acted upon for a certain
period, e.g. 2 hours.   This might allow time for a misconfiguration or
accidental RA to be detected and stopped, before hosts use the data in
the RA.   Of course this would add delays where genuine new RAs are required,
while new hosts appearing on a network would still be vulnerable (or be
unable to configure at all).
	
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.9"></a><h3>3.9.&nbsp;
Add a Default Gateway Option to DHCPv6</h3>

<p>
It may be possible to define a new Default Gateway Option for DHCPv6
that would allow network administrators to only have hosts use DHCPv6
for default gateway configuration in managed networks.   While such
an option could be defined, its ramifications remain unclear.   In
the absence of RAs, other configuration information would also be
missing, e.g. on-link prefix information.     Of course, it may be
that an RA is still required to inform the host to use DHCPv6, and
that may introduce a Catch-22 unless hosts are configured directly
to only use DHCPv6.
	
</p>
<p>
An advantage of DHCPv6 is that should an error be introduced, only
hosts that have refreshed their DHCP information since that time are
affected, while a rogue RA will most likely affect all hosts 
immediately.   DHCPv6 also allows different answers to be given to
different hosts.
	
</p>
<p>
One objection to introducing such an option is that DHCPv6 in itself
is not a secure protocol, and it is also of course subject to 
misconfigurations, accidental or otherwise.   Comparing the threat model
for rogue RAs and rogue DHCPv6 servers is an interesting exercise in itself.
Use of Authenticated DHCP is currently
minimal and thus the (lack of) security is just pushed to another
place, albeit one that site administrators are more familiar and
(rightly or wrongly) comfortable with.
	
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Other considerations</h3>

<p>
There are other general observations that have been made.
	
</p>
<p>
One is that it would generally be prudent for network monitoring or
management platforms to be able to observe and report on observed RAs,
and whether unintended RAs (possibly from unintended sources) are
present on a network.    Further, it may be useful for individual
hosts to be able to report their address status, e.g. this could be
useful during an IPv6 renumbering phased process as described in
<a class='info' href='#RFC4192'>RFC4192<span> (</span><span class='info'>Baker, F., Lear, E., and R. Droms, &ldquo;Procedures for Renumbering an IPv6 Network without a Flag Day,&rdquo; September&nbsp;2005.</span><span>)</span></a> [RFC4192].
	
</p>
<p>
The second is how readily a host can recover from bad configuration
information, e.g. considering the '2 hour rule' of Section 5.5.3 of
RFC4862 (though this applies to the prefix lifetime not the router
lifetime).   We should ensure that methods exist for a network
administrator to correct bad configuration information on a link or
subnet, and that OS platforms support these methods.    At least if the
problem can be detected, and corrected promptly, the impact is
minimised.
	
</p>
<p>
A comment has been made that in the case of 6to4 being run by a host
on a subnet that is not administratively configured with IPv6, some
OSes or applications may begin using IPv6 to the 6to4 host (router)
rather than IPv4 to the intended default IPv4 router.   Mitigating
against this condition can also be seen to be important.
	
</p>
<a name="Conclusions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Conclusions</h3>

<p>
In this text we have described scenarios via which rogue Router Advertisements
(RAs) may appear on a network, and some measures that could be used
to mitigate against these.   
	
</p>
<p>
While SEND perhaps offers the most robust solution, implementations are
not widely available, and the solution is perceived as complex (parallels
can possibly be drawn with Authenticated DHCP in terms of likely deployment).
Adding a new DHCPv6 Default Gateway Option would allow configuration by
DHCP, and be a method that IPv4 administrators are comfortable with
(for better or worse), but such an option would have significant impacts
elsewhere, and in any event one must recognise that the security risk is 
then simply shifted elsewhere.
	
</p>
<p>
Further feedback on the solutions is certainly welcome.   In the meantime,
perhaps the
simplest initial step would be for RA snooping to be defined and deployed
for Layer 2 devices, in such a way that can address (shared) wireless 
as well as wired networks.   One draft proposal in this space, RA-Guard,
has recently been published  <a class='info' href='#ra-guard'>[ra&#8209;guard]<span> (</span><span class='info'>Van de Velde, G., Levy-Abegnoli, E., Popoviciu, C., and J. Mohacsi, &ldquo;IPv6 RA-Guard (draft-ietf-v6ops-ra-guard-00),&rdquo; July&nbsp;2008.</span><span>)</span></a>.    Alternatively,
certain switch platforms can already implement a form of snooping by the 
administrator configuring Access Control Lists (ACLs) that block RA ICMP 
messages that might be inbound on 'user' ports.   A cleaner solution is
desirable though.
	
</p>
<p>
This topic has also highlighted that some DHCPv6 on-link prefix option
may be useful for some scenarios, caused in part by the change of the
'default on-link' rule.   This should be seen as independent of whether
DHCPv6 is extended to add a Default Gateway Option, which is another
open question at this time.
	
</p>
<p>
The material presented here is relevant to the IETF dhc and v6ops working
groups, but the text is labeled as v6ops due to its operational issue
focus.   Should new DHCP features be defined as a result, we assume these
would be presented within the dhc working group.
	
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
There are no extra Security consideration for this document.
	
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>
There are no extra IANA consideration for this document.
	
</p>
<a name="Acknowledgments"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgments</h3>

<p>
Thanks are due to members of the IETF IPv6 Operations and DHCP WGs for their
inputs on this topic, including but not limited to
Iljitsch van Beijnum,
David Malone,
Tony Hain,
Christian Huitema,
Remi Denis-Courmant,
Chip Popoviciu,
Dave Thaler and
Tatuya Jinmei.
	
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3315">[RFC3315]</a></td>
<td class="author-text">Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>,&rdquo; RFC&nbsp;3315, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3315.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3736">[RFC3736]</a></td>
<td class="author-text">Droms, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3736">Stateless Dynamic Host Configuration Protocol (DHCP) Service for IPv6</a>,&rdquo; RFC&nbsp;3736, April&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3736.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3971">[RFC3971]</a></td>
<td class="author-text">Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;<a href="http://tools.ietf.org/html/rfc3971">SEcure Neighbor Discovery (SEND)</a>,&rdquo; RFC&nbsp;3971, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3971.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4191">[RFC4191]</a></td>
<td class="author-text">Draves, R. and D. Thaler, &ldquo;<a href="http://tools.ietf.org/html/rfc4191">Default Router Preferences and More-Specific Routes</a>,&rdquo; RFC&nbsp;4191, November&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4191.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4192">[RFC4192]</a></td>
<td class="author-text">Baker, F., Lear, E., and R. Droms, &ldquo;<a href="http://tools.ietf.org/html/rfc4192">Procedures for Renumbering an IPv6 Network without a Flag Day</a>,&rdquo; RFC&nbsp;4192, September&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4192.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4861">[RFC4861]</a></td>
<td class="author-text">Narten, T., Nordmark, E., Simpson, W., and H. Soliman, &ldquo;<a href="http://tools.ietf.org/html/rfc4861">Neighbor Discovery for IP version 6 (IPv6)</a>,&rdquo; RFC&nbsp;4861, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4861.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4862">[RFC4862]</a></td>
<td class="author-text">Thomson, S., Narten, T., and T. Jinmei, &ldquo;<a href="http://tools.ietf.org/html/rfc4862">IPv6 Stateless Address Autoconfiguration</a>,&rdquo; RFC&nbsp;4862, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4862.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="ra-guard">[ra-guard]</a></td>
<td class="author-text">Van de Velde, G., Levy-Abegnoli, E., Popoviciu, C., and J. Mohacsi, &ldquo;IPv6 RA-Guard (draft-ietf-v6ops-ra-guard-00),&rdquo; July&nbsp;2008.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tim Chown</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Southampton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Southampton, Hampshire  SO17 1BJ</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">United Kingdom</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tjc@ecs.soton.ac.uk">tjc@ecs.soton.ac.uk</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stig Venaas</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">UNINETT</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trondheim  NO 7465</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Norway</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:venaas@uninett.no">venaas@uninett.no</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
