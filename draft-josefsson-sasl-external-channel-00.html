<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>SASL Mechanism for External Authentication using Channel Bindings:
EXTERNAL-CHANNEL</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="SASL Mechanism for External Authentication using Channel Bindings:
EXTERNAL-CHANNEL">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">S. Josefsson</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">SJD</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">August 05, 2008</td></tr>
<tr><td class="header">Expires: February 6, 2009</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />SASL Mechanism for External Authentication using Channel Bindings:
EXTERNAL-CHANNEL<br />draft-josefsson-sasl-external-channel-00</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on February 6, 2009.</p>

<h3>Abstract</h3>

<p>This document describes a way to perform end-user authentication
    in the Simple Authentication and Security Layer (SASL) framework
    which re-use an external security layer (such as the Transport
    Layer Security (TLS) protocol) that may have already completed
    end-user authentication.  In comparison with the existing EXTERNAL
    mechanism, this mechanism offers a way to cryptographically bind
    the authentication to the security layer via a channel binding.
    The EXTERNAL-CHANNEL mechanism alleviates the a priori assumptions
    made by the design of the EXTERNAL mechanism.
</p>
<p>See &lt;http://josefsson.org/external-channel/&gt; for more
    information.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Technical Specification<br />
<a href="#anchor3">3.</a>&nbsp;
Examples<br />
<a href="#anchor4">4.</a>&nbsp;
Making Authorization Decisions<br />
<a href="#anchor5">5.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor6">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor7">7.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The EXTERNAL mechanism, described in Appendix A of
    <a class='info' href='#RFC4422'>[RFC4422]<span> (</span><span class='info'>Melnikov, A. and K. Zeilenga, &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; June&nbsp;2006.</span><span>)</span></a> allows a client to request the server to
    use credentials established by means external to the mechanism to
    authenticate the client.  The external means may be, for instance,
    <a class='info' href='#RFC4346'>TLS<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a> [RFC4346] or <a class='info' href='#RFC4301'>IP
      Security<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4301] services.
</p>
<p>The EXTERNAL mechanism requires some a prior agreement between
    the client and the server regarding which external channel, and
    consequently which external credentials, should be used for
    authentication.  In practice this has often meant that the
    EXTERNAL mechanism is only used when there is tight out of band
    interaction between the server administration and client user.
    This has an impact of the interoperability of the EXTERNAL
    mechanism.
</p>
<p>The EXTERNAL-CHANNEL mechanism, specified in this document, is
    similar to the EXTERNAL mechanism in that it relies on an external
    channel to perform the user authentication.  However,
    EXTERNAL-CHANNEL provides a way for the client to provide an
    identifier of the external channel that provides the user
    credentials.  The intention is that the server need not rely on a
    priori arrangement to identify the secure channel that was used,
    but can automatically find the intended channel and re-use its
    credentials for the SASL authentication.
</p>
<p>In the EXTERNAL-CHANNEL mechanism the external channel is
    identified using the "Channel binding unique prefix" string as
    defined in <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>.  A channel bindings is
    transferred, so that the server can verify that the client is a
    peer of the same secure channel as the server.
</p>
<p>Binding authentication to a specific encrypted session can
    protect from certain <a class='info' href='#MITM'>attacks<span> (</span><span class='info'>Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunneled Authentication,&rdquo; .</span><span>)</span></a> [MITM].  It can
    also help to improve performance by having peers agree to re-use a
    secure channel rather than to set up a new.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Technical Specification</h3>

<p>The name of this mechanism is "EXTERNAL-CHANNEL".
</p>
<p>The mechanism does not provide a security layer.  It provides
    similar functionality by relying on an external channel.
</p>
<p>The mechanism is capable of transferring a channel binding and an
    authorization identity string.  If the authorization identity
    string is empty, the client is requesting to act as the identity
    the server has associated with the client's credentials.  If the
    authorization identity string is non-empty, the client is
    requesting to act as the identity represented by the string.  The
    channel binding name cannot be empty.
</p>
<p>The client is expected to send data first in the authentication
    exchange.  Where the client does not provide an initial response
    data in its request to initiate the authentication exchange, the
    server is to respond to the request with an empty initial
    challenge and then the client is to provide its initial
    response.
</p>
<p>The client sends the initial response containing the channel
    binding name, a <a class='info' href='#RFC4648'>base64<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4648] encoded
    channel bindings, and a <a class='info' href='#RFC3629'>UTF-8<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a> [RFC3629]
    encoding of the requested authorization identity string.
</p>
<p>The authorization identity is non-empty when the client is
    requesting to act as the identity represented by the (non-empty)
    string.  The authorization identity is empty when the client is
    requesting to act as the identity the server associates with the
    external authentication credentials.
</p>
<p>The syntax of the initial response is specified as a value of the
    &lt;extern-initial-resp&gt; production detailed below using the
    <a class='info' href='#RFC4234'>Augmented Backus-Naur Form (ABNF)<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; October&nbsp;2005.</span><span>)</span></a> [RFC4234]
    notation.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   <dfn>external-initial-resp</dfn> = <cite class='id'>cb-name</cite> "<span class='str'> </span>" <cite class='id'>b64-cb-data</cite> "<span class='str'> </span>" <cite class='id'>authz-id-string</cite>

   <dfn>cb-name</dfn>               = <span class='rep'>1*</span>( <cite class='id'>US-ASCII</cite> / "<span class='str'>.</span>" / "<span class='str'>-</span>")
        <em>;; Based on RFC 5056: "There is no naming convention for channel</em>
        <em>;; bindings: any string composed of US-ASCII alphanumeric</em>
        <em>;; characters, period ('.'), and dash ('-') will suffice."</em>

   <dfn>b64-cb-data</dfn>           = <span class='rep'>*</span>( <cite class='key'>ALPHA</cite> / <cite class='key'>DIGIT</cite> / "<span class='str'>+</span>" / "<span class='str'>/</span>" / "<span class='str'>=</span>" )
        <em>;; Base64 encoding of the channel bindings, the format</em>
        <em>;; of the decoded data depends on the cb-name.</em>

   <dfn>authz-id-string</dfn>       = <span class='rep'>*</span>( <cite class='id'>UTF8-char-no-nul</cite> )
   <dfn>UTF8-char-no-nul</dfn>      = <cite class='id'>UTF8-1-no-nul</cite> / <cite class='id'>UTF8-2</cite> / <cite class='id'>UTF8-3</cite> / <cite class='id'>UTF8-4</cite>
        <em>;; where the UTF8-2, UTF8-3, and UTF8-4 productions are</em>
        <em>;; as defined in RFC 3629.</em>

   <dfn>UTF8-1-no-nul</dfn>         = <span class='val'>%x01-7F</span>
</pre></div>
<p>There are no additional challenges and responses.
</p>
<p>Hence, the server is to return the outcome of the authentication
    exchange.
</p>
<p>The exchange fails if
</p>
<p>- the cb-name denote an (to the server implementation) unknown or
    end-point channel binding type,
</p>
<p>- the client has not established its credentials via the
    indicated external channel,
</p>
<p>- the channel bindings data does not match,
</p>
<p>- the client's credentials are inadequate,
</p>
<p>- the client provided an empty authorization identity string and
    the server is unwilling or unable to associate an authorization
    identity with the client's credentials,
</p>
<p>- the client provided a non-empty authorization identity string
    that is invalid per the syntax requirements of the applicable
    application protocol specification,
</p>
<p>- the client provided a non-empty authorization identity string
    representing an identity that the client is not allowed to act as,
    or
</p>
<p>- the server is unwilling or unable to provide service to the
    client for any other reason.
</p>
<p>Otherwise the exchange is successful.  When indicating a
    successful outcome, additional data is not provided.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Examples</h3>

<p>This section provides examples of EXTERNAL-CHANNEL authentication
    exchanges.  The examples are intended to help the readers
    understand the above text.  The examples are not definitive.  The
    <a class='info' href='#RFC2244'>Application Configuration Access Protocol
    (ACAP)<span> (</span><span class='info'>Newman, C. and J. Myers, &ldquo;ACAP -- Application Configuration Access Protocol,&rdquo; November&nbsp;1997.</span><span>)</span></a> [RFC2244] is used in the examples because ACAP sends the SASL
    tokens without additional encoding.
</p>
<p>The first example shows use of EXTERNAL-CHANNEL with an empty
    authorization identity bound to an external "tls-unique" channel.
    In this example, the initial response is not sent in the client's
    request to initiate the authentication exchange.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      S: * ACAP (SASL "DIGEST-MD5")
      C: a001 STARTTLS
      S: a001 OK "Begin TLS negotiation now"
      &lt;TLS negotiation, further commands are under TLS layer&gt;
      S: * ACAP (SASL "DIGEST-MD5" "EXTERNAL-CHANNEL")
      C: a002 AUTHENTICATE "EXTERNAL-CHANNEL"
      S: + "tls-unique rvOng1J3oo2oMQBc "
      C: + ""
      S: a002 OK "Authenticated"
</pre></div>
<p>Note how the string ends with a " ", it needs to be present even
    if the authorization identity is empty.
</p>
<p>The second example shows use of EXTERNAL-CHANNEL with an
    authorization identity of "simon" bound to an external
    "tls-unique" channel.  In this example, the initial response is
    sent with the client's request to initiate the authentication
    exchange.  This saves a round-trip.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      S: * ACAP (SASL "DIGEST-MD5")
      C: a001 STARTTLS
      S: a001 OK "Begin TLS negotiation now"
      &lt;TLS negotiation, further commands are under TLS layer&gt;
      S: * ACAP (SASL "DIGEST-MD5" "EXTERNAL-CHANNEL")
      C: a002 AUTHENTICATE "EXTERNAL-CHANNEL" {31+}
      C: tls-unique CI4WoQGSd7FdWPrw simon
      S: a002 NO "Cannot assume requested authorization identity"
</pre></div>
<p>Note how the server rejects the authentication attempt with an
    authorization-related error message.  Presumably the client
    credentials presented in the TLS session does not give the client
    authority to assume the identity of "simon".
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Making Authorization Decisions</h3>

<p>The server may use any mechanism to make authorization decisions.
    For illustration, we want to give some ideas on how this may work
    in practice.  This section is not normative.
</p>
<p>Typically the external channel will not use authentication
    identities that can be used by the application protocol that uses
    the SASL EXTERNAL-CHANNEL mechanism.  Thus, a mapping is normally
    required.  There may be mappings from the external credential to a
    set of permitted identifiers, and a "default" identifier can be
    provided in the mapping table if the client do not specify a
    particular authorization identity.
</p>
<p>For example, when mapping from X.509 credentials used in TLS
    connections to simple usernames, a table stored on the server can
    contain hex-encoded hashes of client X.509 certificates and a set
    of usernames.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
aef3a7835277a28da831005c2ae3b919e2076a62 simon jas admin
d2fc512490a15036460b5489401439d6da5407fa joe
</pre></div>
<p>The server could extract a successfully authenticated X.509
    client certificate from the TLS stack, hash it and look it up in
    the mapping table.  Each of the usernames given would be permitted
    authorization identities.  The first username given may be the
    default username if the client does not provide an authorization
    identity.
</p>
<p>When mapping from <a class='info' href='#RFC5081'>OpenPGP credentials used
    in TLS<span> (</span><span class='info'>Mavrogiannopoulos, N., &ldquo;Using OpenPGP Keys for Transport Layer Security (TLS) Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a> [RFC5081], the mapping table could consist of verified OpenPGP
    fingerprints and a set of permitted usernames, such as the
    following table.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0424D4EE81A0E3D119C6F835EDA21E94B565716F simon jas admin
A4D94E92B0986AB5EE9DCD755DE249965B0358A2 werner
90A79E2FC6F4AAB5B604974FE15DD857B15C37D1 nikos
</pre></div>
<p>When <a class='info' href='#RFC5054'>SRP authentication with TLS<span> (</span><span class='info'>Taylor, D., Wu, T., Mavrogiannopoulos, N., and T. Perrin, &ldquo;Using the Secure Remote Password (SRP) Protocol for TLS Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a> [RFC5054] is
    used, the username provided may be the same as the application
    username, and no mapping would be necessary.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>The IANA is request to add to the SASL mechanisms registry the
    following entry.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Subject: Registration of SASL mechanism EXTERNAL-CHANNEL
      SASL mechanism name (or prefix for the family): EXTERNAL-CHANNEL
      Security considerations: See security considerations in RFC XXXX.
      Published specification (recommended): RFC XXXX.
      Person &amp; email address to contact for further information:
          Simon Josefsson &lt;simon@josefsson.org&gt;
      Intended usage: COMMON
      Owner/Change controller: Simon Josefsson &lt;simon@josefsson.org&gt;
</pre></div>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>The EXTERNAL-CHANNEL mechanism does not authenticate users
    itself, it relies on implementation to perform the authentication
    as part of the external channel.  Care must be taken to ensure
    that the client credential has been authenticated, rather than
    just blindly accepted as part of a leap-of-faith setup.
</p>
<p>The security of external channel is critical to the security of
    this mechanism.  The connection between the authentication and the
    external channel is made via a channel binding, thus the security
    considerations related to channel bindings are also critical, see
    <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</p>
<p>We claim that by appropriately using a channel binding an
    application can protect itself from the attacks in
    <a class='info' href='#MITM'>[MITM]<span> (</span><span class='info'>Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunneled Authentication,&rdquo; .</span><span>)</span></a>.  To guarantee this property, the derived
    data is only to be used for the intended purpose.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>The EXTERNAL-CHANNEL mechanism, and significant amount of text in
    this document, is based on the EXTERNAL mechanism in Appendix A
    of <a class='info' href='#RFC4422'>SASL<span> (</span><span class='info'>Melnikov, A. and K. Zeilenga, &ldquo;Simple Authentication and Security Layer (SASL),&rdquo; June&nbsp;2006.</span><span>)</span></a> [RFC4422].
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4234">[RFC4234]</a></td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">Crocker, D., Ed.</a> and <a href="mailto:paul.overell@thus.net">P. Overell</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; RFC&nbsp;4234, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4234.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4234.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4234.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4422">[RFC4422]</a></td>
<td class="author-text">Melnikov, A. and K. Zeilenga, &ldquo;<a href="http://tools.ietf.org/html/rfc4422">Simple Authentication and Security Layer (SASL)</a>,&rdquo; RFC&nbsp;4422, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4422.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4648">[RFC4648]</a></td>
<td class="author-text">Josefsson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>,&rdquo; RFC&nbsp;4648, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4648.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5056">[RFC5056]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>,&rdquo; RFC&nbsp;5056, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5056.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2244">[RFC2244]</a></td>
<td class="author-text"><a href="mailto:chris.newman@innosoft.com">Newman, C.</a> and <a href="mailto:jgmyers@netscape.com">J. Myers</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2244">ACAP -- Application Configuration Access Protocol</a>,&rdquo; RFC&nbsp;2244, November&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2244.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4301">[RFC4301]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4301.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4346">[RFC4346]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc4346">The Transport Layer Security (TLS) Protocol Version 1.1</a>,&rdquo; RFC&nbsp;4346, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4346.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5054">[RFC5054]</a></td>
<td class="author-text">Taylor, D., Wu, T., Mavrogiannopoulos, N., and T. Perrin, &ldquo;<a href="http://tools.ietf.org/html/rfc5054">Using the Secure Remote Password (SRP) Protocol for TLS Authentication</a>,&rdquo; RFC&nbsp;5054, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5054.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5081">[RFC5081]</a></td>
<td class="author-text">Mavrogiannopoulos, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5081">Using OpenPGP Keys for Transport Layer Security (TLS) Authentication</a>,&rdquo; RFC&nbsp;5081, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5081.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="MITM">[MITM]</a></td>
<td class="author-text">Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunneled Authentication,&rdquo; WWW&nbsp;http://www.saunalahti.fi/~asokan/research/mitm.html.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Simon Josefsson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">SJD</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:simon@josefsson.org">simon@josefsson.org</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
