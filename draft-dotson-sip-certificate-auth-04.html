<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Certificate Authentication in SIP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Certificate Authentication in SIP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SIP</td><td class="header">S. Dotson</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">CableLabs</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">November 06, 2007</td></tr>
<tr><td class="header">Expires: May 9, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Certificate Authentication in SIP<br />draft-dotson-sip-certificate-auth-04</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 9, 2008.</p>

<h3>Abstract</h3>

<p>
	This document defines requirements for adding certificate authentication to the Session Initiation Protocol (SIP). The use case addressed is that of a SIP device authenticating on behalf of configured users using a device certificate for purposes such as registration. This document is being presented with the intention of providing requirements to any potential solutions specifying certificate authentication within SIP networks. Supporting certificate authentication in SIP would provide strong authentication and increase the types of possible deployment scenarios.
   	
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#overview">1.1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#usecases">1.2.</a>&nbsp;
Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">1.3.</a>&nbsp;
Terminology<br />
<a href="#existing">2.</a>&nbsp;
Existing Work<br />
<a href="#anchor2">3.</a>&nbsp;
Requirements and Recommendations<br />
<a href="#anchor3">4.</a>&nbsp;
IANA Considerations<br />
<a href="#security">5.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">6.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
		SIP enables many real-time IP communications architectures. While it offers many advantages, it is restrictive regarding the types of credentials supported. As of this writing, it only provides for username and pre-shared key based credentials. The lack of stronger credential types, specifically certificate-based credentials, is restricting certain deployment scenarios and the advantages that can be realized by them.
		<br />
<br />

		Certificates have been successfully deployed in many networks, such as PacketCable. They offer two distinct advantages, among others, over username and password based credentials:
		</p>
<ul class="text">
<li>They provide relatively stronger authentication, for example, when compared to usernames and passwords (as used commonly)
</li>
<li>They allow authentication in scenarios where the clients are not pre-configured in the SIP network (using the Public Key Infrastructure, PKI)
</li>
</ul><p>
		<br />
<br />

		Thus, SIP deployments would greatly benefit from certificate-based authentication in SIP networks. However, this requires careful consideration. This document presents such considerations, requirements, and recommendations. It does not present any solutions, which are considered out-of-scope for this document.
		
</p>
<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Overview</h3>

<p>
		The sections in the document mirror the work that was done to create the document. The use cases that were the catalyst for the document are described. The use cases in turn drove the requirements. Existing standardized solutions were then evaluated to determine their ability to meet the requirements.
		
</p>
<a name="usecases"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Use Cases</h3>

<p>
		The primary use case for the requirements discussed in this document is that of a UA registering with a SIP Registrar, where the UA has only a certificate for authentication to the network, or possibly multiple credentials with one credential being a certificate. The following diagram shows the message flows during a registration as currently defined in <a class='info' href='#RFC3261'>RFC 3261<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3261].
		
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   User                          SIP Server
     |                               |
     |          REGISTER             |
     |------------------------------&gt;|
     |                               |
     |      401 Unauthorized         |
     |&lt;------------------------------|
     |                               |
     |          REGISTER             |
     |------------------------------&gt;|
     |                               |
     |            200 OK             |
     |&lt;------------------------------|
     |                               |

</pre></div>
<p>
		In this call flow, a user sends a SIP REGISTER request to the SIP Server which includes the user's identity. The SIP server provides a challenge to the user. The user uses the challenge and its credentials to create a challenge response and sends this back to the SIP server. The SIP server validates the user's credentials.
		
</p>
<p>
		There may be multiple proxies between the UA and the Registrar. In this case, the UA needs to be able to authenticate with the Registrar using a public certificate. The following figure uses the previous example with the addition of an intermediate proxy.
		
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   User                        Proxy Server              SIP Server

     |                               |                            |
     |          REGISTER             |           REGISTER         |
     |------------------------------&gt;|---------------------------&gt;|
     |                               |                            |
     |      401 Unauthorized         |       401 Unauthorized     |
     |&lt;------------------------------|&lt;---------------------------|
     |                               |                            |
     |          REGISTER             |           REGISTER         |
     |------------------------------&gt;|---------------------------&gt;|
     |                               |                            |
     |            200 OK             |            200 OK          |
     |&lt;------------------------------|&lt;---------------------------|
     |                               |                            |

</pre></div>
<p>
		In this example, a proxy server is situated between the User and the SIP Server. The proxy does not have access to the user's subscription data. If confidentiality is used, the User and Proxy would terminate the confidentiality protection.
		
</p>
<p>
		In regards to the entity being authenticated, there are several deployment scenarios that can be readily identified. 
			</p>
<ul class="text">
<li>The entity may be a device, in which case the certificate would contain information related to the device identity (e.g., MAC address, FQDN, etc).
</li>
<li>The entity may be a user, in which case the certificate would contain information related to the user identity (e.g., SIP URI, etc).
</li>
</ul><p>
		For the purposes of this document, only the device certificate use case is considered. The registrar contains information mapping the unique device identification asserted in the certificate to authorized SIP identities for that device. These identities can then be mapped to users of the device, or user devices connected to the device such as phone handsets, as shown in the following figure.

			<br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                                     Authentication
                                &lt;======================&gt;
 +--------+
 | Phone  |        +------------+
 | Alice  |--------|            |       +-------+       +-----------+
 +--------+        |            |       |       |       |           |
                   | SIP Device |-------| Proxy |-------| Registrar |
 +--------+        |            |       |       |       |           |
 | Phone  |--------|            |       +-------+       +-----------+
 |  Bob   |        +------------+
 +--------+



</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;SIP Device Authentication&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

                <br />
<br />

		In this example, the SIP device would authenticate on behalf of configured users (e.g., Alice, Bob) to the registrar using its device certificate. The registrar would return the authorized SIP identities for that device (e.g., alice@foo.com, bob@foo.com). These identities could then be mapped by the SIP device to different phone lines. The proxy would then be responsible for ensuring only authorized SIP identities are sourced from the SIP device.
		
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Terminology</h3>

<p>
		The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in  <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
		<br />
<br />

		This document borrows SIP related terminology as specified in  <a class='info' href='#RFC3261'>RFC 3261<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3261].
		<br />
<br />

		Certificate: A <a class='info' href='#RFC3280'>PKIX<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> [RFC3280] style certificate containing a public key and a list of identities in the subjectAltName that are bound to this key.
		<br />
<br />

		End entity: User of X.509 certificates and/or end user system that is represented by the certificate.
		
</p>
<a name="existing"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Existing Work</h3>

<p>
	Currently, <a class='info' href='#RFC3261'>RFC 3261<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3261] defines procedures for performing SIP Digest authentication using usernames and passwords. SIP Digest is a challenge based mechanism for authentication. Any time a UA or proxy server receives a request it may challenge the initiator of the request to provide assurance of its identity. 	
	<br />
<br />

	SIP Digest utilizes a challenge-response authentication mechanism that may be used by a server to challenge a client request and by a client to provide authentication information. The Digest scheme challenges using a nonce value. A valid response contains a checksum of the password, username, the provided nonce value, and other parameters. As a result, the password is never sent in the clear. SIP Digest provides authentication and replay detection. Because it is based on passwords, it suffers from the security weaknesses of password based systems.
	
</p>
<p>
	The genesis for this document was the lack of an existing solution for authentication from a UA to a registrar using a public key certificate within SIP messaging. While there are mechanisms related to SIP and certificates, and SIP and authentication, none of these, as currently specified, are able to meet all the requirements of this document. The following existing solutions were reviewed:	
		</p>
<ul class="text">
<li>TLS
</li>
<li>SIP S/MIME
</li>
<li>AIB
</li>
<li>SIP Identity
</li>
<li>SIP Security Agreement
</li>
</ul><p>
	
</p>
<p>
	Following is an analysis of existing work in the IETF in relation to the requirements presented in this document.
        
</p>
<p>
	<br />
<br />

	<a class='info' href='#RFC4346'>RFC 4346<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a> [RFC4346] describes Transport Layer Security (TLS) between a client and a server. TLS provides privacy and data integrity between two communiticating applications. TLS is currently required to be supported by <a class='info' href='#RFC3261'>RFC 3261<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3261] proxy servers and registrars. Mutual TLS could be performed between the UA and it's nearest proxy in order to authenticate the UA to the proxy, and the proxy could then assert the identity of the UA through <a class='info' href='#RFC4474'>SIP Identity<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4474] or <a class='info' href='#RFC3325'>RFC 4474<span> (</span><span class='info'>Jennings, C., Peterson, J., and M. Watson, &ldquo;Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks,&rdquo; November&nbsp;2002.</span><span>)</span></a> [RFC3325] P-Asserted-Identity headers to the registrar. In this model, the edge proxy performing the authentication is part of the operator's trusted network.  
       	</p>
<ul class="text">
<li>Because device certificates contain the identity of a device (e.g., MAC address), and the registrar contains the mapping of device certificate to authorized identities, extra signaling from proxy to registrar may be needed in order to convey the device identity from the certificate to the registrar.
</li>
<li><a class='info' href='#RFC3261'>RFC 3261<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3261] does not define the use of client certificates for mutual TLS and SIP.
</li>
</ul><p>
	
</p>
<p>
	<br />
<br />

	<a class='info' href='#RFC3261'>RFC 3261<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3261] discusses the use of S/MIME and certificates to provide confidentiality, integrity and authentication of UAs. The procedures are based on the use of the CMS content types signedData, for signing messages, and enveloped data, for encrypting data. 
	</p>
<ul class="text">
<li>S/MIME is not based on challenge/response, requiring the UA to always send dialog requests S/MIME protected. This is even more of an issue where authentication of non-REGISTERs (e.g., INVITEs) is desired.
</li>
<li><a class='info' href='#RFC3261'>RFC 3261<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3261] does not define the use of using S/MIME to authenticate a UA to a registrar.
</li>
<li>S/MIME may have issues with network intermediaries that must view or modify the bodies of SIP messages (especially SDP).
</li>
<li>S/MIME does not have a means to negotiate authentication methods (assuming the authentication would be between the UA and registrar, and a UA may contain multiple credential types).
</li>
</ul><p>
	
</p>
<p>
	<br />
<br />

	<a class='info' href='#RFC3893'>RFC 3893<span> (</span><span class='info'>Peterson, J., &ldquo;Session Initiation Protocol (SIP) Authenticated Identity Body (AIB) Format,&rdquo; September&nbsp;2004.</span><span>)</span></a> [RFC3893] Authenticated Identity Body (AIB) Format defines a more specific mechansim than the S/MIME solution in <a class='info' href='#RFC3261'>RFC 3261<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3261]. It changes the MIME type and reduces the number of headers included in the cryptographic operation from those recommended in RFC 3261. As the solution is similar to RFC 3261 S/MIME in relation to the requirements in this document, the solution has the same deficiencies as S/MIME described in the previous paragraph.
	
</p>
<p>
	<a class='info' href='#RFC4474'>RFC 4474<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4474] SIP Identity provides a mechanism to cryptographically assure the identity of originators of SIP messages. As described in Section 5, Identity uses a private key and a certificate associated with the domain indicated in the From header. An authentication service authenticates the UAC and then inserts an Identity header and an Identity-Info header in the forwarded request. The Authentication Service is typically located at the outbound proxy and may authenticate the UAC using digest authentication and/or a TLS session.
	</p>
<ul class="text">
<li>Identity is not based on challenge/response, requiring the UA to always send dialog requests protected. This is even more of an issue where authentication of non-REGISTERs (e.g., INVITEs) is desired.
</li>
<li>Unless the UA is directly connected to the Authentication Service, TLS is not available to the UA to perform mutual TLS to the Authentication Service.
</li>
<li>Identity requires the Authentication Service to be authoritative for a domain, and this is typically not supported on a UA as the UA would need to be its own domain.
</li>
</ul><p>
        
</p>
<p>
	<a class='info' href='#RFC3329'>RFC 3329<span> (</span><span class='info'>Arkko, J., Torvinen, V., Camarillo, G., Niemi, A., and T. Haukka, &ldquo;Security Mechanism Agreement for the Session Initiation Protocol (SIP),&rdquo; January&nbsp;2003.</span><span>)</span></a> [RFC3329] Security Mechanism Agreement for the Session Initiation Protocol (SIP) describes a mechanism for a user agent and its next-hop SIP entity to negotiate security mechanisms. <a class='info' href='#RFC3329'>RFC 3329<span> (</span><span class='info'>Arkko, J., Torvinen, V., Camarillo, G., Niemi, A., and T. Haukka, &ldquo;Security Mechanism Agreement for the Session Initiation Protocol (SIP),&rdquo; January&nbsp;2003.</span><span>)</span></a> [RFC3329] may be used to enable confidentiality of messaging for the solution between a client and its next-hop SIP server, but it is not a solution in itself.
	
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Requirements and Recommendations</h3>

<p>
	The following are the general requirements and recommendations for the support of certificate based authentication in SIP networks. A proposed solution MUST meet all the requirements stated in this section.
      	</p>
<ol class="text">
<li>The solution MUST utilize SIP messaging and be compliant to <a class='info' href='#RFC3261'>RFC 3261<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> [RFC3261].
</li>
<li>Depending on the solution, it MAY need to follow a challenge/response paradigm, to allow the network to decide the policy for authentication (i.e., keep the client from always computing and sending authentication data).
</li>
<li>The solution MUST provide end-to-end authentication. One example is the authentication between UAs and Registrars during a registration that includes intermediate proxies. In this case, the registrar must receive enough information to ensure the authenticity of the client and the authorization of the client to receive service.
</li>
<li>A device certificate MUST represent an end entity that will be authenticated. The certificate MUST contain enough information that allows the end entity to be identified. <a class='info' href='#RFC2818'>RFC 2818<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> [RFC2818] contains some rules on end entity authentication that may be utilized in the solution.
</li>
<li>Relying parties MUST check the validity of certificates as defined in <a class='info' href='#RFC3280'>RFC 3280<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a> [RFC3280].Relying parties MAY use the additional rules of <a class='info' href='#RFC2818'>RFC 2818<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> [RFC2818] to validate end entity certificates.
</li>
<li>The solution MUST support client-only authentication and mutual authentication modes. Client-only authentication modes could be employed when mutual authentication is achieved by other means (e.g., TLS).
</li>
</ol><p>
	
</p>
<p>
	The following are the recommendations that should be considered when developing a solution that complies with this document.
	</p>
<ol class="text">
<li>This document RECOMMENDS that solutions consider a way for the entities to agree on the authentication to be used. This would allow for the coexistence and the use of multiple authentication mechanisms. Exceptions include solutions that do not allow for the use of multiple credentials.
</li>
<li>The methodology SHOULD consider message size impacts and SHOULD attempt to limit them. Bandwidth constrained environments may be impacted.
</li>
<li>The solution SHOULD re-use existing standards and solutions where applicable.
</li>
</ol><p>
	
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
IANA Considerations</h3>

<p>
	None.
	
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>
      This document defines the requirements for certificate-based authentication within SIP. As such, it does not define a specific solution or set of technologies. However, the eventual technical architecture meeting these requirements must consider the security of the solution.
	<br />
<br />

	Depending on the solution, confidentiality and integrity of messages may be necessary. Replay protection must be provided.
      
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2818">[RFC2818]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3280">[RFC3280]</a></td>
<td class="author-text">Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;<a href="http://tools.ietf.org/html/rfc3280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3280, April&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3325">[RFC3325]</a></td>
<td class="author-text">Jennings, C., Peterson, J., and M. Watson, &ldquo;<a href="http://tools.ietf.org/html/rfc3325">Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks</a>,&rdquo; RFC&nbsp;3325, November&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3325.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3329">[RFC3329]</a></td>
<td class="author-text">Arkko, J., Torvinen, V., Camarillo, G., Niemi, A., and T. Haukka, &ldquo;<a href="http://tools.ietf.org/html/rfc3329">Security Mechanism Agreement for the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;3329, January&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3329.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3893">[RFC3893]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://tools.ietf.org/html/rfc3893">Session Initiation Protocol (SIP) Authenticated Identity Body (AIB) Format</a>,&rdquo; RFC&nbsp;3893, September&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3893.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4346">[RFC4346]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc4346">The Transport Layer Security (TLS) Protocol Version 1.1</a>,&rdquo; RFC&nbsp;4346, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4346.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4474">[RFC4474]</a></td>
<td class="author-text">Peterson, J. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4474">Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4474, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4474.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Steve Dotson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">CableLabs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">858 Coal Creek Circle</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Louisville, CO  80027</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:s.dotson@cablelabs.com">s.dotson@cablelabs.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
