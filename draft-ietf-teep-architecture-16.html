<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Trusted Execution Environment Provisioning (TEEP) Architecture</title>
<meta content="Mingliang Pei" name="author">
<meta content="Hannes Tschofenig" name="author">
<meta content="Dave Thaler" name="author">
<meta content="David Wheeler" name="author">
<meta content="
       A Trusted Execution Environment (TEE) is an environment that
enforces that any code within that environment cannot be tampered with,
and that any data used by such code cannot be read or tampered with
by any code outside that environment.
This architecture document motivates the design and standardization
of a protocol for managing the lifecycle of trusted applications
running inside such a TEE. 
    " name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-teep-architecture-16" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-ietf-teep-architecture-16-bdi5ntbs.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">TEEP Architecture</td>
<td class="right">February 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Pei, et al.</td>
<td class="center">Expires 1 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TEEP</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-teep-architecture-16</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-02-28" class="published">28 February 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-01">1 September 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Pei</div>
<div class="org">Broadcom</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">D. Thaler</div>
<div class="org">Microsoft</div>
</div>
<div class="author">
      <div class="author-name">D. Wheeler</div>
<div class="org">Amazon</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Trusted Execution Environment Provisioning (TEEP) Architecture</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">A Trusted Execution Environment (TEE) is an environment that
enforces that any code within that environment cannot be tampered with,
and that any data used by such code cannot be read or tampered with
by any code outside that environment.
This architecture document motivates the design and standardization
of a protocol for managing the lifecycle of trusted applications
running inside such a TEE.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-use-cases" class="xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-payment" class="xref">Payment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-authentication" class="xref">Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-internet-of-things" class="xref">Internet of Things</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-confidential-cloud-computin" class="xref">Confidential Cloud Computing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-architecture" class="xref">Architecture</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-system-components" class="xref">System Components</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-multiple-tees-in-a-device" class="xref">Multiple TEEs in a Device</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-multiple-tams-and-relations" class="xref">Multiple TAMs and Relationship to TAs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-untrusted-apps-trusted-apps" class="xref">Untrusted Apps, Trusted Apps, and Personalization Data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="xref">4.4.1</a>.  <a href="#name-example-application-deliver" class="xref">Example: Application Delivery Mechanisms in Intel SGX</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="xref">4.4.2</a>.  <a href="#name-example-application-delivery" class="xref">Example: Application Delivery Mechanisms in Arm TrustZone</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-entity-relations" class="xref">Entity Relations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-keys-and-certificate-types" class="xref">Keys and Certificate Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-trust-anchors-in-a-teep-age" class="xref">Trust Anchors in a TEEP Agent</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-trust-anchors-in-a-tee" class="xref">Trust Anchors in a TEE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-trust-anchors-in-a-tam" class="xref">Trust Anchors in a TAM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-scalability" class="xref">Scalability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-message-security" class="xref">Message Security</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-teep-broker" class="xref">TEEP Broker</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-role-of-the-teep-broker" class="xref">Role of the TEEP Broker</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-teep-broker-implementation-" class="xref">TEEP Broker Implementation Consideration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-teep-broker-apis" class="xref">TEEP Broker APIs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-teep-broker-distribution" class="xref">TEEP Broker Distribution</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-attestation" class="xref">Attestation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-algorithm-and-attestation-a" class="xref">Algorithm and Attestation Agility</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-broker-trust-model" class="xref">Broker Trust Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-data-protection" class="xref">Data Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-compromised-ree" class="xref">Compromised REE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="xref">9.4</a>.  <a href="#name-ca-compromise-or-expiry-of-" class="xref">CA Compromise or Expiry of CA Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="xref">9.5</a>.  <a href="#name-compromised-tam" class="xref">Compromised TAM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="xref">9.6</a>.  <a href="#name-malicious-ta-removal" class="xref">Malicious TA Removal</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a href="#section-9.7" class="xref">9.7</a>.  <a href="#name-certificate-expiry-and-rene" class="xref">Certificate Expiry and Renewal</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a href="#section-9.8" class="xref">9.8</a>.  <a href="#name-keeping-secrets-from-the-ta" class="xref">Keeping Secrets from the TAM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.9">
                <p id="section-toc.1-1.9.2.9.1"><a href="#section-9.9" class="xref">9.9</a>.  <a href="#name-ree-privacy" class="xref">REE Privacy</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-contributors" class="xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Applications executing in a device are exposed to many different attacks
intended to compromise the execution of the application or reveal the
data upon which those applications are operating. These attacks increase
with the number of other applications on the device, with such other
applications coming from potentially untrustworthy sources. The
potential for attacks further increases with the complexity of features
and applications on devices, and the unintended interactions among those
features and applications. The danger of attacks on a system increases
as the sensitivity of the applications or data on the device increases.
As an example, exposure of emails from a mail client is likely to be of
concern to its owner, but a compromise of a banking application raises
even greater concerns.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The Trusted Execution Environment (TEE) concept is designed to let
applications execute in a protected environment that enforces that any code 
within that environment cannot be tampered with, 
and that any data used by such code 
cannot be read or tampered with by any code outside that environment, 
including by a commodity operating system (if present).
In a system with multiple TEEs, this also means that code in one TEE 
cannot be read or tampered with by code in another TEE.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This separation reduces the possibility
of a successful attack on application components and the data contained inside the
TEE. Typically, application components are chosen to execute inside a TEE because
those application components perform security sensitive operations or operate on
sensitive data. An application component running inside a TEE is referred to as a
Trusted Application (TA), while an application running outside any TEE, i.e., in the
Rich Execution Environment (REE),
is referred to as an Untrusted Application. In the example of a banking application, 
code that relates to the authentication protocol could reside in a TA while the 
application logic including HTTP protocol parsing could be contained in the 
Untrusted Application.  In addition, processing of credit card numbers or account balances could be done in a TA as it is sensitive data.
The precise code split is ultimately a decision of the 
developer based on the assets he or she wants to protect according to the threat model.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">TEEs are typically used in cases where a software or data asset needs to be protected
from unauthorized entities that may include the owner (or pwner) or possesser of a device.  This
situation arises for example in gaming consoles where anti-cheat protection is a concern,
devices such as ATMs or IoT devices placed in locations where attackers might have physical
access, cell phones or other devices used for mobile payments, and hosted cloud environments.  Such environments
can be thought of as hybrid devices where one user or administrator controls the REE and a
different (remote) user or administrator controls a TEE in the same physical device.
It may also be the case in some constrained devices that there is no REE (only a TEE) and there
may be no local "user" per se, only a remote TEE administrator.
For further discussion of such confidential computing use cases and threat model, see
<span>[<a href="#CC-Overview" class="xref">CC-Overview</a>]</span> and <span>[<a href="#CC-Technical-Analysis" class="xref">CC-Technical-Analysis</a>]</span>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">TEEs use hardware enforcement combined with software protection to secure TAs and
its data. TEEs typically offer a more limited set of services to TAs than is 
normally available to Untrusted Applications.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Not all TEEs are the same, however, and different vendors may have different
implementations of TEEs with different security properties, different
features, and different control mechanisms to operate on TAs. Some
vendors may themselves market multiple different TEEs with different
properties attuned to different markets. A device vendor may integrate
one or more TEEs into their devices depending on market needs.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">To simplify the life of TA developers interacting
with TAs in a TEE, an interoperable protocol for managing TAs running in
different TEEs of various devices is needed. This software update protocol 
needs to make sure that compatible trusted and untrusted components (if any) of an 
application are installed on the correct device. In this TEE ecosystem,
there often arises a need for an external trusted party to verify the
identity, claims, and rights of TA developers, devices, and their TEEs.
This external trusted party is the Trusted Application Manager (TAM).<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">The Trusted Execution Environment Provisioning (TEEP) protocol addresses
the following problems:<a href="#section-1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-9.1">An installer of an Untrusted Application that depends on a given TA
wants to request installation of that TA in the device's TEE
so that the Untrusted Application can complete, but the TEE
needs to verify whether such a TA is actually authorized to
run in the TEE and consume potentially scarce TEE resources.<a href="#section-1-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-9.2">A TA developer providing a TA whose code itself is considered
confidential wants to determine 
security-relevant information of a device before allowing their
TA to be provisioned to the TEE within the device. An example 
is the verification of 
the type of TEE included in a device and that it is capable of 
providing the security protections required.<a href="#section-1-9.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-9.3">A TEE in a device wants to determine whether an entity
that wants to manage a TA in the device is authorized to manage TAs
in the TEE, and what TAs the entity is permitted to manage.<a href="#section-1-9.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-9.4">A Device Administrator wants to determine if a TA exists (is
installed) on a device (in the TEE), and if not, install the TA in
the TEE.<a href="#section-1-9.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-9.5">A Device Administrator wants to check whether a TA in a
device's TEE is the most up-to-date version, and if not, update the
TA in the TEE.<a href="#section-1-9.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-9.6">A Device Administrator wants to remove a TA from a device's TEE if
the TA developer is no longer maintaining that TA, when the TA has
been revoked, or is not used for other reasons anymore (e.g., due to an 
expired subscription).<a href="#section-1-9.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-10">For TEEs that simply verify and load signed TA's from an untrusted
filesystem, classic application distribution protocols can be used
without modification.  The problems in the bullets above, on the other hand,
require a new protocol, i.e.,
the TEEP protocol, for TEEs that can install and enumerate TAs in a
TEE-secured location and where another domain-specific protocol standard
(e.g., <span>[<a href="#GSMA" class="xref">GSMA</a>]</span>, <span>[<a href="#OTRP" class="xref">OTRP</a>]</span>) that meets the needs is not already in use.<a href="#section-1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The following terms are used:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">Device: A physical piece of hardware that hosts one or more TEEs,
often along with
an REE.<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.2">Device Administrator:  An entity that is responsible for administration
of a device, which could be the Device Owner. A Device Administrator
has privileges on the device to install and remove Untrusted Applications and TAs,
approve or reject Trust Anchors, and approve or reject TA developers,
among possibly other privileges on the device. A Device Administrator can
manage the list of allowed TAMs by modifying the list of Trust
Anchors on the device. Although a Device Administrator may have
privileges and device-specific controls to locally administer a
device, the Device Administrator may choose to remotely
administer a device through a TAM.<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.3">Device Owner: A device is always owned by someone. In some cases, it is common for
the (primary) device user to also own the device, making the device
user/owner also the Device Administrator. In enterprise environments
it is more common for the enterprise to own the device, and any device
user has no or limited administration rights. In this case, the
enterprise appoints a Device Administrator that is not the device
owner.<a href="#section-2-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.4">Device User: A human being that uses a device. Many devices have
a single device user. Some devices have a primary device user with
other human beings as secondary device users (e.g., a parent allowing
children to use their tablet or laptop). Other devices are not used
by a human being and hence have no device user. Relates to Device Owner
and Device Administrator.<a href="#section-2-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.5">Personalization Data: A set of configuration data that is specific to
   the device or user. The Personalization Data may depend on the type of
   TEE, a particular TEE instance, the TA, and even the user of the device;
   an example of Personalization Data might be a secret symmetric key used
   by a TA to communicate with some service.<a href="#section-2-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.6">Raw Public Key: A raw public key consists of only the algorithm identifier
(type) of the key and the cryptographic public key material, such as the
SubjectPublicKeyInfo structure of a PKIX certificate <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>. Other
serialization formats that do not rely on ASN.1 may also be used.<a href="#section-2-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.7">Rich Execution Environment (REE): An environment that is provided
and governed by a typical OS (e.g., Linux, Windows, Android, iOS),
potentially in conjunction with other supporting operating systems
and hypervisors; it is outside of the TEE(s) managed by the TEEP protocol. This environment and
applications running on it are considered untrusted (or more precisely,
less trusted than a TEE).<a href="#section-2-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.8">Trust Anchor: As defined in <span>[<a href="#RFC6024" class="xref">RFC6024</a>]</span> and <span>[<a href="#I-D.ietf-suit-architecture" class="xref">I-D.ietf-suit-architecture</a>]</span>,
"A trust anchor represents an authoritative entity via a public
key and associated data.  The public key is used to verify digital
signatures, and the associated data is used to constrain the types
of information for which the trust anchor is authoritative."
The Trust Anchor may be a certificate or it may be a raw public key.<a href="#section-2-2.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.9">Trust Anchor Store: As defined in <span>[<a href="#RFC6024" class="xref">RFC6024</a>]</span>, "A trust anchor
store is a set of one or more trust anchors stored in a device...
A device may have more than one trust anchor store, each of which
may be used by one or more applications."  As noted in <span>[<a href="#I-D.ietf-suit-architecture" class="xref">I-D.ietf-suit-architecture</a>]</span>,
a Trust Anchor Store must resist modification against unauthorized
insertion, deletion, and modification.<a href="#section-2-2.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.10">Trusted Application (TA): An application (or, in some implementations, an application component) that runs in a TEE.<a href="#section-2-2.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.11">Trusted Application Manager (TAM): An entity that manages Trusted
Applications and other Trusted Components running in TEEs of various devices.<a href="#section-2-2.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.12">Trusted Component: A set of code and/or data in a TEE managed as a unit
by a Trusted Application Manager.  Trusted Applications and
Personalization Data are thus managed by being included in
Trusted Components.  Trusted OS code or trusted firmware can also be
expressed as Trusted Components that a Trusted Component depends on.<a href="#section-2-2.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.13">Trusted Component Developer: An entity that develops one or
more Trusted Components.<a href="#section-2-2.13" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.14">Trusted Component Signer: An entity that signs a Trusted Component with
a key that a TEE will trust. The signer might or might not be the
same entity as the Trusted Component Developer. For example, a Trusted Component might
be signed (or re-signed) by a Device Administrator if the TEE will
only trust the Device Administrator. A Trusted Component might also be encrypted,
if the code is considered confidential.<a href="#section-2-2.14" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.15">Trusted Execution Environment (TEE): An execution environment that enforces that
only authorized code can execute within the TEE, and data used by that
code cannot be read or tampered with by code outside the TEE.
A TEE also generally has a device unique credential that cannot be cloned.
There are multiple technologies that can be used to implement
a TEE, and the level of security achieved varies accordingly.
In addition, TEEs typically use an isolation mechanism between Trusted Applications to ensure
that one TA cannot read, modify or delete the data and code of another
TA.<a href="#section-2-2.15" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.16">Untrusted Application: An application running in an REE. An Untrusted Application 
might depend on one or more TAs.<a href="#section-2-2.16" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="use-cases">
<section id="section-3">
      <h2 id="name-use-cases">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<div id="payment">
<section id="section-3.1">
        <h3 id="name-payment">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-payment" class="section-name selfRef">Payment</a>
        </h3>
<p id="section-3.1-1">A payment application in a mobile device requires high security and
trust in the hosting device. Payments initiated from a mobile
device can use a Trusted Application
to provide strong identification and proof of transaction.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">For a mobile payment application, some biometric identification
information could also be stored in a TEE. The mobile payment
application can use such information for unlocking the device and 
for local identification of the user.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">A trusted user interface (UI) may be used in a mobile device to
prevent malicious software from stealing sensitive user input data.
Such an implementation often relies on a TEE for providing access 
to peripherals, such as PIN input or a trusted display, so that
the REE cannot observe or tamper with the user input or output.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication">
<section id="section-3.2">
        <h3 id="name-authentication">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-authentication" class="section-name selfRef">Authentication</a>
        </h3>
<p id="section-3.2-1">For better security of authentication, a device may store its
keys and cryptographic libraries inside a TEE limiting access to 
cryptographic functions via a well-defined interface and thereby 
reducing access to keying material.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="internet-of-things">
<section id="section-3.3">
        <h3 id="name-internet-of-things">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-internet-of-things" class="section-name selfRef">Internet of Things</a>
        </h3>
<p id="section-3.3-1">Weak security in Internet of Things (IoT) devices has been posing threats to 
critical infrastructure that relies upon such devices.
It is desirable that IoT devices can prevent malware from
manipulating actuators (e.g., unlocking a door), or
stealing or modifying sensitive data, such as authentication credentials
in the device. A TEE can be the best way to implement such IoT
security functions.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="confidential-cloud-computing">
<section id="section-3.4">
        <h3 id="name-confidential-cloud-computin">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-confidential-cloud-computin" class="section-name selfRef">Confidential Cloud Computing</a>
        </h3>
<p id="section-3.4-1">A tenant can store sensitive data, such as customer details or credit
card numbers, in a TEE in a cloud computing
server such that only the tenant can access the data, preventing
the cloud hosting provider from accessing the data. A tenant can
run TAs inside a server TEE for secure operation and enhanced
data security. This provides benefits not only to tenants with
better data security but also to cloud hosting providers for reduced
liability and increased cloud adoption.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="architecture">
<section id="section-4">
      <h2 id="name-architecture">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-architecture" class="section-name selfRef">Architecture</a>
      </h2>
<div id="system-components">
<section id="section-4.1">
        <h3 id="name-system-components">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-system-components" class="section-name selfRef">System Components</a>
        </h3>
<p id="section-4.1-1"><a href="#notionalarch" class="xref">Figure 1</a> shows the main components in a typical device with an REE and a
TEE. Full descriptions of
components not previously defined are provided below. Interactions of
all components are further explained in the following paragraphs.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<span id="name-notional-architecture-of-te"></span><div id="notionalarch">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-4.1-2.1">
<pre>
   +-------------------------------------------+
   | Device                                    |    Trusted Component
   |                          +--------+       |              Signer
   |    +-------------+       |        |-----------+              |
   |    | TEE-1       |       | TEEP   |---------+ |              |
   |    | +--------+  |  +----| Broker |       | | |  +--------+  |
   |    | | TEEP   |  |  |    |        |&lt;---+  | | +-&gt;|        |&lt;-+
   |    | | Agent  |&lt;----+    |        |    |  | |  +-|  TAM-1 |
   |    | +--------+  |       |        |&lt;-+ |  | +-&gt;| |        |&lt;-+
   |    |             |       +--------+  | |  |    | +--------+  |
   |    | +---+ +---+ |                   | |  |    | TAM-2  |    |
   |  +--&gt;|TA1| |TA2| |        +-------+  | |  |    +--------+    |
   |  | | |   | |   |&lt;---------| App-2 |--+ |  |                  |
   |  | | +---+ +---+ |    +-------+   |    |  |    Device Administrator
   |  | +-------------+    | App-1 |   |    |  |
   |  |                    |       |   |    |  |
   |  +--------------------|       |---+    |  |
   |                       |       |--------+  |
   |                       +-------+           |
   +-------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-notional-architecture-of-te" class="selfRef">Notional Architecture of TEEP</a>
          </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-4.1-3.1">Trusted Component Signers and Device Administrators utilize the services
of a TAM to manage TAs on devices. Trusted Component Signers do not directly interact
with devices. Device Administators may elect to use a TAM for remote administration
of TAs instead of managing each device directly.<a href="#section-4.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-3.2">
            <p id="section-4.1-3.2.1">Trusted Application Manager (TAM):  A TAM is responsible for performing lifecycle
management activity on Trusted Components on behalf of Trusted Component Signers
and Device Administrators. This includes installation and
deletion of Trusted Components, and may include, for example, over-the-air
updates to keep Trusted Components up-to-date and clean up when Trusted Components
should be removed. TAMs may provide services that make it easier for
Trusted Component Signers or Device Administators to use the TAM's service to manage multiple devices,
although that is not required of a TAM.<a href="#section-4.1-3.2.1" class="pilcrow">¶</a></p>
<p id="section-4.1-3.2.2">
The TAM performs its management of Trusted Components on the device through
interactions with a device's TEEP Broker, which relays
messages between a TAM and a TEEP Agent running inside the TEE. 
TEEP authentication is performed between a TAM and a TEEP Agent.<a href="#section-4.1-3.2.2" class="pilcrow">¶</a></p>
<p id="section-4.1-3.2.3">
As shown in
<a href="#notionalarch" class="xref">Figure 1</a>, the TAM cannot directly contact a TEEP Agent, but must
wait for the TEEP Broker to contact
the TAM requesting a particular service. This architecture is
intentional in order to accommodate network and application firewalls
that normally protect user and enterprise devices from arbitrary
connections from external network entities.<a href="#section-4.1-3.2.3" class="pilcrow">¶</a></p>
<p id="section-4.1-3.2.4">
A TAM may be publicly available for use by many Trusted Component Signers, or a TAM
may be private, and accessible by only one or a limited number of
Trusted Component Signers. It is expected that many enterprises, manufacturers, and network carriers
will run their own private TAM.<a href="#section-4.1-3.2.4" class="pilcrow">¶</a></p>
<p id="section-4.1-3.2.5">
A Trusted Component Signer or Device Administrator chooses a particular TAM based on
whether the TAM is trusted by a device or set of devices. The
TAM is trusted by a device if the TAM's public key is, or chains up to,
an authorized
Trust Anchor in the device. A Trusted Component Signer or Device Administrator may run
their own TAM, but the devices they wish to manage must include
this TAM's public key or certificate, or a certificate it chains up to, in the
Trust Anchor Store.<a href="#section-4.1-3.2.5" class="pilcrow">¶</a></p>
<p id="section-4.1-3.2.6">
A Trusted Component Signer or Device Administrator is free to utilize multiple TAMs. This may
be required for managing Trusted Components on multiple different types of devices
from different manufacturers, or mobile devices on
different network carriers, since
the Trust Anchor Store on these different devices may contain keys
for different
TAMs. A Device Administrator may be able to add their own TAM's
public key or certificate, or a certificate it chains up to, to the Trust Anchor Store on all their devices,
overcoming this limitation.<a href="#section-4.1-3.2.6" class="pilcrow">¶</a></p>
<p id="section-4.1-3.2.7">
Any entity is free to operate a TAM. For a TAM to be successful, it must
have its public key or certificate installed in a device's Trust Anchor Store.
A TAM may set up a relationship with device manufacturers or network carriers
to have them install the TAM's keys in their device's Trust Anchor Store.
Alternatively, a TAM may publish its certificate and allow Device
Administrators to install the TAM's certificate in their devices as
an after-market action.<a href="#section-4.1-3.2.7" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.3">TEEP Broker: A TEEP Broker is an application component running in a Rich
Execution Environment (REE) that enables the message protocol exchange between
a TAM and a TEE in a device. A TEEP Broker does not process messages
on behalf of a TEE, but merely is responsible for relaying messages from
the TAM to the TEE, and for returning the TEE's responses to the TAM.
In devices with no REE (e.g., a microcontroller where all code runs
in an environment that meets the definition of a Trusted Execution
Environment in <a href="#terminology" class="xref">Section 2</a>), the TEEP Broker would be absent and
instead the
TEEP protocol transport would be implemented inside the TEE itself.<a href="#section-4.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-3.4">TEEP Agent: The TEEP Agent is a processing module running inside
a TEE that receives TAM requests (typically relayed via a TEEP Broker
that runs in an REE). A TEEP Agent in the TEE may parse requests or
forward requests to other processing modules in a TEE, which is
up to a TEE provider's implementation. A response message
corresponding to a TAM request is sent back to the TAM, again typically
relayed via a TEEP Broker.<a href="#section-4.1-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-3.5">Certification Authority (CA): A CA is an entity that issues digital 
certificates (especially X.509 certificates) and vouches for the 
binding between the data items in a certificate <span>[<a href="#RFC4949" class="xref">RFC4949</a>]</span>. 
Certificates are then used for authenticating a device, a TAM, or a 
Trusted Component Signer, as discussed in <a href="#trustanchors" class="xref">Section 5</a>.  The CAs do not need to be the same;
different CAs can be chosen by each TAM, and different device CAs
can be used by different device manufacturers.<a href="#section-4.1-3.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="multiple-tees-in-a-device">
<section id="section-4.2">
        <h3 id="name-multiple-tees-in-a-device">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-multiple-tees-in-a-device" class="section-name selfRef">Multiple TEEs in a Device</a>
        </h3>
<p id="section-4.2-1">Some devices might implement multiple TEEs. 
In these cases, there might be one shared TEEP Broker 
that interacts with all the TEEs in the device.
However, some TEEs (for example, SGX <span>[<a href="#SGX" class="xref">SGX</a>]</span>) present themselves as separate containers
within memory without a controlling manager within the TEE. As such,
there might be multiple TEEP Brokers in the REE,
where each TEEP Broker communicates with one or more TEEs associated with it.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">It is up to the REE and the Untrusted Applications
how they select the correct TEEP Broker. Verification that the correct TA
has been reached then becomes a matter of properly verifying TA attestations,
which are unforgeable.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">The multiple TEEP Broker approach is shown in the diagram below.
For brevity, TEEP Broker 2 is shown interacting with only one TAM and Untrusted Application and only one TEE, but
no such limitations are intended to be implied in the architecture.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<span id="name-notional-architecture-of-tee"></span><div id="notionalarch2">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-4.2-4.1">
<pre>
   +-------------------------------------------+            Trusted
   | Device                                    |          Component
   |                                           |             Signer
   |    +-------------+                        |                  |
   |    | TEE-1       |                        |                  |
   |    | +-------+   |       +--------+       |      +--------+  |
   |    | | TEEP  |   |       | TEEP   |-------------&gt;|        |&lt;-+
   |    | | Agent |&lt;----------| Broker |       |      |        | TA
   |    | | 1     |   |       | 1      |---------+    |        |
   |    | +-------+   |       |        |       | |    |        |
   |    |             |       |        |&lt;---+  | |    |        |
   |    | +---+ +---+ |       |        |    |  | |  +-|  TAM-1 |Policy
   |    | |TA1| |TA2| |       |        |&lt;-+ |  | +-&gt;| |        |&lt;-+
   |  +--&gt;|   | |   |&lt;---+    +--------+  | |  |    | +--------+  |
   |  | | +---+ +---+ |  |                | |  |    | TAM-2  |    |
   |  | |             |  |     +-------+  | |  |    +--------+    |
   |  | +-------------+  +-----| App-2 |--+ |  |       ^          |
   |  |                    +-------+   |    |  |       |       Device
   |  +--------------------| App-1 |   |    |  |       |   Administrator
   |                +------|       |   |    |  |       |
   |    +-----------|-+    |       |---+    |  |       |
   |    | TEE-2     | |    |       |--------+  |       |
   |    | +------+  | |    |       |------+    |       |
   |    | | TEEP |  | |    +-------+      |    |       |
   |    | | Agent|&lt;-----+                 |    |       |
   |    | | 2    |  | | |                 |    |       |
   |    | +------+  | | |                 |    |       |
   |    |           | | |                 |    |       |
   |    | +---+     | | |                 |    |       |
   |    | |TA3|&lt;----+ | |  +----------+   |    |       |
   |    | |   |       | |  | TEEP     |&lt;--+    |       |
   |    | +---+       | +--| Broker   |        |       |
   |    |             |    | 2        |----------------+
   |    +-------------+    +----------+        |
   |                                           |
   +-------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-notional-architecture-of-tee" class="selfRef">Notional Architecture of TEEP with multiple TEEs</a>
          </figcaption></figure>
</div>
<p id="section-4.2-5">In the diagram above, TEEP Broker 1 controls interactions with the TAs in TEE-1,
and TEEP Broker 2 controls interactions with the TAs in TEE-2. This presents some
challenges for a TAM in completely managing the device, since a TAM may not
interact with all the TEEP Brokers on a particular platform. In addition, since
TEEs may be physically separated, with wholly different resources, there may be no
need for TEEP Brokers to share information on installed Trusted Components or resource usage.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-tams-and-relationship-to-tas">
<section id="section-4.3">
        <h3 id="name-multiple-tams-and-relations">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-multiple-tams-and-relations" class="section-name selfRef">Multiple TAMs and Relationship to TAs</a>
        </h3>
<p id="section-4.3-1">As shown in <a href="#notionalarch2" class="xref">Figure 2</a>, a TEEP Broker provides communication between 
one or more TEEP Agents and
one or more TAMs. The selection of which TAM to interact with might be
made with or without input from an Untrusted Application, but is ultimately
the decision of a TEEP Agent.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">A TEEP Agent is assumed to be able to determine, for any given Trusted Component,
whether that Trusted Component is installed (or minimally, is running) in a TEE with
which the TEEP Agent is associated.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Each Trusted Component is digitally signed, protecting its integrity, and linking
the Trusted Component back to the Trusted Component Signer. The Trusted Component Signer is often the Trusted Component Developer, but in
some cases might be another party such as a Device Administrator
or other party
to whom the code has been licensed (in which case the same code might
be signed by multiple licensees and distributed as if it were different TAs).<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">A Trusted Component Signer selects one or more TAMs and communicates the Trusted Component(s) to the TAM.
For example, the Trusted Component Signer might choose TAMs based upon the markets into which the TAM can provide access. There
may be TAMs that provide services to specific types of devices, or device
operating systems, or specific geographical regions or network carriers. A Trusted Component Signer may be
motivated to utilize multiple TAMs in order to maximize market penetration
and availability on multiple types of devices. This means that the same Trusted Component
will often be available through multiple TAMs.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">When the developer of an Untrusted Application that depends on a Trusted Component publishes
the Untrusted Application to an app store or other app repository, the developer
optionally binds the Untrusted Application with a manifest that identifies
what TAMs can be contacted for
the Trusted Component. In some situations, a Trusted Component may only be available via a single TAM - this is likely the case
for enterprise applications or Trusted Component Signers serving a closed community. For broad public apps,
there will likely be multiple TAMs in the Untrusted Application's manifest - one servicing one brand of mobile
device and another servicing a different manufacturer, etc. Because different devices
and different manufacturers trust different TAMs, the manifest can include multiple
TAMs that support the required Trusted Component.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">When a TEEP Broker receives a request (see the RequestTA API in <a href="#apis" class="xref">Section 6.2.1</a>) from an Untrusted Application to install a Trusted Component,
a list of TAM URIs may be provided for that Trusted Component, and the request is passed to the TEEP Agent.
If the TEEP Agent decides that the Trusted Component needs to be installed, the TEEP Agent selects a single TAM URI
that is consistent with the list of trusted TAMs provisioned in the TEEP Agent, invokes the
HTTP transport for TEEP to connect to the TAM URI, and begins a TEEP protocol exchange.  When the TEEP Agent
subsequently receives the Trusted Component to install and the Trusted Component's manifest indicates dependencies
on any other trusted components, each dependency can include a list of TAM URIs for the
relevant dependency.  If such dependencies exist that are prerequisites to install the Trusted Component,
then the TEEP Agent recursively follows the same procedure for each dependency that needs to be installed
or updated, including selecting a TAM URI that is consistent with the list of trusted TAMs provisioned
on the device, and beginning a TEEP exchange.  If multiple TAM URIs are considered trusted,
only one needs to be contacted and they can be attempted in some order until one responds.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">Separate from the Untrusted Application's manifest, this framework relies on the use of the manifest 
format in <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span> for expressing how to install a Trusted Component, as well as any
dependencies on other TEE components and versions.
That is, dependencies from Trusted Components on other Trusted Components can be expressed in a SUIT manifest,
including dependencies on any other TAs, trusted OS code (if any), or trusted firmware.
Installation steps can also be expressed in a SUIT manifest.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">For example, TEEs compliant
with GlobalPlatform <span>[<a href="#GPTEE" class="xref">GPTEE</a>]</span> may have a notion of a "security domain" (which is a grouping of
one or more TAs installed on a device, that can share information within such a group)
that must be created and into which one or more TAs can then be installed. It is thus up
to the SUIT manifest to express a dependency on having such a security domain existing
or being created first, as appropriate.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3-9">Updating a Trusted Component may cause compatibility issues with any Untrusted Applications or other
components that depend on the updated Trusted Component, just like updating the OS or a shared library
could impact an Untrusted Application.  Thus, an implementation needs to take into
account such issues.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="untrusted-apps-trusted-apps-and-personalization-data">
<section id="section-4.4">
        <h3 id="name-untrusted-apps-trusted-apps">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-untrusted-apps-trusted-apps" class="section-name selfRef">Untrusted Apps, Trusted Apps, and Personalization Data</a>
        </h3>
<p id="section-4.4-1">In TEEP, there is an explicit relationship and dependence between an Untrusted Application
in an REE and one or more TAs in a TEE, as shown in <a href="#notionalarch2" class="xref">Figure 2</a>.
For most purposes, an Untrusted Application that uses one or more TAs in a TEE
appears no different from any other Untrusted Application in the REE. However, the way
the Untrusted Application and its corresponding TAs are packaged, delivered, and installed on
the device can vary. The variations depend on whether the Untrusted Application and TA are bundled
together or are provided separately, and this has implications to the management of
the TAs in a TEE. In addition to the Untrusted Application and TA(s), the TA(s) and/or TEE may also require additional data to personalize the TA to the device or a user.
Implementations must support encryption of such
Personalization Data to preserve the confidentiality of potentially
sensitive data contained within it, and must support integrity protection
of the Personalization Data.
Other than the requirement to support confidentiality and integrity protection,
the TEEP architecture places no limitations or requirements on the Personalization Data.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">There are multiple possible cases for bundling of an Untrusted Application, TA(s), and Personalization Data.
Such cases include (possibly among others):<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4-3">
<li id="section-4.4-3.1">The Untrusted Application, TA(s), and Personalization Data are all bundled together in a single
package by a Trusted Component Signer and either provided to the TEEP Broker through the TAM, or provided separately (with encrypted Personalization Data), with
key material needed to decrypt and install the Personalization
Data and TA provided by a TAM.<a href="#section-4.4-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-3.2">The Untrusted Application and the TA(s) are bundled together in a single package, which a TAM or
a publicly accessible app store maintains, and the Personalization Data
is separately provided by the Personalization Data provider's TAM.<a href="#section-4.4-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-3.3">All components are independent packages. The Untrusted Application is installed through some
independent or device-specific mechanism, and one or more TAMs provide (directly or indirectly by reference)
the TA(s) and Personalization Data.<a href="#section-4.4-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-3.4">The TA(s) and Personalization Data are bundled together into a package provided by a TAM,
while the Untrusted Application is installed through some independent
or device-specific mechanism such as an app store.<a href="#section-4.4-3.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-3.5">Encrypted Personalization Data is bundled into a package distributed with the Untrusted
Application, while the TA(s) and key material needed to decrypt and install the Personalization Data
are in a separate package provided by a TAM.<a href="#section-4.4-3.5" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.4-4">The TEEP protocol can treat each TA, any dependencies the TA has, and Personalization Data as
separate Trusted Components with separate installation steps that are expressed in SUIT manifests,
and a SUIT manifest might contain or reference multiple binaries (see <span>[<a href="#I-D.ietf-suit-manifest" class="xref">I-D.ietf-suit-manifest</a>]</span>
for more details). The TEEP Agent is responsible for handling any installation steps
that need to be performed inside the TEE, such as decryption of private TA binaries or
Personalization Data.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">In order to better understand these cases, it is helpful to review actual implementations of TEEs and their application delivery mechanisms.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<div id="example-application-delivery-mechanisms-in-intel-sgx">
<section id="section-4.4.1">
          <h4 id="name-example-application-deliver">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-example-application-deliver" class="section-name selfRef">Example: Application Delivery Mechanisms in Intel SGX</a>
          </h4>
<p id="section-4.4.1-1">In Intel Software Guard Extensions (SGX), the Untrusted Application and TA are typically bundled into the
same package (Case 2). The TA 
exists in the package as a shared library (.so or .dll). The Untrusted Application loads the TA into
an SGX enclave when the Untrusted Application needs the TA. This organization makes it easy to maintain
compatibility between the Untrusted Application and the TA, since they are updated together. It is
entirely possible to create an Untrusted Application that loads an external TA into an SGX enclave, and
use that TA (Cases 3-5). In this case, the Untrusted Application would require a reference to an external
file or download such a file dynamically, place the contents of the file into memory, and
load that as a TA. Obviously, such file or downloaded content must be properly formatted
and signed for it to be accepted by the SGX TEE.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-2">In SGX, any
Personalization Data is normally loaded into the SGX enclave (the TA) after the TA has
started. Although it is possible with SGX to include the Untrusted Application in an encrypted
package along with Personalization Data (Cases 1 and 5), there are no instances of this known to
be in use at this time, since such a construction would require a special installation
program and SGX TA (which might or might not be the TEEP Agent itself based on the implementation)
to receive the encrypted package, decrypt it, separate it into the
different elements, and then install each one. This installation is complex
because the Untrusted Application decrypted inside the TEE must be passed out of the TEE to an
installer in the REE which would install the Untrusted Application.
Finally, the Personalization Data would need to be sent out of the
TEE (encrypted in an SGX enclave-to-enclave manner) to the REE's installation app, which
would pass this data to the installed Untrusted Application, which would in turn send this data
to the SGX enclave (TA). This complexity is due to the fact that each SGX enclave is separate
and does not have direct communication to other SGX enclaves.<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.4.1-3">As long as signed files (TAs and/or Personalization Data) are installed into
an untrusted filesystem and trust is verified by the TEE at load time, classic
distribution mechanisms can be used.  Some uses of SGX, however, allow a model
where a TA can be dynamically installed into an SGX enclave that
provides a runtime platform.  The TEEP protocol can be used in
such cases, where the runtime platform could include a TEEP Agent.<a href="#section-4.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-application-delivery-mechanisms-in-arm-trustzone">
<section id="section-4.4.2">
          <h4 id="name-example-application-delivery">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-example-application-delivery" class="section-name selfRef">Example: Application Delivery Mechanisms in Arm TrustZone</a>
          </h4>
<p id="section-4.4.2-1">In Arm TrustZone <span>[<a href="#TrustZone" class="xref">TrustZone</a>]</span> for A-class devices, the Untrusted Application and TA may or may not be
bundled together. This differs from SGX since in TrustZone the TA lifetime is not inherently tied
to a specific Untrused Application process lifetime as occurs in SGX.  A TA is loaded by
a trusted OS running in the TEE such as a GlobalPlatform <span>[<a href="#GPTEE" class="xref">GPTEE</a>]</span> compliant TEE, where the trusted OS is 
separate from the OS in the REE.
Thus Cases 2-4 are equally applicable.  In addition, it is possible for TAs to communicate
with each other without involving any Untrusted Application, and so the complexity of Cases 1 and 5
are lower than in the SGX example, though still more
complex than Cases 2-4.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2-2">A trusted OS running in the TEE (e.g., OP-TEE) that supports loading and verifying signed TAs from
an untrusted filesystem can, like SGX, use classic file distribution
mechanisms.  If secure TA storage is used (e.g., a Replay-Protected
Memory Block device) on the other hand, the TEEP protocol can be used
to manage such storage.<a href="#section-4.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="entity-relations">
<section id="section-4.5">
        <h3 id="name-entity-relations">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-entity-relations" class="section-name selfRef">Entity Relations</a>
        </h3>
<p id="section-4.5-1">This architecture leverages asymmetric cryptography to
authenticate a device to a TAM. Additionally, a TEEP Agent
in a device authenticates a TAM. The
provisioning of Trust Anchors to a device may be different from
one use case to the other. A Device Administrator may want to
have the capability to control what TAs are allowed.
A device manufacturer enables verification by one or more TAMs and by Trusted Component Signers; 
it may embed a list of default Trust Anchors into the TEEP Agent
and TEE for TAM trust verification and TA signature verification.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<span id="name-example-developer-experienc"></span><div id="experience">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-4.5-2.1">
<pre>
 (App Developers)   (App Store)   (TAM)      (Device with TEE)  (CAs)
        |                   |       |                |            |
        |                   |       |      (Embedded TEE cert) &lt;--|
        |                   |       |                |            |
        | &lt;--- Get an app cert -----------------------------------|
        |                   |       |                |            |
        |                   |       | &lt;-- Get a TAM cert ---------|
        |                   |       |                |            |
1. Build two apps:          |       |                |            |
                            |       |                |            |
   (a) Untrusted            |       |                |            |
       App - 2a. Supply --&gt; | --- 3. Install ------&gt; |            |
                            |       |                |            |
   (b) TA -- 2b. Supply ----------&gt; | 4. Messaging--&gt;|            |
                            |       |                |            |
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-example-developer-experienc" class="selfRef">Example Developer Experience</a>
          </figcaption></figure>
</div>
<p id="section-4.5-3"><a href="#experience" class="xref">Figure 3</a> shows an example where the same developer builds and signs
two applications: (a) an Untrusted Application; (b) a TA
that provides some security functions to be run inside
a TEE.  This example assumes that the developer, the TEE, and the TAM have
previously been provisioned with certificates.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">At step 1, the developer authors the two applications.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<p id="section-4.5-5">At step 2, the developer uploads the
Untrusted Application (2a) to an Application Store. 
In this example, the developer is also the Trusted Component Signer, and so generates
a signed TA.
The developer can then either bundle the signed TA
with the Untrusted Application, or the developer can provide a signed Trusted Component containing the TA
to a TAM that will be managing the TA in various devices.<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<p id="section-4.5-6">At step 3, a user
will go to an Application Store to download the Untrusted
Application (where the arrow indicates the direction of data transfer).<a href="#section-4.5-6" class="pilcrow">¶</a></p>
<p id="section-4.5-7">At step 4, since the Untrusted Application depends on the TA,
installing the Untrusted Application will trigger TA installation
via communication with a TAM. The TEEP Agent
will interact with the TAM via a TEEP Broker that faciliates communications between the TAM
and the TEEP Agent.<a href="#section-4.5-7" class="pilcrow">¶</a></p>
<p id="section-4.5-8">Some Trusted Component installation implementations might ask for a user's consent. In other
implementations,
a Device Administrator might choose what Untrusted Applications and related Trusted Components to
be installed. A user consent flow is out of scope of the TEEP architecture.<a href="#section-4.5-8" class="pilcrow">¶</a></p>
<p id="section-4.5-9">The main components of the TEEP protocol
consist of a set of standard messages created by
a TAM to deliver Trusted Component management commands to a device,
and device attestation and response messages created by a TEE that
responds to a TAM's message.<a href="#section-4.5-9" class="pilcrow">¶</a></p>
<p id="section-4.5-10">It should be noted that network communication capability is generally
not available in TAs in today's TEE-powered devices.  Consequently, Trusted
Applications generally rely on a broker in the REE to provide access to
network functionality in the REE.  A broker does not need to know the actual
content of messages to facilitate such access.<a href="#section-4.5-10" class="pilcrow">¶</a></p>
<p id="section-4.5-11">Similarly, since the TEEP Agent runs inside a TEE, the TEEP Agent generally
relies on a TEEP Broker in the REE to provide network access, and relay
TAM requests to the TEEP Agent and relay the responses back to the TAM.<a href="#section-4.5-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="trustanchors">
<section id="section-5">
      <h2 id="name-keys-and-certificate-types">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-keys-and-certificate-types" class="section-name selfRef">Keys and Certificate Types</a>
      </h2>
<p id="section-5-1">This architecture leverages the following credentials, which allow
achieving end-to-end security between a TAM and a TEEP Agent.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2"><a href="#keys" class="xref">Figure 4</a> summarizes the relationships between various keys and where
they are stored.  Each public/private key identifies a Trusted Component Signer, TAM, or TEE,
and gets a certificate that chains up to some trust anchor.  A list of trusted
certificates is used to check a presented certificate against.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Different CAs can be used for different
types of certificates.  TEEP messages are always signed, where the signer
key is the message originator's private key, such as that of a TAM
or a TEE.  In addition to the keys shown in <a href="#keys" class="xref">Figure 4</a>,
there may be additional keys used for attestation or encryption.  Refer to the 
RATS Architecture <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span> for more discussion.<a href="#section-5-3" class="pilcrow">¶</a></p>
<span id="name-signature-keys"></span><div id="keys">
<figure id="figure-4">
        <div class="alignLeft art-text artwork" id="section-5-4.1">
<pre>
                    Cardinality &amp;                    Location of
                     Location of    Private Key     Trust Anchor
Purpose              Private Key       Signs           Store
------------------   -----------   -------------    -------------
Authenticating        1 per TEE    TEEP responses       TAM
TEEP Agent

Authenticating TAM    1 per TAM    TEEP requests     TEEP Agent

Code Signing          1 per Trusted  TA binary          TEE
                      Component
                      Signer
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-signature-keys" class="selfRef">Signature Keys</a>
        </figcaption></figure>
</div>
<p id="section-5-5">Note that Personalization Data is not included in the table above. 
The use of Personalization Data is dependent on how TAs are used 
and what their security requirements are.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">TEEP requests from a TAM to a TEEP Agent are signed with the TAM
private key (for authentication and integrity protection). 
Personalization Data and TA binaries can be encrypted with a key 
that is established with a content-encryption key established with 
the TEE public key (to provide confidentiality). Conversely, 
TEEP responses from a TEEP Agent to a TAM can be signed with the TEE 
private key.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">The TEE key pair and certificate are thus used for authenticating the TEE
to a remote TAM, and for sending private data to the TEE.   Often, 
the key pair is burned into the TEE by the
TEE manufacturer and the key pair and its certificate are valid for
the expected lifetime of the TEE.  A TAM provider is responsible
for configuring the TAM's Trust Anchor Store with the manufacturer certificates or CAs
that are used to sign TEE keys. This is discussed further in
<a href="#trust-anchors-in-tam" class="xref">Section 5.3</a> below.  Typically
the same key TEE pair is used for both signing and encryption, though separate
key pairs might also be used in the future, as the joint security of
encryption and signature with a single key remains to some extent an open
question in academic cryptography.<a href="#section-5-7" class="pilcrow">¶</a></p>
<p id="section-5-8">The TAM key pair and certificate are used for authenticating a TAM
to a remote TEE, and for sending private data to the TAM (separate key 
pairs for authentication vs. encryption could also be used in the future).  A TAM provider
is responsible for acquiring a
certificate from a CA that is trusted by the TEEs it manages. This
is discussed further in <a href="#trust-anchors-in-teep-agent" class="xref">Section 5.1</a> below.<a href="#section-5-8" class="pilcrow">¶</a></p>
<p id="section-5-9">The Trusted Component Signer key pair and certificate are used to sign Trusted Components that the TEE
will consider authorized to execute.  TEEs must be configured with
the certificates or keys that it considers authorized to sign TAs
that it will execute.  This is discussed further in
<a href="#trust-anchors-in-tee" class="xref">Section 5.2</a> below.<a href="#section-5-9" class="pilcrow">¶</a></p>
<div id="trust-anchors-in-teep-agent">
<section id="section-5.1">
        <h3 id="name-trust-anchors-in-a-teep-age">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-trust-anchors-in-a-teep-age" class="section-name selfRef">Trust Anchors in a TEEP Agent</a>
        </h3>
<p id="section-5.1-1">A TEEP Agent's Trust Anchor Store contains a list of Trust Anchors, which
are typically CA certificates that sign various TAM certificates.  The list
is typically preloaded at manufacturing time, and
can be updated using the TEEP protocol if the TEE has some form of
"Trust Anchor Manager TA" that has Trust Anchors in its configuration data.
Thus, Trust Anchors can be updated similarly to the Personalization Data
for any other TA.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">When Trust Anchor update is carried out, it is imperative that any update
must maintain integrity where only an authentic Trust Anchor list from
a device manufacturer or a Device Administrator is accepted. Details
are out of scope of the architecture and can be addressed in a protocol
document.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">Before a TAM can begin operation in the marketplace to support a
device with a particular TEE, it must be able to get its raw public
key, or its certificate, or a certificate it chains up to, listed in
the Trust Anchor Store of the TEEP Agent.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-anchors-in-tee">
<section id="section-5.2">
        <h3 id="name-trust-anchors-in-a-tee">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-trust-anchors-in-a-tee" class="section-name selfRef">Trust Anchors in a TEE</a>
        </h3>
<p id="section-5.2-1">The Trust Anchor Store in a TEE contains a list of Trust Anchors (raw public keys
or certificates) that are used to determine whether TA binaries are allowed to execute by 
checking if their signatures can be verified.  The list
is typically preloaded at manufacturing time, and
can be updated using the TEEP protocol if the TEE has some form of
"Trust Anchor Manager TA" that has Trust Anchors in its configuration data.
Thus, Trust Anchors can be updated similarly to the Personalization Data
for any other TA, as discussed in <a href="#trust-anchors-in-teep-agent" class="xref">Section 5.1</a>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-anchors-in-tam">
<section id="section-5.3">
        <h3 id="name-trust-anchors-in-a-tam">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-trust-anchors-in-a-tam" class="section-name selfRef">Trust Anchors in a TAM</a>
        </h3>
<p id="section-5.3-1">The Trust Anchor Store in a TAM consists of a list of Trust Anchors, which
are certificates that sign various device TEE certificates.  A TAM will accept a
device for Trusted Component management if the TEE in the device uses a TEE certificate
that is chained to a certificate or raw public key that the TAM trusts, is contained in an allow list, 
is not found on a block list, and/or fulfills any other policy criteria.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scalability">
<section id="section-5.4">
        <h3 id="name-scalability">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-scalability" class="section-name selfRef">Scalability</a>
        </h3>
<p id="section-5.4-1">This architecture uses a PKI (including self-signed certificates). Trust Anchors exist on the devices to
enable the TEEP Agent to authenticate TAMs and the TEE to authenticate
Trusted Component Signers, and TAMs use Trust Anchors to
authenticate TEEP Agents.  When a PKI is used, many intermediate CA
certificates can chain to a root certificate, each of which can issue
many certificates.  This makes the protocol highly scalable.  New
factories that produce TEEs can join the ecosystem.  In this case,
such a factory can get an intermediate CA certificate from one of the
existing roots without requiring that TAMs are updated with
information about the new device factory.  Likewise, new TAMs can
join the ecosystem, providing they are issued a TAM certificate that
chains to an existing root whereby existing TEEs will be allowed to
be personalized by the TAM without requiring changes to the TEE
itself.  This enables the ecosystem to scale, and avoids the need for
centralized databases of all TEEs produced or all TAMs that exist or
all Trusted Component Signers that exist.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-security">
<section id="section-5.5">
        <h3 id="name-message-security">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-message-security" class="section-name selfRef">Message Security</a>
        </h3>
<p id="section-5.5-1">Messages created by a TAM are used to deliver Trusted Component
management commands to a device, and device attestation and
messages are created by the device TEE to respond to TAM messages.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">These messages are signed end-to-end between a TEEP Agent and a TAM.
Confidentiality is provided by encrypting sensitive payloads (such as
Personalization Data and attestation evidence), rather than encrypting the
messages themselves.  Using encrypted payloads is important to ensure
that only the targeted device TEE or TAM is able to decrypt and view
the actual content.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="broker">
<section id="section-6">
      <h2 id="name-teep-broker">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-teep-broker" class="section-name selfRef">TEEP Broker</a>
      </h2>
<p id="section-6-1">A TEE and TAs often do not have the capability to directly communicate
outside of the hosting device.  For example, GlobalPlatform
<span>[<a href="#GPTEE" class="xref">GPTEE</a>]</span> specifies one such architecture.  This calls for a software
module in the REE world to handle network communication with a TAM.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">A TEEP Broker is an application component
running in the REE of the device or an SDK that facilitates
communication between a TAM and a TEE.  It also provides interfaces for
Untrusted Applications to query and trigger installation of Trusted Components that the
application needs to use.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">An Untrusted Application might communicate with a TEEP Broker at runtime
to trigger Trusted Component installation itself, or an Untrusted Application might simply
have a metadata file that describes the Trusted Components it depends on and the associated TAM(s) for each Trusted Component,
and an REE Application Installer can inspect this
application metadata file and invoke the TEEP Broker to trigger Trusted Component installation
on behalf of the Untrusted
Application without requiring the Untrusted Application to run first.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="role-of-the-teep-broker">
<section id="section-6.1">
        <h3 id="name-role-of-the-teep-broker">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-role-of-the-teep-broker" class="section-name selfRef">Role of the TEEP Broker</a>
        </h3>
<p id="section-6.1-1">A TEEP Broker abstracts the message exchanges with a TEE in a device.
The input data is originated from a TAM or the first initialization
call to trigger a Trusted Component installation.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The Broker doesn't need to parse TEEP message content received from a TAM
that should be processed by a TEE (see the ProcessTeepMessage API in <a href="#apis" class="xref">Section 6.2.1</a>).
When a device has more than one TEE, one TEEP Broker per TEE could
be present in the REE or a common TEEP Broker could be used by multiple TEEs
where the transport protocol (e.g., <span>[<a href="#I-D.ietf-teep-otrp-over-http" class="xref">I-D.ietf-teep-otrp-over-http</a>]</span>) allows
the TEEP Broker to distinguish which TEE is relevant for each message from a TAM.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">The TEEP Broker interacts with a TEEP Agent inside a TEE, and
relays the response messages generated from the TEEP Agent back to the TAM.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">The Broker only needs to return a (transport) error message to the TAM if the TEE is
not reachable for some reason.  Other errors are represented as
TEEP response messages returned from the TEE which will then be passed to
the TAM.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="teep-broker-implementation-consideration">
<section id="section-6.2">
        <h3 id="name-teep-broker-implementation-">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-teep-broker-implementation-" class="section-name selfRef">TEEP Broker Implementation Consideration</a>
        </h3>
<p id="section-6.2-1">As depicted in <a href="#broker-models" class="xref">Figure 5</a>, there are multiple ways in which a TEEP Broker
can be implemented, with more or fewer layers being inside the TEE.  For example, in
model A, the model with the smallest TEE footprint, only the TEEP implementation is inside
the TEE, whereas the TEEP/HTTP implementation is in the TEEP Broker outside the TEE.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<span id="name-teep-broker-models"></span><div id="broker-models">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-6.2-2.1">
<pre>
                        Model:    A      B      C     ...

                                 TEE    TEE    TEE
     +----------------+           |      |      |
     |      TEEP      |     Agent |      |      | Agent
     | implementation |           |      |      |
     +----------------+           v      |      |
              |                          |      |
     +----------------+           ^      |      |
     |    TEEP/HTTP   |    Broker |      |      |
     | implementation |           |      |      |
     +----------------+           |      v      |
              |                   |             |
     +----------------+           |      ^      |
     |     HTTP(S)    |           |      |      |
     | implementation |           |      |      |
     +----------------+           |      |      v
              |                   |      |
     +----------------+           |      |      ^
     |   TCP or QUIC  |           |      |      | Broker
     | implementation |           |      |      |
     +----------------+           |      |      |
                                 REE    REE    REE
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-teep-broker-models" class="selfRef">TEEP Broker Models</a>
          </figcaption></figure>
</div>
<p id="section-6.2-3">In other models, additional layers are moved into the TEE, increasing the TEE footprint,
with the Broker either containing or calling the topmost protocol layer outside of the TEE.
An implementation is free to choose any of these models.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">TEEP Broker implementers should consider methods of distribution, scope and
   concurrency on devices and runtime options.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<div id="apis">
<section id="section-6.2.1">
          <h4 id="name-teep-broker-apis">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-teep-broker-apis" class="section-name selfRef">TEEP Broker APIs</a>
          </h4>
<p id="section-6.2.1-1">The following conceptual APIs exist from a TEEP Broker to a TEEP Agent:<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2.1-2">
<li id="section-6.2.1-2.1">RequestTA: A notification from an REE application (e.g., an installer,
or an Untrusted Application) that it depends on a given Trusted Component, which may or may not
already be installed in the TEE.<a href="#section-6.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.2.1-2.2">UnrequestTA: A notification from an REE application (e.g., an installer,
or an Untrusted Application) that it no longer depends on a given
Trusted Component, which may or may not already be installed in the TEE. 
For example, if the Untrusted Application is uninstalled, the uninstaller
might invoke this conceptual API.<a href="#section-6.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-6.2.1-2.3">ProcessTeepMessage: A message arriving from the network, to be delivered
to the TEEP Agent for processing.<a href="#section-6.2.1-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-6.2.1-2.4">RequestPolicyCheck: A hint (e.g., based on a timer) that the TEEP Agent
may wish to contact the TAM for any changes, without the device itself
needing any particular change.<a href="#section-6.2.1-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-6.2.1-2.5">ProcessError: A notification that the TEEP Broker could not deliver an outbound
TEEP message to a TAM.<a href="#section-6.2.1-2.5" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-6.2.1-3">For comparison, similar APIs may exist on the TAM side, where a Broker may or may not
exist, depending on whether the TAM uses a TEE or not:<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2.1-4">
<li id="section-6.2.1-4.1">ProcessConnect: A notification that a new TEEP session is being requested by a TEEP Agent.<a href="#section-6.2.1-4.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.2.1-4.2">ProcessTeepMessage: A message arriving on an existing TEEP session, to be delivered
to the TAM for processing.<a href="#section-6.2.1-4.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-6.2.1-5">For further discussion on these APIs, see <span>[<a href="#I-D.ietf-teep-otrp-over-http" class="xref">I-D.ietf-teep-otrp-over-http</a>]</span>.<a href="#section-6.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="teep-broker-distribution">
<section id="section-6.2.2">
          <h4 id="name-teep-broker-distribution">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-teep-broker-distribution" class="section-name selfRef">TEEP Broker Distribution</a>
          </h4>
<p id="section-6.2.2-1">The Broker installation is commonly carried out at OEM time. A user
can dynamically download and install a Broker on-demand.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="attestation">
<section id="section-7">
      <h2 id="name-attestation">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-attestation" class="section-name selfRef">Attestation</a>
      </h2>
<p id="section-7-1">Attestation is the process through which one entity (an Attester) presents "evidence", in the form
of a series of claims, to another entity (a Verifier), and provides sufficient proof that the claims
are true. Different Verifiers may require different degrees of confidence in attestation proofs
and not all attestations are acceptable to every verifier.  A third entity (a Relying Party)
can then use "attestation results", in the form of another series of claims, from a Verifier
to make authorization decisions.  (See <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span> for more discussion.)<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">In TEEP, as depicted in <a href="#attestation-roles" class="xref">Figure 6</a>,
the primary purpose of an attestation is to allow a device (the Attester) to prove to a TAM
(the Relying Party) that a TEE in the device has particular properties, was built by a particular
manufacturer, and/or is executing a particular TA. Other claims are possible; TEEP
does not limit the claims that may appear in evidence or attestation results,
but defines a minimal set of attestation result claims
required for TEEP to operate properly. Extensions to these claims are possible.
Other standards or groups may define the format and semantics
of extended claims.<a href="#section-7-2" class="pilcrow">¶</a></p>
<span id="name-teep-attestation-roles"></span><div id="attestation-roles">
<figure id="figure-6">
        <div class="alignLeft art-text artwork" id="section-7-3.1">
<pre>
   +----------------+
   | Device         |            +----------+
   | +------------+ |  Evidence  |   TAM    |   Evidence    +----------+
   | |     TEE    |-------------&gt;| (Relying |--------------&gt;| Verifier |
   | | (Attester) | |            |  Party)  |&lt;--------------|          |
   | +------------+ |            +----------+  Attestation  +----------+
   +----------------+                             Result
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-teep-attestation-roles" class="selfRef">TEEP Attestation Roles</a>
        </figcaption></figure>
</div>
<p id="section-7-4">As of the writing of this specification, device and TEE attestations have not been standardized
across the market. Different devices, manufacturers, and TEEs support different attestation
protocols. In order for TEEP to be inclusive, it is agnostic to the format of evidence,
allowing proprietary or standardized formats to be used between a TEE and a verifier (which may or may not
be colocated in the TAM), as long as the format supports encryption of
any information that is considered sensitive.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">However, it should be recognized
that not all Verifiers may be able to process all proprietary forms of attestation evidence.
Similarly, the TEEP protocol is agnostic as to the format of attestation results, and the protocol
(if any) used between the TAM and a verifier, as long as they convey at least the required set of claims
in some format. Note that the respective attestation algorithms are not defined in the TEEP protocol itself; see <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span> and <span>[<a href="#I-D.ietf-teep-protocol" class="xref">I-D.ietf-teep-protocol</a>]</span> for more discussion.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">There are a number of considerations that need to be considered when appraising
evidence provided by a TEE, including:<a href="#section-7-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-7.1">What security measures a manufacturer takes when provisioning keys into devices/TEEs;<a href="#section-7-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-7.2">What hardware and software components have access to the attestation keys of the TEE;<a href="#section-7-7.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-7.3">The source or local verification of claims within an attestation prior to a TEE signing a set of claims;<a href="#section-7-7.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-7.4">The level of protection afforded to attestation keys against exfiltration, modification, and side channel attacks;<a href="#section-7-7.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-7.5">The limitations of use applied to TEE attestation keys;<a href="#section-7-7.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-7.6">The processes in place to discover or detect TEE breaches; and<a href="#section-7-7.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-7.7">The revocation and recovery process of TEE attestation keys.<a href="#section-7-7.7" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-8">Some TAMs may require additional claims in order to properly authorize a device or TEE.  The specific
format for these additional claims are outside the scope of this specification, but the TEEP protocol
allows these additional claims to be included in the attestation messages.<a href="#section-7-8" class="pilcrow">¶</a></p>
<p id="section-7-9">For more discussion of the attestation and appraisal process, see
the RATS Architecture <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span>.<a href="#section-7-9" class="pilcrow">¶</a></p>
<p id="section-7-10">The following information is required for TEEP attestation:<a href="#section-7-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-11.1">Device Identifying Information: Attestation information may need to uniquely identify a device to the TAM.
Unique device identification allows the TAM to provide services to the device, such as managing installed
TAs, and providing subscriptions to services, and locating device-specific keying material to
communicate with or authenticate the device. In some use cases it may be sufficient to identify 
only the class of the device. The security and privacy requirements regarding device identification 
will vary with the type of TA provisioned to the TEE.<a href="#section-7-11.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-11.2">TEE Identifying Information: The type of TEE that generated this attestation must be identified.
This includes version identification information for hardware, firmware, and software version of the TEE, as applicable by the
TEE type. TEE manufacturer information for the TEE is
required in order to disambiguate the same TEE type created by different manufacturers and
address considerations around manufacturer provisioning, keying and support for the TEE.<a href="#section-7-11.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-11.3">Freshness Proof: A claim that includes freshness information must be included, such as a nonce
or timestamp.<a href="#section-7-11.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="algorithm-and-attestation-agility">
<section id="section-8">
      <h2 id="name-algorithm-and-attestation-a">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-algorithm-and-attestation-a" class="section-name selfRef">Algorithm and Attestation Agility</a>
      </h2>
<p id="section-8-1">RFC 7696 <span>[<a href="#RFC7696" class="xref">RFC7696</a>]</span> outlines the requirements to migrate from one
mandatory-to-implement cryptographic algorithm suite to another over time.
This feature is also known as crypto agility. Protocol evolution
is greatly simplified when crypto agility is considered
during the design of the protocol. In the case of the TEEP
protocol the diverse range of use cases, from trusted app
updates for smart phones and tablets to updates of code on
higher-end IoT devices, creates the need for different
mandatory-to-implement algorithms already from the start.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Crypto agility in TEEP concerns the use of symmetric as well as asymmetric 
algorithms. In the context of TEEP, symmetric algorithms are used for 
encryption and integrity protection of TA binaries and Personalization Data 
whereas the asymmetric algorithms are used for signing messages and managing 
symmetric keys.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">In addition to the use of cryptographic algorithms in TEEP, there
is also the need to make use of different attestation technologies.
A device must provide techniques to inform a TAM about the
attestation technology it supports. For many deployment cases it
is more likely for the TAM to support one or more attestation
techniques whereas the device may only support one.<a href="#section-8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="broker-trust-model">
<section id="section-9.1">
        <h3 id="name-broker-trust-model">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-broker-trust-model" class="section-name selfRef">Broker Trust Model</a>
        </h3>
<p id="section-9.1-1">The architecture enables the TAM to communicate, via a TEEP Broker, with the device's TEE
to manage Trusted Components.  Since the TEEP Broker runs in a potentially vulnerable REE,
the TEEP Broker could, however, be (or be infected by) malware.
As such, all TAM messages are signed and sensitive
data is encrypted such that the TEEP Broker cannot modify or capture
sensitive data, but the TEEP Broker can still conduct DoS attacks
as discussed in <a href="#compromised-ree" class="xref">Section 9.3</a>.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">A TEEP Agent in a TEE is responsible for protecting against potential attacks
from a compromised 
TEEP Broker or rogue malware in the REE. A rogue TEEP Broker
might send corrupted data to the TEEP Agent, or launch a DoS attack by sending a flood
of TEEP protocol requests, or simply drop or delay notifications to a TEE. The TEEP Agent validates the signature of each TEEP protocol request
and checks the signing certificate against its Trust Anchors. To mitigate
DoS attacks, it might also add some protection
scheme such as a threshold on repeated requests or number of TAs that can be installed.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">Some implementations might rely on (due to lack of any available alternative) the use of 
an untrusted timer or other event to call the RequestPolicyCheck API (<a href="#apis" class="xref">Section 6.2.1</a>), which
means that a compromised REE can cause a TEE to not receive policy changes and thus be out of date
with respect to policy.  The same can potentially be done by any other man-in-the-middle
simply by blocking communication with a TAM.  Ultimately such outdated compliance
could be addressed by using attestation in secure communication, where the attestation
evidence reveals what state the TEE is in, so that communication (other than remediation
such as via TEEP) from an out-of-compliance TEE can be rejected.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">Similarly, in most implementations the REE is involved in the mechanics of installing new TAs.
However, the authority for what TAs are running in a given TEE is between the TEEP Agent and the TAM.
While a TEEP Broker broker can in effect make suggestions, it cannot decide or enforce what runs where.
The TEEP Broker can also control which TEE a given installation request is directed at, but a TEEP
Agent will only accept TAs that are actually applicable to it and where installation instructions
are received by a TAM that it trusts.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1-5">The authorization model for the UnrequestTA operation is, however, weaker in that it
expresses the removal of a dependency from an application that was untrusted to begin with.
This means that a compromised REE could remove a valid dependency from an Untrusted Application
on a TA.  Normal REE security mechanisms should be used to protect the REE and Untrusted Applications.<a href="#section-9.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="data-protection">
<section id="section-9.2">
        <h3 id="name-data-protection">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-data-protection" class="section-name selfRef">Data Protection</a>
        </h3>
<p id="section-9.2-1">It is the responsibility of the TAM to protect data on its servers.
Similarly, it is the responsibility of the TEE implementation to provide protection of
data against integrity and confidentiality attacks from outside the TEE.
TEEs that provide isolation among TAs within the TEE are likewise
responsible for protecting TA data against the REE and other TAs.
For example, this can be used to protect one user's or tenant's data
from compromise by another user or tenant, even if the attacker has TAs.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">The protocol between TEEP Agents and TAMs similarly is responsible for
securely providing integrity and confidentiality protection against
adversaries between them. It is a design choice at what layers to best 
provide protection against network adversaries. As discussed in <a href="#broker" class="xref">Section 6</a>, 
the transport protocol and any security mechanism associated with it (e.g., the Transport Layer Security protocol) under 
the TEEP protocol may terminate outside a TEE. If it does, the TEEP protocol 
itself must provide integrity protection and confidentiality protection to 
secure data end-to-end. For example, confidentiality protection for 
payloads may be provided by utilizing encrypted TA binaries and encrypted
attestation information. See <span>[<a href="#I-D.ietf-teep-protocol" class="xref">I-D.ietf-teep-protocol</a>]</span> for how a specific 
solution addresses the design question of how to provide integrity and 
confidentiality protection.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compromised-ree">
<section id="section-9.3">
        <h3 id="name-compromised-ree">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-compromised-ree" class="section-name selfRef">Compromised REE</a>
        </h3>
<p id="section-9.3-1">It is possible that the REE of a device is compromised. 
We have already seen examples of attacks on the public Internet with billions
of compromised devices being used to mount DDoS attacks.  A compromised
REE can be used for such an attack but it cannot tamper with the TEE's
code or data in doing so.  A compromised REE can, however, launch DoS attacks
against the TEE.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">The compromised REE
may terminate the TEEP Broker such that TEEP transactions cannot reach the TEE,
or might drop or delay messages between a TAM and a TEEP Agent.
However, while a DoS attack cannot be prevented, the REE cannot access
anything in the TEE if the TEE is implemented correctly.
Some TEEs may have some watchdog scheme to observe REE state and mitigate DoS
attacks against it but most TEEs don't have such a capability.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<p id="section-9.3-3">In some other scenarios, the compromised REE may ask a TEEP Broker
to make repeated requests to a TEEP Agent in a TEE to install or
uninstall a Trusted Component.  An installation or uninstallation request constructed
by the TEEP Broker or REE will be rejected by the TEEP Agent because
the request won't have the correct signature from a TAM to pass the request
signature validation.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
<p id="section-9.3-4">This can become a DoS attack by exhausting resources in a TEE with
repeated requests. In general, a DoS attack threat exists when the REE
is compromised, and a DoS attack can happen to other resources. The TEEP
architecture doesn't change this.<a href="#section-9.3-4" class="pilcrow">¶</a></p>
<p id="section-9.3-5">A compromised REE might also request initiating the full flow of
installation of Trusted Components that are not necessary.
It may also repeat a prior legitimate Trusted Component installation
request. A TEEP Agent implementation is responsible for ensuring that it
can recognize and decline such repeated requests. It is also responsible
for protecting the resource usage allocated for Trusted Component management.<a href="#section-9.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ca-compromise-or-expiry-of-ca-certificate">
<section id="section-9.4">
        <h3 id="name-ca-compromise-or-expiry-of-">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-ca-compromise-or-expiry-of-" class="section-name selfRef">CA Compromise or Expiry of CA Certificate</a>
        </h3>
<p id="section-9.4-1">A root CA for TAM certificates might get compromised or its certificate might
expire, or a Trust Anchor other than a root CA certificate may also expire or
be compromised.
TEEs are responsible for validating the entire TAM certificate path,
including the TAM certificate and any intermediate certificates up to
the root certificate.  See Section 6 of <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> for details.
Such validation generally includes checking for certificate
revocation, but certificate status check protocols may
not scale down to constrained devices that use TEEP.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">To address the above issues, a certificate path update mechanism
is expected from TAM operators, so that the TAM can get
a new certificate path that can be validated by a TEEP Agent.
In addition, the Trust Anchor in the TEEP Agent's Trust Anchor Store
may need to be updated.  To address this, some TEE Trust Anchor update 
mechanism is expected from device OEMs, such as using the TEEP protocol
to distribute new Trust Anchors.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4-3">Similarly, 
a root CA for TEE certificates might get compromised or its certificate might
expire, or a Trust Anchor other than a root CA certificate may also expire or
be compromised.
TAMs are responsible for validating the entire TEE certificate path,
including the TEE certificate and any intermediate certificates up to
the root certificate.  Such validation includes checking for certificate
revocation.<a href="#section-9.4-3" class="pilcrow">¶</a></p>
<p id="section-9.4-4">If a TEE certificate path validation fails, the TEE
might be rejected by a TAM, subject to the TAM's policy.
To address this, some certificate path update mechanism
is expected from device OEMs, so that the TEE can get
a new certificate path that can be validated by a TAM.
In addition, the Trust Anchor in the TAM's Trust Anchor Store
may need to be updated.<a href="#section-9.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compromised-tam">
<section id="section-9.5">
        <h3 id="name-compromised-tam">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-compromised-tam" class="section-name selfRef">Compromised TAM</a>
        </h3>
<p id="section-9.5-1">Device TEEs are responsible for validating the supplied TAM certificates
to determine that the TAM is trustworthy.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="malicious-ta-removal">
<section id="section-9.6">
        <h3 id="name-malicious-ta-removal">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-malicious-ta-removal" class="section-name selfRef">Malicious TA Removal</a>
        </h3>
<p id="section-9.6-1">It is possible that a rogue developer distributes a malicious Untrusted 
Application and intends to get a malicious TA installed. Such a TA
might be able to escape from malware detection by the REE, or access trusted
resources within the TEE (but could not access other TEEs, or access other
TA's if the TEE provides isolation between TAs).<a href="#section-9.6-1" class="pilcrow">¶</a></p>
<p id="section-9.6-2">It is the responsibility
of the TAM to not install malicious TAs in the first place. The TEEP
architecture allows a TEEP Agent to decide which TAMs it trusts via Trust Anchors, 
and delegates the TA authenticity check to the TAMs it trusts.<a href="#section-9.6-2" class="pilcrow">¶</a></p>
<p id="section-9.6-3">It may happen that a TA was previously considered trustworthy but is later
found to be buggy or compromised.
In this case, the TAM can initiate the removal of the TA by notifying devices 
to remove the TA (and potentially the REE or Device Owner to remove any Untrusted 
Application that depend on the TA).  If the TAM does not currently have a
connection to the TEEP Agent on a device, such a notification would occur
the next time connectivity does exist.  That is, to recover, the TEEP Agent
must be able to reach out to the TAM, for example whenever the 
RequestPolicyCheck API (<a href="#apis" class="xref">Section 6.2.1</a>) is invoked by a timer or other event.<a href="#section-9.6-3" class="pilcrow">¶</a></p>
<p id="section-9.6-4">Furthermore the policy in the Verifier in an attestation process can be
updated so that any evidence that includes the malicious TA would result
in an attestation failure.  There is, however, a time window during which
a malicious TA might be able to operate successfully, which is the
validity time of the previous attestation result.  For example, if
the Verifier in <a href="#attestation-roles" class="xref">Figure 6</a> is updated to treat a previously
valid TA as no longer trustworthy, any attestation result it previously
generated saying that the TA is valid will continue to be used until
the attestation result expires.  As such, the TAM's Verifier should
take into account the acceptable time window when generating attestation
results. See <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span> for further discussion.<a href="#section-9.6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certificate-expiry-and-renewal">
<section id="section-9.7">
        <h3 id="name-certificate-expiry-and-rene">
<a href="#section-9.7" class="section-number selfRef">9.7. </a><a href="#name-certificate-expiry-and-rene" class="section-name selfRef">Certificate Expiry and Renewal</a>
        </h3>
<p id="section-9.7-1">TEE device certificates are expected to be long lived, longer
than the lifetime of a device.  A TAM certificate usually has a
moderate lifetime of 2 to 5 years.  A TAM should get renewed or
rekeyed certificates.  The root CA certificates for a TAM, which are
embedded into the Trust Anchor Store in a device, should have long
lifetimes that don't require device Trust Anchor updates.  On the
other hand, it is imperative that OEMs or device providers plan for
support of Trust Anchor update in their shipped devices.<a href="#section-9.7-1" class="pilcrow">¶</a></p>
<p id="section-9.7-2">For those cases where TEE devices are given certificates for which no good
expiration date can be assigned the recommendations in Section 4.1.2.5 of 
<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> are applicable.<a href="#section-9.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="keeping-secrets-from-the-tam">
<section id="section-9.8">
        <h3 id="name-keeping-secrets-from-the-ta">
<a href="#section-9.8" class="section-number selfRef">9.8. </a><a href="#name-keeping-secrets-from-the-ta" class="section-name selfRef">Keeping Secrets from the TAM</a>
        </h3>
<p id="section-9.8-1">In some scenarios, it is desirable to protect the TA binary or Personalization Data
from being disclosed to the TAM that distributes them.  In such a scenario,
the files can be encrypted end-to-end between a Trusted Component Signer and a TEE.  However, there
must be some means of provisioning the decryption key into the TEE and/or some
means of the Trusted Component Signer securely learning a public key of the TEE that it can use to
encrypt. The Trusted Component Signer cannot necessarily even trust the
TAM to report the correct public key of a TEE for use with encryption, since the TAM might instead
provide the public key of a TEE that it controls.<a href="#section-9.8-1" class="pilcrow">¶</a></p>
<p id="section-9.8-2">One way to solve this is for the Trusted Component Signer to run its own TAM that is only used to
distribute the decryption key via the TEEP protocol, and the key file can be a
dependency in the manifest of the encrypted TA.  Thus, the TEEP Agent would
look at the Trusted Component manifest, determine there is a dependency with a TAM URI of the
Trusted Component Signer's TAM. The Agent would then install the dependency, and then continue with
the Trusted Component installation steps, including decrypting the TA binary with the relevant key.<a href="#section-9.8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ree-privacy">
<section id="section-9.9">
        <h3 id="name-ree-privacy">
<a href="#section-9.9" class="section-number selfRef">9.9. </a><a href="#name-ree-privacy" class="section-name selfRef">REE Privacy</a>
        </h3>
<p id="section-9.9-1">The TEEP architecture is applicable to cases where devices have a TEE that protects data
and code from the REE administrator.  In such cases, the TAM administrator, not the REE administrator,
controls the TEE in the devices.  As some examples:<a href="#section-9.9-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.9-2.1">a cloud hoster may be the REE administrator where a customer administrator controls the TEE hosted in the cloud.<a href="#section-9.9-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.9-2.2">a device manufacturer might control the TEE in a device purchased by a customer<a href="#section-9.9-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-9.9-3">The privacy risk is that data in the REE might be susceptible to disclosure to the TEE administrator.
This risk is not introduced by the TEEP architecture, but is inherent in most uses of TEEs.
This risk can be mitigated by making sure the REE administrator is aware of and explicitly chooses
to have a TEE that is managed by another party.  In the cloud hoster example, this choice is made
by explicitly offering a service to customers to provide TEEs for them to administer.  In the device
manufacturer example, this choice is made by the customer choosing to buy a device made by a given
manufacturer.<a href="#section-9.9-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document does not require actions by IANA.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="section-11">
      <h2 id="name-contributors">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-11-1.1">Andrew Atyeo, Intercede (andrew.atyeo@intercede.com)<a href="#section-11-1.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-11-1.2">Liu Dapeng, Alibaba Group (maxpassion@gmail.com)<a href="#section-11-1.2" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="acknowledgements">
<section id="section-12">
      <h2 id="name-acknowledgements">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-12-1">We would like to thank Nick Cook, Minho Yoo, Brian Witten, Tyler Kim, Alin Mutu, Juergen Schoenwaelder, Nicolae Paladi, Sorin Faibish, Ned Smith, Russ Housley, Jeremy O'Donoghue, and Anders Rundgren for their feedback.<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-13">
      <h2 id="name-informative-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="CC-Overview">[CC-Overview]</dt>
      <dd>
<span class="refAuthor">Confidential Computing Consortium</span>, <span class="refTitle">"Confidential Computing: Hardware-Based Trusted Execution for Applications and Data"</span>, <time datetime="2021-01" class="refDate">January 2021</time>, <span>&lt;<a href="https://confidentialcomputing.io/wp-content/uploads/sites/85/2021/03/confidentialcomputing_outreach_whitepaper-8-5x11-1.pdf">https://confidentialcomputing.io/wp-content/uploads/sites/85/2021/03/confidentialcomputing_outreach_whitepaper-8-5x11-1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CC-Technical-Analysis">[CC-Technical-Analysis]</dt>
      <dd>
<span class="refAuthor">Confidential Computing Consortium</span>, <span class="refTitle">"A Technical Analysis of Confidential Computing, v1.2"</span>, <time datetime="2021-10" class="refDate">October 2021</time>, <span>&lt;<a href="https://confidentialcomputing.io/wp-content/uploads/sites/85/2022/01/CCC-A-Technical-Analysis-of-Confidential-Computing-v1.2.pdf">https://confidentialcomputing.io/wp-content/uploads/sites/85/2022/01/CCC-A-Technical-Analysis-of-Confidential-Computing-v1.2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GPTEE">[GPTEE]</dt>
      <dd>
<span class="refAuthor">GlobalPlatform</span>, <span class="refTitle">"GlobalPlatform Device Technology: TEE System Architecture, v1.1"</span>, <span class="seriesInfo">GlobalPlatform GPD_SPE_009</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://globalplatform.org/specs-library/tee-system-architecture-v1-1/">https://globalplatform.org/specs-library/tee-system-architecture-v1-1/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GSMA">[GSMA]</dt>
      <dd>
<span class="refAuthor">GSM Association</span>, <span class="refTitle">"GP.22 RSP Technical Specification, Version 2.2.2"</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.gsma.com/esim/wp-content/uploads/2020/06/SGP.22-v2.2.2.pdf">https://www.gsma.com/esim/wp-content/uploads/2020/06/SGP.22-v2.2.2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-architecture">[I-D.ietf-rats-architecture]</dt>
      <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote Attestation Procedures Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-architecture-15</span>, <time datetime="2022-02-08" class="refDate">8 February 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-rats-architecture-15.txt">https://www.ietf.org/archive/id/draft-ietf-rats-architecture-15.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-suit-architecture">[I-D.ietf-suit-architecture]</dt>
      <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Brown, D.</span>, and <span class="refAuthor">M. Meriac</span>, <span class="refTitle">"A Firmware Update Architecture for Internet of Things"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-suit-architecture-16</span>, <time datetime="2021-01-27" class="refDate">27 January 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-suit-architecture-16.txt">https://www.ietf.org/archive/id/draft-ietf-suit-architecture-16.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-suit-manifest">[I-D.ietf-suit-manifest]</dt>
      <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Birkholz, H.</span>, and <span class="refAuthor">K. Zandberg</span>, <span class="refTitle">"A Concise Binary Object Representation (CBOR)-based Serialization Format for the Software Updates for Internet of Things (SUIT) Manifest"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-suit-manifest-16</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-suit-manifest-16.txt">https://www.ietf.org/archive/id/draft-ietf-suit-manifest-16.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-teep-otrp-over-http">[I-D.ietf-teep-otrp-over-http]</dt>
      <dd>
<span class="refAuthor">Thaler, D.</span>, <span class="refTitle">"HTTP Transport for Trusted Execution Environment Provisioning: Agent Initiated Communication"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-teep-otrp-over-http-13</span>, <time datetime="2022-02-28" class="refDate">28 February 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-teep-otrp-over-http-13.txt">https://www.ietf.org/archive/id/draft-ietf-teep-otrp-over-http-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-teep-protocol">[I-D.ietf-teep-protocol]</dt>
      <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Pei, M.</span>, <span class="refAuthor">Wheeler, D.</span>, <span class="refAuthor">Thaler, D.</span>, and <span class="refAuthor">A. Tsukamoto</span>, <span class="refTitle">"Trusted Execution Environment Provisioning (TEEP) Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-teep-protocol-07</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-teep-protocol-07.txt">https://www.ietf.org/archive/id/draft-ietf-teep-protocol-07.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OTRP">[OTRP]</dt>
      <dd>
<span class="refAuthor">GlobalPlatform</span>, <span class="refTitle">"Open Trust Protocol (OTrP) Profile v1.1"</span>, <span class="seriesInfo">GlobalPlatform GPD_SPE_123</span>, <time datetime="2020-07" class="refDate">July 2020</time>, <span>&lt;<a href="https://globalplatform.org/specs-library/tee-management-framework-open-trust-protocol/">https://globalplatform.org/specs-library/tee-management-framework-open-trust-protocol/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
      <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4949">https://www.rfc-editor.org/info/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
      <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6024">[RFC6024]</dt>
      <dd>
<span class="refAuthor">Reddy, R.</span> and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"Trust Anchor Management Requirements"</span>, <span class="seriesInfo">RFC 6024</span>, <span class="seriesInfo">DOI 10.17487/RFC6024</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6024">https://www.rfc-editor.org/info/rfc6024</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7696">[RFC7696]</dt>
      <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Guidelines for Cryptographic Algorithm Agility and Selecting Mandatory-to-Implement Algorithms"</span>, <span class="seriesInfo">BCP 201</span>, <span class="seriesInfo">RFC 7696</span>, <span class="seriesInfo">DOI 10.17487/RFC7696</span>, <time datetime="2015-11" class="refDate">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7696">https://www.rfc-editor.org/info/rfc7696</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SGX">[SGX]</dt>
      <dd>
<span class="refAuthor">Intel</span>, <span class="refTitle">"Intel(R) Software Guard Extensions (Intel (R) SGX)"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.intel.com/content/www/us/en/architecture-and-technology/software-guard-extensions.html">https://www.intel.com/content/www/us/en/architecture-and-technology/software-guard-extensions.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TrustZone">[TrustZone]</dt>
    <dd>
<span class="refAuthor">Arm</span>, <span class="refTitle">"Arm TrustZone Technology"</span>, <span>n.d.</span>, <span>&lt;<a href="https://developer.arm.com/ip-products/security-ip/trustzone">https://developer.arm.com/ip-products/security-ip/trustzone</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mingliang Pei</span></div>
<div dir="auto" class="left"><span class="org">Broadcom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mingliang.pei@broadcom.com" class="email">mingliang.pei@broadcom.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@arm.com" class="email">hannes.tschofenig@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dave Thaler</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dthaler@microsoft.com" class="email">dthaler@microsoft.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Wheeler</span></div>
<div dir="auto" class="left"><span class="org">Amazon</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:davewhee@amazon.com" class="email">davewhee@amazon.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
