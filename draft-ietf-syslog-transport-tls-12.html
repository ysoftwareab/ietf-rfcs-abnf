<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>TLS Transport Mapping for Syslog</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="TLS Transport Mapping for Syslog">
<meta name="keywords" content="RFC, Request for Comments, Syslog TLS Transport Security, Internet-Draft, XML, Extensible Markup Language">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Syslog Working Group</td><td class="header">F. Miao, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Y. Ma, Ed.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Huawei Technologies</td></tr>
<tr><td class="header">Expires: November 8, 2008</td><td class="header">J. Salowey, Ed.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">May 07, 2008</td></tr>
</table></td></tr></table>
<h1><br />TLS Transport Mapping for Syslog<br />draft-ietf-syslog-transport-tls-12.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on November 8, 2008.</p>

<h3>Abstract</h3>

<p>This document describes the use of Transport Layer Security (TLS) to
      provide a secure connection for the transport of syslog messages. This
      document describes the security threats to syslog and how TLS can be
      used to counter such threats.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Terminology<br />
<a href="#reqs">2.</a>&nbsp;
Security Requirements for Syslog<br />
<a href="#anchor3">3.</a>&nbsp;
TLS to Secure Syslog<br />
<a href="#anchor4">4.</a>&nbsp;
Protocol Elements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
Port Assignment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
Initiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#serverauth">4.2.1.</a>&nbsp;
Server Authentication and Basic Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#clientauth">4.2.2.</a>&nbsp;
Client Authentication and Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certfinger">4.2.3.</a>&nbsp;
Certificate Fingerprints<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.2.4.</a>&nbsp;
Cryptographic Level<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.3.</a>&nbsp;
Sending data<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.3.1.</a>&nbsp;
Message Length<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.4.</a>&nbsp;
Closure<br />
<a href="#anchor11">5.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.1.</a>&nbsp;
Authentication and Certificates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.2.</a>&nbsp;
Cipher Suites<br />
<a href="#anchor14">6.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">6.1.</a>&nbsp;
Port Number<br />
<a href="#anchor16">7.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document describes the use of Transport Layer Security (<a class='info' href='#I-D.ietf-tls-rfc4346-bis'>TLS<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; March&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;tls&#8209;rfc4346&#8209;bis]) to provide a secure connection for the
      transport of <a class='info' href='#I-D.ietf-syslog-protocol'>syslog<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;syslog&#8209;protocol]
      messages. This document describes the security threats to syslog and how
      TLS can be used to counter such threats.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>The following definitions are used in this document: </p>
<ul class="text">
<li>An "originator" generates syslog content to be carried in a
            message.
</li>
<li>A "collector" gathers syslog content for further analysis.
</li>
<li>A "relay" forwards messages, accepting messages from
            originators or other relays, and sending them to collectors or
            other relays.
</li>
<li>A "transport sender" passes syslog messages to a specific
            transport protocol.
</li>
<li>A "transport receiver" takes syslog messages from a specific
            transport protocol.
</li>
<li>A "TLS client" is an application that can initiate a TLS
            connection by sending a Client Hello to a peer.
</li>
<li>A "TLS server" is an application that can receive a Client
            Hello from a peer and reply with a Server Hello.
</li>
</ul>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="reqs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Security Requirements for Syslog</h3>

<p>syslog messages may transit several hops to arrive at the intended
      collector. Some intermediary networks may not be trusted by the
      originator, relay, or receiver because the network is in a
      different security domain or at a different security level from the
      originator, relay, or collector. Another security concern is that the
      originator, relay, or receiver itself is in an insecure network.
</p>
<p>There are several threats to be addressed for syslog security. The
      primary threats are: </p>
<ul class="text">
<li>Masquerade. An unauthorized transport sender may send messages to
          a legitimate transport receiver, or an unauthorized transport
          receiver tries to deceive a legitimate transport sender into sending
          syslog messages to it.
</li>
<li>Modification. An attacker between the transport sender and the
          transport receiver may modify an in-transit syslog message and then
          forward the message to the transport receiver. Such modification may
          make the transport receiver misunderstand the message or cause it to
          behave in undesirable ways.
</li>
<li>Disclosure. An unauthorized entity may examine the contents of
          the syslog messages, gaining unauthorized access to the information.
          Some data in syslog messages is sensitive and may be useful to an
          attacker, such as the password of an authorized administrator or
          user.
</li>
</ul>

<p>The secondary threat is: </p>
<ul class="text">
<li>Message stream modification. An attacker may delete one or more
          syslog message from a series of messages, replay a message, or alter
          the delivery sequence. The syslog protocol itself is not based on
          message order, but an event in a syslog message may relate
          semantically to events in other messages, so message ordering may be
          important to understanding a sequence of events.
</li>
</ul>

<p>The following threats are deemed to be of lesser importance for
      syslog, and are not addressed in this document: </p>
<ul class="text">
<li>Denial of Service
</li>
<li>Traffic Analysis
</li>
</ul>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
TLS to Secure Syslog</h3>

<p>TLS can be used as a secure transport to counter all the primary
      threats to syslog described in section 2: </p>
<ul class="text">
<li>Confidentiality to counter disclosure of the message
          contents;
</li>
<li>Integrity checking to counter modifications to a message on a
          hop-by-hop basis;
</li>
<li>Server or mutual authentication to counter masquerade.
</li>
</ul><p>Note: This secure transport (i.e. TLS) only secures syslog in a
      hop-by-hop manner, the threat of end-to-end message stream modification
      is not addressed in this document.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protocol Elements</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Port Assignment</h3>

<p>A syslog transport sender is always a TLS client and a transport
        receiver is always a TLS server.
</p>
<p>The TCP port NNN has been allocated as the default port for syslog
        over TLS, as defined in this document.
</p>
<p>Note to RFC Editor: please replace NNN with the IANA-assigned
        value, and remove this note.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Initiation</h3>

<p>The transport sender should initiate a connection to the transport
        receiver and then send the TLS Client Hello to begin the TLS
        handshake. When the TLS handshake has finished the transport sender
        MAY then send the first syslog message.
</p>
<p>TLS typically uses <a class='info' href='#I-D.ietf-pkix-rfc3280bis'>certificates<span> (</span><span class='info'>Cooper, D., &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate  Revocation List (CRL) Profile,&rdquo; February&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;pkix&#8209;rfc3280bis] to authenticate
        peers. Authentication and authorization of the TLS server
   (transport receiver) is described in <a class='info' href='#serverauth'>Section&nbsp;4.2.1<span> (</span><span class='info'>Server Authentication and Basic Authorization</span><span>)</span></a>; authentication
   and authorization of the TLS client (transport sender) is described
   in <a class='info' href='#clientauth'>Section&nbsp;4.2.2<span> (</span><span class='info'>Client Authentication and Authorization</span><span>)</span></a>.
</p>
<a name="serverauth"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Server Authentication and Basic Authorization</h3>

<p>[Editor's Note: Text referencing RFC2818 was removed, it is not clear that it is all the relevant to SYSLOG.] 
</p>
<p>[Editor's Note: Option for certificate fingerprint added]
</p>
<p>The transport sender (TLS client) has three different options for
   authenticating and authorizing the transport receiver (TLS server).
</p>
<ul class="text">
<li>Certification path validation and subject name verification: the  
      client is configured with one or more trust anchors, and for 
      each transport receiver, the name to be matched against the  
      certificate for authorization. This option MUST be supported.
</li>
<li>Certificate fingerprints: For each transport receiver, the client 
      is configured with a fingerprint of the server's certificate
      (which can be self-signed). This option MUST be supported.
</li>
<li>No server authentication/authorization: The client is configured 
      to accept any certificate from the server. This option
      MAY be supported, but MUST NOT be enabled by default.
</li>
</ul>
<p>For certification path validation, client implementations MUST
   provide a mechanism for configuring one or more trust anchors, and
   MUST perform certification path validation as specified in
   <a class='info' href='#I-D.ietf-pkix-rfc3280bis'>[I&#8209;D.ietf&#8209;pkix&#8209;rfc3280bis]<span> (</span><span class='info'>Cooper, D., &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate  Revocation List (CRL) Profile,&rdquo; February&nbsp;2008.</span><span>)</span></a>. 
</p>
<p>For subject name verification, client implementations MUST support
   configuring, for each transport receiver, the name to be matched
   against the certificate.  This name may be the host name or IP
   address used when opening the TCP connection.  Implementations 
   MUST support checking the hostname against a SubjectAltName field 
   with a type of dNSName and SHOULD support checking hostname against 
   the Common Name portion of the Subject Distinguished Name.  Matching 
   for certificate credentials is performed using the matching rules 
   specified by <a class='info' href='#I-D.ietf-pkix-rfc3280bis'>[I&#8209;D.ietf&#8209;pkix&#8209;rfc3280bis]<span> (</span><span class='info'>Cooper, D., &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate  Revocation List (CRL) Profile,&rdquo; February&nbsp;2008.</span><span>)</span></a>.  
   If more than one identity of a given type is presented in the certificate 
   (e.g., more than one dNSName name), a match in any one of the 
   set is considered acceptable.  Implementations MAY support 
   other authorization processes matching against other fields in a 
   certificate.  Implementations also MAY support wildcards to match 
   a range of values.  For example, names to be matched against a 
   certificate may contain the wildcard character * which is 
   considered to match any single domain name component or 
   component fragment. E.g., *.a.com matches foo.a.com but not
   bar.foo.a.com. f*.com matches foo.com but not bar.com. 
</p>
<p>[Editor's Note: How useful is it to match against IP address?  Do we expect deployments to issue certificates with IP addresses in them? Are IP addresses typically used in configuration? ]
</p>
<p>To support certificate fingerprints, client implementations MUST
   support configuring, for each transport receiver, a fingerprint of
   the server certificate. See <a class='info' href='#certfinger'>Section&nbsp;4.2.3<span> (</span><span class='info'>Certificate Fingerprints</span><span>)</span></a> for details.
</p>
<p>If the certificate fails authorization or validity checks,
          clients SHOULD log the error in some form or another (see next
          paragraph), and SHOULD terminate the connection with a bad
          certificate error.
</p>
<p>The application developer must take some care to consider the
          case when, for whatever reason, there is a problem with
          authenticating the other end of the connection. Since this problem
          will prevent log messages from being transmitted, each device having
          this problem should use whatever means are available to inform the
          administrator of the problem. This may include producing an error
          code on a console, returning an error to a user (if there is one),
          or writing a file to disk, being mindful that such writes should be
          rate limited in the case of attacks.
</p>
<a name="clientauth"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Client Authentication and Authorization</h3>

<p>The transport receiver (TLS server) has three different options for
   authenticating and authorizing the transport sender (TLS client).
</p>
<p>[Editor's note: At least one one authorization mechanism should be mandatory to implement to protect against the threat of masquerade listed above.]
</p>
<ul class="text">
<li>Certification path validation and subject name verification:
      the server is configured with one or more trust anchors,
      and a set of names (or wildcard patterns) to be matched 
      against the certificates.  This option MUST be supported.
</li>
<li>Certificate fingerprints: The server is configured with the 
      fingerprints of client certificates. This option MUST be
      supported.
</li>
<li>No client authentication or authorization (or authorization
      based only on connection source IP address): This option MAY 
      be supported, but MUST NOT be enabled by default.
</li>
</ul>
<p>Certification path validation and subject name verification work
   as described in Section <a class='info' href='#clientauth'>Section&nbsp;4.2.2<span> (</span><span class='info'>Client Authentication and Authorization</span><span>)</span></a> above.  A server may allow wild card names to match against the certificate which will result in a large number of clients with valid certificates to be authorized. Servers SHOULD provide a mechanism to log the identity and issuer of an accepted certificate to enable messages received from the client to be associated with an authenticated entity. 
</p>
<p> To support certificate fingerprints, server implementations MUST
   support configuring with a list of fingerprints of authorized
   certificates. See Section <a class='info' href='#certfinger'>Section&nbsp;4.2.3<span> (</span><span class='info'>Certificate Fingerprints</span><span>)</span></a> for details.
</p>
<p>[Editor's note: Removed section on using the same name for more that one host as it seems implementation specific. Removed section on discussion on who issues the certificate since it is out of scope.] 
</p>
<a name="certfinger"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Certificate Fingerprints</h3>

<p> Both client and server implementations MUST make the certificate
   fingerprint available through a management interface. If no other
   certificate is configured, both client and server implementations
   MUST support generating a key pair and self-signed certificate.
</p>
<p>The RECOMMENDED mechanism to generate a fingerprint is to take the SHA-1 hash of the certificate and convert the 20 byte result into 20 colon separated, hexadecimal bytes, each represented by 2 uppercase ASCII characters.  When a fingerprint value is displayed or configured the algorithm used to generate the fingerprint SHOULD be indicated.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
Cryptographic Level</h3>

<p>Syslog applications SHOULD be implemented in a manner that
          permits administrators, as a matter of local policy, to select the
          cryptographic level and authentication options they desire.
</p>
<p>TLS permits the resumption of an earlier TLS session or the use
          of another active session when a new session is requested, in order
          to save the expense of another full TLS handshake. The security
          parameters of the resumed session are reused for the requested
          session. The security parameters SHOULD be checked against the
          security requirement of the requested session to make sure that the
          resumed session provides proper security.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Sending data</h3>

<p>All syslog messages MUST be sent as TLS "application data". It is
        possible that multiple syslog messages be contained in one TLS record,
        or that a syslog message be transferred in multiple TLS records. The
        application data is defined with the following <a class='info' href='#RFC5234'>ABNF<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5234] expression:
</p>
<p>APPLICATION-DATA = 1*SYSLOG-FRAME
</p>
<p>SYSLOG-FRAME = MSG-LEN SP SYSLOG-MSG
</p>
<p>MSG-LEN = NONZERO-DIGIT *DIGIT
</p>
<p>SP = %d32
</p>
<p>NONZERO-DIGIT = %d49-57
</p>
<p>DIGIT = %d48 / NONZERO-DIGIT
</p>
<p>SYSLOG-MSG is defined in <a class='info' href='#I-D.ietf-syslog-protocol'>syslog<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;syslog&#8209;protocol] protocol.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Message Length</h3>

<p>The message length is the octet count of the SYSLOG-MSG in the
          SYSLOG-FRAME. A transport receiver MUST use the message length to
          delimit a syslog message. There is no upper limit for a message
          length per se. However, in order to establish a baseline for
          interoperability, this specification requires that a transport
          receiver MUST be able to process messages with a length up to and
          including 2048 octets. Transport receiver SHOULD be able to process
          messages with lengths up to and including 8192 octets.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Closure</h3>

<p>A TLS client MUST close the associated TLS connection if the
        connection is not expected to deliver any syslog messages later. It
        MUST send a TLS close_notify alert before closing the connection. A
        client MAY choose to not wait for the server's close_notify alert and
        simply close the connection, thus generating an incomplete close on
        the server side. Once the server gets a close_notify from the client,
        it MUST reply with a close_notify unless it becomes aware that the
        connection has already been closed by the client (e.g., the closure
        was indicated by TCP).
</p>
<p>When no data is received from a connection for a long time (where
        the application decides what "long" means), a server MAY close the
        connection. The server MUST attempt to initiate an exchange of
        close_notify alerts with the client before closing the connection.
        Servers that are unprepared to receive any more data MAY close the
        connection after sending the close_notify alert, thus generating an
        incomplete close on the client side. When the client has received the
        close_notify alert from the server and still has pending data to send,
        it SHOULD send the pending data before sending the close_notify
        alert.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Authentication and Certificates</h3>

<p>In security sensitive environments, it is recommended that mutual
        authentication be deployed as that will prevent masquerade attacks,
        modification of the messages, and disclosure of the contents of the
        messages. Mutual authentication means the TLS client and server are
        provisioned with necessary trust anchors and must perform certificate
        validation.
</p>
<p>[Editor's Note: added text on self-signed certificate validation and removed text on caching.]
</p>
<p> The use of self-signed certificates with certificate 
        fingerprint authorization lists provides more protection 
        from masquerade and man-in-the-middle attacks than forgoing 
        certificate validation and authorization. 
</p>
<p>[Editor's Note: It may be useful to suggest some operational practice that facilitates the deployment of self-signed certificates.  For example, in order to initially populate an authorization list a client or server can display a certificate finger-print through a user interface to an administrator to be authorized and added to the authorization list.]
</p>
<p>If the client or server choose to forgo certificate validation then the threats listed in <a class='info' href='#reqs'>Section&nbsp;2<span> (</span><span class='info'>Security Requirements for Syslog</span><span>)</span></a> may not be appropriately mitigated.  Malicious entities may masquerade as the client or server, or they may insert themselves as a man-in-the middle of the conversation.  This may result in modification and disclosure of data.  While this may be acceptable in a security insensitive environment, it is recommended that server and client are configured with certificates and validate received certificate against provisioned trust anchors and authorization lists.  
</p>
<p>TLS authentication and the distribution of keys is based on
        certificates and asymmetric cryptography. This makes TLS transport
        more expensive than non-TLS plain transport. An attacker may
        initialize many TLS connections to a receiver as a denial of service
        attack. Since a receiver may act upon received data, for syslog over
        TLS, it is recommended that the server authenticate the client to
        ensure that information received is authentic.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Cipher Suites</h3>

<p>This specification specifies the following cipher suite required
        for all compliant implementation for minimum interoperability
        purposes:
</p>
<p>TLS_RSA_WITH_AES_128_CBC_SHA
</p>
<p>Operators MAY choose to disable cipher suites for TLS that are
        regarded as too weak for the environment in which this specification
        is being used, especially older cipher suites. This MAY lead to a
        reduction of interoperability. It is likely that, in time, the cipher
        suite specified here will become subject to attack and the use of it
        will too be deprecated. This allows the future update of the
        specification to change mandatory-to-implement cipher requirement for
        interoperability. This also allows the TLS community to change its
        recommendations, and operators to follow those recommendations.
</p>
<p>The implementers and deployers should be aware of the strengths of
        the public keys algorithm in the suite for exchanging symmetric keys,
        which is elaborated in <a class='info' href='#RFC3766'>BCP86<span> (</span><span class='info'>Orman, H. and P. Hoffman, &ldquo;Determining Strengths For Public Keys Used For Exchanging Symmetric Keys,&rdquo; April&nbsp;2004.</span><span>)</span></a> [RFC3766]. The
        implementers and deployers should also be aware of the latest TLS and
        other IETF cryptography standards including BCP86.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Port Number</h3>

<p>IANA is requested to assign a TCP port number in the range 1..1023
        in the http://www.iana.org/assignments/port-numbers registry which
        will be the default port for syslog over TLS, as defined in this
        document.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgments</h3>

<p>Authors appreciate Eric Rescorla, Rainer Gerhards, Tom Petch, Anton
      Okmianski, Balazs Scheidler, Bert Wijnen, and Chris Lonvick for their
      effort on issues resolving discussion. Authors would also like to
      appreciate Balazs Scheidler, Tom Petch and other persons for their input
      on security threats of syslog. The authors would like to acknowledge
      David Harrington for his detailed reviews of the content and grammar of
      the document and Pasi Eronen for his contributions to certificate 
      authentication and authorization sections.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-syslog-protocol">[I-D.ietf-syslog-protocol]</a></td>
<td class="author-text">Gerhards, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-syslog-protocol-23.txt">The syslog Protocol</a>,&rdquo; draft-ietf-syslog-protocol-23 (work in progress), September&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-syslog-protocol-23.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-pkix-rfc3280bis">[I-D.ietf-pkix-rfc3280bis]</a></td>
<td class="author-text">Cooper, D., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-pkix-rfc3280bis-11.txt">Internet X.509 Public Key Infrastructure Certificate and Certificate  Revocation List (CRL) Profile</a>,&rdquo; draft-ietf-pkix-rfc3280bis-11 (work in progress), February&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-pkix-rfc3280bis-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5234.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tls-rfc4346-bis">[I-D.ietf-tls-rfc4346-bis]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4346-bis-10.txt">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; draft-ietf-tls-rfc4346-bis-10 (work in progress), March&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4346-bis-10.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3766">[RFC3766]</a></td>
<td class="author-text">Orman, H. and P. Hoffman, &ldquo;<a href="http://tools.ietf.org/html/rfc3766">Determining Strengths For Public Keys Used For Exchanging Symmetric Keys</a>,&rdquo; BCP&nbsp;86, RFC&nbsp;3766, April&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3766.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fuyou Miao (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">No. 3, Xinxi Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Shangdi Information Industry Base</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Haidian District, Beijing  100085</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P. R. China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86 10 8288 2008</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:miaofy@huawei.com">miaofy@huawei.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="www.huawei.com">www.huawei.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yuzhi Ma (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">No. 3, Xinxi Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Shangdi Information Industry Base</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Haidian District, Beijing  100085</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P. R. China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86 10 8288 2008</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:myz@huawei.com">myz@huawei.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="www.huawei.com">www.huawei.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Joseph Salowey (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2901 3rd. Ave</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, WA  98121</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jsalowey@cisco.com">jsalowey@cisco.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
