Secure Inter-Domain Routing (sidr)                             Kent, S. 
Internet Draft                                                 Kong, D. 
Expires: August 2007                                   BBN Technologies 
Intended Status: Proposed Standard                        February 2007 
 
                                      
              A Profile for Route Origin Authorizations (ROA) 
                        draft-ietf-sidr-roa-format-00.txt 


Status of this Memo 

   By submitting this Internet-Draft, each author represents that       
   any applicable patent or other IPR claims of which he or she is       
   aware have been or will be disclosed, and any of which he or she       
   becomes aware will be disclosed, in accordance with Section 6 of       
   BCP 79. 

   Internet-Drafts are working documents of the Internet Engineering 
   Task Force (IETF), its areas, and its working groups.  Note that 
   other groups may also distribute working documents as Internet-
   Drafts. 

   Internet-Drafts are draft documents valid for a maximum of six months 
   and may be updated, replaced, or obsoleted by other documents at any 
   time.  It is inappropriate to use Internet-Drafts as reference 
   material or to cite them other than as "work in progress." 

   The list of current Internet-Drafts can be accessed at 
   http://www.ietf.org/ietf/1id-abstracts.txt 

   The list of Internet-Draft Shadow Directories can be accessed at 
   http://www.ietf.org/shadow.html 

   This Internet-Draft will expire on August 26, 2007. 

Abstract 

   This document defines a standard profile for Route Origin 
   Authorizations (ROAs).  A ROA is a digitally signed object that 
   provides a means of verifying that an IP address block holder has 
   authorized an Autonomous System (AS) to originate routes to that 
   address block. 

Conventions used in this document 

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 

 
 
 
Kent and Kong            Expires August 2007                   [Page 1] 

Internet-Draft     Route Origin Attestation Profile       February 2007 
    

   document are to be interpreted as described in RFC-2119 Error! 
   Reference source not found.. 

Table of Contents 

    
   1. Introduction...................................................2 
   2. Basic Format...................................................3 
      2.1. Signed-Data Content Type..................................3 
         2.1.1. version..............................................3 
         2.1.2. digestAlgorithms.....................................3 
         2.1.3. encapContentInfo.....................................3 
            2.1.3.1. eContentType....................................4 
            2.1.3.2. eContent........................................4 
         2.1.4. certificates.........................................5 
         2.1.5. crls.................................................5 
         2.1.6. signerInfos..........................................5 
            2.1.6.1. version.........................................5 
            2.1.6.2. sid.............................................5 
            2.1.6.3. digestAlgorithm.................................6 
            2.1.6.4. signedAttrs.....................................6 
            2.1.6.5. signatureAlgorithm..............................6 
            2.1.6.6. signature.......................................6 
            2.1.6.7. unsignedAttrs...................................6 
   3. Security Considerations........................................6 
   4. IANA Considerations............................................7 
   5. Acknowledgments................................................7 
   6. References.....................................................8 
      6.1. Normative References......................................8 
      6.2. Informative References....................................8 
   Author's Addresses................................................9 
   Intellectual Property Statement..................................10 
   Disclaimer of Validity...........................................10 
   Copyright Statement..............................................10 
    
1. Introduction 

   The primary purpose of the Internet IP Address and AS Number public 
   key infrastructure (PKI) system is to improve routing security.  As 
   part of this system, a mechanism is needed to allow entities to 
   verify that an AS has been given permission by an IP address block 
   holder to advertise routes to that block.  A ROA provides this 
   function. 

   A ROA is a digitally signed object that makes use of Cryptographic 
   Message Syntax (CMS) [RFC3852] as a standard encapsulation format.  

 
 
Kent and Kong            Expires August 2007                   [Page 2] 

Internet-Draft     Route Origin Attestation Profile       February 2007 
    

   CMS was chosen to take advantage of existing open source software 
   available for processing messages in this format. 

2. Basic Format 

   Using CMS syntax, a ROA is a type of signed-data object.  The general 
   format of a CMS object is: 

      ContentInfo ::= SEQUENCE { 
        contentType ContentType, 
        content [0] EXPLICIT ANY DEFINED BY contentType } 
    
      ContentType ::= OBJECT IDENTIFIER 
    
   As a ROA is a signed-data object, it uses the corresponding OID, 
   1.2.840.113549.1.7.2. [RFC3852] 

2.1. Signed-Data Content Type 

   According to the CMS standard, the signed-data content type shall 
   have ASN.1 type SignedData: 

      SignedData ::= SEQUENCE { 
        version CMSVersion, 
        digestAlgorithms DigestAlgorithmIdentifiers, 
        encapContentInfo EncapsulatedContentInfo, 
        certificates [0] IMPLICIT CertificateSet OPTIONAL, 
        crls [1] IMPLICIT RevocationInfoChoices OPTIONAL, 
        signerInfos SignerInfos } 
    
      DigestAlgorithmIdentifiers ::= SET OF DigestAlgorithmIdentifier 
    
      SignerInfos ::= SET OF SignerInfo 
    

2.1.1. version 

   The version is the syntax version number.  It MUST be 3, 
   corresponding to the signerInfo structure having version number 3.   

2.1.2. digestAlgorithms 

   The digestAlgorithms set MUST include only SHA-256, the OID for which 
   is 2.16.840.1.101.3.4.2.1. [RFC4055] It MUST NOT contain any other 
   algorithms. 


 
 
Kent and Kong            Expires August 2007                   [Page 3] 

Internet-Draft     Route Origin Attestation Profile       February 2007 
    

2.1.3. encapContentInfo 

   encapContentInfo is the signed content, consisting of a content type 
   identifier and the content itself. 

      EncapsulatedContentInfo ::= SEQUENCE { 
        eContentType ContentType, 
        eContent [0] EXPLICIT OCTET STRING OPTIONAL } 
    
      ContentType ::= OBJECT IDENTIFIER 
    
2.1.3.1. eContentType 

   The ContentType for a ROA is defined as routeOriginAttestation and 
   has the numerical value of 1.2.840.113549.1.9.16.1.24. 

      id-smime OBJECT IDENTIFIER ::= { iso(1) member-body(2) us(840) 
   rsadsi(113549) pkcs(1) pkcs9(9) 16 } 
    
      id-ct OBJECT INDENTIFIER ::= { id-smime 1 } 
    
      routeOriginAttestion OBJECT IDENTIFIER ::= { id-ct 24 } 
    
2.1.3.2. eContent 

   The content of a ROA is a single AS that has been authorized by the 
   address space holder to originate routes and a list of one or more IP 
   address prefixes that will be advertised.  If the address space 
   holder needs to authorize multiple ASes to advertise the same set of 
   address blocks, the holder issues multiple ROAs, one per AS number. 
   It is formally defined as: 

      RouteOriginAttestation ::= SEQUENCE { 
        version [0] INTEGER DEFAULT 0, 
        asID   ASID, 
        ipAddrBlocks ROAIPAddrBlocks } 
 
      ASID ::= INTEGER 
    
      ROAIPAddrBlocks ::= SEQUENCE of ROAIPAddressFamily 
    
      ROAIPAddressFamily ::= SEQUENCE { 
        addressFamily OCTET STRING (SIZE (2..3)), 
        addressesOrRanges SEQUENCE OF IPAddressOrRange } 
      -- Only two address families are allowed: IPv4 and IPv6 


 
 
Kent and Kong            Expires August 2007                   [Page 4] 

Internet-Draft     Route Origin Attestation Profile       February 2007 
    

      IPAddressOrRange ::= CHOICE { 
        addressPrefix IPAddress, 
        addressRange IPAddressRange } 
    
      IPAddressRange ::= SEQUENCE { 
        min IPAddress, 
        max IPAddress } 
    
      IPAddress ::= BIT STRING 
    
2.1.4. certificates 

   The certificates field MAY be included.  If so, it MUST contain only 
   the end entity certificate needed to validate this ROA. This 
   certificate should be present only if the ROA is being transmitted to 
   a relying party.  Thus in the initial use of ROA's where they are 
   being made available to relying parties via a repository system, this 
   certificate SHOULD be omitted. 

2.1.5. crls 

   The crls field MUST be omitted. 

2.1.6. signerInfos 

   SignerInfo is defined under CMS as: 

      SignerInfo ::= SEQUENCE { 
        version CMSVersion, 
        sid SignerIdentifier, 
        digestAlgorithm DigestAlgorithmIdentifier, 
        signedAttrs [0] IMPLICIT SignedAttributes OPTIONAL, 
        signatureAlgorithm SignatureAlgorithmIdentifier, 
        signature SignatureValue, 
        unsignedAttrs [1] IMPLICIT UnsignedAttributes OPTIONAL } 
 
2.1.6.1. version 

   The version number MUST be 3, corresponding with the choice of 
   SubjectKeyIdentifier for the sid. 

2.1.6.2. sid 

   The sid is defined as: 



 
 
Kent and Kong            Expires August 2007                   [Page 5] 

Internet-Draft     Route Origin Attestation Profile       February 2007 
    

      SignerIdentifier ::= CHOICE { 
        issuerAndSerialNumber IssuerAndSerialNumber, 
        subjectKeyIdentifier [0] SubjectKeyIdentifier } 
    
   For a ROA, the sid MUST be a SubjectKeyIdentifier. 
    
2.1.6.3. digestAlgorithm 

   The digestAlgorithm MUST be SHA-256, the OID for which is 
   2.16.840.1.101.3.4.2.1. [RFC4055] 

2.1.6.4. signedAttrs 

   signedAttrs MUST be omitted. 

2.1.6.5. signatureAlgorithm 

   The signatureAlgorithm MUST be SHA-256 with RSA 
   (sha256WithRSAEncryption), the OID for which is 
   1.2.840.113549.1.1.11. [RFC4055] 

2.1.6.6. signature 

   The signature value is defined as: 
    
      SignatureValue ::= OCTET STRING 
    
   The signature characteristics are defined by the digest and signature 
algorithms. 

2.1.6.7. unsignedAttrs 

   unsignedAttrs MUST be omitted. 

3. Security Considerations 

   There is no assumption of confidentiality for the data in a ROA; it 
   is anticipated that ROAs will be stored in repositories that are 
   accessible to all ISPs, maybe to all Internet users. There is no 
   explicit authentication associated with a ROA, since the PKI used for 
   ROA validation provides authorization but not authentication. 
   Although the ROA is a signed, application layer object, there is no 
   intent to convey non-repudiation via a ROA.  
    
   The purpose of a ROA is to convey authorization for an AS to 
   originate a route to the prefix(es) in the ROA. Thus the integrity of 
   a ROA must be established. The ROA makes use of the CMS signed 
 
 
Kent and Kong            Expires August 2007                   [Page 6] 

Internet-Draft     Route Origin Attestation Profile       February 2007 
    

   message format for integrity, and thus inherits the security 
   considerations associated with that data structure. The right of the 
   ROA signer to authorize the target AS to originate routes to the 
   prefix(es) is established through use of the address space and AS 
   number PKI described in [ARCH]. Specifically one must verify the 
   signature on the ROA using an X.509 certificate issued under this 
   PKI, and check that the prefix(es) in the ROA match those in the 
   address space extension in the certificate.  

4. IANA Considerations 

   None. 

5. Acknowledgments 

   The authors wish to thank Charles Gardiner and Russ Housley for their 
   help and contributions. 






























 
 
Kent and Kong            Expires August 2007                   [Page 7] 

Internet-Draft     Route Origin Attestation Profile       February 2007 
    

6. References 

6.1. Normative References 

   [RFC2119] Bradner, S., "Key words for use in RFCs to Indicate 
             Requirement Levels", BCP 14, RFC 2119, March 1997. 

   [RFC3852] Housley, R., "Cryptographic Message Syntax", RFC 3852, July 
             2004.    

   [RFC4055] Schaad, J., Kaliski, B., and Housley, R., "Additional 
             Algorithms and Identifiers for RSA Cryptography for use in 
             the Internet X.509 Public Key Infrastructure Certificate 
             and Certificate Revocation List (CRL) Profile", RFC 4055, 
             June 2005. 

6.2. Informative References 

   [RSA]     Rivest, R., Shamir, A., and Adelman, L. M. 1978. A method 
             for obtaining digital signatures and public-key 
             cryptosystems. Commun. ACM 21, 2 (Feb.), 120-126. 

   [ARCH]    Kent, S., Barnes, R., "An Infrastructure to Support Secure 
             Internet Routing," draft-ietf-sidr-arch-00.txt, February, 
             2007 (work in progress).   

    

    

    

    

    

    

    

    

    

    


 
 
Kent and Kong            Expires August 2007                   [Page 8] 

Internet-Draft     Route Origin Attestation Profile       February 2007 
    

Author's Addresses 

   Stephen Kent 
   BBN Technologies 
   10 Moulton Street 
   Cambridge MA 02138 
   USA 

   Phone: +1 (617) 873-3988 
   Email: skent@bbn.com 
    
   Derrick Kong 
   BBN Technologies 
   10 Moulton Street 
   Cambridge MA 02138 
   USA 
       
   Phone: +1 (617) 873-1951 
   Email: dkong@bbn.com 
    

    

    

    

    

    

    

    

    

    

    

    

    



 
 
Kent and Kong            Expires August 2007                   [Page 9] 

Internet-Draft     Route Origin Attestation Profile       February 2007 
    

Intellectual Property Statement 

   The IETF takes no position regarding the validity or scope of any 
   Intellectual Property Rights or other rights that might be claimed to 
   pertain to the implementation or use of the technology described in 
   this document or the extent to which any license under such rights 
   might or might not be available; nor does it represent that it has 
   made any independent effort to identify any such rights.  Information 
   on the procedures with respect to rights in RFC documents can be 
   found in BCP 78 and BCP 79. 

   Copies of IPR disclosures made to the IETF Secretariat and any 
   assurances of licenses to be made available, or the result of an 
   attempt made to obtain a general license or permission for the use of 
   such proprietary rights by implementers or users of this 
   specification can be obtained from the IETF on-line IPR repository at 
   http://www.ietf.org/ipr. 

   The IETF invites any interested party to bring to its attention any 
   copyrights, patents or patent applications, or other proprietary 
   rights that may cover technology that may be required to implement 
   this standard.  Please address the information to the IETF at 
   ietf-ipr@ietf.org. 

Disclaimer of Validity 

   This document and the information contained herein are provided on an 
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS 
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND 
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS 
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF 
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED 
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. 

Copyright Statement 

   Copyright (C) The IETF Trust (2007). 

   This document is subject to the rights, licenses and restrictions 
   contained in BCP 78, and except as set forth therein, the authors 
   retain all their rights. 

 




 
 
Kent and Kong            Expires August 2007                  [Page 10] 

