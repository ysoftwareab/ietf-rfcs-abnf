<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>LSP-Ping and BFD for MPLS-TP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="LSP-Ping and BFD for MPLS-TP">
<meta name="keywords" content="Internet-Draft, MPLS-TP OAM, lsp ping">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">N. Bahadur, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">R. Aggarwal</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Juniper Networks, Inc.</td></tr>
<tr><td class="header">Expires: January 7, 2010</td><td class="header">T. Nadeau</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">BT</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">N. Sprecher</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Y. Weingarten</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 06, 2009</td></tr>
</table></td></tr></table>
<h1><br />LSP-Ping and BFD for MPLS-TP<br />draft-nitinb-mpls-tp-lsp-ping-bfd-procedures-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 7, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>LSP-Ping and BFD for MPLS are existing and widely deployment OAM
      mechanisms for MPLS LSPs. This document describes how LSP-Ping and BFD
      for MPLS can be used to perform OAM on MPLS-TP LSPs. This document
      describes extensions to LSP-Ping when IP addressing is not in use, in a
      MPLS-TP deployment scenario. These extensions are also meant to be
      applicable when it is desirable to avoid the use of IP encapsulation for
      exchanging LSP-Ping OAM messages. This document also clarifies the use
      of BFD for MPLS-TP LSPs when IP addressing may not be available and/or
      it may not be desirable to encapsulate BFD packets in IP.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">1.1.</a>&nbsp;
Conventions used in this document<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.2.</a>&nbsp;
Existing LSP-Ping and BFD for MPLS LSPs Encapsulation Mechanism<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.3.</a>&nbsp;
Non-IP LSP-Ping and BFD for MPLS LSPs Encapsulation Mechanism<br />
<a href="#anchor4">2.</a>&nbsp;
LSP-Ping extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ach-header">2.1.</a>&nbsp;
LSP-Ping packet over ACH<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#pw-ach-header">2.2.</a>&nbsp;
LSP-Ping packet over PW-ACH<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dsmap-addr-type">2.3.</a>&nbsp;
New address type for Downstream Mapping TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#src-addr-tlv">2.4.</a>&nbsp;
Source Address TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dest-addr-tlv">2.5.</a>&nbsp;
Destination Address TLV<br />
<a href="#anchor5">3.</a>&nbsp;
Performing LSP-Ping over MPLS-TP LSPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lsp-ping-traditional">3.1.</a>&nbsp;
Traditional LSP-Ping<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lsp-ping-ping">3.2.</a>&nbsp;
Non-IP based LSP-Ping<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
P2MP Considerations<br />
<a href="#anchor7">4.</a>&nbsp;
Performing LSP Traceroute over MPLS-TP LSPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lsp-trace-traditional">4.1.</a>&nbsp;
Traditional LSP Traceroute<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lsp-ping-trace">4.2.</a>&nbsp;
Non-IP based LSP Traceroute<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.2.1.</a>&nbsp;
Ingress node procedure for sending echo request packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.2.2.</a>&nbsp;
Ingress node procedure for receiving echo response packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.2.3.</a>&nbsp;
Transit and egress node procedure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.3.</a>&nbsp;
P2MP Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.4.</a>&nbsp;
ECMP Considerations<br />
<a href="#bfd-mpls-tp">5.</a>&nbsp;
Running BFD over MPLS-TP LSPs<br />
<a href="#anchor13">6.</a>&nbsp;
Applicability<br />
<a href="#anchor14">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor15">8.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">8.1.</a>&nbsp;
New ACH Channel Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">8.2.</a>&nbsp;
New LSP-Ping TLV Types<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>LSP-Ping <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-bfd-mpls'>[I&#8209;D.ietf&#8209;bfd&#8209;mpls]<span> (</span><span class='info'>Aggarwal, R., Kompella, K., Nadeau, T., and G. Swallow, &ldquo;BFD For MPLS LSPs,&rdquo; June&nbsp;2008.</span><span>)</span></a> are OAM mechanisms for MPLS LSPs.
      This document describes how LSP-Ping and BFD for MPLS can be used to
      perform OAM on MPLS-TP LSPs. The document considers two cases. The first
      is when IP addressing and host stack are available on egress and transit
      LSRs. The second is when such capabilities are either not available or
      it is not desirable to use them.
</p>
<p>Sections <a class='info' href='#lsp-ping-ping'>Section&nbsp;3.2<span> (</span><span class='info'>Non-IP based LSP-Ping</span><span>)</span></a> and <a class='info' href='#lsp-ping-trace'>Section&nbsp;4.2<span> (</span><span class='info'>Non-IP based LSP Traceroute</span><span>)</span></a> describes the theory of operation for
      performing LSP-Ping over MPLS-TP LSPs. Section <a class='info' href='#ach-header'>Section&nbsp;2.1<span> (</span><span class='info'>LSP-Ping packet over ACH</span><span>)</span></a> describes the new TLVs and LSP-Ping
      extensions for performing LSP-Ping in the absence of IP addressing.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Conventions used in this document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Existing LSP-Ping and BFD for MPLS LSPs Encapsulation Mechanism</h3>

<p>LSP-Ping requires IP addressing on the egress and transit LSRs for
        performing OAM on MPLS signaled LSPs and pseudowires. BFD for MPLS
        LSPs also requires IP addressing. In particular, in these cases the
        LSP-Ping and BFD packets generated by an ingress LSR are encapsulated
        in an IP/UDP header with the destination address from the 127/8 range
        and then encapsulated in the MPLS label stack (<a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a> , <a class='info' href='#I-D.ietf-bfd-mpls'>[I&#8209;D.ietf&#8209;bfd&#8209;mpls]<span> (</span><span class='info'>Aggarwal, R., Kompella, K., Nadeau, T., and G. Swallow, &ldquo;BFD For MPLS LSPs,&rdquo; June&nbsp;2008.</span><span>)</span></a>).
        Egress LSRs use the presence of the 127/8 destination address to
        identify the OAM packets and rely further on the UDP port number to
        determine whether the packet is a LSP-Ping or a BFD packet. It is to
        be noted that this determination does not require IP forwarding
        capabilities. It requires the presence of an IP host stack which
        enables egress LSRs to process packets with a destination address from
        the 127/8 range. <a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a> allocates the 127/8
        range as "Internal host loopback address" and <a class='info' href='#RFC1812'>[RFC1812]<span> (</span><span class='info'>Baker, F., &ldquo;Requirements for IP Version 4 Routers,&rdquo; June&nbsp;1995.</span><span>)</span></a> states that "a router SHOULD NOT forward,
        except over a loopback interface, any packet that has a destination
        address on network 127".
</p>
<p>LSP-Ping and BFD for MPLS specify procedures that allow an egress
        LSR to use a MPLS LSP for forwarding LSP-Ping or BFD packets to the
        ingress LSR. This ensures that IP forwarding capabilities are not
        required and meets the MPLS-TP requirement of not having IP forwarding
        capabilities.
</p>
<p><a class='info' href='#I-D.ietf-mpls-tp-framework'>[I&#8209;D.ietf&#8209;mpls&#8209;tp&#8209;framework]<span> (</span><span class='info'>Bocci, M., Bryant, S., Frost, D., Levrau, L., and L. Berger, &ldquo;A Framework for MPLS in Transport Networks,&rdquo; April&nbsp;2010.</span><span>)</span></a> specifies that IP
        addressing is the default addressing mechanism for MPLS-TP networks.
        An IP host stack must be present when IP addressing is in use. This
        implies that exisiting LSP-Ping and BFD procedures can be used as is
        in MPLS-TP environments when IP addressing is in use.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Non-IP LSP-Ping and BFD for MPLS LSPs Encapsulation Mechanism</h3>

<p>In certain MPLS-TP deployment scenarios IP addressing might not be
        available or it may be preferred to use non-IP encapsulation for
        LSP-Ping and BFD packets. To enable re-use of OAM techniques provided
        by LSP-Ping and BFD in such networks, rest of this document defines
        extensions to LSP-Ping and procedures for using BFD. The document
        defines a new code-point for using LSP-Ping with an ACH header.
        Further, it describes how LSP-Ping can be used to perform Connectivity
        Verification, Route Tracing and Adjacency functions specified in <a class='info' href='#I-D.ietf-mpls-tp-oam-requirements'>[I&#8209;D.ietf&#8209;mpls&#8209;tp&#8209;oam&#8209;requirements]<span> (</span><span class='info'>Vigoureux, M. and D. Ward, &ldquo;Requirements for OAM in MPLS Transport Networks,&rdquo; March&nbsp;2010.</span><span>)</span></a>. This document also
        clarifies the usage of BFD in the context of MPLS-TP LSPs.
</p>
<p>Sections <a class='info' href='#lsp-ping-ping'>Section&nbsp;3.2<span> (</span><span class='info'>Non-IP based LSP-Ping</span><span>)</span></a> and <a class='info' href='#lsp-ping-trace'>Section&nbsp;4.2<span> (</span><span class='info'>Non-IP based LSP Traceroute</span><span>)</span></a> describe the theory of operation for
        performing LSP-Ping over MPLS-TP LSPs with a non-IP encapsulation.
        <a class='info' href='#ach-header'>Section&nbsp;2.1<span> (</span><span class='info'>LSP-Ping packet over ACH</span><span>)</span></a> describes the new TLVs and LSP-Ping
        extensions for performing LSP-Ping in the absence of IP addressing.
        <a class='info' href='#bfd-mpls-tp'>Section&nbsp;5<span> (</span><span class='info'>Running BFD over MPLS-TP LSPs</span><span>)</span></a> describes procedures for using BFD
        with non-IP encapsulation."
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
LSP-Ping extensions</h3>

<a name="ach-header"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
LSP-Ping packet over ACH</h3>

<p><a class='info' href='#RFC5586'>[RFC5586]<span> (</span><span class='info'>Bocci, M., Vigoureux, M., and S. Bryant, &ldquo;MPLS Generic Associated Channel,&rdquo; June&nbsp;2009.</span><span>)</span></a> defines an ACH mechanism for MPLS
        LSPs. This document defines a new ACH channel type for when IP
        addressing is not in use for LSP-Ping over associated bi-directional
        LSPs and co-routed bi-directional LSPs.
</p>
<p>ACH TLVs CANNOT be associated with LSP-Ping channel type.
</p><br /><hr class="insert" />
<a name="channel-type-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |0 0 0 1|Version|   Reserved    |     LSP-Ping Channel Type     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: LSP-Ping ACH Channel Type&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="pw-ach-header"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
LSP-Ping packet over PW-ACH</h3>

<p><a class='info' href='#RFC4385'>[RFC4385]<span> (</span><span class='info'>Bryant, S., Swallow, G., Martini, L., and D. McPherson, &ldquo;Pseudowire Emulation Edge-to-Edge (PWE3) Control Word for Use over an MPLS PSN,&rdquo; February&nbsp;2006.</span><span>)</span></a> defines an PW-ACH mechanism for
        pseudowires. The ACH channel type for LSP-Ping defined in <a class='info' href='#ach-header'>Section&nbsp;2.1<span> (</span><span class='info'>LSP-Ping packet over ACH</span><span>)</span></a> will be re-used for pseudowires so that IP
        addressing is not needed when using LSP-Ping OAM over pseudowires.
</p>
<a name="dsmap-addr-type"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
New address type for Downstream Mapping TLV</h3>

<p><a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a> defines the Downstream Mapping TLV.
        A new type is being added to the Address Type field as follows:
</p><br /><hr class="insert" />
<a name="dsmap-addr-type-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Type #        Address Type           K Octets
      ------        --------------         --------
          0         Not Applicable                8

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Downstream Mapping TLV new Address Type&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The new address type indicates that no address is present in the
        Downstream Mapping TLV. Multipath type MAY be set to 0 (no mutlpath)
        when using this address type.
</p>
<p>When this address type is used, on receipt of a lsp-ping echo
        request, both interface verification and label stack validation MUST
        be bypassed.
</p>
<p>The new address type is also applicable to the Detailed Downstream
        Mapping TLV defined in <a class='info' href='#I-D.ietf-mpls-lsp-ping-enhanced-dsmap'>[I&#8209;D.ietf&#8209;mpls&#8209;lsp&#8209;ping&#8209;enhanced&#8209;dsmap]<span> (</span><span class='info'>Bahadur, N., Kompella, K., and G. Swallow, &ldquo;Mechanism for performing LSP-Ping over MPLS tunnels,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="src-addr-tlv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Source Address TLV</h3>

<p>A new optional TLV is being defined for encapsulating the source
        address. The optional TLV will be part of the TLVs defined in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>. Only 1 source address TLV MUST be present in
        a LSP-Ping packet. The source address MUST specify the address of the
        originator of the packet. If more than 1 such TLV is present in a
        LSP-Ping request packet, then an error of "Malformed echo request
        received" SHOULD be returned. If more than 1 source address TLV is
        present in a LSP-Ping response packet, then the packet SHOULD be
        dropped without further processing. The source address TLV MUST NOT be
        used if IP addressing is in use. If IP addressing is in use, then one
        should use lsp-ping with IP.
</p>
<p>The format of the TLV is TBD.
</p>
<a name="dest-addr-tlv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Destination Address TLV</h3>

<p>A new optional TLV is being defined for encapsulating the
        destination address. The optional TLV will be part of the TLVs defined
        in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>. One or more of this TLV MAY be
        included in a LSP-Ping request message. If more than 1 destination
        address TLV is present in a LSP-Ping response packet, then the packet
        SHOULD be dropped without further processing. The destination address
        MUST specify the intended receipient(s) of the packet. If the
        destination address specified in any of the Destination Address TLVs
        does not match any address associated with the node which receives the
        LSP-Ping packet, then the LSP-Ping packet SHOULD be dropped without
        further processing. The destination address TLV MUST NOT be used if IP
        addressing is in use. If IP addressing is in use, then one should use
        lsp-ping with IP.
</p>
<p>The format of the TLV is TBD.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Performing LSP-Ping over MPLS-TP LSPs</h3>

<p>This section specifies how LSP-Ping ping can be used in the context
      of MPLS-TP LSPs. The LSP-Ping ping function meets the Connectivity
      Verification requirement specified in <a class='info' href='#I-D.ietf-mpls-tp-oam-requirements'>[I&#8209;D.ietf&#8209;mpls&#8209;tp&#8209;oam&#8209;requirements]<span> (</span><span class='info'>Vigoureux, M. and D. Ward, &ldquo;Requirements for OAM in MPLS Transport Networks,&rdquo; March&nbsp;2010.</span><span>)</span></a>.
</p>
<a name="lsp-ping-traditional"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Traditional LSP-Ping</h3>

<p>Traditional LSP-Ping packets ride over the LSP and contain an
        IP/UDP packet within them. The IP header is not used for forwarding
        (since the LSP is forwarded using MPLS label switching). The IP header
        is used mainly for addressing and can be used in the context of
        MPLS-TP LSPs. This form of LSP-Ping OAM MUST be supported for MPLS-TP
        LSPs when IP addressing is in use. The figure below shows an MPLS-TP
        LSP-Ping OAM packet.
</p><br /><hr class="insert" />
<a name="lsp-ping-ip-payload-fig"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: 0'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         MPLS Label stack                      |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                       IP/UDP Headers                          |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      LSP-Ping payload                         |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: LSP-Ping packet&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The LSP-Ping Reply mode <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a> in the
        LSP-Ping echo request MUST be set to 4 (Reply via application level
        control channel).
</p>
<p>The LSP-Ping reply message MUST be sent on the reverse path of the
        LSP. The reply MUST contain IP/UDP headers followed by the LSP-Ping
        payload. The destination address in the IP header MUST be set to that
        of the sender of the request message. The source adderss in the IP
        header MUST be set to a valid address of the replying node.
</p>
<a name="lsp-ping-ping"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Non-IP based LSP-Ping</h3>

<p>The OAM procedures defined in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>
        require the use of IP addressing and in some cases IP routing to
        perform OAM functions. When the ACH header is used, IP addressing and
        routing is not needed. This section describes procedures for
        performing lsp-ping without a dependency on IP.
</p>
<p>When ACH header is used, an LSP-Ping packet will look as
        follows:
</p><br /><hr class="insert" />
<a name="lsp-ping-payload-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         MPLS Label stack                      |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          GAL                                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |0 0 0 1|Version|   Reserved    |     LSP-Ping Channel Type     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      LSP-Ping payload                         |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: LSP-Ping packet with ACH&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>When using LSP-Ping over the ACH header, the LSP-Ping Reply mode
        <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a> in the LSP-Ping echo request MUST be
        set to 4 (Reply via application level control channel).
</p>
<p>The ingress node MAY attach a Source Address TLV (<a class='info' href='#src-addr-tlv'>Section&nbsp;2.4<span> (</span><span class='info'>Source Address TLV</span><span>)</span></a>) to identify the node originating the
        request.
</p>
<p>The LSP-Ping reply message MUST be sent on the reverse path of the
        LSP using ACH. The LSP-Ping payload MUST directly follow the ACH
        header and no IP and/or UDP headers MUST be attached. If the request
        message contained the Source Address TLV and a response is being sent
        to the originator, then a Destination Address TLV (<a class='info' href='#dest-addr-tlv'>Section&nbsp;2.5<span> (</span><span class='info'>Destination Address TLV</span><span>)</span></a>) SHOULD be added to the reply message.
        The contents of the LSP-Ping request Source Address TLV should be
        copied into the LSP-Ping response Destination Address TLV. The
        responding node MAY attach a Source Address TLV to identify the node
        sending the response.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
P2MP Considerations</h3>

<p><a class='info' href='#I-D.ietf-mpls-p2mp-lsp-ping'>[I&#8209;D.ietf&#8209;mpls&#8209;p2mp&#8209;lsp&#8209;ping]<span> (</span><span class='info'>Yasukawa, S., Farrel, A., Ali, Z., Swallow, G., Nadeau, T., and S. Saxena, &ldquo;Detecting Data Plane Failures in Point-to-Multipoint Multiprotocol Label Switching (MPLS) - Extensions to LSP Ping,&rdquo; March&nbsp;2010.</span><span>)</span></a> describes how
        LSP-Ping can be used for OAM on P2MP LSPs. The procedures described in
        this draft apply as is irrespective of whether we use the mechanism
        specified in <a class='info' href='#lsp-ping-traditional'>Section&nbsp;3.1<span> (</span><span class='info'>Traditional LSP-Ping</span><span>)</span></a> or the
        mechanism specified in <a class='info' href='#lsp-ping-ping'>Section&nbsp;3.2<span> (</span><span class='info'>Non-IP based LSP-Ping</span><span>)</span></a>.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Performing LSP Traceroute over MPLS-TP LSPs</h3>

<p>This section specifies how LSP-Ping traceroute can be used in the
      context of MPLS-TP LSPs. The LSP-Ping traceroute function meets the
      Adjancency and Route Tracing requirement specified in <a class='info' href='#I-D.ietf-mpls-tp-oam-requirements'>[I&#8209;D.ietf&#8209;mpls&#8209;tp&#8209;oam&#8209;requirements]<span> (</span><span class='info'>Vigoureux, M. and D. Ward, &ldquo;Requirements for OAM in MPLS Transport Networks,&rdquo; March&nbsp;2010.</span><span>)</span></a>.
</p>
<p>When performing lsp-ping traceroute, the ingress node inserts a
      Downstream Mapping TLV to get the downstream node information and to
      enable LSP verification along the transit nodes. The Downstream mapping
      TLV can be used as is for performing the traceroute. If IP addressing is
      not in use, then the Address Type field in the Downstream Mapping TLV
      can be set to "Not applicable" (<a class='info' href='#dsmap-addr-type'>Section&nbsp;2.3<span> (</span><span class='info'>New address type for Downstream Mapping TLV</span><span>)</span></a>).
      The Downstream Mapping TLV address type field can be extended to include
      other address types as need be.
</p>
<a name="lsp-trace-traditional"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Traditional LSP Traceroute</h3>

<p>The mechanics of LSP-Ping traceroute are similar to those described
        for ping in <a class='info' href='#lsp-ping-traditional'>Section&nbsp;3.1<span> (</span><span class='info'>Traditional LSP-Ping</span><span>)</span></a>. Traceroute
        packets sent by the lsp ingress MUST adhere to the format described in
        <a class='info' href='#lsp-ping-ping'>Section&nbsp;3.2<span> (</span><span class='info'>Non-IP based LSP-Ping</span><span>)</span></a>.This form of LSP-Ping OAM MUST be
        supported for MPLS-TP LSPs, when IP addressing is in use.
</p>
<a name="lsp-ping-trace"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Non-IP based LSP Traceroute</h3>

<p>This section describes the procedures for performing lsp-traceroute
        when using the ACH header and without any dependency on IP addressing.
        The procedures specified in <a class='info' href='#lsp-ping-ping'>Section&nbsp;3.2<span> (</span><span class='info'>Non-IP based LSP-Ping</span><span>)</span></a> with
        regards to Source Address TLV and Destination Address TLV apply to LSP
        traceroute as well.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Ingress node procedure for sending echo request packets</h3>

<p>Traceroute packets sent by the lsp ingress MUST adhere to the
          format described in <a class='info' href='#lsp-ping-ping'>Section&nbsp;3.2<span> (</span><span class='info'>Non-IP based LSP-Ping</span><span>)</span></a>. MPLS-TTL
          expiry (as described in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a>) will be used
          to direct the packets to specific nodes along the LSP path.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Ingress node procedure for receiving echo response packets</h3>

<p>The lsp-ping traceroute responses will be received on the LSP
          itself and the presence of an ACH header with channel type of
          LSP-Ping is an indicator that the packet contains LSP-ping
          payload.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Transit and egress node procedure</h3>

<p>When a echo request reaches the transit or egress, the presence
          of the ACH channel type of LSP-Ping will indicate that the packet
          contains LSP-Ping data. The LSP-Ping data and the label stack should
          be able to identify the LSP associated with the echo request packet.
          In case if there is an error and the node is unable to idenfity the
          LSP on which the echo response should to be sent, the node MUST drop
          the echo request packet and not send any response back. All
          responses MUST always be sent on a LSP path using the ACH header and
          ACH channel type of LSP-Ping.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
P2MP Considerations</h3>

<p><a class='info' href='#I-D.ietf-mpls-p2mp-lsp-ping'>[I&#8209;D.ietf&#8209;mpls&#8209;p2mp&#8209;lsp&#8209;ping]<span> (</span><span class='info'>Yasukawa, S., Farrel, A., Ali, Z., Swallow, G., Nadeau, T., and S. Saxena, &ldquo;Detecting Data Plane Failures in Point-to-Multipoint Multiprotocol Label Switching (MPLS) - Extensions to LSP Ping,&rdquo; March&nbsp;2010.</span><span>)</span></a> describes how
        LSP-Ping can be used for OAM on P2MP LSPs. The procedures described in
        this draft apply as is irrespective of whether we use the mechanism
        specified in <a class='info' href='#lsp-trace-traditional'>Section&nbsp;4.1<span> (</span><span class='info'>Traditional LSP Traceroute</span><span>)</span></a> or the
        mechanism specified in <a class='info' href='#lsp-ping-trace'>Section&nbsp;4.2<span> (</span><span class='info'>Non-IP based LSP Traceroute</span><span>)</span></a>.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
ECMP Considerations</h3>

<p>LSP-Ping using ACH SHOULD NOT be used when there is ECMP (equal
        cost multiple paths) for a given LSP. The addition of the additional
        ACH header may modify the hashing behavior for OAM packets which may
        result in incorrect modeling of path taken by data traffic.
</p>
<a name="bfd-mpls-tp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Running BFD over MPLS-TP LSPs</h3>

<p><a class='info' href='#I-D.ietf-bfd-mpls'>[I&#8209;D.ietf&#8209;bfd&#8209;mpls]<span> (</span><span class='info'>Aggarwal, R., Kompella, K., Nadeau, T., and G. Swallow, &ldquo;BFD For MPLS LSPs,&rdquo; June&nbsp;2008.</span><span>)</span></a> describes how BFD can be
      used for Continuity Check for MPLS LSPs. When IP addressing is in use,
      the procedures described in <a class='info' href='#I-D.ietf-bfd-mpls'>[I&#8209;D.ietf&#8209;bfd&#8209;mpls]<span> (</span><span class='info'>Aggarwal, R., Kompella, K., Nadeau, T., and G. Swallow, &ldquo;BFD For MPLS LSPs,&rdquo; June&nbsp;2008.</span><span>)</span></a>
      apply as is. This section clarifies the usage of BFD in the context of
      MPLS-TP LSPs when it is not desirable to use IP encapsulation. When
      using BFD over MPLS-TP LSPs, the BFD descriminator MAY either be
      signaled via LSP-Ping or be statically configured. The BFD packets MUST
      be sent over ACH when IP encapsulation is not used. BFD packets, for
      both directions, MUST be sent over the MPLS-TP LSP and IP forwarding
      SHOULD NOT be used for the reverse path. The format of a BFD packet when
      using it as an OAM tool for MPLS-TP LSPs SHOULD be as follows:
</p><br /><hr class="insert" />
<a name="bfd-payload-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         MPLS Label stack                      |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          GAL                                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |0 0 0 1|Version|   Reserved    |        Channel Type           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Payload depending on channel type                  |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: BFD packet over MPLS-TP LSPs&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p><a class='info' href='#I-D.ietf-pwe3-vccv-bfd'>[I&#8209;D.ietf&#8209;pwe3&#8209;vccv&#8209;bfd]<span> (</span><span class='info'>Nadeau, T. and C. Pignataro, &ldquo;Bidirectional Forwarding Detection (BFD) for the Pseudowire Virtual Circuit Connectivity Verification (VCCV),&rdquo; July&nbsp;2009.</span><span>)</span></a> specifies how BFD can
      be used over MPLS PWs. Of specific interest are 2 modes:
</p>
<p></p>
<ol class="text">
<li>Channel type is IP and payload contains BFD packet with IP/UDP
          headers.
</li>
<li>Channel type is BFD and payload contains BFD packet without
          IP/UDP headers.
</li>
</ol><p>The first mode MUST be supported for BFD over MPLS-TP LSPs. The
      second mode MAY be supported in addition.
</p>
<p>Thus, no changes in BFD and no new code-points are needed to run BFD
      over MPLS-TP LSPs. BFD supports continuous fault monitoring and thus
      meets the Continuity Check requirement specified in <a class='info' href='#I-D.ietf-mpls-tp-oam-requirements'>[I&#8209;D.ietf&#8209;mpls&#8209;tp&#8209;oam&#8209;requirements]<span> (</span><span class='info'>Vigoureux, M. and D. Ward, &ldquo;Requirements for OAM in MPLS Transport Networks,&rdquo; March&nbsp;2010.</span><span>)</span></a>. For point to
      multipoint Continuity Check, there is work in progress on using BFD for
      P2MP MPLS LSPs ( <a class='info' href='#I-D.katz-ward-bfd-multipoint'>[I&#8209;D.katz&#8209;ward&#8209;bfd&#8209;multipoint]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;BFD for Multipoint Networks,&rdquo; February&nbsp;2009.</span><span>)</span></a>)
      and this can be leveraged for MPLS-TP LSPs as well.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Applicability</h3>

<p>The procedures described in this document apply to MPLS LSPs and as
      well as to LSPs based on the MPLS-TP profile. The LSP-Ping procedures
      can be used for performing OAM on both LSPs and Pseudowires.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>The draft does not introduce any new security considerations. Those
      discussed in <a class='info' href='#RFC4379'>[RFC4379]<span> (</span><span class='info'>Kompella, K. and G. Swallow, &ldquo;Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures,&rdquo; February&nbsp;2006.</span><span>)</span></a> are also applicable to this
      document.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
New ACH Channel Type</h3>

<p>A new Channel type is defined in <a class='info' href='#ach-header'>Section&nbsp;2.1<span> (</span><span class='info'>LSP-Ping packet over ACH</span><span>)</span></a>.
        IANA is requested to assign a new value from the "PW Associated
        Channel Type" registry, as per IETF consensus policy.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Value    Meaning
    -----    -------
     TBD     Associated Channel carries LSP-Ping packet

</pre></div>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
New LSP-Ping TLV Types</h3>

<p>New TLV types are defined in <a class='info' href='#src-addr-tlv'>Section&nbsp;2.4<span> (</span><span class='info'>Source Address TLV</span><span>)</span></a>
        and <a class='info' href='#dest-addr-tlv'>Section&nbsp;2.5<span> (</span><span class='info'>Destination Address TLV</span><span>)</span></a>. IANA is requested to assign
        values from the "Multi-Protocol Label Switching (MPLS) Label Switched
        Paths (LSPs) Parameters" registry, "TLVs and sub-TLVs" sub- registry
        from the range of 32768-64511.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Value    Meaning
    -----    -------
     TBD     Source Address
     TBD     Destination Address

</pre></div>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4379">[RFC4379]</a></td>
<td class="author-text">Kompella, K. and G. Swallow, &ldquo;<a href="http://tools.ietf.org/html/rfc4379">Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures</a>,&rdquo; RFC&nbsp;4379, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4379.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4385">[RFC4385]</a></td>
<td class="author-text">Bryant, S., Swallow, G., Martini, L., and D. McPherson, &ldquo;<a href="http://tools.ietf.org/html/rfc4385">Pseudowire Emulation Edge-to-Edge (PWE3) Control Word for Use over an MPLS PSN</a>,&rdquo; RFC&nbsp;4385, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4385.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-bfd-mpls">[I-D.ietf-bfd-mpls]</a></td>
<td class="author-text">Aggarwal, R., Kompella, K., Nadeau, T., and G. Swallow, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-mpls-07.txt">BFD For MPLS LSPs</a>,&rdquo; draft-ietf-bfd-mpls-07 (work in progress), June&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-mpls-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mpls-lsp-ping-enhanced-dsmap">[I-D.ietf-mpls-lsp-ping-enhanced-dsmap]</a></td>
<td class="author-text">Bahadur, N., Kompella, K., and G. Swallow, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mpls-lsp-ping-enhanced-dsmap-04.txt">Mechanism for performing LSP-Ping over MPLS tunnels</a>,&rdquo; draft-ietf-mpls-lsp-ping-enhanced-dsmap-04 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mpls-lsp-ping-enhanced-dsmap-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mpls-p2mp-lsp-ping">[I-D.ietf-mpls-p2mp-lsp-ping]</a></td>
<td class="author-text">Yasukawa, S., Farrel, A., Ali, Z., Swallow, G., Nadeau, T., and S. Saxena, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mpls-p2mp-lsp-ping-10.txt">Detecting Data Plane Failures in Point-to-Multipoint Multiprotocol Label Switching (MPLS) - Extensions to LSP Ping</a>,&rdquo; draft-ietf-mpls-p2mp-lsp-ping-10 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mpls-p2mp-lsp-ping-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mpls-tp-framework">[I-D.ietf-mpls-tp-framework]</a></td>
<td class="author-text">Bocci, M., Bryant, S., Frost, D., Levrau, L., and L. Berger, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mpls-tp-framework-11.txt">A Framework for MPLS in Transport Networks</a>,&rdquo; draft-ietf-mpls-tp-framework-11 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mpls-tp-framework-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mpls-tp-oam-requirements">[I-D.ietf-mpls-tp-oam-requirements]</a></td>
<td class="author-text">Vigoureux, M. and D. Ward, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mpls-tp-oam-requirements-06.txt">Requirements for OAM in MPLS Transport Networks</a>,&rdquo; draft-ietf-mpls-tp-oam-requirements-06 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mpls-tp-oam-requirements-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-pwe3-vccv-bfd">[I-D.ietf-pwe3-vccv-bfd]</a></td>
<td class="author-text">Nadeau, T. and C. Pignataro, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-pwe3-vccv-bfd-07.txt">Bidirectional Forwarding Detection (BFD) for the Pseudowire Virtual Circuit Connectivity Verification (VCCV)</a>,&rdquo; draft-ietf-pwe3-vccv-bfd-07 (work in progress), July&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-pwe3-vccv-bfd-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.katz-ward-bfd-multipoint">[I-D.katz-ward-bfd-multipoint]</a></td>
<td class="author-text">Katz, D. and D. Ward, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-katz-ward-bfd-multipoint-02.txt">BFD for Multipoint Networks</a>,&rdquo; draft-katz-ward-bfd-multipoint-02 (work in progress), February&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-katz-ward-bfd-multipoint-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1122">[RFC1122]</a></td>
<td class="author-text"><a href="mailto:Braden@ISI.EDU">Braden, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1122">Requirements for Internet Hosts - Communication Layers</a>,&rdquo; STD&nbsp;3, RFC&nbsp;1122, October&nbsp;1989 (<a href="http://www.rfc-editor.org/rfc/rfc1122.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1812">[RFC1812]</a></td>
<td class="author-text"><a href="mailto:fred@cisco.com">Baker, F.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1812">Requirements for IP Version 4 Routers</a>,&rdquo; RFC&nbsp;1812, June&nbsp;1995 (<a href="http://www.rfc-editor.org/rfc/rfc1812.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5586">[RFC5586]</a></td>
<td class="author-text">Bocci, M., Vigoureux, M., and S. Bryant, &ldquo;<a href="http://tools.ietf.org/html/rfc5586">MPLS Generic Associated Channel</a>,&rdquo; RFC&nbsp;5586, June&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5586.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nitin Bahadur (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juniper Networks, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1194 N. Mathilda Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale, CA  94089</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 745 2000</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:nitinb@juniper.net">nitinb@juniper.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="www.juniper.net">www.juniper.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Rahul Agrawal</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juniper Networks, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1194 N. Mathilda Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale, CA  94089</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 745 2000</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rahul@juniper.net">rahul@juniper.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="www.juniper.net">www.juniper.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Thomas D. Nadeau</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">BT</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">BT Centre</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">81 Newgate Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">London  EC1A 7AJ</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">United Kingdom</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tom.nadeau@bt.com">tom.nadeau@bt.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nurit Sprecher</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3 Hanagar St. Neve Ne'eman B</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hod Hasharon  45241</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Israel</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+972-9-775 1229</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:nurit.sprecher@nsn.com">nurit.sprecher@nsn.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yaacov Weingarten</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3 Hanagar St. Neve Ne'eman B</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hod Hasharon  45241</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Israel</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+972-9-775 1827</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:yaacov.weingarten@nsn.com">yaacov.weingarten@nsn.com</a></td></tr>
</table>
</body></html>
