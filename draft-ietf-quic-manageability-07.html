<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Manageability of the QUIC Transport Protocol</title>
<meta content="Mirja Kuehlewind" name="author">
<meta content="Brian Trammell" name="author">
<meta content="
       This document discusses manageability of the QUIC transport protocol, focusing
on caveats impacting network operations involving QUIC traffic. Its intended
audience is network operators, as well as content providers that rely on the use
of QUIC-aware middleboxes, e.g. for load balancing. 
    " name="description">
<meta content="xml2rfc 2.46.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-quic-manageability-07" name="ietf.draft">
<link href="/tmp/draft-ietf-quic-manageability-07-t7dlwg2j.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code {
  background-color: #f9f9f9;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">QUIC Manageability</td>
<td class="right">July 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Kuehlewind &amp; Trammell</td>
<td class="center">Expires 9 January 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-quic-manageability-07</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-07-08" class="published">8 July 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-01-09">9 January 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Kuehlewind</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">B. Trammell</div>
<div class="org">Google</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Manageability of the QUIC Transport Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document discusses manageability of the QUIC transport protocol, focusing
on caveats impacting network operations involving QUIC traffic. Its intended
audience is network operators, as well as content providers that rely on the use
of QUIC-aware middleboxes, e.g. for load balancing.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 9 January 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-notational-conventions" class="xref">Notational Conventions</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-features-of-the-quic-wire-i" class="xref">Features of the QUIC Wire Image</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-quic-packet-header-structur" class="xref">QUIC Packet Header Structure</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-coalesced-packets" class="xref">Coalesced Packets</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-use-of-port-numbers" class="xref">Use of Port Numbers</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-the-quic-handshake" class="xref">The QUIC handshake</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-integrity-protection-of-the" class="xref">Integrity Protection of the Wire Image</a><a href="#section-toc.1-1.2.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-connection-id-and-rebinding" class="xref">Connection ID and Rebinding</a><a href="#section-toc.1-1.2.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="xref">2.7</a>.  <a href="#name-packet-numbers" class="xref">Packet Numbers</a><a href="#section-toc.1-1.2.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.8">
                <p id="section-toc.1-1.2.2.8.1"><a href="#section-2.8" class="xref">2.8</a>.  <a href="#name-version-negotiation-and-gre" class="xref">Version Negotiation and Greasing</a><a href="#section-toc.1-1.2.2.8.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-network-visible-information" class="xref">Network-visible information about QUIC flows</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-identifying-quic-traffic" class="xref">Identifying QUIC traffic</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-identifying-negotiated-vers" class="xref">Identifying Negotiated Version</a><a href="#section-toc.1-1.3.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-rejection-of-garbage-traffi" class="xref">Rejection of Garbage Traffic</a><a href="#section-toc.1-1.3.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-connection-confirmation" class="xref">Connection confirmation</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-application-identification" class="xref">Application Identification</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-flow-association" class="xref">Flow association</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-flow-teardown" class="xref">Flow teardown</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-flow-symmetry-measurement" class="xref">Flow symmetry measurement</a><a href="#section-toc.1-1.3.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-round-trip-time-rtt-measure" class="xref">Round-Trip Time (RTT) Measurement</a><a href="#section-toc.1-1.3.2.7.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7.2.1">
                    <p id="section-toc.1-1.3.2.7.2.1.1"><a href="#section-3.7.1" class="xref">3.7.1</a>.  <a href="#name-measuring-initial-rtt" class="xref">Measuring initial RTT</a><a href="#section-toc.1-1.3.2.7.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7.2.2">
                    <p id="section-toc.1-1.3.2.7.2.2.1"><a href="#section-3.7.2" class="xref">3.7.2</a>.  <a href="#name-using-the-spin-bit-for-pass" class="xref">Using the Spin Bit for Passive RTT Measurement</a><a href="#section-toc.1-1.3.2.7.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-specific-network-management" class="xref">Specific Network Management Tasks</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-stateful-treatment-of-quic-" class="xref">Stateful treatment of QUIC traffic</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-passive-network-performance" class="xref">Passive network performance measurement and troubleshooting</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-server-cooperation-with-loa" class="xref">Server cooperation with load balancers</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-ddos-detection-and-mitigati" class="xref">DDoS Detection and Mitigation</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-udp-policing" class="xref">UDP Policing</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-distinguishing-acknowledgme" class="xref">Distinguishing acknowledgment traffic</a><a href="#section-toc.1-1.4.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-qos-support-and-ecmp" class="xref">QoS support and ECMP</a><a href="#section-toc.1-1.4.2.7.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-contributors" class="xref">Contributors</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">QUIC <span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span> is a new transport protocol
currently under development in the IETF QUIC working group, focusing on
support of semantics as needed for HTTP/2 <span>[<a href="#QUIC-HTTP" class="xref">QUIC-HTTP</a>]</span>.
Based on current deployment practices, QUIC is encapsulated in UDP and
encrypted by default. The current version of QUIC integrates TLS
<span>[<a href="#QUIC-TLS" class="xref">QUIC-TLS</a>]</span> to encrypt all payload data and most control
information.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Given that QUIC is an end-to-end transport protocol, all information in the
protocol header, even that which can be inspected, is not meant to be
mutable by the network, and is therefore integrity-protected. While less
information is visible to the network than for TCP, integrity protection can
also simplify troubleshooting because none of the nodes on the network path
can modify the transport layer information.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document provides guidance for network operation on the management of QUIC
traffic. This includes guidance on how to interpret and utilize information that
is exposed by QUIC to the network as well as explaining requirement and
assumptions that the QUIC protocol design takes toward the expected network
treatment. It also discusses how common network management practices will be
impacted by QUIC.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Since QUIC's wire image <span>[<a href="#WIRE-IMAGE" class="xref">WIRE-IMAGE</a>]</span> is integrity protected and not
modifiable on path, in-network operations are not possible without terminating
the QUIC connection, for instance using a back-to-back proxy. Proxy operations
are not in scope for this document. QUIC proxies must be fully-fledged QUIC
endpoints, implementing the transport as defined in <span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span> and
<span>[<a href="#QUIC-TLS" class="xref">QUIC-TLS</a>]</span> as well as proxy-relevant semantics for the application(s) running
over QUIC (e.g. HTTP/3 as defined in <span>[<a href="#QUIC-HTTP" class="xref">QUIC-HTTP</a>]</span>).<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Network management is not a one-size-fits-all endeavour: practices considered
necessary or even mandatory within enterprise networks with certain compliance
requirements, for example, would be impermissible on other networks without
those requirements. This document therefore does not make any specific
recommendations as to which practices should or should not be applied; for each
practice, it describes what is and is not possible with the QUIC transport
protocol as defined.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">QUIC is at the moment very much a moving target. This document refers the state
of the QUIC working group drafts as well as to changes under discussion, via
issues and pull requests in GitHub current as of the time of writing.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="notational-conventions">
<section id="section-1.1">
        <h3 id="name-notational-conventions">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-wire-image">
<section id="section-2">
      <h2 id="name-features-of-the-quic-wire-i">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-features-of-the-quic-wire-i" class="section-name selfRef">Features of the QUIC Wire Image</a>
      </h2>
<p id="section-2-1">In this section, we discusses those aspects of the QUIC transport protocol that
have an impact on the design and operation of devices that forward QUIC packets.
Here, we are concerned primarily with the unencrypted part of QUIC's wire image
<span>[<a href="#WIRE-IMAGE" class="xref">WIRE-IMAGE</a>]</span>, which we define as the information available in the packet
header in each QUIC packet, and the dynamics of that information. Since QUIC is
a versioned protocol, the wire image of the header format can also change from
version to version. However, at least the mechanism by which a receiver can
determine which version is used and the meaning and location of fields used in
the version negotiation process is invariant
<span>[<a href="#QUIC-INVARIANTS" class="xref">QUIC-INVARIANTS</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document is focused on the protocol as presently defined in
<span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span> and <span>[<a href="#QUIC-TLS" class="xref">QUIC-TLS</a>]</span>. Non-invariant parts of the wire image
as described herein and in those documents cannot be used to identify QUIC
as a protocol, and cannot be relied upon to infer behavior of
future versions of QUIC.<a href="#section-2-2" class="pilcrow">¶</a></p>
<div id="public-header">
<section id="section-2.1">
        <h3 id="name-quic-packet-header-structur">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-quic-packet-header-structur" class="section-name selfRef">QUIC Packet Header Structure</a>
        </h3>
<p id="section-2.1-1">QUIC packets may have either a long header, or a short header. The first bit
of the QUIC header us the Header Form bit, and indicates which type of header
is present.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The long header exposes more information. It is used during connection
establishment, including version negotiation, retry, and 0-RTT data. It
contains a version number, as well as source and destination connection IDs
for grouping packets belonging to the same flow. The definition and location
of these fields in the QUIC long header are invariant for future versions of
QUIC, although future versions of QUIC may provide additional fields in the
long header <span>[<a href="#QUIC-INVARIANTS" class="xref">QUIC-INVARIANTS</a>]</span>.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">Short headers are used after connection establishment, and contain only an
optional destination connection ID and the spin bit for RTT measurement.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">The following information is exposed in QUIC packet headers:<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-5.1">"fixed bit": the second most significant bit of the first octet most QUIC
packets of the current version is currently set to 1, for demultiplexing
with other UDP-encapsulated protocols.<a href="#section-2.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.2">latency spin bit: the third most significant bit of first octet in the short
packet header. The spin bit is set by endpoints such that  tracking edge
transitions can be used to passively observe end-to-end RTT. See
<a href="#spin-usage" class="xref">Section 3.7.2</a> for further details.<a href="#section-2.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.3">header type: the long header has a 2 bit packet type field following the
Header Form and fixed bits. Header types correspond to stages of the
handshake; see Section 17.2 of <span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span> for details.<a href="#section-2.1-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.4">version number: the version number present in the long header, and identifies
the version used for that packet. Note that during Version Negotiation (see
<a href="#version" class="xref">Section 2.8</a>, and Section 17.2.1 of <span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span>, the version number
field has a special value (0x00000000) that identifies the packet as a Version
Negotiation packet.<a href="#section-2.1-5.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.5">source and destination connection ID: short and long packet headers carry a
destination connection ID, a variable-length field that can be used to
identify the connection associated with a QUIC packet, for load-balancing and
NAT rebinding purposes; see <a href="#sec-loadbalancing" class="xref">Section 4.3</a> and <a href="#rebinding" class="xref">Section 2.6</a>. Long
packet headers additionally carry a source connection ID. The source
connection ID corresponds to the destination connection ID the source would
like to have on packets sent to it, and is only present on long packet
headers. On long header packets, the length of the connection
IDs is also present; on short header packets, the length of the destination
connection ID is implicit.<a href="#section-2.1-5.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.6">length: the length of the remaining QUIC packet after the length field,
present on long headers. This field is used to implement coalesced packets
during the handshake (see <a href="#coalesced" class="xref">Section 2.2</a>).<a href="#section-2.1-5.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.7">token: Initial packets may contain a token, a variable-length opaque value
optionally sent from client to server, used for validating the client's
address. Retry packets also contain a token, which can be used by the client
in an Initial packet on a subsequent connection attempt. The length of the
token is explicit in both cases.<a href="#section-2.1-5.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-6">Retry (Section 17.2.5 of <span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span>) and Version Negotiation (Section
17.2.1 of <span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span>) packets are not encrypted or obfuscated in any
way. For other kinds of packets, other information in the packet headers is
cryptographically obfuscated:<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-7.1">packet number: All packets except Version Negotiation and
Retry packets have an associated packet number; however, this packet number
is encrypted, and therefore not of use to on-path observers. The offset of the
packet number is encoded in the header for packets with long headers, while it
is implicit (depending on Destination Connection ID length) in short header
packets. The length of the packet number is cryptographically obfuscated.<a href="#section-2.1-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-7.2">key phase: The Key Phase bit, present in short headers, specifies the keys
used to encrypt the packet, supporting key rotation. The Key Phase bit is
cryptographically obfuscated.<a href="#section-2.1-7.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="coalesced">
<section id="section-2.2">
        <h3 id="name-coalesced-packets">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-coalesced-packets" class="section-name selfRef">Coalesced Packets</a>
        </h3>
<p id="section-2.2-1">Multiple QUIC packets may be coalesced into a UDP datagram, with a datagram
carrying one or more long header packets followed by zero or one short header
packets. When packets are coalesced, the Length fields in the long headers are
used to separate QUIC packets. The length header field is variable length and
its position in the header is also variable depending on the length of the
source and destination connection ID. See Section 4.6 of <span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-port-numbers">
<section id="section-2.3">
        <h3 id="name-use-of-port-numbers">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-use-of-port-numbers" class="section-name selfRef">Use of Port Numbers</a>
        </h3>
<p id="section-2.3-1">Applications that have a mapping for TCP as well as QUIC are expected to
use the same port number for both services. However, as with
TCP-based services, especially when application layer information is
encrypted, there is no guarantee that a specific application will use the
registered port, or the used port is carrying traffic belonging to the
respective registered service. For example, <span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span> specifies
the use of Alt-Svc for discovery of QUIC/HTTP services on other ports.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">Further, as QUIC has a connection ID, it is also possible to maintain multiple
QUIC connections over one 5-tuple. However, if the connection ID is not present
in the packet header, all packets of the 5-tuple belong to the same QUIC
connection.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="handshake">
<section id="section-2.4">
        <h3 id="name-the-quic-handshake">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-the-quic-handshake" class="section-name selfRef">The QUIC handshake</a>
        </h3>
<p id="section-2.4-1">New QUIC connections are established using a handshake, which is distinguishable
on the wire and contains some information that can be passively observed.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">To illustrate the information visible in the QUIC wire image during the
handshake, we first show the general communication pattern visible in the UDP
datagrams containing the QUIC handshake, then examine each of the datagrams in
detail.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">In the nominal case, the QUIC handshake can be recognized on the wire through at
least four datagrams we'll call "QUIC Client Hello", "QUIC Server Hello", and
"Initial Completion", and "Handshake Completion", for purposes of this
illustration, as shown in <a href="#fig-handshake" class="xref">Figure 1</a>.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.4-4">Packets in the handshake belong to three separate cryptographic and transport
contexts ("Initial", which contains observable payload, and "Handshake" and
"1-RTT", which do not). QUIC packets in separate contexts during the handshake
are generally coalesced (see <a href="#coalesced" class="xref">Section 2.2</a>) in order to reduce the number of UDP
datagrams sent during the handshake.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<p id="section-2.4-5">As shown here, the client can send 0-RTT data as soon as it has sent its Client
Hello, and the server can send 1-RTT data as soon as it has sent its Server
Hello.<a href="#section-2.4-5" class="pilcrow">¶</a></p>
<span id="name-general-communication-patte"></span><div id="fig-handshake">
<figure id="figure-1">
          <div class="artwork art-text alignLeft" id="section-2.4-6.1">
<pre>
Client                                    Server
  |                                          |
  +----QUIC Client Hello--------------------&gt;|
  +----(zero or more 0RTT)------------------&gt;|
  |                                          |
  |&lt;--------------------QUIC Server Hello----+
  |&lt;---------(1RTT encrypted data starts)----+
  |                                          |
  +----Initial Completion-------------------&gt;|
  +----(1RTT encrypted data starts)---------&gt;|
  |                                          |
  |&lt;-----------------Handshake Completion----+
  |                                          |
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-general-communication-patte" class="selfRef">General communication pattern visible in the QUIC handshake</a>
          </figcaption></figure>
</div>
<p id="section-2.4-7">A typical handshake starts with the client sending of a QUIC Client Hello
datagram as shown in <a href="#fig-client-hello" class="xref">Figure 2</a>, which elicits a QUIC Server Hello
datagram as shown in <a href="#fig-server-hello" class="xref">Figure 3</a> typically containing three packets:
an Initial packet with the Server Hello, a Handshake packet with the rest of
the server's side of the TLS handshake, and initial 1-RTT data, if present.<a href="#section-2.4-7" class="pilcrow">¶</a></p>
<p id="section-2.4-8">The content of QUIC Initial packets are encrypted using Initial Secrets, which
are derived from a per-version constant and the client's destination connection
ID; they are therefore observable by any on-path device that knows the
per-version constant; we therefore consider these as visible in our
illustration. The content of QUIC Handshake packets are encrypted using keys
established during the initial handshake exchange, and are therefore not
visible.<a href="#section-2.4-8" class="pilcrow">¶</a></p>
<p id="section-2.4-9">Initial, Handshake, and the Short Header packets transmitted after the handshake
belong to cryptographic and transport contexts. The Initial Completion
<a href="#fig-init-complete" class="xref">Figure 4</a> and the Handshake Completion <a href="#fig-hs-complete" class="xref">Figure 5</a> datagrams
finish these first two contexts, by sending the final acknowledgment and
finishing the transmission of CRYPTO frames.<a href="#section-2.4-9" class="pilcrow">¶</a></p>
<span id="name-typical-1-rtt-quic-client-h"></span><div id="fig-client-hello">
<figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-2.4-10.1">
<pre>
+----------------------------------------------------------+
| UDP header (source and destination UDP ports)            |
+----------------------------------------------------------+
| QUIC long header (type = Initial, Version, DCID, SCID) (Length)
+----------------------------------------------------------+  |
| QUIC CRYPTO frame header                                 |  |
+----------------------------------------------------------+  |
| TLS Client Hello (incl. TLS SNI)                         |  |
+----------------------------------------------------------+  |
| QUIC PADDING frame                                       |  |
+----------------------------------------------------------+&lt;-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-typical-1-rtt-quic-client-h" class="selfRef">Typical 1-RTT QUIC Client Hello datagram pattern</a>
          </figcaption></figure>
</div>
<p id="section-2.4-11">The Client Hello datagram exposes version number, source and destination
connection IDs, and information in the TLS Client Hello message, including any
TLS Server Name Indication (SNI) present, in the clear. The QUIC PADDING frame
shown here may be present to ensure the Client Hello datagram has a minimum size
of 1200 octets, to mitigate the possibility of handshake amplification. Note
that the location of PADDING is implementation-dependent, and PADDING frames may
not appear in the Initial packet in a coalesced packet.<a href="#section-2.4-11" class="pilcrow">¶</a></p>
<span id="name-typical-quic-server-hello-d"></span><div id="fig-server-hello">
<figure id="figure-3">
          <div class="artwork art-text alignLeft" id="section-2.4-12.1">
<pre>
+------------------------------------------------------------+
| UDP header (source and destination UDP ports)              |
+------------------------------------------------------------+
| QUIC long header (type = Initial, Version, DCID, SCID)   (Length)
+------------------------------------------------------------+  |
| QUIC CRYPTO frame header                                   |  |
+------------------------------------------------------------+  |
| TLS Server Hello                                           |  |
+------------------------------------------------------------+  |
| QUIC ACK frame (acknowledging client hello)                |  |
+------------------------------------------------------------+&lt;-+
| QUIC long header (type = Handshake, Version, DCID, SCID) (Length)
+------------------------------------------------------------+  |
| encrypted payload (presumably CRYPTO frames)               |  |
+------------------------------------------------------------+&lt;-+
| QUIC short header                                          |
+------------------------------------------------------------+
| 1-RTT encrypted payload                                    |
+------------------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-typical-quic-server-hello-d" class="selfRef">Typical QUIC Server Hello datagram pattern</a>
          </figcaption></figure>
</div>
<p id="section-2.4-13">The Server Hello datagram exposes version number, source and destination
connection IDs, and information in the TLS Server Hello message.<a href="#section-2.4-13" class="pilcrow">¶</a></p>
<span id="name-typical-quic-initial-comple"></span><div id="fig-init-complete">
<figure id="figure-4">
          <div class="artwork art-text alignLeft" id="section-2.4-14.1">
<pre>
+------------------------------------------------------------+
| UDP header (source and destination UDP ports)              |
+------------------------------------------------------------+
| QUIC long header (type = Initial, Version, DCID, SCID)   (Length)
+------------------------------------------------------------+  |
| QUIC ACK frame (acknowledging Server Hello Initial)        |  |
+------------------------------------------------------------+&lt;-+
| QUIC long header (type = Handshake, Version, DCID, SCID) (Length)
+------------------------------------------------------------+  |
| encrypted payload (presumably CRYPTO/ACK frames)           |  |
+------------------------------------------------------------+&lt;-+
| QUIC short header                                          |
+------------------------------------------------------------+
| 1-RTT encrypted payload                                    |
+------------------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-typical-quic-initial-comple" class="selfRef">Typical QUIC Initial Completion datagram pattern</a>
          </figcaption></figure>
</div>
<p id="section-2.4-15">The Initial Completion datagram does not expose any additional information;
however, recognizing it can be used to determine that a handshake has completed
(see <a href="#sec-confirm" class="xref">Section 3.2</a>), and for three-way handshake RTT estimation as in
<a href="#sec-rtt" class="xref">Section 3.7</a>.<a href="#section-2.4-15" class="pilcrow">¶</a></p>
<span id="name-typical-quic-handshake-comp"></span><div id="fig-hs-complete">
<figure id="figure-5">
          <div class="artwork art-text alignLeft" id="section-2.4-16.1">
<pre>
+------------------------------------------------------------+
| UDP header (source and destination UDP ports)              |
+------------------------------------------------------------+
| QUIC long header (type = Handshake, Version, DCID, SCID) (Length)
+------------------------------------------------------------+  |
| encrypted payload (presumably ACK frame)                   |  |
+------------------------------------------------------------+&lt;-+
| QUIC short header                                          |
+------------------------------------------------------------+
| 1-RTT encrypted payload                                    |
+------------------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-typical-quic-handshake-comp" class="selfRef">Typical QUIC Handshake Completion datagram pattern</a>
          </figcaption></figure>
</div>
<p id="section-2.4-17">Similar to Initial Completion, Handshake Completion also exposes no additional
information; observing it serves only to determine that the handshake has
completed.<a href="#section-2.4-17" class="pilcrow">¶</a></p>
<p id="section-2.4-18">When the client uses 0-RTT connection resumption, 0-RTT data may also be
seen in the QUIC Client Hello datagram, as shown in <a href="#fig-client-hello-0rtt" class="xref">Figure 6</a>.<a href="#section-2.4-18" class="pilcrow">¶</a></p>
<span id="name-typical-0-rtt-quic-client-h"></span><div id="fig-client-hello-0rtt">
<figure id="figure-6">
          <div class="artwork art-text alignLeft" id="section-2.4-19.1">
<pre>
+----------------------------------------------------------+
| UDP header (source and destination UDP ports)            |
+----------------------------------------------------------+
| QUIC long header (type = Initial, Version, DCID, SCID) (Length)
+----------------------------------------------------------+  |
| QUIC CRYPTO frame header                                 |  |
+----------------------------------------------------------+  |
| TLS Client Hello (incl. TLS SNI)                         |  |
+----------------------------------------------------------+&lt;-+
| QUIC long header (type = 0RTT, Version, DCID, SCID)    (Length)
+----------------------------------------------------------+  |
| 0-rtt encrypted payload                                  |  |
+----------------------------------------------------------+&lt;-+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-typical-0-rtt-quic-client-h" class="selfRef">Typical 0-RTT QUIC Client Hello datagram pattern</a>
          </figcaption></figure>
</div>
<p id="section-2.4-20">In a 0-RTT QUIC Client Hello datagram, the PADDING frame is only present if
necessary to increase the size of the datagram with 0RTT data to at least 1200
bytes. Additional datagrams containing only 0-RTT protected long header packets
may be sent from the client to the server after the Client Hello datagram,
containing the rest of the 0-RTT data. The amount of 0-RTT protected data is
limited by the initial congestion window, typically around 10 packets
<span>[<a href="#RFC6928" class="xref">RFC6928</a>]</span>.<a href="#section-2.4-20" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wire-integrity">
<section id="section-2.5">
        <h3 id="name-integrity-protection-of-the">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-integrity-protection-of-the" class="section-name selfRef">Integrity Protection of the Wire Image</a>
        </h3>
<p id="section-2.5-1">As soon as the cryptographic context is established, all information in the QUIC
header, including information exposed in the packet header, is integrity
protected. Further, information that was sent and exposed in handshake packets
sent before the cryptographic context was established are validated later during
the cryptographic handshake.  Therefore, devices on path MUST NOT change any
information or bits in QUIC packet headers, since alteration of header
information will lead to a failed integrity check at the receiver, and can even
lead to connection termination.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rebinding">
<section id="section-2.6">
        <h3 id="name-connection-id-and-rebinding">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-connection-id-and-rebinding" class="section-name selfRef">Connection ID and Rebinding</a>
        </h3>
<p id="section-2.6-1">The connection ID in the QUIC packet headers allows routing of QUIC packets at
load balancers on other than five-tuple information, ensuring that related
flows are appropriately balanced together; and to allow rebinding of a
connection after one of the endpoint's addresses changes - usually the
client's, in the case of the HTTP binding. Client and server negotiate
connection IDs during the handshake; typically, however, only the server will
request a connection ID for the lifetime of the connection. Connection IDs for
either endpoint may change during the lifetime of a connection, with the new
connection ID being negotiated via encrypted frames. See Section 5.1 of
<span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span>.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="packetnumber">
<section id="section-2.7">
        <h3 id="name-packet-numbers">
<a href="#section-2.7" class="section-number selfRef">2.7. </a><a href="#name-packet-numbers" class="section-name selfRef">Packet Numbers</a>
        </h3>
<p id="section-2.7-1">The packet number field is always present in the QUIC packet header; however,
it is always encrypted. The encryption key for packet number protection on
handshake packets sent before cryptographic context establishment is specific
to the QUIC version, while packet number protection on subsequent packets uses
secrets derived from the end-to-end cryptographic context. Packet numbers are
therefore not part of the wire image that is visible to on-path observers.<a href="#section-2.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="version">
<section id="section-2.8">
        <h3 id="name-version-negotiation-and-gre">
<a href="#section-2.8" class="section-number selfRef">2.8. </a><a href="#name-version-negotiation-and-gre" class="section-name selfRef">Version Negotiation and Greasing</a>
        </h3>
<p id="section-2.8-1">Version negotiation is not protected, given the used protection mechanism can
change with the version.  However, the choices provided in the list of version
in the Version Negotiation packet will be validated as soon as the cryptographic
context has been established. Therefore any manipulation of this list will be
detected and will cause the endpoints to terminate the connection.<a href="#section-2.8-1" class="pilcrow">¶</a></p>
<p id="section-2.8-2">Also note that the list of versions in the Version Negotiation packet may
contain reserved versions. This mechanism is used to avoid ossification in the
implementation on the selection mechanism. Further, a client may send a Initial
Client packet with a reserved version number to trigger version negotiation. In
the Version Negotiation packet the connection ID and packet number of the Client
Initial packet are reflected to provide a proof of return-routability. Therefore
changing these information will also cause the connection to fail.<a href="#section-2.8-2" class="pilcrow">¶</a></p>
<p id="section-2.8-3">QUIC is expected to evolve rapidly, so new versions, both experimental and IETF
standard versions, will be deployed in the Internet more often than with
traditional Internet- and transport-layer protocols. Using a particular version
number to recognize valid QUIC traffic is likely to persistently miss a fraction
of QUIC flows and completely fail in the multi-year timeframe so therefore not
recommended.<a href="#section-2.8-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="network-visible-information-about-quic-flows">
<section id="section-3">
      <h2 id="name-network-visible-information">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-network-visible-information" class="section-name selfRef">Network-visible information about QUIC flows</a>
      </h2>
<p id="section-3-1">This section addresses the different kinds of observations and inferences that
can be made about QUIC flows by a passive observer in the network based on the
wire image in <a href="#sec-wire-image" class="xref">Section 2</a>. Here we assume a bidirectional observer (one
that can see packets in both directions in the sequence in which they are
carried on the wire) unless noted.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="sec-identifying">
<section id="section-3.1">
        <h3 id="name-identifying-quic-traffic">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-identifying-quic-traffic" class="section-name selfRef">Identifying QUIC traffic</a>
        </h3>
<p id="section-3.1-1">The QUIC wire image is not specifically designed to be distinguishable from
other UDP traffic.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The only application binding defined by the IETF QUIC WG is HTTP/3
<span>[<a href="#QUIC-HTTP" class="xref">QUIC-HTTP</a>]</span> at the time of this writing; however, many other applications
are currently being defined and deployed over QUIC, so an assumption that all
QUIC traffic is HTTP/3 is not valid. HTTP over QUIC uses UDP port 443 by
default, although URLs referring to resources available over HTTP over QUIC
may specify alternate port numbers. Simple assumptions about whether a
given flow is using QUIC based upon a UDP port number may therefore not hold;
see also <span>[<a href="#RFC7605" class="xref">RFC7605</a>]</span> section 5.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">While the second most significant bit (0x40) of the first octet is set to
1 in most QUIC packets of the current version (see <a href="#public-header" class="xref">Section 2.1</a>),
this method of recognizing QUIC traffic is NOT RECOMMENDED. First, it only
provides one bit of information and is quite prone to collide with
UDP-based protocols other than those that this static bit is meant to allow
multiplexing with. Second, this feature of the wire image is not invariant
<span>[<a href="#QUIC-INVARIANTS" class="xref">QUIC-INVARIANTS</a>]</span> and may change in future versions of the protocol, or
even be negotiated after handshake via future transport parameters.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<div id="identifying-negotiated-version">
<section id="section-3.1.1">
          <h4 id="name-identifying-negotiated-vers">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-identifying-negotiated-vers" class="section-name selfRef">Identifying Negotiated Version</a>
          </h4>
<p id="section-3.1.1-1">An in-network observer assuming that a set of packets belongs to a QUIC flow
can infer the version number in use by observing the handshake: an Initial
packet with a given version from a client to which a server responds with an
Initial packet with the same version implies acceptance of that version.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">Negotiated version cannot be identified for flows for which a handshake is not
observed, such as in the case of connection migration; however, these flows can
be associated with flows for which a version has been identified; see
<a href="#sec-flow-association" class="xref">Section 3.4</a>.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1-3">This document focuses on QUIC Version 1, and this section applies only to
packets belonging to Version 1 QUIC flows; for purposes of on-path observation,
it assumes that these packets have been identified as such through the
observation of a version negotiation.<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-garbage">
<section id="section-3.1.2">
          <h4 id="name-rejection-of-garbage-traffi">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-rejection-of-garbage-traffi" class="section-name selfRef">Rejection of Garbage Traffic</a>
          </h4>
<p id="section-3.1.2-1">A related question is whether a first packet of a given flow on known
QUIC-associated port is a valid QUIC packet, in order to support in-network
filtering of garbage UDP packets (reflection attacks, random backscatter). While
heuristics based on the first byte of the packet (packet type) could be used to
separate valid from invalid first packet types, the deployment of such
heuristics is not recommended, as packet types may have different meanings in
future versions of the protocol.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-confirm">
<section id="section-3.2">
        <h3 id="name-connection-confirmation">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-connection-confirmation" class="section-name selfRef">Connection confirmation</a>
        </h3>
<p id="section-3.2-1">Connection establishment uses Initial, Handshake, and Retry packets containing a
TLS handshake. Connection establishment can therefore be detected using
heuristics similar to those used to detect TLS over TCP. A client using 0-RTT
connection may also send data packets in 0-RTT Protected packets directly after
the Initial packet containing the TLS Client Hello. Since these packets may be
reordered in the network, note that 0-RTT Protected data packets may be seen
before the Initial packet.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Note that clients send Initial packets before servers do, servers send Handshake
packets before  clients do, and only clients send Initial packets with tokens,
so the sides of a connection can be generally be confirmed by an on-path
observer. An attempted connection after Retry can be detected by correlating the
token on the Retry with the token on the subsequent Initial packet.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-server">
<section id="section-3.3">
        <h3 id="name-application-identification">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-application-identification" class="section-name selfRef">Application Identification</a>
        </h3>
<p id="section-3.3-1">The cleartext TLS handshake may contain Server Name Indication (SNI)
<span>[<a href="#RFC6066" class="xref">RFC6066</a>]</span>, by which the client reveals the name of the server it intends to
connect to, in order to allow the server to present a certificate based on
that name. It may also contain information from Application-Layer Protocol
Negotiation (ALPN) <span>[<a href="#RFC7301" class="xref">RFC7301</a>]</span>, by which the client exposes the names of
application-layer protocols it supports; an observer can deduce that one of
those protocols will be used if the connection continues.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Work is currently underway in the TLS working group to encrypt the SNI in TLS
1.3 <span>[<a href="#TLS-ESNI" class="xref">TLS-ESNI</a>]</span>. If used with QUIC, this
would make SNI-based application identification impossible through passive
measurement.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-flow-association">
<section id="section-3.4">
        <h3 id="name-flow-association">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-flow-association" class="section-name selfRef">Flow association</a>
        </h3>
<p id="section-3.4-1">The QUIC Connection ID (see <a href="#rebinding" class="xref">Section 2.6</a>) is designed to allow an on-path
device such as a load-balancer to associate two flows as identified by
five-tuple when the address and port of one of the endpoints changes; e.g. due
to NAT rebinding or server IP address migration. An observer keeping flow state
can associate a connection ID with a given flow, and can associate a known flow
with a new flow when when observing a packet sharing a connection ID and one
endpoint address (IP address and port) with the known flow.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">However, since the connection ID may change multiple times during the lifetime
of a flow, and the negotiation of connection ID changes is encrypted, packets
with the same 5-tuple but different connection IDs may or may not belong to the
same connection.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">The connection ID value should be treated as opaque; see <a href="#sec-loadbalancing" class="xref">Section 4.3</a>
for caveats regarding connection ID selection at servers.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-teardown">
<section id="section-3.5">
        <h3 id="name-flow-teardown">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-flow-teardown" class="section-name selfRef">Flow teardown</a>
        </h3>
<p id="section-3.5-1">QUIC does not expose the end of a connection; the only indication to on-path
devices that a flow has ended is that packets are no longer observed. Stateful
devices on path such as NATs and firewalls must therefore use idle timeouts to
determine when to drop state for QUIC flows, see further section
<a href="#sec-stateful" class="xref">Section 4.1</a>.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-symmetry">
<section id="section-3.6">
        <h3 id="name-flow-symmetry-measurement">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-flow-symmetry-measurement" class="section-name selfRef">Flow symmetry measurement</a>
        </h3>
<p id="section-3.6-1">QUIC explicitly exposes which side of a connection is a client and which side is
a server during the handshake. In addition, the symmetry of a flow (whether
primarily client-to-server, primarily server-to-client, or roughly
bidirectional, as input to basic traffic classification techniques) can be
inferred through the measurement of data rate in each direction. While QUIC
traffic is protected and ACKs may be padded, padding is not required.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-rtt">
<section id="section-3.7">
        <h3 id="name-round-trip-time-rtt-measure">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-round-trip-time-rtt-measure" class="section-name selfRef">Round-Trip Time (RTT) Measurement</a>
        </h3>
<p id="section-3.7-1">Round-trip time of QUIC flows can be inferred by observation once per flow,
during the handshake, as in passive TCP measurement; this requires parsing of
the QUIC packet header and recognition of the handshake, as illustrated in
<a href="#handshake" class="xref">Section 2.4</a>. It can also be inferred during the flow's lifetime, if the
endpoints use the spin bit facility described below and in
<span>[<a href="#QUIC-TRANSPORT" class="xref">QUIC-TRANSPORT</a>]</span>, section 17.3.1.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<div id="measuring-initial-rtt">
<section id="section-3.7.1">
          <h4 id="name-measuring-initial-rtt">
<a href="#section-3.7.1" class="section-number selfRef">3.7.1. </a><a href="#name-measuring-initial-rtt" class="section-name selfRef">Measuring initial RTT</a>
          </h4>
<p id="section-3.7.1-1">In the common case, the delay between the Initial packet containing the TLS
Client Hello and the Handshake packet containing the TLS Server Hello
represents the RTT component on the path between the observer and the server.
The delay between the TLS Server Hello and the Handshake packet containing the
TLS Finished message sent by the client represents the RTT component on the
path between the observer and the client. While the client may send 0-RTT
Protected packets after the Initial packet during 0-RTT connection
re-establishment, these can be ignored for RTT measurement purposes.<a href="#section-3.7.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.1-2">Handshake RTT can be measured by adding the client-to-observer and
observer-to-server RTT components together. This measurement necessarily
includes any transport and application layer delay (the latter mainly
caused by the asymmetric crypto operations associated with the TLS
handshake) at both sides.<a href="#section-3.7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spin-usage">
<section id="section-3.7.2">
          <h4 id="name-using-the-spin-bit-for-pass">
<a href="#section-3.7.2" class="section-number selfRef">3.7.2. </a><a href="#name-using-the-spin-bit-for-pass" class="section-name selfRef">Using the Spin Bit for Passive RTT Measurement</a>
          </h4>
<p id="section-3.7.2-1">The spin bit provides an additional method to measure per-flow RTT from
observation points on the network path throughout the duration of a connection.
Endpoint participation in spin bit signaling is optional in QUIC. That is, while
its location is fixed in this version of QUIC, an endpoint can unilaterally
choose to not support "spinning" the bit. Use of the spin bit for RTT
measurement by devices on path is only possible when both endpoints enable it.
Some endpoints may disable use of the spin bit by default, others only in
specific deployment scenarios, e.g. for servers and clients where the RTT would
reveal the presence of a VPN or proxy. To avoid making these connections
identifiable based on the usage of the spin bit, it is recommended that all
endpoints randomly disable "spinning" for at least one eighth of connections,
even if otherwise enabled by default. An endpoint not participating in spin bit
signaling for a given connection can use a fixed spin value for the duration of
the connection, or can set the bit randomly on each packet sent.<a href="#section-3.7.2-1" class="pilcrow">¶</a></p>
<p id="section-3.7.2-2">When in use and a QUIC flow sends data continuously, the latency spin bit in
each direction changes value once per round-trip time (RTT). An on-path observer
can observe the time difference between edges (changes from 1 to 0 or 0 to 1) in
the spin bit signal in a single direction to measure one sample of end-to-end
RTT.<a href="#section-3.7.2-2" class="pilcrow">¶</a></p>
<p id="section-3.7.2-3">Note that this measurement, as with passive RTT measurement for TCP, includes
any transport protocol delay (e.g., delayed sending of acknowledgements) and/or
application layer delay (e.g., waiting for a response to be generated). It
therefore provides devices on path a good instantaneous estimate of the RTT as
experienced by the application. A simple linear smoothing or moving minimum
filter can be applied to the stream of RTT information to get a more stable
estimate.<a href="#section-3.7.2-3" class="pilcrow">¶</a></p>
<p id="section-3.7.2-4">However, application-limited and flow-control-limited senders can have
application and transport layer delay, respectively, that are much greater than
network RTT. When the sender is application-limited and e.g. only sends small
amount of periodic application traffic, where that period is longer than the
RTT, measuring the spin bit provides information about the application period,
not the network RTT.<a href="#section-3.7.2-4" class="pilcrow">¶</a></p>
<p id="section-3.7.2-5">Since the spin bit logic at each endpoint considers only samples from packets
that advance the largest packet number, signal generation itself is
resistant to reordering. However, reordering can cause problems at an observer
by causing spurious edge detection and therefore inaccurate (i.e., lower) RTT
estimates, if reordering occurs across a spin-bit flip in the stream.<a href="#section-3.7.2-5" class="pilcrow">¶</a></p>
<p id="section-3.7.2-6">Simple heuristics based on the observed data rate per flow or changes in the RTT
series can be used to reject bad RTT samples due to lost or reordered edges in
the spin signal, as well as application or flow control limitation; for example,
QoF <span>[<a href="#TMA-QOF" class="xref">TMA-QOF</a>]</span> rejects component RTTs significantly higher than RTTs over the
history of the flow. These heuristics may use the handshake RTT as an initial
RTT estimate for a given flow. Usually such heuristics would also detect if
the spin is either constant or randomly set for a connection.<a href="#section-3.7.2-6" class="pilcrow">¶</a></p>
<p id="section-3.7.2-7">An on-path observer that can see traffic in both directions (from client to
server and from server to client) can also use the spin bit to measure
"upstream" and "downstream" component RTT; i.e, the component of the
end-to-end RTT attributable to the paths between the observer and the server
and the observer and the client, respectively. It does this by measuring the
delay between a spin edge observed in the upstream direction and that observed
in the downstream direction, and vice versa.<a href="#section-3.7.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="specific-network-management-tasks">
<section id="section-4">
      <h2 id="name-specific-network-management">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-specific-network-management" class="section-name selfRef">Specific Network Management Tasks</a>
      </h2>
<p id="section-4-1">In this section, we review specific network management and measurement
techniques and how QUIC's design impacts them.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="sec-stateful">
<section id="section-4.1">
        <h3 id="name-stateful-treatment-of-quic-">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-stateful-treatment-of-quic-" class="section-name selfRef">Stateful treatment of QUIC traffic</a>
        </h3>
<p id="section-4.1-1">Stateful treatment of QUIC traffic (e.g., at a firewall or NAT middlebox) is
possible through QUIC traffic and version
identification (<a href="#sec-identifying" class="xref">Section 3.1</a>) and observation of the handshake for
connection confirmation (<a href="#sec-confirm" class="xref">Section 3.2</a>). The lack of any visible end-of-flow
signal (<a href="#sec-teardown" class="xref">Section 3.5</a>) means that this state must be purged either through
timers or through least-recently-used eviction, depending on application
requirements.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2"><span>[<a href="#RFC4787" class="xref">RFC4787</a>]</span> recommends a 2 minute timeout interval for UDP, however,
often timer are lower in the range of 15 to 30 second. In constrast
<span>[<a href="#RFC5382" class="xref">RFC5382</a>]</span> recommends a timeout of more than 2 hours for TCP, given TCP is
a connection-oriented protocol with well defined closure semantics. For network
devices that are QUIC-aware, it is recommended to also use
longer timeouts for QUIC traffic, as QUIC is connection-oriented and as such
a handshake packet from the server indicates the willingness of the server to
communicate with the client.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">The QUIC header optionally contains a Connection ID which can be used as
additional entropy beyond the 5-tuple, if needed. The QUIC handshake needs
to be observed in order to understand whether the Connection ID is present and
what length it has. However, Connection IDs may be renegotiated during
a connection, and this renegotiation is not visible to the path. Keying state
off the Connection ID may therefore cause undetectable and unrecoverable loss
of state in the middle of a connection. Use of Connection ID specifically
discouraged for NAT applications.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="passive-network-performance-measurement-and-troubleshooting">
<section id="section-4.2">
        <h3 id="name-passive-network-performance">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-passive-network-performance" class="section-name selfRef">Passive network performance measurement and troubleshooting</a>
        </h3>
<p id="section-4.2-1">Limited RTT measurement is possible by passive observation of QUIC traffic;
see <a href="#sec-rtt" class="xref">Section 3.7</a>. No passive measurement of loss is possible with the present
wire image. Extremely limited observation of upstream congestion may be
possible via the observation of CE markings on ECN-enabled QUIC traffic.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-loadbalancing">
<section id="section-4.3">
        <h3 id="name-server-cooperation-with-loa">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-server-cooperation-with-loa" class="section-name selfRef">Server cooperation with load balancers</a>
        </h3>
<p id="section-4.3-1">In the case of content distribution networking architectures including load
balancers, the connection ID provides a way for the server to signal information
about the desired treatment of a flow to the load balancers. Guidance on
assigning connection IDs is given in
<span>[<a href="#QUIC-APPLICABILITY" class="xref">QUIC-APPLICABILITY</a>]</span>.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-ddos-dec">
<section id="section-4.4">
        <h3 id="name-ddos-detection-and-mitigati">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-ddos-detection-and-mitigati" class="section-name selfRef">DDoS Detection and Mitigation</a>
        </h3>
<p id="section-4.4-1">Current practices in detection and mitigation of Distributed Denial of Service
(DDoS) attacks generally involves classification of incoming traffic (as
packets, flows, or some other aggregate) into "good" (productive) and "bad"
(DDoS) traffic, then differential treatment of this traffic to forward only
good traffic, to the extent possible. This operation is often done in a separate
specialized mitigation environment through which all traffic is filtered;
a generalized architecture for separation of concerns in mitigation is given in
<span>[<a href="#DOTS-ARCH" class="xref">DOTS-ARCH</a>]</span>.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">Key to successful DDoS mitigation
is efficient classification of this traffic in the mitigation environment.
Limited first-packet garbage detection as in <a href="#sec-garbage" class="xref">Section 3.1.2</a> and stateful
tracking of QUIC traffic as in <a href="#sec-stateful" class="xref">Section 4.1</a> above may be useful during
classification.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">Note that the use of a connection ID to support connection migration renders
5-tuple based filtering insufficient and requires more state to be maintained by
DDoS defense systems. For the common case of NAT rebinding, DDoS defense systems
can detect a change in client's endpoint address by linking flows based on the
first 8 bytes of the server's connection IDs, provided the server is using at
least 8-bytes-long connection IDs. QUIC's linkability resistance ensures that a
deliberate connection migration is accompanied by a change in the connection ID
and necessitate that connection ID aware DDoS defense system must have the same
information about connection IDs as the load balancer
<span>[<a href="#I-D.ietf-quic-load-balancers" class="xref">I-D.ietf-quic-load-balancers</a>]</span>. This may be complicated where mitigation
and load balancing environments are logically separate.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">It is questionable whether connection migrations must be supported during a DDoS
attack. If the connection migration is not visible to the network that performs
the DDoS detection, an active, migrated QUIC connection may be blocked by such a
system under attack. As soon as the connection blocking is detected by the
client, the client may rely on the fast resumption mechanism provided by
QUIC. When clients migrate to a new path, they should be prepared for the
migration to fail and attempt to reconnect quickly.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-udp-1312">
<section id="section-4.5">
        <h3 id="name-udp-policing">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-udp-policing" class="section-name selfRef">UDP Policing</a>
        </h3>
<p id="section-4.5-1">Today, UDP is the most prevalent DDoS vector, since it is easy for compromised
non-admin applications to send a flood of large UDP packets (while with TCP the
attacker gets throttled by the congestion controller) or to craft reflection and
amplification attacks. Networks should therefore be
prepared for UDP flood attacks on ports used for QUIC traffic. One possible
response to this threat is to police UDP traffic on the network, allocating a
fixed portion of the network capacity to UDP and blocking UDP datagram over that
cap.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">The recommended way to police QUIC
packets is to either drop them all or to throttle them based on the hash of the
UDP datagram's source and destination addresses, blocking a portion of the hash
space that corresponds to the fraction of UDP traffic one wishes to drop.
When the handshake is blocked, QUIC-capable applications may failover to TCP
(at least applications using well-known UDP ports). However, blindly blocking a
significant fraction of QUIC packets will allow many QUIC handshakes
to complete, preventing a TCP failover, but the connections will suffer from
severe packet loss.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="distinguishing-acknowledgment-traffic">
<section id="section-4.6">
        <h3 id="name-distinguishing-acknowledgme">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-distinguishing-acknowledgme" class="section-name selfRef">Distinguishing acknowledgment traffic</a>
        </h3>
<p id="section-4.6-1">Some deployed in-network functions distinguish pure-acknowledgment (ACK) packets
from packets carrying upper-layer data in order to attempt to enhance
performance, for example by queueing ACKs differently or manipulating ACK
signaling. Distinguishing ACK packets is trivial in TCP, but not supported by
QUIC, since acknowledgment signaling is carried inside QUIC's encrypted payload,
and ACK manipulation is impossible. Specifically, heuristics attempting to
distinguish ACK-only packets from payload-carrying packets based on packet size
are likely to fail, and are emphatically NOT RECOMMENDED.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="qos-support-and-ecmp">
<section id="section-4.7">
        <h3 id="name-qos-support-and-ecmp">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-qos-support-and-ecmp" class="section-name selfRef">QoS support and ECMP</a>
        </h3>
<p id="section-4.7-1">[EDITOR'S NOTE: this is a bit speculative; keep?]<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">QUIC does not provide any additional information on requirements on Quality of
Service (QoS) provided from the network. QUIC assumes that all packets with the
same 5-tuple {dest addr, source addr, protocol, dest port, source port} will
receive similar network treatment.  That means all stream that are multiplexed
over the same QUIC connection require the same network treatment and are handled
by the same congestion controller. If differential network treatment is desired,
multiple QUIC connections to the same server might be used, given that
establishing a new connection using 0-RTT support is cheap and fast.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">QoS mechanisms in the network MAY also use the connection ID for service
differentiation, as a change of connection ID is bound to a change of address
which anyway is likely to lead to a re-route on a different path with different
network characteristics.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<p id="section-4.7-4">Given that QUIC is more tolerant of packet re-ordering than TCP (see
<a href="#packetnumber" class="xref">Section 2.7</a>), Equal-cost multi-path routing (ECMP) does not necessarily
need to be flow based.  However, 5-tuple (plus eventually connection ID if
present) matching is still beneficial for QoS given all packets are handled by
the same congestion controller.<a href="#section-4.7-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document has no actions for IANA.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">Supporting manageability of QUIC traffic inherently involves tradeoffs with the
confidentiality of QUIC's control information; this entire document is therefore
security-relevant.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="section-7">
      <h2 id="name-contributors">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-7-1">Dan Druta contributed text to <a href="#sec-ddos-dec" class="xref">Section 4.4</a>. Igor Lubashev contributed text
to <a href="#sec-loadbalancing" class="xref">Section 4.3</a> on the use of the connection ID for load balancing.
Marcus Ilhar contributed text to <a href="#sec-rtt" class="xref">Section 3.7</a> on the use of the spin bit.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="section-8">
      <h2 id="name-acknowledgments">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-8-1">This work is partially supported by the European Commission under Horizon 2020
grant agreement no. 688421 Measurement and Architecture for a Middleboxed
Internet (MAMI), and by the Swiss State Secretariat for Education, Research, and
Innovation under contract no. 15.0268. This support does not imply endorsement.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Ding2015">[Ding2015]</dt>
        <dd>
<span class="refAuthor">Ding, H.</span><span class="refAuthor"> and M. Rabinovich</span>, <span class="refTitle">"TCP Stretch Acknowledgments and Timestamps - Findings and Impliciations for Passive RTT Measurement (ACM Computer Communication Review)"</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="http://www.sigcomm.org/sites/default/files/ccr/papers/2015/July/0000000-0000002.pdf">http://www.sigcomm.org/sites/default/files/ccr/papers/2015/July/0000000-0000002.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DOTS-ARCH">[DOTS-ARCH]</dt>
        <dd>
<span class="refAuthor">Mortensen, A.</span><span class="refAuthor">, Reddy.K, T.</span><span class="refAuthor">, Andreasen, F.</span><span class="refAuthor">, Teague, N.</span><span class="refAuthor">, and R. Compton</span>, <span class="refTitle">"Distributed-Denial-of-Service Open Threat Signaling (DOTS) Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dots-architecture-18</span>, <time datetime="2020-03-06" class="refDate">6 March 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dots-architecture-18.txt">http://www.ietf.org/internet-drafts/draft-ietf-dots-architecture-18.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-quic-load-balancers">[I-D.ietf-quic-load-balancers]</dt>
        <dd>
<span class="refAuthor">Duke, M.</span><span class="refAuthor"> and N. Banks</span>, <span class="refTitle">"QUIC-LB: Generating Routable QUIC Connection IDs"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-load-balancers-02</span>, <time datetime="2020-03-09" class="refDate">9 March 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-quic-load-balancers-02.txt">http://www.ietf.org/internet-drafts/draft-ietf-quic-load-balancers-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IPIM">[IPIM]</dt>
        <dd>
<span class="refAuthor">Allman, M.</span><span class="refAuthor">, Beverly, R.</span><span class="refAuthor">, and B. Trammell</span>, <span class="refTitle">"In-Protocol Internet Measurement (arXiv preprint 1612.02902)"</span>, <time datetime="2016-12-09" class="refDate">9 December 2016</time>, <span>&lt;<a href="https://arxiv.org/abs/1612.02902">https://arxiv.org/abs/1612.02902</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-APPLICABILITY">[QUIC-APPLICABILITY]</dt>
        <dd>
<span class="refAuthor">Kuehlewind, M.</span><span class="refAuthor"> and B. Trammell</span>, <span class="refTitle">"Applicability of the QUIC Transport Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-applicability-06</span>, <time datetime="2020-01-06" class="refDate">6 January 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-quic-applicability-06.txt">http://www.ietf.org/internet-drafts/draft-ietf-quic-applicability-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-HTTP">[QUIC-HTTP]</dt>
        <dd>
<span class="refAuthor">Bishop, M.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 3 (HTTP/3)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-http-29</span>, <time datetime="2020-06-09" class="refDate">9 June 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-quic-http-29.txt">http://www.ietf.org/internet-drafts/draft-ietf-quic-http-29.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-INVARIANTS">[QUIC-INVARIANTS]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span>, <span class="refTitle">"Version-Independent Properties of QUIC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-invariants-09</span>, <time datetime="2020-06-09" class="refDate">9 June 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-quic-invariants-09.txt">http://www.ietf.org/internet-drafts/draft-ietf-quic-invariants-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-TLS">[QUIC-TLS]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span><span class="refAuthor"> and S. Turner</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-tls-29</span>, <time datetime="2020-06-09" class="refDate">9 June 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-quic-tls-29.txt">http://www.ietf.org/internet-drafts/draft-ietf-quic-tls-29.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-TRANSPORT">[QUIC-TRANSPORT]</dt>
        <dd>
<span class="refAuthor">Iyengar, J.</span><span class="refAuthor"> and M. Thomson</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-transport-29</span>, <time datetime="2020-06-09" class="refDate">9 June 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-quic-transport-29.txt">http://www.ietf.org/internet-drafts/draft-ietf-quic-transport-29.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4787">[RFC4787]</dt>
        <dd>
<span class="refAuthor">Audet, F., Ed.</span><span class="refAuthor"> and C. Jennings</span>, <span class="refTitle">"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"</span>, <span class="seriesInfo">BCP 127</span>, <span class="seriesInfo">RFC 4787</span>, <span class="seriesInfo">DOI 10.17487/RFC4787</span>, <time datetime="2007-01" class="refDate">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4787">https://www.rfc-editor.org/info/rfc4787</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5382">[RFC5382]</dt>
        <dd>
<span class="refAuthor">Guha, S., Ed.</span><span class="refAuthor">, Biswas, K.</span><span class="refAuthor">, Ford, B.</span><span class="refAuthor">, Sivakumar, S.</span><span class="refAuthor">, and P. Srisuresh</span>, <span class="refTitle">"NAT Behavioral Requirements for TCP"</span>, <span class="seriesInfo">BCP 142</span>, <span class="seriesInfo">RFC 5382</span>, <span class="seriesInfo">DOI 10.17487/RFC5382</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5382">https://www.rfc-editor.org/info/rfc5382</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6066">https://www.rfc-editor.org/info/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6928">[RFC6928]</dt>
        <dd>
<span class="refAuthor">Chu, J.</span><span class="refAuthor">, Dukkipati, N.</span><span class="refAuthor">, Cheng, Y.</span><span class="refAuthor">, and M. Mathis</span>, <span class="refTitle">"Increasing TCP's Initial Window"</span>, <span class="seriesInfo">RFC 6928</span>, <span class="seriesInfo">DOI 10.17487/RFC6928</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6928">https://www.rfc-editor.org/info/rfc6928</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7301">[RFC7301]</dt>
        <dd>
<span class="refAuthor">Friedl, S.</span><span class="refAuthor">, Popov, A.</span><span class="refAuthor">, Langley, A.</span><span class="refAuthor">, and E. Stephan</span>, <span class="refTitle">"Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension"</span>, <span class="seriesInfo">RFC 7301</span>, <span class="seriesInfo">DOI 10.17487/RFC7301</span>, <time datetime="2014-07" class="refDate">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7301">https://www.rfc-editor.org/info/rfc7301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7605">[RFC7605]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"Recommendations on Using Assigned Transport Port Numbers"</span>, <span class="seriesInfo">BCP 165</span>, <span class="seriesInfo">RFC 7605</span>, <span class="seriesInfo">DOI 10.17487/RFC7605</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7605">https://www.rfc-editor.org/info/rfc7605</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS-ESNI">[TLS-ESNI]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor">, Oku, K.</span><span class="refAuthor">, Sullivan, N.</span><span class="refAuthor">, and C. Wood</span>, <span class="refTitle">"TLS Encrypted Client Hello"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-esni-07</span>, <time datetime="2020-06-01" class="refDate">1 June 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-esni-07.txt">http://www.ietf.org/internet-drafts/draft-ietf-tls-esni-07.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TMA-QOF">[TMA-QOF]</dt>
        <dd>
<span class="refAuthor">Trammell, B.</span><span class="refAuthor">, Gugelmann, D.</span><span class="refAuthor">, and N. Brownlee</span>, <span class="refTitle">"Inline Data Integrity Signals for Passive Measurement (in Proc. TMA 2014)"</span>, <time datetime="2014-04" class="refDate">April 2014</time>. </dd>
<dd class="break"></dd>
<dt id="WIRE-IMAGE">[WIRE-IMAGE]</dt>
      <dd>
<span class="refAuthor">Trammell, B.</span><span class="refAuthor"> and M. Kuehlewind</span>, <span class="refTitle">"The Wire Image of a Network Protocol"</span>, <span class="seriesInfo">RFC 8546</span>, <span class="seriesInfo">DOI 10.17487/RFC8546</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8546">https://www.rfc-editor.org/info/rfc8546</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mirja Kuehlewind</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mirja.kuehlewind@ericsson.com" class="email">mirja.kuehlewind@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Brian Trammell</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div dir="auto" class="left"><span class="street-address">Gustav-Gull-Platz 1</span></div>
<div dir="auto" class="left">CH- <span class="locality">8004 Zurich</span>
</div>
<div dir="auto" class="left"><span class="country-name">Switzerland</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@trammell.ch" class="email">ietf@trammell.ch</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
