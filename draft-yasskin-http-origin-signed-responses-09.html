<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Signed HTTP Exchanges</title>
<meta content="Jeffrey Yasskin" name="author">
<meta content="
       This document specifies how a server can send an HTTP exchange--a request
URL, content negotiation information, and a response--with signatures that
vouch for that exchange's
authenticity. These signatures can be verified against an origin's certificate
to establish that the exchange is authoritative for an origin even if it was
transferred over a connection that isn't. The signatures can also be used in
other ways described in the appendices. 
       These signatures contain countermeasures against downgrade and
protocol-confusion attacks. 
    " name="description">
<meta content="xml2rfc 2.47.0" name="generator">
<meta content="draft-yasskin-http-origin-signed-responses-09" name="ietf.draft">
<link href="/tmp/draft-yasskin-http-origin-signed-responses-09-guxfdvga.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Signed HTTP Exchanges</td>
<td class="right">July 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Yasskin</td>
<td class="center">Expires 28 January 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-yasskin-http-origin-signed-responses-09</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-07-27" class="published">27 July 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-01-28">28 January 2021</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Yasskin</div>
<div class="org">Google</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Signed HTTP Exchanges</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies how a server can send an HTTP exchange--a request
URL, content negotiation information, and a response--with signatures that
vouch for that exchange's
authenticity. These signatures can be verified against an origin's certificate
to establish that the exchange is authoritative for an origin even if it was
transferred over a connection that isn't. The signatures can also be used in
other ways described in the appendices.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">These signatures contain countermeasures against downgrade and
protocol-confusion attacks.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-note-to-readers">
<a href="#name-note-to-readers" class="section-name selfRef">Note to Readers</a>
      </h2>
<p id="section-note.1-1">Discussion of this draft takes place on the HTTP working group mailing list
(ietf-http-wg@w3.org), which is archived
at <a href="https://lists.w3.org/Archives/Public/ietf-http-wg/">https://lists.w3.org/Archives/Public/ietf-http-wg/</a>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">The source code and issues list for this draft can be found
in <a href="https://github.com/WICG/webpackage">https://github.com/WICG/webpackage</a>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 January 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-signing-an-exchange" class="xref">Signing an exchange</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-the-signature-header" class="xref">The Signature Header</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1" class="keepWithNext"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-examples" class="xref">Examples</a><a href="#section-toc.1-1.3.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-open-questions" class="xref">Open Questions</a><a href="#section-toc.1-1.3.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-cbor-representation-of-exch" class="xref">CBOR representation of exchange response headers</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-example" class="xref">Example</a><a href="#section-toc.1-1.3.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-loading-a-certificate-chain" class="xref">Loading a certificate chain</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-canonical-cbor-serializatio" class="xref">Canonical CBOR serialization</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-signature-validity" class="xref">Signature validity</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="xref">3.5.1</a>.  <a href="#name-open-questions-2" class="xref">Open Questions</a><a href="#section-toc.1-1.3.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-updating-signature-validity" class="xref">Updating signature validity</a><a href="#section-toc.1-1.3.2.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="xref">3.6.1</a>.  <a href="#name-examples-2" class="xref">Examples</a><a href="#section-toc.1-1.3.2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-the-accept-signature-header" class="xref">The Accept-Signature header</a><a href="#section-toc.1-1.3.2.7.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7.2.1">
                    <p id="section-toc.1-1.3.2.7.2.1.1"><a href="#section-3.7.1" class="xref">3.7.1</a>.  <a href="#name-integrity-identifiers" class="xref">Integrity identifiers</a><a href="#section-toc.1-1.3.2.7.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7.2.2">
                    <p id="section-toc.1-1.3.2.7.2.2.1"><a href="#section-3.7.2" class="xref">3.7.2</a>.  <a href="#name-key-type-identifiers" class="xref">Key type identifiers</a><a href="#section-toc.1-1.3.2.7.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7.2.3">
                    <p id="section-toc.1-1.3.2.7.2.3.1"><a href="#section-3.7.3" class="xref">3.7.3</a>.  <a href="#name-key-value-identifiers" class="xref">Key value identifiers</a><a href="#section-toc.1-1.3.2.7.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7.2.4">
                    <p id="section-toc.1-1.3.2.7.2.4.1"><a href="#section-3.7.4" class="xref">3.7.4</a>.  <a href="#name-examples-3" class="xref">Examples</a><a href="#section-toc.1-1.3.2.7.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7.2.5">
                    <p id="section-toc.1-1.3.2.7.2.5.1"><a href="#section-3.7.5" class="xref">3.7.5</a>.  <a href="#name-open-questions-3" class="xref">Open Questions</a><a href="#section-toc.1-1.3.2.7.2.5.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-cross-origin-trust" class="xref">Cross-origin trust</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-uncached-header-fields" class="xref">Uncached header fields</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-stateful-header-fields" class="xref">Stateful header fields</a><a href="#section-toc.1-1.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-certificate-requirements" class="xref">Certificate Requirements</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-extensions-to-the-caa-recor" class="xref">Extensions to the CAA Record: cansignhttpexchanges Parameter</a><a href="#section-toc.1-1.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-transferring-a-signed-excha" class="xref">Transferring a signed exchange</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-same-origin-response" class="xref">Same-origin response</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-serialized-headers-for-a-sa" class="xref">Serialized headers for a same-origin response</a><a href="#section-toc.1-1.5.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-the-signed-headers-header" class="xref">The Signed-Headers Header</a><a href="#section-toc.1-1.5.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-http-2-extension-for-cross-" class="xref">HTTP/2 extension for cross-origin Server Push</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-indicating-support-for-cros" class="xref">Indicating support for cross-origin Server Push</a><a href="#section-toc.1-1.5.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-no_trusted_exchange_signatu" class="xref">NO_TRUSTED_EXCHANGE_SIGNATURE error code</a><a href="#section-toc.1-1.5.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.  <a href="#name-validating-a-cross-origin-p" class="xref">Validating a cross-origin Push</a><a href="#section-toc.1-1.5.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-application-signed-exchange" class="xref">application/signed-exchange format</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-cross-origin-trust-in-appli" class="xref">Cross-origin trust in application/signed-exchange</a><a href="#section-toc.1-1.5.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="xref">5.3.2</a>.  <a href="#name-example-2" class="xref">Example</a><a href="#section-toc.1-1.5.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="xref">5.3.3</a>.  <a href="#name-open-questions-7" class="xref">Open Questions</a><a href="#section-toc.1-1.5.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-over-signing" class="xref">Over-signing</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.  <a href="#name-session-fixation" class="xref">Session fixation</a><a href="#section-toc.1-1.6.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="xref">6.1.2</a>.  <a href="#name-misleading-content" class="xref">Misleading content</a><a href="#section-toc.1-1.6.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-off-path-attackers" class="xref">Off-path attackers</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-mis-issued-certificates" class="xref">Mis-issued certificates</a><a href="#section-toc.1-1.6.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-stolen-private-keys" class="xref">Stolen private keys</a><a href="#section-toc.1-1.6.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-downgrades" class="xref">Downgrades</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-signing-oracles-are-permane" class="xref">Signing oracles are permanent</a><a href="#section-toc.1-1.6.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-unsigned-headers" class="xref">Unsigned headers</a><a href="#section-toc.1-1.6.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-application-signed-exchange-2" class="xref">application/signed-exchange</a><a href="#section-toc.1-1.6.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="xref">6.7</a>.  <a href="#name-key-re-use-with-tls" class="xref">Key re-use with TLS</a><a href="#section-toc.1-1.6.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="xref">6.8</a>.  <a href="#name-content-sniffing" class="xref">Content sniffing</a><a href="#section-toc.1-1.6.2.8.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-privacy-considerations" class="xref">Privacy considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-visibility-of-resource-requ" class="xref">Visibility of resource requests</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-user-id-transfer" class="xref">User ID transfer</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-signature-header-field-regi" class="xref">Signature Header Field Registration</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-accept-signature-header-fie" class="xref">Accept-Signature Header Field Registration</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-signed-headers-header-field" class="xref">Signed-Headers Header Field Registration</a><a href="#section-toc.1-1.8.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-http-2-settings" class="xref">HTTP/2 Settings</a><a href="#section-toc.1-1.8.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="xref">8.5</a>.  <a href="#name-http-2-error-code" class="xref">HTTP/2 Error code</a><a href="#section-toc.1-1.8.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="xref">8.6</a>.  <a href="#name-internet-media-type-applica" class="xref">Internet Media Type application/signed-exchange</a><a href="#section-toc.1-1.8.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="xref">8.7</a>.  <a href="#name-internet-media-type-applicat" class="xref">Internet Media Type application/cert-chain+cbor</a><a href="#section-toc.1-1.8.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.8">
                <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="xref">8.8</a>.  <a href="#name-the-cansignhttpexchanges-ca" class="xref">The cansignhttpexchanges CAA Parameter</a><a href="#section-toc.1-1.8.2.8.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-use-cases" class="xref">Use cases</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-pushed-subresources" class="xref">PUSHed subresources</a><a href="#section-toc.1-1.10.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-explicit-use-of-a-content-d" class="xref">Explicit use of a content distributor for subresources</a><a href="#section-toc.1-1.10.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-subresource-integrity" class="xref">Subresource Integrity</a><a href="#section-toc.1-1.10.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-a.4" class="xref">A.4</a>.  <a href="#name-binary-transparency" class="xref">Binary Transparency</a><a href="#section-toc.1-1.10.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-a.5" class="xref">A.5</a>.  <a href="#name-static-analysis" class="xref">Static Analysis</a><a href="#section-toc.1-1.10.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#section-a.6" class="xref">A.6</a>.  <a href="#name-offline-websites" class="xref">Offline websites</a><a href="#section-toc.1-1.10.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-requirements" class="xref">Requirements</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-proof-of-origin" class="xref">Proof of origin</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.11.2.1.2.1">
                    <p id="section-toc.1-1.11.2.1.2.1.1"><a href="#section-b.1.1" class="xref">B.1.1</a>.  <a href="#name-certificate-constraints" class="xref">Certificate constraints</a><a href="#section-toc.1-1.11.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.1.2.2">
                    <p id="section-toc.1-1.11.2.1.2.2.1"><a href="#section-b.1.2" class="xref">B.1.2</a>.  <a href="#name-signature-constraints" class="xref">Signature constraints</a><a href="#section-toc.1-1.11.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.1.2.3">
                    <p id="section-toc.1-1.11.2.1.2.3.1"><a href="#section-b.1.3" class="xref">B.1.3</a>.  <a href="#name-retrieving-the-certificate" class="xref">Retrieving the certificate</a><a href="#section-toc.1-1.11.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-how-much-to-sign" class="xref">How much to sign</a><a href="#section-toc.1-1.11.2.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a href="#section-b.2.1" class="xref">B.2.1</a>.  <a href="#name-conveying-the-signed-header" class="xref">Conveying the signed headers</a><a href="#section-toc.1-1.11.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-b.3" class="xref">B.3</a>.  <a href="#name-response-lifespan" class="xref">Response lifespan</a><a href="#section-toc.1-1.11.2.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.11.2.3.2.1">
                    <p id="section-toc.1-1.11.2.3.2.1.1"><a href="#section-b.3.1" class="xref">B.3.1</a>.  <a href="#name-certificate-revocation" class="xref">Certificate revocation</a><a href="#section-toc.1-1.11.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.3.2.2">
                    <p id="section-toc.1-1.11.2.3.2.2.1"><a href="#section-b.3.2" class="xref">B.3.2</a>.  <a href="#name-response-downgrade-attacks" class="xref">Response downgrade attacks</a><a href="#section-toc.1-1.11.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-b.4" class="xref">B.4</a>.  <a href="#name-low-implementation-complexi" class="xref">Low implementation complexity</a><a href="#section-toc.1-1.11.2.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.11.2.4.2.1">
                    <p id="section-toc.1-1.11.2.4.2.1.1"><a href="#section-b.4.1" class="xref">B.4.1</a>.  <a href="#name-limited-choices" class="xref">Limited choices</a><a href="#section-toc.1-1.11.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.4.2.2">
                    <p id="section-toc.1-1.11.2.4.2.2.1"><a href="#section-b.4.2" class="xref">B.4.2</a>.  <a href="#name-bounded-buffering-integrity" class="xref">Bounded-buffering integrity checking</a><a href="#section-toc.1-1.11.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.c" class="xref">Appendix C</a>.  <a href="#name-determining-validity-using-" class="xref">Determining validity using cache control</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-c.1" class="xref">C.1</a>.  <a href="#name-example-of-updating-cache-c" class="xref">Example of updating cache control</a><a href="#section-toc.1-1.12.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-c.2" class="xref">C.2</a>.  <a href="#name-downsides-of-updating-cache" class="xref">Downsides of updating cache control</a><a href="#section-toc.1-1.12.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.d" class="xref">Appendix D</a>.  <a href="#name-change-log" class="xref">Change Log</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.e" class="xref">Appendix E</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-appendix.f" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Signed HTTP exchanges provide a way to prove the authenticity of a resource in
cases where the transport layer isn't sufficient. This can be used in several
ways:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">When signed by a certificate (<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>) that's trusted for an origin, an
exchange can be treated as authoritative for that origin, even if it was
transferred over a connection that isn't authoritative (Section 9.1 of
<span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>) for that origin. See <a href="#uc-pushed-subresources" class="xref">Appendix A.1</a> and
<a href="#uc-explicit-distributor" class="xref">Appendix A.2</a>.<a href="#section-1-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.2">A top-level resource can use a public key to identify an expected publisher for
particular subresources, a system known as Subresource Integrity (<span>[<a href="#SRI" class="xref">SRI</a>]</span>). An
exchange's signature provides the matching proof of authorship. See
<a href="#uc-sri" class="xref">Appendix A.3</a>.<a href="#section-1-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.3">A signature can vouch for the exchange in some way, for example that it
appears in a transparency log or that static analysis indicates that it omits
certain attacks. See <a href="#uc-transparency" class="xref">Appendix A.4</a> and <a href="#uc-static-analysis" class="xref">Appendix A.5</a>.<a href="#section-1-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-3">Subsequent work toward the use cases in <span>[<a href="#I-D.yasskin-wpack-use-cases" class="xref">I-D.yasskin-wpack-use-cases</a>]</span>
will provide a way to group signed exchanges into bundles that can be
transmitted and stored together, but single signed exchanges are useful enough
to standardize on their own.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-2-1">
        <dt id="section-2-1.1">Absolute URL</dt>
        <dd id="section-2-1.2">
  A string for which the <a href="https://url.spec.whatwg.org/#concept-url-parser">URL
 parser</a> (<span>[<a href="#URL" class="xref">URL</a>]</span>), when run
 without a base URL, returns a URL rather than a failure, and for which that URL
 has a null fragment. This is similar to the <a href="https://url.spec.whatwg.org/#absolute-url-string">absolute-URL
 string</a> concept defined by
 (<span>[<a href="#URL" class="xref">URL</a>]</span>) but might not include exactly the same strings.<a href="#section-2-1.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.3">Author</dt>
        <dd id="section-2-1.4">
  The entity that wrote the content in a particular resource. This specification
deals with publishers rather than authors.<a href="#section-2-1.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.5">Publisher</dt>
        <dd id="section-2-1.6">
  The entity that controls the server for a particular origin <span>[<a href="#RFC6454" class="xref">RFC6454</a>]</span>. The
publisher can get a CA to issue certificates for their private keys and can
run a TLS server for their origin.<a href="#section-2-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.7">Exchange (noun)</dt>
        <dd id="section-2-1.8">
  An HTTP request URL, content negotiation information, and an HTTP response.
This can be encoded into a request message from a client with its matching
response from a server, into the request in a PUSH_PROMISE with its matching
response stream, or into the dedicated format in
<a href="#application-signed-exchange" class="xref">Section 5.3</a>, which uses <span>[<a href="#I-D.ietf-httpbis-variants" class="xref">I-D.ietf-httpbis-variants</a>]</span> to
encode the content negotiation information. This is not quite the same meaning
as defined by Section 8 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>, which assumes the content negotiation
information is embedded into HTTP request headers.<a href="#section-2-1.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.9">Intermediate</dt>
        <dd id="section-2-1.10">
  An entity that fetches signed HTTP exchanges from a publisher or another
intermediate and forwards them to another intermediate or a client.<a href="#section-2-1.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.11">Client</dt>
        <dd id="section-2-1.12">
  An entity that uses a signed HTTP exchange and needs to be able to prove that
the publisher vouched for it as coming from its claimed origin.<a href="#section-2-1.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.13">Unix time</dt>
        <dd id="section-2-1.14">
  Defined by <span>[<a href="#POSIX" class="xref">POSIX</a>]</span> <a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap04.html#tag_04_16">section
4.16</a>.<a href="#section-2-1.14" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-2">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="proposal">
<section id="section-3">
      <h2 id="name-signing-an-exchange">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-signing-an-exchange" class="section-name selfRef">Signing an exchange</a>
      </h2>
<p id="section-3-1">In the response of an HTTP exchange the server MAY include a <code>Signature</code> header
field (<a href="#signature-header" class="xref">Section 3.1</a>) holding a list of one or more parameterised
signatures that vouch for the content of the exchange. Exactly which content the
signature vouches for can depend on how the exchange is transferred
(<a href="#transfer" class="xref">Section 5</a>).<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The client categorizes each signature as "valid" or "invalid" by validating that
signature with its certificate or public key and other metadata against the
exchange's URL, response headers, and content (<a href="#signature-validity" class="xref">Section 3.5</a>). This
validity then informs higher-level protocols.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Each signature is parameterised with information to let a client fetch assurance
that a signed exchange is still valid, in the face of revoked certificates and
newly-discovered vulnerabilities. This assurance can be bundled back into the
signed exchange and forwarded to another client, which won't have to re-fetch
this validity information for some period of time.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="signature-header">
<section id="section-3.1">
        <h3 id="name-the-signature-header">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-the-signature-header" class="section-name selfRef">The Signature Header</a>
        </h3>
<p id="section-3.1-1">The <code>Signature</code> header field conveys a list of signatures for an exchange, each
one accompanied by information about how to determine the authority of and
refresh that signature. Each signature directly signs the exchange's URL and
response headers and identifies one of those headers that enforces the integrity
of the exchange's payload.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The <code>Signature</code> header is a Structured Header as defined by
<span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>. Its value MUST be a parameterised list
(Section 3.4 of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>). Its ABNF is:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1-3">
<pre>
Signature = sh-param-list
</pre><a href="#section-3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.1-4">Each parameterised identifier in the list MUST have parameters named "sig",
"integrity", "validity-url", "date", and "expires". Each parameterised identifier
MUST also have either "cert-url" and "cert-sha256" parameters or an "ed25519key"
parameter. This specification gives no meaning to the identifier itself, which
can be used as a human-readable identifier for the signature (however, this is
likely to change soon; see <a href="#parameterised-binary" class="xref">Section 3.1.2, Paragraph 1</a>). The present parameters
MUST have the following values:<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1-5">
          <dt id="section-3.1-5.1">"sig"</dt>
          <dd id="section-3.1-5.2">
  Byte sequence (Section 3.10 of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>) holding
the signature of most of these parameters and the exchange's URL and response
headers.<a href="#section-3.1-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-5.3">"integrity"</dt>
          <dd id="section-3.1-5.4">
  A string (Section 3.8 of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>) containing a
"/"-separated sequence of names starting with the lowercase name of the
response header field that guards the response payload's integrity. The
meaning of subsequent names depends on the response header field, but for the
"digest" header field, the single following name is the name of the digest
algorithm that guards the payload's integrity.<a href="#section-3.1-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-5.5">"cert-url"</dt>
          <dd id="section-3.1-5.6">
  A string (Section 3.8 of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>) containing an
absolute URL (<a href="#terminology" class="xref">Section 2</a>) with a scheme of "https" or "data".<a href="#section-3.1-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-5.7">"cert-sha256"</dt>
          <dd id="section-3.1-5.8">
  Byte sequence (Section 3.10 of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>) holding
the SHA-256 hash of the first certificate found at "cert-url".<a href="#section-3.1-5.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-5.9">"ed25519key"</dt>
          <dd id="section-3.1-5.10">
  Byte sequence (Section 3.10 of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>) holding
an Ed25519 public key (<span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>).<a href="#section-3.1-5.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-5.11">"validity-url"</dt>
          <dd id="section-3.1-5.12">
<div id="signature-validityurl">
  A string (Section 3.8 of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>) containing an
absolute URL (<a href="#terminology" class="xref">Section 2</a>) with a scheme of "https".<a href="#signature-validityurl" class="pilcrow">¶</a>
</div>
          </dd>
<dd class="break"></dd>
<dt id="section-3.1-5.13">"date" and "expires"</dt>
          <dd id="section-3.1-5.14">
  An integer (Section 3.6 of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>)
representing a Unix time.<a href="#section-3.1-5.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.1-6">The "cert-url" parameter is <em>not</em> signed, so intermediates can update it with a
pointer to a cached version.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<div id="example-signature-header">
<section id="section-3.1.1">
          <h4 id="name-examples">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
          </h4>
<p id="section-3.1.1-1">The following header is included in the response for an exchange with effective
request URI <code>https://example.com/resource.html</code>. Newlines are added for
readability.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-http" id="section-3.1.1-2">
<pre>
Signature:
 sig1;
  sig=*MEUCIQDXlI2gN3RNBlgFiuRNFpZXcDIaUpX6HIEwcZEc0cZYLAIga9DsVOMM+g5YpwEBdGW3sS+bvnmAJJiSMwhuBdqp5UY=*;
  integrity="digest/mi-sha256";
  validity-url="https://example.com/resource.validity.1511128380";
  cert-url="https://example.com/oldcerts";
  cert-sha256=*W7uB969dFW3Mb5ZefPS9Tq5ZbH5iSmOILpjv2qEArmI=*;
  date=1511128380; expires=1511733180,
 sig2;
  sig=*MEQCIGjZRqTRf9iKNkGFyzRMTFgwf/BrY2ZNIP/dykhUV0aYAiBTXg+8wujoT4n/W+cNgb7pGqQvIUGYZ8u8HZJ5YH26Qg==*;
  integrity="digest/mi-sha256";
  validity-url="https://example.com/resource.validity.1511128380";
  cert-url="https://example.com/newcerts";
  cert-sha256=*J/lEm9kNRODdCmINbvitpvdYKNQ+YgBj99DlYp4fEXw=*;
  date=1511128380; expires=1511733180,
 srisig;
  sig=*lGZVaJJM5f2oGczFlLmBdKTDL+QADza4BgeO494ggACYJOvrof6uh5OJCcwKrk7DK+LBch0jssDYPp5CLc1SDA==*;
  integrity="digest/mi-sha256";
  validity-url="https://example.com/resource.validity.1511128380";
  ed25519key=*zsSevyFsxyZHiUluVBDd4eypdRLTqyWRVOJuuKUz+A8=*
  date=1511128380; expires=1511733180,
 thirdpartysig;
  sig=*MEYCIQCNxJzn6Rh2fNxsobktir8TkiaJYQFhWTuWI1i4PewQaQIhAMs2TVjc4rTshDtXbgQEOwgj2mRXALhfXPztXgPupii+*;
  integrity="digest/mi-sha256";
  validity-url="https://thirdparty.example.com/resource.validity.1511161860";
  cert-url="https://thirdparty.example.com/certs";
  cert-sha256=*UeOwUPkvxlGRTyvHcsMUN0A2oNsZbU8EUvg8A9ZAnNc=*;
  date=1511133060; expires=1511478660,
</pre><a href="#section-3.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1.1-3">There are 4 signatures: 2 from different secp256r1 certificates within
<code>https://example.com/</code>, one using a raw ed25519 public key that's also
controlled by <code>example.com</code>, and a fourth using a secp256r1 certificate owned by
<code>thirdparty.example.com</code>.<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1.1-4">All 4 signatures rely on the <code>Digest</code> response header with the mi-sha256 digest
algorithm to guard the integrity of the response payload.<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1.1-5">The signatures include a "validity-url" that includes the first time the resource
was seen. This allows multiple versions of a resource at the same URL to be
updated with new signatures, which allows clients to avoid transferring extra
data while the old versions don't have known security bugs.<a href="#section-3.1.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1.1-6">The certificates at <code>https://example.com/oldcerts</code> and
<code>https://example.com/newcerts</code> have <code>subjectAltName</code>s of <code>example.com</code>, meaning
that if they and their signatures validate, the exchange can be trusted as
having an origin of <code>https://example.com/</code>. The publisher might be using two
certificates because their readers have disjoint sets of roots in their trust
stores.<a href="#section-3.1.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1.1-7">The publisher signed with all three certificates at the same time, so they share
a validity range: 7 days starting at 2017-11-19 21:53 UTC.<a href="#section-3.1.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1.1-8">The publisher then requested an additional signature from
<code>thirdparty.example.com</code>, which did some validation or processing and then
signed the resource at 2017-11-19 23:11 UTC. <code>thirdparty.example.com</code> only
grants 4-day signatures, so clients will need to re-validate more often.<a href="#section-3.1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oq-signature-header">
<section id="section-3.1.2">
          <h4 id="name-open-questions">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-open-questions" class="section-name selfRef">Open Questions</a>
          </h4>
<div id="parameterised-binary">
<p id="section-3.1.2-1">The next revision of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span> will provide a way
to parameterise byte sequences, at which point the signature itself is likely to
become the main list item.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
</div>
<p id="section-3.1.2-2">Should the cert-url and validity-url be lists so that intermediates can offer a
cache without losing the original URLs? Putting lists in dictionary fields is
more complex than <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span> allows, so they're
single items for now.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cbor-representation">
<section id="section-3.2">
        <h3 id="name-cbor-representation-of-exch">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-cbor-representation-of-exch" class="section-name selfRef">CBOR representation of exchange response headers</a>
        </h3>
<p id="section-3.2-1">To sign an exchange's response headers, they need to be serialized into a byte string.
Since intermediaries and <span><a href="#uc-explicit-distributor" class="xref">distributors</a> (<a href="#uc-explicit-distributor" class="xref">Appendix A.2</a>)</span> might
rearrange, add, or just reserialize headers, we can't use the literal bytes of
the headers as this serialization. Instead, this section defines a CBOR
representation that can be embedded into other CBOR, canonically serialized
(<a href="#canonical-cbor" class="xref">Section 3.4</a>), and then signed.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The CBOR representation of a set of response metadata and headers is the CBOR
(<span>[<a href="#RFC7049" class="xref">RFC7049</a>]</span>) map with the following mappings:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.1">The byte string ':status' to the byte string containing the response's 3-digit
status code, and<a href="#section-3.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-3.2">For each response header field, the header field's lowercase name as a byte
string to the header field's value as a byte string.<a href="#section-3.2-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<div id="example-cbor-representation">
<section id="section-3.2.1">
          <h4 id="name-example">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-example" class="section-name selfRef">Example</a>
          </h4>
<p id="section-3.2.1-1">Given the HTTP exchange:<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-http" id="section-3.2.1-2">
<pre>
GET / HTTP/1.1
Host: example.com
Accept: */*

HTTP/1.1 200
Content-Type: text/html
Digest: mi-sha256=dcRDgR2GM35DluAV13PzgnG6+pvQwPywfFvAu1UeFrs=
Signed-Headers: "content-type", "digest"

&lt;!doctype html&gt;
&lt;html&gt;
...
</pre><a href="#section-3.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1-3">The cbor representation consists of the following item, represented using the
extended diagnostic notation from <span>[<a href="#CDDL" class="xref">CDDL</a>]</span> appendix G:<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cbor-diag" id="section-3.2.1-4">
<pre>
{
  'digest': 'mi-sha256=dcRDgR2GM35DluAV13PzgnG6+pvQwPywfFvAu1UeFrs=',
  ':status': '200',
  'content-type': 'text/html'
}
</pre><a href="#section-3.2.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="cert-chain-format">
<section id="section-3.3">
        <h3 id="name-loading-a-certificate-chain">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-loading-a-certificate-chain" class="section-name selfRef">Loading a certificate chain</a>
        </h3>
<p id="section-3.3-1">The resource at a signature's <code>cert-url</code> MUST have the
<code>application/cert-chain+cbor</code> content type, MUST be canonically-encoded CBOR
(<a href="#canonical-cbor" class="xref">Section 3.4</a>), and MUST match the following CDDL:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cddl" id="section-3.3-2">
<pre>
cert-chain = [
  "📜⛓", ; U+1F4DC U+26D3
  + augmented-certificate
]
augmented-certificate = {
  cert: bytes,
  ? ocsp: bytes,
  ? sct: bytes,
  * tstr =&gt; any,
}
</pre><a href="#section-3.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.3-3">The first map (second item) in the CBOR array is treated as the end-entity
certificate, and the client will attempt to build a path (<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>) to it
from a trusted root using the other certificates in the chain.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-4">
          <li id="section-3.3-4.1">Each <code>cert</code> value MUST be a DER-encoded X.509v3 certificate (<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>).
Other key/value pairs in the same array item define properties of this
certificate.<a href="#section-3.3-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-4.2">The first certificate's <code>ocsp</code> value MUST be a complete, DER-encoded OCSP
response for that certificate (using the ASN.1 type <code>OCSPResponse</code> defined in
<span>[<a href="#RFC6960" class="xref">RFC6960</a>]</span>). Subsequent certificates MUST NOT have an <code>ocsp</code> value.<a href="#section-3.3-4.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-4.3">Each certificate's <code>sct</code> value if any MUST be a
<code>SignedCertificateTimestampList</code> for that certificate as defined by Section
3.3 of <span>[<a href="#RFC6962" class="xref">RFC6962</a>]</span>.<a href="#section-3.3-4.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-5">Loading a <code>cert-url</code> takes a <code>forceFetch</code> flag. The client MUST:<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-6">
          <li id="section-3.3-6.1">Let <code>raw-chain</code> be the result of fetching (<span>[<a href="#FETCH" class="xref">FETCH</a>]</span>) <code>cert-url</code>. If
<code>forceFetch</code> is <em>not</em> set, the fetch can be fulfilled from a cache using
normal HTTP semantics <span>[<a href="#RFC7234" class="xref">RFC7234</a>]</span>. If this fetch fails, return
"invalid".<a href="#section-3.3-6.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-6.2">Let <code>certificate-chain</code> be the array of certificates and properties produced
by parsing <code>raw-chain</code> using the CDDL above. If any of the requirements above
aren't satisfied, return "invalid". Note that this validation requirement
might be impractical to completely achieve due to certificate validation
implementations that don't enforce DER encoding or other standard
constraints.<a href="#section-3.3-6.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-6.3">Return <code>certificate-chain</code>.<a href="#section-3.3-6.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="canonical-cbor">
<section id="section-3.4">
        <h3 id="name-canonical-cbor-serializatio">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-canonical-cbor-serializatio" class="section-name selfRef">Canonical CBOR serialization</a>
        </h3>
<p id="section-3.4-1">Within this specification, the canonical serialization of a CBOR item uses the
following rules derived from Section 3.9 of <span>[<a href="#RFC7049" class="xref">RFC7049</a>]</span> with erratum 4964
applied:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">Integers and the lengths of arrays, maps, and strings MUST use the smallest
possible encoding.<a href="#section-3.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-2.2">Items MUST NOT be encoded with indefinite length.<a href="#section-3.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-2.3">
            <p id="section-3.4-2.3.1">The keys in every map MUST be sorted in the bytewise lexicographic order of
their canonical encodings. For example, the following keys are correctly sorted:<a href="#section-3.4-2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.4-2.3.2">
              <li id="section-3.4-2.3.2.1">10, encoded as 0A.<a href="#section-3.4-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-3.4-2.3.2.2">100, encoded as 18 64.<a href="#section-3.4-2.3.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-3.4-2.3.2.3">-1, encoded as 20.<a href="#section-3.4-2.3.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-3.4-2.3.2.4">"z", encoded as 61 7A.<a href="#section-3.4-2.3.2.4" class="pilcrow">¶</a>
</li>
              <li id="section-3.4-2.3.2.5">"aa", encoded as 62 61 61.<a href="#section-3.4-2.3.2.5" class="pilcrow">¶</a>
</li>
              <li id="section-3.4-2.3.2.6">[100], encoded as 81 18 64.<a href="#section-3.4-2.3.2.6" class="pilcrow">¶</a>
</li>
              <li id="section-3.4-2.3.2.7">[-1], encoded as 81 20.<a href="#section-3.4-2.3.2.7" class="pilcrow">¶</a>
</li>
              <li id="section-3.4-2.3.2.8">false, encoded as F4.<a href="#section-3.4-2.3.2.8" class="pilcrow">¶</a>
</li>
            </ol>
</li>
        </ul>
<p id="section-3.4-3">Note: this specification does not use floating point, tags, or other more
complex data types, so it doesn't need rules to canonicalize those.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-validity">
<section id="section-3.5">
        <h3 id="name-signature-validity">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-signature-validity" class="section-name selfRef">Signature validity</a>
        </h3>
<p id="section-3.5-1">The client MUST parse the <code>Signature</code> header field as the parameterised list
(Section 4.2.5 of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>) described in
<a href="#signature-header" class="xref">Section 3.1</a>. If an error is thrown during this parsing or any of the
requirements described there aren't satisfied, the exchange has no valid
signatures. Otherwise, each member of this list represents a signature with
parameters.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">The client MUST use the following algorithm to determine whether each signature
with parameters is invalid or potentially-valid for an exchange's<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-3.1">
            <code>requestUrl</code>, a byte sequence that can be parsed into the exchange's effective
request URI (Section 5.5 of <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>),<a href="#section-3.5-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.5-3.2">
            <code>responseHeaders</code>, a byte sequence holding the canonical serialization
(<a href="#canonical-cbor" class="xref">Section 3.4</a>) of the CBOR representation (<a href="#cbor-representation" class="xref">Section 3.2</a>) of
the exchange's response metadata and headers, and<a href="#section-3.5-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.5-3.3">
            <code>payload</code>, a stream of bytes constituting the exchange's payload body (Section
3.3 of <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>). Note that the payload body is the message body with any
transfer encodings removed.<a href="#section-3.5-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.5-4">Potentially-valid results include:<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-5.1">The signed headers of the exchange so that higher-level protocols can avoid
relying on unsigned headers, and<a href="#section-3.5-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.5-5.2">Either a certificate chain or a public key so that a higher-level protocol can
determine whether it's actually valid.<a href="#section-3.5-5.2" class="pilcrow">¶</a>
</li>
        </ul>
<div id="force-fetch">
<p id="section-3.5-6">This algorithm accepts a <code>forceFetch</code> flag that avoids the cache when fetching
URLs. A client that determines that a potentially-valid certificate chain is
actually invalid due to an expired OCSP response MAY retry with <code>forceFetch</code> set
to retrieve an updated OCSP from the original server.<a href="#section-3.5-6" class="pilcrow">¶</a></p>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3.5-7">
          <li id="section-3.5-7.1">
            <p id="section-3.5-7.1.1">Let:<a href="#section-3.5-7.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-7.1.2.1">
                <code>signature</code> be the signature (byte sequence in the parameterised
identifier's "sig" parameter).<a href="#section-3.5-7.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.5-7.1.2.2">
                <code>integrity</code> be the signature's "integrity" parameter.<a href="#section-3.5-7.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.5-7.1.2.3">
                <code>validity-url</code> be the signature's "validity-url" parameter.<a href="#section-3.5-7.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.5-7.1.2.4">
                <code>cert-url</code> be the signature's "cert-url" parameter, if any.<a href="#section-3.5-7.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.5-7.1.2.5">
                <code>cert-sha256</code> be the signature's "cert-sha256" parameter, if any.<a href="#section-3.5-7.1.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.5-7.1.2.6">
                <code>ed25519key</code> be the signature's "ed25519key" parameter, if any.<a href="#section-3.5-7.1.2.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.5-7.1.2.7">
                <code>date</code> be the signature's "date" parameter, interpreted as a Unix time.<a href="#section-3.5-7.1.2.7" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.5-7.1.2.8">
                <code>expires</code> be the signature's "expires" parameter, interpreted as a Unix
time.<a href="#section-3.5-7.1.2.8" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.5-7.2">
            <p id="section-3.5-7.2.1">Set <code>publicKey</code> and <code>signing-alg</code> depending on which key fields are present:<a href="#section-3.5-7.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.5-7.2.2">
              <li id="section-3.5-7.2.2.1">
                <p id="section-3.5-7.2.2.1.1">If <code>cert-url</code> is present:<a href="#section-3.5-7.2.2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.5-7.2.2.1.2">
                  <li id="section-3.5-7.2.2.1.2.1">Let <code>certificate-chain</code> be the result of loading the certificate chain
at <code>cert-url</code> passing the <code>forceFetch</code> flag (<a href="#cert-chain-format" class="xref">Section 3.3</a>). If
this returns "invalid", return "invalid".<a href="#section-3.5-7.2.2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-3.5-7.2.2.1.2.2">Let <code>main-certificate</code> be the first certificate in <code>certificate-chain</code>.<a href="#section-3.5-7.2.2.1.2.2" class="pilcrow">¶</a>
</li>
                  <li id="section-3.5-7.2.2.1.2.3">Set <code>publicKey</code> to <code>main-certificate</code>'s public key.<a href="#section-3.5-7.2.2.1.2.3" class="pilcrow">¶</a>
</li>
                  <li id="section-3.5-7.2.2.1.2.4">If <code>publicKey</code> is an RSA key, return "invalid".<a href="#section-3.5-7.2.2.1.2.4" class="pilcrow">¶</a>
</li>
                  <li id="section-3.5-7.2.2.1.2.5">If <code>publicKey</code> is a key using the secp256r1 elliptic curve, set
<code>signing-alg</code> to ecdsa_secp256r1_sha256 as defined in Section 4.2.3 of
<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-3.5-7.2.2.1.2.5" class="pilcrow">¶</a>
</li>
                  <li id="section-3.5-7.2.2.1.2.6">Otherwise, either return "invalid" or set <code>signing-alg</code> to a non-legacy
signing algorithm defined by TLS 1.3 or later
(<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>). This choice MUST depend only on
<code>publicKey</code>'s type and not on any other context.<a href="#section-3.5-7.2.2.1.2.6" class="pilcrow">¶</a>
</li>
                </ol>
</li>
              <li id="section-3.5-7.2.2.2">If <code>ed25519key</code> is present, set <code>publicKey</code> to <code>ed25519key</code> and
<code>signing-alg</code> to ed25519, as defined by <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span><a href="#section-3.5-7.2.2.2" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-3.5-7.3">If <code>expires</code> is more than 7 days (604800 seconds) after <code>date</code>, return
"invalid".<a href="#section-3.5-7.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.5-7.4">If the current time is before <code>date</code> or after <code>expires</code>, return "invalid".<a href="#section-3.5-7.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.5-7.5">
            <p id="section-3.5-7.5.1">Let <code>message</code> be the concatenation of the following byte strings. This
matches the <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> format to avoid cross-protocol attacks if
anyone uses the same key in a TLS certificate and an exchange-signing
certificate.<a href="#section-3.5-7.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.5-7.5.2">
              <li id="section-3.5-7.5.2.1">A string that consists of octet 32 (0x20) repeated 64 times.<a href="#section-3.5-7.5.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-3.5-7.5.2.2">
                <p id="section-3.5-7.5.2.2.1">A context string: the ASCII encoding of "HTTP Exchange 1".<a href="#section-3.5-7.5.2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.5-7.5.2.2.2">
Note: RFC EDITOR PLEASE DELETE THIS NOTE; The implementation of the final
RFC MUST use this context string, but implementations of drafts MUST NOT
use it and MUST use another draft-specific string beginning with "HTTP
Exchange 1 " instead. This ensures that signers can predict how their
signatures will be used.<a href="#section-3.5-7.5.2.2.2" class="pilcrow">¶</a></p>
</li>
              <li id="section-3.5-7.5.2.3">A single 0 byte which serves as a separator.<a href="#section-3.5-7.5.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-3.5-7.5.2.4">If <code>cert-sha256</code> is set, a byte holding the value 32 followed by the 32
bytes of the value of <code>cert-sha256</code>. Otherwise a 0 byte.<a href="#section-3.5-7.5.2.4" class="pilcrow">¶</a>
</li>
              <li id="section-3.5-7.5.2.5">The 8-byte big-endian encoding of the length in bytes of <code>validity-url</code>,
followed by the bytes of <code>validity-url</code>.<a href="#section-3.5-7.5.2.5" class="pilcrow">¶</a>
</li>
              <li id="section-3.5-7.5.2.6">The 8-byte big-endian encoding of <code>date</code>.<a href="#section-3.5-7.5.2.6" class="pilcrow">¶</a>
</li>
              <li id="section-3.5-7.5.2.7">The 8-byte big-endian encoding of <code>expires</code>.<a href="#section-3.5-7.5.2.7" class="pilcrow">¶</a>
</li>
              <li id="section-3.5-7.5.2.8">The 8-byte big-endian encoding of the length in bytes of <code>requestUrl</code>,
followed by the bytes of <code>requestUrl</code>.<a href="#section-3.5-7.5.2.8" class="pilcrow">¶</a>
</li>
              <li id="section-3.5-7.5.2.9">The 8-byte big-endian encoding of the length in bytes of <code>responseHeaders</code>,
followed by the bytes of <code>responseHeaders</code>.<a href="#section-3.5-7.5.2.9" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-3.5-7.6">
            <p id="section-3.5-7.6.1">If <code>cert-url</code> is present and the SHA-256 hash of <code>main-certificate</code>'s
<code>cert_data</code> is not equal to <code>cert-sha256</code> (whose presence was checked when the
<code>Signature</code> header field was parsed), return "invalid".<a href="#section-3.5-7.6.1" class="pilcrow">¶</a></p>
<p id="section-3.5-7.6.2">
Note that this intentionally differs from TLS 1.3, which signs the entire
certificate chain in its Certificate Verify (Section 4.4.3 of
<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>), in order to allow updating the stapled OCSP
response without updating signatures at the same time.<a href="#section-3.5-7.6.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.5-7.7">If <code>signature</code> is not a valid signature of <code>message</code> by <code>publicKey</code> using
<code>signing-alg</code>, return "invalid".<a href="#section-3.5-7.7" class="pilcrow">¶</a>
</li>
          <li id="section-3.5-7.8">
            <p id="section-3.5-7.8.1">If <code>headers</code>, interpreted according to <a href="#cbor-representation" class="xref">Section 3.2</a>, does not
contain a <code>Content-Type</code> response header field (Section 3.1.1.5 of
<span>[<a href="#RFC7231" class="xref">RFC7231</a>]</span>), return "invalid".<a href="#section-3.5-7.8.1" class="pilcrow">¶</a></p>
<p id="section-3.5-7.8.2">
Clients MUST interpret the signed payload as this specified media type
instead of trying to sniff a media type from the bytes of the payload, for
example by attaching an <code>X-Content-Type-Options: nosniff</code> header field
(<span>[<a href="#FETCH" class="xref">FETCH</a>]</span>) to the extracted response.<a href="#section-3.5-7.8.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.5-7.9">
            <p id="section-3.5-7.9.1">If <code>integrity</code> names a header field and parameter that is not present in
<code>responseHeaders</code> or which the client cannot use to check the
integrity of <code>payload</code> (for example, the header field is new and hasn't been
implemented yet), then return "invalid". If the selected header field
provides integrity guarantees weaker than SHA-256, return "invalid". If
validating integrity using the selected header field requires the client to
process records larger than 16384 bytes, return "invalid". Clients MUST
implement at least the <code>Digest</code> header field with its <code>mi-sha256</code> digest
algorithm (Section 3 of <span>[<a href="#I-D.thomson-http-mice" class="xref">I-D.thomson-http-mice</a>]</span>).<a href="#section-3.5-7.9.1" class="pilcrow">¶</a></p>
<p id="section-3.5-7.9.2">
Note: RFC EDITOR PLEASE DELETE THIS NOTE; Implementations of drafts of this
RFC MUST recognize the draft spelling of the content encoding and digest
algorithm specified by <span>[<a href="#I-D.thomson-http-mice" class="xref">I-D.thomson-http-mice</a>]</span> until that draft is
published as an RFC. For example, implementations of
draft-thomson-http-mice-03 would use <code>mi-sha256-03</code> and MUST NOT use
<code>mi-sha256</code> itself. This ensures that final implementations don't need to
handle compatibility with implementations of early drafts of that content
encoding.<a href="#section-3.5-7.9.2" class="pilcrow">¶</a></p>
<p id="section-3.5-7.9.3">
If <code>payload</code> doesn't match the integrity information in the header described
by <code>integrity</code>, return "invalid".<a href="#section-3.5-7.9.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.5-7.10">Return "potentially-valid" with whichever is present of <code>certificate-chain</code>
or <code>ed25519key</code>.<a href="#section-3.5-7.10" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.5-8">Note that the above algorithm can determine that an exchange's headers are
potentially-valid before the exchange's payload is received. Similarly, if
<code>integrity</code> identifies a header field and parameter like <code>Digest:mi-sha256</code>
(<span>[<a href="#I-D.thomson-http-mice" class="xref">I-D.thomson-http-mice</a>]</span>)
that can incrementally validate the payload, early parts of the payload can be
determined to be potentially-valid before later parts of the payload.
Higher-level protocols MAY process parts of the exchange that have been
determined to be potentially-valid as soon as that determination is made but
MUST NOT process parts of the exchange that are not yet potentially-valid.
Similarly, as the higher-level protocol determines that parts of the exchange
are actually valid, the client MAY process those parts of the exchange and MUST
wait to process other parts of the exchange until they too are determined to be
valid.<a href="#section-3.5-8" class="pilcrow">¶</a></p>
<div id="oq-signature-validity">
<section id="section-3.5.1">
          <h4 id="name-open-questions-2">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-open-questions-2" class="section-name selfRef">Open Questions</a>
          </h4>
<p id="section-3.5.1-1">Should the signed message use the TLS format (with an initial 64 spaces) even
though these certificates can't be used in TLS servers?<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="updating-validity">
<section id="section-3.6">
        <h3 id="name-updating-signature-validity">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-updating-signature-validity" class="section-name selfRef">Updating signature validity</a>
        </h3>
<p id="section-3.6-1">Both OCSP responses and signatures are designed to expire a short
time after they're signed, so that revoked certificates and signed exchanges
with known vulnerabilities are distrusted promptly.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">This specification provides no way to update OCSP responses by themselves.
Instead, <span><a href="#force-fetch" class="xref">clients need to re-fetch the "cert-url"</a> (<a href="#force-fetch" class="xref">Section 3.5, Paragraph 6</a>)</span> to get a chain
including a newer OCSP response.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<p id="section-3.6-3">The <span><a href="#signature-validityurl" class="xref">"validity-url" parameter</a> (<a href="#signature-validityurl" class="xref">Section 3.1</a>)</span> of the signatures provides
a way to fetch new signatures or learn where to fetch a complete updated
exchange.<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<p id="section-3.6-4">Each version of a signed exchange SHOULD have its own validity URLs, since each
version needs different signatures and becomes obsolete at different times.<a href="#section-3.6-4" class="pilcrow">¶</a></p>
<p id="section-3.6-5">The resource at a "validity-url" is "validity data", a CBOR map matching the
following CDDL (<span>[<a href="#CDDL" class="xref">CDDL</a>]</span>):<a href="#section-3.6-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cddl" id="section-3.6-6">
<pre>
validity = {
  ? signatures: [ + bytes ]
  ? update: {
    ? size: uint,
  }
]
</pre><a href="#section-3.6-6" class="pilcrow">¶</a>
</div>
<p id="section-3.6-7">The elements of the <code>signatures</code> array are parameterised identifiers (Section
4.2.6 of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>) meant to replace the signatures
within the <code>Signature</code> header field pointing to this validity data. If the
signed exchange contains a bug severe enough that clients need to stop using the
content, the <code>signatures</code> array MUST NOT be present.<a href="#section-3.6-7" class="pilcrow">¶</a></p>
<p id="section-3.6-8">If the the <code>update</code> map is present, that indicates that a new version of the
signed exchange is available at its effective request URI (Section 5.5 of
<span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>) and can give an estimate of the size of the updated exchange
(<code>update.size</code>). If the signed exchange is currently the most recent version,
the <code>update</code> SHOULD NOT be present.<a href="#section-3.6-8" class="pilcrow">¶</a></p>
<p id="section-3.6-9">If both the <code>signatures</code> and <code>update</code> fields are present, clients can use the
estimated size to decide whether to update the whole resource or just its
signatures.<a href="#section-3.6-9" class="pilcrow">¶</a></p>
<div id="examples-updating-validity">
<section id="section-3.6.1">
          <h4 id="name-examples-2">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-examples-2" class="section-name selfRef">Examples</a>
          </h4>
<p id="section-3.6.1-1">For example, say a signed exchange whose URL is <code>https://example.com/resource</code>
has the following <code>Signature</code> header field (with line breaks included and
irrelevant fields omitted for ease of reading).<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-http" id="section-3.6.1-2">
<pre>
Signature:
 sig1;
  sig=*MEUCIQ...*;
  ...
  validity-url="https://example.com/resource.validity.1511157180";
  cert-url="https://example.com/oldcerts";
  date=1511128380; expires=1511733180,
 sig2;
  sig=*MEQCIG...*;
  ...
  validity-url="https://example.com/resource.validity.1511157180";
  cert-url="https://example.com/newcerts";
  date=1511128380; expires=1511733180,
 thirdpartysig;
  sig=*MEYCIQ...*;
  ...
  validity-url="https://thirdparty.example.com/resource.validity.1511161860";
  cert-url="https://thirdparty.example.com/certs";
  date=1511478660; expires=1511824260
</pre><a href="#section-3.6.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.6.1-3">At 2017-11-27 11:02 UTC, <code>sig1</code> and <code>sig2</code> have expired, but <code>thirdpartysig</code>
doesn't exipire until 23:11 that night, so the client needs to fetch
<code>https://example.com/resource.validity.1511157180</code> (the <code>validity-url</code> of <code>sig1</code>
and <code>sig2</code>) if it wishes to update those signatures. This URL might contain:<a href="#section-3.6.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-cbor-diag" id="section-3.6.1-4">
<pre>
{
  "signatures": [
    'sig1; '
    'sig=*MEQCIC/I9Q+7BZFP6cSDsWx43pBAL0ujTbON/+7RwKVk+ba5AiB3FSFLZqpzmDJ0NumNwN04pqgJZE99fcK86UjkPbj4jw==*; '
    'validity-url="https://example.com/resource.validity.1511157180"; '
    'integrity="digest/mi-sha256"; '
    'cert-url="https://example.com/newcerts"; '
    'cert-sha256=*J/lEm9kNRODdCmINbvitpvdYKNQ+YgBj99DlYp4fEXw=*; '
    'date=1511733180; expires=1512337980'
  ],
  "update": {
    "size": 5557452
  }
}
</pre><a href="#section-3.6.1-4" class="pilcrow">¶</a>
</div>
<p id="section-3.6.1-5">This indicates that the client could fetch a newer version at
<code>https://example.com/resource</code> (the original URL of the exchange), or that the
validity period of the old version can be extended by replacing the first two of
the original signatures (the ones with a validity-url of
<code>https://example.com/resource.validity.1511157180</code>) with the single new
signature provided. (This might happen at the end of a migration to a new root
certificate.) The signatures of the updated signed exchange would be:<a href="#section-3.6.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-http" id="section-3.6.1-6">
<pre>
Signature:
 sig1;
  sig=*MEQCIC...*;
  ...
  validity-url="https://example.com/resource.validity.1511157180";
  cert-url="https://example.com/newcerts";
  date=1511733180; expires=1512337980,
 thirdpartysig;
  sig=*MEYCIQ...*;
  ...
  validity-url="https://thirdparty.example.com/resource.validity.1511161860";
  cert-url="https://thirdparty.example.com/certs";
  date=1511478660; expires=1511824260
</pre><a href="#section-3.6.1-6" class="pilcrow">¶</a>
</div>
<p id="section-3.6.1-7"><code>https://example.com/resource.validity.1511157180</code> could also expand the set of
signatures if its <code>signatures</code> array contained more than 2 elements.<a href="#section-3.6.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="accept-signature">
<section id="section-3.7">
        <h3 id="name-the-accept-signature-header">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-the-accept-signature-header" class="section-name selfRef">The Accept-Signature header</a>
        </h3>
<p id="section-3.7-1"><code>Signature</code> header fields cost on the order of 300 bytes for ECDSA signatures,
so servers might prefer to avoid sending them to clients that don't intend to
use them. A client can send the <code>Accept-Signature</code> header field to indicate that
it does intend to take advantage of any available signatures and to indicate
what kinds of signatures it supports.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<p id="section-3.7-2">When a server receives an <code>Accept-Signature</code> header field in a client request,
it SHOULD reply with any available <code>Signature</code> header fields for its response
that the <code>Accept-Signature</code> header field indicates the client supports. However,
if the <code>Accept-Signature</code> value violates a requirement in this section, the
server MUST behave as if it hadn't received any <code>Accept-Signature</code> header at
all.<a href="#section-3.7-2" class="pilcrow">¶</a></p>
<p id="section-3.7-3">The <code>Accept-Signature</code> header field is a Structured Header as defined by
<span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>. Its value MUST be a parameterised list
(Section 3.4 of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>). Its ABNF is:<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.7-4">
<pre>
Accept-Signature = sh-param-list
</pre><a href="#section-3.7-4" class="pilcrow">¶</a>
</div>
<p id="section-3.7-5">The order of identifiers in the <code>Accept-Signature</code> list is not significant.
Identifiers, ignoring any initial "-" character, MUST NOT be duplicated.<a href="#section-3.7-5" class="pilcrow">¶</a></p>
<p id="section-3.7-6">Each identifier in the <code>Accept-Signature</code> header field's value indicates that a
feature of the <code>Signature</code> header field (<a href="#signature-header" class="xref">Section 3.1</a>) is supported. If
the identifier begins with a "-" character, it instead indicates that the
feature named by the rest of the identifier is not supported. Unknown
identifiers and parameters MUST be ignored because new identifiers and new
parameters on existing identifiers may be defined by future specifications.<a href="#section-3.7-6" class="pilcrow">¶</a></p>
<div id="accept-signature-integrity">
<section id="section-3.7.1">
          <h4 id="name-integrity-identifiers">
<a href="#section-3.7.1" class="section-number selfRef">3.7.1. </a><a href="#name-integrity-identifiers" class="section-name selfRef">Integrity identifiers</a>
          </h4>
<p id="section-3.7.1-1">Identifiers starting with "digest/" indicate that the client supports the
<code>Digest</code> header field (<span>[<a href="#RFC3230" class="xref">RFC3230</a>]</span>) with the parameter from the <a href="https://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml">HTTP Digest
Algorithm Values
Registry</a>
registry named in lower-case by the rest of the identifier. For example,
"digest/mi-blake2" indicates support for Merkle integrity with the
as-yet-unspecified mi-blake2 parameter, and "-digest/mi-sha256" indicates
non-support for Merkle integrity with the mi-sha256 content encoding.<a href="#section-3.7.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.1-2">If the <code>Accept-Signature</code> header field is present, servers SHOULD assume support
for "digest/mi-sha256" unless the header field states otherwise.<a href="#section-3.7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="accept-signature-key-types">
<section id="section-3.7.2">
          <h4 id="name-key-type-identifiers">
<a href="#section-3.7.2" class="section-number selfRef">3.7.2. </a><a href="#name-key-type-identifiers" class="section-name selfRef">Key type identifiers</a>
          </h4>
<p id="section-3.7.2-1">Identifiers starting with "ecdsa/" indicate that the client supports
certificates holding ECDSA public keys on the curve named in lower-case by the
rest of the identifier.<a href="#section-3.7.2-1" class="pilcrow">¶</a></p>
<p id="section-3.7.2-2">If the <code>Accept-Signature</code> header field is present, servers SHOULD assume support
for "ecdsa/secp256r1" unless the header field states otherwise.<a href="#section-3.7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="accept-signature-key-values">
<section id="section-3.7.3">
          <h4 id="name-key-value-identifiers">
<a href="#section-3.7.3" class="section-number selfRef">3.7.3. </a><a href="#name-key-value-identifiers" class="section-name selfRef">Key value identifiers</a>
          </h4>
<p id="section-3.7.3-1">The "ed25519key" identifier has parameters indicating the public keys that will
be used to validate the returned signature. Each parameter's name is
re-interpreted as a byte sequence (Section 3.10 of
<span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>) encoding a prefix of the public key. For
example, if the client will validate signatures using the public key whose
base64 encoding is <code>11qYAYKxCrfVS/7TyWQHOg7hcvPapiMlrwIaaPcHURo=</code>, valid
<code>Accept-Signature</code> header fields include:<a href="#section-3.7.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-http" id="section-3.7.3-2">
<pre>
Accept-Signature: ..., ed25519key; *11qYAYKxCrfVS/7TyWQHOg7hcvPapiMlrwIaaPcHURo=*
Accept-Signature: ..., ed25519key; *11qYAYKxCrfVS/7TyWQHOg==*
Accept-Signature: ..., ed25519key; *11qYAQ==*
Accept-Signature: ..., ed25519key; **
</pre><a href="#section-3.7.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.7.3-3">but not<a href="#section-3.7.3-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-http" id="section-3.7.3-4">
<pre>
Accept-Signature: ..., ed25519key; *11qYA===*
</pre><a href="#section-3.7.3-4" class="pilcrow">¶</a>
</div>
<p id="section-3.7.3-5">because 5 bytes isn't a valid length for encoded base64, and not<a href="#section-3.7.3-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-http" id="section-3.7.3-6">
<pre>
Accept-Signature: ..., ed25519key; 11qYAQ
</pre><a href="#section-3.7.3-6" class="pilcrow">¶</a>
</div>
<p id="section-3.7.3-7">because it doesn't start or end with the <code>*</code>s that indicate a byte sequence.<a href="#section-3.7.3-7" class="pilcrow">¶</a></p>
<p id="section-3.7.3-8">Note that <code>ed25519key; **</code> is an empty prefix, which matches all public keys, so
it's useful in subresource integrity (<a href="#uc-sri" class="xref">Appendix A.3</a>) cases like <code>&lt;link rel=preload
as=script href="..."&gt;</code> where the public key isn't known until the matching
<code>&lt;script src="..." integrity="..."&gt;</code> tag.<a href="#section-3.7.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="accept-signature-examples">
<section id="section-3.7.4">
          <h4 id="name-examples-3">
<a href="#section-3.7.4" class="section-number selfRef">3.7.4. </a><a href="#name-examples-3" class="section-name selfRef">Examples</a>
          </h4>
<div class="artwork art-text alignLeft art-http" id="section-3.7.4-1">
<pre>
Accept-Signature: digest/mi-sha256
</pre><a href="#section-3.7.4-1" class="pilcrow">¶</a>
</div>
<p id="section-3.7.4-2">states that the client will accept signatures with payload integrity assured by
the <code>Digest</code> header and <code>mi-sha256</code> digest algorithm and implies that the client
will accept signatures from ECDSA keys on the secp256r1 curve.<a href="#section-3.7.4-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-http" id="section-3.7.4-3">
<pre>
Accept-Signature: -ecdsa/secp256r1, ecdsa/secp384r1
</pre><a href="#section-3.7.4-3" class="pilcrow">¶</a>
</div>
<p id="section-3.7.4-4">states that the client will accept ECDSA keys on the secp384r1 curve but not the
secp256r1 curve and payload integrity assured with the <code>Digest: mi-sha256</code>
header field.<a href="#section-3.7.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oq-accept-signature">
<section id="section-3.7.5">
          <h4 id="name-open-questions-3">
<a href="#section-3.7.5" class="section-number selfRef">3.7.5. </a><a href="#name-open-questions-3" class="section-name selfRef">Open Questions</a>
          </h4>
<p id="section-3.7.5-1">Is an <code>Accept-Signature</code> header useful enough to pay for itself? If clients wind
up sending it on most requests, that may cost more than the cost of sending
<code>Signature</code>s unconditionally. On the other hand, it gives servers an indication
of which kinds of signatures are supported, which can help us upgrade the
ecosystem in the future.<a href="#section-3.7.5-1" class="pilcrow">¶</a></p>
<p id="section-3.7.5-2">Is <code>Accept-Signature</code> the right spelling, or do we want to imitate <code>Want-Digest</code>
(Section 4.3.1 of <span>[<a href="#RFC3230" class="xref">RFC3230</a>]</span>) instead?<a href="#section-3.7.5-2" class="pilcrow">¶</a></p>
<p id="section-3.7.5-3">Do I have the right structure for the identifiers indicating feature support?<a href="#section-3.7.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="cross-origin-trust">
<section id="section-4">
      <h2 id="name-cross-origin-trust">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-cross-origin-trust" class="section-name selfRef">Cross-origin trust</a>
      </h2>
<p id="section-4-1">To determine whether to trust a cross-origin exchange, the client takes a
<code>Signature</code> header field (<a href="#signature-header" class="xref">Section 3.1</a>) and the exchange's<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <code>requestUrl</code>, a byte sequence that can be parsed into the exchange's effective
request URI (Section 5.5 of <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>),<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">
          <code>responseHeaders</code>, a byte sequence holding the canonical serialization
(<a href="#canonical-cbor" class="xref">Section 3.4</a>) of the CBOR representation (<a href="#cbor-representation" class="xref">Section 3.2</a>) of
the exchange's response metadata and headers, and<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.3">
          <code>payload</code>, a stream of bytes constituting the exchange's payload body (Section
3.3 of <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>).<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-3">The client MUST parse the <code>Signature</code> header into a list of signatures according
to the instructions in <a href="#signature-validity" class="xref">Section 3.5</a>, and run the following algorithm
for each signature, stopping at the first one that returns "valid". If any
signature returns "valid", return "valid". Otherwise, return "invalid".<a href="#section-4-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-4">
        <li id="section-4-4.1">If the signature's <span><a href="#signature-validityurl" class="xref">"validity-url" parameter</a> (<a href="#signature-validityurl" class="xref">Section 3.1</a>)</span> is not
<a href="https://html.spec.whatwg.org/multipage/origin.html#same-origin">same-origin</a>
with <code>requestUrl</code>, return "invalid".<a href="#section-4-4.1" class="pilcrow">¶</a>
</li>
        <li id="section-4-4.2">Use <a href="#signature-validity" class="xref">Section 3.5</a> to determine the signature's validity for
<code>requestUrl</code>, <code>responseHeaders</code>, and <code>payload</code>, getting <code>certificate-chain</code> back. If
this returned "invalid" or didn't return a certificate chain, return
"invalid".<a href="#section-4-4.2" class="pilcrow">¶</a>
</li>
        <li id="section-4-4.3">Let <code>response</code> be the response metadata and headers parsed out of
<code>responseHeaders</code>.<a href="#section-4-4.3" class="pilcrow">¶</a>
</li>
        <li id="section-4-4.4">If Section 3 of <span>[<a href="#RFC7234" class="xref">RFC7234</a>]</span> forbids a shared cache from storing <code>response</code>,
return "invalid".<a href="#section-4-4.4" class="pilcrow">¶</a>
</li>
        <li id="section-4-4.5">If <code>response</code>'s headers contain an uncached header field, as defined in
<a href="#uncached-headers" class="xref">Section 4.1</a>, return "invalid".<a href="#section-4-4.5" class="pilcrow">¶</a>
</li>
        <li id="section-4-4.6">Let <code>authority</code> be the host component of <code>requestUrl</code>.<a href="#section-4-4.6" class="pilcrow">¶</a>
</li>
        <li id="section-4-4.7">
          <p id="section-4-4.7.1">Validate the <code>certificate-chain</code> using the following substeps. If any of them
fail, re-run <a href="#signature-validity" class="xref">Section 3.5</a> once over the signature with the
<code>forceFetch</code> flag set, and restart from step 2. If a substep fails again,
return "invalid".<a href="#section-4-4.7.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-4.7.2">
            <li id="section-4-4.7.2.1">Use <code>certificate-chain</code> to validate that its first entry,
<code>main-certificate</code> is trusted as <code>authority</code>'s server certificate
(<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> and other undocumented conventions). Let <code>path</code> be the path
that was used from the <code>main-certificate</code> to a trusted root, including the
<code>main-certificate</code> but excluding the root.<a href="#section-4-4.7.2.1" class="pilcrow">¶</a>
</li>
            <li id="section-4-4.7.2.2">Validate that <code>main-certificate</code> has the CanSignHttpExchanges extension
(<a href="#cross-origin-cert-req" class="xref">Section 4.2</a>).<a href="#section-4-4.7.2.2" class="pilcrow">¶</a>
</li>
            <li id="section-4-4.7.2.3">Validate that <code>main-certificate</code> has an <code>ocsp</code> property
(<a href="#cert-chain-format" class="xref">Section 3.3</a>) with a valid OCSP response whose lifetime
(<code>nextUpdate - thisUpdate</code>) is less than 7 days (<span>[<a href="#RFC6960" class="xref">RFC6960</a>]</span>). Note that
this does not check for revocation of intermediate certificates, and
clients SHOULD implement another mechanism for that.<a href="#section-4-4.7.2.3" class="pilcrow">¶</a>
</li>
            <li id="section-4-4.7.2.4">
              <p id="section-4-4.7.2.4.1">Validate that valid SCTs from trusted logs are available from any of:<a href="#section-4-4.7.2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-4.7.2.4.2.1">The <code>SignedCertificateTimestampList</code> in <code>main-certificate</code>'s <code>sct</code>
property (<a href="#cert-chain-format" class="xref">Section 3.3</a>),<a href="#section-4-4.7.2.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4-4.7.2.4.2.2">An OCSP extension in the OCSP response in <code>main-certificate</code>'s <code>ocsp</code>
property, or<a href="#section-4-4.7.2.4.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-4-4.7.2.4.2.3">An X.509 extension in the certificate in <code>main-certificate</code>'s <code>cert</code>
property,<a href="#section-4-4.7.2.4.2.3" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-4-4.7.2.4.3">
as described by Section 3.3 of <span>[<a href="#RFC6962" class="xref">RFC6962</a>]</span>.<a href="#section-4-4.7.2.4.3" class="pilcrow">¶</a></p>
</li>
          </ol>
</li>
        <li id="section-4-4.8">Return "valid".<a href="#section-4-4.8" class="pilcrow">¶</a>
</li>
      </ol>
<div id="uncached-headers">
<section id="section-4.1">
        <h3 id="name-uncached-header-fields">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-uncached-header-fields" class="section-name selfRef">Uncached header fields</a>
        </h3>
<p id="section-4.1-1">Hop-by-hop and other uncached headers MUST NOT appear in a signed exchange.
These will eventually be listed in <span>[<a href="#I-D.ietf-httpbis-cache" class="xref">I-D.ietf-httpbis-cache</a>]</span>, but for now
they're listed here:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">Hop-by-hop header fields listed in the Connection header field (Section 6.1 of
<span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>).<a href="#section-4.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-2.2">Header fields listed in the no-cache response directive in the Cache-Control
header field (Section 5.2.2.2 of <span>[<a href="#RFC7234" class="xref">RFC7234</a>]</span>).<a href="#section-4.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">Header fields defined as hop-by-hop:<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.3.2.1">Connection<a href="#section-4.1-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.1-2.3.2.2">Keep-Alive<a href="#section-4.1-2.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.1-2.3.2.3">Proxy-Connection<a href="#section-4.1-2.3.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.1-2.3.2.4">Trailer<a href="#section-4.1-2.3.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.1-2.3.2.5">Transfer-Encoding<a href="#section-4.1-2.3.2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.1-2.3.2.6">Upgrade<a href="#section-4.1-2.3.2.6" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.1-2.4">Stateful headers as defined below.<a href="#section-4.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<div id="stateful-headers">
<section id="section-4.1.1">
          <h4 id="name-stateful-header-fields">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-stateful-header-fields" class="section-name selfRef">Stateful header fields</a>
          </h4>
<p id="section-4.1.1-1">As described in <a href="#seccons-over-signing" class="xref">Section 6.1</a>, a publisher can cause problems if they
sign an exchange that includes private information. There's no way for a client
to be sure an exchange does or does not include private information, but header
fields that store or convey stored state in the client are a good sign.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">A stateful response header field modifies state, including authentication
status, in the client. The HTTP cache is not considered part of this state.
These include but are not limited to:<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-3.1">
              <code>Authentication-Control</code>, <span>[<a href="#RFC8053" class="xref">RFC8053</a>]</span><a href="#section-4.1.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.2">
              <code>Authentication-Info</code>, <span>[<a href="#RFC7615" class="xref">RFC7615</a>]</span><a href="#section-4.1.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.3">
              <code>Clear-Site-Data</code>, <span>[<a href="#W3C.WD-clear-site-data-20171130" class="xref">W3C.WD-clear-site-data-20171130</a>]</span><a href="#section-4.1.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.4">
              <code>Optional-WWW-Authenticate</code>, <span>[<a href="#RFC8053" class="xref">RFC8053</a>]</span><a href="#section-4.1.1-3.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.5">
              <code>Proxy-Authenticate</code>, <span>[<a href="#RFC7235" class="xref">RFC7235</a>]</span><a href="#section-4.1.1-3.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.6">
              <code>Proxy-Authentication-Info</code>, <span>[<a href="#RFC7615" class="xref">RFC7615</a>]</span><a href="#section-4.1.1-3.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.7">
              <code>Public-Key-Pins</code>, <span>[<a href="#RFC7469" class="xref">RFC7469</a>]</span><a href="#section-4.1.1-3.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.8">
              <code>Sec-WebSocket-Accept</code>, <span>[<a href="#RFC6455" class="xref">RFC6455</a>]</span><a href="#section-4.1.1-3.8" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.9">
              <code>Set-Cookie</code>, <span>[<a href="#RFC6265" class="xref">RFC6265</a>]</span><a href="#section-4.1.1-3.9" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.10">
              <code>Set-Cookie2</code>, <span>[<a href="#RFC2965" class="xref">RFC2965</a>]</span><a href="#section-4.1.1-3.10" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.11">
              <code>SetProfile</code>, <span>[<a href="#W3C.NOTE-OPS-OverHTTP" class="xref">W3C.NOTE-OPS-OverHTTP</a>]</span><a href="#section-4.1.1-3.11" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.12">
              <code>Strict-Transport-Security</code>, <span>[<a href="#RFC6797" class="xref">RFC6797</a>]</span><a href="#section-4.1.1-3.12" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.13">
              <code>WWW-Authenticate</code>, <span>[<a href="#RFC7235" class="xref">RFC7235</a>]</span><a href="#section-4.1.1-3.13" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="cross-origin-cert-req">
<section id="section-4.2">
        <h3 id="name-certificate-requirements">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-certificate-requirements" class="section-name selfRef">Certificate Requirements</a>
        </h3>
<p id="section-4.2-1">We define a new X.509 extension, CanSignHttpExchanges to be used in the
certificate when the certificate permits the usage of signed exchanges.  When
this extension is not present the client MUST NOT accept a signature from the
certificate as proof that a signed exchange is authoritative for a domain
covered by the certificate. When it is present, the client MUST follow the
validation procedure in <a href="#cross-origin-trust" class="xref">Section 4</a>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-asn.1" id="section-4.2-2">
<pre>
   id-ce-canSignHttpExchanges OBJECT IDENTIFIER ::= { TBD }

   CanSignHttpExchanges ::= NULL
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2-3">Note that this extension contains an ASN.1 NULL (bytes <code>05 00</code>) because some
implementations have bugs with empty extensions.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Leaf certificates without this extension need to be revoked if the private key
is exposed to an unauthorized entity, but they generally don't need to be
revoked if a signing oracle is exposed and then removed.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">CA certificates, by contrast, need to be revoked if an unauthorized entity is
able to make even one unauthorized signature.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">Certificates with this extension MUST be revoked if an unauthorized entity is
able to make even one unauthorized signature.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">Certificates with this extension MUST have a Validity Period no greater than 90
days.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2-8">Conforming CAs MUST NOT mark this extension as critical.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
<p id="section-4.2-9">A conforming CA MUST NOT issue certificates with this extension unless, for each
dNSName in the subjectAltName extension of the certificate to be issued:<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2-10">
          <li id="section-4.2-10.1">An "issue" or "issuewild" CAA property (<span>[<a href="#RFC6844" class="xref">RFC6844</a>]</span>) exists that authorizes
the CA to issue the certificate; and<a href="#section-4.2-10.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-10.2">The "cansignhttpexchanges" parameter (<a href="#caa-cansignhttpexchanges" class="xref">Section 4.2.1</a>) is
present on the property and is equal to "yes"<a href="#section-4.2-10.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.2-11">Clients MUST NOT accept certificates with this extension in TLS connections
(Section 4.4.2.2 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>).<a href="#section-4.2-11" class="pilcrow">¶</a></p>
<p id="section-4.2-12">RFC EDITOR PLEASE DELETE THE REST OF THE PARAGRAPHS IN THIS SECTION<a href="#section-4.2-12" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-asn.1" id="section-4.2-13">
<pre>
   id-ce-google OBJECT IDENTIFIER ::= { 1 3 6 1 4 1 11129 }
   id-ce-canSignHttpExchangesDraft OBJECT IDENTIFIER ::= { id-ce-google 2 1 22 }
</pre><a href="#section-4.2-13" class="pilcrow">¶</a>
</div>
<p id="section-4.2-14">Implementations of drafts of this specification MAY recognize the
<code>id-ce-canSignHttpExchangesDraft</code> OID as identifying the CanSignHttpExchanges
extension. This OID might or might not be used as the final OID for the
extension, so certificates including it might need to be reissued once the final
RFC is published.<a href="#section-4.2-14" class="pilcrow">¶</a></p>
<p id="section-4.2-15">Some certificates have already been issued with this extension and with validity
periods longer than 90 days. These certificates will not immediately be treated
as invalid. Instead:<a href="#section-4.2-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-16.1">Clients MUST reject certificates with this extension that were issued after
2019-05-01 and have a Validity Period longer than 90 days.<a href="#section-4.2-16.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-16.2">After 2019-08-01, clients MUST reject all certificates with this extension
that have a Validity Period longer than 90 days.<a href="#section-4.2-16.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-17">The above requirements on CAs to limit the Validity Period and check for a CAA
parameter are effective starting 2019-05-01.<a href="#section-4.2-17" class="pilcrow">¶</a></p>
<div id="caa-cansignhttpexchanges">
<section id="section-4.2.1">
          <h4 id="name-extensions-to-the-caa-recor">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-extensions-to-the-caa-recor" class="section-name selfRef">Extensions to the CAA Record: cansignhttpexchanges Parameter</a>
          </h4>
<p id="section-4.2.1-1">A CAA parameter "cansignhttpexchanges" is defined for the "issue" and
"issuewild" properties defined by <span>[<a href="#RFC6844" class="xref">RFC6844</a>]</span>.  The value of this parameter, if
specified, MUST be "yes".<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="transfer">
<section id="section-5">
      <h2 id="name-transferring-a-signed-excha">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-transferring-a-signed-excha" class="section-name selfRef">Transferring a signed exchange</a>
      </h2>
<p id="section-5-1">A signed exchange can be transferred in several ways, of which three are
described here.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="same-origin-response">
<section id="section-5.1">
        <h3 id="name-same-origin-response">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-same-origin-response" class="section-name selfRef">Same-origin response</a>
        </h3>
<p id="section-5.1-1">The signature for a signed exchange can be included in a normal HTTP response.
Because different clients send different request header fields, clients don't
know how the server's content negotiation algorithm works, and intermediate
servers add response header fields, it can be impossible to have a signature for
the exchange's exact request, content negotiation, and response. Therefore, when a client
calls the validation procedure in <a href="#signature-validity" class="xref">Section 3.5</a>) to validate the
<code>Signature</code> header field for an exchange represented as a normal HTTP
request/response pair, it MUST pass:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">The <code>Signature</code> header field,<a href="#section-5.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.2">The effective request URI (Section 5.5 of <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>) of the request,<a href="#section-5.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.3">The serialized headers defined by <a href="#serialized-headers" class="xref">Section 5.1.1</a>, and<a href="#section-5.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-2.4">The response's payload.<a href="#section-5.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-3">If the client relies on signature validity for any aspect of its behavior, it
MUST ignore any header fields that it didn't pass to the validation procedure.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">If the signed response includes a <code>Variants</code> header field, the client MUST use
the cache behavior algorithm in Section 4 of <span>[<a href="#I-D.ietf-httpbis-variants" class="xref">I-D.ietf-httpbis-variants</a>]</span> to
check that the signed response is an appropriate representation for the request
the client is trying to fulfil. If the response is not an appropriate
representation, the client MUST treat the signature as invalid.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<div id="serialized-headers">
<section id="section-5.1.1">
          <h4 id="name-serialized-headers-for-a-sa">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-serialized-headers-for-a-sa" class="section-name selfRef">Serialized headers for a same-origin response</a>
          </h4>
<p id="section-5.1.1-1">The serialized headers of an exchange represented as a normal HTTP
request/response pair (Section 2.1 of <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span> or Section 8.1 of
<span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>) are the canonical serialization (<a href="#canonical-cbor" class="xref">Section 3.4</a>) of the CBOR
representation (<a href="#cbor-representation" class="xref">Section 3.2</a>) of the response status code (Section 6
of <span>[<a href="#RFC7231" class="xref">RFC7231</a>]</span>) and the response header fields whose names are listed in that
response's <code>Signed-Headers</code> header field (<a href="#signed-headers" class="xref">Section 5.1.2</a>). If a response
header field name from <code>Signed-Headers</code> does not appear in the response's header
fields, the exchange has no serialized headers.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">If the exchange's <code>Signed-Headers</code> header field is not present, doesn't parse as
a Structured Header (<span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>) or doesn't follow
the constraints on its value described in <a href="#signed-headers" class="xref">Section 5.1.2</a>, the exchange has
no serialized headers.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<div id="oq-serialized-headers">
<section id="section-5.1.1.1">
            <h5 id="name-open-questions-4">
<a href="#section-5.1.1.1" class="section-number selfRef">5.1.1.1. </a><a href="#name-open-questions-4" class="section-name selfRef">Open Questions</a>
            </h5>
<p id="section-5.1.1.1-1">Do the serialized headers of an exchange need to include the <code>Signed-Headers</code>
header field itself?<a href="#section-5.1.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="signed-headers">
<section id="section-5.1.2">
          <h4 id="name-the-signed-headers-header">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-the-signed-headers-header" class="section-name selfRef">The Signed-Headers Header</a>
          </h4>
<p id="section-5.1.2-1">The <code>Signed-Headers</code> header field identifies an ordered list of response header
fields to include in a signature. The request URL and response status are
included unconditionally. This allows a TLS-terminating intermediate to reorder
headers without breaking the signature. This <em>can</em> also allow the intermediate
to add headers that will be ignored by some higher-level protocols, but
<a href="#signature-validity" class="xref">Section 3.5</a> provides a hook to let other higher-level protocols
reject such insecure headers.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">This header field appears once instead of being incorporated into the
signatures' parameters because the signed header fields need to be consistent
across all signatures of an exchange, to avoid forcing higher-level protocols to
merge the header field lists of valid signatures.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3"><code>Signed-Headers</code> is a Structured Header as defined by
<span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>. Its value MUST be a list (Section 3.2 of
<span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>). Its ABNF is:<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1.2-4">
<pre>
Signed-Headers = sh-list
</pre><a href="#section-5.1.2-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-5">Each element of the <code>Signed-Headers</code> list must be a lowercase string (Section
3.8 of <span>[<a href="#I-D.ietf-httpbis-header-structure" class="xref">I-D.ietf-httpbis-header-structure</a>]</span>) naming an HTTP response header
field. Pseudo-header field names (Section 8.1.2.1 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>) MUST NOT
appear in this list.<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<p id="section-5.1.2-6">Higher-level protocols SHOULD place requirements on the minimum set of headers
to include in the <code>Signed-Headers</code> header field.<a href="#section-5.1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cross-origin-push">
<section id="section-5.2">
        <h3 id="name-http-2-extension-for-cross-">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-http-2-extension-for-cross-" class="section-name selfRef">HTTP/2 extension for cross-origin Server Push</a>
        </h3>
<p id="section-5.2-1">To allow servers to Server-Push (Section 8.2 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>) signed exchanges
(<a href="#proposal" class="xref">Section 3</a>) signed by an authority for which the server is not authoritative
(Section 9.1 of <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>), this section defines an HTTP/2 extension.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="setting">
<section id="section-5.2.1">
          <h4 id="name-indicating-support-for-cros">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-indicating-support-for-cros" class="section-name selfRef">Indicating support for cross-origin Server Push</a>
          </h4>
<p id="section-5.2.1-1">Clients that might accept signed Server Pushes with an authority for which the
server is not authoritative indicate this using the HTTP/2 SETTINGS parameter
ENABLE_CROSS_ORIGIN_PUSH (0xSETTING-TBD).<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">An ENABLE_CROSS_ORIGIN_PUSH value of 0 indicates that the client does not
support cross-origin Push. A value of 1 indicates that the client does support
cross-origin Push.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">A client MUST NOT send a ENABLE_CROSS_ORIGIN_PUSH setting with a value other
than 0 or 1 or a value of 0 after previously sending a value of 1. If a server
receives a value that violates these rules, it MUST treat it as a connection
error (Section 5.4.1 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>) of type PROTOCOL_ERROR.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1-4">The use of a SETTINGS parameter to opt-in to an otherwise incompatible protocol
change is a use of "Extending HTTP/2" defined by Section 5.5 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>. If
a server were to send a cross-origin Push without first receiving a
ENABLE_CROSS_ORIGIN_PUSH setting with the value of 1 it would be a protocol
violation.<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="error-code">
<section id="section-5.2.2">
          <h4 id="name-no_trusted_exchange_signatu">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-no_trusted_exchange_signatu" class="section-name selfRef">NO_TRUSTED_EXCHANGE_SIGNATURE error code</a>
          </h4>
<p id="section-5.2.2-1">The signatures on a Pushed cross-origin exchange may be untrusted for several
reasons, for example that the certificate could not be fetched, that the
certificate does not chain to a trusted root, that the signature itself doesn't
validate, that the signature is expired, etc. This draft conflates all of these
possible failures into one error code, NO_TRUSTED_EXCHANGE_SIGNATURE
(0xERROR-TBD).<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<div id="oq-error-code">
<section id="section-5.2.2.1">
            <h5 id="name-open-questions-5">
<a href="#section-5.2.2.1" class="section-number selfRef">5.2.2.1. </a><a href="#name-open-questions-5" class="section-name selfRef">Open Questions</a>
            </h5>
<p id="section-5.2.2.1-1">How fine-grained should this specification's error codes be?<a href="#section-5.2.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="validating-cross-origin-push">
<section id="section-5.2.3">
          <h4 id="name-validating-a-cross-origin-p">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-validating-a-cross-origin-p" class="section-name selfRef">Validating a cross-origin Push</a>
          </h4>
<p id="section-5.2.3-1">If the client has set the ENABLE_CROSS_ORIGIN_PUSH setting to 1, the server MAY
Push a signed exchange for which it is not authoritative, and the client MUST
NOT treat a PUSH_PROMISE for which the server is not authoritative as a stream
error (Section 5.4.2 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>) of type PROTOCOL_ERROR, as described in
Section 8.2 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>, unless there is another error as described below.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3-2">Instead, the client MUST validate such a PUSH_PROMISE and its response against
the following list:<a href="#section-5.2.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.3-3">
            <li id="section-5.2.3-3.1">If the PUSH_PROMISE includes any non-pseudo request header fields, the client
MUST treat it as a stream error (Section 5.4.2 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>) of type
PROTOCOL_ERROR.<a href="#section-5.2.3-3.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.3-3.2">If the PUSH_PROMISE's method is not <code>GET</code>, the client MUST treat it as a
stream error (Section 5.4.2 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>) of type PROTOCOL_ERROR.<a href="#section-5.2.3-3.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.3-3.3">
              <p id="section-5.2.3-3.3.1">Run the algorithm in <a href="#cross-origin-trust" class="xref">Section 4</a> over:<a href="#section-5.2.3-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3-3.3.2.1">The <code>Signature</code> header field from the response.<a href="#section-5.2.3-3.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.3-3.3.2.2">The effective request URI from the PUSH_PROMISE.<a href="#section-5.2.3-3.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.3-3.3.2.3">The canonical serialization (<a href="#canonical-cbor" class="xref">Section 3.4</a>) of the CBOR representation
(<a href="#cbor-representation" class="xref">Section 3.2</a>) of the pushed response's status and its headers
except for the <code>Signature</code> header field.<a href="#section-5.2.3-3.3.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.3-3.3.2.4">The response's payload.<a href="#section-5.2.3-3.3.2.4" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-5.2.3-3.3.3">
If this returns "invalid", the client MUST treat the response as a stream error
(Section 5.4.2 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>) of type NO_TRUSTED_EXCHANGE_SIGNATURE.
Otherwise, the client MUST treat the pushed response as if the server were
authoritative for the PUSH_PROMISE's authority.<a href="#section-5.2.3-3.3.3" class="pilcrow">¶</a></p>
</li>
          </ol>
<div id="oq-cross-origin-push">
<section id="section-5.2.3.1">
            <h5 id="name-open-questions-6">
<a href="#section-5.2.3.1" class="section-number selfRef">5.2.3.1. </a><a href="#name-open-questions-6" class="section-name selfRef">Open Questions</a>
            </h5>
<p id="section-5.2.3.1-1">Is it right that "validity-url" is required to be same-origin with the exchange?
This allows the mitigation against downgrades in <a href="#seccons-downgrades" class="xref">Section 6.3</a>, but
prohibits intermediates from providing a cache of the validity information. We
could do both with a list of URLs.<a href="#section-5.2.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="application-signed-exchange">
<section id="section-5.3">
        <h3 id="name-application-signed-exchange">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-application-signed-exchange" class="section-name selfRef">application/signed-exchange format</a>
        </h3>
<p id="section-5.3-1">To allow signed exchanges to be the targets of <code>&lt;link rel=prefetch&gt;</code> tags, we
define the  <code>application/signed-exchange</code> content type that represents a signed
HTTP exchange, including a request URL, response metadata
and header fields, and a response payload.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">When served over HTTP, a response containing an <code>application/signed-exchange</code>
payload MUST include at least the following response header fields, to reduce
content sniffing vulnerabilities (<a href="#seccons-content-sniffing" class="xref">Section 6.8</a>):<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-3.1">Content-Type: application/signed-exchange;v=<em>version</em><a href="#section-5.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-3.2">X-Content-Type-Options: nosniff<a href="#section-5.3-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-4">This content type consists of the concatenation of the following items:<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3-5">
          <li id="section-5.3-5.1">
            <p id="section-5.3-5.1.1">8 bytes consisting of the ASCII characters "sxg1" followed by 4 0x00 bytes,
to serve as a file signature. This is redundant with the MIME type, and
recipients that receive both MUST check that they match and stop parsing if
they don't.<a href="#section-5.3-5.1.1" class="pilcrow">¶</a></p>
<p id="section-5.3-5.1.2">
Note: RFC EDITOR PLEASE DELETE THIS NOTE; The implementation of the final RFC
MUST use this file signature, but implementations of drafts MUST NOT use it
and MUST use another implementation-specific 8-byte string beginning with
"sxg1-".<a href="#section-5.3-5.1.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.3-5.2">2 bytes storing a big-endian integer <code>fallbackUrlLength</code>.<a href="#section-5.3-5.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-5.3">
            <p id="section-5.3-5.3.1"><code>fallbackUrlLength</code> bytes holding a <code>fallbackUrl</code>, which MUST UTF-8 decode to
an absolute URL with a scheme of "https".<a href="#section-5.3-5.3.1" class="pilcrow">¶</a></p>
<p id="section-5.3-5.3.2">
Note: The byte location of the fallback URL is intended to remain invariant
across versions of the <code>application/signed-exchange</code> format so that parsers
encountering unknown versions can always find a URL to redirect to.<a href="#section-5.3-5.3.2" class="pilcrow">¶</a></p>
<p id="section-5.3-5.3.3">
Issue: Should this fallback information also include the method?<a href="#section-5.3-5.3.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.3-5.4">3 bytes storing a big-endian integer <code>sigLength</code>. If this is larger than
16384 (16*1024), parsing MUST fail.<a href="#section-5.3-5.4" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-5.5">3 bytes storing a big-endian integer <code>headerLength</code>. If this is larger than
524288 (512*1024), parsing MUST fail.<a href="#section-5.3-5.5" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-5.6">
            <code>sigLength</code> bytes holding the <code>Signature</code> header field's value
(<a href="#signature-header" class="xref">Section 3.1</a>).<a href="#section-5.3-5.6" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-5.7">
            <code>headerLength</code> bytes holding <code>signedHeaders</code>, the canonical serialization
(<a href="#canonical-cbor" class="xref">Section 3.4</a>) of the CBOR representation of the response
headers of the exchange represented by the <code>application/signed-exchange</code>
resource (<a href="#cbor-representation" class="xref">Section 3.2</a>), excluding the <code>Signature</code> header field.<a href="#section-5.3-5.7" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-5.8">
            <p id="section-5.3-5.8.1">The payload body (Section 3.3 of <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>) of the exchange represented by
the <code>application/signed-exchange</code> resource.<a href="#section-5.3-5.8.1" class="pilcrow">¶</a></p>
<p id="section-5.3-5.8.2">
Note that the use of the payload body here means that a <code>Transfer-Encoding</code>
header field inside the <code>application/signed-exchange</code> header block has no
effect. A <code>Transfer-Encoding</code> header field on the outer HTTP response that
transfers this resource still has its normal effect.<a href="#section-5.3-5.8.2" class="pilcrow">¶</a></p>
</li>
        </ol>
<div id="co-trust-app-signed-exchange">
<section id="section-5.3.1">
          <h4 id="name-cross-origin-trust-in-appli">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-cross-origin-trust-in-appli" class="section-name selfRef">Cross-origin trust in application/signed-exchange</a>
          </h4>
<p id="section-5.3.1-1">To determine whether to trust a cross-origin exchange stored in an
<code>application/signed-exchange</code> resource, pass the <code>Signature</code> header field's
value, <code>fallbackUrl</code> as the effective request URI, <code>signedHeaders</code>, and the
payload body to the algorithm in <a href="#cross-origin-trust" class="xref">Section 4</a>.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-application-signed-exchange">
<section id="section-5.3.2">
          <h4 id="name-example-2">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-example-2" class="section-name selfRef">Example</a>
          </h4>
<p id="section-5.3.2-1">An example <code>application/signed-exchange</code> file representing a possible signed
exchange with <a href="https://example.com/">https://example.com/</a> follows, with lengths represented by
descriptions in <code>&lt;&gt;</code>s, CBOR represented in the extended diagnostic format
defined in Appendix G of <span>[<a href="#CDDL" class="xref">CDDL</a>]</span>, and most of the <code>Signature</code> header field and
payload elided with a ...:<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.3.2-2">
<pre>
sxg1\0\0\0\0&lt;2-byte length of the following url string&gt;
https://example.com/&lt;3-byte length of the following header
value&gt;&lt;3-byte length of the encoding of the
following map&gt;sig1; sig=*...; integrity="digest/mi-sha256"; ...{
  ':status': '200',
  'content-type': 'text/html'
}&lt;!doctype html&gt;\r\n&lt;html&gt;...
</pre><a href="#section-5.3.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="oq-application-signed-exchange">
<section id="section-5.3.3">
          <h4 id="name-open-questions-7">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-open-questions-7" class="section-name selfRef">Open Questions</a>
          </h4>
<p id="section-5.3.3-1">Should this be a CBOR format, or is the current mix of binary and CBOR better?<a href="#section-5.3.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3.3-2">Are the mime type, extension, and magic number right?<a href="#section-5.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security considerations</a>
      </h2>
<div id="seccons-over-signing">
<section id="section-6.1">
        <h3 id="name-over-signing">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-over-signing" class="section-name selfRef">Over-signing</a>
        </h3>
<p id="section-6.1-1">If a publisher blindly signs all responses as their origin, they can cause at
least two kinds of problems, described below. To avoid this, publishers SHOULD
design their systems to opt particular public content that doesn't depend on
authentication status into signatures instead of signing by default.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Signing systems SHOULD also incorporate the following mitigations to reduce the
risk that private responses are signed:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-3">
          <li id="section-6.1-3.1">Strip the <code>Cookie</code> request header field and other identifying information
like client authentication and TLS session IDs from requests whose exchange
is destined to be signed, before forwarding the request to a backend.<a href="#section-6.1-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-3.2">Only sign exchanges where the response includes a <code>Cache-Control: public</code>
header. Clients are not required to fail signature-checking for exchanges
that omit this <code>Cache-Control</code> response header field to reduce the risk that
naive signing systems blindly add it.<a href="#section-6.1-3.2" class="pilcrow">¶</a>
</li>
        </ol>
<div id="seccons-session-fixation">
<section id="section-6.1.1">
          <h4 id="name-session-fixation">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-session-fixation" class="section-name selfRef">Session fixation</a>
          </h4>
<p id="section-6.1.1-1">Blind signing can sign responses that create session cookies or otherwise change
state on the client to identify a particular session. This breaks certain kinds
of CSRF defense and can allow an attacker to force a user into the attacker's
account, where the user might unintentionally save private information, like
credit card numbers or addresses.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">This specification defends against cookie-based attacks by blocking the
<code>Set-Cookie</code> response header, but it cannot prevent Javascript or other response
content from changing state.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="seccons-misleading-content">
<section id="section-6.1.2">
          <h4 id="name-misleading-content">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-misleading-content" class="section-name selfRef">Misleading content</a>
          </h4>
<p id="section-6.1.2-1">If a site signs private information, an attacker might set up their own account
to show particular private information, forward that signed information to a
victim, and use that victim's confusion in a more sophisticated attack.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">Stripping authentication information from requests before sending them to
backends is likely to prevent the backend from showing attacker-specific
information in the signed response. It does not prevent the attacker from
showing their victim a signed-out page when the victim is actually signed in,
but while this is still misleading, it seems less likely to be useful to the
attacker.<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="seccons-off-path">
<section id="section-6.2">
        <h3 id="name-off-path-attackers">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-off-path-attackers" class="section-name selfRef">Off-path attackers</a>
        </h3>
<p id="section-6.2-1">Relaxing the requirement to consult DNS when determining authority for an origin
means that an attacker who possesses a valid certificate no longer needs to be
on-path to redirect traffic to them; instead of modifying DNS or IP routing,
they need only convince the user to visit another Web site in order to serve
responses signed as the target. This consideration and mitigations for it are
shared by the combination of <span>[<a href="#RFC8336" class="xref">RFC8336</a>]</span> and
<span>[<a href="#I-D.ietf-httpbis-http2-secondary-certs" class="xref">I-D.ietf-httpbis-http2-secondary-certs</a>]</span>, and are discussed further in
<span>[<a href="#I-D.bishop-httpbis-origin-fed-up" class="xref">I-D.bishop-httpbis-origin-fed-up</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="mis-issued-certificates">
<section id="section-6.2.1">
          <h4 id="name-mis-issued-certificates">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-mis-issued-certificates" class="section-name selfRef">Mis-issued certificates</a>
          </h4>
<p id="section-6.2.1-1">If a CA mis-issues a certificate for a domain, this specification provides a way
to detect the mis-issuance and mitigate harm within approximately two weeks.
Specifically, because all signed exchanges must include a
<code>SignedCertificateTimestampList</code> (<span>[<a href="#RFC6962" class="xref">RFC6962</a>]</span>, a CT log has promised to publish
the mis-issued certificate within that log's Maximum Merge Delay, 1 day for many
logs. The domain owner can then detect the mis-issued certificate and notify the
CA to revoke it, which the <span>[<a href="#BRs" class="xref">BRs</a>]</span>, section 4.9.1.1, say they must do within
another 5 days.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">Once the mis-issued certificate is revoked, existing OCSP responses begin to
expire. The <span>[<a href="#BRs" class="xref">BRs</a>]</span>, section 4.9.10, require that OCSP responses have a maximum
expiration time of 10 days, after which they can't be used to validate a
certificate chain (<a href="#cert-chain-format" class="xref">Section 3.3</a>). This leads to a total compromised
time of 16 days after a mis-issuance.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<p id="section-6.2.1-3">However, CAs might future-date their OCSP responses, in which case the
mitigation doesn't work.<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<p id="section-6.2.1-4">CAs are forbidden from future-dating their OCSP responses by the <span>[<a href="#BRs" class="xref">BRs</a>]</span> section
4.9.9, "OCSP responses MUST conform to RFC6960 and/or RFC5019." <span>[<a href="#RFC6960" class="xref">RFC6960</a>]</span>
includes, "The time at which the status was known to be correct SHALL be
reflected in the thisUpdate field of the response.", and <span>[<a href="#RFC5019" class="xref">RFC5019</a>]</span> includes,
"When pre-producing OCSPResponse messages, the responder MUST set the
thisUpdate, nextUpdate, and producedAt times as follows: thisUpdate: The time at
which the status being indicated is known to be correct."<a href="#section-6.2.1-4" class="pilcrow">¶</a></p>
<p id="section-6.2.1-5">However, if a CA violates the <span>[<a href="#BRs" class="xref">BRs</a>]</span> to sign future-dated OCSP responses,
attempts to keep the nonconformant OCSP responses private, but then leaks them,
it could cause clients to trust a hostile signed exchange long after its
certificate has been revoked.<a href="#section-6.2.1-5" class="pilcrow">¶</a></p>
<p id="section-6.2.1-6">Clients could use systems like <span>[<a href="#CRLSets" class="xref">CRLSets</a>]</span> and <span>[<a href="#OneCrl" class="xref">OneCrl</a>]</span> to revoke the
intermediate certificate that signed the future-dated OCSP responses.<a href="#section-6.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="stolen-private-keys">
<section id="section-6.2.2">
          <h4 id="name-stolen-private-keys">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-stolen-private-keys" class="section-name selfRef">Stolen private keys</a>
          </h4>
<p id="section-6.2.2-1">If the private key for a CanSignHttpExchanges certificate is stolen, it can be
used at scale until the certificate expires or is revoked, and unlike for a
stolen key for a normal TLS-terminating certificate, the rightful owner can't
detect the problem by watching for attacks on the DNS or routing infrastructure.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2.2-2">This specification does not currently propose a way for the rightful owner to
detect that their keys are being used by an attacker, after they've opted into
the risk by requesting a CanSignHttpExchanges certificate in the first place.
Clients can fetch a signature's "validity-url" (<a href="#signature-header" class="xref">Section 3.1</a>) to help
owners detect key compromise, but that compromises some of the privacy
properties of this specification.<a href="#section-6.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="seccons-downgrades">
<section id="section-6.3">
        <h3 id="name-downgrades">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-downgrades" class="section-name selfRef">Downgrades</a>
        </h3>
<p id="section-6.3-1">Signing a bad response can affect more users than simply serving a bad response,
since a served response will only affect users who make a request while the bad
version is live, while an attacker can forward a signed response until its
signature expires. Publishers should consider shorter signature expiration times
than they use for cache expiration times.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">Clients MAY also check the <span><a href="#signature-validityurl" class="xref">"validity-url"</a> (<a href="#signature-validityurl" class="xref">Section 3.1</a>)</span> of an
exchange more often than the signature's expiration would require. Doing so for
an exchange with an HTTPS request URI provides a TLS guarantee that the exchange
isn't out of date (as long as <a href="#oq-cross-origin-push" class="xref">Section 5.2.3.1</a> is resolved to keep the
same-origin requirement).<a href="#section-6.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="seccons-signing-oracles">
<section id="section-6.4">
        <h3 id="name-signing-oracles-are-permane">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-signing-oracles-are-permane" class="section-name selfRef">Signing oracles are permanent</a>
        </h3>
<p id="section-6.4-1">An attacker with temporary access to a signing oracle can sign "still valid"
assertions with arbitrary timestamps and expiration times. As a result, when a
signing oracle is removed, the keys it provided access to MUST be revoked so
that, even if the attacker used them to sign future-dated exchange validity
assertions, the key's OCSP assertion will expire, causing the exchange as a
whole to become untrusted.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="seccons-unsigned-headers">
<section id="section-6.5">
        <h3 id="name-unsigned-headers">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-unsigned-headers" class="section-name selfRef">Unsigned headers</a>
        </h3>
<p id="section-6.5-1">The use of a single <code>Signed-Headers</code> header field prevents us from signing
aspects of the request other than its effective request URI (Section 5.5 of
<span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>). For example, if a publisher signs both <code>Content-Encoding: br</code> and
<code>Content-Encoding: gzip</code> variants of a response, what's the impact if an
attacker serves the brotli one for a request with <code>Accept-Encoding: gzip</code>? This
is mitigated by using <span>[<a href="#I-D.ietf-httpbis-variants" class="xref">I-D.ietf-httpbis-variants</a>]</span> instead of request headers
to describe how the client should run content negotiation.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">The simple form of <code>Signed-Headers</code> also prevents us from signing less than the
full request URL. The SRI use case (<a href="#uc-sri" class="xref">Appendix A.3</a>) may benefit from being able to
leave the authority less constrained.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3"><a href="#signature-validity" class="xref">Section 3.5</a> can succeed when some delivered headers aren't included
in the signed set. This accommodates current TLS-terminating intermediates and
may be useful for SRI (<a href="#uc-sri" class="xref">Appendix A.3</a>), but is risky for trusting cross-origin
responses (<a href="#uc-pushed-subresources" class="xref">Appendix A.1</a>, <a href="#uc-explicit-distributor" class="xref">Appendix A.2</a>, and
<a href="#uc-offline-websites" class="xref">Appendix A.6</a>). <a href="#cross-origin-push" class="xref">Section 5.2</a> requires all headers to be
included in the signature before trusting cross-origin pushed resources, at Ryan
Sleevi's recommendation.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-application-signed-exchange">
<section id="section-6.6">
        <h3 id="name-application-signed-exchange-2">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-application-signed-exchange-2" class="section-name selfRef">application/signed-exchange</a>
        </h3>
<p id="section-6.6-1">Clients MUST NOT trust an effective request URI claimed by an
<code>application/signed-exchange</code> resource (<a href="#application-signed-exchange" class="xref">Section 5.3</a>) without
either ensuring the resource was transferred from a server that was
authoritative (Section 9.1 of <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>) for that URI's origin, or calling
the algorithm in <a href="#co-trust-app-signed-exchange" class="xref">Section 5.3.1</a> and getting "valid" back.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="seccons-key-re-use">
<section id="section-6.7">
        <h3 id="name-key-re-use-with-tls">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-key-re-use-with-tls" class="section-name selfRef">Key re-use with TLS</a>
        </h3>
<p id="section-6.7-1">In general, key re-use across multiple protocols is a bad idea.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
<p id="section-6.7-2">Using an exchange-signing key in a TLS (or other directly-internet-facing)
server increases the risk that an attacker can steal the private key, which will
allow them to mint packages (similar to <a href="#seccons-signing-oracles" class="xref">Section 6.4</a>) until their
theft is discovered.<a href="#section-6.7-2" class="pilcrow">¶</a></p>
<p id="section-6.7-3">Using a TLS key in a CanSignHttpExchanges certificate makes it less likely that
the server operator will discover key theft, due to the considerations in
<a href="#seccons-off-path" class="xref">Section 6.2</a>.<a href="#section-6.7-3" class="pilcrow">¶</a></p>
<p id="section-6.7-4">This specification uses the CanSignHttpExchanges X.509 extension
(<a href="#cross-origin-cert-req" class="xref">Section 4.2</a>) to discourage re-use of TLS keys to sign exchanges
or vice-versa.<a href="#section-6.7-4" class="pilcrow">¶</a></p>
<p id="section-6.7-5">We require that clients reject certificates with the CanSignHttpExchanges
extension when making TLS connections to minimize the chance that servers will
re-use keys like this. Ideally, we would make the extension critical so that
even clients that don't understand it would reject such TLS connections, but
this proved impossible because certificate-validating libraries ship on
significantly different schedules from the clients that use them.<a href="#section-6.7-5" class="pilcrow">¶</a></p>
<p id="section-6.7-6">Even once all clients reject these certificates in TLS connections, this will
still just discourage and not prevent key re-use, since a server operator can
unwisely request two different certificates with the same private key.<a href="#section-6.7-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="seccons-content-sniffing">
<section id="section-6.8">
        <h3 id="name-content-sniffing">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-content-sniffing" class="section-name selfRef">Content sniffing</a>
        </h3>
<p id="section-6.8-1">While modern browsers tend to trust the <code>Content-Type</code> header sent with a
resource, especially when accompanied by <code>X-Content-Type-Options: nosniff</code>,
plugins will sometimes search for executable content buried inside a resource
and execute it in the context of the origin that served the resource, leading to
XSS vulnerabilities. For example, some PDF reader plugins look for <code>%PDF</code>
anywhere in the first 1kB and execute the code that follows it.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
<p id="section-6.8-2">The <code>application/signed-exchange</code> format (<a href="#application-signed-exchange" class="xref">Section 5.3</a>)
includes a URL and response headers early in the format, which an
attacker could use to cause these plugins to sniff a bad content type.<a href="#section-6.8-2" class="pilcrow">¶</a></p>
<p id="section-6.8-3">To avoid vulnerabilities, in addition to the response header requirements in
<a href="#application-signed-exchange" class="xref">Section 5.3</a>, servers are advised to only serve an
<code>application/signed-exchange</code> resource (SXG) from a domain if it would also be
safe for that domain to serve the SXG's content directly, and to follow at least
one of the following strategies:<a href="#section-6.8-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.8-4">
          <li id="section-6.8-4.1">Only serve signed exchanges from dedicated domains that don't have access to
sensitive cookies or user storage.<a href="#section-6.8-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.8-4.2">Generate signed exchanges "offline", that is, in response to a trusted author
submitting content or existing signatures reaching a certain age, rather than
in response to untrusted-reader queries.<a href="#section-6.8-4.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.8-4.3">
            <p id="section-6.8-4.3.1">Do all of:<a href="#section-6.8-4.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.8-4.3.2">
              <li id="section-6.8-4.3.2.1">If the SXG's fallback URL (<a href="#application-signed-exchange" class="xref">Section 5.3</a>) is derived
from the request URL,
<a href="https://url.spec.whatwg.org/#percent-encode">percent-encode</a> (<span>[<a href="#URL" class="xref">URL</a>]</span>)
any bytes that are greater than 0x7E or are not <a href="https://url.spec.whatwg.org/#url-code-points">URL code
points</a> (<span>[<a href="#URL" class="xref">URL</a>]</span>) in the
fallback URL . It is particularly important to make sure no unescaped
nulls (0x00) or angle brackets (0x3C and 0x3E) appear.<a href="#section-6.8-4.3.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-6.8-4.3.2.2">Do not reflect request header fields into the set of response headers.<a href="#section-6.8-4.3.2.2" class="pilcrow">¶</a>
</li>
            </ol>
</li>
        </ol>
<p id="section-6.8-5">There are still a few binary length fields that an attacker may influence to
contain sensitive bytes, but they're always followed by lowercase alphabetic
strings from a small set of possibilities, which reduces the chance that a
client will sniff them as indicating a particular content type.<a href="#section-6.8-5" class="pilcrow">¶</a></p>
<p id="section-6.8-6">To encourage servers to include the <code>X-Content-Type-Options: nosniff</code> header
field, clients SHOULD reject signed exchanges served without it.<a href="#section-6.8-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy considerations</a>
      </h2>
<div id="visibility-of-resource-requests">
<section id="section-7.1">
        <h3 id="name-visibility-of-resource-requ">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-visibility-of-resource-requ" class="section-name selfRef">Visibility of resource requests</a>
        </h3>
<p id="section-7.1-1">Normally, when a client follows a link from https://source.example/page.html to
<code>https://publisher.example/page.html</code>, <code>publisher.example</code> learns that the
client is interested in the resource. <code>source.example</code> also has several ways of
discovering that the client has clicked the link, including the use of
Javascript to record the click or having the link point to a URL that serves a
302 redirect to the real target.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">If <code>publisher.example</code> signs <code>page.html</code> into <code>page.sxg</code>, <code>distributor.example</code>
serves it as <code>https://distributor.example/publisher/page.sxg</code>, and the client
fetches it from there, then <code>distributor.example</code> learns that the client is
interested, and if the client executes some Javascript on the page or makes
subresource requests, that could also report the client's interest back to
<code>publisher.example</code>.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">To prevent network operators other than <code>distributor.example</code> or
<code>publisher.example</code> from learning which exchanges were read, clients SHOULD only
load exchanges fetched over a transport that's protected from eavesdroppers.
This can be difficult to determine when the exchange is being loaded from local
disk, but when the client itself requested the exchange over a network it SHOULD
require TLS (<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>) or a successor transport layer, and MUST NOT accept
exchanges transferred over plain HTTP without TLS.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">If <code>source.example</code> and <code>distributor.example</code> are controlled by the same entity,
no extra information escapes here. If they are run by different entities, a
similar amount of information escapes as if <code>source.example</code> had implemented its
click tracking by outsourcing to a service like <a href="https://bit.ly/">https://bit.ly/</a>.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">There has been discussion of allowing a publisher to restrict the set of
distributors that can host its signed content. If that's added, then the privacy
situation becomes more similar to the situation with CDNs, where a publisher
chooses a CDN to serve their content, and the CDN learns about all requests for
that content. Here the publisher would choose one or more distributors, and the
distributor(s) would learn about requests for the content.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">For non-executable resource types, a signed response can improve the privacy
situation by hiding the client's interest from the original publisher.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="user-id-transfer">
<section id="section-7.2">
        <h3 id="name-user-id-transfer">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-user-id-transfer" class="section-name selfRef">User ID transfer</a>
        </h3>
<p id="section-7.2-1">If a request for <code>https://distributor.example/publisher/page.sxg</code> comes with the
source's or distributor's user ID for the user, either because it's sent with
the distributor's cookies or because the source stashes an encoded user ID into
either the request's path or a subdomain, the distributor has a few ways to
pass that user ID on to the publisher that signed the page:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.2-2">
          <li id="section-7.2-2.1">If the distributor has the publisher's signing keys, it can sign a new page
with its user ID directly embedded.<a href="#section-7.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-7.2-2.2">Otherwise, the publisher can sign lots of copies of their package, and the
distributor can choose a particular copy to send a subset of the bits in its
user ID to the publisher on each click, which will eventually transfer the
whole thing.<a href="#section-7.2-2.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-7.2-3">To prevent this, the request for a signed exchange needs to omit credentials and
block them from appearing in the URL in the same way it would block them from
appearing in a cross-origin URL. We're exploring ways the link can mark the
request so user agents can take the right counter-measures.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA considerations</a>
      </h2>
<p id="section-8-1">TODO: possibly register the validity-url format.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="signature-header-field-registration">
<section id="section-8.1">
        <h3 id="name-signature-header-field-regi">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-signature-header-field-regi" class="section-name selfRef">Signature Header Field Registration</a>
        </h3>
<p id="section-8.1-1">This section registers the <code>Signature</code> header field in the "Permanent Message
Header Field Names" registry (<span>[<a href="#RFC3864" class="xref">RFC3864</a>]</span>).<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Header field name:  <code>Signature</code><a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">Applicable protocol:  http<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">Status:  standard<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5">Author/Change controller:  IETF<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<p id="section-8.1-6">Specification document(s):  <a href="#signature-header" class="xref">Section 3.1</a> of this document<a href="#section-8.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="accept-signature-header-field-registration">
<section id="section-8.2">
        <h3 id="name-accept-signature-header-fie">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-accept-signature-header-fie" class="section-name selfRef">Accept-Signature Header Field Registration</a>
        </h3>
<p id="section-8.2-1">This section registers the <code>Accept-Signature</code> header field in the "Permanent
Message Header Field Names" registry (<span>[<a href="#RFC3864" class="xref">RFC3864</a>]</span>).<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">Header field name:  <code>Accept-Signature</code><a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Applicable protocol:  http<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">Status:  standard<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5">Author/Change controller:  IETF<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<p id="section-8.2-6">Specification document(s):  <a href="#accept-signature" class="xref">Section 3.7</a> of this document<a href="#section-8.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signed-headers-header-field-registration">
<section id="section-8.3">
        <h3 id="name-signed-headers-header-field">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-signed-headers-header-field" class="section-name selfRef">Signed-Headers Header Field Registration</a>
        </h3>
<p id="section-8.3-1">This section registers the <code>Signed-Headers</code> header field in the "Permanent
Message Header Field Names" registry (<span>[<a href="#RFC3864" class="xref">RFC3864</a>]</span>).<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">Header field name:  <code>Signed-Headers</code><a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">Applicable protocol:  http<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4">Status:  standard<a href="#section-8.3-4" class="pilcrow">¶</a></p>
<p id="section-8.3-5">Author/Change controller:  IETF<a href="#section-8.3-5" class="pilcrow">¶</a></p>
<p id="section-8.3-6">Specification document(s):  <a href="#signed-headers" class="xref">Section 5.1.2</a> of this document<a href="#section-8.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http2-settings">
<section id="section-8.4">
        <h3 id="name-http-2-settings">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-http-2-settings" class="section-name selfRef">HTTP/2 Settings</a>
        </h3>
<p id="section-8.4-1">This section establishes an entry for the HTTP/2 Settings Registry that was
established by Section 11.3 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span><a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">Name: ENABLE_CROSS_ORIGIN_PUSH<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4-3">Code: 0xSETTING-TBD<a href="#section-8.4-3" class="pilcrow">¶</a></p>
<p id="section-8.4-4">Initial Value: 0<a href="#section-8.4-4" class="pilcrow">¶</a></p>
<p id="section-8.4-5">Specification: This document<a href="#section-8.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http2-error-code">
<section id="section-8.5">
        <h3 id="name-http-2-error-code">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-http-2-error-code" class="section-name selfRef">HTTP/2 Error code</a>
        </h3>
<p id="section-8.5-1">This section establishes an entry for the HTTP/2 Error Code Registry that was
established by Section 11.4 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span><a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">Name: NO_TRUSTED_EXCHANGE_SIGNATURE<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<p id="section-8.5-3">Code: 0xERROR-TBD<a href="#section-8.5-3" class="pilcrow">¶</a></p>
<p id="section-8.5-4">Description: The client does not trust the signature for a cross-origin Pushed
signed exchange.<a href="#section-8.5-4" class="pilcrow">¶</a></p>
<p id="section-8.5-5">Specification: This document<a href="#section-8.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="internet-media-type-applicationsigned-exchange">
<section id="section-8.6">
        <h3 id="name-internet-media-type-applica">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-internet-media-type-applica" class="section-name selfRef">Internet Media Type application/signed-exchange</a>
        </h3>
<p id="section-8.6-1">IANA is requested to register the MIME media type (<span>[<a href="#IANA.media-types" class="xref">IANA.media-types</a>]</span>) for
signed exchanges, application/signed-exchange, as follows:<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<p id="section-8.6-2">Type name:  application<a href="#section-8.6-2" class="pilcrow">¶</a></p>
<p id="section-8.6-3">Subtype name:  signed-exchange<a href="#section-8.6-3" class="pilcrow">¶</a></p>
<p id="section-8.6-4">Required parameters:<a href="#section-8.6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.6-5.1">
            <p id="section-8.6-5.1.1">v: A string denoting the version of the file format. (<span>[<a href="#RFC5234" class="xref">RFC5234</a>]</span> ABNF:
<code>version = DIGIT/%x61-7A</code>) The version defined in this specification is <code>1</code>.
When used with the <code>Accept</code> header field (Section 5.3.2 of <span>[<a href="#RFC7231" class="xref">RFC7231</a>]</span>), this
parameter can be a comma (,)-separated list of version strings. (<span>[<a href="#RFC5234" class="xref">RFC5234</a>]</span>
ABNF: <code>version-list = version *( "," version )</code>) The server is then expected
to reply with a resource using a particular version from that list.<a href="#section-8.6-5.1.1" class="pilcrow">¶</a></p>
<p id="section-8.6-5.1.2">
Note: RFC EDITOR PLEASE DELETE THIS NOTE; Implementations of drafts of this
specification MUST NOT use simple integers to describe their versions, and
MUST instead define implementation-specific strings to identify which draft is
implemented. The newest version of
<span>[<a href="#I-D.yasskin-httpbis-origin-signed-exchanges-impl" class="xref">I-D.yasskin-httpbis-origin-signed-exchanges-impl</a>]</span> describes the meaning of
one such string.<a href="#section-8.6-5.1.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.6-6">Optional parameters:  N/A<a href="#section-8.6-6" class="pilcrow">¶</a></p>
<p id="section-8.6-7">Encoding considerations:  binary<a href="#section-8.6-7" class="pilcrow">¶</a></p>
<p id="section-8.6-8">Security considerations:  see <a href="#security-application-signed-exchange" class="xref">Section 6.6</a><a href="#section-8.6-8" class="pilcrow">¶</a></p>
<p id="section-8.6-9">Interoperability considerations:  N/A<a href="#section-8.6-9" class="pilcrow">¶</a></p>
<p id="section-8.6-10">Published specification:  This specification (see
<a href="#application-signed-exchange" class="xref">Section 5.3</a>).<a href="#section-8.6-10" class="pilcrow">¶</a></p>
<p id="section-8.6-11">Applications that use this media type:  N/A<a href="#section-8.6-11" class="pilcrow">¶</a></p>
<p id="section-8.6-12">Fragment identifier considerations:  N/A<a href="#section-8.6-12" class="pilcrow">¶</a></p>
<p id="section-8.6-13">Additional information:<a href="#section-8.6-13" class="pilcrow">¶</a></p>
<p id="section-8.6-14">Deprecated alias names for this type:  N/A<a href="#section-8.6-14" class="pilcrow">¶</a></p>
<p id="section-8.6-15">Magic number(s):  73 78 67 31 00<a href="#section-8.6-15" class="pilcrow">¶</a></p>
<p id="section-8.6-16">File extension(s): .sxg<a href="#section-8.6-16" class="pilcrow">¶</a></p>
<p id="section-8.6-17">Macintosh file type code(s):  N/A<a href="#section-8.6-17" class="pilcrow">¶</a></p>
<p id="section-8.6-18">Person and email address to contact for further information: See Authors'
  Addresses section.<a href="#section-8.6-18" class="pilcrow">¶</a></p>
<p id="section-8.6-19">Intended usage:  COMMON<a href="#section-8.6-19" class="pilcrow">¶</a></p>
<p id="section-8.6-20">Restrictions on usage:  N/A<a href="#section-8.6-20" class="pilcrow">¶</a></p>
<p id="section-8.6-21">Author:  See Authors' Addresses section.<a href="#section-8.6-21" class="pilcrow">¶</a></p>
<p id="section-8.6-22">Change controller:  IESG<a href="#section-8.6-22" class="pilcrow">¶</a></p>
<p id="section-8.6-23">Provisional registration? Yes<a href="#section-8.6-23" class="pilcrow">¶</a></p>
</section>
</div>
<div id="internet-media-type-applicationcert-chaincbor">
<section id="section-8.7">
        <h3 id="name-internet-media-type-applicat">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-internet-media-type-applicat" class="section-name selfRef">Internet Media Type application/cert-chain+cbor</a>
        </h3>
<p id="section-8.7-1">IANA is requested to register the MIME media type (<span>[<a href="#IANA.media-types" class="xref">IANA.media-types</a>]</span>) for
CBOR-format certificate chains, application/cert-chain+cbor, as follows:<a href="#section-8.7-1" class="pilcrow">¶</a></p>
<p id="section-8.7-2">Type name:  application<a href="#section-8.7-2" class="pilcrow">¶</a></p>
<p id="section-8.7-3">Subtype name:  cert-chain+cbor<a href="#section-8.7-3" class="pilcrow">¶</a></p>
<p id="section-8.7-4">Required parameters:  N/A<a href="#section-8.7-4" class="pilcrow">¶</a></p>
<p id="section-8.7-5">Optional parameters:  N/A<a href="#section-8.7-5" class="pilcrow">¶</a></p>
<p id="section-8.7-6">Encoding considerations:  binary<a href="#section-8.7-6" class="pilcrow">¶</a></p>
<p id="section-8.7-7">Security considerations:  N/A<a href="#section-8.7-7" class="pilcrow">¶</a></p>
<p id="section-8.7-8">Interoperability considerations:  N/A<a href="#section-8.7-8" class="pilcrow">¶</a></p>
<p id="section-8.7-9">Published specification:  This specification (see <a href="#cert-chain-format" class="xref">Section 3.3</a>).<a href="#section-8.7-9" class="pilcrow">¶</a></p>
<p id="section-8.7-10">Applications that use this media type:  N/A<a href="#section-8.7-10" class="pilcrow">¶</a></p>
<p id="section-8.7-11">Fragment identifier considerations:  N/A<a href="#section-8.7-11" class="pilcrow">¶</a></p>
<p id="section-8.7-12">Additional information:<a href="#section-8.7-12" class="pilcrow">¶</a></p>
<p id="section-8.7-13">Deprecated alias names for this type:  N/A<a href="#section-8.7-13" class="pilcrow">¶</a></p>
<p id="section-8.7-14">Magic number(s): 1*9(??) 67 F0 9F 93 9C E2 9B 93<a href="#section-8.7-14" class="pilcrow">¶</a></p>
<p id="section-8.7-15">File extension(s): N/A<a href="#section-8.7-15" class="pilcrow">¶</a></p>
<p id="section-8.7-16">Macintosh file type code(s):  N/A<a href="#section-8.7-16" class="pilcrow">¶</a></p>
<p id="section-8.7-17">Person and email address to contact for further information: See Authors'
  Addresses section.<a href="#section-8.7-17" class="pilcrow">¶</a></p>
<p id="section-8.7-18">Intended usage:  COMMON<a href="#section-8.7-18" class="pilcrow">¶</a></p>
<p id="section-8.7-19">Restrictions on usage:  N/A<a href="#section-8.7-19" class="pilcrow">¶</a></p>
<p id="section-8.7-20">Author:  See Authors' Addresses section.<a href="#section-8.7-20" class="pilcrow">¶</a></p>
<p id="section-8.7-21">Change controller:  IESG<a href="#section-8.7-21" class="pilcrow">¶</a></p>
<p id="section-8.7-22">Provisional registration? Yes<a href="#section-8.7-22" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-caa-cansignhttpexchanges">
<section id="section-8.8">
        <h3 id="name-the-cansignhttpexchanges-ca">
<a href="#section-8.8" class="section-number selfRef">8.8. </a><a href="#name-the-cansignhttpexchanges-ca" class="section-name selfRef">The cansignhttpexchanges CAA Parameter</a>
        </h3>
<p id="section-8.8-1">There are no IANA considerations for this parameter.<a href="#section-8.8-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="CDDL">[CDDL]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span><span class="refAuthor">, Vigano, C.</span><span class="refAuthor">, and C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FETCH">[FETCH]</dt>
        <dd>
<span class="refAuthor">WHATWG</span>, <span class="refTitle">"Fetch"</span>, <time datetime="2020-07" class="refDate">July 2020</time>, <span>&lt;<a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-httpbis-header-structure">[I-D.ietf-httpbis-header-structure]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span><span class="refAuthor"> and P. Kamp</span>, <span class="refTitle">"Structured Field Values for HTTP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-header-structure-19</span>, <time datetime="2020-06-03" class="refDate">3 June 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-httpbis-header-structure-19.txt">http://www.ietf.org/internet-drafts/draft-ietf-httpbis-header-structure-19.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-httpbis-variants">[I-D.ietf-httpbis-variants]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"HTTP Representation Variants"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-variants-06</span>, <time datetime="2019-11-03" class="refDate">3 November 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-httpbis-variants-06.txt">http://www.ietf.org/internet-drafts/draft-ietf-httpbis-variants-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.thomson-http-mice">[I-D.thomson-http-mice]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span><span class="refAuthor"> and J. Yasskin</span>, <span class="refTitle">"Merkle Integrity Content Encoding"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-thomson-http-mice-03</span>, <time datetime="2018-08-13" class="refDate">13 August 2018</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-thomson-http-mice-03.txt">http://www.ietf.org/internet-drafts/draft-thomson-http-mice-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.media-types">[IANA.media-types]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Media Types"</span>, <span></span>, <span>&lt;<a href="http://www.iana.org/assignments/media-types">http://www.iana.org/assignments/media-types</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="POSIX">[POSIX]</dt>
        <dd>
<span class="refAuthor">IEEE</span><span class="refAuthor"> and The Open Group</span>, <span class="refTitle">"The Open Group Base Specifications Issue 7"</span>, <span class="seriesInfo">value 1003.1-2008, 2016 Edition</span>, <span class="seriesInfo">name IEEE</span>, <time datetime="2016" class="refDate">2016</time>, <span>&lt;<a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/">http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3230">[RFC3230]</dt>
        <dd>
<span class="refAuthor">Mogul, J.</span><span class="refAuthor"> and A. Van Hoff</span>, <span class="refTitle">"Instance Digests in HTTP"</span>, <span class="seriesInfo">RFC 3230</span>, <span class="seriesInfo">DOI 10.17487/RFC3230</span>, <time datetime="2002-01" class="refDate">January 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3230">https://www.rfc-editor.org/info/rfc3230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3864">[RFC3864]</dt>
        <dd>
<span class="refAuthor">Klyne, G.</span><span class="refAuthor">, Nottingham, M.</span><span class="refAuthor">, and J. Mogul</span>, <span class="refTitle">"Registration Procedures for Message Header Fields"</span>, <span class="seriesInfo">BCP 90</span>, <span class="seriesInfo">RFC 3864</span>, <span class="seriesInfo">DOI 10.17487/RFC3864</span>, <time datetime="2004-09" class="refDate">September 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3864">https://www.rfc-editor.org/info/rfc3864</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span><span class="refAuthor"> and P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span><span class="refAuthor">, Santesson, S.</span><span class="refAuthor">, Farrell, S.</span><span class="refAuthor">, Boeyen, S.</span><span class="refAuthor">, Housley, R.</span><span class="refAuthor">, and W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6844">[RFC6844]</dt>
        <dd>
<span class="refAuthor">Hallam-Baker, P.</span><span class="refAuthor"> and R. Stradling</span>, <span class="refTitle">"DNS Certification Authority Authorization (CAA) Resource Record"</span>, <span class="seriesInfo">RFC 6844</span>, <span class="seriesInfo">DOI 10.17487/RFC6844</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6844">https://www.rfc-editor.org/info/rfc6844</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6960">[RFC6960]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span><span class="refAuthor">, Myers, M.</span><span class="refAuthor">, Ankney, R.</span><span class="refAuthor">, Malpani, A.</span><span class="refAuthor">, Galperin, S.</span><span class="refAuthor">, and C. Adams</span>, <span class="refTitle">"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"</span>, <span class="seriesInfo">RFC 6960</span>, <span class="seriesInfo">DOI 10.17487/RFC6960</span>, <time datetime="2013-06" class="refDate">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6960">https://www.rfc-editor.org/info/rfc6960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6962">[RFC6962]</dt>
        <dd>
<span class="refAuthor">Laurie, B.</span><span class="refAuthor">, Langley, A.</span><span class="refAuthor">, and E. Kasper</span>, <span class="refTitle">"Certificate Transparency"</span>, <span class="seriesInfo">RFC 6962</span>, <span class="seriesInfo">DOI 10.17487/RFC6962</span>, <time datetime="2013-06" class="refDate">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6962">https://www.rfc-editor.org/info/rfc6962</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7049">[RFC7049]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor"> and P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <span class="seriesInfo">DOI 10.17487/RFC7049</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7049">https://www.rfc-editor.org/info/rfc7049</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7230">[RFC7230]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor"> and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7231">[RFC7231]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor"> and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"</span>, <span class="seriesInfo">RFC 7231</span>, <span class="seriesInfo">DOI 10.17487/RFC7231</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7234">[RFC7234]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor">, Nottingham, M., Ed.</span><span class="refAuthor">, and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Caching"</span>, <span class="seriesInfo">RFC 7234</span>, <span class="seriesInfo">DOI 10.17487/RFC7234</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7234">https://www.rfc-editor.org/info/rfc7234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7540">[RFC7540]</dt>
        <dd>
<span class="refAuthor">Belshe, M.</span><span class="refAuthor">, Peon, R.</span><span class="refAuthor">, and M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span><span class="refAuthor"> and I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="URL">[URL]</dt>
      <dd>
<span class="refAuthor">WHATWG</span>, <span class="refTitle">"URL"</span>, <time datetime="2020-07" class="refDate">July 2020</time>, <span>&lt;<a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BRs">[BRs]</dt>
        <dd>
<span class="refAuthor">CA/Browser Forum</span>, <span class="refTitle">"Baseline Requirements for the Issuance and Management of Publicly-Trusted Certificates"</span>, <time datetime="2018-12-10" class="refDate">10 December 2018</time>, <span>&lt;<a href="https://cabforum.org/baseline-requirements-documents/">https://cabforum.org/baseline-requirements-documents/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CRLSets">[CRLSets]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refTitle">"Revocation checking and Chrome's CRL"</span>, <time datetime="2012-02-05" class="refDate">5 February 2012</time>, <span>&lt;<a href="https://www.imperialviolet.org/2012/02/05/crlsets.html">https://www.imperialviolet.org/2012/02/05/crlsets.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.bishop-httpbis-origin-fed-up">[I-D.bishop-httpbis-origin-fed-up]</dt>
        <dd>
<span class="refAuthor">Bishop, M.</span><span class="refAuthor"> and E. Nygren</span>, <span class="refTitle">"DNS Security with HTTP/2 ORIGIN"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bishop-httpbis-origin-fed-up-00</span>, <time datetime="2019-01-08" class="refDate">8 January 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-bishop-httpbis-origin-fed-up-00.txt">http://www.ietf.org/internet-drafts/draft-bishop-httpbis-origin-fed-up-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.burke-content-signature">[I-D.burke-content-signature]</dt>
        <dd>
<span class="refAuthor">Burke, B.</span>, <span class="refTitle">"HTTP Header for digital signatures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-burke-content-signature-00</span>, <time datetime="2011-03-07" class="refDate">7 March 2011</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-burke-content-signature-00.txt">http://www.ietf.org/internet-drafts/draft-burke-content-signature-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.cavage-http-signatures">[I-D.cavage-http-signatures]</dt>
        <dd>
<span class="refAuthor">Cavage, M.</span><span class="refAuthor"> and M. Sporny</span>, <span class="refTitle">"Signing HTTP Messages"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-cavage-http-signatures-12</span>, <time datetime="2019-10-21" class="refDate">21 October 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-cavage-http-signatures-12.txt">http://www.ietf.org/internet-drafts/draft-cavage-http-signatures-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-httpbis-cache">[I-D.ietf-httpbis-cache]</dt>
        <dd>
<span class="refAuthor">Fielding, R.</span><span class="refAuthor">, Nottingham, M.</span><span class="refAuthor">, and J. Reschke</span>, <span class="refTitle">"HTTP Caching"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-cache-10</span>, <time datetime="2020-07-12" class="refDate">12 July 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-httpbis-cache-10.txt">http://www.ietf.org/internet-drafts/draft-ietf-httpbis-cache-10.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-httpbis-http2-secondary-certs">[I-D.ietf-httpbis-http2-secondary-certs]</dt>
        <dd>
<span class="refAuthor">Bishop, M.</span><span class="refAuthor">, Sullivan, N.</span><span class="refAuthor">, and M. Thomson</span>, <span class="refTitle">"Secondary Certificate Authentication in HTTP/2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-http2-secondary-certs-06</span>, <time datetime="2020-05-14" class="refDate">14 May 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-httpbis-http2-secondary-certs-06.txt">http://www.ietf.org/internet-drafts/draft-ietf-httpbis-http2-secondary-certs-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.thomson-http-content-signature">[I-D.thomson-http-content-signature]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span>, <span class="refTitle">"Content-Signature Header Field for HTTP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-thomson-http-content-signature-00</span>, <time datetime="2015-07-02" class="refDate">2 July 2015</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-thomson-http-content-signature-00.txt">http://www.ietf.org/internet-drafts/draft-thomson-http-content-signature-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.yasskin-httpbis-origin-signed-exchanges-impl">[I-D.yasskin-httpbis-origin-signed-exchanges-impl]</dt>
        <dd>
<span class="refAuthor">Yasskin, J.</span><span class="refAuthor"> and K. Ueno</span>, <span class="refTitle">"Signed HTTP Exchanges Implementation Checkpoints"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-yasskin-httpbis-origin-signed-exchanges-impl-03</span>, <time datetime="2019-07-25" class="refDate">25 July 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-yasskin-httpbis-origin-signed-exchanges-impl-03.txt">http://www.ietf.org/internet-drafts/draft-yasskin-httpbis-origin-signed-exchanges-impl-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.yasskin-wpack-use-cases">[I-D.yasskin-wpack-use-cases]</dt>
        <dd>
<span class="refAuthor">Yasskin, J.</span>, <span class="refTitle">"Use Cases and Requirements for Web Packages"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-yasskin-wpack-use-cases-00</span>, <time datetime="2019-10-30" class="refDate">30 October 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-yasskin-wpack-use-cases-00.txt">http://www.ietf.org/internet-drafts/draft-yasskin-wpack-use-cases-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OneCrl">[OneCrl]</dt>
        <dd>
<span class="refAuthor">Goodwin, M.</span>, <span class="refTitle">"Revoking Intermediate Certificates: Introducing OneCRL"</span>, <time datetime="2015-03-03" class="refDate">3 March 2015</time>, <span>&lt;<a href="https://blog.mozilla.org/security/2015/03/03/revoking-intermediate-certificates-introducing-onecrl/">https://blog.mozilla.org/security/2015/03/03/revoking-intermediate-certificates-introducing-onecrl/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2965">[RFC2965]</dt>
        <dd>
<span class="refAuthor">Kristol, D.</span><span class="refAuthor"> and L. Montulli</span>, <span class="refTitle">"HTTP State Management Mechanism"</span>, <span class="seriesInfo">RFC 2965</span>, <span class="seriesInfo">DOI 10.17487/RFC2965</span>, <time datetime="2000-10" class="refDate">October 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2965">https://www.rfc-editor.org/info/rfc2965</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5019">[RFC5019]</dt>
        <dd>
<span class="refAuthor">Deacon, A.</span><span class="refAuthor"> and R. Hurst</span>, <span class="refTitle">"The Lightweight Online Certificate Status Protocol (OCSP) Profile for High-Volume Environments"</span>, <span class="seriesInfo">RFC 5019</span>, <span class="seriesInfo">DOI 10.17487/RFC5019</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5019">https://www.rfc-editor.org/info/rfc5019</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6066">https://www.rfc-editor.org/info/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6265">[RFC6265]</dt>
        <dd>
<span class="refAuthor">Barth, A.</span>, <span class="refTitle">"HTTP State Management Mechanism"</span>, <span class="seriesInfo">RFC 6265</span>, <span class="seriesInfo">DOI 10.17487/RFC6265</span>, <time datetime="2011-04" class="refDate">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6265">https://www.rfc-editor.org/info/rfc6265</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6454">[RFC6454]</dt>
        <dd>
<span class="refAuthor">Barth, A.</span>, <span class="refTitle">"The Web Origin Concept"</span>, <span class="seriesInfo">RFC 6454</span>, <span class="seriesInfo">DOI 10.17487/RFC6454</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6454">https://www.rfc-editor.org/info/rfc6454</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6455">[RFC6455]</dt>
        <dd>
<span class="refAuthor">Fette, I.</span><span class="refAuthor"> and A. Melnikov</span>, <span class="refTitle">"The WebSocket Protocol"</span>, <span class="seriesInfo">RFC 6455</span>, <span class="seriesInfo">DOI 10.17487/RFC6455</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6455">https://www.rfc-editor.org/info/rfc6455</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6797">[RFC6797]</dt>
        <dd>
<span class="refAuthor">Hodges, J.</span><span class="refAuthor">, Jackson, C.</span><span class="refAuthor">, and A. Barth</span>, <span class="refTitle">"HTTP Strict Transport Security (HSTS)"</span>, <span class="seriesInfo">RFC 6797</span>, <span class="seriesInfo">DOI 10.17487/RFC6797</span>, <time datetime="2012-11" class="refDate">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6797">https://www.rfc-editor.org/info/rfc6797</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7235">[RFC7235]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor"> and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Authentication"</span>, <span class="seriesInfo">RFC 7235</span>, <span class="seriesInfo">DOI 10.17487/RFC7235</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7235">https://www.rfc-editor.org/info/rfc7235</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7469">[RFC7469]</dt>
        <dd>
<span class="refAuthor">Evans, C.</span><span class="refAuthor">, Palmer, C.</span><span class="refAuthor">, and R. Sleevi</span>, <span class="refTitle">"Public Key Pinning Extension for HTTP"</span>, <span class="seriesInfo">RFC 7469</span>, <span class="seriesInfo">DOI 10.17487/RFC7469</span>, <time datetime="2015-04" class="refDate">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7469">https://www.rfc-editor.org/info/rfc7469</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7615">[RFC7615]</dt>
        <dd>
<span class="refAuthor">Reschke, J.</span>, <span class="refTitle">"HTTP Authentication-Info and Proxy-Authentication-Info Response Header Fields"</span>, <span class="seriesInfo">RFC 7615</span>, <span class="seriesInfo">DOI 10.17487/RFC7615</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7615">https://www.rfc-editor.org/info/rfc7615</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span><span class="refAuthor">, Kaliski, B.</span><span class="refAuthor">, Jonsson, J.</span><span class="refAuthor">, and A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8053">[RFC8053]</dt>
        <dd>
<span class="refAuthor">Oiwa, Y.</span><span class="refAuthor">, Watanabe, H.</span><span class="refAuthor">, Takagi, H.</span><span class="refAuthor">, Maeda, K.</span><span class="refAuthor">, Hayashi, T.</span><span class="refAuthor">, and Y. Ioku</span>, <span class="refTitle">"HTTP Authentication Extensions for Interactive Clients"</span>, <span class="seriesInfo">RFC 8053</span>, <span class="seriesInfo">DOI 10.17487/RFC8053</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8053">https://www.rfc-editor.org/info/rfc8053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8336">[RFC8336]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span><span class="refAuthor"> and E. Nygren</span>, <span class="refTitle">"The ORIGIN HTTP/2 Frame"</span>, <span class="seriesInfo">RFC 8336</span>, <span class="seriesInfo">DOI 10.17487/RFC8336</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8336">https://www.rfc-editor.org/info/rfc8336</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SRI">[SRI]</dt>
        <dd>
<span class="refAuthor">Akhawe, D.</span><span class="refAuthor">, Braun, F.</span><span class="refAuthor">, Marier, F.</span><span class="refAuthor">, and J. Weinberger</span>, <span class="refTitle">"Subresource Integrity"</span>, <span class="seriesInfo">World Wide Web Consortium Recommendation REC-SRI-20160623</span>, <time datetime="2016-06-23" class="refDate">23 June 2016</time>, <span>&lt;<a href="http://www.w3.org/TR/2016/REC-SRI-20160623">http://www.w3.org/TR/2016/REC-SRI-20160623</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="W3C.NOTE-OPS-OverHTTP">[W3C.NOTE-OPS-OverHTTP]</dt>
        <dd>
<span class="refAuthor">Hensley, P.</span><span class="refAuthor">, Metral, M.</span><span class="refAuthor">, Shardanand, U.</span><span class="refAuthor">, Converse, D.</span><span class="refAuthor">, and M. Myers</span>, <span class="refTitle">"Implementation of OPS Over HTTP"</span>, <span class="seriesInfo">W3C NOTE NOTE-OPS-OverHTTP</span>, <time datetime="1997-06-02" class="refDate">2 June 1997</time>, <span>&lt;<a href="http://www.w3.org/TR/NOTE-OPS-OverHTTP">http://www.w3.org/TR/NOTE-OPS-OverHTTP</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="W3C.WD-clear-site-data-20171130">[W3C.WD-clear-site-data-20171130]</dt>
      <dd>
<span class="refAuthor">West, M.</span>, <span class="refTitle">"Clear Site Data"</span>, <span class="seriesInfo">World Wide Web Consortium WD WD-clear-site-data-20171130</span>, <time datetime="2017-11-30" class="refDate">30 November 2017</time>, <span>&lt;<a href="https://www.w3.org/TR/2017/WD-clear-site-data-20171130">https://www.w3.org/TR/2017/WD-clear-site-data-20171130</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="use-cases">
<section id="section-appendix.a">
      <h2 id="name-use-cases">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-use-cases" class="section-name selfRef">Use cases</a>
      </h2>
<div id="uc-pushed-subresources">
<section id="section-a.1">
        <h2 id="name-pushed-subresources">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-pushed-subresources" class="section-name selfRef">PUSHed subresources</a>
        </h2>
<p id="section-a.1-1">To reduce round trips, a server might use HTTP/2 Push (Section 8.2 of
<span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>) to inject a subresource from another server into the client's
cache. If anything about the subresource is expired or can't be verified, the
client would fetch it from the original server.<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<p id="section-a.1-2">For example, if <code>https://example.com/index.html</code> includes<a href="#section-a.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-html" id="section-a.1-3">
<pre>
&lt;script src="https://jquery.com/jquery-1.2.3.min.js"&gt;
</pre><a href="#section-a.1-3" class="pilcrow">¶</a>
</div>
<p id="section-a.1-4">Then to avoid the need to look up and connect to <code>jquery.com</code> in the critical
path, <code>example.com</code> might push that resource signed by <code>jquery.com</code>.<a href="#section-a.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="uc-explicit-distributor">
<section id="section-a.2">
        <h2 id="name-explicit-use-of-a-content-d">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-explicit-use-of-a-content-d" class="section-name selfRef">Explicit use of a content distributor for subresources</a>
        </h2>
<p id="section-a.2-1">In order to speed up loading but still maintain control over its content, an
HTML page in a particular origin <code>O.com</code> could tell clients to load its
subresources from an intermediate content distributor that's not authoritative,
but require that those resources be signed by <code>O.com</code> so that the distributor
couldn't modify the resources. This is more constrained than the common CDN case
where <code>O.com</code> has a CNAME granting the CDN the right to serve arbitrary content
as <code>O.com</code>.<a href="#section-a.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-html" id="section-a.2-2">
<pre>
&lt;img logicalsrc="https://O.com/img.png"
     physicalsrc="https://distributor.com/O.com/img.png"&gt;
</pre><a href="#section-a.2-2" class="pilcrow">¶</a>
</div>
<p id="section-a.2-3">To make it easier to configure the right distributor for a given request,
computation of the <code>physicalsrc</code> could be encapsulated in a custom element:<a href="#section-a.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-html" id="section-a.2-4">
<pre>
&lt;dist-img src="https://O.com/img.png"&gt;&lt;/dist-img&gt;
</pre><a href="#section-a.2-4" class="pilcrow">¶</a>
</div>
<p id="section-a.2-5">where the <code>&lt;dist-img&gt;</code> implementation generates an appropriate <code>&lt;img&gt;</code> based on,
for example, a <code>&lt;meta name="dist-base"&gt;</code> tag elsewhere in the page. However,
this has the downside that the
<a href="https://calendar.perfplanet.com/2013/big-bad-preloader/">preloader</a> can no
longer see the physical source to download it. The resulting delay might cancel
out the benefit of using a distributor.<a href="#section-a.2-5" class="pilcrow">¶</a></p>
<p id="section-a.2-6">This could be used for some of the same purposes as SRI (<a href="#uc-sri" class="xref">Appendix A.3</a>).<a href="#section-a.2-6" class="pilcrow">¶</a></p>
<p id="section-a.2-7">To implement this with the current proposal, the distributor would respond to
the physical request to <code>https://distributor.com/O.com/img.png</code> with first a
signed PUSH_PROMISE for <code>https://O.com/img.png</code> and then a redirect to
<code>https://O.com/img.png</code>.<a href="#section-a.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="uc-sri">
<section id="section-a.3">
        <h2 id="name-subresource-integrity">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-subresource-integrity" class="section-name selfRef">Subresource Integrity</a>
        </h2>
<p id="section-a.3-1">The W3C WebAppSec group is investigating
<a href="https://github.com/mikewest/signature-based-sri">using signatures</a> in <span>[<a href="#SRI" class="xref">SRI</a>]</span>.
They need a way to transmit the signature with the response, which this proposal
provides.<a href="#section-a.3-1" class="pilcrow">¶</a></p>
<p id="section-a.3-2">Their needs are simpler than most other use cases in that the
<code>integrity="ed25519-[public-key]"</code> attribute and CSP-based ways of expressing a
public key don't need that key to be wrapped into a certificate.<a href="#section-a.3-2" class="pilcrow">¶</a></p>
<p id="section-a.3-3">The "ed25519key" signature parameter supports this simpler way of attaching a
key.<a href="#section-a.3-3" class="pilcrow">¶</a></p>
<p id="section-a.3-4">The current proposal for signature-based SRI describes signing only the content
of a resource, while this specification requires them to sign the request URI as
well. This issue is tracked in
<a href="https://github.com/mikewest/signature-based-sri/issues/5">https://github.com/mikewest/signature-based-sri/issues/5</a>. The details of what
they need to sign will affect whether and how they can use this proposal.<a href="#section-a.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="uc-transparency">
<section id="section-a.4">
        <h2 id="name-binary-transparency">
<a href="#section-a.4" class="section-number selfRef">A.4. </a><a href="#name-binary-transparency" class="section-name selfRef">Binary Transparency</a>
        </h2>
<p id="section-a.4-1">So-called "Binary Transparency" may eventually allow users to verify that a
program they've been delivered is one that's available to the public, and not a
specially-built version intended to attack just them. Binary transparency
systems don't exist yet, but they're likely to work similarly to the successful
Certificate Transparency logs described by <span>[<a href="#RFC6962" class="xref">RFC6962</a>]</span>.<a href="#section-a.4-1" class="pilcrow">¶</a></p>
<p id="section-a.4-2">Certificate Transparency depends on Signed Certificate Timestamps that prove a
log contained a particular certificate at a particular time. To build the same
thing for Binary Transparency logs containing HTTP resources or full websites,
we'll need a way to provide signatures of those resources, which signed
exchanges provides.<a href="#section-a.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="uc-static-analysis">
<section id="section-a.5">
        <h2 id="name-static-analysis">
<a href="#section-a.5" class="section-number selfRef">A.5. </a><a href="#name-static-analysis" class="section-name selfRef">Static Analysis</a>
        </h2>
<p id="section-a.5-1">Native app stores like the <a href="https://www.apple.com/ios/app-store/">Apple App
Store</a> and the <a href="https://play.google.com/store">Android Play
Store</a> grant their contents powerful abilities,
which they attempt to make safe by analyzing the applications before offering
them to people. The web has no equivalent way for people to wait to run an
update of a web application until a trusted authority has vouched for it.<a href="#section-a.5-1" class="pilcrow">¶</a></p>
<p id="section-a.5-2">While full application analysis probably needs to wait until the authority can
sign bundles of exchanges, authorities may be able to guarantee certain
properties by just checking a top-level resource and its <span>[<a href="#SRI" class="xref">SRI</a>]</span>-constrained
sub-resources.<a href="#section-a.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="uc-offline-websites">
<section id="section-a.6">
        <h2 id="name-offline-websites">
<a href="#section-a.6" class="section-number selfRef">A.6. </a><a href="#name-offline-websites" class="section-name selfRef">Offline websites</a>
        </h2>
<p id="section-a.6-1">Fully-offline websites can be represented as bundles of signed exchanges,
although an optimization to reduce the number of signature verifications may be
needed. Work on this is in progress in the <a href="https://github.com/WICG/webpackage">https://github.com/WICG/webpackage</a>
repository.<a href="#section-a.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="requirements">
<section id="section-appendix.b">
      <h2 id="name-requirements">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
      </h2>
<div id="proof-of-origin">
<section id="section-b.1">
        <h2 id="name-proof-of-origin">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-proof-of-origin" class="section-name selfRef">Proof of origin</a>
        </h2>
<p id="section-b.1-1">To verify that a thing came from a particular origin, for use in the same
context as a TLS connection, we need someone to vouch for the signing key with
as much verification as the signing keys used in TLS. The obvious way to do this
is to re-use the web PKI and CA ecosystem.<a href="#section-b.1-1" class="pilcrow">¶</a></p>
<div id="certificate-constraints">
<section id="section-b.1.1">
          <h3 id="name-certificate-constraints">
<a href="#section-b.1.1" class="section-number selfRef">B.1.1. </a><a href="#name-certificate-constraints" class="section-name selfRef">Certificate constraints</a>
          </h3>
<p id="section-b.1.1-1">If we re-use existing TLS server certificates, we incur the risks that:<a href="#section-b.1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-b.1.1-2">
            <li id="section-b.1.1-2.1">TLS server certificates must be accessible from online servers, so they're
easier to steal or use as signing oracles than an offline key. An exchange's
signing key doesn't need to be online.<a href="#section-b.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-b.1.1-2.2">A server using an origin-trusted key for one purpose (e.g. TLS) might
accidentally sign something that looks like an exchange, or vice versa.<a href="#section-b.1.1-2.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-b.1.1-3">These risks are considered too high, so we define a new X.509 certificate
extension in <a href="#cross-origin-cert-req" class="xref">Section 4.2</a> that requires CAs to issue new
certificates for this purpose. We expect at least one low-cost CA to be willing
to sign certificates with this extension.<a href="#section-b.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-constraints">
<section id="section-b.1.2">
          <h3 id="name-signature-constraints">
<a href="#section-b.1.2" class="section-number selfRef">B.1.2. </a><a href="#name-signature-constraints" class="section-name selfRef">Signature constraints</a>
          </h3>
<p id="section-b.1.2-1">In order to prevent an attacker who can convince the server to sign some
resource from causing those signed bytes to be interpreted as something else the
new X.509 extension here is forbidden from being used in TLS servers. If
<a href="#cross-origin-cert-req" class="xref">Section 4.2</a> changes to allow re-use in TLS servers, we would need
to:<a href="#section-b.1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-b.1.2-2">
            <li id="section-b.1.2-2.1">Avoid key types that are used for non-TLS protocols whose output could be
confused with a signature. That may be just the <code>rsaEncryption</code> OID from
<span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>.<a href="#section-b.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-b.1.2-2.2">Use the same format as TLS's signatures, specified in Section 4.4.3 of
<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, with a context string that's specific to this use.<a href="#section-b.1.2-2.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-b.1.2-3">The specification also needs to define which signing algorithm to use. It
currently specifies that as a function from the key type, instead of allowing
attacker-controlled data to specify it.<a href="#section-b.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certificate-chain">
<section id="section-b.1.3">
          <h3 id="name-retrieving-the-certificate">
<a href="#section-b.1.3" class="section-number selfRef">B.1.3. </a><a href="#name-retrieving-the-certificate" class="section-name selfRef">Retrieving the certificate</a>
          </h3>
<p id="section-b.1.3-1">The client needs to be able to find the certificate vouching for the signing
key, a chain from that certificate to a trusted root, and possibly other trust
information like SCTs (<span>[<a href="#RFC6962" class="xref">RFC6962</a>]</span>). One approach would be to include the
certificate and its chain in the signature metadata itself, but this wastes
bytes when the same certificate is used for multiple HTTP responses. If we
decide to put the signature in an HTTP header, certificates are also unusually
large for that context.<a href="#section-b.1.3-1" class="pilcrow">¶</a></p>
<p id="section-b.1.3-2">Another option is to pass a URL that the client can fetch to retrieve the
certificate and chain. To avoid extra round trips in fetching that URL, it could
be <span><a href="#uc-offline-websites" class="xref">bundled</a> (<a href="#uc-offline-websites" class="xref">Appendix A.6</a>)</span> with the signed content or
<span><a href="#uc-pushed-subresources" class="xref">PUSHed</a> (<a href="#uc-pushed-subresources" class="xref">Appendix A.1</a>)</span> with it. The risks from the
<code>client_certificate_url</code> extension (Section 11.3 of <span>[<a href="#RFC6066" class="xref">RFC6066</a>]</span>) don't seem to
apply here, since an attacker who can get a client to load an exchange and fetch
the certificates it references, can also get the client to perform those fetches
by loading other HTML.<a href="#section-b.1.3-2" class="pilcrow">¶</a></p>
<p id="section-b.1.3-3">To avoid using an unintended certificate with the same public key as the
intended one, the content of the leaf certificate or the chain should be
included in the signed data, like TLS does (Section 4.4.3 of
<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>).<a href="#section-b.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="how-much-to-sign">
<section id="section-b.2">
        <h2 id="name-how-much-to-sign">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-how-much-to-sign" class="section-name selfRef">How much to sign</a>
        </h2>
<p id="section-b.2-1">The previous <span>[<a href="#I-D.thomson-http-content-signature" class="xref">I-D.thomson-http-content-signature</a>]</span> and
<span>[<a href="#I-D.burke-content-signature" class="xref">I-D.burke-content-signature</a>]</span> schemes signed just the content, while
(<span>[<a href="#I-D.cavage-http-signatures" class="xref">I-D.cavage-http-signatures</a>]</span> could also sign the response headers and the
request method and path. However, the same path, response headers, and content
may mean something very different when retrieved from a different server.
<a href="#serialized-headers" class="xref">Section 5.1.1</a> currently includes the whole request URL in the
signature, but it's possible we need a more flexible scheme to allow some
higher-level protocols to accept a less-signed URL.<a href="#section-b.2-1" class="pilcrow">¶</a></p>
<p id="section-b.2-2">Servers might want to sign other request headers in order to capture their
effects on content negotiation. However, there's no standard algorithm to check
that a client's actual request headers match request headers sent by a server.
The most promising attempt at this is <span>[<a href="#I-D.ietf-httpbis-variants" class="xref">I-D.ietf-httpbis-variants</a>]</span>, which
encodes the content negotiation algorithm into the <code>Variants</code> and <code>Variant-Key</code>
response headers. The proposal here (<a href="#proposal" class="xref">Section 3</a>) assumes that is in use and
doesn't sign request headers.<a href="#section-b.2-2" class="pilcrow">¶</a></p>
<div id="conveying-the-signed-headers">
<section id="section-b.2.1">
          <h3 id="name-conveying-the-signed-header">
<a href="#section-b.2.1" class="section-number selfRef">B.2.1. </a><a href="#name-conveying-the-signed-header" class="section-name selfRef">Conveying the signed headers</a>
          </h3>
<p id="section-b.2.1-1">HTTP headers are traditionally munged by proxies, making it impossible to
guarantee that the client will see the same sequence of bytes as the publisher
published. In the HTTPS world, we have more end-to-end header integrity, but
it's still likely that there are enough TLS-terminating proxies that the
publisher's signatures would tend to break before getting to the client.<a href="#section-b.2.1-1" class="pilcrow">¶</a></p>
<p id="section-b.2.1-2">There's no way in current HTTP for the response to a client-initiated request
(Section 8.1 of <span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>) to convey the request headers it expected to
respond to, but we sidestep that by conveying content negotiation information in
response headers, per <span>[<a href="#I-D.ietf-httpbis-variants" class="xref">I-D.ietf-httpbis-variants</a>]</span>.<a href="#section-b.2.1-2" class="pilcrow">¶</a></p>
<p id="section-b.2.1-3">Since proxies are unlikely to modify unknown content types, we can wrap the
original exchange into an <code>application/signed-exchange</code> format
(<a href="#application-signed-exchange" class="xref">Section 5.3</a>) and include the <code>Cache-Control: no-transform</code>
header when sending it.<a href="#section-b.2.1-3" class="pilcrow">¶</a></p>
<p id="section-b.2.1-4">To reduce the likelihood of accidental modification by proxies, the
<code>application/signed-exchange</code> format includes a file signature that doesn't
collide with other known signatures.<a href="#section-b.2.1-4" class="pilcrow">¶</a></p>
<p id="section-b.2.1-5">To help the PUSHed subresources use case (<a href="#uc-pushed-subresources" class="xref">Appendix A.1</a>), we might
also want to extend the <code>PUSH_PROMISE</code> frame type to include a signature, and
that could tell intermediates not to change the ensuing headers.<a href="#section-b.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="response-lifespan">
<section id="section-b.3">
        <h2 id="name-response-lifespan">
<a href="#section-b.3" class="section-number selfRef">B.3. </a><a href="#name-response-lifespan" class="section-name selfRef">Response lifespan</a>
        </h2>
<p id="section-b.3-1">A normal HTTPS response is authoritative only for one client, for as long as its
cache headers say it should live. A signed exchange can be re-used for many
clients, and if it was generated while a server was compromised, it can continue
compromising clients even if their requests happen after the server recovers.
This signing scheme needs to mitigate that risk.<a href="#section-b.3-1" class="pilcrow">¶</a></p>
<div id="certificate-revocation">
<section id="section-b.3.1">
          <h3 id="name-certificate-revocation">
<a href="#section-b.3.1" class="section-number selfRef">B.3.1. </a><a href="#name-certificate-revocation" class="section-name selfRef">Certificate revocation</a>
          </h3>
<p id="section-b.3.1-1">Certificates are mis-issued and private keys are stolen, and in response clients
need to be able to stop trusting these certificates as promptly as possible.
Online revocation
checks <a href="https://www.imperialviolet.org/2012/02/05/crlsets.html">don't work</a>, so
the industry has moved to pushed revocation lists and stapled OCSP responses
<span>[<a href="#RFC6066" class="xref">RFC6066</a>]</span>.<a href="#section-b.3.1-1" class="pilcrow">¶</a></p>
<p id="section-b.3.1-2">Pushed revocation lists work as-is to block trust in the certificate signing an
exchange, but the signatures need an explicit strategy to staple OCSP responses.
One option is to extend the certificate download (<a href="#certificate-chain" class="xref">Appendix B.1.3</a>) to
include the OCSP response too, perhaps in the
<a href="https://tlswg.github.io/tls13-spec/draft-ietf-tls-tls13.html#ocsp-and-sct">TLS 1.3 CertificateEntry</a> format.<a href="#section-b.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="downgrade">
<section id="section-b.3.2">
          <h3 id="name-response-downgrade-attacks">
<a href="#section-b.3.2" class="section-number selfRef">B.3.2. </a><a href="#name-response-downgrade-attacks" class="section-name selfRef">Response downgrade attacks</a>
          </h3>
<p id="section-b.3.2-1">The signed content in a response might be vulnerable to attacks, such as XSS, or
might simply be discovered to be incorrect after publication. Once the author
fixes those vulnerabilities or mistakes, clients should stop trusting the old
signed content in a reasonable amount of time. Similar to certificate
revocation, I expect the best option to be stapled "this version is still valid"
assertions with short expiration times.<a href="#section-b.3.2-1" class="pilcrow">¶</a></p>
<p id="section-b.3.2-2">These assertions could be structured as:<a href="#section-b.3.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-b.3.2-3">
            <li id="section-b.3.2-3.1">A signed minimum version number or timestamp for a set of request headers:
This requires that signed responses need to include a version number or
timestamp, but allows a server to provide a single signature covering all
valid versions.<a href="#section-b.3.2-3.1" class="pilcrow">¶</a>
</li>
            <li id="section-b.3.2-3.2">A replacement for the whole exchange's signature. This requires the publisher to
separately re-sign each valid version and requires each version to include a
different update URL, but allows intermediates to serve less data. This is
the approach taken in <a href="#proposal" class="xref">Section 3</a>.<a href="#section-b.3.2-3.2" class="pilcrow">¶</a>
</li>
            <li id="section-b.3.2-3.3">A replacement for the exchange's signature and an update for the embedded
<code>expires</code> and related cache-control HTTP headers <span>[<a href="#RFC7234" class="xref">RFC7234</a>]</span>. This naturally
extends publishers' intuitions about cache expiration and the existing cache
revalidation behavior to signed exchanges. This is sketched and its downsides
explored in <a href="#validity-with-cache-control" class="xref">Appendix C</a>.<a href="#section-b.3.2-3.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-b.3.2-4">The signature also needs to include instructions to intermediates for how to
fetch updated validity assertions.<a href="#section-b.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="low-implementation-complexity">
<section id="section-b.4">
        <h2 id="name-low-implementation-complexi">
<a href="#section-b.4" class="section-number selfRef">B.4. </a><a href="#name-low-implementation-complexi" class="section-name selfRef">Low implementation complexity</a>
        </h2>
<p id="section-b.4-1">Simpler implementations are, all things equal, less likely to include bugs. This
section describes decisions that were made in the rest of the specification to
reduce complexity.<a href="#section-b.4-1" class="pilcrow">¶</a></p>
<div id="limited-choices">
<section id="section-b.4.1">
          <h3 id="name-limited-choices">
<a href="#section-b.4.1" class="section-number selfRef">B.4.1. </a><a href="#name-limited-choices" class="section-name selfRef">Limited choices</a>
          </h3>
<p id="section-b.4.1-1">In general, we're trying to eliminate unnecessary choices in the specification.
For example, instead of requiring clients to support two methods for verifying
payload integrity, we only require one.<a href="#section-b.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="bounded-buffering-integrity-checking">
<section id="section-b.4.2">
          <h3 id="name-bounded-buffering-integrity">
<a href="#section-b.4.2" class="section-number selfRef">B.4.2. </a><a href="#name-bounded-buffering-integrity" class="section-name selfRef">Bounded-buffering integrity checking</a>
          </h3>
<p id="section-b.4.2-1">Clients can be designed with a more-trusted network layer that decides how to
trust resources and then provides those resources to less-trusted rendering
processes along with handles to the storage and other resources they're allowed
to access. If the network layer can enforce that it only operates on chunks of
data up to a certain size, it can avoid the complexity of spooling large files
to disk.<a href="#section-b.4.2-1" class="pilcrow">¶</a></p>
<p id="section-b.4.2-2">To allow the network layer to verify signed exchanges using a bounded amount of
memory, <a href="#application-signed-exchange" class="xref">Section 5.3</a> requires the signature to be less than
16kB and the headers to be less than 512kB, and <a href="#signature-validity" class="xref">Section 3.5</a> requires
that the MI record size be less than 16kB. This allows the network layer to
validate a bounded chunk at a time, and pass that chunk on to a renderer, and
then forget about that chunk before processing the next one.<a href="#section-b.4.2-2" class="pilcrow">¶</a></p>
<p id="section-b.4.2-3">The <code>Digest</code> header field from <span>[<a href="#RFC3230" class="xref">RFC3230</a>]</span> requires the network layer to buffer
the entire response body, so it's disallowed.<a href="#section-b.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="validity-with-cache-control">
<section id="section-appendix.c">
      <h2 id="name-determining-validity-using-">
<a href="#section-appendix.c" class="section-number selfRef">Appendix C. </a><a href="#name-determining-validity-using-" class="section-name selfRef">Determining validity using cache control</a>
      </h2>
<p id="section-appendix.c-1">This draft could expire signature validity using the normal HTTP cache control
headers (<span>[<a href="#RFC7234" class="xref">RFC7234</a>]</span>) instead of embedding an expiration date in the signature
itself. This section specifies how that would work, and describes why I haven't
chosen that option.<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
<p id="section-appendix.c-2">The signatures in the <code>Signature</code> header field (<a href="#signature-header" class="xref">Section 3.1</a>) would no
longer contain "date" or "expires" fields.<a href="#section-appendix.c-2" class="pilcrow">¶</a></p>
<p id="section-appendix.c-3">The validity-checking algorithm (<a href="#signature-validity" class="xref">Section 3.5</a>) would initialize <code>date</code>
from the resource's <code>Date</code> header field (Section 7.1.1.2 of <span>[<a href="#RFC7231" class="xref">RFC7231</a>]</span>) and
initialize <code>expires</code> from either the <code>Expires</code> header field (Section 5.3 of
<span>[<a href="#RFC7234" class="xref">RFC7234</a>]</span>) or the <code>Cache-Control</code> header field's <code>max-age</code> directive (Section
5.2.2.8 of <span>[<a href="#RFC7234" class="xref">RFC7234</a>]</span>) (added to <code>date</code>), whichever is present, preferring
<code>max-age</code> (or failing) if both are present.<a href="#section-appendix.c-3" class="pilcrow">¶</a></p>
<p id="section-appendix.c-4">Validity updates (<a href="#updating-validity" class="xref">Section 3.6</a>) would include a list of replacement
response header fields. For each header field name in this list, the client
would remove matching header fields from the stored exchange's response header
fields. Then the client would append the replacement header fields to the stored
exchange's response header fields.<a href="#section-appendix.c-4" class="pilcrow">¶</a></p>
<div id="example-of-updating-cache-control">
<section id="section-c.1">
        <h2 id="name-example-of-updating-cache-c">
<a href="#section-c.1" class="section-number selfRef">C.1. </a><a href="#name-example-of-updating-cache-c" class="section-name selfRef">Example of updating cache control</a>
        </h2>
<p id="section-c.1-1">For example, given a stored exchange of:<a href="#section-c.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-http" id="section-c.1-2">
<pre>
GET  / HTTP/1.1
Host: example.com
Accept: */*

HTTP/1.1 200
Date: Mon, 20 Nov 2017 10:00:00 UTC
Content-Type: text/html
Date: Tue, 21 Nov 2017 10:00:00 UTC
Expires: Sun, 26 Nov 2017 10:00:00 UTC

&lt;!doctype html&gt;
&lt;html&gt;
...
</pre><a href="#section-c.1-2" class="pilcrow">¶</a>
</div>
<p id="section-c.1-3">And an update listing the following headers:<a href="#section-c.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-http" id="section-c.1-4">
<pre>
Expires: Fri, 1 Dec 2017 10:00:00 UTC
Date: Sat, 25 Nov 2017 10:00:00 UTC
</pre><a href="#section-c.1-4" class="pilcrow">¶</a>
</div>
<p id="section-c.1-5">The resulting stored exchange would be:<a href="#section-c.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft art-http" id="section-c.1-6">
<pre>
GET / HTTP/1.1
Host: example.com
Accept: */*

HTTP/1.1 200
Content-Type: text/html
Expires: Fri, 1 Dec 2017 10:00:00 UTC
Date: Sat, 25 Nov 2017 10:00:00 UTC

&lt;!doctype html&gt;
&lt;html&gt;
...
</pre><a href="#section-c.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="downsides-of-cache-control">
<section id="section-c.2">
        <h2 id="name-downsides-of-updating-cache">
<a href="#section-c.2" class="section-number selfRef">C.2. </a><a href="#name-downsides-of-updating-cache" class="section-name selfRef">Downsides of updating cache control</a>
        </h2>
<p id="section-c.2-1">In an exchange with multiple signatures, using cache control to expire
signatures forces all signatures to initially live for the same period. Worse,
the update from one signature's "validity-url" might not match the update for
another signature. Clients would need to maintain a current set of headers for
each signature, and then decide which set to use when actually parsing the
resource itself.<a href="#section-c.2-1" class="pilcrow">¶</a></p>
<p id="section-c.2-2">This need to store and reconcile multiple sets of headers for a single signed
exchange argues for embedding a signature's lifetime into the signature.<a href="#section-c.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="change-log">
<section id="section-appendix.d">
      <h2 id="name-change-log">
<a href="#section-appendix.d" class="section-number selfRef">Appendix D. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<p id="section-appendix.d-1">RFC EDITOR PLEASE DELETE THIS SECTION.<a href="#section-appendix.d-1" class="pilcrow">¶</a></p>
<p id="section-appendix.d-2">draft-09<a href="#section-appendix.d-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-3.1">No change<a href="#section-appendix.d-3.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-4">draft-08<a href="#section-appendix.d-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-5.1">Improve the privacy considerations.<a href="#section-appendix.d-5.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-6">draft-07<a href="#section-appendix.d-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-7.1">Provisionally register application/signed-exchange and
application/cert-chain+cbor.<a href="#section-appendix.d-7.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-8">draft-06<a href="#section-appendix.d-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-9.1">Add a security consideration for future-dated OCSP responses and for stolen
private keys.<a href="#section-appendix.d-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-9.2">Define a CAA parameter to opt into certificate issuance.<a href="#section-appendix.d-9.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-9.3">Limit certificate lifetimes to 90 days.<a href="#section-appendix.d-9.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-9.4">UTF-8 decode the fallback URL.<a href="#section-appendix.d-9.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-10">draft-05<a href="#section-appendix.d-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-11.1">Define absolute URLs, and limit the schemes each instance can use.<a href="#section-appendix.d-11.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-11.2">Fill in TBD size limits.<a href="#section-appendix.d-11.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-11.3">Update to mice-03 including the Digest header.<a href="#section-appendix.d-11.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-11.4">Refer to draft-yasskin-httpbis-origin-signed-exchanges-impl for draft version
numbers.<a href="#section-appendix.d-11.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-11.5">Require <code>exchange</code>'s response to be cachable by a shared cache.<a href="#section-appendix.d-11.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-11.6">Define the "integrity" field of the Signature header to include subfields of
the main integrity-protecting header, including the digest algorithm.<a href="#section-appendix.d-11.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-11.7">Put a fallback URL at the beginning of the <code>application/signed-exchange</code>
format, which replaces the ':url' key from the CBOR representation of the
exchange's request and response metadata and headers.<a href="#section-appendix.d-11.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-11.8">Remove the rest of the request headers from the signed data, in favor of
representing content negotiation with the <code>Variants</code> response header.<a href="#section-appendix.d-11.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-11.9">Make the signed message format a concatenation of byte sequences, which helps
implementations avoid re-serializing the exchange's request and response
metadata and headers.<a href="#section-appendix.d-11.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-11.10">Explicitly check the response payload's integrity instead of assuming the
client did it elsewhere in processing the response.<a href="#section-appendix.d-11.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-11.11">Reject uncached header fields.<a href="#section-appendix.d-11.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-11.12">Update to draft-ietf-httpbis-header-structure-09.<a href="#section-appendix.d-11.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-11.13">Update to the final TLS 1.3 RFC.<a href="#section-appendix.d-11.13" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-12">draft-04<a href="#section-appendix.d-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-13.1">Update to draft-ietf-httpbis-header-structure-06.<a href="#section-appendix.d-13.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-13.2">
          <p id="section-appendix.d-13.2.1">Replace the application/http-exchange+cbor format with a simpler
application/signed-exchange format that:<a href="#section-appendix.d-13.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-13.2.2.1">Doesn't require a streaming CBOR parser parse it from a network stream.<a href="#section-appendix.d-13.2.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-appendix.d-13.2.2.2">Doesn't allow request payloads or response trailers, which don't fit into
the signature model.<a href="#section-appendix.d-13.2.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-appendix.d-13.2.2.3">Allows checking the signature before parsing the exchange headers.<a href="#section-appendix.d-13.2.2.3" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-appendix.d-13.3">Require absolute URLs.<a href="#section-appendix.d-13.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-13.4">Make all identifiers in headers lower-case, as required by Structured Headers.<a href="#section-appendix.d-13.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-13.5">Switch back to the TLS 1.3 signature format.<a href="#section-appendix.d-13.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-13.6">Include the version and draft number in the signature context string.<a href="#section-appendix.d-13.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-13.7">Remove support for integrity protection using the Digest header field.<a href="#section-appendix.d-13.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-13.8">Limit the record size in the mi-sha256 encoding.<a href="#section-appendix.d-13.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-13.9">Forbid RSA keys, and only require clients to support secp256r1 keys.<a href="#section-appendix.d-13.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-13.10">Add a test OID for the CanSignHttpExchanges X.509 extension.<a href="#section-appendix.d-13.10" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-14">draft-03<a href="#section-appendix.d-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-15.1">Allow each method of transferring an exchange to define which headers are
signed, have the cross-origin methods use all headers, and remove the
<code>allResponseHeaders</code> flag.<a href="#section-appendix.d-15.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-15.2">Describe footguns around signing private content, and block certain headers to
make it less likely.<a href="#section-appendix.d-15.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-15.3">Define a CBOR structure to hold the certificate chain instead of re-using the
TLS1.3 message. The TLS 1.3 parser fails on unexpected extensions while this
format should ignore them, and apparently TLS implementations don't expose
their message parsers enough to allow passing a message to a certificate
verifier.<a href="#section-appendix.d-15.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-15.4">Require an X.509 extension for the signing certificate.<a href="#section-appendix.d-15.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-16">draft-02<a href="#section-appendix.d-16" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-17.1">Signatures identify a header (e.g. Digest or MI) to guard the payload's
integrity instead of directly signing over the payload.<a href="#section-appendix.d-17.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-17.2">The validityUrl is signed.<a href="#section-appendix.d-17.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-17.3">Use CBOR maps where appropriate, and define how they're canonicalized.<a href="#section-appendix.d-17.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-17.4">Remove the update.url field from signature validity updates, in favor of just
re-fetching the original request URL.<a href="#section-appendix.d-17.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-17.5">Define an HTTP/2 extension to use a setting to enable cross-origin Server
Push.<a href="#section-appendix.d-17.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-17.6">Define an <code>Accept-Signature</code> header to negotiate whether to send Signatures
and which ones.<a href="#section-appendix.d-17.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-17.7">Define an <code>application/http-exchange+cbor</code> format to fetch signed exchanges
without HTTP/2 Push.<a href="#section-appendix.d-17.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-17.8">2 new use cases.<a href="#section-appendix.d-17.8" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="acknowledgements">
<section id="section-appendix.e">
      <h2 id="name-acknowledgements">
<a href="#section-appendix.e" class="section-number selfRef">Appendix E. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.e-1">Thanks to Andrew Ayer, Devin Mullins, Ilari Liusvaara, John Wilander, Justin
Schuh, Mark Nottingham, Mike Bishop, Ryan Sleevi, and Yoav Weiss for comments
that improved this draft.<a href="#section-appendix.e-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.f">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jeffrey Yasskin</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jyasskin@chromium.org" class="email">jyasskin@chromium.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
