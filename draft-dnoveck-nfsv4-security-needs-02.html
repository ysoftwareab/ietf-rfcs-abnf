<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Security Needs for the NFSv4 Protocols</title>
<meta content="David Noveck" name="author">
<meta content="Charles Lever" name="author">
<meta content="
       
This document
discusses the inadequate approach to security
within the family of NFSv4 protocol specifications
and
proposes steps to correct the situation.
Because the security architecture is similar
for all NFSv4 minor versions,
we recommend a single new standards-track document
to encapsulate NFSv4 security fundamentals,
and
propose the introduction
of several additional security-related documents.
 
    " name="description">
<meta content="xml2rfc 3.5.0" name="generator">
<meta content="draft-dnoveck-nfsv4-security-needs-02" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.2
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.25.1
    setuptools 51.0.0
    six 1.15.0
-->
<link href="/tmp/draft-dnoveck-nfsv4-security-needs-02-2za2nnvo.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">NFSv4 Security Needs</td>
<td class="right">January 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Noveck &amp; Lever</td>
<td class="center">Expires 25 July 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network File System Version 4</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-dnoveck-nfsv4-security-needs-02</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-01-21" class="published">21 January 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-07-25">25 July 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Noveck</div>
<div class="org">NetApp</div>
</div>
<div class="author">
      <div class="author-name">C. Lever, <span class="editor">Ed.</span>
</div>
<div class="org">Oracle</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Security Needs for the NFSv4 Protocols</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
This document
discusses the inadequate approach to security
within the family of NFSv4 protocol specifications
and
proposes steps to correct the situation.
Because the security architecture is similar
for all NFSv4 minor versions,
we recommend a single new standards-track document
to encapsulate NFSv4 security fundamentals,
and
propose the introduction
of several additional security-related documents.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <p id="section-note.1-1">
Discussion of this draft takes place
on the NFSv4 working group mailing list (nfsv4@ietf.org),
which is archived at
<span><a href="https://mailarchive.ietf.org/arch/browse/nfsv4/">https://mailarchive.ietf.org/arch/browse/nfsv4/</a></span>.
Working Group information can be found at
<span><a href="https://datatracker.ietf.org/wg/nfsv4/about/">https://datatracker.ietf.org/wg/nfsv4/about/</a></span>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">This note is to be removed before publishing as an RFC.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
The source for this draft is maintained in GitHub.
Suggested changes should be submitted as pull requests at
<span><a href="https://github.com/chucklever/i-d-security-needs">https://github.com/chucklever/i-d-security-needs</a></span>.
Instructions are on that page as well.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 25 July 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-requirements-language-as-us" class="xref">Requirements Language as Used in This Document</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-glossary" class="xref">Glossary</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-use-of-this-document" class="xref">Use of this Document</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-current-use-of-this-documen" class="xref">Current Use of this Document</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-future-use-of-this-document" class="xref">Future Use of this Document</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-situation-to-be-addressed" class="xref">Situation to be Addressed</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-nfsv4-use-environments-to-b" class="xref">NFSv4 Use Environments to be Addressed</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-emergence-and-correction-of" class="xref">Emergence and Correction of Security Issues</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-major-problems-to-address" class="xref">Major Problems to Address</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-problems-with-security-pres" class="xref">Problems with Security Presentation/Organization</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-problems-with-presentation-" class="xref">Problems with Presentation of Security Architecture</a><a href="#section-toc.1-1.5.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-problems-with-security-eval" class="xref">Problems with Security Evaluation</a><a href="#section-toc.1-1.5.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-the-treatment-of-auth_sys" class="xref">The Treatment of AUTH_SYS</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-current-auth_sys-security-p" class="xref">Current AUTH_SYS Security Policies</a><a href="#section-toc.1-1.5.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-working-group-actions" class="xref">Working Group Actions</a><a href="#section-toc.1-1.5.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-problems-with-confidentiali" class="xref">Problems with Confidentiality</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-file-access-control" class="xref">File Access Control</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="xref">5.4.1</a>.  <a href="#name-file-content-integrity-and-" class="xref">File Content Integrity and Provenance</a><a href="#section-toc.1-1.5.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-framework-for-correcting-pr" class="xref">Framework for Correcting Problems</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-correcting-problems-with-re" class="xref">Correcting Problems with Regard to Threat Analyses</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-correcting-problems-with-reg" class="xref">Correcting Problems with Regard to Use of Normative Terms</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-opportunities-for-improveme" class="xref">Opportunities for Improvement Provided by Recent Work within the RPC Layer</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-opportunities-for-improvemen" class="xref">Opportunities for Improvement in Encryption</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-opportunities-for-improvement" class="xref">Opportunities for Improvement in Authentication</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-opportunities-for-improvement-" class="xref">Opportunities for Improvement when Using RDMA Transports</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-issues-that-need-to-be-addr" class="xref">Issues that Need to be Addressed</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-threat-analysis-goals" class="xref">Threat  Analysis Goals</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="xref">8.1.1</a>.  <a href="#name-background" class="xref">Background</a><a href="#section-toc.1-1.8.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a href="#section-8.1.2" class="xref">8.1.2</a>.  <a href="#name-issues-to-be-addressed" class="xref">Issues to be Addressed</a><a href="#section-toc.1-1.8.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-nfsv4-extension-policies" class="xref">NFSv4 Extension Policies</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="xref">8.2.1</a>.  <a href="#name-background-2" class="xref">Background</a><a href="#section-toc.1-1.8.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="xref">8.2.2</a>.  <a href="#name-addressing-extension-issues" class="xref">Addressing Extension Issues</a><a href="#section-toc.1-1.8.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-tls-encryption-policies" class="xref">TLS Encryption Policies</a><a href="#section-toc.1-1.8.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="xref">8.3.1</a>.  <a href="#name-background-3" class="xref">Background</a><a href="#section-toc.1-1.8.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.3.2.2">
                    <p id="section-toc.1-1.8.2.3.2.2.1"><a href="#section-8.3.2" class="xref">8.3.2</a>.  <a href="#name-issues-to-address" class="xref">Issues to Address</a><a href="#section-toc.1-1.8.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-handling-of-auth_sys" class="xref">Handling of AUTH_SYS</a><a href="#section-toc.1-1.8.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.4.2.1">
                    <p id="section-toc.1-1.8.2.4.2.1.1"><a href="#section-8.4.1" class="xref">8.4.1</a>.  <a href="#name-historical-background" class="xref">Historical Background</a><a href="#section-toc.1-1.8.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.4.2.2">
                    <p id="section-toc.1-1.8.2.4.2.2.1"><a href="#section-8.4.2" class="xref">8.4.2</a>.  <a href="#name-background-for-existing-aut" class="xref">Background for Existing AUTH_SYS in NFSv4</a><a href="#section-toc.1-1.8.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.4.2.3">
                    <p id="section-toc.1-1.8.2.4.2.3.1"><a href="#section-8.4.3" class="xref">8.4.3</a>.  <a href="#name-core-issue-to-resolve-for-a" class="xref">Core Issue to Resolve for AUTH_SYS</a><a href="#section-toc.1-1.8.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.4.2.4">
                    <p id="section-toc.1-1.8.2.4.2.4.1"><a href="#section-8.4.4" class="xref">8.4.4</a>.  <a href="#name-need-to-better-document-and" class="xref">Need to Better Document and Explain Issues with AUTH_SYS</a><a href="#section-toc.1-1.8.2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.4.2.5">
                    <p id="section-toc.1-1.8.2.4.2.5.1"><a href="#section-8.4.5" class="xref">8.4.5</a>.  <a href="#name-issues-to-address-for-exist" class="xref">Issues to Address for Existing Use of AUTH_SYS</a><a href="#section-toc.1-1.8.2.4.2.5.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.4.2.6">
                    <p id="section-toc.1-1.8.2.4.2.6.1"><a href="#section-8.4.6" class="xref">8.4.6</a>.  <a href="#name-issues-to-resolve-for-revis" class="xref">Issues to Resolve for Revised Approach to AUTH_SYS</a><a href="#section-toc.1-1.8.2.4.2.6.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="xref">8.5</a>.  <a href="#name-handling-of-state-protectio" class="xref">Handling of State Protection</a><a href="#section-toc.1-1.8.2.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.5.2.1">
                    <p id="section-toc.1-1.8.2.5.2.1.1"><a href="#section-8.5.1" class="xref">8.5.1</a>.  <a href="#name-background-4" class="xref">Background</a><a href="#section-toc.1-1.8.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.5.2.2">
                    <p id="section-toc.1-1.8.2.5.2.2.1"><a href="#section-8.5.2" class="xref">8.5.2</a>.  <a href="#name-issues-to-be-addressed-2" class="xref">Issues to be Addressed</a><a href="#section-toc.1-1.8.2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-security-considerations-sec" class="xref">Security Considerations Section for Eventual NFSv4-wide Standards-track Security Document</a><a href="#section-toc.1-1.10.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-security-considerations-sect" class="xref">Security Considerations Section for Eventual Rfc5661bis</a><a href="#section-toc.1-1.10.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="xref">10.3</a>.  <a href="#name-security-considerations-secti" class="xref">Security Considerations Section for Potential Revised RPC Specification Document</a><a href="#section-toc.1-1.10.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="xref">10.4</a>.  <a href="#name-security-considerations-sectio" class="xref">Security Considerations Section for Potential Standards-track Document Dealing with AUTH_SYS</a><a href="#section-toc.1-1.10.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.11.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="INTRO">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
This document proposes specification changes
that modernize NFSv4 security.
These changes are necessary because
the original goal for the NFSv4 protocol,
to enable secure file exchange on the open internet
<span>[<a href="#RFC2624" class="xref">RFC2624</a>]</span>,
has not been effectively realized.
Moreover, existing approaches to NFSv4 security
do not meet the security needs
of many contemporary restricted-access environments.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
Restricting physical access to the network
on which a client and server interact
is a common NFSv4 deployment technique.
This restriction limits access to users
associated with a particular organization
but
does not eliminate the need for protocol support
that enables completely secure operation.
<a href="#SITU-env" class="xref">Section 4.1</a>
contains a taxonomy of specific environments
and
their corresponding security needs.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
As an example,
the use of transport-layer security,
including the encryption of network traffic
and
the use of client host authentication,
can improve security when AUTH_SYS
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
is in use,
replacing the security approaches specified in
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
and
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>.
For a discussion of issues connected to
shifting the security approach of mature protocols, see
<a href="#SITU-emcorr" class="xref">Section 4.2</a>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
The current document serves as a resource
for the nfsv4 working group as it
updates current standards-track documents
and
proposes new standards-track documents
to address security issues within the NFSv4 protocol.
For further details on the expected use of this document, see
<a href="#USE" class="xref">Section 3</a>.<a href="#section-1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="TERM">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<div id="REQLANG">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.1-1">
The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
"<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
"<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
"<span class="bcp14">SHOULD NOT</span>",
"<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>"
in this document are to be interpreted
as described in BCP 14
<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>
          <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="REQLANG-usage">
<section id="section-2.2">
        <h3 id="name-requirements-language-as-us">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-requirements-language-as-us" class="section-name selfRef">Requirements Language as Used in This Document</a>
        </h3>
<p id="section-2.2-1">
The current document is Informational.
Therefore it cannot make normative statements
using the keywords defined in
<a href="#REQLANG" class="xref">Section 2.1</a>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">
However, in discussing the treatment of security
within the set of NFSv4 specifications,
there are occasions in which the current document
includes quotations from existing standards-track documents
that use these keywords.
In such cases, the definitions within BCP 14
<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>
          <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>
are to be adhered to when the terms appear in all-capitals.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">
The current document also uses these keywords
when exploring future standards-track documents.
Although these terms do not have a normative effect
in this setting,
their meaning remains the same.
These statements can
differ from
and
may contradict
existing normative statements
for one or more of the following reasons:<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-4.1">
Earlier standards-track documents did not
handle a security issue appropriately.<a href="#section-2.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-4.2">
The community did not recognize a security issue
when a standards-track document was initially approved.<a href="#section-2.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-4.3">
An actual or potential security feature was not available
at the time standards-track documents were written and approved.<a href="#section-2.2-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-5">
Changes in normative statements applying to
implementations of a particular NFSv4 minor version
require special care to avoid creating later difficulties.
Problems might arise because:<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-6.1">
Implementers might choose to
leave unimplemented
changes that are not mandatory-to-implement.<a href="#section-2.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-6.2">
A client implementation assumes that
a particular server behavior is foreclosed
(e.g., by a
"<span class="bcp14">MUST NOT</span>"
or
"<span class="bcp14">SHOULD NOT</span>"),
but a future change allows that behavior.<a href="#section-2.2-6.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="GLOSSARY">
<section id="section-2.3">
        <h3 id="name-glossary">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-glossary" class="section-name selfRef">Glossary</a>
        </h3>
<p id="section-2.3-1">
More complete definitions to be filled in later.
The security definitions are based on
<span>[<a href="#RFC3552" class="xref">RFC3552</a>]</span>
and
<span>[<a href="#RFC4949" class="xref">RFC4949</a>]</span>.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.3-2">
          <dt id="section-2.3-2.1">Authentication Flavor</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.2">
As defined in
<span><a href="https://rfc-editor.org/rfc/rfc5531#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC5531" class="xref">RFC5531</a>]</span>.<a href="#section-2.3-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.3">Confidentiality</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.4">
Data is kept secret from unintended listeners.
RPCSEC_GSS sometimes uses the term "privacy" to mean the same thing.
As defined in
<span><a href="https://rfc-editor.org/rfc/rfc3552#section-2.1.1" class="relref">Section 2.1.1</a> of [<a href="#RFC3552" class="xref">RFC3552</a>]</span>.<a href="#section-2.3-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.5">Host authentication</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.6">
The remote endpoint in the communication is the one we intended.
Also referred to as "peer authentication".
As defined in
<span><a href="https://rfc-editor.org/rfc/rfc3552#section-2.1.3" class="relref">Section 2.1.3</a> of [<a href="#RFC3552" class="xref">RFC3552</a>]</span>.<a href="#section-2.3-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.7">Identity</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.8">
A local trusted label for an object or resource,
such as a network address or a UID.<a href="#section-2.3-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.9">Integrity</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.10">
Data that is received (or read) is the same data that was sent (or written).
As defined in
<span><a href="https://rfc-editor.org/rfc/rfc3552#section-2.1.2" class="relref">Section 2.1.2</a> of [<a href="#RFC3552" class="xref">RFC3552</a>]</span>.<a href="#section-2.3-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.11">Non-repudiation</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.12">
Demonstration to a third party (or the same parties at a later time)
that both a sender's identity is certain
and the data received from that sender is the same as the data that was sent.
As defined in
<span><a href="https://rfc-editor.org/rfc/rfc3552#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC3552" class="xref">RFC3552</a>]</span>.<a href="#section-2.3-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.13">Trust</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.14">
As defined in
<span><a href="https://rfc-editor.org/rfc/rfc4949#section-4" class="relref">Section 4</a> of [<a href="#RFC4949" class="xref">RFC4949</a>]</span>.<a href="#section-2.3-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-2.15">User authentication</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-2.16">
Establish the truth that a user is who (s)he claims to be.
As discussed in
<span><a href="https://rfc-editor.org/rfc/rfc3552#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC3552" class="xref">RFC3552</a>]</span>.<a href="#section-2.3-2.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="USE">
<section id="section-3">
      <h2 id="name-use-of-this-document">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-use-of-this-document" class="section-name selfRef">Use of this Document</a>
      </h2>
<div id="USE-current">
<section id="section-3.1">
        <h3 id="name-current-use-of-this-documen">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-current-use-of-this-documen" class="section-name selfRef">Current Use of this Document</a>
        </h3>
<p id="section-3.1-1">
This document is a means to facilitate discussion
of the specific inadequacies that need to be addressed
within a new approach to NFSv4 security
that we believe is required.
For each specfic inadequacy, as discussion proceeds,
the treatment is expected evolve downward in the following list
to enable the working group to formulate text
for new standards-track documents to address the problem:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
The statement that a specific inadequacy exists and needs to be dealt with.<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.2">
A listing of potential ways to deal with a specific inadequacy.<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.3">
A proposal by the authors that a specfic adequacy is best dealt
with a particular way, possibly accompanied by a list of other
reasonable aproaches.<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.4">
A statement that the working is expected to address a specfic
inadequacy in a particular way.<a href="#section-3.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.5">
A statement that the working is addressing a specfic inadequacy in
a particular way.<a href="#section-3.1-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">
While it is expected that, if the working group concurs, this
document will be adopted as a working group document, that transition
is not expected to affect the document's pattern of use.  When
deciding on that issue the working group will not be considering the
specific propoals to address inadequacies, which can be addressed
later.  The working group will be considering whether there are
serous inadequacies requiring new documents and whether such a
document will be helpful in addressing them.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">
The working group discussion anticipated, expected to be documented
in future versions of this document, will guide the writing of a
number of expected standards-track documents:<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-5.1">
A new standards-track document discussing security for all NFSv4
minor versions, updating
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
and
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>.
It is intended that this document be referred to by
rfc5661bis
when it is ready for publication
but it should be able to be published, on its own,
before that, since it would update
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>.<a href="#section-3.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-5.2">
            <p id="section-3.1-5.2.1">
To address NFSv4.1-specific security issues, new text will be
needed in an anticipated rfc5661bis, updating
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>.<a href="#section-3.1-5.2.1" class="pilcrow">¶</a></p>
<p id="section-3.1-5.2.2">
draft-dnoveck-nfsv4-rfc5661bis
<span>[<a href="#I-D.dnoveck-nfsv4-rfc5661bis" class="xref">I-D.dnoveck-nfsv4-rfc5661bis</a>]</span>
is anticipated to be a precursor document whose drafting will be
affected.<a href="#section-3.1-5.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-6">
In addition, the working group discussion anticipated might guide the
writing of a number of potential working group documents:<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-7.1">
A new standards-track document discussing AUTH_SYS, including
discussion of the potential use of client-host authentication.<a href="#section-3.1-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-7.2">
A new standards-track document updating
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>,
focusing on a
more complete and accurate treatment of AUTH_SYS.<a href="#section-3.1-7.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="USE-future">
<section id="section-3.2">
        <h3 id="name-future-use-of-this-document">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-future-use-of-this-document" class="section-name selfRef">Future Use of this Document</a>
        </h3>
<p id="section-3.2-1">
The pattern of use discussed above is expected to continue until the
decisions to be made are finalized.  While the documents whose
drafting is to be guided, will be farly far into development, it is
not necessary for the working group to wait for publication of those
documents (or even WGLC) before scheduling WGLC for this one.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">
The question of possible publication of this document as an
informational RFC remains open.  It should probably be discussed
shortly before WGLC.  Given this uncertainty, if there is to be a
milestone associated with this document, the target should be WGLC.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="SITU">
<section id="section-4">
      <h2 id="name-situation-to-be-addressed">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-situation-to-be-addressed" class="section-name selfRef">Situation to be Addressed</a>
      </h2>
<div id="SITU-env">
<section id="section-4.1">
        <h3 id="name-nfsv4-use-environments-to-b">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-nfsv4-use-environments-to-b" class="section-name selfRef">NFSv4 Use Environments to be Addressed</a>
        </h3>
<p id="section-4.1-1">
We will consider a range of network environments and how the type of
environment affects the need for the features being introduced
to provide for secure operation.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-2">
<li id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">
Within a data center local area network, there may well be
sufficient administrative controls over the software running
on machines with physical access to the network
as to make additional security features
within NFS unnecessary.<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.1-2.1.2">
If such a network is physically isolated or has all access to
it controlled using an appropriately configured firewall, it may
be acceptable, from a security point of view, to use AUTH_SYS
without client host authentication, and without encryption,
assuming all attackers have been excluded from access.<a href="#section-4.1-2.1.2" class="pilcrow">¶</a></p>
<p id="section-4.1-2.1.3">
Although such networks typically do have firewalls, they are
generally configured to allow significant access, including
NFSv4 access, to traffic originating outside the data center,
although not outside the owning organization.  In such cases, we
effectively have a within-organization network, dealt with
in item 2 below.<a href="#section-4.1-2.1.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">
Within a network devoted to a single organization or a single
site within an organization.  Such networks often have
associated firewalls configured to exclude access from outside
the organization, and restrict it inside the organization.<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-4.1-2.2.2">
It had until recently been assumed that, by excluding access
to those outside the organization, it could be assumed that
attackers would also be excluded.  However, this approach
ignores the possibility of insider threats.  Since we feel
these threats cannot be ignored, the security of NFSv4 needs
to be upgraded to prevent attacks by insiders, making the
security needs in this case more like those on the internet.<a href="#section-4.1-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">
Use on the internet is the most challenging.  While secure use on
the internet was a goal of NFSv4 and steps were taken to achieve
that goal, the approach required a number of steps, including a
significant performance penalty and a significantly different
approach to systems administration.  Given that those administering
such systems were unwilling to adapt in this way, we now need to meet
the goal of secure use on the internet in a new way.<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
<p id="section-4.1-2.3.2">
Secure use on the internet requires not only protection of user
data in-flight from unauthorized disclosure or modification, as in
case 2 above, but
also effort to deal with the possibility of extensive external
monitoring and denial-of-service
attacks.<a href="#section-4.1-2.3.2" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-2.4">
Use of NFSv4 to access data located in the cloud poses many
of issues discussed in item 3 above.  However, in general, the
cloud service provider is responsible for protecting multiple
tenants from one another, often involving use of
tenant-specific credentials.  If the distribution of
such credentials is quite tightly limited, we can have a
situation like
that in item 1.  However, if those credentials are available to
a larger group, then the situation become like that in item 2,
with insider threats being a point of concern.<a href="#section-4.1-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-2.5">
The use of NFSv4 within cloud-located data centers presents
different issues.  If access to the NFSv4 service is
suitably restricted, the situation is quite close to that
described in case 1, with the physical location of the data
center irrelevant.  However, if there means of external
access that are not tightly restricted, the situation becomes
like that of case 2 above, with the possibility of insider
threats requiring a security model with many similarities to
that needed for the
environments described in item 3.<a href="#section-4.1-2.5" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.1-3">
As will be discussed below, NFSv4 security, as currently  defined,
has significant security issues in many of the above environments,
although not in all.  No special provisions will be made for the
more restricted environments, except where necessary to avoid
incompatibilities when interacting with existing implementations.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">
By focusing on a single set of requirements for all of these
environments, there will necessarily be occasions in
which some security-related work is required that is
not, strictly speaking, needed for the particular environment
in which it is used.   However, we have endeavored to keep the
required effort small, eliminating requirements for
major administrative changes or compute-intensive additions to
the processing path.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SITU-emcorr">
<section id="section-4.2">
        <h3 id="name-emergence-and-correction-of">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-emergence-and-correction-of" class="section-name selfRef">Emergence and Correction of Security Issues</a>
        </h3>
<p id="section-4.2-1">
The fact that serious security issues exist in many of the
environment discussed above has made it
necessary to consider taking the drastic step of modifying
security-related
recommendations for existing protocols.  This situation seems to call
for an explanation and we will attempt to provide one.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">
One possible form this might take would be to
explain why
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
and
<span>[<a href="#RFC5661" class="xref">RFC5661</a>]</span>
made erroneous choices, with accompanying commentary explaining
the choices that should have been made instead.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">
Such an explanation does not appear to be possible, since
it would not have been possible for the authors and approvers of these
documents to reach the conclusions we have adopted without an
implausible level of foresight on their part.
This is so even though we would not adopt the choices made
in
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
and
<span>[<a href="#RFC5661" class="xref">RFC5661</a>]</span>
today.  Knowing what was known then,
we might well have made the same choices, although it is hard not to
fault the lack of attention, in the relevant documents, to the
security consequences of the decisions made.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">
Although we will call
attention in sections below to things which might have been done
differently, this does indicate that we believe that
the authors and approvers of these
documents, could have arrived at conclusions similar to the ones
we expect to choose now.  Our choices are so different from the
ones made previously because they take into account the needs of
NFSv4 today and take advantage of security facilities not
available earlier.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">
In order to better understand this divergence, we have to look at the
history of NFS and take note of the context in which assumptions were
established with regard to security or changes in security guidance
occurred.  In understanding this history and the choices of
RFC2119-defined keywords, the constraints on the working group need
to be understood, as described in
<a href="#CORR-norm" class="xref">Section 6.2</a><a href="#section-4.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-6.1">
The basic assumptions about security for NFS were established
over thirty years ago.  At that time, it was generally taken
for granted that a co-operating set of UNIX kernels would
provide a uniform infrastructure to govern internode sharing
within a network.  Within this framework, security concerns
focused on issues related to the appropriateness of granting or
withholding of privileges
by UNIX kernels and there was little concern for network
security as understood today.  As a result, NFS administrators
came to take for
granted the use of AUTH_SYS making it difficult to restrict its
use, despite the security weaknesses we perceive in it today.
The assumptions
underlying AUTH_SYS fit so well with the way UNIX systems were managed
in general led to the use of AUTH_SYS becoming so well-entrenched
that concrete
steps to eliminate it or to substantially restrict its use were never
seriously considered.<a href="#section-4.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-6.2">
            <p id="section-4.2-6.2.1">
When NFSv4 was developed, around twenty years ago, serious steps
were taken to improve the security situation by requiring the
implementation of RPCSEC_GSS.  This included support for encryption,
necessary to support use on the internet. AUTH_SYS was retained
as an additional optional means of authentication, which would
have allowed implementations to drop support at a later point,
although, as things developed, that became less and less likely
as use of AUTH_SYS remained quite common.<a href="#section-4.2-6.2.1" class="pilcrow">¶</a></p>
<p id="section-4.2-6.2.2">
While it is possible to interpret the treatment of the matter in
<span>[<a href="#RFC3530" class="xref">RFC3530</a>]</span>
as implying that these two (i.e. RPCSEC_GSS
and AUTH_SYS) were equivalent and to find fault with that implication,
it is not clear how different choices would have led to a
better result.  In particular, attempts to deprecate AUTH_SYS (e.g.
by using the phrase
"<span class="bcp14">SHOULD NOT</span>")
would have been problematic
in that they  might have retarded adoption of NFSv4 rather than
enhancing adoption of RPCSEC_GSS.<a href="#section-4.2-6.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-6.3">
            <p id="section-4.2-6.3.1">
When NFSv4.1 was developed, there appeared to be no reason to
change the security decisions made for NFSv4.0.  Although it
might have been possible to change the status of AUTH_SYS in
NFSv4.1, there was no reason to tie the session architecture
to changes in security that many implementers would have been
unwilling to make.<a href="#section-4.2-6.3.1" class="pilcrow">¶</a></p>
<p id="section-4.2-6.3.2">
The only significant security-related extension was the
provision made for state protection, which required the
server to protect clients from one another, apart from the
users on whose behalf requests were being made.<a href="#section-4.2-6.3.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-6.4">
In the ten years since
<span>[<a href="#RFC5661" class="xref">RFC5661</a>]</span>
was published,
there was no way to address new security needs without creating
an essentially new protocol, on the order of NFSv4.1, and there
was little interest in doing that.
Within the
framework established by
<span>[<a href="#RFC8178" class="xref">RFC8178</a>]</span>,
there was
provision for the addition of
<span class="bcp14">OPTIONAL</span>
features, while addressing
lingering security issues for existing minor versions
did not fit in that framework.<a href="#section-4.2-6.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-7">
With the above history in mind, we will look at why NFSv4 security
needs are different today and take advantage of some options that
were not available on earlier occasions in which NFSv4 security
decisions were made.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-8.1">
We have the option of providing better security for AUTH_SYS
use by implementing client host authentication.<a href="#section-4.2-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-8.2">
We have the option of providing confidentiality and integrity
even when RPCSEC_GSS is not used.<a href="#section-4.2-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-8.3">
We have the option of providing confidentiality and integrity
universally, without special configuration effort or interfering
with performance by requiring non-offloadable encryption/decryption
on the client and server.<a href="#section-4.2-8.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-8.4">
We have the option of providing state protection (to prevent
clients interfering with one another) without the special
implementation work specified in
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>.<a href="#section-4.2-8.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-9">
These options have been made available by the work at the RPC layer
described in
<a href="#OPP" class="xref">Section 7</a>
while the specifics of
having NFSv4 take advantage of these options are described in
<a href="#ISSUES" class="xref">Section 8</a>.<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<p id="section-4.2-10">
Providing a new security approach for multiple existing protocols
is potentially disruptive and due care will need to be taken to
avoid damaging implementation incompatibilities.   However, as will
be discussed below, the existing situation, in which serious
security inadequacies need to be addressed, requires that
significant changes be made.
It is our expectation that the situation
will be resolved by the eventual publication of a standards-track
document updating
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
and
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>
and much of this document will concern
itself with determining how the needed changes can resolve existing
security issues without undue disruption.<a href="#section-4.2-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="PROB">
<section id="section-5">
      <h2 id="name-major-problems-to-address">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-major-problems-to-address" class="section-name selfRef">Major Problems to Address</a>
      </h2>
<p id="section-5-1">
The problems to be addressed concern the way that security
information has been conveyed in earlier specifications (discussed in
<a href="#PROB-pres" class="xref">Section 5.1</a>)
as well as
two sets of substantive security weaknesses discussed in Sections
<a href="#PROB-authsys" class="xref">5.2</a>
and
<a href="#PROB-conf" class="xref">5.3</a>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
Although the inadequacies in the presentation of security issues
have contributed to prolongation of the substantive weaknesses and
will be discussed in the latter two sections, there is no reason to
believe that correction of the presentation problems, will, by
itself, improve the security situation, since the substantive
problems still need to be addressed. Nevertheless,
correction of the presentation
issues is necessary so that the proposed solutions to the substantive
security issues receive the proper attention and analysis, both now
in connection with the changes to be proposed, and also
going forward, as needs change.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="PROB-pres">
<section id="section-5.1">
        <h3 id="name-problems-with-security-pres">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-problems-with-security-pres" class="section-name selfRef">Problems with Security Presentation/Organization</a>
        </h3>
<p id="section-5.1-1">
While attention has previously focused on the deficiencies of
the Security Considerations sections (e.g. Lack of a threat
analysis), this is not the only presentation issue that needs to be
addressed.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
Problems with the overall presentation of NFSv4 security,
particularly the discussion
of the security architecture will be dealt with in
<a href="#PROB-pres-sa" class="xref">Section 5.1.1</a>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">
Problems with the evaluation of NFSv4 security including
the lack of a threat analysis and the contents of the
Security considerations sections will be dealt with in
<a href="#PROB-pres-sc" class="xref">Section 5.1.2</a>.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<div id="PROB-pres-sa">
<section id="section-5.1.1">
          <h4 id="name-problems-with-presentation-">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-problems-with-presentation-" class="section-name selfRef">Problems with Presentation of Security Architecture</a>
          </h4>
<p id="section-5.1.1-1">
The presentation of the NFSv4 security architecture (for both
minor versions) focuses on the work done to make RPCSEC_GSS
usable in view of the basic architectural decisions made in
going from NFSv3 to NFSv4.   These include the use of
NFS4ERR_WRONGSEC and SECINFO to allow the server namespace
to be carved into regions with the use of particular security
flavors and services (associated with particular quality-of-
protection values)
required in each one.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">
Unfortunately, features added later in the NFSv4.0 development
cycle were not integrated into the description of the security
architecture.  A list of such noteworthy features follows.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-3">
Another consequence of the approach taken to writing Security
Considerations sections has been that these sections may have
not appropriately highlighted the security implications
of new features being added to the protocols.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.1-4.1">
              <p id="section-5.1.1-4.1.1">
The addition of callbacks to NFS was not accompanied by an
explanation of how security for callbacks was to be dealt with,
It was never made clear whether the existing mandate to provide
support for RPCSEC_GSS applied to reverse-direction operation.
The fact that there is no reverse-direction complement to
NFS4ERR_WRONGSEC and SECINFO means that there is no way that
the client, as a responder, could force use of another
flavor if it did not provide support for RPCSEC_GSS authentication,
in the role of a responder.<a href="#section-5.1.1-4.1.1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4.1.2">
The fact that callbacks are normally issued by the server itself
and not on behalf a specific user, means that the typical function
of RPCSEC_GSS authentication is not relevant to the application.
However, if RPCSEC_GSS is used in the forward direction, then the
mutual authentication of client and server should be adequate to
provide authentication of the server to the client, although the
possibility that an attacker might inject a spurious callback
to the reverse-direction request stream remains a concern.<a href="#section-5.1.1-4.1.2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4.1.3">
In any case, the absence of mention of reverse-direction
authentication in a description of the NFSv4 security approach
is troubling.  The lack of mention in the
Security Considerations section is noteworthy because this
creates a large set of requests and responses for which there
is no available facility to mandate encryption, and that lack could
be exploited by monitoring attacks.<a href="#section-5.1.1-4.1.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.1-4.2">
              <p id="section-5.1.1-4.2.1">
The addition of pNFS to NFSv4.1
<span>[<a href="#RFC5661" class="xref">RFC5661</a>]</span>
required
that there be a means of providing that the proper quality of
protection by provided by the a pNFS data server implementing the
files mapping type.   Given that SECINFO is namespace-oriented,
it was necessary to define SECINFO_NONAME, implementable by the
data server, to provide this functionality.<a href="#section-5.1.1-4.2.1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4.2.2">
This security-related change, while explained adequately in
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>,
is not mentioned in the description
of the security architecture or the Security
Considerations section.   As this feature does create new threats,
it should have been mentioned in the
Security Considerations section.  Also, this
change while compatible with the existing NFSv4 security
architecture, does represent a considerable change to it.
It seems to call for special mention in a standards-track
document devoted to NFSv4 security issues.   It makes sense
to include it in an introductory section providing an
overview of the NFSv4 security architecture.<a href="#section-5.1.1-4.2.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.1-4.3">
              <p id="section-5.1.1-4.3.1">
The implementation of sessions in NFSv4.1
<span>[<a href="#RFC5661" class="xref">RFC5661</a>]</span>
created a requirement to protect clients from one another, even
when they were making requests on behalf of the same user.
Although adequate means of dealing with this issue were
described in
<span>[<a href="#RFC5661" class="xref">RFC5661</a>]</span>,
they were
<span class="bcp14">OPTIONAL</span>
features and implementation has been very limited.<a href="#section-5.1.1-4.3.1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4.3.2">
In this case, the additional exposure makes the absence of
mention of the issue in the Security Considerations section
troublesome, although its role in the limited implementation
of the corresponding security features is hard to evaluate at this
point.   In any case, this was a major architectural change
to the security architecture which requires more attention.
Over the years, there has been considerable discussion on the
NFSv4 mailing list of the lack of authentication of the client,
as opposed to the client users on whose behalf it is acting,
although no work has been undertaken to make this a basic element
of NFSv4 security.  Despite the delay, the issue now seems on its
way to effective resolution, using the work done in
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>,
as described in
<a href="#ISSUES-stp" class="xref">Section 8.5</a>.<a href="#section-5.1.1-4.3.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.1.1-5">
As we have seen, the description of the security architecture of
NFSv4 is quite limited and a new security document will have
some gaps to fill.<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="PROB-pres-sc">
<section id="section-5.1.2">
          <h4 id="name-problems-with-security-eval">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-problems-with-security-eval" class="section-name selfRef">Problems with Security Evaluation</a>
          </h4>
<p id="section-5.1.2-1">
The principal difficulty in the overall approach to security taken
in the Security Considerations section of
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
and
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>
concerns the absence of a threat analysis within these documents.
The absence of such an analysis has meant that:<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.2-2.1">
There was no occasion to determine whether the security
improvements made relative to earlier versions of NFS were
adequate to realize any particular reasonable
interpretation of the goal of "secure use on the internet",
which goal was never clearly defined.<a href="#section-5.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.2-2.2">
In the absence of a clear goal or a means of testing whether that
goal had been met, a choice of security facilities was made based
on their likely availability.   The prevalent assumption that
security against network-based attacks was not important in
most NFS environments made it
difficult to consider improvements, or to forthrightly discuss
existing security weaknesses and make plans to address them.<a href="#section-5.1.2-2.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="PROB-authsys">
<section id="section-5.2">
        <h3 id="name-the-treatment-of-auth_sys">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-the-treatment-of-auth_sys" class="section-name selfRef">The Treatment of AUTH_SYS</a>
        </h3>
<p id="section-5.2-1">
Sections 7 and 8.2 of
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
introduce the RPC auth_flavor enumerator
and
a pair of opaque fields (the credential and the verifier fields).
These fields
carry material in each RPC message that can
identify
and
authenticate the RPC client
and
the user who initiated the RPC transaction.
The enumerator field determines the structure and content of the credential and verifier.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
The simpler auth_flavors
(e.g., AUTH_SYS)
merely identify the requesting user and sending host.
These flavors do not provide any cryptographic proof of identity.
Therefore they do not provide true authentication
of the conveyed user and host identities.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">
The RPCSEC_GSS credential and verifier can both
identify
and
authenticate
the requesting user.
They can additionally provide message integrity and confidentiality.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">
<span>[<a href="#RFC3530" class="xref">RFC3530</a>]</span>,
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>,
and
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>
state that implementation of RPCSEC_GSS is
<span class="bcp14">REQUIRED</span>.
However, they do not also mandate its use,
exposing an opportunity for attackers to issue unauthenticated requests
targeting NFSv4 servers in which RPCSEC_GSS is not the only form of
authentication available.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">
Among the RPC auth_flavors that can present unauthenticated
requests to a server,
AUTH_SYS is the most significant of these for many reasons:<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-6.1">
Because the AUTH_SYS flavor is simple to implement and administer,
existing NFSv4 servers and client implementations
make it almost universally available.<a href="#section-5.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.2">
Unlike the AUTH_NONE flavor, whose name gives a fair warning
that requests are unauthenticated,
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
describes AUTH_SYS as a means of authentication
without addressing the question of what is being authenticated
and by whom.<a href="#section-5.2-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.3">
The substance of server and client implementations
is not described in standards-track documents,
leaving much to implementers' choice.<a href="#section-5.2-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.4">
There is no clear and complete description
of the security consequences of deploying AUTH_SYS RPC services.<a href="#section-5.2-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-6.5">
Even
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
designates AUTH_SYS as "insecure,
all NFSv4 minor versions continue to allow its use.<a href="#section-5.2-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-7">
The everyday use of AUTH_SYS arises from NFS's early history
and development as part of the RPC authentication function and NFSv2
<span>[<a href="#RFC1094" class="xref">RFC1094</a>]</span>
and NFSv3
<span>[<a href="#RFC1813" class="xref">RFC1813</a>]</span>.
That approach,
in which security was made the responsibility
of large multi-user clients trusted by servers,
might have made sense when it was initially developed,
but has become less relevant to NFSv4 security needs over time.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2-8">
The designers of the NFSv4 protocol made RPCSEC_GSS
mandatory-to-implement.
AUTH_SYS was left in place as an alternative
without considering the corresponding consequences for security.
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>,
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>,
and
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>
mention several common practices that servers have typically
used to determine whether AUTH_SYS requests should be accepted,
but without explicit dicussion of their obvious security weaknesses.<a href="#section-5.2-8" class="pilcrow">¶</a></p>
<div id="Current-Authsys-Security-Policies">
<section id="section-5.2.1">
          <h4 id="name-current-auth_sys-security-p">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-current-auth_sys-security-p" class="section-name selfRef">Current AUTH_SYS Security Policies</a>
          </h4>
<p id="section-5.2.1-1">
Current NFSv4 client and server implementations
commonly provide the following security policies.
These policies attempt to improve the security
offered by AUTH_SYS.
Because these policies are not specified or discussed
within standards-track documents,
they have not been subject to threat analysis.
There is an opportunity to describe and analyze
security policies for AUTH_SYS
and
other authentication flavors used with NFSv4
in an NFSv4-wide standards-track security document.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-5.2.1-2">
            <dt id="section-5.2.1-2.1">Network Address-based Access Control</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-2.2">
              <p id="section-5.2.1-2.2.1">
A typical server policy,
which first appeared with implementations
of earlier versions of NFS,
is to limit the acceptance of AUTH_SYS requests
to requests from known clients,
as determined by the client's network address.<a href="#section-5.2.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2.2.2">
The Security Considerations section of
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
does not address the possibility of address spoofing,
although it does state that
this is "certainly not a safe model",
most likely alluding to this possibility.
The text does not follow up
to call into question the use of AUTH_SYS as an
<span class="bcp14">OPTIONAL</span>
security flavor (stated earlier in the form
"<span class="bcp14">MAY</span>
be implemented").
Instead, it is used as justification
for the mandatory nature of RPCSEC_GSS implementation;
the lack of security when only AUTH_SYS is in use
is not mentioned further.<a href="#section-5.2.1-2.2.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-2.3">Network Port-based Access Control</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-2.4">
              <p id="section-5.2.1-2.4.1">
Another frequently-used server-side security policy is
to restrict the use of AUTH_SYS
based on the associated client source port,
assuming that this ensures that the client's kernel
(or a privileged user space agent) has vetted the request.
That assumption has, over time, become dubious.<a href="#section-5.2.1-2.4.1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2.4.2">
Appendix A of
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
refers to this practice as follows:<a href="#section-5.2.1-2.4.2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2.4.3">
"It should be noted that use of this flavor of authentication
does not
guarantee any security for the users or providers of a service,
in itself.  The authentication provided by this scheme can be
considered legitimate only when applications using this scheme
and the network can be secured externally, and privileged
transport addresses are used for the communicating end-points
(an example of this is the use of privileged TCP/UDP ports
in UNIX systems -- note that not all
systems enforce privileged transport address mechanisms)."<a href="#section-5.2.1-2.4.3" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-2.5">Identity Squashing</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-2.6">
              <p id="section-5.2.1-2.6.1">
NFS servers can implement a security policy that
executes all AUTH_SYS requests
as a suitably unprivileged user ID,
such as the anonymous user.
An alternate policy treats
only requests from a particular privileged user ID
(e.g., root) this way.<a href="#section-5.2.1-2.6.1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2.6.2">
Squashing does not prevent an attacker from
masquerading as another user
but only limits the range of user identities
that can be assumed without difficulty.<a href="#section-5.2.1-2.6.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="Authsys-Working-Group-Actions">
<section id="section-5.2.2">
          <h4 id="name-working-group-actions">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-working-group-actions" class="section-name selfRef">Working Group Actions</a>
          </h4>
<p id="section-5.2.2-1">
The Security Considerations section of
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
states that AUTH_SYS is "known to be insecure"
and further states
"AUTH_SYS
<span class="bcp14">SHOULD NOT</span>
be used for services that permit clients to modify data."
Nevertheless, AUTH_SYS has been commonly used
by NFSv4 clients modifying data
since NFSv4 was first implemented,
while the security consequences have never been addressed.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">
Given the security difficulties that use of AUTH_SYS gives rise to,
the NFS community faces a choice between a few alternatives:<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-3.1">
              <p id="section-5.2.2-3.1.1">
Take steps to
eliminate
or
otherwise minimize
the use of AUTH_SYS as a valid authentication flavor,
either for NFSv4 as a whole
or
for minor versions based on NFSv4.1,
whose description was published as a Proposed Standard
after the publication of
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>,
which stated that AUTH_SYS was "known to be insecure".<a href="#section-5.2.2-3.1.1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3.1.2">
Given the many clients using AUTH_SYS,
such steps might take the form of recommendations,
with the difficulty of switching authentication models
considered a valid reason
to continue to use AUTH_SYS
as long as one is aware of the security consequences.<a href="#section-5.2.2-3.1.2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3.1.3">
Regardless of the working group's choice of normative terms,
it is crucial that new NFSv4 standards clearly explain
the security consequences of using AUTH_SYS.<a href="#section-5.2.2-3.1.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-3.2">
              <p id="section-5.2.2-3.2.1">
Revise AUTH_SYS to enable secure implementation of an
authentication model in which authenticated client hosts
determine, within appropriate limits,
the user IDs used for each request sent.<a href="#section-5.2.2-3.2.1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3.2.2">
To do this, servers would authenticate client hosts issuing
AUTH_SYS requests, taking advantage of the authentication
provided by
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>
as described in
<a href="#OPP-auth" class="xref">Section 7.2</a>.
A more detailed discussion of issues to be addressed
in establishing
the rules for this form of authentication appears in
<a href="#ISSUES-asys-resnew" class="xref">Section 8.4.6</a>.<a href="#section-5.2.2-3.2.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-3.3">
Continue to pursue alternative RPC security mechanisms
that are simple to deploy and not costly to run.
One such mechanism is RPC-over-TLS,
which should be available in time to include in security documents
published together with rfc5661bis.
However, we can easily imagine mechanisms
based on other open federated authentication standards
that can be made available within NFSv4 via subsequent extensions.<a href="#section-5.2.2-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.2.2-4">
The nfsv4 working group should consider all of these alternatives.<a href="#section-5.2.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2.2-5">
The first of these is unlikely to be feasible;
otherwise, the NFS community might have already attempted such a step.
The use of AUTH_SYS has continued even though
alternatives are available,
and there is no reason to expect that the use of the words
"<span class="bcp14">SHOULD NOT</span>"
or
"<span class="bcp14">MUST NOT</span>"
would prevent implementers from continuing to support it or
administrators depending on such support,
despite the negative effect on the security of NFSv4 implementations<a href="#section-5.2.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2.2-6">
Because of the current predominant role of AUTH_SYS in existing
NFSv4 implementations, providing better security while remaining
within the AUTH_SYS framework will also be difficult because of
the issues discussed earlier in
<a href="#CORR-norm" class="xref">Section 6.2</a>.
Nevertheless,
we feel it needs to be attempted as a new security framework
cannot address AUTH_SYS without clearly discussing its security
weaknesses.
Once that is done, we need to take advantage of
strong client host authentication
to provide a modicum of security
while allowing administrators to
delegate credential-checking to trusted clients,
as they are now accustomed to doing.<a href="#section-5.2.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2.2-7">
This approach is far from ideal.
It requires a trust relationship between clients and servers.
Adopting it provides a reasonable approach to support NFSv4
in the near-term while allowing the development
of a better alternative
(e.g., a new authentication flavor)
to proceed in parallel.
Concerning our immediate need for better NFSv4 security,
the obvious alternatives might not be realizable:<a href="#section-5.2.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-8.1">
Given the weaknesses of AUTH_SYS
and
the need to present a threat analysis,
we cannot commend AUTH_SYS without client host authentication as
<span class="bcp14">OPTIONAL</span>
to use, either explicitly or by implication.<a href="#section-5.2.2-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-8.2">
Recommending that AUTH_SYS without client host authentication
not be used, with RPCSEC_GSS as the only alternative,
will not be effective and would limit adoption
of a better, although far-from-ideal, alternative.<a href="#section-5.2.2-8.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.2.2-9">
Therefore, the authors propose that
upcoming NFSv4 standards-track documents mandate or recommend
that, when AUTH_SYS is in use,
a form of strong host authentication is always deployed along with it.
Ultimately this is a matter for working group decision, however.
For a further discussion of related issues, see
<a href="#ISSUES-asys-rescore" class="xref">Section 8.4.3</a>.
Although the rest of this document assumes the
authors' preference is selected,
<a href="#ISSUES-asys-rescore" class="xref">Section 8.4.3</a>
explains the changes to an eventual standards-track document
required if the working group concludes that different choices are necessary.<a href="#section-5.2.2-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="PROB-conf">
<section id="section-5.3">
        <h3 id="name-problems-with-confidentiali">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-problems-with-confidentiali" class="section-name selfRef">Problems with Confidentiality</a>
        </h3>
<p id="section-5.3-1">
Confidentiality is currently provided within NFSv4 by the use of
RPCSEC_GSS, with the server charged with enforcing any
administrator-specified needs to use these facilities
on appropriate
portions of the server namespace.   Requirements
for the use of integrity protection are
handled similarly.  This approach is capable of providing
confidentiality when accessing certain directories or file systems,
assuming that files that require such protection can be isolated
in certain regions of the server namespace.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">
An important difficulty with regard to this approach to
confidentiality is that there is significant non-encrypted data
sent on NFSv4 connections
which can allow extensive data to be gathered on the part of
those engaged in monitoring attacks<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-3.1">
Certain parts of RPC requests and response are not encrypted
and can be the basis of traffic analysis.   Fortunately, the
structure of NFSv4 requests limits the data exposed since the
requested operation is always COMPOUND (or CB_COMPOUND).
Nevertheless, the size of requests and information determinable from
those allows patterns of reading and writing data by specific
clients to be inferred.<a href="#section-5.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-3.2">
Because the focus of this approach is on areas of the server
namespace, there is no way to force use of encryption on
requests used to set up connections and sessions.<a href="#section-5.3-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-3.3">
Similarly, there is no provision for negotiating/enforcing
the use of integrity or encryption on reverse-direction requests.<a href="#section-5.3-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-4">
Despite the availability of encryption in NFSv4, it is very rarely
used, which makes its formal sufficiency essentially irrelevant.
In understanding why confidentiality is not more generally
used, we need look at the issues below in order to understand
how to address the problem going forward.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-5.1">
            <p id="section-5.3-5.1.1">
The cost is such that its use has a noticeable effect on
performance, given that the design (by
requiring different keys for different users) makes it difficult or
impossible for the work of encryption to be offloaded.<a href="#section-5.3-5.1.1" class="pilcrow">¶</a></p>
<p id="section-5.3-5.1.2">
It is likely that, given increasing network speeds, this factor
is more important today than it was when this approach was
settled upon.<a href="#section-5.3-5.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-5.2">
In many environments it might not be possible to isolate
files needing such protection in a way consistent with the way
file protections are normally managed.   As a result, encryption
would be present for all files or for none, with none being chosen
most often because of performance concerns.<a href="#section-5.3-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-5.3">
Implementation of confidentiality requirements may face
difficulties due to uncertainty about whether client encryption
support is available.  For example,
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
specifies that privacy support is required (although only for
krb5), while
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>
says only that clients
"<span class="bcp14">SHOULD</span>"
support privacy.  The document give no guidance regarding
what might be considered valid reasons to not support privacy,
leaving servers without any reliable way of demanding
confidentiality on certain portions of the server namespace.<a href="#section-5.3-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-5.4">
The concurrent use of AUTH_SYS might have a similar inhibiting
effect.   While it is possible, within the protocol, to force
a transition to use of RPCSEC_GSS with privacy, RPCSEC GSS
access might not be possible in many cases (e. g. the proper
id mapping facilities might not have been configured).<a href="#section-5.3-5.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-5.5">
The current Security Considerations sections for the
NFSv4 protocols may have contributed to the continuation of the
problem by not drawing sufficient attention to the security
issues involved in allowing access without encryption.<a href="#section-5.3-5.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-6">
Looking at the relevant Security Considerations sections, we find
the following:<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-7.1">
Although the cost of performing encryption is mentioned as a
reason not to perform it, there is no discussion of the security
consequences of not performing it.<a href="#section-5.3-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-7.2">
Similarly, there is no
discussion of the use of integrity services in preventing
modification of user data in flight and the data corruption
that attackers could cause when these services are not used.<a href="#section-5.3-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-7.3">
There are a number of references to integrity protection for
various sort of operations but none connected with the
protection of user data, possibly suggesting to the reader
that this issue is not important.  Ironically, while
the operations used to
obtain security requirements for a given portion of the
namespace are among these mentioned,
an attacker could not use these to
obtain transmission in the clear but would instead cause
denial-of-service, as would happen the bogus security
parameters were rejected.<a href="#section-5.3-7.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-8">
All of the issues discussed above may have contributed to the
lack of use of encryption with NFSv4, but the issues of
poor performance due to the a non-offloadable nature of
encryption appears to have
had a critical role in creating an unsatisfactory
situation for a protocol where high performance is often
of critical importance.<a href="#section-5.3-8" class="pilcrow">¶</a></p>
<p id="section-5.3-9">
Once the choice was made to limit encryption to specific file systems
or directories, there was commonly a perceived need to
avoid the cost of encryption and the difficulties that approach
to the matter led to were exacerbated by the lack within the
Security Considerations sections of information about
the damage thus done.
Because there was insufficient attention to these issues,
effective
action to address them was delayed, until the problem
could no longer be ignored.<a href="#section-5.3-9" class="pilcrow">¶</a></p>
<p id="section-5.3-10">
Given these weaknesses with regard to encryption,
those needing to use NFSv4 outside
local area networks often implemented NFSv4 over secure tunnels.
As this work proceeded, it served as an inspiration for the
work done in
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>
that provided the opportunity to provide encryption uniformly and
potentially with high performance.   An overview of steps
necessary to address these issues appears in
<a href="#OPP-enc" class="xref">Section 7.1</a>.<a href="#section-5.3-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="FILE-access-control">
<section id="section-5.4">
        <h3 id="name-file-access-control">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-file-access-control" class="section-name selfRef">File Access Control</a>
        </h3>
<p id="section-5.4-1">
Originally, the NFS protocol provided only a
basic form of access control in the form of
permission bits (also known as mode bits).<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">
NFSv4 introduced a rich access control list mechanism
which supplements mode bit-based access control
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>.
This is referred to as a Discretionary Access Control (DAC) mechanism,
where access to the file's content is at the discretion of the file's owner
and is based on identity of the requesting user.
A more complete definition of DAC is available in
<span><a href="https://rfc-editor.org/rfc/rfc4949#section-4" class="relref">Section 4</a> of [<a href="#RFC4949" class="xref">RFC4949</a>]</span>.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">
The NFSv4.2 protocol provides a basis for supporting
Mandatory Access Control (MAC) in the form of Security Labels,
as described in
<span><a href="https://rfc-editor.org/rfc/rfc7862#section-9" class="relref">Section 9</a> of [<a href="#RFC7862" class="xref">RFC7862</a>]</span>.
Mandatory Access Control is generally mandated from
a central authority that constrains access to file content
based on broad trust categories.
Because this usage overloads the abbreviation MAC,
which can also refer to Message Authentication Codes
and Media Access Control,
we avoid using the abbreviation unless the meaning is clear.
A more detailed definition of MAC is available in
<span><a href="https://rfc-editor.org/rfc/rfc4949#section-4" class="relref">Section 4</a> of [<a href="#RFC4949" class="xref">RFC4949</a>]</span>.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">
Both of these file access authorization mechanisms need
a threat analysis
and
a discussion of exposures due to missing access control facilities.
However, without documentation of access semantics
in the case of Security Labels,
any threat analysis might not be complete.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<div id="FILE-INTEGRITY">
<section id="section-5.4.1">
          <h4 id="name-file-content-integrity-and-">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-file-content-integrity-and-" class="section-name selfRef">File Content Integrity and Provenance</a>
          </h4>
<p id="section-5.4.1-1">
Ever since RPC has supported an integrity-protected mode of
transport (via RPCSEC_GSS integrity pseudoflavors),
NFS has been able to provide a strong guarantee
that NFS messages in transit on a network are immutable.<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
<p id="section-5.4.1-2">
Recent work in block storage has extended the immutability
of file content from application to storage and back
(for example, SCSI commands related to Protection
Information, as defined by the T10 technical committee).
This provides a guarantee that what an application reads
at time T+1 is what an application wrote at time T.
The NFS protocol can and should enable this stronger
form of integrity guarantee.<a href="#section-5.4.1-2" class="pilcrow">¶</a></p>
<p id="section-5.4.1-3">
Provenance is a deeper guarantee.
It additionally identifies the author of a file's content,
and guarantees that content is exactly what the author
originally provided.
An NFS client might use verifiable provenance to gate access
to a critical executable or other resources contained
in files stored on an NFS server.<a href="#section-5.4.1-3" class="pilcrow">¶</a></p>
<p id="section-5.4.1-4">
Lastly,
some systems provide a policy-based access control mechanism
based on whether file data content passes various integrity
checks.<a href="#section-5.4.1-4" class="pilcrow">¶</a></p>
<p id="section-5.4.1-5">
These capabilities require the storage and transit
of additional metadata associated with each file,
which is currently not a part of the NFSv4 protocol.
Security Considerations sections should explain
how data is put at risk
when these capabilities are not present.<a href="#section-5.4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="CORR">
<section id="section-6">
      <h2 id="name-framework-for-correcting-pr">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-framework-for-correcting-pr" class="section-name selfRef">Framework for Correcting Problems</a>
      </h2>
<p id="section-6-1">
This section addresses the fundamental issues of the organization and
presentation of a new security framework.  The complementary issues
involved in making substantive improvements in NFSv4 security will be
dealt with in
<a href="#OPP" class="xref">Section 7</a>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="CORR-threat">
<section id="section-6.1">
        <h3 id="name-correcting-problems-with-re">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-correcting-problems-with-re" class="section-name selfRef">Correcting Problems with Regard to Threat Analyses</a>
        </h3>
<p id="section-6.1-1">
Of prime importance is the inclusion of appropriate threat analyses,
even apart from the requirement (in BCP 72
<span>[<a href="#RFC3552" class="xref">RFC3552</a>]</span>)
that such analyses appear in Security Considerations sections.
As we have already seen, without such an
analysis, there is no way to determine whether any security changes
adopted are adequate to address NFSv4's security difficulties.  In
the case of NFSv4, because of its complicated history and the
conflict
between the status of AUTH_SYS as specified by the NFSv4
specification
documents
(<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>,
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>)
and that in
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>,
there might be multiple analyses, located in different places:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">
Because the security needs of the various minor versions are so
similar, the bulk of the analysis could appear in an NFSv4-wide
standards-track document updating
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span> and
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>.<a href="#section-6.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-2.2">
The case of a threat analysis for AUTH_SYS raises a special set
of issues.  Currently, AUTH_SYS is discussed and
declared "insecure" within
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
with no threat analysis appearing
within the document.  A new threat analysis could
appear in the NFSv4-wide security document referred to above
but the fact that AUTH_SYS might be considered as part of
RPC rather than of NFSv4, might dictate otherwise.
Such an analysis might appear in
a document updating
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>,
or in a new
document devoted to that specific purpose.   Whichever choice is
made, there will be a need for a document updating
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>.<a href="#section-6.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.1-3">
The appropriate location of a threat analysis for AUTH_SYS as
currently used depends on the question of whether to consider
AUTH_SYS as part of RPC, as it formally is, or to transfer
responsibility to NFSv4, since it was deprecated as insecure in
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>,
while at the same time embedded
as a heavily used optional feature for all minor versions of
NFSv4, including a new protocol, NFSv4.1 published as a Proposed
Standard subsequently, in
<span>[<a href="#RFC5661" class="xref">RFC5661</a>]</span>.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">
Also relevant to the question of the appropriate location for
this threat analysis is the question of whether there might be a
need for a revised treatment of AUTH_SYS including client host
authentication.  The possible existence of such a revised
treatment,  together with issues related to a threat analysis
necessary for its inclusion is discussed in
<a href="#ISSUES-asys-doc" class="xref">Section 8.4.4</a>.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CORR-norm">
<section id="section-6.2">
        <h3 id="name-correcting-problems-with-reg">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-correcting-problems-with-reg" class="section-name selfRef">Correcting Problems with Regard to Use of Normative Terms</a>
        </h3>
<p id="section-6.2-1">
Another important issue concerns the potential need for adjustment of
inappropriate use of terms defined by
<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>,
particularly any suggestion that use of AUTH_SYS may be validly used
without important security consequences, as suggested by the current
understanding that its use is optional.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">
However, as desirable as such clarifications might be, it is
necessary
that we be realistic about what such changes can accomplish, even if
the particular issues cited in
<a href="#REQLANG-usage" class="xref">Section 2.2</a>
are properly
attended to.  Documents can be written to define certain
implementations
as non-conformant, but the ability of any such designation to affect
implementer behavior is strongly affected by circumstances,
particularly when the
term is a hard one to pin down such as
"<span class="bcp14">SHOULD</span>"
or
"<span class="bcp14">SHOULD NOT</span>".<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">
The ability of such term choices to affect implementer behavior is
at its maximum when a new protocol is defined.   In this case, the
specification document formalizes a contract between
implementations, so
that the consequence of not following these terms is a lack of
interoperability rather the fact that one's implementation may be,
formally speaking, non-conformant.   In the case of a protocol such as
NFSv4,intended to build and extend the work of earlier NFS versions,
the ability of
the IETF to affect implementer choices is significantly reduced, as
interoperability with the existing protocol and the existing
infrastructure to support it
will be of greater importance to implementers.  Further,
it needs to be recognized that
when these terms are used to constrain security-related behavior
rather than interoperability per se, their effect on implementer
choice
is likely to be similarly reduced.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">
Although
<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>
provides definitions of
"<span class="bcp14">SHOULD</span>"
and
"<span class="bcp14">SHOULD NOT</span>",
it is difficult to determine the proper interpretation
unless it is clear what the "valid reasons" that might supersede
the recommendation or the expected consequences of doing so.  For
this reason, when these terms are used in proposed text, we will make such
matters explicit, where they are not otherwise clear, as suggested by 
<span><a href="https://rfc-editor.org/rfc/rfc2119#section-7" class="relref">Section 7</a> of [<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="OPP">
<section id="section-7">
      <h2 id="name-opportunities-for-improveme">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-opportunities-for-improveme" class="section-name selfRef">Opportunities for Improvement Provided by Recent Work within the RPC Layer</a>
      </h2>
<p id="section-7-1">
The work done to provide TLS support for RPC
(in
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>)
presents an important
opportunity to address the substantive security problems described in
Sections
<a href="#PROB-authsys" class="xref">5.2</a>
and
<a href="#PROB-conf" class="xref">5.3</a>.
While there will be
a need to specify appropriate policies for its use by NFSv4 as a
ULP (see
Sections
<a href="#ISSUES-tlse-res" class="xref">8.3.2</a>
and
<a href="#ISSUES-asys-resnew" class="xref">8.4.6</a>
for details), the following opportunities present themselves
and are likely to be taken advantage of:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">
The use of transport-level encryption is a good way of dealing
with the inadequacies discussed in
<a href="#PROB-conf" class="xref">Section 5.3</a>.
The use of a single key per connection makes offloaded
implementations possible allowing use for all requests including
those currently not encrypted.  This is discussed in more
detail in <a href="#OPP-enc" class="xref">Section 7.1</a><a href="#section-7-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.2">
Authentication of the client host, as provided by the
authentication
material presented at connection initialization might be used
to authenticate the client host, to avoid acceptance of
AUTH_SYS requests from unauthenticated clients.
This is discussed in more
detail in <a href="#OPP-auth" class="xref">Section 7.2</a><a href="#section-7-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-3">
Although
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>)
does not provide
support for RDMA transports, parallel services to provide encryption
and authentication are expected to be available, as discussed in
<a href="#OPP-rdma" class="xref">Section 7.3</a>.<a href="#section-7-3" class="pilcrow">¶</a></p>
<div id="OPP-enc">
<section id="section-7.1">
        <h3 id="name-opportunities-for-improvemen">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-opportunities-for-improvemen" class="section-name selfRef">Opportunities for Improvement in Encryption</a>
        </h3>
<p id="section-7.1-1">
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>
provides the ability
to encrypt all traffic on the connection used between an NFSv4
client and server.   This requires that that both the client and
server provide support for RPC-over-TLS.  Appropriate
requirements/recommendations are discussed in
<a href="#ISSUES-tlse-res" class="xref">Section 8.3.2</a>.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">
Because this facility is based on an opportunistic use of TLS,
there is a need for ULP-defined policies to deal with situations
in which the server rejected the request for a TLS connection.
These matters are discussed in
<a href="#ISSUES-tlse-res" class="xref">Section 8.3.2</a>
as well, as is the policy that servers are to adopt when dealing
with a connection on which RPC-over-TLS is not requested.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">
Because this new form of encryption is being added to
an existing protocol, all of these policies are more
complicated than would be the case for a new protocol, since
there might be a need to accommodate earlier implementations,
which might not have had time to be enhanced, while providing
the ability to take advantage of whatever confidentiality support
that might be present for a given client and server.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="OPP-auth">
<section id="section-7.2">
        <h3 id="name-opportunities-for-improvement">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-opportunities-for-improvement" class="section-name selfRef">Opportunities for Improvement in Authentication</a>
        </h3>
<p id="section-7.2-1">
When establishing a connection, as provided for by
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>,
authentication material is provided by the client and could be used to
authenticate the client host to the server.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">
By using this authentication material to authenticate the
client host, it would be possible
to correct some of the issues discussed in
<a href="#PROB-authsys" class="xref">Section 5.2</a>.
This would involve
clearly specifying how that material is to be used,
in contrast to the situation for the existing AUTH_SYS,
for which current documentation (in Appendix A of
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>)
is quite limited.
Any such respecification would need to be acceptable to those
used to using AUTH_SYS while avoiding the security issues
that make its further use, in the old form,
inadvisable.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">
This could allow the following improvements:<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-4.1">
This would avoid dependence on the use of source
request IP
address, which is insecure, given the possibility of
address spoofing.<a href="#section-7.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-4.2">
Authentication material could be separately defined for user and
kernel-mode clients to avoid dependence on the outdated
privileged port mechanism.<a href="#section-7.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-4.3">
More options could be provided to allow limitation of the user
ids upon behalf of which requests are made, to address the
limitations of "root squashing".<a href="#section-7.2-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-5">
The details of how the authentication material could be
used are discussed
<a href="#ISSUES-asys-resnew" class="xref">Section 8.4.6</a>.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="OPP-rdma">
<section id="section-7.3">
        <h3 id="name-opportunities-for-improvement-">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-opportunities-for-improvement-" class="section-name selfRef">Opportunities for Improvement when Using RDMA Transports</a>
        </h3>
<p id="section-7.3-1">
As noted above,
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>)
is not
supported on RDMA transports, making it necessary to provide
appropriate support for encryption and client host authentication
in other ways.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-2.1">
Often RNICs used to implement RDMA transports will often implement
encryption to secure inter-RNIC traffic.  When, as is often the
case, the inter-RNIC protocols are not standardized, the
judgment as to the adequacy of the encryption is out-of-scope,
from our point of view.   However, the client and server could
be configured to take advantage of this encryption, when it is
judged appropriate to do so by those responsible. In addition,
the transport characteristics mechanism defined in
<span>[<a href="#I-D.ietf-nfsv4-rpcrdma-version-two" class="xref">I-D.ietf-nfsv4-rpcrdma-version-two</a>]</span>
could allow
those configuring the client and server to make independent
judgments on encryption adequacy, with RPCSEC_GSS integrity and
encryption only superseded, when both agree.
(See
<a href="#ISSUES-tlse-res" class="xref">Section 8.3.2</a>
for details).<a href="#section-7.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-2.2">
Authentication material to support client host authentication
can be provided by using the transport properties mechanism
provided for in
<span>[<a href="#I-D.ietf-nfsv4-rpcrdma-version-two" class="xref">I-D.ietf-nfsv4-rpcrdma-version-two</a>]</span>.<a href="#section-7.3-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.3-3">
It should be noted that our need to normatively reference
<span>[<a href="#I-D.ietf-nfsv4-rpcrdma-version-two" class="xref">I-D.ietf-nfsv4-rpcrdma-version-two</a>]</span>
would affect the
schedule of a standards-track document dealing with NFSv4 security.
Given that the current milestone for requesting publication is
December 2020, this not expected to pose an obstacle.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ISSUES">
<section id="section-8">
      <h2 id="name-issues-that-need-to-be-addr">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-issues-that-need-to-be-addr" class="section-name selfRef">Issues that Need to be Addressed</a>
      </h2>
<p id="section-8-1">
These sections discuss the issues that need to be addressed by
new standards-track documents including both issues of the
presentation/evaluation of NFSv4
(discussed in
<a href="#PROB-pres" class="xref">Section 5.1</a>)
and the substantive security
weaknesses discussed in Sections
<a href="#PROB-authsys" class="xref">5.2</a>
and
<a href="#PROB-conf" class="xref">5.3</a>.
For each issue
there is a section providing background followed by information
suggesting how the issue would be addressed or issues that would need
to be resolved before the issue could be addressed.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="ISSUES-tag">
<section id="section-8.1">
        <h3 id="name-threat-analysis-goals">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-threat-analysis-goals" class="section-name selfRef">Threat  Analysis Goals</a>
        </h3>
<div id="ISSUES-tag-bg">
<section id="section-8.1.1">
          <h4 id="name-background">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-background" class="section-name selfRef">Background</a>
          </h4>
<p id="section-8.1.1-1">
For reasons that remain unclear, none of the specification
documents for the existing NFSv4 minor versions contain a
threat analysis.   As a result, for the reasons discussed in
<a href="#PROB-pres" class="xref">Section 5.1</a>,
we need to provide an appropriate
threat analysis for all NFSv4 minor versions.  Because of the
high degree of overlap between pairs of NFSv4 minor versions,
most of the analysis will be common to all versions.  However,
there are some areas where features in later minor versions
have significant security implications:<a href="#section-8.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.1-2.1">
              <p id="section-8.1.1-2.1.1">
In NFSv4.1
<span>[<a href="#RFC5661" class="xref">RFC5661</a>]</span>,
SECINFO_NO_NAME was added, in large part because it would be necessary to allow
the data server, when the pNFS file mapping type is used, to
communicate to the client that either integrity or encryption
would be required when access to file data was provided
through the data
server (as opposed to the metadata server).<a href="#section-8.1.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-8.1.1-2.1.2">
The use of TLS-based encryption, which we expect to be
recommended (see
<a href="#ISSUES-tlse-res" class="xref">Section 8.3.2</a>,
may limit the need for this feature, but it will remain
<span class="bcp14">REQUIRED</span>,
when file-based pNFS is implemented.<a href="#section-8.1.1-2.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.1-2.2">
              <p id="section-8.1.1-2.2.1">
NFSv4.1
<span>[<a href="#RFC5661" class="xref">RFC5661</a>]</span>
facilities were added to
protect locking and session-related state from modification
by other servers (i.e. SP4_MACHCRED and SP4_SSV).<a href="#section-8.1.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-8.1.1-2.2.2">
These features have had very limited implementation work, so
it would be desirable to provide alternative means to achieve
the goal, as described in
<a href="#ISSUES-stp" class="xref">Section 8.5</a>.<a href="#section-8.1.1-2.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.1.1-3">
While the bulk of the threat analysis would be minor-version-
independent, differences between minor version will have to be
noted, as will differences that reflect uses of the facilities
discussed in
<a href="#OPP" class="xref">Section 7</a>.<a href="#section-8.1.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1.1-4">
Beyond the lack of NFsv4 threat analyses, there is a further
problem in that there is no threat analysis dealing with the
AUTH_SYS case in the existing RPC specification
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>.
In this case,
the gap is easier to understand since RPC deals with security on
a per-flavor basis and declares AUTH_SYS as "insecure".
It may well
be that the authors, the working group and the IESG thought this
was adequate, and it would have been if this had resulted in its
not being used subsequently.
As things happened however, AUTH_SYS continued to be used
extensively, including for NFsv4, so that there still remains
a gap in this regard.<a href="#section-8.1.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1.1-5">
The following facts are relevant to the continued use of
AUTH_SYS despite its security problems:<a href="#section-8.1.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.1-6.1">
It was stated that AUTH_SYS
"<span class="bcp14">SHOULD NOT</span>"
be used for
services capable of modifying data.   Given that its further
use was still anticipated, in some circumstances,
a security analysis would still be
required.  In addition, use within the purview of the
"<span class="bcp14">SHOULD NOT</span>"
would make such analysis even more important, since that
recommendation would allow use presumably based on balancing
of possible benefits and corresponding problems.  Without an
understanding of
the security problems (i.e. the substance behind the
designation of AUTH_SYS as insecure), such balancing would
not be possible.<a href="#section-8.1.1-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.1.1-6.2">
Despite the recommendation that AUTH_SYS not be used for
services,
such as NFSv4, that are capable of modifying data, NFSv4 was
specified allowing such use with very limited attention to the
security issues that uses of AUTH_SYS gives rise to.
As a result, there remains a needs for an appropriate threat
analysis including for AUTH_SYS, since no matter what the
working group decides to do in this area, use of AUTH_SYS, in
connection with all NFS protocols (and possible other ONCRPC
protocols) will continue for some time.<a href="#section-8.1.1-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.1.1-6.3">
The reason stated for considering AUTH_SYS insecure, the lack
of a verifier, while worthwhile to note, does not touch the
substance of the problem, that unauthenticated requests are
accepted and potentially acted upon.   The difficulty is further
compounded by the fact that the client validation checks made
by actual implementations are
not fully described within RFC (They are described above in
<a href="#PROB-authsys" class="xref">Section 5.2</a>).<a href="#section-8.1.1-6.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="ISSUES-tag-res">
<section id="section-8.1.2">
          <h4 id="name-issues-to-be-addressed">
<a href="#section-8.1.2" class="section-number selfRef">8.1.2. </a><a href="#name-issues-to-be-addressed" class="section-name selfRef">Issues to be Addressed</a>
          </h4>
<p id="section-8.1.2-1">
It is expected that a threat analysis dealing with all NFSv4 minor
will be dealt with in new standards-track document dealing
with NFSv4 security.  Because this document will address
security for all minor versions, it will update
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>,
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>,
and
<span>[<a href="#RFC7862" class="xref">RFC7862</a>]</span>.<a href="#section-8.1.2-1" class="pilcrow">¶</a></p>
<p id="section-8.1.2-2">
There will, in addition, be a need for a threat analysis
dealing with AUTH_SYS, which might or might not appear
in the NFSv4-wide security document for reasons explained in
<a href="#CORR-threat" class="xref">Section 6.1</a>.
The question of where this best be done is discussed in
<a href="#ISSUES-asys-doc" class="xref">Section 8.4.4</a>.<a href="#section-8.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ISSUES-ext">
<section id="section-8.2">
        <h3 id="name-nfsv4-extension-policies">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-nfsv4-extension-policies" class="section-name selfRef">NFSv4 Extension Policies</a>
        </h3>
<div id="ISSUES-ext-bg">
<section id="section-8.2.1">
          <h4 id="name-background-2">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-background-2" class="section-name selfRef">Background</a>
          </h4>
<p id="section-8.2.1-1">
The basic framework for the extension of NFSv4 was
established by
<span>[<a href="#RFC8178" class="xref">RFC8178</a>]</span>.
Given that the
anticipated standards-track document dealing with NFSv4
security will, in a sense, extend NFSv4, there might
be some uncertainty about whether the changes anticipated are in line
with that extension framework and whether there might be
a need for that document to update
<span>[<a href="#RFC8178" class="xref">RFC8178</a>]</span>.<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-8.2.1-2">
The following questions need to be addressed:<a href="#section-8.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2.1-3.1">
Whether the changes in policies anticipated here, with
regard to encryption and use of AUTH_SYS, are consistent with
<span>[<a href="#RFC8178" class="xref">RFC8178</a>]</span>.<a href="#section-8.2.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.2.1-3.2">
How the use of new security-related facilities provided
at the RPC level
relates to the extension framework established by
<span>[<a href="#RFC8178" class="xref">RFC8178</a>]</span>.<a href="#section-8.2.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.2.1-3.3">
How further extensions might relate to use of such new
RPC-level facilities.<a href="#section-8.2.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.2.1-3.4">
How to deal with and document extensions that provide
new security-related features.<a href="#section-8.2.1-3.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="ISSUES-ext-res">
<section id="section-8.2.2">
          <h4 id="name-addressing-extension-issues">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-addressing-extension-issues" class="section-name selfRef">Addressing Extension Issues</a>
          </h4>
<p id="section-8.2.2-1">
We anticipate that the material would be in a section entitled,
"NFSv4 Security Changes and the Existing NFSv4 Extension Model"<a href="#section-8.2.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2.2-2">
The following introductory material seems appropriate:<a href="#section-8.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2.2-3.1">
The security-related changes recommended in this document
are outside the scope of the extension model presented in
<span>[<a href="#RFC8178" class="xref">RFC8178</a>]</span>.
However, they do not
contradict it and there is no need for this document to
update that one.<a href="#section-8.2.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.2.2-3.2">
Normally, changes requiring coordinated work on the
client and server are signaled using a new minor version.
In that case, the new minor version is essentially
treated as a new protocol and there is no need to update
<span>[<a href="#RFC8178" class="xref">RFC8178</a>]</span>
or specifications for existing minor versions.<a href="#section-8.2.2-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.2.2-4">
The following paragraphs discuss the core issues:<a href="#section-8.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2.2-5.1">
That approach is not possible in this case since the basic
need is to change the handling of existing minor versions
to improve security.  This create the possibility of
interoperability issues since there is neither a new
minor version nor a means of distinguishing
a consistent set of
<span class="bcp14">OPTIONAL</span>
features supported by the
server and known to the client.<a href="#section-8.2.2-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.2.2-5.2">
              <p id="section-8.2.2-5.2.1">
In order to limit the possibility of interoperability issues,
the security changes are made in the form of recommendations,
but, because there exist implementations built before these
recommendations were in effect, clients and server have to
be aware of the possibility that these recommendations might not
be followed.   As a result, the effect of these recommendations,
made to limit security issues, is, from an interoperability point
of view, similar to those that might arise from
<span class="bcp14">OPTIONAL</span>
features.
With regard to the NFSv4 extension framework,<a href="#section-8.2.2-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2.2-5.2.2.1">
                  <p id="section-8.2.2-5.2.2.1.1">
The use of the new RPC-level facilities does not raise
any extension issues, since the existing specification
do not limit the transport used, except to require reliable
and in-order delivery.  For this reason, these facilities
can be used without updating the existing minor version
specifications.<a href="#section-8.2.2-5.2.2.1.1" class="pilcrow">¶</a></p>
<p id="section-8.2.2-5.2.2.1.2">
Use of these facilities does not raise additional interoperability
issues since
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>,
by using the opportunistic TLS model, provided for interoperability
between those that do and do not support these extensions.<a href="#section-8.2.2-5.2.2.1.2" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.2.2-5.2.2.2">
                  <p id="section-8.2.2-5.2.2.2.1">
The policies to use these facilities, made the
responsibility of the ULP by
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>
are significant additions to existing minor versions, requiring that the
new standards-track document dealing  with NFSv4 security update
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
and
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>.<a href="#section-8.2.2-5.2.2.2.1" class="pilcrow">¶</a></p>
<p id="section-8.2.2-5.2.2.2.2">
These changes do not raise interoperability issues since the
policies apply to all uses of these transport-level facilities
for NFSV4.  That addresses the case in which client and server
both provide support while other cases are dealt with as
indicated in the previous bullet.<a href="#section-8.2.2-5.2.2.2.2" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.2.2-5.2.2.3">
                  <p id="section-8.2.2-5.2.2.3.1">
The new recommendations regarding use of existing features
(e.g. encryption, AUTH_SYS) often contradict existing guidance
and so also require that
new standards-track document dealing  with NFSv4 security
update <span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
and
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>.<a href="#section-8.2.2-5.2.2.3.1" class="pilcrow">¶</a></p>
<p id="section-8.2.2-5.2.2.3.2">
These change do potentially raise interoperability issues
which need to be dealt with by giving sufficient scope, within
the framework of new recommendations, to accommodate existing
behavior.  As a result, from an interoperability standpoint,
these changes are compatible with the previous designation of
<span class="bcp14">OPTIONAL</span>
use, even though the security consequences make
it necessary that the use of these previously
<span class="bcp14">OPTIONAL</span>
facilities (e.g. transferring data in the clear,
use of AUTH_SYS without client host authentication)
be something to be warned against.<a href="#section-8.2.2-5.2.2.3.2" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="ISSUES-tlse">
<section id="section-8.3">
        <h3 id="name-tls-encryption-policies">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-tls-encryption-policies" class="section-name selfRef">TLS Encryption Policies</a>
        </h3>
<div id="ISSUES-tlse-bg">
<section id="section-8.3.1">
          <h4 id="name-background-3">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-background-3" class="section-name selfRef">Background</a>
          </h4>
<p id="section-8.3.1-1">
As discussed in
<a href="#PROB-conf" class="xref">Section 5.3</a>,
NFSv4 as currently defined, has serious problems
providing the appropriate level of confidentiality for its
transmissions.  Providing encryption at the transport layer,
whether as described in
<a href="#OPP-enc" class="xref">Section 7.1</a>
or otherwise, can
be expected to resolve this issue by providing encryption in a
potentially offloadable way,
making use of RPC-level privacy
and integrity services unnecessary.<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
<p id="section-8.3.1-2">
If we were defining a new protocol, such transport-level encryption
could be
<span class="bcp14">REQUIRED</span> without difficulty.  However, given that we are
upgrading the security for an existing protocol, it might not be
possible to designate this encryption as
"<span class="bcp14">REQUIRED</span>", since
this might give rise to extensive interoperability problems
between new and old implementations.  In any case,
existing implementers of the existing protocol would not have
the same
interest in specification compliance as in the corresponding situation
with a new protocol, leading to a situation in which one group of
implementations essentially ignored the issue of
specification-compliance
with regard to the latest protocol specifications.<a href="#section-8.3.1-2" class="pilcrow">¶</a></p>
<p id="section-8.3.1-3">
We need to be aware that,<a href="#section-8.3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3.1-4.1">
In implementation of a new protocol, any requirements on
the client
the server such as we have been discussing act
synergistically to
marginalize non-compliant implementations.
Since non-compliant
server will not interoperate with a compliant client and vice
versa.<a href="#section-8.3.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.3.1-4.2">
The corresponding case of a requirement providing for a security
upgrade, as in this case, is different.   Implementers, and those
charged with allocating resources to their work will naturally
focus on improvement/maintenance of the working protocol and
limit the effort devoted to being the first to do an
implementation that would not be used until others do their part.
In such cases, if there are parties who are not convinced
of the necessity for the upgrade, it takes strong input from
users/customers to ensure that the needed upgrade is given
sufficient attention.<a href="#section-8.3.1-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.3.1-4.3">
In some cases, a new protocol containing an important security
upgrade can result in a situation more like the latter case than
the former.<a href="#section-8.3.1-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.3.1-5">
As we consider how to discuss the need for encryption in
<a href="#ISSUES-tlse-res" class="xref">Section 8.3.2</a>,
we will be mindful of the above.
Since it not possible to mandate the use of encryption, we will make it
<span class="bcp14">RECOMMENDED</span>.
However, in discussing the valid reasons that
encryption might not be provided, we will try to restrict them
to the degree we can reasonably do so.  Further, we will try to
clearly state the security consequences which implementers and
those configuring clients and server need to be aware of when
choosing to not provide the
<span class="bcp14">RECOMMENDED</span> encryption.<a href="#section-8.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ISSUES-tlse-res">
<section id="section-8.3.2">
          <h4 id="name-issues-to-address">
<a href="#section-8.3.2" class="section-number selfRef">8.3.2. </a><a href="#name-issues-to-address" class="section-name selfRef">Issues to Address</a>
          </h4>
<p id="section-8.3.2-1">
There is a need to recommend the implementation and use of
appropriate encryption by the server and client, as is done,
for example, by the following paragraphs.<a href="#section-8.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3.2-2.1">
Data sent over connections used to connect an NFSv4 client
and server
<span class="bcp14">SHOULD</span>
be encrypted, whether this uses TLS encryption,
as described in
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>
(to be used for TCP connections) or another form of encryption.
For example,
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>
does not address encryption for RPC-over-RDMA
(<span>[<a href="#RFC8166" class="xref">RFC8166</a>]</span>,
<span>[<a href="#I-D.ietf-nfsv4-rpcrdma-version-two" class="xref">I-D.ietf-nfsv4-rpcrdma-version-two</a>]</span>)
but RNICs used to implement RDMA transports will often implement
encryption to secure inter-RNIC traffic.<a href="#section-8.3.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.3.2-2.2">
Valid reasons for not implementing the encryption
recommendation include insufficient time and resources
to code, test,  and deploy an appropriate implementation.
Implementers and those deploying NFSv4 servers and clients
and those deploying NFSv4 services need to remain aware of
the consequences of not providing encryption.  These
consequences are of concern regardless
of the validity of the reasons for not doing so, which may
be expected to become more restricted as time goes on.<a href="#section-8.3.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.3.2-2.3">
Given that it is necessary for both the client and the
server to provide implementations capable of
transport-level
encryption, those deploying NFSv4 implementations
need to be aware of possible steps to provide remediation,
the difficulties involved in providing it and the
consequences of not doing do.<a href="#section-8.3.2-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.3.2-2.4">
              <p id="section-8.3.2-2.4.1">
The lack of encryption for the connection as a whole can
be addressed by encryption of individual requests using the
facilities within RPCSEC_GSS specified  in
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
and
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>
as providing "privacy".  When doing
so, the following complicating issues need to be taken
account of:<a href="#section-8.3.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3.2-2.4.2.1">
Such facilities are not likely to be offloadable and often
will reduce performance dramatically.<a href="#section-8.3.2-2.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-8.3.2-2.4.2.2">
Support for confidentiality via encryption is not required by
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>
but only recommended, saying it
"<span class="bcp14">SHOULD</span>
be supported".
Unfortunately, the document does not specify what might be
valid reasons not to provide such support. Also, although
<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>
states the one choosing not to
follow such a recommendation should be aware of the
consequences, given the general reticence of NFSv4
specification
Security Considerations sections about such matters,
it is not clear that implementers have been able to
properly consider
the issue in the past.
In any case, implementations without such
support probably exist, making encryption unavailable for
some existing client-server pairs.<a href="#section-8.3.2-2.4.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-8.3.2-2.5">
When encryption is not provided, or, because of its effect on
performance, not used, all of the user data read
or written is transmitted in the clear, subject to interception
or modification in flight.   While this is clearly
unacceptable for use on the internet, it should not be
assumed that it is acceptable in more restricted environments.<a href="#section-8.3.2-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.3.2-2.6">
Where  this problem exists, it will often be necessary to
restrict such traffic to specific network segments, and make
it impossible, via administrative measures, to limit access to
such network segments or monitor them extensively.<a href="#section-8.3.2-2.6" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.3.2-3">
Although, as indicated in
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>,
that there should be no need to negotiate security flavors to
be used to provide integrity and confidentiality, the exact
effect on existing clients and servers needs to be made clearer.<a href="#section-8.3.2-3" class="pilcrow">¶</a></p>
<p id="section-8.3.2-4">
The text below is a suggested way of doing this.<a href="#section-8.3.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3.2-5.1">
Although the pseudo-flavors created to indicate use of integrity
or encryption continue to be a part of NFSv4, when transport-level
encryption is provided, their use is unnecessary, although
server responses to SECINFO and SECINFO_NONAME may continue to
include them.<a href="#section-8.3.2-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.3.2-5.2">
              <p id="section-8.3.2-5.2.1">
When TLS is
used to provide encryption, as specified in
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>,
the client and
server will, as indicated by that
document, be aware that
encryption, is present.  In the case of RPC-over-RDMA,
when the RNICs provide encryption transparently, the server
and client have the opportunity to each make their own
judgment about the adequacy of the encryption provided and
communicate this to their peer as a transport property as
provided for by
<span>[<a href="#I-D.ietf-nfsv4-rpcrdma-version-two" class="xref">I-D.ietf-nfsv4-rpcrdma-version-two</a>]</span>).
In either case, the client and server will only act, as described below,
on knowledge about the existence of encryption shared by both
parties:<a href="#section-8.3.2-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3.2-5.2.2.1">
                  <p id="section-8.3.2-5.2.2.1.1">
The server treats all requests as being made requesting
encryption, even if a different pseudo-flavor is used.
As a result, the server will never return, NFS4ERR_WRONGSEC
because of a quality-of-protection issue, despite a possible
mismatch between the pseudo-flavor specified in SECINFO response
and the one actually used.<a href="#section-8.3.2-5.2.2.1.1" class="pilcrow">¶</a></p>
<p id="section-8.3.2-5.2.2.1.2">
The server will still return NFS4ERR_WRONGSEC when an
inappropriate security flavor or oid is used and clients
need to be prepared to use SECINFO to determine the
security to be used.<a href="#section-8.3.2-5.2.2.1.2" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.3.2-5.2.2.2">
The client is free to ignore the quality-of-protection issues in
a SECINFO response, making use of authentication-only
variant of RPCSEC_GSS most efficient.<a href="#section-8.3.2-5.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-8.3.2-5.2.2.3">
Although use of integrity or privacy pseudo-flavors is
unnecessary on an encrypted channel, the server
still needs to accept such requests.<a href="#section-8.3.2-5.2.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-8.3.2-5.2.2.4">
Within NFSv4.1
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>,
support for SECINFO_NONAME is still
<span class="bcp14">REQUIRED</span>
when pNFS is
supported, even if the server only accepts connection
on which encryption is used, making generation of
NFS4ERR_WRONGSEC on a connection to the metadata server
impossible.<a href="#section-8.3.2-5.2.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="ISSUES-asys">
<section id="section-8.4">
        <h3 id="name-handling-of-auth_sys">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-handling-of-auth_sys" class="section-name selfRef">Handling of AUTH_SYS</a>
        </h3>
<div id="ISSUES-asys-hbg">
<section id="section-8.4.1">
          <h4 id="name-historical-background">
<a href="#section-8.4.1" class="section-number selfRef">8.4.1. </a><a href="#name-historical-background" class="section-name selfRef">Historical Background</a>
          </h4>
<p id="section-8.4.1-1">
During the development of NFSv2
<span>[<a href="#RFC1094" class="xref">RFC1094</a>]</span>,
little attention was directed to network security and no attention
was directed to the possibility that a machine on the network
might represent itself as a client, with the ability to make
requests on behalf of non-existent client processes
it identified by user id.
During this time, NFS clients
were multi-user machines and it made sense to many for the
client kernel
to have the same responsibilities to verify user credentials and
keep track of process user ids as it had successfully been doing
with local file systems. This was the origin of AUTH_UNIX (later
renamed AUTH_SYS) which was based on a model of
co-operating UNIX kernels and
provided no protection against an attacker with kernel
privileges.
Despite the later name change, actual implementations were
strongly
focused on UNIX, deriving the necessary
implementation requirements from shared code and from informal
inter-developer communications, rather than standards documents.
As a result, as discussed in
<a href="#PROB-authsys" class="xref">Section 5.2</a>,
when it was necessary to discuss the security of AUTH_SYS in
connection
with RPC (in
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>,
there was insufficient
information on which to base a threat analysis, although it was
correctly concluded that the result of use was a lack of
security.<a href="#section-8.4.1-1" class="pilcrow">¶</a></p>
<p id="section-8.4.1-2">
With regard to the following aspects of AUTH_SYS,
this UNIX orientation was significant. In
many cases as the computing environment changed, it was not
possible to change the details to keep up with evolving needs.<a href="#section-8.4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.1-3.1">
As the assumption of kernel trustworthiness became increasingly
unviable as a basis for security, no action was taken to
address the issue.   While the check for a privileged port
retained some residual value, it was used to exclude requests
issued by non-kernel clients as inherently untrustworthy.  The
more significant and difficult problem of distinguishing
trustworthy and untrustworthy kerenel-level access was never
addressed, leaving
AUTH_SYS of little value as a means of authentication, despite
its continuing use.<a href="#section-8.4.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.1-3.2">
AUTH_SYS was focused on the use of the non-hierarchical 32-bit
user id space typical of UNIX.  Although later attempts
were made to generalize this within NFSv4, the fact
that this approach is embedded in many server filesystems
meant
that this aspect of AUTH_SYS, does not seriously obstruct
access to such servers.<a href="#section-8.4.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.1-3.3">
The particular user id of zero (denoting "root" in UNIX)
was often treated specially, by treating the request as
issued by the predefined user id "nobody".   While this
was undoubtedly helpful when first defined, it is now the
case that other non-root users might have significant
privileges and that the ability of an attacker to assume any
chosen user id allows much important information to be
obtained and corrupted.<a href="#section-8.4.1-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.1-4">
Later, with the development of NFSv3
<span>[<a href="#RFC1813" class="xref">RFC1813</a>]</span>,
some
of these assumptions started to seem less justifiable and
alternate authentication models were developed.
However, because
AUTH_SYS was so suited to the Unix environment, making NFS
administration so similar to local file system administration,
its use remained
predominant despite its obvious weaknesses from the security
standpoint.<a href="#section-8.4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ISSUES-asys-ebg">
<section id="section-8.4.2">
          <h4 id="name-background-for-existing-aut">
<a href="#section-8.4.2" class="section-number selfRef">8.4.2. </a><a href="#name-background-for-existing-aut" class="section-name selfRef">Background for Existing AUTH_SYS in NFSv4</a>
          </h4>
<p id="section-8.4.2-1">
When NFSv4 was first defined (in
<span>[<a href="#RFC3530" class="xref">RFC3530</a>]</span>),
RPCSEC_GSS was added as a mandatory-to-implement means of
authentication which was optional to use, presumably under
the assumption that other optional-to-implement authentication
flavors, such as AUTH_SYS would be used by some clients<a href="#section-8.4.2-1" class="pilcrow">¶</a></p>
<p id="section-8.4.2-2">
The continued use of AUTH_SYS is troubling and hard to
explain if one is focused on network security,
but the following possibilities are worthy of note:<a href="#section-8.4.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.2-3.1">
It might well have been felt that the problems with
AUTH_SYS, although troubling, did not really apply
to the most common use case for NFS, on local area
networks.<a href="#section-8.4.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.2-3.2">
The familiarity of AUTH_SYS to Unix administrators, and
general consistency with existing UNIX methods of system
administration may have made it difficult to contemplate its
abrupt removal in NFSv4.0, with the expectation that doing so
might have substantially impeded NFSv4 adoption.<a href="#section-8.4.2-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.2-4">
Regardless of why this happened, the important fact is
that it did happen, despite the serious security problems
that it gave rise to.   Later subsections of
<a href="#ISSUES-asys" class="xref">Section 8.4</a>
will discuss ways to address the resulting situation.<a href="#section-8.4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ISSUES-asys-rescore">
<section id="section-8.4.3">
          <h4 id="name-core-issue-to-resolve-for-a">
<a href="#section-8.4.3" class="section-number selfRef">8.4.3. </a><a href="#name-core-issue-to-resolve-for-a" class="section-name selfRef">Core Issue to Resolve for AUTH_SYS</a>
          </h4>
<p id="section-8.4.3-1">
Given the serious security weaknesses described in
<a href="#PROB-authsys" class="xref">Section 5.2</a>,
there is clearly a need to
discourage its further use in its existing form,
since the difficulties with it will not be eliminated
by the adoption of encryption of NFSv4 connections alone<a href="#section-8.4.3-1" class="pilcrow">¶</a></p>
<p id="section-8.4.3-2">
There are two basic forms that such an effort might take:<a href="#section-8.4.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.3-3.1">
Seek to discourage the use of AUTH_SYS in the expectation that
it will be eventually replaced by RPCSEC_GSS or a new
security flavor.<a href="#section-8.4.3-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.3-3.2">
Seek to eliminate or mitigate its security problems and
to discourage the use AUTH_SYS  variants that have not
addressed the underlying problem, in favor of a
revised approach to AUTH_SYS with better security, based on
client host authentication.<a href="#section-8.4.3-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.3-4">
While the authors are strongly of the opinion that the second
choice is more likely to be successful, and this document
reflects that view, there is no intention to foreclose the
first option, should the working group choose it.  If that
option is chosen, then the material in
<a href="#ISSUES-asys-resnew" class="xref">Section 8.4.6</a>
becomes irrelevant and can
be ignored while much of that in
<a href="#ISSUES-asys-rescur" class="xref">Section 8.4.5</a>
can be simply modified to expand its scope, as described below in
that section.<a href="#section-8.4.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ISSUES-asys-doc">
<section id="section-8.4.4">
          <h4 id="name-need-to-better-document-and">
<a href="#section-8.4.4" class="section-number selfRef">8.4.4. </a><a href="#name-need-to-better-document-and" class="section-name selfRef">Need to Better Document and Explain Issues with AUTH_SYS</a>
          </h4>
<p id="section-8.4.4-1">
As described in
<a href="#ISSUES-tag" class="xref">Section 8.1</a>
there is a need for
an appropriate threat analysis for NFSv4.   For a number of reasons,
issues with AUTH_SYS that would make it difficult to refer to in an
NFSv4-wide security document without some additional work preparatory
work:<a href="#section-8.4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.4-2.1">
Unlike the case of RPCSEC_GSS, there is no discussion of possible
security threats.<a href="#section-8.4.4-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.4-2.2">
There is no complete documentation how AUTH_SYS is to be used.<a href="#section-8.4.4-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.4-2.3">
The reason for deciding that AUTH_SYS is "insecure", while
probably valid,
adds considerable confusion since it makes it harder to address
the issue complained of.<a href="#section-8.4.4-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.4-3">
Under other circumstances, it might have been possible to
dispense with
further analysis of AUTH_SYS because of the following facts:<a href="#section-8.4.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.4-4.1">
AUTH_SYS is declared "insecure", which might be considered as
making a further security analysis beside the point.<a href="#section-8.4.4-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.4-4.2">
There are a number of statements with
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
limiting the use of AUTH_SYS, which might lead a reader to
conclude that it was, in essence, a historical artifact.<a href="#section-8.4.4-4.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.4-5">
Despite the above, we will need a more complete of treatment
of AUTH_SYS security for a number of reasons.<a href="#section-8.4.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.4-6.1">
Despite the recognition of its insecurity and restrictions
on its use, AUTH_SYS has been at least on a par with RPCSEC_GSS
in terms of NFSv4 use, for over a decade following.<a href="#section-8.4.4-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.4-6.2">
              <p id="section-8.4.4-6.2.1">
Given that the ongoing security issues with AUTH_SYS might
give rise to efforts to address them, an accurate understanding
of these issues is even more important, regardless of how the
working group chooses to resolve the issue discussed in
<a href="#ISSUES-asys-rescore" class="xref">Section 8.4.3</a>.<a href="#section-8.4.4-6.2.1" class="pilcrow">¶</a></p>
<p id="section-8.4.4-6.2.2">
If the decision is made to improve the security characteristics
of AUTH_SYS, it is important to understand existing security
issues and how they might be best addressed.<a href="#section-8.4.4-6.2.2" class="pilcrow">¶</a></p>
<p id="section-8.4.4-6.2.3">
If the decision is made to eliminate the use
of AUTH_SYS, an adequate understanding of the security issues
that made that decision necessary would seem to be required.
In that context, the current statement in
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>,
regarding the insecurity of AUTH_SYS needs to be clarified.<a href="#section-8.4.4-6.2.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.4.4-6.3">
It is likely that attempts to eliminate or restrict use of
AUTH_SYS will take the form of a recommendation that it not be
used or only be used in certain ways or under certain
circumstances. Such recommendations normally
require that the user be made aware of the consequences
of doing something other than what is recommended.   In this
case that would be either to use AUTH_SYS or to use it
without client host authentication.<a href="#section-8.4.4-6.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.4-7">
An important question is where such a treatment should appear.
In deciding this question, the important question is whether,
at this point, it is best addressed as a feature associated with
NFSv4 or with RPC.<a href="#section-8.4.4-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.4-8.1">
While structurally, AUTH_SYS, presented as one of security
supported security flavors associated with RPC would seem
to require treatment within the framework of RPC, its recent
treatment raises questions about continuing to deal with it
solely within this framework.   This is not due solely
because of the attempt (in
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>)
to discourage its use, as was done for AUTH_DH.  In that case
it remains appropriate to discuss it as part of RPC, without a
threat analysis, since there is no continuing use justifying
another course.<a href="#section-8.4.4-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.4-8.2">
              <p id="section-8.4.4-8.2.1">
The continued use of AUTH_SYS by all NFSv4 minor versions
might well be considered to justify a transfer of responsibility
to NFSv4, with the authentication flavor being mentioned, in
RPC specifications, only as a historical artifact.<a href="#section-8.4.4-8.2.1" class="pilcrow">¶</a></p>
<p id="section-8.4.4-8.2.2">
The potential continued use of AUTH_SYS with client-host
authentication strengthens the NFSv4 connection.  Since
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>
assigns the
specification of policies related to authentication to the
ULP, it seems that AUTH_SYS needs to be discussed by
NFSv4 documents in a manner more substantial than simply
listed as another authentication flavor.<a href="#section-8.4.4-8.2.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.4.4-8.3">
              <p id="section-8.4.4-8.3.1">
AUTH_SYS, both with and without client host authentication
could be discussed in its own document, including an
appropriate threat analysis.<a href="#section-8.4.4-8.3.1" class="pilcrow">¶</a></p>
<p id="section-8.4.4-8.3.2">
That document could be referenced by a new document updating
or obsoleting
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>.
This would provide
an opportunity to address existing text which was essentially
ignored by NFSv4.<a href="#section-8.4.4-8.3.2" class="pilcrow">¶</a></p>
<p id="section-8.4.4-8.3.3">
That document could also be referenced by a new standards-track
document dealing with NFSv4 security.   The threat analysis
would provide a basis for the whatever approach the working
group decides to take with regard to the discussion of AUTH_SYS
with client-host authentication.   See
<a href="#ISSUES-asys-resnew" class="xref">Section 8.4.6</a>
for further details.<a href="#section-8.4.4-8.3.3" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.4.4-9">
The last of these is most likely to be adopted regardless of
how the working group decides the issue described in
<a href="#ISSUES-asys-rescore" class="xref">Section 8.4.3</a>.
However, if the working
group decides to strongly discourage the use of AUTH_SYS even
with client-host authentication, the first is a possibility
that should be considered.<a href="#section-8.4.4-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ISSUES-asys-rescur">
<section id="section-8.4.5">
          <h4 id="name-issues-to-address-for-exist">
<a href="#section-8.4.5" class="section-number selfRef">8.4.5. </a><a href="#name-issues-to-address-for-exist" class="section-name selfRef">Issues to Address for Existing Use of AUTH_SYS</a>
          </h4>
<p id="section-8.4.5-1">
This section presents material that might be included in a
standards-track document in an effort to suitably discourage use
of AUTH_SYS in its current (insecure) form.<a href="#section-8.4.5-1" class="pilcrow">¶</a></p>
<p id="section-8.4.5-2">
While it is sometimes the case that such a task can be accomplished
by substituting one of the terms defined in
<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>
by another, that is not the case here  While the designation of
AUTH_SYS as optional (to implement) with
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
and
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>
using the language
"<span class="bcp14">MAY</span>
be implemented",
is wrong and probably needs to be fixed, the situation is more complex
than generally recognized.  It should be kept in mind that
these terms are,
in many cases, ignored or followed while ignoring the underlying
intent.   As a result, such changes, without supporting
explanations might not be effective in changing implementer
behavior.<a href="#section-8.4.5-2" class="pilcrow">¶</a></p>
<p id="section-8.4.5-3">
To summarize the confusing situation with AUTH_SYS and NFS and
the role of the RPC specification,
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>.<a href="#section-8.4.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.5-4.1">
At the time of publication of
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>,
AUTH_SYS was extensively used by NFSv2
<span>[<a href="#RFC1094" class="xref">RFC1094</a>]</span>,
NFSv3
<span>[<a href="#RFC1813" class="xref">RFC1813</a>]</span>,
and
NFSv4.0
<span>[<a href="#RFC3530" class="xref">RFC3530</a>]</span>.<a href="#section-8.4.5-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.5-4.2">
The Security Considerations Section of
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>,
states "AUTH_SYS
<span class="bcp14">SHOULD NOT</span>
be used for services that permit
clients to modify data", which all versions of NFS clearly are.<a href="#section-8.4.5-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.5-4.3">
              <span><a href="https://rfc-editor.org/rfc/rfc5531#section-10" class="relref">Section 10</a> of [<a href="#RFC5531" class="xref">RFC5531</a>]</span>
states "Implementors
<span class="bcp14">MAY</span>
include AUTH_SYS in their implementations to support existing
applications."  Although this statement was probably intended
to authorize continued use of AUTH_SYS, the contradiction between
this statement and the Security Consideration section is not
noted so there is no way to determine how this contradiction is
to be resolved or precisely what "an application" is.<a href="#section-8.4.5-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.5-4.4">
The case of NFsv4.1, later defined in
<span>[<a href="#RFC5661" class="xref">RFC5661</a>]</span>,
is different since, being a separate protocol, with additional
vulnerabilities when AUTH_SYS is used, it would
presumably not be an "existing application".<a href="#section-8.4.5-4.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.5-4.5">
Turning from
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
to
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>
and
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>,
we find AUTH_SYS described as an
<span class="bcp14">OPTIONAL</span>
means of authentication, with
its security weaknesses not being discussed or treated as a
significant concern.<a href="#section-8.4.5-4.5" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.5-5">
While there may well be sufficient loopholes within
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
to avoid an outright contradiction
of the rules established there, it is certainly troubling
that the security implications of implementing and using
AUTH_SYS are not properly recommended against.<a href="#section-8.4.5-5" class="pilcrow">¶</a></p>
<p id="section-8.4.5-6">
While we may need to adjust the normative language, the effect of
doing so is limited for reasons that have already been discussed.
As a result, we need to put substantial emphasis on clearly
stating the
consequences of doing what
"<span class="bcp14">SHOULD NOT</span>"
(or "should not") be done,
as is suggested by
<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>,
at least for the former case.<a href="#section-8.4.5-6" class="pilcrow">¶</a></p>
<p id="section-8.4.5-7">
The following text is one way to present the situation:<a href="#section-8.4.5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.5-8.1">
The use of AUTH_SYS,  as described (incompletely) in
Appendix A of
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
is quite detrimental to security and so
<span class="bcp14">SHOULD NOT</span> be used.<a href="#section-8.4.5-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.5-8.2">
This is so because it involves accepting requests from clients
on behalf of specific users without authentication of the
clients themselves.  In essence, the task of authentication
is delegated to NFSv4 client implementations, with the server
accepting such authentication decisions.   Normally, such an
arrangement would require the establishment of a trust
relationship between client and server.<a href="#section-8.4.5-8.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.5-8.3">
Typically, when using AUTH_SYS, use of a privileged port
represents the client kernel's judgment (by granting root
access) that the client proper is to be trusted but there
is no good reason to trust the client kernels in this regard.<a href="#section-8.4.5-8.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.5-8.4">
Although
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>
and
<span>[<a href="#RFC7530" class="xref">RFC7530</a>]</span>
previously treated implementation of AUTH_SYS as optional,
it appears that
this treatment was in error in that it focused on the
relevant interoperability constraints without attention to
the security consequences of use (discussed in
<span><a href="https://rfc-editor.org/rfc/rfc2119#section-7" class="relref">Section 7</a> of [<a href="#RFC2119" class="xref">RFC2119</a>]</span>).
While use of AUTH_SYS was not
characterized using any of the keywords defined in
<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>,
it was reasonable for implementers
to assume this was valid given the lack of attention
to network security issues and the fact that there would
be no point in implementing support for AUTH_SYS in servers
if it could not be used.<a href="#section-8.4.5-8.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.5-8.5">
              <p id="section-8.4.5-8.5.1">
Although, as a result of these previous approaches to
AUTH_SYS without client host authentication,
it might be used extensively despite the
security issues that cause us to specify that it
"<span class="bcp14">SHOULD NOT</span>"
be used are sufficient to justify this shift.
However, due to the difficulty of making such a shift,
the need to maintain continuity of support is a valid
reason to continue to use it in this way, as long as
this decision is made with awareness of  the security
consequences:<a href="#section-8.4.5-8.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.5-8.5.2.1">
That it is possible for an attacker to impersonate
a trusted client by using its IP address in source
IP address of packet sent, enabling to send its own
requests to read or modify data, as any particular user.<a href="#section-8.4.5-8.5.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-8.4.5-8.5.2.2">
That compromising any client whose AUTH_SYS requests
are accepted allows it to create a connection from
which its unauthenticated requests will be executed by
the server.<a href="#section-8.4.5-8.5.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-8.4.5-8.5.2.3">
That it is possible for attackers to work around
"root squashing" since it can assume any identity it
intends to, other than that of root.<a href="#section-8.4.5-8.5.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="ISSUES-asys-resnew">
<section id="section-8.4.6">
          <h4 id="name-issues-to-resolve-for-revis">
<a href="#section-8.4.6" class="section-number selfRef">8.4.6. </a><a href="#name-issues-to-resolve-for-revis" class="section-name selfRef">Issues to Resolve for Revised Approach to AUTH_SYS</a>
          </h4>
<p id="section-8.4.6-1">
The availability of client-host authentication makes possible a
revised approach to AUTH_SYS addressing some of its security
vulnerabilities. A revised approach to AUTH_SYS might provide:<a href="#section-8.4.6-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.4.6-2">
<li id="section-8.4.6-2.1">
              <p id="section-8.4.6-2.1.1">
The ability to prevent, using client host-authentication,
another machine masquerading as the expected client.<a href="#section-8.4.6-2.1.1" class="pilcrow">¶</a></p>
<p id="section-8.4.6-2.1.2">
The authentication features described in
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>,
would be assure
that you could identify trusted client machines, eliminating
a major security issue with AUTH_SYS.   On the other hand,
it is not clear whether servers would be wise to trust clients
to this degree, especially if the items below (#2 and #3) are
not satisfactorily dealt with.<a href="#section-8.4.6-2.1.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-8.4.6-2.2">
              <p id="section-8.4.6-2.2.1">
It would be possible to include, as part of the client
authentication material, information known only to the
client and the server.   The secret value would be chosen by the
client, and saved so it is usable by later client instances.
If this were done, it would prevent
any process with root privileges on a trusted machine from
impersonating the trusted client.   If this were not done,
then any compromise of a single trusted client would
compromise any server which trusted it to present AUTH_SYS
requests.<a href="#section-8.4.6-2.2.1" class="pilcrow">¶</a></p>
<p id="section-8.4.6-2.2.2">
To make this approach viable,
servers would have to maintain, in persistent
storage, a record of the secret value assigned to each authenticated
client.   When an authenticated client connected with a different
value it would indicate that a root process on the client-host
was attempting to impersonate the NFSv4 client.<a href="#section-8.4.6-2.2.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-8.4.6-2.3">
              <p id="section-8.4.6-2.3.1">
The power granted to the authenticated client-host, to make
a request on behalf of user or group has troubling consequences.
Although most implementations have the ability to exclude
requests from the root user, that may not, as has been noted
previously, be sufficient to satisfactorily deal with the problem,
since many deployments contain security-critical files that can
be accessed and modified but users other than root.<a href="#section-8.4.6-2.3.1" class="pilcrow">¶</a></p>
<p id="section-8.4.6-2.3.2">
It would be desirable to exclude a wider range of users such as
all users within a given group (or alternatively include only
users within a given group).  However, neither of these is viable
since servers receiving AUTH_SYS requests typically have no
knowledge of what users belong to what groups, relying on the
AUTH_SYS client to provide this information within the request.<a href="#section-8.4.6-2.3.2" class="pilcrow">¶</a></p>
<p id="section-8.4.6-2.3.3">
Given this lack of knowledge on the part of the servers, any
restrictions on the ability of AUTH_SYS requests to access or
modify files designate a set of protected files in some way.
Since designating a list of files is complicated and hard to
maintain, it might be possible to describe the files whose
access and/or modification by means of an ACL.   When a
request is made to access a file, that request is suppressed
(i.e. treated as a request by "nobody") iff it would be allowed
to access by the designated ACL and similarly in the case of
modifying requests.<a href="#section-8.4.6-2.3.3" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-8.4.6-3">
How to address the question of the potential use of AUTH_SYS with
client-host authentication would depend on the working group's
judgement about how likely such an arrangement would be likely
to be in providing security when AUTH_SYS is used.   This in turn
would depend on the working group's judgment as to whether
solutions for #2 and #3 could be defined and effectively deployed,
as well as the results of the threat analysis<a href="#section-8.4.6-3" class="pilcrow">¶</a></p>
<p id="section-8.4.6-4">
We assume that AUTH_SYS with client-host authentication needs
to be considered inferior to RPCSEC_GSS but sufficiently superior
to AUTH_SYS without client authentication to make it desirable
to encourage its use, given that it is impossible to eliminate
use of AUTH_SYS, even with a
"<span class="bcp14">MUST NOT</span>".
A number of potential introductions to the topic, of varying tone
are explored below:<a href="#section-8.4.6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.6-5.1">
              <p id="section-8.4.6-5.1.1">
If the working group wants to focus on the improvement
relative to AUTH_SYS without client-host authentication, the
following paragraphs might be an appropriate introduction:<a href="#section-8.4.6-5.1.1" class="pilcrow">¶</a></p>
<p id="section-8.4.6-5.1.2">
When AUTH_SYS is used with client-host authentication, then the
server, by allowing use of AUTH_SYS for that specific client, is
essentially delegating the user authentication task to that
client who is trusted by the server to perform that task locally,
just as typically done when authenticating users for the purpose
of local file access, even though the scope of damage that
could be enabled by any false authentication is likely to be
much wider in this case.<a href="#section-8.4.6-5.1.2" class="pilcrow">¶</a></p>
<p id="section-8.4.6-5.1.3">
By accepting AUTH_SYS requests from a particular client, a server
is relying on the security of the client for the security of all
data stored on the server.   This is in contrast to
RPCSC_GSS, in which authentication is provided for each request
issued.  Because of this, the use of AUTH_SYS should only be
allowed from client hosts that can reasonably be trusted.<a href="#section-8.4.6-5.1.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.4.6-5.2">
              <p id="section-8.4.6-5.2.1">
If the working group wants to adopt a more cautionary tone
regarding use of AUTH_SYS with client-host authentication, the
following paragraphs might be an appropriate introduction:<a href="#section-8.4.6-5.2.1" class="pilcrow">¶</a></p>
<p id="section-8.4.6-5.2.2">
By accepting AUTH_SYS requests from a particular client, a server
is relying on the security of the client for the security of all
data stored on the server.   This is in contrast to
RPCSC_GSS, in which authentication is provided for each request
issued.  Because of this, the use of AUTH_SYS should only be
allowed from client hosts that can reasonably be trusted and
whose internal security is sufficiently robust that the additional
risk to server data can be considered reasonable.<a href="#section-8.4.6-5.2.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.4.6-5.3">
              <p id="section-8.4.6-5.3.1">
If the working group wants to focus more on encouraging use
of RPCSEC_GSS, then on improving the security of those choosing
to use AUTH_SYS, a paragraph like the following might be
appropriate.<a href="#section-8.4.6-5.3.1" class="pilcrow">¶</a></p>
<p id="section-8.4.6-5.3.2">
While the use of AUTH_SYS with client-host authentication
eliminates some of the major security issues that arise
from use of AUTH_SYS, it is still inferior, from a security
point of view, to RPCSEC_GSS.   As a result, its use should
be limited to situations in which, use of RPCSEC_GSS is not
a practical possibility.<a href="#section-8.4.6-5.3.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-8.4.6-6">
The following paragraph might be added if item #2 is not
successfully addressed:<a href="#section-8.4.6-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.6-7.1">
It should be noted that any security weaknesses in the client
host kernel which might allow an attacker to execute in
privileged mode, are likely to allow that that attacker to
present AUTH_SYS requests to the server and have them executed
without any authentication beyond verifying that they were issued
by a trusted host.<a href="#section-8.4.6-7.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.6-8">
The following paragraph might be added if item #2 is successfully
addressed:<a href="#section-8.4.6-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.6-9.1">
In order to assure that it is not possible for a process
running as root to successfully masquerade as a previously
active kernel-based client on that machine, user-level clients
even privileged ones, will present distinct authentication
material from a kernel-based client and from each other.   Servers
<span class="bcp14">SHOULD</span>
maintain, persistently, sufficient information so to be
able to detect a situation in which process with root privileges
on a trusted server masquerades as a client previously recognized
on that and judged secure.<a href="#section-8.4.6-9.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.6-10">
The following paragraph might be added if item #3 is not
successfully addressed:<a href="#section-8.4.6-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.6-11.1">
There is no standardized way the server can effectively limit
the range of client user identities and group memberships
assumed by AUTH_SYS requests except for the commonly implemented
practice of "root squashing".<a href="#section-8.4.6-11.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.6-12">
The following paragraph might be added if item #3 is
successfully addressed:<a href="#section-8.4.6-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.6-13.1">
Server
<span class="bcp14">SHOULD</span>
provide a means by which specific sets of sensitive
files are made inaccessible or unmodifiable by use of
AUTH_SYS requests, in order to limit the damage that could occur
in the event that a client compromise allows unauthenticated
requests to be generated and acted upon.  One desirable way
of providing such a facility would be to allow an ACL to be
associated with each authenticated client host (e.g. by designating
a file whose ACL is to be used).  If this is done any request
whose user together with a group set would allow it to be
accepted by the specified ACL would be rejected.<a href="#section-8.4.6-13.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.6-14">
The following closing paragraphs are proposed for an eventual
introduction to AUTH_SYS, as revised.  In these paragraphs,
material to be added only if a particular item above is addressed
or not addressed will appear in brackets with the prefix "if-#x:"
or "if-not-#x:".<a href="#section-8.4.6-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.6-15.1">
The ability to make AUTH_SYS requests of a server
<span class="bcp14">SHOULD</span>
be limited to those cases in which the client host making those
requests can be trusted to appropriately verify a user's credentials
(e.g. passwords) before issuing RPC requests on that user's
behalf. [if-#3:  This limitation should be applied even when
the set of users or owning groups is restricted to specially
protect files deemed sensitive.] [if-not-#3:
When not so limited, requests purportedly from any user except
possibly root, can be synthesized and acted upon, without
effective authentication.]<a href="#section-8.4.6-15.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.6-15.2">
For that reason, accepting AUTH_SYS requests from a large set
of client hosts is a practice to be avoided, with individual
hosts included where their security has been verified.  The
only possible exception is where
a set of policies is in place which effectively limits the
kernel software allowed to run on those hosts to ensure that
those hosts appropriately providing user authentication
[if-not-#2: and capable of excluding untrusted code from
masquerading as an NFSv4 server by assuming root privileges.]<a href="#section-8.4.6-15.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="ISSUES-stp">
<section id="section-8.5">
        <h3 id="name-handling-of-state-protectio">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-handling-of-state-protectio" class="section-name selfRef">Handling of State Protection</a>
        </h3>
<div id="ISSUES-stp-bg">
<section id="section-8.5.1">
          <h4 id="name-background-4">
<a href="#section-8.5.1" class="section-number selfRef">8.5.1. </a><a href="#name-background-4" class="section-name selfRef">Background</a>
          </h4>
<p id="section-8.5.1-1">
The inclusion of state management within NFSv4 created new
security issues in which the objects requiring protection
were not files associated with particular users but locks,
opens, and delegations, associated with particular clients.<a href="#section-8.5.1-1" class="pilcrow">¶</a></p>
<p id="section-8.5.1-2">
In NFSv4.0, some protection could be provided when RPCSEC_GSS
was used by limiting
modification of state objects to users having access to the
associated file.  Nevertheless, the fundamental issue
remained unresolved.<a href="#section-8.5.1-2" class="pilcrow">¶</a></p>
<p id="section-8.5.1-3">
When sessions were introduced into NFSv4 (in NFSv4.1) there were
additional vulnerabilities that needed to be protected against.
There needed to be protection to prevent a session
established by one client being bound to a
connection established by another client, leading to the
following possibilities:<a href="#section-8.5.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.5.1-4.1">
The existing session could be destroyed.<a href="#section-8.5.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.5.1-4.2">
The associated clientid could be destroyed.<a href="#section-8.5.1-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.5.1-4.3">
The existing session slots could be used resulting in the
legitimate owner of the session having his requests
rejected because his slot sequence values had been rendered
invalid
because of the interloper's requests using the same slots.<a href="#section-8.5.1-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.5.1-5">
Facilities were defined in
<span>[<a href="#RFC5661" class="xref">RFC5661</a>]</span>
to allow
such client-based protection to be implemented: SP4_MACHCRED and
SP4_SSV but implementation has been quite limited.   Client-host
authentication makes it possible to apply such protection more
generally, as described below.<a href="#section-8.5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ISSUES-stp-res">
<section id="section-8.5.2">
          <h4 id="name-issues-to-be-addressed-2">
<a href="#section-8.5.2" class="section-number selfRef">8.5.2. </a><a href="#name-issues-to-be-addressed-2" class="section-name selfRef">Issues to be Addressed</a>
          </h4>
<p id="section-8.5.2-1">
While transport-level encryption would make it harder for
attackers to mount attacks based on these vulnerabilities,
the authentication material provided when a TLS connection
is established could enable the vulnerabilities discussed
above to be eliminated without the work of implementing
SP4_MACHCRED or SP4_SSV, and irrespective of whether the
client is using AUTH_SYS or RPCSEC_GSS.<a href="#section-8.5.2-1" class="pilcrow">¶</a></p>
<p id="section-8.5.2-2">
If one has a TLS connection including suitable authentication
material, then the server is in a position to reject attempts
to bind to sessions established under this connection by other
connections that are not TLS connections with client-host authentication
or are not established by the same client, unless SP4_MACHCRED
or SP4_SSV is in effect.
This would make state protection available to those using SP4_NONE,
i.e. the vast majority, whether they used RPCSEC_GSS or AUTH_SYS
with client-host authentication.<a href="#section-8.5.2-2" class="pilcrow">¶</a></p>
<p id="section-8.5.2-3">
The fact that this is an NFSv4.1-only security feature would make it
difficult to fully it address solely in the NFSv4-wide security
document which will be written.  The following proposal is intended to
allow the security document to be published before proceeding
to publish the anticipated rfc5661bis:<a href="#section-8.5.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.5.2-4.1">
In the anticipated standards-track NFSv4 security document,
it can be stated that when SP4_NONE is specified and the
client owning the session is authenticated, then the session
is protected from being bound-to or destroyed by an
unauthenticated client or a different authenticated client,
then the effect is the same as if SP4_MACHCRED or SP4_SSV were
used by the owning client and a non-matching client was
found.  Since the new standards-track document would update
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>,
that provides adequate notice of this change<a href="#section-8.5.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.5.2-4.2">
Later, when rfc5661bis is ready to be published, there would
an opportunity to provide introductory material explaining
the various ways clients can be authenticated for the purpose
of state protection, including use of SP4_MACHCRED or SP4_SSV and
authentication as part of use of RPC-TLS.  This would allow
defining the circumstances under which one connection can access/modify
state owned by an another client in terms of whether the connections
involved are part of the same client. References to such abstract
relationships would replace most current mentions of SP4_NONE,
SP4_MACHCRED, and SP4_SSV in
<span>[<a href="#RFC8881" class="xref">RFC8881</a>]</span>.<a href="#section-8.5.2-4.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.5.2-5">
It should be noted that this use of client-host authentication
provides applicable protection even when AUTH_SYS is used.
This is so however the issues discussed in
<a href="#ISSUES-asys-resnew" class="xref">Section 8.4.6</a>
are addressed, and
independent of the decision made regarding the choice discussed in
<a href="#ISSUES-asys-rescore" class="xref">Section 8.4.3</a>
unless it is decided that AUTH_SYS
<span class="bcp14">MUST NOT</span>
be used.   Issues regarding the impersonation
of a large set of users are not relevant because user ids are
not referenced.   Furthermore, the possibility of a privileged
user-level client implementing a denial-of-service attach (if
issue #2 in
<a href="#ISSUES-asys-resnew" class="xref">Section 8.4.6</a>
is not addressed),
is not of concern since such a privileged process would find it
far easier to deny service directly on the client host.<a href="#section-8.5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">
The current document does not require any actions by IANA.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SEC">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">
The convention of requiring a Security Considerations Section
within an I-D
encounters difficulties when applied to a document dealing solely
with security, making it most unclear what such a section might
contain for such documents.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">
In addition, the nature of this particular document poses further issues
regarding the possible content of a Security Consideration Section:<a href="#section-10-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-3.1">
This document does not define a protocol or protocol feature
that can be implemented, making it unclear how a threat analysis
could be performed whose security
considerations would be described.<a href="#section-10-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-3.2">
Despite this document's informational nature, it does attempt
to address security issues for an existing set of protocols<a href="#section-10-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-10-4">
In light of the above, this section will summarize the security-related
message of earlier sections and will, in subsections, discuss the
appropriate contents of Security Considerations Sections for a
eventual standards-track documents to be written<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">
The message of this document with regard to security issues can be
summarized as follows<a href="#section-10-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-6.1">
The current security approach for the NFSv4 protocols has some
significant weaknesses, requiring a major reworking of the
security approach.<a href="#section-10-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-6.2">
This reworking can be accomplished without change to the NFS protocols
per se, by taking advantage of recent security improvements defined
within the RPC layer.<a href="#section-10-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-6.3">
A threat analysis, not provided in previous NFSv4 specification
documents, will be the provided within a new standards-track
document addressing security for all minor versions of
NFSv4.<a href="#section-10-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-6.4">
Because there is no threat analysis of AUTH_SYS in existence, one
needs to be provided, preferably in a new standard-track document
dealing with AUTH_SYS.   This is despite the designation of
AUTH_SYS (in
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
as "insecure", which was never, at least in the case of NFSv4,
acted upon. Such a document is needed to clarify the
security weaknesses of AUTH_SYS
and the degree such weakness could be rectified by the implementation
of TLS-based encryption and/or client host authentication.<a href="#section-10-6.4" class="pilcrow">¶</a>
</li>
      </ul>
<div id="SEC-std">
<section id="section-10.1">
        <h3 id="name-security-considerations-sec">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-security-considerations-sec" class="section-name selfRef">Security Considerations Section for Eventual NFSv4-wide Standards-track Security Document</a>
        </h3>
<p id="section-10.1-1">
Although it is clear that such a document would need to include a
threat analysis, as provided for by
<span>[<a href="#RFC3552" class="xref">RFC3552</a>]</span>.
However, the length of such an analysis
might well be so large that it cannot be reasonably contained within
a Security Considerations Section.  In that case, the Security
Considerations Section will summarize the results of the
threat analysis,
referring to those parts that appear in other sections of the
document.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SEC-bis">
<section id="section-10.2">
        <h3 id="name-security-considerations-sect">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-security-considerations-sect" class="section-name selfRef">Security Considerations Section for Eventual Rfc5661bis</a>
        </h3>
<p id="section-10.2-1">
This section would have to refer to the Security Considerations
section of the new NFSv4-wide secrity document.  In addition, to deal
with NFSv4.1-specific security issues (i.e. pNFS and state
protection), there would be additional material, most likely within
the Security Considerations section or a subsection thereof.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SEC-rpc">
<section id="section-10.3">
        <h3 id="name-security-considerations-secti">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-security-considerations-secti" class="section-name selfRef">Security Considerations Section for Potential Revised RPC Specification Document</a>
        </h3>
<p id="section-10.3-1">
The general form of this section in
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
in which references are made to documents for each security flavor, seem
appropriate.   However, the following changes are likely to be
required:<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-2.1">
            <p id="section-10.3-2.1.1">
The treatment of AUTH_SYS might need to reference a new document
describing AUTH_SYS, rather than the incomplete description in
Appendix A, which needs to be removed.<a href="#section-10.3-2.1.1" class="pilcrow">¶</a></p>
<p id="section-10.3-2.1.2">
In addition, the last two sentences of the initial paragraph
of section 14 need to be
reworked to respond to the fact that while, there was no clear
violation of them, this insecure authentication flavor was used
by NFSv4 for over a decade subsequently.  Although the following
attempt at loophole removal might not survive the editing and
review process, the issues it raises are worth considering.<a href="#section-10.3-2.1.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-2.1.3.1">
As discussed in the referenced document, the use of AUTH_SYS
in the clear without client host-authentication introduces
significant security vulnerabilities in that it allows
unauthenticated requests to be created by an unauthenticated
client.  This make its use highly inappropriate for any RPC
service, particularly those that allow clients to modify data.<a href="#section-10.3-2.1.3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.3-2.1.3.2">
Similarly, in specifications of standards-track RPC services,
it is inappropriate to make such use
<span class="bcp14">REQUIRED</span>
or
<span class="bcp14">RECOMMENDED</span>.
Where such use is allowed at all (whether by
"<span class="bcp14">MAY</span>"
or
"<span class="bcp14">SHOULD NOT</span>"
is used), viable non-disruptive alternatives need to provided
and the associated Security Consideration sections need to clearly
explain the security consequences of use.<a href="#section-10.3-2.1.3.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-10.3-2.2">
The case of AUTH_DH is similar to that of AUTH_SYS in that there
is a simple declaration of insecurity.  However, there is a
document referenced and there is no indication that the loopholes
in the treatment were bypassed in this case, as they were for
AUTH_SYS.  Still, it might worth revising the final two sentences
as were done with AUTH_SYS.<a href="#section-10.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.3-2.3">
            <p id="section-10.3-2.3.1">
Given that the final paragraph of the Security Considerations
section was
drafted without consideration of reverse direction operation and
without consideration the possibility that either TLs encryption
or client host authentication might be available (and potentially
<span class="bcp14">REQUIRED</span>),
redrafting it to be more appropriate for the
environment made possible by
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>
is likely.<a href="#section-10.3-2.3.1" class="pilcrow">¶</a></p>
<p id="section-10.3-2.3.2">
The following replacement text is suggested to deal with these
issues:<a href="#section-10.3-2.3.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-2.3.3.1">
Standards-track RPC services need to mandate server and client
support for RPCSEC_GSS when used in the forward direction.
The treatment of authentication for reverse-direction operation
needs to provide for authentication of the identity of the
requester (i.e. on the server) to the responder (i.e. on the
client).  When reverse direction requests are not made on behalf
of a specific user, the mutual authentication provided by RPC-TLS
can be relied on but authentication of users on reverse-direction
requests will need to use RPCSEC_GSS.<a href="#section-10.3-2.3.3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.3-2.3.3.2">
For either direction of operation, when user identities
must be authenticated, such services need to
mandate support for an authentication pseudo-flavor.
In situations in which it is
possible/allowed for RPC services to be used without
TLS encryption there is also a need to mandate pseudo-flavors
with additional appropriate levels of security, depending on
the need for authentication only, integrity (a.k.a.
non-repudiation), or encryption to provide data confidentiality.<a href="#section-10.3-2.3.3.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="SEC-asys">
<section id="section-10.4">
        <h3 id="name-security-considerations-sectio">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-security-considerations-sectio" class="section-name selfRef">Security Considerations Section for Potential Standards-track Document Dealing with AUTH_SYS</a>
        </h3>
<p id="section-10.4-1">
As mentioned above, a prime goal of a general threat analysis for AUTH_SYS
would be to clarify the degree to which the security weaknesses of
AUTH_SYS can be successfully addressed using transport-level  security
facilities.  Those pieces of the threat analysis might well appear
outside the Security Consideration section proper.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<p id="section-10.4-2">
The Security Considerations would need to summarize these and provide a
basis for ULPs that allow AUTH_SYS to specify the appropriate
conditions for use and the consequences of not enforcing these.<a href="#section-10.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-nfsv4-rpc-tls">[I-D.ietf-nfsv4-rpc-tls]</dt>
        <dd>
<span class="refAuthor">Myklebust, T.</span><span class="refAuthor"> and C. Lever</span>, <span class="refTitle">"Towards Remote Procedure Call Encryption By Default"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-nfsv4-rpc-tls-11</span>, <time datetime="2020-11-23" class="refDate">23 November 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-nfsv4-rpc-tls-11">https://tools.ietf.org/html/draft-ietf-nfsv4-rpc-tls-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-nfsv4-rpcrdma-version-two">[I-D.ietf-nfsv4-rpcrdma-version-two]</dt>
        <dd>
<span class="refAuthor">Lever, C.</span><span class="refAuthor"> and D. Noveck</span>, <span class="refTitle">"RPC-over-RDMA Version 2 Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-nfsv4-rpcrdma-version-two-03</span>, <time datetime="2020-08-10" class="refDate">10 August 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-nfsv4-rpcrdma-version-two-03">https://tools.ietf.org/html/draft-ietf-nfsv4-rpcrdma-version-two-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3552">[RFC3552]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor"> and B. Korver</span>, <span class="refTitle">"Guidelines for Writing RFC Text on Security Considerations"</span>, <span class="seriesInfo">BCP 72</span>, <span class="seriesInfo">RFC 3552</span>, <span class="seriesInfo">DOI 10.17487/RFC3552</span>, <time datetime="2003-07" class="refDate">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3552">https://www.rfc-editor.org/info/rfc3552</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5531">[RFC5531]</dt>
        <dd>
<span class="refAuthor">Thurlow, R.</span>, <span class="refTitle">"RPC: Remote Procedure Call Protocol Specification Version 2"</span>, <span class="seriesInfo">RFC 5531</span>, <span class="seriesInfo">DOI 10.17487/RFC5531</span>, <time datetime="2009-05" class="refDate">May 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5531">https://www.rfc-editor.org/info/rfc5531</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7530">[RFC7530]</dt>
        <dd>
<span class="refAuthor">Haynes, T., Ed.</span><span class="refAuthor"> and D. Noveck, Ed.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Protocol"</span>, <span class="seriesInfo">RFC 7530</span>, <span class="seriesInfo">DOI 10.17487/RFC7530</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7530">https://www.rfc-editor.org/info/rfc7530</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7862">[RFC7862]</dt>
        <dd>
<span class="refAuthor">Haynes, T.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 2 Protocol"</span>, <span class="seriesInfo">RFC 7862</span>, <span class="seriesInfo">DOI 10.17487/RFC7862</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7862">https://www.rfc-editor.org/info/rfc7862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8166">[RFC8166]</dt>
        <dd>
<span class="refAuthor">Lever, C., Ed.</span><span class="refAuthor">, Simpson, W.</span><span class="refAuthor">, and T. Talpey</span>, <span class="refTitle">"Remote Direct Memory Access Transport for Remote Procedure Call Version 1"</span>, <span class="seriesInfo">RFC 8166</span>, <span class="seriesInfo">DOI 10.17487/RFC8166</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8166">https://www.rfc-editor.org/info/rfc8166</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8881">[RFC8881]</dt>
      <dd>
<span class="refAuthor">Noveck, D., Ed.</span><span class="refAuthor"> and C. Lever</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 1 Protocol"</span>, <span class="seriesInfo">RFC 8881</span>, <span class="seriesInfo">DOI 10.17487/RFC8881</span>, <time datetime="2020-08" class="refDate">August 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8881">https://www.rfc-editor.org/info/rfc8881</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.dnoveck-nfsv4-rfc5661bis">[I-D.dnoveck-nfsv4-rfc5661bis]</dt>
        <dd>
<span class="refAuthor">Noveck, D.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 1 Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-dnoveck-nfsv4-rfc5661bis-00</span>, <time datetime="2020-12-31" class="refDate">31 December 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-dnoveck-nfsv4-rfc5661bis-00">https://tools.ietf.org/html/draft-dnoveck-nfsv4-rfc5661bis-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1094">[RFC1094]</dt>
        <dd>
<span class="refAuthor">Nowicki, B.</span>, <span class="refTitle">"NFS: Network File System Protocol specification"</span>, <span class="seriesInfo">RFC 1094</span>, <span class="seriesInfo">DOI 10.17487/RFC1094</span>, <time datetime="1989-03" class="refDate">March 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1094">https://www.rfc-editor.org/info/rfc1094</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1813">[RFC1813]</dt>
        <dd>
<span class="refAuthor">Callaghan, B.</span><span class="refAuthor">, Pawlowski, B.</span><span class="refAuthor">, and P. Staubach</span>, <span class="refTitle">"NFS Version 3 Protocol Specification"</span>, <span class="seriesInfo">RFC 1813</span>, <span class="seriesInfo">DOI 10.17487/RFC1813</span>, <time datetime="1995-06" class="refDate">June 1995</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1813">https://www.rfc-editor.org/info/rfc1813</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2624">[RFC2624]</dt>
        <dd>
<span class="refAuthor">Shepler, S.</span>, <span class="refTitle">"NFS Version 4 Design Considerations"</span>, <span class="seriesInfo">RFC 2624</span>, <span class="seriesInfo">DOI 10.17487/RFC2624</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2624">https://www.rfc-editor.org/info/rfc2624</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3530">[RFC3530]</dt>
        <dd>
<span class="refAuthor">Shepler, S.</span><span class="refAuthor">, Callaghan, B.</span><span class="refAuthor">, Robinson, D.</span><span class="refAuthor">, Thurlow, R.</span><span class="refAuthor">, Beame, C.</span><span class="refAuthor">, Eisler, M.</span><span class="refAuthor">, and D. Noveck</span>, <span class="refTitle">"Network File System (NFS) version 4 Protocol"</span>, <span class="seriesInfo">RFC 3530</span>, <span class="seriesInfo">DOI 10.17487/RFC3530</span>, <time datetime="2003-04" class="refDate">April 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3530">https://www.rfc-editor.org/info/rfc3530</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4949">https://www.rfc-editor.org/info/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5661">[RFC5661]</dt>
        <dd>
<span class="refAuthor">Shepler, S., Ed.</span><span class="refAuthor">, Eisler, M., Ed.</span><span class="refAuthor">, and D. Noveck, Ed.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 1 Protocol"</span>, <span class="seriesInfo">RFC 5661</span>, <span class="seriesInfo">DOI 10.17487/RFC5661</span>, <time datetime="2010-01" class="refDate">January 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5661">https://www.rfc-editor.org/info/rfc5661</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8178">[RFC8178]</dt>
      <dd>
<span class="refAuthor">Noveck, D.</span>, <span class="refTitle">"Rules for NFSv4 Extensions and Minor Versions"</span>, <span class="seriesInfo">RFC 8178</span>, <span class="seriesInfo">DOI 10.17487/RFC8178</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8178">https://www.rfc-editor.org/info/rfc8178</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="section_472EA7CC-8CA3-4B98-BC1F-629321AB159E">
<section id="section-appendix.a">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.a-1">
The authors would like to thank all who contributed to
<span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">I-D.ietf-nfsv4-rpc-tls</a>]</span>
for their important work providing
security at the RPC layer, enabling us to break the NFSv4
security logjam.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">
The authors would like to thank
<span class="contact-name">Tom Haynes</span>
(of Hammerspace) for
introducing the idea of dealing with security for all minor versions
in a single document.<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Noveck</span></div>
<div dir="auto" class="left"><span class="org">NetApp</span></div>
<div dir="auto" class="left"><span class="street-address">1601 Trapelo Road</span></div>
<div dir="auto" class="left">
<span class="locality">Waltham</span>, <span class="region">MA</span> <span class="postal-code">02451</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20781%20572%208038" class="tel">+1 781 572 8038</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:davenoveck@gmail.com" class="email">davenoveck@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Charles Lever (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Oracle Corporation</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:chuck.lever@oracle.com" class="email">chuck.lever@oracle.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
