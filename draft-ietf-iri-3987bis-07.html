<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Internationalized Resource Identifiers (IRIs)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Overview and Motivation">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Applicability">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Definitions">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Notation">
<link href="#rfc.section.2" rel="Chapter" title="2 IRI Syntax">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Summary of IRI Syntax">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 ABNF for IRI References and IRIs">
<link href="#rfc.section.3" rel="Chapter" title="3 Processing IRIs and related protocol elements">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Converting to UCS">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Parse the IRI into IRI components">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 General percent-encoding of IRI components">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Mapping ireg-name">
<link href="#rfc.section.3.4.1" rel="Chapter" title="3.4.1 Mapping using Percent-Encoding">
<link href="#rfc.section.3.4.2" rel="Chapter" title="3.4.2 Mapping using Punycode">
<link href="#rfc.section.3.4.3" rel="Chapter" title="3.4.3 Additional Considerations">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Mapping query components">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 Mapping IRIs to URIs">
<link href="#rfc.section.3.7" rel="Chapter" title="3.7 Converting URIs to IRIs">
<link href="#rfc.section.3.7.1" rel="Chapter" title="3.7.1 Examples">
<link href="#rfc.section.4" rel="Chapter" title="4 Use of IRIs">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Limitations on UCS Characters Allowed in IRIs">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Software Interfaces and Protocols">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Format of URIs and IRIs in Documents and Protocols">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Use of UTF-8 for Encoding Original Characters">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 Relative IRI References">
<link href="#rfc.section.5" rel="Chapter" title="5 Liberal Handling of Otherwise Invalid IRIs">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 LEIRI Processing">
<link href="#rfc.section.6" rel="Chapter" title="6 Characters Not Allowed in IRIs">
<link href="#rfc.section.7" rel="Chapter" title="7 URI/IRI Processing Guidelines (Informative)">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 URI/IRI Software Interfaces">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 URI/IRI Entry">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 URI/IRI Transfer between Applications">
<link href="#rfc.section.7.4" rel="Chapter" title="7.4 URI/IRI Generation">
<link href="#rfc.section.7.5" rel="Chapter" title="7.5 URI/IRI Selection">
<link href="#rfc.section.7.6" rel="Chapter" title="7.6 Display of URIs/IRIs">
<link href="#rfc.section.7.7" rel="Chapter" title="7.7 Interpretation of URIs and IRIs">
<link href="#rfc.section.7.8" rel="Chapter" title="7.8 Upgrading Strategy">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations">
<link href="#rfc.section.10" rel="Chapter" title="10 Acknowledgements">
<link href="#rfc.section.11" rel="Chapter" title="11 Main Changes Since RFC 3987">
<link href="#rfc.section.11.1" rel="Chapter" title="11.1 Split out Bidi, processing guidelines, comparison sections">
<link href="#rfc.section.11.2" rel="Chapter" title="11.2 Major restructuring of IRI processing model">
<link href="#rfc.section.11.2.1" rel="Chapter" title="11.2.1 OLD WAY">
<link href="#rfc.section.11.2.2" rel="Chapter" title="11.2.2 NEW WAY">
<link href="#rfc.section.11.2.3" rel="Chapter" title="11.2.3 Extension of Syntax">
<link href="#rfc.section.11.2.4" rel="Chapter" title="11.2.4 More to be added">
<link href="#rfc.section.11.3" rel="Chapter" title="11.3 Change Log">
<link href="#rfc.section.11.3.1" rel="Chapter" title="11.3.1 Changes after draft-ietf-iri-3987bis-01">
<link href="#rfc.section.11.3.2" rel="Chapter" title="11.3.2 Changes from draft-duerst-iri-bis-07 to draft-ietf-iri-3987bis-00">
<link href="#rfc.section.11.3.3" rel="Chapter" title="11.3.3 Changes from -06 to -07 of draft-duerst-iri-bis">
<link href="#rfc.section.11.4" rel="Chapter" title="11.4 Changes from -00 to -01">
<link href="#rfc.section.11.5" rel="Chapter" title="11.5 Changes from -05 to -06 of draft-duerst-iri-bis-00">
<link href="#rfc.section.11.6" rel="Chapter" title="11.6 Changes from -04 to -05 of draft-duerst-iri-bis">
<link href="#rfc.section.11.7" rel="Chapter" title="11.7 Changes from -03 to -04 of draft-duerst-iri-bis">
<link href="#rfc.section.11.8" rel="Chapter" title="11.8 Changes from -02 to -03 of draft-duerst-iri-bis">
<link href="#rfc.section.11.9" rel="Chapter" title="11.9 Changes from -01 to -02 of draft-duerst-iri-bis">
<link href="#rfc.section.11.10" rel="Chapter" title="11.10 Changes from -00 to -01 of draft-duerst-iri-bis">
<link href="#rfc.section.11.11" rel="Chapter" title="11.11 Changes from RFC 3987 to -00 of draft-duerst-iri-bis">
<link href="#rfc.references" rel="Chapter" title="12 References">
<link href="#rfc.references.1" rel="Chapter" title="12.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="12.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document defines the Internationalized Resource Identifier (IRI) protocol element, as an extension of the Uniform Resource Identifier (URI).  An IRI is a sequence of characters from the Universal Character Set (Unicode/ISO 10646). Grammar and processing rules are given for IRIs and related syntactic forms." />
  <meta name="description" content="This document defines the Internationalized Resource Identifier (IRI) protocol element, as an extension of the Uniform Resource Identifier (URI).  An IRI is a sequence of characters from the Universal Character Set (Unicode/ISO 10646). Grammar and processing rules are given for IRIs and related syntactic forms." />
  <meta name="keywords" content="IRI, Internationalized Resource Identifier, UTF-8, URI, IDN, LEIRI" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internationalized Resource Identifiers (iri)</td>
<td class="right">M.J. Duerst</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Aoyama Gakuin University</td>
</tr>
<tr>
<td class="left">Obsoletes: 3987 (if approved)</td>
<td class="right">M.L. Suignard</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Unicode Consortium</td>
</tr>
<tr>
<td class="left">Expires: February 15, 2012</td>
<td class="right">L. Masinter</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Adobe</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">August 14, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Internationalized Resource Identifiers (IRIs)<br />
  <span class="filename">draft-ietf-iri-3987bis-07</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines the Internationalized Resource Identifier (IRI) protocol element, as an extension of the Uniform Resource Identifier (URI).  An IRI is a sequence of characters from the Universal Character Set (Unicode/ISO 10646). Grammar and processing rules are given for IRIs and related syntactic forms.</p>
<p>In addition, this document provides named additional rule sets for processing otherwise invalid IRIs, in a way that supports other specifications that wish to mandate common behavior for 'error' handling. In particular, rules used in some XML languages (LEIRI) and web applications are given.</p>
<p>Defining IRI as new protocol element (rather than updating or extending the definition of URI) allows independent orderly transitions: other protocols and languages that use URIs must explicitly choose to allow IRIs.</p>
<p>Guidelines are provided for the use and deployment of IRIs and related protocol elements when revising protocols, formats, and software components that currently deal only with URIs.</p>
<h1><a>RFC Editor: Please remove the next paragraph before publication.</a></h1>
<p>This (and several companion documents) are intended to obsolete RFC 3987, and also move towards IETF Draft Standard.  For discussion and comments on these drafts, please join the IETF IRI WG by subscribing to the mailing list public-iri@w3.org, archives at http://lists.w3.org/archives/public/public-iri/.  For a list of open issues, please see the issue tracker of the WG at http://trac.tools.ietf.org/wg/iri/trac/report/1.  For a list of individual edits, please see the change history at http://trac.tools.ietf.org/wg/iri/trac/log/draft-ietf-iri-3987bis.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on February 15, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Overview and Motivation</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Applicability</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Definitions</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Notation</a>
</li>
<li>2.   <a href="#rfc.section.2">IRI Syntax</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Summary of IRI Syntax</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">ABNF for IRI References and IRIs</a>
</li>
<li>3.   <a href="#rfc.section.3">Processing IRIs and related protocol elements</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Converting to UCS</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Parse the IRI into IRI components</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">General percent-encoding of IRI components</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Mapping ireg-name</a>
</li>
<li>3.4.1.   <a href="#rfc.section.3.4.1">Mapping using Percent-Encoding</a>
</li>
<li>3.4.2.   <a href="#rfc.section.3.4.2">Mapping using Punycode</a>
</li>
<li>3.4.3.   <a href="#rfc.section.3.4.3">Additional Considerations</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Mapping query components</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">Mapping IRIs to URIs</a>
</li>
<li>3.7.   <a href="#rfc.section.3.7">Converting URIs to IRIs</a>
</li>
<li>3.7.1.   <a href="#rfc.section.3.7.1">Examples</a>
</li>
<li>4.   <a href="#rfc.section.4">Use of IRIs</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Limitations on UCS Characters Allowed in IRIs</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Software Interfaces and Protocols</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Format of URIs and IRIs in Documents and Protocols</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Use of UTF-8 for Encoding Original Characters</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">Relative IRI References</a>
</li>
<li>5.   <a href="#rfc.section.5">Liberal Handling of Otherwise Invalid IRIs</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">LEIRI Processing</a>
</li>
<li>6.   <a href="#rfc.section.6">Characters Not Allowed in IRIs</a>
</li>
<li>7.   <a href="#rfc.section.7">URI/IRI Processing Guidelines (Informative)</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">URI/IRI Software Interfaces</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">URI/IRI Entry</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">URI/IRI Transfer between Applications</a>
</li>
<li>7.4.   <a href="#rfc.section.7.4">URI/IRI Generation</a>
</li>
<li>7.5.   <a href="#rfc.section.7.5">URI/IRI Selection</a>
</li>
<li>7.6.   <a href="#rfc.section.7.6">Display of URIs/IRIs</a>
</li>
<li>7.7.   <a href="#rfc.section.7.7">Interpretation of URIs and IRIs</a>
</li>
<li>7.8.   <a href="#rfc.section.7.8">Upgrading Strategy</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a>
</li>
<li>10.   <a href="#rfc.section.10">Acknowledgements</a>
</li>
<li>11.   <a href="#rfc.section.11">Main Changes Since RFC 3987</a>
</li>
<li>11.1.   <a href="#rfc.section.11.1">Split out Bidi, processing guidelines, comparison sections</a>
</li>
<li>11.2.   <a href="#rfc.section.11.2">Major restructuring of IRI processing model</a>
</li>
<li>11.2.1.   <a href="#rfc.section.11.2.1">OLD WAY</a>
</li>
<li>11.2.2.   <a href="#rfc.section.11.2.2">NEW WAY</a>
</li>
<li>11.2.3.   <a href="#rfc.section.11.2.3">Extension of Syntax</a>
</li>
<li>11.2.4.   <a href="#rfc.section.11.2.4">More to be added</a>
</li>
<li>11.3.   <a href="#rfc.section.11.3">Change Log</a>
</li>
<li>11.3.1.   <a href="#rfc.section.11.3.1">Changes after draft-ietf-iri-3987bis-01</a>
</li>
<li>11.3.2.   <a href="#rfc.section.11.3.2">Changes from draft-duerst-iri-bis-07 to draft-ietf-iri-3987bis-00</a>
</li>
<li>11.3.3.   <a href="#rfc.section.11.3.3">Changes from -06 to -07 of draft-duerst-iri-bis</a>
</li>
<li>11.4.   <a href="#rfc.section.11.4">Changes from -00 to -01</a>
</li>
<li>11.5.   <a href="#rfc.section.11.5">Changes from -05 to -06 of draft-duerst-iri-bis-00</a>
</li>
<li>11.6.   <a href="#rfc.section.11.6">Changes from -04 to -05 of draft-duerst-iri-bis</a>
</li>
<li>11.7.   <a href="#rfc.section.11.7">Changes from -03 to -04 of draft-duerst-iri-bis</a>
</li>
<li>11.8.   <a href="#rfc.section.11.8">Changes from -02 to -03 of draft-duerst-iri-bis</a>
</li>
<li>11.9.   <a href="#rfc.section.11.9">Changes from -01 to -02 of draft-duerst-iri-bis</a>
</li>
<li>11.10.   <a href="#rfc.section.11.10">Changes from -00 to -01 of draft-duerst-iri-bis</a>
</li>
<li>11.11.   <a href="#rfc.section.11.11">Changes from RFC 3987 to -00 of draft-duerst-iri-bis</a>
</li>
<li>12.   <a href="#rfc.references">References</a>
</li>
<li>12.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>12.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#overview" id="overview">Overview and Motivation</a>
</h1>
<p id="rfc.section.1.1.p.1">A Uniform Resource Identifier (URI) is defined in <a href="#RFC3986">[RFC3986]</a> as a sequence of characters chosen from a limited subset of the repertoire of US-ASCII <a href="#ASCII">[ASCII]</a> characters.</p>
<p id="rfc.section.1.1.p.2">The characters in URIs are frequently used for representing words of natural languages.  This usage has many advantages: Such URIs are easier to memorize, easier to interpret, easier to transcribe, easier to create, and easier to guess. For most languages other than English, however, the natural script uses characters other than A - Z. For many people, handling Latin characters is as difficult as handling the characters of other scripts is for those who use only the Latin alphabet. Many languages with non-Latin scripts are transcribed with Latin letters. These transcriptions are now often used in URIs, but they introduce additional difficulties.</p>
<p id="rfc.section.1.1.p.3">The infrastructure for the appropriate handling of characters from additional scripts is now widely deployed in operating system and application software. Software that can handle a wide variety of scripts and languages at the same time is increasingly common. Also, an increasing number of protocols and formats can carry a wide range of characters.</p>
<p id="rfc.section.1.1.p.4">URIs are used both as a protocol element (for transmission and processing by software) and also a presentation element (for display and handling by people who read, interpret, coin, or guess them). The transition between these roles is more difficult and complex when dealing with the larger set of characters than allowed for URIs in <a href="#RFC3986">[RFC3986]</a>. </p>
<p id="rfc.section.1.1.p.5">This document defines the protocol element called Internationalized Resource Identifier (IRI), which allow applications of URIs to be extended to use resource identifiers that have a much wider repertoire of characters. It also provides corresponding "internationalized" versions of other constructs from <a href="#RFC3986">[RFC3986]</a>, such as URI references. The syntax of IRIs is defined in <a href="#syntax">Section 2</a>.  </p>
<p id="rfc.section.1.1.p.6">Using characters outside of A - Z in IRIs adds a number of difficulties. <a href="#IRIuse">Section 4</a> discusses the use of IRIs in different situations.  <a href="#guidelines">Section 7</a> gives additional informative guidelines.  <a href="#security">Section 9</a> discusses IRI-specific security considerations.</p>
<p><a href="#Bidi">[Bidi]</a> discusses the special case of bidirectional IRIs using characters from scripts written right-to-left.  <a href="#Equivalence">[Equivalence]</a> gives guidelines for applications wishing to determine if two IRIs are equivalent, as well as defining some equivalence methods.  <a href="#RFC4395bis">[RFC4395bis]</a> updates the URI scheme registration guidelines and proceedures to note that every URI scheme is also automatically an IRI scheme and to allow scheme definitions to be directly described in terms of Unicode characters.  </p>
<p id="rfc.section.1.1.p.8">When originally defining IRIs, several design alternatives were considered.  Historically interested readers can find an overview in Appendix A of <a href="#RFC3987">[RFC3987]</a>.  For some additional background on the design of URIs and IRIs, please also see <a href="#Gettys">[Gettys]</a>.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#Applicability" id="Applicability">Applicability</a>
</h1>
<p id="rfc.section.1.2.p.1">IRIs are designed to allow protocols and software that deal with URIs to be updated to handle IRIs. Processing of IRIs is accomplished by extending the URI syntax while retaining (and not expanding) the set of "reserved" characters, such that the syntax for any URI scheme may be extended to allow non-ASCII characters. In addition, following parsing of an IRI, it is possible to construct a corresponding URI by first encoding characters outside of the allowed URI range and then reassembling the components.  </p>
<p id="rfc.section.1.2.p.2">Practical use of IRIs forms in place of URIs forms depends on the following conditions being met:</p>
<p></p>

<dl>
<dt>a.</dt>
<dd style="margin-left: 8">A protocol or format element MUST be explicitly designated to be able to carry IRIs. The intent is to avoid introducing IRIs into contexts that are not defined to accept them.  For example, XML schema <a href="#XMLSchema">[XMLSchema]</a> has an explicit type "anyURI" that includes IRIs and IRI references. Therefore, IRIs and IRI references can be in attributes and elements of type "anyURI".  On the other hand, in the <a href="#RFC2616">[RFC2616]</a> definition of HTTP/1.1, the Request URI is defined as a URI, which means that direct use of IRIs is not allowed in HTTP requests.</dd>
<dt>b.</dt>
<dd style="margin-left: 8">The protocol or format carrying the IRIs MUST have a mechanism to represent the wide range of characters used in IRIs, either natively or by some protocol- or format-specific escaping mechanism (for example, numeric character references in <a href="#XML1">[XML1]</a>).</dd>
<dt>c.</dt>
<dd style="margin-left: 8">The URI scheme definition, if it explicitly allows a percent sign ("%") in any syntactic component, SHOULD define the interpretation of sequences of percent-encoded octets (using "%XX" hex octets) as octet from sequences of UTF-8 encoded strings; this is recommended in the guidelines for registering new schemes, <a href="#RFC4395bis">[RFC4395bis]</a>.  For example, this is the practice for IMAP URLs <a href="#RFC2192">[RFC2192]</a>, POP URLs <a href="#RFC2384">[RFC2384]</a> and the URN syntax <a href="#RFC2141">[RFC2141]</a>). Note that use of percent-encoding may also be restricted in some situations, for example, URI schemes that disallow percent-encoding might still be used with a fragment identifier which is percent-encoded (e.g., <a href="#XPointer">[XPointer]</a>). See <a href="#UTF8use">Section 4.4</a> for further discussion.</dd>
</dl>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#sec-Definitions" id="sec-Definitions">Definitions</a>
</h1>
<p id="rfc.section.1.3.p.1">The following definitions are used in this document; they follow the terms in <a href="#RFC2130">[RFC2130]</a>, <a href="#RFC2277">[RFC2277]</a>, and <a href="#ISO10646">[ISO10646]</a>.</p>
<p></p>

<dl>
<dt>character:</dt>
<dd style="margin-left: 8">A member of a set of elements used for the organization, control, or representation of data. For example, "LATIN CAPITAL LETTER A" names a character.</dd>
<dt>octet:</dt>
<dd style="margin-left: 8">An ordered sequence of eight bits considered as a unit.</dd>
<dt>character repertoire:</dt>
<dd style="margin-left: 8">A set of characters (set in the mathematical sense).</dd>
<dt>sequence of characters:</dt>
<dd style="margin-left: 8">A sequence of characters (one after another).</dd>
<dt>sequence of octets:</dt>
<dd style="margin-left: 8">A sequence of octets (one after another).</dd>
<dt>character encoding:</dt>
<dd style="margin-left: 8">A method of representing a sequence of characters as a sequence of octets (maybe with variants). Also, a method of (unambiguously) converting a sequence of octets into a sequence of characters.</dd>
<dt>charset:</dt>
<dd style="margin-left: 8">The name of a parameter or attribute used to identify a character encoding.</dd>
<dt>UCS:</dt>
<dd style="margin-left: 8">Universal Character Set. The coded character set defined by ISO/IEC 10646 <a href="#ISO10646">[ISO10646]</a> and the Unicode Standard <a href="#UNIV6">[UNIV6]</a>.</dd>
<dt>IRI reference:</dt>
<dd style="margin-left: 8">Denotes the common usage of an Internationalized Resource Identifier. An IRI reference may be absolute or relative.  However, the "IRI" that results from such a reference only includes absolute IRIs; any relative IRI references are resolved to their absolute form.  Note that in <a href="#RFC2396">[RFC2396]</a> URIs did not include fragment identifiers, but in <a href="#RFC3986">[RFC3986]</a> fragment identifiers are part of URIs.</dd>
<dt>LEIRI (Legacy Extended IRI) processing:</dt>
<dd style="margin-left: 8">This term was used in various XML specifications to refer to strings that, although not valid IRIs, were acceptable input to the processing rules in <a href="#LEIRIspec">Section 5.1</a>.</dd>
<dt>running text:</dt>
<dd style="margin-left: 8">Human text (paragraphs, sentences, phrases) with syntax according to orthographic conventions of a natural language, as opposed to syntax defined for ease of processing by machines (e.g., markup, programming languages).</dd>
<dt>protocol element:</dt>
<dd style="margin-left: 8">Any portion of a message that affects processing of that message by the protocol in question.</dd>
<dt>presentation element:</dt>
<dd style="margin-left: 8">A presentation form corresponding to a protocol element; for example, using a wider range of characters.</dd>
<dt>create (a URI or IRI):</dt>
<dd style="margin-left: 8">With respect to URIs and IRIs, the term is used for the initial creation. This may be the initial creation of a resource with a certain identifier, or the initial exposition of a resource under a particular identifier.</dd>
<dt>generate (a URI or IRI):</dt>
<dd style="margin-left: 8">With respect to URIs and IRIs, the term is used when the identifier is generated by derivation from other information.</dd>
<dt>parsed URI component:</dt>
<dd style="margin-left: 8">When a URI processor parses a URI (following the generic syntax or a scheme-specific syntax, the result is a set of parsed URI components, each of which has a type (corresponding to the syntactic definition) and a sequence of URI characters.  </dd>
<dt>parsed IRI component:</dt>
<dd style="margin-left: 8">When an IRI processor parses an IRI directly, following the general syntax or a scheme-specific syntax, the result is a set of parsed IRI components, each of which has a type (corresponding to the syntactice definition) and a sequence of IRI characters. (This definition is analogous to "parsed URI component".)</dd>
<dt>IRI scheme:</dt>
<dd style="margin-left: 8">A URI scheme may also be known as an "IRI scheme" if the scheme's syntax has been extended to allow non-US-ASCII characters according to the rules in this document.</dd>
</dl>
<h1 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> <a href="#sec-Notation" id="sec-Notation">Notation</a>
</h1>
<p id="rfc.section.1.4.p.1">RFCs and Internet Drafts currently do not allow any characters outside the US-ASCII repertoire. Therefore, this document uses various special notations to denote such characters in examples.</p>
<p id="rfc.section.1.4.p.2">In text, characters outside US-ASCII are sometimes referenced by using a prefix of 'U+', followed by four to six hexadecimal digits.</p>
<p id="rfc.section.1.4.p.3">To represent characters outside US-ASCII in examples, this document uses 'XML Notation'.</p>
<p id="rfc.section.1.4.p.4">XML Notation uses a leading '&amp;#x', a trailing ';', and the hexadecimal number of the character in the UCS in between. For example, &amp;#x44F; stands for CYRILLIC CAPITAL LETTER YA. In this notation, an actual '&amp;' is denoted by '&amp;amp;'.</p>
<p id="rfc.section.1.4.p.5">To denote actual octets in examples (as opposed to percent-encoded octets), the two hex digits denoting the octet are enclosed in "&lt;" and "&gt;".  For example, the octet often denoted as 0xc9 is denoted here as &lt;c9&gt;.</p>
<p id="rfc.section.1.4.p.6">In this document, the key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#syntax" id="syntax">IRI Syntax</a>
</h1>
<p id="rfc.section.2.p.1">This section defines the syntax of Internationalized Resource Identifiers (IRIs).</p>
<p id="rfc.section.2.p.2">As with URIs, an IRI is defined as a sequence of characters, not as a sequence of octets. This definition accommodates the fact that IRIs may be written on paper or read over the radio as well as stored or transmitted digitally.  The same IRI might be represented as different sequences of octets in different protocols or documents if these protocols or documents use different character encodings (and/or transfer encodings).  Using the same character encoding as the containing protocol or document ensures that the characters in the IRI can be handled (e.g., searched, converted, displayed) in the same way as the rest of the protocol or document.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#summary" id="summary">Summary of IRI Syntax</a>
</h1>
<p id="rfc.section.2.1.p.1">The IRI syntax extends the URI syntax in <a href="#RFC3986">[RFC3986]</a> by extending the class of unreserved characters, primarily by adding the characters of the UCS (Universal Character Set, <a href="#ISO10646">[ISO10646]</a>) beyond U+007F, subject to the limitations given in the syntax rules below and in <a href="#limitations">Section 4.1</a>.</p>
<p id="rfc.section.2.1.p.2">The syntax and use of components and reserved characters is the same as that in <a href="#RFC3986">[RFC3986]</a>. Each "URI scheme" thus also functions as an "IRI scheme", in that scheme-specific parsing rules for URIs of a scheme are be extended to allow parsing of IRIs using the same parsing rules.</p>
<p id="rfc.section.2.1.p.3">All the operations defined in <a href="#RFC3986">[RFC3986]</a>, such as the resolution of relative references, can be applied to IRIs by IRI-processing software in exactly the same way as they are for URIs by URI-processing software.</p>
<p id="rfc.section.2.1.p.4">Characters outside the US-ASCII repertoire MUST NOT be reserved and therefore MUST NOT be used for syntactical purposes, such as to delimit components in newly defined schemes. For example, U+00A2, CENT SIGN, is not allowed as a delimiter in IRIs, because it is in the 'iunreserved' category. This is similar to the fact that it is not possible to use '-' as a delimiter in URIs, because it is in the 'unreserved' category.</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#abnf" id="abnf">ABNF for IRI References and IRIs</a>
</h1>
<p id="rfc.section.2.2.p.1">An ABNF definition for IRI references (which are the most general concept and the start of the grammar) and IRIs is given here. The syntax of this ABNF is described in <a href="#STD68">[STD68]</a>. Character numbers are taken from the UCS, without implying any actual binary encoding. Terminals in the ABNF are characters, not octets.</p>
<p id="rfc.section.2.2.p.2">The following grammar closely follows the URI grammar in <a href="#RFC3986">[RFC3986]</a>, except that the range of unreserved characters is expanded to include UCS characters, with the restriction that private UCS characters can occur only in query parts. The grammar is split into two parts: Rules that differ from <a href="#RFC3986">[RFC3986]</a> because of the above-mentioned expansion, and rules that are the same as those in <a href="#RFC3986">[RFC3986]</a>. For rules that are different than those in <a href="#RFC3986">[RFC3986]</a>, the names of the non-terminals have been changed as follows. If the non-terminal contains 'URI', this has been changed to 'IRI'. Otherwise, an 'i' has been prefixed.  The rule &lt;pct-form&gt; has been introduced in order to be able to reference it from other parts of the document.</p>
<div id="#rfc.figure.1"></div>
<p>The following rules are different from those in <a href="#RFC3986">[RFC3986]</a>:</p>
<pre>
IRI            = scheme ":" ihier-part [ "?" iquery ]
                 [ "#" ifragment ]

ihier-part     = "//" iauthority ipath-abempty
               / ipath-absolute
               / ipath-rootless
               / ipath-empty

IRI-reference  = IRI / irelative-ref

absolute-IRI   = scheme ":" ihier-part [ "?" iquery ]

irelative-ref  = irelative-part [ "?" iquery ] [ "#" ifragment ]

irelative-part = "//" iauthority ipath-abempty
               / ipath-absolute
               / ipath-noscheme
               / ipath-empty

iauthority     = [ iuserinfo "@" ] ihost [ ":" port ]
iuserinfo      = *( iunreserved / pct-form / sub-delims / ":" )
ihost          = IP-literal / IPv4address / ireg-name

pct-form       = pct-encoded

ireg-name      = *( iunreserved / sub-delims )

ipath          = ipath-abempty   ; begins with "/" or is empty
               / ipath-absolute  ; begins with "/" but not "//"
               / ipath-noscheme  ; begins with a non-colon segment
               / ipath-rootless  ; begins with a segment
               / ipath-empty     ; zero characters

ipath-abempty  = *( path-sep isegment )
ipath-absolute = path-sep [ isegment-nz *( path-sep isegment ) ]
ipath-noscheme = isegment-nz-nc *( path-sep isegment )
ipath-rootless = isegment-nz *( path-sep isegment )
ipath-empty    = 0&lt;ipchar&gt;
path-sep       = "/"

isegment       = *ipchar
isegment-nz    = 1*ipchar
isegment-nz-nc = 1*( iunreserved / pct-form / sub-delims
                     / "@" )
               ; non-zero-length segment without any colon ":"                      

ipchar         = iunreserved / pct-form / sub-delims / ":"
               / "@"
 
iquery         = *( ipchar / iprivate / "/" / "?" )

ifragment      = *( ipchar / "/" / "?" )

iunreserved    = ALPHA / DIGIT / "-" / "." / "_" / "~" / ucschar

ucschar        = %xA0-D7FF / %xF900-FDCF / %xFDF0-FFEF
               / %x10000-1FFFD / %x20000-2FFFD / %x30000-3FFFD
               / %x40000-4FFFD / %x50000-5FFFD / %x60000-6FFFD
               / %x70000-7FFFD / %x80000-8FFFD / %x90000-9FFFD
               / %xA0000-AFFFD / %xB0000-BFFFD / %xC0000-CFFFD
               / %xD0000-DFFFD / %xE1000-EFFFD

iprivate       = %xE000-F8FF / %xE0000-E0FFF / %xF0000-FFFFD
               / %x100000-10FFFD
</pre>
<p id="rfc.section.2.2.p.3">Some productions are ambiguous. The "first-match-wins" (a.k.a. "greedy") algorithm applies. For details, see <a href="#RFC3986">[RFC3986]</a>.</p>
<div id="#rfc.figure.2"></div>
<p>The following rules are the same as those in <a href="#RFC3986">[RFC3986]</a>:</p>
<pre>
scheme         = ALPHA *( ALPHA / DIGIT / "+" / "-" / "." )
 
port           = *DIGIT
 
IP-literal     = "[" ( IPv6address / IPvFuture  ) "]"
 
IPvFuture      = "v" 1*HEXDIG "." 1*( unreserved / sub-delims / ":" )
 
IPv6address    =                            6( h16 ":" ) ls32
               /                       "::" 5( h16 ":" ) ls32
               / [               h16 ] "::" 4( h16 ":" ) ls32
               / [ *1( h16 ":" ) h16 ] "::" 3( h16 ":" ) ls32
               / [ *2( h16 ":" ) h16 ] "::" 2( h16 ":" ) ls32
               / [ *3( h16 ":" ) h16 ] "::"    h16 ":"   ls32
               / [ *4( h16 ":" ) h16 ] "::"              ls32
               / [ *5( h16 ":" ) h16 ] "::"              h16
               / [ *6( h16 ":" ) h16 ] "::"
               
h16            = 1*4HEXDIG
ls32           = ( h16 ":" h16 ) / IPv4address

IPv4address    = dec-octet "." dec-octet "." dec-octet "." dec-octet

dec-octet      = DIGIT                 ; 0-9
               / %x31-39 DIGIT         ; 10-99
               / "1" 2DIGIT            ; 100-199
               / "2" %x30-34 DIGIT     ; 200-249
               / "25" %x30-35          ; 250-255
            
pct-encoded    = "%" HEXDIG HEXDIG

unreserved     = ALPHA / DIGIT / "-" / "." / "_" / "~"
reserved       = gen-delims / sub-delims
gen-delims     = ":" / "/" / "?" / "#" / "[" / "]" / "@"
sub-delims     = "!" / "$" / "&amp;" / "'" / "(" / ")"
               / "*" / "+" / "," / ";" / "="
</pre>
<p id="rfc.section.2.2.p.4">This syntax does not support IPv6 scoped addressing zone identifiers.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#processing" id="processing">Processing IRIs and related protocol elements</a>
</h1>
<p id="rfc.section.3.p.1">IRIs are meant to replace URIs in identifying resources within new versions of protocols, formats, and software components that use a UCS-based character repertoire.  Protocols and components may use and process IRIs directly. However, there are still numerous systems and protocols which only accept URIs or components of parsed URIs; that is, they only accept sequences of characters within the subset of US-ASCII characters allowed in URIs. </p>
<p id="rfc.section.3.p.2">This section defines specific processing steps for IRI consumers which establish the relationship between the string given and the interpreted derivatives. These processing steps apply to both IRIs and IRI references (i.e., absolute or relative forms); for IRIs, some steps are scheme specific. </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#ucsconv" id="ucsconv">Converting to UCS</a>
</h1>
<p id="rfc.section.3.1.p.1">Input that is already in a Unicode form (i.e., a sequence of Unicode characters or an octet-stream representing a Unicode-based character encoding such as UTF-8 or UTF-16) should be left as is and not normalized or changed.</p>
<p id="rfc.section.3.1.p.2">An IRI or IRI reference is a sequence of characters from the UCS.  For resource identifiers that are not already in a Unicode form (as when written on paper, read aloud, or represented in a text stream using a legacy character encoding), convert the IRI to Unicode.  Note that some character encodings or transcriptions can be converted to or represented by more than one sequence of Unicode characters.  Ideally the resulting IRI would use a normalized form, such as Unicode Normalization Form C <a href="#UTR15">[UTR15]</a>, since that ensures a stable, consistent representation that is most likely to produce the intended results.  Implementers and users are cautioned that, while denormalized character sequences are valid, they might be difficult for other users or processes to reproduce and might lead to unexpected results.  </p>
<p id="rfc.section.3.1.p.3">In other cases (written on paper, read aloud, or otherwise represented independent of any character encoding) represent the IRI as a sequence of characters from the UCS normalized according to Unicode Normalization Form C (NFC, <a href="#UTR15">[UTR15]</a>).</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Parse the IRI into IRI components</h1>
<p id="rfc.section.3.2.p.1">Parse the IRI, either as a relative reference (no scheme) or using scheme specific processing (according to the scheme given); the result is a set of parsed IRI components.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#compmapping" id="compmapping">General percent-encoding of IRI components</a>
</h1>
<p id="rfc.section.3.3.p.1">Except as noted in the following subsections, IRI components are mapped to the equivalent URI components by percent-encoding those characters not allowed in URIs. Previous processing steps will have removed some characters, and the interpretation of reserved characters will have already been done (with the syntactic reserved characters outside of the IRI component). This mapping is defined for all sequences of Unicode characters, whether or not they are valid for the component in question. </p>
<p id="rfc.section.3.3.p.2">For each character which is not allowed anywhere in a valid URI apply the following steps. </p>
<p></p>

<dl>
<dt>Convert to UTF-8</dt>
<dd style="margin-left: 8">Convert the character to a sequence of one or more octets using UTF-8 <a href="#RFC3629">[RFC3629]</a>.</dd>
<dt>Percent encode</dt>
<dd style="margin-left: 8">Convert each octet of this sequence to %HH, where HH is the hexadecimal notation of the octet value. The hexadecimal notation SHOULD use uppercase letters. (This is the general URI percent-encoding mechanism in Section 2.1 of <a href="#RFC3986">[RFC3986]</a>.)</dd>
</dl>
<p id="rfc.section.3.3.p.4">Note that the mapping is an identity transformation for parsed URI components of valid URIs, and is idempotent: applying the mapping a second time will not change anything.</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#dnsmapping" id="dnsmapping">Mapping ireg-name</a>
</h1>
<h1 id="rfc.section.3.4.1">
<a href="#rfc.section.3.4.1">3.4.1.</a> <a href="#dnspercent" id="dnspercent">Mapping using Percent-Encoding</a>
</h1>
<p id="rfc.section.3.4.1.p.1">The ireg-name component SHOULD be converted according to the general procedure for percent-encoding of IRI components described in <a href="#compmapping">Section 3.3</a>.</p>
<p id="rfc.section.3.4.1.p.2">For example, the IRI <br>"http://r&amp;#xE9;sum&amp;#xE9;.example.org"<br> will be converted to <br>"http://r%C3%A9sum%C3%A9.example.org".</p>
<p id="rfc.section.3.4.1.p.3">This conversion for ireg-name is in line with Section 3.2.2 of <a href="#RFC3986">[RFC3986]</a>, which does not mandate a particular registered name lookup technology. For further background, see <a href="#RFC6055">[RFC6055]</a> and <a href="#Gettys">[Gettys]</a>.</p>
<h1 id="rfc.section.3.4.2">
<a href="#rfc.section.3.4.2">3.4.2.</a> <a href="#dnspunycode" id="dnspunycode">Mapping using Punycode</a>
</h1>
<p id="rfc.section.3.4.2.p.1">The ireg-name component MAY also be converted as follows:</p>
<p id="rfc.section.3.4.2.p.2">Replace the ireg-name part of the IRI by the part converted using the Domain Name Lookup procedure (Subsections 5.3 to 5.5) of <a href="#RFC5891">[RFC5891]</a>.  on each dot-separated label, and by using U+002E (FULL STOP) as a label separator.  This procedure may fail, but this would mean that the IRI cannot be resolved.  In such cases, if the domain name conversion fails, then the entire IRI conversion fails. Processors that have no mechanism for signalling a failure MAY instead substitute an otherwise invalid host name, although such processing SHOULD be avoided.</p>
<p id="rfc.section.3.4.2.p.3">For example, the IRI <br>"http://r&amp;#xE9;sum&amp;#xE9;.example.org"<br> MAY be converted to <br>"http://xn--rsum-bad.example.org"<br>.</p>
<p id="rfc.section.3.4.2.p.4">This conversion for ireg-name will be better able to deal with legacy infrastructure that cannot handle percent-encoding in domain names.</p>
<h1 id="rfc.section.3.4.3">
<a href="#rfc.section.3.4.3">3.4.3.</a> Additional Considerations</h1>
<p></p>

<dl>
<dt>Note:</dt>
<dd style="margin-left: 8">Domain Names may appear in parts of an IRI other than the ireg-name part.  It is the responsibility of scheme-specific implementations (if the Internationalized Domain Name is part of the scheme syntax) or of server-side implementations (if the Internationalized Domain Name is part of 'iquery') to apply the necessary conversions at the appropriate point. Example: Trying to validate the Web page at<br> http://r&amp;#xE9;sum&amp;#xE9;.example.org would lead to an IRI of <br>http://validator.w3.org/check?uri=http%3A%2F%2Fr&amp;#xE9;sum&amp;#xE9;.<br>example.org, which would convert to a URI of<br>http://validator.w3.org/check?uri=http%3A%2F%2Fr%C3%A9sum%C3%A9.<br>example.org.  The server-side implementation is responsible for making the necessary conversions to be able to retrieve the Web page.</dd>
<dt>Note:</dt>
<dd style="margin-left: 8">In this process, characters allowed in URI references and existing percent-encoded sequences are not encoded further.  (This mapping is similar to, but different from, the encoding applied when arbitrary content is included in some part of a URI.) For example, an IRI of <br>"http://www.example.org/red%09ros&amp;#xE9;#red" (in XML notation) is converted to <br>"http://www.example.org/red%09ros%C3%A9#red", not to something like <br>"http%3A%2F%2Fwww.example.org%2Fred%2509ros%C3%A9%23red".</dd>
</dl>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#querymapping" id="querymapping">Mapping query components</a>
</h1>
<p id="rfc.section.3.5.p.1">For compatibility with existing deployed HTTP infrastructure, the following special case applies for schemes "http" and "https" and IRIs whose origin has a document charset other than one which is UCS-based (e.g., UTF-8 or UTF-16). In such a case, the "query" component of an IRI is mapped into a URI by using the document charset rather than UTF-8 as the binary representation before pct-encoding. This mapping is not applied for any other scheme or component.</p>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> <a href="#mapping" id="mapping">Mapping IRIs to URIs</a>
</h1>
<p id="rfc.section.3.6.p.1">The mapping from an IRI to URI is accomplished by applying the mapping above (from IRI to URI components) and then reassembling a URI from the parsed URI components using the original punctuation that delimited the IRI components. </p>
<h1 id="rfc.section.3.7">
<a href="#rfc.section.3.7">3.7.</a> <a href="#URItoIRI" id="URItoIRI">Converting URIs to IRIs</a>
</h1>
<p id="rfc.section.3.7.p.1">In some situations, for presentation and further processing, it is desirable to convert a URI into an equivalent IRI in which natural characters are represented directly rather than percent encoded. Of course, every URI is already an IRI in its own right without any conversion, and in general there This section gives one such procedure for this conversion.  </p>
<p id="rfc.section.3.7.p.2">The conversion described in this section, if given a valid URI, will result in an IRI that maps back to the URI used as an input for the conversion (except for potential case differences in percent-encoding and for potential percent-encoded unreserved characters).  However, the IRI resulting from this conversion may differ from the original IRI (if there ever was one).</p>
<p id="rfc.section.3.7.p.3">URI-to-IRI conversion removes percent-encodings, but not all percent-encodings can be eliminated. There are several reasons for this:</p>
<p></p>

<dl>
<dt>1.</dt>
<dd style="margin-left: 8">Some percent-encodings are necessary to distinguish percent-encoded and unencoded uses of reserved characters.</dd>
<dt>2.</dt>
<dd style="margin-left: 8">Some percent-encodings cannot be interpreted as sequences of UTF-8 octets.<br><br> (Note: The octet patterns of UTF-8 are highly regular.  Therefore, there is a very high probability, but no guarantee, that percent-encodings that can be interpreted as sequences of UTF-8 octets actually originated from UTF-8. For a detailed discussion, see <a href="#Duerst97">[Duerst97]</a>.)</dd>
<dt>3.</dt>
<dd style="margin-left: 8">The conversion may result in a character that is not appropriate in an IRI. See <a href="#abnf">Section 2.2</a>, and <a href="#limitations">Section 4.1</a> for further details.</dd>
<dt>4.</dt>
<dd style="margin-left: 8">IRI to URI conversion has different rules for dealing with domain names and query parameters.</dd>
</dl>
<p id="rfc.section.3.7.p.5">Conversion from a URI to an IRI MAY be done by using the following steps: </p>

<dl>
<dt>1.</dt>
<dd style="margin-left: 8">Represent the URI as a sequence of octets in US-ASCII.</dd>
<dt>2.</dt>
<dd style="margin-left: 8">Convert all percent-encodings ("%" followed by two hexadecimal digits) to the corresponding octets, except those corresponding to "%", characters in "reserved", and characters in US-ASCII not allowed in URIs.</dd>
<dt>3.</dt>
<dd style="margin-left: 8">Re-percent-encode any octet produced in step 2 that is not part of a strictly legal UTF-8 octet sequence.</dd>
<dt>4.</dt>
<dd style="margin-left: 8">Re-percent-encode all octets produced in step 3 that in UTF-8 represent characters that are not appropriate according to <a href="#abnf">Section 2.2</a>  and <a href="#limitations">Section 4.1</a>.</dd>
<dt>5.</dt>
<dd style="margin-left: 8">Interpret the resulting octet sequence as a sequence of characters encoded in UTF-8.</dd>
<dt>6.</dt>
<dd style="margin-left: 8">URIs known to contain domain names in the reg-name component SHOULD convert punycode-encoded domain name labels to the corresponding characters using the ToUnicode procedure. </dd>
</dl>
<p id="rfc.section.3.7.p.6">This procedure will convert as many percent-encoded characters as possible to characters in an IRI. Because there are some choices when step 4 is applied (see <a href="#limitations">Section 4.1</a>), results may vary.</p>
<p id="rfc.section.3.7.p.7">Conversions from URIs to IRIs MUST NOT use any character encoding other than UTF-8 in steps 3 and 4, even if it might be possible to guess from the context that another character encoding than UTF-8 was used in the URI.  For example, the URI "http://www.example.org/r%E9sum%E9.html" might with some guessing be interpreted to contain two e-acute characters encoded as iso-8859-1. It must not be converted to an IRI containing these e-acute characters. Otherwise, in the future the IRI will be mapped to "http://www.example.org/r%C3%A9sum%C3%A9.html", which is a different URI from "http://www.example.org/r%E9sum%E9.html".</p>
<h1 id="rfc.section.3.7.1">
<a href="#rfc.section.3.7.1">3.7.1.</a> Examples</h1>
<p id="rfc.section.3.7.1.p.1">This section shows various examples of converting URIs to IRIs.  Each example shows the result after each of the steps 1 through 6 is applied. XML Notation is used for the final result.  Octets are denoted by "&lt;" followed by two hexadecimal digits followed by "&gt;".</p>
<p id="rfc.section.3.7.1.p.2">The following example contains the sequence "%C3%BC", which is a strictly legal UTF-8 sequence, and which is converted into the actual character U+00FC, LATIN SMALL LETTER U WITH DIAERESIS (also known as u-umlaut).  </p>

<dl>
<dt>1.</dt>
<dd style="margin-left: 8">http://www.example.org/D%C3%BCrst</dd>
<dt>2.</dt>
<dd style="margin-left: 8">http://www.example.org/D&lt;c3&gt;&lt;bc&gt;rst</dd>
<dt>3.</dt>
<dd style="margin-left: 8">http://www.example.org/D&lt;c3&gt;&lt;bc&gt;rst</dd>
<dt>4.</dt>
<dd style="margin-left: 8">http://www.example.org/D&lt;c3&gt;&lt;bc&gt;rst</dd>
<dt>5.</dt>
<dd style="margin-left: 8">http://www.example.org/D&amp;#xFC;rst</dd>
<dt>6.</dt>
<dd style="margin-left: 8">http://www.example.org/D&amp;#xFC;rst</dd>
</dl>

<p> </p>
<p id="rfc.section.3.7.1.p.3">The following example contains the sequence "%FC", which might represent U+00FC, LATIN SMALL LETTER U WITH DIAERESIS, in the<br>iso-8859-1 character encoding.  (It might represent other characters in other character encodings. For example, the octet &lt;fc&gt; in iso-8859-5 represents U+045C, CYRILLIC SMALL LETTER KJE.)  Because &lt;fc&gt; is not part of a strictly legal UTF-8 sequence, it is re-percent-encoded in step 3.  </p>

<dl>
<dt>1.</dt>
<dd style="margin-left: 8">http://www.example.org/D%FCrst</dd>
<dt>2.</dt>
<dd style="margin-left: 8">http://www.example.org/D&lt;fc&gt;rst</dd>
<dt>3.</dt>
<dd style="margin-left: 8">http://www.example.org/D%FCrst</dd>
<dt>4.</dt>
<dd style="margin-left: 8">http://www.example.org/D%FCrst</dd>
<dt>5.</dt>
<dd style="margin-left: 8">http://www.example.org/D%FCrst</dd>
<dt>6.</dt>
<dd style="margin-left: 8">http://www.example.org/D%FCrst</dd>
</dl>

<p> </p>
<p id="rfc.section.3.7.1.p.4">The following example contains "%e2%80%ae", which is the percent-encoded<br>UTF-8 character encoding of U+202E, RIGHT-TO-LEFT OVERRIDE.  The direct use of this character is forbiddin in an IRI. Therefore, the corresponding octets are re-percent-encoded in step 4. This example shows that the case (upper- or lowercase) of letters used in percent-encodings may not be preserved.  The example also contains a punycode-encoded domain name label (xn--99zt52a), which is not converted.  </p>

<dl>
<dt>1.</dt>
<dd style="margin-left: 8">http://xn--99zt52a.example.org/%e2%80%ae</dd>
<dt>2.</dt>
<dd style="margin-left: 8">http://xn--99zt52a.example.org/&lt;e2&gt;&lt;80&gt;&lt;ae&gt;</dd>
<dt>3.</dt>
<dd style="margin-left: 8">http://xn--99zt52a.example.org/&lt;e2&gt;&lt;80&gt;&lt;ae&gt;</dd>
<dt>4.</dt>
<dd style="margin-left: 8">http://xn--99zt52a.example.org/%E2%80%AE</dd>
<dt>5.</dt>
<dd style="margin-left: 8">http://xn--99zt52a.example.org/%E2%80%AE</dd>
<dt>6.</dt>
<dd style="margin-left: 8">http://&amp;#x7D0D;&amp;#x8C46;.example.org/%E2%80%AE</dd>
</dl>
<p id="rfc.section.3.7.1.p.5">Note that the label "xn--99zt52a" is converted to U+7D0D U+8C46 (Japanese Natto). ((EDITOR NOTE: There is some inconsistency in this note.))</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#IRIuse" id="IRIuse">Use of IRIs</a>
</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#limitations" id="limitations">Limitations on UCS Characters Allowed in IRIs</a>
</h1>
<p id="rfc.section.4.1.p.1">This section discusses limitations on characters and character sequences usable for IRIs beyond those given in <a href="#abnf">Section 2.2</a>.  The considerations in this section are relevant when IRIs are created and when URIs are converted to IRIs.</p>
<p></p>

<dl>
<dt>a.</dt>
<dd style="margin-left: 8">The repertoire of characters allowed in each IRI component is limited by the definition of that component.  For example, the definition of the scheme component does not allow characters beyond US-ASCII.  <br><br> (Note: In accordance with URI practice, generic IRI software cannot and should not check for such limitations.)</dd>
<dt>b.</dt>
<dd style="margin-left: 8">The UCS contains many areas of characters for which there are strong visual look-alikes. Because of the likelihood of transcription errors, these also should be avoided. This includes the full-width equivalents of Latin characters, half-width Katakana characters for Japanese, and many others. It also includes many look-alikes of "space", "delims", and "unwise", characters excluded in <a href="#RFC3491">[RFC3491]</a>.</dd>
</dl>

<p> </p>
<p id="rfc.section.4.1.p.3">Additional information is available from <a href="#UNIXML">[UNIXML]</a>.  <a href="#UNIXML">[UNIXML]</a> is written in the context of running text rather than in that of identifiers. Nevertheless, it discusses many of the categories of characters not appropriate for IRIs.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Software Interfaces and Protocols</h1>
<p id="rfc.section.4.2.p.1">Although an IRI is defined as a sequence of characters, software interfaces for URIs typically function on sequences of octets or other kinds of code units. Thus, software interfaces and protocols MUST define which character encoding is used.</p>
<p id="rfc.section.4.2.p.2">Intermediate software interfaces between IRI-capable components and URI-only components MUST map the IRIs per <a href="#mapping">Section 3.6</a>, when transferring from IRI-capable to URI-only components.  This mapping SHOULD be applied as late as possible. It SHOULD NOT be applied between components that are known to be able to handle IRIs.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Format of URIs and IRIs in Documents and Protocols</h1>
<p id="rfc.section.4.3.p.1">Document formats that transport URIs may have to be upgraded to allow the transport of IRIs. In cases where the document as a whole has a native character encoding, IRIs MUST also be encoded in this character encoding and converted accordingly by a parser or interpreter.  IRI characters not expressible in the native character encoding SHOULD be escaped by using the escaping conventions of the document format if such conventions are available. Alternatively, they MAY be percent-encoded according to <a href="#mapping">Section 3.6</a>. For example, in HTML or XML, numeric character references SHOULD be used. If a document as a whole has a native character encoding and that character encoding is not UTF-8, then IRIs MUST NOT be placed into the document in the UTF-8 character encoding.</p>
<p id="rfc.section.4.3.p.2">((UPDATE THIS NOTE)) Note: Some formats already accommodate IRIs, although they use different terminology. HTML 4.0 <a href="#HTML4">[HTML4]</a> defines the conversion from IRIs to URIs as error-avoiding behavior. XML 1.0 <a href="#XML1">[XML1]</a>, XLink <a href="#XLink">[XLink]</a>, XML Schema <a href="#XMLSchema">[XMLSchema]</a>, and specifications based upon them allow IRIs. Also, it is expected that all relevant new W3C formats and protocols will be required to handle IRIs <a href="#CharMod">[CharMod]</a>.</p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#UTF8use" id="UTF8use">Use of UTF-8 for Encoding Original Characters</a>
</h1>
<p id="rfc.section.4.4.p.1">This section discusses details and gives examples for point c) in <a href="#Applicability">Section 1.2</a>. To be able to use IRIs, the URI corresponding to the IRI in question has to encode original characters into octets by using UTF-8.  This can be specified for all URIs of a URI scheme or can apply to individual URIs for schemes that do not specify how to encode original characters.  It can apply to the whole URI, or only to some part. For background information on encoding characters into URIs, see also Section 2.5 of <a href="#RFC3986">[RFC3986]</a>.</p>
<p id="rfc.section.4.4.p.2">For new URI schemes, using UTF-8 is recommended in <a href="#RFC4395bis">[RFC4395bis]</a>.  Examples where UTF-8 is already used are the URN syntax <a href="#RFC2141">[RFC2141]</a>, IMAP URLs <a href="#RFC2192">[RFC2192]</a>, and POP URLs <a href="#RFC2384">[RFC2384]</a>.  On the other hand, because the HTTP URI scheme does not specify how to encode original characters, only some HTTP URLs can have corresponding but different IRIs.</p>
<p id="rfc.section.4.4.p.3">For example, for a document with a URI of<br>"http://www.example.org/r%C3%A9sum%C3%A9.html", it is possible to construct a corresponding IRI (in XML notation, see <a href="#sec-Notation">Section 1.4</a>): "http://www.example.org/r&amp;#xE9;sum&amp;#xE9;.html" ("&amp;#xE9;" stands for the e-acute character, and "%C3%A9" is the UTF-8 encoded and percent-encoded representation of that character). On the other hand, for a document with a URI of "http://www.example.org/r%E9sum%E9.html", the percent-encoding octets cannot be converted to actual characters in an IRI, as the percent-encoding is not based on UTF-8.</p>
<p id="rfc.section.4.4.p.4">For most URI schemes, there is no need to upgrade their scheme definition in order for them to work with IRIs.  The main case where upgrading makes sense is when a scheme definition, or a particular component of a scheme, is strictly limited to the use of US-ASCII characters with no provision to include non-ASCII characters/octets via percent-encoding, or if a scheme definition currently uses highly scheme-specific provisions for the encoding of non-ASCII characters.  An example of this is the mailto: scheme <a href="#RFC2368">[RFC2368]</a>.</p>
<p id="rfc.section.4.4.p.5">This specification updates the IANA registry of URI schemes to note their applicability to IRIs, see <a href="#iana">Section 8</a>.  All IRIs use URI schemes, and all URIs with URI schemes can be used as IRIs, even though in some cases only by using URIs directly as IRIs, without any conversion.</p>
<p id="rfc.section.4.4.p.6">Scheme definitions can impose restrictions on the syntax of scheme-specific URIs; i.e., URIs that are admissible under the generic URI syntax <a href="#RFC3986">[RFC3986]</a> may not be admissible due to narrower syntactic constraints imposed by a URI scheme specification. URI scheme definitions cannot broaden the syntactic restrictions of the generic URI syntax; otherwise, it would be possible to generate URIs that satisfied the scheme-specific syntactic constraints without satisfying the syntactic constraints of the generic URI syntax. However, additional syntactic constraints imposed by URI scheme specifications are applicable to IRI, as the corresponding URI resulting from the mapping defined in <a href="#mapping">Section 3.6</a> MUST be a valid URI under the syntactic restrictions of generic URI syntax and any narrower restrictions imposed by the corresponding URI scheme specification.</p>
<p id="rfc.section.4.4.p.7">The requirement for the use of UTF-8 generally applies to all parts of a URI.  However, it is possible that the capability of IRIs to represent a wide range of characters directly is used just in some parts of the IRI (or IRI reference). The other parts of the IRI may only contain US-ASCII characters, or they may not be based on UTF-8. They may be based on another character encoding, or they may directly encode raw binary data (see also <a href="#RFC2397">[RFC2397]</a>). </p>
<p id="rfc.section.4.4.p.8">For example, it is possible to have a URI reference of<br>"http://www.example.org/r%E9sum%E9.xml#r%C3%A9sum%C3%A9", where the document name is encoded in iso-8859-1 based on server settings, but where the fragment identifier is encoded in UTF-8 according to <a href="#XPointer">[XPointer]</a>. The IRI corresponding to the above URI would be (in XML notation)<br>"http://www.example.org/r%E9sum%E9.xml#r&amp;#xE9;sum&amp;#xE9;".</p>
<p id="rfc.section.4.4.p.9">Similar considerations apply to query parts. The functionality of IRIs (namely, to be able to include non-ASCII characters) can only be used if the query part is encoded in UTF-8.</p>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> Relative IRI References</h1>
<p id="rfc.section.4.5.p.1">Processing of relative IRI references against a base is handled straightforwardly; the algorithms of <a href="#RFC3986">[RFC3986]</a> can be applied directly, treating the characters additionally allowed in IRI references in the same way that unreserved characters are in URI references.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#LEIRIHREF" id="LEIRIHREF">Liberal Handling of Otherwise Invalid IRIs</a>
</h1>
<p id="rfc.section.5.p.1">Some technical specifications and widely-deployed software have allowed additional variations and extensions of IRIs to be used in syntactic components. </p>
<p id="rfc.section.5.p.2">Future technical specifications SHOULD NOT allow conforming producers to produce, or conforming content to contain, such forms, as they are not interoperable with other IRI consuming software.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#LEIRIspec" id="LEIRIspec">LEIRI Processing</a>
</h1>
<p id="rfc.section.5.1.p.1">This section defines Legacy Extended IRIs (LEIRIs).  The syntax of Legacy Extended IRIs is the same as that for &lt;IRI-reference&gt;, except that the ucschar production is replaced by the leiri-ucschar production:</p>
<div id="#rfc.figure.3"></div>
<pre>
  leiri-ucschar  = " " / "&lt;" / "&gt;" / '"' / "{" / "}" / "|"
                   / "\" / "^" / "`" / %x0-1F / %x7F-D7FF
                   / %xE000-FFFD / %x10000-10FFFF
</pre>
<p>Among other extensions, processors based on this specification also did not enforce the restriction on bidirectional formatting characters in <a href="#Bidi">[Bidi]</a>, and the iprivate production becomes redundant.</p>
<p id="rfc.section.5.1.p.2">To convert a string allowed as a LEIRI to an IRI, each character allowed in leiri-ucschar but not in ucschar must be percent-encoded using <a href="#compmapping">Section 3.3</a>.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#notAllowed" id="notAllowed">Characters Not Allowed in IRIs</a>
</h1>
<p id="rfc.section.6.p.1">This section provides a list of the groups of characters and code points that are allowed in some contexts but are not allowed in IRIs or are allowed in IRIs only in the query part. For each group of characters, advice on the usage of these characters is also given, concentrating on the reasons for why they are excluded from IRI use.</p>
<p></p>

<ul class="empty">
<li>Space (U+0020): Some formats and applications use space as a delimiter, e.g. for items in a list. Appendix C of <a href="#RFC3986">[RFC3986]</a> also mentions that white space may have to be added when displaying or printing long URIs; the same applies to long IRIs. This means that spaces can disappear, or can make the what is intended as a single IRI or IRI reference to be treated as two or more separate IRIs.</li>
<li>Delimiters "&lt;" (U+003C), "&gt;" (U+003E), and '"' (U+0022): Appendix C of <a href="#RFC3986">[RFC3986]</a> suggests the use of double-quotes ("http://example.com/") and angle brackets (&lt;http://example.com/&gt;) as delimiters for URIs in plain text. These conventions are often used, and also apply to IRIs.  Using these characters in strings intended to be IRIs would result in the IRIs being cut off at the wrong place.</li>
<li>Unwise characters "\" (U+005C), "^" (U+005E), "`" (U+0060), "{" (U+007B), "|" (U+007C), and "}" (U+007D): These characters originally have been excluded from URIs because the respective codepoints are assigned to different graphic characters in some 7-bit or 8-bit encoding. Despite the move to Unicode, some of these characters are still occasionally displayed differently on some systems, e.g. U+005C may appear as a Japanese Yen symbol on some systems. Also, the fact that these characters are not used in URIs or IRIs has encouraged their use outside URIs or IRIs in contexts that may include URIs or IRIs. If a string with such a character were used as an IRI in such a context, it would likely be interpreted piecemeal.</li>
<li>The controls (C0 controls, DEL, and C1 controls, #x0 - #x1F #x7F - #x9F): There is generally no way to transmit these characters reliably as text outside of a charset encoding.  Even when in encoded form, many software components silently filter out some of these characters, or may stop processing alltogether when encountering some of them. These characters may affect text display in subtle, unnoticable ways or in drastic, global, and irreversible ways depending on the hardware and software involved. The use of some of these characters would allow malicious users to manipulate the display of an IRI and its context in many situations.</li>
<li>Bidi formatting characters (U+200E, U+200F, U+202A-202E): These characters affect the display ordering of characters. If IRIs were allowed to contain these characters and the resulting visual display transcribed. they could not be converted back to electronic form (logical order) unambiguously. These characters, if allowed in IRIs, might allow malicious users to manipulate the display of IRI and its context.</li>
<li>Specials (U+FFF0-FFFD): These code points provide functionality beyond that useful in an IRI, for example byte order identification, annotation, and replacements for unknown characters and objects. Their use and interpretation in an IRI would serve no purpose and might lead to confusing display variations.</li>
<li>Private use code points (U+E000-F8FF, U+F0000-FFFFD, U+100000-10FFFD): Display and interpretation of these code points is by definition undefined without private agreement. Therefore, these code points are not suited for use on the Internet. They are not interoperable and may have unpredictable effects.</li>
<li>Tags (U+E0000-E0FFF): These characters provide a way to language tag in Unicode plain text. They are not appropriate for IRIs because language information in identifiers cannot reliably be input, transmitted (e.g. on a visual medium such as paper), or recognized.</li>
<li>Non-characters (U+FDD0-FDEF, U+1FFFE-1FFFF, U+2FFFE-2FFFF, U+3FFFE-3FFFF, U+4FFFE-4FFFF, U+5FFFE-5FFFF, U+6FFFE-6FFFF, U+7FFFE-7FFFF, U+8FFFE-8FFFF, U+9FFFE-9FFFF, U+AFFFE-AFFFF, U+BFFFE-BFFFF, U+CFFFE-CFFFF, U+DFFFE-DFFFF, U+EFFFE-EFFFF, U+FFFFE-FFFFF, U+10FFFE-10FFFF): These code points are defined as non-characters. Applications may use some of them internally, but are not prepared to interchange them.</li>
</ul>
<p id="rfc.section.6.p.3">LEIRI preprocessing disallowed some code points and code units: </p>

<ul class="empty"><li>Surrogate code units (D800-DFFF): These do not represent Unicode codepoints.</li></ul>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#guidelines" id="guidelines">URI/IRI Processing Guidelines (Informative)</a>
</h1>
<p id="rfc.section.7.p.1">This informative section provides guidelines for supporting IRIs in the same software components and operations that currently process URIs: Software interfaces that handle URIs, software that allows users to enter URIs, software that creates or generates URIs, software that displays URIs, formats and protocols that transport URIs, and software that interprets URIs. These may all require modification before functioning properly with IRIs. The considerations in this section also apply to URI references and IRI references.</p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> URI/IRI Software Interfaces</h1>
<p id="rfc.section.7.1.p.1">Software interfaces that handle URIs, such as URI-handling APIs and protocols transferring URIs, need interfaces and protocol elements that are designed to carry IRIs.</p>
<p id="rfc.section.7.1.p.2">In case the current handling in an API or protocol is based on US-ASCII, UTF-8 is recommended as the character encoding for IRIs, as it is compatible with US-ASCII, is in accordance with the recommendations of <a href="#RFC2277">[RFC2277]</a>, and makes converting to URIs easy. In any case, the API or protocol definition must clearly define the character encoding to be used.</p>
<p id="rfc.section.7.1.p.3">The transfer from URI-only to IRI-capable components requires no mapping, although the conversion described in <a href="#URItoIRI">Section 3.7</a> above may be performed. It is preferable not to perform this inverse conversion unless it is certain this can be done correctly.</p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> URI/IRI Entry</h1>
<p id="rfc.section.7.2.p.1">Some components allow users to enter URIs into the system by typing or dictation, for example. This software must be updated to allow for IRI entry.</p>
<p id="rfc.section.7.2.p.2">A person viewing a visual representation of an IRI (as a sequence of glyphs, in some order, in some visual display) or hearing an IRI will use an entry method for characters in the user's language to input the IRI. Depending on the script and the input method used, this may be a more or less complicated process.</p>
<p id="rfc.section.7.2.p.3">The process of IRI entry must ensure, as much as possible, that the restrictions defined in <a href="#abnf">Section 2.2</a> are met. This may be done by choosing appropriate input methods or variants/settings thereof, by appropriately converting the characters being input, by eliminating characters that cannot be converted, and/or by issuing a warning or error message to the user.</p>
<p id="rfc.section.7.2.p.4">As an example of variant settings, input method editors for East Asian Languages usually allow the input of Latin letters and related characters in full-width or half-width versions. For IRI input, the input method editor should be set so that it produces half-width Latin letters and punctuation and full-width Katakana.</p>
<p id="rfc.section.7.2.p.5">An input field primarily or solely used for the input of URIs/IRIs might allow the user to view an IRI as it is mapped to a URI.  Places where the input of IRIs is frequent may provide the possibility for viewing an IRI as mapped to a URI. This will help users when some of the software they use does not yet accept IRIs.</p>
<p id="rfc.section.7.2.p.6">An IRI input component interfacing to components that handle URIs, but not IRIs, must map the IRI to a URI before passing it to these components.</p>
<p id="rfc.section.7.2.p.7">For the input of IRIs with right-to-left characters, please see <a href="#Bidi">[Bidi]</a>.</p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> URI/IRI Transfer between Applications</h1>
<p id="rfc.section.7.3.p.1">Many applications (for example, mail user agents) try to detect URIs appearing in plain text. For this, they use some heuristics based on URI syntax. They then allow the user to click on such URIs and retrieve the corresponding resource in an appropriate (usually scheme-dependent) application.</p>
<p id="rfc.section.7.3.p.2">Such applications would need to be upgraded, in order to use the IRI syntax as a base for heuristics. In particular, a non-ASCII character should not be taken as the indication of the end of an IRI.  Such applications also would need to make sure that they correctly convert the detected IRI from the character encoding of the document or application where the IRI appears, to the character encoding used by the system-wide IRI invocation mechanism, or to a URI (according to <a href="#mapping">Section 3.6</a>) if the system-wide invocation mechanism only accepts URIs.</p>
<p id="rfc.section.7.3.p.3">The clipboard is another frequently used way to transfer URIs and IRIs from one application to another. On most platforms, the clipboard is able to store and transfer text in many languages and scripts.  Correctly used, the clipboard transfers characters, not octets, which will do the right thing with IRIs.</p>
<h1 id="rfc.section.7.4">
<a href="#rfc.section.7.4">7.4.</a> URI/IRI Generation</h1>
<p id="rfc.section.7.4.p.1">Systems that offer resources through the Internet, where those resources have logical names, sometimes automatically generate URIs for the resources they offer. For example, some HTTP servers can generate a directory listing for a file directory and then respond to the generated URIs with the files.</p>
<p id="rfc.section.7.4.p.2">Many legacy character encodings are in use in various file systems.  Many currently deployed systems do not transform the local character representation of the underlying system before generating URIs.</p>
<p id="rfc.section.7.4.p.3">For maximum interoperability, systems that generate resource identifiers should make the appropriate transformations. For example, if a file system contains a file named "r&amp;#xE9;sum&amp;#xE9;.html", a server should expose this as "r%C3%A9sum%C3%A9.html" in a URI, which allows use of "r&amp;#xE9;sum&amp;#xE9;.html" in an IRI, even if locally the file name is kept in a character encoding other than UTF-8.  </p>
<p id="rfc.section.7.4.p.4">This recommendation particularly applies to HTTP servers. For FTP servers, similar considerations apply; see <a href="#RFC2640">[RFC2640]</a>.</p>
<h1 id="rfc.section.7.5">
<a href="#rfc.section.7.5">7.5.</a> <a href="#selection" id="selection">URI/IRI Selection</a>
</h1>
<p id="rfc.section.7.5.p.1">In some cases, resource owners and publishers have control over the IRIs used to identify their resources. This control is mostly executed by controlling the resource names, such as file names, directly.</p>
<p id="rfc.section.7.5.p.2">In these cases, it is recommended to avoid choosing IRIs that are easily confused. For example, for US-ASCII, the lower-case ell ("l") is easily confused with the digit one ("1"), and the upper-case oh ("O") is easily confused with the digit zero ("0"). Publishers should avoid confusing users with "br0ken" or "1ame" identifiers.</p>
<p id="rfc.section.7.5.p.3">Outside the US-ASCII repertoire, there are many more opportunities for confusion; a complete set of guidelines is too lengthy to include here. As long as names are limited to characters from a single script, native writers of a given script or language will know best when ambiguities can appear, and how they can be avoided. What may look ambiguous to a stranger may be completely obvious to the average native user. On the other hand, in some cases, the UCS contains variants for compatibility reasons; for example, for typographic purposes.  These should be avoided wherever possible. Although there may be exceptions, newly created resource names should generally be in NFKC <a href="#UTR15">[UTR15]</a> (which means that they are also in NFC).</p>
<p id="rfc.section.7.5.p.4">As an example, the UCS contains the "fi" ligature at U+FB01 for compatibility reasons.  Wherever possible, IRIs should use the two letters "f" and "i" rather than the "fi" ligature. An example where the latter may be used is in the query part of an IRI for an explicit search for a word written containing the "fi" ligature.</p>
<p id="rfc.section.7.5.p.5">In certain cases, there is a chance that characters from different scripts look the same. The best known example is the similarity of the Latin "A", the Greek "Alpha", and the Cyrillic "A". To avoid such cases, IRIs should only be created where all the characters in a single component are used together in a given language. This usually means that all of these characters will be from the same script, but there are languages that mix characters from different scripts (such as Japanese).  This is similar to the heuristics used to distinguish between letters and numbers in the examples above. Also, for Latin, Greek, and Cyrillic, using lowercase letters results in fewer ambiguities than using uppercase letters would.</p>
<h1 id="rfc.section.7.6">
<a href="#rfc.section.7.6">7.6.</a> <a href="#display" id="display">Display of URIs/IRIs</a>
</h1>
<p id="rfc.section.7.6.p.1">In situations where the rendering software is not expected to display non-ASCII parts of the IRI correctly using the available layout and font resources, these parts should be percent-encoded before being displayed.</p>
<p id="rfc.section.7.6.p.2">For display of Bidi IRIs, please see <a href="#Bidi">[Bidi]</a>.</p>
<h1 id="rfc.section.7.7">
<a href="#rfc.section.7.7">7.7.</a> Interpretation of URIs and IRIs</h1>
<p id="rfc.section.7.7.p.1">Software that interprets IRIs as the names of local resources should accept IRIs in multiple forms and convert and match them with the appropriate local resource names.</p>
<p id="rfc.section.7.7.p.2">First, multiple representations include both IRIs in the native character encoding of the protocol and also their URI counterparts.</p>
<p id="rfc.section.7.7.p.3">Second, it may include URIs constructed based on character encodings other than UTF-8. These URIs may be produced by user agents that do not conform to this specification and that use legacy character encodings to convert non-ASCII characters to URIs. Whether this is necessary, and what character encodings to cover, depends on a number of factors, such as the legacy character encodings used locally and the distribution of various versions of user agents. For example, software for Japanese may accept URIs in Shift_JIS and/or EUC-JP in addition to UTF-8.</p>
<p id="rfc.section.7.7.p.4">Third, it may include additional mappings to be more user-friendly and robust against transmission errors. These would be similar to how some servers currently treat URIs as case insensitive or perform additional matching to account for spelling errors. For characters beyond the US-ASCII repertoire, this may, for example, include ignoring the accents on received IRIs or resource names. Please note that such mappings, including case mappings, are language dependent.</p>
<p id="rfc.section.7.7.p.5">It can be difficult to identify a resource unambiguously if too many mappings are taken into consideration. However, percent-encoded and not percent-encoded parts of IRIs can always be clearly distinguished.  Also, the regularity of UTF-8 (see <a href="#Duerst97">[Duerst97]</a>) makes the potential for collisions lower than it may seem at first.</p>
<h1 id="rfc.section.7.8">
<a href="#rfc.section.7.8">7.8.</a> Upgrading Strategy</h1>
<p id="rfc.section.7.8.p.1">Where this recommendation places further constraints on software for which many instances are already deployed, it is important to introduce upgrades carefully and to be aware of the various interdependencies.</p>
<p id="rfc.section.7.8.p.2">If IRIs cannot be interpreted correctly, they should not be created, generated, or transported. This suggests that upgrading URI interpreting software to accept IRIs should have highest priority.</p>
<p id="rfc.section.7.8.p.3">On the other hand, a single IRI is interpreted only by a single or very few interpreters that are known in advance, although it may be entered and transported very widely.</p>
<p id="rfc.section.7.8.p.4">Therefore, IRIs benefit most from a broad upgrade of software to be able to enter and transport IRIs. However, before an individual IRI is published, care should be taken to upgrade the corresponding interpreting software in order to cover the forms expected to be received by various versions of entry and transport software.</p>
<p id="rfc.section.7.8.p.5">The upgrade of generating software to generate IRIs instead of using a local character encoding should happen only after the service is upgraded to accept IRIs. Similarly, IRIs should only be generated when the service accepts IRIs and the intervening infrastructure and protocol is known to transport them safely.</p>
<p id="rfc.section.7.8.p.6">Software converting from URIs to IRIs for display should be upgraded only after upgraded entry software has been widely deployed to the population that will see the displayed result.</p>
<p id="rfc.section.7.8.p.7">Where there is a free choice of character encodings, it is often possible to reduce the effort and dependencies for upgrading to IRIs by using UTF-8 rather than another encoding. For example, when a new file-based Web server is set up, using UTF-8 as the character encoding for file names will make the transition to IRIs easier. Likewise, when a new Web form is set up using UTF-8 as the character encoding of the form page, the returned query URIs will use UTF-8 as the character encoding (unless the user, for whatever reason, changes the character encoding) and will therefore be compatible with IRIs.</p>
<p id="rfc.section.7.8.p.8">These recommendations, when taken together, will allow for the extension from URIs to IRIs in order to handle characters other than US-ASCII while minimizing interoperability problems. For considerations regarding the upgrade of URI scheme definitions, see <a href="#UTF8use">Section 4.4</a>.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.8.p.1">RFC Editor and IANA note: Please Replace RFC XXXX with the number of this document when it issues as an RFC. </p>
<p id="rfc.section.8.p.2">IANA maintains a registry of "URI schemes". A "URI scheme" also serves an "IRI scheme". </p>
<p id="rfc.section.8.p.3">To clarify that the URI scheme registration process also applies to IRIs, change the description of the "URI schemes" registry header to say "[RFC4395] defines an IANA-maintained registry of URI Schemes. These registries include the Permanent and Provisional URI Schemes.  RFC XXXX updates this registry to designate that schemes may also indicate their usability as IRI schemes.</p>
<p id="rfc.section.8.p.4">Update "per RFC 4395" to "per RFC 4395 and RFC XXXX".  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.9.p.1">The security considerations discussed in <a href="#RFC3986">[RFC3986]</a> also apply to IRIs. In addition, the following issues require particular care for IRIs.</p>
<p id="rfc.section.9.p.2">Incorrect encoding or decoding can lead to security problems.  For example, some UTF-8 decoders do not check against overlong byte sequences. See <a href="#UTR36">[UTR36]</a> Section 3 for details.</p>
<p id="rfc.section.9.p.3">There are serious difficulties with relying on a human to verify that a an IRI (whether presented visually or aurally) is the same as another IRI or is the one intended.  These problems exist with ASCII-only URIs (bl00mberg.com vs. bloomberg.com) but are strongly exacerbated when using the much larger character repertoire of Unicode.  For details, see Section 2 of <a href="#UTR36">[UTR36]</a>.  Using administrative and technical means to reduce the availability of such exploits is possible, but they are difficult to eliminate altogether.  User agents SHOULD NOT rely on visual or perceptual comparison or verification of IRIs as a means of validating or assuring safety, correctness or appropriateness of an IRI.  Other means of presenting users with the validity, safety, or appropriateness of visited sites are being developed in the browser community as an alternative means of avoiding these difficulties.</p>
<p id="rfc.section.9.p.4">Besides the large character repertoire of Unicode, reasons for confusion include different forms of normalization and different normalization expectations, use of percent-encoding with various legacy encodings, and bidirectionality issues. See also <a href="#Bidi">[Bidi]</a>.</p>
<p id="rfc.section.9.p.5">Confusion can occur in various IRI components, such as the domain name part or the path part, or between IRI components. For considerations specific to the domain name part, see <a href="#RFC5890">[RFC5890]</a>. For considerations specific to particular protocols or schemes, see the security sections of the relevant specifications and registration templates.  Administrators of sites that allow independent users to create resources in the same sub area have to be careful.  Details are discussed in <a href="#selection">Section 7.5</a>.</p>
<p id="rfc.section.9.p.6">The characters additionally allowed in Legacy Extended IRIs introduce additional security issues. For details, see <a href="#notAllowed">Section 6</a>.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Acknowledgements</h1>
<p id="rfc.section.10.p.1">This document was derived from <a href="#RFC3987">[RFC3987]</a>; the acknowledgments from that specification still apply.</p>
<p id="rfc.section.10.p.2">In addition, this document was influenced by contributions from (in no particular order)Norman Walsh, Richard Tobin, Henry S. Thomson, John Cowan, Paul Grosso, the XML Core Working Group of the W3C, Chris Lilley, Bjoern Hoehrmann, Felix Sasaki, Jeremy Carroll, Frank Ellermann, Michael Everson, Cary Karp, Matitiahu Allouche, Richard Ishida, Addison Phillips, Jonathan Rosenne, Najib Tounsi, Debbie Garside, Mark Davis, Sarmad Hussain, Ted Hardie, Konrad Lanz, Thomas Roessler, Lisa Dusseault, Julian Reschke, Giovanni Campagna, Anne van Kesteren, Mark Nottingham, Erik van der Poel, Marcin Hanclik, Marcos Caceres, Roy Fielding, Greg Wilkins, Pieter Hintjens, Daniel R. Tobias, Marko Martin, Maciej Stanchowiak, Wil Tan, Yui Naruse, Michael A. Puls II, Dave Thaler, Tom Petch, John Klensin, Shawn Steele, Peter Saint-Andre, Geoffrey Sneddon, Chris Weber, Alex Melnikov, Slim Amamou, S. Moonesamy, Tim Berners-Lee, Yaron Goland, Sam Ruby, Adam Barth, Abdulrahman I. ALGhadir, Aharon Lanin, Thomas Milo, Murray Sargent, Marc Blanchet, and Mykyta Yevstifeyev.</p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> Main Changes Since RFC 3987</h1>
<p id="rfc.section.11.p.1">This section describes the main changes since <a href="#RFC3987">[RFC3987]</a>.</p>
<h1 id="rfc.section.11.1">
<a href="#rfc.section.11.1">11.1.</a> Split out Bidi, processing guidelines, comparison sections</h1>
<p id="rfc.section.11.1.p.1">Move some components (comparison, bidi, processing) into separate documents.</p>
<h1 id="rfc.section.11.2">
<a href="#rfc.section.11.2">11.2.</a> <a href="#forkChanges" id="forkChanges">Major restructuring of IRI processing model</a>
</h1>
<p id="rfc.section.11.2.p.1">Major restructuring of IRI processing model to make scheme-specific translation necessary to handle IDNA requirements and for consistency with web implementations. </p>
<p id="rfc.section.11.2.p.2">Starting with IRI, you want one of: </p>

<dl>
<dt>a</dt>
<dd style="margin-left: 8">IRI components (IRI parsed into UTF8 pieces)</dd>
<dt>b</dt>
<dd style="margin-left: 8">URI components (URI parsed into ASCII pieces, encoded correctly) </dd>
<dt>c</dt>
<dd style="margin-left: 8">whole URI  (for passing on to some other system that wants whole URIs) </dd>
</dl>
<h1 id="rfc.section.11.2.1">
<a href="#rfc.section.11.2.1">11.2.1.</a> OLD WAY</h1>
<p></p>

<ol>
<li>Pct-encoding on the whole thing to a URI.  (c1) If you want a (maybe broken) whole URI, you might stop here.</li>
<li>Parsing the URI into URI components.  (b1) If you want (maybe broken) URI components, stop here.</li>
<li>Decode the components (undoing the pct-encoding).  (a) if you want IRI components, stop here.</li>
<li>reencode:  Either using a different encoding some components (for domain names, and query components in web pages, which depends on the component, scheme and context), and otherwise using pct-encoding.  (b2) if you want (good) URI components, stop here.</li>
<li>reassemble the reencoded components.  (c2) if you want a (*good*) whole URI stop here.</li>
</ol>

<p> </p>
<h1 id="rfc.section.11.2.2">
<a href="#rfc.section.11.2.2">11.2.2.</a> NEW WAY</h1>
<p></p>

<ol>
<li>Parse the IRI into IRI components using the generic syntax.  (a) if you want IRI components, stop here.</li>
<li>Encode each components, using pct-encoding, IDN encoding, or special query part encoding depending on the component scheme or context. (b) If you want URI components, stop here.</li>
<li>reassemble the a whole URI from URI components.  (c) if you want a whole URI stop here.</li>
</ol>
<h1 id="rfc.section.11.2.3">
<a href="#rfc.section.11.2.3">11.2.3.</a> Extension of Syntax</h1>
<p id="rfc.section.11.2.3.p.1">Added the tag range (U+E0000-E0FFF) to the iprivate production.  Some IRIs generated with the new syntax may fail to pass very strict checks relying on the old syntax. But characters in this range should be extremely infrequent anyway.</p>
<h1 id="rfc.section.11.2.4">
<a href="#rfc.section.11.2.4">11.2.4.</a> More to be added</h1>
<p id="rfc.section.11.2.4.p.1">TODO: There are more main changes that need to be documented in this section.</p>
<h1 id="rfc.section.11.3">
<a href="#rfc.section.11.3">11.3.</a> Change Log</h1>
<p id="rfc.section.11.3.p.1">Note to RFC Editor: Please completely remove this section before publication.</p>
<h1 id="rfc.section.11.3.1">
<a href="#rfc.section.11.3.1">11.3.1.</a> Changes after draft-ietf-iri-3987bis-01</h1>
<p id="rfc.section.11.3.1.p.1">Changes from draft-ietf-iri-3987bis-01 onwards are available as changesets in the IETF tools subversion repository at http://trac.tools.ietf.org/wg/iri/trac/log/draft-ietf-iri-3987bis/draft-ietf-iri-3987bis.xml.</p>
<h1 id="rfc.section.11.3.2">
<a href="#rfc.section.11.3.2">11.3.2.</a> Changes from draft-duerst-iri-bis-07 to draft-ietf-iri-3987bis-00</h1>
<p id="rfc.section.11.3.2.p.1">Changed draft name, date, last paragraph of abstract, and titles in change log, and added this section in moving from draft-duerst-iri-bis-07 (personal submission) to draft-ietf-iri-3987bis-00 (WG document).</p>
<h1 id="rfc.section.11.3.3">
<a href="#rfc.section.11.3.3">11.3.3.</a> Changes from -06 to -07 of draft-duerst-iri-bis</h1>
<p id="rfc.section.11.3.3.p.1">Major restructuring of the processing model, see <a href="#forkChanges">Section 11.2</a>.</p>
<h1 id="rfc.section.11.4">
<a href="#rfc.section.11.4">11.4.</a> Changes from -00 to -01</h1>
<p></p>

<ul>
<li>Removed 'mailto:' before mail addresses of authors.</li>
<li>Added "&lt;to be done&gt;" as right side of 'href-strip' rule. Fixed '|' to '/' for alternatives.</li>
</ul>
<h1 id="rfc.section.11.5">
<a href="#rfc.section.11.5">11.5.</a> Changes from -05 to -06 of draft-duerst-iri-bis-00</h1>
<p></p>

<ul>
<li>Add HyperText Reference, change abstract, acks and references for it</li>
<li>Add Masinter back as another editor.</li>
<li>Masinter integrates HRef material from HTML5 spec.</li>
<li>Rewrite introduction sections to modernize.</li>
</ul>
<h1 id="rfc.section.11.6">
<a href="#rfc.section.11.6">11.6.</a> Changes from -04 to -05 of draft-duerst-iri-bis</h1>
<p></p>

<ul>
<li>Updated references.</li>
<li>Changed IPR text to pre5378Trust200902.</li>
</ul>
<h1 id="rfc.section.11.7">
<a href="#rfc.section.11.7">11.7.</a> Changes from -03 to -04 of draft-duerst-iri-bis</h1>
<p></p>

<ul>
<li>Added explicit abbreviation for LEIRIs.</li>
<li>Mentioned LEIRI references.</li>
<li>Completed text in LEIRI section about tag characters and about specials.</li>
</ul>
<h1 id="rfc.section.11.8">
<a href="#rfc.section.11.8">11.8.</a> Changes from -02 to -03 of draft-duerst-iri-bis</h1>
<p></p>

<ul>
<li>Updated some references.</li>
<li>Updated Michel Suginard's coordinates.</li>
</ul>
<h1 id="rfc.section.11.9">
<a href="#rfc.section.11.9">11.9.</a> Changes from -01 to -02 of draft-duerst-iri-bis</h1>
<p></p>

<ul>
<li>Added tag range to iprivate (issue private-include-tags-115).</li>
<li>Added Specials (U+FFF0-FFFD) to Legacy Extended IRIs.</li>
</ul>
<h1 id="rfc.section.11.10">
<a href="#rfc.section.11.10">11.10.</a> Changes from -00 to -01 of draft-duerst-iri-bis</h1>
<p></p>

<ul>
<li>Changed from "IRIs with Spaces/Controls" to "Legacy Extended IRI" based on input from the W3C XML Core WG.  Moved the relevant subsections to the back and promoted them to a section.</li>
<li>Added some text re. Legacy Extended IRIs to the security section.</li>
<li>Added a IANA Consideration Section.</li>
<li>Added this Change Log Section.</li>
<li>Added a section about "IRIs with Spaces/Controls" (converting from a Note in RFC 3987).</li>
</ul>
<h1 id="rfc.section.11.11">
<a href="#rfc.section.11.11">11.11.</a> Changes from RFC 3987 to -00 of draft-duerst-iri-bis</h1>
<p></p>

<ul class="empty"><li>Fixed errata (see http://www.rfc-editor.org/cgi-bin/errataSearch.pl?rfc=3987).</li></ul>
<h1 id="rfc.references">
<a href="#rfc.references">12.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">12.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="ASCII">[ASCII]</b></td>
<td class="top">
<a>American National Standards Institute</a>, "<a>Coded Character Set -- 7-bit American Standard Code for Information Interchange</a>", ANSI X3.4, 1986.</td>
</tr>
<tr>
<td class="reference"><b id="ISO10646">[ISO10646]</b></td>
<td class="top">
<a>International Organization for Standardization</a>, "<a>ISO/IEC 10646:2003: Information Technology - Universal Multiple-Octet Coded Character Set (UCS)</a>", ISO Standard 10646, December 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3490">[RFC3490]</b></td>
<td class="top">
<a>Faltstrom, P.</a>, <a>Hoffman, P.</a> and <a>A. Costello</a>, "<a href="http://tools.ietf.org/html/rfc3490">Internationalizing Domain Names in Applications (IDNA)</a>", RFC 3490, March 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3491">[RFC3491]</b></td>
<td class="top">
<a>Hoffman, P.</a> and <a>M. Blanchet</a>, "<a href="http://tools.ietf.org/html/rfc3491">Nameprep: A Stringprep Profile for Internationalized Domain Names (IDN)</a>", RFC 3491, March 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3629">[RFC3629]</b></td>
<td class="top">
<a>Yergeau, F.</a>, "<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>", STD 63, RFC 3629, November 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a href="mailto:timbl@w3.org" title="World Wide Web Consortium">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com" title="Day Software">Fielding, R.</a> and <a href="mailto:LMM@acm.org" title="Adobe Systems Incorporated">L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="STD68">[STD68]</b></td>
<td class="top">
<a>Crocker, D.</a> and <a>P. Overell</a>, "<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>", STD 68, RFC 5234, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5890">[RFC5890]</b></td>
<td class="top">
<a>Klensin, J.</a>, "<a href="http://tools.ietf.org/html/rfc5890">Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework</a>", RFC 5890, August 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5891">[RFC5891]</b></td>
<td class="top">
<a>Klensin, J.</a>, "<a href="http://tools.ietf.org/html/rfc5891">Internationalized Domain Names in Applications (IDNA): Protocol</a>", RFC 5891, August 2010.</td>
</tr>
<tr>
<td class="reference"><b id="UNIV6">[UNIV6]</b></td>
<td class="top">
<a>The Unicode Consortium</a>, "<a>The Unicode Standard, Version 6.0.0 (Mountain View, CA, The Unicode Consortium, 2011, ISBN 978-1-936213-01-6)</a>", October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="UTR15">[UTR15]</b></td>
<td class="top">
<a>Davis, M.</a> and <a>M.J. Duerst</a>, "<a>Unicode Normalization Forms</a>", Unicode Standard Annex #15, March 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">12.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="CharMod">[CharMod]</b></td>
<td class="top">
<a>Duerst, M.</a>, <a>Yergeau, F.</a>, <a>Ishida, R.</a>, <a>Wolf, M.</a> and <a>T. Texin</a>, "<a>Character Model for the World Wide Web: Resource Identifiers</a>", World Wide Web Consortium Candidate Recommendation, November 2004.</td>
</tr>
<tr>
<td class="reference"><b id="Duerst97">[Duerst97]</b></td>
<td class="top">
<a>Duerst, M.J.</a>, "<a>The Properties and Promises of UTF-8</a>", Proc. 11th International Unicode Conference, San Jose , September 1997.</td>
</tr>
<tr>
<td class="reference"><b id="Gettys">[Gettys]</b></td>
<td class="top">
<a>Gettys, J.</a>, "<a>URI Model Consequences</a>", .</td>
</tr>
<tr>
<td class="reference"><b id="HTML4">[HTML4]</b></td>
<td class="top">
<a>Raggett, D.</a>, <a>Le Hors, A.</a> and <a>I. Jacobs</a>, "<a>HTML 4.01 Specification</a>", World Wide Web Consortium Recommendation, December 1999.</td>
</tr>
<tr>
<td class="reference"><b id="LEIRI">[LEIRI]</b></td>
<td class="top">
<a>Thompson, H.</a>, <a>Tobin, R.</a> and <a>N. Walsh</a>, "<a>Legacy extended IRIs for XML resource identification</a>", World Wide Web Consortium Note, November 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2045">[RFC2045]</b></td>
<td class="top">
<a href="mailto:ned@innosoft.com" title="Innosoft International, Inc.">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com" title="First Virtual Holdings">N.S. Borenstein</a>, "<a href="http://tools.ietf.org/html/rfc2045">Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</a>", RFC 2045, November 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2130">[RFC2130]</b></td>
<td class="top">
<a href="mailto:cweider@microsoft.com" title="Microsoft Corp.">Weider, C.</a>, <a href="mailto:cecilia@well.com" title="Preston &amp; Lynch">Preston, C.</a>, <a href="mailto:Keld@dkuug.dk" title="DKUUG">Simonsen, K.</a>, <a href="mailto:Harald.T.Alvestrand@uninett.no" title="UNINETT">Alvestrand, H.T.</a>, <a href="mailto:rja@cisco.com" title="cisco Systems">Atkinson, R.</a>, <a href="mailto:mrc@cac.washington.edu" title="Networks &amp; Distributed Computing">Crispin, M.</a> and <a href="mailto:psv@nada.kth.se" title="Dept. of Numberical Analysis and Computing Science (Nada)">P. Svanberg</a>, "<a href="http://tools.ietf.org/html/rfc2130">The Report of the IAB Character Set Workshop held 29 February - 1 March, 1996</a>", RFC 2130, April 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2141">[RFC2141]</b></td>
<td class="top">
<a href="mailto:jayhawk@ds.internic.net" title="AT&amp;T">Moats, R.</a>, "<a href="http://tools.ietf.org/html/rfc2141">URN Syntax</a>", RFC 2141, May 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2192">[RFC2192]</b></td>
<td class="top">
<a href="mailto:chris.newman@innosoft.com" title="Innosoft International, Inc.">Newman, C.</a>, "<a href="http://tools.ietf.org/html/rfc2192">IMAP URL Scheme</a>", RFC 2192, September 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2277">[RFC2277]</b></td>
<td class="top">
<a href="mailto:Harald.T.Alvestrand@uninett.no" title="UNINETT">Alvestrand, H.T.</a>, "<a href="http://tools.ietf.org/html/rfc2277">IETF Policy on Character Sets and Languages</a>", BCP 18, RFC 2277, January 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2368">[RFC2368]</b></td>
<td class="top">
<a href="mailto:phoffman@imc.org" title="Internet Mail Consortium">Hoffman, P.E.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox Corporation">Masinter, L.</a> and <a href="mailto:jwz@netscape.com" title="Netscape Communications Corp.">J. Zawinski</a>, "<a href="http://tools.ietf.org/html/rfc2368">The mailto URL scheme</a>", RFC 2368, July 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2384">[RFC2384]</b></td>
<td class="top">
<a href="mailto:Randy@Qualcomm.Com" title="QUALCOMM, Incorporated">Gellens, R.</a>, "<a href="http://tools.ietf.org/html/rfc2384">POP URL Scheme</a>", RFC 2384, August 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2396">[RFC2396]</b></td>
<td class="top">
<a href="mailto:timbl@w3.org" title="World Wide Web Consortium">Berners-Lee, T.</a>, <a href="mailto:fielding@ics.uci.edu" title="Department of Information and Computer Science">Fielding, R.T.</a> and <a href="mailto:masinter@parc.xerox.com" title="Xerox PARC">L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc2396">Uniform Resource Identifiers (URI): Generic Syntax</a>", RFC 2396, August 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2397">[RFC2397]</b></td>
<td class="top">
<a href="mailto:masinter@parc.xerox.com" title="Xerox Palo Alto Research Center">Masinter, L.</a>, "<a href="http://tools.ietf.org/html/rfc2397">The "data" URL scheme</a>", RFC 2397, August 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2616">[RFC2616]</b></td>
<td class="top">
<a href="mailto:fielding@ics.uci.edu" title="Department of Information and Computer Science">Fielding, R.</a>, <a href="mailto:jg@w3.org" title="World Wide Web Consortium">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com" title="Compaq Computer Corporation">Mogul, J.</a>, <a href="mailto:frystyk@w3.org" title="World Wide Web Consortium">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox Corporation">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.</a> and <a href="mailto:timbl@w3.org" title="World Wide Web Consortium">T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2616, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2640">[RFC2640]</b></td>
<td class="top">
<a href="mailto:curtinw@ftm.disa.mil" title="JIEO">Curtin, B.</a>, "<a href="http://tools.ietf.org/html/rfc2640">Internationalization of the File Transfer Protocol</a>", RFC 2640, July 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3987">[RFC3987]</b></td>
<td class="top">
<a>Duerst, M.</a> and <a>M. Suignard</a>, "<a href="http://tools.ietf.org/html/rfc3987">Internationalized Resource Identifiers (IRIs)</a>", RFC 3987, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6055">[RFC6055]</b></td>
<td class="top">
<a>Thaler, D.</a>, <a>Klensin, J.</a> and <a>S. Cheshire</a>, "<a href="http://tools.ietf.org/html/rfc6055">IAB Thoughts on Encodings for Internationalized Domain Names</a>", RFC 6055, February 2011.</td>
</tr>
<tr>
<td class="reference"><b id="Bidi">[Bidi]</b></td>
<td class="top">
<a>Duerst, M.</a> and <a>L. Masinter</a>, "<a href="http://tools.ietf.org/html/draft-ietf-iri-bidi-guidelines-00">Guidelines for Internationalized Resource Identifiers with Bi-directional Characters (Bidi IRIs)</a>", Internet-Draft draft-ietf-iri-bidi-guidelines-00, August 2011.</td>
</tr>
<tr>
<td class="reference"><b id="Equivalence">[Equivalence]</b></td>
<td class="top">
<a>Masinter, L.</a> and <a>M. Duerst</a>, "<a href="http://tools.ietf.org/html/draft-ietf-iri-comparison-00">Equivalence and Canonicalization of Internationalized Resource Identifiers (IRIs)</a>", Internet-Draft draft-ietf-iri-comparison-00, August 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4395bis">[RFC4395bis]</b></td>
<td class="top">
<a>Hansen, T.</a>, <a>Hardie, T.</a> and <a>L. Masinter</a>, "<a href="http://tools.ietf.org/html/draft-ietf-iri-4395bis-irireg-03">Guidelines and Registration Procedures for New URI/IRI Schemes</a>", Internet-Draft draft-ietf-iri-4395bis-irireg-03, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="UNIXML">[UNIXML]</b></td>
<td class="top">
<a>Duerst, M.J.</a> and <a>A. Freytag</a>, "<a>Unicode in XML and other Markup Languages</a>", Unicode Technical Report #20, World Wide Web Consortium Note, June 2003.</td>
</tr>
<tr>
<td class="reference"><b id="UTR36">[UTR36]</b></td>
<td class="top">
<a>Davis, M.</a> and <a>M. Suignard</a>, "<a>Unicode Security Considerations</a>", Unicode Technical Report #36, August 2010.</td>
</tr>
<tr>
<td class="reference"><b id="XLink">[XLink]</b></td>
<td class="top">
<a>DeRose, S.</a>, <a>Maler, E.</a> and <a>D. Orchard</a>, "<a>XML Linking Language (XLink) Version 1.0</a>", World Wide Web Consortium Recommendation, June 2001.</td>
</tr>
<tr>
<td class="reference"><b id="XML1">[XML1]</b></td>
<td class="top">
<a>Bray, T.</a>, <a>Paoli, J.</a>, <a>Sperberg-McQueen, C.M.</a>, <a>Maler, E.</a> and <a>F. Yergeau</a>, "<a>Extensible Markup Language (XML) 1.0 (Forth Edition)</a>", World Wide Web Consortium Recommendation, August 2006.</td>
</tr>
<tr>
<td class="reference"><b id="XMLNamespace">[XMLNamespace]</b></td>
<td class="top">
<a>Bray, T.</a>, <a>Hollander, D.</a>, <a>Layman, A.</a> and <a>R. Tobin</a>, "<a>Namespaces in XML (Second Edition)</a>", World Wide Web Consortium Recommendation, August 2006.</td>
</tr>
<tr>
<td class="reference"><b id="XMLSchema">[XMLSchema]</b></td>
<td class="top">
<a>Biron, P.</a> and <a>A. Malhotra</a>, "<a>XML Schema Part 2: Datatypes</a>", World Wide Web Consortium Recommendation, May 2001.</td>
</tr>
<tr>
<td class="reference"><b id="XPointer">[XPointer]</b></td>
<td class="top">
<a>Grosso, P.</a>, <a>Maler, E.</a>, <a>Marsh, J.</a> and <a>N. Walsh</a>, "<a>XPointer Framework</a>", World Wide Web Consortium Recommendation, March 2003.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Martin Duerst</span> 
	  <span class="n hidden">
		<span class="family-name">Duerst</span>
	  </span>
	</span>
	<span class="org vcardline">Aoyama Gakuin University</span>
	<span class="adr">
	  <span>5-10-1 Fuchinobe</span>

	  <span class="vcardline">
		<span class="locality">Sagamihara</span>,  
		<span class="region">Kanagawa</span> 
		<span class="code">229-8558</span>
	  </span>
	  <span class="country-name vcardline">Japan</span>
	</span>
	<span class="vcardline">Phone: +81 42 759 6329</span>

<span class="vcardline">EMail: <a href="mailto:duerst@it.aoyama.ac.jp">duerst@it.aoyama.ac.jp</a></span>

<span class="vcardline">URI: <a href="http://www.sw.it.aoyama.ac.jp/D%C3%BCrst/">http://www.sw.it.aoyama.ac.jp/D%C3%BCrst/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Michel Suignard</span> 
	  <span class="n hidden">
		<span class="family-name">Suignard</span>
	  </span>
	</span>
	<span class="org vcardline">Unicode Consortium</span>
	<span class="adr">
	  <span>P.O. Box 391476</span>

	  <span class="vcardline">
		<span class="locality">Mountain View</span>,  
		<span class="region">CA</span> 
		<span class="code">94039-1476</span>
	  </span>
	  <span class="country-name vcardline">U.S.A.</span>
	</span>
	<span class="vcardline">Phone: +1-650-693-3921</span>

<span class="vcardline">EMail: <a href="mailto:michel@unicode.org">michel@unicode.org</a></span>

<span class="vcardline">URI: <a href="http://www.suignard.com">http://www.suignard.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Larry Masinter</span> 
	  <span class="n hidden">
		<span class="family-name">Masinter</span>
	  </span>
	</span>
	<span class="org vcardline">Adobe</span>
	<span class="adr">
	  <span>345 Park Ave</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95110</span>
	  </span>
	  <span class="country-name vcardline">U.S.A.</span>
	</span>
	<span class="vcardline">Phone: +1-408-536-3024</span>

<span class="vcardline">EMail: <a href="mailto:masinter@adobe.com">masinter@adobe.com</a></span>

<span class="vcardline">URI: <a href="http://larry.masinter.net">http://larry.masinter.net</a></span>

  </address>
</div>

</body>
</html>