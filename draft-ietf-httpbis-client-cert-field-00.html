<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Client-Cert HTTP Header Field: Conveying Client Certificate Information from TLS Terminating Reverse Proxies to Origin Server Applications</title>
<meta content="Brian Campbell" name="author">
<meta content="Mike Bishop" name="author">
<meta content="
       This document defines the HTTP header field  Client-Cert  that allows a TLS
terminating reverse proxy to convey the client certificate of a
mutually-authenticated TLS connection to the origin server in a common and
predictable manner. 
    " name="description">
<meta content="xml2rfc 3.8.0" name="generator">
<meta content="http" name="keyword">
<meta content="client certificate" name="keyword">
<meta content="draft-ietf-httpbis-client-cert-field-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.8.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 57.0.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-httpbis-client-cert-field-00-nv_ybt8m.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Client-Cert Field</td>
<td class="right">June 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Campbell &amp; Bishop</td>
<td class="center">Expires 10 December 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">HTTP</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-httpbis-client-cert-field-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-06-08" class="published">8 June 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-12-10">10 December 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">B. Campbell</div>
<div class="org">Ping Identity</div>
</div>
<div class="author">
      <div class="author-name">M. Bishop, <span class="editor">Ed.</span>
</div>
<div class="org">Akamai</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Client-Cert HTTP Header Field: Conveying Client Certificate Information from TLS Terminating Reverse Proxies to Origin Server Applications</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the HTTP header field <code>Client-Cert</code> that allows a TLS
terminating reverse proxy to convey the client certificate of a
mutually-authenticated TLS connection to the origin server in a common and
predictable manner.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-note-to-readers">
<a href="#name-note-to-readers" class="section-name selfRef">Note to Readers</a>
      </h2>
<p id="section-note.1-1"><em>RFC EDITOR: please remove this section before publication</em><a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this draft takes place on the HTTP working group mailing list (ietf-http-wg@w3.org), which is archived at <a href="https://lists.w3.org/Archives/Public/ietf-http-wg/">https://lists.w3.org/Archives/Public/ietf-http-wg/</a>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Working Group information can be found at <a href="http://httpwg.github.io/">http://httpwg.github.io/</a>; source code and issues list for this draft can be found at <a href="https://github.com/httpwg/http-extensions/labels/client-cert-header">https://github.com/httpwg/http-extensions/labels/client-cert-header</a>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 10 December 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-notation-and-c" class="xref">Requirements Notation and Conventions</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-http-header-field-and-proce" class="xref">HTTP Header Field and Processing Rules</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-encoding" class="xref">Encoding</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-client-cert-http-header-fie" class="xref">Client-Cert HTTP Header Field</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-processing-rules" class="xref">Processing Rules</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-example" class="xref">Example</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-considerations-considered" class="xref">Considerations Considered</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-header-injection" class="xref">Header Injection</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-the-forwarded-http-extensio" class="xref">The Forwarded HTTP Extension</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-b.3" class="xref">B.3</a>.  <a href="#name-the-whole-certificate-and-o" class="xref">The Whole Certificate and Only the Whole Certificate</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-appendix.c" class="xref">Appendix C</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-appendix.d" class="xref">Appendix D</a>.  <a href="#name-document-history" class="xref">Document History</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.e" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A fairly common deployment pattern for HTTPS applications is to have the origin
HTTP application servers sit behind a reverse proxy that terminates TLS
connections from clients. The proxy is accessible to the internet and dispatches
client requests to the appropriate origin server within a private or protected
network. The origin servers are not directly accessible by clients and are only
reachable through the reverse proxy. The backend details of this type of
deployment are typically opaque to clients who make requests to the proxy server
and see responses as though they originated from the proxy server itself.
Although HTTPS is also usually employed between the proxy and the origin server,
the TLS connection that the client establishes for HTTPS is only between itself
and the reverse proxy server.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The deployment pattern is found in a number of varieties such as n-tier
architectures, content delivery networks, application load balancing services,
and ingress controllers.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Although not exceedingly prevalent, TLS client certificate authentication is
sometimes employed and in such cases the origin server often requires
information about the client certificate for its application logic. Such logic
might include access control decisions, audit logging, and binding issued tokens
or cookies to a certificate, and the respective validation of such bindings. The
specific details from the certificate needed also vary with the application
requirements. In order for these types of application deployments to work in
practice, the reverse proxy needs to convey information about the client
certificate to the origin application server. A common way this information is
conveyed in practice today is by using non-standard headers to carry the
certificate (in some encoding) or individual parts thereof in the HTTP request
that is dispatched to the origin server. This solution works but
interoperability between independently developed components can be cumbersome or
even impossible depending on the implementation choices respectively made (like
what header names are used or are configurable, which parts of the certificate
are exposed, or how the certificate is encoded). A well-known predictable
approach to this commonly occurring functionality could improve and simplify
interoperability between independent implementations.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document aspires to standardize an HTTP header field named <code>Client-Cert</code>
that a TLS terminating reverse proxy (TTRP) adds to requests that it sends to
the backend origin servers. The header value contains the client certificate
from the mutually-authenticated TLS connection between the originating client
and the TTRP. This enables the backend origin server to utilize the client
certificate information in its application logic. While there may be additional
proxies or hops between the TTRP and the origin server (potentially even with
mutually-authenticated TLS connections between them), the scope of the
<code>Client-Cert</code> header is intentionally limited to exposing to the origin server
the certificate that was presented by the originating client in its connection
to the TTRP.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="requirements-notation-and-conventions">
<section id="section-1.1">
        <h3 id="name-requirements-notation-and-c">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-notation-and-c" class="section-name selfRef">Requirements Notation and Conventions</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">Phrases like TLS client certificate authentication or mutually-authenticated TLS
are used throughout this document to refer to the process whereby, in addition
to the normal TLS server authentication with a certificate, a client presents
its X.509 certificate <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> and proves possession of the corresponding
private key to a server when negotiating a TLS connection or the resumption of
such a connection.  In contemporary versions of TLS <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> this
requires that the client send the Certificate and CertificateVerify messages
during the handshake and for the server to verify the CertificateVerify and
Finished messages.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-2.1">TODO: HTTP2 forbids TLS renegotiation and post-handshake authentication but it's
possible with HTTP1.1 and maybe needs to be discussed explicitly here or
somewhere in this document? Naively I'd say that the <code>Client-Cert</code> header will
be sent with the data of the most recent client cert anytime after renegotiation
or post-handshake auth. And only for requests that are fully covered by the cert
but that in practice making the determination of where exactly in the
application data the cert messages arrived is hard to impossible so it'll be a
best effort kind of thing.<a href="#section-1.2-2.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="http-header-field-and-processing-rules">
<section id="section-2">
      <h2 id="name-http-header-field-and-proce">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-http-header-field-and-proce" class="section-name selfRef">HTTP Header Field and Processing Rules</a>
      </h2>
<div id="encoding">
<section id="section-2.1">
        <h3 id="name-encoding">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-encoding" class="section-name selfRef">Encoding</a>
        </h3>
<p id="section-2.1-1">The field-values of the HTTP header defined herein utilize the following encoded
form.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">A certificate is represented in text as an <code>EncodedCertificate</code>, which is the
base64-encoded (Section 4 of <span>[<a href="#RFC4648" class="xref">RFC4648</a>]</span>) DER <span>[<a href="#ITU.X690.1994" class="xref">ITU.X690.1994</a>]</span> PKIX certificate. The
encoded value MUST NOT include any line breaks, whitespace, or other additional
characters. ABNF <span>[<a href="#RFC5234" class="xref">RFC5234</a>]</span> syntax for <code>EncodedCertificate</code> is shown in the
figure below.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.1-3">
<pre>
 EncodedCertificate = 1*( DIGIT / ALPHA / "+" / "/" ) 0*2"="

 DIGIT = &lt;Defined in Section B.1 of [RFC5234]&gt;  ; A-Z / a-z
 ALPHA = &lt;Defined in Section B.1 of [RFC5234]&gt;  ; 0-9
</pre><a href="#section-2.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="header">
<section id="section-2.2">
        <h3 id="name-client-cert-http-header-fie">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-client-cert-http-header-fie" class="section-name selfRef">Client-Cert HTTP Header Field</a>
        </h3>
<p id="section-2.2-1">In the context of a TLS terminating reverse proxy (TTRP) deployment, the TTRP
makes the TLS client certificate available to the backend application with the
following header field.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-2">
          <dt id="section-2.2-2.1">
Client-Cert:  </dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.2">
            <p id="section-2.2-2.2.1">The end-entity client certificate as an <code>EncodedCertificate</code> value.<a href="#section-2.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-3">The <code>Client-Cert</code> header field defined herein is only for use in HTTP requests
and MUST NOT be used in HTTP responses.  It is a single HTTP header field-value
as defined in Section 3.2 of <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span>, which MUST NOT have a list of values or
occur multiple times in a request.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-rules">
<section id="section-2.3">
        <h3 id="name-processing-rules">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-processing-rules" class="section-name selfRef">Processing Rules</a>
        </h3>
<p id="section-2.3-1">This section outlines the applicable processing rules for a TLS terminating
reverse proxy (TTRP) that has negotiated a mutually-authenticated TLS connection
to convey the client certificate from that connection to the backend origin
servers. Use of the technique is to be a configuration or deployment option and
the processing rules described herein are for servers operating with that option
enabled.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">A TTRP negotiates the use of a mutually-authenticated TLS connection with the
client, such as is described in <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> or <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span>, and validates the
client certificate per its policy and trusted certificate authorities.  Each
HTTP request on the underlying TLS connection are dispatched to the origin
server with the following modifications:<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-3">
<li id="section-2.3-3.1">The client certificate is be placed in the <code>Client-Cert</code> header field of the
dispatched request as defined in <a href="#header" class="xref">Section 2.2</a>.<a href="#section-2.3-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-3.2">Any occurrence of the <code>Client-Cert</code> header in the original incoming request
MUST be removed or overwritten before forwarding the request. An incoming
request that has a <code>Client-Cert</code> header MAY be rejected with an HTTP 400
response.<a href="#section-2.3-3.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.3-4">Requests made over a TLS connection where the use of client certificate
authentication was not negotiated MUST be sanitized by removing any and all
occurrences <code>Client-Cert</code> header field prior to dispatching the request to the
backend server.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<p id="section-2.3-5">Backend origin servers may then use the <code>Client-Cert</code> header of the request to
determine if the connection from the client to the TTRP was
mutually-authenticated and, if so, the certificate thereby presented by the
client.<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3-6">Forward proxies and other intermediaries MUST NOT add the <code>Client-Cert</code> header
to requests, or modify an existing <code>Client-Cert</code> header. Similarly, clients MUST
NOT employ the <code>Client-Cert</code> header in requests.<a href="#section-2.3-6" class="pilcrow">¶</a></p>
<p id="section-2.3-7">A server that receives a request with a <code>Client-Cert</code> header value that it
considers to be too large can respond with an HTTP 431 status code per Section 5
of <span>[<a href="#RFC6585" class="xref">RFC6585</a>]</span>.<a href="#section-2.3-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec">
<section id="section-3">
      <h2 id="name-security-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-3-1">The header described herein enable a TTRP and backend or origin server to
function together as though, from the client's perspective, they are a single
logical server side deployment of HTTPS over a mutually-authenticated TLS
connection. Use of the <code>Client-Cert</code> header outside that intended use case,
however, may undermine the protections afforded by TLS client certificate
authentication. Therefore steps MUST be taken to prevent unintended use, both in
sending the header and in relying on its value.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Producing and consuming the <code>Client-Cert</code> header SHOULD be a configurable
option, respectively, in a TTRP and backend server (or individual application in
that server). The default configuration for both should be to not use the
<code>Client-Cert</code> header thus requiring an "opt-in" to the functionality.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">In order to prevent header injection, backend servers MUST only accept the
<code>Client-Cert</code> header from a trusted TTRP (or other proxy in a trusted path from
the TTRP). A TTRP MUST sanitize the incoming request before forwarding it on by
removing or overwriting any existing instances of the header. Otherwise
arbitrary clients can control the header value as seen and used by the backend
server. It is important to note that neglecting to prevent header injection does
not "fail safe" in that the nominal functionality will still work as expected
even when malicious actions are possible. As such, extra care is recommended in
ensuring that proper header sanitation is in place.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">The communication between a TTRP and backend server needs to be secured against
eavesdropping and modification by unintended parties.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">The configuration options and request sanitization are necessarily functionally
of the respective servers. The other requirements can be met in a number of
ways, which will vary based on specific deployments. The communication between a
TTRP and backend or origin server, for example, might be authenticated in some
way with the insertion and consumption of the <code>Client-Cert</code> header occurring
only on that connection. Alternatively the network topology might dictate a
private network such that the backend application is only able to accept
requests from the TTRP and the proxy can only make requests to that server.
Other deployments that meet the requirements set forth herein are also possible.<a href="#section-3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4-1.1">TODO: register the <code>Client-Cert</code> HTTP header field in the registry defined by
http-core.<a href="#section-4-1.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-5">
      <h2 id="name-references">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-5.1">
        <h3 id="name-normative-references">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ITU.X690.1994">[ITU.X690.1994]</dt>
      <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ITU-T Recommendation X.690</span>, <time datetime="1994" class="refDate">1994</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-5.2">
        <h3 id="name-informative-references">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5246">https://www.rfc-editor.org/rfc/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7230">[RFC7230]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7230">https://www.rfc-editor.org/rfc/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6585">[RFC6585]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span> and <span class="refAuthor">R. Fielding</span>, <span class="refTitle">"Additional HTTP Status Codes"</span>, <span class="seriesInfo">RFC 6585</span>, <span class="seriesInfo">DOI 10.17487/RFC6585</span>, <time datetime="2012-04" class="refDate">April 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6585">https://www.rfc-editor.org/rfc/rfc6585</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7239">[RFC7239]</dt>
        <dd>
<span class="refAuthor">Petersson, A.</span> and <span class="refAuthor">M. Nilsson</span>, <span class="refTitle">"Forwarded HTTP Extension"</span>, <span class="seriesInfo">RFC 7239</span>, <span class="seriesInfo">DOI 10.17487/RFC7239</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7239">https://www.rfc-editor.org/rfc/rfc7239</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8705">[RFC8705]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">T. Lodderstedt</span>, <span class="refTitle">"OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens"</span>, <span class="seriesInfo">RFC 8705</span>, <span class="seriesInfo">DOI 10.17487/RFC8705</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8705">https://www.rfc-editor.org/rfc/rfc8705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8941">[RFC8941]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span> and <span class="refAuthor">P-H. Kamp</span>, <span class="refTitle">"Structured Field Values for HTTP"</span>, <span class="seriesInfo">RFC 8941</span>, <span class="seriesInfo">DOI 10.17487/RFC8941</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8941">https://www.rfc-editor.org/rfc/rfc8941</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7250">[RFC7250]</dt>
      <dd>
<span class="refAuthor">Wouters, P., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Gilmore, J.</span>, <span class="refAuthor">Weiler, S.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7250">https://www.rfc-editor.org/rfc/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="example">
<section id="section-appendix.a">
      <h2 id="name-example">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-example" class="section-name selfRef">Example</a>
      </h2>
<p id="section-appendix.a-1">In a hypothetical example where a TLS client presents the client and
intermediate certificate from <a href="#example-chain" class="xref">Figure 1</a> when establishing a
mutually-authenticated TLS connection with the TTRP, the proxy would send the
<code>Client-Cert</code> header shown in {#example-header} to the backend. Note that line
breaks and whitespace have been added to the value of the header field in
<a href="#example-header" class="xref">Figure 2</a> for display and formatting purposes only.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<span id="name-certificate-chain-with-clie"></span><div id="example-chain">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-appendix.a-2.1">
<pre>
-----BEGIN CERTIFICATE-----
MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKDBJMZXQncyBB
dXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQTAeFw0yMDAx
MTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFkwEwYHKoZI
zj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmckC8vdgJ1p
5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDVR0TBAIw
ADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf8EBAMC
BsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV4YW1w
bGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6bMje
SkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIB5jCCAYugAwIBAgIBFjAKBggqhkjOPQQDAjBWMQswCQYDVQQGEwJVUzEbMBkG
A1UECgwSTGV0J3MgQXV0aGVudGljYXRlMSowKAYDVQQDDCFMZXQncyBBdXRoZW50
aWNhdGUgUm9vdCBBdXRob3JpdHkwHhcNMjAwMTE0MjEzMjMwWhcNMzAwMTExMjEz
MjMwWjA6MRswGQYDVQQKDBJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxB
IEludGVybWVkaWF0ZSBDQTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJf+aA54
RC5pyLAR5yfXVYmNpgd+CGUTDp2KOGhc0gK91zxhHesEYkdXkpS2UN8Kati+yHtW
CV3kkhCngGyv7RqjZjBkMB0GA1UdDgQWBBRm3WjLa38lbEYCuiCPct0ZaSED2DAf
BgNVHSMEGDAWgBTEA2Q6eecKu9g9yb5glbkhhVINGDASBgNVHRMBAf8ECDAGAQH/
AgEAMA4GA1UdDwEB/wQEAwIBhjAKBggqhkjOPQQDAgNJADBGAiEA5pLvaFwRRkxo
mIAtDIwg9D7gC1xzxBl4r28EzmSO1pcCIQCJUShpSXO9HDIQMUgH69fNDEMHXD3R
RX5gP7kuu2KGMg==
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIICBjCCAaygAwIBAgIJAKS0yiqKtlhoMAoGCCqGSM49BAMCMFYxCzAJBgNVBAYT
AlVTMRswGQYDVQQKDBJMZXQncyBBdXRoZW50aWNhdGUxKjAoBgNVBAMMIUxldCdz
IEF1dGhlbnRpY2F0ZSBSb290IEF1dGhvcml0eTAeFw0yMDAxMTQyMTI1NDVaFw00
MDAxMDkyMTI1NDVaMFYxCzAJBgNVBAYTAlVTMRswGQYDVQQKDBJMZXQncyBBdXRo
ZW50aWNhdGUxKjAoBgNVBAMMIUxldCdzIEF1dGhlbnRpY2F0ZSBSb290IEF1dGhv
cml0eTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABFoaHU+Z5bPKmGzlYXtCf+E6
HYj62fORaHDOrt+yyh3H/rTcs7ynFfGn+gyFsrSP3Ez88rajv+U2NfD0o0uZ4Pmj
YzBhMB0GA1UdDgQWBBTEA2Q6eecKu9g9yb5glbkhhVINGDAfBgNVHSMEGDAWgBTE
A2Q6eecKu9g9yb5glbkhhVINGDAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQE
AwIBhjAKBggqhkjOPQQDAgNIADBFAiEAmAeg1ycKHriqHnaD4M/UDBpQRpkmdcRF
YGMg1Qyrkx4CIB4ivz3wQcQkGhcsUZ1SOImd/lq1Q0FLf09rGfLQPWDc
-----END CERTIFICATE-----
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-certificate-chain-with-clie" class="selfRef">Certificate Chain (with client certificate first)</a>
        </figcaption></figure>
</div>
<span id="name-header-in-http-request-to-o"></span><div id="example-header">
<figure id="figure-2">
        <div class="artwork art-text alignLeft" id="section-appendix.a-3.1">
<pre>
Client-Cert: MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKDBJM
 ZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQTAeFw0y
 MDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFkwEwYHKoZI
 zj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmckC8vdgJ1p5Be5
 F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDVR0TBAIwADAfBgNV
 HSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf8EBAMCBsAwEwYDVR0l
 BAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV4YW1wbGUuY29tMAoGCCqG
 SM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6bMjeSkC3dFCOOB8TAiEAx/kH
 SB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-header-in-http-request-to-o" class="selfRef">Header in HTTP Request to Origin Server</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="considerations-considered">
<section id="section-appendix.b">
      <h2 id="name-considerations-considered">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-considerations-considered" class="section-name selfRef">Considerations Considered</a>
      </h2>
<div id="header-injection">
<section id="section-b.1">
        <h2 id="name-header-injection">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-header-injection" class="section-name selfRef">Header Injection</a>
        </h2>
<p id="section-b.1-1">This draft requires that the TTRP sanitize the headers of the incoming request
by removing or overwriting any existing instances of the <code>Client-Cert</code> header
before dispatching that request to the backend application. Otherwise, a client
could inject its own <code>Client-Cert</code> header that would appear to the backend to
have come from the TTRP. Although numerous other methods of detecting/preventing
header injection are possible; such as the use of a unique secret value as part
of the header name or value or the application of a signature, HMAC, or AEAD,
there is no common general standardized mechanism. The potential problem of
client header injection is not at all unique to the functionality of this draft
and it would therefor be inappropriate for this draft to define a one-off
solution. In the absence of a generic standardized solution existing currently,
stripping/sanitizing the headers is the de facto means of protecting against
header injection in practice today. Sanitizing the headers is sufficient when
properly implemented and is normative requirement of <a href="#sec" class="xref">Section 3</a>.<a href="#section-b.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-forwarded-http-extension">
<section id="section-b.2">
        <h2 id="name-the-forwarded-http-extensio">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-the-forwarded-http-extensio" class="section-name selfRef">The Forwarded HTTP Extension</a>
        </h2>
<p id="section-b.2-1">The <code>Forwarded</code> HTTP header field defined in <span>[<a href="#RFC7239" class="xref">RFC7239</a>]</span> allows proxy
components to disclose information lost in the proxying process. The TLS client
certificate information of concern to this draft could have been communicated
with an extension parameter to the <code>Forwarded</code> header field, however, doing so
would have had some disadvantages that this draft endeavored to avoid. The
<code>Forwarded</code> header syntax allows for information about a full chain of proxied
HTTP requests, whereas the <code>Client-Cert</code> header of this document is concerned
only with conveying information about the certificate presented by the
originating client on the TLS connection to the TTRP (which appears as the
server from that client's perspective) to backend applications.  The multi-hop
syntax of the <code>Forwarded</code> header is expressive but also more complicated, which
would make processing it more cumbersome, and more importantly, make properly
sanitizing its content as required by <a href="#sec" class="xref">Section 3</a> to prevent header injection
considerably more difficult and error prone. Thus, this draft opted for the
flatter and more straightforward structure of a single <code>Client-Cert</code> header.<a href="#section-b.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-whole-certificate-and-only-the-whole-certificate">
<section id="section-b.3">
        <h2 id="name-the-whole-certificate-and-o">
<a href="#section-b.3" class="section-number selfRef">B.3. </a><a href="#name-the-whole-certificate-and-o" class="section-name selfRef">The Whole Certificate and Only the Whole Certificate</a>
        </h2>
<p id="section-b.3-1">Different applications will have varying requirements about what information
from the client certificate is needed, such as the subject and/or issuer
distinguished name, subject alternative name(s), serial number, subject public
key info, fingerprint, etc.. Furthermore some applications, such as "OAuth 2.0
Mutual-TLS Client Authentication and Certificate-Bound Access Tokens"
<span>[<a href="#RFC8705" class="xref">RFC8705</a>]</span>, make use of the entire certificate. In order to accommodate the
latter and ensure wide applicability by not trying to cherry-pick particular
certificate information, this draft opted to pass the full encoded certificate
as the value of the <code>Client-Cert</code> header.<a href="#section-b.3-1" class="pilcrow">¶</a></p>
<p id="section-b.3-2">The handshake and validation of the client certificate (chain) of the
mutually-authenticated TLS connection is performed by the TTRP.  With the
responsibility of certificate validation falling on the TTRP, only the
end-entity certificate is passed to the backend - the root Certificate Authority
is not included nor are any intermediates.<a href="#section-b.3-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-b.3-3.1">TODO: It has been suggested that more information about the certificate chain
might be needed/wanted by the backend application (to independently evaluate the
cert chain, for example, although that seems like it would be terribly
inefficient) and that any intermediates as well as the root should also be
somehow conveyed, which is an area for further discussion should this draft
progress. One potential approach suggested by a few folks is to allow some
configurability in what is sent along with maybe a prefix token to indicate
what's being sent - something like <code>Client-Cert: FULL \&lt;cert&gt; \&lt;intermediate&gt;
\&lt;anchor&gt;</code> or <code>Client-Cert: EE \&lt;cert&gt;</code> as the strawman. Or a perhaps a
parameter or other construct of <span>[<a href="#RFC8941" class="xref">RFC8941</a>]</span> to indicate what's being sent. It's
also been suggested that the end-entity certificate by itself might sometimes be
too big (esp. e.g., with some post-quantum signature schemes). Hard to account
for it both being too much data and not enough data at the same time. But
potentially opening up configuration options to send only specific attribute(s)
from the client certificate is a possibility for that. In the author's humble
opinion the end-entity certificate by itself strikes a good balance for the vast
majority of needs and avoids optionality. But, again, this is an area for
further discussion should this draft progress.<a href="#section-b.3-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-b.3-4.1">TODO: It has also been suggested that maybe considerations for <span>[<a href="#RFC7250" class="xref">RFC7250</a>]</span> Raw
Public Keys is maybe worth considering. This too is this is an area for further
discussion and consideration should this draft progress.<a href="#section-b.3-4.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-appendix.c">
      <h2 id="name-acknowledgements">
<a href="#section-appendix.c" class="section-number selfRef">Appendix C. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.c-1">The author would like to thank the following individuals who've contributed in various ways ranging from just being generally supportive of bringing forth the draft to providing specific feedback or content:<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.c-2.1">Evan Anderson<a href="#section-appendix.c-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.2">Annabelle Backman<a href="#section-appendix.c-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.3">Mike Bishop<a href="#section-appendix.c-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.4">Rory Hewitt<a href="#section-appendix.c-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.5">Fredrik Jeansson<a href="#section-appendix.c-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.6">Benjamin Kaduk<a href="#section-appendix.c-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.7">Torsten Lodderstedt<a href="#section-appendix.c-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.8">Kathleen Moriarty<a href="#section-appendix.c-2.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.9">Mark Nottingham<a href="#section-appendix.c-2.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.10">Mike Ounsworth<a href="#section-appendix.c-2.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.11">Matt Peterson<a href="#section-appendix.c-2.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.12">Eric Rescorla<a href="#section-appendix.c-2.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.13">Justin Richer<a href="#section-appendix.c-2.13" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.14">Michael Richardson<a href="#section-appendix.c-2.14" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.15">Joe Salowey<a href="#section-appendix.c-2.15" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.16">Rich Salz<a href="#section-appendix.c-2.16" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.17">Mohit Sethi<a href="#section-appendix.c-2.17" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.18">Rifaat Shekh-Yusef<a href="#section-appendix.c-2.18" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.19">Travis Spencer<a href="#section-appendix.c-2.19" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.20">Nick Sullivan<a href="#section-appendix.c-2.20" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.21">Peter Wu<a href="#section-appendix.c-2.21" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.c-2.22">Hans Zandbelt<a href="#section-appendix.c-2.22" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="document-history">
<section id="section-appendix.d">
      <h2 id="name-document-history">
<a href="#section-appendix.d" class="section-number selfRef">Appendix D. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-appendix.d-1.1">To be removed by the RFC Editor before publication as an RFC<a href="#section-appendix.d-1.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-2">draft-ietf-httpbis-client-cert-field-00<a href="#section-appendix.d-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-3.1">Initial WG revision<a href="#section-appendix.d-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-3.2">Mike Bishop added as co-editor<a href="#section-appendix.d-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-4">draft-bdc-something-something-certificate-05<a href="#section-appendix.d-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-5.1">Change intended status of the draft to Informational<a href="#section-appendix.d-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.d-5.2">Editorial updates and (hopefully) clarifications<a href="#section-appendix.d-5.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-6">draft-bdc-something-something-certificate-04<a href="#section-appendix.d-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-7.1">Update reference from draft-ietf-oauth-mtls to RFC8705<a href="#section-appendix.d-7.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-8">draft-bdc-something-something-certificate-03<a href="#section-appendix.d-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-9.1">Expanded further discussion notes to capture some of the feedback in and around the presentation of the draft in SECDISPATCH at IETF 107 and add those who've provided such feedback to the acknowledgements<a href="#section-appendix.d-9.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-10">draft-bdc-something-something-certificate-02<a href="#section-appendix.d-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-11.1">Editorial tweaks + further discussion notes<a href="#section-appendix.d-11.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-12">draft-bdc-something-something-certificate-01<a href="#section-appendix.d-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-13.1">Use the RFC v3 Format or die trying<a href="#section-appendix.d-13.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.d-14">draft-bdc-something-something-certificate-00<a href="#section-appendix.d-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.d-15.1">Initial draft after a time constrained and rushed <a href="https://datatracker.ietf.org/meeting/106/materials/slides-106-secdispatch-securing-protocols-between-proxies-and-backend-http-servers-00">secdispatch
presentation</a>
at IETF 106 in Singapore with the recommendation to write up a draft (at
the end of the
<a href="https://datatracker.ietf.org/meeting/106/materials/minutes-106-secdispatch">minutes</a>)
and some folks expressing interest despite the rather poor presentation<a href="#section-appendix.d-15.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.e">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Brian Campbell</span></div>
<div dir="auto" class="left"><span class="org">Ping Identity</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bcampbell@pingidentity.com" class="email">bcampbell@pingidentity.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Bishop (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Akamai</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mbishop@evequefou.be" class="email">mbishop@evequefou.be</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
