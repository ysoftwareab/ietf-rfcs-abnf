<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Application Mechanism for maintaining alive the
      Network Address Translator (NAT) mappings associated to RTP flows.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Application Mechanism for maintaining alive the
      Network Address Translator (NAT) mappings associated to RTP flows.">
<meta name="keywords" content="NAT, RTP, SDP, binding, mapping, keepalive">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">X. Marjou</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">A. Sollaud</td></tr>
<tr><td class="header">Intended status: BCP</td><td class="header">France Telecom</td></tr>
<tr><td class="header">Expires: August 3, 2009</td><td class="header">January 30, 2009</td></tr>
</table></td></tr></table>
<h1><br />Application Mechanism for maintaining alive the
      Network Address Translator (NAT) mappings associated to RTP flows.<br />draft-ietf-avt-app-rtp-keepalive-05</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 3, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document lists the different mechanisms that enable applications using 
		 Real-time Transport Protocol (RTP) to maintain their RTP Network Address Translator (NAT) mappings alive.
		 It also makes a recommendation for a preferred mechanism.
		 This document is not applicable to Interactive Connectivity Establishment (ICE) agents.
		 
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#requirements">3.</a>&nbsp;
Requirements<br />
<a href="#alternatives">4.</a>&nbsp;
List of Alternatives for Performing RTP Keepalive<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#transport">4.1.</a>&nbsp;
Transport Packet of 0-byte<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#comfort-noise">4.2.</a>&nbsp;
RTP Packet with Comfort Noise Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rtcp-mux">4.3.</a>&nbsp;
RTCP Packets Multiplexed with RTP Packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#stun">4.4.</a>&nbsp;
STUN Indication Packet<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#incorrect-version">4.5.</a>&nbsp;
RTP Packet with Incorrect Version Number<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#unknown-pt">4.6.</a>&nbsp;
RTP Packet with Unknown Payload Type<br />
<a href="#recommend">5.</a>&nbsp;
Recommended Solution for Keepalive Mechanism<br />
<a href="#exceptions">6.</a>&nbsp;
Media Format Exceptions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">6.1.</a>&nbsp;
Real-time Text Payload Format Keepalive Mechanism<br />
<a href="#additional">7.</a>&nbsp;
Timing and Transport Considerations<br />
<a href="#anchor4">8.</a>&nbsp;
Security Considerations<br />
<a href="#anchor5">9.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">9.1.</a>&nbsp;
Registration of the SDP 'rtp-keepalive' Attribute<br />
<a href="#anchor7">10.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative references<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative references<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> Documents <a class='info' href='#RFC4787'>[RFC4787]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> and <a class='info' href='#RFC5382'>[RFC5382]<span> (</span><span class='info'>Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;NAT Behavioral Requirements for TCP,&rdquo; October&nbsp;2008.</span><span>)</span></a> describe NAT behaviors
		  and point out that two key aspects of NAT are mappings (a.k.a. bindings) and their refreshment. 
      This introduces a derived requirement for applications engaged in a multimedia session 
      involving NAT traversal: they need to generate a minimum
      of flow activity in order to create NAT mappings and maintain them.
</p>
<p> When applied to applications using RTP <a class='info' href='#RFC3550'>[RFC3550]<span> (</span><span class='info'>Schulzrinne, H., Casner, S., Frederick, R., and V. Jacobson, &ldquo;RTP: A Transport Protocol for Real-Time Applications,&rdquo; July&nbsp;2003.</span><span>)</span></a>, 
      the RTP media stream packets themselves normally fulfill this requirement.
      However there exist some cases where RTP does not generate the minimum required flow activity.
</p>
<p> The examples are:<br />
<br />

		</p>
<ul class="text">
<li> In some RTP usages, such as SIP, agents can negotiate a unidirectional media stream by 
		    using the SDP "recvonly" attribute on one agent and "sendonly" on the peer, 
		    as defined in <a class='info' href='#RFC3264'>[RFC3264]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;An Offer/Answer Model with Session Description Protocol (SDP),&rdquo; June&nbsp;2002.</span><span>)</span></a>.  
		    RFC 3264 directs implementations not to transmit media on the receiving agent.  
        In case the agent receiving the media is located in the private side of a NAT, 
        it will never receive RTP packets 
		    from the public peer if the NAT mapping has not been created.<br />
<br />

</li>
<li> Similarly, a bidirectional media stream can be "put on hold".  
        This is accomplished by using the SDP "sendonly" or "inactive" attributes.  
        Again RFC 3264 directs implementations to cease transmission of
   		  media in these cases.  However, doing so may cause NAT bindings to
   		  timeout, and media won't be able to come off hold.<br />
<br />

</li>
<li> In case of audio media, if silence suppression is in use, long periods of silence
   		  may cause media transmission to cease sufficiently long for NAT bindings to time out.<br />
<br />

</li>
<li> Some RTP payload formats, such as the payload format for
   		  text conversation <a class='info' href='#RFC4103'>[RFC4103]<span> (</span><span class='info'>Hellstrom, G. and P. Jones, &ldquo;RTP Payload for Text Conversation,&rdquo; June&nbsp;2005.</span><span>)</span></a>, may send packets so infrequently that the
   		  interval exceeds the NAT binding timeouts.
</li>
</ul><p>
	
</p>
<p> To solve these problems, an agent therefore needs to periodically send keepalive data 
      within the outgoing RTP session of an RTP media stream  regardless of whether
      the media stream is currently inactive, sendonly, recvonly or sendrecv, 
      and regardless of the presence or value of the bandwidth attribute.
  
</p>
<p> It is important to note that the above examples also require the agents to use symmetric RTP
      <a class='info' href='#RFC4961'>[RFC4961]<span> (</span><span class='info'>Wing, D., &ldquo;Symmetric RTP / RTP Control Protocol (RTCP),&rdquo; July&nbsp;2007.</span><span>)</span></a> in addition to RTP keepalive. 
  
</p>
<p> This document first states the requirements that must be supported 
	    to perform RTP keepalives (<a class='info' href='#requirements'>Section&nbsp;3<span> (</span><span class='info'>Requirements</span><span>)</span></a>).
	    In a second step, the document reports the different mechanisms to overcome 
	    this problem (<a class='info' href='#alternatives'>Section&nbsp;4<span> (</span><span class='info'>List of Alternatives for Performing RTP Keepalive</span><span>)</span></a>) and makes recommendations about their use.
	    <a class='info' href='#recommend'>Section&nbsp;5<span> (</span><span class='info'>Recommended Solution for Keepalive Mechanism</span><span>)</span></a> finally states the recommended solution for RTP keepalive.      
	
</p>
<p> The scope of the draft is limited to non-ICE agents. 
      Indeed, ICE agents need to follow the RTP keepalive mechanism specified 
      in the ICE specification <a class='info' href='#DRAFT-ICE'>[DRAFT&#8209;ICE]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Interactive Connectivity Establishment (ICE): A Methodology for Network Address Translator (NAT) Traversal for Offer/Answer Protocols,&rdquo; October&nbsp;2007.</span><span>)</span></a>.
 
</p>
<p> The scope of the draft is also limited to RTP flows.
		In particular, this document does not address keepalive activity related to:<br />
<br />

		</p>
<ul class="text">
<li> Session signaling flows, such as the Session Initiation Protocol (SIP).<br />
<br />

</li>
<li> RTCP flows. 
				
<blockquote class="text">
<p>Recall that <a class='info' href='#RFC3550'>[RFC3550]<span> (</span><span class='info'>Schulzrinne, H., Casner, S., Frederick, R., and V. Jacobson, &ldquo;RTP: A Transport Protocol for Real-Time Applications,&rdquo; July&nbsp;2003.</span><span>)</span></a> recommends a minimum interval of 5 seconds 
      			and that "on hold" procedures of <a class='info' href='#RFC3264'>[RFC3264]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;An Offer/Answer Model with Session Description Protocol (SDP),&rdquo; June&nbsp;2002.</span><span>)</span></a> do not impact RTCP transmissions. 
      			Therefore, when in use, there is always some RTCP flow activity.
</p>
</blockquote>
      	
</li>
</ul><p>
	
</p>
<p>Note that if a given media uses a codec that already integrates a keepalive mechanism, no additional keepalive mechanism is required at the RTP level.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p> In this document, the key words "MUST", "MUST NOT", "REQUIRED",
   "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
   and "OPTIONAL" are to be interpreted as described in RFC 2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Requirements</h3>

<p>This section outlines the key requirements that need to be 
		satisfied in order to provide RTP media keepalive.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-1</dt>
<dd>Some data is sent periodically within the outgoing RTP session for the whole duration of the RTP media stream.<br />

</dd>
<dt>REQ-2</dt>
<dd>Any type of transport (e.g. UDP, TCP) MUST be supported.<br />

</dd>
<dt>REQ-3</dt>
<dd>Any media type (e.g. audio, video, text) MUST be supported.<br />

</dd>
<dt>REQ-4</dt>
<dd>Any media format (e.g. G.711, H.263) MUST be supported.<br />

</dd>
<dt>REQ-5</dt>
<dd>Session signaling protocols SHOULD NOT be impacted.<br />

</dd>
<dt>REQ-6</dt>
<dd>Impacts on existing software SHOULD be minimized.<br />

</dd>
<dt>REQ-7</dt>
<dd>Remote peer SHOULD NOT be impacted.<br />

</dd>
<dt>REQ-8</dt>
<dd>The support for RTP keepalive SHOULD be described in the SDP.<br />

</dd>
<dt>REQ-9</dt>
<dd>More than one mechanism MAY exist.
</dd>
</dl></blockquote>

<a name="alternatives"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
List of Alternatives for Performing RTP Keepalive</h3>

<p>This section lists, in no particular order, some alternatives that can be used to 
			perform a keepalive message within RTP media streams.
</p>
<a name="transport"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Transport Packet of 0-byte</h3>

<p>The application sends an empty transport packet (e.g. UDP packet, DCCP packet ...).
</p>
<p>Cons:
				</p>
<ul class="text">
<li> This alternative is specific to each transport protocol.
</li>
</ul><p>
			
</p>
<p>Recommendation:
				</p>
<ul class="text">
<li>This method should not be used for RTP keepalive.
</li>
</ul><p>
      
</p>
<a name="comfort-noise"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
RTP Packet with Comfort Noise Payload</h3>

<p>The application sends an RTP packet with a comfort-noise payload <a class='info' href='#RFC3389'>[RFC3389]<span> (</span><span class='info'>Zopf, R., &ldquo;Real-time Transport Protocol (RTP) Payload for Comfort Noise (CN),&rdquo; September&nbsp;2002.</span><span>)</span></a>.
</p>
<p>Cons:
				</p>
<ul class="text">
<li>This alternative is limited to audio formats only. 
</li>
<li>Comfort Noise needs to be supported by the remote peer.
</li>
<li>Comfort Noise needs to be signalled in SDP offer/answer.
</li>
<li>The peer is likely to render comfort noise at the other side, so the content of the payload (the noise level) needs to be carefully chosen.
</li>
</ul><p>
			
</p>
<p>Recommendation:
				</p>
<ul class="text">
<li>This method may be used when the media allows for it.
</li>
</ul><p>
      
</p>
<a name="rtcp-mux"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
RTCP Packets Multiplexed with RTP Packets</h3>

<p>The application sends RTCP packets in the RTP media path itself 
			   (i.e. same tuples for both RTP and RTCP packets) <a class='info' href='#DRAFT-RTP-RTCP'>[DRAFT&#8209;RTP&#8209;RTCP]<span> (</span><span class='info'>Perkins, C. and M. Magnus, &ldquo;Multiplexing RTP Data and Control Packets on a Single Port,&rdquo; August&nbsp;2007.</span><span>)</span></a>.
				 RTCP packets therefore maintain the NAT mappings open.
</p>
<p>Cons:
				</p>
<ul class="text">
<li>Multiplexing RTP and RTCP must be supported by the remote peer.
</li>
<li>Multiplexing RTP and RTCP must be signalled in SDP offer/answer.
</li>
<li>Some RTCP monitoring tools expect that RTCP are not multiplexed.
</li>
</ul><p>
			
</p>
<p>Recommendation:
				</p>
<ul class="text">
<li>This method must only be used for RTP keepalive when negotiated between agents.
</li>
</ul><p>
      
</p>
<a name="stun"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
STUN Indication Packet</h3>

<p>The application sends a STUN <a class='info' href='#RFC5389'>[RFC5389]<span> (</span><span class='info'>Rosenberg, J., Mahy, R., Matthews, P., and D. Wing, &ldquo;Session Traversal Utilities for NAT (STUN),&rdquo; October&nbsp;2008.</span><span>)</span></a> Binding Indication packet as specified in ICE <a class='info' href='#DRAFT-ICE'>[DRAFT&#8209;ICE]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Interactive Connectivity Establishment (ICE): A Methodology for Network Address Translator (NAT) Traversal for Offer/Answer Protocols,&rdquo; October&nbsp;2007.</span><span>)</span></a>.
</p>
<p>Thanks to the RTP validity check, STUN packets will be ignored by the RTP stack.
</p>
<p>Cons:
				</p>
<ul class="text">
<li>The sending agent needs support STUN.
</li>
</ul><p>
			
</p>
<p>Recommendation:
				</p>
<ul class="text">
<li>This method must only be used for sessions between ICE agents, as specified in <a class='info' href='#DRAFT-ICE'>[DRAFT&#8209;ICE]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Interactive Connectivity Establishment (ICE): A Methodology for Network Address Translator (NAT) Traversal for Offer/Answer Protocols,&rdquo; October&nbsp;2007.</span><span>)</span></a>.
</li>
</ul><p>
      
</p>
<a name="incorrect-version"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
RTP Packet with Incorrect Version Number</h3>

<p>The application sends an RTP packet with an incorrect version number, which value is zero.
</p>
<p>Based on RTP specification <a class='info' href='#RFC3550'>[RFC3550]<span> (</span><span class='info'>Schulzrinne, H., Casner, S., Frederick, R., and V. Jacobson, &ldquo;RTP: A Transport Protocol for Real-Time Applications,&rdquo; July&nbsp;2003.</span><span>)</span></a>, the peer should perform a header validity check, 
      	and therefore ignore these types of packet.
</p>
<p>Cons:
				</p>
<ul class="text">
<li>Only four version numbers are possible. Using one of them for RTP keepalive would be wasteful.
</li>
<li><a class='info' href='#RFC4566'>[RFC4566]<span> (</span><span class='info'>Handley, M., Jacobson, V., and C. Perkins, &ldquo;SDP: Session Description Protocol,&rdquo; July&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#RFC3264'>[RFC3264]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;An Offer/Answer Model with Session Description Protocol (SDP),&rdquo; June&nbsp;2002.</span><span>)</span></a> mandate not to send
		    media with inactive and recvonly attributes, however this is mitigated as no real media is sent 
		    with this mechanism.
</li>
</ul><p>
			
</p>
<p>Recommendation:
				</p>
<ul class="text">
<li>This method should not be used for RTP keepalive.
</li>
</ul><p>
      
</p>
<a name="unknown-pt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
RTP Packet with Unknown Payload Type</h3>

<p>The application sends an RTP packet of 0 length with a dynamic payload type that has not been 
			negotiated by the peers (e.g. not negotiated within the SDP offer/answer, and thus not mapped to any media format). 
</p>
<p> The sequence number is incremented by one for each packet, as it is sent within 
			    the same RTP session as the actual media.
					The timestamp contains the same value a media packet would have at this time.
					The marker bit is not significant for the keepalive packets and is thus set to zero.
			
</p>
<p>Normally the peer will ignore this packet, as RTP <a class='info' href='#RFC3550'>[RFC3550]<span> (</span><span class='info'>Schulzrinne, H., Casner, S., Frederick, R., and V. Jacobson, &ldquo;RTP: A Transport Protocol for Real-Time Applications,&rdquo; July&nbsp;2003.</span><span>)</span></a> states that "a receiver 
				MUST ignore packets with payload types that it does not understand".
</p>
<p>Cons:
				</p>
<ul class="text">
<li><a class='info' href='#RFC4566'>[RFC4566]<span> (</span><span class='info'>Handley, M., Jacobson, V., and C. Perkins, &ldquo;SDP: Session Description Protocol,&rdquo; July&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#RFC3264'>[RFC3264]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;An Offer/Answer Model with Session Description Protocol (SDP),&rdquo; June&nbsp;2002.</span><span>)</span></a> mandate not to send
		    media with inactive and recvonly attributes, however this is mitigated as no real media is sent 
		    with this mechanism.
</li>
</ul><p>
     
</p>
<p>Recommendation:
				</p>
<ul class="text">
<li>This method should be used for RTP keepalive.
</li>
</ul><p>
      
</p>
<a name="recommend"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Recommended Solution for Keepalive Mechanism</h3>

<p> Some mechanisms do not meet the requirements as they are either specific to the transport (<a class='info' href='#transport'>Section&nbsp;4.1<span> (</span><span class='info'>Transport Packet of 0-byte</span><span>)</span></a>),
		    or specific to a media type (<a class='info' href='#comfort-noise'>Section&nbsp;4.2<span> (</span><span class='info'>RTP Packet with Comfort Noise Payload</span><span>)</span></a>). These mechanisms are thus NOT RECOMMENDED. 
</p>
<p> Other mechanisms are dependent on the capabilities of the peer (<a class='info' href='#rtcp-mux'>Section&nbsp;4.3<span> (</span><span class='info'>RTCP Packets Multiplexed with RTP Packets</span><span>)</span></a>, <a class='info' href='#stun'>Section&nbsp;4.4<span> (</span><span class='info'>STUN Indication Packet</span><span>)</span></a>).
		    Among these mechanisms, RTCP packets multiplexed with RTP packets (<a class='info' href='#rtcp-mux'>Section&nbsp;4.3<span> (</span><span class='info'>RTCP Packets Multiplexed with RTP Packets</span><span>)</span></a>) is desirable because it reduces 
        the number of ports used.
</p>
<p>The RECOMMENDED solution is thus the "RTCP packets multiplexed with RTP packets" (<a class='info' href='#rtcp-mux'>Section&nbsp;4.3<span> (</span><span class='info'>RTCP Packets Multiplexed with RTP Packets</span><span>)</span></a>). However, when this mechanism cannot be negotiated, it
        is RECOMMENDED to use the fallback "RTP Packet with Unknown Payload Type" mechanism (<a class='info' href='#unknown-pt'>Section&nbsp;4.6<span> (</span><span class='info'>RTP Packet with Unknown Payload Type</span><span>)</span></a>) as it will always work.
</p>
<p>When using SDP, an agent supporting the fallback solution MUST indicate its support by adding an a=rtp-keepalive SDP attribute.
     	 	 This attribute is declarative only and can not be negotiated. 
     	 	 It indicates that the fallback solution will be used if the recommended solution can not be used.
</p>
<p>When using the SDP offer-answer <a class='info' href='#RFC3264'>[RFC3264]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;An Offer/Answer Model with Session Description Protocol (SDP),&rdquo; June&nbsp;2002.</span><span>)</span></a>, the agent SHOULD offer both the "a=rtcp-mux" and "a=rtp-keepalive" attributes. 
If "a=rtcp-mux"attribute is present in the answer, the agent uses RTCP packets being multiplexed on the RTP port as a keepalive. Otherwise, the agent uses RTP packets with an invalid payload type as a keepalive.
</p>
<a name="exceptions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Media Format Exceptions</h3>

<p>When a given media format does not allow the keepalive solution
   recommended in <a class='info' href='#recommend'>Section&nbsp;5<span> (</span><span class='info'>Recommended Solution for Keepalive Mechanism</span><span>)</span></a>, an alternative mechanism SHOULD be defined
   in the payload format specification for this media format.
</p>
<p>Real-time text payload format <a class='info' href='#RFC4103'>[RFC4103]<span> (</span><span class='info'>Hellstrom, G. and P. Jones, &ldquo;RTP Payload for Text Conversation,&rdquo; June&nbsp;2005.</span><span>)</span></a> is an example 
   of such a media format.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Real-time Text Payload Format Keepalive Mechanism</h3>

<p>Real-time text payload format <a class='info' href='#RFC4103'>[RFC4103]<span> (</span><span class='info'>Hellstrom, G. and P. Jones, &ldquo;RTP Payload for Text Conversation,&rdquo; June&nbsp;2005.</span><span>)</span></a> does not allow
     to use different payloads within a same RTP session, so the fallback mechanism does not work.
</p>
<p>For real-time text, the RECOMMENDED solution is the "RTCP packets multiplexed
     with RTP packets".  When this mechanism cannot be negotiated, it is
     RECOMMENDED to use an empty T140block containing no data in the same
     manner as for the idle procedure defined in <a class='info' href='#RFC4103'>[RFC4103]<span> (</span><span class='info'>Hellstrom, G. and P. Jones, &ldquo;RTP Payload for Text Conversation,&rdquo; June&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="additional"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Timing and Transport Considerations</h3>

<p>An application supporting this specification must transmit either keepalive packets or media packets
		at least once every Tr seconds during the whole duration of the media session. 
		Tr SHOULD be configurable, and otherwise MUST default to 15 seconds.
</p>
<p>When using the "RTCP packets multiplexed with RTP packets" solution for 
		keepalive, Tr MUST comply with the RTCP timing rules of <a class='info' href='#RFC3550'>[RFC3550]<span> (</span><span class='info'>Schulzrinne, H., Casner, S., Frederick, R., and V. Jacobson, &ldquo;RTP: A Transport Protocol for Real-Time Applications,&rdquo; July&nbsp;2003.</span><span>)</span></a>. 
		
		The fallback "RTP Packet with Unknown Payload Type" solution uses RTP, 
		and thus does not have these RTCP constraints.
</p>
<p>Keepalive packets within a particular RTP session MUST use the tuple (source IP
   	address, source TCP/UDP ports, target IP address, target TCP/UDP
   	Port) of the regular RTP packets.
</p>
<p>The agent SHOULD only send RTP keepalive when it does not send regular RTP packets.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>The RTP keepalive packets are sent on the same path as regular RTP media packets
		   and may be perceived as an attack by the peer.
		   The peer needs to react as described by <a class='info' href='#RFC3550'>[RFC3550]<span> (</span><span class='info'>Schulzrinne, H., Casner, S., Frederick, R., and V. Jacobson, &ldquo;RTP: A Transport Protocol for Real-Time Applications,&rdquo; July&nbsp;2003.</span><span>)</span></a> by ignoring them. 
		   Not only does it not hurt to drop them, but not dropping them would be harmful. 
		   
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Registration of the SDP 'rtp-keepalive' Attribute</h3>

<p>
   This section instructs the IANA to register the following SDP att-
   field under the Session Description Protocol (SDP) Parameters
   registry:
   
</p>
<p>
   Contact name:  xavier.marjou@orange-ftgroup.com
   
</p>
<p>
   Attribute name:  rtp-keepalive
   
</p>
<p>
   Long-form attribute name:  RTP keepalive
   
</p>
<p>
   Type of attribute  Media level
   
</p>
<p>
   Subject to charset:  No
   
</p>
<p>
   Purpose of attribute:  The 'rtp-keepalive' attribute declares that the agent supports the fallback RTP keepalive mechanism (<a class='info' href='#unknown-pt'>Section&nbsp;4.6<span> (</span><span class='info'>RTP Packet with Unknown Payload Type</span><span>)</span></a>).
</p>
<p>
   Allowed attribute values:  None
   
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgements</h3>

<p>Jonathan Rosenberg provided the major inputs for this draft via the ICE specification. 
		In addition, thanks to Alfred E. Heggestad, Colin Perkins, Dan Wing, Gunnar Hellstrom, Hadriel Kaplan, 
		Randell Jesup, Remi Denis-Courmont, and Steve Casner for their useful inputs and comments.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative references</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="DRAFT-RTP-RTCP">[DRAFT-RTP-RTCP]</a></td>
<td class="author-text">Perkins, C. and M. Magnus, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-avt-rtp-and-rtcp-mux-07.txt">Multiplexing RTP Data and Control Packets on a Single Port</a>,&rdquo; draft-ietf-avt-rtp-and-rtcp-mux-07 (work in progress), August&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3550">[RFC3550]</a></td>
<td class="author-text">Schulzrinne, H., Casner, S., Frederick, R., and V. Jacobson, &ldquo;<a href="http://tools.ietf.org/html/rfc3550">RTP: A Transport Protocol for Real-Time Applications</a>,&rdquo; STD&nbsp;64, RFC&nbsp;3550, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3550.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc3550.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc3550.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4961">[RFC4961]</a></td>
<td class="author-text">Wing, D., &ldquo;<a href="http://tools.ietf.org/html/rfc4961">Symmetric RTP / RTP Control Protocol (RTCP)</a>,&rdquo; BCP&nbsp;131, RFC&nbsp;4961, July&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4961.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative references</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="DRAFT-ICE">[DRAFT-ICE]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-19.txt">Interactive Connectivity Establishment (ICE): A Methodology for Network Address Translator (NAT) Traversal for Offer/Answer Protocols</a>,&rdquo; draft-ietf-mmusic-ice-19 (work in progress), October&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3264">[RFC3264]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3264">An Offer/Answer Model with Session Description Protocol (SDP)</a>,&rdquo; RFC&nbsp;3264, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3264.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3389">[RFC3389]</a></td>
<td class="author-text">Zopf, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3389">Real-time Transport Protocol (RTP) Payload for Comfort Noise (CN)</a>,&rdquo; RFC&nbsp;3389, September&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3389.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4103">[RFC4103]</a></td>
<td class="author-text">Hellstrom, G. and P. Jones, &ldquo;<a href="http://tools.ietf.org/html/rfc4103">RTP Payload for Text Conversation</a>,&rdquo; RFC&nbsp;4103, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4103.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4566">[RFC4566]</a></td>
<td class="author-text">Handley, M., Jacobson, V., and C. Perkins, &ldquo;<a href="http://tools.ietf.org/html/rfc4566">SDP: Session Description Protocol</a>,&rdquo; RFC&nbsp;4566, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4566.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4787">[RFC4787]</a></td>
<td class="author-text">Audet, F. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4787">Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</a>,&rdquo; BCP&nbsp;127, RFC&nbsp;4787, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4787.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5382">[RFC5382]</a></td>
<td class="author-text">Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;<a href="http://tools.ietf.org/html/rfc5382">NAT Behavioral Requirements for TCP</a>,&rdquo; BCP&nbsp;142, RFC&nbsp;5382, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5382.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5389">[RFC5389]</a></td>
<td class="author-text">Rosenberg, J., Mahy, R., Matthews, P., and D. Wing, &ldquo;<a href="http://tools.ietf.org/html/rfc5389">Session Traversal Utilities for NAT (STUN)</a>,&rdquo; RFC&nbsp;5389, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5389.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Xavier Marjou</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France Telecom</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2, avenue Pierre Marzin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lannion  22307</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:xavier.marjou@orange-ftgroup.com">xavier.marjou@orange-ftgroup.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Aurelien Sollaud</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France Telecom</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2, avenue Pierre Marzin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lannion  22307</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:aurelien.sollaud@orange-ftgroup.com">aurelien.sollaud@orange-ftgroup.com</a></td></tr>
</table>
</body></html>
