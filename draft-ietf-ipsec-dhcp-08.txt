





IPSEC Working Group                                          Baiju Patel
INTERNET-DRAFT                                                     Intel
Category: Standards Track                                  Bernard Aboba
<draft-ietf-ipsec-dhcp-08.txt>                                 Microsoft
                                                             Scott Kelly
                                                 RedCreek Communications
                                                             Vipul Gupta
                                                  Sun Microsystems, Inc.

               DHCPv4 Configuration of IPSEC Tunnel Mode

This document is an Internet-Draft and is in full conformance with all
provisions of Section 10 of RFC2026.

This document is an Internet-Draft.  Internet-Drafts are working docu-
ments of the Internet Engineering Task Force (IETF), its areas, and its
working groups.  Note that other groups may also distribute working
documents as Internet-Drafts.

Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any
time.  It is inappropriate to use Internet- Drafts as reference material
or to cite them other than as "work in progress."

The list of current Internet-Drafts can be accessed at
http://www.ietf.org/ietf/1id-abstracts.txt

The list of Internet-Draft Shadow Directories can be accessed at
http://www.ietf.org/shadow.html.

1.  Copyright Notice

Copyright (C) The Internet Society (2000).  All Rights Reserved.

2.  Abstract

In many remote access scenarios, a mechanism for making the remote host
appear to be present on the local corporate network is quite useful.
This may be accomplished by assigning the host a "virtual" address from
the corporate network, and then tunneling traffic via Ipsec from the
host's ISP-assigned address to the corporate security gateway. In IPv4,
Dynamic Host Configuration Protocol (DHCP) provides for such remote host
configuration. This draft explores the requirements for host
configuration in IPSEC tunnel mode, and describes how DHCPv4 may be
leveraged for configuration.






Patel, Aboba, Kelly & Gupta  Standards Track                    [Page 1]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


3.  Introduction

In many remote access scenarios, a mechanism for making the remote host
appear to be present on the local corporate network is quite useful.
This may be accomplished by assigning the host a "virtual" address from
the corporate network, and then tunneling traffic via IPSEC from the
host's ISP-assigned address to the corporate security gateway. In IPv4,
Dynamic Host Configuration Protocol (DHCP) [3] provides for such remote
host configuration. This draft explores the requirements for host
configuration in IPSEC tunnel mode, and describes how DHCPv4 may be
leveraged for configuration.

3.1.  Terminology

This document uses the following terms:

DHCP client
          A DHCP client or "client" is an Internet host using DHCP to
          obtain configuration parameters such as a network address.

DHCP server
          A DHCP server or "server" is an Internet host that returns
          configuration parameters to DHCP clients.

3.2.  Requirements language

In this document, the key words "MAY", "MUST,  "MUST  NOT",  "optional",
"recommended",  "SHOULD",  and  "SHOULD  NOT",  are to be interpreted as
described in [1].

4.  IPSEC tunnel mode configuration requirements

As described in [21], the configuration requirements of a host with an
IPSEC tunnel mode interface include the need to obtain an IPv4 address
and other configuration parameters appropriate to the class of host. In
addition to meeting the basic requirements [21], the following
additional capabilities may be desirable:

   1. integration with existing IPv4 address management facilities
   2. support for address pool management
   3. reconfiguration when required
   4. support for fail-over
   5. maintaining security and simplicity in the IKE implementation.
   6. authentication where required







Patel, Aboba, Kelly & Gupta  Standards Track                    [Page 2]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


4.1.  DHCP configuration evaluation

Leveraging DHCP for configuration of IPSEC tunnel mode meets the basic
requirements described in [21]. It also provides the additional
capabilities described above.

Basic configuration
          In IPv4, leveraging DHCPv4 [3] for the configuration of IPSEC
          tunnel mode satisfies the basic requirements described in
          [21].  Since the required configuration parameters described
          in [21] are a subset of those already supported in DHCPv4
          options [5], no new DHCPv4 options are required, and no
          modifications to DHCPv4 [3] are required.

Address management integration
          Since DHCPv4 is widely deployed for address management today,
          reuse of DHCPv4 for IPSEC tunnel mode address management
          enables compatibility and integration with existing addressing
          implementations and IPv4 address management software.

Address pool management
          As described in [18], DHCPv4 implementations support
          conditional behavior so that the address and configuration
          parameters assigned can be dependent on parameters included in
          the DHCPDISCOVER. This makes it possible for the security
          gateway to ensure that the client receives an IP address
          assignment from the appropriate address pool, such as via the
          User Class option, described in [16].

Reconfiguration
          DHCP supports the concept of configuration leases, and there
          is a proposal for handling forced reconfiguration [14].

Fail-over support
          When leveraging DHCPv4, configuration and addressing state is
          kept on the DHCP server, not within the IKE implementation. As
          a result, the loss of a tunnel server does not result in the
          loss of configuration and addressing state, thus making it
          easier to support fail-over [8].

Security and simplicity
          Leveraging DHCPv4 also makes it easier to maintain security in
          the IKE implementation since no IKE modifications are required
          to support configuration.

Authentication
          Where DHCPv4 authentication [6] is required, this can be
          supported on an IPSEC tunnel mode interface as it would be on



Patel, Aboba, Kelly & Gupta  Standards Track                    [Page 3]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


          any other interface.

4.2.  IKECFG evaluation

Alternatives to DHCPv4, such as ISAKMP CFG, described in [13], do not
meet the basic requirements described in [21], nor do they provide the
additional capabilities.

Basic configuration
          While ISAKMP CFG can provide for IP address assignment as well
          as configuration of a few additional parameters such as the
          DNS server and WINS server addresses, the rich configuration
          facilities of DHCPv4 are not supported. Past experience with
          similar configuration mechanisms within PPP IPCP [7] has
          taught us that it is not viable merely to support minimal
          configuration.  Eventually, either much of the functionality
          embodied in the DHCPv4 options [5] is duplicated or support
          for DHCPINFORM [3] will be required.

Address management integration
          Since IKECFG is not integrated with existing IP address
          management facilities, it is difficult to integrate it with
          policy management services that may be dependent on the user
          to IP address binding.

Address pool management
          IKECFG does not provide a mechanism for the client to indicate
          a preference for a particular address pool. This makes it
          difficult to support address pool management.

Reconfiguration
          IKECFG does not support the concept of configuration leases or
          reconfiguration.

Fail-over support
          Since IKECFG creates a separate pool of address state, it
          complicates the provisioning of network utility-class
          reliability, both in the IP address management system and in
          the security gateways themselves.

Security and simplicity
          As past history with PPP IPCP demonstrates, once it is decided
          to provide non-integrated address management and configuration
          facilities within IKE, it will be difficult to limit the
          duplication of effort to address assignment. Instead, it will
          be tempting to also duplicate the configuration,
          authentication and fail-over facilities of DHCPv4. This
          duplication will greatly increase the scope of work,



Patel, Aboba, Kelly & Gupta  Standards Track                    [Page 4]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


          eventually compromising the security of IKE.

Authentication
          While IKECFG can support mutual authentication of the IPSEC
          tunnel endpoints, it is difficult to integrate IKECFG with
          DHCPv4 authentication [6].  This is because the IPSEC tunnel
          server will not typically have access to the client
          credentials necessary to sign the DHCPv4 authentication option
          on the client's behalf.

          IKECFG does not currently support the functionality necessary
          for the security gateway to issue an authenticated DHCP
          request on the client's behalf. As a result, it is necessary
          for the security gateway to request allocation of an IP
          address on its own behalf, and then assign this to the client
          via IKECFG. Since IKECFG does not support the concept of an
          address lease, the security gateway will need to do the
          renewal itself.  This complicates the renewal process.

          Since RFC 2131 [3] assumes that a DHCPREQUEST will not contain
          a filled in giaddr field when generated during RENEWING state,
          the DHCPACK will be sent directly to the client, which will
          not be expecting it. As a result, it is either necessary for
          the security gateway to add special code to avoid forwarding
          such packets, or to wait until REBINDING state. Since [3] does
          not specify that the giaddr field cannot be filled in when in
          the REBINDING state, the security gateway may put its own
          address in the giaddr field when in REBINDING state, thereby
          ensuring that it can receive the renewal response without
          treating it as a special case.

4.3.  Summary

As described, DHCPv4 [3] meets the IPSEC tunnel mode configuration
requirements [21], as well as providing additional capabilities. In
contrast, IKECFG [13] does not meet the basic requirements, nor does it
provide additional capabilities. As a result, DHCPv4 is the superior
alternative for IPSEC tunnel mode configuration.

5.  Scenario overview

IPSEC [2], [9]-[12] is a protocol suite defined to secure communication
at the network layer between communicating peers. Among many
applications enabled by IPSEC, a useful application is to connect a
remote host to a corporate intranet via a security gateway, using IPSEC
tunnel mode.  This host is then configured in such a manner so as to
provide it with a virtual presence on the internal network. This is
accomplished in the following manner:



Patel, Aboba, Kelly & Gupta  Standards Track                    [Page 5]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


A remote host on the Internet will connect to the security gateway and
then establish an IPSEC tunnel to it.  The remote host then interacts
via the IPSEC tunnel with a DHCPv4 server which provides the remote host
with an address from the corporate network address space. The remote
host subsequently uses this as the source address for all interactions
with corporate resources. Note that this implies that the corporate
security gateway continues to recognize the host's original, routable IP
address as the tunnel endpoint. The virtual identity assumed by the
remote host when using the assigned address appears to the corporate
network as though it were situated behind a security gateway bearing the
original routable IP address. All the traffic between the remote host
and the intranet will be carried over the IPSEC tunnel via the security
gateway as shown below:

                                       corporate net
 +------------------+                      |
 |    externally    |        +--------+    |   !~~~~~~~~~~!
 |+-------+ visible |        |        |    |   ! rmt host !
 ||virtual| host    |        |security|    |---! virtual  !
 || host  |         |--------|gateway/|    |   ! presence !
 ||       |<================>|  DHCP  |----|   !~~~~~~~~~~!
 |+-------+         |--------| Relay  |    |
 +------------------+   ^    +--------+    |   +--------+
                        |                  |---| DHCPv4 |
                      IPsec tunnel         |   | server |
                      with encapsulated    |   +--------+
                      traffic inside

This scenario assumes that the remote host already has Internet
connectivity and the host Internet interface is appropriately
configured. The mechanisms for configuration of the remote host's
address for the Internet interface are well defined; i.e., PPP IP
control protocol (IPCP), described in [4], DHCPv4, described in [3], and
static addressing. The mechanisms for auto-configuration of the intranet
are also standardized. It is also assumed that the remote host has
knowledge of the location of the security gateway. This can be
accomplished via DNS, using either A, KX, or SRV records.

Typically the DHCPv4 server will not reside on the same machine as the
security gateway, which will act as a DHCPv4 relay. In this case, the
security gateway merely relays packets between the client and the DHCPv4
server, but does not request or renew addresses on the client's behalf.

A typical configuration of the remote host in this application would use
two addresses: 1) an interface to connect to the Internet (internet
interface), and 2) a virtual interface to connect to the intranet
(intranet interface). The IP address of the Internet and intranet
interfaces are used in the outer and inner headers of the IPSEC tunnel



Patel, Aboba, Kelly & Gupta  Standards Track                    [Page 6]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


mode packet, respectively.

5.1.  Configuration walk-through

The configuration of the intranet interface of the IPSEC tunnel mode
host is accomplished in the following steps:

1) The remote host establishes an IKE security association with
   the security gateway in a main mode or aggressive mode exchange.
   This IKE SA then serves to secure additional quick mode IPSEC SAs.
2) The remote host establishes a DHCP SA with the IPSEC tunnel mode
   server in a quick mode exchange. The DHCP SA is an IPSEC tunnel mode
   SA established to protect initial DHCPv4 traffic between the
   security gateway and the remote host. The DHCP SA MUST
   only be used for DHCP traffic. The details of how this
   SA is set up are described in Section 6.1.
3) DHCP messages are sent back and forth between the remote host
   and the DHCPv4 server. While other configurations are possible,
   typically the IPSEC tunnel server acts as a DHCPv4 relay.
   The traffic is protected between the remote host and the
   security gateway using the DHCP SA established in step 2. After
   the DHCP conversation completes, the remote host's intranet interface
   obtains an IP address as well as other configuration parameters.
4) The remote host MAY request deletion of the DHCP SA since
   future DHCP messages will be carried over a new IPSEC tunnel.
   Alternatively, the remote host and the security gateway
   MAY continue to use the same SA for all subsequent traffic
   by adding temporary SPD selectors in the same manner as is
   provided for name ID types in [2].
5) If a new IPSEC tunnel is required, the remote host establishes
   a tunnel mode SA to the security gateway in a quick mode exchange.
   In this case, the new address assigned via DHCPv4 MUST be used
   in the quick mode ID.

At the end of the last step, the remote host is ready to communicate
with the intranet using an IPSEC tunnel. All the IP traffic (including
future DHCPv4 messages) between the remote host and the intranet are now
tunneled over this IPSEC tunnel mode SA.  Since the security parameters
used for different SAs are based on the unique requirements of the
remote host and the security gateway, they are not described in this
document. The mechanisms described here work best when the VPN is
implemented using a virtual interface.

6.  Detailed description

This section provides details relating to the messages exchanged during
the setup and teardown of the DHCP SAs.




Patel, Aboba, Kelly & Gupta  Standards Track                    [Page 7]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


6.1.  DHCPDISCOVER message processing

The events begin with the remote host intranet interface generating a
DHCPDISCOVER message. Details are described below:

   FIELD      OCTETS       DESCRIPTION
   -----      ------       -----------

   op            1  Message op code / message type.
                    1 = BOOTREQUEST, 2 = BOOTREPLY
   htype         1  Hardware address type. Set to a value TBD,
                    signifying an IPSEC tunnel mode virtual interface.
   hlen          1  Hardware address length
   hops          1  Client sets to zero, optionally used by relay agents
                    when booting via a relay agent.
   xid           4  Transaction ID, a random number chosen by the
                    client, used by the client and server to associate
                    messages and responses between a client and a
                    server.
   secs          2  Filled in by client, seconds elapsed since client
                    began address acquisition or renewal process.
   flags         2  Flags
   ciaddr        4  Client IP address; only filled in if client is in
                    BOUND, RENEW or REBINDING state.
   yiaddr        4  'your' (client) IP address.
   siaddr        4  IP address of next server to use in bootstrap;
                    returned in DHCPOFFER, DHCPACK by server.
   giaddr        4  Security gateway IP address, used in booting via a
                    relay agent.
   chaddr       16  Client hardware address. Should be unique.
   sname        64  Optional server host name, null terminated string.
   file        128  Boot file name, null terminated string; "generic"
                    name or null in DHCPDISCOVER, fully qualified
                    directory-path name in DHCPOFFER.
   options     var  Optional parameters field.

           Table 1:  Description of fields in the DHCP message

The chaddr field of the DHCPDISCOVER should include a unique identifier.
The client must use the same chaddr field in all subsequent messages
within the same DHCPv4 exchange. This permits the use of DHCP Relay load
balancing as described in [19]. The contents of the hlen and chaddr
fields SHOULD be the hlen and chaddr values for the LAN interface
supplying the network connectivity used for this tunnel. Note that in
order to more easily allow the DHCP server to differentiate VPN from
non-VPN requests, the htype is set to a value TBD, signifying a virtual
IPSEC tunnel mode interface, rather than to the LAN interface value.




Patel, Aboba, Kelly & Gupta  Standards Track                    [Page 8]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


If there is no LAN interface, for IPv4, the chaddr SHOULD be the IPv4
address of the interface supplying the network connectivity,
concatenated with 2 octets of random data. Once again, the htype is set
to a value TBD signifying a virtual IPSEC tunnel mode interface.  Note
that in this case the chaddr will not be unique between reboots, so that
the client-identifier option MUST be included, and SHOULD be set to
something that is unique and persistent across reboots, such as the
machine FQDN concatenated with the interface name and a number.

In order to deliver the DHCPDISCOVER packet from the intranet interface
to the security gateway, an IKE Phase 1 SA is established between the
Internet interface and the security gateway. A phase 2 (quick mode) DHCP
SA tunnel mode SA is then established. The key lifetime for the DHCP SA
SHOULD be on the order of minutes since it will only be temporary.  The
remote host SHOULD  use an IDci payload of 0.0.0.0/UDP/port 68 in the
quick mode exchange. The security gateway will use an IDcr payload of
its own Internet address/UDP/port 67  The DHCP SA is established as a
tunnel mode SA with filters set as follows:

 From client to server: Any to Any, destination: UDP port 67
 From server to client: Any to Any, destination: UDP port 68

Note that these filters will work not only for a client without
configuration, but also with a client that has previously obtained a
configuration lease, and is attempting to renew it. In the latter case,
the DHCP SA will initially be used to send a DHCPREQUEST rather than a
DHCPDISCOVER message.

The initial DHCPv4 message (DHCPDISCOVER or DHCPREQUEST) is then
tunneled to the security gateway using the tunnel mode SA. Since the
security gateway is acting as a DHCP relay, it will insert its address
in the "giaddr" field, possibly adding a relay agent option [17], and
will forward the message to one or more intranet DHCP servers.

6.2.  DHCPOFFER message processing

Typically, the security gateway will also store the xid and the chaddr
gleaned from the DHCPDISCOVER in a table so as to be able to route the
corresponding DHCPOFFER message(s) back to the remote host.

6.3.  DHCPREQUEST message processing

After the Internet interface has received the DHCPOFFER message, it
forwards this to the intranet interface after IPSEC processing. The
intranet interface then responds by creating a DHCPREQUEST message,
which is tunneled to security gateway using the DHCP SA.





Patel, Aboba, Kelly & Gupta  Standards Track                    [Page 9]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


6.4.  DHCPACK message processing

The DHCPv4 server than replies with a DHCPACK or DHCPNAK message, which
is forwarded down the DHCP SA by the security gateway. The remote host
Internet interface then forwards the DHCPACK or DHCPNAK message to the
intranet interface after IPSEC processing. To learn the IP address of
the client in order to route packets to it, the security gateway will
typically snoop the yiaddr field within the DHCPACK and plumb a
corresponding route as part of DHCP relay processing.

After processing of the DHCPACK, the intranet interface is configured
and the internet interface can establish a new IPSEC tunnel mode SA to
the security gateway. The IDci of the quick mode exchange used to
establish the new IPSEC tunnel mode SA should be the address of the
intranet interface as obtained via DHCPv4.

The remote host may now delete the DHCP tunnel mode SA. All future DHCP
messages sent by the client, including DHCPREQUEST, DHCPINFORM,
DHCPDECLINE, and DHCPRELEASE messages will use the newly established VPN
SA. Similarly, all DHCP messages subsequently sent by the DHCPv4 server
will be forwarded by the security gateway (acting as a DHCP relay) using
the IPEC tunnel mode SA, including DHCPOFFER, DHCPACK, and DHCPNAK
messages.

It SHOULD be possible to configure the client to forward all internet-
bound traffic through the tunnel. While this adds overhead to round-
trips between the client and the internet, it provides some added
security in return for this, in that the corporate security gateway may
now filter traffic as it would if the remote host were physically
located on the corporate network.

6.5.  Configuration policy

Several mechanisms can be used to enable IPSEC tunnel mode clients to be
assigned different configurations. For example, clients may use the User
Class Option [16] to request various configuration profiles.  The DHCPv4
server may also take a number of other variables into account, including
the chaddr;  the client-identifier option; the DHCP relay option [17];
the vendor-class-identifier option; the vendor-specific information
option; the subnet selection option [15] or the host name option [18].

Conditional configuration of clients, described in [18], can be used to
solve a number of problems, including assignment of options based on the
client operating system; assignment of groups of clients to address
ranges subsequently used to determine quality of service; allocation of
special address ranges for IPSEC tunnel mode clients; special treatment
for various hardware types, assignment of static routes to clients [20],
etc.  As noted in the security considerations, these mechanisms, while



Patel, Aboba, Kelly & Gupta  Standards Track                   [Page 10]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


useful, do not enhance security since they can be evaded by a client
choosing its own IP address.

Note that in the case of a dialup client, the chaddr will typically
change between reboots so that the client SHOULD include the client
identifier option in its DHCPDISCOVER message.  The client identifier
option MUST be unique; thus a unique identifier such as the client FQDN
concatenated with the interface name and a number can be used, in the
form of an ASCII null terminated string.

7.  References


[1]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
     Levels", BCP 14, RFC 2119, March 1997.

[2]  Atkinson, R., Kent, S., "Security Architecture for the Internet
     Protocol", RFC 2401, November 1998.

[3]  Droms, R., "Dynamic Host Configuration Protocol", RFC 2131, March
     1997.

[4]  McGregor, G., "The PPP Internet Protocol Control Protocol (IPCP)",
     RFC 1332, May 1992.

[5]  Alexander, S., Droms, R., "DHCP Options and BOOTP Vendor
     Extensions", RFC 2132, March 1997.

[6]  Droms, R., Arbaugh, W., "Authentication for DHCP Messages",
     Internet draft (work in progress), draft-ietf-dhc-
     authentication-14.txt, July 2000.

[7]  Cobb, S., "PPP Internet Protocol Control Protocol Extensions for
     Name Server Addresses", RFC 1877, December 1995.

[8]  Droms, R., Kinnear, K., Stapp, M., Volz, B., Gonczi, S., Rabil, G.,
     Dooley, M., Kapur, A., "DHCP Failover Protocol", Internet draft
     (work in progress), draft-ietf-dhc-failover-07.txt, July 2000.

[9]  Kent,S., Atkinson, R., "IP Authentication Header", RFC 2402,
     November 1998.

[10] Kent,S., Atkinson, R., "IP Encapsulating Security Payload (ESP)",
     RFC 2406, November 1998.

[11] Piper, D., "The Internet IP Security Domain of Interpretation of
     ISAKMP", RFC 2407, November 1998.




Patel, Aboba, Kelly & Gupta  Standards Track                   [Page 11]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


[12] Harkins, D., Carrel, D., "The Internet Key Exchange (IKE)", RFC
     2409, November 1998.

[13] Dukes, D., Pereira, R., "The ISAKMP Configuration Method", Internet
     draft (work in progress), draft-dukes-ike-mode-cfg-00.txt, October
     2000.

[14] De Schrijver, P., T'Joens, Y., Hublet, C., "Dynamic host
     configuration : DHCP reconfigure extension", Internet draft (work
     in progress), draft-ietf-dhc-pv4-reconfigure-01.txt, June 2000.

[15] Waters, G., "The IPv4 Subnet Selection Option for DHCP", Internet
     draft (work in progress), draft-ietf-dhc-subnet-option-07.xt,
     September 2000.

[16] Stump, G., Droms, R., Gu, Y., Vyaghrapuri, R., Demirtjis, A.,
     Beser, B., Privat, J., "The User Class Option for DHCP", Internet
     draft (work in progress), draft-ietf-dhc-userclass-10.txt, August
     2000.

[17] Patrick, M., "DHCP Relay Agent Information Option", Internet draft
     (work in progress), draft-ietf-dhc-agent-options-12.txt, October
     2000.

[18] Droms, R., and Lemon, T., The DHCP Handbook, Macmillan,
     Indianapolis, Indiana, 1999.

[19] Volz, B., Gonczi, S., Lemon, T., Stevens, R., "DHC Load Balancing
     Algorithm", Internet draft (work in progress), draft-ietf-dhc-
     loadb-02.txt, June 2000.

[20] Lemon, T., "The Classless Static Route Option for DHCP", Internet
     draft (work in progress), draft-ietf-dhc-csr-02.txt, June 2000.

[21] Kelly, S., Ramamoorthi, S., "Requirements for IPSEC Remote Access
     Scenarios", Internet draft (work in progress), draft-ietf-ipsra-
     reqmts-02.txt, November 2000.

8.  Security Considerations

This protocol is secured using IPSEC, and as a result the DHCP packets
flowing between the client and the security gateway are authenticated
and integrity protected.

However, since the security gateway acts as a DHCP Relay, no protection
is afforded the DHCP packets in the portion of the path between the
security gateway and the DHCP server, unless DHCP authentication is
used.



Patel, Aboba, Kelly & Gupta  Standards Track                   [Page 12]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


Note that authenticated DHCP cannot be used as an access control
mechanism. This is because a client can always set its own IP address
and thus evade any  security measures based DHCP authentication.

As a result, the assigned address MUST NOT be depended upon for
security. Instead, the security gateway can use other techniques such as
instantiating packet filters or quick mode selectors on a per-tunnel
basis.

9.  IANA Considerations

This draft requires that an htype value be allocated for use with IPSEC
tunnel mode. Since DHCP and ARP share the same hardware type space, this
implies that a new ARP hrd will be created in the process, though it
will not be used with ARP. No new number spaces are created for IANA
administration.

10.  Acknowledgments

This draft has been enriched by comments from John Richardson and
Prakash Iyer of Intel, Gurdeep Pall and Peter Ford of Microsoft.

11.  Authors' Addresses

Baiju V. Patel
Intel Corp, JF3-206
2511 NE 25th Ave
Hillsboro, OR 97124

Phone: +1 503 264-2422
EMail: baiju.v.patel@intel.com

Bernard Aboba
Microsoft Corporation
One Microsoft Way
Redmond, WA 98052

Phone: +1 425 936-6605
EMail: bernarda@microsoft.com

Scott Kelly
RedCreek Communications
3900 Newpark Mall Road
Newark, CA 94560

Phone: +1 510 745-3969
Email: skelly@redcreek.com




Patel, Aboba, Kelly & Gupta  Standards Track                   [Page 13]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


Vipul Gupta
Sun Microsystems, Inc.
901 San Antonio Rd.
Palo Alto, CA 94303

Phone: +1 650 786 3614
Fax: +1 650 786 6445
EMail: vipul.gupta@eng.sun.com

12.  Intellectual Property Statement

The IETF takes no position regarding the validity or scope of any
intellectual property or other rights that might be claimed to  pertain
to the implementation or use of the technology described in this
document or the extent to which any license under such rights might or
might not be available; neither does it represent that it has made any
effort to identify any such rights.  Information on the IETF's
procedures with respect to rights in standards-track and standards-
related documentation can be found in BCP-11.  Copies of claims of
rights made available for publication and any assurances of licenses to
be made available, or the result of an attempt made to obtain a general
license or permission for the use of such proprietary rights by
implementors or users of this specification can be obtained from the
IETF Secretariat.

The IETF invites any interested party to bring to its attention any
copyrights, patents or patent applications, or other proprietary rights
which may cover technology that may be required to practice this
standard.  Please address the information to the IETF Executive
Director.

13.  Full Copyright Statement

Copyright (C) The Internet Society (2000).  All Rights Reserved.
This document and translations of it may be copied and furnished to
others, and derivative works that comment on or otherwise explain it or
assist in its implementation may be prepared, copied, published and
distributed, in whole or in part, without restriction of any kind,
provided that the above copyright notice and this paragraph are included
on all such copies and derivative works.  However, this document itself
may not be modified in any way, such as by removing the copyright notice
or references to the Internet Society or other Internet organizations,
except as needed for the purpose of developing Internet standards in
which case the procedures for copyrights defined in the Internet
Standards process must be followed, or as required to translate it into
languages other than English.  The limited permissions granted above are
perpetual and will not be revoked by the Internet Society or its
successors or assigns.  This document and the information contained



Patel, Aboba, Kelly & Gupta  Standards Track                   [Page 14]





INTERNET-DRAFT     DHCPv4 Config. of IPSEC Tunnel Mode  20 November 2000


herein is provided on an "AS IS" basis and THE INTERNET SOCIETY AND THE
INTERNET ENGINEERING TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE."

14.  Expiration Date

This memo is filed as <draft-ietf-ipsec-dhcp-08.txt>,  and  expires July
1, 2001.









































Patel, Aboba, Kelly & Gupta  Standards Track                   [Page 15]


