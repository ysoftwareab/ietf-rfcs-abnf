<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>HTTP Authentication: MAC Access Authentication</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Example">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Notational Conventions">
<link href="#rfc.section.2" rel="Chapter" title="2 Issuing MAC Credentials">
<link href="#rfc.section.3" rel="Chapter" title="3 Making Requests">
<link href="#rfc.section.3.1" rel="Chapter" title='3.1 The "Authorization" Request Header'>
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Body Hash">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Request MAC">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 Normalized Request String">
<link href="#rfc.section.3.3.2" rel="Chapter" title="3.3.2 hmac-sha-1">
<link href="#rfc.section.3.3.3" rel="Chapter" title="3.3.3 hmac-sha-256">
<link href="#rfc.section.4" rel="Chapter" title="4 Verifying Requests">
<link href="#rfc.section.4.1" rel="Chapter" title='4.1 The "WWW-Authenticate" Response Header Field'>
<link href="#rfc.section.5" rel="Chapter" title="5 Use with OAuth 2.0">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Issuing MAC-Type Access Tokens">
<link href="#rfc.section.6" rel="Chapter" title="6 Use with Set-Cookie">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 User Agent Requirements">
<link href="#rfc.section.6.1.1" rel="Chapter" title="6.1.1 The Set-Cookie Header">
<link href="#rfc.section.6.1.1.1" rel="Chapter" title="6.1.1.1 The MAC-Key attribute">
<link href="#rfc.section.6.1.1.2" rel="Chapter" title="6.1.1.2 The MAC-Algorithm attribute">
<link href="#rfc.section.6.1.2" rel="Chapter" title="6.1.2 Storage Model">
<link href="#rfc.section.6.1.3" rel="Chapter" title="6.1.3 The Authorization Header">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 MAC Keys Transmission">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Confidentiality of Requests">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 Spoofing by Counterfeit Servers">
<link href="#rfc.section.7.4" rel="Chapter" title="7.4 Plaintext Storage of Credentials">
<link href="#rfc.section.7.5" rel="Chapter" title="7.5 Entropy of MAC Keys">
<link href="#rfc.section.7.6" rel="Chapter" title="7.6 Denial of Service / Resource Exhaustion Attacks">
<link href="#rfc.section.7.7" rel="Chapter" title="7.7 Timing Attacks">
<link href="#rfc.section.7.8" rel="Chapter" title="7.8 CSRF Attacks">
<link href="#rfc.section.7.9" rel="Chapter" title="7.9 Coverage Limitations">
<link href="#rfc.section.7.10" rel="Chapter" title="7.10 Version Rollback Attack">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 The HTTP MAC Authentication Scheme Algorithm Registry">
<link href="#rfc.section.8.1.1" rel="Chapter" title="8.1.1 Registration Template">
<link href="#rfc.section.8.1.2" rel="Chapter" title="8.1.2 Initial Registry Contents">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 OAuth Access Token Type Registration">
<link href="#rfc.section.8.2.1" rel="Chapter" title='8.2.1 The "mac" OAuth Access Token Type'>
<link href="#rfc.section.8.3" rel="Chapter" title="8.3 OAuth Parameters Registration">
<link href="#rfc.section.8.3.1" rel="Chapter" title='8.3.1 The "secret" OAuth Parameter'>
<link href="#rfc.section.8.3.2" rel="Chapter" title='8.3.2 The "algorithm" OAuth Parameter'>
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document specifies the HTTP MAC access authentication scheme, an HTTP authentication method using a message authentication code (MAC) algorithm to provide cryptographic verification of portions of HTTP requests. The document also defines an OAuth 2.0 binding for use as an access-token type, as well as an extension attribute to the HTTP Set-Cookie response header field.  " />
  <meta name="description" content="This document specifies the HTTP MAC access authentication scheme, an HTTP authentication method using a message authentication code (MAC) algorithm to provide cryptographic verification of portions of HTTP requests. The document also defines an OAuth 2.0 binding for use as an access-token type, as well as an extension attribute to the HTTP Set-Cookie response header field.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">E. Hammer-Lahav</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Yahoo!</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">A. Barth</td>
</tr>
<tr>
<td class="left">Expires: October 31, 2011</td>
<td class="right">Google</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">B. Adida</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Mozilla</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">April 29, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">HTTP Authentication: MAC Access Authentication<br />
  <span class="filename">draft-hammer-oauth-v2-mac-token-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document specifies the HTTP MAC access authentication scheme, an HTTP authentication method using a message authentication code (MAC) algorithm to provide cryptographic verification of portions of HTTP requests. The document also defines an OAuth 2.0 binding for use as an access-token type, as well as an extension attribute to the HTTP Set-Cookie response header field.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on October 31, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Example</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Notational Conventions</a>
</li>
<li>2.   <a href="#rfc.section.2">Issuing MAC Credentials</a>
</li>
<li>3.   <a href="#rfc.section.3">Making Requests</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">The "Authorization" Request Header</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Body Hash</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Request MAC</a>
</li>
<li>3.3.1.   <a href="#rfc.section.3.3.1">Normalized Request String</a>
</li>
<li>3.3.2.   <a href="#rfc.section.3.3.2">hmac-sha-1</a>
</li>
<li>3.3.3.   <a href="#rfc.section.3.3.3">hmac-sha-256</a>
</li>
<li>4.   <a href="#rfc.section.4">Verifying Requests</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">The "WWW-Authenticate" Response Header Field</a>
</li>
<li>5.   <a href="#rfc.section.5">Use with OAuth 2.0</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Issuing MAC-Type Access Tokens</a>
</li>
<li>6.   <a href="#rfc.section.6">Use with Set-Cookie</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">User Agent Requirements</a>
</li>
<li>6.1.1.   <a href="#rfc.section.6.1.1">The Set-Cookie Header</a>
</li>
<li>6.1.1.1.   <a href="#rfc.section.6.1.1.1">The MAC-Key attribute</a>
</li>
<li>6.1.1.2.   <a href="#rfc.section.6.1.1.2">The MAC-Algorithm attribute</a>
</li>
<li>6.1.2.   <a href="#rfc.section.6.1.2">Storage Model</a>
</li>
<li>6.1.3.   <a href="#rfc.section.6.1.3">The Authorization Header</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">MAC Keys Transmission</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">Confidentiality of Requests</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">Spoofing by Counterfeit Servers</a>
</li>
<li>7.4.   <a href="#rfc.section.7.4">Plaintext Storage of Credentials</a>
</li>
<li>7.5.   <a href="#rfc.section.7.5">Entropy of MAC Keys</a>
</li>
<li>7.6.   <a href="#rfc.section.7.6">Denial of Service / Resource Exhaustion Attacks</a>
</li>
<li>7.7.   <a href="#rfc.section.7.7">Timing Attacks</a>
</li>
<li>7.8.   <a href="#rfc.section.7.8">CSRF Attacks</a>
</li>
<li>7.9.   <a href="#rfc.section.7.9">Coverage Limitations</a>
</li>
<li>7.10.   <a href="#rfc.section.7.10">Version Rollback Attack</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>8.1.   <a href="#rfc.section.8.1">The HTTP MAC Authentication Scheme Algorithm Registry</a>
</li>
<li>8.1.1.   <a href="#rfc.section.8.1.1">Registration Template</a>
</li>
<li>8.1.2.   <a href="#rfc.section.8.1.2">Initial Registry Contents</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">OAuth Access Token Type Registration</a>
</li>
<li>8.2.1.   <a href="#rfc.section.8.2.1">The "mac" OAuth Access Token Type</a>
</li>
<li>8.3.   <a href="#rfc.section.8.3">OAuth Parameters Registration</a>
</li>
<li>8.3.1.   <a href="#rfc.section.8.3.1">The "secret" OAuth Parameter</a>
</li>
<li>8.3.2.   <a href="#rfc.section.8.3.2">The "algorithm" OAuth Parameter</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgments</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">This specification defines the HTTP MAC access authentication scheme, providing a method for making authenticated HTTP requests, with partial cryptographic verification of the request covering the HTTP method, request URI, host, and in some cases the request body.  </p>
<p id="rfc.section.1.p.2">Similar to the HTTP Basic access authentication scheme <a href="#RFC2617">[RFC2617]</a>, the MAC scheme utilizes a set of client credentials which include an identifier and key. However, in contrast with the Basic scheme, the key is never included in authenticated requests but is used to calculate the request MAC value which is included instead.  </p>
<p id="rfc.section.1.p.3">[[ Add note about design constraints (eg sign an HTTP request without any interactivity with the server; suitable for shared secret keys, but not for shared passwords) ]] </p>
<p id="rfc.section.1.p.4">The MAC scheme requires the establishment of a shared symmetric key between the client and the server. This is often accomplished through a manual process such as client registration. This specification defines two methods for issuing a set of MAC credentials to the client using: </p>
<p></p>

<ul>
<li>OAuth 2.0 in the form of a MAC-type access token, using any supported OAuth grant type.  </li>
<li>The HTTP <samp>Set-Cookie</samp> response header field via an extension attribute.  </li>
</ul>

<p> </p>
<p id="rfc.section.1.p.6">Please discuss this draft on the <a href="https://www.ietf.org/mailman/listinfo/apps-discuss">apps-discuss@ietf.org</a> mailing list.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Example</h1>
<p id="rfc.section.1.1.p.1">The client attempts to access a protected resource without authentication, making the following HTTP request to the resource server: </p>
<div id="#rfc.figure.1"></div>
<pre>
            
  GET /resource/1?b=1&amp;a=2 HTTP/1.1
  Host: example.com

          </pre>
<p id="rfc.section.1.1.p.2">The resource server returns the following authentication challenge: </p>
<div id="#rfc.figure.2"></div>
<pre>
            
  HTTP/1.1 401 Unauthorized
  WWW-Authenticate: MAC
  Date: Thu, 02 Dec 2010 21:39:45 GMT

          </pre>
<p id="rfc.section.1.1.p.3">The client has previously obtained a set of MAC credentials for accessing resources on the <samp>http://example.com/</samp> server. The MAC credentials issued to the client include the following attributes: </p>
<p></p>

<dl>
<dt>MAC key identifier:</dt>
<dd style="margin-left: 6">h480djs93hd8</dd>
<dt>MAC key:</dt>
<dd style="margin-left: 6">489dks293j39</dd>
<dt>MAC algorithm:</dt>
<dd style="margin-left: 6">hmac-sha-1</dd>
<dt>Issuer:</dt>
<dd style="margin-left: 6">login.example.net:443</dd>
</dl>

<p> </p>
<p id="rfc.section.1.1.p.5">The client constructs the authentication header by calculating the current timestamp and generating a nonce. The nonce is unique to the timestamp used, typically a random string: </p>
<p></p>

<dl>
<dt>Timestamp:</dt>
<dd style="margin-left: 6">137131200</dd>
<dt>Nonce:</dt>
<dd style="margin-left: 6">dj83hs9s</dd>
</dl>

<p> </p>
<p id="rfc.section.1.1.p.7">The client normalizes the request and constructs the normalized request string (the new line separator character is represented by <samp>\n</samp> for display purposes only): </p>
<div id="#rfc.figure.3"></div>
<pre>
            
  login.example.net:443\n
  137131200\n
  dj83hs9s\n
  GET\n
  /resource/1?b=1&amp;a=2\n
  example.com\n
  80\n
  \n

          </pre>
<p id="rfc.section.1.1.p.8">The request MAC is calculated using the specified MAC algorithm <samp>hmac-sha-1</samp> and the MAC key over the normalized request string. The result is base64-encoded to produce the request MAC: </p>
<div id="#rfc.figure.4"></div>
<pre>
            
  JDS+y7WYyrHaNGq5lVgK+Y9ogKI=

          </pre>
<p id="rfc.section.1.1.p.9">The client includes the MAC key identifier, issuer, timestamp, nonce, and request MAC with the request using the <samp>Authorization</samp> request header field: </p>
<div id="#rfc.figure.5"></div>
<pre>
            
  GET /resource/1 HTTP/1.1
  Host: example.com
  Authorization: MAC id="h480djs93hd8",
                     issuer="login.example.net:443",
                     timestamp="137131200",
                     nonce="dj83hs9s",
                     mac="JDS+y7WYyrHaNGq5lVgK+Y9ogKI="

          </pre>
<p id="rfc.section.1.1.p.10">The server validates the request by calculating the request MAC again based on the request received and verifies the validity and scope of the MAC credentials. If valid, the server responds with the requested representation.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Notational Conventions</h1>
<p id="rfc.section.1.2.p.1">The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY', and 'OPTIONAL' in this specification are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<p id="rfc.section.1.2.p.2">This specification uses the Augmented Backus-Naur Form (ABNF) notation of <a href="#I-D.ietf-httpbis-p1-messaging">[I-D.ietf-httpbis-p1-messaging]</a>. Additionally, the following rules are included from [RFC2617]: auth-param.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#issue" id="issue">Issuing MAC Credentials</a>
</h1>
<p id="rfc.section.2.p.1">This specification defines two method for issuing MAC credentials using OAuth 2.0 as described in <a href="#oauth2">Section 5</a> and using the HTTP <samp>Set-Cookie</samp> response header field as described in <a href="#cookie">Section 6</a>.  </p>
<p id="rfc.section.2.p.2">This specification does not mandate servers to support any particular method for issuing MAC credentials, and other methods can be defined. Whenever MAC credentials are issued, the credentials MUST include the following attributes: </p>
<p></p>

<dl>
<dt>MAC key identifier</dt>
<dd style="margin-left: 6">
<br> A string identifying the MAC key used to calculate the request MAC. The string is usually opaque to the client. The server typically assigns a specific scope and lifetime to each set of MAC credentials. The identifier MAY denote a unique value used to retrieve the authorization information (e.g. from a database), or self-contain the authorization information in a verifiable manner (i.e. a string consisting of some data and a signature).  </dd>
<dt>MAC key</dt>
<dd style="margin-left: 6">
<br> A shared symmetric secret used as the MAC algorithm key.  </dd>
<dt>MAC algorithm</dt>
<dd style="margin-left: 6">
<br> A MAC algorithm used to calculate the request MAC. Value MUST be one of <samp>hmac-sha-1</samp>, <samp>hmac-sha-256</samp>, or a registered extension algorithm name as described in <a href="#registry">Section 8.1</a>.  </dd>
<dt>Issuer</dt>
<dd style="margin-left: 6">
<br> A string identifying the entity issuing the credentials. The content and format of the issuer attribute depends on the method used to obtain the credentials.  </dd>
</dl>

<p> </p>
<div id="#rfc.figure.6"></div>
<p>The MAC key identifier, MAC key, MAC algorithm, and issuer strings MUST NOT include characters other than: </p>
<pre>
          
  DIGIT / ALPHA / %x20-21 / %x23-5B / %x5D-7E
  ; Any printable ASCII character except for &lt;"&gt; and &lt;\&gt;

        </pre>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#requests" id="requests">Making Requests</a>
</h1>
<p id="rfc.section.3.p.1">To make authenticated requests, the client must be in the possession of a valid set of MAC credentials accepted by the server. The client constructs the request by calculating a set of attributes, and adding them to the HTTP request using the <samp>Authorization</samp> request header field as described in <a href="#authz_header">Section 3.1</a>.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#authz_header" id="authz_header">The "Authorization" Request Header</a>
</h1>
<p id="rfc.section.3.1.p.1">The <samp>Authorization</samp> request header field uses the framework defined by <a href="#RFC2617">[RFC2617]</a> as follows: </p>
<div id="#rfc.figure.7"></div>
<pre>
            
  credentials    = 'MAC' [ RWS 1#param ]
  
  param          = id /
                   issuer /
                   timestamp /
                   nonce /
                   body-hash /
                   mac

  id             = 'id' '=' &lt;"&gt; plain-string &lt;"&gt;
  issuer         = 'issuer' '=' &lt;"&gt; plain-string &lt;"&gt;
  timestamp      = 'timestamp' '=' &lt;"&gt; 1*DIGIT &lt;"&gt;
  nonce          = 'nonce' '=' &lt;"&gt; plain-string &lt;"&gt;
  body-hash      = 'bodyhash' '=' &lt;"&gt; plain-string &lt;"&gt;
  mac            = 'mac' '=' &lt;"&gt; plain-string &lt;"&gt;
  
  plain-string   = 1*( DIGIT / ALPHA / %x20-21 / %x23-5B / %x5D-7E )

          </pre>
<p id="rfc.section.3.1.p.2">The header attributes are set as follows: </p>
<p></p>

<dl>
<dt>id</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The MAC key identifier.  </dd>
<dt>issuer</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The identifier of the entity who issued the MAC credentials.  </dd>
<dt>timestamp</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The current time expressed in the number of seconds since January 1, 1970 00:00:00 GMT, and MUST be a positive integer. The timestamp value MUST NOT include leading zeros (e.g. "000137131200").  </dd>
<dt>nonce</dt>
<dd style="margin-left: 6">
<br> REQUIRED. A random string, uniquely generated by the client to allow the server to verify that a request has never been made before and helps prevent replay attacks when requests are made over an insecure channel. The nonce value MUST be unique across all requests with the same timestamp and MAC key identifier combination.  <br> To avoid the need to retain an infinite number of nonce values for future checks, servers MAY choose to restrict the time period after which a request with an old timestamp is rejected.  Such a restriction implies a level of synchronization between the client's and server's clocks. The client MAY use the <samp>Date</samp> response header field to synchronize its clock after a failed request.  </dd>
<dt>bodyhash</dt>
<dd style="margin-left: 6">
<br> OPTIONAL. The HTTP request payload body hash as described in <a href="#body-hash">Section 3.2</a>.  </dd>
<dt>mac</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The HTTP request MAC as described in <a href="#mac">Section 3.3</a>.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.1.p.4">Attributes MUST NOT appear more than once. Attribute values are limited to a subset of ASCII, which does not require escaping, as defined by the plain-string ABNF.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#body-hash" id="body-hash">Body Hash</a>
</h1>
<p id="rfc.section.3.2.p.1">[[ Need to figure out exactly when body-hash is required ]] </p>
<p id="rfc.section.3.2.p.2">The body hash is used to provide integrity verification of the HTTP request payload body.  The body hash value is calculated using a hash algorithm over the entire HTTP request payload body.  </p>
<p id="rfc.section.3.2.p.3">The client MAY include the body hash with any request. The server SHOULD require the calculation and inclusion of the body hash with any request containing an payload body, or when the presence (or lack of) of an payload body is of significance.  </p>
<p id="rfc.section.3.2.p.4">The body hash algorithm is determined by the MAC algorithm. The SHA-1 hash algorithm as defined by <a href="#NIST%20FIPS-180-3">[NIST FIPS-180-3]</a> is used with the <samp>hmac-sha-1</samp> MAC algorithm. The SHA-256 hash algorithm as defined by <a href="#NIST%20FIPS-180-3">[NIST FIPS-180-3]</a> is used with the <samp>hmac-sha-256</samp> MAC algorithm. Additional MAC algorithms MUST specify the corresponding body hash algorithm.  </p>
<p id="rfc.section.3.2.p.5">The body hash is calculated as follows: </p>
<div id="#rfc.figure.8"></div>
<pre>
            
  bodyhash = BASE64 ( HASH (text) )

          </pre>
<p id="rfc.section.3.2.p.6">Where: </p>
<p></p>

<dl>
<dt>HASH</dt>
<dd style="margin-left: 6">
<br> is the hash algorithm function, </dd>
<dt>text</dt>
<dd style="margin-left: 6">
<br> is the HTTP request payload body, </dd>
<dt>BASE64</dt>
<dd style="margin-left: 6">
<br> is the base64-encoding function per <a href="#RFC2045">[RFC2045]</a> section 6.8, applied to the hash result octet string, and </dd>
<dt>bodyhash</dt>
<dd style="margin-left: 6">
<br> is the value used in the normalized request string and to set the <samp>bodyhash</samp> attribute of the <samp>Authorization</samp> request header field.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.2.p.8">The body hash is calculated before the normalized request string is constructed and the request MAC is calculated.  </p>
<div id="#rfc.figure.9"></div>
<p>For example, the HTTP request: </p>
<pre>
            
  POST /request HTTP/1.1
  Host: example.com
  Content-Type: application/x-www-form-urlencoded

  hello=world%21

          </pre>
<div id="#rfc.figure.10"></div>
<p>using MAC key identifier <samp>h480djs93hd8</samp>, issuer <samp>login.example.com:443</samp>, timestamp <samp>137131200</samp>, nonce <samp>dj83hs9s</samp>, MAC algorithm <samp>hmac-sha-1</samp>, and MAC key <samp>8yfrufh348h</samp>, is transmitted as (line breaks are for display purposes only): </p>
<pre>
            
  POST /request HTTP/1.1
  Host: example.com
  Content-Type: application/x-www-form-urlencoded
  Authorization: MAC id="h480djs93hd8",
                     issuer="login.example.com:443",
                     timestamp="137131200",
                     nonce="dj83hs9s",
                     bodyhash="k9kbtCIy0CkI3/FEfpS/oIDjk6k=",
                     mac="CAGsmhyPtRFdN662zethhZLztEc="

  hello=world%21

          </pre>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#mac" id="mac">Request MAC</a>
</h1>
<p id="rfc.section.3.3.p.1">The client uses the MAC algorithm and the MAC key to calculate the request MAC. This specification defines two algorithms: <samp>hmac-sha-1</samp> and <samp>hmac-sha-256</samp>, and provides an extension registry for additional algorithms.  </p>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> <a href="#base_string" id="base_string">Normalized Request String</a>
</h1>
<p id="rfc.section.3.3.1.p.1">The normalized request string is a consistent, reproducible concatenation of several of the HTTP request elements into a single string. By normalizing the request into a reproducible string, the client and server can both calculate the request MAC over the exact same value.  </p>
<p id="rfc.section.3.3.1.p.2">The string is constructed by concatenating together, in order, the following HTTP request elements, each followed by a new line character (%x0A): </p>
<p></p>

<ol>
<li>The MAC credentials issuer identifier exactly as included with the request using the <samp>issuer</samp> attribute.  </li>
<li>The timestamp value calculated for the request.  </li>
<li>The nonce value generated for the request.  </li>
<li>The HTTP request method in upper case. For example: <samp>HEAD</samp>, <samp>GET</samp>, <samp>POST</samp>, etc.  </li>
<li>The HTTP request-URI as defined by <a href="#RFC2616">[RFC2616]</a> section 5.1.2.  </li>
<li>The hostname included in the HTTP request using the <samp>Host</samp> request header field in lower case.  </li>
<li>The port as included in the HTTP request using the <samp>Host</samp> request header field. If the header field does not include a port, the default value for the scheme MUST be used (e.g. 80 for HTTP and 443 for HTTPS).  </li>
<li>The request payload body hash as described in <a href="#body-hash">Section 3.2</a> if one was calculated and included in the request, otherwise, an empty string. Note that the body hash of an empty payload body is not an empty string.  </li>
</ol>

<p> </p>
<p id="rfc.section.3.3.1.p.4">Each element is followed by a new line character (%x0A) regardless of its position in the list, or if its value is an empty string.  </p>
<div id="#rfc.figure.11"></div>
<p>For example, the HTTP request: </p>
<pre>
              
  POST /request?b5=%3D%253D&amp;a3=a&amp;c%40=&amp;a2=r%20b&amp;c2&amp;a3=2+q HTTP/1.1
  Host: example.com

  Hello World!

            </pre>
<p>using MAC key identifier <samp>kkk9d7dh3k39sjv7</samp>, issuer <samp>login.example.com:443</samp>, timestamp <samp>137131201</samp>, nonce <samp>7d8f3e4a</samp>, and body hash <samp>Lve95gjOVATpfV8EL5X4nxwjKHE=</samp> is normalized into the following string (the new line separator character is represented by <samp>\n</samp> for display purposes only): </p>
<div id="#rfc.figure.12"></div>
<pre>
              
  kkk9d7dh3k39sjv7\n
  login.example.com:443\n
  137131201\n
  7d8f3e4a\n
  POST\n
  /request?b5=%3D%253D&amp;a3=a&amp;c%40=&amp;a2=r%20b&amp;c2&amp;a3=2+q\n
  example.com\n
  80\n
  Lve95gjOVATpfV8EL5X4nxwjKHE=\n

            </pre>
<h1 id="rfc.section.3.3.2">
<a href="#rfc.section.3.3.2">3.3.2.</a> hmac-sha-1</h1>
<p><samp>hmac-sha-1</samp> uses the HMAC-SHA1 algorithm as defined in <a href="#RFC2104">[RFC2104]</a>: </p>
<div id="#rfc.figure.13"></div>
<pre>
              
  mac = HMAC-SHA1 (key, text)

            </pre>
<p id="rfc.section.3.3.2.p.2">Where: </p>
<p></p>

<dl>
<dt>text</dt>
<dd style="margin-left: 6">
<br> is set to the value of the normalized request string as described in <a href="#base_string">Section 3.3.1</a>, </dd>
<dt>key</dt>
<dd style="margin-left: 6">
<br> is set to the MAC key provided by the server, and </dd>
<dt>mac</dt>
<dd style="margin-left: 6">
<br> is used to set the value of the <samp>mac</samp> attribute, after the result octet string is base64-encoded per <a href="#RFC2045">[RFC2045]</a> section 6.8.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.3.2.p.4">The SHA-1 hash algorithm as defined by <a href="#NIST%20FIPS-180-3">[NIST FIPS-180-3]</a> is used for generating the body hash attribute described in <a href="#body-hash">Section 3.2</a> when using MAC credentials with the <samp>hmac-sha-1</samp> MAC algorithm.  </p>
<h1 id="rfc.section.3.3.3">
<a href="#rfc.section.3.3.3">3.3.3.</a> hmac-sha-256</h1>
<p><samp>hmac-sha-256</samp> uses the HMAC algorithm as defined in <a href="#RFC2104">[RFC2104]</a> together with the SHA-256 hash function defined in <a href="#NIST%20FIPS-180-3">[NIST FIPS-180-3]</a>: </p>
<div id="#rfc.figure.14"></div>
<pre>
              
  mac = HMAC-SHA256 (key, text)

            </pre>
<p id="rfc.section.3.3.3.p.2">Where: </p>
<p></p>

<dl>
<dt>text</dt>
<dd style="margin-left: 6">
<br> is set to the value of the normalize request string as described in <a href="#base_string">Section 3.3.1</a>, </dd>
<dt>key</dt>
<dd style="margin-left: 6">
<br> is set to the MAC key provided by the server, and </dd>
<dt>mac</dt>
<dd style="margin-left: 6">
<br> is used to set the value of the <samp>mac</samp> attribute, after the result octet string is base64-encoded per <a href="#RFC2045">[RFC2045]</a> section 6.8.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.3.3.p.4">The SHA-256 hash algorithm as defined by <a href="#NIST%20FIPS-180-3">[NIST FIPS-180-3]</a> is used for generating the body hash attribute described in <a href="#body-hash">Section 3.2</a> when using MAC credentials with the <samp>hmac-sha-256</samp> MAC algorithm.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#verify_request" id="verify_request">Verifying Requests</a>
</h1>
<p id="rfc.section.4.p.1">A server receiving an authenticated request validates it by performing the following REQUIRED steps: </p>
<p></p>

<ol>
<li>Recalculate the request body hash (if included in the request) as described in <a href="#body-hash">Section 3.2</a> and request MAC as described in <a href="#mac">Section 3.3</a> and compare the request MAC to the value received from the client via the <samp>mac</samp> attribute.  </li>
<li>Ensure that the combination of nonce, timestamp, and MAC key identifier received from the client has not been used before in a previous request (the server MAY reject requests with stale timestamps; the determination of staleness is left up to the server to define).  </li>
<li>Verify the scope and validity of the MAC credentials.  </li>
</ol>

<p> </p>
<p id="rfc.section.4.p.3">If the request fails verification, the server response includes the <samp>WWW-Authenticate</samp> response header field as described in <a href="#authn-header">Section 4.1</a> and SHOULD include one of the following HTTP status codes: </p>
<p></p>

<dl>
<dt>401 (Unauthorized)</dt>
<dd style="margin-left: 6">
<br> The <samp>Authorization</samp> request header field is not included, missing a required parameter, includes an unsupported parameter or parameter value, repeats the same parameter, or is otherwise malformed. The MAC credentials provided are expired, revoked, malformed, or invalid. The body hash or request MAC provided do not match the values calculated by the server, or a body hash is required but missing.  </dd>
<dt>307 (Temporary Redirect)</dt>
<dd style="margin-left: 6">
<br> Same as 401, with the exception that a human intervention at the destination URI (identified by the <samp>Location</samp> response header field) MAY resolve the issue (e.g. provide a login page which upon a successful authentication will issue the user-agent a new set of MAC credentials using the <samp>Set-Cookie</samp> response header field as described in <a href="#cookie">Section 6</a>.  </dd>
<dt>403 (Forbidden)</dt>
<dd style="margin-left: 6">
<br> The <samp>Authorization</samp> request header field is valid, but the request requires higher privileges than provided by the MAC credentials.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#authn-header" id="authn-header">The "WWW-Authenticate" Response Header Field</a>
</h1>
<p id="rfc.section.4.1.p.1">If the protected resource request does not include authentication credentials, contains an invalid MAC key identifier, or is malformed, the server SHOULD include the HTTP <samp>WWW-Authenticate</samp> response header field.  </p>
<div id="#rfc.figure.15"></div>
<p>For example: </p>
<pre>
            
  HTTP/1.1 401 Unauthorized
  WWW-Authenticate: MAC

          </pre>
<p id="rfc.section.4.1.p.2">The <samp>WWW-Authenticate</samp> request header field uses the framework defined by <a href="#RFC2617">[RFC2617]</a> as follows: </p>
<div id="#rfc.figure.16"></div>
<pre>
            
  challenge   = "MAC" [ RWS 1#param ]
  param       = error / auth-param
  error       = "error" "=" quoted-string

          </pre>
<p id="rfc.section.4.1.p.3">Each attribute MUST NOT appear more than once.  </p>
<p id="rfc.section.4.1.p.4">If the protected resource request included a MAC <samp>Authorization</samp> request header field and failed authentication, the server MAY include the <samp>error</samp> attribute to provide the client with a human-readable explanation why the access request was declined.  </p>
<div id="#rfc.figure.17"></div>
<p>For example: </p>
<pre>
            
  HTTP/1.1 401 Unauthorized
  WWW-Authenticate: MAC error="The MAC credentials expired"

          </pre>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#oauth2" id="oauth2">Use with OAuth 2.0</a>
</h1>
<p id="rfc.section.5.p.1">OAuth 2.0 (<a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a>) defines a token-based authentication framework in which third-party applications (clients) access protected resources using access tokens. Access tokens are obtained via the resource owners' authorization from an authorization server. This specification defines the OAuth 2.0 MAC token type, as well as type-specific token attributes.  </p>
<p id="rfc.section.5.p.2">This specification does not define methods for the client to specifically request a MAC-type token from the authorization server. Additionally, it does not include any discovery facilities for identifying which HMAC algorithms are supported by a resource server, or how the client may go about obtaining MAC access tokens for any given protected resource.  </p>
<p id="rfc.section.5.p.3">The authorization server MUST require the use of a transport-layer security mechanism when sending requests to the token endpoint to obtain a MAC token.  </p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Issuing MAC-Type Access Tokens</h1>
<p id="rfc.section.5.1.p.1">Authorization servers issuing MAC-type access tokens MUST include the following parameters whenever a response includes the <samp>access_token</samp> parameter: </p>
<p></p>

<dl>
<dt>access_token</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The MAC key identifier.  </dd>
<dt>secret</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The MAC key.  </dd>
<dt>algorithm</dt>
<dd style="margin-left: 6">
<br> REQUIRED. The MAC algorithm used to calculate the request MAC. Value MUST be one of <samp>hmac-sha-1</samp>, <samp>hmac-sha-256</samp>, or a registered extension algorithm name as described in <a href="#registry">Section 8.1</a>.  </dd>
</dl>

<p> </p>
<p id="rfc.section.5.1.p.3">The issuer attribute MUST be determined by the client alone, and set to the host and port of the token endpoint used to make the HTTP request to obtain the credentials, separated by a colon character (%x3A). For example, 'auth.example.com:443'. If the client followed any redirections before receiving the credentials, it MUST use the host and port of the final request (the request resulting in the transmission of the MAC credential).  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#cookie" id="cookie">Use with Set-Cookie</a>
</h1>
<p id="rfc.section.6.p.1">The HTTP <samp>Set-Cookie </samp> response header field defined in <a href="#RFC6265">[RFC6265]</a> enables the server to set persistent information which the client repeats back on follow-up requests. Each cookie includes a name-value pair which is sent back to the server, and a set of attributes which inform the client when to include the cookie in follow-up requests. The attributes are never sent back to the server.  </p>
<p id="rfc.section.6.p.2">This specification defines the <samp>MAC-Key</samp> and <samp>MAC-Algorithm</samp> cookie attributes, which are used by the server, together with the cookie name which includes the MAC key identifier, to issue the client a set of MAC credentials.  </p>
<p id="rfc.section.6.p.3">The issuer attribute MUST be determined by the client alone, and set to the host and port of the token endpoint used to make the HTTP request to obtain the credentials, separated by a colon character (%x3A). For example, 'auth.example.com:443'. If the client followed any redirections before receiving the credentials, it MUST use the host and port of the final request (the request resulting in the transmission of the credential).  </p>
<p id="rfc.section.6.p.4">The server MUST only include the <samp>MAC-Key</samp> attribute in response to requests made using a transport-layer security mechanism such as TLS 1.2 as defined in <a href="#RFC5246">[RFC5246]</a>. Clients MUST discard any MAC credentials received over an insecure channel.  </p>
<div id="#rfc.figure.18"></div>
<p>For example, after a successful end-user authentication, the server includes the following response header field (line breaks are for display purposes only): </p>
<pre>
          
  Set-Cookie: SID=31d4d96e407aad42; Path=/; Domain=example.com;
              MAC-Key=8yfrufh348h; MAC-Algorithm=hmac-sha-1

        </pre>
<p>which provides the client with the necessary MAC credentials. The cookie name <samp>SID</samp> is used as the MAC key identifier together with the other MAC-specific attributes. The user-agent uses the MAC credentials for subsequent HTTP requests that match the scope of the cookie, in this case for <samp>example.com</samp> and all subdomains.  </p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> User Agent Requirements</h1>
<p id="rfc.section.6.1.p.1">This section updates <a href="#RFC6265">[RFC6265]</a>, adding the ability to issue MAC credentials using the <samp>Set-Cookie </samp> response header field.  </p>
<h1 id="rfc.section.6.1.1">
<a href="#rfc.section.6.1.1">6.1.1.</a> The Set-Cookie Header</h1>
<p id="rfc.section.6.1.1.p.1">Add the following two subsections to the end of Section 5.2 (The Set-Cookie Header) in <a href="#RFC6265">[RFC6265]</a>. These sections instruct the user-agent how to parse the <samp>MAC-Key</samp> attribute and <samp>MAC-Algorithm</samp> attribute, respectively.  </p>
<h1 id="rfc.section.6.1.1.1">
<a href="#rfc.section.6.1.1.1">6.1.1.1.</a> The MAC-Key attribute</h1>
<p id="rfc.section.6.1.1.1.p.1">If the attribute-name case-insensitively matches the string <samp>MAC-Key</samp>, the user-agent MUST append an attribute to the cookie-attribute-list with an attribute name of <samp>MAC-Key</samp> and a attribute-value equal to the attribute-value.  </p>
<h1 id="rfc.section.6.1.1.2">
<a href="#rfc.section.6.1.1.2">6.1.1.2.</a> The MAC-Algorithm attribute</h1>
<p id="rfc.section.6.1.1.2.p.1">If the attribute-name case-insensitively matches the string <samp>MAC-Algorithm</samp>, and if the attribute-value is either <samp>hmac-sha-1</samp>, <samp>hmac-sha-256</samp>, or a registered extension value, the user-agent MUST append an attribute to the cookie-attribute-list with an attribute name of <samp>MAC-Algorithm</samp> and an attribute-value equal to the attribute-value.  </p>
<h1 id="rfc.section.6.1.2">
<a href="#rfc.section.6.1.2">6.1.2.</a> Storage Model</h1>
<p id="rfc.section.6.1.2.p.1">The storage model for cookies is extended with three additional fields: <samp>mac-key</samp>, <samp>mac-algorithm</samp>, and <samp>issuer</samp>, all of which default to the empty string.  </p>
<p id="rfc.section.6.1.2.p.2">The user-agent MUST perform the follow steps after Step 10 of the algorithm in Section 5.3 of <a href="#RFC6265">[RFC6265]</a>: </p>
<p></p>

<ol>
<li>If the cookie-attribute-list contains an attribute with an attribute-name of <samp>MAC-Key</samp>, set the cookie's <samp>mac-key</samp> field to the attribute-value of the last such attribute.  </li>
<li>If the cookie-attribute-list contains an attribute with an attribute-name of <samp>Mac-Algorithm</samp>, set the cookie's <samp>mac-alogrithm</samp> field to the attribute-value of the last such attribute.  </li>
<li>Set the <samp>issuer</samp> field to the canonicalized request-host, as defined in <a href="#RFC6265">[RFC6265]</a> followed by a colon character (%x3A), and the port number of the request-uri (as defined in Section 5.1.2 of <a href="#RFC2616">[RFC2616]</a>).  </li>
</ol>

<p> </p>
<p id="rfc.section.6.1.2.p.4">When the user agent removes excess cookies from the cookie store because there are more than a predetermined number of cookies that share a domain field, or the combined length of cookies sharing a single domain field or being sent in a single request have exceeded a predetermined length, the user agent MUST evict cookies with an empty mac-key or an empty mac-algorithm field before cookies with both a non-empty mac-key and a non-empty mac-algorithm field.  </p>
<h1 id="rfc.section.6.1.3">
<a href="#rfc.section.6.1.3">6.1.3.</a> The Authorization Header</h1>
<p id="rfc.section.6.1.3.p.1">In addition to being sent to the server in the <samp>Cookie</samp> request header field, cookies with <samp>MAC-Key</samp> and <samp>MAC-Algorithm</samp> attributes are also used to compute the <samp>Authorization</samp> request header field as described in <a href="#authz_header">Section 3.1</a>.  </p>
<p id="rfc.section.6.1.3.p.2">The user-agent MAY ignore cookies for the purpose of generating the <samp>Authorization</samp> request header field. For example, the user-agent might wish to ignore cookies when issuing "third-party" requests or use MAC credentials obtained via other means.  </p>
<p id="rfc.section.6.1.3.p.3">When issuing an HTTP request, let cookie-list be the set of cookies defined in Section 5.4 of <a href="#RFC6265">[RFC6265]</a>. Further, let mac-cookie-list be those cookies in the cookie-list that contain both a non-empty <samp>mac-key</samp> and <samp>mac-algorithm</samp> fields.  </p>
<p id="rfc.section.6.1.3.p.4">For each cookie in the mac-cookie-list: include an <samp>Authorization</samp> request header field in the HTTP request as described in <a href="#authz_header">Section 3.1</a> using the cookie MAC credentials where: </p>
<p></p>

<dl>
<dt>MAC key identifier</dt>
<dd style="margin-left: 8">
<br> is equal to the cookie's name, </dd>
<dt>MAC key</dt>
<dd style="margin-left: 8">
<br> is equal to the cookie's <samp>mac-key</samp>, </dd>
<dt>MAC algorithm</dt>
<dd style="margin-left: 8">
<br> is equal to the cookie's <samp>mac-algorithm</samp>, and </dd>
<dt>Issuer</dt>
<dd style="margin-left: 8">is equal to the cookie's <samp>issuer</samp>.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">As stated in <a href="#RFC2617">[RFC2617]</a>, the greatest sources of risks are usually found not in the core protocol itself but in policies and procedures surrounding its use.  Implementers are strongly encouraged to assess how this protocol addresses their security requirements.  </p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> MAC Keys Transmission</h1>
<p id="rfc.section.7.1.p.1">This specification describes two mechanism for obtaining or transmitting MAC keys, both require the use of a transport-layer security mechanism when sending MAC keys to the client. Additional methods used to obtain MAC credentials must ensure that these transmissions are protected using transport-layer mechanisms such as TLS or SSL.  </p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> Confidentiality of Requests</h1>
<p id="rfc.section.7.2.p.1">While this protocol provides a mechanism for verifying the integrity of requests, it provides no guarantee of request confidentiality. Unless further precautions are taken, eavesdroppers will have full access to request content. Servers should carefully consider the kinds of data likely to be sent as part of such requests, and should employ transport-layer security mechanisms to protect sensitive resources.  </p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> Spoofing by Counterfeit Servers</h1>
<p id="rfc.section.7.3.p.1">This protocol makes no attempt to verify the authenticity of the server. A hostile party could take advantage of this by intercepting the client's requests and returning misleading or otherwise incorrect responses. Service providers should consider such attacks when developing services using this protocol, and should require transport-layer security for any requests where the authenticity of the resource server or of request responses is an issue.  </p>
<h1 id="rfc.section.7.4">
<a href="#rfc.section.7.4">7.4.</a> Plaintext Storage of Credentials</h1>
<p id="rfc.section.7.4.p.1">The MAC key functions the same way passwords do in traditional authentication systems. In order to compute the request MAC, the server must have access to the MAC key in plaintext form. This is in contrast, for example, to modern operating systems, which store only a one-way hash of user credentials.  </p>
<p id="rfc.section.7.4.p.2">If an attacker were to gain access to these MAC keys - or worse, to the server's database of all such MAC keys - he or she would be able to perform any action on behalf of any resource owner. Accordingly, it is critical that servers protect these MAC keys from unauthorized access.  </p>
<h1 id="rfc.section.7.5">
<a href="#rfc.section.7.5">7.5.</a> Entropy of MAC Keys</h1>
<p id="rfc.section.7.5.p.1">Unless a transport-layer security protocol is used, eavesdroppers will have full access to authenticated requests and request MAC values, and will thus be able to mount offline brute-force attacks to recover the MAC key used. Servers should be careful to assign MAC keys which are long enough, and random enough, to resist such attacks for at least the length of time that the MAC credentials are valid.  </p>
<p id="rfc.section.7.5.p.2">For example, if the MAC credentials are valid for two weeks, servers should ensure that it is not possible to mount a brute force attack that recovers the MAC key in less than two weeks. Of course, servers are urged to err on the side of caution, and use the longest MAC key reasonable.  </p>
<p id="rfc.section.7.5.p.3">It is equally important that the pseudo-random number generator (PRNG) used to generate these MAC keys be of sufficiently high quality. Many PRNG implementations generate number sequences that may appear to be random, but which nevertheless exhibit patterns or other weaknesses which make cryptanalysis or brute force attacks easier. Implementers should be careful to use cryptographically secure PRNGs to avoid these problems.  </p>
<h1 id="rfc.section.7.6">
<a href="#rfc.section.7.6">7.6.</a> Denial of Service / Resource Exhaustion Attacks</h1>
<p id="rfc.section.7.6.p.1">This specification includes a number of features which may make resource exhaustion attacks against servers possible. For example, this protocol requires servers to track used nonces. If an attacker is able to use many nonces quickly, the resources required to track them may exhaust available capacity. And again, this protocol can require servers to perform potentially expensive computations in order to verify the request MAC on incoming requests. An attacker may exploit this to perform a denial of service attack by sending a large number of invalid requests to the server.  </p>
<p id="rfc.section.7.6.p.2">Resource Exhaustion attacks are by no means specific to this specification. However, implementers should be careful to consider the additional avenues of attack that this protocol exposes, and design their implementations accordingly. For example, entropy starvation typically results in either a complete denial of service while the system waits for new entropy or else in weak (easily guessable) MAC keys. When implementing this protocol, servers should consider which of these presents a more serious risk for their application and design accordingly.  </p>
<h1 id="rfc.section.7.7">
<a href="#rfc.section.7.7">7.7.</a> Timing Attacks</h1>
<p id="rfc.section.7.7.p.1">This specification makes use of HMACs, for which a signature verification involves comparing the received MAC string to the expected one. If the string comparison operator operates in observably different times depending on inputs, e.g. because it compares the strings character by character and returns a negative result as soon as two characters fail to match, then it may be possible to use this timing information to determine the expected MAC, character by character.  </p>
<p id="rfc.section.7.7.p.2">Service implementors are encouraged to use fixed-time string comparators for MAC verification.  </p>
<h1 id="rfc.section.7.8">
<a href="#rfc.section.7.8">7.8.</a> CSRF Attacks</h1>
<p id="rfc.section.7.8.p.1">A Cross-Site Request Forgery attack occurs when a site, evil.com, initiates within the victim's browser the loading of a URL from or the posting of a form to a web site where a side-effect will occur, e.g. transfer of money, change of status message, etc. To prevent this kind of attack, web sites may use various techniques to determine that the originator of the request is indeed the site itself, rather than a third party. The classic approach is to include, in the set of URL parameters or form content, a nonce generated by the server and tied to the user's session, which indicates that only the server could have triggered the action.  </p>
<p id="rfc.section.7.8.p.2">Recently, the Origin HTTP header has been proposed and deployed in some browsers. This header indicates the scheme, host, and port of the originator of a request. Some web applications may use this Origin header as a defense against CSRF.  </p>
<p id="rfc.section.7.8.p.3">To keep this specification simple, HTTP headers are not part of the string to be MAC'ed.  As a result, MAC authentication cannot defend against header spoofing, and a web site that uses the Host header to defend against CSRF attacks cannot use MAC authentication to defend against active network attackers. Sites that want the full protection of MAC Authentication should use traditional, cookie-tied CSRF defenses.  </p>
<h1 id="rfc.section.7.9">
<a href="#rfc.section.7.9">7.9.</a> Coverage Limitations</h1>
<p id="rfc.section.7.9.p.1">The normalized request string has been designed to support the authentication methods defined in this specification. Those designing additional methods, should evaluated the compatibility of the normalized request string with their security requirements.  Since the normalized request string does not cover the entire HTTP request, servers should employ additional mechanisms to protect such elements.  </p>
<p id="rfc.section.7.9.p.2">The request MAC does not cover entity-header fields which can often affect how the request body is interpreted by the server (i.e. Content-Type). If the server behavior is influenced by the presence or value of such header fields, an attacker can manipulate the request header without being detected. This will alter the request even when using the body hash attribute.  </p>
<h1 id="rfc.section.7.10">
<a href="#rfc.section.7.10">7.10.</a> Version Rollback Attack</h1>
<p id="rfc.section.7.10.p.1">[[ TODO ]] </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> <a href="#registry" id="registry">The HTTP MAC Authentication Scheme Algorithm Registry</a>
</h1>
<p id="rfc.section.8.1.p.1">This specification establishes the HTTP MAC authentication scheme algorithm registry.  </p>
<p id="rfc.section.8.1.p.2">Additional MAC algorithms are registered on the advice of one or more Designated Experts (appointed by the IESG or their delegate), with a Specification Required (using terminology from <a href="#RFC5226">[RFC5226]</a>). However, to allow for the allocation of values prior to publication, the Designated Expert(s) may approve registration once they are satisfied that such a specification will be published.  </p>
<p id="rfc.section.8.1.p.3">Registration requests should be sent to the [TBD]@ietf.org mailing list for review and comment, with an appropriate subject (e.g., "Request for MAC Algorithm: example").  [[ Note to RFC-EDITOR: The name of the mailing list should be determined in consultation with the IESG and IANA. Suggested name: http-mac-ext-review. ]] </p>
<p id="rfc.section.8.1.p.4">Within at most 14 days of the request, the Designated Expert(s) will either approve or deny the registration request, communicating this decision to the review list and IANA.  Denials should include an explanation and, if applicable, suggestions as to how to make the request successful.  </p>
<p id="rfc.section.8.1.p.5">Decisions (or lack thereof) made by the Designated Expert can be first appealed to Application Area Directors (contactable using app-ads@tools.ietf.org email address or directly by looking up their email addresses on http://www.iesg.org/ website) and, if the appellant is not satisfied with the response, to the full IESG (using the iesg@iesg.org mailing list).  </p>
<p id="rfc.section.8.1.p.6">IANA should only accept registry updates from the Designated Expert(s), and should direct all requests for registration to the review mailing list.  </p>
<h1 id="rfc.section.8.1.1">
<a href="#rfc.section.8.1.1">8.1.1.</a> Registration Template</h1>
<p></p>

<dl>
<dt>Algorithm name:</dt>
<dd style="margin-left: 8">
<br> The name requested (e.g., "example").  </dd>
<dt>Body hash algorithm:</dt>
<dd style="margin-left: 8">
<br> The corresponding algorithm used to calculate the payload body hash.  </dd>
<dt>Change controller:</dt>
<dd style="margin-left: 8">
<br> For standards-track RFCs, state "IETF". For others, give the name of the responsible party. Other details (e.g., postal address, e-mail address, home page URI) may also be included.  </dd>
<dt>Specification document(s):</dt>
<dd style="margin-left: 8">
<br> Reference to document that specifies the algorithm, preferably including a URI that can be used to retrieve a copy of the document. An indication of the relevant sections may also be included, but is not required.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.8.1.2">
<a href="#rfc.section.8.1.2">8.1.2.</a> Initial Registry Contents</h1>
<p id="rfc.section.8.1.2.p.1">The HTTP MAC authentication scheme algorithm registry's initial contents are: </p>
<p></p>

<ul>
<li>Algorithm name: hmac-sha-1 </li>
<li>Body hash algorithm: sha-1 </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<p></p>

<ul>
<li>Algorithm name: hmac-sha-256 </li>
<li>Body hash algorithm: sha-256 </li>
<li>Change controller: IETF </li>
<li>Specification document(s): [[ this document ]] </li>
</ul>

<p> </p>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> OAuth Access Token Type Registration</h1>
<p id="rfc.section.8.2.p.1">This specification registers the following access token type in the OAuth Access Token Type Registry.  </p>
<h1 id="rfc.section.8.2.1">
<a href="#rfc.section.8.2.1">8.2.1.</a> The "mac" OAuth Access Token Type</h1>
<p></p>

<dl>
<dt>Type name:</dt>
<dd style="margin-left: 8">
<br> mac </dd>
<dt>Additional Token Endpoint Response Parameters:</dt>
<dd style="margin-left: 8">
<br> secret, algorithm </dd>
<dt>HTTP Authentication Scheme(s):</dt>
<dd style="margin-left: 8">
<br> MAC </dd>
<dt>Change controller:</dt>
<dd style="margin-left: 8">
<br> IETF </dd>
<dt>Specification document(s):</dt>
<dd style="margin-left: 8">
<br> [[ this document ]] </dd>
</dl>

<p> </p>
<h1 id="rfc.section.8.3">
<a href="#rfc.section.8.3">8.3.</a> OAuth Parameters Registration</h1>
<p id="rfc.section.8.3.p.1">This specification registers the following parameters in the OAuth Parameters Registry established by <a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a>.  </p>
<h1 id="rfc.section.8.3.1">
<a href="#rfc.section.8.3.1">8.3.1.</a> The "secret" OAuth Parameter</h1>
<p></p>

<dl>
<dt>Parameter name:</dt>
<dd style="margin-left: 8">secret </dd>
<dt>Parameter usage location:</dt>
<dd style="margin-left: 8">authorization response, token response </dd>
<dt>Change controller:</dt>
<dd style="margin-left: 8">IETF </dd>
<dt>Specification document(s):</dt>
<dd style="margin-left: 8">[[ this document ]] </dd>
<dt>Related information:</dt>
<dd style="margin-left: 8">None </dd>
</dl>

<p> </p>
<h1 id="rfc.section.8.3.2">
<a href="#rfc.section.8.3.2">8.3.2.</a> The "algorithm" OAuth Parameter</h1>
<p></p>

<dl>
<dt>Parameter name:</dt>
<dd style="margin-left: 8">algorithm </dd>
<dt>Parameter usage location:</dt>
<dd style="margin-left: 8">authorization response, token response </dd>
<dt>Change controller:</dt>
<dd style="margin-left: 8">IETF </dd>
<dt>Specification document(s):</dt>
<dd style="margin-left: 8">[[ this document ]] </dd>
<dt>Related information:</dt>
<dd style="margin-left: 8">None </dd>
</dl>

<p> </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Acknowledgments</h1>
<p id="rfc.section.9.p.1">The authors would like to thank Rasmus Lerdorf, James Manger, Scott Renfro, Toby White, Peter Wolanin, and Skylar Woodward for their suggestions and feedback.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2045">[RFC2045]</b></td>
<td class="top">
<a href="mailto:ned@innosoft.com" title="Innosoft International, Inc.">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com" title="First Virtual Holdings">N.S. Borenstein</a>, "<a href="http://tools.ietf.org/html/rfc2045">Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</a>", RFC 2045, November 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2104">[RFC2104]</b></td>
<td class="top">
<a href="mailto:hugo@watson.ibm.com" title="IBM, T.J. Watson Research Center">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu" title="University of California at San Diego, Dept of Computer Science and Engineering">Bellare, M.</a> and <a href="mailto:canetti@watson.ibm.com" title="IBM T.J. Watson Research Center">R. Canetti</a>, "<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>", RFC 2104, February 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2616">[RFC2616]</b></td>
<td class="top">
<a href="mailto:fielding@ics.uci.edu" title="Department of Information and Computer Science">Fielding, R.</a>, <a href="mailto:jg@w3.org" title="World Wide Web Consortium">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com" title="Compaq Computer Corporation">Mogul, J.</a>, <a href="mailto:frystyk@w3.org" title="World Wide Web Consortium">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox Corporation">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.</a> and <a href="mailto:timbl@w3.org" title="World Wide Web Consortium">T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2616, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2617">[RFC2617]</b></td>
<td class="top">
<a href="mailto:john@math.nwu.edu" title="Northwestern University, Department of Mathematics">Franks, J.</a>, <a href="mailto:pbaker@verisign.com" title="Verisign Inc.">Hallam-Baker, P.M.</a>, <a href="mailto:jeff@AbiSource.com" title="AbiSource, Inc.">Hostetler, J.L.</a>, <a href="mailto:lawrence@agranat.com" title="Agranat Systems, Inc.">Lawrence, S.D.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.J.</a>, <a title="Netscape Communications Corporation">Luotonen, A.</a> and <a href="mailto:stewart@OpenMarket.com" title="Open Market, Inc.">L. Stewart</a>, "<a href="http://tools.ietf.org/html/rfc2617">HTTP Authentication: Basic and Digest Access Authentication</a>", RFC 2617, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a href="mailto:timbl@w3.org" title="World Wide Web Consortium">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com" title="Day Software">Fielding, R.</a> and <a href="mailto:LMM@acm.org" title="Adobe Systems Incorporated">L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5226">[RFC5226]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 5226, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6265">[RFC6265]</b></td>
<td class="top">
<a>Barth, A.</a>, "<a href="http://tools.ietf.org/html/rfc6265">HTTP State Management Mechanism</a>", RFC 6265, April 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-httpbis-p1-messaging">[I-D.ietf-httpbis-p1-messaging]</b></td>
<td class="top">
<a>Fielding, R</a>, <a>Gettys, J</a>, <a>Mogul, J</a>, <a>Nielsen, H</a>, <a>Masinter, L</a>, <a>Leach, P</a>, <a>Berners-Lee, T</a> and <a>J Reschke</a>, "<a href="http://tools.ietf.org/html/draft-ietf-httpbis-p1-messaging-13">HTTP/1.1, part 1: URIs, Connections, and Message Parsing</a>", Internet-Draft draft-ietf-httpbis-p1-messaging-13, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</b></td>
<td class="top">
<a>Hammer-Lahav, E</a>, <a>Recordon, D</a> and <a>D Hardt</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-15">The OAuth 2.0 Authorization Protocol</a>", Internet-Draft draft-ietf-oauth-v2-15, April 2011.</td>
</tr>
<tr>
<td class="reference"><b id="W3C.REC-html401-19991224">[W3C.REC-html401-19991224]</b></td>
<td class="top">
<a>Raggett, D.</a>, <a>Hors, A.</a> and <a>I. Jacobs</a>, "<a>HTML 4.01 Specification</a>", World Wide Web Consortium Recommendation REC-html401-19991224, December 1999.</td>
</tr>
<tr>
<td class="reference"><b id="NIST FIPS-180-3">[NIST FIPS-180-3]</b></td>
<td class="top">
<a>National Institute of Standards and Technology</a>, "<a>Secure Hash Standard (SHS). FIPS PUB 180-3, October 2008</a>", .</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table><tbody><tr>
<td class="reference"><b id="RFC5849">[RFC5849]</b></td>
<td class="top">
<a>Hammer-Lahav, E.</a>, "<a href="http://tools.ietf.org/html/rfc5849">The OAuth 1.0 Protocol</a>", RFC 5849, April 2010.</td>
</tr></tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Eran Hammer-Lahav</span> 
	  <span class="n hidden">
		<span class="family-name">Hammer-Lahav</span>
	  </span>
	</span>
	<span class="org vcardline">Yahoo!</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:eran@hueniverse.com">eran@hueniverse.com</a></span>

<span class="vcardline">URI: <a href="http://hueniverse.com">http://hueniverse.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Adam Barth</span> 
	  <span class="n hidden">
		<span class="family-name">Barth</span>
	  </span>
	</span>
	<span class="org vcardline">Google</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ietf@adambarth.com">ietf@adambarth.com</a></span>

<span class="vcardline">URI: <a href="http://www.adambarth.com">http://www.adambarth.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ben Adida</span> 
	  <span class="n hidden">
		<span class="family-name">Adida</span>
	  </span>
	</span>
	<span class="org vcardline">Mozilla</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ben@adida.net">ben@adida.net</a></span>

<span class="vcardline">URI: <a href="http://ben.adida.net">http://ben.adida.net</a></span>

  </address>
</div>

</body>
</html>