<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>AES-CCM ECC Cipher Suites for TLS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="AES-CCM ECC Cipher Suites for TLS">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">TLS Working Group</td><td class="header">D. McGrew</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">D. Bailey</td></tr>
<tr><td class="header">Expires: January 7, 2011</td><td class="header">RSA/EMC</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Campagna</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">R. Dugal</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Certicom Corp.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 6, 2010</td></tr>
</table></td></tr></table>
<h1><br />AES-CCM ECC Cipher Suites for TLS<br />draft-mcgrew-tls-aes-ccm-ecc-00</h1>

<h3>Abstract</h3>

<p>
		    This memo describes the use of the Advanced
		    Encryption Standard (AES) in the Counter and
		    CBC-MAC Mode (CCM) of operation within Transport
		    Layer Security (TLS) to provide confidentiality
		    and data origin authentication.  The AES-CCM
		    algorithm is amenable to compact implementations,
		    making it suitable for constrained environments.
		    The ciphersuites defined in this document use
		    Elliptic Curve Cryptography (ECC), and are
		    intended for use in networks with limited
		    bandwidth.
		  
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on January 7, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Conventions Used In This Document<br />
<br />
<a href="#suites">2.</a>&nbsp;
ECC based AES-CCM Cipher Suites<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Data Structures and Encoding<br />
<br />
<a href="#anchor4">3.</a>&nbsp;
TLS Versions<br />
<br />
<a href="#newaead">4.</a>&nbsp;
New AEAD algorithms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
AES-128-CCM with an 8-octet ICV<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
AES-256-CCM with an 8-octet ICV<br />
<br />
<a href="#IANA">5.</a>&nbsp;
IANA Considerations<br />
<br />
<a href="#Security">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">6.1.</a>&nbsp;
Perfect Forward Secrecy<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">6.2.</a>&nbsp;
Counter Reuse<br />
<br />
<a href="#Acknowledgements">7.</a>&nbsp;
Acknowledgements<br />
<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document describes the use of Advanced Encryption Standard
    (AES) <a class='info' href='#AES'>[AES]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Specification for the Advanced Encryption Standard (AES),&rdquo; November&nbsp;2001.</span><span>)</span></a> in Counter with CBC-MAC Mode
    (CCM) <a class='info' href='#CCM'>[CCM]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for 					  Block Cipher Modes of 					  Operation: The CCM Mode for 					  Authentication and 					  Confidentiality,&rdquo; May&nbsp;2004.</span><span>)</span></a> in several TLS ciphersuites.
    AES-CCM provides both authentication and confidentiality and uses
    as its only primitive the AES encrypt operation (the AES decrypt
    operation is not needed).  This makes it amenable to compact
    implementations, which makes it useful in constrained
    environments.  The use of AES-CCM has been specified for use with
    IPsec ESP <a class='info' href='#RFC4309'>[RFC4309]<span> (</span><span class='info'>Housley, R., &ldquo;Using Advanced Encryption Standard (AES) CCM Mode with IPsec Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a> and 802.15.4 wireless
    networks <a class='info' href='#IEEE802154'>[IEEE802154]<span> (</span><span class='info'>Institute of Electrical and Electronics Engineers, &ldquo;Wireless Personal Area Networks,&rdquo; 2006.</span><span>)</span></a>.

</p>
<p>
  Authenticated encryption, in addition to providing confidentiality
  for the plaintext that is encrypted, provides a way to check its
  integrity and authenticity.  Authenticated Encryption with
  Associated Data, or AEAD <a class='info' href='#RFC5116'>[RFC5116]<span> (</span><span class='info'>McGrew, D., &ldquo;An Interface and Algorithms for Authenticated Encryption,&rdquo; January&nbsp;2008.</span><span>)</span></a>, adds the ability
  to check the integrity and authenticity of some associated data that
  is not encrypted.  This note utilizes the AEAD facility within TLS
  1.2 <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> and the AES-CCM-based AEAD
  algorithms defined in <a class='info' href='#RFC5116'>[RFC5116]<span> (</span><span class='info'>McGrew, D., &ldquo;An Interface and Algorithms for Authenticated Encryption,&rdquo; January&nbsp;2008.</span><span>)</span></a>.  Additional AEAD
  algorithms are also defined, which use AES-CCM but which have
  shorter authentication tags, and therefore are more suitable for use
  across networks in which bandwidth is constrained and message sizes
  may be small.

</p>
<p>
The ciphersuites defined in this document use Ephemeral Elliptic Curve
Diffie-Hellman (ECDHE) as their key establishment mechanism; these
ciphersuites can be used with DTLS <a class='info' href='#I-D.ietf-tls-rfc4347-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4347&#8209;bis]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security version 1.2,&rdquo; October&nbsp;2009.</span><span>)</span></a>.

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Conventions Used In This Document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED",
   "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
   and "OPTIONAL" in this document are to be interpreted as described
   in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>
</p>
<a name="suites"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
ECC based AES-CCM Cipher Suites</h3>

<p>The ciphersuites defined in this document
    are based on the the AES-CCM authenticated
    encryption with associated data (AEAD)
    algorithms AEAD_AES_128_CCM and
    AEAD_AES_256_CCM described
    in <a class='info' href='#RFC5116'>[RFC5116]<span> (</span><span class='info'>McGrew, D., &ldquo;An Interface and Algorithms for Authenticated Encryption,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
    The following ciphersuites are defined:
</p>
<p></p>
<blockquote class="text"><dl>
<dt></dt>
<dd>
	CipherSuite TLS_ECDHE_ECDSA_WITH_AES_128_CCM   = {TBD1,TBD1}
	CipherSuite TLS_ECDHE_ECDSA_WITH_AES_256_CCM   = {TBD2,TBD2)<br />

	CipherSuite TLS_ECDHE_ECDSA_WITH_AES_128_CCM   = {TBD3,TBD3}<br />

	CipherSuite TLS_ECDHE_ECDSA_WITH_AES_256_CCM   = {TBD4,TBD4}<br />

	CipherSuite TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 = {TBD5,TBD5}<br />

	CipherSuite TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8 = {TBD6,TBD6)<br />

	CipherSuite TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 = {TBD7,TBD7}<br />

	CipherSuite TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8 = {TBD8,TBD8}
      
</dd>
</dl></blockquote>

<p>These ciphersuites make use of the AEAD capability in TLS
    1.2 <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.  Note that each of these AEAD
    algorithms uses AES-CCM.  Ciphersuites ending with "8" use
    eight-octet authentication tags; the other ciphersuites have 16
    octet authentication tags.

</p>
<p>
  The HMAC truncation option described in Section 3.5 of
  <a class='info' href='#RFC4366'>[RFC4366]<span> (</span><span class='info'>Blake-Wilson, S., Nystrom, M., Hopwood, D., Mikkelsen, J., and T. Wright, &ldquo;Transport Layer Security (TLS) Extensions,&rdquo; April&nbsp;2006.</span><span>)</span></a> (which negotiates the "truncated_hmac" TLS
  extension) does not have an effect on cipher suites that do not use
  HMAC.

</p>
<p>
The "nonce" input to the AEAD
algorithm is defined as in <a class='info' href='#RFC5288'>[RFC5288]<span> (</span><span class='info'>Salowey, J., Choudhury, A., and D. McGrew, &ldquo;AES Galois Counter Mode (GCM) Cipher Suites for TLS,&rdquo; August&nbsp;2008.</span><span>)</span></a>.  The "nonce" SHALL be 12 bytes
long and constructed as follows:

</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
struct {
   case client:
      uint32 client_write_IV;  // low order 32-bits
   case server:
      uint32 server_write_IV;  // low order 32-bits
   uint64 seq_num;
} CCMNonce.</pre></div>
<p>In DTLS, the 64-bit seq_num field is the 16-bit DTLS epoch field concatenated with the
  48-bit sequence_number field.   The epoch and sequence_number appear in the 
  DTLS record layer.  

</p>
<p>This construction allows the internal counter to be 32-bits long,
   which is a convenient size for use with CCM.
</p>
<p>These ciphersuites make use of the default TLS 1.2 Pseudorandom
    Function (PRF), which uses HMAC with the SHA-256 hash
    function. The ECDHE_ECDSA key exchange is performed as defined
    in <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a>, with the following additional
    stipulations:
</p>
<blockquote class="text">
<p> 
  The curves secp256r1, secp384r1, and secp521r1 MUST be supported;
  these curves are equivalent to the NIST P-256, P-384, and P-521 curves.
  Note that all of these curves have cofactor equal to one, which
  simplifies their use.

</p>
<p> The uncompressed point format MUST be supported, and other point
  formats MUST NOT be used.  The use of other point formats will be
  considered in later versions of this draft.

</p>
<p>
  The client MUST NOT offer the elliptic_curves extension nor the
  ec_point_formats extension.  The server MUST NOT expect to receive
  those extensions.

</p>
<p>
<a class='info' href='#I-D.mcgrew-fundamental-ecc'>[I&#8209;D.mcgrew&#8209;fundamental&#8209;ecc]<span> (</span><span class='info'>McGrew, D., Igoe, K., and M. Salter, &ldquo;Fundamental Elliptic Curve Cryptography Algorithms,&rdquo; May&nbsp;2010.</span><span>)</span></a>  MAY be used as an implementation method.  

</p>
<p>
  The server's certificate MUST contain an ECDSA-capable public key, and
  it MUST be signed with ECDSA.   If a client certificate is used, 
  the same conditions apply to it.

</p>
</blockquote><p>



</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Data Structures and Encoding</h3>

<p>
The key exchange method uses the data structures and encodings defined
in this section; these are a subset of <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a>.  
Unused enumerated values and branches of "select" operations are not shown.

</p>
<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        enum {
            secp256r1 (23), secp384r1 (24), secp521r1 (25),
            (0xFFFF)
        } NamedCurve;

       struct {
            ECCurveType curve_type = named_curve;
            NamedCurve namedcurve;
        } ECParameters;

        struct {
            opaque point &lt;1..2^8-1&gt;;
        } ECPoint;

        struct {
            ECParameters    curve_params;
            ECPoint         public;
        } ServerECDHParams;
</pre></div><p>

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        {
                ServerECDHParams    params;
                Signature           signed_params;
        } ServerKeyExchange;

          enum { ecdsa } SignatureAlgorithm;

         {
                  digitally-signed struct {
                      opaque sha_hash[sha_size];
                  };
          } Signature;

           Ecdsa-Sig-Value ::= SEQUENCE {
               r       INTEGER,
               s       INTEGER
           }
</pre></div><p>


</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        enum {
            ecdsa_sign(64), (255)
        } ClientCertificateType;
</pre></div><p>



</p>
<p>
  The TLS CertificateRequest message is extended as follows.

Because only ephemeral Diffie-Hellman is used, the PublicValueEncoding
is always "explicit".
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       struct {
                ECPoint ecdh_Yc;
            } ecdh_public;
        } ClientECDiffieHellmanPublic;

        struct {
            {
                ClientECDiffieHellmanPublic;
            } exchange_keys;
        } ClientKeyExchange;
</pre></div><p>



</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
TLS Versions</h3>

<p>These ciphersuites make use of the
   authenticated encryption with additional data defined in TLS
   1.2 <a class='info' href='#RFC5288'>[RFC5288]<span> (</span><span class='info'>Salowey, J., Choudhury, A., and D. McGrew, &ldquo;AES Galois Counter Mode (GCM) Cipher Suites for TLS,&rdquo; August&nbsp;2008.</span><span>)</span></a>.  They MUST NOT
   be negotiated in older versions of TLS.  Clients MUST NOT offer
   these cipher suites if they do not offer TLS 1.2 or later.  Servers
   which select an earlier version of TLS MUST NOT select one of these
   cipher suites.  Because TLS has no way for the client to indicate
   that it supports TLS 1.2 but not earlier, a non-compliant server
   might potentially negotiate TLS 1.1 or earlier and select one of
   the cipher suites in this document.  Clients MUST check the TLS
   version and generate a fatal "illegal_parameter" alert if they
   detect an incorrect version.
</p>
<a name="newaead"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
New AEAD algorithms</h3>

<p>
	  The following AEAD algorithms are defined:
	  </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>
	      AEAD_AES_128_CCM_8     = TBD9 
	      AEAD_AES_256_CCM_8     = TBD10<br />

	      AEAD_AES_128_CCM_12 =  TBD11 <br />

	      AEAD_AES_256_CCM_12 = TBD12
	    
</dd>
</dl></blockquote><p>
	
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
AES-128-CCM with an 8-octet ICV</h3>

<p>
	      
   The AEAD_AES_128_CCM_8 authenticated encryption algorithm is
   identical to the AEAD_AES_128_CCM algorithm (see Section 5.3 of
   <a class='info' href='#RFC5116'>[RFC5116]<span> (</span><span class='info'>McGrew, D., &ldquo;An Interface and Algorithms for Authenticated Encryption,&rdquo; January&nbsp;2008.</span><span>)</span></a>), except that it uses eight octets for
   authentication, instead of the full sixteen octets used by
   AEAD_AES_128_CCM.  The AEAD_AES_128_CCM_8 ciphertext consists of
   the ciphertext output of the CCM encryption operation concatenated
   with the 8-octet authentication tag output of the CCM encryption
   operation.  Test cases are provided in [CCM].  The input and output
   lengths are as as for AEAD_AES_128_CCM.  An AEAD_AES_128_CCM_8
   ciphertext is exactly 8 octets longer than its corresponding
   plaintext.

	  
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
AES-256-CCM with an 8-octet ICV</h3>

<p>
	      
   The AEAD_AES_256_CCM_8 authenticated encryption algorithm is
   identical to the AEAD_AES_256_CCM algorithm (see Section 5.4 of
   <a class='info' href='#RFC5116'>[RFC5116]<span> (</span><span class='info'>McGrew, D., &ldquo;An Interface and Algorithms for Authenticated Encryption,&rdquo; January&nbsp;2008.</span><span>)</span></a>), except that it uses eight octets for
   authentication, instead of the full sixteen octets used by
   AEAD_AES_256_CCM.  The AEAD_AES_256_CCM_8 ciphertext consists of
   the ciphertext output of the CCM encryption operation concatenated
   with the 8-octet authentication tag output of the CCM encryption
   operation.  Test cases are provided in [CCM].  The input and output
   lengths are as as for AEAD_AES_128_CCM.  An AEAD_AES_128_CCM_8
   ciphertext is exactly 8 octets longer than its corresponding
   plaintext.

	  
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>IANA has assigned values for the Ciphersuites defined in <a class='info' href='#suites'>Section&nbsp;2<span> (</span><span class='info'>ECC based AES-CCM Cipher Suites</span><span>)</span></a>
and the AEAD algorithms defined in <a class='info' href='#newaead'>Section&nbsp;4<span> (</span><span class='info'>New AEAD algorithms</span><span>)</span></a> of this note.

</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Perfect Forward Secrecy</h3>

<p>The perfect forward secrecy
				properties of ephemeral Diffie-Hellman
				ciphersuites are discussed in the
				security analysis
				of <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a>.  
				  This analysis applies to the ECDHE
				  ciphersuites. 
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Counter Reuse</h3>

<p>AES-CCM security requires that the
				counter is never reused.  The IV
				construction
				in <a class='info' href='#suites'>Section&nbsp;2<span> (</span><span class='info'>ECC based AES-CCM Cipher Suites</span><span>)</span></a> is
				designed to prevent counter
				reuse. 
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>This draft borrows heavily from <a class='info' href='#RFC5288'>[RFC5288]<span> (</span><span class='info'>Salowey, J., Choudhury, A., and D. McGrew, &ldquo;AES Galois Counter Mode (GCM) Cipher Suites for TLS,&rdquo; August&nbsp;2008.</span><span>)</span></a>.
			
</p>
<p>
			  This draft is motivated by the considerations raised in 
			  the Zigbee Smart Energy 2.0 working group. 
			  
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="AES">[AES]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;Specification for the Advanced Encryption Standard (AES),&rdquo; FIPS&nbsp;197, November&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="CCM">[CCM]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;Recommendation for
					  Block Cipher Modes of
					  Operation: The CCM Mode for
					  Authentication and
					  Confidentiality,&rdquo; SP&nbsp;800-38C, May&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tls-rfc4347-bis">[I-D.ietf-tls-rfc4347-bis]</a></td>
<td class="author-text">Rescorla, E. and N. Modadugu, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4347-bis-03.txt">Datagram Transport Layer Security version 1.2</a>,&rdquo; draft-ietf-tls-rfc4347-bis-03 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4347-bis-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.mcgrew-fundamental-ecc">[I-D.mcgrew-fundamental-ecc]</a></td>
<td class="author-text">McGrew, D., Igoe, K., and M. Salter, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-mcgrew-fundamental-ecc-03.txt">Fundamental Elliptic Curve Cryptography Algorithms</a>,&rdquo; draft-mcgrew-fundamental-ecc-03 (work in progress), May&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-mcgrew-fundamental-ecc-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4346">[RFC4346]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc4346">The Transport Layer Security (TLS) Protocol Version 1.1</a>,&rdquo; RFC&nbsp;4346, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4346.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4366">[RFC4366]</a></td>
<td class="author-text">Blake-Wilson, S., Nystrom, M., Hopwood, D., Mikkelsen, J., and T. Wright, &ldquo;<a href="http://tools.ietf.org/html/rfc4366">Transport Layer Security (TLS) Extensions</a>,&rdquo; RFC&nbsp;4366, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4366.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4492">[RFC4492]</a></td>
<td class="author-text">Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;<a href="http://tools.ietf.org/html/rfc4492">Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)</a>,&rdquo; RFC&nbsp;4492, May&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4492.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5116">[RFC5116]</a></td>
<td class="author-text">McGrew, D., &ldquo;<a href="http://tools.ietf.org/html/rfc5116">An Interface and Algorithms for Authenticated Encryption</a>,&rdquo; RFC&nbsp;5116, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5116.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5288">[RFC5288]</a></td>
<td class="author-text">Salowey, J., Choudhury, A., and D. McGrew, &ldquo;<a href="http://tools.ietf.org/html/rfc5288">AES Galois Counter Mode (GCM) Cipher Suites for TLS</a>,&rdquo; RFC&nbsp;5288, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5288.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="IEEE802154">[IEEE802154]</a></td>
<td class="author-text">Institute of Electrical and Electronics Engineers, &ldquo;Wireless Personal Area Networks,&rdquo; IEEE Standard&nbsp;802.15.4-2006, 2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4309">[RFC4309]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4309">Using Advanced Encryption Standard (AES) CCM Mode with IPsec Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;4309, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4309.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David McGrew</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 W Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mcgrew@cisco.com">mcgrew@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Daniel V. Bailey</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">RSA/EMC</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">174 Middlesex Tpke.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bedford, MA  01463</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dbailey@rsa.com">dbailey@rsa.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Matthew Campagna</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Certicom Corp.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5520 Explorer Drive #400</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mississauga, Ontario  L4W 5L1</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mcampagna@certicom.com">mcampagna@certicom.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Robert Dugal</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Certicom Corp.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5520 Explorer Drive #400</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mississauga, Ontario  L4W 5L1</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rdugal@certicom.com">rdugal@certicom.com</a></td></tr>
</table>
</body></html>
