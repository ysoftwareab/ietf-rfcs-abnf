<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Network Configuration Protocol (NETCONF) Access Control Model </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Access Control Design Objectives">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Access Control Points">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Simplicity">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Procedural Interface">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Datastore Access">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 Users and Groups">
<link href="#rfc.section.2.6" rel="Chapter" title="2.6 Maintenance">
<link href="#rfc.section.2.7" rel="Chapter" title="2.7 Configuration Capabilities">
<link href="#rfc.section.2.8" rel="Chapter" title="2.8 Identifying Security-Sensitive Content">
<link href="#rfc.section.3" rel="Chapter" title="3 NETCONF Access Control Model (NACM)">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Introduction">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Features">
<link href="#rfc.section.3.1.2" rel="Chapter" title="3.1.2 External Dependencies">
<link href="#rfc.section.3.1.3" rel="Chapter" title="3.1.3 Message Processing Model">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Datastore Access">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Access Rights">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 &lt;get&gt; and &lt;get-config&gt; Operations">
<link href="#rfc.section.3.2.3" rel="Chapter" title="3.2.3 &lt;edit-config&gt; Operation">
<link href="#rfc.section.3.2.4" rel="Chapter" title="3.2.4 &lt;copy-config&gt; Operation">
<link href="#rfc.section.3.2.5" rel="Chapter" title="3.2.5 &lt;delete-config&gt; Operation">
<link href="#rfc.section.3.2.6" rel="Chapter" title="3.2.6 &lt;commit&gt; Operation">
<link href="#rfc.section.3.2.7" rel="Chapter" title="3.2.7 &lt;discard-changes&gt; Operation">
<link href="#rfc.section.3.2.8" rel="Chapter" title="3.2.8 &lt;kill-session&gt; Operation">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Model Components">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 Users">
<link href="#rfc.section.3.3.2" rel="Chapter" title="3.3.2 Groups">
<link href="#rfc.section.3.3.3" rel="Chapter" title="3.3.3 Global Enforcement Controls">
<link href="#rfc.section.3.3.3.1" rel="Chapter" title="3.3.3.1 enable-nacm Switch">
<link href="#rfc.section.3.3.3.2" rel="Chapter" title="3.3.3.2 read-default Switch">
<link href="#rfc.section.3.3.3.3" rel="Chapter" title="3.3.3.3 write-default Switch">
<link href="#rfc.section.3.3.3.4" rel="Chapter" title="3.3.3.4 exec-default Switch">
<link href="#rfc.section.3.3.4" rel="Chapter" title="3.3.4 Access Control Rules">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Access Control Enforcement Procedures">
<link href="#rfc.section.3.4.1" rel="Chapter" title="3.4.1 Initial Operation">
<link href="#rfc.section.3.4.2" rel="Chapter" title="3.4.2 Session Establishment">
<link href="#rfc.section.3.4.3" rel="Chapter" title='3.4.3 "access-denied" Error Handling'>
<link href="#rfc.section.3.4.4" rel="Chapter" title="3.4.4 Incoming RPC Message Validation">
<link href="#rfc.section.3.4.5" rel="Chapter" title="3.4.5 Data Node Access Validation">
<link href="#rfc.section.3.4.6" rel="Chapter" title="3.4.6 Outgoing &lt;notification&gt; Authorization">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Data Model Definitions">
<link href="#rfc.section.3.5.1" rel="Chapter" title="3.5.1 Data Organization">
<link href="#rfc.section.3.5.2" rel="Chapter" title="3.5.2 YANG Module">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 IANA Considerations">
<link href="#rfc.section.3.7" rel="Chapter" title="3.7 Security Considerations">
<link href="#rfc.section.3.7.1" rel="Chapter" title="3.7.1 NACM Configuration and Monitoring Considerations">
<link href="#rfc.section.3.7.2" rel="Chapter" title="3.7.2 General Configuration Issues">
<link href="#rfc.section.3.7.3" rel="Chapter" title="3.7.3 Data Model Design Considerations">
<link href="#rfc.references" rel="Chapter" title="4 References">
<link href="#rfc.references.1" rel="Chapter" title="4.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="4.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Usage Examples">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 &lt;groups&gt; Example">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 Module Rule Example">
<link href="#rfc.appendix.Appendix%20A.3" rel="Chapter" title="Appendix A.3 RPC Rule Example">
<link href="#rfc.appendix.Appendix%20A.4" rel="Chapter" title="Appendix A.4 Data Rule Example">
<link href="#rfc.appendix.Appendix%20A.5" rel="Chapter" title="Appendix A.5 Notification Rule Example">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Change Log">
<link href="#rfc.appendix.Appendix%20B.1" rel="Chapter" title="Appendix B.1 05-06">
<link href="#rfc.appendix.Appendix%20B.2" rel="Chapter" title="Appendix B.2 04-05">
<link href="#rfc.appendix.Appendix%20B.3" rel="Chapter" title="Appendix B.3 03-04">
<link href="#rfc.appendix.Appendix%20B.4" rel="Chapter" title="Appendix B.4 02-03">
<link href="#rfc.appendix.Appendix%20B.5" rel="Chapter" title="Appendix B.5 01-02">
<link href="#rfc.appendix.Appendix%20B.6" rel="Chapter" title="Appendix B.6 00-01">
<link href="#rfc.appendix.Appendix%20B.7" rel="Chapter" title="Appendix B.7 00">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The standardization of network configuration interfaces for use with the NETCONF protocol requires a structured and secure operating environment that promotes human usability and multi-vendor interoperability.  There is a need for standard mechanisms to restrict NETCONF protocol access for particular users to a pre-configured subset of all available NETCONF protocol operations and content.  This document defines such an access control model.  " />
  <meta name="description" content="The standardization of network configuration interfaces for use with the NETCONF protocol requires a structured and secure operating environment that promotes human usability and multi-vendor interoperability.  There is a need for standard mechanisms to restrict NETCONF protocol access for particular users to a pre-configured subset of all available NETCONF protocol operations and content.  This document defines such an access control model.  " />
  <meta name="keywords" content="NETCONF, YANG, XML" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">A.B. Bierman</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Brocade</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">M.B. Bjorklund</td>
</tr>
<tr>
<td class="left">Expires: May 03, 2012</td>
<td class="right">Tail-f Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 31, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Network Configuration Protocol (NETCONF) Access Control Model <br />
  <span class="filename">draft-ietf-netconf-access-control-06</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The standardization of network configuration interfaces for use with the NETCONF protocol requires a structured and secure operating environment that promotes human usability and multi-vendor interoperability.  There is a need for standard mechanisms to restrict NETCONF protocol access for particular users to a pre-configured subset of all available NETCONF protocol operations and content.  This document defines such an access control model.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 03, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Terminology</a>
</li>
<li>2.   <a href="#rfc.section.2">Access Control Design Objectives</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Access Control Points</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Simplicity</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Procedural Interface</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">Datastore Access</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">Users and Groups</a>
</li>
<li>2.6.   <a href="#rfc.section.2.6">Maintenance</a>
</li>
<li>2.7.   <a href="#rfc.section.2.7">Configuration Capabilities</a>
</li>
<li>2.8.   <a href="#rfc.section.2.8">Identifying Security-Sensitive Content</a>
</li>
<li>3.   <a href="#rfc.section.3">NETCONF Access Control Model (NACM)</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Introduction</a>
</li>
<li>3.1.1.   <a href="#rfc.section.3.1.1">Features</a>
</li>
<li>3.1.2.   <a href="#rfc.section.3.1.2">External Dependencies</a>
</li>
<li>3.1.3.   <a href="#rfc.section.3.1.3">Message Processing Model</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Datastore Access</a>
</li>
<li>3.2.1.   <a href="#rfc.section.3.2.1">Access Rights</a>
</li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">&lt;get&gt; and &lt;get-config&gt; Operations</a>
</li>
<li>3.2.3.   <a href="#rfc.section.3.2.3">&lt;edit-config&gt; Operation</a>
</li>
<li>3.2.4.   <a href="#rfc.section.3.2.4">&lt;copy-config&gt; Operation</a>
</li>
<li>3.2.5.   <a href="#rfc.section.3.2.5">&lt;delete-config&gt; Operation</a>
</li>
<li>3.2.6.   <a href="#rfc.section.3.2.6">&lt;commit&gt; Operation</a>
</li>
<li>3.2.7.   <a href="#rfc.section.3.2.7">&lt;discard-changes&gt; Operation</a>
</li>
<li>3.2.8.   <a href="#rfc.section.3.2.8">&lt;kill-session&gt; Operation</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Model Components</a>
</li>
<li>3.3.1.   <a href="#rfc.section.3.3.1">Users</a>
</li>
<li>3.3.2.   <a href="#rfc.section.3.3.2">Groups</a>
</li>
<li>3.3.3.   <a href="#rfc.section.3.3.3">Global Enforcement Controls</a>
</li>
<li>3.3.3.1.   <a href="#rfc.section.3.3.3.1">enable-nacm Switch</a>
</li>
<li>3.3.3.2.   <a href="#rfc.section.3.3.3.2">read-default Switch</a>
</li>
<li>3.3.3.3.   <a href="#rfc.section.3.3.3.3">write-default Switch</a>
</li>
<li>3.3.3.4.   <a href="#rfc.section.3.3.3.4">exec-default Switch</a>
</li>
<li>3.3.4.   <a href="#rfc.section.3.3.4">Access Control Rules</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Access Control Enforcement Procedures</a>
</li>
<li>3.4.1.   <a href="#rfc.section.3.4.1">Initial Operation</a>
</li>
<li>3.4.2.   <a href="#rfc.section.3.4.2">Session Establishment</a>
</li>
<li>3.4.3.   <a href="#rfc.section.3.4.3">"access-denied" Error Handling</a>
</li>
<li>3.4.4.   <a href="#rfc.section.3.4.4">Incoming RPC Message Validation</a>
</li>
<li>3.4.5.   <a href="#rfc.section.3.4.5">Data Node Access Validation</a>
</li>
<li>3.4.6.   <a href="#rfc.section.3.4.6">Outgoing &lt;notification&gt; Authorization</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Data Model Definitions</a>
</li>
<li>3.5.1.   <a href="#rfc.section.3.5.1">Data Organization</a>
</li>
<li>3.5.2.   <a href="#rfc.section.3.5.2">YANG Module</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">IANA Considerations</a>
</li>
<li>3.7.   <a href="#rfc.section.3.7">Security Considerations</a>
</li>
<li>3.7.1.   <a href="#rfc.section.3.7.1">NACM Configuration and Monitoring Considerations</a>
</li>
<li>3.7.2.   <a href="#rfc.section.3.7.2">General Configuration Issues</a>
</li>
<li>3.7.3.   <a href="#rfc.section.3.7.3">Data Model Design Considerations</a>
</li>
<li>4.   <a href="#rfc.references">References</a>
</li>
<li>4.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>4.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Usage Examples</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">&lt;groups&gt; Example</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">Module Rule Example</a>
</li>
<li>Appendix A.3.   <a href="#rfc.appendix.Appendix%20A.3">RPC Rule Example</a>
</li>
<li>Appendix A.4.   <a href="#rfc.appendix.Appendix%20A.4">Data Rule Example</a>
</li>
<li>Appendix A.5.   <a href="#rfc.appendix.Appendix%20A.5">Notification Rule Example</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Change Log</a>
</li>
<li>Appendix B.1.   <a href="#rfc.appendix.Appendix%20B.1">05-06</a>
</li>
<li>Appendix B.2.   <a href="#rfc.appendix.Appendix%20B.2">04-05</a>
</li>
<li>Appendix B.3.   <a href="#rfc.appendix.Appendix%20B.3">03-04</a>
</li>
<li>Appendix B.4.   <a href="#rfc.appendix.Appendix%20B.4">02-03</a>
</li>
<li>Appendix B.5.   <a href="#rfc.appendix.Appendix%20B.5">01-02</a>
</li>
<li>Appendix B.6.   <a href="#rfc.appendix.Appendix%20B.6">00-01</a>
</li>
<li>Appendix B.7.   <a href="#rfc.appendix.Appendix%20B.7">00</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The NETCONF protocol does not provide any standard mechanisms to restrict the protocol operations and content that each user is authorized to access.  </p>
<p id="rfc.section.1.p.2">There is a need for inter-operable management of the controlled access to administrator selected portions of the available NETCONF content within a particular server.  </p>
<p id="rfc.section.1.p.3">This document addresses access control mechanisms for the Operation and Content layers of NETCONF, as defined in <a href="#RFC6241">[RFC6241]</a>.  It contains three main sections: </p>

<ol>
<li>Access Control Design Objectives</li>
<li>NETCONF Access Control Model (NACM)</li>
<li>YANG Data Model (ietf-netconf-acm.yang)</li>
</ol>

<p> </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Terminology</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<p id="rfc.section.1.1.p.2">The following terms are defined in <a href="#RFC6241">[RFC6241]</a> and are not redefined here: </p>

<ul>
<li>client</li>
<li>datastore</li>
<li>protocol operation</li>
<li>server</li>
<li>session</li>
<li>user</li>
</ul>

<p> </p>
<p id="rfc.section.1.1.p.3">The following terms are defined in <a href="#RFC6020">[RFC6020]</a> and are not redefined here: </p>

<ul>
<li>data node</li>
<li>data definition statement</li>
</ul>

<p> </p>
<p id="rfc.section.1.1.p.4">The following terms are used throughout this documentation: </p>

<dl>
<dt>access control:</dt>
<dd style="margin-left: 8">A security feature provided by the NETCONF server, that allows an administrator to restrict access to a subset of all NETCONF protocol operations and data, based on various criteria.  </dd>
<dt>access control model (ACM):</dt>
<dd style="margin-left: 8">A conceptual model used to configure and monitor the access control procedures desired by the administrator to enforce a particular access control policy.  </dd>
<dt>access control rule:</dt>
<dd style="margin-left: 8">The criteria used to determine if a particular NETCONF protocol operation will be permitted or denied.  </dd>
<dt>access operation:</dt>
<dd style="margin-left: 8">How a request attempts to access a conceptual object.  One of "none", "read", "create", "delete", "update", and "execute".  </dd>
<dt>recovery session:</dt>
<dd style="margin-left: 8">A special administrative session that is given unlimited NETCONF access, and is exempt from all access control enforcement.  The mechanism(s) used by a server to control and identify whether a session is a recovery session or not are implementation-specific and outside the scope of this document.  </dd>
<dt>write access:</dt>
<dd style="margin-left: 8">A shorthand for the "create", "delete", and "update" access operations.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Access Control Design Objectives</h1>
<p id="rfc.section.2.p.1">This section documents the design objectives for the NETCONF Access Control Model presented in <a href="#acm">Section 3</a>.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Access Control Points</h1>
<p id="rfc.section.2.1.p.1">NETCONF allows new protocol operations to be added at any time, and the YANG data modeling language supports this feature.  It is not possible to design an ACM for NETCONF that only focuses on a static set of protocol operations, like some other protocols.  Since few assumptions can be made about an arbitrary protocol operation, the NETCONF architectural server components need to be protected at three conceptual control points.  </p>
<div id="#rfc.figure.1"></div>
<div id="#control_points"></div>
<pre>
              +-------------+                 +-------------+
 client       |  protocol   |                 |  data node  |
 request --&gt;  |  operation  | -------------&gt;  |   access    |
              |  allowed?   |   datastore     |  allowed?   |
              +-------------+   or state      +-------------+
                                data access  


              +----------------+
              |  notification  | 
 event --&gt;    |  allowed?      |
              +----------------+

            
          </pre>
<p></p>
<p id="rfc.section.2.1.p.3">The following access control points, described in <a href="#control_points">Figure 1</a>, are identified: </p>

<dl>
<dt>protocol operation:</dt>
<dd style="margin-left: 8">Permission to invoke specific protocol operations.  </dd>
<dt>datastore:</dt>
<dd style="margin-left: 8">Permission to read and/or alter specific data nodes within any datastore.  </dd>
<dt>notification:</dt>
<dd style="margin-left: 8">Permission to receive specific notification event types.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Simplicity</h1>
<p id="rfc.section.2.2.p.1">There is concern that a complicated ACM will not be widely deployed, because it is too hard to use.  It needs to be easy to do simple things, and possible to do complex things, instead of hard to do everything.  </p>
<p id="rfc.section.2.2.p.2">Configuration of the access control system needs to be as simple as possible.  Simple and common tasks need to be easy to configure, and require little expertise or domain-specific knowledge.  Complex tasks are possible using additional mechanisms, which may require additional expertise.  </p>
<p id="rfc.section.2.2.p.3">A single set of access control rules ought to be able to control all types of NETCONF protocol operation invocation, all datastore access, and all notification events.  </p>
<p id="rfc.section.2.2.p.4">Access control ought to be defined with a small and familiar set of permissions, while still allowing full control of NETCONF datastore access.  </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> Procedural Interface</h1>
<p id="rfc.section.2.3.p.1">The NETCONF protocol uses a remote procedure call model, and an extensible set of protocol operations.  Access control for any possible protocol operation is necessary.  </p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> Datastore Access</h1>
<p id="rfc.section.2.4.p.1">It is necessary to control access to specific nodes and subtrees within the NETCONF datastore, regardless of which protocol operation, standard or proprietary, was used to access the datastore.  </p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> Users and Groups</h1>
<p id="rfc.section.2.5.p.1">It is necessary that access control rules for a single user or a configurable group of users can be configured.  </p>
<p id="rfc.section.2.5.p.2">The ACM needs to support the concept of administrative groups, to support the well-established distinction between a root account and other types of less-privileged conceptual user accounts.  These groups needs to be configurable by the administrator.  </p>
<p id="rfc.section.2.5.p.3">It is necessary that the user-to-group mapping can be delegated to a central server, such as a RADIUS server <a href="#RFC2865">[RFC2865]</a> <a href="#RFC5607">[RFC5607]</a>.  Since authentication is performed by the NETCONF transport layer, and RADIUS performs authentication and service authorization at the same time, the underlying NETCONF transport needs to be able to report a set of group names associated with the user to the server.  </p>
<h1 id="rfc.section.2.6">
<a href="#rfc.section.2.6">2.6.</a> Maintenance</h1>
<p id="rfc.section.2.6.p.1">It ought to be possible to disable part or all of the access control model without deleting any access control rules.  </p>
<h1 id="rfc.section.2.7">
<a href="#rfc.section.2.7">2.7.</a> Configuration Capabilities</h1>
<p id="rfc.section.2.7.p.1">Suitable configuration and monitoring mechanisms are needed to allow an administrator to easily manage all aspects of the ACM behavior. A standard data model, suitable for use with the &lt;edit-config&gt; protocol operation needs to be available for this purpose.  </p>
<p id="rfc.section.2.7.p.2">Access control rules to restrict access operations on specific subtrees within the configuration datastore needs to be supported.  </p>
<h1 id="rfc.section.2.8">
<a href="#rfc.section.2.8">2.8.</a> Identifying Security-Sensitive Content</h1>
<p id="rfc.section.2.8.p.1">One of the most important aspects of the data model documentation, and biggest concerns during deployment, is the identification of security-sensitive content.  This applies to protocol operations in NETCONF, not just data and notifications.  </p>
<p id="rfc.section.2.8.p.2">It is mandatory for security-sensitive objects to be documented in the Security Considerations section of an RFC.  This is nice, but it is not good enough, for the following reasons: </p>

<ul>
<li>This documentation-only approach forces administrators to study the RFC and determine if there are any potential security risks introduced by a new data model.  </li>
<li>If any security risks are identified, then the administrator can study some more RFC text, and determine how to mitigate the security risk(s).  </li>
<li>The ACM on each server can be configured to mitigate the security risks, e.g., require privileged access to read or write the specific data identified in the Security Considerations section.  </li>
<li>If the ACM is not pre-configured, then there will be a time window of vulnerability, after the new data model is loaded, and before the new access control rules for that data model are configured, enabled, and debugged.  </li>
</ul>

<p> </p>
<p id="rfc.section.2.8.p.3">Often, the administrator just wants to disable default access to the secure content, so no inadvertent or malicious changes can be made to the server.  This allows the default rules to be more lenient, without significantly increasing the security risk.  </p>
<p id="rfc.section.2.8.p.4">A data model designer needs to be able to use machine-readable statements to identify NETCONF content which needs to be protected by default.  This will allow client and server tools to automatically identify data-model specific security risks, by denying access to sensitive data unless the user is explicitly authorized to perform the requested access operation.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#acm" id="acm">NETCONF Access Control Model (NACM)</a>
</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Introduction</h1>
<p id="rfc.section.3.1.p.1">This section provides a high-level overview of the access control model structure.  It describes the NETCONF protocol message processing model, and the conceptual access control requirements within that model.  </p>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> Features</h1>
<p id="rfc.section.3.1.1.p.1">The NACM data model provides the following features: </p>

<ul>
<li>Independent control of RPC, data, and notification access.  </li>
<li>Simple access control rules configuration data model that is easy to use.  </li>
<li>The concept of an emergency recovery session is supported, but configuration of the server for this purpose is beyond the scope of this document.  An emergency recovery session will bypass all access control enforcement, in order to allow it to initialize or repair the NACM configuration.  </li>
<li>A simple and familiar set of datastore permissions is used.  </li>
<li>Support for YANG security tagging (e.g., "nacm:default-deny-write" statement) allows default security modes to automatically exclude sensitive data.  </li>
<li>Separate default access modes for read, write, and execute permissions.  </li>
<li>Access control rules are applied to configurable groups of users.  </li>
<li>The entire ACM can be disabled during operation, in order to debug operational problems.  </li>
<li>Access control rules are simple to configure.  </li>
<li>The number of denied protocol operation requests and denied datastore write requests can be monitored by the client.  </li>
<li>Simple unconstrained YANG instance identifiers are used to configure access control rules for specific data nodes.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.3.1.2">
<a href="#rfc.section.3.1.2">3.1.2.</a> External Dependencies</h1>
<p id="rfc.section.3.1.2.p.1">The <a href="#RFC6241">NETCONF</a> <cite title="NONE">[RFC6241]</cite> protocol is used for all management purposes within this document.  It is expected that the mandatory transport mapping <a href="#RFC6242">NETCONF Over SSH</a> <cite title="NONE">[RFC6242]</cite> is also supported by the server, and that the server has access to the user name associated with each session.  </p>
<p id="rfc.section.3.1.2.p.2">The <a href="#RFC6020">YANG Data Modeling Language</a> <cite title="NONE">[RFC6020]</cite> is used to define the NETCONF data models specified in this document.  </p>
<h1 id="rfc.section.3.1.3">
<a href="#rfc.section.3.1.3">3.1.3.</a> Message Processing Model</h1>
<p id="rfc.section.3.1.3.p.1">The following diagram shows the conceptual message flow model, including the points at which access control is applied, during NETCONF message processing.  </p>
<div id="#rfc.figure.2"></div>
<div id="#NACM_model"></div>
<pre>

                 +-------------------------+
                 |       session           |
                 |      (username)         |
                 +-------------------------+
                    |                 ^
                    V                 |
          +--------------+     +---------------+
          |   message    |     |   message     |
          | dispatcher   |     |   generator   |
          +--------------+     +---------------+
               |                  ^         ^
               V                  |         |
      +===========+     +-------------+   +----------------+
      |   &lt;rpc&gt;   |---&gt; | &lt;rpc-reply&gt; |   | &lt;notification&gt; |
      | acc. ctl  |     |  generator  |   |  generator     |
      +===========+     +-------------+   +----------------+
            |              ^    ^                ^
            V       +------+    |                |
      +-----------+ |   +=============+  +================+
      |   &lt;rpc&gt;   | |   |    read     |  | &lt;notification&gt; |
      | processor |-+   | data node   |  |  access ctl    |
      |           |     | acc. ctl    |  |                |
      +-----------+     +=============+  +================+
            |   |                  ^        ^
            V   +----------------+ |        |
      +===========+              | |        |
      |  write    |              | |        |
      | data node |              | |        |
      | acc. ctl  | -----------+ | |        |
      +===========+            | | |        |
            |                  | | |        |
            V                  V V |        |
      +---------------+      +-----------------+
      | configuration | ---&gt; |     server      |
      |   datastore   |      | instrumentation |
      |               | &lt;--- |                 |
      +---------------+      +-----------------+


            </pre>
<p></p>
<p id="rfc.section.3.1.3.p.3">The following high-level sequence of conceptual processing steps is executed for each received &lt;rpc&gt; message, if access control enforcement is enabled: </p>

<ul>
<li>Access control is applied to all &lt;rpc&gt; messages (except &lt;close-session&gt;) received by the server, individually, for each active session, unless the session is identified as a "recovery session".  </li>
<li>If the user is authorized to execute the specified protocol operation, then processing continues, otherwise the request is rejected with an "access-denied" error.  </li>
<li>If the configuration datastore or conceptual state data is accessed by the protocol operation, then the server checks if the client is authorized to access the nodes in the data store.  If the user is authorized to perform the requested access operation on the requested data, then processing continues.  </li>
</ul>

<p> </p>
<p id="rfc.section.3.1.3.p.4">The following sequence of conceptual processing steps is executed for each generated notification event, if access control enforcement is enabled: </p>

<ul>
<li>Server instrumentation generates a notification, for a particular subscription.  </li>
<li>The notification access control enforcer checks the notification event type, and if it is one which the user is not authorized to read, then the notification is dropped for that subscription.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Datastore Access</h1>
<p id="rfc.section.3.2.p.1">The same access control rules apply to all datastores.  For example, the candidate configuration datastore or the running configuration datastore.  </p>
<p id="rfc.section.3.2.p.2">Only the standard NETCONF datastores (candidate, running, and startup) are controlled by NACM.  Local or remote files or datastores accessed via the &lt;url&gt; parameter are not controlled by NACM.  </p>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> Access Rights</h1>
<p id="rfc.section.3.2.1.p.1">A small set of hard-wired datastore access rights is needed to control access to all possible NETCONF protocol operations, including vendor extensions to the standard protocol operation set.  </p>
<p id="rfc.section.3.2.1.p.2">The "CRUDX" model can support all NETCONF protocol operations: </p>

<ul>
<li>Create:  Allows the client to add a new data node instance to a datastore.  </li>
<li>Read: Allows the client to read a data node instance from a datastore, or receive the notification event type.  </li>
<li>Update: Allows the client to update an existing data node instance in a datastore.  </li>
<li>Delete: Allows the client to delete a data node instance from a datastore.  </li>
<li>eXec: Allows the client to execute the protocol operation.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> &lt;get&gt; and &lt;get-config&gt; Operations</h1>
<p id="rfc.section.3.2.2.p.1">Data nodes to which the client does not have read access are silently omitted from the &lt;rpc-reply&gt; message.  This is done to allow NETCONF filters for &lt;get&gt; and &lt;get-config&gt; to function properly, instead of causing an "access-denied" error because the filter criteria would otherwise include unauthorized read access to some data nodes.  For NETCONF filtering purposes, the selection criteria is applied to the subset of nodes that the user is authorized to read, not the entire datastore.  </p>
<h1 id="rfc.section.3.2.3">
<a href="#rfc.section.3.2.3">3.2.3.</a> &lt;edit-config&gt; Operation</h1>
<p id="rfc.section.3.2.3.p.1">The NACM access rights are not directly coupled to the &lt;edit-config&gt; "operation" attribute, although they are similar.  Instead, a NACM access right applies to all protocol operations which would result in a particular access operation to the target datastore. This section describes how these access rights apply to the specific access operations supported by the &lt;edit-config&gt; protocol operation.  </p>
<p id="rfc.section.3.2.3.p.2">If the effective access operation is "none" (i.e., default-operation="none") for a particular data node, then no access control is applied to that data node.  This is required to allow access to a sub-tree within larger data structure.  For example, a user may be authorized to create a new "/interfaces/interface" list entry, but not be authorized to create or delete its parent container ("/interfaces").  If the "/interfaces" container already exists in the target datastore, then the effective operation will be "none" for the "/interfaces" node if an "/interfaces/interface" list entry is edited.  </p>
<p id="rfc.section.3.2.3.p.3">If the protocol operation would result in the creation of a data store node, and the user does not have "create" access permission for that node, the protocol operation is rejected with an "access-denied" error.  </p>
<p id="rfc.section.3.2.3.p.4">If the protocol operation would result in the deletion of a data store node, and the user does not have "delete" access permission for that node, the protocol operation is rejected with an "access-denied" error.  </p>
<p id="rfc.section.3.2.3.p.5">If the protocol operation would result in the modification of a data store node, and the user does not have "update" access permission for that node, the protocol operation is rejected with an "access-denied" error.  </p>
<p id="rfc.section.3.2.3.p.6">A "merge" or "replace" &lt;edit-config&gt; operation may include data nodes which do not alter portions of the existing datastore.  For example, a container or list node may be present for naming purposes, but does not actually alter the corresponding datastore node.  These unaltered data nodes are ignored by the server, and do not require any access rights by the client.  </p>
<p id="rfc.section.3.2.3.p.7">A "merge" &lt;edit-config&gt; operation may include data nodes, but not include particular child data nodes that are present in the datastore.  These missing data nodes within the scope of a "merge" &lt;edit-config&gt; operation are ignored by the server, and do not require any access rights by the client.  </p>
<p id="rfc.section.3.2.3.p.8">The contents of specific restricted datastore nodes MUST NOT be exposed in any &lt;rpc-error&gt; elements within the reply.  </p>
<h1 id="rfc.section.3.2.4">
<a href="#rfc.section.3.2.4">3.2.4.</a> &lt;copy-config&gt; Operation</h1>
<p id="rfc.section.3.2.4.p.1">Access control for the &lt;copy-config&gt; protocol operation requires special consideration because the administrator may be replacing the entire target datastore.  </p>
<p id="rfc.section.3.2.4.p.2">If the source of the &lt;copy-config&gt; protocol operation is the running configuration datastore, and the target is the startup configuration datastore, the client is only required to have permission to execute the &lt;copy-config&gt; protocol operation.  </p>
<p id="rfc.section.3.2.4.p.3">Otherwise: </p>

<ul>
<li>If the source of the &lt;copy-config&gt; operation is a datastore, then data nodes to which the client does not have read access are silently omitted.  </li>
<li>If the target of the &lt;copy-config&gt; operation is a datastore, the client needs access to the modified nodes.  Specifically: <ul class="empty">
<li>If the protocol operation would result in the creation of a data store node, and the user does not have "create" access permission for that node, the protocol operation is rejected with an "access-denied" error.  </li>
<li>If the protocol operation would result in the deletion of a data store node, and the user does not have "delete" access permission for that node, the protocol operation is rejected with an "access-denied" error.  </li>
<li>If the protocol operation would result in the modification of a data store node, and the user does not have "update" access permission for that node, the protocol operation is rejected with an "access-denied" error.  </li>
</ul>
<p> </p>
</li>
</ul>

<p> </p>
<h1 id="rfc.section.3.2.5">
<a href="#rfc.section.3.2.5">3.2.5.</a> &lt;delete-config&gt; Operation</h1>
<p id="rfc.section.3.2.5.p.1">Access to the &lt;delete-config&gt; protocol operation is denied by default.  The 'exec-default' parameter does not apply to this protocol operation.  Access control rules must be explicitly configured to allow invocation by a non-recovery session.  </p>
<h1 id="rfc.section.3.2.6">
<a href="#rfc.section.3.2.6">3.2.6.</a> &lt;commit&gt; Operation</h1>
<p id="rfc.section.3.2.6.p.1">The server MUST determine the exact nodes in the running configuration datastore which are actually different, and only check "create", "update", and "delete" access permissions for this set of nodes, which could be empty.  </p>
<p id="rfc.section.3.2.6.p.2">For example, if a session can read the entire datastore, but only change one leaf, that session needs to be able to edit and commit that one leaf.  </p>
<h1 id="rfc.section.3.2.7">
<a href="#rfc.section.3.2.7">3.2.7.</a> &lt;discard-changes&gt; Operation</h1>
<p id="rfc.section.3.2.7.p.1">The client is only required to have permission to execute the &lt;discard-changes&gt; protocol operation.  No datastore permissions are needed.  </p>
<h1 id="rfc.section.3.2.8">
<a href="#rfc.section.3.2.8">3.2.8.</a> &lt;kill-session&gt; Operation</h1>
<p id="rfc.section.3.2.8.p.1">The &lt;kill-session&gt; operation does not directly alter a datastore.  However, it allows one session to disrupt another session which is editing a datastore.  </p>
<p id="rfc.section.3.2.8.p.2">Access to the &lt;kill-session&gt; protocol operation is denied by default.  The 'exec-default' parameter does not apply to this protocol operation.  Access control rules must be explicitly configured to allow invocation by a non-recovery session.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Model Components</h1>
<p id="rfc.section.3.3.p.1">This section defines the conceptual components related to access control model.  </p>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> Users</h1>
<p id="rfc.section.3.3.1.p.1">A "user" is the conceptual entity that is associated with the access permissions granted to a particular session.  A user is identified by a string which is unique within the server.  </p>
<p id="rfc.section.3.3.1.p.2">As described in <a href="#RFC6241">[RFC6241]</a>, the user name string is derived from the transport layer during session establishment.  If the transport layer cannot authenticate the user, the session is terminated.  </p>
<p id="rfc.section.3.3.1.p.3">The server MAY support a "recovery session" mechanism, which will bypass all access control enforcement.  This is useful for restricting initial access and repairing a broken access control configuration.  </p>
<h1 id="rfc.section.3.3.2">
<a href="#rfc.section.3.3.2">3.3.2.</a> Groups</h1>
<p id="rfc.section.3.3.2.p.1">Access to a specific NETCONF protocol operation is granted to a session, associated with a group, not a user.  </p>
<p id="rfc.section.3.3.2.p.2">A group is identified by its name.  All group names are unique within the server.  </p>
<p id="rfc.section.3.3.2.p.3">A group member is identified by a user name string.  </p>
<p id="rfc.section.3.3.2.p.4">The same user can be a member of multiple groups.  </p>
<h1 id="rfc.section.3.3.3">
<a href="#rfc.section.3.3.3">3.3.3.</a> Global Enforcement Controls</h1>
<p id="rfc.section.3.3.3.p.1">There are four global controls that are used to help control how access control is enforced.  </p>
<h1 id="rfc.section.3.3.3.1">
<a href="#rfc.section.3.3.3.1">3.3.3.1.</a> enable-nacm Switch</h1>
<p id="rfc.section.3.3.3.1.p.1">A global "enable-nacm" on/off switch is provided to enable or disable all access control enforcement.  When this global switch is set to "true", then all requests are checked against the access control rules, and only permitted if configured to allow the specific access request.  When this global switch is set to "false", then all access requested are permitted.  </p>
<h1 id="rfc.section.3.3.3.2">
<a href="#rfc.section.3.3.3.2">3.3.3.2.</a> read-default Switch</h1>
<p id="rfc.section.3.3.3.2.p.1">An on/off "read-default" switch is provided to enable or disable default access to receive data in replies and notifications.  When the "enable-nacm" global switch is set to "true", then this global switch is relevant, if no matching access control rule is found to explicitly permit or deny read access to the requested NETCONF datastore data or notification event type.  </p>
<p id="rfc.section.3.3.3.2.p.2">When this global switch is set to "permit", and no matching access control rule is found for the NETCONF datastore read or notification event requested, then access is permitted.  </p>
<p id="rfc.section.3.3.3.2.p.3">When this global switch is set to "deny", and no matching access control rule is found for the NETCONF datastore read or notification event requested, then access is denied.  </p>
<h1 id="rfc.section.3.3.3.3">
<a href="#rfc.section.3.3.3.3">3.3.3.3.</a> write-default Switch</h1>
<p id="rfc.section.3.3.3.3.p.1">An on/off "write-default" switch is provided to enable or disable default access to alter configuration data.  When the "enable-nacm" global switch is set to "true", then this global switch is relevant, if no matching access control rule is found to explicitly permit or deny write access to the requested NETCONF datastore data.  </p>
<p id="rfc.section.3.3.3.3.p.2">When this global switch is set to "permit", and no matching access control rule is found for the NETCONF datastore write requested, then access is permitted.  </p>
<p id="rfc.section.3.3.3.3.p.3">When this global switch is set to "deny", and no matching access control rule is found for the NETCONF datastore write requested, then access is denied.  </p>
<h1 id="rfc.section.3.3.3.4">
<a href="#rfc.section.3.3.3.4">3.3.3.4.</a> exec-default Switch</h1>
<p id="rfc.section.3.3.3.4.p.1">An on/off "exec-default" switch is provided to enable or disable default access to execute protocol operations.  When the "enable-nacm" global switch is set to "true", then this global switch is relevant, if no matching access control rule is found to explicitly permit or deny access to the requested NETCONF protocol operation.  </p>
<p id="rfc.section.3.3.3.4.p.2">When this global switch is set to "permit", and no matching access control rule is found for the NETCONF protocol operation requested, then access is permitted.  </p>
<p id="rfc.section.3.3.3.4.p.3">When this global switch is set to "deny", and no matching access control rule is found for the NETCONF protocol operation requested, then access is denied.  </p>
<h1 id="rfc.section.3.3.4">
<a href="#rfc.section.3.3.4">3.3.4.</a> Access Control Rules</h1>
<p id="rfc.section.3.3.4.p.1">There are 4 types of rules available in NACM: </p>

<dl>
<dt>module rule:</dt>
<dd style="margin-left: 8">Controls access for definitions in a specific YANG module, identified by its name.  </dd>
<dt>protocol operation rule:</dt>
<dd style="margin-left: 8">Controls access for a specific protocol operation, identified by its YANG module and name.  </dd>
<dt>data node rule:</dt>
<dd style="margin-left: 8">Controls access for a specific data node, identified by its path location within the conceptual XML document for the data node.  </dd>
<dt>notification rule:</dt>
<dd style="margin-left: 8">Controls access for a specific notification event type, identified by its YANG module and name.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Access Control Enforcement Procedures</h1>
<p id="rfc.section.3.4.p.1">There are seven separate phases that need to be addressed, four of which are related to the NETCONF message processing model.  In addition, the initial start-up mode for a NETCONF server, session establishment, and "access-denied" error handling procedures also need to be considered.  </p>
<p id="rfc.section.3.4.p.2">The server MUST use the access control rules in effect at the time it starts processing the message.  The same access control rules MUST stay in effect for the processing of the entire message.  </p>
<h1 id="rfc.section.3.4.1">
<a href="#rfc.section.3.4.1">3.4.1.</a> Initial Operation</h1>
<p id="rfc.section.3.4.1.p.1">Upon the very first start-up of the NETCONF server, the access control configuration will probably not be present.  If it isn't, a server MUST NOT allow any write access to any session role except a "recovery session".  </p>
<p id="rfc.section.3.4.1.p.2">Access rules are enforced any time a request is initiated from a user session.  Access control is not enforced for server-initiated access requests, such as the initial load of the running datastore, during bootup.  </p>
<h1 id="rfc.section.3.4.2">
<a href="#rfc.section.3.4.2">3.4.2.</a> Session Establishment</h1>
<p id="rfc.section.3.4.2.p.1">The access control model applies specifically to the well-formed XML content transferred between a client and a server, after session establishment has been completed, and after the &lt;hello&gt; exchange has been successfully completed.  </p>
<p id="rfc.section.3.4.2.p.2">Once session establishment is completed, and a user has been authenticated, the NETCONF transport layer reports the user name and a possibly empty set of group names associated with the user to the NETCONF server.  The NETCONF server will enforce the access control rules, based on the supplied user name, group names, and the configuration data stored on the server.  </p>
<h1 id="rfc.section.3.4.3">
<a href="#rfc.section.3.4.3">3.4.3.</a> "access-denied" Error Handling</h1>
<p id="rfc.section.3.4.3.p.1">The "access-denied" error-tag is generated when the access control system denies access to either a request to invoke a protocol operation or a request to perform a particular access operation on the configuration datastore.  </p>
<p id="rfc.section.3.4.3.p.2">A server MUST NOT include any sensitive information in any &lt;error-info&gt; elements within the &lt;rpc-error&gt; response.  </p>
<h1 id="rfc.section.3.4.4">
<a href="#rfc.section.3.4.4">3.4.4.</a> Incoming RPC Message Validation</h1>
<p id="rfc.section.3.4.4.p.1">The diagram below shows the basic conceptual structure of the access control processing model for incoming NETCONF &lt;rpc&gt; messages, within a server.  </p>
<div id="#rfc.figure.3"></div>
<div id="#NACM_incoming"></div>
<pre>


                NETCONF server
               +------------+
               |    XML     |
               |   message  |
               | dispatcher |
               +------------+
                      |
                      |
                      V
               +------------+
               | NC-base NS |
               |   &lt;rpc&gt;    |
               +------------+
                 |   |  |
                 |   |  +-------------------------+
                 |   +------------+               |
                 V                V               V
            +-----------+ +---------------+ +------------+
            | Vendor NS | | NC-base NS    | | NC-base NS |
            | &lt;my-edit&gt; | | &lt;edit-config&gt; | | &lt;unlock&gt;   |
            +-----------+ +---------------+ +------------+
                   |               |
                   |               |
                   V               V
                 +----------------------+
                 |                      |
                 |    configuration     |
                 |      datastore       |
                 +----------------------+


           </pre>
<p></p>
<p id="rfc.section.3.4.4.p.3">Access control begins with the message dispatcher.  </p>
<p id="rfc.section.3.4.4.p.4">After the server validates the &lt;rpc&gt; element, and determines the namespace URI and the element name of the protocol operation being requested, the server verifies that the user is authorized to invoke the protocol operation.  </p>
<p id="rfc.section.3.4.4.p.5">The server MUST separately authorize every protocol operation by following these steps: </p>

<ol>
<li>If the "enable-nacm" leaf is set to "false", then the protocol operation is permitted.  </li>
<li>If the requesting session is identified as a "recovery session", then the protocol operation is permitted.  </li>
<li>If the requested operation is the NETCONF &lt;close-session&gt; protocol operation, then the protocol operation is permitted.  </li>
<li>Check all the "group" entries for ones that contain a "user-name" entry that equals the user name for the session making the request.  Add to these groups the set of groups provided by the transport layer.  </li>
<li>If no groups are found, continue with step 10.  </li>
<li>Process all rule-list entries, in the order they appear in the configuration.  If a rule-list's "group" leaf-list does not match any of the user's groups, proceed to the next rule-list entry.  </li>
<li>For each rule-list entry found, process all rules, in order, until a rule that matches the requested access operation is found.  A rule matches if all of the following criteria are met: <ul>
<li>The rule's "module-name" leaf is "*", or equals the name of the YANG module where the protocol operation is defined.  </li>
<li>The rule does not have a "rule-type" defined, or the "rule-type" is "protocol-operation" and the "rpc-name" is "*" or equals the name of the requested protocol operation.  </li>
<li>The rule's "access-operations" leaf has the "exec" bit set, or has the special value "*".  </li>
</ul>
<p> </p>
</li>
<li>If a matching rule is found, then the "action" leaf is checked.  If it is equal to "permit", then the protocol operation is permitted, otherwise it is denied.  </li>
<li>Otherwise, no matching rule was found in any rule-list entry.  </li>
<li>If the requested protocol operation is defined in a YANG module advertised in the server capabilities, and the "rpc" statement contains a "nacm:default-deny-all" statement, then the protocol operation is denied.  </li>
<li>If the requested protocol operation is the NETCONF &lt;kill-session&gt; or &lt;delete-config&gt;, then the protocol operation is denied.  </li>
<li>If the "exec-default" leaf is set to "permit", then permit the protocol operation, otherwise deny the request.  </li>
</ol>

<p> </p>
<div id="#rfc.figure.4"></div>
<pre>
		 
      &lt;error-path
        xmlns:nc="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;
          /nc:rpc/nc:edit-config
      &lt;/error-path&gt;
</pre>
<p id="rfc.section.3.4.4.p.6">If the user is not authorized to invoke the protocol operation then an &lt;rpc-error&gt; is generated with the following information: </p>

<dl>
<dt>error-tag:</dt>
<dd style="margin-left: 8">access-denied</dd>
<dt>error-path:</dt>
<dd style="margin-left: 8">Identifies the requested protocol operation.  For example: </dd>
</dl>

<p> </p>
<p id="rfc.section.3.4.4.p.7">If a datastore is accessed, either directly or as a side effect of the protocol operation, then the server MUST intercept the access operation and make sure the user is authorized to perform the requested access operation on the specified data, as defined in <a href="#node-access">Section 3.4.5</a>.  </p>
<h1 id="rfc.section.3.4.5">
<a href="#rfc.section.3.4.5">3.4.5.</a> <a href="#node-access" id="node-access">Data Node Access Validation</a>
</h1>
<p id="rfc.section.3.4.5.p.1">If a data node within a datastore is accessed, then the server MUST ensure that the user is authorized to perform the requested read, create, update, or delete access operation on the specified data node.  </p>
<p id="rfc.section.3.4.5.p.2">The data node access request is authorized by following these steps: </p>

<ol>
<li>If the "enable-nacm" leaf is set to "false", then the access operation is permitted.  </li>
<li>If the requesting session is identified as a "recovery session", then the access operation is permitted.  </li>
<li>Check all the "group" entries for ones that contain a "user-name" entry that equals the user name for the session making the request.  Add to these groups the set of groups provided by the transport layer.  </li>
<li>If no groups are found, continue with step 9.  </li>
<li>Process all rule-list entries, in the order they appear in the configuration.  If a rule-list's "group" leaf-list does not match any of the user's groups, proceed to the next rule-list entry.  </li>
<li>For each rule-list entry found, process all rules, in order, until a rule that matches the requested access operation is found.  A rule matches if all of the following criteria are met: <ul>
<li>The rule's "module-name" leaf is "*", or equals the name of the YANG module where the requested data node is defined.  </li>
<li>The rule does not have a "rule-type" defined, or the "rule-type" is "data-node" and the "path" matches the requested data node.  </li>
<li>For a read access operation, the rule's "access-operations" leaf has the "read" bit set, or has the special value "*".  </li>
<li>For a create access operation, the rule's "access-operations" leaf has the "create" bit set, or has the special value "*".  </li>
<li>For a delete access operation, the rule's "access-operations" leaf has the "delete" bit set, or has the special value "*".  </li>
<li>For an update access operation, the rule's "access-operations" leaf has the "update" bit set, or has the special value "*".  </li>
</ul>
<p> </p>
</li>
<li>If a matching rule is found, then the "action" leaf is checked.  If it is equal to "permit", then the data node access is permitted, otherwise it is denied.  For a read access operation, "denied" means that the requested data is not returned in the reply.  </li>
<li>Otherwise, no matching rule was found in any rule-list entry.  </li>
<li>For a read access operation, if the requested data node is defined in a YANG module advertised in the server capabilities, and the data definition statement contains a "nacm:default-deny-all" statement, then the requested data node is not included in the reply.  </li>
<li>For a write access operation, if the requested data node is defined in a YANG module advertised in the server capabilities, and the data definition statement contains a "nacm:default-deny-write" or a "nacm:default-deny-all" statement, then the data node access request is denied.  </li>
<li>For a read access operation, if the "read-default" leaf is set to "permit", then include the requested data node in the reply, otherwise do not include the requested data node in the reply.  </li>
<li>For a write access operation, if the "write-default" leaf is set to "permit", then permit the data node access request, otherwise deny the request.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.3.4.6">
<a href="#rfc.section.3.4.6">3.4.6.</a> Outgoing &lt;notification&gt; Authorization</h1>
<p id="rfc.section.3.4.6.p.1">Configuration of access control rules specifically for descendant nodes of the notification event type element are outside the scope of this document.  If the user is authorized to receive the notification event type, then it is also authorized to receive any data it contains.  </p>
<p id="rfc.section.3.4.6.p.2">The following figure shows the conceptual message processing model for outgoing &lt;notification&gt; messages.  </p>
<div id="#rfc.figure.5"></div>
<div id="#NACM_outgoing_notification"></div>
<pre>
             

                NETCONF server
               +------------+
               |    XML     |
               |   message  |
               | generator  |
               +------------+
                     ^
                     |
             +----------------+
             | &lt;notification&gt; |
             |  generator     |
             +----------------+
                     ^
                     |
            +=================+
            | &lt;notification&gt;  |
            |  access control |
            |  &lt;eventType&gt;    |
            +=================+ 
                     ^
                     |
         +------------------------+
         | server instrumentation |
         +------------------------+
                   |     ^
                   V     |
          +----------------------+
          |    configuration     |
          |      datastore       |
          +----------------------+


           </pre>
<p></p>
<p id="rfc.section.3.4.6.p.4">The generation of a notification for a specific subscription <a href="#RFC5277">[RFC5277]</a> is authorized by following these steps: </p>

<ol>
<li>If the "enable-nacm" leaf is set to "false", then the notification is permitted.  </li>
<li>If the session is identified as a "recovery session", then the notification is permitted.  </li>
<li>If the notification is the NETCONF &lt;replayComplete&gt; or &lt;notificationComplete&gt; event type <a href="#RFC5277">[RFC5277]</a>, then the notification is permitted.  </li>
<li>Check all the "group" entries for ones that contain a "user-name" entry that equals the user name for the session making the request.  Add to these groups the set of groups provided by the transport layer.  </li>
<li>If no groups are found, continue with step 10.  </li>
<li>Process all rule-list entries, in the order they appear in the configuration.  If a rule-list's "group" leaf-list does not match any of the user's groups, proceed to the next rule-list entry.  </li>
<li>For each rule-list entry found, process all rules, in order, until a rule that matches the requested access operation is found.  A rule matches if all of the following criteria are met: <ul>
<li>The rule's "module-name" leaf is "*", or equals the name of the YANG module where the notification is defined.  </li>
<li>The rule does not have a "rule-type" defined, or the "rule-type" is "notification" and the "notification-name" is "*", equals the name of the notification.  </li>
<li>The rule's "access-operations" leaf has the "read" bit set, or has the special value "*".  </li>
</ul>
<p> </p>
</li>
<li>If a matching rule is found, then the "action" leaf is checked.  If it is equal to "permit", then permit the notification, otherwise drop the notification for the associated subscription.  </li>
<li>Otherwise, no matching rule was found in any rule-list entry.  </li>
<li>If the requested notification is defined in a YANG module advertised in the server capabilities, and the "notification" statement contains a "nacm:default-deny-all" statement, then the notification is dropped for the associated subscription.  </li>
<li>If the "read-default" leaf is set to "permit", then permit the notification, otherwise drop the notification for the associated subscription.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#DM" id="DM">Data Model Definitions</a>
</h1>
<p id="rfc.section.3.5.p.1">This section defines the semantics of the conceptual data structures found in the data model in <a href="#DM">Section 3.5</a>.  </p>
<h1 id="rfc.section.3.5.1">
<a href="#rfc.section.3.5.1">3.5.1.</a> Data Organization</h1>
<p id="rfc.section.3.5.1.p.1">The following diagram highlights the contents and structure of the NACM YANG module.  </p>
<div id="#rfc.figure.6"></div>
<pre>
   +--rw nacm
      +--rw enable-nacm?            boolean
      +--rw read-default?           action-type
      +--rw write-default?          action-type
      +--rw exec-default?           action-type
      +--ro denied-operations       yang:zero-based-counter32
      +--ro denied-data-writes      yang:zero-based-counter32
      +--ro denied-notifications    yang:zero-based-counter32
      +--rw groups
      |  +--rw group [name]
      |     +--rw name         group-name-type
      |     +--rw user-name*   user-name-type
      +--rw rule-list [name]
         +--rw name     string
         +--rw group*   union
         +--rw rule [name]
            +--rw name                 string
            +--rw module-name?         union
            +--rw (rule-type)?
            |  +--:(protocol-operation)
            |  |  +--rw rpc-name?            union
            |  +--:(notification)
            |  |  +--rw notification-name?   union
            |  +--:(data-node)
            |     +--rw path                 node-instance-identifier
            +--rw access-operations?   union
            +--rw action               action-type
            +--rw comment?             string
             </pre>
<h1 id="rfc.section.3.5.2">
<a href="#rfc.section.3.5.2">3.5.2.</a> YANG Module</h1>
<p id="rfc.section.3.5.2.p.1">The following YANG module specifies the normative NETCONF content that MUST by supported by the server.  </p>
<p id="rfc.section.3.5.2.p.2">The "ietf-netconf-acm" YANG module imports typedefs from <a href="#RFC6021">[RFC6021]</a>.  </p>
<div id="#rfc.figure.7"></div>
<div id="#YANG_module"></div>
<pre>
// RFC Ed.: please update the date to the date of publication
&lt;CODE BEGINS&gt; file="ietf-netconf-acm@2011-10-31.yang"

module ietf-netconf-acm {

  namespace "urn:ietf:params:xml:ns:yang:ietf-netconf-acm";

  prefix "nacm";

  import ietf-yang-types {
    prefix yang;
  }

  organization
    "IETF NETCONF (Network Configuration) Working Group";


  contact
    "WG Web:   &lt;http://tools.ietf.org/wg/netconf/&gt;
     WG List:  &lt;mailto:netconf@ietf.org&gt;

     WG Chair: Mehmet Ersue
               &lt;mailto:mehmet.ersue@nsn.com&gt;

     WG Chair: Bert Wijnen
               &lt;mailto:bertietf@bwijnen.net&gt;

     Editor:   Andy Bierman
               &lt;mailto:andy.bierman@brocade.com&gt;

     Editor:   Martin Bjorklund
               &lt;mailto:mbj@tail-f.com&gt;";

  description 
    "NETCONF Access Control Model.

     Copyright (c) 2011 IETF Trust and the persons identified as
     authors of the code. All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD
     License set forth in Section 4.c of the IETF Trust's
     Legal Provisions Relating to IETF Documents
     (http://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC XXXX; see
     the RFC itself for full legal notices.";
  // RFC Ed.: replace XXXX with actual RFC number and
  // remove this note

  // RFC Ed.: remove this note
  // Note: extracted from draft-ietf-netconf-access-control-06.txt

  // RFC Ed.: please update the date to the date of publication
  revision "2011-10-31" {
    description
      "Initial version";
    reference 
      "RFC XXXX: Network Configuration Protocol
                 Access Control Model";
  }

  /*
   * Extension statements
   */

  extension default-deny-write {
    description
      "Used to indicate that the data model node 
       represents a sensitive security system parameter.

       If present, and the NACM module is enabled (i.e.,
       /nacm/enable-nacm object equals 'true'), the NETCONF server
       will only allow the designated 'recovery session' to have
       write access to the node.  An explicit access control rule is
       required for all other users.

       The 'default-deny-write' extension MAY appear within a data
       definition statement.  It is ignored otherwise.";
  }

  extension default-deny-all {
    description
      "Used to indicate that the data model node 
       controls a very sensitive security system parameter.

       If present, and the NACM module is enabled (i.e.,
       /nacm/enable-nacm object equals 'true'), the NETCONF server
       will only allow the designated 'recovery session' to have
       read, write, or execute access to the node.  An explicit
       access control rule is required for all other users.

       The 'default-deny-all' extension MAY appear within a data
       definition statement, 'rpc' statement, or 'notification'
       statement.  It is ignored otherwise.";
  }

  /*
   * Derived types
   */

  typedef user-name-type {
    type string {
      length "1..max";
    }
    description
      "General Purpose User Name string.";
  }

  typedef matchall-string-type {
    type string {
      pattern "\*";
    }
    description
      "The string containing a single asterisk '*' is used
       to conceptually represent all possible values
       for the particular leaf using this data type.";
  }
  
  typedef access-operations-type {
    type bits {
      bit create {
        description
          "Any protocol operation that creates a
           new data node.";
      }
      bit read {
        description
          "Any protocol operation or notification that
           returns the value of a data node.";
      }
      bit update {
        description
          "Any protocol operation that alters an existing
           data node.";
      }
      bit delete {
        description
          "Any protocol operation that removes a data node.";
      }
      bit exec {
        description
          "Execution access to the specified protocol operation.";
      }
    }
    description 
      "NETCONF Access Operation.";
  }

  typedef group-name-type {
    type string {
      length "1..max";
      pattern "[^\*].*";
    }
    description 
      "Name of administrative group to which
       users can be assigned.";
  }

  typedef action-type {
    type enumeration {
      enum permit {
        description
          "Requested action is permitted.";
      }
      enum deny {
        description
          "Requested action is denied.";
      }
    }
    description
      "Action taken by the server when a particular
       rule matches.";
  }

  typedef node-instance-identifier {
    type yang:xpath1.0;
    description
      "Path expression used to represent a special 
       data node instance identifier string.
     
       A node-instance-identifier value is an 
       unrestricted YANG instance-identifier expression.
       All the same rules as an instance-identifier apply
       except predicates for keys are optional.  If a key
       predicate is missing, then the node-instance-identifier
       represents all possible server instances for that key.

       This XPath expression is evaluated in the following context:

         o  The set of namespace declarations are those in scope on
            the leaf element where this type is used.

         o  The set of variable bindings contains one variable,
            'USER', which contains the name of user of the current
             session.

         o  The function library is the core function library, but
            note that due to the syntax restrictions of an
            instance-identifier, no functions are allowed.

         o  The context node is the root node in the data tree.";
  }

  container nacm {
    nacm:default-deny-all;

    description
      "Parameters for NETCONF Access Control Model.";

    leaf enable-nacm {
      type boolean;
      default true;
      description
        "Enable or disable all NETCONF access control
         enforcement.  If 'true', then enforcement
         is enabled.  If 'false', then enforcement
         is disabled.";
    } 

    leaf read-default {
      type action-type;
      default "permit";
      description
        "Controls whether read access is granted if
         no appropriate rule is found for a
         particular read request.";
    }

    leaf write-default {
      type action-type;
      default "deny";
      description
        "Controls whether create, update, or delete access
         is granted if no appropriate rule is found for a
         particular write request.";
    }

    leaf exec-default {
      type action-type;
      default "permit";
      description
        "Controls whether exec access is granted if no appropriate
         rule is found for a particular protocol operation request.";
    }

    leaf denied-operations {
      type yang:zero-based-counter32;
      config false;
      mandatory true;
      description
        "Number of times a protocol operation request was denied
         since the server last restarted.";
    }

    leaf denied-data-writes {
      type yang:zero-based-counter32;
      config false;
      mandatory true;
      description
        "Number of times a protocol operation request to alter
         a configuration datastore was denied, since the 
         server last restarted.";
    }

    leaf denied-notifications {
      type yang:zero-based-counter32;
      config false;
      mandatory true;
      description
        "Number of times a notification was dropped
         for a subscription because access to 
         the event type was denied, since the server 
         last restarted.";
    }

    container groups {
      description
        "NETCONF Access Control Groups.";

      list group {
        key name;

        description
          "One NACM Group Entry.";

        leaf name {
          type group-name-type;
          description 
            "Group name associated with this entry.";
        }

        leaf-list user-name {
          type user-name-type;
          description 
            "Each entry identifies the user name of 
             a member of the group associated with 
             this entry.";
        }
      }
    }

    list rule-list {
      key "name";
      ordered-by user;
      description
        "An ordered collection of access control rules.";
      
      leaf name {
        type string {
          length "1..max";
        }
        description
          "Arbitrary name assigned to the rule-list.";
      }
      leaf-list group {
        type union {
          type matchall-string-type;
          type group-name-type;
        }
        description
          "List of administrative groups that will be
           assigned the associated access rights
           defined by the 'rule' list.

           The string '*' indicates that all groups apply to the
           entry.";
      }

      list rule {
        key "name";
        ordered-by user;
        description
          "One access control rule.

           Rules are processed in user-defined order until a match is
           found.  A rule matches if 'module-name', 'rule-type', and
           'access-operations' matches the request.  If a rule
           matches, the 'action' leaf determines if access is granted
           or not.";

        leaf name {
          type string {
            length "1..max";
          }
          description
            "Arbitrary name assigned to the rule.";
        }
        
        leaf module-name {
          type union {
            type matchall-string-type;
            type string;
          }
          default "*";
          description
            "Name of the module associated with this rule.

             This leaf matches if it has the value '*', or if the
             object being accessed is defined in the module with the
             specified module name.";
        }
        choice rule-type {
          description
            "This choice matches if all leafs present in the rule
             matches the request.  If no leafs are present, the
             choice matches all requests.";
          case protocol-operation {
            leaf rpc-name {
              type union {
                type matchall-string-type;
                type string;
              }
              description
                "This leaf matches if it has the value '*', or if
                 its value equals the requested protocol operation
                 name.";
            }
          }
          case notification {
            leaf notification-name {
              type union {
                type matchall-string-type;
                type string;
              }
              description
                "This leaf matches if it has the value '*', or if its
                 value equals the requested notification name.";
            }
          }
          case data-node {
            leaf path {
              type node-instance-identifier;
              mandatory true;
              description
                "Data Node Instance Identifier associated with the
                 data node controlled by this rule.

                 Configuration data or state data instance 
                 identifiers start with a top-level data node.  A
                 complete instance identifier is required for this
                 type of path value.

                 The special value '/' refers to all possible data
                 store contents.";
            }
          }
        }

        leaf access-operations {
          type union {
            type matchall-string-type;
            type access-operations-type;
          }
          default "*";
          description
            "Access operations associated with this rule.

             This leaf matches if it has the value '*', or if the
             bit corresponding to the requested operation is set.";
        }

        leaf action {
          type action-type;
          mandatory true;
          description
            "The access control action associated with the
             rule.  If a rule is determined to match a
             particular request, then this object is used
             to determine whether to permit or deny the
             request.";
        }
        
        leaf comment {
          type string;
          description
            "A textual description of the access rule.";
        }
      }
    }
  }
}


&lt;CODE ENDS&gt;
             </pre>
<p></p>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.3.6.p.1">There are two actions that are requested of IANA: This document registers one URI in "The IETF XML Registry".  Following the format in <a href="#RFC3688">[RFC3688]</a>, the following has been registered.  </p>
<div id="#rfc.figure.8"></div>
<pre>
     URI: urn:ietf:params:xml:ns:yang:ietf-netconf-acm
     Registrant Contact: The IESG.
     XML: N/A, the requested URI is an XML namespace.
             </pre>
<p></p>
<div id="#rfc.figure.9"></div>
<pre>
     name: ietf-netconf-acm
     namespace: urn:ietf:params:xml:ns:yang:ietf-netconf-acm
     prefix: nacm
     reference: RFC XXXX
        // RFC Ed.: Replace XXX with actual RFC number 
        // and remove this note
             </pre>
<p id="rfc.section.3.6.p.3">This document registers one module in the "YANG Module Names" registry.  Following the format in <a href="#RFC6020">[RFC6020]</a>, the following has been registered.  </p>
<h1 id="rfc.section.3.7">
<a href="#rfc.section.3.7">3.7.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.3.7.p.1">This entire document discusses access control requirements and mechanisms for restricting NETCONF protocol behavior within a given session.  </p>
<p id="rfc.section.3.7.p.2">This section highlights the issues for an administrator to consider when configuring a NETCONF server with NACM.  </p>
<h1 id="rfc.section.3.7.1">
<a href="#rfc.section.3.7.1">3.7.1.</a> NACM Configuration and Monitoring Considerations</h1>
<p id="rfc.section.3.7.1.p.1">Configuration of the access control system is highly sensitive to system security.  A server may choose not to allow any user configuration to some portions of it, such as the global security level, or the groups which allowed access to system resources.  </p>
<p id="rfc.section.3.7.1.p.2">By default, NACM enforcement is enabled.  By default, "read" access to all datastore contents enabled, (unless "nacm:default-deny-all" is specified for the data definition) and "exec" access is enabled for safe protocol operations.  An administrator needs to ensure that NACM is enabled, and also decide if the default access parameters are set appropriately.  Make sure the following data nodes are properly configured: </p>

<ul>
<li>/nacm/enable-nacm (default "true")</li>
<li>/nacm/read-default (default "permit")</li>
<li>/nacm/write-default (default "deny")</li>
<li>/nacm/exec-default (default "permit")</li>
</ul>

<p> </p>
<p id="rfc.section.3.7.1.p.3">An administrator needs to restrict write access to all configurable objects within this data model.  </p>
<p id="rfc.section.3.7.1.p.4">If write access is allowed for configuration of access control rules, then care needs to be taken not to disrupt the access control enforcement.  For example, if the NACM access control rules are edited directly within the running configuration datastore (i.e., :writable-running capability is supported and used), then care needs to be taken not to allow unintended access while the edits are being done.  </p>
<p id="rfc.section.3.7.1.p.5">An administrator needs to make sure that the translation from a transport or implementation dependant user identity to a NACM user name is unique and correct.  This requirement is specified in detail in section 2.2 of <a href="#RFC6241">[RFC6241]</a>.  </p>
<p id="rfc.section.3.7.1.p.6">An administrator needs to be aware that the YANG data structures representing access control rules (/nacm/rule-list and /nacm/rule-list/rule) are ordered by the client.  The server will evaluate the access control rules according to their relative conceptual order within the running datastore configuration.  </p>
<p id="rfc.section.3.7.1.p.7">Note that the /nacm/groups data structure contains the administrative group names used by the server.  These group names may be configured locally and/or provided through an external protocol, such as RADIUS <a href="#RFC2865">[RFC2865]</a> <a href="#RFC5607">[RFC5607]</a>.  </p>
<p id="rfc.section.3.7.1.p.8">An administrator needs to restrict read access to the following objects within this data model, which reveal access control configuration which could be considered sensitive.  </p>

<ul>
<li>/nacm/enable-nacm</li>
<li>/nacm/read-default</li>
<li>/nacm/write-default</li>
<li>/nacm/exec-default</li>
<li>/nacm/groups</li>
<li>/nacm/rule-list</li>
</ul>

<p> </p>
<h1 id="rfc.section.3.7.2">
<a href="#rfc.section.3.7.2">3.7.2.</a> General Configuration Issues</h1>
<p id="rfc.section.3.7.2.p.1">There is a risk that invocation of non-standard protocol operations will have undocumented side effects.  An administrator needs to construct access control rules such that the configuration datastore is protected from such side effects.  </p>
<p id="rfc.section.3.7.2.p.2">It is possible for a session with some write access (e.g., allowed to invoke &lt;edit-config&gt;), but without any access to a particular datastore subtree containing sensitive data, to determine the presence or non-presence of that data.  This can be done by repeatedly issuing some sort of edit request (create, update, or delete) and possibly receiving "access-denied" errors in response.  These "fishing" attacks can identify the presence or non-presence of specific sensitive data even without the "error-path" field being present within the "rpc-error" response.  </p>
<p id="rfc.section.3.7.2.p.3">It may be possible for the set of NETCONF capabilities on the server to change over time.  If so, then there is a risk that new protocol operations, notifications, and/or datastore content have been added to the device.  An administrator needs to be sure the access control rules are correct for the new content in this case.  Mechanisms to detect NETCONF capability changes on a specific device are outside the scope of this document.  </p>
<p id="rfc.section.3.7.2.p.4">It is possible that the data model definition itself (e.g., YANG when-stmt) will help an unauthorized session determine the presence or even value of sensitive data nodes by examining the presence and values of different data nodes.  </p>
<p id="rfc.section.3.7.2.p.5">There is a risk that non-standard protocol operations, or even the standard &lt;get&gt; protocol operation, may return data which "aliases" or "copies" sensitive data from a different data object.  There may simply be multiple data model definitions which expose or even configure the same underlying system instrumentation.  </p>
<p id="rfc.section.3.7.2.p.6">A data model may contain external keys (e.g., YANG leafref), which expose values from a different data structure.  An administrator needs to be aware of sensitive data models which contain leafref nodes.  This entails finding all the leafref objects that "point" at the sensitive data (i.e., "path-stmt" values) that implicitly or explicitly include the sensitive data node.  </p>
<p id="rfc.section.3.7.2.p.7">It is beyond the scope of this document to define access control enforcement procedures for underlying device instrumentation that may exist to support the NETCONF server operation.  An administrator can identify each protocol operation that the server provides, and decide if it needs any access control applied to it.  </p>
<p id="rfc.section.3.7.2.p.8">This document incorporates the optional use of a "recovery session" mechanism, which can be used to bypass access control enforcement in emergencies, such as NACM configuration errors which disable all access to the server.  The configuration and identification of such a recovery session mechanism are implementation-specific and outside the scope of this document.  An administrator needs to be aware of any "recovery session" mechanisms available on the device, and make sure they are used appropriately.  </p>
<p id="rfc.section.3.7.2.p.9">It is possible for a session to disrupt configuration management, even without any write access to the configuration, by locking the datastore. This may be done to insure all or part of the configuration  remains stable while it is being retrieved, or it may be done as a "denial-of-service" attack.  There is no way for the server to know the difference.  An administrator may wish to restrict "exec" access to the following protocol operations: </p>

<ul>
<li>&lt;lock&gt;</li>
<li>&lt;unlock&gt;</li>
<li>&lt;partial-lock&gt;</li>
<li>&lt;partial-unlock&gt;</li>
</ul>

<p> </p>
<h1 id="rfc.section.3.7.3">
<a href="#rfc.section.3.7.3">3.7.3.</a> Data Model Design Considerations</h1>
<p id="rfc.section.3.7.3.p.1">Designers need to clearly identify any sensitive data, notifications, or protocol operations defined within a YANG module.  For such definitions, a "nacm:default-deny-write" or "nacm:default-deny-all" statement SHOULD be present, in addition to a clear description of the security risks.  </p>
<p id="rfc.section.3.7.3.p.2">Protocol operations need to be properly documented by the data model designer, so it is clear to administrators what data nodes (if any) are affected by the protocol operation, and what information (if any) is returned in the &lt;rpc-reply&gt; message.  </p>
<p id="rfc.section.3.7.3.p.3">Data models ought to be designed so that different access levels for input parameters to protocol operations is not required.  Use of generic protocol operations should be avoided, and separate protocol operations defined instead, if different access levels are needed.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">4.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">4.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3688">[RFC3688]</b></td>
<td class="top">
<a>Mealling, M.</a>, "<a href="http://tools.ietf.org/html/rfc3688">The IETF XML Registry</a>", BCP 81, RFC 3688, January 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5277">[RFC5277]</b></td>
<td class="top">
<a>Chisholm, S.</a> and <a>H. Trevino</a>, "<a href="http://tools.ietf.org/html/rfc5277">NETCONF Event Notifications</a>", RFC 5277, July 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6020">[RFC6020]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="http://tools.ietf.org/html/rfc6020">YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)</a>", RFC 6020, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6021">[RFC6021]</b></td>
<td class="top">
<a>Schoenwaelder, J.</a>, "<a href="http://tools.ietf.org/html/rfc6021">Common YANG Data Types</a>", RFC 6021, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6241">[RFC6241]</b></td>
<td class="top">
<a>Enns, R.</a>, <a>Bjorklund, M.</a>, <a>Schoenwaelder, J.</a> and <a>A. Bierman</a>, "<a href="http://tools.ietf.org/html/rfc6241">Network Configuration Protocol (NETCONF)</a>", RFC 6241, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6242">[RFC6242]</b></td>
<td class="top">
<a>Wasserman, M.</a>, "<a href="http://tools.ietf.org/html/rfc6242">Using the NETCONF Protocol over Secure Shell (SSH)</a>", RFC 6242, June 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">4.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2865">[RFC2865]</b></td>
<td class="top">
<a>Rigney, C.</a>, <a>Willens, S.</a>, <a>Rubens, A.</a> and <a>W. Simpson</a>, "<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>", RFC 2865, June 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5607">[RFC5607]</b></td>
<td class="top">
<a>Nelson, D.</a> and <a>G. Weber</a>, "<a href="http://tools.ietf.org/html/rfc5607">Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management</a>", RFC 5607, July 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Usage Examples</h1>
<p id="rfc.section.Appendix A.p.1">The following XML snippets are provided as examples only, to demonstrate how NACM can be configured to perform some access control tasks.  </p>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> &lt;groups&gt; Example</h1>
<p id="rfc.section.Appendix A.1.p.1">There needs to be at least one &lt;group&gt; entry in order for any of the access control rules to be useful.  </p>
<p id="rfc.section.Appendix A.1.p.2">The following XML shows arbitrary groups, and is not intended to represent any particular use-case.  </p>
<div id="#rfc.figure.10"></div>
<pre>
&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
  &lt;groups&gt;
    &lt;group&gt;
      &lt;name&gt;admin&lt;/name&gt;
      &lt;user-name&gt;admin&lt;/user-name&gt;
      &lt;user-name&gt;andy&lt;/user-name&gt;
    &lt;/group&gt;

    &lt;group&gt;
      &lt;name&gt;limited&lt;/name&gt;
      &lt;user-name&gt;wilma&lt;/user-name&gt;
      &lt;user-name&gt;bam-bam&lt;/user-name&gt;
    &lt;/group&gt;

    &lt;group&gt;
      &lt;name&gt;guest&lt;/name&gt;
      &lt;user-name&gt;guest&lt;/user-name&gt;
      &lt;user-name&gt;guest@example.com&lt;/user-name&gt;
    &lt;/group&gt;
  &lt;/groups&gt;
&lt;/nacm&gt;


            
          </pre>
<p></p>
<p id="rfc.section.Appendix A.1.p.4">This example shows 3 groups: </p>

<ol>
<li>The "admin" group contains 2 users named "admin" and "andy".  </li>
<li>The "limited" group contains 2 users named "wilma" and "bam-bam".  </li>
<li>The "guest" group contains 2 users named "guest" and "guest@example.com".  </li>
</ol>

<p> </p>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> Module Rule Example</h1>
<p id="rfc.section.Appendix A.2.p.1">Module rules are used to control access to all the content defined in a specific module.  A module rule has the &lt;module-name&gt; leaf set, but no case in the "rule-type" choice.  </p>
<div id="#rfc.figure.11"></div>
<pre>
&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
  &lt;rule-list&gt;
    &lt;name&gt;guest-acl&lt;/name&gt;
    &lt;group&gt;guest&lt;/group&gt;

    &lt;rule&gt;
      &lt;name&gt;deny-ncm&lt;/name&gt;
      &lt;module-name&gt;ietf-netconf-monitoring&lt;/module-name&gt;
      &lt;access-operations&gt;*&lt;/access-operations&gt;
      &lt;action&gt;deny&lt;/action&gt;
      &lt;comment&gt;
          Do not allow guests any access to the netconf 
          monitoring information.
      &lt;/comment&gt;
    &lt;/rule&gt;
  &lt;/rule-list&gt;

  &lt;rule-list&gt;
    &lt;name&gt;limited-acl&lt;/name&gt;
    &lt;group&gt;limited&lt;/group&gt;

    &lt;rule&gt;
      &lt;name&gt;permit-ncm&lt;/name&gt;
      &lt;module-name&gt;ietf-netconf-monitoring&lt;/module-name&gt;
      &lt;access-operations&gt;read&lt;/access-operations&gt;
      &lt;action&gt;permit&lt;/action&gt;
      &lt;comment&gt;
          Allow read access to the netconf 
          monitoring information.
      &lt;/comment&gt;
    &lt;/rule&gt;
    &lt;rule&gt;
      &lt;name&gt;permit-exec&lt;/name&gt;
      &lt;module-name&gt;*&lt;/module-name&gt;
      &lt;access-operations&gt;exec&lt;/access-operations&gt;
      &lt;action&gt;permit&lt;/action&gt;
      &lt;comment&gt;
          Allow invocation of the
          supported server operations.
      &lt;/comment&gt;
    &lt;/rule&gt;
  &lt;/rule-list&gt;

  &lt;rule-list&gt;
    &lt;name&gt;admin-acl&lt;/name&gt;
    &lt;group&gt;admin&lt;/group&gt;

    &lt;rule&gt;
      &lt;name&gt;permit-all&lt;/name&gt;
      &lt;module-name&gt;*&lt;/module-name&gt;
      &lt;access-operations&gt;*&lt;/access-operations&gt;
      &lt;action&gt;permit&lt;/action&gt;
      &lt;comment&gt;
          Allow the admin group complete access to all
          operations and data.
      &lt;/comment&gt;
    &lt;/rule&gt;
  &lt;/rule-list&gt;
&lt;/nacm&gt;


            
          </pre>
<p></p>
<p id="rfc.section.Appendix A.2.p.3">This example shows 4 module rules: </p>

<dl>
<dt>deny-ncm:</dt>
<dd style="margin-left: 8">This rule prevents the "guest" group from reading any monitoring information in the "ietf-netconf-monitoring" YANG module.  </dd>
<dt>permit-ncm:</dt>
<dd style="margin-left: 8">This rule allows the "limited" group to read the "ietf-netconf-monitoring" YANG module.  </dd>
<dt>permit-exec:</dt>
<dd style="margin-left: 8">This rule allows the "limited" group to invoke any protocol operation supported by the server.  </dd>
<dt>permit-all:</dt>
<dd style="margin-left: 8">This rule allows the "admin" group complete access to all content in the server.  No subsequent rule will match for the "admin" group, because of this module rule.  </dd>
</dl>

<p> </p>
<h1 id="rfc.appendix.Appendix A.3">
<a href="#rfc.appendix.Appendix%20A.3">Appendix A.3.</a> RPC Rule Example</h1>
<p id="rfc.section.Appendix A.3.p.1">RPC rules are used to control access to a specific protocol operation.  </p>
<div id="#rfc.figure.12"></div>
<pre>
&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
  &lt;rule-list&gt;
    &lt;name&gt;guest-limited-acl&lt;/name&gt;
    &lt;group&gt;limited&lt;/group&gt;
    &lt;group&gt;guest&lt;/group&gt;

    &lt;rule&gt;
      &lt;name&gt;deny-kill-session&lt;/name&gt;
      &lt;module-name&gt;ietf-netconf&lt;/module-name&gt;
      &lt;rpc-name&gt;kill-session&lt;/rpc-name&gt;
      &lt;access-operations&gt;exec&lt;/access-operations&gt;
      &lt;action&gt;deny&lt;/action&gt;
      &lt;comment&gt;
        Do not allow the limited or guest group
        to kill another session.
      &lt;/comment&gt;
    &lt;/rule&gt;
    &lt;rule&gt;
      &lt;name&gt;deny-delete-config&lt;/name&gt;
      &lt;module-name&gt;ietf-netconf&lt;/module-name&gt;
      &lt;rpc-name&gt;delete-config&lt;/rpc-name&gt;
      &lt;access-operations&gt;exec&lt;/access-operations&gt;
      &lt;action&gt;deny&lt;/action&gt;
      &lt;comment&gt;
        Do not allow limited or guest group
        to delete any configurations.
      &lt;/comment&gt;
    &lt;/rule&gt;
  &lt;/rule-list&gt;

  &lt;rule-list&gt;
    &lt;name&gt;limited-acl&lt;/name&gt;
    &lt;group&gt;limited&lt;/group&gt;

    &lt;rule&gt;
      &lt;name&gt;permit-edit-config&lt;/name&gt;
      &lt;module-name&gt;ietf-netconf&lt;/module-name&gt;
      &lt;rpc-name&gt;edit-config&lt;/rpc-name&gt;
      &lt;access-operations&gt;exec&lt;/access-operations&gt;
      &lt;action&gt;permit&lt;/action&gt;
      &lt;comment&gt;
        Allow the limited group to edit the configuration.
      &lt;/comment&gt;
    &lt;/rule&gt;
  &lt;/rule-list&gt;

&lt;/nacm&gt;

            
          </pre>
<p></p>
<p id="rfc.section.Appendix A.3.p.3">This example shows 3 protocol operation rules: </p>

<dl>
<dt>deny-kill-session:</dt>
<dd style="margin-left: 8">This rule prevents the "limited" or "guest" groups from invoking the NETCONF &lt;kill-session&gt; protocol operation.  </dd>
<dt>deny-delete-config:</dt>
<dd style="margin-left: 8">This rule prevents the "limited" or "guest" groups from invoking the NETCONF &lt;delete-config&gt; protocol operation.  </dd>
<dt>permit-edit-config:</dt>
<dd style="margin-left: 8">This rule allows the "limited" group to invoke the NETCONF &lt;edit-config&gt; protocol operation.  This rule will have no real effect unless the "exec-default" leaf is set to "deny".  </dd>
</dl>

<p> </p>
<h1 id="rfc.appendix.Appendix A.4">
<a href="#rfc.appendix.Appendix%20A.4">Appendix A.4.</a> Data Rule Example</h1>
<p id="rfc.section.Appendix A.4.p.1">Data rules are used to control access to specific (config and non-config) data nodes within the NETCONF content provided by the server.  </p>
<div id="#rfc.figure.13"></div>
<pre>
&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
  &lt;rule-list&gt;
    &lt;name&gt;guest-acl&lt;/name&gt;
    &lt;group&gt;guest&lt;/group&gt;

    &lt;rule&gt;
      &lt;name&gt;deny-nacm&lt;/name&gt;
      &lt;path xmlns:n="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
        /n:nacm
      &lt;/path&gt;
      &lt;access-operations&gt;*&lt;/access-operations&gt;
      &lt;action&gt;deny&lt;/action&gt;
      &lt;comment&gt;
        Deny the guest group any access to the /nacm data.
      &lt;/comment&gt;
    &lt;/rule&gt;
  &lt;/rule-list&gt;

  &lt;rule-list&gt;
    &lt;name&gt;limited-acl&lt;/name&gt;
    &lt;group&gt;limited&lt;/group&gt;

    &lt;rule&gt;
      &lt;name&gt;permit-acme-config&lt;/name&gt;
      &lt;path xmlns:acme="http://example.com/ns/netconf"&gt;
        /acme:acme-netconf/acme:config-parameters
      &lt;/path&gt;
      &lt;access-operations&gt;
        read create update delete
      &lt;/access-operations&gt;
      &lt;action&gt;permit&lt;/action&gt;
      &lt;comment&gt;
        Allow the limited group complete access to the acme
        netconf configuration parameters.  Showing long form
        of 'access-operations' instead of shorthand.
      &lt;/comment&gt;
    &lt;/rule&gt;
  &lt;/rule-list&gt;

  &lt;rule-list&gt;
    &lt;name&gt;guest-limited-acl&lt;/name&gt;
    &lt;group&gt;guest&lt;/group&gt;
    &lt;group&gt;limited&lt;/group&gt;

    &lt;rule&gt;
      &lt;name&gt;permit-dummy-interface&lt;/name&gt;
      &lt;path xmlns:acme="http://example.com/ns/itf"&gt;
        /acme:interfaces/acme:interface[acme:name='dummy']
      &lt;/path&gt;
      &lt;access-operations&gt;read update&lt;/access-operations&gt;
      &lt;action&gt;permit&lt;/action&gt;
      &lt;comment&gt;
        Allow the limited and guest groups read
        and update access to the dummy interface.
      &lt;/comment&gt;
    &lt;/rule&gt;
  &lt;/rule-list&gt;

  &lt;rule-list&gt;
    &lt;name&gt;admin-acl&lt;/name&gt;
    &lt;group&gt;admin&lt;/group&gt;
    &lt;rule&gt;
      &lt;name&gt;permit-interface&lt;/name&gt;
      &lt;path xmlns:acme="http://example.com/ns/itf"&gt;
        /acme:interfaces/acme:interface
      &lt;/path&gt;
      &lt;access-operations&gt;*&lt;/access-operations&gt;
      &lt;action&gt;permit&lt;/action&gt;
      &lt;comment&gt;
        Allow admin full access to all acme interfaces.
      &lt;/comment&gt;
    &lt;/rule&gt;
  &lt;/rule-list&gt;
&lt;/nacm&gt;

            
          </pre>
<p></p>
<p id="rfc.section.Appendix A.4.p.3">This example shows 4 data rules: </p>

<dl>
<dt>deny-nacm:</dt>
<dd style="margin-left: 8">This rule denies the "guest" group any access to the &lt;nacm&gt; subtree.  Note that the default namespace is only applicable because this subtree is defined in the same namespace as the &lt;data-rule&gt; element.  </dd>
<dt>permit-acme-config:</dt>
<dd style="margin-left: 8">This rule gives the "limited" group read-write access to the acme &lt;config-parameters&gt;.  </dd>
<dt>permit-dummy-interface:</dt>
<dd style="margin-left: 8">This rule gives the "limited" and "guest" groups read-update access to the acme &lt;interface&gt; entry named "dummy".  This entry cannot be created or deleted by these groups, just altered.  </dd>
<dt>permit-interface:</dt>
<dd style="margin-left: 8">This rule gives the "admin" group read-write access to all acme &lt;interface&gt; entries.  </dd>
</dl>

<p> </p>
<h1 id="rfc.appendix.Appendix A.5">
<a href="#rfc.appendix.Appendix%20A.5">Appendix A.5.</a> Notification Rule Example</h1>
<p id="rfc.section.Appendix A.5.p.1">Notification rules are used to control access to a specific notification event type.  </p>
<div id="#rfc.figure.14"></div>
<pre>
&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
  &lt;rule-list&gt;
    &lt;name&gt;sys-acl&lt;/name&gt;
    &lt;group&gt;limited&lt;/group&gt;
    &lt;group&gt;guest&lt;/group&gt;
    
    &lt;rule&gt;
      &lt;name&gt;deny-config-change&lt;/name&gt;
      &lt;module-name&gt;acme-system&lt;/module-name&gt;
      &lt;notification-name&gt;sys-config-change&lt;/notification-name&gt;
      &lt;access-operations&gt;read&lt;/access-operations&gt;
      &lt;action&gt;deny&lt;/action&gt;
      &lt;comment&gt;
        Do not allow the guest or limited groups 
        to receive config change events.
      &lt;/comment&gt;
    &lt;/rule&gt;
  &lt;/rule-list&gt;
&lt;/nacm&gt;

            
          </pre>
<p></p>
<p id="rfc.section.Appendix A.5.p.3">This example shows 1 notification rule: </p>

<dl>
<dt>deny-config-change:</dt>
<dd style="margin-left: 8">This rule prevents the "limited" or "guest" groups from receiving the acme &lt;sys-config-change&gt; event type.  </dd>
</dl>

<p> </p>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> Change Log</h1>
<p id="rfc.section.Appendix B.p.1">-- RFC Ed.: remove this section before publication.  </p>
<h1 id="rfc.appendix.Appendix B.1">
<a href="#rfc.appendix.Appendix%20B.1">Appendix B.1.</a> 05-06</h1>
<p id="rfc.section.Appendix B.1.p.1">Added clarification to Security Considerations section about ordered-by user lists (/nacm/rule-list and /nacm/rule-list/rule).  </p>
<p id="rfc.section.Appendix B.1.p.2">Added clarifications to security considerations wrt/ user names and NETCONF capability changes.  </p>
<p id="rfc.section.Appendix B.1.p.3">Fixed typos found in review.  </p>
<h1 id="rfc.appendix.Appendix B.2">
<a href="#rfc.appendix.Appendix%20B.2">Appendix B.2.</a> 04-05</h1>
<p id="rfc.section.Appendix B.2.p.1">Updated Security Considerations section.  </p>
<p id="rfc.section.Appendix B.2.p.2">Changed term 'operator' to 'administrator'.  </p>
<p id="rfc.section.Appendix B.2.p.3">Used the terms "access operation" and "protocol operation" consistently.  </p>
<p id="rfc.section.Appendix B.2.p.4">Moved some normative text from section 2 to section 3.  Also made it more clear that section 2 is not a requirements section, but documentation of the objectives for NACM.  </p>
<p id="rfc.section.Appendix B.2.p.5">Renamed "nacm:secure" to "nacm:default-deny-write", and "nacm:very-secure" to "nacm:default-deny-all".  Explained that "nacm:default-deny-write" is ignored on rpc statements.  </p>
<p id="rfc.section.Appendix B.2.p.6">Described that &lt;kill-session&gt; and &lt;delete-config&gt; behave as if specified with "nacm:default-deny-all".  </p>
<h1 id="rfc.appendix.Appendix B.3">
<a href="#rfc.appendix.Appendix%20B.3">Appendix B.3.</a> 03-04</h1>
<p id="rfc.section.Appendix B.3.p.1">Introduced rule-lists to group related rules together.  </p>
<p id="rfc.section.Appendix B.3.p.2">Moved "module-rule", "rpc-rule", "notification-rule", and "data-rule" into one common "rule", with a choice to select between the four variants.  </p>
<p id="rfc.section.Appendix B.3.p.3">Changed "superuser" to "recovery session", and adjusted text throughout document for this change.  </p>
<p id="rfc.section.Appendix B.3.p.4">Clarified behavior of global default NACM parameters, enable-nacm, read-default, write-default, exec-default.  </p>
<p id="rfc.section.Appendix B.3.p.5">Clarified when access control is applied during system initialization.  </p>
<h1 id="rfc.appendix.Appendix B.4">
<a href="#rfc.appendix.Appendix%20B.4">Appendix B.4.</a> 02-03</h1>
<p id="rfc.section.Appendix B.4.p.1">Fixed improper usage of RFC 2119 keywords.  </p>
<p id="rfc.section.Appendix B.4.p.2">Changed term usage of "database" to "datastore".  </p>
<p id="rfc.section.Appendix B.4.p.3">Clarified that "secure" and "very-secure" extensions only apply if the /nacm/enable-nacm object is "true".  </p>
<h1 id="rfc.appendix.Appendix B.5">
<a href="#rfc.appendix.Appendix%20B.5">Appendix B.5.</a> 01-02</h1>
<p id="rfc.section.Appendix B.5.p.1">Removed authentication text and objects.  </p>
<p id="rfc.section.Appendix B.5.p.2">Changed module name from ietf-nacm to ietf-netconf-acm.  </p>
<p id="rfc.section.Appendix B.5.p.3">Updated NETCONF and YANG terminology.  </p>
<p id="rfc.section.Appendix B.5.p.4">Removed open issues section.  </p>
<p id="rfc.section.Appendix B.5.p.5">Changed some must to MUST in requirements section.  </p>
<h1 id="rfc.appendix.Appendix B.6">
<a href="#rfc.appendix.Appendix%20B.6">Appendix B.6.</a> 00-01</h1>
<p id="rfc.section.Appendix B.6.p.1">Updated YANG anf YANG Types references.  </p>
<p id="rfc.section.Appendix B.6.p.2">Updated module namespace URI to standard format.  </p>
<p id="rfc.section.Appendix B.6.p.3">Updated module header meta-data to standard format.  </p>
<p id="rfc.section.Appendix B.6.p.4">Filled in IANA section.  </p>
<h1 id="rfc.appendix.Appendix B.7">
<a href="#rfc.appendix.Appendix%20B.7">Appendix B.7.</a> 00</h1>
<p id="rfc.section.Appendix B.7.p.1">Initial version cloned from draft-bierman-netconf-access-control-02.txt.  </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Andy Bierman</span> 
	  <span class="n hidden">
		<span class="family-name">Bierman</span>
	  </span>
	</span>
	<span class="org vcardline">Brocade</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:andy.bierman@brocade.com">andy.bierman@brocade.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Martin Bjorklund</span> 
	  <span class="n hidden">
		<span class="family-name">Bjorklund</span>
	  </span>
	</span>
	<span class="org vcardline">Tail-f Systems</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mbj@tail-f.com">mbj@tail-f.com</a></span>

  </address>
</div>

</body>
</html>