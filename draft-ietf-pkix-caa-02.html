<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>DNS Certification Authority Authorization (CAA) Resource Record</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Definitions">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Defined Terms">
<link href="#rfc.section.2" rel="Chapter" title="2 Introduction">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 The CAA RR type">
<link href="#rfc.section.3" rel="Chapter" title="3 Certification Authority Processing">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Canonical Domain Name">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Use of DNS Security">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Archive">
<link href="#rfc.section.4" rel="Chapter" title="4 Mechanism">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Syntax">
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 Canonical Presentation Format">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 CAA issue Property">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Mis-Issue by Authorized Certification Authority">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Suppression or spoofing of CAA records">
<link href="#rfc.section.5.2.1" rel="Chapter" title="5.2.1 Applications">
<link href="#rfc.section.5.2.2" rel="Chapter" title="5.2.2 Certification Authorities">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Denial of Service">
<link href="#rfc.section.5.4" rel="Chapter" title="5.4 Abuse of the Critical Flag">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Registration of the CAA Resource Record Type">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Certification Authority Authorization Properties">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The Certification Authority Authorization (CAA) DNS Resource Record allows a DNS domain name holder to specify the certificate signing certificate(s) authorized to issue certificates for that domain.  CAA resource records allow a public Certification Authority to implement additional controls to reduce the risk of unintended certificate mis-issue.  " />
  <meta name="description" content="The Certification Authority Authorization (CAA) DNS Resource Record allows a DNS domain name holder to specify the certificate signing certificate(s) authorized to issue certificates for that domain.  CAA resource records allow a public Certification Authority to implement additional controls to reduce the risk of unintended certificate mis-issue.  " />
  <meta name="keywords" content="DNS, DNSSEC, PKIX" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">P. M. Hallam-Baker</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Comodo Group Inc.</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">R. N. Stradling</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Comodo CA Ltd.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">B. Laurie</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Google Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Sept 7, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">DNS Certification Authority Authorization (CAA) Resource Record<br />
  <span class="filename">draft-ietf-pkix-caa-02</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The Certification Authority Authorization (CAA) DNS Resource Record allows a DNS domain name holder to specify the certificate signing certificate(s) authorized to issue certificates for that domain.  CAA resource records allow a public Certification Authority to implement additional controls to reduce the risk of unintended certificate mis-issue.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Definitions</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Defined Terms</a>
</li>
<li>2.   <a href="#rfc.section.2">Introduction</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">The CAA RR type</a>
</li>
<li>3.   <a href="#rfc.section.3">Certification Authority Processing</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Canonical Domain Name</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Use of DNS Security</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Archive</a>
</li>
<li>4.   <a href="#rfc.section.4">Mechanism</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Syntax</a>
</li>
<li>4.1.1.   <a href="#rfc.section.4.1.1">Canonical Presentation Format</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">CAA issue Property</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Mis-Issue by Authorized Certification Authority</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Suppression or spoofing of CAA records</a>
</li>
<li>5.2.1.   <a href="#rfc.section.5.2.1">Applications</a>
</li>
<li>5.2.2.   <a href="#rfc.section.5.2.2">Certification Authorities</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Denial of Service</a>
</li>
<li>5.4.   <a href="#rfc.section.5.4">Abuse of the Critical Flag</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Registration of the CAA Resource Record Type</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Certification Authority Authorization Properties</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Definitions</h1>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Defined Terms</h1>
<p id="rfc.section.1.2.p.1">The following terms are used in this document:</p>
<p></p>

<dl>
<dt>Authorization Entry</dt>
<dd style="margin-left: 8">An authorization assertion that grants or denies a specific set of permissions to a specific group of entities.</dd>
<dt>Canonical Domain Name</dt>
<dd style="margin-left: 8">A Domain Name that is not an alias.  </dd>
<dt>Canonical Domain Name Value</dt>
<dd style="margin-left: 8">The value of a Canonical Domain Name. The value resulting from applying alias transformations to a Domain Name that is not canonical.  </dd>
<dt>Certificate</dt>
<dd style="margin-left: 8">An X.509 Certificate, as specified in <a href="#RFC5280">RFC 5280</a> <cite title="NONE">[RFC5280]</cite>.  </dd>
<dt>Certification Policy (CP)</dt>
<dd style="margin-left: 8">Specifies the criteria that a Certification Authority undertakes to meet in its issue of certificates.</dd>
<dt>Certification Practices Statement (CPS)</dt>
<dd style="margin-left: 8">Specifies the means by which the criteria of the Certification Policy are met. In most cases this will be the document against which the operations of the Certification Authority are audited.</dd>
<dt>Certification Authority (CA)</dt>
<dd style="margin-left: 8">An entity that issues Certificates in accordance with a specified Certification Policy.</dd>
<dt>Domain</dt>
<dd style="margin-left: 8">The set of resources associated with a DNS Domain Name.</dd>
<dt>Domain Name</dt>
<dd style="margin-left: 8">A DNS Domain name as specified in <a href="#RFC1035">RFC 1035</a> <cite title="NONE">[RFC1035]</cite> and revisions.  </dd>
<dt>Domain Name System (DNS)</dt>
<dd style="margin-left: 8">The Internet naming system specified in <a href="#RFC1035">RFC 1035</a> <cite title="NONE">[RFC1035]</cite> and revisions.  </dd>
<dt>DNS Security (DNSSEC)</dt>
<dd style="margin-left: 8">Extensions to the DNS that provide authentication services as specified in <a href="#RFC4033">RFC 4033</a> <cite title="NONE">[RFC4033]</cite> and revisions.  </dd>
<dt>Extended Issuer Authorization Set</dt>
<dd style="margin-left: 8">The most specific Issuer Authorization Set that is active for a domain.  This is either the Issuer Authorization Set for the domain itself, or if that is empty, the Issuer Authorization Set for the corresponding Public Delegation Point.  </dd>
<dt>Issuer Authorization Set</dt>
<dd style="margin-left: 8">The set of Authorization Entries for a domain name that are flagged for use by Issuers. Analogous to an Access Control List but with no ordering specified.</dd>
<dt>Public Delegation Point</dt>
<dd style="margin-left: 8">A Domain Name that is obtained from a public DNS registry.  </dd>
<dt>Public Key Infrastructure X.509 (PKIX)</dt>
<dd style="margin-left: 8">Standards and specifications issued by the IETF that apply the <a href="#X.509">X.509</a> <cite title="NONE">[X.509]</cite> certificate standards specified by the ITU to Internet applications as specified in <a href="#RFC5280">RFC 5280</a> <cite title="NONE">[RFC5280]</cite> and related documents.  </dd>
<dt>Resource Record (RR)</dt>
<dd style="margin-left: 8">A set of attributes bound to a Domain Name.</dd>
<dt>Relying Party</dt>
<dd style="margin-left: 8">A party that makes use of an application whose operation depends on use of a Certificate for making a security decision.</dd>
<dt>Relying Application</dt>
<dd style="margin-left: 8">An application whose operation depends on use of a Certificate for making a security decision.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Introduction</h1>
<p id="rfc.section.2.p.1">The Certification Authority Authorization (CAA) DNS Resource Record allows a DNS domain name holder to specify the Certification Authorities authorized to issue certificates for that domain. Publication of CAA resource records allow a public Certification Authority (CA) to implement additional controls to reduce the risk of unintended certificate mis-issue.  </p>
<p id="rfc.section.2.p.2">Conformance with a published CAA record is a necessary but not sufficient condition for issue of a certificate.  Before issuing a certificate, a PKIX CA is required to validate the request according to the policies set out in its Certificate Policy Statement. In the case of a public CA that validates certificate requests as a third party, the certificate will be typically issued under a public root certificate embedded in one or more relevant Relying Applications.  </p>
<p id="rfc.section.2.p.3">Criteria for inclusion of embedded root certificates in applications are outside the scope of this document but typically require the CA to publish a Certificate Practices Statement (CPS) that specifies how the requirements of the Certificate Policy (CP) are achieved and provide an annual audit statement of their performance against their CPS performed by an independent third party auditor.  </p>
<p id="rfc.section.2.p.4">It is the intention of the authors to propose the CAA record defined in this document as the basis for CA validation requirements to be proposed in organizations that publish validation requirements.  </p>
<p id="rfc.section.2.p.5">CAA records only describe the current state of Certification Authority certificate issue authority. Since a certificate is typically valid for at least a year, it is possible that a certificate that is not conformant with the CAA records currently published was conformant with the CAA records published at the time that it was issued. Thus Relying Applications MUST NOT use failure to conform to currently published CAA records specifying issue authorization as a certificate validity criteria.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> The CAA RR type</h1>
<p id="rfc.section.2.1.p.1">A CAA RR publishes a CAA property entry that corresponds to the specified domain name. Multiple property entries MAY be associated with the same domain name by publishing multiple CAA RRs at that domain name. Each property entry MAY be tagged with one or more of the following flag values: </p>
<p></p>

<dl>
<dt>Critical</dt>
<dd style="margin-left: 8">If set, indicates that the corresponding property entry tag MUST be understood if the semantics of the CAA record are to be correctly understood by the specified audience.</dd>
<dt></dt>
<dd style="margin-left: 8">Issuers MUST NOT issue certificates for a domain if the Extended Issuer Authorization Set contains unknown property entry tags that have both the Issuer and Critical bits set.  </dd>
<dt>Issuer</dt>
<dd style="margin-left: 8">Specifies that the corresponding Property Entry is to be used by Issuers and forms part of the Issuer Authorization Set for the domain.  </dd>
</dl>

<p> </p>
<p id="rfc.section.2.1.p.3">The following properties are defined: </p>
<p></p>

<dl>
<dt>issue &lt;Domain Name&gt; [; &lt;tag=value&gt; ]*</dt>
<dd style="margin-left: 8">The policy property entry declares an authorization entry granting authorization to issue under the specified Certificate Policy to the holder of the specified domain.  </dd>
</dl>

<p> </p>
<p id="rfc.section.2.1.p.5">The following example informs CAs that certificates must not be issued except by the holder of the domain name 'ca.example.net' or an authorized agent thereof.  Since the policy is published at the Public Delegation Point, the policy applies to all subordinate domains under example.com.  </p>
<div id="#rfc.figure.1"></div>
<pre>
$ORIGIN example.com
.       CAA 1 issue "ca.example.net"
                    </pre>
<p id="rfc.section.2.1.p.6">A certificate issuer MAY specify additional parameters that allow customers to specify additional parameters governing certificate issue.  For example, the Certification Policy under which the certificate is to be issued or the authentication process to be used.  </p>
<div id="#rfc.figure.2"></div>
<pre>
$ORIGIN example.com
.       CAA 1 issue "ca.example.net; account=230123"
                    </pre>
<p id="rfc.section.2.1.p.7">The syntax and semantics of such parameters is left to site policy and is outside the scope of this document.  </p>
<p id="rfc.section.2.1.p.8">Future versions of this specification MAY use the critical flag to introduce new semantics that MUST be understood for correct processing of the record, preventing Certification Authorities that do not recognize the record from issuing certificates.  </p>
<p id="rfc.section.2.1.p.9">In the following example, the property 'tbs' is flagged as critical. The example.net CA is not authorized to issue under either policy unless the processing rules for the 'tbs' property tag are understood.  </p>
<div id="#rfc.figure.3"></div>
<pre>
$ORIGIN example.com
.       CAA 1 issue "ca.example.net; policy=ev"
.       CAA 129 tbs "Unknown" 
                        </pre>
<p id="rfc.section.2.1.p.10">Note that the above restrictions only apply to issue of certificates.  Since the validity of an end entity certificate is typically a year or more it is quite possible that the CAA records published at a domain will change between the issue of the certificate and verification by a relying party.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Certification Authority Processing</h1>
<p id="rfc.section.3.p.1">Before issue of a certificate, a compliant CA MUST check for publication of a relevant CAA Resource Record(s) and if such record(s) are published, that the certificate requested is consistent with them. If the certificate requested is not consistent with the relevant CAA RRs, the CA MUST NOT issue the certificate.  </p>
<p id="rfc.section.3.p.2">The Issuer Authorization Set for a domain name consists of the set of all CAA Authorization Entries declared for the canonical form of the specified domain.  </p>
<p id="rfc.section.3.p.3">The Extended Issuer Authorization Set for a domain name consists of the Issuer Authorization Set for that domain name if it is non-empty.  Otherwise the Extended Issuer Authorization Set for a domain name consists of the Issuer Authorization Set for the corresponding Public Delegation Point for that domain name.  </p>
<p id="rfc.section.3.p.4">If the Extended Issuer Authorization Set for a domain name is not empty, a Certification Authority MUST NOT issue a certificate unless it conforms to at least one authorization entry in the Extended Issuer Authorization Set.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Canonical Domain Name</h1>
<p id="rfc.section.3.1.p.1">The DNS defines the CNAME and DNAME mechanisms for specifying domain name aliases. The canonical name of a DNS name is the name that results from performing all DNS alias operations.  </p>
<p id="rfc.section.3.1.p.2">A Certification Authority MUST perform CNAME and DNAME processing as defined in the DNS specifications <a href="#RFC1035">1035</a> <cite title="NONE">[RFC1035]</cite> to resolve CAA records.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Use of DNS Security</h1>
<p id="rfc.section.3.2.p.1">Use of DNSSEC to authenticate CAA RRs is strongly recommended but not required. A CA MUST NOT issue certificates if doing so would conflict with the corresponding extended issuer authorization set whether the corresponding DNS records are signed or not.  </p>
<p id="rfc.section.3.2.p.2">Use of DNSSEC allows a CA to acquire and archive a non-repudiable proof that they were authorized to issue certificates for the domain.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Archive</h1>
<p id="rfc.section.3.3.p.1">A compliant CA SHOULD maintain an archive of the DNS transactions used to verify CAA eligibility.  </p>
<p id="rfc.section.3.3.p.2">In particular a CA SHOULD ensure that where DNSSEC data is available that the corresponding signature and NSEC/NSEC3 records are preserved so as to enable later compliance audits.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Mechanism</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Syntax</h1>
<p id="rfc.section.4.1.p.1">A CAA RR contains a single property entry consisting of a tag value pair.  Each tag represents a property of the CAA record. The value of a CAA property is that specified in the corresponding value field.  </p>
<p id="rfc.section.4.1.p.2">A domain name MAY have multiple CAA RRs associated with it and a given property MAY be specified more than once.  </p>
<p id="rfc.section.4.1.p.3">The CAA data field contains one property entry.  A property entry consists of the following data fields: </p>
<div id="#rfc.figure.4"></div>
<pre>
+0-1-2-3-4-5-6-7-|0-1-2-3-4-5-6-7-|
| Flags          | Tag Length = n |
+----------------+----------------+...+---------------+
| Tag char 0     | Tag Char 1     |...| Tag Char n-1  |
+----------------+----------------+...+---------------+
+----------------+----------------+.....+---------------+
| Data byte 0    | Data byte 1    |.....| Data byte m-1 |
+----------------+----------------+.....+---------------+
                    </pre>
<p id="rfc.section.4.1.p.4">Where n is the length specified in the tag length field and m is the remaining octets in the data field (m = d - n - 2) where d is the length of the data section.  </p>
<p id="rfc.section.4.1.p.5">The data fields are defined as follows: </p>
<p></p>

<dl>
<dt>Flags</dt>
<dd style="margin-left: 8">One octet containing the following fields: <dl>
<dt>Bit 0: Critical Flag</dt>
<dd style="margin-left: 8">If the value is set (1), the critical flag is asserted and the property MUST be understood if the CAA record is to be correctly processed.  </dd>
<dt></dt>
<dd style="margin-left: 8">A Certification Authority MUST NOT issue certificates for any Domain that contains a CAA critical property for an unknown or unsupported property type that has the issuer bit set.  </dd>
<dt>Bit 7: Issuer Use</dt>
<dd style="margin-left: 8">If set, the property entry contains an Authorization Entry that forms part of the Issuer Application Authorization Set for the corresponding domain.  </dd>
</dl>
<p> </p>
</dd>
<dt></dt>
<dd style="margin-left: 8">Note that according to the conventions set out in  <a href="#RFC1035">RFC 1035</a> <cite title="NONE">[RFC1035]</cite> Bit 0 is the Most Significant Bit and Bit 7 is the Least Significant.  Thus the flags value 1 means that bit 7 is set while a value of 128 means that bit 0 is set according to this convention.  </dd>
<dt>Tag Length</dt>
<dd style="margin-left: 8">A single octet containing an unsigned integer specifying the tag length in octets. The tag length MUST be at least 1 and SHOULD be no more than 15.  </dd>
<dt>Tag</dt>
<dd style="margin-left: 8">The property identifier, a sequence of ASCII characters.</dd>
<dt></dt>
<dd style="margin-left: 8">Tag values MAY contain ASCII characters a through z and the numbers 0 through 9. Tag values MUST NOT contain any other characters. Matching of tag values is case insensitive.  </dd>
<dt>Value</dt>
<dd style="margin-left: 8">A sequence of octets representing the property value. Property values are encoded as binary values and MAY employ sub-formats.</dd>
<dt></dt>
<dd style="margin-left: 8">The length of the value field is specified implicitly as the remaining length of the enclosing Resource Record data field.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.1.1">
<a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#zoneformat" id="zoneformat">Canonical Presentation Format</a>
</h1>
<p id="rfc.section.4.1.1.p.1">The canonical presentation format of the CAA record is as follows: </p>
<p id="rfc.section.4.1.1.p.2">CAA &lt;flags&gt; &lt;tag&gt; &lt;data&gt; </p>
<p id="rfc.section.4.1.1.p.3">Where: </p>
<p></p>

<dl>
<dt>flags</dt>
<dd style="margin-left: 8">Is an unsigned integer between 0 and 15.</dd>
<dt>tag</dt>
<dd style="margin-left: 8">Is a non-zero sequence of ASCII letter and numbers in lower case.  </dd>
<dt>data</dt>
<dd style="margin-left: 8">Is the ascii text Encoding of the value field </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> CAA issue Property</h1>
<p id="rfc.section.4.2.p.1">[TBS] </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Security Considerations</h1>
<p id="rfc.section.5.p.1">CAA Records provide an accountability control. They are intended to deter rather than prevent undesired behavior.  </p>
<p id="rfc.section.5.p.2">While a Certification Authority can choose to ignore published CAA records, doing so increases the both the probability that they will mis-issue a certificate and the consequences of doing so. Once it is known that a CA observes CAA records, malicious registration requests will  disproportionately target the negligent CAs that do not, and so the mis-issue rate amongst the negligent CAs will increase.  Since the CA could clearly have avoided the mis-issue by performing CAA processing, the likelihood of sanctions against the negligent CA is increased. Failure to observe CAA issue restrictions provides an objective criteria for excluding issuers from embedded roots of trust.  </p>
<p id="rfc.section.5.p.3">In contrast, a Certification Authority that processes CAA records correctly can reasonably claim that any residual mis-issue event could have been avoided had the Domain Name holder published appropriate CAA records.  </p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Mis-Issue by Authorized Certification Authority</h1>
<p id="rfc.section.5.1.p.1">Use of CAA records does not provide protection against mis-issue by an authorized Certification Authority.  </p>
<p id="rfc.section.5.1.p.2">Domain name holders SHOULD ensure that the CAs they authorize to issue certificates for their domains employ appropriate controls to ensure that certificates are only issued to authorized parties within their organization.  </p>
<p id="rfc.section.5.1.p.3">Such controls are most appropriately determined by the domain name holder and the authorized CA(s) directly and are thus out of scope of this document.  </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Suppression or spoofing of CAA records</h1>
<p id="rfc.section.5.2.p.1">Suppression of the CAA record or insertion of a bogus CAA record could enable an attacker to obtain a certificate from a CA that was not authorized to issue for that domain name.  </p>
<h1 id="rfc.section.5.2.1">
<a href="#rfc.section.5.2.1">5.2.1.</a> Applications</h1>
<p id="rfc.section.5.2.1.p.1">Applications performing CAA checking SHOULD mitigate the risk of suppresion or spoofing of CAA records by means of DNSSEC validation where present. In cases where DNSSEC validation is not available, CAA checking is of limited security value.  </p>
<h1 id="rfc.section.5.2.2">
<a href="#rfc.section.5.2.2">5.2.2.</a> Certification Authorities</h1>
<p id="rfc.section.5.2.2.p.1">Since a certificate issued by a CA can be valid for several years, the consequences of a spoofing or suppression attack are much greater for Certification Authorities and so additional countermeasures are justified.  </p>
<p id="rfc.section.5.2.2.p.2">A CA MUST mitigate this risk by employing DNSSEC verification whenever possible and rejecting certificate requests in any case where it is not possible to verify the non-existence or contents of a relevant CAA record.  </p>
<p id="rfc.section.5.2.2.p.3">In cases where DNSSEC is not deployed in a corresponding domain, a CA SHOULD attempt to mitigate this risk by employing appropriate DNS security controls. For example all portions of the DNS lookup process SHOULD be performed against the authoritative name server.  Cached data MUST NOT be relied on but MAY be used to support additional anti-spoofing or anti-suppression controls.  </p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> Denial of Service</h1>
<p id="rfc.section.5.3.p.1">Introduction of a malformed or malicious CAA RR could in theory enable a Denial of Service attack.  </p>
<p id="rfc.section.5.3.p.2">This specific threat is not considered to add significantly to the risk of running an insecure DNS service.  </p>
<h1 id="rfc.section.5.4">
<a href="#rfc.section.5.4">5.4.</a> Abuse of the Critical Flag</h1>
<p id="rfc.section.5.4.p.1">A Certification Authority could make use of the critical flag to trick customers into publishing records which prevent competing Certification Authorities from issuing certificates even though the customer intends to authorize multiple providers.  </p>
<p id="rfc.section.5.4.p.2">In practice, such an attack would be of minimal effect since any competent competitor that found itself unable to issue certificates due to lack of support for a property marked critical is going to investigate the cause and report the reason to the customer who was deceived. It is thus unlikely that the attack would succeed and the attempt might lay the perpetrator open to civil or criminal sanctions.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> IANA Considerations</h1>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Registration of the CAA Resource Record Type</h1>
<p id="rfc.section.6.1.p.1">IANA has assigned Resource Record Type 257 for the CAA Resource Record Type and added the line depicted below to the registry named Resource Record (RR) TYPEs and QTYPEs as defined in BCP 42 RFC 5395 [RFC5395] and located at http://www.iana.org/assignments/dns-parameters.  </p>
<div id="#rfc.figure.5"></div>
<pre>
             Value and meaning                                Reference
-----------  ---------------------------------------------    ---------
CAA          257 Certification Authority Restriction          [RFC-THIS]
</pre>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Certification Authority Authorization Properties</h1>
<p id="rfc.section.6.2.p.1">IANA has created the Certification Authority Authorization Properties registry with the following initial values: </p>
<div id="#rfc.figure.6"></div>
<pre>

             Meaning                                          Reference
-----------  -----------------------------------------------  ---------
issue        Authorization Entry by Domain                    [RFC-THIS]
auth         Reserved
path         Reserved
policy       Reserved
                    </pre>
<p id="rfc.section.6.2.p.2">Addition of tag identifiers requires a public specification and expert review as set out in <a href="#RFC5395">RFC5395</a> <cite title="NONE">[RFC5395]</cite> </p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a title="USC/ISI">Mockapetris, P.</a>, "<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4033">[RFC4033]</b></td>
<td class="top">
<a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>", RFC 4033, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4055">[RFC4055]</b></td>
<td class="top">
<a>Schaad, J.</a>, <a>Kaliski, B.</a> and <a>R. Housley</a>, "<a href="http://tools.ietf.org/html/rfc4055">Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 4055, June 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5395">[RFC5395]</b></td>
<td class="top">
<a>Eastlake, D.</a>, "<a href="http://tools.ietf.org/html/rfc5395">Domain Name System (DNS) IANA Considerations</a>", RFC 5395, November 2008.</td>
</tr>
<tr>
<td class="reference"><b id="X.509">[X.509]</b></td>
<td class="top">
<a>International Telecommunication Union </a>, "<a>ITU-T Recommendation X.509 (11/2008): Information technology - Open systems interconnection - The Directory: Public-key and attribute certificate frameworks </a>", ITU-T Recommendation X.509, November 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Phillip Hallam-Baker</span> 
	  <span class="n hidden">
		<span class="family-name">Hallam-Baker</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo Group Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:philliph@comodo.com">philliph@comodo.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Rob Stradling</span> 
	  <span class="n hidden">
		<span class="family-name">Stradling</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo CA Ltd.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:rob.stradling@comodo.com">rob.stradling@comodo.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ben Laurie</span> 
	  <span class="n hidden">
		<span class="family-name">Laurie</span>
	  </span>
	</span>
	<span class="org vcardline">Google Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:benl@google.com">benl@google.com</a></span>

  </address>
</div>

</body>
</html>