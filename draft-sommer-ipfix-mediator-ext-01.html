<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Mediator-Specific Extensions to IPFIX Protocol and Information Model</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Mediator-Specific Extensions to IPFIX Protocol and Information Model">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">C. Sommer</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">F. Dressler</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Univ. Erlangen</td></tr>
<tr><td class="header">Expires: January 15, 2009</td><td class="header">G. Muenz</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Univ. Tuebingen</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 14, 2008</td></tr>
</table></td></tr></table>
<h1><br />Mediator-Specific Extensions to IPFIX Protocol and Information Model<br />&lt;draft-sommer-ipfix-mediator-ext-01.txt&gt;</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 15, 2009.</p>

<h3>Abstract</h3>

<p>
				IPFIX supports the concept of a Mediator, a device that receives, transforms, and exports data streams using IPFIX. One of the most important requirements is the reduction of the volume of IPFIX traffic by aggregating and discarding received information.
				This document introduces a number of extensions to the IPFIX Information Model that support the export of aggregated IPFIX data, introducing abstract data types and Information Elements that optimize the transport of descriptive information in terms of flow records' amount and size. All extensions are directly applicable to the IPFIX Mediator but can be used in many different applications as well.
			
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#ipfix-extension-ol">2.</a>&nbsp;
Abstract data type orderedList<br />
<a href="#ipfix-extension-op">3.</a>&nbsp;
Abstract data type orderedPair<br />
<a href="#ipfix-extension-pr">4.</a>&nbsp;
Abstract data type portRanges<br />
<a href="#ipfix-extension-ip4n">5.</a>&nbsp;
Abstract data type ipv4Network<br />
<a href="#excludedpropertiesid">6.</a>&nbsp;
excludedPropertiesId Information Element<br />
<a href="#anchor2">7.</a>&nbsp;
Security considerations<br />
<a href="#anchor3">8.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">9.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
				The IPFIX Mediator is intended to provide techniques and features to process IPFIX data in a Mediation Process. This process receives data streams using IPFIX. It can apply transformations or aggregation techniques and forward the resulting Flow information to an Exporting Process and, thus, to another IPFIX collector.
				Flow aggregation is one of the key operations in high-bandwidth networks. The main idea is to reduce both the number and the size of IPFIX messages.
			
</p>
<p>
				This document introduces extensions to the IPFIX Information Model that support the export of aggregated IPFIX data. These extensions allow and optimize the transport of descriptive information on aggregated IPFIX data. Thus, more information can be preserved in the transmission while further reducing both the number and the size of IPFIX messages.
				All the proposed extensions are directly applicable to the IPFIX Mediator but can be used in many different applications as well.
			
</p>
<p>
				The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
				Illustrations of abstract data types are written in Augmented Backus-Naur Form (ABNF), as specified in <a class='info' href='#RFC4234'>[RFC4234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; October&nbsp;2005.</span><span>)</span></a>, extending the abstract data types defined in <a class='info' href='#RFC5102'>[RFC5102]<span> (</span><span class='info'>Quittek, J., Bryant, S., Claise, B., Aitken, P., and J. Meyer, &ldquo;Information Model for IP Flow Information Export,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
				Apart from the basic terms as defined in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a>, this document uses terminology first introduced in <a class='info' href='#I-D.dressler-ipfix-aggregation'>[I&#8209;D.dressler&#8209;ipfix&#8209;aggregation]<span> (</span><span class='info'>Dressler, F., Sommer, C., Muenz, G., and A. Kobayashi, &ldquo;IPFIX Flow Aggregation,&rdquo; July&nbsp;2008.</span><span>)</span></a>.
			
</p>
<a name="ipfix-extension-ol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Abstract data type orderedList</h3>

<p>
				IPFIX allows the transport of an ordered list of values by including in a Template several Information Elements of the same type more than once. This approach requires one Template for each possible length of the list. In the context of flow mediation, however, the number of entries in such lists typically changes with each exported compound flow, leading to a dramatic increase of Templates and associated housekeeping overhead.
				Therefore, a new abstract data type, orderedList, is defined in this section. 
				
<p style='text-align: left'>
						The abstract data type orderedList defines an ordered list of Information Elements, each being of the same type (referred to as elementType) and the same, pre-defined length. An orderedList can transport any finite number of Information Elements. The length of an orderedList thus varies and is an integer multiple of the contained Information Elements' length. If more than one contained Information Element is transmitted in the form of an orderedList, reduced size encoding of elementType MUST NOT be used. If only one contained Information Element is transmitted, reduced size encoding of elementType MAY be used. 
						In ABNF-style notation, the syntax can be summed up as follows:
					
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
<dfn>orderedList</dfn>     =  <span class='rep'>*</span>( <cite class='id'>elementType</cite> )
</pre></div>
<p style='text-align: left'>
						The number of Information Elements contained in an orderedList can be determined by dividing the length of the orderedList by the length of elementType. 
						An Information Element basing on orderedList MAY also be used as a variable-length Information Element by prefixing it with a one-octet or three-octet length specifier as defined in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
					
</p>
			

<p>
				<a class='info' href='#ipfix-extension-ol-ex'>Table&nbsp;1<span> (</span><span class='info'>orderedList Examples</span><span>)</span></a> shows some encoding examples if unsigned16 is used as the elementType.
			
</p><br /><hr class="insert" />
<a name="ipfix-extension-ol-ex"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Human-Readable</th><th align="left">Octets</th><th align="left">Hexadecimal</th><th align="left">Remarks</th></tr>
<tr>
<td align="left">80</td>
<td align="left">1</td>
<td align="left">50</td>
<td align="left">Reduced size encoding</td>
</tr>
<tr>
<td align="left">80</td>
<td align="left">2</td>
<td align="left">0050</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">80, 443</td>
<td align="left">4</td>
<td align="left">0050 01BB</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">80, 443, 8080</td>
<td align="left">6</td>
<td align="left">0050 01BB 1F90</td>
<td align="left">&nbsp;</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: orderedList Examples&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="ipfix-extension-op"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Abstract data type orderedPair</h3>

<p>
				
<p style='text-align: left'>
						The abstract data type orderedPair defines a 2-tuple of Information Elements, each being of the same type (referred to as elementType) and the same, pre-defined length. The length of an orderedPair is thus defined as twice the length of its elementType. If more than one contained Information Element is transmitted in the form of an orderedPair, reduced size encoding of elementType MUST NOT be used. If only one contained Information Element is transmitted, reduced size encoding of orderedPair MAY be used if both contained Information Elements are of the same value. The reduced size representation of the orderedPair is in this case identical with the (full or reduced size representation) of elementType.
						In ABNF-style notation, the syntax can be summed up as follows:
					
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
<dfn>orderedPair</dfn>     =  <cite class='id'>elementType</cite> <cite class='id'>elementType</cite>
<dfn>orderedPair</dfn>     =/ <cite class='id'>elementType</cite>
</pre></div>
<p style='text-align: left'>
					
</p>
			

<p>
				<a class='info' href='#ipfix-extension-op-ex'>Table&nbsp;2<span> (</span><span class='info'>orderedPair Examples</span><span>)</span></a> shows some encoding examples if unsigned16 is used as the elementType.
			
</p><br /><hr class="insert" />
<a name="ipfix-extension-op-ex"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Human-Readable</th><th align="left">Octets</th><th align="left">Hexadecimal</th><th align="left">Remarks</th></tr>
<tr>
<td align="left">80, 80</td>
<td align="left">1</td>
<td align="left">50</td>
<td align="left">Reduced size encoding</td>
</tr>
<tr>
<td align="left">80, 80</td>
<td align="left">2</td>
<td align="left">0050</td>
<td align="left">Reduced size encoding</td>
</tr>
<tr>
<td align="left">80, 80</td>
<td align="left">4</td>
<td align="left">0050 0050</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">80, 443</td>
<td align="left">4</td>
<td align="left">0050 01BB</td>
<td align="left">&nbsp;</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: orderedPair Examples&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="ipfix-extension-pr"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Abstract data type portRanges</h3>

<p>
				For some applications it might be useful to restrict the applicability of an Aggregation Rule to Flows with source or destination port being of a specific set of port numbers. 
				In an Aggregation Rule, such a set of port numbers can be specified as a pattern.
				However, the current IPFIX Information Model does not define any data type that allows transmitting a set of port numbers, which is necessary in order to export the pattern as a Common Property of the resulting Compound Flows.
				Therefore, the new abstract data type portRanges for a list of port ranges is defined in this section.
			
</p>
<p>
				The abstract data type portRanges is an orderedList of orderedPair Information Elements, each pair consisting of two unsigned16 Information Elements representing the port range's first and last port number.
			
</p>
<p>
				Data types basing on portRanges MAY thus be cast down to unsigned16 using reduced size encoding to represent a single Port and, hence, the transportSourcePort and transportDestinationPort data types, currently based on the unsigned16 abstract data type, can also be parsed as portRanges-based data types.
				As specified for data types basing on orderedList, an Information Element basing on portRanges MAY also be used as a variable-length Information Elements by prefixing it with a one-octet or three-octet length specifier as defined in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
			
</p>
<p>
				<a class='info' href='#ipfix-extension-pr-ex'>Table&nbsp;3<span> (</span><span class='info'>PortRanges Examples</span><span>)</span></a> shows some encoding examples with portRanges.
			
</p><br /><hr class="insert" />
<a name="ipfix-extension-pr-ex"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Port Ranges</th><th align="left">Octets</th><th align="left">Hexadecimal Representation</th></tr>
<tr>
<td align="left">80</td>
<td align="left">2</td>
<td align="left">0050</td>
</tr>
<tr>
<td align="left">1:7</td>
<td align="left">4</td>
<td align="left">0001 0007</td>
</tr>
<tr>
<td align="left">80,  443 </td>
<td align="left">8</td>
<td align="left">0050 0050  01BB 01BB</td>
</tr>
<tr>
<td align="left">1:7, 256:1024</td>
<td align="left">8</td>
<td align="left">0001 0007  0100 0400</td>
</tr>
<tr>
<td align="left">20,  80, 443</td>
<td align="left">12</td>
<td align="left">0014 0014  0050 0050  01BB 01BB</td>
</tr>
<tr>
<td align="left">1:7, 80, 443</td>
<td align="left">12</td>
<td align="left">0001 0007  0050 0050  01BB 01BB</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: PortRanges Examples&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
				
			
</p>
<a name="ipfix-extension-ip4n"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Abstract data type ipv4Network</h3>

<p>
				Currently, the transport of IP network information as specified by IPFIX is done using two separate fields for the network address and the corresponding mask. 
				We propose a new abstract data type ipv4Network that represents the common notation of IP networks: address/mask. 
				
<p style='text-align: left'>
						The ipv4Network abstract data type extends the abstract data type ipv4Address to allow a concatenated unsigned8 specifying the prefix length.
						Alternatively, Information Elements based on the ipv4Network abstract data type MAY be transmitted using reduced size encoding to transmit only the network part of an IPv4 address.
						In ABNF-style notation, the syntax can be summed up as follows:
					
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
<dfn>ipv4Network</dfn>    =  <cite class='id'>ipv4Address</cite> <cite class='id'>unsigned8</cite>
<dfn>ipv4Network</dfn>    =/ <span class='rep'>*4</span>( <cite class='id'>unsigned8</cite> )
</pre></div>
<p style='text-align: left'>
					
</p>
			

<p>
				Although using an ipv4Network field instead of two separate fields for prefix and mask will not reduce the length of resulting Flow Records, it eases the work of the aggregator:
				With ipv4Network, the comparison of subnet addresses requires only one field lookup per Flow Record instead of two.
				Furthermore, using the abstract data type ipv4Network reduces the Template size by one field equaling four octets.
				Applications such as IPFIX Aggregation benefit from ipv4Network if network addresses are frequently exported.
			
</p>
<a name="excludedpropertiesid"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
excludedPropertiesId Information Element</h3>

<p>
				The IPFIX Information Model <a class='info' href='#RFC5102'>[RFC5102]<span> (</span><span class='info'>Quittek, J., Bryant, S., Claise, B., Aitken, P., and J. Meyer, &ldquo;Information Model for IP Flow Information Export,&rdquo; January&nbsp;2008.</span><span>)</span></a> defines the commonPropertiesId Information Element, which can be used to link to information which several Flows have in common.
			
</p>
<p>
				Similarly, the excludedPropertiesId shall be defined to link to a set of Common Properties which a Flow does explicitly not exhibit. An Element Id of 239 is proposed for this Information Element.
			
</p>
<p>
				The excludedPropertiesId works like a Boolean "and not" operation on the linked properties. This means that, if an excludedPropertiesId refers to a set of Common Properties which in turn specifies excluded properties, these transitively referenced properties are to be treated as if directly referenced via a commonPropertiesId element and, hence, as being present in the Flow in question.
			
</p>
<p>
				Multiple excludedPropertiesId and commonPropertiesId specified for an IPFIX Record must never contradict each other. If an IPFIX Collector is able to detect that contradicting IEs were received, it SHOULD proceed as if it received bad or nonsensical data.
			
</p>
<p>
				The excludedPropertiesId can, for example, be used when a hierarchy of Aggregation Rules with a "preceding rule" semantic, as introduced in <a class='info' href='#I-D.dressler-ipfix-aggregation'>[I&#8209;D.dressler&#8209;ipfix&#8209;aggregation]<span> (</span><span class='info'>Dressler, F., Sommer, C., Muenz, G., and A. Kobayashi, &ldquo;IPFIX Flow Aggregation,&rdquo; July&nbsp;2008.</span><span>)</span></a>, is configured in an IPFIX Aggregator. 
			
</p>
<p>	
				<a class='info' href='#cp2'>Figure&nbsp;1<span> (</span><span class='info'>Using excludedPropertiesId to communicate a rule hierarchy</span><span>)</span></a> illustrates the use of Common Property definitions and the linking to these definitions with Information Elements of types commonPropertiesId (CP) and excludedPropertiesId (EP). In this example, two rules are defined in the aggregator: Rule 1 matches Flows with a sourceIPv4Address of 192.0.2.1, Rule 2 matches Flows with a destinationIPv4Address of 192.0.2.2. Furthermore, Rule 1 is configured to precede Rule 2 in a hierarchy of rules, i.e. Flows that matched Rule 1 will never match Rule 2. 
			
</p>
<p>	
				In order to communicate this fact to a receiver, each Aggregation Rule is transmitted as two sets of Common Properties. One set of properties (shown on the right hand side of <a class='info' href='#cp2'>Figure&nbsp;1<span> (</span><span class='info'>Using excludedPropertiesId to communicate a rule hierarchy</span><span>)</span></a>) directly transmits a rule's filtering criteria. The other set of properties (shown on the left hand side) refers via a commonPropertiesId to all properties that a Compound Flow exhibits, as well as via an excludedPropertiesId to all that the Compound Flow does not exhibit.
			
</p>
<p>
				The Flow depicted at the bottom of <a class='info' href='#cp2'>Figure&nbsp;1<span> (</span><span class='info'>Using excludedPropertiesId to communicate a rule hierarchy</span><span>)</span></a> thus communicates a source port of 80, a destination port of 65432, a destination IP of 192.0.2.2 and a source IP of "not 192.0.2.1". However, besides the transmission of this Flow in one Data Record, previous transmissions (and the successful reception) of four Option Templates, four Option Data Records and one Template are required to communicate this information.
			
</p>
<p>
				<br /><hr class="insert" />
<a name="cp2"></a>
</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
Rule 1:
+########+------+             +######+---------------+
# CP=101 # CP=1 |&lt;-----------&gt;# CP=1 # SRC=192.0.2.1 |
+########+------+             +######+---------------+
                                 ^
            .--------------------'
Rule 2:     v
+########+------+------+      +######+---------------+
# CP=102 # EP=1 | CP=2 |&lt;----&gt;# CP=2 # DST=192.0.2.2 |
+########+------+------+      +######+---------------+
     ^
     '-------------------.
Flow:                    v
+--------+-----------+--------+
| SPT=80 | DPT=65432 | CP=102 |
+--------+-----------+--------+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Using excludedPropertiesId to communicate a rule hierarchy&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
				
			
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security considerations</h3>

<p>
				As all methods described in this document are merely variations on methods already introduced in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a>, the same rules regarding exchange of Flow information apply.
			
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>
				Use of excludedPropertiesId, as well as use of a data type basing on ipv4Network or on portRanges requires one new IPFIX Information Element identifier each to be assigned.
				
			
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.dressler-ipfix-aggregation">[I-D.dressler-ipfix-aggregation]</a></td>
<td class="author-text">Dressler, F., Sommer, C., Muenz, G., and A. Kobayashi, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-dressler-ipfix-aggregation-05.txt">IPFIX Flow Aggregation</a>,&rdquo; draft-dressler-ipfix-aggregation-05 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-dressler-ipfix-aggregation-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4234">[RFC4234]</a></td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">Crocker, D., Ed.</a> and <a href="mailto:paul.overell@thus.net">P. Overell</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; RFC&nbsp;4234, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4234.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4234.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4234.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5101">[RFC5101]</a></td>
<td class="author-text">Claise, B., &ldquo;<a href="http://tools.ietf.org/html/rfc5101">Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information</a>,&rdquo; RFC&nbsp;5101, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5101.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5102">[RFC5102]</a></td>
<td class="author-text">Quittek, J., Bryant, S., Claise, B., Aitken, P., and J. Meyer, &ldquo;<a href="http://tools.ietf.org/html/rfc5102">Information Model for IP Flow Information Export</a>,&rdquo; RFC&nbsp;5102, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5102.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Christoph Sommer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Erlangen-Nuremberg</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Computer Science 7</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Martensstr. 3</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Erlangen  91058</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 9131 85-27993</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:christoph.sommer@informatik.uni-erlangen.de">christoph.sommer@informatik.uni-erlangen.de</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www7.informatik.uni-erlangen.de/~sommer/">http://www7.informatik.uni-erlangen.de/~sommer/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Falko Dressler</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Erlangen-Nuremberg</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Computer Science 7</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Martensstr. 3</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Erlangen  91058</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 9131 85-27914</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dressler@informatik.uni-erlangen.de">dressler@informatik.uni-erlangen.de</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www7.informatik.uni-erlangen.de/">http://www7.informatik.uni-erlangen.de/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gerhard Muenz</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Tuebingen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Computer Networks and Internet</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sand 13</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tuebingen  72076</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 7071 29-70534</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:muenz@informatik.uni-tuebingen.de">muenz@informatik.uni-tuebingen.de</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://net.informatik.uni-tuebingen.de/">http://net.informatik.uni-tuebingen.de/</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
