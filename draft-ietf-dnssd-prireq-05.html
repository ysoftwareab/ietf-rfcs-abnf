<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>DNS-SD Privacy and Security Requirements </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Threat Model">
<link href="#rfc.section.3" rel="Chapter" title="3 Threat Analysis">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Service Discovery Scenarios">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Private Client and Public Server">
<link href="#rfc.section.3.1.2" rel="Chapter" title="3.1.2 Private Client and Private Server">
<link href="#rfc.section.3.1.3" rel="Chapter" title="3.1.3 Wearable Client and Server">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 DNS-SD Privacy Considerations">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Information made available via DNS-SD Resource Records">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Privacy Implication of Publishing Service Instance Names">
<link href="#rfc.section.3.2.3" rel="Chapter" title="3.2.3 Privacy Implication of Publishing Node Names">
<link href="#rfc.section.3.2.4" rel="Chapter" title="3.2.4 Privacy Implication of Publishing Service Attributes">
<link href="#rfc.section.3.2.5" rel="Chapter" title="3.2.5 Device Fingerprinting">
<link href="#rfc.section.3.2.6" rel="Chapter" title="3.2.6 Privacy Implication of Discovering Services">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Security Considerations">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 Authenticity, Integrity &amp; Freshness">
<link href="#rfc.section.3.3.2" rel="Chapter" title="3.3.2 Confidentiality">
<link href="#rfc.section.3.3.3" rel="Chapter" title="3.3.3 Resistance to Dictionary Attacks">
<link href="#rfc.section.3.3.4" rel="Chapter" title="3.3.4 Resistance to Denial-of-Service Attacks">
<link href="#rfc.section.3.3.5" rel="Chapter" title="3.3.5 Resistance to Sender Impersonation">
<link href="#rfc.section.3.3.6" rel="Chapter" title="3.3.6 Sender Deniability">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Operational Considerations">
<link href="#rfc.section.3.4.1" rel="Chapter" title="3.4.1 Power Management">
<link href="#rfc.section.3.4.2" rel="Chapter" title="3.4.2 Protocol Efficiency">
<link href="#rfc.section.3.4.3" rel="Chapter" title="3.4.3 Secure Initialization and Trust Models">
<link href="#rfc.section.3.4.4" rel="Chapter" title="3.4.4 External Dependencies">
<link href="#rfc.section.4" rel="Chapter" title="4 Requirements for a DNS-SD Privacy Extension">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Private Client Requirements">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Private Server Requirements">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Security and Operation">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="7 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.40.0 - https://tools.ietf.org/tools/xml2rfc" />
<meta name="viewport" content="width=600;" />
<meta name="viewport" content="width=600;" />
<meta name="viewport" content="width=600;" />
<meta name="viewport" content="width=600;" />
<meta name="viewport" content="width=600;" />
<meta name="viewport" content="width=600;" />
<meta name="viewport" content="width=600;" />
<meta name="viewport" content="width=600;" />
<meta name="viewport" content="width=600;" />
<meta name="viewport" content="width=600;" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Huitema, C. and D. Kaiser" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-dnssd-prireq-05" />
  <meta name="dct.issued" scheme="ISO8601" content="2020-21" />
  <meta name="dct.abstract" content="DNS-SD (DNS Service Discovery) normally discloses information about devices offering and requesting services. This information includes host names, network parameters, and possibly a further description of the corresponding service instance. Especially when mobile devices engage in DNS Service Discovery at a public hotspot, serious privacy problems arise. We analyze the requirements of a privacy-respecting discovery service.   " />
  <meta name="description" content="DNS-SD (DNS Service Discovery) normally discloses information about devices offering and requesting services. This information includes host names, network parameters, and possibly a further description of the corresponding service instance. Especially when mobile devices engage in DNS Service Discovery at a public hotspot, serious privacy problems arise. We analyze the requirements of a privacy-respecting discovery service.   " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">C. Huitema</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Private Octopus Inc.</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">D. Kaiser</td>
</tr>
<tr>
<td class="left">Expires: August 24, 2020</td>
<td class="right">University of Luxembourg</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">February 21, 2020</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">DNS-SD Privacy and Security Requirements <br />
  <span class="filename">draft-ietf-dnssd-prireq-05</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>DNS-SD (DNS Service Discovery) normally discloses information about devices offering and requesting services. This information includes host names, network parameters, and possibly a further description of the corresponding service instance. Especially when mobile devices engage in DNS Service Discovery at a public hotspot, serious privacy problems arise. We analyze the requirements of a privacy-respecting discovery service.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on August 24, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2020 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Threat Model</a>
</li>
<li>3.   <a href="#rfc.section.3">Threat Analysis</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Service Discovery Scenarios</a>
</li>
<ul><li>3.1.1.   <a href="#rfc.section.3.1.1">Private Client and Public Server</a>
</li>
<li>3.1.2.   <a href="#rfc.section.3.1.2">Private Client and Private Server</a>
</li>
<li>3.1.3.   <a href="#rfc.section.3.1.3">Wearable Client and Server</a>
</li>
</ul><li>3.2.   <a href="#rfc.section.3.2">DNS-SD Privacy Considerations</a>
</li>
<ul><li>3.2.1.   <a href="#rfc.section.3.2.1">Information made available via DNS-SD Resource Records</a>
</li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">Privacy Implication of Publishing Service Instance Names</a>
</li>
<li>3.2.3.   <a href="#rfc.section.3.2.3">Privacy Implication of Publishing Node Names</a>
</li>
<li>3.2.4.   <a href="#rfc.section.3.2.4">Privacy Implication of Publishing Service Attributes</a>
</li>
<li>3.2.5.   <a href="#rfc.section.3.2.5">Device Fingerprinting</a>
</li>
<li>3.2.6.   <a href="#rfc.section.3.2.6">Privacy Implication of Discovering Services</a>
</li>
</ul><li>3.3.   <a href="#rfc.section.3.3">Security Considerations</a>
</li>
<ul><li>3.3.1.   <a href="#rfc.section.3.3.1">Authenticity, Integrity &amp; Freshness</a>
</li>
<li>3.3.2.   <a href="#rfc.section.3.3.2">Confidentiality</a>
</li>
<li>3.3.3.   <a href="#rfc.section.3.3.3">Resistance to Dictionary Attacks</a>
</li>
<li>3.3.4.   <a href="#rfc.section.3.3.4">Resistance to Denial-of-Service Attacks</a>
</li>
<li>3.3.5.   <a href="#rfc.section.3.3.5">Resistance to Sender Impersonation</a>
</li>
<li>3.3.6.   <a href="#rfc.section.3.3.6">Sender Deniability</a>
</li>
</ul><li>3.4.   <a href="#rfc.section.3.4">Operational Considerations</a>
</li>
<ul><li>3.4.1.   <a href="#rfc.section.3.4.1">Power Management</a>
</li>
<li>3.4.2.   <a href="#rfc.section.3.4.2">Protocol Efficiency</a>
</li>
<li>3.4.3.   <a href="#rfc.section.3.4.3">Secure Initialization and Trust Models</a>
</li>
<li>3.4.4.   <a href="#rfc.section.3.4.4">External Dependencies</a>
</li>
</ul></ul><li>4.   <a href="#rfc.section.4">Requirements for a DNS-SD Privacy Extension</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Private Client Requirements</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Private Server Requirements</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Security and Operation</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Acknowledgments</a>
</li>
<li>7.   <a href="#rfc.references">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">DNS Service Discovery (DNS-SD) <a href="#RFC6763" class="xref">[RFC6763]</a> over Multicast DNS (mDNS) <a href="#RFC6762" class="xref">[RFC6762]</a> enables zero-configuration service discovery in local networks. It is very convenient for users, but it requires the public exposure of the offering and requesting identities along with information about the offered and requested services. Parts of the published information can seriously breach the user's privacy. These privacy issues and potential solutions are discussed in <a href="#KW14a" class="xref">[KW14a]</a>, <a href="#KW14b" class="xref">[KW14b]</a> and <a href="#K17" class="xref">[K17]</a>.  While the multicast nature of mDNS makes these risks obvious, most risks derive from the observability of transactions.  These risks also need to be mitigated when using server-based variants of DNS-SD.  </p>
<p id="rfc.section.1.p.2">There are cases when nodes connected to a network want to provide or consume services without exposing their identity to the other parties connected to the same network. Consider for example a traveler wanting to upload pictures from a phone to a laptop when connected to the Wi-Fi network of an Internet cafe, or two travelers who want to share files between their laptops when waiting for their plane in an airport lounge.  </p>
<p id="rfc.section.1.p.3">We expect that these exchanges will start with a discovery procedure using DNS-SD over mDNS.  One of the devices will publish the availability of a service, such as a picture library or a file store in our examples. The user of the other device will discover this service, and then connect to it.  </p>
<p id="rfc.section.1.p.4">When analyzing these scenarios in <a href="#scenarios" class="xref">Section 3.1</a>, we find that the DNS-SD messages leak identifying information such as the service instance name, the host name, or service properties.  </p>
<p></p>

<dl>
<dt>Identity</dt>
<dd style="margin-left: 8">In this document, the term "identity" refers to the identity of the entity (legal person) operating a device.  </dd>
<dt>Disclosing an Identity</dt>
<dd style="margin-left: 8">In this document "disclosing an identity" means showing the identity of operating entities to devices external to the discovery process; e.g., devices on the same network link that are listening to the network traffic but are not actually involved in the discovery process.  This document focuses on identity disclosure by data conveyed via messages on the service discovery protocol layer.  Still, identity leaks on deeper layers, e.g., the IP layer, are mentioned.  </dd>
<dt>Disclosing Information</dt>
<dd style="margin-left: 8">In this document "disclosing information" is also focused on disclosure by data conveyed via messages on the service discovery protocol layer.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#threatmodel" id="threatmodel">Threat Model</a>
</h1>
<p id="rfc.section.2.p.1">This document considers the following attacker types sorted by increasing power.  All these attackers can either be passive, i.e. they just listen to network traffic they have access to, or active, i.e. they additionally can craft and send (malicious) packets.  </p>
<p></p>

<dl>
<dt>external</dt>
<dd style="margin-left: 8">An external attacker is not on the same network link as victim devices engaging in service discovery; thus, the external attacker is in a different multicast domain.  </dd>
<dt>on-link</dt>
<dd style="margin-left: 8">An on-link attacker is on the same network link as victim devices engaging in service discovery; thus, the external attacker is in the same multicast domain.  This attacker can also mount all attacks an external attacker can mount.  </dd>
<dt>MITM</dt>
<dd style="margin-left: 8">A Man in the Middle (MITM) attacker either controls (parts of) a network link or can trick two parties to send traffic via him; thus, the MITM attacker has access to unicast traffic between devices engaging in service discovery.  This attacker can also mount all attacks an on-link attacker can mount.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#threatanalysis" id="threatanalysis">Threat Analysis</a>
</h1>
<p id="rfc.section.3.p.1">In this section we analyse how the attackers described in the previous section might threaten the privacy of entities operating devices engaging in service discovery.  We focus on attacks leveraging data transmitted in service discovery protocol messages.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#scenarios" id="scenarios">Service Discovery Scenarios</a>
</h1>
<p id="rfc.section.3.1.p.1">In this section, we review common service discovery scenarios and discuss privacy threats and their privacy requirements.  In all three of these common scenarios the attacker is of the type passive on-link.</p>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> <a href="#privclipubserv" id="privclipubserv">Private Client and Public Server</a>
</h1>
<p id="rfc.section.3.1.1.p.1">Perhaps the simplest private discovery scenario involves a single client connecting to a public server through a public network. A common example would be a traveler using a publicly available printer in a business center, in an hotel, or at an airport.  </p>
<pre>
                                     ( Taking notes:
                                     ( David is printing
                                     ( a document
                                      ~~~~~~~~~~~
                                                  o
         ___                                        o   ___
        /   \                                         _|___|_
        |   |   client                server           |* *|
         \_/      __                                    \_/
          |      / /   Discovery   +----------+          |
         /|\    /_/  &lt;-----------&gt; |  +----+  |         /|\
        / | \__/                   +--|    |--+        / | \
       /  |                           |____/          /  |  \
      /   |                                          /   |   \
         / \                                            / \
        /   \                                          /   \
       /     \                                        /     \
      /       \                                      /       \
     /         \                                    /         \
                                                    
        David                                        adversary
</pre>
<p></p>
<p id="rfc.section.3.1.1.p.3">In that scenario, the server is public and wants to be discovered, but the client is private. The adversary will be listening to the network traffic, trying to identify the visitors' devices and their activity.  Identifying devices leads to identifying people, either just for tracking people or as a preliminary to targeted attacks.  </p>
<p id="rfc.section.3.1.1.p.4">The requirement in that scenario is that the discovery activity should not disclose the identity of the client.  </p>
<h1 id="rfc.section.3.1.2">
<a href="#rfc.section.3.1.2">3.1.2.</a> <a href="#privcliprivserv" id="privcliprivserv">Private Client and Private Server</a>
</h1>
<p id="rfc.section.3.1.2.p.1">The second private discovery scenario involves a private client connecting to a private server. A common example would be two people engaging in a collaborative application in a public place, such as for example an airport's lounge.  </p>
<pre>
                                        ( Taking notes:
                                        ( David is meeting
                                        ( with Stuart
                                          ~~~~~~~~~~~
                                                     o
         ___                               ___         o   ___
        /   \                             /   \          _|___|_
        |   |   server          client    |   |           |* *|
         \_/      __               __      \_/             \_/
          |      / /   Discovery   \ \      |               |
         /|\    /_/  &lt;-----------&gt;  \_\    /|\             /|\
        / | \__/                       \__/ | \           / | \
       /  |                                 |  \         /  |  \
      /   |                                 |   \       /   |   \
         / \                               / \             / \
        /   \                             /   \           /   \
       /     \                           /     \         /     \
      /       \                         /       \       /       \
     /         \                       /         \     /         \

       David                              Stuart        Adversary
</pre>
<p></p>
<p id="rfc.section.3.1.2.p.3">In that scenario, the collaborative application on one of the devices will act as a server, and the application on the other device will act as a client.  The server wants to be discovered by the client, but has no desire to be discovered by anyone else. The adversary will be listening to network traffic, attempting to discover the identity of devices as in the first scenario, and also attempting to discover the patterns of traffic, as these patterns reveal the business and social interactions between the owners of the devices.  </p>
<p id="rfc.section.3.1.2.p.4">The requirement in that scenario is that the discovery activity should not disclose the identity of either the client or the server.  </p>
<h1 id="rfc.section.3.1.3">
<a href="#rfc.section.3.1.3">3.1.3.</a> <a href="#wearcliserv" id="wearcliserv">Wearable Client and Server</a>
</h1>
<p id="rfc.section.3.1.3.p.1">The third private discovery scenario involves wearable devices.  A typical example would be the watch on someone's wrist connecting to the phone in their pocket.  </p>
<pre>

                                     ( Taking notes:
                                     ( David is here. His watch is 
                                     ( talking to his phone
                                       ~~~~~~~~~~~
                                                   o
         ___                                         o  ___
        /   \                                         _|___|_
        |   |   client                                 |* *|
         \_/                                            \_/
          |     _/                                       |
         /|\   //                                       /|\
        / | \__/  ^                                    / | \
       /  |__     | Discovery                         /  |  \
      /   |\ \    v                                  /   |   \
         / \\_\                                         / \
        /   \   server                                 /   \
       /     \                                        /     \
      /       \                                      /       \
     /         \                                    /         \

        David                                        Adversary
</pre>
<p></p>
<p id="rfc.section.3.1.3.p.3">This third scenario is in many ways similar to the second scenario. It involves two devices, one acting as server and the other acting as client, and it leads to the same requirement of the discovery traffic not disclosing the identity of either the client or the server. The main difference is that the devices are managed by a single owner, which can lead to different methods for establishing secure relations between the devices. There is also an added emphasis on hiding the type of devices that the person wears.  </p>
<p id="rfc.section.3.1.3.p.4">In addition to tracking the identity of the owner of the devices, the adversary is interested in the characteristics of the devices, such as type, brand, and model.  Identifying the type of device can lead to further attacks, from theft to device specific hacking. The combination of devices worn by the same person will also provide a "fingerprint" of the person, allowing identification.  </p>
<p id="rfc.section.3.1.3.p.5">This scenario also represents the general case of bringing private IoT devices into public places.  A wearable IoT device might act as a DNS-SD/mDNS client which allows attackers to infer information about devices' owners.  While the attacker might be a person as in the example figure, this could also be abused for large scale data collection installing stationary IoT-device-tracking servers in frequented public places.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#analysis" id="analysis">DNS-SD Privacy Considerations</a>
</h1>
<p id="rfc.section.3.2.p.1">While the discovery process illustrated in the scenarios in <a href="#scenarios" class="xref">Section 3.1</a> most likely would be based on <a href="#RFC6762" class="xref">[RFC6762]</a> as a means for making service information available, this document considers all kinds of means for making DNS-SD resource records available.  These means comprise but are not limited to mDNS <a href="#RFC6762" class="xref">[RFC6762]</a>, DNS servers (<a href="#RFC1033" class="xref">[RFC1033]</a> <a href="#RFC1034" class="xref">[RFC1034]</a>, <a href="#RFC1035" class="xref">[RFC1035]</a>), e.g. using SRP <a href="#I-D.ietf-dnssd-srp" class="xref">[I-D.ietf-dnssd-srp]</a>, and multi-link <a href="#RFC7558" class="xref">[RFC7558]</a> networks.  </p>
<p id="rfc.section.3.2.p.2">The discovery scenarios in <a href="#scenarios" class="xref">Section 3.1</a> illustrate three separate abstract privacy requirements that vary based on the use case. These are not limited to mDNS.  </p>

<ol>
<li>Client identity privacy: Client identities are not leaked during service discovery or use.</li>
<li>Multi-entity, mutual client and server identity privacy: Neither client nor server identities are leaked during service discovery or use.</li>
<li>Single-entity, mutual client and server identity privacy: Identities of clients and servers owned and managed by the same legal person are not leaked during service discovery or use.</li>
</ol>

<p> </p>
<p id="rfc.section.3.2.p.3">In this section, we describe aspects of DNS-SD that make these requirements difficult to achieve in practice.  While it is intended to be thorough, it is not possible to be exhaustive.  </p>
<p id="rfc.section.3.2.p.4">Client identity privacy, if not addressed properly, can be thwarted by a passive attacker (see <a href="#threatmodel" class="xref">Section 2</a>).  The type of passive attacker necessary depends on the means of making service information available.  Information conveyed via multicast messages can be obtained by an on-link attacker, while unicast messages are only available to MITM attackers. Using multi-link service discovery solutions <a href="#RFC7558" class="xref">[RFC7558]</a>, external attackers have to be taken into consideration as well, e.g., when relaying multicast messages to other links.  </p>
<p id="rfc.section.3.2.p.5">Server identity privacy can be thwarted by a passive attacker in the same way as client identity privacy.  Additionally, active attackers querying for information have to be taken into consideration as well.  This is mainly relevant for unicast based discovery, where listening to discovery traffic requires a MITM attacker; however, an external active attacker might be able to learn the server identity by just querying for service information, e.g. via DNS.  </p>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> <a href="#RRs" id="RRs">Information made available via DNS-SD Resource Records</a>
</h1>
<p id="rfc.section.3.2.1.p.1">DNS-Based Service Discovery (DNS-SD) is defined in <a href="#RFC6763" class="xref">[RFC6763]</a>.  It allows nodes to publish the availability of an instance of a service by inserting specific records in the DNS (<a href="#RFC1033" class="xref">[RFC1033]</a>, <a href="#RFC1034" class="xref">[RFC1034]</a>, <a href="#RFC1035" class="xref">[RFC1035]</a>) or by publishing these records locally using multicast DNS (mDNS) <a href="#RFC6762" class="xref">[RFC6762]</a>.  Available services are described using three types of records: </p>
<p></p>

<dl>
<dt>PTR Record:</dt>
<dd style="margin-left: 8">Associates a service type in the domain with an "instance" name of this service type.  </dd>
<dt>SRV Record:</dt>
<dd style="margin-left: 8">Provides the node name, port number, priority and weight associated with the service instance, in conformance with <a href="#RFC2782" class="xref">[RFC2782]</a>.  </dd>
<dt>TXT Record:</dt>
<dd style="margin-left: 8">Provides a set of attribute-value pairs describing specific properties of the service instance.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> <a href="#instanceLeak" id="instanceLeak">Privacy Implication of Publishing Service Instance Names</a>
</h1>
<p id="rfc.section.3.2.2.p.1">In the first phase of discovery, clients obtain all PTR records associated with a service type in a given naming domain. Each PTR record contains a Service Instance Name defined in Section 4 of <a href="#RFC6763" class="xref">[RFC6763]</a>: </p>
<pre>
  Service Instance Name = &lt;Instance&gt; . &lt;Service&gt; . &lt;Domain&gt;
</pre>
<p></p>
<p id="rfc.section.3.2.2.p.3">The &lt;Instance&gt; portion of the Service Instance Name is meant to convey enough information for users of discovery clients to easily select the desired service instance.  Nodes that use DNS-SD over mDNS <a href="#RFC6762" class="xref">[RFC6762]</a> in a mobile environment will rely on the specificity of the instance name to identify the desired service instance.  In our example of users wanting to upload pictures to a laptop in an Internet Cafe, the list of available service instances may look like: </p>
<pre>
Alice's Images         . _imageStore._tcp . local
Alice's Mobile Phone   . _presence._tcp   . local
Alice's Notebook       . _presence._tcp   . local
Bob's Notebook         . _presence._tcp   . local
Carol's Notebook       . _presence._tcp   . local
</pre>
<p></p>
<p id="rfc.section.3.2.2.p.5">Alice will see the list on her phone and understand intuitively that she should pick the first item. The discovery will "just work". (Note that our examples of service names conform to the specification in section 4.1 of <a href="#RFC6763" class="xref">[RFC6763]</a>, but may require some character escaping when entered in conventional DNS software.) </p>
<p id="rfc.section.3.2.2.p.6">However, DNS-SD/mDNS will reveal to anybody that Alice is currently visiting the Internet Cafe.  It further discloses the fact that she uses two devices, shares an image store, and uses a chat application supporting the _presence protocol on both of her devices. She might currently chat with Bob or Carol, as they are also using a _presence supporting chat application.  This information is not just available to devices actively browsing for and offering services, but to anybody passively listening to the network traffic, i.e. a passive on-link attacker.  </p>
<h1 id="rfc.section.3.2.3">
<a href="#rfc.section.3.2.3">3.2.3.</a> Privacy Implication of Publishing Node Names</h1>
<p id="rfc.section.3.2.3.p.1">The SRV records contain the DNS name of the node publishing the service. Typical implementations construct this DNS name by concatenating the "host name" of the node with the name of the local domain. The privacy implications of this practice are reviewed in <a href="#RFC8117" class="xref">[RFC8117]</a>.  Depending on naming practices, the host name is either a strong identifier of the device, or at a minimum a partial identifier.  It enables tracking of both the device, and, by extension, the device's owner.  </p>
<h1 id="rfc.section.3.2.4">
<a href="#rfc.section.3.2.4">3.2.4.</a> Privacy Implication of Publishing Service Attributes</h1>
<p id="rfc.section.3.2.4.p.1">The TXT record's attribute-value pairs contain information on the characteristics of the corresponding service instance.  This in turn reveals information about the devices that publish services. The amount of information varies widely with the particular service and its implementation: </p>
<p></p>

<ul>
<li>Some attributes like the paper size available in a printer, are the same on many devices, and thus only provide limited information to a tracker.  </li>
<li>Attributes that have freeform values, such as the name of a directory, may reveal much more information.  </li>
</ul>

<p> </p>
<p id="rfc.section.3.2.4.p.3">Combinations of attributes have more information power than specific attributes, and can potentially be used for "fingerprinting" a specific device.  </p>
<p id="rfc.section.3.2.4.p.4">Information contained in TXT records does not only breach privacy by making devices trackable, but might directly contain private information about the user.  For instance the _presence service reveals the "chat status" to everyone in the same network.  Users might not be aware of that.  </p>
<p id="rfc.section.3.2.4.p.5">Further, TXT records often contain version information about services allowing potential attackers to identify devices running exploit-prone versions of a certain service.  </p>
<h1 id="rfc.section.3.2.5">
<a href="#rfc.section.3.2.5">3.2.5.</a> <a href="#serverFingerprint" id="serverFingerprint">Device Fingerprinting</a>
</h1>
<p id="rfc.section.3.2.5.p.1">The combination of information published in DNS-SD has the potential to provide a "fingerprint" of a specific device. Such information includes: </p>
<p></p>

<ul>
<li>List of services published by the device, which can be retrieved because the SRV records will point to the same host name.  </li>
<li>Specific attributes describing these services.  </li>
<li>Port numbers used by the services.  </li>
<li>Priority and weight attributes in the SRV records.  </li>
</ul>

<p> </p>
<p id="rfc.section.3.2.5.p.3">This combination of services and attributes will often be sufficient to identify the version of the software running on a device. If a device publishes many services with rich sets of attributes, the combination may be sufficient to identify the specific device.  </p>
<p id="rfc.section.3.2.5.p.4">An argument is sometimes made that devices providing services can be identified by observing the local traffic, and that trying to hide the presence of the service is futile. However, </p>

<ol>
<li>Providing privacy at the discovery layer is of the essence for enabling automatically configured privacy-preserving network applications. Application layer protocols are not forced to leverage the offered privacy, but if device tracking is not prevented at the deeper layers, including the service discovery layer, obfuscating a certain service's protocol at the application layer is futile.  </li>
<li>Further, in the case of mDNS based discovery, even if the application layer does not protect privacy, typically services are provided via unicast which requires a MITM attacker, while identifying services based on multicast discovery messages just requires an on-link attacker.  </li>
</ol>

<p> The same argument can be extended to say that the pattern of services offered by a device allows for fingerprinting the device. This may or may not be true, since we can expect that services will be designed or updated to avoid leaking fingerprints. In any case, the design of the discovery service should avoid making a bad situation worse, and should as much as possible avoid providing new fingerprinting information.  </p>
<h1 id="rfc.section.3.2.6">
<a href="#rfc.section.3.2.6">3.2.6.</a> <a href="#clientPrivacy" id="clientPrivacy">Privacy Implication of Discovering Services</a>
</h1>
<p id="rfc.section.3.2.6.p.1">The consumers of services engage in discovery, and in doing so reveal some information such as the list of services they are interested in and the domains in which they are looking for the services. When the clients select specific instances of services, they reveal their preference for these instances. This can be benign if the service type is very common, but it could be more problematic for sensitive services, such as for example some private messaging services.  </p>
<p id="rfc.section.3.2.6.p.2">One way to protect clients would be to somehow encrypt the requested service types.  Of course, just as we noted in <a href="#serverFingerprint" class="xref">Section 3.2.5</a>, traffic analysis can often reveal the service.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Security Considerations</h1>
<p id="rfc.section.3.3.p.1">For each of the operations described above, we must also consider security threats we are concerned about.</p>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> Authenticity, Integrity &amp; Freshness</h1>
<p id="rfc.section.3.3.1.p.1">Can devices (both servers and clients) trust the information they receive? Has it been modified in flight by an adversary? Can devices trust the source of the information? Is the source of information fresh, i.e., not replayed? Freshness may or may not be required depending on whether the discovery process is meant to be online. In some cases, publishing discovery information to a shared directory or registry, rather than to each online recipient through a broadcast channel, may suffice.</p>
<h1 id="rfc.section.3.3.2">
<a href="#rfc.section.3.3.2">3.3.2.</a> Confidentiality</h1>
<p id="rfc.section.3.3.2.p.1">Confidentiality is about restricting information access to only authorized individuals. Ideally this should only be the appropriate trusted parties, though it can be challenging to define who are "the appropriate trusted parties." In some use cases, this may mean that only mutually authenticated and trusting clients and servers can read messages sent for one another.  The process of service discovery in particular is often used to discover new entities that the device did not previously know about.  It may be tricky to work out how a device can have an established trust relationship with a new entity it has never previously communicated with.  </p>
<h1 id="rfc.section.3.3.3">
<a href="#rfc.section.3.3.3">3.3.3.</a> Resistance to Dictionary Attacks</h1>
<p id="rfc.section.3.3.3.p.1">It can be tempting to use (publicly computable) hash functions to obscure sensitive identifiers.  This transforms a sensitive unique identifier such as an email address into a "scrambled" but still unique identifier. Unfortunately simple solutions may be vulnerable to offline dictionary attacks.</p>
<h1 id="rfc.section.3.3.4">
<a href="#rfc.section.3.3.4">3.3.4.</a> Resistance to Denial-of-Service Attacks</h1>
<p id="rfc.section.3.3.4.p.1">In any protocol where the receiver of messages has to perform cryptographic operations on those messages, there is a risk of a brute-force flooding attack causing the receiver to expend excessive amounts of CPU time and, where appliciable, battery power just processing and discarding those messages.</p>
<p id="rfc.section.3.3.4.p.2">Also, amplification attacks have to be taken into consideration.  Messages with larger payloads should only be sent as an answer to a query sent by a verified client.  </p>
<h1 id="rfc.section.3.3.5">
<a href="#rfc.section.3.3.5">3.3.5.</a> Resistance to Sender Impersonation</h1>
<p id="rfc.section.3.3.5.p.1">Sender impersonation is an attack wherein messages such as service offers are forged by entities who do not possess the corresponding secret key material. These attacks may be used to learn the identity of a communicating party, actively or passively.</p>
<h1 id="rfc.section.3.3.6">
<a href="#rfc.section.3.3.6">3.3.6.</a> Sender Deniability</h1>
<p id="rfc.section.3.3.6.p.1">Deniability of sender activity, e.g., of broadcasting a discovery request, may be desirable or necessary in some use cases. This property ensures that eavesdroppers cannot prove senders issued a specific message destined for one or more peers. </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Operational Considerations</h1>
<h1 id="rfc.section.3.4.1">
<a href="#rfc.section.3.4.1">3.4.1.</a> Power Management</h1>
<p id="rfc.section.3.4.1.p.1">Many modern devices, especially battery-powered devices, use power management techniques to conserve energy.  One such technique is for a device to transfer information about itself to a proxy, which will act on behalf of the device for some functions, while the device itself goes to sleep to reduce power consumption.  When the proxy determines that some action is required which only the device itself can perform, the proxy may have some way to wake the device, as implied in <a href="#RFC6762" class="xref">RFC6762</a></p>
<p id="rfc.section.3.4.1.p.2">In many cases, the device may not trust the network proxy sufficiently to share all its confidential key material with the proxy.  This poses challenges for combining private discovery that relies on per-query cryptographic operations, with energy-saving techniques that rely on having (somewhat untrusted) network proxies answer queries on behalf of sleeping devices.</p>
<h1 id="rfc.section.3.4.2">
<a href="#rfc.section.3.4.2">3.4.2.</a> Protocol Efficiency</h1>
<p id="rfc.section.3.4.2.p.1">Creating a discovery protocol that has the desired security properties may result in a design that is not efficient.  To perform the necessary operations the protocol may need to send and receive a large number of network packets.  This may consume an unreasonable amount of network capacity, particularly problematic when it is a shared wireless spectrum.  Further it may cause an unnecessary level of power consumption which is particularly problematic on battery devices, and may result in the discovery process being slow.</p>
<p id="rfc.section.3.4.2.p.2">It is a difficult challenge to design a discovery protocol that has the property of obscuring the details of what it is doing from unauthorized observers, while also managing to do that efficiently.</p>
<h1 id="rfc.section.3.4.3">
<a href="#rfc.section.3.4.3">3.4.3.</a> Secure Initialization and Trust Models</h1>
<p id="rfc.section.3.4.3.p.1">One of the challenges implicit in the preceding discussions is that whenever we discuss "trusted entities" versus "untrusted entities", there needs to be some way that trust is initially established, to convert an "untrusted entity" into a "trusted entity".</p>
<p id="rfc.section.3.4.3.p.2">The purpose of this document is not to define the specific way in which trust can be established. Protocol designers may rely on a number of existing technologies, including PKI, Trust On First Use (TOFU), or using a short passphrase or PIN with cryptographic algorithms such as <a href="#RFC5054" class="xref">Secure Remote Password (SRP)</a> or a Password Authenticated Key Exchange like <a href="#RFC8236" class="xref">J-PAKE</a> using a <a href="#RFC8235" class="xref">Schnorr Non-interactive Zero-Knowledge Proof</a>.  </p>
<p id="rfc.section.3.4.3.p.3">Protocol designers should consider a specific usability pitfall when trust is established immediately prior to performing discovery. Users will have a tendency to "click OK" in order to achieve their task. This implicit vulnerability is avoided if the trust establishment requires active participation of the user, such as entering a password or PIN.  </p>
<h1 id="rfc.section.3.4.4">
<a href="#rfc.section.3.4.4">3.4.4.</a> External Dependencies</h1>
<p id="rfc.section.3.4.4.p.1">Trust establishment may depend on external parties.  Optionally, this might involve synchronous communication.  Systems which have such a dependency may be attacked by interfering with communication to external dependencies. Where possible, such dependencies should be minimized.  Local trust models are best for secure initialization in the presence of active attackers.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Requirements for a DNS-SD Privacy Extension</h1>
<p id="rfc.section.4.p.1">Given the considerations discussed in the previous sections, we state requirements for privacy preserving DNS-SD in the following subsections.  </p>
<p id="rfc.section.4.p.2">Defining a solution according to these requirements is intended to lead to a solution that does not transmit privacy violating DNS-SD messages and further does not open pathways to new attacks against the operation of DNS-SD.  </p>
<p id="rfc.section.4.p.3">However, while this document gives advice on which privacy protecting mechanisms should be used on deeper layer network protocols and on how to actually connect to services in a privacy preserving way, stating corresponding requirements is out of the scope of this document.  To mitigate attacks against privacy on lower layers, both servers and clients must use privacy options available at lower layers, and for example avoid publishing static IPv4 or IPv6 addresses, or static IEEE 802 MAC addresses.  For services advertised on a single network link, link local IP addresses should be used; see <a href="#RFC3927" class="xref">[RFC3927]</a> and <a href="#RFC4291" class="xref">[RFC4291]</a> for IPv4 and IPv6, respectively.  Static servers advertising services globally via DNS can hide their IP addresses from unauthorized clients using the split mode topology shown in <a href="#I-D.ietf-tls-esni" class="xref">[I-D.ietf-tls-esni]</a>.  Hiding static MAC addresses can be achieved via MAC address randomization (see <a href="#RFC7844" class="xref">[RFC7844]</a>).  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Private Client Requirements</h1>
<p id="rfc.section.4.1.p.1">For all three scenarios described in <a href="#scenarios" class="xref">Section 3.1</a>, client privacy requires DNS-SD messages to: </p>

<ol>
<li>Avoid disclosure of the client's identity, either directly or via inference, to nodes other than select servers.  </li>
<li>Avoid exposure of linkable identifiers that allow tracing client devices.  </li>
<li>Avoid disclosure of the client's interest in specific service instances or service types to nodes other than select servers.  </li>
</ol>

<p> </p>
<p id="rfc.section.4.1.p.2">When listing and resolving services via current DNS-SD deployments, clients typically disclose their interest in specific services types and specific instances of these types, respectively.  </p>
<p id="rfc.section.4.1.p.3">In addition to the exposure and disclosure risks noted above, protocols and implementations will have to consider fingerprinting attacks (see <a href="#serverFingerprint" class="xref">Section 3.2.5</a>) that could retrieve similar information.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Private Server Requirements</h1>
<p id="rfc.section.4.2.p.1">Servers like the "printer" discussed in scenario 1 are public, but the servers discussed in scenarios 2 and 3 are by essence private.  Server privacy requires DNS-SD messages to: </p>
<p></p>

<ol>
<li>Avoid disclosure of the server's identity, either directly or via inference, to nodes other than authorized clients.  In particular, Servers must avoid publishing static identifiers such as host names or service names.  When those fields are required by the protocol, servers should publish randomized values. (See <a href="#RFC8117" class="xref">[RFC8117]</a> for a discussion of host names.) </li>
<li>Avoid exposure of linkable identifiers that allow tracing servers.  </li>
<li>Avoid disclosure of service instance names or service types of offered services to unauthorized clients.  </li>
<li>Avoid disclosure of information about the services they offer to unauthorized clients.  </li>
<li>Avoid disclosure of static IPv4 or IPv6 addresses.  </li>
</ol>

<p> </p>
<p id="rfc.section.4.2.p.3">When offering services via current DNS-SD deployments, servers typically disclose their hostnames (SRV, A/AAAA), instance names of offered services (PRT, SRV), and information about services (TXT).  Heeding these requirements protects a server's privacy on the DNS-SD level.  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Security and Operation</h1>
<p id="rfc.section.4.3.p.1">In order to be secure and feasible, a DNS-SD privacy extension needs to consider security and operational requirements including: </p>

<ol>
<li>Avoiding significant CPU overhead on nodes or significantly higher network load.  Such overhead or load would make nodes vulnerable to denial of service attacks. Further, it would increase power consumption which is critical for IoT devices.  </li>
<li>Avoiding designs in which a small message can trigger a large amount of traffic towards an unverified address, as this could be exploited in amplification attacks.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.5.p.1">This draft does not require any IANA action.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Acknowledgments</h1>
<p id="rfc.section.6.p.1">This draft incorporates many contributions from Stuart Cheshire and Chris Wood. Thanks to Florian Adamsky for extensive review and suggestions on the organization of the threat model.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-dnssd-srp">[I-D.ietf-dnssd-srp]</b></td>
<td class="top">
<a>Cheshire, S.</a> and <a>T. Lemon</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dnssd-srp-02">Service Registration Protocol for DNS-Based Service Discovery</a>", Internet-Draft draft-ietf-dnssd-srp-02, July 2019.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-tls-esni">[I-D.ietf-tls-esni]</b></td>
<td class="top">
<a>Rescorla, E.</a>, <a>Oku, K.</a>, <a>Sullivan, N.</a> and <a>C. Wood</a>, "<a href="https://tools.ietf.org/html/draft-ietf-tls-esni-05">Encrypted Server Name Indication for TLS 1.3</a>", Internet-Draft draft-ietf-tls-esni-05, November 2019.</td>
</tr>
<tr>
<td class="reference"><b id="K17">[K17]</b></td>
<td class="top">
<a>Kaiser, D.</a>, "<a href="http://nbn-resolving.de/urn:nbn:de:bsz:352-0-422757">Efficient Privacy-Preserving Configurationless Service Discovery Supporting Multi-Link Networks</a>", 2017.</td>
</tr>
<tr>
<td class="reference"><b id="KW14a">[KW14a]</b></td>
<td class="top">
<a>Kaiser, D.</a> and <a>M. Waldvogel</a>, "<a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?arnumber=7011331">Adding Privacy to Multicast DNS Service Discovery</a>", DOI 10.1109/TrustCom.2014.107, 2014.</td>
</tr>
<tr>
<td class="reference"><b id="KW14b">[KW14b]</b></td>
<td class="top">
<a>Kaiser, D.</a> and <a>M. Waldvogel</a>, "<a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?arnumber=7056899">Efficient Privacy Preserving Multicast DNS Service Discovery</a>", DOI 10.1109/HPCC.2014.141, 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1033">[RFC1033]</b></td>
<td class="top">
<a>Lottor, M.</a>, "<a href="https://tools.ietf.org/html/rfc1033">Domain Administrators Operations Guide</a>", RFC 1033, DOI 10.17487/RFC1033, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1034">[RFC1034]</b></td>
<td class="top">
<a>Mockapetris, P.</a>, "<a href="https://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>", STD 13, RFC 1034, DOI 10.17487/RFC1034, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a>Mockapetris, P.</a>, "<a href="https://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, DOI 10.17487/RFC1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2782">[RFC2782]</b></td>
<td class="top">
<a>Gulbrandsen, A.</a>, <a>Vixie, P.</a> and <a>L. Esibov</a>, "<a href="https://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>", RFC 2782, DOI 10.17487/RFC2782, February 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3927">[RFC3927]</b></td>
<td class="top">
<a>Cheshire, S.</a>, <a>Aboba, B.</a> and <a>E. Guttman</a>, "<a href="https://tools.ietf.org/html/rfc3927">Dynamic Configuration of IPv4 Link-Local Addresses</a>", RFC 3927, DOI 10.17487/RFC3927, May 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4291">[RFC4291]</b></td>
<td class="top">
<a>Hinden, R.</a> and <a>S. Deering</a>, "<a href="https://tools.ietf.org/html/rfc4291">IP Version 6 Addressing Architecture</a>", RFC 4291, DOI 10.17487/RFC4291, February 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5054">[RFC5054]</b></td>
<td class="top">
<a>Taylor, D.</a>, <a>Wu, T.</a>, <a>Mavrogiannopoulos, N.</a> and <a>T. Perrin</a>, "<a href="https://tools.ietf.org/html/rfc5054">Using the Secure Remote Password (SRP) Protocol for TLS Authentication</a>", RFC 5054, DOI 10.17487/RFC5054, November 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6762">[RFC6762]</b></td>
<td class="top">
<a>Cheshire, S.</a> and <a>M. Krochmal</a>, "<a href="https://tools.ietf.org/html/rfc6762">Multicast DNS</a>", RFC 6762, DOI 10.17487/RFC6762, February 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6763">[RFC6763]</b></td>
<td class="top">
<a>Cheshire, S.</a> and <a>M. Krochmal</a>, "<a href="https://tools.ietf.org/html/rfc6763">DNS-Based Service Discovery</a>", RFC 6763, DOI 10.17487/RFC6763, February 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7558">[RFC7558]</b></td>
<td class="top">
<a>Lynn, K.</a>, <a>Cheshire, S.</a>, <a>Blanchet, M.</a> and <a>D. Migault</a>, "<a href="https://tools.ietf.org/html/rfc7558">Requirements for Scalable DNS-Based Service Discovery (DNS-SD) / Multicast DNS (mDNS) Extensions</a>", RFC 7558, DOI 10.17487/RFC7558, July 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7844">[RFC7844]</b></td>
<td class="top">
<a>Huitema, C.</a>, <a>Mrugalski, T.</a> and <a>S. Krishnan</a>, "<a href="https://tools.ietf.org/html/rfc7844">Anonymity Profiles for DHCP Clients</a>", RFC 7844, DOI 10.17487/RFC7844, May 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8117">[RFC8117]</b></td>
<td class="top">
<a>Huitema, C.</a>, <a>Thaler, D.</a> and <a>R. Winter</a>, "<a href="https://tools.ietf.org/html/rfc8117">Current Hostname Practice Considered Harmful</a>", RFC 8117, DOI 10.17487/RFC8117, March 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8235">[RFC8235]</b></td>
<td class="top">
<a>Hao, F.</a>, "<a href="https://tools.ietf.org/html/rfc8235">Schnorr Non-interactive Zero-Knowledge Proof</a>", RFC 8235, DOI 10.17487/RFC8235, September 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8236">[RFC8236]</b></td>
<td class="top">
<a>Hao, F.</a>, "<a href="https://tools.ietf.org/html/rfc8236">J-PAKE: Password-Authenticated Key Exchange by Juggling</a>", RFC 8236, DOI 10.17487/RFC8236, September 2017.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Christian Huitema</span> 
	  <span class="n hidden">
		<span class="family-name">Huitema</span>
	  </span>
	</span>
	<span class="org vcardline">Private Octopus Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">Friday Harbor</span>,  
		<span class="region">WA</span> 
		<span class="code">98250</span>
	  </span>
	  <span class="country-name vcardline">U.S.A.</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:huitema@huitema.net">huitema@huitema.net</a></span>

<span class="vcardline">URI: <a href="http://privateoctopus.com/">http://privateoctopus.com/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Daniel Kaiser</span> 
	  <span class="n hidden">
		<span class="family-name">Kaiser</span>
	  </span>
	</span>
	<span class="org vcardline">University of Luxembourg</span>
	<span class="adr">
	  <span class="vcardline">6, avenue de la Fonte</span>

	  <span class="vcardline">
		<span class="locality">Esch-sur-Alzette</span>,  
		<span class="region"></span>
		<span class="code">4364</span>
	  </span>
	  <span class="country-name vcardline">Luxembourg</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:daniel.kaiser@uni.lu">daniel.kaiser@uni.lu</a></span>

<span class="vcardline">URI: <a href="https://secan-lab.uni.lu/">https://secan-lab.uni.lu/</a></span>

  </address>
</div>

</body>
</html>
