I_message = HDR, T, RAND, [IDi], IDr, 
                  {SP}, DHi, KEMAC 
    
                       ----------------------->   R_message = HDR, T, 
                                                   [IDr], IDi, DHr, 
                                                   DHi, KEMAC 
    
                       <---------------------- 
 
 
 
I_message = HDR, T, [IDi], IDr, 
                  {SP}, [DHi], KEMAC 
    
                       ----------------------->   R_message = HDR, T, 
                                                   [IDr], IDi, 
                                                   [DHr, DHi], KEMAC 
    
                       <---------------------- 
 
 
 
                      Figure 2: DHHMAC update message 
 
 
 
 
 
 
  
             HMAC-authenticated Diffie-Hellman for MIKEY  October 2004 
 
 
 
