CNAPurl		= url-parameters
protocolversion	= 1*3DIGIT	; 0 to 255
cnas			= 1*5DIGIT	; 0 to 99999
holdtime		= 1*3DIGIT	; 0 to 255
distrib-level-types = ("multiple" | "single")
rrs-type		= ("dns-cname")
IPv4address		= 1*digit "." 1*digit "." 1*digit "." 
                          1*digit
IPv4mask		= 1*digit
other-param		= (token | (token "=" (token | quoted-
                           string )))
advert-type		= ("area" | "content")
content-as-path	= *( (1*5DIGIT) [","])
area-list		= *( (IPv4address "&" IPv4mask ) [","] )
error-data		= *(alphanum)
status-type		= ("add" | "withdraw")
region-id-list	= *( (1*5DIGIT) [","])
rdir-value		= *(alphanum)

   
  
generic-message	=	start-line
					[message-header]
					CRLF

message-header		=	( open-header
					| notification-header
					| advertisement-header )
   

Message-header = field-name ":" [field-value] CRLF
Field-name = token
Field-value = *(field-content|LWS)
Field-content = <the OCTETs making up the field-value and 
                   consisting of either TEXT-UTF8 or combinations 
                   of token, separators and quoted string>


start-line	=	Method CRLF


Method = "OPEN" | "NOTIFY" | "ADVERTISEMENT" | "KEEPALIVE"

   
open-header	= Protocol-Version
Protocol-Version = "Protocol-Version" ":" protocolversion

    Node-ID: The Node ID is an unique IP address of the CIG. 
Node-ID = "Node-ID" ":" IPv4Address

    CNAS: The Content Network Autonomous System that uniquely 
          identifies this content network.  Each CN is assigned a   
          CNAS by an addressing authority.
Content-AS = "Content-AS" ":" cnas

    Holdtime: Keepalives expected in this interval.
Holdtime = "Holdtime" ":" holdtime 
 
    Distrib-Levels: Number of levels supported for request 
                    routing for this CN.
Distrib-Levels = "Distrib-Levels" ":" distrib-level-type

    RRS-Types: list of RRS types supported by this CN.
RRS-Types = "RRS-Types" ":" *(rrs-type)

    CNAPabilities: list of optional CNAPabilities supported by 
                   the CN.
CNAPabilities = *(CNAPability)



notify-header	= Error-Code
Error-Code = "Error-Code" ":" 3DIGIT

    Error-Subcode: Sub-code within a given error code type. If no 
                   specific
    subcode applies, the subcode should be set to zero.
Error-Subcode = "Error-Subcode" ":" 3DIGIT

    Error-Data: additional information regarding the error.
Error-Data = "Error-Data" ":" *(alphanum)

advertisement-header	= Advertisement-Type
			      | Authoritative-CN
			      | CN-Path
				| (area-header | content-header)

   Advertisement-Type: This specifies the type of advertisement.
Advertisement-Type = "Advertisement-Type" ":" advert-type

   Authoritative-CN: the CONTENTAS number of the CN authoritative 
                     for the CONTENT or AREA being advertised in 
                     this message.
Authoritative-CN = "Authoritative-CN" ":" contentas

   CN-Path: attribute that is composed of a sequence of CONTENTAS 
            numbers.
CN-Path = "CN-Path" ":" content-as-path
	
content-header	= Content-Set
Content-Set = "Content-Set" ":" *( (CNAPurl) [","] )

    Status: The status of the content set for the advertising CN.  
            The status-type may be either "ready" or "withdraw".  
            Ready indicates the CN can accept request for content 
            within the content-set.  Withdraw indicates
            that requests for content within the content-set 
            should not be sent to the advertising CN.
Status = "Status" ":" status-type


Region-List = "Region-List" ":" region-id-list

    TTL: Indicates for how long the CN will be ready for content 
         in the content set in minutes.
TTL = "TTL" ":" 32DIGITS

redirection-info = Redirection-Type
			  | Redirection-Value

    Redirection-Type: type of redirection parameter set used.
Redirection-Type = "Redirection-Type" ":" rrs-type
		      
    Redirection-Value: value of redirection parameter set 
                       (terminated by CRLF like other headers). 
                       See Section 4 for the structure of the 
                       Redirection value for cname based request 
                       routing systems.
Redirection-Value = "Redirection-Value" ":" rdir-value
 
redirection-info = Withdraw-Effective

    Withdraw-Effective: when the withdraw will be effective 
                        (might be 0).  A withdraw MAY withdraw 
                        content before the TTL in a previous 
                        ready message is reached. If the TTL 
                        in the ready message is reached the
                        content is considered withdrawn.
Withdraw-Effective = "Withdraw-Effective" ":" 32DIGITS


area-header	= Area-Set
Area-Set = "Area-Set" ":" area-list
	
    Status: The status of the area set for the advertising CN.  
            The status-type may be either "ready" or "withdraw".  
            Ready indicates the CN can accept request for the IP 
            prefixes within the area-set.  Withdraw
            indicates that requests for content within the area-
            set should not be sent to the advertising CN.
Status = "Status" ":" status-type

    Region-List: List of 16-bit region IDs for which the that are 
                 identified with the area set. 
Region-List = "Region-List" ":" region-id-list

    TTL: Indicates for how long the CN the area advertisement is 
         valid in minutes.
TTL = "TTL" ":" 32DIGITS


metric-list= *(metric)

metric = Metric-Type
	    | Metric-Value

    Metric-Type: type of metric reported.
Metric-Type = "Metric-Type" ":" 16DIGIT
   
    Metric-Value: value of metric; depends on type.
Metric-Value = "Metric-Value" ":" *(alphanum)

Redirection-Type = "Redirection-Type" ":" "dns-cname"
		  
	Redirection-Value: The CNAME to use for redirecting 
                         requests for content in the content set.
Redirection-Value = "Redirection-Value" ":"
                                *(alphanum)
   
