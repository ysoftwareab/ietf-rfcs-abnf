<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Channel Bindings for TLS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Channel Bindings for TLS">
<meta name="keywords" content="Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">NETWORK WORKING GROUP</td><td class="header">J. Altman</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Secure Endpoints</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">N. Williams</td></tr>
<tr><td class="header">Expires: December 13, 2009</td><td class="header">Sun</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 11, 2009</td></tr>
</table></td></tr></table>
<h1><br />Channel Bindings for TLS<br />draft-altman-tls-channel-bindings-04.txt</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on December 13, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document defines three channel binding types for
		Transport Layer Security (TLS), tls-unique,
		tls-server-end-point, and tls-unique-for-telnet, in
		accordance with RFC 5056 (On Channel Binding).
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Conventions used in this document<br />
<a href="#anchor2">2.</a>&nbsp;
Introduction<br />
<a href="#anchor3">3.</a>&nbsp;
The 'tls-unique' Channel Binding Type<br />
<a href="#anchor4">4.</a>&nbsp;
The 'tls-server-end-point' Channel Binding Type<br />
<a href="#anchor5">5.</a>&nbsp;
The 'tls-unique-for-telnet' Channel Binding Type<br />
<a href="#anchor6">6.</a>&nbsp;
Applicability of TLS Channel Binding Types<br />
<a href="#anchor7">7.</a>&nbsp;
Required Application Programming Interfaces<br />
<a href="#anchor8">8.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor9">9.</a>&nbsp;
Security Considerations<br />
<a href="#anchor10">9.1.</a>&nbsp;
Cryptographic Algorithm Agility<br />
<a href="#anchor11">9.2.</a>&nbsp;
On Disclosure of Channel Bindings Data by
		Authentication Mechanisms<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
<a href="#rfc.references2">10.2.</a>&nbsp;
Normative References for 'tls-server-end-point'<br />
<a href="#rfc.references3">10.3.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Conventions used in this document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
            "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
            and "OPTIONAL" in this document are to be interpreted as
            described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>Subsequent to the publication of "On Channel Bindings"
		<a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>, three channel binding types
		for Transport Layer Security (TLS) were proposed,
		reviewed and added to the IANA channel binding type
		registry, all in accordance with <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.  Those channel binding types
		are: 'tls-unique', 'tls-server-end-point', and
		'tls-unique-for-telnet'.  It has become desirable to
		have these channel binding types re-registered through
		an RFC so as to make it easier to reference them.  This
		document does just that.  The authors of those three
		channel binding types have, or have indicated that they
		will, transferred "ownership" of those channel binding
		types to the IESG.
</p>
<p>We also provide some advice on the applicability of these
		channel binding types, as well as advice on when to use
		which.  And we provide an abstract API that TLS
		implementors should provide, by which to obtain channel
		bindings data for a TLS connection.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
The 'tls-unique' Channel Binding Type</h3>

<p>IANA is hereby directed to update the registration of the
		'tls-unique' channel binding type to match the
		following.  Note that the only material changes from the
		original registration should be: the "owner" (now the
		IESG), contacts, the published specfication, and a
		clarification to the description by the addition of a
		parenthetical note (that is, the first such note in the
		descritption is a new addition).  We also added a note
		indicating that this specification contains
		applicability advice, and we moved security
		considerations notes to the security considerations
		section of this document.  All other fields of the
		registration are copied here for the convenience of
		readers.
</p>
<p>
		</p>
<ul class="text">
<li>Channel binding unique prefix: tls-unique
</li>
<li>Channel binding type: unique
</li>
<li>Channel type: TLS <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>
</li>
<li>Published specification: &lt;this document&gt;
</li>
<li>Channel binding is secret: no
</li>
<li>Description: The client's TLS Finished message (note:
			the Finished struct) from the first handshake of the
			connection (note: connection, not session, so that
			the channel binding is specific to each connection
			regardless of whether session resumption is
			used).
</li>
<li>Intended usage: COMMON
</li>
<li>Person and email address to contact for further information:
			Larry Zhu (lzhu@microsoft.com), Nicolas Williams
			(Nicolas.Williams@sun.com).
</li>
<li>Owner/Change controller name and email address:
			IESG.
</li>
<li>Expert reviewer name and contact information: IETF
			(ietf@ietf.org)
</li>
<li>Note: see the published specification for advice
			on the applicability of this channel binding
			type.
</li>
</ul><p>

	    
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
The 'tls-server-end-point' Channel Binding Type</h3>

<p>IANA is hereby directed to update the registration of the
		'tls-server-end-point' channel binding type to match the
		following.  Note that the only material changes from the
		original registration should be: the "owner" (now the
		IESG), the contacts, the published specfication, and a
		note indicating that the published specification should
		be consulted for applicability advice.  References were
		added to the description.  All other fields of the
		registration are copied here for the convenience of
		readers.
</p>
<p>

		</p>
<ul class="text">
<li>Channel binding unique prefix: tls-server-end-point
</li>
<li>Channel binding type: end-point
</li>
<li>Channel type: TLS <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>
</li>
<li>Published specification: &lt;this document&gt;
</li>
<li>Channel binding is secret: no
</li>
<li>Description: The hash of the TLS server's end
			entity certificate <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> as
			it appears, octet for octet, in the server's
			Certificate message (note that the Certificate
			message contains a certificate_list, the first
			element of which is the server's end entity
			certificate.) The hash function to be selected
			is as follows: if the certificate's signature
			hash algorithm is either MD5 <a class='info' href='#RFC1321'>[RFC1321]<span> (</span><span class='info'>Rivest, R., &ldquo;The MD5 Message-Digest Algorithm,&rdquo; April&nbsp;1992.</span><span>)</span></a> or SHA-1 <a class='info' href='#RFC3174'>[RFC3174]<span> (</span><span class='info'>Eastlake, D. and P. Jones, &ldquo;US Secure Hash Algorithm 1 (SHA1),&rdquo; September&nbsp;2001.</span><span>)</span></a>, then use SHA-256 <a class='info' href='#FIPS-180-2'>[FIPS&#8209;180&#8209;2]<span> (</span><span class='info'>United States of America, 			    National Institute of Standards and 			    Technology, &ldquo;Secure Hash Standard (Federal Information 			Processing Standard (FIPS) 180-2,&rdquo; .</span><span>)</span></a>, otherwise use the
			certificate's signature hash algorithm.
			<br />
<br />

			The reason for using a hash of the certificate
			is that some implementations need to track the
			channel binding of a TLS session in kernel-mode
			memory, which is often at a premium.
</li>
<li>Intended usage: COMMON
</li>
<li>Person and email address to contact for further
			information: Larry Zhu (lzhu@microsoft.com),
			Nicolas Williams (Nicolas.Williams@sun.com).
</li>
<li>Owner/Change controller name and email address:
			IESG.
</li>
<li>Expert reviewer name and contact information:
			IETF (ietf@ietf.org)
</li>
<li>Note: This channel binding is only suitable for
			use with PKIX server certificates <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>, not OpenPGP certificates
			<a class='info' href='#RFC5081'>[RFC5081]<span> (</span><span class='info'>Mavrogiannopoulos, N., &ldquo;Using OpenPGP Keys for Transport Layer Security (TLS) Authentication,&rdquo; November&nbsp;2007.</span><span>)</span></a> <a class='info' href='#RFC4880'>[RFC4880]<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</li>
<li>Note: see the published specification for advice
			on the applicability of this channel binding
			type.
</li>
</ul><p>

	    
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
The 'tls-unique-for-telnet' Channel Binding Type</h3>

<p>IANA is hereby directed to update the registration of the
		'tls-unique-for-telnet' channel binding type to match
		the following.  Note that the only material changes from
		the original registration should be: the "owner" (now
		the IESG), the contacts, the published specfication, and
		a note indicating that the published specification
		should be consulted for applicability advice.  The
		description is also clarified.  We also moved security
		considerations notes to the security considerations
		section of this document.  All other fields of the
		registration are copied here for the convenience of
		readers.
</p>
<p>

		</p>
<ul class="text">
<li>Channel binding unique prefix: tls-unique-for-telnet
</li>
<li>Channel binding type: unique
</li>
<li>Channel type: TLS <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>
</li>
<li>Published specification: &lt;this document&gt;
</li>
<li>Channel binding is secret: no
</li>
<li>Description: There is a proposal for adding a
			"StartTLS" extension to TELNET, and a channel
			binding extension for the various TELNET AUTH
			mechanisms whereby each side sends the other a
			"checksum" (MAC) of their view of the channel's
			bindings. The client uses the first TLS Finished
			messages (note: the Finished struct) from the
			client and server, each concatenated in that
			order and in their clear text form. The server
			does the same but in the opposite concatenation
			order (server, then client).
</li>
<li>Intended usage: COMMON
</li>
<li>Person and email address to contact for further
			information: Jeff Altman
			(jaltman@secure-endpoints.com), Nicolas Williams
			(Nicolas.Williams@sun.com).
</li>
<li>Owner/Change controller name and email address:
			IESG.
</li>
<li>Expert reviewer name and contact information: IETF
			(ietf@ietf.org)
</li>
<li>Note: see the published specification for advice
			on the applicability of this channel binding
			type.
</li>
</ul><p>

	    
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Applicability of TLS Channel Binding Types</h3>

<p>The 'tls-unique-for-telnet' channel binding type is only
		applicable to TELNET <a class='info' href='#RFC0854'>[RFC0854]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;Telnet Protocol Specification,&rdquo; May&nbsp;1983.</span><span>)</span></a>.
</p>
<p>The 'tls-unique' channel binding type is always available
		for TLS connections, while 'tls-server-end-point' is
		only available when TLS cipher suites with server
		certificates are used.  Therefore 'tls-unique' is
		generally better than 'tls-server-end-point'.  However,
		'tls-server-end-point' may be used with existing TLS
		server-side proxies ("concentrators") without
		modification to the proxies, whereas 'tls-unique' may
		require firmware or software updates to server-side
		proxies.  Therefore there are cases where
		'tls-server-end-point' may interoperate but where
		'tls-unique' may not.
</p>
<p>In other words, for many applications there may be two
		potentially applicable TLS channel binding types.
		Channel binding is all or nothing for the GSS-API <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a>, and likely other frameworks.
		Therefore agreement on the use of channel
		binding, and a particular channel binding type is
		necessary.  Such agreement can be a priori or
		negotiated.
</p>
<p>The specifics of whether and how to negotiate channel
		binding types are beyond the scope of this document.
		However, it is RECOMMENDED that application protocols
		making use of TLS channel bindings, use 'tls-unique'
		exclusively, except, perhaps, where server-side proxies
		are common in deployments of an application protocol.
		In the latter case an application protocol MAY specify
		that 'tls-server-end-point' channel bindings must be
		used when available, with 'tls-unique' being used when
		'tls-server-end-point' channel bindings are not
		available.  Alternatively, the application may negotiate
		which channel binding type to use, or may make the
		choice of channel binding type configurable.
</p>
<p>Specifically, application protocol specifications MUST
		indicate at least one mandatory to implement channel
		binding type, MAY specify a negotiation protocol, MAY
		allow for out-of-band negotiation or configuration, and
		SHOULD prefer 'tls-unique' over
		'tls-server-end-point'.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Required Application Programming Interfaces</h3>

<p>TLS implementations supporting the use of 'tls-unique'
		and/or 'tls-unique-for-telnet' channel binding types,
		MUST provide application programming interfaces by which
		applications may obtain the channel bindings for a TLS
		connection.  An implementation MAY provide interfaces
		for obtaining the initial Finished messages of a
		connection separately, letting TELNET <a class='info' href='#RFC0854'>[RFC0854]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;Telnet Protocol Specification,&rdquo; May&nbsp;1983.</span><span>)</span></a> construct 'tls-unique-for-telnet'
		channel bindings from those, or the implementation MAY
		provide an interface specifically for extracting channel
		bindings data from a connection, and for a given channel
		binding type.
</p>
<p>TLS implementations supporting the use of
		'tls-server-end-point' channel bindings MUST provide
		application programming interfaces to obtain this
		channel binding.  Such an interface SHOULD produce the
		'tls-server-end-point' channel bindings data directly,
		but MAY produce the certificate of the server for the
		connection instead, as it appears, octet for octet, in
		the server's Certificate message.  When a connection
		results from TLS session resumption, the implementation
		may need to have cached the server certificate from the
		original connection, but MAY return an error instead of
		the channel binding or server certificate.  Applications
		wishing to use 'tls-server-end-point' channel bindings
		and TLS session resumption MUST be prepared to handle
		the unavailability of 'tls-server-end-point' channel
		bindings in the case of TLS session resumption.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>The IANA is hereby directed to update three existing
		channel binding type registrations.  See the rest of
		this document.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>The Security Considerations section of <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a> applies to this document.
</p>
<p>The TLS Finished messages (see section 7.4.9 of <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>) are known to both endpoints of a
		TLS connection, and are cryptographycally bound to it.
		Therefore the TLS Finished messages can be safely used
		as a channel binding provided that the authentication
		mechanism doing the channel binding conforms to the
		requirements in <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</p>
<p>The server certificate, when present, is also
		cryptographically bound to the TLS connection through
		its use in key transport and/or authentication of the
		server (either by dint of its use in key transport, by
		its use in signing key agreement, or by its use in key
		agreement).  Therefore the server certificate is
		suitable as an end-point channel binding as described in
		<a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Cryptographic Algorithm Agility</h3>

<p>The 'tls-unique' and 'tls-unique-for-telnet' channel
		    binding types do not add any use of cryptography
		    beyond that used by TLS itself.  Therefore these two
		    channel binding types add no considerations with
		    respect to cryptographic algorithm agility.
</p>
<p>The 'tls-server-end-point' channel binding type
		    consist of a hash of a server certificate.  This use
		    of a hash algorithm is above and beyond TLS's use of
		    cryptography, therefore the 'tls-server-end-point'
		    channel binding type has a security consideration
		    with respect to hash algorithm agility.  The
		    algorithm to be used, however, is derived from the
		    certificate itself: use SHA-256 if the certificate
		    uses MD5 or SHA-1, else use whatever hash function
		    the certificate uses.  This construction
		    automatically makes 'tls-server-end-point' hash
		    algorithm agile.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
On Disclosure of Channel Bindings Data by
		Authentication Mechanisms</h3>

<p>When these channel binding types were first
		    considered, one issue that some commenters were
		    concerned about was the possible impact on the
		    security of the TLS channel, of disclosure of the
		    channel bindings data by authentication mechanisms.
		    This can happen, for example, when an authentication
		    mechanism transports the channel bindings data, with
		    no confidentiality protection, over other transports
		    (for example, in communicating with a trusted third
		    party), or when the TLS channel provides no
		    confidentiality protection and the authentication
		    mechanism does not protect the confidentiality of
		    the channel bindings data.  This section considers
		    that concern.
</p>
<p>When the TLS connection uses a cipher suite that does
		    not provide confidentiality protection, the TLS
		    Finished messages will be visible to eavesdroppers,
		    regardless of what the authentication mechanism
		    does.  The same is true of the server certificate
		    which, in any case, is generally visible to
		    eavesdroppers.  Therefore we must consider our
		    choices of TLS channel bindings here to be safe to
		    disclose by definition -- if that were not the case
		    then TLS with cipher suites that don't provide
		    confidentiality protection would be unsafe.
		    Furthermore, the TLS Finished message construction
		    depends on the security of the TLS PRF, which in
		    turn needs to be resistant to key recovery attacks,
		    and we think that it is, as it is based on HMAC, and
		    the master secret is, well, secret (and the result
		    of key exchange).
</p>
<p>Note too that in the case of an attempted active
		    man-in-the-middle attack, the attacker will already
		    possess knowledge of the TLS finished messages for
		    both inbound and outbound TLS channels (which will
		    differ, given that the attacker cannot force them to
		    be the same).  No additional information is obtained
		    by the attacker from the authentication mechanism's
		    disclosure of channel bindings data -- the attacker
		    already has it, even when cipher suites providing
		    confidentiality protection are provided.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5056">[RFC5056]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>,&rdquo; RFC&nbsp;5056, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5056.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Normative References for 'tls-server-end-point'</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS-180-2">[FIPS-180-2]</a></td>
<td class="author-text">United States of America,
			    National Institute of Standards and
			    Technology, &ldquo;<a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf">Secure Hash Standard (Federal Information
			Processing Standard (FIPS) 180-2</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5280">[RFC5280]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5280.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.3.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC0854">[RFC0854]</a></td>
<td class="author-text">Postel, J. and J. Reynolds, &ldquo;<a href="http://tools.ietf.org/html/rfc854">Telnet Protocol Specification</a>,&rdquo; STD&nbsp;8, RFC&nbsp;854, May&nbsp;1983 (<a href="http://www.rfc-editor.org/rfc/rfc854.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1321">[RFC1321]</a></td>
<td class="author-text"><a href="mailto:rivest@theory.lcs.mit.edu">Rivest, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1321">The MD5 Message-Digest Algorithm</a>,&rdquo; RFC&nbsp;1321, April&nbsp;1992 (<a href="http://www.rfc-editor.org/rfc/rfc1321.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2743">[RFC2743]</a></td>
<td class="author-text"><a href="mailto:jlinn@rsasecurity.com">Linn, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2743">Generic Security Service Application Program Interface Version 2, Update 1</a>,&rdquo; RFC&nbsp;2743, January&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2743.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3174">[RFC3174]</a></td>
<td class="author-text">Eastlake, D. and P. Jones, &ldquo;<a href="http://tools.ietf.org/html/rfc3174">US Secure Hash Algorithm 1 (SHA1)</a>,&rdquo; RFC&nbsp;3174, September&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3174.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4880">[RFC4880]</a></td>
<td class="author-text">Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R. Thayer, &ldquo;<a href="http://tools.ietf.org/html/rfc4880">OpenPGP Message Format</a>,&rdquo; RFC&nbsp;4880, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4880.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5081">[RFC5081]</a></td>
<td class="author-text">Mavrogiannopoulos, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5081">Using OpenPGP Keys for Transport Layer Security (TLS) Authentication</a>,&rdquo; RFC&nbsp;5081, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5081.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jeff
	    Altman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Secure Endpoints</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">255 W 94TH ST PHB</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">New York, NY  10025</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jaltman@secure-endpoints.com">jaltman@secure-endpoints.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nicolas
	    Williams</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sun Microsystems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5300 Riata Trace Ct</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Austin, TX  78727</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Nicolas.Williams@sun.com">Nicolas.Williams@sun.com</a></td></tr>
</table>
</body></html>
