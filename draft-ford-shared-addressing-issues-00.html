<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Issues with ISP Responses to IPv4 Address
      Exhaustion</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Issues with ISP Responses to IPv4 Address
      Exhaustion">
<meta name="keywords" content="IPv4 address exhaustion completion shared">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Internet Engineering Task Force</td><td class="header">A. Durand</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Comcast</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">M. Ford</td></tr>
<tr><td class="header">Expires: September 4, 2009</td><td class="header">P. Roberts</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Internet Society</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 03, 2009</td></tr>
</table></td></tr></table>
<h1><br />Issues with ISP Responses to IPv4 Address
      Exhaustion<br />draft-ford-shared-addressing-issues-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 4, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>The looming completion of IPv4 address allocations from IANA and the RIRs is already
        causing ISPs around the world to start to question how they will continue providing IPv4
        service to IPv4-speaking customers when there are no longer sufficient IPv4 addresses to
        allocate them one per customer. Several possible solutions to this problem are now emerging
        and this memo identifies important criteria to be borne in mind when evaluating these
        solutions. We also seek to identify serious issues that remain even when mechanisms meeting
        our criteria are adopted. We wish to stress that these solutions have a number of common,
        and potentially serious, issues.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Guiding principles<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
IPv6 is the goal<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Criteria for judging ISP responses<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Potential responses<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.3.1.</a>&nbsp;
Obtaining previously-allocated addresses<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.3.2.</a>&nbsp;
Deploy CGN, allocate private addresses<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.3.3.</a>&nbsp;
Shared address solutions<br />
<a href="#anchor9">3.</a>&nbsp;
Issues with shared address solutions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.1.</a>&nbsp;
Port Distribution, Port Reservation, Port Negotiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.2.</a>&nbsp;
Connection to a Well-Known Port Number<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.3.</a>&nbsp;
Universal Plug and Play<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Security and Subscriber Identification with IPv4">3.4.</a>&nbsp;
Security and Subscriber Identification with IPv4<br />
<a href="#anchor13">4.</a>&nbsp;
Concluding remarks<br />
<a href="#Acknowledgements">5.</a>&nbsp;
Acknowledgements<br />
<a href="#IANA">6.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">7.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Allocations of IPv4 addresses from the Internet Assigned Numbers Authority (IANA) are
        currently forecast to be complete during the first half of 2011 <a class='info' href='#IPv4_Report'>[IPv4_Report]<span> (</span><span class='info'>Huston, G., &ldquo;IPv4 Address Report,&rdquo; 2009.</span><span>)</span></a>. Allocations from the Regional Internet Registries (RIRs) are anticipated to be complete
        around a year later, although the exact date will vary from registry to registry. This is
        already causing ISPs around the world to start to question how they will continue providing
        IPv4 service to IPv4-speaking customers when there are no longer sufficient IPv4 addresses
        to allocate them one per customer. Several possible solutions to this problem are now
        emerging and the following discussion identifies important criteria to be borne in mind when
        evaluating the merits and demerits of these solutions. These criteria are derived from the
        development and acceptance of a modern understanding and consistent implementation of the
        end-to-end principle of the Internet.
</p>
<p>This memo is divided into two principal sections. The first deals with what we consider to
        be guiding principles that it is important to bear in mind when evaluating address-sharing
        proposals. The second section is concerned with identifying and discussing the operational
        implications of adopting any address-sharing mechanism. We wish to stress that these
        solutions have a number of common, and potentially serious, issues. Address sharing amongst
        multiple subscribers will inevitably result in a degraded experience of the network for many
        users, and increased operating costs for ISPs. Content providers are encouraged to consider
        carefully the potential impact of shared-addressing on their business and operational
        practices.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Guiding principles</h3>

<p>"The end-to-end principle is the core architectural guideline of the Internet." Section 2
        of <a class='info' href='#RFC3724'>RFC&nbsp;3724<span> (</span><span class='info'>Kempf, J., Austein, R., and IAB, &ldquo;The Rise of the Middle and the Future of End-to-End: Reflections on the Evolution of the Internet Architecture,&rdquo; March&nbsp;2004.</span><span>)</span></a> [RFC3724] provides a concise history of the
        end-to-end principle. While the original articulation was concerned with where best to place
        functionality in a communication system, the growth and development of the Internet has
        resulted in an expansion of the scope of the end-to-end principle so that it now encompasses
        the question of where best to locate the state associated with Internet applications. This
        expanded principle is well-articulated in <a class='info' href='#RFC1958'>RFC&nbsp;1958<span> (</span><span class='info'>Carpenter, B., &ldquo;Architectural Principles of the Internet,&rdquo; June&nbsp;1996.</span><span>)</span></a> [RFC1958],
          </p>
<blockquote class="text">
<p>"An end-to-end protocol design should not rely on the maintenance of state (i.e.,
            information about the state of the end-to-end communication) inside the network. Such
            state should be maintained only in the endpoints, in such a way that the state can only
            be destroyed when the endpoint itself breaks (known as fate-sharing)."
</p>
</blockquote><p>
      
</p>
<p>The end-to-end principle is arguably the fundamental principle of the Internet
        architecture. In a sense the Internet is the embodiment of the principle. By allowing either
        tacit or explicit erosion of the principle as we apply our understanding to the construction
        and operation of the global network, we allow the dismantling of the utility itself.
        Unfortunately the approaches being proposed to address the looming IPv4 address shortage
        threaten just such erosion.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
IPv6 is the goal</h3>

<p>While we are discussing solutions to allow continued operation of the IPv4 Internet and
          the continued provision of services to IPv4-speaking customers, it is absolutely not the
          intention of this discussion to in any way advocate the prolongation of the life of IPv4
          or to (further) delay the widespread adoption of IPv6. Rather, the discussion herein is
          intended to guide reactions to proposals that are being made as a pragmatic response to
          some very real problems looming for operators who need to be able to continue providing
          service to customers who do not have any IPv6 capable equipment and/or who want to access
          services that are only available via IPv4.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Criteria for judging ISP responses</h3>

<p>On that basis, we believe that solutions to the problem of continuing to provide IPv4
          service post-IPv4-address-completion should be judged on two primary criteria: </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>1) The proximity of the end user to control over the impact of the solution on the
              end-to-end communication, and;
</dd>
<dt></dt>
<dd>2) The extent to which the solution affords a natural progression to widespread IPv6
              deployment.
</dd>
</dl></blockquote>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Potential responses</h3>

<p>Assuming ISPs wish to continue growing their businesses post-IPv4-address-completion
          there are a number of possible responses they can take: </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>o Obtain previously-allocated IPv4 addresses through some unspecified means
</dd>
<dt></dt>
<dd>o Deploy CGN and allocate customers with private addresses
</dd>
<dt></dt>
<dd>o Deploy a shared-address solution - customers get public addresses with fewer
              available ports
</dd>
</dl></blockquote><p>Let's deal with each of these in turn.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1"></a><h3>2.3.1.&nbsp;
Obtaining previously-allocated addresses</h3>

<p>Acquisition of previously-allocated IPv4 addresses by whatever means is a strategy with
            currently unknown (but definitely limited) viability. It is also impossible to estimate
            in advance the cost of such an approach, so it does nothing to minimise business risk.
            Acquiring previously-allocated addresses may provide a short-term tactical solution
            where a relatively small number of addresses are required urgently to address a specific
            need. It cannot be a solution for long-term network business growth. It is likely that
            previously-allocated blocks acquired by whatever means will be small and obtaining lots
            of contiguous small blocks may be impossible. This would inevitably lead to operational
            complexity and associated cost for the network taking this approach. It is operationally
            unsustainable in anything but the short term.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2"></a><h3>2.3.2.&nbsp;
Deploy CGN, allocate private addresses</h3>

<p>In light of the two criteria for judging solutions to the address allocation completion
            problem that we identified above, so-called 'carrier-grade' NAT (CGN) proposals <a class='info' href='#I-D.nishitani-cgn'>[I&#8209;D.nishitani&#8209;cgn]<span> (</span><span class='info'>Yamagata, I., Nishitani, T., Miyakawa, S., Nakagawa, A., and H. Ashida, &ldquo;Common requirements for IP address sharing schemes,&rdquo; March&nbsp;2010.</span><span>)</span></a> raise several issues. Centralisation of NAT functionality
            in the network core will reduce the ability of end-users to deploy applications as they
            wish without reference to the network operator. This means that unadorned CGN solutions
            will struggle to meet the first criterion. Providing mechanisms for end-users to control
            their treatment by the CGN may go some way to mitigate this concern, however those
            mechanisms would need to be very carefully engineered to avoid raising additional
            scalability and resilience concerns of their own. CGNs may create a single point of
            failure for all their clients and decrease the resilience of the network from an
            end-user's perspective. CGN implementations may also struggle when considering our
            second criterion as there is no requirement to make use of IPv6 technology as part of
            the solution. For these reasons there is a real risk that CGNs will do nothing to
            progress the state of IPv6 deployment and will only serve to degrade the utility of the
            current network.
</p>
<p>While the subject of CGN deployment has arisen recently in the context of IPv4 address
            depletion, some operators, particularly mobile network operators, have a long history of
            allocating private addresses to their subscribers. Recent discussions have indicated
            that the increasing sophistication of both mobile handsets and the applications that run
            on them is driving operators of mobile networks towards public addressing solutions,
            including IPv6 deployment, to improve scalability and minimise operating expenses. This
            suggests that those operators with real-world experience of CGN technology are already
            choosing to migrate away from it as a solution to their addressing needs.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.3"></a><h3>2.3.3.&nbsp;
Shared address solutions</h3>

<p>How could we do better? There are proposals currently in the IETF that address one or
            both of the criteria we identify as critical. These alternative proposals are simplified
            by using IPv6 as a transport substrate for the legacy traffic <a class='info' href='#I-D.durand-softwire-dual-stack-lite'>[I&#8209;D.durand&#8209;softwire&#8209;dual&#8209;stack&#8209;lite]<span> (</span><span class='info'>Durand, A., Droms, R., Haberman, B., and J. Woodyatt, &ldquo;Dual-stack lite broadband deployments post IPv4 exhaustion,&rdquo; November&nbsp;2008.</span><span>)</span></a>, thereby motivating IPv6 deployment,
            and may also ensure that control over the fate of end-user applications is kept as close
            to the end-user as possible by distributing the NAT functionality towards the CPE <a class='info' href='#I-D.ymbk-aplusp'>[I&#8209;D.ymbk&#8209;aplusp]<span> (</span><span class='info'>Bush, R., &ldquo;The A+P Approach to the IPv4 Address Shortage,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</p>
<p>However, some reduction of utility for IPv4-speaking Internet users is unavoidable in
            the future. It is inevitable that a reduced number of ports will be available for
            individual end-user applications. Running servers on well-known ports will most probably
            be an activity that is restricted to users willing to pay a premium for a higher tier of
            service contract. These may turn out to be good incentives for end-users to migrate to
            IPv6. 
</p>
<p>The remainder of this memo deals with issues that arise when shared address solutions
            are deployed by ISPs.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Issues with shared address solutions</h3>

<p>A number of proposals currently under consideration for standardization or contribution to
        some future standard rely upon the concept of address sharing across multiple subscribers to
        achieve their goals. These proposals include Carrier Grade NAT <a class='info' href='#I-D.nishitani-cgn'>[I&#8209;D.nishitani&#8209;cgn]<span> (</span><span class='info'>Yamagata, I., Nishitani, T., Miyakawa, S., Nakagawa, A., and H. Ashida, &ldquo;Common requirements for IP address sharing schemes,&rdquo; March&nbsp;2010.</span><span>)</span></a>, Dual-Stack-Lite <a class='info' href='#I-D.durand-softwire-dual-stack-lite'>[I&#8209;D.durand&#8209;softwire&#8209;dual&#8209;stack&#8209;lite]<span> (</span><span class='info'>Durand, A., Droms, R., Haberman, B., and J. Woodyatt, &ldquo;Dual-stack lite broadband deployments post IPv4 exhaustion,&rdquo; November&nbsp;2008.</span><span>)</span></a>, NAT64 <a class='info' href='#I-D.bagnulo-behave-nat64'>[I&#8209;D.bagnulo&#8209;behave&#8209;nat64]<span> (</span><span class='info'>Bagnulo, M., Matthews, P., and I. Beijnum, &ldquo;NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4  Servers,&rdquo; March&nbsp;2009.</span><span>)</span></a>, IVI <a class='info' href='#I-D.baker-behave-ivi'>[I&#8209;D.baker&#8209;behave&#8209;ivi]<span> (</span><span class='info'>Li, X., Bao, C., Baker, F., and K. Yin, &ldquo;IVI Update to SIIT and NAT-PT,&rdquo; September&nbsp;2008.</span><span>)</span></a>,
        Address+Port proposals <a class='info' href='#I-D.ymbk-aplusp'>[I&#8209;D.ymbk&#8209;aplusp]<span> (</span><span class='info'>Bush, R., &ldquo;The A+P Approach to the IPv4 Address Shortage,&rdquo; October&nbsp;2009.</span><span>)</span></a>, and SAM <a class='info' href='#I-D.despres-sam'>[I&#8209;D.despres&#8209;sam]<span> (</span><span class='info'>Despres, R., &ldquo;Scalable Multihoming across IPv6 Local-Address Routing Zones Global-Prefix/Local-Address Stateless Address Mapping (SAM),&rdquo; July&nbsp;2009.</span><span>)</span></a>.
</p>
<p>In many operator networks today a subscriber receives a single public IPv4 address at their
        home or small business. Within that home or small business there is a NAT function that
        issues private addresses (RFC1918 addresses) to devices within the home. All of those
        devices share the single public IPv4 address and they are all associated with a single small
        set of users, and a single operator subscriber account.
</p>
<p>With these new proposals a single public IPv4 address would be shared by a number of homes
        or small businesses (i.e. multiple subscribers) so the operational paradigm described above
        would no longer apply.
</p>
<p>All the proposals listed above share a number of technical or operational issues and these
        are addressed in the subsections that follow. 
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Port Distribution, Port Reservation, Port Negotiation</h3>

<p>When we talk about port numbers we need to make a distinction between outgoing
          connections and incoming connections. For outgoing connections, the actual source port
          number used is usually irrelevant. But for incoming connections, the specific port numbers
          allocated to customers matter because they are part of external referrals (used by third
          parties to contact services run by the customers). It is desirable to make sure those
          incoming ports remain stable over time. This is challenging as the network doesn't know
          anything in particular about the applications which it is supporting and therefore has no
          real notion of how long an application/service session is still ongoing and therefore
          requiring port stability.
</p>
<p>According to actual measurements the average number of outgoing ports per customer is
          much, much smaller than the maximum number of ports a customer can use at any given time.
          However, the distribution is heavy-tailed, so there are typically a small number of
          subscribers who use a very high number of ports <a class='info' href='#CGN_Viability'>[CGN_Viability]<span> (</span><span class='info'>Alcock, S., &ldquo;Research into the Viability of Service-Provider NAT,&rdquo; 2008.</span><span>)</span></a>. This means
          that an algorithm that dynamically allocates outgoing port numbers from a central pool is
          much more efficient than algorithms that statically divide the resource by pre-allocating
          a fixed number of ports to each subscriber. Similarly, such an algorithm should be more
          able to accommodate users wishing to use a relatively high number of ports.
</p>
<p>Early measurements also seem to indicate that, on average, only very few ports are used
          by customers for incoming connections. However, a majority of subscribers accept at least
          one inbound connection.
</p>
<p>This means that it is not necessary to pre-allocate a large number of ports to each
          subscriber, but that it is possible to either pre-allocate a small number of ports for
          incoming connections or do port allocation on demand when the application wishing to
          receive a connection is initiated and reserve the bulk of ports as a centralized resource
          shared by all subscribers using a given public IPv4 address.
</p>
<p>A potential problem with this approach occurs when one of the subscriber devices behind
          such a port-shared IPv4 address becomes infected with a worm, which then quickly sets
          about opening many outbound connections in order to propagate itself. Such an infection
          could rapidly exhaust the shared resource of the single IPv4 address for all connected
          subscribers. Poor network hygiene of one subscriber now threatens the connectivity for all
          immediate network neighbors.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Connection to a Well-Known Port Number</h3>

<p>Once a port address-mapping scheme is in place, connections to well-known port numbers
          will not work in the general case. Some workaround (e.g. redirects to a port-specific URL)
          could always be deployed given sufficient incentives. There exist several proposals for
          'application service location' protocols which would provide a means of addressing this
          problem, but historically these proposals have not gained much deployment traction.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Universal Plug and Play</h3>

<p>Using the UPnP semantic, a client is asking "I want to use port number X, is that ok?"
          and the answer is yes or no. If the answer is no, the client will typically try the next
          port, until it either finds one that works or gives up after a limited number of attempts.
          UPnP has, currently, no way to redirect the client to use another port number.
</p>
<p>NAT-PMP has a better semantic here, enabling the NAT to redirect the client to an
          available port number.
</p>
<a name="Security and Subscriber Identification with IPv4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Security and Subscriber Identification with IPv4</h3>

<p>When an abuse is reported today, it is usually done in the form: IPv4 address X has done
          something bad at time T0. This is not enough information to uniquely identify the
          subscriber responsible for the abuse when that IPv4 address is shared by more than one
          subscriber. This particular issue can be fixed by logging port numbers.
</p>
<p>A number of application servers on the network today log IPv4 addresses in connection
          attempts to protect themselves from certain attacks. For example, if a server sees too
          many login attempts from the same IPv4 address, it may decide to put that address in a
          penalty box for a certain time. If an IPv4 address is shared by multiple subscribers, this
          would have unintended consequences in a couple of ways. First it may become the natural
          behavior to see many login attempts from the same address because it is now shared across
          a potentially large number of users. Second and more likely is that one user who fails a
          number of login attempts may block out other users who have not made any previous attempts
          but who will now fail on their first attempt.
</p>
<p>Moreover, the assumption that a single IPv4 address maps to a single user may be used for
          other purposes like geolocation, counting the number of individual users of a service,
          etc. All those things may become more complicated when an IPv4 address is shared by
          several subscribers at the same time.
</p>
<p>To some extent these problems of shared addressing are already with us due to the
          prevalence of dyamically assigned addresses to domestic broadband subscribers and the use
          of CPE NAT, but the point we wish to make here is that the widespread adoption of
          port-shared addresses by service providers will make these complications considerably more
          widespread and severe.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Concluding remarks</h3>

<p>Of the various options that are now available to service providers as we approach the
        completion of IPv4 address allocations from the IANA, there are some shared-address
        solutions that seem to offer an approach consistent with a long-term goal of IPv6 deployment
        and maximal preservation of the end-to-end principle. Nevertheless, it must be stressed that
        these solutions have a number of common, and potentially serious, issues. Address sharing
        amongst multiple subscribers will inevitably result in a degraded experience of the network
        for many users, and increased operating costs for ISPs. Content providers are encouraged to
        consider carefully the potential impact of shared-addressing on their business and
        operational practices.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Acknowledgements</h3>

<p>This memo was largely inspired by conversations that took place as part of an Internet
        Society hosted roundtable event for operators deploying IPv6. Participants in that
        discussion included John Brzozowski, Leslie Daigle, Tom Klieber, Yiu Lee, Kurtis Lindqvist, Wes George, and Christian Jacquenet.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This memo includes no request to IANA.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p><a class='info' href='#Security and Subscriber Identification with IPv4'>Section&nbsp;3.4<span> (</span><span class='info'>Security and Subscriber Identification with IPv4</span><span>)</span></a> discusses some of the security and identity-related implications of address sharing.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="CGN_Viability">[CGN_Viability]</a></td>
<td class="author-text">Alcock, S., &ldquo;Research into the Viability of Service-Provider NAT,&rdquo; 2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.bagnulo-behave-nat64">[I-D.bagnulo-behave-nat64]</a></td>
<td class="author-text">Bagnulo, M., Matthews, P., and I. Beijnum, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-bagnulo-behave-nat64-03.txt">NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4  Servers</a>,&rdquo; draft-bagnulo-behave-nat64-03 (work in progress), March&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-bagnulo-behave-nat64-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.baker-behave-ivi">[I-D.baker-behave-ivi]</a></td>
<td class="author-text">Li, X., Bao, C., Baker, F., and K. Yin, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-baker-behave-ivi-01.txt">IVI Update to SIIT and NAT-PT</a>,&rdquo; draft-baker-behave-ivi-01 (work in progress), September&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-baker-behave-ivi-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.despres-sam">[I-D.despres-sam]</a></td>
<td class="author-text">Despres, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-despres-sam-03.txt">Scalable Multihoming across IPv6 Local-Address Routing Zones Global-Prefix/Local-Address Stateless Address Mapping (SAM)</a>,&rdquo; draft-despres-sam-03 (work in progress), July&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-despres-sam-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.durand-softwire-dual-stack-lite">[I-D.durand-softwire-dual-stack-lite]</a></td>
<td class="author-text">Durand, A., Droms, R., Haberman, B., and J. Woodyatt, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-durand-softwire-dual-stack-lite-01.txt">Dual-stack lite broadband deployments post IPv4 exhaustion</a>,&rdquo; draft-durand-softwire-dual-stack-lite-01 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-durand-softwire-dual-stack-lite-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.nishitani-cgn">[I-D.nishitani-cgn]</a></td>
<td class="author-text">Yamagata, I., Nishitani, T., Miyakawa, S., Nakagawa, A., and H. Ashida, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-nishitani-cgn-04.txt">Common requirements for IP address sharing schemes</a>,&rdquo; draft-nishitani-cgn-04 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-nishitani-cgn-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ymbk-aplusp">[I-D.ymbk-aplusp]</a></td>
<td class="author-text">Bush, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ymbk-aplusp-05.txt">The A+P Approach to the IPv4 Address Shortage</a>,&rdquo; draft-ymbk-aplusp-05 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ymbk-aplusp-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IPv4_Report">[IPv4_Report]</a></td>
<td class="author-text">Huston, G., &ldquo;<a href="http://www.potaroo.net/tools/ipv4/index.html">IPv4 Address Report</a>,&rdquo; 2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1958">[RFC1958]</a></td>
<td class="author-text"><a href="mailto:brian@dxcoms.cern.ch">Carpenter, B.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1958">Architectural Principles of the Internet</a>,&rdquo; RFC&nbsp;1958, June&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1958.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3724">[RFC3724]</a></td>
<td class="author-text">Kempf, J., Austein, R., and IAB, &ldquo;<a href="http://tools.ietf.org/html/rfc3724">The Rise of the Middle and the Future of End-to-End: Reflections on the Evolution of the Internet Architecture</a>,&rdquo; RFC&nbsp;3724, March&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3724.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alain Durand</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Comcast</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Alain_Durand@cable.comcast.com">Alain_Durand@cable.comcast.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mat Ford</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Internet Society</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Geneva</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Switzerland</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ford@isoc.org">ford@isoc.org</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Phil Roberts</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Internet Society</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Reston, VA</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:roberts@isoc.org">roberts@isoc.org</a></td></tr>
</table>
</body></html>
