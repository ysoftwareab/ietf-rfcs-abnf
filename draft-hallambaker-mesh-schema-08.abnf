alg =           UdfAlg (PIN)
pinData =       UdfBDS (PIN)
saltedPINData = MAC (Action, pinData)
saltedPIN =     UDFPresent (HMAC_SHA_2_512 + saltedPINData)
PinId =         UDFPresent (MAC (Account, saltedPINData))

witnessData =   Account.ToUTF8() + ClientNonce + PayloadDigest
witnessValue =  MAC (witnessData , saltedPINData)
pin = AAJP-KPYV-NSB4-GIYL-AM
action = message.

alg = UdfAlg (PIN)
       = Authenticator_HMAC_SHA_2_512

hashalg = default (alg, HMAC_SHA_2_512)

pinData = UdfBDS (PIN)
       = System.Byte[]

saltedPIN = UDFPresent (hashalg + saltedPINData)
       = ADBB-JTKR-RGGL-ACEM-TW6E-ZFY6-NQXF

Account =  alice@example.com

PinId = UDFPresent (MAC (Account, saltedPINData))
       = ADVR-47UA-ZHDX-6CFS-GDDD-RYTA-LSB6

