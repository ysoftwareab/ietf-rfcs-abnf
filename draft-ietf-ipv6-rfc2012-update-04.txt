IPv6 MIB Revision Design Team                             Bill Fenner
INTERNET-DRAFT                                          AT&T Research
Expires: March 2004                                  Keith McCloghrie
                                          Rajiv Raghunarayan (Editor)
                                                        Cisco Systems
                                                 Juergen Schoenwalder
                                                      TU Braunschweig
                                                       September 2003


                      Management Information Base
              for the Transmission Control Protocol (TCP)
                 draft-ietf-ipv6-rfc2012-update-04.txt

Status of this Document

This document is an Internet-Draft and is in full conformance with all
provisions of Section 10 of RFC2026.

Internet-Drafts are working documents of the Internet Engineering Task
Force (IETF), its areas, and its working groups.  Note that other 
groups may also distribute working documents as Internet-Drafts.

Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any
time.  It is inappropriate to use Internet-Drafts as reference material
or to cite them other than as "work in progress."

The list of current Internet-Drafts can be accessed at
http://www.ietf.org/ietf/1id-abstracts.txt

The list of Internet-Draft Shadow Directories can be accessed at
http://www.ietf.org/shadow.html.

This document is a product of the IPv6 MIB Revision Design Team.
Comments should be addressed to the editor/authors or the mailing 
list at ipng@sunroof.eng.sun.com.

Copyright Notice

Copyright (C) The Internet Society (2001). All Rights Reserved.



                                Abstract

This memo defines a portion of the Management Information Base (MIB) 
for use with network management protocols in the Internet community.  
In particular, it describes managed objects used for implementations 
of the Transmission Control Protocol (TCP) in an IP version 
independent manner. This memo obsoletes RFCs 2012 and 2452.






Raghunarayan, Editor                                           [Page 1]

INTERNET-DRAFT             Expires: March 2004           September 2003


                           Table of Contents


1. The Internet-Standard Management Framework  . . . . . . . . . .    2
2. Revision History. . . . . . . . . . . . . . . . . . . . . . . .    2
3. Overview. . . . . . . . . . . . . . . . . . . . . . . . . . . .    6
4. Definitions . . . . . . . . . . . . . . . . . . . . . . . . . .    7
5. Acknowledgements. . . . . . . . . . . . . . . . . . . . . . . .   22
6. Normative References. . . . . . . . . . . . . . . . . . . . . .   22
7. Informative References. . . . . . . . . . . . . . . . . . . . .   22
8. Security Considerations . . . . . . . . . . . . . . . . . . . .   23
9. Editor's Address. . . . . . . . . . . . . . . . . . . . . . . .   24
10. Authors. . . . . . . . . . . . . . . . . . . . . . . . . . . .   24
11. Full Copyright Statement . . . . . . . . . . . . . . . . . . .   25


1.  The Internet-Standard Management Framework

   For a detailed overview of the documents that describe the current
   Internet-Standard Management Framework, please refer to section 7 of
   RFC 3410 [RFC3410].

   Managed objects are accessed via a virtual information store, termed
   the Management Information Base or MIB.  MIB objects are generally
   accessed through the Simple Network Management Protocol (SNMP).
   Objects in the MIB are defined using the mechanisms defined in the
   Structure of Management Information (SMI).  This memo specifies a
   MIB module that is compliant to the SMIv2, which is described in
   STD 58, RFC 2578 [RFC2578], STD 58, RFC 2579 [RFC2579] and STD 58,
   RFC 2580 [RFC2580].


2.  Revision History

Changes from draft-ietf-ipv6-rfc2012-update-03.txt:

14th September 2003

    Some editorial changes - correcting some spellings, and added a
    statement to indicate the deprecation of RFC 2012 and RFC 2542.

Changes from draft-ietf-ipv6-rfc2012-update-02.txt:

16th June 2003

    Added tcpHCInSegs and tcpHCOutSegs back to the mib, in order to
    have the 64-bit counters along with the 32-bit counters.

Changes from draft-ietf-ipv6-rfc2012-update-01.txt:

23rd February 2003


Raghunarayan, Editor                                           [Page 2]

INTERNET-DRAFT             Expires: March 2004           September 2003


     Changes in this version mainly concentrate on reducing this mib 
     to a bare minimum update of RFC 2012, enough to satisfy the 
     needs of IPv6.  The actual modifications are listed below.

     Scalars tcpHCInSegs and tcpHCOutSegs dropped.

     Objects dropped from the tcpConnectionTable include 
     tcpConnectionInSegs, tcpConnectionOutSegs,
     tcpConnectionInOctets, tcpConnectionOutOctets,
     tcpConnectionHCInSegs, tcpConnectionHCOutSegs,
     tcpConnectionHCInOctets, tcpConnectionHCOutOctets,
     tcpConnectionAge and tcpConnectionId.

     Objects dropped from tcpListenerTable include
     tcpListenerTimeOuts, tcpListenerEstablished and tcpListenerAge.

     Updated compliance statements to reflect the aforementioned
     changes.


Changes from draft-ietf-ipv6-rfc2012-update-00.txt:

4th November 2002

     Replaced the tcpConnectionStartTime and tcpListenerStartTime
     objects with tcpConnectionAge and tcpListenerAge respectively.
          
     Added tcpConnectionRemAddressType as an auxiliary object into 
     the tcpConnectionTable.
     
     Added new object, tcpConnectionId, to provide a link into the
     TCP-ESTATS-MIB.
     
     Included tcpConnectionAge and tcpConnectionProcess into the
     tcpConnectionGroup.
          
     Included tcpListenerAge and tcpListenerProcess into the 
     tcpListenerGroup.
     
     tcpListenerGroup added to the mandatory list for compliance.

Changes from draft-ietf-ipngwg-rfc2012-update-01.txt:

27 June 2002

     Replaced all occurrences of the term packets to segments, to be 
     consistent with the TCP specification.

     Added limits to tcpRtoMin, tcpRtoMax and tcpMaxConn.

     Added the scalar, tcpListenerTableLastChange.


Raghunarayan, Editor                                           [Page 3]

INTERNET-DRAFT             Expires: March 2004           September 2003


     Updated the description of tcpConnectionLocalAddress - removed
     reference to 'listen' state.

     Updated the description tcpConnection*Octets to explicitly
     indicate whether the count includes the TCP header octets.

     Updated the description of tcpConnectionStartTime and 
     tcpListenerStartTime - added clarifying text.

     Renamed tcpConnectionProcessID to tcpConnectionProcess.

     Updated the description of tcpListenerTable.


     Updated the description of tcpListenerLocalAddressType to include
     unknown (0) as a valid value.

     Updated the description of tcpListenerLocalAddress - the value 
     ''h (zero-length octet-string) represents the case wherein an
     application is will to accept connections for any IP interface
     associated with the node. 

     Removed tcpListenerRemAddressType.

     Removed tcpListenerHCConnectionsTimedOut and 
     tcpListenerHCConnectionsAccepted. Added them to open issues, to
     be added iff deemed required after discussions.

     Renamed tcpListenerConnectionsAccepted to tcpListenerEstablished
     and tcpListenerConnectionsTimedOut to tcpListenerTimeOuts.

     Renamed tcpListenerProcessID to tcpListenerProcess.

     Updated compliance statement for the object tcpConnectionState -
     support for the value 'deleteTCB (12)' deemed optional.

     Added RFC 2790 and RFC 2287 to the References section.

     Updated Contact-Info and Editor's address.

     Added Authors section.

Changes from draft-ietf-ipngwg-rfc2012-update-00.txt:

14 November 2001

     Added HC versions of connection counters.

     Added Listener table, with counters for accepted and timed out
     connection attempts.



Raghunarayan, Editor                                           [Page 4]

INTERNET-DRAFT             Expires: March 2004           September 2003


     Added tcp{Connection,Listener}ProcessID to index into SYSAPPL-MIB
     or HOST-RESOURCES-MIB.

     Removed tcpConnectionRemAddrType, it must be the same as
     tcpConnectionLocalAddrType.

Changes from draft-ops-rfc2012-update-00.txt

12 Jul 2001

     Turned into IPNG WG document

     Added tcpCountersGroup for per-connection counters

Changes from first draft posted to v6mib mailing list:

23 Feb 2001

     Made threshold for HC packet counters 1Mpps

     Added copyright statements and table of contents


21 Feb 2001 -- Juergen's changes

     Renamed tcpInetConn* to tcpConnection*

     Updated Conformance info

     Added missing tcpConnectionState and tcpConnState objects to
     SEQUENCEs

6 Feb 2001

     Removed v6-only objects.

     Renamed inetTcp* to tcpInet*

     Added SIZE restriction to InetAddress index objects.  (36 = 
     32-byte addresses plus 4-byte scope, but it's just a strawman)

     Used InetPortNumber TC from updated INET-ADDRESS-MIB

     Updated compliance statements.

     Added Keith to authors

     Added open issues section.

Changes from RFC 2012

     Deprecated tcpConnTable

Raghunarayan, Editor                                           [Page 5]

INTERNET-DRAFT             Expires: March 2004           September 2003


     Added tcpConnectionTable

3.  Overview

   The current TCP-MIB defined in this memo consists of two tables and
   a group of scalars:

   - The tcp group of scalars reports parameters and statistics of a
     TCP protocol engine.

   - The tcpConnectionTable provides access to status information for
     all TCP connections handled by a TCP protocol engine. In addition
     the table also reports identification of the operating system
     level processes which handle the TCP connections.

   - The tcpListenerTable provides access to information about all TCP
     listening endpoints known by a TCP protocol engine. And similar
     to the case of the connection table, the tcpListenerTable also 
     reports the identification of the operating system level
     processes which handle this listening TCP endpoint.

3.1 Relationship to Other MIBs

   This section discusses the relationship of this TCP-MIB module to
   other MIB modules.

3.1.1 Relationship to RFC1213-MIB

   TCP related MIB objects were originally defined as part of the
   RFC1213-MIB defined in RFC 1213 [RFC1213]. The TCP related objects
   of the RFC1213-MIB were later copied into a separate MIB module and
   published in RFC 2012 [RFC2012] in SMIv2 format.

   The previous versions of the TCP-MIB both defined the tcpConnTable,
   which has been deprecated for basically two reasons:

   (1) The tcpConnTable only supports IPv4.

      The current approach in the IETF is to write IP version neutral
      MIBs rather than having different definitions for various
      version of IP. This reduces the amount of overhead when new
      objects are introduced since there is only one place to add
      them. Hence, the approach taken in RFC 2452 of having separate
      tables is not continued.

   (2) The tcpConnTable mixes listening endpoints with connections.

      It turns out that connections tend to have a different behaviour
      and management access pattern compared to listening endpoints.
      Splitting the original tcpConnTable into two tables thus allows
      for the addition of specific status and statistics objects for
      listening endpoints and connections.

Raghunarayan, Editor                                           [Page 6]

INTERNET-DRAFT             Expires: March 2004           September 2003


3.1.2 Relationship to IPV6-TCP-MIB

   The IPV6-TCP-MIB defined in RFC 2452 has been moved to Historic
   since the approach of having separate IP version specific tables is
   not followed anymore. Implementation of RFC 2452 is thus not
   suggested anymore.

3.1.3 Relationship to HOST-RESOURCES-MIB and SYSAPPL-MIB

   The tcpConnectionTable and the tcpListenerTable report the
   identification of the operating system level process which handles
   a connection or a listening endpoint. The value is reported as an
   Unsigned32 which is expected to be the same as the hrSWRunIndex of
   the HOST-RESOURCES-MIB [RFC2790] (if the value is smaller than
   2147483647) or the sysApplElmtRunIndex of the SYSAPPL-MIB [RFC2287].
   This allows managment applications to identify the TCP connections
   that belong to an operating system level process which has proven
   to be valuable in operational environments.


4.  Definitions

TCP-MIB DEFINITIONS ::= BEGIN

IMPORTS
    MODULE-IDENTITY, OBJECT-TYPE, Integer32, Unsigned32,
    Gauge32, Counter32, Counter64, IpAddress, mib-2
                                       FROM SNMPv2-SMI
    MODULE-COMPLIANCE, OBJECT-GROUP    FROM SNMPv2-CONF
    InetAddress, InetAddressType,
    InetPortNumber                     FROM INET-ADDRESS-MIB;

tcpMIB MODULE-IDENTITY
    LAST-UPDATED "200309140000Z"
    ORGANIZATION "IETF IPv6 MIB Revision Team"
    CONTACT-INFO
           "Rajiv Raghunarayan (editor)

            Cisco Systems Inc.
            170 West Tasman Drive
            San Jose, CA 95134

            Phone: +1 408 853 9612
            Email: <raraghun@cisco.com>"
    DESCRIPTION
           "The MIB module for managing TCP implementations."
    REVISION      "200309140000Z"
    DESCRIPTION
           "IP version neutral revision, published as RFC XXXX."
    REVISION      "9411010000Z"
    DESCRIPTION
           "Initial SMIv2 version, published as RFC 2012."

Raghunarayan, Editor                                           [Page 7]

INTERNET-DRAFT             Expires: March 2004           September 2003


    REVISION      "9103310000Z"
    DESCRIPTION
           "The initial revision of this MIB module was part of 
            MIB-II."
    ::= { mib-2 49 }


-- the TCP base variables group

tcp      OBJECT IDENTIFIER ::= { mib-2 6 }

-- Scalars

tcpRtoAlgorithm OBJECT-TYPE
    SYNTAX      INTEGER {
                    other(1),    -- none of the following
                    constant(2), -- a constant rto
                    rsre(3),     -- MIL-STD-1778, Appendix B
                    vanj(4)      -- Van Jacobson's algorithm [VANJ]
                }
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The algorithm used to determine the timeout value used for
            retransmitting unacknowledged octets."
    ::= { tcp 1 }

tcpRtoMin OBJECT-TYPE
    SYNTAX     Integer32 (0..2147483647)
    UNITS      "milliseconds"
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The minimum value permitted by a TCP implementation for the
            retransmission timeout, measured in milliseconds.  More
            refined semantics for objects of this type depend upon the
            algorithm used to determine the retransmission timeout.  In
            particular, when the timeout algorithm is rsre(3), an 
            object of this type has the semantics of the LBOUND 
            quantity described in RFC 793."
    ::= { tcp 2 }












Raghunarayan, Editor                                           [Page 8]

INTERNET-DRAFT             Expires: March 2004           September 2003


tcpRtoMax OBJECT-TYPE
    SYNTAX     Integer32 (0..2147483647)
    UNITS      "milliseconds"
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The maximum value permitted by a TCP implementation for the
            retransmission timeout, measured in milliseconds.  More
            refined semantics for objects of this type depend upon the
            algorithm used to determine the retransmission timeout.  In
            particular, when the timeout algorithm is rsre(3), an 
            object of this type has the semantics of the UBOUND 
            quantity described in RFC 793."
    ::= { tcp 3 }


tcpMaxConn OBJECT-TYPE
    SYNTAX     Integer32 (-1 | 0..2147483647)
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The limit on the total number of TCP connections the entity
            can support.  In entities where the maximum number of
            connections is dynamic, this object should contain the 
            value -1."
    ::= { tcp 4 }

tcpActiveOpens OBJECT-TYPE
    SYNTAX     Counter32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The number of times TCP connections have made a direct
            transition to the SYN-SENT state from the CLOSED state."
    ::= { tcp 5 }

tcpPassiveOpens OBJECT-TYPE
    SYNTAX     Counter32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The number of times TCP connections have made a direct
            transition to the SYN-RCVD state from the LISTEN state."
    ::= { tcp 6 }









Raghunarayan, Editor                                           [Page 9]

INTERNET-DRAFT             Expires: March 2004           September 2003


tcpAttemptFails OBJECT-TYPE
    SYNTAX     Counter32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The number of times TCP connections have made a direct
            transition to the CLOSED state from either the SYN-SENT
            state or the SYN-RCVD state, plus the number of times TCP
            connections have made a direct transition to the LISTEN
            state from the SYN-RCVD state."
    ::= { tcp 7 }

tcpEstabResets OBJECT-TYPE
    SYNTAX     Counter32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The number of times TCP connections have made a direct
            transition to the CLOSED state from either the ESTABLISHED
            state or the CLOSE-WAIT state."
    ::= { tcp 8 }


tcpCurrEstab OBJECT-TYPE
    SYNTAX     Gauge32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The number of TCP connections for which the current state
            is either ESTABLISHED or CLOSE-WAIT."
    ::= { tcp 9 }

tcpInSegs OBJECT-TYPE
    SYNTAX     Counter32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The total number of segments received, including those
            received in error.  This count includes segments received
            on currently established connections."
    ::= { tcp 10 }

tcpOutSegs OBJECT-TYPE
    SYNTAX     Counter32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The total number of segments sent, including those on
            current connections but excluding those containing only
            retransmitted octets."
    ::= { tcp 11 }


Raghunarayan, Editor                                          [Page 10]

INTERNET-DRAFT             Expires: March 2004           September 2003


tcpRetransSegs OBJECT-TYPE
    SYNTAX     Counter32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The total number of segments retransmitted - that is, the
            number of TCP segments transmitted containing one or more
            previously transmitted octets."
    ::= { tcp 12 }

tcpInErrs OBJECT-TYPE
    SYNTAX     Counter32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The total number of segments received in error (e.g., bad
            TCP checksums)."
    ::= { tcp 14 }


tcpOutRsts OBJECT-TYPE
    SYNTAX     Counter32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The number of TCP segments sent containing the RST flag."
    ::= { tcp 15 }

-- { tcp 16 } was used to represent the ipv6TcpConnTable in RFC 2452,
-- which has since been obsoleted. It MUST not be used.

tcpHCInSegs OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The total number of segments received, including those
            received in error.  This count includes segments received
            on currently established connections.  This object is 
            the 64-bit equivalent of tcpInSegs."
    ::= { tcp 17 }

tcpHCOutSegs OBJECT-TYPE
    SYNTAX     Counter64
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The total number of segments sent, including those on
            current connections but excluding those containing only
            retransmitted octets.  This object is the 64-bit
            equivalent of tcpOutSegs."
    ::= { tcp 18 }

Raghunarayan, Editor                                          [Page 11]

INTERNET-DRAFT             Expires: March 2004           September 2003


-- The TCP Connection table

tcpConnectionTable OBJECT-TYPE
    SYNTAX     SEQUENCE OF TcpConnectionEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "A table containing information about existing TCP
            connections.  Note that unlike earlier TCP MIBs, there 
            is a separate table for connections in the LISTEN state."
    ::= { tcp 19 }

tcpConnectionEntry OBJECT-TYPE
    SYNTAX     TcpConnectionEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "A conceptual row of the tcpConnectionTable containing
            information about a particular current TCP connection.  
            Each row of this table is transient, in that it ceases to
            exist when (or soon after) the connection makes the
            transition to the CLOSED state."
    INDEX   { tcpConnectionLocalAddressType,
              tcpConnectionLocalAddress,
              tcpConnectionLocalPort,
              tcpConnectionRemAddressType,
              tcpConnectionRemAddress,
              tcpConnectionRemPort }
    ::= { tcpConnectionTable 1 }

TcpConnectionEntry ::= SEQUENCE {
        tcpConnectionLocalAddressType   InetAddressType,
        tcpConnectionLocalAddress       InetAddress,
        tcpConnectionLocalPort          InetPortNumber,
        tcpConnectionRemAddressType     InetAddressType,
        tcpConnectionRemAddress         InetAddress,
        tcpConnectionRemPort            InetPortNumber,
        tcpConnectionState              INTEGER,
        tcpConnectionProcess            Unsigned32
    }

tcpConnectionLocalAddressType OBJECT-TYPE
    SYNTAX     InetAddressType
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "The address type of tcpConnectionLocalAddress.  Only IPv4, 
            IPv4z, IPv6 and IPv6z address types are expected."
    ::= { tcpConnectionEntry 1 }




Raghunarayan, Editor                                          [Page 12]

INTERNET-DRAFT             Expires: March 2004           September 2003


tcpConnectionLocalAddress OBJECT-TYPE
    SYNTAX     InetAddress (SIZE(0..36))
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "The local IP address for this TCP connection."
    ::= { tcpConnectionEntry 2 }

tcpConnectionLocalPort OBJECT-TYPE
    SYNTAX     InetPortNumber
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "The local port number for this TCP connection."
    ::= { tcpConnectionEntry 3 }

tcpConnectionRemAddressType OBJECT-TYPE
    SYNTAX     InetAddressType
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "The address type of tcpConnectionRemAddress.  Only IPv4,
            IPv4z, IPv6 and IPv6z address types are expected."
    ::= { tcpConnectionEntry 4 }

tcpConnectionRemAddress OBJECT-TYPE
    SYNTAX     InetAddress (SIZE(0..36))
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "The remote IP address for this TCP connection."
    ::= { tcpConnectionEntry 5 }

tcpConnectionRemPort OBJECT-TYPE
    SYNTAX     InetPortNumber
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "The remote port number for this TCP connection."
    ::= { tcpConnectionEntry 6 }













Raghunarayan, Editor                                          [Page 13]

INTERNET-DRAFT             Expires: March 2004           September 2003


tcpConnectionState OBJECT-TYPE
    SYNTAX     INTEGER {
                    closed(1),
                    listen(2),  -- do we need this here???
                    synSent(3),
                    synReceived(4),
                    established(5),
                    finWait1(6),
                    finWait2(7),
                    closeWait(8),
                    lastAck(9),
                    closing(10),
                    timeWait(11),
                    deleteTCB(12)
                }
    MAX-ACCESS read-write
    STATUS     current
    DESCRIPTION
           "The state of this TCP connection.

            The value listen(2) is included only for parallelism to the
            old tcpConnTable, and should not be used.  A connection in
            LISTEN state should be present in the tcpListenerTable.

            The only value which may be set by a management station is
            deleteTCB(12).  Accordingly, it is appropriate for an agent
            to return a `badValue' response if a management station
            attempts to set this object to any other value.

            If a management station sets this object to the value
            deleteTCB(12), then this has the effect of deleting the TCB
            (as defined in RFC 793) of the corresponding connection on
            the managed node, resulting in immediate termination of the
            connection.

            As an implementation-specific option, a RST segment may be
            sent from the managed node to the other TCP endpoint (note
            however that RST segments are not sent reliably)."
    ::= { tcpConnectionEntry 7 }

tcpConnectionProcess OBJECT-TYPE
    SYNTAX     Unsigned32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The system's process ID for the process associated with 
            this connection, or zero if there is no such process.  This
            value is expected to be the same as HOST-RESOURCES-MIB::
            hrSWRunIndex or SYSAPPL-MIB::sysApplElmtRunIndex for some
            row in the appropriate tables."
    ::= { tcpConnectionEntry 8 }


Raghunarayan, Editor                                          [Page 14]

INTERNET-DRAFT             Expires: March 2004           September 2003


-- The TCP Listener table

tcpListenerTable OBJECT-TYPE
    SYNTAX     SEQUENCE OF TcpListenerEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "A table containing information about TCP listeners.  A 
            listening application can be represented in three 
            possible ways:

            1. An application that is willing to accept both IPv4 and
               IPv6 datagrams is represented by 
               tcpListenerLocalAddressType of unknown (0) and 
               tcpListenerLocalAddress of ''h (a zero-length 
               octet-string).

            2. An application which is willing to accept only IPv4 or
               IPv6 datagrams is represented by a 
               tcpListenerLocalAddressType of the appropriate address
               type and tcpListenerLocalAddress of ''h (a zero-length
               octet-string).

            3. An application which is a listening for data destined
               only to a specific IP address, but from any remote 
               system, is represented by a tcpListenerLocalAddressType 
               of an appropriate address type, with 
               tcpListenerLocalAddress the specific local address.

            NOTE: that address type in this table represents the 
            address type used for the communication, irrespective 
            of the higher-layer abstraction.  For example, an 
            application using IPv6 'sockets' to communicate via 
            IPv4 between ::ffff:10.0.0.1 and ::ffff:10.0.0.2 would 
            use InetAddressType ipv4(1))."
    ::= { tcp 20 }

tcpListenerEntry OBJECT-TYPE
    SYNTAX     TcpListenerEntry
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "A conceptual row of the tcpListenerTable containing
            information about a particular TCP listener."
    INDEX   { tcpListenerLocalAddressType,
              tcpListenerLocalAddress,
              tcpListenerLocalPort }
    ::= { tcpListenerTable 1 }





Raghunarayan, Editor                                          [Page 15]

INTERNET-DRAFT             Expires: March 2004           September 2003


TcpListenerEntry ::= SEQUENCE {
        tcpListenerLocalAddressType       InetAddressType,
        tcpListenerLocalAddress           InetAddress,
        tcpListenerLocalPort              InetPortNumber,
        tcpListenerProcess                Unsigned32
    }

tcpListenerLocalAddressType OBJECT-TYPE
    SYNTAX     InetAddressType
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "The address type of tcpListenerLocalAddress.  Only IPv4, 
            IPv4z, IPv6 and IPv6z address types are expected, or 
            unknown (0) if connection initiation to all local IP  
            addresses are accepted. "
    ::= { tcpListenerEntry 1 }

tcpListenerLocalAddress OBJECT-TYPE
    SYNTAX     InetAddress (SIZE(0..36))
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "The local IP address for this TCP connection.  In the case
            of a listener which is willing to accept connections for 
            any IP interface associated with the node, a value of ''h
            (zero-length octet-string) is used."
    ::= { tcpListenerEntry 2 }

tcpListenerLocalPort OBJECT-TYPE
    SYNTAX     InetPortNumber
    MAX-ACCESS not-accessible
    STATUS     current
    DESCRIPTION
           "The local port number for this TCP connection."
    ::= { tcpListenerEntry 3 }

tcpListenerProcess OBJECT-TYPE
    SYNTAX     Unsigned32
    MAX-ACCESS read-only
    STATUS     current
    DESCRIPTION
           "The system's process ID for the process associated with 
            this listener, or zero if there is no such process.  This 
            value is expected to be the same as HOST-RESOURCES-MIB::
            hrSWRunIndex or SYSAPPL-MIB::sysApplElmtRunIndex for some
            row in the appropriate tables."
    ::= { tcpListenerEntry 4 }





Raghunarayan, Editor                                          [Page 16]

INTERNET-DRAFT             Expires: March 2004           September 2003


-- The deprecated TCP Connection table

tcpConnTable OBJECT-TYPE
    SYNTAX     SEQUENCE OF TcpConnEntry
    MAX-ACCESS not-accessible
    STATUS     deprecated
    DESCRIPTION
           "A table containing information about existing IPv4-specific
            TCP connections or listeners.  This table has been
            deprecated in favor of the version neutral
            tcpConnectionTable."
    ::= { tcp 13 }

tcpConnEntry OBJECT-TYPE
    SYNTAX     TcpConnEntry
    MAX-ACCESS not-accessible
    STATUS     deprecated
    DESCRIPTION
           "A conceptual row of the tcpConnTable containing information
            about a particular current IPv4 TCP connection.  Each row 
            of this table is transient, in that it ceases to exist when
            (or soon after) the connection makes the transition to the
            CLOSED state."
    INDEX   { tcpConnLocalAddress,
              tcpConnLocalPort,
              tcpConnRemAddress,
              tcpConnRemPort }
    ::= { tcpConnTable 1 }

TcpConnEntry ::= SEQUENCE {
        tcpConnState         INTEGER,
        tcpConnLocalAddress  IpAddress,
        tcpConnLocalPort     Integer32,
        tcpConnRemAddress    IpAddress,
        tcpConnRemPort       Integer32
    }

















Raghunarayan, Editor                                          [Page 17]

INTERNET-DRAFT             Expires: March 2004           September 2003


tcpConnState OBJECT-TYPE
    SYNTAX     INTEGER {
                    closed(1),
                    listen(2),
                    synSent(3),
                    synReceived(4),
                    established(5),
                    finWait1(6),
                    finWait2(7),
                    closeWait(8),
                    lastAck(9),
                    closing(10),
                    timeWait(11),
                    deleteTCB(12)
                }
    MAX-ACCESS read-write
    STATUS     deprecated
    DESCRIPTION
           "The state of this TCP connection.

            The only value which may be set by a management station is
            deleteTCB(12).  Accordingly, it is appropriate for an agent
            to return a `badValue' response if a management station
            attempts to set this object to any other value.

            If a management station sets this object to the value
            deleteTCB(12), then this has the effect of deleting the TCB
            (as defined in RFC 793) of the corresponding connection on
            the managed node, resulting in immediate termination of the
            connection.

            As an implementation-specific option, a RST segment may be
            sent from the managed node to the other TCP endpoint (note
            however that RST segments are not sent reliably)."
    ::= { tcpConnEntry 1 }

tcpConnLocalAddress OBJECT-TYPE
    SYNTAX     IpAddress
    MAX-ACCESS read-only
    STATUS     deprecated
    DESCRIPTION
           "The local IP address for this TCP connection.  In the case
            of a connection in the listen state which is willing to
            accept connections for any IP interface associated with the
            node, the value 0.0.0.0 is used."
    ::= { tcpConnEntry 2 }







Raghunarayan, Editor                                          [Page 18]

INTERNET-DRAFT             Expires: March 2004           September 2003


tcpConnLocalPort OBJECT-TYPE
    SYNTAX     Integer32 (0..65535)
    MAX-ACCESS read-only
    STATUS     deprecated
    DESCRIPTION
           "The local port number for this TCP connection."
    ::= { tcpConnEntry 3 }

tcpConnRemAddress OBJECT-TYPE
    SYNTAX     IpAddress
    MAX-ACCESS read-only
    STATUS     deprecated
    DESCRIPTION
           "The remote IP address for this TCP connection."
    ::= { tcpConnEntry 4 }


tcpConnRemPort OBJECT-TYPE
    SYNTAX     Integer32 (0..65535)
    MAX-ACCESS read-only
    STATUS     deprecated
    DESCRIPTION
           "The remote port number for this TCP connection."
    ::= { tcpConnEntry 5 }

-- conformance information

tcpMIBConformance OBJECT IDENTIFIER ::= { tcpMIB 2 }

tcpMIBCompliances OBJECT IDENTIFIER ::= { tcpMIBConformance 1 }
tcpMIBGroups      OBJECT IDENTIFIER ::= { tcpMIBConformance 2 }






















Raghunarayan, Editor                                          [Page 19]

INTERNET-DRAFT             Expires: March 2004           September 2003


-- compliance statements

tcpMIBCompliance2 MODULE-COMPLIANCE
    STATUS     current
    DESCRIPTION
           "The compliance statement for systems which implement TCP."
    MODULE  -- this module
        MANDATORY-GROUPS { tcpBaseGroup, tcpConnectionGroup,
                           tcpListenerGroup }
        GROUP       tcpHCGroup
        DESCRIPTION
           "This group is mandatory for those systems which are capable
            of receiving or transmitting more than 1 million TCP
            segments per second.  1 million segments per second will
            cause a Counter32 to wrap in just over an hour."
        OBJECT      tcpConnectionState
        SYNTAX      INTEGER { closed(1), listen(2), synSent(3),
                              synReceived(4), established(5),
                              finWait1(6), finWait2(7), closeWait(8),
                              lastAck(9), closing(10), timeWait(11) }
        MIN-ACCESS  read-only
        DESCRIPTION
           "Write access is not required, nor is support for the value
            deleteTCB (12)."
    ::= { tcpMIBCompliances 2 }

tcpMIBCompliance MODULE-COMPLIANCE
    STATUS     deprecated
    DESCRIPTION
           "The compliance statement for IPv4-only systems which
            implement TCP.  In order to be IP version independent, this
            compliance statement is deprecated in favor of
            tcpMIBCompliance2.  However, agents are still encouraged
            to implement these objects in order to interoperate with
            the deployed base of managers."
    MODULE  -- this module
        MANDATORY-GROUPS { tcpGroup }
        OBJECT      tcpConnState
        MIN-ACCESS  read-only
        DESCRIPTION
           "Write access is not required."
    ::= { tcpMIBCompliances 1 }











Raghunarayan, Editor                                          [Page 20]

INTERNET-DRAFT             Expires: March 2004           September 2003


-- units of conformance

tcpGroup OBJECT-GROUP
    OBJECTS   { tcpRtoAlgorithm, tcpRtoMin, tcpRtoMax,
                tcpMaxConn, tcpActiveOpens,
                tcpPassiveOpens, tcpAttemptFails,
                tcpEstabResets, tcpCurrEstab, tcpInSegs,
                tcpOutSegs, tcpRetransSegs, tcpConnState,
                tcpConnLocalAddress, tcpConnLocalPort,
                tcpConnRemAddress, tcpConnRemPort,
                tcpInErrs, tcpOutRsts }
    STATUS     deprecated
    DESCRIPTION
           "The tcp group of objects providing for management of TCP
            entities."
    ::= { tcpMIBGroups 1 }

tcpBaseGroup OBJECT-GROUP
    OBJECTS   { tcpRtoAlgorithm, tcpRtoMin, tcpRtoMax,
                tcpMaxConn, tcpActiveOpens,
                tcpPassiveOpens, tcpAttemptFails,
                tcpEstabResets, tcpCurrEstab, tcpInSegs,
                tcpOutSegs, tcpRetransSegs,
                tcpInErrs, tcpOutRsts }
    STATUS     current
    DESCRIPTION
           "The group of counters common to TCP entities."
    ::= { tcpMIBGroups 2 }

tcpConnectionGroup OBJECT-GROUP
    OBJECTS    { tcpConnectionState, tcpConnectionProcess }
    STATUS     current
    DESCRIPTION
           "The group provides general information about TCP 
            connections."
    ::= { tcpMIBGroups 3 }

tcpListenerGroup OBJECT-GROUP
    OBJECTS    { tcpListenerProcess }
    STATUS     current
    DESCRIPTION
           "This group has objects providing general information about
            TCP listeners."
    ::= { tcpMIBGroups 4 }

tcpHCGroup OBJECT-GROUP
    OBJECTS    { tcpHCInSegs, tcpHCOutSegs }
    STATUS     current
    DESCRIPTION
           "The group of objects providing for counters of high speed
            TCP implementations."
    ::= { tcpMIBGroups 5 }

Raghunarayan, Editor                                          [Page 21]

INTERNET-DRAFT             Expires: March 2004           September 2003


END


5.  Acknowledgements

This document contains a modified subset of RFC 1213 and updates RFC
2012 and RFC 2452.  Acknowledgements are therefore due to the authors
and editors of these documents for their excellent work.  Several
useful comments regarding usability and design were also received
from Kristine Adamson.  The authors would like to like all these
people for their contribution to this effort.


6.  Normative References

[RFC793]  Postel, J., "Transmission Control Protocol - DARPA Internet
          Program Protocol Specification", STD 7, RFC 793, DARPA,
          September 1981.

[RFC2287] Krupczak, C., Saperia, J., "Definitions of System-Level
          Managed Objects for Applications", RFC 2287, February 1998.

[RFC2790] Waldbusser, S., Grillo, P., "Host Resources MIB", RFC 2790,
          March 2000.

[RFC2578] McCloghrie, K., Perkins, D., Schoenwaelder, J., Case, J.,
          Rose, M. and S. Waldbusser, "Structure of Management
          Information Version 2 (SMIv2)", STD 58, RFC 2578, April
          1999.

[RFC2579] McCloghrie, K., Perkins, D., Schoenwaelder, J., Case, J.,
          Rose, M. and S. Waldbusser, "Textual Conventions for SMIv2",
          STD 58, RFC 2579, April 1999.

[RFC2580] McCloghrie, K., Perkins, D., Schoenwaelder, J., Case, J.,
          Rose, M. and S. Waldbusser, "Conformance Statements for
          SMIv2", STD 58, RFC 2580, April 1999.

[RFC3291] Daniele, M., Haberman, B., Routhier, S., and Schoenwaelder,
          J., "Textual Conventions for Internet Network Addresses",
          RFC 3291, May 2002.


7.  Informative References

[RFC1213] Rose, M. and K. McCloghrie, "Management Information Base 
          for Network Management of TCP/IP-based internets", RFC 1213,
          March 1991.

[RFC2012] K. McCloghrie, "SNMPv2 Management Information Base for the
          Transmission Control Protocol using SMIv2", RFC 2012,
          November 1996.

Raghunarayan, Editor                                          [Page 22]

INTERNET-DRAFT             Expires: March 2004           September 2003


[RFC2452] Daniele, M., "IP Version 6 Management Information Base for
          the Transmission Control Protocol", RFC 2452, December 1998.

[RFC3410] Case, J., Mundy, R., Partain, D. and B. Stewart,
          "Introduction and Applicability Statements for Internet-
          Standard Management Framework", RFC 3410, December 2002.

[VANJ]    Jacobson, V., "Congestion Avoidance and Control", SIGCOMM
          1988, Stanford, California.


8.  Security Considerations

There are management objects defined in this MIB that have a
MAX-ACCESS clause of read-write.  Such objects may be considered
sensitive or vulnerable in some network environments.  The support
for SET operations in a non-secure environment without proper
protection can have a negative effect on network operations.
These are the tables and objects and their sensitivity/vulnerability:

o The tcpConnectionState and tcpConnState objects have a MAX-ACCESS
  clause of read-write, which allows termination of an arbitrary
  connection.  Unauthorized access could cause a denial of service.

Some of the readable objects in this MIB module (i.e., objects with a
MAX-ACCESS other than not-accessible) may be considered sensitive or
vulnerable in some network environments.  It is thus important to
control even GET and/or NOTIFY access to these objects and possibly
to even encrypt the values of these objects when sending them over
the network via SNMP.  These are the tables and objects and their
sensitivity/vulnerability:

o The tcpConnectionTable and the tcpConnTable contain objects
  providing information on the active connections on the device,
  the status of these connections and the associated processes.
  This information may be used by an attacker to launch attacks
  against known/unknown weakness in certain protocols/applications.

o The tcpListenerTable and the tcpConnTable contain objects providing
  information on listeners on an entity.  For e.g. the
  tcpListenerLocalPort and tcpConnLocalPort objects can be used 
  to identify what ports are open on the machine and can thus what 
  attacks are likely to succeed, without the attacker having to run a 
  port scanner.

SNMP versions prior to SNMPv3 did not include adequate security.
Even if the network itself is secure (for example by using IPSec),
even then, there is no control as to who on the secure network is
allowed to access and GET/SET (read/change/create/delete) the objects
in this MIB module.



Raghunarayan, Editor                                          [Page 23]

INTERNET-DRAFT             Expires: March 2004           September 2003


It is RECOMMENDED that implementers consider the security features as
provided by the SNMPv3 framework (see [RFC3410], section 8),
including full support for the SNMPv3 cryptographic mechanisms (for
authentication and privacy).

Further, deployment of SNMP versions prior to SNMPv3 is NOT
RECOMMENDED.  Instead, it is RECOMMENDED to deploy SNMPv3 and to
enable cryptographic security.  It is then a customer/operator
responsibility to ensure that the SNMP entity giving access to an
instance of this MIB module is properly configured to give access to
the objects only to those principals (users) that have legitimate
rights to indeed GET or SET (change/create/delete) them.


9.  Editor's Address

Rajiv Raghunarayan
Cisco Systems Inc.
170 West Tasman Drive
San Jose, CA 95134
USA

Email: raraghun@cisco.com


10. Authors

This document is an output of the IPv6 MIB revision team, and 
contributors to earlier versions of this document include:

Bill Fenner, AT&T Labs -- Research
Email: fenner@research.att.com

Brian Haberman
Email: bkhabs@nc.rr.com

Shawn A. Routhier, Wind River
Email: sar@epilogue.com

Juergen Schoenwalder, TU Braunschweig
Email: schoenw@ibr.cs.tu-bs.de

Dave Thaler, Microsoft
Email: dthaler@windows.microsoft

This documents updates parts of the MIBs from several documents. RFC
2012 has been the base document for these updations. RFC 2452 was
the first document to define the managed objects for implementations
of TCP over IPv6.




Raghunarayan, Editor                                          [Page 24]

INTERNET-DRAFT             Expires: March 2004           September 2003


RFC 2012:

Keith McCloghrie, Cisco Systems (Editor)
kzm@cisco.com

RFC 2452:

Mike Daniele, Compaq Computer Corporation
daniele@zk3.dec.com


11.  Full Copyright Statement

Copyright (C) The Internet Society (2002). All Rights Reserved.

This document and translations of it may be copied and furnished to
others, and derivative works that comment on or otherwise explain it or
assist in its implementation may be prepared, copied, published and
distributed, in whole or in part, without restriction of any kind,
provided that the above copyright notice and this paragraph are 
included on all such copies and derivative works. However, this 
document itself may not be modified in any way, such as by removing the
copyright notice or references to the Internet Society or other 
Internet organizations, except as needed for the purpose of developing 
Internet standards in which case the procedures for copyrights defined 
in the Internet Standards process must be followed, or as required to
translate it into languages other than English.

The limited permissions granted above are perpetual and will not be
revoked by the Internet Society or its successors or assigns.

This document and the information contained herein is provided on an 
"AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING 
TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT 
NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN WILL
NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY 
OR FITNESS FOR A PARTICULAR PURPOSE.
















Raghunarayan, Editor                                          [Page 25]

