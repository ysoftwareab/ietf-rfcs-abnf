<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Hypertext Transfer Protocol (HTTP) Timeouts </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Request Timeouts">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Idle Connection Timeouts">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Request-Timeout Header">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Existing Intermediaries">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Examples">
<link href="#rfc.section.4" rel="Chapter" title="4 Connection-Timeout Header">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Existing Intermediaries">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Upgraded HTTP Connections">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Example">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Request-Timeout HTTP header Registration">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Connection-Timeout HTTP header Registration">
<link href="#rfc.section.7" rel="Chapter" title="7 Acknowledgments">
<link href="#rfc.section.8" rel="Chapter" title="8 Change Log">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="A Request-Timeout header is defined for Hypertext Transfer Protocol (HTTP).  This end-to-end header informs an origin server and any intermediaries of the maximum time that a client will await a response to its request.  A server can use this header to ensure that a timely response is generated.  This also identifies requests as being potentially long-lived, and allows for better resource allocation for these requests.  " />
  <meta name="description" content="A Request-Timeout header is defined for Hypertext Transfer Protocol (HTTP).  This end-to-end header informs an origin server and any intermediaries of the maximum time that a client will await a response to its request.  A server can use this header to ensure that a timely response is generated.  This also identifies requests as being potentially long-lived, and allows for better resource allocation for these requests.  " />
  <meta name="keywords" content="HTTP, Timeout, Request-Timeout, Connection-Timeout, Connection" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">HYBI</td>
<td class="right">M. Thomson</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Andrew Corporation</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">S. Loreto</td>
</tr>
<tr>
<td class="left">Expires: September 08, 2011</td>
<td class="right">Ericsson</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">G. Wilkins</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Intalio</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">March 07, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Hypertext Transfer Protocol (HTTP) Timeouts <br />
  <span class="filename"></span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>A Request-Timeout header is defined for Hypertext Transfer Protocol (HTTP).  This end-to-end header informs an origin server and any intermediaries of the maximum time that a client will await a response to its request.  A server can use this header to ensure that a timely response is generated.  This also identifies requests as being potentially long-lived, and allows for better resource allocation for these requests.  </p>
<p>A Connection-Timeout header is defined for HTTP.  This hop-by-hop header informs the entity at the other end of a connection of the maximum time that an idle connection is kept open.  This header improves reliability by providing better information about the idle connection management policy of HTTP hosts.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 08, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Request Timeouts</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Idle Connection Timeouts</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Request-Timeout Header</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Existing Intermediaries</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Examples</a>
</li>
<li>4.   <a href="#rfc.section.4">Connection-Timeout Header</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Existing Intermediaries</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Upgraded HTTP Connections</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Example</a>
</li>
<li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Request-Timeout HTTP header Registration</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Connection-Timeout HTTP header Registration</a>
</li>
<li>7.   <a href="#rfc.section.7">Acknowledgments</a>
</li>
<li>8.   <a href="#rfc.section.8">Change Log</a>
</li>
<li>9.   <a href="#rfc.references">References</a>
</li>
<li>9.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">This document describes two headers that provide <a href="#RFC2616">Hypertext Transfer Protocol (HTTP)</a> <cite title="NONE">[RFC2616]</cite> hosts with timing information.  </p>
<p id="rfc.section.1.p.2">The <samp>Request-Timeout</samp> header describes the time available for a single HTTP request.  </p>
<p id="rfc.section.1.p.3">The <samp>Connection-Timeout</samp> header describes the time that an idle connection is retained.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Request Timeouts</h1>
<p id="rfc.section.1.1.p.1">HTTP is a client-driven protocol.  As such, a server is only able to provide information to a client when that client requests it.  To address the need for servers to provide low-latency notifications to clients, a practice of <a href="#I-D.loreto-http-bidirectional">long-polling</a> <cite title="NONE">[I-D.loreto-http-bidirectional]</cite> is commonplace.  </p>
<p id="rfc.section.1.1.p.2">Long-polling requires that a client maintain an open request to a server.  The server withholds responses to this request until the event of interest occurs.  The open request provides the server with a way to send a message immediately after the event occurs.  After the response containing the notification is received, the client immediately opens another open request.  </p>
<p id="rfc.section.1.1.p.3">Long-polling differs significantly to many HTTP requests, which do not have significant delay between request and response.  Long-polling requests monopolize a connection for the time that they are outstanding.  For this reason, it is useful for a server or intermediary to identify a long-polling request.  Identifying a long-polling request would enable specialized resource management for long-polling requests; for instance, separate connection allocations and management, longer timeout periods and long-poll optimizations.  </p>
<p id="rfc.section.1.1.p.4">A connection that is used for long-polling also appears to be idle for a significant period.  Management of idle connections can interfere with the operation of a long-poll.  Many intermediaries legitimately use timeouts to avoid clients from monopolizing the use of outgoing connections.  If an intermediary times out a request, the server is unable to send a response.  </p>
<p id="rfc.section.1.1.p.5">Knowing the time available to provide a response can avoid problems with timeouts.  Current implementations select times between 30 and 120 seconds, times that have been empirically determined to be safe.  A server provides a null response before this time to ensure that the connection appears to be active to intermediaries.  Such low values are potentially wasteful, since each null response and subsequent request generates traffic.  A null response can also increase the latency of notifications, since the response removes the channel that the server would use for notifications.  </p>
<p id="rfc.section.1.1.p.6">The Request-Timeout header defined in <a href="#request-timeout">Section 3</a> describes the maximum time available to a server in providing a response to any particular request.  </p>
<p id="rfc.section.1.1.p.7">For the Request-Timeout header, <a href="#intermediary">Section 3.1</a> includes a discussion of the interaction with existing HTTP intermediaries and other intermediaries like network address translation (NAT) device.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Idle Connection Timeouts</h1>
<p id="rfc.section.1.2.p.1">Management of idle HTTP connections has an impact on long-lived communications between hosts.  Hosts are able to close idle connections in order to reduce resource consumption.  </p>
<p id="rfc.section.1.2.p.2">Many clients choose not to send non-idempotent requests on idle connections.  If the intermediary or server holding the other end of the connection chooses to close the connection while a non-idempotent request is in transit, the client has no way to tell if the request has succeeded.  For this reason, many clients establish a new connection for every non-idempotent request.  This is inefficient if the existing connection is usable connection: establishing a new connection adds significantly to the latency of the request.  </p>
<p id="rfc.section.1.2.p.3">Polling of resource state can more efficiently use connection resources when an idle connection timeout is known.  A client that polls on an interval that is close to the connection timeout can ensure that polling requests are made before the idle connection is closed, avoiding any need to retry a request due to the aforementioned problem.  Alternatively, a client that knows that the connection timeout is less than the polling interval can close the connection immediately after a poll, releasing resources.  </p>
<p id="rfc.section.1.2.p.4">A Connection-Timeout header is defined in <a href="#conn-timeout">Section 4</a>.  This hop-by-hop header informs hosts of the minumum time that a connection remains idle before it is closed.  Indicating this time explicitly gives a client the knowledge necessary to reuse an idle connection with a greater assurance that the connection is usable.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p id="rfc.section.2.p.1">In this document, the key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" are to be interpreted as described in BCP 14, <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite> and indicate requirement levels for compliant implementations.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#request-timeout" id="request-timeout">Request-Timeout Header</a>
</h1>
<p id="rfc.section.3.p.1">The <samp>Request-Timeout</samp> header is a end-to-end request header that indicates the maximum time that a client is prepared to await a response.  </p>
<div id="#rfc.figure.1"></div>
<pre>
Request-Timeout    = "Request-Timeout" ":" timeout-value
timeout-value      = 1*DIGIT
        </pre>
<p id="rfc.section.3.p.2">A client adds a Request-Timeout header to any request for which they are prepared to await a response.  The client sets the header to the maximum time that they are prepared to wait.  </p>
<p id="rfc.section.3.p.3">The value of the Request-Timeout header is a single integer value in seconds.  </p>
<p id="rfc.section.3.p.4">An origin server interprets this header as the time between receipt of a complete request and the time that it generates and begins sending the response.  A client will observe a longer time interval between request and response, as network transit and processing by intermediaries add delays.  If this time is critical, a client SHOULD allow for delays in setting a value for the header.  </p>
<p id="rfc.section.3.p.5">An origin server MAY apply a lower value to the timeout based on local policy.  An origin server MAY choose to take longer to produce a response, at the risk that the client is no longer able to use the response.  </p>
<p id="rfc.section.3.p.6">An HTTP intermediary MAY reduce the value of a Request-Timeout header based on local policy.  An intermediary MAY add a Request-Timeout header if none is present.  The value in the Request-Timeout header MUST NOT be increased or removed.  </p>
<p id="rfc.section.3.p.7">The client MUST NOT set the value of the Timeout header greater than the value of the Connection-Timeout header.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#intermediary" id="intermediary">Existing Intermediaries</a>
</h1>
<p id="rfc.section.3.1.p.1">The exact impact of an intermediary on an HTTP request with a Request-Timeout header depends on the type of intermediary.  </p>
<p id="rfc.section.3.1.p.2">An intermediary that is compliant with HTTP/1.1 passes this header, but unaware of the header semantics, passes the header on to the origin server without altering it.  For an intermediary that does not time out requests, or an intermediary that has a timeout period that is longer than the one specified in the header, this has no impact.  </p>
<p id="rfc.section.3.1.p.3">An existing intermediary that has a shorter timeout period than the indicated time will time out a request before the server generates a response.  The intermediary could send the client a 504 (Gateway Timeout) response when it times out.  </p>
<p id="rfc.section.3.1.p.4">An intermediary that forwards requests without altering them (a transparent intermediary) is similar to an HTTP/1.1 compliant intermediary.  </p>
<p id="rfc.section.3.1.p.5">A non-compliant intermediary might remove a Request-Timeout header.  This means that the server is unaware of the timeliness requirements of the client.  A server that expects a Request-Timeout header might attempt to guess an appropriate value.  </p>
<p id="rfc.section.3.1.p.6">A network address translation (NAT) device might interact with timeouts.  These devices maintain state about TCP connections that are established through them.  This state can be discarded or lost if the connection remains idle.  A NAT device failure can also cause state loss.  Further attempts to use the connection either fail without error, or result in the NAT device sending a TCP <samp>RST</samp> to the entity that attempts to use the connection.  </p>
<p id="rfc.section.3.1.p.7">A client MAY revise the Request-Timeout header that it sends in subsequent requests to the same resource or origin server if it detects intermediaries or NAT devices that have shorter timeout periods.  However, two requests are not guaranteed to follow the same path through a network, especially for different resources.  A client that employs a heuristic for setting the Timeout header SHOULD ensure that any knowledge it obtains about timeouts is not retained indefinitely.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Examples</h1>
<p id="rfc.section.3.2.p.1">The following example shows how a Request-Timeout header could be used.  In this case, both intermediaries - proxy and gateway - both reduce the timeout based on their policy.  </p>
<div id="#rfc.figure.2"></div>
<pre>
Client              Proxy              Gateway             Server
  |                   |                   |                   |
  |  Request-         |                   |                   |
  +-- Timeout: 300 --&gt;|  Request-         |                   |
  |                   +-- Timeout: 250 --&gt;|  Request-         |
  |                   |                   +-- Timeout: 240 --&gt;|
  |                   |                   |                ^  |
  .                   .                   .                |  .
  .                   .                   .     up to 240 seconds
  .                   .                   .                |  .
  |                   |                   |                V  |
  |                   |                   |&lt;----- 200 OK -----+
  |                   |&lt;----- 200 OK -----+                   |
  |&lt;----- 200 OK -----+                   |                   |
  |                   |                   |                   |
</pre>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#conn-timeout" id="conn-timeout">Connection-Timeout Header</a>
</h1>
<p id="rfc.section.4.p.1">The <samp>Connection-Timeout</samp> header is a hop-by-hop header that indicates the minimum time that an idle connection will be maintained.  </p>
<div id="#rfc.figure.3"></div>
<pre>
Connection-Timeout = "Connection-Timeout" ":" timeout-value
                     ; timeout-value from Timeout header
        </pre>
<p id="rfc.section.4.p.2">This header is sent by either host participating in a persistent connection.  A host sets the value to the minimum time that local policy at that host allows for an idle connection to remain open.  A connection is idle if no data is sent or received by a host.  </p>
<p id="rfc.section.4.p.3">The value of the Connection-Timeout header is a single integer in seconds.  </p>
<p id="rfc.section.4.p.4">As a hop-by-hop header, this header only applies to a single transport-level connection.  If a Connection-Timeout header is added to a request or response, the Connection header MUST include the tag <samp>Connection-Timeout</samp>.  This ensures that intermediaries that do not recognize this header remove it before forwarding a request.  </p>
<p id="rfc.section.4.p.5">A host MAY keep an idle connection open for longer than the time that it indicates, but it SHOULD attempt to retain a connection for at least as long as indicated.  </p>
<p id="rfc.section.4.p.6">Network transit and processing by intermediaries add additional delays that can skew the subjective perception of whether a connection is idle.  A client SHOULD make allowances for any delays in determining whether to reuse an idle connection.  </p>
<p id="rfc.section.4.p.7">An intermediary that provides a Connection-Timeout header value, MUST set the value of the Request-Timeout header in any requests that it forwards to be less than or equal to the Connection-Timeout that it provides.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#conn-intermediary" id="conn-intermediary">Existing Intermediaries</a>
</h1>
<p id="rfc.section.4.1.p.1">The exact impact of an intermediary on an HTTP request with a Connection-Timeout header depends on the type of intermediary.  </p>
<p id="rfc.section.4.1.p.2">An intermediary that is compliant with HTTP/1.1 ignores and discards this header before forwarding a request.  Since it is unaware of the semantics of the header it could drop an idle connection at any time (see Section 7.1.4 of <a href="#I-D.ietf-httpbis-p1-messaging">[I-D.ietf-httpbis-p1-messaging]</a>).  </p>
<p id="rfc.section.4.1.p.3">A non-compliant or otherwise transparent intermediary might pass this header on to the next hop.  This results in same types of errors that the Keep-Alive header causes, as described in Section 19.7.1 of <a href="#RFC2068">[RFC2068]</a>.  </p>
<p id="rfc.section.4.1.p.4">A network address translation (NAT) device might cause a connection to become unavailable prior to the advertised timeout.  </p>
<p id="rfc.section.4.1.p.5">A host MAY revise the Connection-Timeout header that it sends in subsequent requests to the same resource or origin server if it detects intermediaries or NAT devices that have shorter timeout periods.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Upgraded HTTP Connections</h1>
<p id="rfc.section.4.2.p.1">A connection timeout can apply to a connection that is subsequently upgraded to another protocol <a href="#RFC2817">[RFC2817]</a>.  Endpoints and intermediaries MAY assume that the connection timeout applies to the upgraded connection, unless the upgraded protocol provides another method for indicating idle timeouts.  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Example</h1>
<p id="rfc.section.4.3.p.1">The following example shows how a Connection-Timeout header could be used.  All connections are independently negotiated.  In this example, the client indicates a timeout of 600 seconds (10 minutes), but the proxy is only prepared to retain the connection for at least 120 seconds (2 minutes).  On the link between proxy and server, the proxy requests a timeout of 1200 seconds and the server reduces this to 300 seconds.  </p>
<div id="#rfc.figure.4"></div>
<pre>
Client                        Proxy                         Server
  |                             |                              |
  +- Connection-Timeout: 600 --&gt;|                              |
  |  Connection:                |                              |
  |    Connection-Timeout       |                              |
  |                             +- Connection-Timeout: 1200 --&gt;|
  |                             |  Connection:                 |
  |                             |    Connection-Timeout        |
  |                             |                              |
  |                             |&lt;-- Connection-Timeout: 300 --+
  |                             |    Connection:               |
  |                             |      Connection-Timeout      |
  |&lt;-- Connection-Timeout: 120 -+                              |
  |    Connection:              |                              |
  |      Connection-Timeout     |                              |
  |                             |                              |
</pre>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">Establishing a persistent connection requires a commitment of resources at a host.  The Timeout and Connection-Timeout headers are used to express host policy that could alter the way that a host allocates connection resources.  </p>
<p id="rfc.section.5.p.2">A host that alters its policies based on the receipt of either header could be exploited by a malicious host to either benefit from increased access to resources or to consume resources in the hopes of depriving another host.  </p>
<p id="rfc.section.5.p.3">An attacker might attempt to keep a connection from becoming idle, to keep the connection open.  A client could legitimately do this to benefit from a reduced latency for later requests, but an attacker might exploit this to monopolize server resources.  A host that has indicated a Connection-Timeout MAY close a non-idle connection sooner than the indicated time if necessary or dictated by local policy (see Section 7.1.4 of <a href="#I-D.ietf-httpbis-p1-messaging">[I-D.ietf-httpbis-p1-messaging]</a>).  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> IANA Considerations</h1>
<p id="rfc.section.6.p.1">This section registers the two HTTP headers in the "Permanent Message Header Fields" registry established by <a href="#RFC3864">[RFC3864]</a>.  </p>
<p id="rfc.section.6.p.2">[[Note to IANA/RFC Editor: Please replace instance of RFCXXXX with the number of the published RFC and remove this note.]] </p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Request-Timeout HTTP header Registration</h1>
<p id="rfc.section.6.1.p.1">This document registers the HTTP <samp>Request-Timeout</samp> header in the "Permanent Message Header Fields" registry established by <a href="#RFC3864">[RFC3864]</a> </p>

<dl>
<dt>Header field:</dt>
<dd style="margin-left: 8">Request-Timeout</dd>
<dt>Applicable protocol:</dt>
<dd style="margin-left: 8">HTTP</dd>
<dt>Status:</dt>
<dd style="margin-left: 8">standard</dd>
<dt>Author/change controller:</dt>
<dd style="margin-left: 8">Internet Engineering Task Force, IETF (iesg@ietf.org)</dd>
<dt>Specification document(s):</dt>
<dd style="margin-left: 8">RFCXXXX (this document)</dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Connection-Timeout HTTP header Registration</h1>
<p id="rfc.section.6.2.p.1">This document registers the HTTP <samp>Connection-Timeout</samp> header in the "Permanent Message Header Fields" registry established by <a href="#RFC3864">[RFC3864]</a> </p>

<dl>
<dt>Header field:</dt>
<dd style="margin-left: 8">Connection-Timeout</dd>
<dt>Applicable protocol:</dt>
<dd style="margin-left: 8">HTTP</dd>
<dt>Status:</dt>
<dd style="margin-left: 8">standard</dd>
<dt>Author/change controller:</dt>
<dd style="margin-left: 8">Internet Engineering Task Force, IETF (iesg@ietf.org)</dd>
<dt>Specification document(s):</dt>
<dd style="margin-left: 8">RFCXXXX (this document)</dd>
</dl>

<p> </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Acknowledgments</h1>
<p id="rfc.section.7.p.1">Jamie Lokier provided valuable contributions of experience, insight and text suggestions to this document.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Change Log</h1>
<p id="rfc.section.8.p.1">Since draft-loreto-http-timeout: </p>

<ul>
<li>Changed Timeout to Request-Timeout to avoid a conflict with an existing header definition.</li>
<li>Added note about the application of Connection-Timeout to upgraded protocols.</li>
</ul>

<p> </p>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2616">[RFC2616]</b></td>
<td class="top">
<a href="mailto:fielding@ics.uci.edu" title="Department of Information and Computer Science">Fielding, R.</a>, <a href="mailto:jg@w3.org" title="World Wide Web Consortium">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com" title="Compaq Computer Corporation">Mogul, J.</a>, <a href="mailto:frystyk@w3.org" title="World Wide Web Consortium">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox Corporation">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.</a> and <a href="mailto:timbl@w3.org" title="World Wide Web Consortium">T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2616, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3864">[RFC3864]</b></td>
<td class="top">
<a>Klyne, G.</a>, <a>Nottingham, M.</a> and <a>J. Mogul</a>, "<a href="http://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>", BCP 90, RFC 3864, September 2004.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">9.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2068">[RFC2068]</b></td>
<td class="top">
<a href="mailto:fielding@ics.uci.edu" title="University of California, Irvine, Department of Information and Computer Science">Fielding, R.</a>, <a href="mailto:jg@w3.org" title="MIT Laboratory for Computer Science">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com" title="Digital Equipment Corporation, Western Research Laboratory">Mogul, J.</a>, <a href="mailto:frystyk@w3.org" title="MIT Laboratory for Computer Science">Nielsen, H.</a> and <a href="mailto:timbl@w3.org" title="MIT Laboratory for Computer Science">T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2068">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2068, January 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2817">[RFC2817]</b></td>
<td class="top">
<a>Khare, R.</a> and <a>S. Lawrence</a>, "<a href="http://tools.ietf.org/html/rfc2817">Upgrading to TLS Within HTTP/1.1</a>", RFC 2817, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-httpbis-p1-messaging">[I-D.ietf-httpbis-p1-messaging]</b></td>
<td class="top">
<a>Fielding, R</a>, <a>Gettys, J</a>, <a>Mogul, J</a>, <a>Nielsen, H</a>, <a>Masinter, L</a>, <a>Leach, P</a>, <a>Berners-Lee, T</a>, <a>Lafon, Y</a> and <a>J Reschke</a>, "<a href="http://tools.ietf.org/html/draft-ietf-httpbis-p1-messaging-17">HTTP/1.1, part 1: URIs, Connections, and Message Parsing</a>", Internet-Draft draft-ietf-httpbis-p1-messaging-17, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.loreto-http-bidirectional">[I-D.loreto-http-bidirectional]</b></td>
<td class="top">
<a>Loreto, S</a>, <a>Saint-Andre, P</a>, <a>Salsano, S</a> and <a>G Wilkins</a>, "<a href="http://tools.ietf.org/html/draft-loreto-http-bidirectional-07">Known Issues and Best Practices for the Use of Long Polling and Streaming in Bidirectional HTTP</a>", Internet-Draft draft-loreto-http-bidirectional-07, January 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Martin Thomson</span> 
	  <span class="n hidden">
		<span class="family-name">Thomson</span>
	  </span>
	</span>
	<span class="org vcardline">Andrew Corporation</span>
	<span class="adr">
	  <span>Andrew Building (39)</span>
<span>Wollongong University Campus</span>
<span>Northfields Avenue</span>

	  <span class="vcardline">
		<span class="locality">Wollongong</span>,  
		<span class="region">NSW</span> 
		<span class="code">2522</span>
	  </span>
	  <span class="country-name vcardline">AU</span>
	</span>
	<span class="vcardline">Phone: +61 2 4221 2915</span>

<span class="vcardline">EMail: <a href="mailto:martin.thomson@andrew.com">martin.thomson@andrew.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Salvatore Loreto</span> 
	  <span class="n hidden">
		<span class="family-name">Loreto</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  <span>Hirsalantie 11</span>

	  <span class="vcardline">
		<span class="locality">Jorvas</span>,  
		<span class="region"></span>
		<span class="code">02420</span>
	  </span>
	  <span class="country-name vcardline">Finland</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:salvatore.loreto@ericsson.com">salvatore.loreto@ericsson.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Greg Wilkins</span> 
	  <span class="n hidden">
		<span class="family-name">Wilkins</span>
	  </span>
	</span>
	<span class="org vcardline">Intalio</span>
	<span class="adr">
	  <span>644 Emerson Street, Suite 200</span>

	  <span class="vcardline">
		<span class="locality">Palo Alto</span>,  
		<span class="region"></span>
		<span class="code">94301</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:gregw@intalio.com">gregw@intalio.com</a></span>

  </address>
</div>

</body>
</html>