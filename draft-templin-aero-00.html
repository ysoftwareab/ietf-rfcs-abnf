<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Asymmetric Extended Route Optimization (AERO)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Requirements">
<link href="#rfc.section.4" rel="Chapter" title="4 Asymmetric Expedited Route Optimization (AERO)">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 AERO Link Dynamic Routing">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 AERO Node Behavior">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 AERO Node Types">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 Source Address Verification">
<link href="#rfc.section.4.2.3" rel="Chapter" title="4.2.3 AERO Host Behavior">
<link href="#rfc.section.4.2.4" rel="Chapter" title="4.2.4 AERO Router Behavior">
<link href="#rfc.section.4.2.5" rel="Chapter" title="4.2.5 AERO Gateway Behavior">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 AERO Reference Operational Scenario">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 AERO Specification">
<link href="#rfc.section.4.4.1" rel="Chapter" title="4.4.1 Sending Predirects">
<link href="#rfc.section.4.4.2" rel="Chapter" title="4.4.2 Processing Predirects and Sending Redirects">
<link href="#rfc.section.4.4.3" rel="Chapter" title="4.4.3 Proxying Redirects">
<link href="#rfc.section.4.4.4" rel="Chapter" title="4.4.4 Processing Redirects">
<link href="#rfc.section.4.4.5" rel="Chapter" title="4.4.5 Sending Periodic Predirect Keepalives">
<link href="#rfc.section.4.4.6" rel="Chapter" title="4.4.6 Reachability Considerations">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 Mobility Considerations">
<link href="#rfc.section.4.6" rel="Chapter" title="4.6 Scaling Considerations">
<link href="#rfc.section.4.7" rel="Chapter" title="4.7 Proxy Chaining">
<link href="#rfc.section.4.8" rel="Chapter" title="4.8 Backward Compatibility">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Nodes (i.e., gateways, routers and hosts) attached to link types such as multicast-capable, shared media and non-broadcast multiple access (NBMA), etc. can exchange packets as neighbors on the link. Each node should therefore be able to discover a neighboring gateway that can provide default routing services to reach off-link destinations, and should also accept redirection messages from the gateway informing it of a neighbor that is closer to the final destination. This redirect function can provide a useful route optimization, since the triangular path from the ingress link neighbor, to the gateway, and finally to the egress link neighbor may be considerably longer than the direct path between the neighbors. However, ordinary redirection may lead to operational issues on certain link types and/or in certain deployment scenarios. This document therefore introduces an Asymmetric Extended Route Optimization (AERO) capability that addresses the issues." />
  <meta name="description" content="Nodes (i.e., gateways, routers and hosts) attached to link types such as multicast-capable, shared media and non-broadcast multiple access (NBMA), etc. can exchange packets as neighbors on the link. Each node should therefore be able to discover a neighboring gateway that can provide default routing services to reach off-link destinations, and should also accept redirection messages from the gateway informing it of a neighbor that is closer to the final destination. This redirect function can provide a useful route optimization, since the triangular path from the ingress link neighbor, to the gateway, and finally to the egress link neighbor may be considerably longer than the direct path between the neighbors. However, ordinary redirection may lead to operational issues on certain link types and/or in certain deployment scenarios. This document therefore introduces an Asymmetric Extended Route Optimization (AERO) capability that addresses the issues." />
  <meta name="keywords" content="I-D, Internet-Draft" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">F. Templin, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Boeing Research &amp; Technology</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">March 30, 2011</td>
</tr>
<tr>
<td class="left">Expires: October 01, 2011</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Asymmetric Extended Route Optimization (AERO)<br />
  <span class="filename">draft-templin-aero-00.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Nodes (i.e., gateways, routers and hosts) attached to link types such as multicast-capable, shared media and non-broadcast multiple access (NBMA), etc. can exchange packets as neighbors on the link. Each node should therefore be able to discover a neighboring gateway that can provide default routing services to reach off-link destinations, and should also accept redirection messages from the gateway informing it of a neighbor that is closer to the final destination. This redirect function can provide a useful route optimization, since the triangular path from the ingress link neighbor, to the gateway, and finally to the egress link neighbor may be considerably longer than the direct path between the neighbors. However, ordinary redirection may lead to operational issues on certain link types and/or in certain deployment scenarios. This document therefore introduces an Asymmetric Extended Route Optimization (AERO) capability that addresses the issues.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on October 01, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Requirements</a>
</li>
<li>4.   <a href="#rfc.section.4">Asymmetric Expedited Route Optimization (AERO)</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">AERO Link Dynamic Routing</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">AERO Node Behavior</a>
</li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">AERO Node Types</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">Source Address Verification</a>
</li>
<li>4.2.3.   <a href="#rfc.section.4.2.3">AERO Host Behavior</a>
</li>
<li>4.2.4.   <a href="#rfc.section.4.2.4">AERO Router Behavior</a>
</li>
<li>4.2.5.   <a href="#rfc.section.4.2.5">AERO Gateway Behavior</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">AERO Reference Operational Scenario</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">AERO Specification</a>
</li>
<li>4.4.1.   <a href="#rfc.section.4.4.1">Sending Predirects</a>
</li>
<li>4.4.2.   <a href="#rfc.section.4.4.2">Processing Predirects and Sending Redirects</a>
</li>
<li>4.4.3.   <a href="#rfc.section.4.4.3">Proxying Redirects</a>
</li>
<li>4.4.4.   <a href="#rfc.section.4.4.4">Processing Redirects</a>
</li>
<li>4.4.5.   <a href="#rfc.section.4.4.5">Sending Periodic Predirect Keepalives</a>
</li>
<li>4.4.6.   <a href="#rfc.section.4.4.6">Reachability Considerations</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">Mobility Considerations</a>
</li>
<li>4.6.   <a href="#rfc.section.4.6">Scaling Considerations</a>
</li>
<li>4.7.   <a href="#rfc.section.4.7">Proxy Chaining</a>
</li>
<li>4.8.   <a href="#rfc.section.4.8">Backward Compatibility</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Acknowledgements</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Nodes (i.e., routers and hosts) attached to link types such as multicast-capable, shared media, non-broadcast multiple access (NBMA), etc. can exchange packets with each other as neighbors on the link. Each node should therefore be able to discover a neighboring gateway that can provide default routing services to reach off-link destinations, and should also accept redirection messages from the gateway informing it of a different link neighbor that is closer to the final destination. This redirect function can provide a useful route optimization, since the triangular path from the ingress link neighbor, to the gateway, and finally to the egress link neighbor may be considerably longer than the direct path between the neighbors. However, ordinary redirection may lead to operational issues on certain link types and/or in certain deployment scenarios.</p>
<p id="rfc.section.1.p.2">For example, when an ingress link neighbor accepts an ordinary redirect message from a gateway, it has no way of knowing whether the egress link neighbor is ready and willing to accept packets directly without involving the gateway. In particular, without involvement from the gateway, the egress would have no way of knowing that the ingress is authorized to forward packets from a given source address. (This is especially important for very large links, since any node on the link can spoof the network-layer source address with low probability of detection even if the link-layer source address cannot be spoofed.) Additionally, the ingress would have no way of knowing whether the direct path to the egress has failed, nor whether the final destination has moved away from the egress to some other network attachment point.</p>
<p id="rfc.section.1.p.3">Therefore, a new redirection mechanism is required that can enable a reliable one-way handshake from the egress to the ingress link node under the mediation of trusted gateways. The mechanism is asymmetric (since only the forward direction from the ingress to the egress is optimized) and extended (since the redirection extends forward to the egress before reaching back to the ingress). This document therefore introduces an Asymmetric Extended Route Optimization (AERO) capability that addresses the issues.</p>
<p id="rfc.section.1.p.4">While the AERO mechanisms were initially designed for the specific purpose of NBMA tunnel interfaces (e.g., see: <a href="#RFC2529">[RFC2529]</a><a href="#RFC5214">[RFC5214]</a><a href="#RFC5569">[RFC5569]</a><a href="#I-D.templin-intarea-vet">[I-D.templin-intarea-vet]</a>) they can also be applied to any link types that support multiple access and redirection <a href="#RFC0792">[RFC0792]</a><a href="#RFC4861">[RFC4861]</a>. The rest of this document refers to this class of links collectively as "AERO links".</p>
<p id="rfc.section.1.p.5">The AERO techniques apply to both the IPv4 <a href="#RFC0791">[RFC0791]</a> and IPv6 <a href="#RFC2460">[RFC2460]</a> protocols, as well as any other network layer protocol that includes multiple access link models that can support redirection.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.2.p.1">The terminology in the normative references apply; the following terms are defined within the scope of this document:</p>
<p><a href="#RFC2119">[RFC2119]</a>. When used in lower case (e.g., must, must not, etc.), these words MUST NOT be interpreted as described in <a href="#RFC2119">[RFC2119]</a>, but are rather interpreted as they would be in common English.</p>

<dl>
<dt>AERO link</dt>
<dd style="margin-left: 8">any multiple access link over which the AERO mechanisms can be applied.</dd>
<dt>AERO node</dt>
<dd style="margin-left: 8">a gateway, router or host connected to an AERO link.</dd>
<dt>AERO gateway</dt>
<dd style="margin-left: 8">a router that configures an advertising router interface on the AERO link, and that can provide default routing services for forwarding packets to off-link destinations.</dd>
<dt>AERO router</dt>
<dd style="margin-left: 8">a router that configures a non-advertising router interface on the AERO link, and that connects End User Networks to the AERO link.</dd>
<dt>AERO host</dt>
<dd style="margin-left: 8">a simple host on the AERO link.</dd>
<dt>ingress AERO node ("ingress")</dt>
<dd style="margin-left: 8">a node that injects packets into the AERO link.</dd>
<dt>egress AERO node ("egress")</dt>
<dd style="margin-left: 8">a node that removes packets from the AERO link.</dd>
</dl>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Requirements</h1>
<p id="rfc.section.3.p.1">The route optimization mechanism must satisfy the following requirements:</p>
<p></p>

<dl>
<dt>Req 1: Off-load traffic from performance-critical gateways.</dt>
<dd style="margin-left: 8">The mechanism must offload sustained transit though a gateway that would become a traffic concentrator.</dd>
<dt>Req 2: Support route optimization.</dt>
<dd style="margin-left: 8">Ingress nodes must be able to send packets directly to egress nodes without involving a gateway as an intermediary hop.</dd>
<dt>Req 3: Support multiple levels of hierarchy.</dt>
<dd style="margin-left: 8">For scaling purposes, allow multiple levels of hierarchy in which gateways in higher levels have progressively more topology knowledge than those in lower levels.</dd>
<dt>Req 4: Do not circumvent ingress filtering.</dt>
<dd style="margin-left: 8">The mechanism must not open an attack vector where network-layer source address spoofing is enabled even when link-layer source address spoofing is disabled.</dd>
<dt>Req 5: Do not open expose packets to loss due to filtering.</dt>
<dd style="margin-left: 8">The ingress node must have a way of knowing that the egress node will accept its forwarded packets.</dd>
<dt>Req 6: Do not open expose packets to loss due to failure of the path to the egress.</dt>
<dd style="margin-left: 8">The ingress node must have a way of discovering whether the egress has gone unreachable on the route optimized path.</dd>
<dt>Req 7: Do not introduce routing loops.</dt>
<dd style="margin-left: 8">The gateway must not perform a route optimization that would cause a routing loop to form.</dd>
<dt>Req 8: Support mobility.</dt>
<dd style="margin-left: 8">The mechanism must continue to work even if the final destination node/network moves from a first egress node and re-associates with a second egress node.</dd>
</dl>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Asymmetric Expedited Route Optimization (AERO)</h1>
<p id="rfc.section.4.p.1">The following sections specify an Asymmetric Extended Route Optimization (AERO) capability that fulfills the requirements specified in Section 3.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#routing-proto" id="routing-proto">AERO Link Dynamic Routing</a>
</h1>
<p id="rfc.section.4.1.p.1">In many AERO link use case scenarios (e.g., enterprise networks, small and stable MANETs, etc.), AERO gateways and routers can engage in a proactive dynamic routing protocol (e.g., OSPF, RIP, IS-IS, etc.) so that routing/forwarding tables can be populated and standard forwarding between routers can be used. In other scenarios (e.g., large ISP networks, cellular service provider networks, dynamic MANETs, etc.), this might be impractical dues to scaling issues.</p>
<p id="rfc.section.4.1.p.2">When a proactive dynamic routing protocol cannot be used, the on-demand dynamic routing capabilities specified in this section should be used.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#no-onlink-prefix" id="no-onlink-prefix">AERO Node Behavior</a>
</h1>
<p id="rfc.section.4.2.p.1">The following sections discuss characteristics of nodes attached to links over which AERO can be used:</p>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#nodetype" id="nodetype">AERO Node Types</a>
</h1>
<p id="rfc.section.4.2.1.p.1">AERO gateways configure their AERO link interfaces as advertising router interfaces (see: <a href="#RFC4861">[RFC4861]</a>, Section 6.2.2), and therefore may send Router Advertisement (RA) messages that include non-zero Router Lifetimes.</p>
<p id="rfc.section.4.2.1.p.2">AERO routers configure their AERO link interfaces as non-advertising router interfaces.</p>
<p id="rfc.section.4.2.1.p.3">AERO hosts configure their AERO link interfaces as simple host interfaces.</p>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> <a href="#verify" id="verify">Source Address Verification</a>
</h1>
<p id="rfc.section.4.2.2.p.1">AERO nodes must employ a source address verification check for the packets they receive on an AERO interface; namely, the node considers the network-layer source address correct for the link-layer source address if:</p>
<p><a href="#predirect">Section 4.4</a>.</p>

<ul>
<li>the link-layer source address is the address of an AERO gateway, or</li>
<li>the link-layer source address is explicitly linked to the network-layer source address (i.e., through stateless or stateful address mapping), or</li>
<li>a forwarding table entry exists that lists the packet's link-layer source address as the link layer address corresponding to the next hop toward the network-layer source address on the AERO link.</li>
</ul>

<p>The latter of these checks can be established through static configuration, a proactive dynamic routing protocol, or through the AERO mechanisms specified in </p>
<h1 id="rfc.section.4.2.3">
<a href="#rfc.section.4.2.3">4.2.3.</a> <a href="#host-behave" id="host-behave">AERO Host Behavior</a>
</h1>
<p id="rfc.section.4.2.3.p.1">AERO hosts send Router Solicitation (RS) messages to obtain RA messages from an AERO gateway. Whether or not non-link-local prefixes are advertised, the host can acquire network-layer addresses via the gateway, e.g., through the use of DHCP stateful address autoconfiguration <a href="#RFC2131">[RFC2131]</a><a href="#RFC3315">[RFC3315]</a>).</p>
<p id="rfc.section.4.2.3.p.2">After the host receives addresses, it assigns them to its AERO interface and forwards any of its outbound packets via the gateway as a default router. The host may subsequently receive redirection messages from the gateway listing a better next hop.</p>
<h1 id="rfc.section.4.2.4">
<a href="#rfc.section.4.2.4">4.2.4.</a> <a href="#router-behave" id="router-behave">AERO Router Behavior</a>
</h1>
<p id="rfc.section.4.2.4.p.1">AERO routers send RS messages to obtain RA messages from an AERO gateway, i.e., they act as "hosts" on their non-advertising AERO link router interfaces.</p>
<p id="rfc.section.4.2.4.p.2">Routers can also acquire prefixes, e.g., through the use of DHCPv6 Prefix Delegation <a href="#RFC3633">[RFC3633]</a> via an AERO gateway in the same fashion as described above for host-based stateful address autoconfiguration.</p>
<p id="rfc.section.4.2.4.p.3">After the router acquires prefixes, it can sub-delegate them to nodes and links within its attached End User Networks (EUNs), then can forward any outbound packets coming from its EUNs via the gateway. The router may subsequently receive redirection messages from the gateway listing a better next hop.</p>
<h1 id="rfc.section.4.2.5">
<a href="#rfc.section.4.2.5">4.2.5.</a> <a href="#gateway-behave" id="gateway-behave">AERO Gateway Behavior</a>
</h1>
<p id="rfc.section.4.2.5.p.1">AERO gateways respond to RS messages from hosts and routers on the AERO link by returning an RA message. Gateways further configure a DHCP relay or server function on their AERO links.</p>
<p id="rfc.section.4.2.5.p.2">When the gateway completes a DHCP address or prefix delegation transaction (i.e., either as a DHCP relay or a DHCP server), it establishes forwarding table entries that list the link-layer address of the DHCP client as the link-layer address of the next hop toward the delegated addresses/prefixes.</p>
<p id="rfc.section.4.2.5.p.3">When the gateway forwards a packet out the same AERO interface it arrived on, it initiates an AERO route optimization procedure as specified in <a href="#predirect">Section 4.4</a>.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#avoidance-fig" id="avoidance-fig">AERO Reference Operational Scenario</a>
</h1>
<p><a href="#no-onlink-prefix-fig">Figure 1</a> depicts a reference AERO network topology. IPv6 is used only as an example network layer protocol, and the same fundamental AERO techniques can be applied for other network layer protocols. The figure shows an AERO gateway ('A'), two non-advertising AERO routers ('B', 'D'), an AERO host ('F'), and three ordinary IPv6 hosts ('C', 'E', 'G') in a typical operational scenario:</p>
<div id="#rfc.figure.1"></div>
<div id="#no-onlink-prefix-fig"></div>
<pre>     .-(::::::::)      2001:db8:3::1
  .-(::: IPv6 :::)-.  +-------------+
 (:::: Internet ::::) | IPv6 Host G |
  `-(::::::::::::)-'  +-------------+
     `-(::::::)-'
 ,.................,
 |companion gateway|
 '.................'      +---------------+
  +--------------+        |    Host F     |
  |  Gateway A   |        +---------------+
  +--------------+          2001:db8:2:1
        L3(A)                   L3(F)
        L2(A)                   L2(F)
          |       AERO Link       |
    X-----+--+-----------------+--+---X
             |                 |
            L2(B)            L2(D)                   .-.
            L3(B)            L3(D)                ,-(  _)-.
  +--------------+         +--------------+    .-(_ IPv6  )-.
  |   Router B   |         |   Router D   |--(__    EUN      )
  +--------------+         +--------------+     `-(______)-'
   2001:db8::/48            2001:db8:1::/48           |
          |                                     2001:db8:1::1
         .-.                                   +-------------+
      ,-(  _)-.       2001:db8::1              | IPv6 Host E |
   .-(_ IPv6  )-.   +-------------+            +-------------+
 (__    EUN      )--| IPv6 Host C |
    `-(______)-'    +-------------+
</pre>
<p id="rfc.section.4.3.p.2">In <a href="#no-onlink-prefix-fig">Figure 1</a>, Gateway 'A' connects to the AERO link and also connects to the IPv6 Internet, either directly or via a companion gateway. 'A' configures an AERO link interface with a link-local network-layer address L3(A) and with link-layer address L2(A). 'A' next arranges to add the link-layer address L2(A) to the list of valid gateways for the link.</p>
<p id="rfc.section.4.3.p.3">Router 'B' connects to one or more IPv6 End User Networks (EUNs) and also connects to the AERO link via an interface with a link-local network-layer address L3(B) and with link-layer address L2(B). 'B' next configures a default IPv6 route with next-hop address L3(A) via the AERO interface, then receives the IPv6 prefix 2001:db8::/48 through a DHCPv6 prefix delegation exchange via 'A'. 'B' finally sub-delegates the prefix to its attached EUNs, where IPv6 host 'C' autoconfigures the address 2001:db8::1.</p>
<p id="rfc.section.4.3.p.4">Router 'D' connects to the AERO link via an interface with addresses L3(D)/L2(D), configures a default IPv6 route with next-hop address L3(A) via the AERO interface, and receives a DHCPv6 prefix delegation of 2001:db8:1::/48 in the same fashion as for router 'B'.  'D' finally sub-delegates the prefix to its attached EUNs, where IPv6 host 'E' autoconfigures IPv6 address 2001:db8:1::1.</p>
<p id="rfc.section.4.3.p.5">Host 'F' connects to the AERO link via an interface with addresses L3(F)/L2(F). 'F' next configures a default IPv6 route with next-hop address L3(A) via the AERO interface, then receives the IPv6 address 2001:db8:2::1 from a DHCPv6 address configuration exchange via 'A'.  When 'F' receives the IPv6 address, it assigns the address to the AERO interface but does not assign a non-link-local IPv6 prefix to the interface.</p>
<p id="rfc.section.4.3.p.6">Finally, IPv6 host 'G' connects to an IPv6 network outside of the AERO link domain. 'G' configures its IPv6 interface in a manner specific to its attached IPv6 link, and autoconfigures the IPv6 address 2001:db8:3::1.</p>
<p id="rfc.section.4.3.p.7">In these arrangements, 'A' must maintain routes that associate the delegated IPv6 addresses/prefixes with the correct routers and/or hosts on the AERO link. The routers and hosts must maintain at least a default route that points to gateway 'A', and can discover more-specific routes either via a proactive dynamic routing protocol or via the AERO mechanisms specified in <a href="#predirect">Section 4.4</a>.</p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#predirect" id="predirect">AERO Specification</a>
</h1>
<p><a href="#no-onlink-prefix-fig">Figure 1</a> depicts a reference operational scenario including an AERO link. The figure shows an AERO gateway ('A'), two AERO routers ('B', 'D'), an AERO host ('F') and three ordinary IPv6 hosts ('C', 'E', 'G') in a typical deployment configuration. We now discuss the operation of AERO with respect to this reference scenario.</p>
<p id="rfc.section.4.4.p.2">With reference to <a href="#no-onlink-prefix-fig">Figure 1</a>, when host 'C' sends a packet with source address 'C' and destination address 'E', the packet is first forwarded over 'C's attached EUN to router 'B'. 'B' then forwards the packet over the AERO interface to gateway 'A', which then forwards the packet to router 'D', where the packet is finally forwarded to host 'E' over 'E's attached EUN. When 'A' forwards the packet back out on its advertising AERO interface, it must arrange to redirect 'B' toward 'D' as a better next hop node on the AERO link that is closer to the final destination 'E'. However, this redirection process should only take place if there is assurance that both 'B' and 'D' are willing participants.</p>
<p id="rfc.section.4.4.p.3">Consider a first alternative in which 'A' informs 'B' only and does not inform 'D' (i.e., "classic redirection"). In that case, 'D' has no way of knowing that 'B' is authorized to forward packets from a given source address. Also, 'B' has no way of knowing whether 'D' is willing to accept its packets, nor whether 'D' is even reachable. Finally, 'B' has no way of knowing whether the final destination has moved away from 'D'.</p>
<p id="rfc.section.4.4.p.4">Consider also a second alternative in which 'A' informs both 'B' and 'D' separately via independent redirection messages (i.e., "augmented redirection"). In that case, several conditions can occur that could result in communications failures. First, if 'B' receives the redirection message but 'D' does not, subsequent packets sent by 'B' would be dropped due to filtering since 'D' would not have a forwarding table entry to verify their source addresses. Second, if 'D' receives the redirection message but 'B' does not, subsequent packets sent in the reverse direction by 'D' would be lost. Finally, timing issues surrounding the establishment and garbage collection of forwarding table entries at 'B' and 'D' could yield unpredictable behavior. For example, unless the timing were carefully coordinated through some form of synchronization loop, there would invariably be instances in which one node has the correct forwarding table state and the other node does not resulting in non-deterministic packet loss.</p>
<p id="rfc.section.4.4.p.5">Since neither of these alternatives can satisfy the requirements listed in Section 3, a new redirection technique is needed. In particular, when 'A' forwards a packet from 'B' out the same AERO interface toward 'D', 'A' must first send a "Predirect" message forward to 'D' to inform it that 'B' is authorized to produce packets using source address 'C'. After 'D' receives the Predirect, it sends a "Redirect" message back to 'B' via 'A' as a trusted intermediary. When 'B' receives the Redirect, it knows that 'D' will accept the packets it sends with source address 'C' as long as 'D' retains the forwarding table entry. This process is known as Asymmetric Extended Route Optimization (AERO), which stands in contrast to the classical and augmented redirection approaches. The following subsections therefore specify the AERO redirection steps necessary to support the reference operational scenario.</p>
<h1 id="rfc.section.4.4.1">
<a href="#rfc.section.4.4.1">4.4.1.</a> Sending Predirects</h1>
<p id="rfc.section.4.4.1.p.1">When a gateway forwards a packet out the same AERO interface that it arrived on, the gateway sends a "Predirect" message forward to the egress AERO node instead of sending a Redirect message back to the ingress node. The Predirect message is simply an AERO-specific version of an ordinary Redirect message. In the case of IPv6 as the network layer protocol, the Predirect format is the same as depicted in Section 4.5 of <a href="#RFC4861">[RFC4861]</a>, and is identified by two new backward-compatible bits taken from the Reserved field as shown in <a href="#predirect-bits">Figure 2</a>:</p>
<div id="#rfc.figure.2"></div>
<div id="#predirect-bits"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Type (=137)  |   Code (=0)   |          Checksum             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|A|P|                       Reserved                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                       Target Address                          +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                     Destination Address                       +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Options ...
+-+-+-+-+-+-+-+-+-+-+-+-
</pre>
<p></p>
<p id="rfc.section.4.4.1.p.3">Where the new bits are defined as:</p>
<p></p>

<dl>
<dt>A (1)</dt>
<dd style="margin-left: 8">the "AERO" bit. Set to 1 to indicate an AERO-specific Redirect message, and set to 0 to indicate an ordinary IPv6 Redirect message.</dd>
<dt>P (1)</dt>
<dd style="margin-left: 8">the "Predirect" bit. Set to 1 to indicate a Predirect message, and set to 0 to indicate a Redirect response to a Predirect message. (This bit is valid only when the A bit is set to 1.)</dd>
</dl>
<p id="rfc.section.4.4.1.p.5">In the reference operational scenario, when gateway 'A' forwards a packet sent by 'B' toward 'D', it also sends a Predirect message forward toward 'D', subject to rate limiting (see Section 8.2 of <a href="#RFC4861">[RFC4861]</a>). 'A' prepares the Predirect message in a similar fashion as for an ordinary IPv6 Redirect message as follows:</p>
<p></p>

<ul>
<li>the link-layer source address is set to 'L2(A)'</li>
<li>the link-layer destination address is set to 'L2(D)'</li>
<li>the network-layer source address is set to 'L3(B)'.</li>
<li>the network-layer destination address is set to 'L3(D)'.</li>
<li>the Predirect Target and Destination Addresses are both set to 'L3(B)'.</li>
<li>on links that require stateful address mapping, the Predirect message includes a Target Link Layer Address Option (TLLAO) set to 'L2(B)'.</li>
<li>the Predirect message includes Route Information Options (RIOs) <a href="#RFC4191">[RFC4191]</a> that encode prefixes taken from 'B's address/prefix delegations, including one that covers the source address of the originating packet.</li>
<li>the Predirect message includes a Redirected Header Option (RHO) that contains the first 128 bytes of the originating packet beginning with the network-layer header (or up to the remainder of the packet if there are fewer than 128 bytes).</li>
<li>the A and P bits in the Predirect message header are both set to 1.</li>
</ul>
<p id="rfc.section.4.4.1.p.7">'A' then sends the Predirect message forward to 'D'.</p>
<h1 id="rfc.section.4.4.2">
<a href="#rfc.section.4.4.2">4.4.2.</a> Processing Predirects and Sending Redirects</h1>
<p id="rfc.section.4.4.2.p.1">When an AERO router or host receives a Predirect message, it validates the message according to the appropriate redirect message validation rules (e.g., Section 8.1 of <a href="#RFC4861">[RFC4861]</a> for IPv6). The node further accepts the message only if it came from the link-layer address of either a trusted gateway or the current previous hop on the AERO link for the source address of the originating packet encapsulated in the RHO.  Finally, the node only processes the message if the destination address of the originating packet encapsulated in the RHO is covered by one of its CURRENT delegated addresses/prefixes (see <a href="#mobility">Section 4.5</a>).</p>
<p id="rfc.section.4.4.2.p.2">In the reference operational scenario, when router 'D' receives the Predirect message from the gateway it creates forwarding table entries with the prefixes encoded in RIO options as the target prefixes, and associates the forwarding table entries with a node structure (e.g., in a neighbor cache) that stores the source address of the Predirect message (i.e., 'L3(B)'). 'D' places the node structure in the FILTERING state, then sets/resets a filtering expiration timer value of 40 seconds. If the filtering timer later expires, 'D' clears the FILTERING state. If the node structure is not in the FORWARDING state, 'D' then deletes the node structure and all of its associated forwarding table entries. (This suggests that 'D's AERO interface should maintain a private forwarding table separate from the primary forwarding table, since the node structure and forwarding table entries must be managed by the AERO interface itself.)</p>
<p id="rfc.section.4.4.2.p.3">After processing the Predirect message and establishing the forwarding table entry, 'D' prepares a Redirect message in response to the Predirect as follows:</p>
<p></p>

<ul>
<li>the link-layer source address is set to 'L2(D)'</li>
<li>the link-layer destination address is set to 'L2(A)'</li>
<li>the network-layer source address is set to 'L3(D)'.</li>
<li>the network-layer destination address is set to 'L3(B)'.</li>
<li>the Redirect Target and the Redirect Destination Addresses are both set to 'L3(D)'.</li>
<li>on links that require stateful address mapping, the Redirect message includes a TLLAO set to 'L2(D)'.</li>
<li>the Redirect message includes an RHO copied from the corresponding Predirect message.</li>
<li>the (A, P) bits in the Redirect message header are set to (1, 0).</li>
</ul>
<p id="rfc.section.4.4.2.p.5">After 'D' prepares the Redirect message, it sends the message to 'A'. (Note that the Redirect message does not include RIOs, since the gateway is the only authoritative source of routing information and will supply RIOs when it proxies the message.)</p>
<h1 id="rfc.section.4.4.3">
<a href="#rfc.section.4.4.3">4.4.3.</a> Proxying Redirects</h1>
<p id="rfc.section.4.4.3.p.1">When an AERO gateway receives a Redirect message, it accepts the message only if it satisfies the redirect message validation rules.  The gateway further accepts the message only if it came from the link-layer address of the current next hop toward the destination address of the originating packet encapsulated in the RHO. The gateway then "proxies" the Redirect message back to the original ingress AERO node as described below.</p>
<p id="rfc.section.4.4.3.p.2">In the reference operational scenario, 'A' receives the Redirect message from 'D' then proxies the message back toward 'B'. In particular, 'A' adds RIOs to the message that encode 'D's address/prefix delegations. Without decrementing the hopcount in the Redirect message, 'A' next changes the link-layer source address of the message to 'L2(A)' and changes the link-layer destination address to 'L2(B)'. 'A' then sends this proxied Redirect message to 'B'.</p>
<h1 id="rfc.section.4.4.4">
<a href="#rfc.section.4.4.4">4.4.4.</a> Processing Redirects</h1>
<p id="rfc.section.4.4.4.p.1">When an AERO router or host receives a Redirect message, it validates the message according to the appropriate redirect message validation rules. The node further accepts the message only if it came from the link-layer address of either a trusted gateway or the current next hop on the AERO link for the destination address of the originating packet encapsulated in the RHO.</p>
<p id="rfc.section.4.4.4.p.2">In the reference operational scenario, 'B' receives the (proxied) Redirect message then creates forwarding table entries with the prefixes encoded in RIO options as the target prefixes. 'B' further associates the forwarding table entries with a node structure (e.g., in a neighbor cache) that stores the source address of the Predirect message (i.e., 'L3(D)'). 'B' places the node structure in the FORWARDING state, then sets/resets a filtering expiration timer value of 30 seconds. If the filtering timer later expires, 'B' clears the FORWARDING state. If the node structure is not in the FILTERING state, 'B' then deletes the node structure and all of its associated forwarding table entries.</p>
<p id="rfc.section.4.4.4.p.3">Now, 'B' has a node structure for 'D' in the FORWARDING state, and 'D' has a node structure for 'B' in the FILTERING state.  Therefore, 'B' may forward ordinary network-layer data packets with destination addresses covered by 'D's prefixes directly to 'D' without involving 'A'. 'D' will in turn accept the packets since it has a forwarding table entry authorizing 'B' to forward packets with source addresses covered by 'B's prefixes.</p>
<p id="rfc.section.4.4.4.p.4">To enable packet forwarding in the reverse direction, a separate AERO operation is required which is the mirror-image of the forward AERO operation described above, i.e., the forward and reverse AERO operations are asymmetric. Following the reverse operation, packets can be exchanged bidirectionally without involving 'A'.</p>
<h1 id="rfc.section.4.4.5">
<a href="#rfc.section.4.4.5">4.4.5.</a> Sending Periodic Predirect Keepalives</h1>
<p id="rfc.section.4.4.5.p.1">In order to prevent forwarding table entries from expiring while data packets are actively flowing, the ingress node can peridoically send Predircet messages directly to the egress node (subject to rate limiting) to solicit Redirect messages. In the reference operational scenario, when 'B' forwards a packet to 'D' and wishes to update the corresponding FORWARDING state timer, 'B' can also send a Predirect message directly to 'D' prepared as follows:</p>
<p></p>

<ul>
<li>the link-layer source address is set to 'L2(B)'.</li>
<li>the link-layer destination address is set to 'L2(D)'.</li>
<li>the network-layer source address is set to 'L3(B)'.</li>
<li>the network-layer destination address is set to 'L3(D)'.</li>
<li>the Predirect Target and Destination Addresses are both set to 'L3(B)'.</li>
<li>the Predirect message includes a Redirected Header Option (RHO) that contains the first 128 bytes of the originating packet beginning with the network-layer header (or up to the remainder of the packet if there are fewer than 128 bytes).</li>
<li>the A and P bits in the Predirect message header are both set to 1.</li>
</ul>
<p id="rfc.section.4.4.5.p.3">When 'D' receives the Predirect message, it accepts the message only if it satisfies the redirect message validation rules. The node further accepts the message only if it came from the current previous hop on the AERO link for the source address of the originating packet encapsulated in the RHO. 'D' then resets its FILTERING expiration timer for node 'B' to 40 seconds, and sends a Redirect message directly to 'B' prepared as follows:</p>
<p></p>

<ul>
<li>the link-layer source address is set to 'L2(D)'.</li>
<li>the link-layer destination address is set to 'L2(B)'.</li>
<li>the network-layer source address is set to 'L3(D)'.</li>
<li>the network-layer destination address is set to 'L3(B)'.</li>
<li>the Redirect Target and Destination Addresses are both set to 'L3(D)'.</li>
<li>the Redirect message includes an RHO copied from the corresponding Predirect message.</li>
<li>the (A, P) bits in the Redirect message header are set to (1, 0).</li>
</ul>

<p>When 'B' receives the Redirect message, it accepts the message only if it satisfies the redirect message validation rules.  The node further accepts the message only if it came from the current next hop on the AERO link for the source address of the originating packet encapsulated in the RHO. 'B' then resets its FORWARDING expiration timer for node 'D' to 30 seconds.</p>
<p id="rfc.section.4.4.5.p.5">Note that in these direct neighbor to neighbor exchanges, neither the Predirect nor Redirect message contain RIOs, since gateways are the only authoritative source of routing information. Therefore, AERO routers and hosts should not include RIOs in the Predirects/Redirects they send, and they must ignore any RIOs included in received Predirect/Redirect messages that did not come from a trusted gateway.</p>
<h1 id="rfc.section.4.4.6">
<a href="#rfc.section.4.4.6">4.4.6.</a> <a href="#reachable" id="reachable">Reachability Considerations</a>
</h1>
<p id="rfc.section.4.4.6.p.1">When an ingress node receives a Redirect message informing it of a direct path to a new egress, there is a question in point as to whether the new egress can be reached directly without involving the gateway as an intermediary. In some environments, it may be reasonable for the ingress to (optimistically) assume that the new egress is reachable, and to immediately begin forwarding data packets to the egress without testing reachability.</p>
<p id="rfc.section.4.4.6.p.2">In environments in which an optimistic assumption of reachability may be inappropriate, however, the ingress can defer the redirection until it tests the direct path to the egress by sending a direct Predirect message to elicit a Redirect as specified in Section 4.4.5. If the ingress is unable to elicit a Redirect message after a small number of attempts, it should consider the direct path to the egress as unusable.</p>
<p id="rfc.section.4.4.6.p.3">In either case, the ingress can process any link errors corresponding to the data packets sent directly to the egress as a hint that the direct path has either failed or has become intermittent.</p>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> <a href="#mobility" id="mobility">Mobility Considerations</a>
</h1>
<p id="rfc.section.4.5.p.1">An AERO link egress router 'D' can configure both a non-advertising router interface on a provider AERO link and an advertising router interface to provide gateway services to nodes in EUNs. When node 'E' in an EUN that has obtained addresses/prefixes moves to a different network point of attachment, however, 'E' can release its address/prefix delegations via 'D' and re-establish them via a different gateway.</p>
<p id="rfc.section.4.5.p.2">When 'E' releases its address/prefix delegations via 'D', 'D' marks the forwarding table entries that cover the addresses/prefixes as DEPARTED (i.e., it clears the CURRENT state). 'D' therefore ceases to respond to Predirect messages correlated with the DEPARTED entries, and also schedules a garbage-collection timer of 60 seconds, after which it deletes the DEPARTED entries.</p>
<p id="rfc.section.4.5.p.3">When 'D' receives packets destined to an address covered by the DEPARTED forwarding table entries, it forwards them to the last-known EUN link-layer address of 'E' as a means for avoiding mobility-related packet loss during routing changes. 'D' also returns a NULL Redirect message to inform the correspondent 'B' of the departure. The Redirect message is prepared as follows:</p>
<p></p>

<ul>
<li>the link-layer source address is set to 'L2(D)'.</li>
<li>the link-layer destination address is set to 'L2(B)'.</li>
<li>the network-layer source address is set to 'L3(D)'.</li>
<li>the network-layer destination address is set to 'L3(B)'.</li>
<li>the Redirect Target and Destination Addresses are both set to NULL.</li>
<li>the Redirect message includes an RHO copied from the corresponding Predirect message.</li>
<li>the (A, P) bits in the Redirect message header are set to (1, 0).</li>
</ul>

<p>Eventually, any correspondents will receive such a NULL Redirect message and will cease to use 'D' as a next hop. They will then revert to sending packets destined to 'E' via their gateways and will receive new Redirect messages to discover that 'E' is now associated with a new egress router. Note that any packets forwarded by 'D' via a forwarding table entry in the DEPARTED state may be lost if the mobile node moves off-link with respect to its previous EUN point of attachment. This should not be a problem for large links (e.g., large cellular network deployments, large ISP networks, etc.) in which all/most mobility events are intra-link.</p>
<h1 id="rfc.section.4.6">
<a href="#rfc.section.4.6">4.6.</a> <a href="#scaling" id="scaling">Scaling Considerations</a>
</h1>
<p><a href="#no-onlink-prefix-fig">Figure 1</a> depicts a reference network topology with only a single gateway on the AERO link. In order to support larger numbers of AERO routers and hosts, the AERO link can deploy more gateways to support load balancing and generally shortest-path routing.</p>
<p id="rfc.section.4.6.p.2">Such an arrangement requires that the gateways participate in a routing protocol instance (e.g., iBGP) so that address/prefix delegations can be mapped to the correct gateway. The routing protocol instance can be configured as either a full mesh topology involving all gateways, or as a partial mesh topology with each AERO link gateway associating with one or more backhaul network companion gateways and a full mesh between companion gateways.</p>
<h1 id="rfc.section.4.7">
<a href="#rfc.section.4.7">4.7.</a> <a href="#chaining" id="chaining">Proxy Chaining</a>
</h1>
<p id="rfc.section.4.7.p.1">In large AERO link deployments, there may be many gateways - each serving many AERO routers and hosts. The gateways then either require full topology knowledge, or a default route to a companion gateway that does have full topology knowledge. For example, if AERO node 'A' connects to gateway 'B', and AERO node 'E' connects to gateway 'D', then 'B' and 'D' must either have full topology knowledge or have a default route to a companion gateway (e.g., 'C') that does.</p>
<p id="rfc.section.4.7.p.2">In that case, when 'A' forwards an initial packet destined to an end system behind 'E', 'B' generates a Predirect message toward 'C', which proxies the message toward 'D' which finally proxies the message toward 'E'.</p>
<p id="rfc.section.4.7.p.3">In the reverse direction, when 'E' sends a Redirect response message back to 'A', it first sends the message to 'D', which proxies the message toward 'C', which proxies the message toward 'B', which finally proxies the message toward 'A'.</p>
<h1 id="rfc.section.4.8">
<a href="#rfc.section.4.8">4.8.</a> <a href="#backward" id="backward">Backward Compatibility</a>
</h1>
<p id="rfc.section.4.8.p.1">If a legacy host or router receives an AERO Redirect or Predirect message, it will process the message as if it were an ordinary Redirect. This will cause no harmful effects, since the legacy system will ignore the 'A' and P' bits in the Reserved field, and will also ignore any RIOs that are included. The values encoded in the Redirect message target and destination addresses will also not cause the legacy node to create incorrect routing state. The mechanism therefore causes no harm to legacy systems, and supports natural incremental deployment.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.5.p.1">There are no IANA considerations for this document.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#secure" id="secure">Security Considerations</a>
</h1>
<p id="rfc.section.6.p.1">This document enables ingress filtering, and therefore improves the security of AERO links.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#ack" id="ack">Acknowledgements</a>
</h1>
<p id="rfc.section.7.p.1">Discussions both on the v6ops list and in private exchanges helped shape some of the concepts in this work. Individuals who contributed insights include Mikael Abrahamsson, Fred Baker, Brian Carpenter, Joel Halpern, Lee Howard,</p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC0791">[RFC0791]</b></td>
<td class="top">
<a title="University of Southern California (USC)/Information Sciences Institute">Postel, J.</a>, "<a href="http://tools.ietf.org/html/rfc791">Internet Protocol</a>", STD 5, RFC 791, September 1981.</td>
</tr>
<tr>
<td class="reference"><b id="RFC0792">[RFC0792]</b></td>
<td class="top">
<a title="University of Southern California (USC)/Information Sciences Institute">Postel, J.</a>, "<a href="http://tools.ietf.org/html/rfc792">Internet Control Message Protocol</a>", STD 5, RFC 792, September 1981.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2460">[RFC2460]</b></td>
<td class="top">
<a href="mailto:deering@cisco.com" title="Cisco Systems, Inc.">Deering, S.E.</a> and <a href="mailto:hinden@iprg.nokia.com" title="Nokia">R.M. Hinden</a>, "<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>", RFC 2460, December 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4861">[RFC4861]</b></td>
<td class="top">
<a>Narten, T.</a>, <a>Nordmark, E.</a>, <a>Simpson, W.</a> and <a>H. Soliman</a>, "<a href="http://tools.ietf.org/html/rfc4861">Neighbor Discovery for IP version 6 (IPv6)</a>", RFC 4861, September 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4191">[RFC4191]</b></td>
<td class="top">
<a>Draves, R.</a> and <a>D. Thaler</a>, "<a href="http://tools.ietf.org/html/rfc4191">Default Router Preferences and More-Specific Routes</a>", RFC 4191, November 2005.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3315">[RFC3315]</b></td>
<td class="top">
<a>Droms, R.</a>, <a>Bound, J.</a>, <a>Volz, B.</a>, <a>Lemon, T.</a>, <a>Perkins, C.</a> and <a>M. Carney</a>, "<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>", RFC 3315, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3633">[RFC3633]</b></td>
<td class="top">
<a>Troan, O.</a> and <a>R. Droms</a>, "<a href="http://tools.ietf.org/html/rfc3633">IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6</a>", RFC 3633, December 2003.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.templin-intarea-vet">[I-D.templin-intarea-vet]</b></td>
<td class="top">
<a>Templin, F</a>, "<a href="http://tools.ietf.org/html/draft-templin-intarea-vet-31">Virtual Enterprise Traversal (VET)</a>", Internet-Draft draft-templin-intarea-vet-31, November 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2131">[RFC2131]</b></td>
<td class="top">
<a href="mailto:droms@bucknell.edu" title="Computer Science Department">Droms, R.</a>, "<a href="http://tools.ietf.org/html/rfc2131">Dynamic Host Configuration Protocol</a>", RFC 2131, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2529">[RFC2529]</b></td>
<td class="top">
<a href="mailto:brian@hursley.ibm.com" title="IBM United Kingdom Laboratories">Carpenter, B.</a> and <a href="mailto:cmj@3Com.com" title="3Com Corporation">C. Jung</a>, "<a href="http://tools.ietf.org/html/rfc2529">Transmission of IPv6 over IPv4 Domains without Explicit Tunnels</a>", RFC 2529, March 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5214">[RFC5214]</b></td>
<td class="top">
<a>Templin, F.</a>, <a>Gleeson, T.</a> and <a>D. Thaler</a>, "<a href="http://tools.ietf.org/html/rfc5214">Intra-Site Automatic Tunnel Addressing Protocol (ISATAP)</a>", RFC 5214, March 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5569">[RFC5569]</b></td>
<td class="top">
<a>Despres, R.</a>, "<a href="http://tools.ietf.org/html/rfc5569">IPv6 Rapid Deployment on IPv4 Infrastructures (6rd)</a>", RFC 5569, January 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Fred L. Templin</span> editor
	  <span class="n hidden">
		<span class="family-name">Templin</span>
	  </span>
	</span>
	<span class="org vcardline">Boeing Research & Technology</span>
	<span class="adr">
	  <span>P.O. Box 3707 MC 7L-49</span>

	  <span class="vcardline">
		<span class="locality">Seattle</span>,  
		<span class="region">WA</span> 
		<span class="code">98124</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:fltemplin@acm.org">fltemplin@acm.org</a></span>

  </address>
</div>

</body>
</html>