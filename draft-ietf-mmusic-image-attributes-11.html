<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Negotiation of Generic Image Attributes in SDP</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements">
<link href="#rfc.section.2" rel="Chapter" title="2 Conventions, Definitions and Acronyms">
<link href="#rfc.section.3" rel="Chapter" title="3 Specification of the 'imageattr' SDP Attribute">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Attribute syntax">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Overall view of syntax">
<link href="#rfc.section.3.1.1.1" rel="Chapter" title="3.1.1.1 Parameter rules">
<link href="#rfc.section.3.1.1.2" rel="Chapter" title="3.1.1.2 Offer/answer rules">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Considerations">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 No imageattr in 1st offer">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Different payload type numbers in offer and answer">
<link href="#rfc.section.3.2.3" rel="Chapter" title="3.2.3 Asymmetry">
<link href="#rfc.section.3.2.4" rel="Chapter" title="3.2.4 sendonly and recvonly">
<link href="#rfc.section.3.2.5" rel="Chapter" title="3.2.5 Sample aspect ratio">
<link href="#rfc.section.3.2.6" rel="Chapter" title="3.2.6 SDPCapNeg support">
<link href="#rfc.section.3.2.7" rel="Chapter" title="3.2.7 Interaction with codec parameters">
<link href="#rfc.section.3.2.7.1" rel="Chapter" title="3.2.7.1 H.263">
<link href="#rfc.section.3.2.7.2" rel="Chapter" title="3.2.7.2 H.264">
<link href="#rfc.section.3.2.7.3" rel="Chapter" title="3.2.7.3 MPEG-4">
<link href="#rfc.section.3.2.7.4" rel="Chapter" title="3.2.7.4 Possible solutions">
<link href="#rfc.section.3.2.8" rel="Chapter" title="3.2.8 Change of display in middle of session">
<link href="#rfc.section.3.2.9" rel="Chapter" title="3.2.9 Use with layered codecs">
<link href="#rfc.section.3.2.10" rel="Chapter" title="3.2.10 Addition of parameters">
<link href="#rfc.section.4" rel="Chapter" title="4 Examples">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 A High-Level Example">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Detailed Examples">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Example 1">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 Example 2">
<link href="#rfc.section.4.2.3" rel="Chapter" title="4.2.3 Example 3">
<link href="#rfc.section.4.2.4" rel="Chapter" title="4.2.4 Example 4">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Acknowledgements">
<link href="#rfc.section.8" rel="Chapter" title="8 Changes">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document proposes a new generic session set up attribute to make it possible to negotiate different image attributes such as image size.  A possible use case is to make it possible for a low-end hand-held terminal to display video without the need to rescale the image, something that may consume large amounts of memory and processing power.  The draft also helps to maintain an optimal bitrate for video as only the image size that is desired by the receiver is transmitted." />
  <meta name="description" content="This document proposes a new generic session set up attribute to make it possible to negotiate different image attributes such as image size.  A possible use case is to make it possible for a low-end hand-held terminal to display video without the need to rescale the image, something that may consume large amounts of memory and processing power.  The draft also helps to maintain an optimal bitrate for video as only the image size that is desired by the receiver is transmitted." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">I. Johansson</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Ericsson AB</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">K. Jung</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Samsung Electronics Co., Ltd.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Feb 18, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Negotiation of Generic Image Attributes in SDP<br />
  <span class="filename">draft-ietf-mmusic-image-attributes-11</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document proposes a new generic session set up attribute to make it possible to negotiate different image attributes such as image size.  A possible use case is to make it possible for a low-end hand-held terminal to display video without the need to rescale the image, something that may consume large amounts of memory and processing power.  The draft also helps to maintain an optimal bitrate for video as only the image size that is desired by the receiver is transmitted.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements</a>
</li>
<li>2.   <a href="#rfc.section.2">Conventions, Definitions and Acronyms</a>
</li>
<li>3.   <a href="#rfc.section.3">Specification of the 'imageattr' SDP Attribute</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Attribute syntax</a>
</li>
<li>3.1.1.   <a href="#rfc.section.3.1.1">Overall view of syntax</a>
</li>
<li>3.1.1.1.   <a href="#rfc.section.3.1.1.1">Parameter rules</a>
</li>
<li>3.1.1.2.   <a href="#rfc.section.3.1.1.2">Offer/answer rules</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Considerations</a>
</li>
<li>3.2.1.   <a href="#rfc.section.3.2.1">No imageattr in 1st offer</a>
</li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">Different payload type numbers in offer and answer</a>
</li>
<li>3.2.3.   <a href="#rfc.section.3.2.3">Asymmetry</a>
</li>
<li>3.2.4.   <a href="#rfc.section.3.2.4">sendonly and recvonly</a>
</li>
<li>3.2.5.   <a href="#rfc.section.3.2.5">Sample aspect ratio</a>
</li>
<li>3.2.6.   <a href="#rfc.section.3.2.6">SDPCapNeg support</a>
</li>
<li>3.2.7.   <a href="#rfc.section.3.2.7">Interaction with codec parameters</a>
</li>
<li>3.2.7.1.   <a href="#rfc.section.3.2.7.1">H.263</a>
</li>
<li>3.2.7.2.   <a href="#rfc.section.3.2.7.2">H.264</a>
</li>
<li>3.2.7.3.   <a href="#rfc.section.3.2.7.3">MPEG-4</a>
</li>
<li>3.2.7.4.   <a href="#rfc.section.3.2.7.4">Possible solutions</a>
</li>
<li>3.2.8.   <a href="#rfc.section.3.2.8">Change of display in middle of session</a>
</li>
<li>3.2.9.   <a href="#rfc.section.3.2.9">Use with layered codecs</a>
</li>
<li>3.2.10.   <a href="#rfc.section.3.2.10">Addition of parameters</a>
</li>
<li>4.   <a href="#rfc.section.4">Examples</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">A High-Level Example</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Detailed Examples</a>
</li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">Example 1</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">Example 2</a>
</li>
<li>4.2.3.   <a href="#rfc.section.4.2.3">Example 3</a>
</li>
<li>4.2.4.   <a href="#rfc.section.4.2.4">Example 4</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Acknowledgements</a>
</li>
<li>8.   <a href="#rfc.section.8">Changes</a>
</li>
<li>9.   <a href="#rfc.references">References</a>
</li>
<li>9.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#sec-intro" id="sec-intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">This document proposes a new SDP attribute to make it possible to negotiate different image attributes such as image size. The term image size is defined here as it may differ from the physical screen size of for instance a hand-held terminal. As an example it may be beneficial to display a video image on a part of the physical screen and leave space on the screen for other features such as menus and other info.</p>
<p id="rfc.section.1.p.2">There are a number of benefits with a possibility to negotiate the image size:</p>

<ul>
<li>Less image distortion: Rescaling of images introduces additional distortion, something that can be avoided (at least on the receiver side) if the image size can be negotiated.</li>
<li>Reduced receiver complexity: Image rescaling can be quite computation intensive. For low end devices this can be a problem.</li>
<li>Optimal quality for the given bitrate: The sender does not need to encode an entire CIF (352x288) image if only an image size of 288x256 is displayed on the receiver screen. This alternatively gives a saving in bitrate.</li>
<li>Memory requirement: The receiver device will know the size of the image and can then allocate memory accordingly.</li>
<li>Optimal aspect ratio: The indication of the supported image sizes and aspect ratio allows the receiver to select the most appropriate combination based on its rescaling capabilities and the desired rendering. For example, if a sender proposes three resolutions in its SDP offer, 100x200, 200x100 and 100x100 with sar=1.0 (1:1) etc.  then the receiver can select the option that fits the receiver screen best.</li>
</ul>
<p id="rfc.section.1.p.3">In cases where rescaling is not implemented (for example, rescaling is not mandatory to implement in H.264 <a href="#H.264">[H.264]</a>), the indication of the image attributes may still provide an optimal use of bandwidth because the attribute will anyway give the encoder a better indication about what image size is preferred and will thus help to avoid wasting bandwidth by encoding with an unnecessarily large resolution.</p>
<p id="rfc.section.1.p.4">For implementers that are considering rescaling issues, it is worth to notice that there are several benefits to do it on the sender side:</p>

<ul>
<li>Rescaling on the sender/encoder side is likely to be easier to do as the camera related software/hardware already contains the necessary functionality for zooming/cropping/trimming/sharpening the video signal. Moreover, rescaling is generally done in RGB or YUV domain and should not depend on the codecs used.</li>
<li>The encoder may be able to encode in a number of formats but may not know which format to choose as, without the image attribute, it does not know the receiver's performance or preference.</li>
<li>The quality drop due to digital domain rescaling using interpolation is likely to be lower if it is done before the video encoding rather than after the decoding especially when low bitrate video coding is used.</li>
<li>If low-complexity rescaling operations such as simple cropping must be performed, the benefit with having this functionality on the sender side is that it is then possible to present a miniature "what you send" image on the display to help the user to target the camera correctly.</li>
</ul>
<p id="rfc.section.1.p.5">Several of the existing standards (<a href="#H.263">[H.263]</a>, <a href="#H.264">[H.264]</a> and <a href="#MPEG-4">[MPEG-4]</a>) have support for different resolutions at different framerates. The purpose of this document is to provide for a generic mechanism and is targeted mainly at the negotiation of the image size but to make it more general the attribute is named 'imageattr'.</p>
<p id="rfc.section.1.p.6">This document is limited to point-to-point unicast communication scenarios. The attribute may be used in centralized conferencing scenarios as well but due to the abundance of configuration options it may then be difficult to come up with a configuration that fits all parties.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements</h1>
<p id="rfc.section.1.1.p.1">The design of the image attribute is based on the following requirements which are listed only for informational purposes:</p>

<dl>
<dt>REQ-1:</dt>
<dd style="margin-left: 8">Support the indication of one or more set(s) of image attributes that the SDP endpoint wish to receive or send.  Each image attribute set must include a specific image size.</dd>
<dt>REQ-2:</dt>
<dd style="margin-left: 8">Support set up/negotiation of image attributes, meaning that each side in the Offer/Answer should be able to negotiate the image attributes it prefers to send and receive.</dd>
<dt>REQ-3:</dt>
<dd style="margin-left: 8">Interoperate with codec specific parameters such as sprop-parameter-sets in <a href="#H.264">[H.264]</a> or config in <a href="#MPEG-4">[MPEG-4]</a>.</dd>
<dt>REQ-4:</dt>
<dd style="margin-left: 8">Make the attribute generic with as few codec specific details/tricks as possible in order to be codec agnostic.</dd>
</dl>
<p id="rfc.section.1.1.p.2">Besides the above mentioned requirements, the requirement below may be applicable.</p>

<dl>
<dt>OPT-1:</dt>
<dd style="margin-left: 8">The image attribute should support the description of image-related attributes for various types of media, including video, pictures, images, etc.</dd>
</dl>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Conventions, Definitions and Acronyms</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#sec-definition" id="sec-definition">Specification of the 'imageattr' SDP Attribute</a>
</h1>
<p id="rfc.section.3.p.1">This section defines the SDP image attribute 'imageattr', which can be used in an SDP Offer/Answer exchange to indicate various image attribute parameters. In this document, we define the following image attribute parameters: image resolution, sample aspect ratio (sar), allowed range in picture aspect ratio (par) and the preference of a given parameter set over another (q). The attribute is extensible and guidelines for defining additional parameters are provided in <a href="#sec-add-params">Section 3.2.10</a>.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Attribute syntax</h1>
<p id="rfc.section.3.1.p.1">In this section the syntax of the 'imageattr' attribute is described. The 'imageattr' attribute is a media-level attribute. The section is split up in two parts, the first gives an overall view of the syntax while the second describes how the syntax is used.</p>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> <a href="#sec-syntax-overall" id="sec-syntax-overall">Overall view of syntax</a>
</h1>
<p id="rfc.section.3.1.1.p.1">The syntax for the image attribute is in <a href="#RFC5234">ABNF</a> <cite title="NONE">[RFC5234]</cite>:</p>
<div id="#rfc.figure.1"></div>
<pre>    ----
    image-attr = "imageattr:" PT 1*2( 1*WSP ( "send" / "recv" )  
                                      1*WSP attr-list ) 
       
    PT = 1*DIGIT / "*"
    attr-list = ( set *(1*WSP set) ) / "*" 
      ;  WSP and DIGIT defined in [RFC5234]
    ----</pre>
<div id="#rfc.figure.2"></div>
<pre>       ----
       set= "[" "x=" xyrange "," "y=" xyrange *( "," key-value ) "]"
                  ; x is the horizontal image size range (pixel count)
                  ; y is the vertical image size range (pixel count)
       key-value = ( "sar=" srange )  
                 / ( "par=" prange ) 
                 / ( "q=" qvalue )
                  ; Key-value MAY be extended with other keyword 
                  ;  parameters.
                  ; At most one instance each of sar, par, or q 
                  ;  allowed in a set.
                  ;
                  ; sar (sample aspect ratio) is the sample aspect ratio
                  ;  associated with the set (optional,MAY be ignored)
                  ; par (picture aspect ratio) is the allowed 
                  ;  ratio between the display's x and y physical 
                  ;  size (optional)
                  ; q (optional, range [0.0..1.0], default value 0.5) 
                  ;  is the preference for the given set, 
                  ;  a higher value means a higher preference
</pre>
<div id="#rfc.figure.3"></div>
<pre>       ----
       onetonine = "1" / "2" / "3" / "4" / "5" / "6" / "7" / "8" / "9"
                  ; Digit between 1 and 9
       xyvalue = onetonine *5DIGIT
                  ; Digit between 1 and 9 which is 
                  ; followed by 0 to 5 other digits
       step = xyvalue
       xyrange = ( "[" xyvalue ":" [ step ":" ] xyvalue "]" )
                  ; Range between a lower and an upper value 
                  ; with an optional step, default step = 1
                  ; The rightmost occurrence of xyvalue MUST have a 
                  ; higher value than the leftmost occurrence.
               / ( "[" xyvalue 1*( "," xyvalue ) "]" ) 
                  ; Discrete values separated by ','
               / ( xyvalue )
                  ; A single value
       spvalue = ( "0" "." onetonine *3DIGIT )
                  ; Values between 0.1000 and 0.9999
               / ( onetonine "." 1*4DIGIT )
                  ; Values between 1.0000 and 9.9999
       srange =  ( "[" spvalue 1*( "," spvalue ) "]" ) 
                  ; Discrete values separated by ','. 
                  ; Each occurrence of spvalue MUST be 
                  ; greater than the previous occurrence.
               / ( "[" spvalue "-" spvalue "]" )
                  ; Range between a lower and an upper level (inclusive)
                  ; The second occurrence of spvalue MUST  have a higher 
                  ; value than the first
               / ( spvalue )
                  ; A single value
       prange =  ( "[" spvalue "-" spvalue "]" )
                  ; Range between a lower and an upper level (inclusive)
                  ; The second occurrence of spvalue MUST  have a higher 
                  ; value than the first

       qvalue  = ( "0" "." 1*2DIGIT )
               / ( "1" "." 1*2("0") )
                  ; Values between 0.00 and 1.00
       ----</pre>
<p></p>

<ul>
<li>The attribute typically contains a "send" and a "recv" keyword. These specify the preferences for the media once the session is set up, in the send and receive direction respectively from the point of view of the sender of the session description. One of the keywords ("send" or "recv") MAY be omitted, see <a href="#sec-sendonly-recvonly">Section 3.2.4</a> and <a href="#sec-different-pl">Section 3.2.2</a> for a description of cases when this may be appropriate.</li>
<li>The "send" keyword and corresponding attribute list (attr-list) MUST NOT occur more than once per image attribute.</li>
<li>The "recv" keyword and corresponding attribute list (attr-list) MUST NOT occur more than once per image attribute.</li>
<li>PT is the payload type number, it MAY be set to "*" (wild card) to indicate that the attribute applies to all payload types in the media description.</li>
<li>For sendrecv streams both of the send and recv directions SHOULD be present in the SDP.</li>
<li>For inactive streams it is RECOMMENDED that both of the send and recv directions are present in the SDP.</li>
</ul>
<h1 id="rfc.section.3.1.1.1">
<a href="#rfc.section.3.1.1.1">3.1.1.1.</a> Parameter rules</h1>
<div id="#rfc.figure.4"></div>
<pre>    ----
    par=[ratio_min-ratio_max]
    ----</pre>
<p id="rfc.section.3.1.1.1.p.1">For the parameters the following rules apply.</p>

<dl>
<dt>Payload type number (PT):</dt>
<dd style="margin-left: 8">The image attribute is bound to a specific codec by means of the payload type number.  A wild card (*) can be specified for the payload type number to indicate that it applies to all payload types in the media description. Several image attributes can be defined for instance for different video codec alternatives. This however requires that the payload type numbers differ. Note that the attribute is associated to the codec(s), for instance an SDP offer may specify payload type number 101 while the answer may specify 102, this may make it troublesome to specify a payload type number with the 'imageattr' attribute. See <a href="#sec-different-pl">Section 3.2.2</a> for a discussion and recommendation how this is solved.</dd>
<dt>Preference (q):</dt>
<dd style="margin-left: 8">The preference for each set is 0.5 by default, setting the optional q parameter to another value makes it possible to set different preferences for the sets. A higher value gives a higher preference for the given set.</dd>
<dt>sar:</dt>
<dd style="margin-left: 8">The sar (storage aspect ratio) parameter specifies the sample aspect ratio associated to the given range of x and y values. The sar parameter is defined as dx/dy where dx and dy is the physical size of the pixels. Square pixels gives a sar=1.0. The parameter sar MAY be expressed as a range or as a single value. <br>If this parameter is not present a default sar value of 1.0 is assumed.  <br>The interpretation of sar differs between the send and the receive directions. <ul>
<li>In the send direction it defines a specific sample aspect ratio associated to a given x and y image size (range).</li>
<li>In the recv direction sar expresses that the receiver of the given medium prefers to receive a given x and y resolution with a given sample aspect ratio.</li>
</ul>
<p>See </p>
<a href="#sec-sar-considerations">Section 3.2.5</a> for a more detailed discussion. <br>The sar parameter will likely not solve all the issues that are related to different sample aspect ratios but it can help to solve them and reduce aspect ratio distortion.<br>The response MUST NOT include a sar parameter if there is no acceptable value given.  The reason to this is that if the response includes a sar parameter it is interpreted as "sar parameter accepted" while removal of the sar parameter is treated as "sar parameter not accepted", for this reason it is safer to remove an unacceptable sar parameter altogether.</dd>
<dt>par:</dt>
<dd style="margin-left: 8">The par (width/height = x/y ratio) parameter indicates a range of allowed ratios between x and y physical size (picture aspect ratio). This is used to limit the number of x and y image size combinations, par is given as <br>If sar and the sample aspect ratio that the receiver actually uses in the display are the same (or close), the relation between the x and y pixel resolution and the physical size of the image is straightforward. If however sar differs from the sample aspect ratio of the receiver display this must be taken into consideration when the x and y pixel resolution alternatives are sorted out. See <a href="#SEC-EX-4">Section 4.2.4</a> for an example of this.</dd>
</dl>
<h1 id="rfc.section.3.1.1.2">
<a href="#rfc.section.3.1.1.2">3.1.1.2.</a> <a href="#sec-offer-answer" id="sec-offer-answer">Offer/answer rules</a>
</h1>
<div id="#rfc.figure.5"></div>
<pre>       ----
       a=imageattr:97 send * recv *
       ----</pre>
<p id="rfc.section.3.1.1.2.p.1">In accordance with <a href="#RFC3264">[RFC3264]</a>, offer answer exchange of the image attribute is as follows.</p>

<ul>
<li>Offerer sending the offer:<ul>
<li>The offerer must be able to support the image attributes that it offers, unless the offerer has expressed a wild card (*) in the attribute list.</li>
<li>It is recommended that a device which sees no reason to use the image attribute, anyway includes the attribute with wild cards (*) in the attribute lists for the send and recv directions. An example of this looks like:</li>
</ul>
</li>
<li>Answerer receiving the offer and sending the answer:<ul>
<li>The answerer may choose to keep the image attribute but is not required to do so.</li>
<li>The answerer may, for its receive and send direction, include one or more entries that it can support from the set of entries proposed in the offer.</li>
<li>The answerer may also, for its receive and send direction, replace the entries with a complete new set of entries different from the original proposed by the offerer. The implementor of this feature should however be aware that this may cause extra offer/answer exchanges.</li>
<li>The answerer may also remove its send direction completely if it is deemed that it cannot support any of the proposed entries.</li>
<li>The answerer should not include an image attribute in the answer if it was not present in the offer.</li>
</ul>
</li>
<li>Offerer receiving the answer:<ul>
<li>If the image attribute is not included in the SDP answer the offerer SHOULD continue to process the answer as if this mechanism had not been offered.</li>
<li>If the image attribute is included in the SDP answer but none of the entries are usable or acceptable, the offerer MUST resort to other methods to determine the appropriate image size. In this case the offerer must also issue a new offer/answer without the image attribute to avoid misunderstandings between offerer and answerer. This will avoid the risk on infinite negotiations.</li>
</ul>
</li>
</ul>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Considerations</h1>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> No imageattr in 1st offer</h1>
<p id="rfc.section.3.2.1.p.1">When the initial offer does not contain the 'imageattr' attribute, the rules in <a href="#sec-offer-answer">Section 3.1.1.2</a> require the attribute to be absent in the answer. The reasons for this are: </p>

<ul>
<li>The offerer of the initial SDP is not likely to understand the image attribute if it did not include it in the offer, bearing in mind that <a href="#sec-syntax-overall">Section 3.1.1</a> recommends that the offerer provide the attribute with wild carded parameters if it has no preference.</li>
<li>Inclusion of the image attribute in the answer may come in conflict with the rules in <a href="#sec-offer-answer">Section 3.1.1.2</a> esp. the rules that apply to "offerer receiving the answer".</li>
</ul>

<p>For the above reasons it is RECOMMENDED that a device which sees no reason to use the image attribute, anyway includes the attribute with wild cards (*) in the attribute lists for the send and recv directions.</p>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> <a href="#sec-different-pl" id="sec-different-pl">Different payload type numbers in offer and answer</a>
</h1>
<div id="#rfc.figure.6"></div>
<pre>    ----
    m=video 49154 RTP/AVP 99
    ----</pre>
<div id="#rfc.figure.7"></div>
<pre>    ----
    m=video 49154 RTP/AVP 100
    ----</pre>
<p id="rfc.section.3.2.2.p.1">In some cases the answer may specify a different media payload type number than the offer. As an example the offer SDP may have the m-line </p>
<p id="rfc.section.3.2.2.p.2">If the image attribute in the offer specifies payload type number 99, this attribute will then have no meaning in the answerers receive direction as the m-line specifies media payload type number 100.</p>
<div id="#rfc.figure.8"></div>
<pre>        ----
        m=video 49154 RTP/AVP 99
        a=imageattr:99 send ... recv ...
        ----</pre>
<div id="#rfc.figure.9"></div>
<pre>        ----
        m=video 49154 RTP/AVP 100
        a=imageattr:99 send ...
        a=imageattr:100 recv ...
        ----</pre>
<p id="rfc.section.3.2.2.p.3">There are a few ways to solve this</p>

<ol>
<li>Use a wild card "*" as payload type number in the image attribute in the offer SDP. The answer SDP also use the wild card. The drawback with this approach is that this attribute then applies to all payload type numbers in the media description.</li>
<li>Specify a wild card "*" as payload type number in the image attribute in the answer SDP. The offer SDP may contain a defined payload type number in the image attribute but the answer SDP replaces this with a wild card. The drawback here is similar to what is listed above.</li>
<li>The image attribute is split in two parts in the SDP answer.  For example the offer SDP (only the parts of interest in this discussion) looks like: </li>
</ol>
<p id="rfc.section.3.2.2.p.4">Of the alternatives listed above, the last one MUST be used as it is the most safe. The other alternatives MUST NOT be used.</p>
<h1 id="rfc.section.3.2.3">
<a href="#rfc.section.3.2.3">3.2.3.</a> Asymmetry</h1>
<p id="rfc.section.3.2.3.p.1">While the image attribute supports asymmetry there are some limitations to this. One important limitation is that the codec being used can only support up to a given maximum resolution for a given profile level.</p>
<p id="rfc.section.3.2.3.p.2">As an example H.264 <a href="#H.264">[H.264]</a> with profile level 1.2 does not support higher resolution than 352x288 (CIF). The offer/answer rules imply that the same profile level must be used in both directions. This means that in an asymmetric scenario where Alice wants an image size of 580x360 and Bob wants 150x120, profile level 2.2 is needed in both directions even though profile level 1 would have been sufficient in one direction.</p>
<p id="rfc.section.3.2.3.p.3">Currently, the only solution to this problem is to specify two unidirectional media descriptions. Note however that the asymmetry issue for the H.264 codec is solved by means of the level-asymmetry-allowed parameter in <a href="#RFC3984bis">[RFC3984bis]</a>.</p>
<h1 id="rfc.section.3.2.4">
<a href="#rfc.section.3.2.4">3.2.4.</a> <a href="#sec-sendonly-recvonly" id="sec-sendonly-recvonly">sendonly and recvonly</a>
</h1>
<p id="rfc.section.3.2.4.p.1">If the directional attributes a=sendonly or a=recvonly are given for a medium, there is of course no need to specify the image attribute for both directions. Therefore one of the directions in the attribute may be omitted. However it may be good to do the image attribute negotiation in both directions in case the session is updated for media in both directions at a later stage.</p>
<h1 id="rfc.section.3.2.5">
<a href="#rfc.section.3.2.5">3.2.5.</a> <a href="#sec-sar-considerations" id="sec-sar-considerations">Sample aspect ratio</a>
</h1>
<div id="#rfc.figure.10"></div>
<pre>    ----
    a=imageattr:97 send [x=720,y=576,sar=1.1]
    ----</pre>
<div id="#rfc.figure.11"></div>
<pre>    ----
    a=imageattr:97 send [x=720,y=576,sar=[0.91,1.0,1.09,1.45]]
    ----</pre>
<p id="rfc.section.3.2.5.p.1">The relationship between the sar parameter and the x and y pixel resolution deserves some extra discussion. Consider the offer from Alice to Bob (we set the recv direction aside for the moment): <br>To avoid this problem Alice may specify a range of values for the sar parameter like:</p>
<h1 id="rfc.section.3.2.6">
<a href="#rfc.section.3.2.6">3.2.6.</a> SDPCapNeg support</h1>
<p id="rfc.section.3.2.6.p.1">The image attribute can be used within the SDP Capability Negotiation <a href="#RFC5939">[RFC5939]</a> framework and its use is then specified using the "a=acap" parameter. An example is</p>
<div id="#rfc.figure.12"></div>
<pre>    ----
    a=acap:1 imageattr:97 send [x=720,y=576,sar=[0.91,1.0,1.09,1.45]]
    ----</pre>
<p id="rfc.section.3.2.6.p.2">For use with SDP Media Capability Negotiation extension <a href="#SDPMedCapNeg">[SDPMedCapNeg]</a>, where it is no longer possible to specify payload type numbers, it is possible to use the parameter substitution rule, an example of this is.</p>
<div id="#rfc.figure.13"></div>
<pre>    ----
    ...
    a=mcap:1 video H264/90000
    a=acap:1 imageattr:%1% send [x=720,y=576,sar=[0.91,1.0,1.09,1.45]]
    ...
    ----</pre>
<p id="rfc.section.3.2.6.p.3">Where %1% maps to media capability number 1.</p>
<p id="rfc.section.3.2.6.p.4">It is also possible to use the a=mscap attribute like in the example below.</p>
<div id="#rfc.figure.14"></div>
<pre>    ----
    ...
    a=mcap:1 video H264/90000
    a=mscap:1 imageattr send [x=720,y=576,sar=[0.91,1.0,1.09,1.45]]
    ...
    ----</pre>
<h1 id="rfc.section.3.2.7">
<a href="#rfc.section.3.2.7">3.2.7.</a> Interaction with codec parameters</h1>
<p id="rfc.section.3.2.7.p.1">As the SDP for most codecs already specifies some kind of indication of, for example, the image size, at session set up, measures must be taken to avoid conflicts between the image attribute and this already existing information.</p>
<p id="rfc.section.3.2.7.p.2">The following subsections describe the most well known codecs and how they define image-size related information. <a href="#sec-interact-solutions">Section 3.2.7.4</a> outlines a few possible solutions, but this document does not make any recommendation for any of them.</p>
<h1 id="rfc.section.3.2.7.1">
<a href="#rfc.section.3.2.7.1">3.2.7.1.</a> H.263</h1>
<p id="rfc.section.3.2.7.1.p.1">The payload format for H.263 <a href="#H.263">[H.263]</a> is described in <a href="#RFC4629">[RFC4629]</a>.</p>
<p id="rfc.section.3.2.7.1.p.2">H.263 defines (on the fmtp line) a list of image sizes and their maximum frame rates (profiles) that the offerer can receive.  The answerer is not allowed to modify this list and must reject a payload type that contains an unsupported profile. The CUSTOM profile may be used for image size negotiation but support for asymmetry requires the specification of two unidirectional media descriptions using the sendonly/recvonly attributes.</p>
<h1 id="rfc.section.3.2.7.2">
<a href="#rfc.section.3.2.7.2">3.2.7.2.</a> H.264</h1>
<p id="rfc.section.3.2.7.2.p.1">The payload format for H.264 <a href="#H.264">[H.264]</a> is described in <a href="#RFC3984bis">[RFC3984bis]</a>.</p>
<p id="rfc.section.3.2.7.2.p.2">H.264 defines image size related information in the fmtp line by means of sprop-parameter-sets. According to the specification several sprop-parameter-sets may be defined for one payload type.  The sprop-parameter-sets describe the image size (+ more) that the offerer sends in the stream and need not be complete. This means that this does not represent any negotiation. Moreover an answer is not allowed to change the sprop-parameter-sets.</p>
<p id="rfc.section.3.2.7.2.p.3">This configuration may be changed later inband if for instance image sizes need to be changed or added.</p>
<h1 id="rfc.section.3.2.7.3">
<a href="#rfc.section.3.2.7.3">3.2.7.3.</a> MPEG-4</h1>
<p id="rfc.section.3.2.7.3.p.1">The payload format for MPEG-4 <a href="#MPEG-4">[MPEG-4]</a> is described in <a href="#RFC3016">[RFC3016]</a>.</p>
<p id="rfc.section.3.2.7.3.p.2">MPEG-4 defines a config parameter on the fmtp line which is a hexadecimal representation of the MPEG-4 visual configuration information. This configuration does not represent any negotiation and the answer is not allowed to change the parameter.</p>
<p id="rfc.section.3.2.7.3.p.3">It is not possible to change the configuration using inband signaling.</p>
<h1 id="rfc.section.3.2.7.4">
<a href="#rfc.section.3.2.7.4">3.2.7.4.</a> <a href="#sec-interact-solutions" id="sec-interact-solutions">Possible solutions</a>
</h1>
<p id="rfc.section.3.2.7.4.p.1">The subsections above clearly indicate that this kind of information must be aligned well with the image attribute to avoid conflicts. There are a number of possible solutions, listed below without any preference:</p>

<ul>
<li>Ignore payload format parameters: This may not work well in the presence of bad channel conditions especially in the beginning of a session. Moreover this is not a good option for MPEG-4.</li>
<li>2nd session-wide offer/answer round: In the 2nd offer/answer the codec payload format specific parameters are defined based on the outcome of the 'imageattr' negotiation.  The drawback with this is that set up of the entire session (including audio) may be delayed considerably, especially as the 'imageattr' negotiation can already itself cost up to two offer/answer rounds. Also the conflict between the 'imageattr' negotiation and the payload format specific parameters is still present after the first offer/answer round and a fuzzy/buggy implementation may start media before the second offer/answer is completed with unwanted results.</li>
<li>2nd session-wide offer/answer round only for video: This is similar to the alternative above with the exception that set up time for audio is not increased, moreover the port number for video is set to 0 during the 1st offer answer round to avoid that media flows. <br>This has the effect that video will blend in some time after the audio is started (up to 2 seconds delay). This alternative is likely the most clean-cut and failsafe alternative. The drawback is, as the port number in the first offer is always zero, the media startup will always be delayed even though it would in fact have been possible to start media already after the first offer/answer round.<br>Note that according to <a href="#RFC3264">[RFC3264]</a>, a port number of zero means that the whole media line is rejected meaning that a new offer for the same port number should be treated as a completely new stream and not as an update. The most safe way to solve this problem is to use preconditions, this is however outside the scope of this document.</li>
</ul>
<h1 id="rfc.section.3.2.8">
<a href="#rfc.section.3.2.8">3.2.8.</a> Change of display in middle of session</h1>
<p id="rfc.section.3.2.8.p.1">A very likely scenario is that a user switches to another phone during a video telephony call or plugs a cellphone into an external monitor. In both cases it is very likely that a renegotiation is initiated using the SIP-REFER or SIP-UPDATE methods. It is RECOMMENDED to negotiate the image size during this renegotiation.</p>
<h1 id="rfc.section.3.2.9">
<a href="#rfc.section.3.2.9">3.2.9.</a> Use with layered codecs</h1>
<p id="rfc.section.3.2.9.p.1">As the image attribute is a media level attribute, its use with layered codecs causes some concern. If the layers are transported in different RTP streams the layers are specified on different media descriptions and the relation is specified using the grouping framework <a href="#RFC5888">[RFC5888]</a> and the depend attribute <a href="#RFC5583">[RFC5583]</a>. As it is not possible to specify only one image attribute for several media descriptions the solution is either to specify the same image attribute for each media description, or to only specify the image attribute for the base layer.</p>
<h1 id="rfc.section.3.2.10">
<a href="#rfc.section.3.2.10">3.2.10.</a> <a href="#sec-add-params" id="sec-add-params">Addition of parameters</a>
</h1>
<p id="rfc.section.3.2.10.p.1">The image attribute allows for the addition of parameters in the future. To make backwards adaptation possible; an entity that processes the attribute MUST ignore any unknown parameters in the offer and MUST NOT include them in the answer it generates. Addition of future parameters that are not understood by the receiving endpoint may lead to ambiguities if mutual dependencies between parameters exist, therefore addition of parameters must be done with great care.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Examples</h1>
<p id="rfc.section.4.p.1">This section gives some more information on how to use the attribute by means of a high-level example and a few detailed examples.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> A High-Level Example</h1>
<p id="rfc.section.4.1.p.1">Assume that Alice wishes to set up a session with Bob and that Alice takes the first initiative. The syntactical white-space delimiters (1*WSP) and double-quotes are removed to make reading easier.</p>
<div id="#rfc.figure.15"></div>
<pre>    ----
    a=imageattr:PT send attr-list recv attr-list
    ----</pre>
<div id="#rfc.figure.16"></div>
<pre>    ----
    a=imageattr:PT send attr-list recv *
    ----</pre>
<p id="rfc.section.4.1.p.2">In the offer Alice provides information for both the send and receive (recv) directions. For the send direction Alice provides a list that the answerer can select from. For the receive direction Alice may either specify a desired image size range right away or a * to instruct Bob to reply with a list of image sizes that Bob can support for sending. Using the overall high level syntax the image attribute may then look like </p>
<div id="#rfc.figure.17"></div>
<pre>    ----
    a=imageattr:PT send attr-list recv attr-list
    ----</pre>
<p id="rfc.section.4.1.p.3">If Bob supports an x and y resolution in at least one of the X and Y ranges given in the send attr-list and in the recv attr-list of the offer, the answer from Bob will look like: </p>
<div id="#rfc.figure.18"></div>
<pre>    ----
    a=imageattr:PT recv attr-list
    ----</pre>
<p id="rfc.section.4.1.p.4">If Bob does not support any x and y resolution in one of the provided send or recv ranges given in the send attr-list or in the recv attr-list, the corresponding part is removed completely. For instance, if Bob doesn't support any of the offered alternatives in the recv attr-list in the offer, the answer from Bob would look like:</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Detailed Examples</h1>
<p id="rfc.section.4.2.p.1">This section gives a few detailed examples, it is assumed where needed that Alice initiates a session with Bob</p>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> Example 1</h1>
<p id="rfc.section.4.2.1.p.1">Two image resolution alternatives are offered with 800x640 with sar=1.1 having the highest preference</p>
<p id="rfc.section.4.2.1.p.2">It is also indicated that Alice wish to display video with a resolution of 330x250 on her display</p>
<div id="#rfc.figure.19"></div>
<pre> ----
 a=imageattr:97 send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320] \
                recv [x=330,y=250]
 ----</pre>
<p id="rfc.section.4.2.1.p.3">In case Bob accepts the "recv [x=330,y=250]" the answer may look like</p>
<div id="#rfc.figure.20"></div>
<pre> ----
 a=imageattr:97 recv [x=800,y=640,sar=1.1] \
                send [x=330,y=250]
 ----</pre>
<p id="rfc.section.4.2.1.p.4">Indicating that the receiver (Bob) wish the encoder (on Alice's side) to compensate for a sample aspect ratio of 1.1 (11:10) and desires an image size on its screen of 800x640.</p>
<p id="rfc.section.4.2.1.p.5">There is however a possibility that "recv [x=330,y=250]" is not supported. If the case, Bob may completely remove this part or replace it with a list of supported image sizes.</p>
<div id="#rfc.figure.21"></div>
<pre> ----
 a=imageattr:97 recv [x=800,y=640,sar=1.1] \
                send [x=[320:16:640],y=[240:16:480],par=[1.2-1.3]]
 ----</pre>
<p id="rfc.section.4.2.1.p.6">Alice can then select a valid image size which is closest to the one that was originally desired (336x256) and performs a second offer/answer</p>
<div id="#rfc.figure.22"></div>
<pre> ----
 a=imageattr:97 send [x=800,y=640,sar=1.1] \
                recv [x=336,y=256]
 ----</pre>
<p id="rfc.section.4.2.1.p.7">Bob replies with:</p>
<div id="#rfc.figure.23"></div>
<pre> ----
 a=imageattr:97 recv [x=800,y=640,sar=1.1] \
                send [x=336,y=256]
 ----</pre>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> Example 2</h1>
<p id="rfc.section.4.2.2.p.1">Two image resolution sets are offered with the first having a higher preference (q=0.6).</p>
<div id="#rfc.figure.24"></div>
<pre> ----
 a=imageattr:97 \
   send [x=[480:16:800],y=[320:16:640],par=[1.2-1.3],q=0.6] \ 
        [x=[176:8:208],y=[144:8:176],par=[1.2-1.3]] \
   recv *
 ----</pre>
<p id="rfc.section.4.2.2.p.2">The x-axis resolution can take the values 480 to 800 in 16 pixels steps and 176 to 208 in 8 pixels steps. The par parameter limits the set of possible x and y screen resolution combinations such that 800x640 (ratio=1.25) is a valid combination while 720x608 (ratio=1.18) or 800x608 (ratio=1.31) are invalid combinations.</p>
<p id="rfc.section.4.2.2.p.3">For the recv direction (Bob-&gt;Alice) Bob is requested to provide with a list of supported image sizes</p>
<h1 id="rfc.section.4.2.3">
<a href="#rfc.section.4.2.3">4.2.3.</a> Example 3</h1>
<p id="rfc.section.4.2.3.p.1">In this example more of the SDP offer is shown. A complicating factor is that the answerer changes the media payload type number in the offer/answer exchange.</p>
<div id="#rfc.figure.25"></div>
<pre>    ----
    m=video 49154 RTP/AVP 99 
    a=rtpmap:99 H264/90000
    a=fmtp:99 packetization-mode=0;profile-level-id=42e011; \
      sprop-parameter-sets=Z0LgC5ZUCg/I,aM4BrFSAa
    a=imageattr:99 \
      send [x=176,y=144] [x=224,y=176] [x=272,y=224] [x=320,y=240] \
      recv [x=176,y=144] [x=224,y=176] [x=272,y=224,q=0.6] [x=320,y=240]
    ----</pre>
<p id="rfc.section.4.2.3.p.2">In the send direction, sprop-parameter-sets is defined for a resolution of 320x240 which is the largest image size offered in the send direction. This means that if 320x240 is selected, no additional offer/answer is necessary. In the receive direction four alternative image sizes are offered with 272x224 being the preferred choice.</p>
<p id="rfc.section.4.2.3.p.3">The answer may look like:</p>
<div id="#rfc.figure.26"></div>
<pre> ----
 m=video 49154 RTP/AVP 100
 a=rtpmap:100 H264/90000
 a=fmtp:100 packetization-mode=0;profile-level-id=42e011; \
   sprop-parameter-sets=Z0LgC5ZUCg/I,aM4BrFSAa
 a=imageattr:99 send [x=320,y=240]
 a=imageattr:100 recv [x=320,y=240]
 ----</pre>
<p id="rfc.section.4.2.3.p.4">Indicating (in this example) that the image size is 320x240 in both directions. Although the offerer preferred 272x224 for the receive direction, the answerer might not be able to offer 272x224 or not allow encoding and decoding of video of different image sizes simultaneously. The answerer sets new sprop-parameter-sets, constructed for both send and receive directions at the restricted conditions and image size of 320x240.</p>
<p id="rfc.section.4.2.3.p.5">Note also that, because the payload type number is changed by the answerer, the image attribute is also split in two parts according to the recommendation in <a href="#sec-different-pl">Section 3.2.2</a>.</p>
<h1 id="rfc.section.4.2.4">
<a href="#rfc.section.4.2.4">4.2.4.</a> <a href="#SEC-EX-4" id="SEC-EX-4">Example 4</a>
</h1>
<p id="rfc.section.4.2.4.p.1">This example illustrates in more detail how compensation for different sample aspect ratios can be negotiated with the image attribute.</p>
<div id="#rfc.figure.27"></div>
<pre>  ----
  a=imageattr:97 \
    send [x=400:16:800],y=[320:16:640],sar=[1.0-1.3],par=[1.2-1.3]] \
    recv [x=800,y=600,sar=1.1]
  ----</pre>
<p id="rfc.section.4.2.4.p.2">We set up a session between Alice and Bob, Alice is the offerer of the session. The offer (from Alice) contains the image attribute below:</p>
<p id="rfc.section.4.2.4.p.3">First we consider the recv direction: The offerer (Alice) explicitly states that she wishes to receive the screen resolution 800x600, however she also indicates that the screen on her display does not use square pixels, the sar value=1.1 means that Bob must (preferably) compensate for this. <br>So.. If Bob's video camera produces square pixels, and wishes to satisfy Alice's sar requirement, the image processing algorithm must rescale a 880x600 pixel image (880=800*1.1) to 800x600 pixels (could be done other ways).</p>
<div id="#rfc.figure.28"></div>
<pre> ----
 a=imageattr:97 \
   recv [x=464,y=384,sar=1.15] \
   send [x=800,y=600,sar=1.1]
 ----</pre>
<p id="rfc.section.4.2.4.p.4">... and now the send direction: Alice indicates that she can (in the image processing algorithms) rescale the image for sample aspect ratios in the range 1.0 to 1.3. She can also provide with a number of different image sizes (in pixels) ranging from 400x320 to 800x640. Bob inspects the offered sar and image sizes and responds with the modified image attribute </p>
<p id="rfc.section.4.2.4.p.5">Alice will (in order to satisfy Bob's request) need to rescale the image from her video camera from 534x384 (534=464*1.15) to 464x384.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> IANA Considerations</h1>
<p id="rfc.section.5.p.1">Following the guidelines in <a href="#RFC4566">[RFC4566]</a>, the IANA is requested to register one new SDP attribute:</p>

<dl>
<dt>Attribute name:</dt>
<dd style="margin-left: 20">imageattr</dd>
<dt>Long form name:</dt>
<dd style="margin-left: 20">Image attribute</dd>
<dt>Type of attribute:</dt>
<dd style="margin-left: 20">Media-level</dd>
<dt>Subject to charset:</dt>
<dd style="margin-left: 20">No</dd>
<dt>Purpose:</dt>
<dd style="margin-left: 20">This attribute defines the ability to negotiate various image attributes such as image sizes. The attribute contains a number of parameters which can be modified in and offer/answer exchange.</dd>
<dt>Appropriate values:</dt>
<dd style="margin-left: 20">See <a href="#sec-syntax-overall">Section 3.1.1</a> of RFCXXXX</dd>
<dt>Contact name:</dt>
<dd style="margin-left: 20">Authors of RFCXXXX</dd>
</dl>
<p id="rfc.section.5.p.2">Note to RFC Editor: please replace "RFCXXXX" above with the RFC number of this document, and remove this note.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Security Considerations</h1>
<p id="rfc.section.6.p.1">The image attribute and especially the parameters that denote the image size can take on values that may cause memory or CPU exhaustion problems. This may happen either as a consequence of a mistake by the sender of the SDP or as a result of an attack issued by a malicious SDP sender. This issue is similar to the case where the a=fmtp line(s) may take on extreme values for the same reasons as outlined above.</p>
<p id="rfc.section.6.p.2">A receiver of the SDP containing the image attribute MUST ensure that the parameters have values that are reasonable and that the device can handle the implications in terms of memory and CPU usage. Failure to do a sanity check on the parameters may result in memory or CPU exhaustion.</p>
<p id="rfc.section.6.p.3">In principle, for some SDPs containing the image attribute and for some deployments, it could be the case that simply checking the parameters is not sufficient to detect all potential DoS problems.  Implementers ought to consider whether there are any potential DoS attacks that would not be detected by simply checking parameters.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.7.p.1">The authors would like to thank the people who has contributed with objections and suggestions to this draft and provided with valuable guidance in the amazing video-coding world. Special thanks go to Clinton Priddle, Roni Even, Randell Jesup, and Dan Wing. Thanks also to Robert Sparks and Paul Kyzivat for the help with the last fixes to get the attribute work well with the offer/answer model.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Changes</h1>
<p id="rfc.section.8.p.1">Note to RFC Editor: please replace remove this section in its entirety before publication.</p>
<p id="rfc.section.8.p.2">The main changes are:</p>

<dl>
<dt>From WG -10 to WG -11</dt>
<dd style="margin-left: "><ul><li>Changes after IESG review</li></ul></dd>
<dt>From WG -09 to WG -10</dt>
<dd style="margin-left: "><ul>
<li>Further clarified the issue that offer and answer may use different PT numbers, additional section added.</li>
<li>Additional typos fixed.</li>
</ul></dd>
<dt>From WG -08 to WG -09</dt>
<dd style="margin-left: "><ul>
<li>Clarified the issue that offer and answer may use different PT numbers</li>
<li>Clarified that wild cards in send and recv direction should be used with care and with total message size in mind</li>
<li>Typos and unclear language fixe</li>
</ul></dd>
<dt>From WG -07 to WG -08</dt>
<dd style="margin-left: "><ul><li>SHOULD changed to MUST in section "Offer/answer rules"</li></ul></dd>
<dt>From WG -05 to WG -06 &amp; -07</dt>
<dd style="margin-left: "><ul>
<li>Update based on AD review comments, no changes to fix issue related to RFC2119 keywords</li>
<li>Minor editorial changes</li>
<li>Added extra example to use of attribute with SDPCapNeg</li>
</ul></dd>
<dt>From WG -04 to WG -05</dt>
<dd style="margin-left: "><ul>
<li>Review based on WGLC comments</li>
<li>ABNF improved</li>
<li>Change use of RFC2119 keywords (MUST, SHOULD, MAY) to lowercase in some sections</li>
<li>Clarification on the directions send and recv in sendrecv, inactive modes</li>
<li>Clarification around sar parameter added</li>
</ul></dd>
<dt>From WG -03 to WG -04</dt>
<dd style="margin-left: "><ul>
<li>Rearrangement of text</li>
<li>Clarification of offer/answer rules</li>
<li>Cleaned IANA section</li>
</ul></dd>
<dt>From WG -02 to WG -03</dt>
<dd style="margin-left: "><ul><li>Partial update based on review comments from Jean-Francois Mule</li></ul></dd>
<dt>From WG -01 to WG -02</dt>
<dd style="margin-left: "><ul><li>Added extra example that highlights the negotiation of sar</li></ul></dd>
<dt>From WG -00 to WG -01</dt>
<dd style="margin-left: "><ul>
<li>Added info about future addition of parameters and backwards compatibility</li>
<li>Added IANA considerations</li>
</ul></dd>
<dt>From individual -02 to WG -00</dt>
<dd style="margin-left: "><ul>
<li>Cleanup of syntax, ABNF form</li>
<li>Additional example</li>
</ul></dd>
<dt>From -01 to -02</dt>
<dd style="margin-left: "><ul>
<li>Cleanup of the sar and par parameters to make them match the established conventions</li>
<li>Requirement specification added</li>
<li>New bidirectional syntax</li>
<li>Interoperability considerations with well known video codecs discussed</li>
</ul></dd>
</dl>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3264">[RFC3264]</b></td>
<td class="top">
<a>Rosenberg, J.</a> and <a>H. Schulzrinne</a>, "<a href="http://tools.ietf.org/html/rfc3264">An Offer/Answer Model with Session Description Protocol (SDP)</a>", RFC 3264, June 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5888">[RFC5888]</b></td>
<td class="top">
<a>Camarillo, G.</a> and <a>H. Schulzrinne</a>, "<a href="http://tools.ietf.org/html/rfc5888">The Session Description Protocol (SDP) Grouping Framework</a>", RFC 5888, June 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4566">[RFC4566]</b></td>
<td class="top">
<a>Handley, M.</a>, <a>Jacobson, V.</a> and <a>C. Perkins</a>, "<a href="http://tools.ietf.org/html/rfc4566">SDP: Session Description Protocol</a>", RFC 4566, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5234">[RFC5234]</b></td>
<td class="top">
<a>Crocker, D.</a> and <a>P. Overell</a>, "<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>", STD 68, RFC 5234, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5583">[RFC5583]</b></td>
<td class="top">
<a>Schierl, T.</a> and <a>S. Wenger</a>, "<a href="http://tools.ietf.org/html/rfc5583">Signaling Media Decoding Dependency in the Session Description Protocol (SDP)</a>", RFC 5583, July 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">9.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3016">[RFC3016]</b></td>
<td class="top">
<a>Kikuchi, Y.</a>, <a>Nomura, T.</a>, <a>Fukunaga, S.</a>, <a>Matsui, Y.</a> and <a>H. Kimata</a>, "<a href="http://tools.ietf.org/html/rfc3016">RTP Payload Format for MPEG-4 Audio/Visual Streams</a>", RFC 3016, November 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4629">[RFC4629]</b></td>
<td class="top">
<a>Ott, H.263Video.J.</a>, <a>Bormann, C.</a>, <a>Sullivan, G.</a>, <a>Wenger, S.</a> and <a>R. Even</a>, "<a href="http://tools.ietf.org/html/rfc4629">RTP Payload Format for ITU-T Rec</a>", RFC 4629, January 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5939">[RFC5939]</b></td>
<td class="top">
<a>Andreasen, F.</a>, "<a href="http://tools.ietf.org/html/rfc5939">Session Description Protocol (SDP) Capability Negotiation</a>", RFC 5939, September 2010.</td>
</tr>
<tr>
<td class="reference"><b id="H.264">[H.264]</b></td>
<td class="top">
<a title="ITU-T">, </a>, "<a>ITU-T Recommendation H.264, http://www.itu.int/rec/T-REC-H.264-200711-I/en</a>", .</td>
</tr>
<tr>
<td class="reference"><b id="H.263">[H.263]</b></td>
<td class="top">
<a title="ITU-T">, </a>, "<a>ITU-T Recommendation H.263 (2005): "Video coding for low bit rate communication"</a>", .</td>
</tr>
<tr>
<td class="reference"><b id="MPEG-4">[MPEG-4]</b></td>
<td class="top">
<a title="ISO/IEC">, </a>, "<a>ISO/IEC 14496-2:2004: "Information technology - Coding of audio-visual objects - Part 2: Visual"</a>", .</td>
</tr>
<tr>
<td class="reference"><b id="SDPMedCapNeg">[SDPMedCapNeg]</b></td>
<td class="top">
<a title="IETF">, </a>, "<a>SDP media capabilities Negotiation, http://tools.ietf.org/wg/mmusic/draft-ietf-mmusic-sdp-media-capabilities</a>", .</td>
</tr>
<tr>
<td class="reference"><b id="RFC3984bis">[RFC3984bis]</b></td>
<td class="top">
<a title="IETF">, </a>, "<a>RTP Payload Format for H.264 Video, http://tools.ietf.org/wg/avt/draft-ietf-avt-rtp-rfc3984bis/</a>", .</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ingemar Johansson</span> 
	  <span class="n hidden">
		<span class="family-name">Johansson</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson AB</span>
	<span class="adr">
	  <span>Laboratoriegrand 11</span>

	  <span class="vcardline">
		<span class="locality">SE-971 28 Luleå</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">SWEDEN</span>
	</span>
	<span class="vcardline">Phone: +46 73 0783289</span>

<span class="vcardline">EMail: <a href="mailto:ingemar.s.johansson@ericsson.com">ingemar.s.johansson@ericsson.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Kyunghun Jung</span> 
	  <span class="n hidden">
		<span class="family-name">Jung</span>
	  </span>
	</span>
	<span class="org vcardline">Samsung Electronics Co., Ltd.</span>
	<span class="adr">
	  <span>Dong Suwon P.O. Box 105</span>
<span>416, Maetan-3Dong, Yeongtong-gu</span>

	  <span class="vcardline">
		<span class="locality">Suwon-city, Gyeonggi-do</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">Korea 442-600</span>
	</span>
	<span class="vcardline">Phone: +82 10 9909 4743</span>

<span class="vcardline">EMail: <a href="mailto:kyunghun.jung@samsung.com">kyunghun.jung@samsung.com</a></span>

  </address>
</div>

</body>
</html>