Cert_HA = {HLSP, PK_HA, Valid_Interval, SIG_CA}


REQ = {Src=HoA, Des=HA, e(k_HA, HoA, CoA, CN, N0 )}


COOKIE0 = {Src=HoA, Des= CN, C0}


COOKIE1 = {Src=CN, Des=HoA, C0, C1, N1}


SIG_HA = Sig(SK_HA,  HoA | CN | g^x | N1 | N2 | TS)


EXCH0 = {Src=HoA, Des= CN, C0, C1, N1, N2, g^x, 
                TS, SIG_HA, Cert_HA},


k_DH = (g^x)^y, 


k_master = prf(k_DH, N1 | N2 ),


k_BU = prf(k_master, N1 | N2 | 0),
k_BA = prf(k_master, N1 | N2 | 1),
k_EN = prf(k_master, N1 | N2 | 2),
EXCH1 = {Src=CN, Des= HoA, C0, C1, g^y, SIG_CN, Cert_CN},


SIG_CN = Sig(SK_CN, CN | HoA | g^y | EXCH0).
Cert_CN = {CN, PK_CN, Valid_Interval, SIG_CA} 


k_BU = prf(k_master, N1|N2|0), 
k_BA = prf(k_master, N1|N2|1), 
k_EN = prf(k_master, N1|N2|2) 
k_HA-next = prf(z, N0 | N1 ),


REP = {Src= CN, Des=CoA, payload}


payload = e(k_HA, N0, k_BU, k_BA, k_EN, k_HA-next).


BU = {Src=CoA, Des=CN, HoA, Seq#, LT_BU, MAC_BU}


MAC_BU = prf(k_BU, HoA | CoA | Seq# | LT_BU)


BA = {Src=CN, Des=CoA, HoA, Seq#, LT_BA, LT_EN, MAC_BA},


MAC_BA = prf(k_BA, CoA | CN | Seq# | LT_BA  | LT_EN)


REQ_KEY = {Src=HoA, Des=HA, e(k_HA, HoA, CoA, CN, N0', REQKEN)}
 
k_EN-new = prf(k_master, N1' | N2' | 2 ),


NEWKEY = {Src=CN, Des=CoA, e(k_HA, N0', k_EN-new, LT_EN )}.


TEST = {Src=CN_HA, Des=CN_CoA, test_flag}
ALIVE = {Src= CN_CoA, Des=CN_HA, N3}


KEYS = {Src=CN_HA, Des=CN_CoA, e(k_CN, N3, k_BU, k_BA, k_EN)}
FWD = {Src=CoA, Des= CN_CoA, HoA, Seq#, LT_BU, MAC_BU}.


BA = {Src=CN_CoA, Des=CoA, CN_HoA, Seq#, LT_BA, LT_EN, MAC_BA}


MAC_BA = prf(k_BA, CoA | CN_CoA | Seq# | LT_BA | LT_EN).


BU = { Src=LCoA, Des=MAP, HoA, RCoA, SIG_MN, Cert_MN }


SIG_MN = Sig{SK_MN, LCoA | MAP | HoA | RCoA},


Cert_MN = {HoA, PK_MN, Valid_Iinterval, SIG_HA}.


REQ_Cert = {Src=MAP, Des=HA, request_cert}.


REP_Cert = {Src=HA, Des=MAP, Cert_HA}.


