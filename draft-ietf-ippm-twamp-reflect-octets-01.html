<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>TWAMP Reflect Octets Feature</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="TWAMP Reflect Octets Feature">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">A. Morton</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">L. Ciavattone</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">AT&amp;T Labs</td></tr>
<tr><td class="header">Expires: September 8, 2009</td><td class="header">March 07, 2009</td></tr>
</table></td></tr></table>
<h1><br />TWAMP Reflect Octets Feature<br />draft-ietf-ippm-twamp-reflect-octets-01</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 8, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>The IETF has completed its work on the core specification of TWAMP -
      the Two-Way Active Measurement Protocol. This memo describes a new
      feature for TWAMP: an optional capability where the responder host
      returns some of the command octets or padding octets to the controller,
      and/or ensures that the same test packet sizes are used in both
      directions.
</p>
<h3>Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Purpose and Scope<br />
<a href="#anchor3">3.</a>&nbsp;
TWAMP Control Extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Connection Setup with Reflect Padding Feature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Request-TW-Session Packet Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
Accept Session Packet Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.4.</a>&nbsp;
Additional considerations<br />
<a href="#anchor8">4.</a>&nbsp;
Extended TWAMP Test <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.1.</a>&nbsp;
Sender Behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.1.1.</a>&nbsp;
Packet Timings<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.1.2.</a>&nbsp;
Packet Formats and Contents<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.1.3.</a>&nbsp;
Padding Truncation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.2.</a>&nbsp;
Reflector Behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.2.1.</a>&nbsp;
Packet Format and Contents<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.2.2.</a>&nbsp;
Padding Truncation<br />
<a href="#anchor16">5.</a>&nbsp;
Possible Alternative<br />
<a href="#Security">6.</a>&nbsp;
Security Considerations<br />
<a href="#IANA">7.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">7.1.</a>&nbsp;
Registry Specification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">7.2.</a>&nbsp;
Registry Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">7.3.</a>&nbsp;
Experimental Numbers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">7.4.</a>&nbsp;
Registry Contents<br />
<a href="#Acknowledgements">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The IETF has completed its work on the core specification of TWAMP -
      the Two-Way Active Measurement Protocol <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>.
      TWAMP is an extension of the One-way Active Measurement Protocol, OWAMP
      <a class='info' href='#RFC4656'>[RFC4656]<span> (</span><span class='info'>Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M. Zekauskas, &ldquo;A One-way Active Measurement Protocol (OWAMP),&rdquo; September&nbsp;2006.</span><span>)</span></a>. The TWAMP specification gathered wide
      review as it approached completion, and the by-products were several
      recommendations for new features in TWAMP. There are a growing number
      TWAMP implementations at present, and wide-spread usage is expected.
      There are even devices that are designed to test implementations for
      protocol compliance.
</p>
<p>This memo describes a new feature for TWAMP. This feature adds the
      OPTIONAL capability for the responder host to return a limited number of
      unassigned (padding) octets to the Control-Client or Session-Sender
      entities. With this capability, the Control-Client or Session-Sender can
      embed octets of information it deems useful and have the assurance that
      the corresponding reply/test packet will contain that information when
      it is reflected and returned (by the Server or Session-Reflector. The
      feature also adds the Session-Reflector capability to assure that
      reflected test packets SHALL have their padding octets truncated, so
      that TWAMP-Test protocol uses the same packet size in both directions of
      transmission.
</p>
<p>The relationship between this memo and TWAMP is intended to be an
      update to <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a> when published.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Purpose and Scope</h3>

<p>The purpose of this memo is to describe a new feature for TWAMP <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>. The feature enhances the TWAMP responder's
      capabilities to perform simple operations on control and test packets:
      the reflection of octets or padding and the guaranteed truncation of
      padding to compensate for the different sizes of TWAMP fields in the
      test packets. Motivations include permitting the controller host to tag
      packets with an index for simplified identification, and/or assert that
      the same size test packets MUST be used in each direction.
</p>
<p>The scope of the memo is currently limited to specifications of the
      following feature:
</p>
<p></p>
<ul class="text">
<li>Extension of the modes of operation through assignment of new
          values in the Mode Field (see section 3.1 <a class='info' href='#RFC4656'>[RFC4656]<span> (</span><span class='info'>Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M. Zekauskas, &ldquo;A One-way Active Measurement Protocol (OWAMP),&rdquo; September&nbsp;2006.</span><span>)</span></a> for the format of the Server Greeting
          message), while retaining backward compatibility with the core TWAMP
          <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a> implementations. These two values
          identify the ability of the Server/Session-Reflector to reflect
          specific octets back to the Client/Session-Sender, and/or to
          truncate padding octets and ensure that TWAMP-Test protocol uses the
          same packet size in both directions.
</li>
</ul>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
TWAMP Control Extensions</h3>

<p>TWAMP-Control protocol <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a> uses the Modes
      Field to identify and select specific communication capabilities, and
      this field is a recognized extension mechanism. The following sections
      describe one such extension.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Connection Setup with Reflect Padding Feature</h3>

<p>TWAMP connection establishment follows the procedure defined in
        section 3.1 of <a class='info' href='#RFC4656'>[RFC4656]<span> (</span><span class='info'>Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M. Zekauskas, &ldquo;A One-way Active Measurement Protocol (OWAMP),&rdquo; September&nbsp;2006.</span><span>)</span></a> and section 3.1 of <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>. The new feature requires two new bit
        positions (and values) to identify the ability of the
        Server/Session-Reflector to reflect specific octets back to the
        Control-Client/Session-Sender, and to truncate padding octets when
        required. With this added feature, the complete set of TWAMP Modes
        Field bit positions and values would be as follows:
</p>
<p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>Value  Description             Reference/Explanation
0      Reserved
1      Unauthenticated         RFC4656, Section 3.1
2      Authenticated           RFC4656, Section 3.1
4      Encrypted               RFC4656, Section 3.1
8      Unauth. TEST protocol,  draft-ietf-more-twamp (3)
       Encrypted CONTROL
--------------------------------------------------------
xxx    Reflect Octets          new bit position (X)
       Capability
yyy    Truncate Padding        new bit position (Y)
       Capability

</pre></div>
<p>
</p>

<p>In the original OWAMP Modes Field, setting bit positions 0, 1 or 2
        indicated the security mode of the Control protocol, and the Test
        protocol inherited the same mode (see section 4 of <a class='info' href='#RFC4656'>[RFC4656]<span> (</span><span class='info'>Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M. Zekauskas, &ldquo;A One-way Active Measurement Protocol (OWAMP),&rdquo; September&nbsp;2006.</span><span>)</span></a>). In the memo <a class='info' href='#I-D.ietf-ippm-more-twamp'>[I&#8209;D.ietf&#8209;ippm&#8209;more&#8209;twamp]<span> (</span><span class='info'>Morton, A. and K. Hedayat, &ldquo;More Features for the Two-Way Active Measurement Protocol - TWAMP,&rdquo; May&nbsp;2009.</span><span>)</span></a>, bit position 3 allows
        unauthenticated TWAMP Test protocol to be used with encryption on the
        TWAMP-Control protocol.
</p>
<p>The Server sets one or both of the new bit positions (X and Y) in
        the Modes Field of the Server Greeting message to indicate its
        capabilities and willingness to operate in these modes if desired.
        &gt;&gt;&gt;IANA: change X and Y to the assigned values
        &lt;&lt;&lt;
</p>
<p>If the Control-Client intends to operate all test sessions invoked
        with this control connection using one or both of the new modes, it
        MUST set the Modes Field bit corresponding to that function in the
        Setup Response message.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Request-TW-Session Packet Format</h3>

<p>The bits designated for the Reflect Octets feature in the
        Request-TW-Session command are as shown in the packet format
        below.
</p>
<p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      5        |  MBZ  | IPVN  |  Conf-Sender  | Conf-Receiver |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Number of Schedule Slots                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
.                                                               .
.           ... Many fields (66 octets) not shown ...           .
.                                                               .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Padding Length                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Start Time, (8 octets)                   |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Timeout, (8 octets)                     |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Type-P Descriptor                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Octets to be reflected    |  Length of padding to reflect |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       MBZ (4 octets)                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                       HMAC (16 octets)                        |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>
</p>

<p>The "Padding Length" Field *continues* to specify the number of
        padding octets that the Session-Sender will append to ALL TWAMP-Test
        packets associated with this test session. See below for
        considerations on the minimum length of the padding octets, especially
        when complying with the options described in this memo, following the
        definitions of the two new fields that follow the Type-P
        Descriptor.
</p>
<p>Note that the number of padding octets appended to the
        Session-Reflector's test packet depends on support for the OPTIONAL
        Truncate Padding mode, or the RECOMMENDED truncation process in TWAMP
        section 4.2.1 <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>.
</p>
<p>The "Octets to be reflected" Field SHALL be 2 octets long, as shown
        and contains the octets that the Server MUST reflect in the Accept
        Session message as specified below.
</p>
<p>The "Length of padding to reflect" Field SHALL be 2 octets long,
        and contain an unsigned binary value in units of octets. This field
        communicates the length of the padding in the TWAMP-Test Packet that
        the Session-Sender expects to be reflected, and the length of octets
        that the Session-Reflector SHALL return in include in its TWAMP-Test
        packet format (see section 4.2). By including this length field in the
        Request-TW-Session message, a Server is able to determine if it can
        comply with a specific request to reflect padding in the TWAMP-Test
        packets, and to arrange for the Session-Reflector processing in
        advance.
</p>
<p>The "Padding Length" SHOULD be &gt;= 27 octets when specifying a
        test session using the Unauthenticated TWAMP-Test mode, to allow for
        the RECOMMENDED truncation process in TWAMP section 4.2.1 <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>.
</p>
<p>The "Padding Length" SHOULD be &gt;= 56 octets when specifying a
        test session using the Authenticated or Encrypted TWAMP-Test modes, to
        allow for the RECOMMENDED truncation process in TWAMP section 4.2.1
        <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>.
</p>
<p>The "Padding Length" SHALL be &gt; the "Length of padding to
        reflect" when specifying a test session using the OPTIONAL Reflect
        Octets mode.
</p>
<p>The "Padding Length" SHALL be &gt;= 27 + "Length of padding to
        reflect" octets when specifying a test session using BOTH the OPTIONAL
        Reflect Octets mode and OPTIONAL Truncate Padding mode with the
        Unauthenticated TWAMP-Test mode.
</p>
<p>The "Padding Length" SHALL be &gt;= 56 + "Length of padding to
        reflect" octets when specifying a test session using BOTH the OPTIONAL
        Reflect Octets mode and OPTIONAL Truncate Padding mode with the
        Authenticated or Encrypted TWAMP-Test modes.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Accept Session Packet Format</h3>

<p>The bits designated for the Reflect Padding feature in the Accept
        Session command are as shown in the packet format below.
</p>
<p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Accept     |      MBZ      |            Port               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|
|                                                               |
|                        SID (16 octets)                        |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Reflected octets        |         Server octets         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       MBZ (8 octets)                          |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                       HMAC (16 octets)                        |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div>
<p>
</p>

<p>The "Reflected octets" field SHALL contain the octets from the
        Request-TW-Session "Octets to be reflected" Field, and be 2 octets
        long, as shown.
</p>
<p>The "Server octets" field SHALL contain information that the Server
        intends to be returned in the TWAMP-Test packet padding
        to-be-reflected Field, OR SHALL be zero, and be 2 octets long, as
        shown. Although the Server determines the SID, this field is very long
        (16 octets) and does not normally appear in TWAMP-Test packets.
</p>
<p>In Truncate Padding mode, IF calculations on the Padding lengths
        reveal that there are insufficient octets supplied to produce
        equal-length Session-Sender and Session-Reflector test packets, then
        the Accept Field MUST be set to 3 = some aspect of the request is not
        supported.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Additional considerations</h3>

<p>The value of the Modes Field sent by the Server in the Server
        Greeting message is the bit-wise OR of the mode values that it is
        willing to support during this session.
</p>
<p>Thus, the last six bits of the Modes 32-bit Field are used. A
        client conforming to this extension of <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>
        MAY ignore the values in the first 24 bits of the Modes Field, or it
        MAY support other features that are communicated in these bit
        positions. (The first 24 bits are available for future protocol
        extensions.)
</p>
<p>Other ways in which TWAMP extends OWAMP are described in <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Extended TWAMP Test </h3>

<p>The TWAMP test protocol is similar to the OWAMP <a class='info' href='#RFC4656'>[RFC4656]<span> (</span><span class='info'>Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M. Zekauskas, &ldquo;A One-way Active Measurement Protocol (OWAMP),&rdquo; September&nbsp;2006.</span><span>)</span></a> test protocol with the exception that the
      Session-Reflector transmits test packets to the Session-Sender in
      response to each test packet it receives. TWAMP section 4<a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a> defines two additional test packet formats for
      packets transmitted by the Session-Reflector. The appropriate format
      depends on the security mode chosen. The new modes specified here
      utilize some of the padding octets within each test packet format, or
      require truncation of those octets depending on the security mode in
      use.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Sender Behavior</h3>

<p>This section describes extensions to the behavior of the TWAMP
        Session-Sender.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Packet Timings</h3>

<p>The Send Schedule is not utilized in TWAMP, and this is unchanged
          in this memo.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Packet Formats and Contents</h3>

<p>The Session-Sender packet format and content follow the same
          procedure and guidelines as defined in section 4.1.2 of <a class='info' href='#RFC4656'>[RFC4656]<span> (</span><span class='info'>Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M. Zekauskas, &ldquo;A One-way Active Measurement Protocol (OWAMP),&rdquo; September&nbsp;2006.</span><span>)</span></a> (as indicated in section 4.1.2 of TWAMP
          <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>).
</p>
<p>The Reflect octets mode re-designates the original TWAMP-Test
          (and OWAMP-Test) Packet Padding Field (see section 4.1.2 of <a class='info' href='#RFC4656'>[RFC4656]<span> (</span><span class='info'>Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M. Zekauskas, &ldquo;A One-way Active Measurement Protocol (OWAMP),&rdquo; September&nbsp;2006.</span><span>)</span></a>), as shown below for unauthenticated
          mode:
</p>
<p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Sequence Number                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Timestamp                            |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Error Estimate        |          MBZ (2 octets)       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                  Packet Padding (to be reflected)             |
.               (length in octets specified elsewhere)          .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
.                                                               .
.                  Additional Packet Padding                    .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div>
<p>
</p>

<p>The "Packet Padding (to be reflected)" Field SHALL correspond to
          the length of octets specified in the Request-TW-Session "Length of
          padding to reflect" Field to this test session. These are the octets
          that the Session-Sender expects will be returned by the
          Session-Reflector.
</p>
<p>The length of the "Additional Packet Padding" Field is the
          difference between two fields in the Request-TW-Session command, as
          follows:
</p>
<p>"Additional Packet Padding", in octets =
</p>
<p>"Padding Length" - "Length of padding to reflect"
</p>
<p>One possible use of the first 4 octets of the "Packet Padding (to
          be reflected)" Field is shown below:
</p>
<p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Client octets          |         Server octets         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Packet Padding (to be reflected)             |
.               (length in octets specified elsewhere)          .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div>
<p>
</p>In this example, the "Client octets" and the "Server
          octets" fields contain the same information that the Client and
          Server exchanged in the Request-TW-Session and Accept-Session
          messages corresponding to this specific test session. These octets
          would be reflected the same as the rest of the "Packet Padding (to
          be reflected)" Field.

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.3"></a><h3>4.1.3.&nbsp;
Padding Truncation</h3>

<p>When the Truncate Padding mode is selected and communicated in
          the Setup Response message, the Session-Sender MUST anticipate a
          minimum padding required to achieve equal size test packets in both
          directions. The amount of padding needed depends on BOTH the
          security mode (Unauthenticated/Authenticated/Encrypted) and whether
          the Reflect Octets mode is selected simultaneously.
</p>
<p>When using the Truncate Padding mode, the Session-Sender MUST
          append sufficient Packet Padding octets to allow the same IP packet
          payload lengths to be used in each direction of transmission (this
          is usually desirable). To compensate for the
          Session-Reflector&rsquo;s larger test packet format, the
          Session-Sender MUST append at least 27 octets of padding in
          Unauthenticated mode, and at least 56 octets in Authenticated and
          Encrypted modes.
</p>
<p>When using the Reflect Octets mode simultaneously with the
          Truncate Padding mode, the Session-Sender MUST append at least 27
          octets of padding plus the "Length of the padding to reflect" octets
          when operating in Unauthenticated mode. The Session-Sender MUST
          append at least 56 octets of padding plus the "Length of the padding
          to reflect" octets when operating in Authenticated and Encrypted
          modes.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Reflector Behavior</h3>

<p>The TWAMP Reflector follows the procedures and guidelines in
        section 4.2 of <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>, with the following
        additional functions:
</p>
<p></p>
<ul class="text">
<li>Reflect Octets mode: Designated octets in the "Packet Padding
            (to be reflected)" field of the Session-Sender's test packet MUST
            be included in the Session-Reflector's test packet.
</li>
<li>Truncate Padding mode: Octets in the packet padding field of
            the Session-Sender's test packet MUST be truncated so that the
            length of the Session-Reflector's test packet equals the length of
            the Session-Sender's test packet.
</li>
</ul>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Packet Format and Contents</h3>

<p>The Reflect Padding feature re-designates the packet padding
          field, as shown below for unauthenticated mode:
</p>
<p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sequence Number                        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          Timestamp                            |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         Error Estimate        |           MBZ                 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                          Receive Timestamp                    |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sender Sequence Number                 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                      Sender Timestamp                         |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Sender Error Estimate    |           MBZ                 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |  Sender TTL   |         Packet Padding (from Session-Sender)  |
 +-+-+-+-+-+-+-+-+                                               +
 .                                                               .
 .               Packet Padding (from Session-Sender)            .
 +               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |               |                                               |
 +-+-+-+-+-+-+-+-+                                               +
 .                  Additional Packet Padding                    .
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div>
<p>
</p>The "Packet Padding (from Session-Sender)" field MUST be
          the same octets as the "Packet Padding (to be reflected)" field in
          the Session-Sender's test packet, and therefore MUST conform to the
          length specified in the Request-TW-Session message.

<p>IF the test packet length is truncated within the padding fields
          in conformance with the RECOMMENDED truncation process in TWAMP
          section 4.2.1 <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>, THEN ALL padding
          designated to be reflected MUST be reflected by Session-Reflectors
          using this feature.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Padding Truncation</h3>

<p>Note that the Session-Reflector Test Packet Formats are larger
          than the Sender&rsquo;s formats. When the Truncate Padding mode is
          selected and communicated in the Setup Response message, the
          Session-Reflector must truncate a specific number of padding octets
          to achieve equal size test packets in both directions. The number of
          octets truncated depends on BOTH the security mode
          (Unauthenticated/Authenticated/Encrypted) and whether the Reflect
          octets mode is selected simultaneously.
</p>
<p>When using the Truncate Padding mode, the Session-Reflector MUST
          truncate exactly 27 octets of padding in Unauthenticated mode, and
          exactly 56 octets in Authenticated and Encrypted modes. The
          Session-Reflector MAY re-use the Sender&rsquo;s Packet Padding
          (since the requirements for padding generation are the same for
          each), and in this case the Session-Reflector MUST truncate the
          padding such that the highest number octets are discarded.
</p>
<p>When simultaneously using the Truncate Padding mode AND Reflect
          octets mode, the Session-Reflector MUST reflect the designated
          octets from the Session-Sender's test packet in the "Packet Padding
          (from Session-Sender)" Field, and MAY re-use additional Packet
          Padding from the Session-Sender. The Session-Reflector MUST truncate
          the padding such that the highest number octets are discarded, and
          the test packet length equals the Session-Sender's packet
          length.
</p>
<p>
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Possible Alternative</h3>

<p>If new TWAMP-Test packet formats are defined, the Reflect Octets and
      Truncate Padding modes could be folded into one new mode.
</p>
<p>It would be possible to obtain even 4 octet boundaries in the revised
      format.
</p>
<p>It is also possible to simplfy test packet reflection by leaving the
      Session-Sender's fields exactly as received, and replacing the Discard
      Fill Field with the new time stamps and sequence number determined by
      the Session-Reflector.
</p>
<p>No calculations on padding are needed, and symmetrical packet size is
      ensured for both directions of transmssion.
</p>
<p>The "Packet Padding (to be reflected)" Field could contain
      information that is TLV encoded, but in general the padding is opaque to
      the Session-Reflector.
</p>
<p>This Alternative is illustrated for discussion purposes.
</p>
<p>New Session-Sender Test Packet Format:
</p>
<p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Sequence Number                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Timestamp                            |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Error Estimate        |          MBZ (2 octets)       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                                                               |
|                                                               |
|                      Discard Fill                             |
|                                                               |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                  Packet Padding (to be reflected)             |
.               (length in octets specified elsewhere)          .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
.                                                               .
.                  Additional Packet Padding                    .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div>
<p>
</p>The "Discard Fill" octets are discarded at the
      Session-Reflector.

<p>New Session-Reflector Test Packet format:
</p>
<p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                     Sender Sequence Number                    |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Sender Timestamp                        |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Sender  Error Estimate   |           MBZ                 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                  Reflector Receive Timestamp                  |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                    Reflector Sequence Number                  |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                  Reflector's Sending  Timestamp               |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Sender Error Estimate    |           MBZ                 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |  Sender TTL   |                      MBZ (3 octets)           |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 .                                                               .
 .               Packet Padding (from Session-Sender)            .
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 .                  Additional Packet Padding                    .
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre></div>

<p>
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>These extended modes of operation do not appear to permit any new
      attacks on hosts communicating with core TWAMP <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a> ???
</p>
<p>The security considerations that apply to any active measurement of
      live networks are relevant here as well. See <a class='info' href='#RFC4656'>[RFC4656]<span> (</span><span class='info'>Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M. Zekauskas, &ldquo;A One-way Active Measurement Protocol (OWAMP),&rdquo; September&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This memo adds two mode combinations to the IANA registry for the
      TWAMP Modes Field, and describes behavior when the new modes are used.
      This field is a recognized extension mechanism for TWAMP.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Registry Specification</h3>

<p>IANA has created a TWAMP-Modes registry (as requested in <a class='info' href='#I-D.ietf-ippm-more-twamp'>[I&#8209;D.ietf&#8209;ippm&#8209;more&#8209;twamp]<span> (</span><span class='info'>Morton, A. and K. Hedayat, &ldquo;More Features for the Two-Way Active Measurement Protocol - TWAMP,&rdquo; May&nbsp;2009.</span><span>)</span></a>). TWAMP-Modes are specified
        in TWAMP Server Greeting messages and Set-up Response messages, as
        described in section 3.1 of <a class='info' href='#RFC5357'>[RFC5357]<span> (</span><span class='info'>Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;A Two-Way Active Measurement Protocol (TWAMP),&rdquo; October&nbsp;2008.</span><span>)</span></a>, consistent
        with section 3.1 of <a class='info' href='#RFC4656'>[RFC4656]<span> (</span><span class='info'>Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M. Zekauskas, &ldquo;A One-way Active Measurement Protocol (OWAMP),&rdquo; September&nbsp;2006.</span><span>)</span></a>, and extended by
        this memo. Modes are indicated by setting bits in the 32-bit Modes
        field. Thus, this registry can contain a total of 32 possible
        values.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Registry Management</h3>

<p>Because the Modes registry can contain only thirty-two values, and
        because TWAMP is an IETF protocol, this registry must be updated only
        by "IETF Consensus" as specified in <a class='info' href='#RFC2434'>[RFC2434]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; October&nbsp;1998.</span><span>)</span></a>(an
        RFC documenting registry use that is approved by the IESG). For the
        Modes registry, we expect that new features will be assigned using
        monotonically increasing bit positions and in the range [0-31] and the
        corresponding values, unless there is a good reason to do
        otherwise.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Experimental Numbers</h3>

<p>No experimental values are currently assigned for the Modes
        Registry.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Registry Contents</h3>

<p>TWAMP Modes Registry is recommended to be augmented as
        follows:
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>Value  Description             Semantics Definition
0      Reserved

1      Unauthenticated         RFC4656, Section 3.1

2      Authenticated           RFC4656, Section 3.1

4      Encrypted               RFC4656, Section 3.1

8      Unauth. TEST protocol,  draft-ietf-more-twamp (3)
       Auth. CONTROL
--------------------------------------------------------
xxx    Reflect Octets          this memo, section 3.1
       Capability              new bit position (X)
yyy    Truncate Padding        this memo, section 3.1
       Capability              new bit position (Y)</pre></div>
<p>
</p>The suggested values are

<p>X=4, xxx=16
</p>
<p>Y=5, yyy=32
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>The authors would like to thank Walt Steverson for helpful review and
      comments.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ippm-more-twamp">[I-D.ietf-ippm-more-twamp]</a></td>
<td class="author-text">Morton, A. and K. Hedayat, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ippm-more-twamp-02.txt">More Features for the Two-Way Active Measurement Protocol - TWAMP</a>,&rdquo; draft-ietf-ippm-more-twamp-02 (work in progress), May&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ippm-more-twamp-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2434">[RFC2434]</a></td>
<td class="author-text"><a href="mailto:narten@raleigh.ibm.com">Narten, T.</a> and <a href="mailto:Harald@Alvestrand.no">H. Alvestrand</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2434">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;2434, October&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2434.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2434.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2434.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4656">[RFC4656]</a></td>
<td class="author-text">Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M. Zekauskas, &ldquo;<a href="http://tools.ietf.org/html/rfc4656">A One-way Active Measurement Protocol (OWAMP)</a>,&rdquo; RFC&nbsp;4656, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4656.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5357">[RFC5357]</a></td>
<td class="author-text">Hedayat, K., Krzanowski, R., Morton, A., Yum, K., and J. Babiarz, &ldquo;<a href="http://tools.ietf.org/html/rfc5357">A Two-Way Active Measurement Protocol (TWAMP)</a>,&rdquo; RFC&nbsp;5357, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5357.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="x">[x]</a></td>
<td class="author-text">&ldquo;.&rdquo;</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Al Morton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">AT&amp;T Labs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">200 Laurel Avenue South</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Middletown,, NJ  07748</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 732 420 1571</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+1 732 368 1192</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:acmorton@att.com">acmorton@att.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://home.comcast.net/~acmacm/">http://home.comcast.net/~acmacm/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Len Ciavattone</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">AT&amp;T Labs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">200 Laurel Avenue South</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Middletown,, NJ  07748</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 732 420 1239</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:lencia@att.com">lencia@att.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href=""></a></td></tr>
</table>
</body></html>
