<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Security Requirements for the
    Geopriv Location System</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Security Requirements for the
    Geopriv Location System">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">GEOPRIV</td><td class="header">R. Barnes</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">M. Lepinski</td></tr>
<tr><td class="header">Updates: <a href='http://tools.ietf.org/html/rfc3693'>3693</a>, <a href='http://tools.ietf.org/html/rfc3694'>3694</a></td><td class="header">BBN Technologies</td></tr>
<tr><td class="header">(if&nbsp;approved)</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">Expires: August 28, 2008</td><td class="header">H. Schulzrinne</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Columbia University</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 25, 2008</td></tr>
</table></td></tr></table>
<h1><br />Security Requirements for the
    Geopriv Location System<br />draft-barnes-geopriv-lo-sec-02</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 28, 2008.</p>

<h3>Abstract</h3>

<p>Internet protocols that deal with presence-based location objects
      support a wide variety of applications. However, the dissemination of
      location objects from sources of location to consumers is a common
      feature of all location-based applications. In order to enable the
      development of broadly-applicable security and privacy mechanisms for
      dissemination of location objects, this document describes an end-to-end
      architecture for policy-constrained location distribution. In this
      architecture, location distribution is accomplished by a set of
      distributed actors. We describe the assurances that these actors require
      from the architecture, and derive more a more detailed description of
      the security features required to provide those assurances.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#term-sec">2.</a>&nbsp;
Terminology<br />
<a href="#arch-sec">3.</a>&nbsp;
An End-to-end Location Architecture<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#trans-sec">3.1.</a>&nbsp;
Structure of a Location Transmission<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">3.1.1.</a>&nbsp;
Structure of a Location Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.2.</a>&nbsp;
Location References<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.3.</a>&nbsp;
LS Processing of Location Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#e2e-sec">3.2.</a>&nbsp;
The End-to-end Model and Global Roles<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#eg-sec">3.3.</a>&nbsp;
Usage Scenarios for this Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.3.1.</a>&nbsp;
RFC 3693 model of transmission<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.2.</a>&nbsp;
Location Configuration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.3.3.</a>&nbsp;
Location Conveyance by Value<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.3.4.</a>&nbsp;
Location Conveyance by Reference<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.3.5.</a>&nbsp;
Presence Server<br />
<a href="#assure-sec">4.</a>&nbsp;
Required Assurances<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.1.</a>&nbsp;
Location Transmission<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.1.1.</a>&nbsp;
Rule Maker<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.1.2.</a>&nbsp;
Location Server<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.1.3.</a>&nbsp;
Location Recipient<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.2.</a>&nbsp;
End-to-end distribution<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.2.1.</a>&nbsp;
Location Generator<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.2.2.</a>&nbsp;
Viewer<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.2.3.</a>&nbsp;
Target<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#assure-summary-sec">4.3.</a>&nbsp;
Summary of Required Assurances<br />
<a href="#req-sec">5.</a>&nbsp;
Security Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.1.</a>&nbsp;
Unauthorized Modification of Rules<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">5.2.</a>&nbsp;
Unauthorized Exposure of Rules<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">5.3.</a>&nbsp;
Acceptance of Rules from Unauthorized Rule Makers <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">5.4.</a>&nbsp;
Unauthorized Exposure of Location Objects<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">5.5.</a>&nbsp;
Unauthorized Modification of Location Objects<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">5.6.</a>&nbsp;
Assertion of Location Object Origins<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">5.7.</a>&nbsp;
Summary of Security Requirements<br />
<a href="#Security">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor25">7.</a>&nbsp;
Acknowledgements<br />
<a href="#IANA">8.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Demand for location-based Internet applications, especially
      location-based Internet calling <a class='info' href='#I-D.ietf-ecrit-framework'>[I&#8209;D.ietf&#8209;ecrit&#8209;framework]<span> (</span><span class='info'>Rosen, B., Schulzrinne, H., Polk, J., and A. Newton, &ldquo;Framework for Emergency Calling using Internet Multimedia,&rdquo; July&nbsp;2009.</span><span>)</span></a>, has driven the creation of
      Internet protocols for communicating information about the location of
      Internet end hosts or other entities. Of interest, for example, are
      protocols for informing hosts of their own location (location
      configuration protocols), transmitting location information from one
      host to another (location conveyance protocols), and requesting location
      information from a server (location dereference protocols).
</p>
<p>The first goal of this document is to describe how location
      information is used by these protocols over its entire "life-cycle".
      This life-cycle begins when location information is introduced into an
      IP network via a location configuration protocol, continues through one
      or more transmissions by way of location conveyance and dereference
      protocols, and ultimately ends when the location is delivered to an
      application consumer.
</p>
<p>The Location Objects (LO) described in RFC 3693 and RFC 3694 are
      usually encoded as XML documents in the Presence Information Data Format
      - Location Object (PIDF-LO) schema <a class='info' href='#RFC4119'>[RFC4119]<span> (</span><span class='info'>Peterson, J., &ldquo;A Presence-based GEOPRIV Location Object Format,&rdquo; December&nbsp;2005.</span><span>)</span></a>. While
      the general trend in the IETF is to require that LOs be in this format,
      certain protocols do not use PIDF-LO, most notably the DHCP extensions
      to carry location in civic <a class='info' href='#RFC4776'>[RFC4776]<span> (</span><span class='info'>Schulzrinne, H., &ldquo;Dynamic Host Configuration Protocol (DHCPv4 and DHCPv6) Option for Civic Addresses Configuration Information,&rdquo; November&nbsp;2006.</span><span>)</span></a> or geospatial
      <a class='info' href='#RFC3825'>[RFC3825]<span> (</span><span class='info'>Polk, J., Schnizlein, J., and M. Linsner, &ldquo;Dynamic Host Configuration Protocol Option for Coordinate-based Location Configuration Information,&rdquo; July&nbsp;2004.</span><span>)</span></a> format. In this document, such formats
      for location information are also regarded as LO formats, even though
      they do not comply with the requirements for LO formats in RFC 3693.
</p>
<p>The expansion of scope to include location object formats other than
      those in compliance RFC 3693 is not meant to in any way deprecate or
      supercede the requirements of RFC 3693. This document is intended to
      treat security aspects of location communication independent of the
      other considerations that RFC 3693 addresses. Where the two documents
      overlap, we aim to provide greater specificity in guidance and
      requirements.
</p>
<p>A model for the use of Internet protocols to transmit location
      information via a store-and-forward network of Location Servers has been
      described in RFC 3693 <a class='info' href='#RFC3693'>[RFC3693]<span> (</span><span class='info'>Cuellar, J., Morris, J., Mulligan, D., Peterson, J., and J. Polk, &ldquo;Geopriv Requirements,&rdquo; February&nbsp;2004.</span><span>)</span></a>. Privacy concerns
      and privacy-relevant security concerns are described in RFC 3694 <a class='info' href='#RFC3694'>[RFC3694]<span> (</span><span class='info'>Danley, M., Mulligan, D., Morris, J., and J. Peterson, &ldquo;Threat Analysis of the Geopriv Protocol,&rdquo; February&nbsp;2004.</span><span>)</span></a>. This document extends those documents in three
      ways: First, we explicitly take into account end-to-end properties of
      the system, through multiple location transmissions. Second, we address
      security concerns not directly related to the privacy of location
      information (of concern for Viewers), such as location integrity and
      access control (of concern to Location Generators). Third, and most
      importantly, we extend these considerations beyond a presence-based
      model to create a general framework for policy-based dissemination of
      location objects.
</p>
<p>Similarly, several policy languages have been developed in the
      context of presence authorization (and for location within that
      context). RFC 4745 <a class='info' href='#RFC4745'>[RFC4745]<span> (</span><span class='info'>Schulzrinne, H., Tschofenig, H., Morris, J., Cuellar, J., Polk, J., and J. Rosenberg, &ldquo;Common Policy: A Document Format for Expressing Privacy Preferences,&rdquo; February&nbsp;2007.</span><span>)</span></a> defines a general
      framework for expressing privacy policies, and RFC 5025 <a class='info' href='#RFC5025'>[RFC5025]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Presence Authorization Rules,&rdquo; December&nbsp;2007.</span><span>)</span></a> specializes this framework to the case of
      presence documents (of which PIDF-LO location objects are considered a
      subset). This document considers these sorts of authorization rules in
      the context of a broader location request authorization framework.
</p>
<p>The remainder of this document is structured as follows: After
      relevant terminology is introduced in <a class='info' href='#term-sec'>Section&nbsp;2<span> (</span><span class='info'>Terminology</span><span>)</span></a>,
      <a class='info' href='#arch-sec'>Section&nbsp;3<span> (</span><span class='info'>An End-to-end Location Architecture</span><span>)</span></a> describes an architecture for the
      end-to-end distribution of location over the Internet. In particular,
      this architecture describes a set of entities that work together to move
      location information from source to consumer. Based on the roles they
      play in the architecture, these entities may require certain assurances,
      and these are described in <a class='info' href='#assure-sec'>Section&nbsp;4<span> (</span><span class='info'>Required Assurances</span><span>)</span></a>. Finally,
      in <a class='info' href='#req-sec'>Section&nbsp;5<span> (</span><span class='info'>Security Requirements</span><span>)</span></a>, the technical properties and
      mechanisms required to enable these assurances are reflected in a set of
      requirements for Geopriv security mechanisms.
</p>
<a name="term-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>The focus of this document is the security properties of two types of
      protocols and two types of data formats:
</p>
<p></p>
<ul class="text">
<li>Policy Conveyance Protocols communicate policy information
          between rule makers and location servers. These can be dedicated
          protocols (e.g., XCAP <a class='info' href='#RFC4825'>[RFC4825]<span> (</span><span class='info'>Rosenberg, J., &ldquo;The Extensible Markup Language (XML) Configuration Access Protocol (XCAP),&rdquo; May&nbsp;2007.</span><span>)</span></a>), or, when
          rules are carried within a location object, the location conveyance
          protocol can act as a policy conveyance protocol.
</li>
<li>Location Conveyance Protocols communicate location requests and
          responses between the location server and the location recipient
          (e.g., SIP Geolocation, HELD, and Location Dereference Protocols).
          Location configuration protocols <a class='info' href='#I-D.ietf-geopriv-l7-lcp-ps'>[I&#8209;D.ietf&#8209;geopriv&#8209;l7&#8209;lcp&#8209;ps]<span> (</span><span class='info'>Tschofenig, H. and H. Schulzrinne, &ldquo;GEOPRIV Layer 7 Location Configuration Protocol; Problem Statement and Requirements,&rdquo; July&nbsp;2009.</span><span>)</span></a> and location dereference
          protocols <a class='info' href='#I-D.ietf-geopriv-lbyr-requirements'>[I&#8209;D.ietf&#8209;geopriv&#8209;lbyr&#8209;requirements]<span> (</span><span class='info'>Marshall, R., &ldquo;Requirements for a Location-by-Reference Mechanism,&rdquo; November&nbsp;2009.</span><span>)</span></a>
          are special cases of location conveyance protocols.
</li>
<li>Location Object Formats define how location information and
          ancillary data are encoded; information is passed between distant
          points in the distribution chain by being carried in the LO.
</li>
<li>Location Reference Formats define how location references (i.e.,
          request parameters) are encoded for dissemination from an LS to
          LRs.
</li>
</ul>

<p>The roles played by these protocols are described in <a class='info' href='#trans-sec'>Section&nbsp;3.1<span> (</span><span class='info'>Structure of a Location Transmission</span><span>)</span></a>, and corresponding security requirements are
      described in <a class='info' href='#req-sec'>Section&nbsp;5<span> (</span><span class='info'>Security Requirements</span><span>)</span></a>.
</p>
<p>This document re-defines the following terms from RFC 3693 in an
      effort to refine their scope: Rule Maker, Location Server, Location
      Recipient, Location Generator, Viewer. Full definitions are given in
      <a class='info' href='#trans-sec'>Section&nbsp;3.1<span> (</span><span class='info'>Structure of a Location Transmission</span><span>)</span></a> and <a class='info' href='#e2e-sec'>Section&nbsp;3.2<span> (</span><span class='info'>The End-to-end Model and Global Roles</span><span>)</span></a>.
</p>
<a name="arch-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
An End-to-end Location Architecture</h3>

<p>In this section, we present an architecture for the end-to-end
      communication of location information. The overall pattern of
      transmissions involved in this communication is often complex and thus
      such systems are modeled as the composition of atomic building
      blocks.
</p>
<p>In <a class='info' href='#trans-sec'>Section&nbsp;3.1<span> (</span><span class='info'>Structure of a Location Transmission</span><span>)</span></a> we describe a single location
      transmission, and the roles played by parties in such a transmission. A
      location transmission is an atomic unit that models a single movement of
      location information. In <a class='info' href='#e2e-sec'>Section&nbsp;3.2<span> (</span><span class='info'>The End-to-end Model and Global Roles</span><span>)</span></a> we describe how
      multiple location transmissions can fit together within an end-to-end
      system and the global roles played by entities in such a composite
      system. Finally, in <a class='info' href='#eg-sec'>Section&nbsp;3.3<span> (</span><span class='info'>Usage Scenarios for this Model</span><span>)</span></a> we demonstrate how
      this model maps to common location use-cases such as location
      configuration and point-to-point location conveyance.
</p>
<a name="trans-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Structure of a Location Transmission</h3>

<p>Location transmission is the basic building block for
        policy-constrained location distribution. The model we describe here
        for a location transmission is based on the one described for a
        presence server in RFC 4745. The protocol interactions involved in a
        location transmission are illustrated in <a class='info' href='#trans-fig'>Figure&nbsp;1<span> (</span><span class='info'>A single location transmission</span><span>)</span></a>: </p>
<ol class="text">
<li>A Rule Maker informs the Location Server about Privacy Rules
            governing the distribution of Location Objects.
</li>
<li>In some cases, the LR will acquire a location reference (e.g.,
            a URI or a domain name for the LS) through an external
            dissemination channel; a specification of this channel is outside
            the scope of this document.
</li>
<li>The transmission is initiated either when the LR sends a
            request to the LS, or when the LS is directed to transmit location
            by some other mechanism. (These two cases roughly correspond to
            Passive and Active Request-Response modes of RFC 4745,
            respectively.)
</li>
<li>The LS determines whether the transmission is permitted by
            currently available policy, and if so, transmits location to the
            LR. Note that in addition to rules installed by the RM, the LS
            also uses policies contained in the LO itself and policies defined
            by local configuration.
</li>
</ol>

<p>The policy transaction in step (1) is conducted using a policy
        conveyance protocol. The reference communicated in step (2) is
        communicated through an unspecified dissemination channel in a given
        location reference format. The transmission in step (4) is conducted
        using a location conveyance protocol, and when the transmission is
        initiated by the LR, the request uses the location conveyance protocol
        as well. The LO is transmitted in some location object format.
</p>
<p>This model makes two important simplifying assumptions. First,
        multiple asynchronous responses to a single request are considered
        part of the same transmission. That is, we do not distinguish between
        the Passive Request-Response and Asynchronous modes of RFC 4745.
        Second, multiple LOs contained within a single response are considered
        as a single response. (A response containing multiple LOs is
        authorized if and only if all of the LOs in the response would be
        authorized independently.)
</p><br /><hr class="insert" />
<a name="trans-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>                     ............(2)...........
                     .                        .
                     .                        V
                +---------+&lt;-----(3)-----+---------+
                |  LS (3) |------(4)----&gt;|   LR    |
                +---------+              +---------+
                     ^
                     |
                    (1)
                     |
                +---------+
                |   RM    |
                +---------+</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: A single location transmission&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>There are three roles involved in this transaction, a Location
        Server (LS), a Location Recipient (LR), and a Rule Maker (RM). A
        single entity may play multiple of these roles within a single
        transmission (see Section <a class='info' href='#eg-sec'>Section&nbsp;3.3<span> (</span><span class='info'>Usage Scenarios for this Model</span><span>)</span></a> for examples).
        The only two roles that are necessarily separate are that of the LS
        and the LR.</p>
<blockquote class="text"><dl>
<dt>Rule Maker</dt>
<dd>The Rule Maker is the party who produces
            the rules governing whether a Location Recipient is allowed to
            receive location information and what precision of location
            information a Location Recipient is allowed to receive. (Formats
            for these rules are described in <a class='info' href='#RFC4745'>[RFC4745]<span> (</span><span class='info'>Schulzrinne, H., Tschofenig, H., Morris, J., Cuellar, J., Polk, J., and J. Rosenberg, &ldquo;Common Policy: A Document Format for Expressing Privacy Preferences,&rdquo; February&nbsp;2007.</span><span>)</span></a>
            and <a class='info' href='#I-D.ietf-geopriv-policy'>[I&#8209;D.ietf&#8209;geopriv&#8209;policy]<span> (</span><span class='info'>Schulzrinne, H., Tschofenig, H., Morris, J., Cuellar, J., and J. Polk, &ldquo;Geolocation Policy: A Document Format for Expressing Privacy Preferences for Location Information,&rdquo; January&nbsp;2010.</span><span>)</span></a>.) The Rule
            Maker may send rules directly to the Location Server, or the
            Location Server may receive the rules as part of a location object
            as per <a class='info' href='#RFC4119'>[RFC4119]<span> (</span><span class='info'>Peterson, J., &ldquo;A Presence-based GEOPRIV Location Object Format,&rdquo; December&nbsp;2005.</span><span>)</span></a>. Note that some
            transmissions may occur without a Rule Maker, in which cases the
            transmission is constrained only by policy contained in the LO
            itself and LS-internal policy.
</dd>
<dt>Location Server</dt>
<dd>The Location Server is the party who
            possesses the location information at the beginning of the
            transmission. The Location Server receives rules governing the
            location information as received from the Rule Maker, as part of
            the location object containing the location information, or as
            part of its internal configuration. The Location Server is
            responsible for applying these rules and as such he may need to
            reduce the precision of the location information or terminate the
            location transmission if the Location Recipient is not authorized
            to receive the location information. After applying the
            appropriate rules, the Location Server sends the location
            information to the Location Recipient.
</dd>
<dt>Location Recipient</dt>
<dd>The Location Recipient receives
            the location from the Location Server, either by making a request
            to the LS or as a result of an LS-initiated transmission.
</dd>
</dl></blockquote>

<p>The distinction between LS-initiated and LR-initiated transfers is
        significant, because in the latter case, the LR can influence which LO
        is transmitted. Additional concerns related to the dissemination of
        references and the interaction between requests and policy make the LS
        policy decision process considerably more complex when transmissions
        are initiated by the LR. Thus, we treat that case in more detail in
        the below.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Structure of a Location Request</h3>

<p>Logically, a location request is a message sent from an LR to an
          LS that requests that the LS send an LO (or set of LOs) to the LR.
          This means that the request must contain at least two types of
          data:</p>
<ol class="text">
<li>A description of the LO to be returned
</li>
<li>An identifier for the LR to which it should be delivered
</li>
</ol>

<p>Depending on the individual protocol and the individual request,
          the internal structure of these data can vary. For example, the
          identifier for the LR can be a source IP address or a SIP URI. The
          description of the LO to be returned could be a detailed set of
          parameters, or an opaque identifier; it could even be implicit,
          being inferred from the LR's identity. In general, we consider the
          identifier for the LR as a single datum, while the description of
          the LO is considered as logically consisting of a set of parameters,
          e.g:
</p>
<p></p>
<ul class="text">
<li>Identity of the target
</li>
<li>Time of sighting / timestamp
</li>
<li>Format of desired LO
</li>
<li>Positioning mechanism used in sighting
</li>
</ul>

<p>The LS may accept these parameters in "clear" or "opaque" form,
          i.e., in the form that can be readily matched against authorization
          rules or in the form of a random token that maps to a clear value in
          a way known only to the LS). In order to be considered "opaque", the
          values assigned by the LS MUST have sufficient entropy that they are
          difficult to guess without prior knowledge. Note also that the LS
          may choose to map a single opaque token to a collection of clear
          values.
</p>
<p>Implicit in the representation of parameter values by opaque
          tokens is that these tokens have a lifetime, namely, the period of
          time for which the LS retains a mapping between the opaque token and
          one or more clear parameter values.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Location References</h3>

<p>A location reference is a data structure that provides
          information on how to make a request for location. In order to be
          useful at all, a reference must contain contact information (e.g., a
          domain name) for an LS. Additionally, the reference may contain
          parameter values that describe an LO. The request that is generated
          from a reference has the indicated parameter values filled into
          appropriate fields, and is sent to the indicated LS.
</p>
<p>References are the mechanism whereby values for opaque parameters
          are distributed. An LS constructs a reference containing opaque
          values which is then distributed to LRs through some dissemination
          channel. Every reference that conveys opaque parameter values has a
          validity lifetime, which is the intersection of the validity
          intervals of the opaque values it conveys.
</p>
<p>To say this another way: Suppose that whenever an LS creates a
          reference it creates a new set of values for all opaque parameters
          (or, equivalently, creates a single opaque token that maps to a set
          of clear values), all with the same validity interval. Then the
          reference is valid over the same interval as the opaque tokens, and
          the LS can render the reference unusable by deleting the associated
          mapping(s).
</p>
<p>More concretely, location references are often encoded as URIs.
          For example, if there were an HTTP request protocol defined, the URI
          &lt;http://ls.example.net/134245&gt; would indicate that an HTTP
          request should be sent to ls.example.net, with the value "/134245"
          (or "http://lis.example.net/134245") as the Request URI (and in
          other fields as specified by the protocol). The validity lifetime of
          this URI is the lifetime for which the LS will store a mapping
          between the opaque value "134245" and a set of clear parameters.
</p>
<p>A location reference logically refers to a set of LOs, namely the
          set of LOs that the indicated LS will return to authorized
          requestors in response to requests with the indicated parameter
          values. When the reference does not specify all available
          parameters, this set contains LOs for all possible parameter values.
          Even when all parameters are set, the set of referenced LOs contains
          all values that are returned over time.
</p>
<p>The size of the referenced LO set determines the sensitivity of
          the reference. A reference that refers to a single LO can only
          expose that LO; i.e., its sensitivity is at most the sensitivity of
          the referenced LO (less if the LS applies access control). On the
          other hand, a reference that can be used to obtain a large set of
          locations can allow the holder of the reference track a target over
          time or to gather the LOs for many targets.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
LS Processing of Location Requests</h3>

<p>An LS determines whether to return an LO in response to a
          request, and which LO to return, based on three types of policy:
</p>
<p></p>
<ol class="text">
<li>A policy specifying which parameters are accepted in clear
              form (and how these should be formatted) and which are accepted
              in opaque form (these sets need not be disjoint). (The LS also
              maintains list of mappings of opaque tokens to clear values,
              which acts as a validation of opaque tokens.)
</li>
<li>A set of authorization rules of the form specified in RFC
              4745.
</li>
<li>A decision function for choosing which among multiple LOs to
              return.
</li>
</ol>

<p>The second of these three, can be populated from any of three
          sources: (1) Rule Makers, (2) Received LOs, and (3) internal
          configuration. The first and last are internal policies of the LS.
          When the LS receives a request, it applies these policies in the
          same order they are presented above:
</p>
<p></p>
<ol class="text">
<li>The LS verifies that clear parameters are properly formatted
              and that the values of opaque parameters are known tokens (i.e.,
              tokens with currently valid mappings to clear values). Valid
              opaque parameters are translated into clear values.
</li>
<li>The LS applies authorization rules to information provided in
              the request to determine the set of LOs that it is authorized to
              return. (Note: this set may not be explicitly enumerated, but
              rather expressed as a set of criteria.)
</li>
<li>If any of the authorized LOs are compliant with the request,
              then the LS applies the decision function to decide which LO(s)
              to return to the LR.
</li>
</ol>

<a name="e2e-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
The End-to-end Model and Global Roles</h3>

<p>The life-cycle of a Location Object typically consists of multiple
        location transmissions. For example, location might first be acquired
        via a location configuration protocol and then conveyed via a location
        conveyance protocol. This end-to-end distribution process can be
        described as a "chaining together" of the individual transmissions
        described above; different transmissions are connected by an entity
        that acts as an LR in one transmission and an LS in the next. This
        process is illustrated in <a class='info' href='#chain-fig'>Figure&nbsp;2<span> (</span><span class='info'>End-to-end location distribution</span><span>)</span></a>. Note that
        although <a class='info' href='#chain-fig'>Figure&nbsp;2<span> (</span><span class='info'>End-to-end location distribution</span><span>)</span></a> depicts a single "path", a
        single LS may transmit location to multiple LRs over time; grouping
        these paths together forms a logical distribution tree, with the LG as
        the root node and Viewers as leaf nodes.
</p><br /><hr class="insert" />
<a name="chain-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>       .              .              .
  +----+----+    +----+----+    +----+----+    +----+--------+
  | LG | LS |---&gt;| LR | LS |---&gt;| LR | LS |---&gt;| LR | Viewer |
  +----+----+    +----+----+    +----+----+    +----+--------+
       .  |           .  |           .  |
       . +----+       . +----+       . +----+
       . | RM |       . | RM |       . | RM |
       . +----+       . +----+       . +----+</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: End-to-end location distribution&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>In addition to the roles within a particular location transmission,
        there are also three additional global roles within the larger
        composite system. As described in Section 3, a given party may need
        particular assurances based on the global role that it plays. </p>
<blockquote class="text"><dl>
<dt>Location Generator</dt>
<dd>The Location Generator is the
            party that initially introduces location information into the
            Internet. The LG may be (but need not be) the entity that performs
            the sighting of the Target. The LG may be the same as the target
            when mechanisms such as GPS are used, but in many settings the
            location generator is a separate entity.
</dd>
<dt>Viewer</dt>
<dd>The Viewer is the party that ultimately makes
            use of the location information; in particular, the Viewer does
            not transmit location further. The Viewer is the Location
            Recipient in the final location transmission.
</dd>
<dt>Target</dt>
<dd>The Target is the party whose location is
            described by the transmitted LO. Although the Target does not
            explicitly play a role in the model above, every LO has a Target,
            and the Target can participate in the distribution process by
            playing other roles.
</dd>
</dl></blockquote><p>It is common for a party to play different roles within the
        different transmissions. For example, the Target might be the Location
        Recipient during location configuration, then act as Location Server
        when transmitting the LO to a presence server, then act as a Rule
        Maker by providing the presence server rules for further dissemination
        of the LO. In some cases, the Target may be a Location Generator or a
        Viewer; obviously, we assume that the roles of the LG and the Viewer
        are played by different entities.
</p>
<p>It is assumed that the only information passed from one
        transmission to another is the LO itself, so that information that is
        communicated across multiple hops is encoded in the LO. In particular,
        mechanisms for providing security across multiple location
        transmissions must define a new LO format, e.g., a PIDF-LO document
        encapsulated with the Cryptographic Message Syntax instead of an
        unencapsulated PIDF-LO.
</p>
<a name="eg-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Usage Scenarios for this Model</h3>

<p>In order to make the meaning of the above model clearer, this
        section describes how several common use cases can be described using
        the model. In addition, we describe how the transmission model
        described in RFC 3693 maps into the model described above.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
RFC 3693 model of transmission</h3>

<p>Section 4 of RFC 3693 depicts the relationships of the primary
          Geopriv entities, in which the Location Server acts as a relay
          between a Location Generator and a Location Recipient, with rules
          provided by a Rule Holder. In this document, we take a more limited
          view of three of these roles: Here an Location Server is simply an
          entity that transmits location (relying on a separate associated
          Location Recipient for input), a Location Generator is simply a
          distinguished Location Server, and Rule Holders are omitted from the
          discussion because they simply act as intermediaries for Rule
          Makers. The omission of Rule Holders is not meant to claim that Rule
          Holders do not exist (for instance, RMs may transmit rules to the LS
          via a store-and-forward network, in which the nodes would be RHs);
          however, they do not have application-level significance.
</p>
<p>In exchange for using these more limited roles, the single
          "T"-shaped diagram of RFC 3693 maps onto a chain of two
          transmissions, as illustrated in <a class='info' href='#rfc3693-fig'>Figure&nbsp;3<span> (</span><span class='info'>The model of RFC 3693, Section 4</span><span>)</span></a>
          below. The first transmission is from the LG (in this case, just
          another LS) to the LR that acts as the receiving component of the
          Location Server (in the sense of RFC 3693). The second transmission
          is from the LS acting as the sending component of the RFC 3693
          Location Server to the LR, as dictated by rules supplied by the
          RM.
</p><br /><hr class="insert" />
<a name="rfc3693-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>                           .
                           .
                    +-------------+
                    |     LS      |
       +----+----+  | +----+----+ |  +----+
       | LG | LS |---&gt;| LR | LS |---&gt;| LR |
       +----+----+  | +----+----+ |  +----+
              .     +--------|----+
              .            . |
            ......         . +----+
            . RM .         . | RM |
            ......         . +----+
                           .</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: The model of RFC 3693, Section 4&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2"></a><h3>3.3.2.&nbsp;
Location Configuration</h3>

<p>Location configuration protocols, such as HELD <a class='info' href='#I-D.ietf-geopriv-http-location-delivery'>[I&#8209;D.ietf&#8209;geopriv&#8209;http&#8209;location&#8209;delivery]<span> (</span><span class='info'>Barnes, M., Winterbottom, J., Thomson, M., and B. Stark, &ldquo;HTTP Enabled Location Delivery (HELD),&rdquo; August&nbsp;2009.</span><span>)</span></a>, that
          require a device to specifically "pull" location can be modeled as a
          location transmission as follows: The LCP server discovery mechanism
          is the dissemination channel, in that the discovery mechanism sends
          the endpoint the identity of the LCP server, e.g. the HELD LIS. The
          endpoint is the Location Recipient and the Target, and the initiator
          of the transmission. Upon receiving the identity of the LIS, the
          endpoint makes an LCP query to the LIS requesting location. The LCP
          server is the Location Server and has been internally configured
          with policy (there is no independent Rule Maker in this scenario).
          The LCP server applies the rules and returns a location object to
          the endpoint.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3"></a><h3>3.3.3.&nbsp;
Location Conveyance by Value</h3>

<p>A protocol, such as SIP, that conveys a location object by value
          can be modeled as a location transmission as follows. The calling
          device is the Location Server, and initiates the transmission. The
          calling device possesses a location object that contains the rules
          governing the location information. The called device is the
          Location Recipient. The calling device applies the rules within the
          location object and then sends the location object to the called
          device (e.g. in the body of a SIP INVITE).
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.4"></a><h3>3.3.4.&nbsp;
Location Conveyance by Reference</h3>

<p>A protocol, such as SIP, that conveys a location object by
          reference can be modeled as a location transmission as follows. In
          this case, SIP is the dissemination channel, over which a URI
          pointing to location is conveyed. The calling device sends the
          location reference, containing both the identity of an LS and the
          identity of the location information, to the called party (e.g. in
          the header of a SIP INVITE). The called party is the Location
          Recipient. Upon receiving the location reference, the called party
          sends a dereference request, containing a description of the desired
          LO, to the IS. The LS is naturally the Location Server, and has been
          previously provisioned with rules by the Rule Maker (likely the
          Target). The LS applies the appropriate rules for the location
          information and returns a location object to the called party.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.5"></a><h3>3.3.5.&nbsp;
Presence Server</h3>

<p>The subscription to location information on a presence server can
          be modeled as a location transmission as follows. The presence
          watcher is the Location Recipient, and initiates the transmission.
          Through some dissemination mechanism (e.g. a business card) the
          watcher learns the identity of a presence server and the identity of
          a target whose presence is stored on the server. The presence
          subscriber sends a subscription request, containing the identity of
          the target (which identifies the desired LO), to the presence
          server. The presence server has previously been provisioned with
          rules by the Rule Maker (in this case, most likely the target). The
          presence server applies the rules and constructs a location object
          which it then sends to the presence subscriber.
</p>
<a name="assure-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Required Assurances</h3>

<p>Each of the entities in the above model has expectations about how
      the system works, which may or may not be valid in a given situation.
      Depending on the needs of the entities, they may require assurances that
      their expectations are valid in a given situation. The goal of Geopriv
      security and privacy mechanisms is to provide such assurances. In order
      to determine requirements for Geopriv security mechanisms, then, we need
      to understand the assurances required by participants in the
      architecture.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Location Transmission</h3>

<p>As described above, there are generally three logical roles in a
        single location transmission. In some cases, the same entity may play
        multiple roles within a transmission. In that case, the set of
        assurances required by that entity is the union of the assurances
        required by the roles it fulfills.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Rule Maker</h3>

<p>The goal of the Rule Maker is provide the LS with policies to
          apply to transmissions, and to ensure that the rules clearly specify
          how the LS should execute them. The first assurance of relevance to
          the RM is to assure that rules are faithfully transmitted to the
          correct destination: Since policy documents can themselves be
          sensitive, the RM must verify that they are delivered only to the LS
          it intends, i.e., it must authenticate the identity of the LS and
          verify that the authenticated identity belongs to the desired LS.
          And since changes to a policy document can affect many subsequent
          transmissions, the RM requires assurance that rules are not modified
          en route to the LS. Second, in order to assure that policy is
          correctly executed, the transmitted rules must define an unambiguous
          mapping from requests to allowable LOs. The RM is further assured
          that the rules will be executed when the LS can provide confirmation
          that it is able to process the supplied rules at the time that the
          RM transmits them.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Location Server</h3>

<p>The goal of the Location Server is to transmit location in
          compliance with relevant policy. Thus, the primary assurances the LS
          requires are related to the question of whether a given transmission
          is authorized by policy. The LS must determine whether the LR is
          authorized to receive location. As a pre-requisite, the LS must also
          verify that policy is valid, i.e., that the Rule Maker is authorized
          to dictate policy. All of these authorization decisions require that
          the server authenticate the identities of the parties requesting
          access, the identity of the LR requesting location and the RM
          requesting modifications to policy. Note that the manner in which
          these authorization policies are installed on the LS and applied to
          specific transmissions is a matter of local configuration.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.3"></a><h3>4.1.3.&nbsp;
Location Recipient</h3>

<p>The goal of the Location Recipient is to acquire the desired LO.
          In general, this assurance can be decomposed into assuring that the
          LS is the one intended to deliver the LO and that the LO is
          faithfully transmitted from the LS to the LR; the LS is trusted by
          the LR to deliver the proper LO. When the transmission is initiated
          by the LS, the LR may not have information about the LS or the LO
          prior to the transmission, so it must also trust that the LS
          delivering location was properly instructed to do so. When the LR
          initiates a transmission, the LR knows the identity of the LS and
          relevant properties of the LO, so the LR can be assured that the LS
          from which it receives location is the proper one by authenticating
          the identity of the LS. In both cases, the LR requires assurance
          that the LO is not modified while en route between the LS and the
          LR.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
End-to-end distribution</h3>

<p>In addition to the three transmission entities described above, we
        also consider three distinguished entities in an end-to-end
        distribution scenario. They require assurances about the entire
        distribution chain, or the entire distribution tree.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Location Generator</h3>

<p>The Location Generator is the Location Server at the root of the
          distribution tree. The LG thus offers the valuable service of acting
          as an Internet-accessible source of location information, and its
          primary interest is in controlling the use of this service,
          especially controlling access to it. In terms of the model, the LG
          is interested in controlling the set of Viewers that are able to
          interpret and use the LO. There are two basic approaches to
          achieving this control: First, the LG may distribute LOs that are
          encrypted in such a way that only the Viewers that are authorized to
          access the location encoded in the LO. Second, the LG may distribute
          location references (i.e., it may support a dissemination channel),
          and only provide an LO in response to a dereference query by an
          authorized LR. (Because these references are not valuable by
          themselves, the LG can allow them to be distributed by parties that
          may not be authorized to access the location they refer to.) In
          order for the Viewer to obtain the referenced location, it has to
          engage in a transmission in which the LG is the LS; as part of this
          transmission, the LG can authenticate the LR and verify directly
          that the Viewer is authorized to receive the location.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Viewer</h3>

<p>The Viewer is the ultimate consumer of a Location Object. As a
          consumer, the Viewer requires assurance that the LO it receives is
          correct. In most situations, it is not possible to verify the
          correctness of location directly. Rather, a Viewer can receive
          assurance that a location is correct by virtue of assurance as to
          the identity of the source of the LO (i.e., the LG that provided
          it), and assurance that the LO was not modified en route to the
          Viewer. That is, the Viewer can have more confidence in the
          correctness of an LO when it can verify that the location was
          provided by a source that it trusts to provide correct location. As
          with LG access control, this verification can be done either through
          the object itself or through the LS that provides it. If the LO
          itself provides a verifiable assertion as to its origin, then the
          Viewer receives assurance about its correctness even if it receives
          the LO via an untrusted channel. On the other hand, if the LS that
          provides the LO is trusted to provide correct location, then the
          Viewer receives assurance about the LO's correctness even if the
          ultimate origin of the LO (i.e., the LG) remains unknown to the
          Viewer.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Target</h3>

<p>The interests of the Target are discussed at length in RFC 3693
          and RFC 3694. The Target by itself has no technical involvement in
          the distribution process; in order to affect how its location is
          distributed, it must take on one of the roles described above. For
          instance, the Target will commonly act as an LS to explicitly
          control how location is transmitted, or as a Rule Maker to control
          distribution by a third-party LS. Much like the LG, the main concern
          of the Target is controlling access to its location. If the Target
          acts as an LS, then the assurances and mechanisms available to it
          are essentially the same as those available to the LG.
</p>
<a name="assure-summary-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Summary of Required Assurances</h3>

<p></p>
<ul class="text">
<li>Rules must be protected against unauthorized modification en
            route.
</li>
<li>Rules must be protected against exposure to unauthorized
            parties.
</li>
<li>Location servers must accept rules only from authorized rule
            makers, as determined by local policy.
</li>
<li>Location objects must be exposed only to location recipients
            authorized by the associated rules (i.e. the rules contained in
            the location object, obtained from an authorized rule maker, or
            pre-configured on the location server in accordance with local
            policy).
</li>
<li>Location objects must be protected against unauthorized
            modification en route.
</li>
<li>Location generators must be able to assert that they have
            created a particular location object.
</li>
<li>Location viewers must be able to determine that a location
            object has passed unchanged through a chain of location servers
            and (intermediate) location recipients.
</li>
</ul>

<a name="req-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Requirements</h3>

<p>In order to enable the GEOPRIV location distribution system to
      provide assurances discussed in <a class='info' href='#assure-sec'>Section&nbsp;4<span> (</span><span class='info'>Required Assurances</span><span>)</span></a>, the
      constituent protocols must make certain security mechanisms available to
      the parties involved. In this section, we describe which security
      mechanisms are necessary to achieve each the assurances described in
      <a class='info' href='#assure-summary-sec'>Section&nbsp;4.3<span> (</span><span class='info'>Summary of Required Assurances</span><span>)</span></a>, and then provide requirements
      for such security mechanisms. In so doing, we provide requirements for
      three types of protocols:
</p>
<p></p>
<ul class="text">
<li>Policy Conveyance Protocols communicate policy information
          between rule makers and location servers. These can be dedicated
          protocols (e.g., XCAP), or, when rules are carried within a location
          object, the location conveyance protocol can act as a policy
          conveyance protocol.
</li>
<li>Location Conveyance Protocols communicate location requests and
          responses between the location server and the location recipient
          (e.g., SIP Geolocation, HELD, and Location Dereference
          Protocols)
</li>
<li>Location Object Formats define how location information and
          ancillary data are encoded; information is passed between distant
          points in the distribution chain by being carried in the LO.
</li>
<li>Location Reference Formats define how location references (i.e.,
          request parameters) are encoded for dissemination from an LS to
          LRs.
</li>
</ul>

<p>The term "Location Conveyance Protocol" is similar to the term "using
      protocol" introduced in RFC 3693, and used in RFC 4745, et al. The
      distinction between a Location Conveyance Protocol and other protocols
      that may incidentally carry location information (e.g., IP or TCP) is
      that a Location Conveyance Protocol makes a normative requirement on the
      LS (i.e., the party that transmits the LO) to apply policy. Note that in
      some cases, the LOs carried by a location conveyance protocol will
      themselves carry rules. When a location conveyance protocol supports the
      transmission of such LOs, it is also considered a policy conveyance
      protocol.
</p>
<p>The requirements described below are not strict requirements: They
      are lists of security features that must be present in order to support
      a certain set of assurances. A protocol specification can be in
      compliance with this document either by explaining how the protocol
      meets the security requirements for each assurance, or by explicitly
      disclaiming its ability to provide assurances for which it does not
      fulfill the requirements.
</p>
<p>Note also that the security features listed below need not be
      provided by cryptographic means in all cases. The primary example of
      non-cryptographic protection is the use of appropriate policy at an LS.
      As an additional example, protocols that are restricted to a local
      network (such as DHCP or LLDP-MED) may derive security properties from
      the physical security of the network.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Unauthorized Modification of Rules</h3>

<p>Rules are exposed to the risk to unauthorized modification en route
        when they are transmitted from a rule maker to a location server. A
        policy conveyance protocol can protect rules from unauthorized
        modification in two ways. First, the policy conveyance protocol can
        allow rules to be transmitted within an integrity-preserving
        encapsulation, such as CMS or S/MIME; this includes the use of an
        integrity-preserving LO format. Second, the policy conveyance protocol
        can allow a mode of operation in which it is carried over an
        integrity-protected channel, such as TLS.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-1</dt>
<dd>A policy conveyance protocol MUST either
            support the provision of rules in an integrity-preseving
            encapsulation, or else it must offer a mode of operation in which
            rules are only transmitted over an integrity-protected
            channel.
</dd>
</dl></blockquote>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Unauthorized Exposure of Rules</h3>

<p>Rules can be exposed to unauthorized parties in two ways. Either
        the RM transmits the rules to a party who is not authorized by the RM
        to act as a location server; or else an unauthorized party is able to
        access the rules en route from the RM to a location server. A
        mechanism that addresses both risks of exposure is to encapsulate the
        rules inside an encrypted object that can only be read by an
        authorized location server (e.g. CMS or S/MIME). Alternatively, the
        first risk can be mitigated by authenticating the location server to
        the rule maker; and the second risk can be mitigated by transmitting
        the rules only over confidentiality-protected channel.</p>
<blockquote class="text"><dl>
<dt>REQ-2</dt>
<dd>A policy conveyance protocol MUST either
            support the encapsulation of rules in an encrypted object format,
            or else it must provide mechanisms for the RM to authenticate the
            LS, and to the RM to transmit rules only over a
            confidentiality-protected channel.
</dd>
</dl></blockquote>

<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Acceptance of Rules from Unauthorized Rule Makers </h3>

<p>A location server must not accept rules from parties who are not
        authorized by local policy to update the set of rules used by the
        location server. This risk can be mitigated in two ways. By
        encapuslating the rules inside an object that is signed by the
        authorized rule maker, or by allowing authenticate the LS to
        authenticate the RM within the policy-handling protocol.</p>
<blockquote class="text"><dl>
<dt>REQ-3</dt>
<dd>A policy conveyance protocol MUST either
            support the signing of rules by the rule maker, or else the policy
            conveyance protocol must provide a mechanism for the LS to
            authenticate the identity of the RM.
</dd>
</dl></blockquote>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Unauthorized Exposure of Location Objects</h3>

<p>A location object can be exposed to unauthorized parties via a
        location transmission in two ways. Either a party other than the
        location recipient in a transmission is able to access the location
        object en route between the LS and the LR; or else the location server
        transmits the location object to an unauthorized location recipient.
        The former risk can be mitigated by transmitting the location object
        only over an encrypted channel. Mitigation of the latter risk differs
        depending on whether it is the location server or the location
        recipient who initiates the location transmission (i.e., the "push"
        case vs. the "pull" case). However, note that the mechanisms discussed
        in this section need not be applied in the case where distribution of
        a location object is unconstrained, i.e., when the authorization
        policy of the location server indicates that all possible location
        recipients are authorized to receive a particular location object.
</p>
<p>When the location server initiates the transmission, the LS must
        apply the authorization policy contained in the appropriate rules
        (i.e. the rules contained in the location object, obtained from an
        authorized rule maker, or locally configured on the LS) to determine
        if the location recipient is authorized to receive the given location
        object. In order to have a reliable identity on which to base these
        authorization decisions, the location server must either authenticate
        the location recipient within the location conveyance protocol, or
        else encapsulate the location object in a secure format so that it is
        accessible only to the authorized recipient.
</p>
<p>The case where the location recipient initiates the transaction is
        further sub-divided depending on whether the location server receives
        parameters in a "clear" or "opaque" form, as discussed in Section
        3.1.2. If the location server receives parameters in a "clear" form,
        then parameters themselves cannot provide any authentication. In this
        case, the location server MUST authenticate the identity of the
        location recipient and then apply authorization policy to determine if
        the location recipient is authorized to receive the requested location
        object.
</p>
<p>If the location server receives parameters in "opaque" form, then
        the location server may be able to derive some assurance about the
        location recipient based on the fact that the location recipient
        possesses the opaque token(s) presented in a request. In some cases,
        policy may indicate that the possession of these tokens is be
        sufficient for the location sever to determine that the location
        recipient is authorized to receive a given location object. Note
        however, that because these opaque parameters are intended to be used
        by multiple requestors, they are not bound to the identity of any
        given watcher and thus MUST NOT be used to satisfy a requirement to
        authenticate the LR via a shared secret (as in RFC 5025). When policy
        does not allow the use of these opaque tokens as authorization
        credentials, the location server MUST authenticate and explicitly
        authorize the location recipient as in the "clear" case above.
</p>
<p>Opaque parameters are to LRs via a dissemination channel (the
        dotted line in <a class='info' href='#trans-fig'>Figure&nbsp;1<span> (</span><span class='info'>A single location transmission</span><span>)</span></a>), in the form of
        location references in a location reference format. In formulating
        policy that determines whether an opaque token suffices for
        authenticate, rule makers and LS operators should keep in mind that
        the utility of opaque parameters for authentication is inherently
        limited by the security of the dissemination channel. An opaque token
        is a reliable authenticator only if it is only known to authorized
        location recipients. So a token used as authenticator MUST be provided
        confidentiality protection by the dissemination channel, and it MUST
        contain enough entropy that it is difficult to guess, a minimum of 128
        bits.
</p>
<p>Dissemination channels can take many different forms, from the SIP
        Geolocation header to SMTP message bodies to business cards. Because
        of this diversity, this document does not place requirements on the
        security features of dissemination protocols, but instead provides
        recommendations for which protocols should be used as dissemination
        channels. In particular, it is RECOMMENDED protocols used as
        dissemination channels provide confidentiality, authenticity, and
        integrity protection. Conversely, because these properties cannot be
        guaranteed, it is RECOMMENDED that an LS minimize the risk introduced
        by this exposure by minimizing the set of LOs to which a location
        reference refers, when that reference is not subject to authentication
        and access control.
</p>
<p>Finally, it may be the case that some LSs along a distribution path
        are unauthorized to access an LO that they transmit. In this case, an
        LO must be encapsulated in an encrypted LO format so that it is only
        accessible by authorized viewers. This encapsulation may be applied by
        the LG or by an intermediate LS.
</p>
<p>Second, opaque tokens can be retransmitted. Therefore, unless an
        opaque token format is able to encode retransmission rules, possession
        of an opaque token is never sufficient to authorize a party to receive
        a location object for which retransmission is forbidden.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-4</dt>
<dd>A location conveyance protocol MUST either
            support the encapsulation of LOs in an encrypted object format, or
            else it must provide mechanisms for the LS to authorize the LR,
            and to the LS to transmit LOs only over a
            confidentiality-protected channel. Input to the authorization
            process might be the authenticated identity or an opaque token (as
            a form of proof of possession).
</dd>
<dt>REQ-5</dt>
<dd>An LS MUST apply authentication and
            authorization policy to requests in which all parameters are in
            clear form. When a request contains opaque parameters, it is
            RECOMMENDED that the same process be followed.
</dd>
<dt>REQ-6</dt>
<dd>A location reference format MUST define a
            format for references that requires a cryptographically random
            component with a minimum entropy of 128 bits.
</dd>
<dt>REQ-7</dt>
<dd>An LS that does not apply identity-based
            authorization policy to requests for some references (e.g., for
            opaque references) MUST minimize the set of locations to which
            those references refer by setting a restrictive default policy.
            Additional rules provided by RMs MAY modify this default policy to
            make it more or less permissive.
</dd>
<dt>REQ-8</dt>
<dd>In order to support the prevention of
            unauthorized exposure to intermediate LSs, a location object
            format MUST include a format in which the LO is encrypted.
</dd>
</dl></blockquote>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Unauthorized Modification of Location Objects</h3>

<p>Location Objects are at risk of unauthorized modification en route
        when they are transmitted from the location server to the location
        recipient. Location objects can be protected against such unauthorized
        modification if the location conveyance protocol transmits location
        objects in an integrity-protected format or over an
        integrity-protected channel. Additionally, a Location Recipient risks
        receipt of a modified (or fabricated) location object if it does not
        authenticate that the location object was transmitted by an entity
        that is authorized (by local policy) to act as a location server.
</p>
<p>Note that these protections by the location conveyance protocol
        need not be used if the location object itself is signed (either by
        the location generator or by the location server); provided that the
        location recipient is able to verify this signature. However, when the
        location recipient is not the location viewer, then the location
        recipient may be unable to verify a signature intended to provide
        end-to-end (or middle-to-end) integrity.</p>
<blockquote class="text"><dl>
<dt>REQ-9</dt>
<dd>A location conveyance protocol MUST either
            support the conveyance of LOs in an integrity-preseving
            encapsulation, or else it must offer a mode of operation in which
            LOs are only transmitted over an integrity-protected channel.
</dd>
<dt>REQ-10</dt>
<dd>A location conveyance protocol MUST allow the
            LR to authenticate the LS.
</dd>
</dl></blockquote>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
Assertion of Location Object Origins</h3>

<p>A location generator can assert that it created a particular
        location object by generating a cryptographic signature over the
        location object. Such an assertion allows a location viewer to
        identify the party that created a location object or that participated
        in its distribution, and thus make local policy decisions based on the
        origin or intermediate provenance of a location object. Additionally,
        such a signature can provide end-to-end integrity protection for the
        portion of the location object covered by the signature.
</p>
<p>Likewise, an LS can sign an object to assert that it was included
        along the distribution path of the LO. The mechanisms discussed in
        Section 5.5 enable a location recipient to determine that a location
        object was not modified en route from the most recent location server.
        However, in a setting where a location object traverses a chain of
        multiple location servers and location recipients, the ultimate
        location viewer may not trust every location server in the chain. When
        a location viewer has a trust relationship with a particular location
        server in the chain, that server can sign the object tp assure the
        integrity of the location object through multiple transmissions (i.e.,
        to provide middle-to-end integrity protection).
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REQ-11</dt>
<dd>In order to support assertion of the origin
            and distribution of LOs, and end-to-end or middle-to-end integrity
            protection, a location object format must enable an LG or LS to
            cryptographically sign a location object.
</dd>
</dl></blockquote>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.7"></a><h3>5.7.&nbsp;
Summary of Security Requirements</h3>

<p>The following security requirements apply to a policy conveyance
        protocol:</p>
<blockquote class="text"><dl>
<dt>REQ-1</dt>
<dd>A policy conveyance protocol MUST either
            support the provision of rules in an integrity-preseving
            encapsulation, or else it must offer a mode of operation in which
            rules are only transmitted over an integrity-protected
            channel.
</dd>
<dt>REQ-2</dt>
<dd>A policy conveyance protocol MUST either
            support the encapsulation of rules in an encrypted object format,
            or else it must provide mechanisms for the RM to authenticate the
            LS, and to the RM to transmit rules only over a
            confidentiality-protected channel.
</dd>
<dt>REQ-3</dt>
<dd>A policy conveyance protocol MUST either
            support the signing of rules by the rule maker, or else the policy
            conveyance protocol must provide a mechanism for the LS to
            authenticate the identity of the RM.
</dd>
</dl></blockquote><p>The following security requirements apply to a location
        conveyance protocol:</p>
<blockquote class="text"><dl>
<dt>REQ-4</dt>
<dd>A location conveyance protocol MUST either
            support the encapsulation of LOs in an encrypted object format, or
            else it must provide mechanisms for the LS to authenticate the LR,
            and to the LS to transmit LOs only over a
            confidentiality-protected channel.
</dd>
<dt>REQ-9</dt>
<dd>A location conveyance protocol MUST either
            support the conveyance of LOs in an integrity-preseving
            encapsulation, or else it must offer a mode of operation in which
            LOs are only transmitted over an integrity-protected channel.
</dd>
<dt>REQ-10</dt>
<dd>A location conveyance protocol MUST allow the
            LR to authenticate the LS.
</dd>
</dl></blockquote><p>The following security requirements apply to a secure
        location object format:</p>
<blockquote class="text"><dl>
<dt>REQ-8</dt>
<dd>In order to support the prevention of
            unauthorized exposure to intermediate LSs, a location object
            format MUST include a format in which the LO is encrypted.
</dd>
<dt>REQ-11</dt>
<dd>In order to support assertion of the origin
            and distribution of LOs, and end-to-end or middle-to-end integrity
            protection, a location object format must enable an LG or LS to
            cryptographically sign a location object.
</dd>
</dl></blockquote><p>The following security requirements apply to a location
        reference format:</p>
<blockquote class="text"><dl>
<dt>REQ-6</dt>
<dd>A location reference format MUST define a
            format for references that requires a cryptographically random
            component with a minimum entropy of 128 bits.
</dd>
</dl></blockquote><p>In addition, the following are recommended practices for LS
        policy:</p>
<blockquote class="text"><dl>
<dt>REQ-4</dt>
<dd>An LS MUST apply authentication and
            authorization policy to requests in which all parameters are in
            clear form. When a request contains opaque parameters, it is
            RECOMMENDED that the same process be followed.
</dd>
<dt>REQ-7</dt>
<dd>An LS that does not apply authentication and
            authorization policy to requests for some references MUST minimize
            the set of locations to which those references refer.
</dd>
</dl></blockquote>

<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>The focus of this document is the security of location objects. As
      such, security concerns are discussed throughout.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>This work was based on the security investigations conducted as part
      of the GEOPRIV Layer-7 Location Configuration Protocol design team,
      which produced <a class='info' href='#I-D.ietf-geopriv-l7-lcp-ps'>[I&#8209;D.ietf&#8209;geopriv&#8209;l7&#8209;lcp&#8209;ps]<span> (</span><span class='info'>Tschofenig, H. and H. Schulzrinne, &ldquo;GEOPRIV Layer 7 Location Configuration Protocol; Problem Statement and Requirements,&rdquo; July&nbsp;2009.</span><span>)</span></a>. We
      would like to thank all the members of the design team.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>This document makes no request of IANA.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ecrit-framework">[I-D.ietf-ecrit-framework]</a></td>
<td class="author-text">Rosen, B., Schulzrinne, H., Polk, J., and A. Newton, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-framework-10.txt">Framework for Emergency Calling using Internet Multimedia</a>,&rdquo; draft-ietf-ecrit-framework-10 (work in progress), July&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-framework-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-http-location-delivery">[I-D.ietf-geopriv-http-location-delivery]</a></td>
<td class="author-text">Barnes, M., Winterbottom, J., Thomson, M., and B. Stark, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-http-location-delivery-16.txt">HTTP Enabled Location Delivery (HELD)</a>,&rdquo; draft-ietf-geopriv-http-location-delivery-16 (work in progress), August&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-http-location-delivery-16.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-l7-lcp-ps">[I-D.ietf-geopriv-l7-lcp-ps]</a></td>
<td class="author-text">Tschofenig, H. and H. Schulzrinne, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-l7-lcp-ps-10.txt">GEOPRIV Layer 7 Location Configuration Protocol; Problem Statement and Requirements</a>,&rdquo; draft-ietf-geopriv-l7-lcp-ps-10 (work in progress), July&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-l7-lcp-ps-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-lbyr-requirements">[I-D.ietf-geopriv-lbyr-requirements]</a></td>
<td class="author-text">Marshall, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-lbyr-requirements-09.txt">Requirements for a Location-by-Reference Mechanism</a>,&rdquo; draft-ietf-geopriv-lbyr-requirements-09 (work in progress), November&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-lbyr-requirements-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-geopriv-policy">[I-D.ietf-geopriv-policy]</a></td>
<td class="author-text">Schulzrinne, H., Tschofenig, H., Morris, J., Cuellar, J., and J. Polk, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-policy-21.txt">Geolocation Policy: A Document Format for Expressing Privacy Preferences for Location Information</a>,&rdquo; draft-ietf-geopriv-policy-21 (work in progress), January&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-geopriv-policy-21.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3693">[RFC3693]</a></td>
<td class="author-text">Cuellar, J., Morris, J., Mulligan, D., Peterson, J., and J. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc3693">Geopriv Requirements</a>,&rdquo; RFC&nbsp;3693, February&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3693.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3694">[RFC3694]</a></td>
<td class="author-text">Danley, M., Mulligan, D., Morris, J., and J. Peterson, &ldquo;<a href="http://tools.ietf.org/html/rfc3694">Threat Analysis of the Geopriv Protocol</a>,&rdquo; RFC&nbsp;3694, February&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3694.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3825">[RFC3825]</a></td>
<td class="author-text">Polk, J., Schnizlein, J., and M. Linsner, &ldquo;<a href="http://tools.ietf.org/html/rfc3825">Dynamic Host Configuration Protocol Option for Coordinate-based Location Configuration Information</a>,&rdquo; RFC&nbsp;3825, July&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3825.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4119">[RFC4119]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4119">A Presence-based GEOPRIV Location Object Format</a>,&rdquo; RFC&nbsp;4119, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4119.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4745">[RFC4745]</a></td>
<td class="author-text">Schulzrinne, H., Tschofenig, H., Morris, J., Cuellar, J., Polk, J., and J. Rosenberg, &ldquo;<a href="http://tools.ietf.org/html/rfc4745">Common Policy: A Document Format for Expressing Privacy Preferences</a>,&rdquo; RFC&nbsp;4745, February&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4745.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4776">[RFC4776]</a></td>
<td class="author-text">Schulzrinne, H., &ldquo;<a href="http://tools.ietf.org/html/rfc4776">Dynamic Host Configuration Protocol (DHCPv4 and DHCPv6) Option for Civic Addresses Configuration Information</a>,&rdquo; RFC&nbsp;4776, November&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4776.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4825">[RFC4825]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4825">The Extensible Markup Language (XML) Configuration Access Protocol (XCAP)</a>,&rdquo; RFC&nbsp;4825, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4825.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5025">[RFC5025]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5025">Presence Authorization Rules</a>,&rdquo; RFC&nbsp;5025, December&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5025.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Richard Barnes</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">BBN Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">9861 Broken Land Pkwy, Suite 400</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Columbia, MD  21046</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 410 290 6169</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rbarnes@bbn.com">rbarnes@bbn.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Matt Lepinski</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">BBN Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10 Moulton St</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cambridge, MA  02138</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 617 873 5939</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mlepinski@bbn.com">mlepinski@bbn.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens
      Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Otto-Hahn-Ring 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Munich, Bavaria  81739</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@nsn.com">Hannes.Tschofenig@nsn.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.com">http://www.tschofenig.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Henning Schulzrinne</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Columbia University</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Computer Science</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">450 Computer Science Building</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">New York, NY  10027</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 212 939 7004</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hgs@cs.columbia.edu">hgs@cs.columbia.edu</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.cs.columbia.edu">http://www.cs.columbia.edu</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
