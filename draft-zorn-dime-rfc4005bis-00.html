<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Diameter Network Access Server Application</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Diameter Network Access Server Application">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">G. Zorn, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Network Zen</td></tr>
<tr><td class="header">Obsoletes: <a href='http://tools.ietf.org/html/rfcRFC4005'>RFC4005</a></td><td class="header">May 23, 2010</td></tr>
<tr><td class="header">(if&nbsp;approved)</td><td class="header">&nbsp;</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">&nbsp;</td></tr>
<tr><td class="header">Expires: November 24, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Diameter Network Access Server Application<br />draft-zorn-dime-rfc4005bis-00</h1>

<h3>Abstract</h3>

<p>
				This document describes the Diameter protocol application used for
				Authentication, Authorization, and Accounting (AAA) services in the
				Network Access Server (NAS) environment.  When combined with the
				Diameter Base protocol, Transport Profile, and Extensible
				Authentication Protocol specifications, this application
				specification satisfies typical network access services requirements.
				<br />
<br />

				Initial deployments of the Diameter protocol are expected to include
				legacy systems.  Therefore, this application has been carefully
				designed to ease the burden of protocol conversion between RADIUS and
				Diameter.  This is achieved by including the RADIUS attribute space
				to eliminate the need to perform many attribute translations.
				<br />
<br />

				The interactions between Diameter applications and RADIUS specified
				in this document are to be applied to all Diameter applications.  In
				this sense, this document extends the Base Diameter protocol.
			
</p>
<h3>Status of This Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on November 24, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Requirements Language<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#A-A-S">1.3.</a>&nbsp;
Advertising Application Support<br />
<a href="#anchor4">2.</a>&nbsp;
NAS Calls, Ports, and Sessions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.1.</a>&nbsp;
Diameter Session Establishment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.2.</a>&nbsp;
Diameter Session Reauthentication or Reauthorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.3.</a>&nbsp;
Diameter Session Termination<br />
<a href="#anchor8">3.</a>&nbsp;
Diameter NAS Application Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AAR">3.1.</a>&nbsp;
AA-Request (AAR) Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AAA">3.2.</a>&nbsp;
AA-Answer (AAA) Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RAR">3.3.</a>&nbsp;
Re-Auth-Request (RAR) Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RAA">3.4.</a>&nbsp;
Re-Auth-Answer (RAA) Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#STR">3.5.</a>&nbsp;
Session-Termination-Request (STR) Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#STA">3.6.</a>&nbsp;
Session-Termination-Answer (STA) Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ASR">3.7.</a>&nbsp;
Abort-Session-Request (ASR) Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ASA">3.8.</a>&nbsp;
Abort-Session-Answer (ASA) Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ACR">3.9.</a>&nbsp;
Accounting-Request (ACR) Command<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ACA">3.10.</a>&nbsp;
Accounting-Answer (ACA) Command<br />
<a href="#D-N-A-AVPs">4.</a>&nbsp;
Diameter NAS Application AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#D-A-D-F">4.1.</a>&nbsp;
Derived AVP Data Formats<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#QFR-Format">4.1.1.</a>&nbsp;
QoSFilterRule<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SESSION-AVP">4.2.</a>&nbsp;
NAS Session AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.2.1.</a>&nbsp;
Call and Session Information<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#N-P">4.2.2.</a>&nbsp;
NAS-Port AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#N-P-I">4.2.3.</a>&nbsp;
NAS-Port-Id AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.2.4.</a>&nbsp;
NAS-Port-Type AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.2.5.</a>&nbsp;
Called-Station-Id AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.2.6.</a>&nbsp;
Calling-Station-Id AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.2.7.</a>&nbsp;
Connect-Info AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.2.8.</a>&nbsp;
Originating-Line-Info AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.2.9.</a>&nbsp;
Reply-Message AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.3.</a>&nbsp;
NAS Authentication AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.3.1.</a>&nbsp;
User-Password AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.3.2.</a>&nbsp;
Password-Retry AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.3.3.</a>&nbsp;
Prompt AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#C-AUTH-AVP">4.3.4.</a>&nbsp;
CHAP-Auth AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#C-A-AVP">4.3.5.</a>&nbsp;
CHAP-Algorithm AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">4.3.6.</a>&nbsp;
CHAP-Ident AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#C-R-AVP">4.3.7.</a>&nbsp;
CHAP-Response AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#C-C-AVP">4.3.8.</a>&nbsp;
CHAP-Challenge AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">4.3.9.</a>&nbsp;
ARAP-Password AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.3.10.</a>&nbsp;
ARAP-Challenge-Response AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#A-S-AVP">4.3.11.</a>&nbsp;
ARAP-Security AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.3.12.</a>&nbsp;
ARAP-Security-Data AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AUTHZ-AVP">4.4.</a>&nbsp;
NAS Authorization AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#S-T-AVP">4.4.1.</a>&nbsp;
Service-Type AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#C-N-AVP">4.4.2.</a>&nbsp;
Callback-Number AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">4.4.3.</a>&nbsp;
Callback-Id AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">4.4.4.</a>&nbsp;
Idle-Timeout AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">4.4.5.</a>&nbsp;
Port-Limit AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#N-F-R-AVP">4.4.6.</a>&nbsp;
NAS-Filter-Rule AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">4.4.7.</a>&nbsp;
Filter-Id AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">4.4.8.</a>&nbsp;
Configuration-Token AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Q-F-R-AVP">4.4.9.</a>&nbsp;
QoS-Filter-Rule AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#F-A-A-AVP">4.4.10.</a>&nbsp;
Framed Access Authorization AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#F-P-AVP">4.4.10.1.</a>&nbsp;
Framed-Protocol AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">4.4.10.2.</a>&nbsp;
Framed-Routing AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">4.4.10.3.</a>&nbsp;
Framed-MTU AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">4.4.10.4.</a>&nbsp;
Framed-Compression AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">4.4.10.5.</a>&nbsp;
IP Access Authorization AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">4.4.10.5.1.</a>&nbsp;
Framed-IP-Address AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">4.4.10.5.2.</a>&nbsp;
Framed-IP-Netmask AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">4.4.10.5.3.</a>&nbsp;
Framed-Route AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">4.4.10.5.4.</a>&nbsp;
Framed-Pool AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">4.4.10.5.5.</a>&nbsp;
Framed-Interface-Id AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">4.4.10.5.6.</a>&nbsp;
Framed-IPv6-Prefix AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">4.4.10.5.7.</a>&nbsp;
Framed-IPv6-Route AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">4.4.10.5.8.</a>&nbsp;
Framed-IPv6-Pool AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">4.4.10.6.</a>&nbsp;
IPX Access AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">4.4.10.6.1.</a>&nbsp;
Framed-IPX-Network AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">4.4.10.7.</a>&nbsp;
AppleTalk Network Access AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">4.4.10.7.1.</a>&nbsp;
Framed-AppleTalk-Link AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">4.4.10.7.2.</a>&nbsp;
Framed-AppleTalk-Network AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">4.4.10.7.3.</a>&nbsp;
Framed-AppleTalk-Zone AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor47">4.4.10.8.</a>&nbsp;
AppleTalk Remote Access AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor48">4.4.10.8.1.</a>&nbsp;
ARAP-Features AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor49">4.4.10.8.2.</a>&nbsp;
ARAP-Zone-Access AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor50">4.4.11.</a>&nbsp;
Non-Framed Access Authorization AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor51">4.4.11.1.</a>&nbsp;
Login-IP-Host AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor52">4.4.11.2.</a>&nbsp;
Login-IPv6-Host AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor53">4.4.11.3.</a>&nbsp;
Login-Service AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TCP-S">4.4.11.4.</a>&nbsp;
TCP Services<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor54">4.4.11.4.1.</a>&nbsp;
Login-TCP-Port AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#LAT-S">4.4.11.5.</a>&nbsp;
LAT Services<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor55">4.4.11.5.1.</a>&nbsp;
Login-LAT-Service AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor56">4.4.11.5.2.</a>&nbsp;
Login-LAT-Node AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor57">4.4.11.5.3.</a>&nbsp;
Login-LAT-Group AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor58">4.4.11.5.4.</a>&nbsp;
Login-LAT-Port AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TUNNELING-AVPS">4.5.</a>&nbsp;
NAS Tunneling AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor59">4.5.1.</a>&nbsp;
Tunneling AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#T-T-AVP">4.5.2.</a>&nbsp;
Tunnel-Type AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#T-M-T-AVP">4.5.3.</a>&nbsp;
Tunnel-Medium-Type AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#T-C-E-AVP">4.5.4.</a>&nbsp;
Tunnel-Client-Endpoint AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#T-S-E-AVP">4.5.5.</a>&nbsp;
Tunnel-Server-Endpoint AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor60">4.5.6.</a>&nbsp;
Tunnel-Password AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor61">4.5.7.</a>&nbsp;
Tunnel-Private-Group-Id AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor62">4.5.8.</a>&nbsp;
Tunnel-Assignment-Id AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor63">4.5.9.</a>&nbsp;
Tunnel-Preference AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor64">4.5.10.</a>&nbsp;
Tunnel-Client-Auth-Id AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor65">4.5.11.</a>&nbsp;
Tunnel-Server-Auth-Id AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ACCT-AVP">4.6.</a>&nbsp;
NAS Accounting AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor66">4.6.1.</a>&nbsp;
Accounting-Input-Octets AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor67">4.6.2.</a>&nbsp;
Accounting-Output-Octets AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor68">4.6.3.</a>&nbsp;
Accounting-Input-Packets AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor69">4.6.4.</a>&nbsp;
Accounting-Output-Packets AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor70">4.6.5.</a>&nbsp;
Acct-Session-Time AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor71">4.6.6.</a>&nbsp;
Acct-Authentic AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#A-A-M-AVP">4.6.7.</a>&nbsp;
Accounting-Auth-Method AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor72">4.6.8.</a>&nbsp;
Acct-Delay-Time AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor73">4.6.9.</a>&nbsp;
Acct-Link-Count AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor74">4.6.10.</a>&nbsp;
Acct-Tunnel-Connection AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor75">4.6.11.</a>&nbsp;
Acct-Tunnel-Packets-Lost AVP<br />
<a href="#A-O-T">5.</a>&nbsp;
AVP Occurrence Tables<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor76">5.1.</a>&nbsp;
AA-Request/Answer AVP Table<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor77">5.2.</a>&nbsp;
Accounting AVP Tables<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor78">5.2.1.</a>&nbsp;
Framed Access Accounting AVP Table<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor79">5.2.2.</a>&nbsp;
Non-Framed Access Accounting AVP Table<br />
<a href="#anchor80">6.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor81">6.1.</a>&nbsp;
Command Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor82">6.2.</a>&nbsp;
AVP Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor83">6.3.</a>&nbsp;
Application Identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor84">6.4.</a>&nbsp;
CHAP-Algorithm AVP Values<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#A-A-M-A-V">6.5.</a>&nbsp;
Accounting-Auth-Method AVP Values<br />
<a href="#anchor85">7.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#anchor88">Appendix&nbsp;A.</a>&nbsp;
Acknowledgements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor89">A.1.</a>&nbsp;
RFC 4005<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor90">A.2.</a>&nbsp;
RFC 4005bis<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
				This document describes the Diameter protocol application used for
				AAA in the Network Access Server (NAS) environment.  When combined
				with the Diameter Base protocol <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>, 
				Transport Profile <a class='info' href='#RFC3539'>[RFC3539]<span> (</span><span class='info'>Aboba, B. and J. Wood, &ldquo;Authentication, Authorization and Accounting (AAA) Transport Profile,&rdquo; June&nbsp;2003.</span><span>)</span></a>, 
				and EAP 
				<a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> 
				specifications, this specification satisfies NAS-related requirements defined
				in <a class='info' href='#RFC2989'>[RFC2989]<span> (</span><span class='info'>Aboba, B., Calhoun, P., Glass, S., Hiller, T., McCann, P., Shiino, H., Zorn, G., Dommety, G., C.Perkins, B.Patil, D.Mitton, S.Manning, M.Beadles, P.Walsh, X.Chen, S.Sivalingham, A.Hameed, M.Munson, S.Jacobs, B.Lim, B.Hirschman, R.Hsu, Y.Xu, E.Campell, S.Baba, and E.Jaques, &ldquo;Criteria for Evaluating AAA Protocols for Network Access,&rdquo; November&nbsp;2000.</span><span>)</span></a>
				and <a class='info' href='#RFC3169'>[RFC3169]<span> (</span><span class='info'>Beadles, M. and D. Mitton, &ldquo;Criteria for Evaluating Network Access Server Protocols,&rdquo; September&nbsp;2001.</span><span>)</span></a>.
				<br />
<br />

				Initial deployments of the Diameter protocol are expected to include
				legacy systems.  Therefore, this application has been carefully
				designed to ease the burden of protocol conversion between RADIUS and
				Diameter.  This is achieved by including the RADIUS attribute space
				to eliminate the need to perform many attribute translations.
				<br />
<br />

				The interactions specified in this document between Diameter
				applications and RADIUS are to be applied to all Diameter
				applications.  In this sense, this document extends the Base Diameter
				protocol <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>.
				<br />
<br />

				First, this document describes the operation of a Diameter NAS
				application.  Then it defines the Diameter message Command-Codes.
				The following sections list the AVPs used in these messages, grouped
				by common usage.  These are session identification, authentication,
				authorization, tunneling, and accounting.  The authorization AVPs are
				further broken down by service type.  Interaction and backward
				compatibility issues with RADIUS are discussed in later sections.
			
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>
					Section 1.2 of the base Diameter specification <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					defines most of
					the terminology used in this document.  Additionally, the following
					terms and acronyms are used in this application:
					</p>
<blockquote class="text"><dl>
<dt>NAS (Network Access Server)</dt>
<dd>
							
							A device that provides an access
							service for a user to a network.  The service may be a network
							connection or a value-added service such as terminal emulation <a class='info' href='#RFC2881'>[RFC2881]<span> (</span><span class='info'>Mitton, D. and M. Beadles, &ldquo;Network Access Server Requirements Next Generation (NASREQNG) NAS Model,&rdquo; July&nbsp;2000.</span><span>)</span></a>.
						
</dd>
<dt>PPP (Point-to-Point Protocol)</dt>
<dd>
							
							A multiprotocol serial datalink.  
							PPP is the primary IP datalink used for dial-in 
							NAS connection service <a class='info' href='#RFC1661'>[RFC1661]<span> (</span><span class='info'>Simpson, W., &ldquo;The Point-to-Point Protocol (PPP),&rdquo; July&nbsp;1994.</span><span>)</span></a>.
						
</dd>
<dt>CHAP (Challenge Handshake Authentication Protocol)</dt>
<dd>
							
							An authentication process used in PPP <a class='info' href='#RFC1994'>[RFC1994]<span> (</span><span class='info'>Simpson, W., &ldquo;PPP Challenge Handshake Authentication Protocol (CHAP),&rdquo; August&nbsp;1996.</span><span>)</span></a>.
						
</dd>
<dt>PAP (Password Authentication Protocol)</dt>
<dd>
							
							A deprecated PPP authentication process, 
							but often used for backward compatibility <a class='info' href='#RFC1334'>[RFC1334]<span> (</span><span class='info'>Lloyd, B. and W. Simpson, &ldquo;PPP Authentication Protocols,&rdquo; October&nbsp;1992.</span><span>)</span></a>.
						
</dd>
<dt>SLIP (Serial Line Interface Protocol)</dt>
<dd>
							
							A serial datalink that only supports IP.  A design prior to PPP.
						
</dd>
<dt>ARAP (Appletalk Remote Access Protocol)</dt>
<dd>
							
							A serial datalink for accessing Appletalk networks <a class='info' href='#ARAP'>[ARAP]<span> (</span><span class='info'>Apple Computer, &ldquo;Apple Remote Access Protocol (ARAP) Version 2.0 External Reference Specification,&rdquo; September&nbsp;1994.</span><span>)</span></a>.
						
</dd>
<dt>IPX (Internet Packet Exchange)</dt>
<dd>
							
							The network protocol used by NetWare networks <a class='info' href='#IPX'>[IPX]<span> (</span><span class='info'>Novell, Inc., &ldquo;NetWare System Technical Interface Overview,&rdquo; June&nbsp;1989.</span><span>)</span></a>.
						
</dd>
<dt>LAT (Local Area Transport</dt>
<dd>
							
							 A Digital Equipment Corp. LAN protocol for terminal services <a class='info' href='#LAT'>[LAT]<span> (</span><span class='info'>Digital Equipment Corp., &ldquo;Local Area Transport (LAT) Specification V5.0,&rdquo; June&nbsp;1989.</span><span>)</span></a>.
						 
</dd>
<dt>VPN (Virtual Private Network)</dt>
<dd>
							
							In this document, this term is used to describe access services that use tunneling methods.
						
</dd>
</dl></blockquote><p>	
				
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Requirements Language</h3>

<p>
					In this document, the key words "MAY", "MUST", "MUST NOT", "OPTIONAL",
					 "RECOMMENDED", "SHOULD", and "SHOULD NOT" are to be interpreted 
					 as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>,
				
</p>
<a name="A-A-S"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Advertising Application Support</h3>

<p>
					Diameter applications conforming to this specification MUST advertise
					support by including the value of one (1) in the Auth-Application-Id
					of the Capabilities-Exchange-Request (CER), AA-Request (AAR), and AA-Answer (AAA)
					messages.  All other messages are defined by RFC 3588
					and use the Base application id value.
				
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
NAS Calls, Ports, and Sessions</h3>

<p>
				The arrival of a new call or service connection at a port of a
				Network Access Server (NAS) starts a Diameter NAS message exchange.
				Information about the call, the identity of the user, and the user's
				authentication information are packaged into a Diameter AA-Request
				(AAR) message and sent to a server.
				<br />
<br />

				The server processes the information and responds with a Diameter
				AA-Answer (AAA) message that contains authorization information for
				the NAS, or a failure code (Result-Code AVP).  A value of
				DIAMETER_MULTI_ROUND_AUTH indicates an additional authentication
				exchange, and several AAR and AAA messages may be exchanged until the
				transaction completes.
				<br />
<br />

				Depending on the Auth-Request-Type AVP, the Diameter protocol allows
				authorization-only requests that contain no authentication
				information from the client.  This capability goes beyond the Call Check capabilities provided
				by RADIUS (<a class='info' href='#RFC2865'>Section 5.6 of<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> [RFC2865])
				in that no access decision is requested.  As a result, service cannot be started as a result of a
				response to an authorization-only request without introducing a significant security vulnerability.
				<br />
<br />

				Since no equivalent capability exists in RADIUS, authorization-only
				requests from a NAS implementing Diameter may not be easily
				translated to an equivalent RADIUS message by a Diameter/RADIUS
				gateway.  For example, when a Diameter authorization-only request
				cannot be translated to a RADIUS Call Check, it would be necessary
				for the Diameter/RADIUS gateway to add authentication information to
				the RADIUS Access Request.  On receiving the Access-Reply, the
				Diameter/RADIUS gateway would need to discard the access decision
				(Accept/Reject).  It is not clear whether these translations can be
				accomplished without adding significant security vulnerabilities.
			
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Diameter Session Establishment</h3>

<p>
					When the authentication or authorization exchange completes
					successfully, the NAS application SHOULD start a session context.  If
					the Result-Code of DIAMETER_MULTI_ROUND_AUTH is returned, the
					exchange continues until a success or error is returned.
					<br />
<br />

					If accounting is active, the application MUST also send an Accounting
					message <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>.  
					An Accounting-Record-Type of START_RECORD is sent
					for a new session.  If a session fails to start, the EVENT_RECORD
					message is sent with the reason for the failure described.
					<br />
<br />

					Note that the return of an unsupportable Accounting-Realtime-Required
					value <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					would result in a failure to establish the session.		
				
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Diameter Session Reauthentication or Reauthorization</h3>

<p>
					The Diameter Base protocol allows users to be periodically
					reauthenticated and/or reauthorized.  In such instances, the
					Session-Id AVP in the AAR message MUST be the same as the one present
					in the original authentication/authorization message.
					<br />
<br />

					A Diameter server informs the NAS of the maximum time allowed before
					reauthentication or reauthorization via the 
					Authorization-Lifetime AVP <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>.  
					A NAS MAY reauthenticate and/or reauthorize before the end, but A NAS MUST reauthenticate
					and/or reauthorize at the end of
					the period provided by the Authorization-Lifetime AVP.  The failure
					of a reauthentication exchange will terminate the service.
					<br />
<br />

					Furthermore, it is possible for Diameter servers to issue an
					unsolicited reauthentication and/or reauthorization request (e.g.,
					Re-Auth-Request (RAR) message <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>) 
					to the NAS.  Upon receipt of
					such a message, the NAS MUST respond to the request with a Re-Auth-Answer (RAA) 
					message <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>.
					<br />
<br />

					If the RAR properly identifies an active session, the NAS will
					initiate a new local reauthentication or authorization sequence as
					indicated by the Re-Auth-Request-Type value.  This will cause the NAS
					to send a new AAR message using the existing Session-Id.  The server
					will respond with an AAA message to specify the new service parameters.
					<br />
<br />

					If accounting is active, every change of authentication or
					authorization SHOULD generate an accounting message.  If the NAS
					service is a continuation of the prior user context, then an
					Accounting-Record-Type of INTERIM_RECORD indicating the new session
					attributes and cumulative status would be appropriate.  If a new user
					or a significant change in authorization is detected by the NAS, then
					the service may send two messages of the types STOP_RECORD and
					START_RECORD.  Accounting may change the subsession identifiers
					(Acct-Session-ID, or Acct-Sub-Session-Id) to indicate such sub-sessions.
					A service may also use a different Session-Id value for
					accounting <a class='info' href='#I-D.ietf-dime-rfc3588bis'>see Section 9.6 of<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis].
					<br />
<br />

					However, the Diameter Session-ID AVP value used for the initial
					authorization exchange MUST be used to generate an STR message when
					the session context is terminated.
				
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Diameter Session Termination</h3>

<p>
					When a NAS receives an indication that a user's session is being
					disconnected by the client (e.g., LCP Terminate is received) or an
					administrative command, the NAS MUST issue a 
					Session-Termination-Request (STR) <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					to its Diameter Server.  This will ensure that
					any resources maintained on the servers are freed appropriately.
					<br />
<br />

					Furthermore, a NAS that receives an Abort-Session-Request (ASR) <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					MUST issue an ASA if the session identified is active and
					disconnect the PPP (or tunneling) session.
					<br />
<br />

					If accounting is active, an Accounting STOP_RECORD message <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					MUST be sent upon termination of the session context.
					<br />
<br />

					More information on Diameter Session Termination can be found in
					<a class='info' href='#I-D.ietf-dime-rfc3588bis'>Sections 8.4 and 8.5 of<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis].
				
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Diameter NAS Application Messages</h3>

<p>
				This section defines the Diameter message Command-Code 
				<a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a> 
				values that MUST be supported by all Diameter implementations conforming to
				this specification.  The Command Codes are as follows:
			
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left" width="60%"><col align="center"><col align="center"><col align="left">
<tr><th align="left">Command Name</th><th align="center">Abbrev.</th><th align="center">Code</th><th align="left">Reference</th></tr>
<tr>
<td align="left">AA-Request</td>
<td align="center">AAR</td>
<td align="center">265</td>
<td align="left"><a class='info' href='#AAR'>Section&nbsp;3.1<span> (</span><span class='info'>AA-Request (AAR) Command</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">AA-Answer</td>
<td align="center">AAA</td>
<td align="center">265</td>
<td align="left"><a class='info' href='#AAA'>Section&nbsp;3.2<span> (</span><span class='info'>AA-Answer (AAA) Command</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Re-Auth-Request</td>
<td align="center">RAR</td>
<td align="center">258</td>
<td align="left"><a class='info' href='#RAR'>Section&nbsp;3.3<span> (</span><span class='info'>Re-Auth-Request (RAR) Command</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Re-Auth-Answer</td>
<td align="center">RAA</td>
<td align="center">258</td>
<td align="left"><a class='info' href='#RAA'>Section&nbsp;3.4<span> (</span><span class='info'>Re-Auth-Answer (RAA) Command</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Session-Termination-Request</td>
<td align="center">STR</td>
<td align="center">275</td>
<td align="left"><a class='info' href='#STR'>Section&nbsp;3.5<span> (</span><span class='info'>Session-Termination-Request (STR) Command</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Session-Termination-Answer</td>
<td align="center">STA</td>
<td align="center">275</td>
<td align="left"><a class='info' href='#STA'>Section&nbsp;3.6<span> (</span><span class='info'>Session-Termination-Answer (STA) Command</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Abort-Session-Request</td>
<td align="center">ASR</td>
<td align="center">274</td>
<td align="left"><a class='info' href='#ASR'>Section&nbsp;3.7<span> (</span><span class='info'>Abort-Session-Request (ASR) Command</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Abort-Session-Answer</td>
<td align="center">ASA</td>
<td align="center">274</td>
<td align="left"><a class='info' href='#ASA'>Section&nbsp;3.8<span> (</span><span class='info'>Abort-Session-Answer (ASA) Command</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Accounting-Request</td>
<td align="center">ACR</td>
<td align="center">271</td>
<td align="left"><a class='info' href='#ACR'>Section&nbsp;3.9<span> (</span><span class='info'>Accounting-Request (ACR) Command</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">Accounting-Answer</td>
<td align="center">ACA</td>
<td align="center">271</td>
<td align="left"><a class='info' href='#ACA'>Section&nbsp;3.10<span> (</span><span class='info'>Accounting-Answer (ACA) Command</span><span>)</span></a></td>
</tr>
</table>
<br clear="all" />

<a name="AAR"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
AA-Request (AAR) Command</h3>

<p>
					The AA-Request (AAR), which is indicated by setting the Command-Code
					field to 265 and the 'R' bit in the Command Flags field, is used to
					request authentication and/or authorization for a given NAS user.
					The type of request is identified through the Auth-Request-Type AVP <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					The recommended value for most RADIUS interoperability
					situations is AUTHORIZE_AUTHENTICATE.
					<br />
<br />

					If Authentication is requested, the User-Name attribute SHOULD be
					present, as well as any additional authentication AVPs that would
					carry the password information.  A request for authorization SHOULD
					only include the information from which the authorization will be
					performed, such as the User-Name, Called-Station-Id, or Calling-Station-Id AVPs.
					All requests SHOULD contain AVPs uniquely
					identifying the source of the call, such as Origin-Host and NAS-Port.
					Certain networks MAY use different AVPs for authorization purposes.
					A request for authorization will include some AVPs defined in <a class='info' href='#AUTHZ-AVP'>Section&nbsp;4.4<span> (</span><span class='info'>NAS Authorization AVPs</span><span>)</span></a>.
					<br />
<br />

					It is possible for a single session to be authorized first and then
					for an authentication request to follow.
					<br />
<br />

					This AA-Request message MAY be the result of a multi-round
					authentication exchange, which occurs when the AA-Answer message is
					received with the Result-Code AVP set to DIAMETER_MULTI_ROUND_AUTH.
					A subsequent AAR message SHOULD be sent, with the User-Password AVP
					that includes the user's response to the prompt, and MUST include any
					State AVPs that were present in the AAA message.
<br /><hr class="insert" />
<a name="figAAR"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Message Format

      &lt;AA-Request&gt; ::= &lt; Diameter Header: 265, REQ, PXY &gt;
                       &lt; Session-Id &gt;
                       { Auth-Application-Id }
                       { Origin-Host }
                       { Origin-Realm }
                       { Destination-Realm }
                       { Auth-Request-Type }
                       [ Destination-Host ]
                       [ NAS-Identifier ]
                       [ NAS-IP-Address ]
                       [ NAS-IPv6-Address ]
                       [ NAS-Port ]
                       [ NAS-Port-Id ]
                       [ NAS-Port-Type ]
                       [ Origin-AAA-Protocol ]
                       [ Origin-State-Id ]
                       [ Port-Limit ]
                       [ User-Name ]
                       [ User-Password ]
                       [ Service-Type ]
                       [ State ]
                       [ Authorization-Lifetime ]
                       [ Auth-Grace-Period ]
                       [ Auth-Session-State ]
                       [ Callback-Number ]
                       [ Called-Station-Id ]
                       [ Calling-Station-Id ]
                       [ Originating-Line-Info ]
                       [ Connect-Info ]
                       [ CHAP-Auth ]
                       [ CHAP-Challenge ]
                     * [ Framed-Compression ]
                       [ Framed-Interface-Id ]
                       [ Framed-IP-Address ]
                     * [ Framed-IPv6-Prefix ]
                       [ Framed-IP-Netmask ]
                       [ Framed-MTU ]
                       [ Framed-Protocol ]
                       [ ARAP-Password ]
                       [ ARAP-Security ]
                     * [ ARAP-Security-Data ]
                     * [ Login-IP-Host ]
                     * [ Login-IPv6-Host ]
                       [ Login-LAT-Group ]
                       [ Login-LAT-Node ]
                       [ Login-LAT-Port ]
                       [ Login-LAT-Service ]
                     * [ Tunneling ]
                     * [ Proxy-Info ]
                     * [ Route-Record ]
                     * [ AVP ]
</pre></div><p>

				
</p>
<a name="AAA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
AA-Answer (AAA) Command</h3>

<p>
					The AA-Answer (AAA) message is indicated by setting the Command-Code
					field to 265 and clearing the 'R' bit in the Command Flags field.  It
					is sent in response to the AA-Request (AAR) message.  If 
					authorization was requested, a successful response will include the
					authorization AVPs appropriate for the service being provided, as
					defined in <a class='info' href='#AUTHZ-AVP'>Section&nbsp;4.4<span> (</span><span class='info'>NAS Authorization AVPs</span><span>)</span></a>.
					<br />
<br />

					For authentication exchanges requiring more than a single round trip,
					the server MUST set the Result-Code AVP to DIAMETER_MULTI_ROUND_AUTH.
					An AAA message with this result code MAY include one Reply-Message or
					more and MAY include zero or one State AVPs.
					<br />
<br />

					If the Reply-Message AVP was present, the network access server
					SHOULD send the text to the user's client to display to the user,
					instructing the client to prompt the user for a response.  For
					example, this capability can be achieved in PPP via PAP.  If the
					access client is unable to prompt the user for a new response, it
					MUST treat the AA-Answer (AAA) with the Reply-Message AVP as an error and deny access.
<br /><hr class="insert" />
<a name="figAAA"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Message Format

      &lt;AA-Answer&gt; ::= &lt; Diameter Header: 265, PXY &gt;
                      &lt; Session-Id &gt;
                      { Auth-Application-Id }
                      { Auth-Request-Type }
                      { Result-Code }
                      { Origin-Host }
                      { Origin-Realm }
                      [ User-Name ]
                      [ Service-Type ]
                    * [ Class ]
                    * [ Configuration-Token ]
                      [ Acct-Interim-Interval ]
                      [ Error-Message ]
                      [ Error-Reporting-Host ]
                    * [ Failed-AVP ]
                      [ Idle-Timeout ]
                      [ Authorization-Lifetime ]
                      [ Auth-Grace-Period ]
                      [ Auth-Session-State ]
                      [ Re-Auth-Request-Type ]
                      [ Multi-Round-Time-Out ]
                      [ Session-Timeout ]
                      [ State ]
                    * [ Reply-Message ]
                      [ Origin-AAA-Protocol ]
                      [ Origin-State-Id ]
                    * [ Filter-Id ]
                      [ Password-Retry ]
                      [ Port-Limit ]
                      [ Prompt ]
                      [ ARAP-Challenge-Response ]
                      [ ARAP-Features ]
                      [ ARAP-Security ]
                    * [ ARAP-Security-Data ]
                      [ ARAP-Zone-Access ]
                      [ Callback-Id ]
                      [ Callback-Number ]
                      [ Framed-Appletalk-Link ]
                    * [ Framed-Appletalk-Network ]
                      [ Framed-Appletalk-Zone ]
                    * [ Framed-Compression ]
                      [ Framed-Interface-Id ]
                      [ Framed-IP-Address ]
                    * [ Framed-IPv6-Prefix ]
                      [ Framed-IPv6-Pool ]
                    * [ Framed-IPv6-Route ]
                      [ Framed-IP-Netmask ]
                    * [ Framed-Route ]
                      [ Framed-Pool ]
                      [ Framed-IPX-Network ]
                      [ Framed-MTU ]
                      [ Framed-Protocol ]
                      [ Framed-Routing ]
                    * [ Login-IP-Host ]
                    * [ Login-IPv6-Host ]
                      [ Login-LAT-Group ]
                      [ Login-LAT-Node ]
                      [ Login-LAT-Port ]
                      [ Login-LAT-Service ]
                      [ Login-Service ]
                      [ Login-TCP-Port ]
                    * [ NAS-Filter-Rule ]
                    * [ QoS-Filter-Rule ]
                    * [ Tunneling ]
                    * [ Redirect-Host ]
                      [ Redirect-Host-Usage ]
                      [ Redirect-Max-Cache-Time ]
                    * [ Proxy-Info ]
                    * [ AVP ]
</pre></div><p>

				
</p>
<a name="RAR"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Re-Auth-Request (RAR) Command</h3>

<p>
					A Diameter server may initiate a re-authentication and/or re-
					authorization service for a particular session by issuing a Re-Auth-Request (RAR) 
					message <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>.
					<br />
<br />

					For example, for pre-paid services, the Diameter server that
					originally authorized a session may need some confirmation that the
					user is still using the services.
					<br />
<br />

					If a NAS receives an RAR message with Session-Id equal to a currently
					active session and a Re-Auth-Type that includes authentication, it
					MUST initiate a re-authentication toward the user, if the service
					supports this particular feature.
<br /><hr class="insert" />
<a name="figRAR"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Message Format

      &lt;RA-Request&gt;  ::= &lt; Diameter Header: 258, REQ, PXY &gt;
                       &lt; Session-Id &gt;
                       { Origin-Host }
                       { Origin-Realm }
                       { Destination-Realm }
                       { Destination-Host }
                       { Auth-Application-Id }
                       { Re-Auth-Request-Type }
                       [ User-Name ]
                       [ Origin-AAA-Protocol ]
                       [ Origin-State-Id ]
                       [ NAS-Identifier ]
                       [ NAS-IP-Address ]
                       [ NAS-IPv6-Address ]
                       [ NAS-Port ]
                       [ NAS-Port-Id ]
                       [ NAS-Port-Type ]
                       [ Service-Type ]
                       [ Framed-IP-Address ]
                       [ Framed-IPv6-Prefix ]
                       [ Framed-Interface-Id ]
                       [ Called-Station-Id ]
                       [ Calling-Station-Id ]
                       [ Originating-Line-Info ]
                       [ Acct-Session-Id ]
                       [ Acct-Multi-Session-Id ]
                       [ State ]
                     * [ Class ]
                       [ Reply-Message ]
                     * [ Proxy-Info ]
                     * [ Route-Record ]
                     * [ AVP ]
</pre></div><p>
				
				
</p>
<a name="RAA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Re-Auth-Answer (RAA) Command</h3>

<p>
					The Re-Auth-Answer (RAA) message <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					is sent in response to the RAR.  The Result-Code AVP MUST be present and indicates the
					disposition of the request.
					<br />
<br />

					A successful RAA transaction MUST be followed by an AAR message.
<br /><hr class="insert" />
<a name="figRAA"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Message Format

      &lt;RA-Answer&gt;  ::= &lt; Diameter Header: 258, PXY &gt;
                       &lt; Session-Id &gt;
                       { Result-Code }
                       { Origin-Host }
                       { Origin-Realm }
                       [ User-Name ]
                       [ Origin-AAA-Protocol ]
                       [ Origin-State-Id ]
                       [ Error-Message ]
                       [ Error-Reporting-Host ]
                     * [ Failed-AVP ]
                     * [ Redirected-Host ]
                       [ Redirected-Host-Usage ]
                       [ Redirected-Host-Cache-Time ]
                       [ Service-Type ]
                     * [ Configuration-Token ]
                       [ Idle-Timeout ]
                       [ Authorization-Lifetime ]
                       [ Auth-Grace-Period ]
                       [ Re-Auth-Request-Type ]
                       [ State ]
                     * [ Class ]
                     * [ Reply-Message ]
                       [ Prompt ]
                     * [ Proxy-Info ]
                     * [ AVP ]
</pre></div><p>
				
				
</p>
<a name="STR"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Session-Termination-Request (STR) Command</h3>

<p>
					The Session-Termination-Request (STR) message <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					is sent by the NAS to inform the Diameter Server that an authenticated and/or
					authorized session is being terminated.
<br /><hr class="insert" />
<a name="figSTR"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Message Format

      &lt;ST-Request&gt; ::= &lt; Diameter Header: 275, REQ, PXY &gt;
                      &lt; Session-Id &gt;
                      { Origin-Host }
                      { Origin-Realm }
                      { Destination-Realm }
                      { Auth-Application-Id }
                      { Termination-Cause }
                      [ User-Name ]
                      [ Destination-Host ]
                    * [ Class ]
                      [ Origin-AAA-Protocol ]
                      [ Origin-State-Id ]
                    * [ Proxy-Info ]
                    * [ Route-Record ]
                    * [ AVP ]
</pre></div><p>
			
				
</p>
<a name="STA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Session-Termination-Answer (STA) Command</h3>

<p>
					The Session-Termination-Answer (STA) message <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					is sent by the Diameter Server to acknowledge the notification that the session has
					been terminated.  The Result-Code AVP MUST be present and MAY contain
					an indication that an error occurred while the STR was being serviced.
					<br />
<br />

					Upon sending or receiving the STA, the Diameter Server MUST release
					all resources for the session indicated by the Session-Id AVP.  Any
					intermediate server in the Proxy-Chain MAY also release any
					resources, if necessary.
<br /><hr class="insert" />
<a name="figSTA"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Message Format

      &lt;ST-Answer&gt;  ::= &lt; Diameter Header: 275, PXY &gt;
                       &lt; Session-Id &gt;
                       { Result-Code }
                       { Origin-Host }
                       { Origin-Realm }
                       [ User-Name ]
                     * [ Class ]
                       [ Error-Message ]
                       [ Error-Reporting-Host ]
                     * [ Failed-AVP ]
                       [ Origin-AAA-Protocol ]
                       [ Origin-State-Id ]
                     * [ Redirect-Host ]
                       [ Redirect-Host-Usase ]
                       [ Redirect-Max-Cache-Time ]
                     * [ Proxy-Info ]
                     * [ AVP ]
</pre></div><p>
		
				
</p>
<a name="ASR"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Abort-Session-Request (ASR) Command</h3>

<p>
					The Abort-Session-Request (ASR) message <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					may be sent by any
					server to the NAS providing session service, to request that the
					session identified by the Session-Id be stopped.
<br /><hr class="insert" />
<a name="figASR"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Message Format

      &lt;AS-Request&gt;  ::= &lt; Diameter Header: 274, REQ, PXY &gt;
                       &lt; Session-Id &gt;
                       { Origin-Host }
                       { Origin-Realm }
                       { Destination-Realm }
                       { Destination-Host }
                       { Auth-Application-Id }
                       [ User-Name ]
                       [ Origin-AAA-Protocol ]
                       [ Origin-State-Id ]
                       [ NAS-Identifier ]
                       [ NAS-IP-Address ]
                       [ NAS-IPv6-Address ]
                       [ NAS-Port ]
                       [ NAS-Port-Id ]
                       [ NAS-Port-Type ]
                       [ Service-Type ]
                       [ Framed-IP-Address ]
                       [ Framed-IPv6-Prefix ]
                       [ Framed-Interface-Id ]
                       [ Called-Station-Id ]
                       [ Calling-Station-Id ]
                       [ Originating-Line-Info ]
                       [ Acct-Session-Id ]
                       [ Acct-Multi-Session-Id ]
                       [ State ]
                     * [ Class ]
                     * [ Reply-Message ]
                     * [ Proxy-Info ]
                     * [ Route-Record ]
                     * [ AVP ]
</pre></div><p>

				
</p>
<a name="ASA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.8"></a><h3>3.8.&nbsp;
Abort-Session-Answer (ASA) Command</h3>

<p>
					The ASA message <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					is sent in response to the ASR.  The Result-Code
					AVP MUST be present and indicates the disposition of the request.
					<br />
<br />

					If the session identified by Session-Id in the ASR was successfully
					terminated, Result-Code is set to DIAMETER_SUCCESS.  If the session
					is not currently active, the Result-Code AVP is set to
					DIAMETER_UNKNOWN_SESSION_ID.  If the access device does not stop the
					session for any other reason, the Result-Code AVP is set to
					DIAMETER_UNABLE_TO_COMPLY.
<br /><hr class="insert" />
<a name="figASA"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Message Format

      &lt;AS-Answer&gt;  ::= &lt; Diameter Header: 274, PXY &gt;
                       &lt; Session-Id &gt;
                       { Result-Code }
                       { Origin-Host }
                       { Origin-Realm }
                       [ User-Name ]
                       [ Origin-AAA-Protocol ]
                       [ Origin-State-Id ]
                       [ State]
                       [ Error-Message ]
                       [ Error-Reporting-Host ]
                     * [ Failed-AVP ]
                     * [ Redirected-Host ]
                       [ Redirected-Host-Usage ]
                       [ Redirected-Max-Cache-Time ]
                     * [ Proxy-Info ]
                     * [ AVP ]
</pre></div><p>

				
</p>
<a name="ACR"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.9"></a><h3>3.9.&nbsp;
Accounting-Request (ACR) Command</h3>

<p>
					The ACR message <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					is sent by the NAS to report its session
					information to a target server downstream.
					<br />
<br />

					Either the Acct-Application-Id AVP or the Vendor-Specific-Application-Id AVP
					MUST be present.  If the Vendor-Specific-Application-Id grouped AVP
					is present, it must have an Acct-Application-Id inside.
					<br />
<br />

					The AVPs listed in the Base protocol specification <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					MUST be assumed to be present, as
					appropriate.  
					NAS service-specific accounting AVPs SHOULD be present
					as described in <a class='info' href='#ACCT-AVP'>Section&nbsp;4.6<span> (</span><span class='info'>NAS Accounting AVPs</span><span>)</span></a> 
					and the rest of this specification.
<br /><hr class="insert" />
<a name="figACR"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Message Format

      &lt;AC-Request&gt; ::= &lt; Diameter Header: 271, REQ, PXY &gt;
                      &lt; Session-Id &gt;
                      { Origin-Host }
                      { Origin-Realm }
                      { Destination-Realm }
                      { Accounting-Record-Type }
                      { Accounting-Record-Number }
                      [ Acct-Application-Id ]
                      [ Vendor-Specific-Application-Id ]
                      [ User-Name ]
                      [ Accounting-Sub-Session-Id ]
                      [ Acct-Session-Id ]
                      [ Acct-Multi-Session-Id ]
                      [ Origin-AAA-Protocol ]
                      [ Origin-State-Id ]
                      [ Destination-Host ]
                      [ Event-Timestamp ]
                      [ Acct-Delay-Time ]
                      [ NAS-Identifier ]
                      [ NAS-IP-Address ]
                      [ NAS-IPv6-Address ]
                      [ NAS-Port ]
                      [ NAS-Port-Id ]
                      [ NAS-Port-Type ]
                    * [ Class ]
                      [ Service-Type ]
                      [ Termination-Cause ]
                      [ Accounting-Input-Octets ]
                      [ Accounting-Input-Packets ]
                      [ Accounting-Output-Octets ]
                      [ Accounting-Output-Packets ]
                      [ Acct-Authentic ]
                      [ Accounting-Auth-Method ]
                      [ Acct-Link-Count ]
                      [ Acct-Session-Time ]
                      [ Acct-Tunnel-Connection ]
                      [ Acct-Tunnel-Packets-Lost ]
                      [ Callback-Id ]
                      [ Callback-Number ]
                      [ Called-Station-Id ]
                      [ Calling-Station-Id ]
                    * [ Connection-Info ]
                      [ Originating-Line-Info ]
                      [ Authorization-Lifetime ]
                      [ Session-Timeout ]
                      [ Idle-Timeout ]
                      [ Port-Limit ]
                      [ Accounting-Realtime-Required ]
                      [ Acct-Interim-Interval ]
                    * [ Filter-Id ]
                    * [ NAS-Filter-Rule ]
                    * [ Qos-Filter-Rule ]
                      [ Framed-AppleTalk-Link ]
                      [ Framed-AppleTalk-Network ]
                      [ Framed-AppleTalk-Zone ]
                      [ Framed-Compression ]
                      [ Framed-Interface-Id ]
                      [ Framed-IP-Address ]
                      [ Framed-IP-Netmask ]
                    * [ Framed-IPv6-Prefix ]
                      [ Framed-IPv6-Pool ]
                    * [ Framed-IPv6-Route ]
                      [ Framed-IPX-Network ]
                      [ Framed-MTU ]
                      [ Framed-Pool ]
                      [ Framed-Protocol ]
                    * [ Framed-Route ]
                      [ Framed-Routing ]
                    * [ Login-IP-Host ]
                    * [ Login-IPv6-Host ]
                      [ Login-LAT-Group ]
                      [ Login-LAT-Node ]
                      [ Login-LAT-Port ]
                      [ Login-LAT-Service ]
                      [ Login-Service ]
                      [ Login-TCP-Port ]
                    * [ Tunneling ]
                    * [ Proxy-Info ]
                    * [ Route-Record ]
                    * [ AVP ]
</pre></div><p>
	
				
</p>
<a name="ACA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.10"></a><h3>3.10.&nbsp;
Accounting-Answer (ACA) Command</h3>

<p>
					The ACA message <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					is used to acknowledge an Accounting-Request command.
					The Accounting-Answer command contains the same Session-Id
					as the Request.  If the Accounting-Request was protected by end-to-end security, then the 
					corresponding ACA message MUST be protected as well.
					<br />
<br />

					Only the target Diameter Server or home Diameter Server SHOULD
					respond with the Accounting-Answer command.
					<br />
<br />

					Either the Acct-Application-Id AVP or the Vendor-Specific-Application-Id AVP
					MUST be present, as it was in the request.
					<br />
<br />

					The AVPs listed in the Base protocol specification <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					MUST be assumed to be present, as
					appropriate.  NAS service-specific accounting AVPs SHOULD be present
					as described in <a class='info' href='#ACCT-AVP'>Section&nbsp;4.6<span> (</span><span class='info'>NAS Accounting AVPs</span><span>)</span></a>
					and the rest of this specification.
<br /><hr class="insert" />
<a name="figACA"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Message Format

      &lt;AC-Answer&gt; ::= &lt; Diameter Header: 271, PXY &gt;
                      &lt; Session-Id &gt;
                      { Result-Code }
                      { Origin-Host }
                      { Origin-Realm }
                      { Accounting-Record-Type }
                      { Accounting-Record-Number }
                      [ Acct-Application-Id ]
                      [ Vendor-Specific-Application-Id ]
                      [ User-Name ]
                      [ Accounting-Sub-Session-Id ]
                      [ Acct-Session-Id ]
                      [ Acct-Multi-Session-Id ]
                      [ Event-Timestamp ]
                      [ Error-Message ]
                      [ Error-Reporting-Host ]
                    * [ Failed-AVP ]
                      [ Origin-AAA-Protocol ]
                      [ Origin-State-Id ]
                      [ NAS-Identifier ]
                      [ NAS-IP-Address ]
                      [ NAS-IPv6-Address ]
                      [ NAS-Port ]
                      [ NAS-Port-Id ]
                      [ NAS-Port-Type ]
                      [ Service-Type ]
                      [ Termination-Cause ]
                      [ Accounting-Realtime-Required ]
                      [ Acct-Interim-Interval ]
                    * [ Class ]
                    * [ Proxy-Info ]
                    * [ Route-Record ]
                    * [ AVP ]
</pre></div><p>

				
</p>
<a name="D-N-A-AVPs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Diameter NAS Application AVPs</h3>

<p>
				The following sections define a new derived AVP data format, a set of application-specific AVPs and 
				describe the use of AVPs defined in other documents by the Diameter NAS Application.
			
</p>
<a name="D-A-D-F"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Derived AVP Data Formats</h3>

<a name="QFR-Format"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
QoSFilterRule</h3>

<p>
						The QosFilterRule format is derived from the OctetString AVP Base
						Format.  It uses the ASCII charset.  Packets may be marked or
						metered based on the following information:
						</p>
<ul class="text">
<li>Direction (in or out)
</li>
<li>Source and destination IP address (possibly masked)
</li>
<li>Protocol
</li>
<li>Source and destination port (lists or ranges)
</li>
<li>DSCP values (no mask or range)
</li>
</ul><p>
						Rules for the appropriate direction are evaluated in order; the
						first matched rule terminates the evaluation.  Each packet is
						evaluated once.  If no rule matches, the packet is treated as best
						effort.  An access device unable to interpret or apply a QoS rule
						SHOULD NOT terminate the session.
						<br />
<br />

						QoSFilterRule filters MUST follow the following format:
						<br />
<br />

						
						</p>
<blockquote class="text">
<p>action dir proto from src to dst [options]
</p>
<p>where
								<br />
<br />

								</p>
<blockquote class="text"><dl>
<dt>action</dt>
<dd>
										
<blockquote class="text"><dl>
<dt>tag</dt>
<dd>
												Mark packet with a specific DSCP <a class='info' href='#RFC2474'>[RFC2474]<span> (</span><span class='info'>Nichols, K., Blake, S., Baker, F., and D. Black, &ldquo;Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers,&rdquo; December&nbsp;1998.</span><span>)</span></a>
											
</dd>
<dt>meter</dt>
<dd>Meter traffic
</dd>
</dl></blockquote>
										<br />
<br />

									
</dd>
<dt>dir</dt>
<dd>
										The format is as described under IPFilterRule 
										<a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
										<br />

									
</dd>
<dt>proto</dt>
<dd>
										The format is as described under IPFilterRule 
										<a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
										<br />

									
</dd>
<dt>src and dst</dt>
<dd>
										The format is as described under IPFilterRule 
										<a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
										<br />

									
</dd>
</dl></blockquote>
							

</blockquote><p>
						
						The options are described in <a class='info' href='#Q-F-R-AVP'>Section&nbsp;4.4.9<span> (</span><span class='info'>QoS-Filter-Rule AVP</span><span>)</span></a>.
						<br />
<br />

						The rule syntax is a modified subset of ipfw(8) from FreeBSD,
						and the ipfw.c code may provide a useful base for implementations.				
				   
</p>
<a name="SESSION-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
NAS Session AVPs</h3>

<p>
					Diameter reserves the AVP Codes 0 - 255 for RADIUS functions that are
					implemented in Diameter.
					<br />
<br />

					AVPs new to Diameter have code values of 256 and greater.  A Diameter
					message that includes one of these AVPs may represent functions not
					present in the RADIUS environment and may cause interoperability
					issues, should the request traverse an AAA system that only supports
					the RADIUS protocol.
				
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Call and Session Information</h3>

<p>
						This section describes the AVPs specific to NAS Diameter applications
						that are needed to identify the call and session context and status
						information.  On a request, this information allows the server to qualify the session.
						<br />
<br />

						These AVPs are used in addition to the following 
						AVPs from the base protocol specification <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>:
						<br />
<br />

						
						</p>
<blockquote class="text">
<p>Session-Id
</p>
<p>Auth-Application-Id
</p>
<p>Origin-Host
</p>
<p>Origin-Realm
</p>
<p>Auth-Request-Type
</p>
<p>Termination-Cause
</p>
</blockquote><p>
						
						<br />
<br />

						The following table gives the possible flag values for the session level AVPs
						and specifies whether the AVP MAY be encrypted.
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                         +---------------------+
                                         |    AVP Flag rules   |
                                         |----+-----+----+-----|----+
                                         |    |     |SHLD| MUST|    |
Attribute Name          Section Defined  |MUST| MAY | NOT|  NOT|Encr|
-----------------------------------------|----+-----+----+-----|----|
NAS-Port                4.2.2            | M  |  P  |    |  V  | Y  |
NAS-Port-Id             4.2.3            | M  |  P  |    |  V  | Y  |
NAS-Port-Type           4.2.4            | M  |  P  |    |  V  | Y  |
Called-Station-Id       4.2.5            | M  |  P  |    |  V  | Y  |
Calling-Station-Id      4.2.6            | M  |  P  |    |  V  | Y  |
Connect-Info            4.2.7            | M  |  P  |    |  V  | Y  |
Originating-Line-Info   4.2.8            |    | M,P |    |  V  | Y  |
Reply-Message           4.2.9            | M  |  P  |    |  V  | Y  |
-----------------------------------------|----+-----+----+-----|----|
</pre></div><p>

					
</p>
<a name="N-P"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
NAS-Port AVP</h3>

<p>
						The NAS-Port AVP (AVP Code 5) is of type Unsigned32 and contains the
						physical or virtual port number of the NAS which is authenticating
						the user.  Note that "port" is meant in its sense as a service
						connection on the NAS, not as an IP protocol identifier.
						<br />
<br />

						Either the NAS-Port AVP or the NAS-Port-Id AVP (<a class='info' href='#N-P-I'>Section&nbsp;4.2.3<span> (</span><span class='info'>NAS-Port-Id AVP</span><span>)</span></a>) 
						SHOULD be present in
						the AA-Request (AAR, <a class='info' href='#AAR'>Section&nbsp;3.1<span> (</span><span class='info'>AA-Request (AAR) Command</span><span>)</span></a>)
						command if the NAS differentiates among its ports.
					
</p>
<a name="N-P-I"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
NAS-Port-Id AVP</h3>

<p>
						The NAS-Port-Id AVP (AVP Code 87) is of type UTF8String and consists
						of ASCII text identifying the port of the NAS authenticating the
						user.  Note that "port" is meant in its sense as a service connection
						on the NAS, not as an IP protocol identifier.
						<br />
<br />

						Either the NAS-Port-Id or the NAS-Port (<a class='info' href='#N-P'>Section&nbsp;4.2.2<span> (</span><span class='info'>NAS-Port AVP</span><span>)</span></a>)
						SHOULD be present in the AA-Request (AAR, <a class='info' href='#AAR'>Section&nbsp;3.1<span> (</span><span class='info'>AA-Request (AAR) Command</span><span>)</span></a>)
						command if the NAS differentiates among its ports.
						NAS-Port-Id is intended for use by NASes that cannot conveniently number their ports.
					
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
NAS-Port-Type AVP</h3>

<p>
						The NAS-Port-Type AVP (AVP Code 61) is of type Enumerated and
						contains the type of the port on which the NAS is authenticating the
						user.  This AVP SHOULD be present if the NAS uses the same NAS-Port
						number ranges for different service types concurrently.
						<br />
<br />

						The currently supported values of the NAS-Port-Type AVP 
						are listed in <a class='info' href='#RADIUSTypes'>[RADIUSTypes]<span> (</span><span class='info'>IANA, &ldquo;RADIUS Types,&rdquo; .</span><span>)</span></a>.
					
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.5"></a><h3>4.2.5.&nbsp;
Called-Station-Id AVP</h3>

<p>
						The Called-Station-Id AVP (AVP Code 30) is of type UTF8String and
						allows the NAS to send the ASCII string describing the Layer 2
						address the user contacted in the request.  For dialup access, this
						can be a phone number obtained by using the Dialed Number Identification Service
						(DNIS) or a similar technology.  Note that this may be different from
						the phone number the call comes in on.  For use with IEEE 802 access,
						the Called-Station-Id MAY contain a MAC address formatted as
						described in <a class='info' href='#RFC3580'>[RFC3580]<span> (</span><span class='info'>Congdon, P., Aboba, B., Smith, A., Zorn, G., and J. Roese, &ldquo;IEEE 802.1X Remote Authentication Dial In User Service (RADIUS) Usage Guidelines,&rdquo; September&nbsp;2003.</span><span>)</span></a>.  
						It SHOULD only be present in authentication and/or authorization requests.
						<br />
<br />

						If the Called-Station-Id AVP is present in an AAR message,
						Auth-Request-Type AVP is set to AUTHORIZE_ONLY and the
						User-Name AVP is absent, the Diameter Server MAY perform
						authorization based on this AVP.  This can be used by a NAS to
						request whether a call should be answered based on the DNIS.
						<br />
<br />

						The codification of this field's allowed usage range is outside the scope of this specification.
					
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.6"></a><h3>4.2.6.&nbsp;
Calling-Station-Id AVP</h3>

<p>
						The Calling-Station-Id AVP (AVP Code 31) is of type UTF8String and
						allows the NAS to send the ASCII string describing the Layer 2
						address from which the user connected in the request.  For dialup
						access, this is the phone number the call came from, using Automatic
						Number Identification (ANI) or a similar technology.  For use with
						IEEE 802 access, the Calling-Station-Id AVP MAY contain a MAC
						address, formated as described in <a class='info' href='#RFC3580'>[RFC3580]<span> (</span><span class='info'>Congdon, P., Aboba, B., Smith, A., Zorn, G., and J. Roese, &ldquo;IEEE 802.1X Remote Authentication Dial In User Service (RADIUS) Usage Guidelines,&rdquo; September&nbsp;2003.</span><span>)</span></a>.  
						It SHOULD only be present in authentication and/or authorization requests.
						<br />
<br />

						If the Calling-Station-Id AVP is present in an AAR message, 
						the Auth-Request-Type AVP is set to 
						AUTHORIZE_ONLY and the
						User-Name AVP is absent, the Diameter Server MAY perform
						authorization based on the value of this AVP.  This can be used by a NAS to
						request whether a call should be answered based on the Layer 2
						address (ANI, MAC Address, etc.)
						<br />
<br />

						The codification of this field's allowed usage range is outside the scope of this specification.
					
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.7"></a><h3>4.2.7.&nbsp;
Connect-Info AVP</h3>

<p>
						The Connect-Info AVP (AVP Code 77) is of type UTF8String and is sent
						in the AA-Request message or an ACR message with the value of the
						Accounting-Record-Type AVP set to STOP.  When sent in the
						AA-Request, it indicates the nature of the user's connection.
						The connection speed SHOULD be included at the beginning of the first
						Connect-Info AVP in the message.  If the transmit and receive
						connection speeds differ, both may be included in the first AVP with
						the transmit speed listed first (the speed at which the NAS modem transmits), 
						then a slash (/), then the receive speed, and then other optional information.
						<br />
<br />

						For example: "28800 V42BIS/LAPM" or "52000/31200 V90"
						<br />
<br />

						If sent in an ACR message with the value of the
						Accounting-Record-Type AVP set to STOP, this attribute may summarize statistics
						relating to session quality.  For example, in IEEE 802.11, the
						Connect-Info AVP may contain information on the number of link
						layer retransmissions.  The exact format of this attribute is implementation specific.
					
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.8"></a><h3>4.2.8.&nbsp;
Originating-Line-Info AVP</h3>

<p>
						The Originating-Line-Info AVP (AVP Code 94) is of type OctetString
						and is sent by the NAS system to convey information about the origin
						of the call from an SS7 system.
						<br />
<br />

						The originating line information (OLI) element indicates the nature
						and/or characteristics of the line from which a call originated
						(e.g., pay phone, hotel, cellular).  Telephone companies are starting
						to offer OLI to their customers as an option over Primary Rate
						Interface (PRI).  Internet Service Providers (ISPs) can use OLI in
						addition to Called-Station-Id and Calling-Station-Id attributes to
						differentiate customer calls and to define different services.
						<br />
<br />

						The Value field contains two octets (00 - 99).  ANSI T1.113 and
						BELLCORE 394 can be used for additional information about these
						values and their use.  For information on the currently assigned
						values, see <a class='info' href='#ANITypes'>[ANITypes]<span> (</span><span class='info'>NANPA Number Resource Info, &ldquo;ANI Assignments,&rdquo; .</span><span>)</span></a>.
					
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.9"></a><h3>4.2.9.&nbsp;
Reply-Message AVP</h3>

<p>
						The Reply-Message AVP (AVP Code 18) is of type UTF8String and
						contains text that MAY be displayed to the user.  When used in an
						AA-Answer message with a successful Result-Code AVP, it indicates
						success.  When found in an AAA message with a Result-Code other than
						DIAMETER_SUCCESS, the AVP contains a failure message.
						<br />
<br />

						The Reply-Message AVP MAY contain text to prompt the user
						before another AA-Request attempt.  When used in an AA-Answer message containing a
						Result-Code AVP with the value DIAMETER_MULTI_ROUND_AUTH or in an Re-Auth-Request
						message, it MAY contain text to prompt the user for a response.
					
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
NAS Authentication AVPs</h3>

<p>
					This section defines the AVPs necessary to carry the authentication
					information in the Diameter protocol.  The functionality defined here
					provides a RADIUS-like AAA service over a more reliable and secure
					transport, as defined in the base protocol <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>.
					<br />
<br />

					The following table gives the possible flag values for the session level AVPs
					and specifies whether the AVP MAY be encrypted.
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                         +---------------------+
                                         |    AVP Flag rules   |
                                         |----+-----+----+-----|----+
                                         |    |     |SHLD| MUST|    |
Attribute Name           Section Defined |MUST| MAY | NOT|  NOT|Encr|
-----------------------------------------|----+-----+----+-----|----|
User-Password            4.3.1           | M  |  P  |    |  V  | Y  |
Password-Retry           4.3.2           | M  |  P  |    |  V  | Y  |
Prompt                   4.3.3           | M  |  P  |    |  V  | Y  |
CHAP-Auth                4.3.4           | M  |  P  |    |  V  | Y  |
CHAP-Algorithm           4.3.5           | M  |  P  |    |  V  | Y  |
CHAP-Ident               4.3.6           | M  |  P  |    |  V  | Y  |
CHAP-Response            4.3.7           | M  |  P  |    |  V  | Y  |
CHAP-Challenge           4.3.8           | M  |  P  |    |  V  | Y  |
ARAP-Password            4.3.9           | M  |  P  |    |  V  | Y  |
ARAP-Challenge-Response  4.3.10          | M  |  P  |    |  V  | Y  |
ARAP-Security            4.3.11          | M  |  P  |    |  V  | Y  |
ARAP-Security-Data       4.3.12          | M  |  P  |    |  V  | Y  |
-----------------------------------------|----+-----+----+-----|----|
</pre></div><p>

				
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
User-Password AVP</h3>

<p>
						The User-Password AVP (AVP Code 2) is of type OctetString and
						contains the password of the user to be authenticated, or the user's
						input in a multi-round authentication exchange.
						<br />
<br />

						The User-Password AVP contains a user password or one-time password
						and therefore represents sensitive information.  As required in <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>,
						Diameter messages are encrypted by using IPsec or TLS.
						Unless this AVP is used for one-time passwords, the User-Password AVP
						SHOULD NOT be used in untrusted proxy environments without encrypting
						it by using end-to-end security techniques.
						<br />
<br />

						The clear-text password (prior to encryption) MUST NOT be longer than 128 bytes in length.
					
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Password-Retry AVP</h3>

<p>
						The Password-Retry AVP (AVP Code 75) is of type Unsigned32 and MAY be
						included in the AA-Answer if the Result-Code indicates an
						authentication failure.  The value of this AVP indicates how many
						authentication attempts a user is permitted before being
						disconnected.  This AVP is primarily intended for use when the
						Framed-Protocol AVP (<a class='info' href='#F-P-AVP'>Section&nbsp;4.4.10.1<span> (</span><span class='info'>Framed-Protocol AVP</span><span>)</span></a>)
						is set to ARAP.
					
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3"></a><h3>4.3.3.&nbsp;
Prompt AVP</h3>

<p>
						The Prompt AVP (AVP Code 76) is of type Enumerated and MAY be present
						in the AA-Answer message.  When present, it is used by the NAS to
						determine whether the user's response, when entered, should be echoed.
						<br />
<br />

						The supported values are listed in <a class='info' href='#RADIUSTypes'>[RADIUSTypes]<span> (</span><span class='info'>IANA, &ldquo;RADIUS Types,&rdquo; .</span><span>)</span></a>
					
</p>
<a name="C-AUTH-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.4"></a><h3>4.3.4.&nbsp;
CHAP-Auth AVP</h3>

<p>
						The CHAP-Auth AVP (AVP Code 402) is of type Grouped and contains the
						information necessary to authenticate a user using the PPP
						Challenge-Handshake Authentication Protocol (CHAP) <a class='info' href='#RFC1994'>[RFC1994]<span> (</span><span class='info'>Simpson, W., &ldquo;PPP Challenge Handshake Authentication Protocol (CHAP),&rdquo; August&nbsp;1996.</span><span>)</span></a>.  
						If the CHAP-Auth AVP is found in a message,
						the CHAP-Challenge AVP <a class='info' href='#C-C-AVP'>Section&nbsp;4.3.8<span> (</span><span class='info'>CHAP-Challenge AVP</span><span>)</span></a>
						MUST be present as well.  The optional AVPs containing the CHAP response
						depend upon the value of the CHAP-Algorithm AVP <a class='info' href='#C-C-AVP'>Section&nbsp;4.3.8<span> (</span><span class='info'>CHAP-Challenge AVP</span><span>)</span></a>.
						The grouped AVP has the following ABNF grammar:
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
CHAP-Auth  ::= &lt; AVP Header: 402 &gt;
               { CHAP-Algorithm }
               { CHAP-Ident }
               [ CHAP-Response ]
             * [ AVP ]
</pre></div><p>

					
</p>
<a name="C-A-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.5"></a><h3>4.3.5.&nbsp;
CHAP-Algorithm AVP</h3>

<p>
					The CHAP-Algorithm AVP (AVP Code 403) is of type Enumerated and
					contains the algorithm identifier used in the computation of the 
					CHAP response <a class='info' href='#RFC1994'>[RFC1994]<span> (</span><span class='info'>Simpson, W., &ldquo;PPP Challenge Handshake Authentication Protocol (CHAP),&rdquo; August&nbsp;1996.</span><span>)</span></a>.  
					The following values are currently supported:
					</p>
<blockquote class="text"><dl>
<dt>CHAP with MD5       5</dt>
<dd>
							The CHAP response is computed by using the procedure described
							in <a class='info' href='#RFC1994'>[RFC1994]<span> (</span><span class='info'>Simpson, W., &ldquo;PPP Challenge Handshake Authentication Protocol (CHAP),&rdquo; August&nbsp;1996.</span><span>)</span></a>
							This algorithm requires that the CHAP-Response AVP <a class='info' href='#C-R-AVP'>Section&nbsp;4.3.7<span> (</span><span class='info'>CHAP-Response AVP</span><span>)</span></a>
							MUST be present in the CHAP-Auth AVP <a class='info' href='#C-AUTH-AVP'>Section&nbsp;4.3.4<span> (</span><span class='info'>CHAP-Auth AVP</span><span>)</span></a>.
						
</dd>
</dl></blockquote><p>
					
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.6"></a><h3>4.3.6.&nbsp;
CHAP-Ident AVP</h3>

<p>
						The CHAP-Ident AVP (AVP Code 404) is of type OctetString and contains
						the 1 octet CHAP Identifier used in the computation of the CHAP
						response <a class='info' href='#RFC1994'>[RFC1994]<span> (</span><span class='info'>Simpson, W., &ldquo;PPP Challenge Handshake Authentication Protocol (CHAP),&rdquo; August&nbsp;1996.</span><span>)</span></a>		
					
</p>
<a name="C-R-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.7"></a><h3>4.3.7.&nbsp;
CHAP-Response AVP</h3>

<p>
						The CHAP-Response AVP (AVP Code 405) is of type OctetString and
						contains the 16 octet authentication data provided by the user in
						response to the CHAP challenge <a class='info' href='#RFC1994'>[RFC1994]<span> (</span><span class='info'>Simpson, W., &ldquo;PPP Challenge Handshake Authentication Protocol (CHAP),&rdquo; August&nbsp;1996.</span><span>)</span></a>.
					
</p>
<a name="C-C-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.8"></a><h3>4.3.8.&nbsp;
CHAP-Challenge AVP</h3>

<p>
						The CHAP-Challenge AVP (AVP Code 60) is of type OctetString and
						contains the CHAP Challenge sent by the NAS to the CHAP peer
						<a class='info' href='#RFC1994'>[RFC1994]<span> (</span><span class='info'>Simpson, W., &ldquo;PPP Challenge Handshake Authentication Protocol (CHAP),&rdquo; August&nbsp;1996.</span><span>)</span></a>.
					
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.9"></a><h3>4.3.9.&nbsp;
ARAP-Password AVP</h3>

<p>
						The ARAP-Password AVP (AVP Code 70) is of type OctetString and is
						only present when the Framed-Protocol AVP (<a class='info' href='#F-P-AVP'>Section&nbsp;4.4.10.1<span> (</span><span class='info'>Framed-Protocol AVP</span><span>)</span></a>) 
						is included in the message and is set to ARAP.  This AVP MUST NOT be
						present if either the User-Password or the CHAP-Auth AVP is present.
						See <a class='info' href='#RFC2869'>[RFC2869]<span> (</span><span class='info'>Rigney, C., Willats, W., and P. Calhoun, &ldquo;RADIUS Extensions,&rdquo; June&nbsp;2000.</span><span>)</span></a> for more information on the contents of this AVP.
					
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.10"></a><h3>4.3.10.&nbsp;
ARAP-Challenge-Response AVP</h3>

<p>
						The ARAP-Challenge-Response AVP (AVP Code 84) is of type OctetString
						and is only present when the Framed-Protocol AVP (<a class='info' href='#F-P-AVP'>Section&nbsp;4.4.10.1<span> (</span><span class='info'>Framed-Protocol AVP</span><span>)</span></a>)
						is included in the message and is set to ARAP.  This AVP contains an
						8 octet response to the dial-in client's challenge.  The RADIUS
						server calculates this value by taking the dial-in client's challenge
						from the high-order 8 octets of the ARAP-Password AVP and performing
						DES encryption on this value with the authenticating user's password
						as the key.  If the user's password is fewer than 8 octets in length,
						the password is padded at the end with NULL octets to a length of 8before it is used as a key.
					
</p>
<a name="A-S-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.11"></a><h3>4.3.11.&nbsp;
ARAP-Security AVP</h3>

<p>
						The ARAP-Security AVP (AVP Code 73) is of type Unsigned32 and MAY be
						present in the AA-Answer message if the Framed-Protocol AVP (<a class='info' href='#F-P-AVP'>Section&nbsp;4.4.10.1<span> (</span><span class='info'>Framed-Protocol AVP</span><span>)</span></a>) is 
						set to the value of ARAP, and the Result-Code AVP (<a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>, Section 7.1)
						is set to DIAMETER_MULTI_ROUND_AUTH.  See <a class='info' href='#RFC2869'>[RFC2869]<span> (</span><span class='info'>Rigney, C., Willats, W., and P. Calhoun, &ldquo;RADIUS Extensions,&rdquo; June&nbsp;2000.</span><span>)</span></a> for more
						information on the contents of this AVP.
					
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.12"></a><h3>4.3.12.&nbsp;
ARAP-Security-Data AVP</h3>

<p>
						The ARAP-Security-Data AVP (AVP Code 74) is of type OctetString and MAY be
						present in the AA-Request or AA-Answer message if the Framed-Protocol
						AVP (<a class='info' href='#F-P-AVP'>Section&nbsp;4.4.10.1<span> (</span><span class='info'>Framed-Protocol AVP</span><span>)</span></a>)
						is set to the value of ARAP and the Result-Code AVP (<a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>, Section 7.1)
						is set to
						DIAMETER_MULTI_ROUND_AUTH.  This AVP contains the security module
						challenge or response associated with the ARAP Security Module
						specified in the ARAP-Security AVP (<a class='info' href='#A-S-AVP'>Section&nbsp;4.3.11<span> (</span><span class='info'>ARAP-Security AVP</span><span>)</span></a>).				
					
</p>
<a name="AUTHZ-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
NAS Authorization AVPs</h3>

<p>
					This section contains the authorization AVPs supported in the NAS
					Application.  The Service-Type AVP SHOULD be present in all messages
					and, based on its value, additional AVPs defined in this section and
					<a class='info' href='#TUNNELING-AVPS'>Section&nbsp;4.5<span> (</span><span class='info'>NAS Tunneling AVPs</span><span>)</span></a>
					MAY be present.
					<br />
<br />

					The following table gives the possible flag values for the session level AVPs
					and specifies whether the AVP MAY be encrypted.
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                         +---------------------+
                                         |    AVP Flag rules   |
                                         |----+-----+----+-----|----+
                                         |    |     |SHLD| MUST|    |
Attribute Name           Section Defined |MUST| MAY | NOT|  NOT|Encr|
-----------------------------------------|----+-----+----+-----|----|
Service-Type                4.4.1        | M  |  P  |    |  V  | Y  |
Callback-Number             4.4.2        | M  |  P  |    |  V  | Y  |
Callback-Id                 4.4.3        | M  |  P  |    |  V  | Y  |
Idle-Timeout                4.4.4        | M  |  P  |    |  V  | Y  |
Port-Limit                  4.4.5        | M  |  P  |    |  V  | Y  |
NAS-Filter-Rule             4.4.6        | M  |  P  |    |  V  | Y  |
Filter-Id                   4.4.7        | M  |  P  |    |  V  | Y  |
Configuration-Token         4.4.8        | M  |     |    | P,V |    |
QoS-Filter-Rule             4.4.9        |    |     |    |     |    |
Framed-Protocol             4.4.10.1     | M  |  P  |    |  V  | Y  |
Framed-Routing              4.4.10.2     | M  |  P  |    |  V  | Y  |
Framed-MTU                  4.4.10.3     | M  |  P  |    |  V  | Y  |
Framed-Compression          4.4.10.4     | M  |  P  |    |  V  | Y  |
Framed-IP-Address           4.4.10.5.1   | M  |  P  |    |  V  | Y  |
Framed-IP-Netmask           4.4.10.5.2   | M  |  P  |    |  V  | Y  |
Framed-Route                4.4.10.5.3   | M  |  P  |    |  V  | Y  |
Framed-Pool                 4.4.10.5.4   | M  |  P  |    |  V  | Y  |
Framed-Interface-Id         4.4.10.5.5   | M  |  P  |    |  V  | Y  |
Framed-IPv6-Prefix          4.4.10.5.6   | M  |  P  |    |  V  | Y  |
Framed-IPv6-Route           4.4.10.5.7   | M  |  P  |    |  V  | Y  |
Framed-IPv6-Pool            4.4.10.5.8   | M  |  P  |    |  V  | Y  |
Framed-IPX-Network          4.4.10.6.1   | M  |  P  |    |  V  | Y  |
Framed-Appletalk-Link       4.4.10.7.1   | M  |  P  |    |  V  | Y  |
Framed-Appletalk-Network    4.4.10.7.2   | M  |  P  |    |  V  | Y  |
Framed-Appletalk-Zone       4.4.10.7.3   | M  |  P  |    |  V  | Y  |
ARAP-Features               4.4.10.8.1   | M  |  P  |    |  V  | Y  |
ARAP-Zone-Access            4.4.10.8.2   | M  |  P  |    |  V  | Y  |
Login-IP-Host               4.4.11.1     | M  |  P  |    |  V  | Y  |
Login-IPv6-Host             4.4.11.2     | M  |  P  |    |  V  | Y  |
Login-Service               4.4.11.3     | M  |  P  |    |  V  | Y  |
Login-TCP-Port              4.4.11.4.1   | M  |  P  |    |  V  | Y  |
Login-LAT-Service           4.4.11.5.1   | M  |  P  |    |  V  | Y  |
Login-LAT-Node              4.4.11.5.2   | M  |  P  |    |  V  | Y  |
Login-LAT-Group             4.4.11.5.3   | M  |  P  |    |  V  | Y  |
Login-LAT-Port              4.4.11.5.4   | M  |  P  |    |  V  | Y  |
-----------------------------------------|----+-----+----+-----|----|
</pre></div><p>

				
</p>
<a name="S-T-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.1"></a><h3>4.4.1.&nbsp;
Service-Type AVP</h3>

<p>
						The Service-Type AVP (AVP Code 6) is of type Enumerated and contains
						the type of service the user has requested or the type of service to
						be provided.  One such AVP MAY be present in an authentication and/or
						authorization request or response.  A NAS is not required to
						implement all of these service types.  It MUST treat unknown or
						unsupported Service-Types received in a response as a failure and end
						the session with a DIAMETER_INVALID_AVP_VALUE Result-Code.
						<br />
<br />

						When used in a request, the Service-Type AVP SHOULD be considered a
						hint to the server that the NAS believes the user would prefer the
						kind of service indicated.  The server is not required to honor the
						hint.  Furthermore, if the service specified by the server is
						supported, but not compatible with the current mode of access, the
						NAS MUST fail to start the session.  The NAS MUST also generate the
						appropriate error message(s).
						<br />
<br />

						The complete list of defined values that the Service-Type AVP can take 
						can be found in <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> 
						and <a class='info' href='#RADIUSTypes'>[RADIUSTypes]<span> (</span><span class='info'>IANA, &ldquo;RADIUS Types,&rdquo; .</span><span>)</span></a>, but the following values require further qualification here:
						<br />
<br />

						
						</p>
<blockquote class="text">
<p>
								</p>
<blockquote class="text"><dl>
<dt>Login (1)</dt>
<dd>
										
										The user should be connected to a host.  The message MAY include additional AVPs 
										as defined in <a class='info' href='#TCP-S'>Section&nbsp;4.4.11.4<span> (</span><span class='info'>TCP Services</span><span>)</span></a> or <a class='info' href='#LAT-S'>Section&nbsp;4.4.11.5<span> (</span><span class='info'>LAT Services</span><span>)</span></a>.
										<br />
<br />

									
</dd>
<dt>Framed (2)</dt>
<dd>
										
										A Framed Protocol, such as PPP or SLIP, should be started for the User.  
										The message MAY include additional AVPs defined in <a class='info' href='#F-A-A-AVP'>Section&nbsp;4.4.10<span> (</span><span class='info'>Framed Access Authorization AVPs</span><span>)</span></a>,
										or <a class='info' href='#TUNNELING-AVPS'>Section&nbsp;4.5<span> (</span><span class='info'>NAS Tunneling AVPs</span><span>)</span></a> 
										for tunneling services.
										<br />
<br />

									
</dd>
<dt>Callback Login (3)</dt>
<dd>
										
										The user should be disconnected and called back, then connected
										to a host.  The message MAY include additional AVPs defined in this Section.
										<br />
<br />

									
</dd>
<dt>Callback Framed (4)</dt>
<dd>
										
										The user should be disconnected and called back, and then a Framed 
										Protocol, such as PPP or SLIP, should be started for the User.  
										The message MAY include additional AVPs defined in <a class='info' href='#F-A-A-AVP'>Section&nbsp;4.4.10<span> (</span><span class='info'>Framed Access Authorization AVPs</span><span>)</span></a>,
										or <a class='info' href='#TUNNELING-AVPS'>Section&nbsp;4.5<span> (</span><span class='info'>NAS Tunneling AVPs</span><span>)</span></a> 
										for tunneling services.
									
</dd>
</dl></blockquote>
							

</blockquote><p>
						
					
</p>
<a name="C-N-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.2"></a><h3>4.4.2.&nbsp;
Callback-Number AVP</h3>

<p>
						The Callback-Number AVP (AVP Code 19) is of type UTF8String and
						contains a dialing string to be used for callback.  It MAY be used in
						an authentication and/or authorization request as a hint to the
						server that a Callback service is desired, but the server is not
						required to honor the hint in the corresponding response.
						<br />
<br />

						The codification of this field's allowed usage range is outside the
						scope of this specification.
					
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.3"></a><h3>4.4.3.&nbsp;
Callback-Id AVP</h3>

<p>
						The Callback-Id AVP (AVP Code 20) is of type UTF8String and contains
						the name of a place to be called, to be interpreted by the NAS.  This
						AVP MAY be present in an authentication and/or authorization
						response.
						<br />
<br />

						This AVP is not roaming-friendly as it assumes that the Callback-Id
						is configured on the NAS.  Using the Callback-Number AVP <a class='info' href='#C-N-AVP'>Section&nbsp;4.4.2<span> (</span><span class='info'>Callback-Number AVP</span><span>)</span></a>
						is therefore preferable.
					
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.4"></a><h3>4.4.4.&nbsp;
Idle-Timeout AVP</h3>

<p>
						The Idle-Timeout AVP (AVP Code 28) is of type Unsigned32 and sets the
						maximum number of consecutive seconds of idle connection allowable to
						the user before termination of the session or before a prompt is
						issued.  The default is none, or system specific.					
					
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.5"></a><h3>4.4.5.&nbsp;
Port-Limit AVP</h3>

<p>
						The Port-Limit AVP (AVP Code 62) is of type Unsigned32 and sets the
						maximum number of ports the NAS provides to the user.  It MAY be used
						in an authentication and/or authorization request as a hint to the
						server that multilink PPP <a class='info' href='#RFC1990'>[RFC1990]<span> (</span><span class='info'>Sklower, K., Lloyd, B., McGregor, G., Carr, D., and T. Coradetti, &ldquo;The PPP Multilink Protocol (MP),&rdquo; August&nbsp;1996.</span><span>)</span></a>
						service is desired, but the server
						is not required to honor the hint in the corresponding response.				
					
</p>
<a name="N-F-R-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.6"></a><h3>4.4.6.&nbsp;
NAS-Filter-Rule AVP</h3>

<p>
						The NAS-Filter-Rule AVP (AVP Code 400) is of type IPFilterRule and
						provides filter rules that need to be configured on the NAS for the
						user.  One or more of these AVPs MAY be present in an authorization
						response.
					
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.7"></a><h3>4.4.7.&nbsp;
Filter-Id AVP</h3>

<p>
						The Filter-Id AVP (AVP Code 11) is of type UTF8String and contains
						the name of the filter list for this user.  Zero or more Filter-Id
						AVPs MAY be sent in an authorization answer.
						<br />
<br />

						Identifying a filter list by name allows the filter to be used on
						different NASes without regard to filter-list implementation details.
						However, this AVP is not roaming-friendly, as filter naming differs
						from one service provider to another.
						<br />
<br />

						In environments where backward compatibility with RADIUS is not required,
						it is RECOMMENDED that the 
						NAS-Filter-Rule AVP <a class='info' href='#N-F-R-AVP'>Section&nbsp;4.4.6<span> (</span><span class='info'>NAS-Filter-Rule AVP</span><span>)</span></a>
						be used instead.
					
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.8"></a><h3>4.4.8.&nbsp;
Configuration-Token AVP</h3>

<p>
						The Configuration-Token AVP (AVP Code 78) is of type OctetString and
						is sent by a Diameter Server to a Diameter Proxy Agent or Translation
						Agent in an AA-Answer command to indicate a type of user profile to
						be used.  It should not be sent to a Diameter Client (NAS).
						<br />
<br />

						The format of the Data field of this AVP is site specific.
					
</p>
<a name="Q-F-R-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.9"></a><h3>4.4.9.&nbsp;
QoS-Filter-Rule AVP</h3>

<p>
						The QoS-Filter-Rule AVP (AVP Code 407) is of
						type QoSFilterRule <a class='info' href='#QFR-Format'>Section&nbsp;4.1.1<span> (</span><span class='info'>QoSFilterRule</span><span>)</span></a>
						and
						provides QoS filter rules that need to be configured on the NAS for
						the user.  One or more such AVPs MAY be present in an authorization
						response.
						<br />
<br />

						</p>
<blockquote class="text"><dl>
<dt>DSCP &lt;color&gt;</dt>
<dd>
								If action is set to tag <a class='info' href='#QFR-Format'>Section&nbsp;4.1.1<span> (</span><span class='info'>QoSFilterRule</span><span>)</span></a> 
								this option MUST be included in the rule.
								<br />

								Color values are defined in <a class='info' href='#RFC2474'>[RFC2474]<span> (</span><span class='info'>Nichols, K., Blake, S., Baker, F., and D. Black, &ldquo;Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers,&rdquo; December&nbsp;1998.</span><span>)</span></a>.
								Exact matching of DSCP values is required (no masks or
								ranges).
							
</dd>
<dt>metering &lt;rate&gt; &lt;color_under&gt; &lt;color_over&gt;</dt>
<dd>
								The metering option provides Assured Forwarding, as defined in
								<a class='info' href='#RFC2597'>[RFC2597]<span> (</span><span class='info'>Heinanen, J., Baker, F., Weiss, W., and J. Wroclawski, &ldquo;Assured Forwarding PHB Group,&rdquo; June&nbsp;1999.</span><span>)</span></a>.
								and MUST be present if the action is set to meter <a class='info' href='#QFR-Format'>Section&nbsp;4.1.1<span> (</span><span class='info'>QoSFilterRule</span><span>)</span></a>
								The rate option is
								the throughput, in bits per second, used by the access device to mark packets.
								Traffic over the rate is marked with the color_over
								codepoint, and traffic under the rate is marked with the color_under codepoint.
								The color_under and color_over options contain the drop
								preferences and MUST conform to the recommended
								codepoint keywords described in <a class='info' href='#RFC2597'>[RFC2597]<span> (</span><span class='info'>Heinanen, J., Baker, F., Weiss, W., and J. Wroclawski, &ldquo;Assured Forwarding PHB Group,&rdquo; June&nbsp;1999.</span><span>)</span></a>
								(e.g., AF13).
								<br />

								The metering option also supports the strict limit on traffic required by Expedited
								Forwarding, as defined in <a class='info' href='#RFC3246'>[RFC3246]<span> (</span><span class='info'>Davie, B., Charny, A., Bennet, J., Benson, K., Le Boudec, J., Courtney, W., Davari, S., Firoiu, V., and D. Stiliadis, &ldquo;An Expedited Forwarding PHB (Per-Hop Behavior),&rdquo; March&nbsp;2002.</span><span>)</span></a>.
								The color_over option may contain the keyword "drop"
								 to prevent forwarding of traffic that exceeds the rate parameter.
							
</dd>
</dl></blockquote><p>
					
</p>
<a name="F-A-A-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10"></a><h3>4.4.10.&nbsp;
Framed Access Authorization AVPs</h3>

<p>
						This section lists the authorization AVPs necessary to
						support framed access, such as PPP and SLIP.  AVPs defined in this
						section MAY be present in a message if the Service-Type AVP was set
						to "Framed" or "Callback Framed".
					
</p>
<a name="F-P-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.1"></a><h3>4.4.10.1.&nbsp;
Framed-Protocol AVP</h3>

<p>
							The Framed-Protocol AVP (AVP Code 7) is of type Enumerated and
							contains the framing to be used for framed access.  This AVP MAY be
							present in both requests and responses.  The supported values are
							listed in <a class='info' href='#RADIUSTypes'>[RADIUSTypes]<span> (</span><span class='info'>IANA, &ldquo;RADIUS Types,&rdquo; .</span><span>)</span></a>.
						
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.2"></a><h3>4.4.10.2.&nbsp;
Framed-Routing AVP</h3>

<p>
							The Framed-Routing AVP (AVP Code 10) is of type Enumerated and
							contains the routing method for the user when the user is a router to
							a network.  This AVP SHOULD only be present in authorization
							responses.  The supported values are listed in  <a class='info' href='#RADIUSTypes'>[RADIUSTypes]<span> (</span><span class='info'>IANA, &ldquo;RADIUS Types,&rdquo; .</span><span>)</span></a>.
						
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.3"></a><h3>4.4.10.3.&nbsp;
Framed-MTU AVP</h3>

<p>
							The Framed-MTU AVP (AVP Code 12) is of type Unsigned32 and contains
							the Maximum Transmission Unit (MTU) to be configured for the user, when it
							is not negotiated by some other means (such as PPP).  This AVP SHOULD
							only be present in authorization responses.  The MTU value MUST be in
							the range from 64 to 65535.					
						
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.4"></a><h3>4.4.10.4.&nbsp;
Framed-Compression AVP</h3>

<p>
							The Framed-Compression AVP (AVP Code 13) is of type Enumerated and
							contains the compression protocol to be used for the link.  It MAY be
							used in an authorization request as a hint to the server that a
							specific compression type is desired, but the server is not required
							to honor the hint in the corresponding response.
							<br />
<br />

							More than one compression protocol AVP MAY be sent.  The NAS is
							responsible for applying the proper compression protocol to the
							appropriate link traffic.
							<br />
<br />

							The supported values are listed in <a class='info' href='#RADIUSTypes'>[RADIUSTypes]<span> (</span><span class='info'>IANA, &ldquo;RADIUS Types,&rdquo; .</span><span>)</span></a>.  					
						
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.5"></a><h3>4.4.10.5.&nbsp;
IP Access Authorization AVPs</h3>

<p>
							The AVPs defined in this section are used when the user requests, or
							is being granted, access service to IP.				
						
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.5.1"></a><h3>4.4.10.5.1.&nbsp;
Framed-IP-Address AVP</h3>

<p>
								The Framed-IP-Address AVP (AVP Code 8) <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>
								is of type OctetString and contains an IPv4 address of the type specified in the
								attribute value to be configured for the user.  It MAY be used in an
								authorization request as a hint to the server that a specific address
								is desired, but the server is not required to honor the hint in the corresponding response.
								<br />
<br />

								Two values have special significance: 0xFFFFFFFF and 0xFFFFFFFE.  The
								value 0xFFFFFFFF indicates that the NAS should allow the user to
								select an address (i.e., negotiated).  The value 0xFFFFFFFE indicates
								that the NAS should select an address for the user (e.g., assigned
								from a pool of addresses kept by the NAS).					
							
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.5.2"></a><h3>4.4.10.5.2.&nbsp;
Framed-IP-Netmask AVP</h3>

<p>
								The Framed-IP-Netmask AVP (AVP Code 9) is of type OctetString and
								contains the four octets of the IPv4 netmask to be configured for the
								user when the user is a router to a network.  It MAY be used in an
								authorization request as a hint to the server that a specific netmask
								is desired, but the server is not required to honor the hint in the
								corresponding response.  This AVP MUST be present in a response if
								the request included this AVP with a value of 0xFFFFFFFF.					
							
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.5.3"></a><h3>4.4.10.5.3.&nbsp;
Framed-Route AVP</h3>

<p>
								The Framed-Route AVP (AVP Code 22) is of type UTF8String and contains
								the ASCII routing information to be configured for the user on the
								NAS.  Zero or more of these AVPs MAY be present in an authorization
								response.
								<br />
<br />

								The string MUST contain a destination prefix in dotted quad form
								optionally followed by a slash and a decimal length specifier stating
								how many high-order bits of the prefix should be used.  This is
								followed by a space, a gateway address in dotted quad form, a space,
								and one or more metrics separated by spaces; for example,
								</p>
<blockquote class="text">
<p>"192.168.1.0/24 192.168.1.1 1"
</p>
</blockquote><p>
								The length specifier may be omitted, in which case it should default
								to 8 bits for class A prefixes, to 16 bits for class B prefixes, and
								to 24 bits for class C prefixes; for example,
								</p>
<blockquote class="text">
<p>"192.168.1.0 192.168.1.1 1"
</p>
</blockquote><p>
								Whenever the gateway address is specified as "0.0.0.0" the IP address
								of the user SHOULD be used as the gateway address.
							
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.5.4"></a><h3>4.4.10.5.4.&nbsp;
Framed-Pool AVP</h3>

<p>
								The Framed-Pool AVP (AVP Code 88) is of type OctetString and contains
								the name of an assigned address pool that SHOULD be used to assign an
								address for the user.  If a NAS does not support multiple address
								pools, the NAS SHOULD ignore this AVP.  Address pools are usually
								used for IP addresses but can be used for other protocols if the NAS
								supports pools for those protocols.
								<br />
<br />

								Although specified as type OctetString for compatibility with RADIUS
								<a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>,
								the encoding of the Data field SHOULD also conform to
								the rules for the UTF8String Data Format.
							
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.5.5"></a><h3>4.4.10.5.5.&nbsp;
Framed-Interface-Id AVP</h3>

<p>
								The Framed-Interface-Id AVP (AVP Code 96) is of type Unsigned64 and
								contains the IPv6 interface identifier to be configured for the user.
								It MAY be used in authorization requests as a hint to the server that
								a specific interface id is desired, but the server is not required to
								honor the hint in the corresponding response.					
							
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.5.6"></a><h3>4.4.10.5.6.&nbsp;
Framed-IPv6-Prefix AVP</h3>

<p>
								The Framed-IPv6-Prefix AVP (AVP Code 97) is of type OctetString and
								contains the IPv6 prefix to be configured for the user.  One or more
								AVPs MAY be used in authorization requests as a hint to the server
								that specific IPv6 prefixes are desired, but the server is not
								required to honor the hint in the corresponding response.					
							
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.5.7"></a><h3>4.4.10.5.7.&nbsp;
Framed-IPv6-Route AVP</h3>

<p>
								The Framed-IPv6-Route AVP (AVP Code 99) is of type UTF8String and
								contains the ASCII routing information to be configured for the user
								on the NAS.  Zero or more of these AVPs MAY be present in an
								authorization response.
								<br />
<br />

								The string MUST contain an IPv6 address prefix followed by a slash
								and a decimal length specifier stating how many high order bits of
								the prefix should be used.  This is followed by a space, a gateway
								address in hexadecimal notation, a space, and one or more metrics
								separated by spaces; for example,					
								</p>
<blockquote class="text">
<p>"2000:0:0:106::/64 2000::106:a00:20ff:fe99:a998 1"
</p>
</blockquote><p>
								Whenever the gateway address is the IPv6 unspecified address, the IP
								address of the user SHOULD be used as the gateway address, such as in:
								</p>
<blockquote class="text">
<p>"2000:0:0:106::/64 :: 1"
</p>
</blockquote><p>					
							
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.5.8"></a><h3>4.4.10.5.8.&nbsp;
Framed-IPv6-Pool AVP</h3>

<p>
								The Framed-IPv6-Pool AVP (AVP Code 100) is of type OctetString and
								contains the name of an assigned pool that SHOULD be used to assign
								an IPv6 prefix for the user.  If the access device does not support
								multiple prefix pools, it MUST ignore this AVP.
								<br />
<br />

								Although specified as type OctetString for compatibility with
								RADIUS <a class='info' href='#RFC3162'>[RFC3162]<span> (</span><span class='info'>Aboba, B., Zorn, G., and D. Mitton, &ldquo;RADIUS and IPv6,&rdquo; August&nbsp;2001.</span><span>)</span></a>, the encoding of the Data field SHOULD
								also conform to the rules for the UTF8String Data Format.					
							
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.6"></a><h3>4.4.10.6.&nbsp;
IPX Access AVPs</h3>

<p>
							The AVPs defined in this section are used when the user requests, or
							is being granted, access to an IPX network service <a class='info' href='#IPX'>[IPX]<span> (</span><span class='info'>Novell, Inc., &ldquo;NetWare System Technical Interface Overview,&rdquo; June&nbsp;1989.</span><span>)</span></a>.				
						
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.6.1"></a><h3>4.4.10.6.1.&nbsp;
Framed-IPX-Network AVP</h3>

<p>
								The Framed-IPX-Network AVP (AVP Code 23) is of type Unsigned32 and
								contains the IPX Network number to be configured for the user.
								It MAY be used in an authorization request as a hint to the server that
								a specific address is desired, but the server is not required to
								honor the hint in the corresponding response.
								<br />
<br />

								Two addresses have special significance: 0xFFFFFFFF and 0xFFFFFFFE.
								The value 0xFFFFFFFF indicates that the NAS should allow the user to
								select an address (i.e., Negotiated).  The value 0xFFFFFFFE indicates
								that the NAS should select an address for the user (e.g., assign it
								from a pool of one or more IPX networks kept by the NAS).
							
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.7"></a><h3>4.4.10.7.&nbsp;
AppleTalk Network Access AVPs</h3>

<p>
							The AVPs defined in this section are used when the user requests, or
							is being granted, access to an AppleTalk network <a class='info' href='#AppleTalk'>[AppleTalk]<span> (</span><span class='info'>Sidhu, G., Andrews, R., and A. Oppenheimer, &ldquo;Inside AppleTalk,&rdquo; 1990.</span><span>)</span></a>.
						
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.7.1"></a><h3>4.4.10.7.1.&nbsp;
Framed-AppleTalk-Link AVP</h3>

<p>
								The Framed-AppleTalk-Link AVP (AVP Code 37) is of type Unsigned32 and
								contains the AppleTalk network number that should be used for the
								serial link to the user, which is another AppleTalk router.  This AVP
								MUST only be present in an authorization response and is never used
								when the user is not another router.
								<br />
<br />

								Despite the size of the field, values range from 0 to 65,535.
								The special value of 0 indicates an unnumbered serial link.  
								A value of 1 to 65,535 means that the serial line between the NAS and the user
								should be assigned that value as an AppleTalk network number.					
							
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.7.2"></a><h3>4.4.10.7.2.&nbsp;
Framed-AppleTalk-Network AVP</h3>

<p>
								The Framed-AppleTalk-Network AVP (AVP Code 38) is of type Unsigned32
								and contains the AppleTalk Network number that the NAS should probe
								to allocate an AppleTalk node for the user.  This AVP MUST only be
								present in an authorization response and is never used when the user
								is not another router.  Multiple instances of this AVP indicate that
								the NAS may probe, using any of the network numbers specified.
								<br />
<br />

								Despite the size of the field, values range from 0 to 65,535.  The
								special value 0 indicates that the NAS should assign a network for
								the user, using its default cable range.  A value between 1 and
								65,535 (inclusive) indicates to the AppleTalk Network that the NAS
								should probe to find an address for the user.					
							
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.7.3"></a><h3>4.4.10.7.3.&nbsp;
Framed-AppleTalk-Zone AVP</h3>

<p>
								The Framed-AppleTalk-Zone AVP (AVP Code 39) is of type OctetString
								and contains the AppleTalk Default Zone to be used for this user.
								This AVP MUST only be present in an authorization response.  Multiple
								instances of this AVP in the same message are not allowed.
								<br />
<br />

								The codification of this field's allowed range is outside the scope of this specification.
							
</p>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.8"></a><h3>4.4.10.8.&nbsp;
AppleTalk Remote Access AVPs</h3>

<p>
							The AVPs defined in this section are used when the user requests, or
							is being granted, access to the AppleTalk network via the AppleTalk
							Remote Access Protocol <a class='info' href='#ARAP'>[ARAP]<span> (</span><span class='info'>Apple Computer, &ldquo;Apple Remote Access Protocol (ARAP) Version 2.0 External Reference Specification,&rdquo; September&nbsp;1994.</span><span>)</span></a>  
							They are only present if the Framed-Protocol AVP <a class='info' href='#F-P-AVP'>Section&nbsp;4.4.10.1<span> (</span><span class='info'>Framed-Protocol AVP</span><span>)</span></a>
							is set to ARAP.  Section 2.2 of RFC 2869 <a class='info' href='#RFC2869'>[RFC2869]<span> (</span><span class='info'>Rigney, C., Willats, W., and P. Calhoun, &ldquo;RADIUS Extensions,&rdquo; June&nbsp;2000.</span><span>)</span></a>
							describes the operational use of these attributes.
						
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.8.1"></a><h3>4.4.10.8.1.&nbsp;
ARAP-Features AVP</h3>

<p>
							The ARAP-Features AVP (AVP Code 71) is of type OctetString and MAY be
							present in the AA-Accept message if the Framed-Protocol AVP is set to
							the value of ARAP.  See <a class='info' href='#RFC2869'>[RFC2869]<span> (</span><span class='info'>Rigney, C., Willats, W., and P. Calhoun, &ldquo;RADIUS Extensions,&rdquo; June&nbsp;2000.</span><span>)</span></a>
							for more information about the
							format of this AVP.						
							
</p>
<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.10.8.2"></a><h3>4.4.10.8.2.&nbsp;
ARAP-Zone-Access AVP</h3>

<p>
								The ARAP-Zone-Access AVP (AVP Code 72) is of type Enumerated and MAY
								be present in the AA-Accept message if the Framed-Protocol AVP is set
								to the value of ARAP.
								<br />
<br />

								The supported values are listed in <a class='info' href='#RADIUSTypes'>[RADIUSTypes]<span> (</span><span class='info'>IANA, &ldquo;RADIUS Types,&rdquo; .</span><span>)</span></a> 
								and defined in <a class='info' href='#RFC2869'>[RFC2869]<span> (</span><span class='info'>Rigney, C., Willats, W., and P. Calhoun, &ldquo;RADIUS Extensions,&rdquo; June&nbsp;2000.</span><span>)</span></a>.			
							
</p>
<a name="anchor50"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.11"></a><h3>4.4.11.&nbsp;
Non-Framed Access Authorization AVPs</h3>

<p>
						This section contains the authorization AVPs that are needed to
						support terminal server functionality.  AVPs defined in this section
						MAY be present in a message if the Service-Type AVP was set to
						 "Login" or "Callback Login".
					
</p>
<a name="anchor51"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.11.1"></a><h3>4.4.11.1.&nbsp;
Login-IP-Host AVP</h3>

<p>
							The Login-IP-Host AVP (AVP Code 14) <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>
							is of type OctetString
							and contains the IPv4 address of a host with which to connect the
							user when the Login-Service AVP is included.  It MAY be used in an
							AA-Request command as a hint to the Diameter Server that a specific
							host is desired, but the Diameter Server is not required to honor the
							hint in the AA-Answer.
							<br />
<br />

							Two addresses have special significance: all ones and 0.  The value
							of all ones indicates that the NAS SHOULD allow the user to select an
							address.  The value 0 indicates that the NAS SHOULD select a host to
							connect the user to.					
						
</p>
<a name="anchor52"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.11.2"></a><h3>4.4.11.2.&nbsp;
Login-IPv6-Host AVP</h3>

<p>
							The Login-IPv6-Host AVP (AVP Code 98) <a class='info' href='#RFC3162'>[RFC3162]<span> (</span><span class='info'>Aboba, B., Zorn, G., and D. Mitton, &ldquo;RADIUS and IPv6,&rdquo; August&nbsp;2001.</span><span>)</span></a>
							is of type
							OctetString and contains the IPv6 address of a host with which to
							connect the user when the Login-Service AVP is included.  It MAY be
							used in an AA-Request command as a hint to the Diameter Server that a
							specific host is desired, but the Diameter Server is not required to
							honor the hint in the AA-Answer.
							<br />
<br />

							Two addresses have special significance,
							 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF and 0.  The value
							 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF indicates that the NAS SHOULD
							 allow the user to select an address.  The value 0 indicates that the
							 NAS SHOULD select a host to connect the user to.					
						
</p>
<a name="anchor53"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.11.3"></a><h3>4.4.11.3.&nbsp;
Login-Service AVP</h3>

<p>
							The Login-Service AVP (AVP Code 15) is of type Enumerated and
							contains the service that should be used to connect the user to the
							login host.  This AVP SHOULD only be present in authorization responses.
							The supported values are listed in <a class='info' href='#RFC2869'>[RFC2869]<span> (</span><span class='info'>Rigney, C., Willats, W., and P. Calhoun, &ldquo;RADIUS Extensions,&rdquo; June&nbsp;2000.</span><span>)</span></a>.
						
</p>
<a name="TCP-S"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.11.4"></a><h3>4.4.11.4.&nbsp;
TCP Services</h3>

<p>
							   The AVP described in the following section MAY be present if the 
							   Login-Service AVP is set to Telnet, Rlogin, TCP Clear, or TCP Clear Quiet.
						
</p>
<a name="anchor54"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.11.4.1"></a><h3>4.4.11.4.1.&nbsp;
Login-TCP-Port AVP</h3>

<p>
								The Login-TCP-Port AVP (AVP Code 16) is of type Unsigned32 and
								contains the TCP port with which the user is to be connected when the
								Login-Service AVP is also present.  This AVP SHOULD only be present
								in authorization responses.  The value MUST NOT be greater than 65,535.						
							
</p>
<a name="LAT-S"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.11.5"></a><h3>4.4.11.5.&nbsp;
LAT Services</h3>

<p>
							   The AVPs described in this section MAY be present if the Login-Service AVP
							    is set to LAT <a class='info' href='#LAT'>[LAT]<span> (</span><span class='info'>Digital Equipment Corp., &ldquo;Local Area Transport (LAT) Specification V5.0,&rdquo; June&nbsp;1989.</span><span>)</span></a>.
						
</p>
<a name="anchor55"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.11.5.1"></a><h3>4.4.11.5.1.&nbsp;
Login-LAT-Service AVP</h3>

<p>
								The Login-LAT-Service AVP (AVP Code 34) is of type OctetString and
								contains the system with which the user is to be connected by LAT.
								It MAY be used in an authorization request as a hint to the server
								that a specific service is desired, but the server is not required to
								honor the hint in the corresponding response.  This AVP MUST only be
								present in the response if the Login-Service AVP states that LAT is desired.
								<br />
<br />

								Administrators use this service attribute when dealing with clustered
								systems, such as a VAX or Alpha cluster.  In these environments,
								several different time-sharing hosts share the same resources (disks,
								printers, etc.), and administrators often configure each host to
								offer access (service) to each of the shared resources.  In this
								case, each host in the cluster advertises its services through LAT broadcasts.
								<br />
<br />

								Sophisticated users often know which service providers (machines) are
								faster and tend to use a node name when initiating a LAT connection.
								Some administrators want particular users to use certain machines as
								a primitive form of load balancing (although LAT knows how to do load balancing itself).
								<br />
<br />

								The String field contains the identity of the LAT service to use.
								The LAT Architecture allows this string to contain $ (dollar), 
								- (hyphen), . (period), _ (underscore), numerics, upper- and lowercase
								alphabetics, and the ISO Latin-1 character set 
								extension <a class='info' href='#ISO.8859-1.1987'>[ISO.8859&#8209;1.1987]<span> (</span><span class='info'>International Organization for Standardization, &ldquo;Information technology - 8-bit single byte coded graphic - character sets - Part 1: Latin alphabet No. 1, JTC1/SC2,&rdquo; 1987.</span><span>)</span></a>.
								All LAT string comparisons are case insensitive.							
							
</p>
<a name="anchor56"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.11.5.2"></a><h3>4.4.11.5.2.&nbsp;
Login-LAT-Node AVP</h3>

<p>
								The Login-LAT-Node AVP (AVP Code 35) is of type OctetString and
								contains the Node with which the user is to be automatically
								connected by LAT.  It MAY be used in an authorization request as a
								hint to the server that a specific LAT node is desired, but the
								server is not required to honor the hint in the corresponding
								response.  This AVP MUST only be present in a response if the Login-Service-Type 
								AVP is set to LAT.
								<br />
<br />

								The String field contains the identity of the LAT service to use.
								The LAT Architecture allows this string to contain $ (dollar), 
								- (hyphen), . (period), _ (underscore), numerics, upper- and lowercase
								alphabetics, and the ISO Latin-1 character set 
								extension <a class='info' href='#ISO.8859-1.1987'>[ISO.8859&#8209;1.1987]<span> (</span><span class='info'>International Organization for Standardization, &ldquo;Information technology - 8-bit single byte coded graphic - character sets - Part 1: Latin alphabet No. 1, JTC1/SC2,&rdquo; 1987.</span><span>)</span></a>.
								All LAT string comparisons are case insensitive.					
							
</p>
<a name="anchor57"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.11.5.3"></a><h3>4.4.11.5.3.&nbsp;
Login-LAT-Group AVP</h3>

<p>
								The Login-LAT-Group AVP (AVP Code 36) is of type OctetString and
								contains a string identifying the LAT group codes this user is
								authorized to use.  It MAY be used in an authorization request as a
								hint to the server that a specific group is desired, but the server
								is not required to honor the hint in the corresponding response.
								This AVP MUST only be present in a response if the Login-Service-Type
								AVP is set to LAT.
								<br />
<br />

								LAT supports 256 different group codes, which LAT uses as a form of
								access rights.  LAT encodes the group codes as a 256-bit bitmap.
								<br />
<br />

								Administrators can assign one or more of the group code bits at the
								LAT service provider; it will only accept LAT connections that have
								these group codes set in the bitmap.  The administrators assign a
								bitmap of authorized group codes to each user.  LAT gets these from
								the operating system and uses them in its requests to the service providers.
								<br />
<br />

								The codification of the range of allowed usage of this field is
								outside the scope of this specification.							
							
</p>
<a name="anchor58"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.11.5.4"></a><h3>4.4.11.5.4.&nbsp;
Login-LAT-Port AVP</h3>

<p>
								The Login-LAT-Port AVP (AVP Code 63) is of type OctetString and
								contains the Port with which the user is to be connected by LAT.  It
								MAY be used in an authorization request as a hint to the server that
								a specific port is desired, but the server is not required to honor
								the hint in the corresponding response.  This AVP MUST only be
								present in a response if the Login-Service-Type AVP is set to LAT.
								<br />
<br />

								The String field contains the identity of the LAT service to use.
								The LAT Architecture allows this string to contain $ (dollar), 
								- (hyphen), . (period), _ (underscore), numerics, upper- and lower-case
								alphabetics, and the ISO Latin-1 character set 
								extension <a class='info' href='#ISO.8859-1.1987'>[ISO.8859&#8209;1.1987]<span> (</span><span class='info'>International Organization for Standardization, &ldquo;Information technology - 8-bit single byte coded graphic - character sets - Part 1: Latin alphabet No. 1, JTC1/SC2,&rdquo; 1987.</span><span>)</span></a>.
								<br />
<br />

								All LAT string comparisons are case insensitive.						
							
</p>
<a name="TUNNELING-AVPS"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
NAS Tunneling AVPs</h3>

<p>
					Some NASes support compulsory tunnel services in which the incoming
					connection data is conveyed by an encapsulation method to a gateway
					elsewhere in the network.  This is typically transparent to the
					service user, and the tunnel characteristics may be described by the
					remote AAA server, based on the user's authorization information.
					Several tunnel characteristics may be returned, and the NAS
					implementation may choose one.
					See <a class='info' href='#RFC2868'>[RFC2868]<span> (</span><span class='info'>Zorn, G., Leifer, D., Rubens, A., Shriver, J., Holdrege, M., and I. Goyret, &ldquo;RADIUS Attributes for Tunnel Protocol Support,&rdquo; June&nbsp;2000.</span><span>)</span></a> and <a class='info' href='#RFC2867'>[RFC2867]<span> (</span><span class='info'>Zorn, G., Aboba, B., and D. Mitton, &ldquo;RADIUS Accounting Modifications for Tunnel Protocol Support,&rdquo; June&nbsp;2000.</span><span>)</span></a> for further information. 
					<br />
<br />

					The following table gives the possible flag values for the session level AVPs
					and specifies whether the AVP MAY be encrypted.
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                         +---------------------+
                                         |    AVP Flag rules   |
                                         |----+-----+----+-----|----+
                                         |    |     |SHLD| MUST|    |
Attribute Name          Section Defined  |MUST| MAY | NOT|  NOT|Encr|
-----------------------------------------|----+-----+----+-----|----|
Tunneling                   4.5.1        | M  |  P  |    |  V  | N  |
Tunnel-Type                 4.5.2        | M  |  P  |    |  V  | Y  |
Tunnel-Medium-Type          4.5.3        | M  |  P  |    |  V  | Y  |
Tunnel-Client-Endpoint      4.5.4        | M  |  P  |    |  V  | Y  |
Tunnel-Server-Endpoint      4.5.5        | M  |  P  |    |  V  | Y  |
Tunnel-Password             4.5.6        | M  |  P  |    |  V  | Y  |
Tunnel-Private-Group-Id     4.5.7        | M  |  P  |    |  V  | Y  |
Tunnel-Assignment-Id        4.5.8        | M  |  P  |    |  V  | Y  |
Tunnel-Preference           4.5.9        | M  |  P  |    |  V  | Y  |
Tunnel-Client-Auth-Id       4.5.10       | M  |  P  |    |  V  | Y  |
Tunnel-Server-Auth-Id       4.5.11       | M  |  P  |    |  V  | Y  |
-----------------------------------------|----+-----+----+-----|----|
</pre></div><p>

				
</p>
<a name="anchor59"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1"></a><h3>4.5.1.&nbsp;
Tunneling AVP</h3>

<p>
						The Tunneling AVP (AVP Code 401) is of type Grouped and contains the
						following AVPs, used to describe a compulsory tunnel service
						(<a class='info' href='#RFC2868'>[RFC2868]<span> (</span><span class='info'>Zorn, G., Leifer, D., Rubens, A., Shriver, J., Holdrege, M., and I. Goyret, &ldquo;RADIUS Attributes for Tunnel Protocol Support,&rdquo; June&nbsp;2000.</span><span>)</span></a>, <a class='info' href='#RFC2867'>[RFC2867]<span> (</span><span class='info'>Zorn, G., Aboba, B., and D. Mitton, &ldquo;RADIUS Accounting Modifications for Tunnel Protocol Support,&rdquo; June&nbsp;2000.</span><span>)</span></a>).
						Its data field has the following ABNF grammar:
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Tunneling     ::= &lt; AVP Header: 401 &gt;
                  { Tunnel-Type }
                  { Tunnel-Medium-Type }
                  { Tunnel-Client-Endpoint }
                  { Tunnel-Server-Endpoint }
                  [ Tunnel-Preference ]
                  [ Tunnel-Client-Auth-Id ]
                  [ Tunnel-Server-Auth-Id ]
                  [ Tunnel-Assignment-Id ]
                  [ Tunnel-Password ]
                  [ Tunnel-Private-Group-Id ]
</pre></div><p>
					
					
</p>
<a name="T-T-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.2"></a><h3>4.5.2.&nbsp;
Tunnel-Type AVP</h3>

<p>
						The Tunnel-Type AVP (AVP Code 64) is of type Enumerated and contains
						the tunneling protocol(s) to be used (in the case of a tunnel
						initiator) or in use (in the case of a tunnel terminator).  It MAY be
						used in an authorization request as a hint to the server that a
						specific tunnel type is desired, but the server is not required to
						honor the hint in the corresponding response.
						<br />
<br />

						The Tunnel-Type AVP SHOULD also be included in ACR messages.
						<br />
<br />

						A tunnel initiator is not required to implement any of these tunnel
						types.  If a tunnel initiator receives a response that contains only
						unknown or unsupported Tunnel-Types, the tunnel initiator MUST behave
						as though a response were received with the Result-Code indicating a failure.
						<br />
<br />

						The supported values are listed in <a class='info' href='#RADIUSTypes'>[RADIUSTypes]<span> (</span><span class='info'>IANA, &ldquo;RADIUS Types,&rdquo; .</span><span>)</span></a>.	
					
</p>
<a name="T-M-T-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.3"></a><h3>4.5.3.&nbsp;
Tunnel-Medium-Type AVP</h3>

<p>
						The Tunnel-Medium-Type AVP (AVP Code 65) is of type Enumerated and
						contains the transport medium to use when creating a tunnel for
						protocols (<a class='info' href='#RFC2661'>such as L2TP<span> (</span><span class='info'>Townsley, W., Valencia, A., Rubens, A., Pall, G., Zorn, G., and B. Palter, &ldquo;Layer Two Tunneling Protocol &quot;L2TP&quot;,&rdquo; August&nbsp;1999.</span><span>)</span></a> [RFC2661])
						that can operate over multiple transports.
						It MAY be used in an authorization request as a hint to the server
						that a specific medium is desired, but the server is not required to
						honor the hint in the corresponding response.
						<br />
<br />

						The supported values are listed in <a class='info' href='#RADIUSTypes'>[RADIUSTypes]<span> (</span><span class='info'>IANA, &ldquo;RADIUS Types,&rdquo; .</span><span>)</span></a>.  				
					
</p>
<a name="T-C-E-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.4"></a><h3>4.5.4.&nbsp;
Tunnel-Client-Endpoint AVP</h3>

<p>
						The Tunnel-Client-Endpoint AVP (AVP Code 66) is of type UTF8String
						and contains the address of the initiator end of the tunnel.  It MAY
						be used in an authorization request as a hint to the server that a
						specific endpoint is desired, but the server is not required to honor
						the hint in the corresponding response.
						This AVP SHOULD be included in the corresponding ACR
						messages, in which case it indicates the address from which the
						tunnel was initiated.  This AVP, along with the 
						Tunnel-Server-Endpoint (<a class='info' href='#T-S-E-AVP'>Section&nbsp;4.5.5<span> (</span><span class='info'>Tunnel-Server-Endpoint AVP</span><span>)</span></a>)
						and Session-Id AVPs
						(<a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>, Section 8.8), can be used to provide a globally
						unique means to identify a tunnel for accounting and auditingpurposes.
						<br />
<br />

						If the value of the Tunnel-Medium-Type AVP (<a class='info' href='#T-M-T-AVP'>Section&nbsp;4.5.3<span> (</span><span class='info'>Tunnel-Medium-Type AVP</span><span>)</span></a>)
						is IPv4 (1), then this string is either the
						fully qualified domain name (FQDN) of the tunnel client machine, or a
						"dotted-decimal" IP address.  Implementations MUST support the
						dotted-decimal format and SHOULD support the FQDN format for IP addresses.
						<br />
<br />

						If Tunnel-Medium-Type is IPv6 (2), then this string is either the
						FQDN of the tunnel client machine, or a text representation of the
						address in either the preferred or alternate form <a class='info' href='#RFC3516'>[RFC3516]<span> (</span><span class='info'>Nerenberg, L., &ldquo;IMAP4 Binary Content Extension,&rdquo; April&nbsp;2003.</span><span>)</span></a>.
						Conforming implementations MUST support the preferred form and SHOULD
						support both the alternate text form and the FQDN format for IPv6 addresses.
						<br />
<br />

						If Tunnel-Medium-Type is neither IPv4 nor IPv6, then this string is a
						tag referring to configuration data local to the Diameter client that
						describes the interface or medium-specific client address to use.
					
</p>
<a name="T-S-E-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.5"></a><h3>4.5.5.&nbsp;
Tunnel-Server-Endpoint AVP</h3>

<p>
						The Tunnel-Server-Endpoint AVP (AVP Code 67) is of type UTF8String
						and contains the address of the server end of the tunnel.  It MAY be
						used in an authorization request as a hint to the server that a
						specific endpoint is desired, but the server is not required to honor
						the hint in the corresponding response.
						<br />
<br />

						This AVP SHOULD be included in the corresponding ACR
						messages, in which case it indicates the address from which the
						tunnel was initiated.  This AVP, along with the 
						Tunnel-Client-Endpoint (<a class='info' href='#T-C-E-AVP'>Section&nbsp;4.5.4<span> (</span><span class='info'>Tunnel-Client-Endpoint AVP</span><span>)</span></a>)
						and Session-Id AVP (<a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>, Section 8.8),
						can be used to provide a globally unique means to identify a tunnel for accounting 
						and auditing purposes.
						<br />
<br />

						If Tunnel-Medium-Type is IPv4 (1), then this string is either the
						fully qualified domain name (FQDN) of the tunnel server machine, or a
						"dotted-decimal" IP address.  Implementations MUST support the
						dotted-decimal format and SHOULD support the FQDN format for IP addresses.
						<br />
<br />

						If Tunnel-Medium-Type is IPv6 (2), then this string is either the
						FQDN of the tunnel server machine, or a text representation of the
						address in either the preferred or alternate form <a class='info' href='#RFC3516'>[RFC3516]<span> (</span><span class='info'>Nerenberg, L., &ldquo;IMAP4 Binary Content Extension,&rdquo; April&nbsp;2003.</span><span>)</span></a>.
						Implementations MUST support the preferred form and SHOULD support
						both the alternate text form and the FQDN format for IPv6 addresses.
						<br />
<br />

						If Tunnel-Medium-Type is not IPv4 or IPv6, this string is a tag
						referring to configuration data local to the Diameter client that
						describes the interface or medium-specific server address to use.					
					
</p>
<a name="anchor60"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.6"></a><h3>4.5.6.&nbsp;
Tunnel-Password AVP</h3>

<p>
						The Tunnel-Password AVP (AVP Code 69) is of type OctetString and may
						contain a password to be used to authenticate to a remote server.
						<br />
<br />

						The Tunnel-Password AVP contains sensitive information.  This value
						is not protected in the same manner as RADIUS <a class='info' href='#RFC2868'>[RFC2868]<span> (</span><span class='info'>Zorn, G., Leifer, D., Rubens, A., Shriver, J., Holdrege, M., and I. Goyret, &ldquo;RADIUS Attributes for Tunnel Protocol Support,&rdquo; June&nbsp;2000.</span><span>)</span></a>.
						Diameter messages are secured by 
						using IPsec or TLS <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>. 
						The Tunnel-Password AVP SHOULD NOT be used in untrusted
						proxy environments without encrypting it by using end-to-end security techniques.
					
</p>
<a name="anchor61"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.7"></a><h3>4.5.7.&nbsp;
Tunnel-Private-Group-Id AVP</h3>

<p>
						The Tunnel-Private-Group-Id AVP (AVP Code 81) is of type OctetString
						and contains the group Id for a particular tunneled session.  The
						Tunnel-Private-Group-Id AVP MAY be included in an authorization
						request if the tunnel initiator can predetermine the group resulting
						from a particular connection.  It SHOULD be included in the
						authorization response if this tunnel session is to be treated as
						belonging to a particular private group.  Private groups may be used
						to associate a tunneled session with a particular group of users.
						For example, it MAY be used to facilitate routing of unregistered IP
						addresses through a particular interface.  This AVP SHOULD be
						included in the ACR messages that pertain to the
						tunneled session.
					
</p>
<a name="anchor62"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.8"></a><h3>4.5.8.&nbsp;
Tunnel-Assignment-Id AVP</h3>

<p>
						The Tunnel-Assignment-Id AVP (AVP Code 82) is of type OctetString and
						is used to indicate to the tunnel initiator the particular tunnel to
						which a session is to be assigned.  
						Some tunneling protocols, such as PPTP <a class='info' href='#RFC2637'>[RFC2637]<span> (</span><span class='info'>Hamzeh, K., Pall, G., Verthein, W., Taarud, J., Little, W., and G. Zorn, &ldquo;Point-to-Point Tunneling Protocol,&rdquo; July&nbsp;1999.</span><span>)</span></a>
						and L2TP <a class='info' href='#RFC2661'>[RFC2661]<span> (</span><span class='info'>Townsley, W., Valencia, A., Rubens, A., Pall, G., Zorn, G., and B. Palter, &ldquo;Layer Two Tunneling Protocol &quot;L2TP&quot;,&rdquo; August&nbsp;1999.</span><span>)</span></a>, 
						allow for sessions between the same two tunnel
						endpoints to be multiplexed over the same tunnel and also for a given
						session to use its own dedicated tunnel.  This attribute provides a
						mechanism for Diameter to inform the tunnel initiator (e.g., PAC,
						LAC) whether to assign the session to a multiplexed tunnel or to a
						separate tunnel.  Furthermore, it allows for sessions sharing
						multiplexed tunnels to be assigned to different multiplexed tunnels.
						<br />
<br />

						A particular tunneling implementation may assign differing
						characteristics to particular tunnels.  For example, different
						tunnels may be assigned different QoS parameters.  Such tunnels may
						be used to carry either individual or multiple sessions.  The
						Tunnel-Assignment-Id attribute thus allows the Diameter server to
						indicate that a particular session is to be assigned to a tunnel
						providing an appropriate level of service.  It is expected that any
						QoS-related Diameter tunneling attributes defined in the future
						accompanying this one will be associated by the tunnel initiator with
						the Id given by this attribute.  In the meantime, any semantic given
						to a particular Id string is a matter left to local configuration in the tunnel initiator.
						<br />
<br />

						The Tunnel-Assignment-Id AVP is of significance only to Diameter and
						the tunnel initiator.  The Id it specifies is only intended to be of
						local use to Diameter and the tunnel initiator.  The Id assigned by
						the tunnel initiator is not conveyed to the tunnel peer.
						<br />
<br />

						This attribute MAY be included in authorization responses.  The
						tunnel initiator receiving this attribute MAY choose to ignore it and
						to assign the session to an arbitrary multiplexed or non-multiplexed
						tunnel between the desired endpoints.  This AVP SHOULD also be
						included in the Accounting-Request messages pertaining to the
						tunneled session.
						<br />
<br />

						If a tunnel initiator supports the Tunnel-Assignment-Id AVP, then it
						should assign a session to a tunnel in the following manner:
						</p>
<ul class="text">
<li>
								If this AVP is present and a tunnel exists between the
								specified endpoints with the specified Id, then the session
								should be assigned to that tunnel.								
							
</li>
<li>
								If this AVP is present and no tunnel exists between the
								specified endpoints with the specified Id, then a new tunnel
								should be established for the session and the specified Id
								should be associated with the new tunnel.
							
</li>
<li>
								If this AVP is not present, then the session is assigned to an
								unnamed tunnel.  If an unnamed tunnel does not yet exist
								between the specified endpoints, then it is established and
								used for this session and for subsequent ones established
								without the Tunnel-Assignment-Id attribute.  A tunnel initiator
								MUST NOT assign a session for which a Tunnel-Assignment-Id AVP
								was not specified to a named tunnel (i.e., one that was
								initiated by a session specifying this AVP).
							
</li>
</ul><p>
						Note that the same Id may be used to name different tunnels if these
						tunnels are between different endpoints.
					
</p>
<a name="anchor63"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.9"></a><h3>4.5.9.&nbsp;
Tunnel-Preference AVP</h3>

<p>
						The Tunnel-Preference AVP (AVP Code 83) is of type Unsigned32 and is
						used to identify the relative preference assigned to each tunnel when
						more than one set of tunneling AVPs is returned within separate
						Grouped-AVP AVPs.  It MAY be used in an authorization request as a
						hint to the server that a specific preference is desired, but the
						server is not required to honor the hint in the corresponding response.
						<br />
<br />

						For example, suppose that AVPs describing two tunnels are returned by
						the server, one with a Tunnel-Type of PPTP and the other with a
						Tunnel-Type of L2TP.  If the tunnel initiator supports only one of
						the Tunnel-Types returned, it will initiate a tunnel of that type.
						If, however, it supports both tunnel protocols, it SHOULD use the
						value of the Tunnel-Preference AVP to decide which tunnel should be
						started.  The tunnel with the lowest numerical value in the Value
						field of this AVP SHOULD be given the highest preference.  The values
						assigned to two or more instances of the Tunnel-Preference AVP within
						a given authorization response MAY be identical.  In this case, the
						tunnel initiator SHOULD use locally configured metrics to decidewhich set of AVPs to use.
					
</p>
<a name="anchor64"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.10"></a><h3>4.5.10.&nbsp;
Tunnel-Client-Auth-Id AVP</h3>

<p>
						The Tunnel-Client-Auth-Id AVP (AVP Code 90) is of type UTF8String and
						specifies the name used by the tunnel initiator during the
						authentication phase of tunnel establishment.  It MAY be used in an
						authorization request as a hint to the server that a specific
						preference is desired, but the server is not required to honor the
						hint in the corresponding response.  This AVP MUST be present in the
						authorization response if an authentication name other than the
						default is desired.  This AVP SHOULD be included in the ACR messages
						pertaining to the tunneled session.
					
</p>
<a name="anchor65"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.11"></a><h3>4.5.11.&nbsp;
Tunnel-Server-Auth-Id AVP</h3>

<p>
						The Tunnel-Server-Auth-Id AVP (AVP Code 91) is of type UTF8String and
						specifies the name used by the tunnel terminator during the
						authentication phase of tunnel establishment.  It MAY be used in an
						authorization request as a hint to the server that a specific
						preference is desired, but the server is not required to honor the
						hint in the corresponding response.  This AVP MUST be present in the
						authorization response if an authentication name other than the
						default is desired.  This AVP SHOULD be included in the ACR messages
						pertaining to the tunneled session.
					
</p>
<a name="ACCT-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
NAS Accounting AVPs</h3>

<p>
					Applications implementing this specification use Diameter Accounting
					(as defined in <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>)
					and the AVPs in the following section.
					Service-specific AVP usage is defined in the tables in <a class='info' href='#A-O-T'>Section&nbsp;5<span> (</span><span class='info'>AVP Occurrence Tables</span><span>)</span></a>.
					<br />
<br />

					If accounting is active, Accounting Request (ACR) messages SHOULD be
					sent after the completion of any Authentication or Authorization
					transaction and at the end of a Session.  The value of the Accounting-Record-Type
					AVP <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					indicates the type of event.  All other AVPs identify the
					session and provide additional information relevant to the event.
					<br />
<br />

					The successful completion of the first Authentication or
					Authorization transaction SHOULD cause a START_RECORD to be sent.  If
					additional Authentications or Authorizations occur in later
					transactions, the first exchange should generate a START_RECORD, and
					the later an INTERIM_RECORD.  For a given session, there MUST only be
					one set of matching START and STOP records, with any number of
					INTERIM_RECORDS in between, or one EVENT_RECORD indicating the reason
					a session wasn't started.
					<br />
<br />

					The following table gives the possible flag values for the session level AVPs
					and specifies whether the AVP MAY be encrypted.
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                         +---------------------+
                                         |    AVP Flag rules   |
                                         |----+-----+----+-----|----+
                                 Section |    |     |SHLD| MUST|    |
Attribute Name                   Defined |MUST| MAY | NOT|  NOT|Encr|
-----------------------------------------|----+-----+----+-----|----|
Accounting-Input-Octets           4.6.1  | M  |  P  |    |  V  | Y  |
Accounting-Output-Octets          4.6.2  | M  |  P  |    |  V  | Y  |
Accounting-Input-Packets          4.6.3  | M  |  P  |    |  V  | Y  |
Accounting-Output-Packets         4.6.4  | M  |  P  |    |  V  | Y  |
Acct-Session-Time                 4.6.5  | M  |  P  |    |  V  | Y  |
Acct-Authentic                    4.6.6  | M  |  P  |    |  V  | Y  |
Accounting-Auth-Method            4.6.7  | M  |  P  |    |  V  | Y  |
Acct-Delay-Time                   4.6.8  | M  |  P  |    |  V  | Y  |
Acct-Link-Count                   4.6.9  | M  |  P  |    |  V  | Y  |
Acct-Tunnel-Connection            4.6.10 | M  |  P  |    |  V  | Y  |
Acct-Tunnel-Packets-Lost          4.6.11 | M  |  P  |    |  V  | Y  |
-----------------------------------------|----+-----+----+-----|----|
</pre></div><p>

				
</p>
<a name="anchor66"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.1"></a><h3>4.6.1.&nbsp;
Accounting-Input-Octets AVP</h3>

<p>
						The Accounting-Input-Octets AVP (AVP Code 363) is of type Unsigned64
						and contains the number of octets received from the user.
						<br />
<br />

						For NAS usage, this AVP indicates how many octets have been received
						from the port in the course of this session.  It can only be present
						in ACR messages with an Accounting-Record-Type <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
						of INTERIM_RECORD or STOP_RECORD.			
					
</p>
<a name="anchor67"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.2"></a><h3>4.6.2.&nbsp;
Accounting-Output-Octets AVP</h3>

<p>
						The Accounting-Output-Octets AVP (AVP Code 364) is of type Unsigned64
						and contains the number of octets sent to the user.
						<br />
<br />

						For NAS usage, this AVP indicates how many octets have been sent to
						the port in the course of this session.  It can only be present in
						ACR messages with an Accounting-Record-Type of INTERIM_RECORD or
						STOP_RECORD.					
					
</p>
<a name="anchor68"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.3"></a><h3>4.6.3.&nbsp;
Accounting-Input-Packets AVP</h3>

<p>
						The Accounting-Input-Packets (AVP Code 365) is of type Unsigned64 and
						contains the number of packets received from the user.
						<br />
<br />

						For NAS usage, this AVP indicates how many packets have been received
						from the port over the course of a session being provided to a Framed
						User.  It can only be present in ACR messages with an Accounting-Record-Type 
						of INTERIM_RECORD or STOP_RECORD.
					
</p>
<a name="anchor69"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.4"></a><h3>4.6.4.&nbsp;
Accounting-Output-Packets AVP</h3>

<p>
						The Accounting-Output-Packets (AVP Code 366) is of type Unsigned64
						and contains the number of IP packets sent to the user.
						<br />
<br />

						For NAS usage, this AVP indicates how many packets have been sent to
						the port over the course of a session being provided to a Framed
						User.  It can only be present in ACR messages with an Accounting-Record-Type
						of INTERIM_RECORD or STOP_RECORD.					
					
</p>
<a name="anchor70"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.5"></a><h3>4.6.5.&nbsp;
Acct-Session-Time AVP</h3>

<p>
						The Acct-Session-Time AVP (AVP Code 46) is of type Unsigned32 and
						indicates the length of the current session in seconds.  It can only
						be present in ACR messages with an Accounting-Record-Type of
						INTERIM_RECORD or STOP_RECORD.
					
</p>
<a name="anchor71"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.6"></a><h3>4.6.6.&nbsp;
Acct-Authentic AVP</h3>

<p>
						The Acct-Authentic AVP (AVP Code 45) is of type Enumerated and
						 specifies how the user was authenticated.  The supported values are
						 listed in <a class='info' href='#RADIUSTypes'>[RADIUSTypes]<span> (</span><span class='info'>IANA, &ldquo;RADIUS Types,&rdquo; .</span><span>)</span></a>.
					
</p>
<a name="A-A-M-AVP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.7"></a><h3>4.6.7.&nbsp;
Accounting-Auth-Method AVP</h3>

<p>
						The Accounting-Auth-Method AVP (AVP Code 406) is of type Enumerated.
						A NAS MAY include this AVP in an Accounting-Request message to
						indicate the method used to authenticate the user.  (Note that this AVP
						is semantically equivalent, and the supported values are identical, to the 
						Microsoft MS-Acct-Auth-Type vendor-specific RADIUS attribute <a class='info' href='#RFC2548'>[RFC2548]<span> (</span><span class='info'>Zorn, G., &ldquo;Microsoft Vendor-specific RADIUS Attributes,&rdquo; March&nbsp;1999.</span><span>)</span></a>).
					
</p>
<a name="anchor72"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.8"></a><h3>4.6.8.&nbsp;
Acct-Delay-Time AVP</h3>

<p>
						The Acct-Delay-Time AVP (AVP Code 41) is of type Unsigned32 and
						indicates the number of seconds the Diameter client has been trying
						to send the Accounting-Request (ACR).  The accounting server may
						subtract this value from the time when the ACR arrives at the server
						to calculate the approximate time of the event that caused the ACR to
						be generated.
						<br />
<br />

						This AVP is not used for retransmissions at the transport level (TCP
						or SCTP).  Rather, it may be used when an ACR command cannot be
						transmitted because there is no appropriate peer to transmit it to or
						was rejected because it could not be delivered.  In these cases, the
						command MAY be buffered and transmitted later, when an appropriate
						peer-connection is available or after sufficient time has passed that
						the destination-host may be reachable and operational.  If the ACR is
						re-sent in this way, the Acct-Delay-Time AVP SHOULD be included.  The
						value of this AVP indicates the number of seconds that elapsed
						between the time of the first attempt at transmission and the current attempt.
					
</p>
<a name="anchor73"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.9"></a><h3>4.6.9.&nbsp;
Acct-Link-Count AVP</h3>

<p>
						The Acct-Link-Count AVP (AVP Code 51) is of type Unsigned32 and
						indicates the total number of links that have been active (current or
						closed) in a given multilink session at the time the accounting
						record is generated.  This AVP MAY be included in Accounting-Requests
						for any session that may be part of a multilink service.
						<br />
<br />

						The Acct-Link-Count AVP may be used to make it easier for an
						accounting server to know when it has all the records for a given
						multilink service.  When the number of Accounting-Requests received
						with Accounting-Record-Type = STOP_RECORD and with the same 
						Acct-Multi-Session-Id and unique Session-Ids equals the largest value of
						Acct-Link-Count seen in those Accounting-Requests, all STOP_RECORD
						Accounting-Requests for that multilink service have been received.
						<br />
<br />

						The following example, showing eight Accounting-Requests, illustrates
						how the Acct-Link-Count AVP is used.  In the table below, only the
						relevant AVPs are shown, although additional AVPs containing
						accounting information will be present in the
						Accounting-Requests.		
</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
Acct-Multi-                   Accounting-     Acct-
Session-Id     Session-Id     Record-Type     Link-Count
--------------------------------------------------------
  "...10"        "...10"      START_RECORD        1
  "...10"        "...11"      START_RECORD        2
  "...10"        "...11"      STOP_RECORD         2
  "...10"        "...12"      START_RECORD        3
  "...10"        "...13"      START_RECORD        4
  "...10"        "...12"      STOP_RECORD         4
  "...10"        "...13"      STOP_RECORD         4
  "...10"        "...10"      STOP_RECORD         4
</pre></div><p>
								
					
</p>
<a name="anchor74"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.10"></a><h3>4.6.10.&nbsp;
Acct-Tunnel-Connection AVP</h3>

<p>
						The Acct-Tunnel-Connection AVP (AVP Code 68) is of type OctetString
						and contains the identifier assigned to the tunnel session.  This
						AVP, along with the Tunnel-Client-Endpoint (<a class='info' href='#T-C-E-AVP'>Section&nbsp;4.5.4<span> (</span><span class='info'>Tunnel-Client-Endpoint AVP</span><span>)</span></a>)
						and Tunnel-Server-Endpoint (<a class='info' href='#T-S-E-AVP'>Section&nbsp;4.5.5<span> (</span><span class='info'>Tunnel-Server-Endpoint AVP</span><span>)</span></a>)
						AVPs, may be used to provide a means to uniquely identify a tunnel
						session for auditing purposes.
						<br />
<br />

						The format of the identifier in this AVP depends upon the value of
						the Tunnel-Type AVP (<a class='info' href='#T-T-AVP'>Section&nbsp;4.5.2<span> (</span><span class='info'>Tunnel-Type AVP</span><span>)</span></a>).  
						For example, to identify an L2TP tunnel
						connection fully, the L2TP Tunnel Id and Call Id might be encoded in
						this field.  The exact encoding of this field is implementation dependent.
					
</p>
<a name="anchor75"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.11"></a><h3>4.6.11.&nbsp;
Acct-Tunnel-Packets-Lost AVP</h3>

<p>
						The Acct-Tunnel-Packets-Lost AVP (AVP Code 86) is of type Unsigned32
						and contains the number of packets lost on a given tunnel.
					
</p>
<a name="A-O-T"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
AVP Occurrence Tables</h3>

<p>
				The following tables present the AVPs used by NAS applications in NAS
				messages and specify in which Diameter messages they MAY or MAY NOT
				be present.  Messages and AVPs defined in the base 
				Diameter protocol <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
				are not described in this document.  Note that AVPs that can only be present within a Grouped
				AVP are not represented in this table.
				<br />
<br />

				The table uses the following symbols:
				
				</p>
<blockquote class="text">
<p>
						</p>
<blockquote class="text"><dl>
<dt>0</dt>
<dd>The AVP MUST NOT be present in the message.
</dd>
<dt>0+</dt>
<dd>Zero or more instances of the AVP MAY be present in the message.
</dd>
<dt>0-1</dt>
<dd>Zero or one instance of the AVP MAY be present in the message.
</dd>
<dt>1</dt>
<dd>Exactly one instance of the AVP MUST be present in the message.
</dd>
</dl></blockquote>
					

</blockquote><p>
				
			
</p>
<a name="anchor76"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
AA-Request/Answer AVP Table</h3>

<p>
					The table in this section is limited to the Command Codes defined in this specification.
</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                              +-----------+
                              |  Command  |
                              |-----+-----+
AVP Name                      | AAR | AAA |
------------------------------|-----+-----+
Acct-Interim-Interval         | 0   | 0-1 |
ARAP-Challenge-Response       | 0   | 0-1 |
ARAP-Features                 | 0   | 0-1 |
ARAP-Password                 | 0-1 | 0   |
ARAP-Security                 | 0-1 | 0-1 |
ARAP-Security-Data            | 0+  | 0+  |
ARAP-Zone-Access              | 0   | 0-1 |
Auth-Application-Id           | 1   | 1   |
Auth-Grace-Period             | 0-1 | 0-1 |
Auth-Request-Type             | 1   | 1   |
Auth-Session-State            | 0-1 | 0-1 |
Authorization-Lifetime        | 0-1 | 0-1 |
------------------------------|-----+-----+
</pre></div><p>

					
</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                              +-----------+
                              |  Command  |
                              |-----+-----+
Attribute Name                | AAR | AAA |
------------------------------|-----+-----+
Callback-Id                   | 0   | 0-1 |
Callback-Number               | 0-1 | 0-1 |
Called-Station-Id             | 0-1 | 0   |
Calling-Station-Id            | 0-1 | 0   |
CHAP-Auth                     | 0-1 | 0   |
CHAP-Challenge                | 0-1 | 0   |
Class                         | 0   | 0+  |
Configuration-Token           | 0   | 0+  |
Connect-Info                  | 0+  | 0   |
Destination-Host              | 0-1 | 0   |
Destination-Realm             | 1   | 0   |
Error-Message                 | 0   | 0-1 |
Error-Reporting-Host          | 0   | 0-1 |
Failed-AVP                    | 0+  | 0+  |
Filter-Id                     | 0   | 0+  |
Framed-Appletalk-Link         | 0   | 0-1 |
Framed-Appletalk-Network      | 0   | 0+  |
Framed-Appletalk-Zone         | 0   | 0-1 |
Framed-Compression            | 0+  | 0+  |
Framed-Interface-Id           | 0-1 | 0-1 |
Framed-IP-Address             | 0-1 | 0-1 |
Framed-IP-Netmask             | 0-1 | 0-1 |
Framed-IPv6-Prefix            | 0+  | 0+  |
Framed-IPv6-Pool              | 0   | 0-1 |
Framed-IPv6-Route             | 0   | 0+  |
Framed-IPX-Network            | 0   | 0-1 |
Framed-MTU                    | 0-1 | 0-1 |
Framed-Pool                   | 0   | 0-1 |
Framed-Protocol               | 0-1 | 0-1 |
Framed-Route                  | 0   | 0+  |
Framed-Routing                | 0   | 0-1 |
Idle-Timeout                  | 0   | 0-1 |
Login-IP-Host                 | 0+  | 0+  |
Login-IPv6-Host               | 0+  | 0+  |
Login-LAT-Group               | 0-1 | 0-1 |
Login-LAT-Node                | 0-1 | 0-1 |
Login-LAT-Port                | 0-1 | 0-1 |
Login-LAT-Service             | 0-1 | 0-1 |
Login-Service                 | 0   | 0-1 |
Login-TCP-Port                | 0   | 0-1 |
Multi-Round-Time-Out          | 0   | 0-1 |
------------------------------|-----+-----+
</pre></div><p>


</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                              +-----------+
                              |  Command  |
                              |-----+-----+
Attribute Name                | AAR | AAA |
------------------------------|-----+-----+
NAS-Filter-Rule               | 0   | 0+  |
NAS-Identifier                | 0-1 | 0   |
NAS-IP-Address                | 0-1 | 0   |
NAS-IPv6-Address              | 0-1 | 0   |
NAS-Port                      | 0-1 | 0   |
NAS-Port-Id                   | 0-1 | 0   |
NAS-Port-Type                 | 0-1 | 0   |
Origin-AAA-Protocol           | 0-1 | 0-1 |
Origin-Host                   | 1   | 1   |
Origin-Realm                  | 1   | 1   |
Origin-State-Id               | 0-1 | 0-1 |
Originating-Line-Info         | 0-1 | 0   |
Password-Retry                | 0   | 0-1 |
Port-Limit                    | 0-1 | 0-1 |
Prompt                        | 0   | 0-1 |
Proxy-Info                    | 0+  | 0+  |
QoS-Filter-Rule               | 0   | 0+  |
Re-Auth-Request-Type          | 0   | 0-1 |
Redirect-Host                 | 0   | 0+  |
Redirect-Host-Usage           | 0   | 0-1 |
Redirect-Max-Cache-Time       | 0   | 0-1 |
Reply-Message                 | 0   | 0+  |
Result-Code                   | 0   | 1   |
Route-Record                  | 0+  | 0+  |
Service-Type                  | 0-1 | 0-1 |
Session-Id                    | 1   | 1   |
Session-Timeout               | 0   | 0-1 |
State                         | 0-1 | 0-1 |
Tunneling                     | 0+  | 0+  |
User-Name                     | 0-1 | 0-1 |
User-Password                 | 0-1 | 0   |
------------------------------|-----+-----+
</pre></div><p>

				
</p>
<a name="anchor77"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Accounting AVP Tables</h3>

<p>
					The tables in this section are used to show which AVPs defined in
					this document are to be present and used in NAS application
					Accounting messages.  These AVPs are defined in this document, as
					well as in <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>
					and <a class='info' href='#RFC2866'>[RFC2866]<span> (</span><span class='info'>Rigney, C., &ldquo;RADIUS Accounting,&rdquo; June&nbsp;2000.</span><span>)</span></a>.
				
</p>
<a name="anchor78"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Framed Access Accounting AVP Table</h3>

<p>
						The table in this section is used when the Service-Type AVP (<a class='info' href='#S-T-AVP'>Section&nbsp;4.4.1<span> (</span><span class='info'>Service-Type AVP</span><span>)</span></a>)
						specifies Framed Access.
						
</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                                          +-----------+
                                          |  Command  |
                                          |-----+-----+
   Attribute Name                         | ACR | ACA |
   ---------------------------------------|-----+-----+
   Accounting-Auth-Method                 | 0-1 | 0   |
   Accounting-Input-Octets                | 1   | 0   |
   Accounting-Input-Packets               | 1   | 0   |
   Accounting-Output-Octets               | 1   | 0   |
   Accounting-Output-Packets              | 1   | 0   |
   Accounting-Record-Number               | 0-1 | 0-1 |
   Accounting-Record-Type                 | 1   | 1   |
   Accounting-Realtime-Required           | 0-1 | 0-1 |
   Accounting-Sub-Session-Id              | 0-1 | 0-1 |
   Acct-Application-Id                    | 0-1 | 0-1 |
   Acct-Session-Id                        | 1   | 0-1 |
   Acct-Multi-Session-Id                  | 0-1 | 0-1 |
   Acct-Authentic                         | 1   | 0   |
   Acct-Delay-Time                        | 0-1 | 0   |
   Acct-Interim-Interval                  | 0-1 | 0-1 |
   Acct-Link-Count                        | 0-1 | 0   |
   Acct-Session-Time                      | 1   | 0   |
   Acct-Tunnel-Connection                 | 0-1 | 0   |
   Acct-Tunnel-Packets-Lost               | 0-1 | 0   |
   Authorization-Lifetime                 | 0-1 | 0   |
   Callback-Id                            | 0-1 | 0   |
   Callback-Number                        | 0-1 | 0   |
   Called-Station-Id                      | 0-1 | 0   |
   Calling-Station-Id                     | 0-1 | 0   |
   Class                                  | 0+  | 0+  |
   Connection-Info                        | 0+  | 0   |
   Destination-Host                       | 0-1 | 0   |
   Destination-Realm                      | 1   | 0   |
   Event-Timestamp                        | 0-1 | 0-1 |
   Error-Message                          | 0   | 0-1 |
   Error-Reporting-Host                   | 0   | 0-1 |
   Failed-AVP                             | 0   | 0+  |
   ---------------------------------------|-----+-----+
</pre></div><p>


</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                                       +-----------+
                                       |  Command  |
                                       |-----+-----+
Attribute Name                         | ACR | ACA |
---------------------------------------|-----+-----+
Framed-AppleTalk-Link                  | 0-1 | 0   |
Framed-AppleTalk-Network               | 0-1 | 0   |
Framed-AppleTalk-Zone                  | 0-1 | 0   |
Framed-Compression                     | 0-1 | 0   |
Framed-IP-Address                      | 0-1 | 0   |
Framed-IP-Netmask                      | 0-1 | 0   |
Framed-IPv6-Prefix                     | 0+  | 0   |
Framed-IPv6-Pool                       | 0-1 | 0   |
Framed-IPX-Network                     | 0-1 | 0   |
Framed-MTU                             | 0-1 | 0   |
Framed-Pool                            | 0-1 | 0   |
Framed-Protocol                        | 0-1 | 0   |
Framed-Route                           | 0-1 | 0   |
Framed-Routing                         | 0-1 | 0   |
NAS-Filter-Rule                        | 0+  | 0   |
NAS-Identifier                         | 0-1 | 0-1 |
NAS-IP-Address                         | 0-1 | 0-1 |
NAS-IPv6-Address                       | 0-1 | 0-1 |
NAS-Port                               | 0-1 | 0-1 |
NAS-Port-Id                            | 0-1 | 0-1 |
NAS-Port-Type                          | 0-1 | 0-1 |
Origin-AAA-Protocol                    | 0-1 | 0-1 |
Origin-Host                            | 1   | 1   |
Origin-Realm                           | 1   | 1   |
Origin-State-Id                        | 0-1 | 0-1 |
Originating-Line-Info                  | 0-1 | 0   |
Proxy-Info                             | 0+  | 0+  |
QoS-Filter-Rule                        | 0+  | 0   |
Route-Record                           | 0+  | 0+  |
Result-Code                            | 0   | 1   |
Service-Type                           | 0-1 | 0-1 |
Session-Id                             | 1   | 1   |
Termination-Cause                      | 0-1 | 0-1 |
Tunnel-Assignment-Id                   | 0-1 | 0   |
Tunnel-Client-Endpoint                 | 0-1 | 0   |
Tunnel-Medium-Type                     | 0-1 | 0   |
Tunnel-Private-Group-Id                | 0-1 | 0   |
Tunnel-Server-Endpoint                 | 0-1 | 0   |
Tunnel-Type                            | 0-1 | 0   |
User-Name                              | 0-1 | 0-1 |
Vendor-Specific-Application-Id         | 0-1 | 0-1 |
---------------------------------------|-----+-----+
</pre></div><p>

					
</p>
<a name="anchor79"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Non-Framed Access Accounting AVP Table</h3>

<p>
						The table in this section is used when the Service-Type AVP (<a class='info' href='#S-T-AVP'>Section&nbsp;4.4.1<span> (</span><span class='info'>Service-Type AVP</span><span>)</span></a>)
						specifies Non-Framed Access.
						
</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                                       +-----------+
                                       |  Command  |
                                       |-----+-----+
Attribute Name                         | ACR | ACA |
---------------------------------------|-----+-----+
Accounting-Auth-Method                 | 0-1 | 0   |
Accounting-Input-Octets                | 1   | 0   |
Accounting-Output-Octets               | 1   | 0   |
Accounting-Record-Type                 | 1   | 1   |
Accounting-Record-Number               | 0-1 | 0-1 |
Accounting-Realtime-Required           | 0-1 | 0-1 |
Accounting-Sub-Session-Id              | 0-1 | 0-1 |
Acct-Application-Id                    | 0-1 | 0-1 |
Acct-Session-Id                        | 1   | 0-1 |
Acct-Multi-Session-Id                  | 0-1 | 0-1 |
Acct-Authentic                         | 1   | 0   |
Acct-Delay-Time                        | 0-1 | 0   |
Acct-Interim-Interval                  | 0-1 | 0-1 |
Acct-Link-Count                        | 0-1 | 0   |
Acct-Session-Time                      | 1   | 0   |
Authorization-Lifetime                 | 0-1 | 0   |
Callback-Id                            | 0-1 | 0   |
Callback-Number                        | 0-1 | 0   |
Called-Station-Id                      | 0-1 | 0   |
Calling-Station-Id                     | 0-1 | 0   |
Class                                  | 0+  | 0+  |
Connection-Info                        | 0+  | 0   |
Destination-Host                       | 0-1 | 0   |
Destination-Realm                      | 1   | 0   |
Event-Timestamp                        | 0-1 | 0-1 |
Error-Message                          | 0   | 0-1 |
Error-Reporting-Host                   | 0   | 0-1 |
Failed-AVP                             | 0   | 0+  |
Login-IP-Host                          | 0+  | 0   |
Login-IPv6-Host                        | 0+  | 0   |
Login-LAT-Service                      | 0-1 | 0   |
Login-LAT-Node                         | 0-1 | 0   |
Login-LAT-Group                        | 0-1 | 0   |
Login-LAT-Port                         | 0-1 | 0   |
Login-Service                          | 0-1 | 0   |
Login-TCP-Port                         | 0-1 | 0   |
---------------------------------------|-----+-----+
</pre></div><p>

</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                                       +-----------+
                                       |  Command  |
                                       |-----+-----+
Attribute Name                         | ACR | ACA |
---------------------------------------|-----+-----+
NAS-Identifier                         | 0-1 | 0-1 |
NAS-IP-Address                         | 0-1 | 0-1 |
NAS-IPv6-Address                       | 0-1 | 0-1 |
NAS-Port                               | 0-1 | 0-1 |
NAS-Port-Id                            | 0-1 | 0-1 |
NAS-Port-Type                          | 0-1 | 0-1 |
Origin-AAA-Protocol                    | 0-1 | 0-1 |
Origin-Host                            | 1   | 1   |
Origin-Realm                           | 1   | 1   |
Origin-State-Id                        | 0-1 | 0-1 |
Originating-Line-Info                  | 0-1 | 0   |
Proxy-Info                             | 0+  | 0+  |
QoS-Filter-Rule                        | 0+  | 0   |
Route-Record                           | 0+  | 0+  |
Result-Code                            | 0   | 1   |
Session-Id                             | 1   | 1   |
Service-Type                           | 0-1 | 0-1 |
Termination-Cause                      | 0-1 | 0-1 |
User-Name                              | 0-1 | 0-1 |
Vendor-Specific-Application-Id         | 0-1 | 0-1 |
---------------------------------------|-----+-----+
</pre></div><p>

					
</p>
<a name="anchor80"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>
				This section provides guidance to the Internet Assigned Numbers
				Authority (IANA) regarding registration of values related to the
				Diameter protocol, in accordance with BCP 26 <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
				<br />
<br />

				This document defines values in the namespaces that have been created
				and defined in the Diameter Base <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>.  
				The IANA Considerations
				section of that document details the assignment criteria.  Values
				assigned in this document, or by future IANA action, must be
				coordinated within this shared namespace.				
			
</p>
<a name="anchor81"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Command Codes</h3>

<p>
					This specification assigns the value 265 from the Command Code
					namespace defined in <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>.  
					See Sections 3.1 and 3.2 for the assignment of the namespace in this specification.
				
</p>
<a name="anchor82"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
AVP Codes</h3>

<p>
					This specification assigns the values 363 - 366 and 400 - 408 from
					the AVP Code namespace defined in <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>. 
					See <a class='info' href='#D-N-A-AVPs'>Section&nbsp;4<span> (</span><span class='info'>Diameter NAS Application AVPs</span><span>)</span></a>
					for the assignment of the namespace in this specification.  Note that the
					values 363 - 366 are jointly, but consistently, assigned in <a class='info' href='#RFC4004'>[RFC4004]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
					This document also creates one new namespace to be
					managed by IANA, as described in <a class='info' href='#A-A-M-A-V'>Section&nbsp;6.5<span> (</span><span class='info'>Accounting-Auth-Method AVP Values</span><span>)</span></a>
					<br />
<br />

					This specification also specifies the use of AVPs in the 0 - 255
					range, which are listed in <a class='info' href='#RADIUSTypes'>[RADIUSTypes]<span> (</span><span class='info'>IANA, &ldquo;RADIUS Types,&rdquo; .</span><span>)</span></a>
					These values are assigned according to the policy stated in 
					<a class='info' href='#RFC2865'>Section 6 of<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> [RFC2865],
					<a class='info' href='#RFC3575'>as amended by<span> (</span><span class='info'>Aboba, B., &ldquo;IANA Considerations for RADIUS (Remote Authentication Dial In User Service),&rdquo; July&nbsp;2003.</span><span>)</span></a> [RFC3575].
				
</p>
<a name="anchor83"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Application Identifier</h3>

<p>
					This specification uses the value one (1) in the Application
					Identifier namespace as assigned in <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>.  
					See <a class='info' href='#A-A-S'>Section&nbsp;1.3<span> (</span><span class='info'>Advertising Application Support</span><span>)</span></a> above for more information.
				
</p>
<a name="anchor84"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
CHAP-Algorithm AVP Values</h3>

<p>
					As defined in <a class='info' href='#C-AUTH-AVP'>Section&nbsp;4.3.4<span> (</span><span class='info'>CHAP-Auth AVP</span><span>)</span></a>,
					the CHAP-Algorithm AVP (AVP Code 403) uses
					the values of the "PPP AUTHENTICATION ALGORITHMS" namespace defined
					in <a class='info' href='#RFC1994'>[RFC1994]<span> (</span><span class='info'>Simpson, W., &ldquo;PPP Challenge Handshake Authentication Protocol (CHAP),&rdquo; August&nbsp;1996.</span><span>)</span></a>.
				
</p>
<a name="A-A-M-A-V"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
Accounting-Auth-Method AVP Values</h3>

<p>
					As defined in <a class='info' href='#A-A-M-AVP'>Section&nbsp;4.6.7<span> (</span><span class='info'>Accounting-Auth-Method AVP</span><span>)</span></a>
					the Accounting-Auth-Method AVP (AVP Code 406) defines the values 1 - 5.  
					All remaining values are available for assignment via the IETF Review policy 
					<a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.		
				
</p>
<a name="anchor85"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>
				This document describes the extension of Diameter for the NAS
				application.  The security considerations of the Diameter protocol
				itself have been discussed in <a class='info' href='#I-D.ietf-dime-rfc3588bis'>[I&#8209;D.ietf&#8209;dime&#8209;rfc3588bis]<span> (</span><span class='info'>Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;Diameter Base Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a>.
				Use of this application of
				Diameter MUST take into consideration the security issues and
				requirements of the Base protocol.
				<br />
<br />

				This document does not contain a security protocol but does discuss
				how PPP authentication protocols can be carried within the Diameter
				protocol.  The PPP authentication protocols described are PAP and
				CHAP.
				<br />
<br />

				The use of PAP SHOULD be discouraged, as it exposes users' passwords
				to possibly non-trusted entities.  However, PAP is also frequently
				used for use with One-Time Passwords, which do not expose a security risk.
				<br />
<br />

				This document also describes how CHAP can be carried within the
				Diameter protocol, which is required for RADIUS backward
				compatibility.  The CHAP protocol, as used in a RADIUS environment,
				facilitates authentication replay attacks.
				<br />
<br />

				The use of the EAP authentication protocols <a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>
				can offer better security, given a method suitable for the circumstances.
			
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ANITypes">[ANITypes]</a></td>
<td class="author-text">NANPA Number Resource Info, &ldquo;<a href="http://www.nanpa.com/number_resource_info/ani_ii_assignments.html">ANI Assignments</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a></td>
<td class="author-text">Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-rfc3588bis-20.txt">Diameter Base Protocol</a>,&rdquo; draft-ietf-dime-rfc3588bis-20 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-rfc3588bis-20.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RADIUSTypes">[RADIUSTypes]</a></td>
<td class="author-text">IANA, &ldquo;<a href="http://www.iana.org/assignments/radius-types">RADIUS Types</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1994">[RFC1994]</a></td>
<td class="author-text"><a href="mailto:wsimpson@GreenDragon.com">Simpson, W.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1994">PPP Challenge Handshake Authentication Protocol (CHAP)</a>,&rdquo; RFC&nbsp;1994, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1994.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2865">[RFC2865]</a></td>
<td class="author-text">Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;2865, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2865.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3162">[RFC3162]</a></td>
<td class="author-text">Aboba, B., Zorn, G., and D. Mitton, &ldquo;<a href="http://tools.ietf.org/html/rfc3162">RADIUS and IPv6</a>,&rdquo; RFC&nbsp;3162, August&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3162.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3516">[RFC3516]</a></td>
<td class="author-text">Nerenberg, L., &ldquo;<a href="http://tools.ietf.org/html/rfc3516">IMAP4 Binary Content Extension</a>,&rdquo; RFC&nbsp;3516, April&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3516.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3539">[RFC3539]</a></td>
<td class="author-text">Aboba, B. and J. Wood, &ldquo;<a href="http://tools.ietf.org/html/rfc3539">Authentication, Authorization and Accounting (AAA) Transport Profile</a>,&rdquo; RFC&nbsp;3539, June&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3539.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ARAP">[ARAP]</a></td>
<td class="author-text">Apple Computer, &ldquo;Apple Remote Access Protocol (ARAP) Version 2.0 External Reference Specification,&rdquo; R0612LL/B&nbsp;, September&nbsp;1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="AppleTalk">[AppleTalk]</a></td>
<td class="author-text">Sidhu, G., Andrews, R., and A. Oppenheimer, &ldquo;Inside AppleTalk,&rdquo; Second Edition&nbsp;Apple Computer, 1990.</td></tr>
<tr><td class="author-text" valign="top"><a name="IPX">[IPX]</a></td>
<td class="author-text">Novell, Inc., &ldquo;NetWare System Technical Interface Overview,&rdquo; &nbsp;#883-000780-001, June&nbsp;1989.</td></tr>
<tr><td class="author-text" valign="top"><a name="ISO.8859-1.1987">[ISO.8859-1.1987]</a></td>
<td class="author-text">International Organization for Standardization, &ldquo;Information technology - 8-bit single byte coded graphic - character sets - Part 1: Latin alphabet No. 1, JTC1/SC2,&rdquo; ISO&nbsp;Standard 8859-1, 1987.</td></tr>
<tr><td class="author-text" valign="top"><a name="LAT">[LAT]</a></td>
<td class="author-text">Digital Equipment Corp., &ldquo;Local Area Transport (LAT) Specification V5.0,&rdquo; &nbsp;AA-NL26A-TE, June&nbsp;1989.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1334">[RFC1334]</a></td>
<td class="author-text"><a href="mailto:brian@lloyd.com">Lloyd, B.</a> and <a href="mailto:Bill.Simpson@um.cc.umich.edu">W. Simpson</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1334">PPP Authentication Protocols</a>,&rdquo; RFC&nbsp;1334, October&nbsp;1992 (<a href="http://www.rfc-editor.org/rfc/rfc1334.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1661">[RFC1661]</a></td>
<td class="author-text"><a href="mailto:Bill.Simpson@um.cc.umich.edu">Simpson, W.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1661">The Point-to-Point Protocol (PPP)</a>,&rdquo; STD&nbsp;51, RFC&nbsp;1661, July&nbsp;1994 (<a href="http://www.rfc-editor.org/rfc/rfc1661.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1990">[RFC1990]</a></td>
<td class="author-text"><a href="mailto:sklower@CS.Berkeley.EDU">Sklower, K.</a>, <a href="mailto:brian@lloyd.com">Lloyd, B.</a>, <a href="mailto:glenn@lloyd.com">McGregor, G.</a>, <a href="mailto:dcarr@Newbridge.COM">Carr, D.</a>, and <a href="mailto:70761.1664@compuserve.com">T. Coradetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1990">The PPP Multilink Protocol (MP)</a>,&rdquo; RFC&nbsp;1990, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1990.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2474">[RFC2474]</a></td>
<td class="author-text"><a href="mailto:kmn@cisco.com">Nichols, K.</a>, <a href="mailto:slblake@torrentnet.com">Blake, S.</a>, <a href="mailto:fred@cisco.com">Baker, F.</a>, and <a href="mailto:black_david@emc.com">D. Black</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2474">Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers</a>,&rdquo; RFC&nbsp;2474, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2474.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2474.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2474.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2548">[RFC2548]</a></td>
<td class="author-text"><a href="mailto:glennz@microsoft.com">Zorn, G.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2548">Microsoft Vendor-specific RADIUS Attributes</a>,&rdquo; RFC&nbsp;2548, March&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2548.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2597">[RFC2597]</a></td>
<td class="author-text"><a href="mailto:jh@telia.fi">Heinanen, J.</a>, <a href="mailto:fred@cisco.com">Baker, F.</a>, <a href="mailto:wweiss@lucent.com">Weiss, W.</a>, and <a href="mailto:jtw@lcs.mit.edu">J. Wroclawski</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2597">Assured Forwarding PHB Group</a>,&rdquo; RFC&nbsp;2597, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2597.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2637">[RFC2637]</a></td>
<td class="author-text"><a href="mailto:kory@ascend.com">Hamzeh, K.</a>, <a href="mailto:gurdeep@microsoft.com">Pall, G.</a>, Verthein, W., Taarud, J., Little, W., and <a href="mailto:glennz@microsoft.com">G. Zorn</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2637">Point-to-Point Tunneling Protocol</a>,&rdquo; RFC&nbsp;2637, July&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2637.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2661">[RFC2661]</a></td>
<td class="author-text"><a href="mailto:townsley@cisco.com">Townsley, W.</a>, <a href="mailto:vandys@cisco.com">Valencia, A.</a>, <a href="mailto:acr@del.com">Rubens, A.</a>, <a href="mailto:gurdeep@microsoft.com">Pall, G.</a>, <a href="mailto:gwz@acm.org">Zorn, G.</a>, and <a href="mailto:palter@zev.net">B. Palter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2661">Layer Two Tunneling Protocol "L2TP"</a>,&rdquo; RFC&nbsp;2661, August&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2661.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2866">[RFC2866]</a></td>
<td class="author-text">Rigney, C., &ldquo;<a href="http://tools.ietf.org/html/rfc2866">RADIUS Accounting</a>,&rdquo; RFC&nbsp;2866, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2866.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2867">[RFC2867]</a></td>
<td class="author-text">Zorn, G., Aboba, B., and D. Mitton, &ldquo;<a href="http://tools.ietf.org/html/rfc2867">RADIUS Accounting Modifications for Tunnel Protocol Support</a>,&rdquo; RFC&nbsp;2867, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2867.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2868">[RFC2868]</a></td>
<td class="author-text">Zorn, G., Leifer, D., Rubens, A., Shriver, J., Holdrege, M., and I. Goyret, &ldquo;<a href="http://tools.ietf.org/html/rfc2868">RADIUS Attributes for Tunnel Protocol Support</a>,&rdquo; RFC&nbsp;2868, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2868.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2869">[RFC2869]</a></td>
<td class="author-text">Rigney, C., Willats, W., and P. Calhoun, &ldquo;<a href="http://tools.ietf.org/html/rfc2869">RADIUS Extensions</a>,&rdquo; RFC&nbsp;2869, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2869.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2881">[RFC2881]</a></td>
<td class="author-text">Mitton, D. and M. Beadles, &ldquo;<a href="http://tools.ietf.org/html/rfc2881">Network Access Server Requirements Next Generation (NASREQNG) NAS Model</a>,&rdquo; RFC&nbsp;2881, July&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2881.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2989">[RFC2989]</a></td>
<td class="author-text">Aboba, B., Calhoun, P., Glass, S., Hiller, T., McCann, P., Shiino, H., Zorn, G., Dommety, G., C.Perkins, B.Patil, D.Mitton, S.Manning, M.Beadles, P.Walsh, X.Chen, S.Sivalingham, A.Hameed, M.Munson, S.Jacobs, B.Lim, B.Hirschman, R.Hsu, Y.Xu, E.Campell, S.Baba, and E.Jaques, &ldquo;<a href="http://tools.ietf.org/html/rfc2989">Criteria for Evaluating AAA Protocols for Network Access</a>,&rdquo; RFC&nbsp;2989, November&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2989.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3169">[RFC3169]</a></td>
<td class="author-text">Beadles, M. and D. Mitton, &ldquo;<a href="http://tools.ietf.org/html/rfc3169">Criteria for Evaluating Network Access Server Protocols</a>,&rdquo; RFC&nbsp;3169, September&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3169.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3246">[RFC3246]</a></td>
<td class="author-text">Davie, B., Charny, A., Bennet, J., Benson, K., Le Boudec, J., Courtney, W., Davari, S., Firoiu, V., and D. Stiliadis, &ldquo;<a href="http://tools.ietf.org/html/rfc3246">An Expedited Forwarding PHB (Per-Hop Behavior)</a>,&rdquo; RFC&nbsp;3246, March&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3575">[RFC3575]</a></td>
<td class="author-text">Aboba, B., &ldquo;<a href="http://tools.ietf.org/html/rfc3575">IANA Considerations for RADIUS (Remote Authentication Dial In User Service)</a>,&rdquo; RFC&nbsp;3575, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3575.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3580">[RFC3580]</a></td>
<td class="author-text">Congdon, P., Aboba, B., Smith, A., Zorn, G., and J. Roese, &ldquo;<a href="http://tools.ietf.org/html/rfc3580">IEEE 802.1X Remote Authentication Dial In User Service (RADIUS) Usage Guidelines</a>,&rdquo; RFC&nbsp;3580, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3580.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4004">[RFC4004]</a></td>
<td class="author-text">Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;<a href="http://tools.ietf.org/html/rfc4004">Diameter Mobile IPv4 Application</a>,&rdquo; RFC&nbsp;4004, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4004.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4072">[RFC4072]</a></td>
<td class="author-text">Eronen, P., Hiller, T., and G. Zorn, &ldquo;<a href="http://tools.ietf.org/html/rfc4072">Diameter Extensible Authentication Protocol (EAP) Application</a>,&rdquo; RFC&nbsp;4072, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4072.txt">TXT</a>).</td></tr>
</table>

<a name="anchor88"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Acknowledgements</h3>

<a name="anchor89"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
RFC 4005</h3>

<p>
					The authors would like to thank Carl Rigney, Allan C. Rubens, William
					Allen Simpson, and Steve Willens for their work on the original RADIUS protocol,
					from which many of the concepts in this
					specification were derived.  Thanks, also, to Carl Rigney for
					<a class='info' href='#RFC2866'>[RFC2866]<span> (</span><span class='info'>Rigney, C., &ldquo;RADIUS Accounting,&rdquo; June&nbsp;2000.</span><span>)</span></a> 
					and <a class='info' href='#RFC2869'>[RFC2869]<span> (</span><span class='info'>Rigney, C., Willats, W., and P. Calhoun, &ldquo;RADIUS Extensions,&rdquo; June&nbsp;2000.</span><span>)</span></a>; 
					Ward Willats for <a class='info' href='#RFC2869'>[RFC2869]<span> (</span><span class='info'>Rigney, C., Willats, W., and P. Calhoun, &ldquo;RADIUS Extensions,&rdquo; June&nbsp;2000.</span><span>)</span></a>; 
					Glen Zorn, Bernard Aboba, and Dave Mitton for <a class='info' href='#RFC2867'>[RFC2867]<span> (</span><span class='info'>Zorn, G., Aboba, B., and D. Mitton, &ldquo;RADIUS Accounting Modifications for Tunnel Protocol Support,&rdquo; June&nbsp;2000.</span><span>)</span></a> 
					and <a class='info' href='#RFC3162'>[RFC3162]<span> (</span><span class='info'>Aboba, B., Zorn, G., and D. Mitton, &ldquo;RADIUS and IPv6,&rdquo; August&nbsp;2001.</span><span>)</span></a>;
					and Dory Leifer, John Shriver, Matt Holdrege, Allan Rubens, Glen Zorn and
					Ignacio Goyret for their work on <a class='info' href='#RFC2868'>[RFC2868]<span> (</span><span class='info'>Zorn, G., Leifer, D., Rubens, A., Shriver, J., Holdrege, M., and I. Goyret, &ldquo;RADIUS Attributes for Tunnel Protocol Support,&rdquo; June&nbsp;2000.</span><span>)</span></a>.  
					This document stole text and concepts from both <a class='info' href='#RFC2868'>[RFC2868]<span> (</span><span class='info'>Zorn, G., Leifer, D., Rubens, A., Shriver, J., Holdrege, M., and I. Goyret, &ldquo;RADIUS Attributes for Tunnel Protocol Support,&rdquo; June&nbsp;2000.</span><span>)</span></a>
					and <a class='info' href='#RFC2869'>[RFC2869]<span> (</span><span class='info'>Rigney, C., Willats, W., and P. Calhoun, &ldquo;RADIUS Extensions,&rdquo; June&nbsp;2000.</span><span>)</span></a>. 
					Thanks go to Carl Williams for providing IPv6-specific text.
					<br />
<br />

					The authors would also like to acknowledge the following people for
					their contributions in the development of the Diameter protocol:
					Bernard Aboba, Jari Arkko, William Bulley, Kuntal Chowdhury, Daniel
					C. Fox, Lol Grant, Nancy Greene, Jeff Hagg, Peter Heitman, Paul
					Krumviede, Fergal Ladley, Ryan Moats, Victor Muslin, Kenneth Peirce,
					Sumit Vakil, John R. Vollbrecht, and Jeff Weisberg.
					<br />
<br />

					Finally, Pat Calhoun would like to thank Sun Microsystems, as most of
					the effort put into this document was done while he was in their employ.		
				
</p>
<a name="anchor90"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
RFC 4005bis</h3>

<p>
					The vast majority of the text in this document was lifted directly fro RFC 4005;
					the editor owes a debt of gratitude to the authors thereof (especially Dave Mitton, who
					somehow managed to make nroff paginate the AVP Occurance Tables correctly!).
				
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Glen Zorn (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Network Zen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1463 East Republican Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">#358</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, Washington  98112</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:gwz@net-zen.net">gwz@net-zen.net</a></td></tr>
</table>
</body></html>
