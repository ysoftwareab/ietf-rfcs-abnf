<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Security for the NFSv4 Protocols</title>
<meta content="David Noveck" name="author">
<meta content="
       
 This document describes the core security features of the NFSv4
 family of protocols, applying to all minor versions. The discussion
 includes the use of security features provided at the RPC transport
 level.
       
       
 This preliminary version of the document, is intended, in
 large part, to result in working group discussion
 regarding NFSv4 security issues and identify issues on which
 the working group needs to work on achieving consensus.
       
       
        When published as an RFC, it will supersede the description of
 security appearing in existing minor version specification
 documents such as RFC 7530 and RFC 8881.
       
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="example" name="keyword">
<meta content="draft-dnoveck-nfsv4-security-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-dnoveck-nfsv4-security-Aug27-1pppwfb1.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Nfsv4 Security</td>
<td class="right">August 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Noveck</td>
<td class="center">Expires 3 March 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">NFSv4</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc8881" class="eref">8881</a>, <a href="https://www.rfc-editor.org/rfc/rfc7530" class="eref">7530</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-08-30" class="published">30 August 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-03-03">3 March 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Noveck, <span class="editor">Ed.</span>
</div>
<div class="org">NetApp</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Security for the NFSv4 Protocols</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
 This document describes the core security features of the NFSv4
 family of protocols, applying to all minor versions. The discussion
 includes the use of security features provided at the RPC transport
 level.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">
 This preliminary version of the document, is intended, in
 large part, to result in working group discussion
 regarding NFSv4 security issues and identify issues on which
 the working group needs to work on achieving consensus.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">
        When published as an RFC, it will supersede the description of
 security appearing in existing minor version specification
 documents such as RFC 7530 and RFC 8881.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 3 March 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-3">
            This document may contain material from IETF Documents or IETF
            Contributions published or made publicly available before November
            10, 2008. The person(s) controlling the copyright in some of this
            material may not have granted the IETF Trust the right to allow
            modifications of such material outside the IETF Standards Process.
            Without obtaining an adequate license from the person(s)
            controlling the copyright in such materials, this document may not
            be modified outside the IETF Standards Process, and derivative
            works of it may not be created outside the IETF Standards Process,
            except to format it for publication as an RFC or to translate it
            into languages other than English.<a href="#section-boilerplate.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-overview" class="xref">Overview</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-keyword-definitions" class="xref">Keyword Definitions</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-special-considerations" class="xref">Special Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-handling-of-multiple-minor-" class="xref">Handling of Multiple Minor Versions</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-handling-of-minor-version-s" class="xref">Handling of Minor-version-specific features</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-transport-based-security-fe" class="xref">Transport-based Security Features</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-issues-yet-to-be-fully-deci" class="xref">Issues Yet to be Fully Decided</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-structure-of-access-control" class="xref">Structure of Access Control Lists</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-access-control-entries" class="xref">Access Control Entries</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-ace-type" class="xref">ACE Type</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-authorization-in-general" class="xref">Authorization in General</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-user-based-file-access-auth" class="xref">User-based File Access Authorization</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-handling-of-multiple-parall" class="xref">Handling of Multiple Parallel File Access Authorization Models</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-attributes-for-user-based-f" class="xref">Attributes for User-based File Access Authorization</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-posix-authorization-model" class="xref">Posix Authorization Model</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="xref">6.3.1</a>.  <a href="#name-attribute-33-mode" class="xref">Attribute 33: mode</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="xref">6.3.2</a>.  <a href="#name-v41-attribute-74-mode_set_m" class="xref">V4.1 Attribute 74: mode_set_masked</a></p>
</li>
                </ul>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-acl-based-authorization-mod" class="xref">ACL-based Authorization Model</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="xref">6.4.1</a>.  <a href="#name-processing-access-control-e" class="xref">Processing Access Control Entries</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a href="#section-6.4.2" class="xref">6.4.2</a>.  <a href="#name-ace-access-mask" class="xref">ACE Access Mask</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4.2.3">
                    <p id="section-toc.1-1.6.2.4.2.3.1"><a href="#section-6.4.3" class="xref">6.4.3</a>.  <a href="#name-details-regarding-mask-bits" class="xref">Details Regarding Mask Bits</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4.2.4">
                    <p id="section-toc.1-1.6.2.4.2.4.1"><a href="#section-6.4.4" class="xref">6.4.4</a>.  <a href="#name-ace4_delete-vs-ace4_delete_" class="xref">ACE4_DELETE vs. ACE4_DELETE_CHILD</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4.2.5">
                    <p id="section-toc.1-1.6.2.4.2.5.1"><a href="#section-6.4.5" class="xref">6.4.5</a>.  <a href="#name-ace-flag" class="xref">ACE flag</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4.2.6">
                    <p id="section-toc.1-1.6.2.4.2.6.1"><a href="#section-6.4.6" class="xref">6.4.6</a>.  <a href="#name-details-regarding-ace-flag-" class="xref">Details Regarding ACE Flag Bits</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4.2.7">
                    <p id="section-toc.1-1.6.2.4.2.7.1"><a href="#section-6.4.7" class="xref">6.4.7</a>.  <a href="#name-ace-who" class="xref">ACE Who</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.4.2.8">
                    <p id="section-toc.1-1.6.2.4.2.8.1"><a href="#section-6.4.8" class="xref">6.4.8</a>.  <a href="#name-automatic-inheritance-featu" class="xref">Automatic Inheritance Features</a></p>
</li>
                </ul>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-v41-attribute-58-dacl" class="xref">V4.1 Attribute 58: dacl</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-v41-attribute-59-sacl" class="xref">V4.1 Attribute 59: sacl</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-common-considerations-for-b" class="xref">Common Considerations for Both File access Models</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-server-considerations" class="xref">Server Considerations</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-client-considerations" class="xref">Client Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-combining-authorization-mod" class="xref">Combining Authorization Models</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-combined-authorization-mode" class="xref">Combined Authorization Models for V4.0</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-combined-authorization-model" class="xref">Combined Authorization Model for V4.1 and Beyond</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="xref">8.2.1</a>.  <a href="#name-computing-a-mode-attribute-" class="xref">Computing a Mode Attribute from an ACL</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="xref">8.2.2</a>.  <a href="#name-alternatives-in-computing-m" class="xref">Alternatives in Computing Mode Bits</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8.2.2.2.3">
                    <p id="section-toc.1-1.8.2.2.2.3.1"><a href="#section-8.2.3" class="xref">8.2.3</a>.  <a href="#name-setting-multiple-acl-attrib" class="xref">Setting Multiple ACL Attributes</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8.2.2.2.4">
                    <p id="section-toc.1-1.8.2.2.2.4.1"><a href="#section-8.2.4" class="xref">8.2.4</a>.  <a href="#name-setting-mode-and-not-acl" class="xref">Setting Mode and not ACL</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8.2.2.2.5">
                    <p id="section-toc.1-1.8.2.2.2.5.1"><a href="#section-8.2.5" class="xref">8.2.5</a>.  <a href="#name-setting-acl-and-not-mode" class="xref">Setting ACL and Not Mode</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8.2.2.2.6">
                    <p id="section-toc.1-1.8.2.2.2.6.1"><a href="#section-8.2.6" class="xref">8.2.6</a>.  <a href="#name-setting-both-acl-and-mode" class="xref">Setting Both ACL and Mode</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8.2.2.2.7">
                    <p id="section-toc.1-1.8.2.2.2.7.1"><a href="#section-8.2.7" class="xref">8.2.7</a>.  <a href="#name-retrieving-the-mode-and-or-" class="xref">Retrieving the Mode and/or ACL Attributes</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8.2.2.2.8">
                    <p id="section-toc.1-1.8.2.2.2.8.1"><a href="#section-8.2.8" class="xref">8.2.8</a>.  <a href="#name-creating-new-objects" class="xref">Creating New Objects</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8.2.2.2.9">
                    <p id="section-toc.1-1.8.2.2.2.9.1"><a href="#section-8.2.9" class="xref">8.2.9</a>.  <a href="#name-use-of-inherited-acl-when-c" class="xref">Use of Inherited ACL When Creating Objects</a></p>
</li>
                </ul>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-combined-authorization-models" class="xref">Combined Authorization Models for V4.2</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-labelled-nfs-authorization-" class="xref">Labelled NFS Authorization Model</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-state-modification-authoriz" class="xref">State Modification Authorization</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-other-uses-of-access-contro" class="xref">Other Uses of Access Control Lists</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-identification-and-authenti" class="xref">Identification and Authentication</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-identification-vs-authentic" class="xref">Identification vs. Authentication</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.  <a href="#name-items-to-be-identified" class="xref">Items to be Identified</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="xref">12.3</a>.  <a href="#name-authentication-provided-by-" class="xref">Authentication Provided by specific RPC Flavors</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="xref">12.4</a>.  <a href="#name-authentication-provided-by-t" class="xref">Authentication Provided by the RPC Transport</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-security-of-data-in-flight" class="xref">Security of Data in Flight</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="xref">13.1</a>.  <a href="#name-data-security-provided-by-t" class="xref">Data Security Provided by the Flavor-associated Services</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="xref">13.2</a>.  <a href="#name-data-security-provided-by-th" class="xref">Data Security Provided by the RPC Transport</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-security-negotiation" class="xref">Security Negotiation</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="xref">14.1</a>.  <a href="#name-flavors-and-pseudo-flavors" class="xref">Flavors and Pseudo-flavors</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="xref">14.2</a>.  <a href="#name-negotiation-of-security-fla" class="xref">Negotiation of Security Flavors and Mechanisms</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-14.3" class="xref">14.3</a>.  <a href="#name-negotiation-of-rpc-transpor" class="xref">Negotiation of RPC Transports and Characteristics</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#section-14.4" class="xref">14.4</a>.  <a href="#name-overall-interpretation-of-s" class="xref">Overall Interpretation of SECINFO Response Arrays</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#section-14.5" class="xref">14.5</a>.  <a href="#name-secinfo" class="xref">SECINFO</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.14.2.5.2.1">
                    <p id="section-toc.1-1.14.2.5.2.1.1"><a href="#section-14.5.4" class="xref">14.5.4</a>.  <a href="#name-secinfo-implementation-gene" class="xref">SECINFO IMPLEMENTATION (general)</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.14.2.5.2.1.2.1">
                        <p id="section-toc.1-1.14.2.5.2.1.2.1.1"><a href="#section-14.5.4.1" class="xref">14.5.4.1</a>.  <a href="#name-secinfo-implementation-for-" class="xref">SECINFO IMPLEMENTATION (for v4.0)</a></p>
</li>
                      <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.14.2.5.2.1.2.2">
                        <p id="section-toc.1-1.14.2.5.2.1.2.2.1"><a href="#section-14.5.4.2" class="xref">14.5.4.2</a>.  <a href="#name-secinfo-implementation-for-v" class="xref">SECINFO IMPLEMENTATION (for v4.1 and v4.2)</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#section-14.6" class="xref">14.6</a>.  <a href="#name-future-security-needs" class="xref">Future Security Needs</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="xref">15.1</a>.  <a href="#name-changes-in-security-conside" class="xref">Changes in Security Considerations</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.1.2.1">
                    <p id="section-toc.1-1.15.2.1.2.1.1"><a href="#section-15.1.1" class="xref">15.1.1</a>.  <a href="#name-wider-view-of-threats" class="xref">Wider View of Threats</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.1.2.2">
                    <p id="section-toc.1-1.15.2.1.2.2.1"><a href="#section-15.1.2" class="xref">15.1.2</a>.  <a href="#name-transport-layer-security-fa" class="xref">Transport-layer Security Facilities</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.1.2.3">
                    <p id="section-toc.1-1.15.2.1.2.3.1"><a href="#section-15.1.3" class="xref">15.1.3</a>.  <a href="#name-compatibility-and-maturity-" class="xref">Compatibility and Maturity Issues</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.1.2.4">
                    <p id="section-toc.1-1.15.2.1.2.4.1"><a href="#section-15.1.4" class="xref">15.1.4</a>.  <a href="#name-discussion-of-authsys" class="xref">Discussion of AUTHSYS</a></p>
</li>
                </ul>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="xref">15.2</a>.  <a href="#name-security-considerations-sco" class="xref">Security Considerations Scope</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.2.2.1">
                    <p id="section-toc.1-1.15.2.2.2.1.1"><a href="#section-15.2.1" class="xref">15.2.1</a>.  <a href="#name-discussion-of-potential-cla" class="xref">Discussion of Potential Classification of Environments</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.2.2.2">
                    <p id="section-toc.1-1.15.2.2.2.2.1"><a href="#section-15.2.2" class="xref">15.2.2</a>.  <a href="#name-discussion-of-environments" class="xref">Discussion of Environments</a></p>
</li>
                </ul>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#section-15.3" class="xref">15.3</a>.  <a href="#name-major-new-recommendations" class="xref">Major New Recommendations</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.3.2.1">
                    <p id="section-toc.1-1.15.2.3.2.1.1"><a href="#section-15.3.1" class="xref">15.3.1</a>.  <a href="#name-recommendations-regarding-s" class="xref">Recommendations Regarding Security of Data in Flight</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.3.2.2">
                    <p id="section-toc.1-1.15.2.3.2.2.1"><a href="#section-15.3.2" class="xref">15.3.2</a>.  <a href="#name-recommendations-regarding-c" class="xref">Recommendations Regarding Client Peer Authentication</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.3.2.3">
                    <p id="section-toc.1-1.15.2.3.2.3.1"><a href="#section-15.3.3" class="xref">15.3.3</a>.  <a href="#name-issues-regarding-valid-reas" class="xref">Issues Regarding Valid Reasons to Bypass Recommendations</a></p>
</li>
                </ul>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#section-15.4" class="xref">15.4</a>.  <a href="#name-data-security-threats" class="xref">Data Security Threats</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a href="#section-15.5" class="xref">15.5</a>.  <a href="#name-authentication-based-threat" class="xref">Authentication-based threats</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.5.2.1">
                    <p id="section-toc.1-1.15.2.5.2.1.1"><a href="#section-15.5.1" class="xref">15.5.1</a>.  <a href="#name-attacks-based-on-the-use-of" class="xref">Attacks based on the use of AUTH_SYS</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.5.2.2">
                    <p id="section-toc.1-1.15.2.5.2.2.1"><a href="#section-15.5.2" class="xref">15.5.2</a>.  <a href="#name-attacks-on-name-userid-mapp" class="xref">Attacks on Name/Userid Mapping Facilities</a></p>
</li>
                </ul>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.6">
                <p id="section-toc.1-1.15.2.6.1"><a href="#section-15.6" class="xref">15.6</a>.  <a href="#name-disruption-and-denial-of-se" class="xref">Disruption and Denial-of-Service Attacks</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.6.2.1">
                    <p id="section-toc.1-1.15.2.6.2.1.1"><a href="#section-15.6.1" class="xref">15.6.1</a>.  <a href="#name-attacks-based-on-the-disrup" class="xref">Attacks Based on the Disruption of Client-Server Shared State</a></p>
</li>
                  <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15.2.6.2.2">
                    <p id="section-toc.1-1.15.2.6.2.2.1"><a href="#section-15.6.2" class="xref">15.6.2</a>.  <a href="#name-attacks-based-on-forcing-th" class="xref">Attacks Based on Forcing the Misuse of Server Resources</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="xref">16</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#section-16.1" class="xref">16.1</a>.  <a href="#name-new-authstat-values" class="xref">New Authstat Values</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#section-16.2" class="xref">16.2</a>.  <a href="#name-new-authentication-pseudo-f" class="xref">New Authentication Pseudo-Flavors</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="xref">17</a>. <a href="#name-dummy-sections" class="xref">Dummy Sections</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#section-17.1" class="xref">17.1</a>.  <a href="#name-dummy-section-authfa-acl-ac" class="xref">Dummy Section AUTHFA-acl-ace</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#section-17.2" class="xref">17.2</a>.  <a href="#name-dummy-section-authfa-acl-acl" class="xref">Dummy Section AUTHFA-acl-aclsupport</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="xref">18</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#section-18.1" class="xref">18.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#section-18.2" class="xref">18.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-changes-made" class="xref">Changes Made</a></p>
<ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-motivating-changes" class="xref">Motivating Changes</a></p>
</li>
              <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-other-changes" class="xref">Other Changes</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="OVIEW">
<section id="section-1">
      <h2 id="name-overview">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-1-1">
 This document presents a new approach to security for the NFSv4
 protocols, which, although building on previous treatments of
 these issues, diverges substantially from them in a number of respects.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
        A new treatment is necessary because:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1">
     Previous treatments paid insufficient attention to security
     issues regarding data in flight.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1">
     The presentation of AUTH_SYS as an "'OPTIONAL' means of
     authentication" obscured the severe security problems that
     come with its use.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.3">
          <p id="section-1-3.3.1">
     The security considerations sections of existing minor
     version specifications contain no threat analyses and
     focus on particular security issues in a way that obscures,
     rather than clarifying, the security issues that need to
     be addressed.<a href="#section-1-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.4">
          <p id="section-1-3.4.1">
     The availability of RPC-with-TLS (described in
     <span>[<a href="#I-D.ietf-nfsv4-rpc-tls" class="xref">12</a>]</span>) provides
     facilities that NFSv4 clients and servers will need to
     use to provide security for data in flight and mitigate
     the lack of authentication when AUTH_SYS is used.<a href="#section-1-3.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-4">
   The first version of this preliminary document contained many
   notes with headers in brackets,
   requesting comments regarding confusing or otherwise dubious
   passages in existing documents and other choices that needed
   to made.  Comments and working group
   discussion of these issues will be important in
   arriving  at an adequate RFC candidate.  In this version, those
   specific have been removed and
   changes to address these issues are listed in
   <a href="#CHG-other" class="xref">Appendix A.2</a> while a few issues that probably
   require further discussion to arrive at consensus are discussed in
   <a href="#INTRO-tbd" class="xref">Section 3.4</a>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
   In order to make further progress on these difficult issues,
   including many whose resolution will probably involve compatibility
   issues with existing implementations, the author has
   tried his best to resolve these issues, even though there is no
   assurance that the resolution adopted by consensus will match the
   author's curret best efforts.  To provide a possible resolution
   that might be the basis of discussion while not foreclosing other
   possibilities, the following annotations will be used:<a href="#section-1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">
          <p id="section-1-6.1.1">
     A paragraph headed "[Previous Treatment]:", indicates text that
     is provided for context but which the author believes, should
     not appear in the eventual RFC.<a href="#section-1-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-6.2">
          <p id="section-1-6.2.1">
     A paragraph headed "[Author Aside]:", provides the author's
     comments about possible changes and will probable not appear
     in the eventual RFC.<a href="#section-1-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-6.3">
          <p id="section-1-6.3.1">
     A paragraph headed "[Consensus Needed]:", provides the author's
     preferred tratment of the matter and should only appear in the
     eventual RFC.<a href="#section-1-6.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-7">
   To deal with situations in which one of the above annotations
   would apply to all paragraphs of a section, that annotation
   may be used on the lead paragraph of the section with the
   paragraph text, "Applies to entire section."<a href="#section-1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="REQL">
<section id="section-2">
      <h2 id="name-requirements-language">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
      </h2>
<div id="REQL-def">
<section id="section-2.1">
        <h3 id="name-keyword-definitions">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-keyword-definitions" class="section-name selfRef">Keyword Definitions</a>
        </h3>
<p id="section-2.1-1">
   The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
   "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
   "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
   "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>",
   "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>"
   in this document are to be
   interpreted as specified in BCP 14 <span>[<a href="#RFC2119" class="xref">1</a>]</span>
          <span>[<a href="#RFC8174" class="xref">5</a>]</span> when, and only when,
   they appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="REQL-special">
<section id="section-2.2">
        <h3 id="name-special-considerations">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-special-considerations" class="section-name selfRef">Special Considerations</a>
        </h3>
<p id="section-2.2-1">
          Because this document needs to revise previous treatments of
   its subject, it will need to cite previous treatments of issues
   that now need to be dealt with in a different way.  This will
   take the form of quotations from documents whose treatment
   of the subject is being obsoleted, most often direct but
   sometimes indirect as well.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">
          Such treatments in quotations will involve use of these
   BCP14-defined terms in two noteworthy ways:<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-3.1">
            <p id="section-2.2-3.1.1">
     The term may have been used inappropriately (i.e not in accord
     with <span>[<a href="#RFC2119" class="xref">1</a>]</span>), as has been the case
     for the "<span class="bcp14">RECOMMENDED</span>" attributes, which are in
     fact <span class="bcp14">OPTIONAL</span>.<a href="#section-2.2-3.1.1" class="pilcrow">¶</a></p>
<p id="section-2.2-3.1.2">
     In such cases, the surrounding text will make clear that the
     quoted text has no normative effect.<a href="#section-2.2-3.1.2" class="pilcrow">¶</a></p>
<p id="section-2.2-3.1.3">
     Some specific issues relating to this case are
     described below <a href="#AUTHFA-attr" class="xref">Section 6.2</a>.<a href="#section-2.2-3.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-3.2">
            <p id="section-2.2-3.2.1">
     The term may been used in accord with <span>[<a href="#RFC2119" class="xref">1</a>]</span>,
     although the resulting normative statement is now felt to be
     inappropriate.<a href="#section-2.2-3.2.1" class="pilcrow">¶</a></p>
<p id="section-2.2-3.2.2">
     In such cases, the surrounding text will need to make clear
     that the text quoted is no longer to be considered normative,
     often by providing new text that conflicts with the quoted,
     previously normative, text.<a href="#section-2.2-3.2.2" class="pilcrow">¶</a></p>
<p id="section-2.2-3.2.3">
            An important instance of this situation is the description of
     AUTH_SYS as an "<span class="bcp14">OPTIONAL</span>" means of authentication.
     For detailed discussion of this case, see Sections
     <a href="#IDENT" class="xref">12</a> and
     <a href="#SECCON-changes-authsys" class="xref">15.1.4</a><a href="#section-2.2-3.2.3" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="INTRO">
<section id="section-3">
      <h2 id="name-introduction">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-3-1">
      Because the basic approach to security issues is so similar for all
      minor versions, this document applies to all NFSv4 minor versions. The
      details of this transition are discussed in Sections
      <a href="#INTRO-mult" class="xref">3.1</a> and
      <a href="#INTRO-feat" class="xref">3.2</a><a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
      This document is able to take a new approach to
      security issues because of the work that has been done to provide
      security features at the transport level, rather than providing security
      features only by making choices with regard to the authentication
      flavor and associated mechanisms and services.  The effect of this
      shift is summarized in <a href="#INTRO-xport" class="xref">Section 3.3</a>.<a href="#section-3-2" class="pilcrow">¶</a></p>
<div id="INTRO-mult">
<section id="section-3.1">
        <h3 id="name-handling-of-multiple-minor-">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-handling-of-multiple-minor-" class="section-name selfRef">Handling of Multiple Minor Versions</a>
        </h3>
<p id="section-3.1-1">
   In some cases, there are differences between minor versions in
   that there are security-related features, not present in all
   minor versions.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
   To deal with this issue, this document will focus on a few
   major areas listed below which are common to all minor versions.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">
            <p id="section-3.1-3.1.1">
     File access authorization (discussed in <a href="#AUTHFA" class="xref">Section 6</a>)
     is the same in all minor versions together with the identification/
     authentication infrastructure supporting it (discussed in
     <a href="#IDENT" class="xref">Section 12</a>) provided by RPC and applying to all
     of NFS.<a href="#section-3.1-3.1.1" class="pilcrow">¶</a></p>
<p id="section-3.1-3.1.2">
     An exception is made regarding labelled NFS, an optional
     feature within NFSv4.2, described in <span>[<a href="#RFC7862" class="xref">10</a>]</span>.
     This is discussed as a version-specific feature in this
     document in <a href="#AUTHL" class="xref">Section 9</a><a href="#section-3.1-3.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.2">
            <p id="section-3.1-3.2.1">
     Features to secure data in-flight, all provided by RPC,
     together with the negotiation infrastructure to support
     them are common to all NFSv4 minor versions, are discussed in
     <a href="#NEGO" class="xref">Section 14</a><a href="#section-3.1-3.2.1" class="pilcrow">¶</a></p>
<p id="section-3.1-3.2.2">
     However, the use of SECINFO_NONAME, together with changes
     needed for transport level encryption, paralleling those
     proposed here for SECINFO, is treated as a version-specific
     feature and, while mentioned here, will be fully documented
     in new v4.1 specification documents.<a href="#section-3.1-3.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.3">
            <p id="section-3.1-3.3.1">
     The Protection of state data from unauthorized modification
     is discussed in <a href="#AUTHST" class="xref">Section 10</a>)
     is the same in all minor versions together with the identification/
     authentication infrastructure supporting it (discussed in
     <a href="#IDENT" class="xref">Section 12</a>) provided by secure transports such
     as RPC-over-TLS.<a href="#section-3.1-3.3.1" class="pilcrow">¶</a></p>
<p id="section-3.1-3.3.2">
     It should be noted that state protection based on RPCSEC_GSS
     is treated as a version-specific feature and will continue to be
     described by <span>[<a href="#RFC8881" class="xref">8</a>]</span> or its successors. Also,
     it needs to be noted that the use of state protection is not
     discussed in <span>[<a href="#RFC7530" class="xref">6</a>]</span>.<a href="#section-3.1-3.3.2" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="INTRO-feat">
<section id="section-3.2">
        <h3 id="name-handling-of-minor-version-s">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-handling-of-minor-version-s" class="section-name selfRef">Handling of Minor-version-specific features</a>
        </h3>
<p id="section-3.2-1">
   There are a number of areas in which security features differ among
   minor versions, as discussed below.  In some cases, a new
   feature requires specific security support while in others
   one version will have a new feature related to enhancing the
   security infrastructure.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">
   How such features are dealt with in this document depends on
   the specific feature.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">
            In addition to SECINFO, whose enhanced description appears in
     this document, NFSv4.1 added a new SECINFO_NONAME operation,
     useful for pNFS file as well as having some non-pNFS uses.<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
<p id="section-3.2-3.1.2">
            While the enhanced description of SECINFO mentions SECINFO_NONAME,
     this is handled as one of a number of cases in which the
     description has to indicate that different actions need to be
     taken for different minor versions.<a href="#section-3.2-3.1.2" class="pilcrow">¶</a></p>
<p id="section-3.2-3.1.3">
            The definitive description of SECINFO_NONAME, now appearing in
     RFC8881 needs to be modified to match the description of SECINFO
     appearing in this document.  It is expected that this will be
     done as part of the rfc5661bis process.<a href="#section-3.2-3.1.3" class="pilcrow">¶</a></p>
<p id="section-3.2-3.1.4">
     The security implications of the security negotiation
     facilities as a whole will be addressed in the security
     considerations section of this document.<a href="#section-3.2-3.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.2">
            <p id="section-3.2-3.2.1">
            The pNFS optional  feature added in NFSv4.1 has its own
     security needs which parallel closely those of non-pNFS
     access. As a result, these needs and the means to satisfy
     them are not discussed in this document.<a href="#section-3.2-3.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2-3.2.2">
            The definitive description of pNFS security will remain in RFC8881
     and its successors (i.e. the rfc5661bis document suite).  However,
     because pNFS security relies heavily on the infrastructure
     discussed here, it is anticipated that the new treatment of
     pNFS security will deal with many matters by referencing
     the overall NFS security
     document.<a href="#section-3.2-3.2.2" class="pilcrow">¶</a></p>
<p id="section-3.2-3.2.3">
            The security considerations section of rfc5661bis will deal with
     pNFS security issues.<a href="#section-3.2-3.2.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.3">
            <p id="section-3.2-3.3.1">
            In addition to the state protection facilities described
     in this document, NFS has another set of such facilities that
     are not usable in NFSv4.0.<a href="#section-3.2-3.3.1" class="pilcrow">¶</a></p>
<p id="section-3.2-3.3.2">
     While this document will discuss the security implications of
     protection against state modification, it will not discuss the
     details of the v4.1-specific features to accomplish it.<a href="#section-3.2-3.3.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.4">
            <p id="section-3.2-3.4.1">
     The additional v4.1 acl attributes, sacl and dacl, are mentioned
     in this document, but do not affect the treatment of security,
     since the acl entries, whether in the acl attribute or separated
     into sacl and dacl attributes continue to have the same effect.<a href="#section-3.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.5">
            <p id="section-3.2-3.5.1">
     Nfsv4.1 introduced detailed description of methods of co-ordinating
     the values of the authorization-related attributes mode and acl.
     this is in contrast to Nfsv4.0, which while expecting such
     coordination to be provide somehow, did not provide any
     details, allowing a number of different approaches to meet the
     goal of providing appropriate co-ordination.<a href="#section-3.2-3.5.1" class="pilcrow">¶</a></p>
<p id="section-3.2-3.5.2">
     This document will provide separate sections describing each of
     the approaches, together with a common section describing the
     goals of providing co-ordination when both are supported.<a href="#section-3.2-3.5.2" class="pilcrow">¶</a></p>
<p id="section-3.2-3.5.3">
     As a result, this document will override the treatment within
     RFC8881 and this material will be removed in the rfc5661bis
     document suite and replaced by a reference to the treatment in
     the NFSv4 security RFC.<a href="#section-3.2-3.5.3" class="pilcrow">¶</a></p>
<p id="section-3.2-3.5.4">
     Similarly, this document will supersede the corresponding treatment
     in RFC7530 as well.  As a result, v4.0 server implementers reading
     any successor document will be aware of the possibility of the
     v4.1 approach even though it is clear that this is only one of the
     possible approaches to this issue. V4.1 client implementers
     will be made aware of the goals and that there is little that
     can be relied upon with regard to v4.0 servers' attempts to
     address those goals.<a href="#section-3.2-3.5.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.6">
            <p id="section-3.2-3.6.1">
     The protocol extension defined in <span>[<a href="#RFC8257" class="xref">13</a>]</span>,
     now part of NFSv4.2, is also related to the issue of
     co-ordination of acl and mode attributes and will be discussed
     in that context.<a href="#section-3.2-3.6.1" class="pilcrow">¶</a></p>
<p id="section-3.2-3.6.2">
     Nevertheless, the description in <span>[<a href="#RFC8257" class="xref">13</a>]</span>
     will remain definitive.<a href="#section-3.2-3.6.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.7">
            <p id="section-3.2-3.7.1">
     The the v4.1 attribute set-mode-masked attribute is mentioned
     together with the
     other attributes implementing the POSIX authorization model.<a href="#section-3.2-3.7.1" class="pilcrow">¶</a></p>
<p id="section-3.2-3.7.2">
     Because this attribute. while related to security, does not
     substantively modify the security properties of the protocol,
     the full description of this attribute, will continue to be
     the province of the v4.1 specification proper.<a href="#section-3.2-3.7.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.8">
            <p id="section-3.2-3.8.1">
     There is a brief description of the v4.2 Labelled NFS feature
     in <a href="#AUTHL" class="xref">Section 9</a>.   Part of that description
     discusses the limitations in the description of that feature
     within <span>[<a href="#RFC7862" class="xref">10</a>]</span>.<a href="#section-3.2-3.8.1" class="pilcrow">¶</a></p>
<p id="section-3.2-3.8.2">
     Because of some limitations in the description, it is not
     possible to provide an appropriate security considerations
     section for that feature in this document.<a href="#section-3.2-3.8.2" class="pilcrow">¶</a></p>
<p id="section-3.2-3.8.3">
     As a result, the responsibility to provide an appropriate
     Security Considerations section remains, unrealized for now,
     with the NFSv4.2 specification document.<a href="#section-3.2-3.8.3" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="INTRO-xport">
<section id="section-3.3">
        <h3 id="name-transport-based-security-fe">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-transport-based-security-fe" class="section-name selfRef">Transport-based Security Features</a>
        </h3>
<p id="section-3.3-1">
   There are a number of security-related facilities that can be
   provided at the transport layer eliminating the need for or
   or proving support to processing done as part of RPC proper.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">
   These will initially be provided by RPC-over-TLS but similar
   facilities might be provided on new versions of existing
   transports or new RPC transports.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-3.1">
            <p id="section-3.3-3.1.1">
     The transport might provide encryption of requests and replies,
     eliminating the need for privacy and integrity services to be
     negotiated later and applied
     on a per-request basis.<a href="#section-3.3-3.1.1" class="pilcrow">¶</a></p>
<p id="section-3.3-3.1.2">
     While clients might choose to establish connections with such
     encryption, servers can establish policies allowing access to
     certain pieces of the namespace using such transports, or
     limiting access to those providing privacy, allowing the use
     of either transport-based encryption or privacy services
     provided by RPCSEC_GSS.<a href="#section-3.3-3.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-3.2">
            <p id="section-3.3-3.2.1">
     The transport might provide mutual authentication of the client
     and server peers as part of the establishment of the connection
     This authentication is distinct from the the mutual authentication
     of the client user and server peer, implemented within the
     GSSSEC_RPC framework.<a href="#section-3.3-3.2.1" class="pilcrow">¶</a></p>
<p id="section-3.3-3.2.2">
     This form of authentication is of particular importance when the
     when the server allows the use of the flavors AUTH_SYS and
     AUTH_NONE, which have no provision for the authentication of the
     user requesting the operation.<a href="#section-3.3-3.2.2" class="pilcrow">¶</a></p>
<p id="section-3.3-3.2.3">
     While clients might choose to establish connections with such
     peer authentication, servers can establish policies a limiting
     access to certain pieces of the namespace without such peer
     authentication or only allowing it using RPCSEC_GSS.<a href="#section-3.3-3.2.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-4">
   To enable server policies to be effectively communicated to
   clients, the security negotiation framework now allows
   connection characteristics to be specified using pseudo-flavors.
   See <a href="#NEGO" class="xref">Section 14</a> for details.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="INTRO-tbd">
<section id="section-3.4">
        <h3 id="name-issues-yet-to-be-fully-deci">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-issues-yet-to-be-fully-deci" class="section-name selfRef">Issues Yet to be Fully Decided</a>
        </h3>
<p id="section-3.4-1">
   {author Aside]: Applies to entire section.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">
   For a number of reasons, it is necessary for the treatment of
   certain aspects to change, even though we strive in this new
   treatment for compatibility.   In some cases, this is because
   the existing treatment is unclear, is inconsistent, or uses
   keywords defined in RFC2119 in an inappropriate way.  See
   <a href="#CHG-other" class="xref">Appendix A.2</a> for a detailed list.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">
   Because the existing specifications, at least notionally, represent
   a working group consensus, it important to verify that there is
   a working group consensus to adopt the modified treatment and the
   list of changes together with notes in ealier versions of this
   document should prompt discussion that will confirm the modified
   treatment or indicate another approach should be adopted. In most
   such cases, the author believes that the changes already made
   deserve to be confirmed by the working group.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">
   There are, however, a number of complex cases in which the author
   has done the best he could but is unsure about the resolution to
   be adopted, principally because of uncertinty about compatibility
   issues with existing v4.0 and v4.1 implementations. These
   difficult cases are discussed below.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">
   There is considerable confusion/uncertainty about what sets of
   ACE types a server may validly support.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-6.1">
            <p id="section-3.4-6.1.1">
     It had been stated in <a href="#AUTHFA-acl-aclsupport" class="xref">Section 17.2</a> that
            "Servers that support either the ALLOW or DENY ACE type
            <span class="bcp14">SHOULD</span> support both ALLOW and DENY ACE types"
     but it is not made clear why this recommendation is made or
     what might be valid reasons to disregard it (as provided by
     the definition of "<span class="bcp14">SHOULD</span>").<a href="#section-3.4-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.2">
            <p id="section-3.4-6.2.1">
     There appears to be a need, when the mode attribute
     is set, to be prepared to return an equivalent acl, it
     appears that supporting ALLOW without DENY is not viable,
     since a mode that only allowed "others" to read a file
     cannot be represented by an ACL with only ALLOW entries.<a href="#section-3.4-6.2.1" class="pilcrow">¶</a></p>
<p id="section-3.4-6.2.2">
     This would justify a statement like the one quoted above
     using <span class="bcp14">MUST</span> but is clearly inconsistent with
     the <span class="bcp14">SHOULD</span> above.<a href="#section-3.4-6.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.3">
            <p id="section-3.4-6.3.1">
     While it is possible to tie these together, the structure of
     the aclsupport attribute is inconsistent with this.<a href="#section-3.4-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-6.4">
            <p id="section-3.4-6.4.1">
     In any case, we would need to provide guidance to the client as
     to dealing
     with servers that support ALLOW or DENY but not both.<a href="#section-3.4-6.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-7">
   The current text, while not using RFC2119 keywords, indicates why
   it is desirable to implement both of these or neither.  The client
   is only to use the acl-based authorization model if both ALLOW and
   DENY ACEs are supported.<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<p id="section-3.4-8">
   There are inconsistent discussions leading to confusion about dealing
   with acls that cannot be enforced.<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-9.1">
            <p id="section-3.4-9.1.1">
     Section xxx of the previous version of this I-D dealt with this
     issue by indicating that the acl presented by the client is to
     be revised into one which can be enforced.<a href="#section-3.4-9.1.1" class="pilcrow">¶</a></p>
<p id="section-3.4-9.1.2">
     The treatment in this section manifests an extraordinary degree
     of solicitude about hypothesized server implementations that do
     not support the NFSv4 ACL model but support a diferent
     authorization model which is finer-grained than that provided
     by mode but
     not as rich as that of the NFSv4 ACL model.   The difficulties
     that the consequent uncertainty would create for clients and
     applications is essentially ignored.<a href="#section-3.4-9.1.2" class="pilcrow">¶</a></p>
<p id="section-3.4-9.1.3">
     Somewhat implausibly, the section speculates about file systems
     whose inability to support the NFSv4 ACL model derives from
     an inability to treat differently writes that extend the file
     and those that don't.<a href="#section-3.4-9.1.3" class="pilcrow">¶</a></p>
<p id="section-3.4-9.1.4">
     There is a discussion of possible complications that derive
     from of use of NFSv4 ACLs in a multiprotocol environment,
     in which the use of the term "modules" obscures the
     necessary distinction between matters relating to NFSv4 are
     dealt with in this document, while those for other protocols
     have to be considered out of scope.<a href="#section-3.4-9.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-9.2">
            <p id="section-3.4-9.2.1">
     In <a href="#AUTHFA-acl-aclsupport" class="xref">Section 17.2</a>, it is stated that
     "a servers <span class="bcp14">SHOULD</span> reject acls it cannot enforce"<a href="#section-3.4-9.2.1" class="pilcrow">¶</a></p>
<p id="section-3.4-9.2.2">
     It is not clear what the harm jutifying the use of
     "<span class="bcp14">SHOULD</span>" might be and what the valid reasons to
     do otherise might be.<a href="#section-3.4-9.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-10">
   The possibility of making the handling of co-ordination of modes
   and acls case minor-version-independent need be considered.<a href="#section-3.4-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-11.1">
            <p id="section-3.4-11.1.1"></p><a href="#section-3.4-11.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-11.2">
            <p id="section-3.4-11.2.1"></p><a href="#section-3.4-11.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.4-12">
   Although not dealt with in the current document, there are a number
   of similar issues which will need to be addressed in a future
   version of this I-D.<a href="#section-3.4-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-13.1">
            <p id="section-3.4-13.1.1">
     The requirents regarding support for LIPKEY, etc.<a href="#section-3.4-13.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-13.2">
            <p id="section-3.4-13.2.1">
     The specific detail for Kerberos support are currently different
     and the possibility of bringing them into aligment needs to
     be seriously considered.<a href="#section-3.4-13.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="ACL">
<section id="section-4">
      <h2 id="name-structure-of-access-control">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-structure-of-access-control" class="section-name selfRef">Structure of Access Control Lists</a>
      </h2>
<p id="section-4-1">
      Access Control Lists consisting of multiple Access Control Elements,
      while originally designed to support a more
      flexible authorization model, have multiple uses within NFSv4,  with
      the use of each element depending on its type, as defined in
      <a href="#ACL-acetype" class="xref">Section 4.2</a><a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">
 They may be used to provide a more flexible authorization model
 as described in <a href="#AUTHFA-acl" class="xref">Section 6.4</a>.   This involves
 use of Access Control Entries of the ALLOW and DENY types.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">
 They may be used to provide the security-related services
 described in <a href="#OTHACL" class="xref">Section 11</a>. This involves
 use of Access Control Entries of the AUDIT and ALARM types.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">
      Subsections of this section define the structure of ACLs and
      discuss ACL-related matters that apply to multiple types of
      ACL use, including the definitions of the acl and aclsupport
      attributes.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
      Matters that relate to only a single one of these use classes,
      including the defiition of the v4.1-specific attributes dacl and sacl
      are discussed in subsections of Sections
      <a href="#AUTHFA-acl" class="xref">6.4</a> or
      <a href="#OTHACL" class="xref">11</a>.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="ACL-ace">
<section id="section-4.1">
        <h3 id="name-access-control-entries">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-access-control-entries" class="section-name selfRef">Access Control Entries</a>
        </h3>
<p id="section-4.1-1">
            The attributes acl, sacl (v4.1 only) and dacl (v4.1 only)
     each contain an array of Access
            Control Entries (ACEs) that are associated with the file
            system object.  The client can set and
            get these attributes attribute, the server is responsible
     for using the ACL-related attributes to perform access control.
     The client can use the
            OPEN or ACCESS operations to check access without modifying
            or explicitly reading data or metadata.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
          The NFS ACE structure is defined as follows:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<div id="section-4.1-3">
<pre class="sourcecode lang-xdr">
typedef uint32_t        acetype4;

typedef uint32_t aceflag4;

typedef uint32_t        acemask4;

struct nfsace4 {
        acetype4        type;
        aceflag4        flag;
        acemask4        access_mask;
        utf8str_mixed   who;
};
</pre><a href="#section-4.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ACL-acetype">
<section id="section-4.2">
        <h3 id="name-ace-type">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-ace-type" class="section-name selfRef">ACE Type</a>
        </h3>
<p id="section-4.2-1">
            The constants used for the type field (acetype4) are as
            follows:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="section-4.2-2">
<pre class="sourcecode lang-xdr">
const ACE4_ACCESS_ALLOWED_ACE_TYPE      = 0x00000000;
const ACE4_ACCESS_DENIED_ACE_TYPE       = 0x00000001;
const ACE4_SYSTEM_AUDIT_ACE_TYPE        = 0x00000002;
const ACE4_SYSTEM_ALARM_ACE_TYPE        = 0x00000003;
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2-3">
            All four are permitted in the
            acl attribute.  For v4.1 and beyond, only the ALLOWED and DENIED
     types may be used in the dacl attribute, and only the AUDIT
     and ALARM types.x
            used in the sacl attribute.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Abbreviation</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ACE4_ACCESS_ALLOWED_ACE_TYPE</td>
              <td class="text-left" rowspan="1" colspan="1">ALLOW</td>
              <td class="text-left" rowspan="1" colspan="1">
     Explicitly grants the ability to perform the action
     specfied in acemask4 to
     the file or directory.
   </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ACE4_ACCESS_DENIED_ACE_TYPE</td>
              <td class="text-left" rowspan="1" colspan="1">DENY</td>
              <td class="text-left" rowspan="1" colspan="1">
     Explicitly denies the ability to perform the action
     specfied in acemask4 to
     the file or directory.
   </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ACE4_SYSTEM_AUDIT_ACE_TYPE</td>
              <td class="text-left" rowspan="1" colspan="1">AUDIT</td>
              <td class="text-left" rowspan="1" colspan="1">
     Log (in a system-dependent way) any attempt to
     perform, for the file or directory, any of the
                    actions specified in acemask4.
   </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ACE4_SYSTEM_ALARM_ACE_TYPE</td>
              <td class="text-left" rowspan="1" colspan="1">ALARM</td>
              <td class="text-left" rowspan="1" colspan="1">
     Generate an alarm (in a system-dependent way) any attempt
     to perform, for the file or directory, any of the
                    actions specified in acemask4.
   </td>
            </tr>
          </tbody>
        </table>
<p id="section-4.2-5">
              The "Abbreviation" column denotes how the
              types will be referred to throughout the rest of this
              document.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AUTHG">
<section id="section-5">
      <h2 id="name-authorization-in-general">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-authorization-in-general" class="section-name selfRef">Authorization in General</a>
      </h2>
<p id="section-5-1">
      There are three distinct methods of checking whether NFSv4 requests
      are authorized:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">
 The most important method of authorization is used to effect
 user-based file access control, as described in
 <a href="#AUTHFA" class="xref">Section 6</a>.<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
<p id="section-5-2.1.2">
        This requires the identification of the user making the request.
        Because of the central role of such access control in providing
 NFSv4 security, server implementations <span class="bcp14">SHOULD NOT</span>
 use such identifications when they are not authenticated. In this
 context, valid reasons to do otherwise are limited to the
 compatibility and maturity issues discussed in
 <a href="#SECCON-changes-compat" class="xref">Section 15.1.3</a><a href="#section-5-2.1.2" class="pilcrow">¶</a></p>
<p id="section-5-2.1.3"></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">
 NFSv4.2, via the labelled NFS feature, provides an additional
 potential requirement for request authorization.<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
<p id="section-5-2.2.2">
        For reasons made clear in <a href="#AUTHL" class="xref">Section 9</a>, there
        is no realistic possibility of the server using the data defined
 by existing specifications of this feature to effect request
 authorization.  While it is possible for clients to provide
 this authorization, the lack of detailed specifications makes it
 impossible to determine the nature of the identification used and
 whether it can appropriately be described as "authentication".<a href="#section-5-2.2.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.3">
          <p id="section-5-2.3.1">
 Since undesired changes to server-mintained locking state (and, for
 NFSv4.1, session state) can result in denial of service attacks
 (see <a href="#SECCON-denial" class="xref">Section 15.6</a>), server implementations
 <span class="bcp14">SHOULD</span> take steps to prevent unauthorized state
 changes. This can be done by implementing the state authorization
 restrictions discussed in <a href="#AUTHST" class="xref">Section 10</a><a href="#section-5-2.3.1" class="pilcrow">¶</a></p>
<p id="section-5-2.3.2"></p>
</li>
      </ul>
</section>
</div>
<div id="AUTHFA">
<section id="section-6">
      <h2 id="name-user-based-file-access-auth">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-user-based-file-access-auth" class="section-name selfRef">User-based File Access Authorization</a>
      </h2>
<div id="AUTHFA-two">
<section id="section-6.1">
        <h3 id="name-handling-of-multiple-parall">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-handling-of-multiple-parall" class="section-name selfRef">Handling of Multiple Parallel File Access Authorization Models</a>
        </h3>
<p id="section-6.1-1">
            ACLs and modes represent two well-established models for
            specifying user-based file access permissions.  NFSv4 provides
     support for either or both depending on the attributes
     supported by the server:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">
            <p id="section-6.1-2.1.1">
       When the attributes mode, owner, owner group are all supported,
       the posix-based
       authorization model, described in <a href="#AUTHFA-posix" class="xref">Section 6.3</a>
       can be used.<a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.2">
            <p id="section-6.1-2.2.1">
       [Consensus Needed (Item #1a)]:
       When the acl (or dacl) attribute is supported together with
       both of the ACE types ALLOW and DENY, the acl based
       authorization model, described  in <a href="#AUTHFA-acl" class="xref">Section 6.4</a>
       can be used as long as the attributes owner and owner group are
       also supported.<a href="#section-6.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-3">
     While formally recommended (essentially <span class="bcp14">OPTIONAL</span>)
     attributes, it appears that the owner and owner_group
     attributes need to be available to support any file access
     authorization model.  As a result, this document will not
     discuss the possibility of servers that do not support
     both of these attributes and clients have no need to
     support such servers.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">
     When both authorization models can be used, there are
     difficulties that can arise because the ACL-based model
     provides finer-grained access control than the POSIX model.
     The ways of dealing with these difficulties appear
     later in this section while more detail on the appropriate
     handling of this situation, which might depend on the minor
     version used, appears in <a href="#AUTH-comb" class="xref">Section 8</a>.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">
     The following describe NFSv4's handling in supporting multiple
     authorization models for file access.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-6.1">
            <p id="section-6.1-6.1.1">
              If a server supports the mode attribute, it should provide
              the appropriate POSIX semantics to clients that only set and
       retrieve the mode attribute.<a href="#section-6.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-6.2">
            <p id="section-6.1-6.2.1">
              If a server supports ACL attributes, it should provide
              ACL semantics as described in this document to clients that only
       set and retrieve
              those attributes.<a href="#section-6.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-6.3">
            <p id="section-6.1-6.3.1">
              On servers that support the mode attribute, if ACL
              attributes have never been set on an object, via
              inheritance or explicitly, the behavior should be
              the behavior mandated by POSIX.<a href="#section-6.1-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-6.4">
            <p id="section-6.1-6.4.1">
              On servers that support the mode attribute, if the ACL
              attributes have been previously set on an object, either
              explicitly or via inheritance:<a href="#section-6.1-6.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-6.4.2.1">
                <p id="section-6.1-6.4.2.1.1">
                [Previous Treatment]:
 Setting only the mode attribute should effectively
                control the traditional UNIX-like permissions of read,
                write, and execute on owner, owner_group, and other.<a href="#section-6.1-6.4.2.1.1" class="pilcrow">¶</a></p>
<p id="section-6.1-6.4.2.1.2">
         [Author Aside]: It isn't really clear
         what the above paragraph means, especially as it governs
 the handling of aces designating specific users and groups
 which are not the owner and have no overlap with the owning<a href="#section-6.1-6.4.2.1.2" class="pilcrow">¶</a></p>
<p id="section-6.1-6.4.2.1.3">
         {Consenses Needed (Item #3)]:
         Setting only the mode attribute, should result in the
 access of the file being controlled just it would be if
 the existing acl did not exist, when decisions as to reading
 writing and executing the file.   The ALLOW and DENY aces
 in the ACL should reflect the modified security although there
 is no need to modify AUDIT and ALARM aces or mask bits not 
 affected by the mode bits, such as SYNCHRONIZE.<a href="#section-6.1-6.4.2.1.3" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-6.4.2.2">
                <p id="section-6.1-6.4.2.2.1">
                [Previou Treatment]:
 Setting only the mode attribute should provide
                reasonable security. For example, setting a mode of
                000 should be enough to ensure that future OPEN operations for
                OPEN4_SHARE_ACCESS_READ or OPEN4_SHARE_ACCESS_WRITE by any principal fail, regardless of a
                previously existing or inherited ACL.<a href="#section-6.1-6.4.2.2.1" class="pilcrow">¶</a></p>
<p id="section-6.1-6.4.2.2.2">
         [Author Aside]:  We need some replacement
         for the subjective first sentence.  While the specific
 example give is unexceptionable, it raises question about
 other case in which what constitutes "reasonable semantics.
 While that question is subject to dispute, the author believes
 consenses item #3 deals with the matter adequately.<a href="#section-6.1-6.4.2.2.2" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.1-6.5">
            NFSv4.1 describes specfic semantic requirements
            relating to the interaction of mode and ACL attributes,
     which do contract the goals listed above. As a result,
     the handling provided by servers of different minor
     version might well be different, as discussed below.<a href="#section-6.1-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.1-7">
   In regard to the interaction of the mode and ACL attributes:<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-8.1">
            <p id="section-6.1-8.1.1">
     As discussed in <a href="#AUTH-comb-v40" class="xref">Section 8.1</a>, the specific
     semantic requirements specified for v4.1 could be adopted
     by v4.0, although
     some modification might be necessary to deal with the
     absence of the mode_set_masked attribute.<a href="#section-6.1-8.1.1" class="pilcrow">¶</a></p>
<p id="section-6.1-8.1.2">
     V4.0 clients would have to be able to interact with servers
     that different approaches to these goals.<a href="#section-6.1-8.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-8.2">
            <p id="section-6.1-8.2.1">
     V4.1 servers have specific rules for handling these issues as
     discussed in <a href="#AUTH-comb-v41" class="xref">Section 8.2</a>.   However, despite
     this, the rules are, in many places, fairly loosely drawn and
     allow a range of server behaviors.<a href="#section-6.1-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-8.3">
            <p id="section-6.1-8.3.1">
     To deal with issues related to the perceived overuse of modes
     derived from the umask in vitiating needed acl inheritance,
     a V4.2 extension was provided, allowing the separation of the
     application-specifed mode from the umask.  This is discussed
     in <a href="#AUTH-comb-v42" class="xref">Section 8.3</a><a href="#section-6.1-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="AUTHFA-attr">
<section id="section-6.2">
        <h3 id="name-attributes-for-user-based-f">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-attributes-for-user-based-f" class="section-name selfRef">Attributes for User-based File Access Authorization</a>
        </h3>
<p id="section-6.2-1">
     NFSv4.1 provides for multiple authentication models,
     controlled by the support for particular recommended attributes
     implemented by the server, as discussed below:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1">
            <p id="section-6.2-2.1.1">
       Consensus Needed (Item #2)]: The attributes owner,
       owning_group, and mode enable use of a POSIX-based
       authorization model, as described in
       <a href="#AUTHFA-posix" class="xref">Section 6.3</a>.
       When all of these attributes are supported, this authorization
       model can be implemented.<a href="#section-6.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-6.2-2.1.2">
       Consensus Needed (Item #2)]:When none of these attributes or only
       a proper subset of them are supported, this authorization model
       is unavailable.<a href="#section-6.2-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.2">
            <p id="section-6.2-2.2.1">
       [Consensus Needed (Item #1b)]: The acl attribute (or the
       attribute dacl in v4.1) can
       provide an ACL-based authorization model as described in
       <a href="#AUTHFA-acl" class="xref">Section 6.4</a> as long as support for ALLOW and
       DENY ACEs is provided.<a href="#section-6.2-2.2.1" class="pilcrow">¶</a></p>
<p id="section-6.2-2.2.2">
       Consensus Needed (Items #1b,2)]: When some of these ACE types are
       not supported or the owner or
       owning_group attribute is not supported, this authorization model
       is unavailable.<a href="#section-6.2-2.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="AUTHFA-posix">
<section id="section-6.3">
        <h3 id="name-posix-authorization-model">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-posix-authorization-model" class="section-name selfRef">Posix Authorization Model</a>
        </h3>
<div id="AUTHFA-posix-mode">
<section id="section-6.3.1">
          <h4 id="name-attribute-33-mode">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-attribute-33-mode" class="section-name selfRef">Attribute 33: mode</a>
          </h4>
<p id="section-6.3.1-1">
          The NFSv4.1 mode attribute is based on the UNIX mode
          bits. The following bits are defined:<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<div id="section-6.3.1-2">
<pre class="sourcecode lang-xdr">
const MODE4_SUID = 0x800;  /* set user id on execution */
const MODE4_SGID = 0x400;  /* set group id on execution */
const MODE4_SVTX = 0x200;  /* save text even after use */
const MODE4_RUSR = 0x100;  /* read permission: owner */
const MODE4_WUSR = 0x080;  /* write permission: owner */
const MODE4_XUSR = 0x040;  /* execute permission: owner */
const MODE4_RGRP = 0x020;  /* read permission: group */
const MODE4_WGRP = 0x010;  /* write permission: group */
const MODE4_XGRP = 0x008;  /* execute permission: group */
const MODE4_ROTH = 0x004;  /* read permission: other */
const MODE4_WOTH = 0x002;  /* write permission: other */
const MODE4_XOTH = 0x001;  /* execute permission: other */
</pre><a href="#section-6.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3.1-3">
          Bits MODE4_RUSR, MODE4_WUSR, and MODE4_XUSR apply to the
          principal identified by the owner attribute. Bits MODE4_RGRP,
          MODE4_WGRP, and MODE4_XGRP apply to principals belonging to
   the group identified in
          the owner_group attribute but who are not identified by the
          owner attribute. Bits MODE4_ROTH, MODE4_WOTH, and MODE4_XOTH apply
          to any principal that does not match that in the owner
          attribute and does not belong to a group matching that of the
          owner_group attribute.  These nine bits are used in providing
   authorization information.<a href="#section-6.3.1-3" class="pilcrow">¶</a></p>
<p id="section-6.3.1-4">
     The bits MODE4_SUID, MODE4_SGID, and MODE4_SVTX do not
     provide authorization information and do not affect server
     behavior.  Instead, they are acted on by the client just as
     they would be for corresponding mode bits obtained from
     local file systems.<a href="#section-6.3.1-4" class="pilcrow">¶</a></p>
<p id="section-6.3.1-5">
          Bits within a mode other than those specified above
          are not defined by this protocol. A server
          <span class="bcp14">MUST NOT</span> return bits other than those defined above in a
          GETATTR or READDIR operation, and it <span class="bcp14">MUST</span> return NFS4ERR_INVAL
          if bits other than those defined above are set in a SETATTR,
          CREATE, OPEN, VERIFY, or NVERIFY operation.<a href="#section-6.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTHFA-posix-smm">
<section id="section-6.3.2">
          <h4 id="name-v41-attribute-74-mode_set_m">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-v41-attribute-74-mode_set_m" class="section-name selfRef">V4.1 Attribute 74: mode_set_masked</a>
          </h4>
<p id="section-6.3.2-1">
          The mode_set_masked attribute is a write-only attribute
          that allows individual bits in the mode attribute to be
          set or reset, without changing others.  It allows, for
          example, the bits MODE4_SUID, MODE4_SGID, and MODE4_SVTX
          to be modified while leaving unmodified any of the 
          nine low-order mode bits devoted to permissions.<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<p id="section-6.3.2-2">
          In instances such that none of the nine low-order bits are subject
          to modification, then neither the acl nor the dacl attribute
          should be automatically modified as discussed in 
   Sections <a href="#AUTH-comb-setmode" class="xref">8.2.4</a> and
   <a href="#AUTH-comb-setboth" class="xref">8.2.6</a>.<a href="#section-6.3.2-2" class="pilcrow">¶</a></p>
<p id="section-6.3.2-3">
          The mode_set_masked attribute consists of two words,
          each in the form of a mode4.  The first consists of the
          value to be applied to the current mode value and the
          second is a mask.  Only bits set to one in the mask word
          are changed (set or reset) in the file's mode.  All 
          other bits in the mode remain unchanged.  Bits in the
          first word that correspond to bits that are zero in
          the mask are ignored, except that undefined bits are
          checked for validity and can result in NFS4ERR_INVAL as
          described below.<a href="#section-6.3.2-3" class="pilcrow">¶</a></p>
<p id="section-6.3.2-4">
          The mode_set_masked attribute is only valid in a SETATTR
          operation.  If it is used in a CREATE or OPEN operation, the
          server <span class="bcp14">MUST</span> return NFS4ERR_INVAL.<a href="#section-6.3.2-4" class="pilcrow">¶</a></p>
<p id="section-6.3.2-5">
          Bits not defined as valid in the mode attribute are not
          valid in either word of the mode_set_masked attribute.
          The server <span class="bcp14">MUST</span> return NFS4ERR_INVAL
          if any such bits are set to one in a SETATTR.  
If the mode and
          mode_set_masked attributes are both specified in the
          same SETATTR, the server <span class="bcp14">MUST</span> also return
   NFS4ERR_INVAL.<a href="#section-6.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AUTHFA-acl">
<section id="section-6.4">
        <h3 id="name-acl-based-authorization-mod">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-acl-based-authorization-mod" class="section-name selfRef">ACL-based Authorization Model</a>
        </h3>
<div id="AUTHFA-proc-ace">
<section id="section-6.4.1">
          <h4 id="name-processing-access-control-e">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-processing-access-control-e" class="section-name selfRef">Processing Access Control Entries</a>
          </h4>
<p id="section-6.4.1-1">
           To determine if a request succeeds, the server processes
           each nfsace4 entry of type ALLOW or DENY
    in turn as ordered in the array.  Only ACEs
   that have a "who"
          that matches the requester are considered. An ACE is considered to
   match a given requester if at least one of the following is true:<a href="#section-6.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4.1-2.1">
       The "who' designates a specific user which is the 
       user making the request.<a href="#section-6.4.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.4.1-2.2">
       The "who" specifies "OWNER@" and the user making the request is the
       owner of the file.<a href="#section-6.4.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.4.1-2.3">
       The "who" designates a specific group and the
       user making the request is a member of that group.<a href="#section-6.4.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.4.1-2.4">
       The "who" specifies "GROUP@" and the user making the request is a
       member of the group owning the file.<a href="#section-6.4.1-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.4.1-2.5">
       The "who" specifies "EVERYONE@".<a href="#section-6.4.1-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.4.1-2.6">
       The "who" specifies "INTERACTIVE@", "NETWORK@", "DIALUP@", "BATCH@",
       or "SERVICE@" and the requester, in the judgment of the server,
       feels that designation appropriately describes the requester.<a href="#section-6.4.1-2.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.4.1-2.7">
       The "who" specifies "ANONYMOUS@" or "AUTHENTICATED@" and the
       requestor's authentication status matches the who, using the
       definitions in <a href="#acewho" class="xref">Section 6.4.7</a><a href="#section-6.4.1-2.7" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.4.1-3">
     Each ACE is
          processed until all of the bits of the requester's access
          have been ALLOWED.  Once a bit (see below) has been ALLOWED
          by an ACCESS_ALLOWED_ACE, it is no longer considered in the
          processing of later ACEs.  If an ACCESS_DENIED_ACE is
          encountered where the requester's access still has unALLOWED
          bits in common with the "access_mask" of the ACE, the
          request is denied.  When the ACL is fully processed, if
          there are bits in the requester's mask that have not been
          ALLOWED or DENIED, access is denied.<a href="#section-6.4.1-3" class="pilcrow">¶</a></p>
<p id="section-6.4.1-4">
          Unlike the ALLOW and DENY ACE types, the ALARM and AUDIT ACE
          types do not affect a requester's access, and instead are
          for triggering events as a result of a requester's access
          attempt.  AUDIT and ALARM ACEs are processed only
          after processing ALLOW and DENY ACEs if any exist.<a href="#section-6.4.1-4" class="pilcrow">¶</a></p>
<p id="section-6.4.1-5">
            [Previous Treatment]: The NFSv4.1 ACL model is quite rich.
     Some server
          platforms may provide access-control functionality that goes
          beyond the UNIX-style mode attribute, but that is not as
          rich as the NFS ACL model.  So that users can take advantage
          of this more limited functionality, the server may support
          the acl attributes by mapping between its ACL model and the
          NFSv4.1 ACL model.  Servers must ensure that the ACL
          they actually store or enforce is at least as strict as the
          NFSv4 ACL that was set.  It is tempting to accomplish this
          by rejecting any ACL that falls outside the small set that
          can be represented accurately.  However, such an approach
          can render ACLs unusable without special client-side
          knowledge of the server's mapping, which defeats the purpose
          of having a common NFSv4 ACL protocol.  Therefore, servers
          should accept every ACL that they can without compromising
          security.  To help accomplish this, servers may make a
          special exception, in the case of unsupported permission
          bits, to the rule that bits not ALLOWED or DENIED by an ACL
          must be denied.  For example, a UNIX-style server might
          choose to silently allow read attribute permissions even
          though an ACL does not explicitly allow those permissions.
          (An ACL that explicitly denies permission to read attributes
          should still be rejected.)<a href="#section-6.4.1-5" class="pilcrow">¶</a></p>
<p id="section-6.4.1-6">
     [Author Aside]:  While the NFSv4.1 provides that many might
     not need or use, it is the one that the working group
     adopted by the working group, and I have to assume that
     alternatives, such as the withdrawn POSIX ACL proposal
     were considered but not adopted.   The phrase "unsupported
     permission bits" with no definition of the bit whose support
     might be dispemsed with implies that the server is free to support
     whatever subset of these bits it chooses.   As a result, clients
     would not be able to rely on a functioning server implementation
     of theis OPTIONAL&gt;   IF there are specfic compatibility issues
     that make it necessary to allow non-support of specfic mask bits,
     then these need to be limited and the client needs guidance
     about determining the set of unsupported mask bits.<a href="#section-6.4.1-6" class="pilcrow">¶</a></p>
<p id="section-6.4.1-7">
            [Previous Treatment]: The situation is complicated by the fact
     that a server may
          have multiple modules that enforce ACLs. For example, the
          enforcement for NFSv4.1 access may be different from,
          but not weaker than, the enforcement for local access, and
          both may be different from the enforcement for access
          through other protocols such as SMB (Server Message Block). So it may be useful for
          a server to accept an ACL even if not all of its modules are
          able to support it.<a href="#section-6.4.1-7" class="pilcrow">¶</a></p>
<p id="section-6.4.1-8"></p>
<p id="section-6.4.1-9">
          The guiding principle with regard to NFSv4 access is
          that the server must not accept ACLs that appear to
          make access to the file more restrictive than it really is.<a href="#section-6.4.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acemask">
<section id="section-6.4.2">
          <h4 id="name-ace-access-mask">
<a href="#section-6.4.2" class="section-number selfRef">6.4.2. </a><a href="#name-ace-access-mask" class="section-name selfRef">ACE Access Mask</a>
          </h4>
<p id="section-6.4.2-1">
            The bitmask constants used for the access mask field
            are as follows:<a href="#section-6.4.2-1" class="pilcrow">¶</a></p>
<div id="section-6.4.2-2">
<pre class="sourcecode lang-xdr">
const ACE4_READ_DATA            = 0x00000001;
const ACE4_LIST_DIRECTORY       = 0x00000001;
const ACE4_WRITE_DATA           = 0x00000002;
const ACE4_ADD_FILE             = 0x00000002;
const ACE4_APPEND_DATA          = 0x00000004;
const ACE4_ADD_SUBDIRECTORY     = 0x00000004;
const ACE4_READ_NAMED_ATTRS     = 0x00000008;
const ACE4_WRITE_NAMED_ATTRS    = 0x00000010;
const ACE4_EXECUTE              = 0x00000020;
const ACE4_DELETE_CHILD         = 0x00000040;
const ACE4_READ_ATTRIBUTES      = 0x00000080;
const ACE4_WRITE_ATTRIBUTES     = 0x00000100;
const ACE4_WRITE_RETENTION      = 0x00000200;
const ACE4_WRITE_RETENTION_HOLD = 0x00000400;

const ACE4_DELETE               = 0x00010000;
const ACE4_READ_ACL             = 0x00020000;
const ACE4_WRITE_ACL            = 0x00040000;
const ACE4_WRITE_OWNER          = 0x00080000;
const ACE4_SYNCHRONIZE          = 0x00100000;
</pre><a href="#section-6.4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.4.2-3">

    Note that some masks have coincident values, for
    example, ACE4_READ_DATA and ACE4_LIST_DIRECTORY.
    The mask entries ACE4_LIST_DIRECTORY,
    ACE4_ADD_FILE, and ACE4_ADD_SUBDIRECTORY are
    intended to be used with directory objects,
    while ACE4_READ_DATA, ACE4_WRITE_DATA, and
    ACE4_APPEND_DATA are intended to be used with
    non-directory objects.<a href="#section-6.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.4.3">
          <h4 id="name-details-regarding-mask-bits">
<a href="#section-6.4.3" class="section-number selfRef">6.4.3. </a><a href="#name-details-regarding-mask-bits" class="section-name selfRef">Details Regarding Mask Bits</a>
          </h4>
<p id="section-6.4.3-1">ACE4_READ_DATA<a href="#section-6.4.3-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-2.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-2.1.1">
                <dt id="section-6.4.3-2.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-2.1.1.2">
                  <p id="section-6.4.3-2.1.1.2.1">READ<a href="#section-6.4.3-2.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-2.1.1.2.2">OPEN<a href="#section-6.4.3-2.1.1.2.2" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-2.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-2.1.1.4">
                  <p id="section-6.4.3-2.1.1.4.1">
       Permission to read the data of the file.<a href="#section-6.4.3-2.1.1.4.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-2.1.1.4.2">
       Servers <span class="bcp14">SHOULD</span> allow a user the ability to read the data
       of the file when only the ACE4_EXECUTE access mask bit is
       allowed.<a href="#section-6.4.3-2.1.1.4.2" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-3">ACE4_LIST_DIRECTORY<a href="#section-6.4.3-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-4.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-4.1.1">
                <dt id="section-6.4.3-4.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-4.1.1.2">READDIR<a href="#section-6.4.3-4.1.1.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-4.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-4.1.1.4">
       Permission to list the contents of a directory.<a href="#section-6.4.3-4.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-5">ACE4_WRITE_DATA<a href="#section-6.4.3-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-6.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-6.1.1">
                <dt id="section-6.4.3-6.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-6.1.1.2">
                  <p id="section-6.4.3-6.1.1.2.1">WRITE<a href="#section-6.4.3-6.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-6.1.1.2.2">OPEN<a href="#section-6.4.3-6.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-6.4.3-6.1.1.2.3">SETATTR of size<a href="#section-6.4.3-6.1.1.2.3" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-6.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-6.1.1.4">
       Permission to modify a file's data.<a href="#section-6.4.3-6.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-7">ACE4_ADD_FILE<a href="#section-6.4.3-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-8.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-8.1.1">
                <dt id="section-6.4.3-8.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-8.1.1.2">
                  <p id="section-6.4.3-8.1.1.2.1">CREATE<a href="#section-6.4.3-8.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-8.1.1.2.2">LINK<a href="#section-6.4.3-8.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-6.4.3-8.1.1.2.3">OPEN<a href="#section-6.4.3-8.1.1.2.3" class="pilcrow">¶</a></p>
<p id="section-6.4.3-8.1.1.2.4">RENAME<a href="#section-6.4.3-8.1.1.2.4" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-8.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-8.1.1.4">
       Permission to add a new file in a directory.
       The CREATE operation is affected when nfs_ftype4
       is NF4LNK, NF4BLK, NF4CHR, NF4SOCK, or
       NF4FIFO. (NF4DIR is not listed because it is
       covered by ACE4_ADD_SUBDIRECTORY.) OPEN is
       affected when used to create a regular file.
       LINK and RENAME are always affected.<a href="#section-6.4.3-8.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-9">ACE4_APPEND_DATA<a href="#section-6.4.3-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-10.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-10.1.1">
                <dt id="section-6.4.3-10.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-10.1.1.2">
                  <p id="section-6.4.3-10.1.1.2.1">WRITE<a href="#section-6.4.3-10.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-10.1.1.2.2">OPEN<a href="#section-6.4.3-10.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-6.4.3-10.1.1.2.3">SETATTR of size<a href="#section-6.4.3-10.1.1.2.3" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-10.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-10.1.1.4">
       The ability to modify a file's data, but only
       starting at EOF.  This allows for the specification of
       append-only files, by allowing ACE4_APPEND_DATA
       and denying ACE4_WRITE_DATA to the same user or
       group.  If a file has an ACL such as the one
       described above and a WRITE request is made for
       somewhere other than EOF, the server <span class="bcp14">SHOULD</span>
       return NFS4ERR_ACCESS.<a href="#section-6.4.3-10.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-11">ACE4_ADD_SUBDIRECTORY<a href="#section-6.4.3-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-12.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-12.1.1">
                <dt id="section-6.4.3-12.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-12.1.1.2">
                  <p id="section-6.4.3-12.1.1.2.1">CREATE<a href="#section-6.4.3-12.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-12.1.1.2.2">RENAME<a href="#section-6.4.3-12.1.1.2.2" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-12.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-12.1.1.4">
       Permission to create a subdirectory in a
       directory.  The CREATE operation is affected
       when nfs_ftype4 is NF4DIR.  The RENAME operation
       is always affected.<a href="#section-6.4.3-12.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-13">ACE4_READ_NAMED_ATTRS<a href="#section-6.4.3-13" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-14.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-14.1.1">
                <dt id="section-6.4.3-14.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-14.1.1.2">
                  <p id="section-6.4.3-14.1.1.2.1">OPENATTR<a href="#section-6.4.3-14.1.1.2.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-14.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-14.1.1.4">
       Permission to read the named attributes of a
       file or to look up the named attribute
       directory.  OPENATTR is affected when it is not
       used to create a named attribute directory.
       This is when 1) createdir is TRUE, but a named
       attribute directory already exists, or 2)
       createdir is FALSE.<a href="#section-6.4.3-14.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-15">ACE4_WRITE_NAMED_ATTRS<a href="#section-6.4.3-15" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-16.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-16.1.1">
                <dt id="section-6.4.3-16.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-16.1.1.2">
                  <p id="section-6.4.3-16.1.1.2.1">OPENATTR<a href="#section-6.4.3-16.1.1.2.1" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-16.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-16.1.1.4">
       Permission to write the named attributes of a
       file or to create a named attribute directory.
       OPENATTR is affected when it is used to create a
       named attribute directory.  This is when
       createdir is TRUE and no named attribute
       directory exists.  The ability to check whether
       or not a named attribute directory exists
       depends on the ability to look it up; therefore,
       users also need the ACE4_READ_NAMED_ATTRS
       permission in order to create a named attribute
       directory.<a href="#section-6.4.3-16.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-17">ACE4_EXECUTE<a href="#section-6.4.3-17" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-18.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-18.1.1">
                <dt id="section-6.4.3-18.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-18.1.1.2">
                  <p id="section-6.4.3-18.1.1.2.1">READ<a href="#section-6.4.3-18.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-18.1.1.2.2">OPEN<a href="#section-6.4.3-18.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-6.4.3-18.1.1.2.3">REMOVE<a href="#section-6.4.3-18.1.1.2.3" class="pilcrow">¶</a></p>
<p id="section-6.4.3-18.1.1.2.4">RENAME<a href="#section-6.4.3-18.1.1.2.4" class="pilcrow">¶</a></p>
<p id="section-6.4.3-18.1.1.2.5">LINK<a href="#section-6.4.3-18.1.1.2.5" class="pilcrow">¶</a></p>
<p id="section-6.4.3-18.1.1.2.6">CREATE<a href="#section-6.4.3-18.1.1.2.6" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-18.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-18.1.1.4">
                  <p id="section-6.4.3-18.1.1.4.1">
       Permission to execute a file.<a href="#section-6.4.3-18.1.1.4.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-18.1.1.4.2">
       Servers <span class="bcp14">SHOULD</span> allow a
       user the ability to read the data of the file
       when only the ACE4_EXECUTE access mask bit is
       allowed.  This is because there is no way to
       execute a file without reading the contents.
       Though a server may treat ACE4_EXECUTE and
       ACE4_READ_DATA bits identically when deciding to
       permit a READ operation, it <span class="bcp14">SHOULD</span> still allow
       the two bits to be set independently in ACLs,
       and <span class="bcp14">MUST</span> distinguish between them when replying
       to ACCESS operations.  In particular, servers
       <span class="bcp14">SHOULD NOT</span> silently turn on one of the two bits
       when the other is set, as that would make it
       impossible for the client to correctly enforce
       the distinction between read and execute
       permissions.<a href="#section-6.4.3-18.1.1.4.2" class="pilcrow">¶</a></p>
<p id="section-6.4.3-18.1.1.4.3">As an example, following a SETATTR of the following ACL:<a href="#section-6.4.3-18.1.1.4.3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-18.1.1.4.4.1">nfsuser:ACE4_EXECUTE:ALLOW<a href="#section-6.4.3-18.1.1.4.4.1" class="pilcrow">¶</a>
</li>
                  </ul>
<p id="section-6.4.3-18.1.1.4.5">
       A subsequent GETATTR of ACL for that file <span class="bcp14">SHOULD</span> return:<a href="#section-6.4.3-18.1.1.4.5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-18.1.1.4.6.1">nfsuser:ACE4_EXECUTE:ALLOW<a href="#section-6.4.3-18.1.1.4.6.1" class="pilcrow">¶</a>
</li>
                  </ul>
<p id="section-6.4.3-18.1.1.4.7">
       Rather than:<a href="#section-6.4.3-18.1.1.4.7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-18.1.1.4.8.1">
                      nfsuser:ACE4_EXECUTE/ACE4_READ_DATA:ALLOW<a href="#section-6.4.3-18.1.1.4.8.1" class="pilcrow">¶</a>
</li>
                  </ul>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-19">ACE4_EXECUTE<a href="#section-6.4.3-19" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-20.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-20.1.1">
                <dt id="section-6.4.3-20.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-20.1.1.2">LOOKUP<a href="#section-6.4.3-20.1.1.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-20.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-20.1.1.4">
       Permission to traverse/search a directory.<a href="#section-6.4.3-20.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-21">ACE4_DELETE_CHILD<a href="#section-6.4.3-21" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-22.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-22.1.1">
                <dt id="section-6.4.3-22.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-22.1.1.2">
                  <p id="section-6.4.3-22.1.1.2.1">REMOVE<a href="#section-6.4.3-22.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-22.1.1.2.2">RENAME<a href="#section-6.4.3-22.1.1.2.2" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-22.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-22.1.1.4">
       Permission to delete a file or directory within
       a directory. 

       See <a href="#delete-delete_child" class="xref">Section 6.4.4</a>
       for information on ACE4_DELETE and
       ACE4_DELETE_CHILD interact.<a href="#section-6.4.3-22.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-23">ACE4_READ_ATTRIBUTES<a href="#section-6.4.3-23" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-24.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-24.1.1">
                <dt id="section-6.4.3-24.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-24.1.1.2">
                  <p id="section-6.4.3-24.1.1.2.1">GETATTR of file system object attributes<a href="#section-6.4.3-24.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-24.1.1.2.2">VERIFY<a href="#section-6.4.3-24.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-6.4.3-24.1.1.2.3">NVERIFY<a href="#section-6.4.3-24.1.1.2.3" class="pilcrow">¶</a></p>
<p id="section-6.4.3-24.1.1.2.4">READDIR<a href="#section-6.4.3-24.1.1.2.4" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-24.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-24.1.1.4">
       The ability to read basic attributes (non-ACLs)
       of a file.  On a UNIX system, basic attributes
       can be thought of as the stat-level attributes.
       Allowing this access mask bit would mean that the
       entity can execute "ls -l" and stat.  If a
       READDIR operation requests attributes, this mask
       must be allowed for the READDIR to succeed.<a href="#section-6.4.3-24.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-25">ACE4_WRITE_ATTRIBUTES<a href="#section-6.4.3-25" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-26.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-26.1.1">
                <dt id="section-6.4.3-26.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-26.1.1.2">
                  <p id="section-6.4.3-26.1.1.2.1">SETATTR of time_access_set, time_backup,<a href="#section-6.4.3-26.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-26.1.1.2.2">time_create, time_modify_set, mimetype, hidden, system<a href="#section-6.4.3-26.1.1.2.2" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-26.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-26.1.1.4">
       Permission to change the times associated with a
       file or directory to an arbitrary value.  Also
       permission to change the mimetype, hidden, and
       system attributes.  A user having
       ACE4_WRITE_DATA or ACE4_WRITE_ATTRIBUTES will be
       allowed to set the times associated with a file
       to the current server time.<a href="#section-6.4.3-26.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-27">ACE4_WRITE_RETENTION<a href="#section-6.4.3-27" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-28.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-28.1.1">
                <dt id="section-6.4.3-28.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-28.1.1.2">SETATTR of retention_set, retentevt_set.<a href="#section-6.4.3-28.1.1.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-28.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-28.1.1.4">
       Permission to modify the durations of event and
       non-event-based retention. Also permission to
       enable event and non-event-based retention. A
       server <span class="bcp14">MAY</span> behave such that setting
       ACE4_WRITE_ATTRIBUTES allows
       ACE4_WRITE_RETENTION.<a href="#section-6.4.3-28.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-29">ACE4_WRITE_RETENTION_HOLD<a href="#section-6.4.3-29" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-30.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-30.1.1">
                <dt id="section-6.4.3-30.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-30.1.1.2">SETATTR of retention_hold.<a href="#section-6.4.3-30.1.1.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-30.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-30.1.1.4">
       Permission to modify the administration
       retention holds.  A server <span class="bcp14">MAY</span> map
       ACE4_WRITE_ATTRIBUTES to
       ACE_WRITE_RETENTION_HOLD.<a href="#section-6.4.3-30.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-31">ACE4_DELETE<a href="#section-6.4.3-31" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-32.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-32.1.1">
                <dt id="section-6.4.3-32.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-32.1.1.2">REMOVE<a href="#section-6.4.3-32.1.1.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-32.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-32.1.1.4">
       Permission to delete the
       file or directory. 

       See <a href="#delete-delete_child" class="xref">Section 6.4.4</a>
       for information on ACE4_DELETE and
       ACE4_DELETE_CHILD interact.<a href="#section-6.4.3-32.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-33">ACE4_READ_ACL<a href="#section-6.4.3-33" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-34.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-34.1.1">
                <dt id="section-6.4.3-34.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-34.1.1.2">
                  <p id="section-6.4.3-34.1.1.2.1">GETATTR of acl, dacl, or sacl<a href="#section-6.4.3-34.1.1.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-34.1.1.2.2">NVERIFY<a href="#section-6.4.3-34.1.1.2.2" class="pilcrow">¶</a></p>
<p id="section-6.4.3-34.1.1.2.3">VERIFY<a href="#section-6.4.3-34.1.1.2.3" class="pilcrow">¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-34.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-34.1.1.4">
       Permission to read the ACL.<a href="#section-6.4.3-34.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-35">ACE4_WRITE_ACL<a href="#section-6.4.3-35" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-36.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-36.1.1">
                <dt id="section-6.4.3-36.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-36.1.1.2">SETATTR of acl and mode<a href="#section-6.4.3-36.1.1.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-36.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-36.1.1.4">Permission to write the acl and mode attributes.<a href="#section-6.4.3-36.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-37">ACE4_WRITE_OWNER<a href="#section-6.4.3-37" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-38.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-38.1.1">
                <dt id="section-6.4.3-38.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-38.1.1.2">SETATTR of owner and owner_group<a href="#section-6.4.3-38.1.1.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-38.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-38.1.1.4">
       Permission to write the owner and owner_group
       attributes.  On UNIX systems, this is the
       ability to execute chown() and chgrp().<a href="#section-6.4.3-38.1.1.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-39">ACE4_SYNCHRONIZE<a href="#section-6.4.3-39" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.4.3-40.1">
              <span class="break"></span><dl class="dlNewline" id="section-6.4.3-40.1.1">
                <dt id="section-6.4.3-40.1.1.1">Operation(s) affected:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-40.1.1.2">NONE<a href="#section-6.4.3-40.1.1.2" class="pilcrow">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.4.3-40.1.1.3">Discussion:</dt>
                <dd style="margin-left: 1.5em" id="section-6.4.3-40.1.1.4">
                  <p id="section-6.4.3-40.1.1.4.1">
       Permission to use the file object as a
       synchronization primitive for interprocess
       communication. This permission is not enforced
       or interpreted by the NFSv4.1 server on behalf of
       the client.<a href="#section-6.4.3-40.1.1.4.1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-40.1.1.4.2">
                      Typically, the ACE4_SYNCHRONIZE permission is
                      only meaningful on local file systems, i.e.,
                      file systems not accessed via NFSv4.1. The reason
                      that the permission bit exists is that some operating
                      environments, such as Windows, use ACE4_SYNCHRONIZE.<a href="#section-6.4.3-40.1.1.4.2" class="pilcrow">¶</a></p>
<p id="section-6.4.3-40.1.1.4.3">
                      For example, if a client copies a file that has
                      ACE4_SYNCHRONIZE set from a local file system to
                      an NFSv4.1 server, and then later copies the file
                      from the NFSv4.1 server to a local file system,
                      it is likely that if ACE4_SYNCHRONIZE was set
                      in the original file, the client will want it
                      set in the second copy.  The first copy will not
                      have the permission set unless the NFSv4.1 server
                      has the means to set the ACE4_SYNCHRONIZE bit. The
                      second copy will not have the permission set unless
                      the NFSv4.1 server has the means to retrieve the
                      ACE4_SYNCHRONIZE bit.<a href="#section-6.4.3-40.1.1.4.3" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</li>
          </ul>
<p id="section-6.4.3-41">
              Server implementations need not provide the granularity
              of control that is implied by this list of masks. For
              example, POSIX-based systems might not distinguish
              ACE4_APPEND_DATA (the ability to append to a file) from
              ACE4_WRITE_DATA (the ability to modify existing
              contents); both masks would be tied to a single "write"
              permission bit. When such a server returns attributes to the
              client that contain such masks, it would show
       ACE4_APPEND_DATA and ACE4_WRITE_DATA if and only if the
       the write permission bit is enabled.<a href="#section-6.4.3-41" class="pilcrow">¶</a></p>
<p id="section-6.4.3-42">
              If a server receives a SETATTR request that it cannot
              accurately implement, it should err in the direction of
              more restricted access, except in the previously
              discussed cases of execute and read. For example,
              suppose a server cannot distinguish overwriting data
              from appending new data, as described in the previous
              paragraph.  If a client submits an ALLOW ACE where
              ACE4_APPEND_DATA is set but ACE4_WRITE_DATA is not (or
              vice versa), the server should either turn off
              ACE4_APPEND_DATA or reject the request with
              NFS4ERR_ATTRNOTSUPP.<a href="#section-6.4.3-42" class="pilcrow">¶</a></p>
</section>
<div id="delete-delete_child">
<section id="section-6.4.4">
          <h4 id="name-ace4_delete-vs-ace4_delete_">
<a href="#section-6.4.4" class="section-number selfRef">6.4.4. </a><a href="#name-ace4_delete-vs-ace4_delete_" class="section-name selfRef">ACE4_DELETE vs. ACE4_DELETE_CHILD</a>
          </h4>
<p id="section-6.4.4-1">
              Two access mask bits govern the ability to delete a
              directory entry: ACE4_DELETE on the object
              itself (the "target") and ACE4_DELETE_CHILD on
              the containing directory (the "parent").<a href="#section-6.4.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4.4-2">
              Many systems also take the "sticky bit" (MODE4_SVTX)
              on a directory to allow unlink only to a user that
              owns either the target or the parent; on some
              such systems the decision also depends on
              whether the target is writable.<a href="#section-6.4.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4.4-3">
              Servers <span class="bcp14">SHOULD</span> allow unlink if either ACE4_DELETE
              is permitted on the target, or ACE4_DELETE_CHILD is
              permitted on the parent.  (Note that this is
              true even if the parent or target explicitly
              denies one of these permissions.)<a href="#section-6.4.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4.4-4">
              If the ACLs in question neither explicitly ALLOW
              nor DENY either of the above, and if MODE4_SVTX is
              not set on the parent, then the server <span class="bcp14">SHOULD</span> allow
              the removal if and only if ACE4_ADD_FILE is permitted.
              In the case where MODE4_SVTX is set, the server
              may also require the remover to own either the parent
              or the target, or may require the target to be
              writable.<a href="#section-6.4.4-4" class="pilcrow">¶</a></p>
<p id="section-6.4.4-5">
              This allows servers to support something close to
              traditional UNIX-like semantics, with ACE4_ADD_FILE
              taking the place of the write bit.<a href="#section-6.4.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="aceflag">
<section id="section-6.4.5">
          <h4 id="name-ace-flag">
<a href="#section-6.4.5" class="section-number selfRef">6.4.5. </a><a href="#name-ace-flag" class="section-name selfRef">ACE flag</a>
          </h4>
<p id="section-6.4.5-1">
            The bitmask constants used for the flag field are as
            follows:<a href="#section-6.4.5-1" class="pilcrow">¶</a></p>
<div id="section-6.4.5-2">
<pre class="sourcecode lang-xdr">
const ACE4_FILE_INHERIT_ACE             = 0x00000001;
const ACE4_DIRECTORY_INHERIT_ACE        = 0x00000002;
const ACE4_NO_PROPAGATE_INHERIT_ACE     = 0x00000004;
const ACE4_INHERIT_ONLY_ACE             = 0x00000008;
const ACE4_SUCCESSFUL_ACCESS_ACE_FLAG   = 0x00000010;
const ACE4_FAILED_ACCESS_ACE_FLAG       = 0x00000020;
const ACE4_IDENTIFIER_GROUP             = 0x00000040;
const ACE4_INHERITED_ACE                = 0x00000080;
</pre><a href="#section-6.4.5-2" class="pilcrow">¶</a>
</div>
<p id="section-6.4.5-3">

            A server need not support any of these flags. If the
            server supports flags that are similar to, but not
            exactly the same as, these flags, the implementation
            may define a mapping between the protocol-defined
            flags and the implementation-defined flags.<a href="#section-6.4.5-3" class="pilcrow">¶</a></p>
<p id="section-6.4.5-4">
            For example, suppose a client tries to set an ACE with
            ACE4_FILE_INHERIT_ACE set but not
            ACE4_DIRECTORY_INHERIT_ACE. If the server does not
            support any form of ACL inheritance, the server should
            reject the request with NFS4ERR_ATTRNOTSUPP. If the
            server supports a single "inherit ACE" flag that
            applies to both files and directories, the server may
            reject the request (i.e., requiring the client to set
            both the file and directory inheritance flags). The
            server may also accept the request and silently turn
            on the ACE4_DIRECTORY_INHERIT_ACE flag.<a href="#section-6.4.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.4.6">
          <h4 id="name-details-regarding-ace-flag-">
<a href="#section-6.4.6" class="section-number selfRef">6.4.6. </a><a href="#name-details-regarding-ace-flag-" class="section-name selfRef">Details Regarding ACE Flag Bits</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-6.4.6-1">
            <dt id="section-6.4.6-1.1">ACE4_FILE_INHERIT_ACE</dt>
            <dd style="margin-left: 1.5em" id="section-6.4.6-1.2">
                  Any non-directory file in any
                  sub-directory will get this ACE
                  inherited.<a href="#section-6.4.6-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.6-1.3">ACE4_DIRECTORY_INHERIT_ACE</dt>
            <dd style="margin-left: 1.5em" id="section-6.4.6-1.4">
              <p id="section-6.4.6-1.4.1">
                  Can be placed on a directory and indicates
                  that this ACE should be added to each new
                  directory created.<a href="#section-6.4.6-1.4.1" class="pilcrow">¶</a></p>
<p id="section-6.4.6-1.4.2">
                  If this flag is set in an ACE in an ACL
                  attribute to be set on a non-directory
                  file system object, the operation
                  attempting to set the ACL <span class="bcp14">SHOULD</span> fail
                  with NFS4ERR_ATTRNOTSUPP.<a href="#section-6.4.6-1.4.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.6-1.5">ACE4_NO_PROPAGATE_INHERIT_ACE</dt>
            <dd style="margin-left: 1.5em" id="section-6.4.6-1.6">
                  Can be placed on a directory.  This flag
                  tells the server that inheritance of this
                  ACE should stop at newly created child
                  directories.<a href="#section-6.4.6-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.6-1.7">ACE4_INHERIT_ONLY_ACE</dt>
            <dd style="margin-left: 1.5em" id="section-6.4.6-1.8">
              <p id="section-6.4.6-1.8.1">
                  Can be placed on a directory but does not
                  apply to the directory; ALLOW and DENY ACEs
                  with this bit set do not affect access to
                  the directory, and AUDIT and ALARM ACEs
                  with this bit set do not trigger log or
                  alarm events.  Such ACEs only take effect
                  once they are applied (with this bit
                  cleared) to newly created files and
                  directories as specified by the
                  ACE4_FILE_INHERIT_ACE and ACE4_DIRECTORY_INHERIT_ACE
                  flags.<a href="#section-6.4.6-1.8.1" class="pilcrow">¶</a></p>
<p id="section-6.4.6-1.8.2">
                  If this flag is present on an ACE, but
                  neither ACE4_DIRECTORY_INHERIT_ACE nor
                  ACE4_FILE_INHERIT_ACE is present, then
                  an operation attempting to set such an
                  attribute <span class="bcp14">SHOULD</span> fail with
                  NFS4ERR_ATTRNOTSUPP.<a href="#section-6.4.6-1.8.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.6-1.9">ACE4_SUCCESSFUL_ACCESS_ACE_FLAG and 
                ACE4_FAILED_ACCESS_ACE_FLAG</dt>
            <dd style="margin-left: 1.5em" id="section-6.4.6-1.10">
              <p id="section-6.4.6-1.10.1">
                  The ACE4_SUCCESSFUL_ACCESS_ACE_FLAG
                  (SUCCESS) and ACE4_FAILED_ACCESS_ACE_FLAG
                  (FAILED) flag bits may be set only on
                  ACE4_SYSTEM_AUDIT_ACE_TYPE (AUDIT) and
                  ACE4_SYSTEM_ALARM_ACE_TYPE (ALARM) ACE
                  types. If during the processing of the
                  file's ACL, the server encounters an AUDIT
                  or ALARM ACE that matches the principal
                  attempting the OPEN, the server notes that
                  fact, and the presence, if any, of the
                  SUCCESS and FAILED flags encountered in
                  the AUDIT or ALARM ACE. Once the server
                  completes the ACL processing, it then
                  notes if the operation succeeded or
                  failed. If the operation succeeded, and if
                  the SUCCESS flag was set for a matching
                  AUDIT or ALARM ACE, then the appropriate
                  AUDIT or ALARM event occurs. If the
                  operation failed, and if the FAILED flag
                  was set for the matching AUDIT or ALARM 
                  ACE, then the appropriate AUDIT or ALARM
                  event occurs.  Either or both of the
                  SUCCESS or FAILED can be set, but if
                  neither is set, the AUDIT or ALARM ACE is
                  not useful.<a href="#section-6.4.6-1.10.1" class="pilcrow">¶</a></p>
<p id="section-6.4.6-1.10.2">
                  The previously described processing
                  applies to ACCESS operations even when
                  they return NFS4_OK.  For the purposes of
                  AUDIT and ALARM, we consider an ACCESS
                  operation to be a "failure" if it fails
                  to return a bit that was requested and
   supported.<a href="#section-6.4.6-1.10.2" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.6-1.11">ACE4_IDENTIFIER_GROUP</dt>
            <dd style="margin-left: 1.5em" id="section-6.4.6-1.12">
                  Indicates that the "who" refers to a GROUP
                  as defined under UNIX or a GROUP ACCOUNT
                  as defined under Windows. Clients and
                  servers <span class="bcp14">MUST</span> ignore the
                  ACE4_IDENTIFIER_GROUP flag on ACEs with a
                  who value equal to one of the special
                  identifiers outlined in
                  <a href="#acewho" class="xref">Section 6.4.7</a>.<a href="#section-6.4.6-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.6-1.13">ACE4_INHERITED_ACE</dt>
            <dd style="margin-left: 1.5em" id="section-6.4.6-1.14">
                  Indicates that this ACE is inherited from
                  a parent directory.  A server that supports
                  automatic inheritance will place
                  this flag on any ACEs inherited from the
                  parent directory when creating a new
                  object.  Client applications will use this
                  to perform automatic inheritance.
                  Clients and servers <span class="bcp14">MUST</span> clear this
                  bit in the acl attribute; it may only
                  be used in the dacl and sacl attributes.<a href="#section-6.4.6-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<div id="acewho">
<section id="section-6.4.7">
          <h4 id="name-ace-who">
<a href="#section-6.4.7" class="section-number selfRef">6.4.7. </a><a href="#name-ace-who" class="section-name selfRef">ACE Who</a>
          </h4>
<p id="section-6.4.7-1">
            The "who" field of an ACE is an identifier that
            specifies the principal or principals to whom the ACE
            applies. It may refer to a user or a group, with the flag
            bit ACE4_IDENTIFIER_GROUP specifying which.<a href="#section-6.4.7-1" class="pilcrow">¶</a></p>
<p id="section-6.4.7-2">
            There are several special identifiers that need to be
            understood universally, rather than in the context of a
            particular DNS domain. Some of these identifiers cannot be
            understood when an NFS client accesses the server, but
            have meaning when a local process accesses the file. The
            ability to display and modify these permissions is
            permitted over NFS, even if none of the access methods on
            the server understands the identifiers.<a href="#section-6.4.7-2" class="pilcrow">¶</a></p>
<div id="specialwho">
<table class="center" id="table-2">
            <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Who</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">OWNER</td>
                <td class="text-left" rowspan="1" colspan="1">
              The owner of the file.
            </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">GROUP</td>
                <td class="text-left" rowspan="1" colspan="1">
              The group associated with the file.
            </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">EVERYONE</td>
                <td class="text-left" rowspan="1" colspan="1">
              The world, including the owner and owning group.
            </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">INTERACTIVE</td>
                <td class="text-left" rowspan="1" colspan="1">
              Accessed from an interactive terminal.
            </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">NETWORK</td>
                <td class="text-left" rowspan="1" colspan="1">
              Accessed via the network.
            </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">DIALUP</td>
                <td class="text-left" rowspan="1" colspan="1">
              Accessed as a dialup user to the server.
            </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">BATCH</td>
                <td class="text-left" rowspan="1" colspan="1">
              Accessed from a batch job.
            </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ANONYMOUS</td>
                <td class="text-left" rowspan="1" colspan="1">
              Accessed without any authentication.
            </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">AUTHENTICATED</td>
                <td class="text-left" rowspan="1" colspan="1">
              Any authenticated user (opposite of
              ANONYMOUS).
            </td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SERVICE</td>
                <td class="text-left" rowspan="1" colspan="1">
              Access from a system service.
            </td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-6.4.7-4">
            To avoid conflict, these special identifiers are
            distinguished by an appended "@" and should appear in the
            form "xxxx@" (with no domain name after the "@"), for
            example, ANONYMOUS@.<a href="#section-6.4.7-4" class="pilcrow">¶</a></p>
<p id="section-6.4.7-5">
            The ACE4_IDENTIFIER_GROUP flag <span class="bcp14">MUST</span> be ignored on
            entries with these special identifiers.  When encoding
            entries with these special identifiers, the
            ACE4_IDENTIFIER_GROUP flag <span class="bcp14">SHOULD</span> be set to zero.<a href="#section-6.4.7-5" class="pilcrow">¶</a></p>
<p id="section-6.4.7-6">
       [working group input needed]:  I don't understand what might be
       valid reasons to ignore this.  Would "<span class="bcp14">MUST</span>" be
       appropriate here?<a href="#section-6.4.7-6" class="pilcrow">¶</a></p>
<p id="section-6.4.7-7">
              It is important to note that "EVERYONE@" is not
              equivalent to the UNIX "other" entity. This is
              because, by definition, UNIX "other" does not include
              the owner or owning group of a file. "EVERYONE@" means
              literally everyone, including the owner or owning
              group.<a href="#section-6.4.7-7" class="pilcrow">¶</a></p>
<p id="section-6.4.7-8"> 
 [working group input needed]:  Some of these require that
 changes be made as discussed below:<a href="#section-6.4.7-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4.7-9.1">
     For "INTERACTIVE", "NETWORK", "DIALUP", "BATCH",
             and "SERVICE" it needs to be specified that server's
     ability to make these distinctions is limited, making
     their use where security is an issue quite problematic.<a href="#section-6.4.7-9.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.4.7-9.2">
              <p id="section-6.4.7-9.2.1">
     For "ANONYMOUS", clearly requests using AUTH_NONE fit
     but what else?<a href="#section-6.4.7-9.2.1" class="pilcrow">¶</a></p>
<p id="section-6.4.7-9.2.2">
     Request by nobody and by users root-squashed to nobody
     are probably OK, although you could argue about the case
     of a user "nobody" authenticated by RPCSEC_GSS&gt;<a href="#section-6.4.7-9.2.2" class="pilcrow">¶</a></p>
<p id="section-6.4.7-9.2.3">
   ON a more contentious note, I would argue that users
   "authenticated" using AUTH_SYS, in the clear, without
   client-peer authentication fit here, but we need to get
   to consensus on this point.<a href="#section-6.4.7-9.2.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.4.7-9.3">
     Issues regarding "AUTHENTICATED" will be the mirror
     image of those for "ANONYMOUS".<a href="#section-6.4.7-9.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="auto_inherit">
<section id="section-6.4.8">
          <h4 id="name-automatic-inheritance-featu">
<a href="#section-6.4.8" class="section-number selfRef">6.4.8. </a><a href="#name-automatic-inheritance-featu" class="section-name selfRef">Automatic Inheritance Features</a>
          </h4>
<p id="section-6.4.8-1">
            The acl attribute consists only of an array of ACEs, but
            the <span><a href="#attrdef_sacl" class="xref">sacl</a> (<a href="#attrdef_sacl" class="xref">Section 6.6</a>)</span>
            and <span><a href="#attrdef_dacl" class="xref">dacl</a> (<a href="#attrdef_dacl" class="xref">Section 6.5</a>)</span> attributes
            also include an additional flag field.<a href="#section-6.4.8-1" class="pilcrow">¶</a></p>
<div id="section-6.4.8-2">
<pre class="sourcecode lang-xdr">
struct nfsacl41 {
        aclflag4        na41_flag;
        nfsace4         na41_aces&lt;&gt;;
};
</pre><a href="#section-6.4.8-2" class="pilcrow">¶</a>
</div>
<p id="section-6.4.8-3">

            The flag field
            applies to the entire sacl or dacl; three flag values are
            defined:<a href="#section-6.4.8-3" class="pilcrow">¶</a></p>
<div id="section-6.4.8-4">
<pre class="sourcecode lang-xdr">
const ACL4_AUTO_INHERIT         = 0x00000001;
const ACL4_PROTECTED            = 0x00000002;
const ACL4_DEFAULTED            = 0x00000004;
</pre><a href="#section-6.4.8-4" class="pilcrow">¶</a>
</div>
<p id="section-6.4.8-5">

            and all other bits must be cleared.  The
            ACE4_INHERITED_ACE flag may be set in the ACEs of the sacl
            or dacl (whereas it must always be cleared in the acl).<a href="#section-6.4.8-5" class="pilcrow">¶</a></p>
<p id="section-6.4.8-6">
            Together these features allow a server to support automatic
            inheritance, which we now explain in more detail.<a href="#section-6.4.8-6" class="pilcrow">¶</a></p>
<p id="section-6.4.8-7">
            Inheritable ACEs are normally inherited by child objects only
            at the time that the child objects are created; later
            modifications to inheritable ACEs do not result in
            modifications to inherited ACEs on descendants.<a href="#section-6.4.8-7" class="pilcrow">¶</a></p>
<p id="section-6.4.8-8">
            However, the dacl and sacl provide an <span class="bcp14">OPTIONAL</span> mechanism
            that allows a client application to propagate changes to
            inheritable ACEs to an entire directory hierarchy.<a href="#section-6.4.8-8" class="pilcrow">¶</a></p>
<p id="section-6.4.8-9">
            A server that supports this feature performs inheritance at object
            creation time in the normal way, and <span class="bcp14">SHOULD</span>  set the
            ACE4_INHERITED_ACE flag on any inherited ACEs as they are
            added to the new object.<a href="#section-6.4.8-9" class="pilcrow">¶</a></p>
<p id="section-6.4.8-10">
            A client application such as an ACL editor may then propagate
            changes to inheritable ACEs on a directory by recursively
            traversing that directory's descendants and modifying each ACL
            encountered to remove any ACEs with the ACE4_INHERITED_ACE flag
            and to replace them by the new inheritable ACEs (also with the
            ACE4_INHERITED_ACE flag set).  It uses the existing ACE
            inheritance flags in the obvious way to decide which ACEs to
            propagate.  (Note that it may encounter further inheritable
            ACEs when descending the directory hierarchy and that those
            will also need to be taken into account when propagating
            inheritable ACEs to further descendants.)<a href="#section-6.4.8-10" class="pilcrow">¶</a></p>
<p id="section-6.4.8-11">
            The reach of this propagation may be limited in two ways:
            first, automatic inheritance is not performed from any
            directory ACL that has the ACL4_AUTO_INHERIT flag
            cleared; and second, automatic inheritance stops wherever
            an ACL with the ACL4_PROTECTED flag is set, preventing
            modification of that ACL and also (if the ACL is set on
            a directory) of the ACL on any of the object's descendants.<a href="#section-6.4.8-11" class="pilcrow">¶</a></p>
<p id="section-6.4.8-12">
            This propagation is performed independently for the sacl
            and the dacl attributes; thus, the ACL4_AUTO_INHERIT and
            ACL4_PROTECTED flags may be independently set for the sacl
            and the dacl, and propagation of one type of acl may continue
            down a hierarchy even where propagation of the other acl has
            stopped.<a href="#section-6.4.8-12" class="pilcrow">¶</a></p>
<p id="section-6.4.8-13">
            New objects should be created with a dacl and a sacl that
            both have the ACL4_PROTECTED flag cleared and the
            ACL4_AUTO_INHERIT flag set to the same value as that on,
            respectively, the sacl or dacl of the parent object.<a href="#section-6.4.8-13" class="pilcrow">¶</a></p>
<p id="section-6.4.8-14">
            Both the dacl and sacl attributes are Recommended, and a server
            may support one without supporting the other.<a href="#section-6.4.8-14" class="pilcrow">¶</a></p>
<p id="section-6.4.8-15">
            A server that supports both the old acl attribute and
            one or both of the new dacl or sacl attributes must do so
            in such a way as to keep all three attributes consistent
            with each other.  Thus, the ACEs reported in the acl attribute
            should be the union of the ACEs reported in the dacl and
            sacl attributes, except that the ACE4_INHERITED_ACE flag must
            be cleared from the ACEs in the acl.  And of course a
            client that queries only the acl will be unable to determine
            the values of the sacl or dacl flag fields.<a href="#section-6.4.8-15" class="pilcrow">¶</a></p>
<p id="section-6.4.8-16">
            When a client performs a SETATTR for the acl attribute,
            the server <span class="bcp14">SHOULD</span> set the ACL4_PROTECTED flag to true on
            both the sacl and the dacl.  By using the acl attribute,
            as opposed to the dacl or sacl attributes, the client signals
            that it may not understand automatic inheritance, and thus
            cannot be trusted to set an ACL for which automatic
            inheritance would make sense.<a href="#section-6.4.8-16" class="pilcrow">¶</a></p>
<p id="section-6.4.8-17">
            When a client application queries an ACL, modifies it, and sets
            it again, it should leave any ACEs marked with
            ACE4_INHERITED_ACE unchanged, in their original order, at the
            end of the ACL.  If the application is unable to do this, it
            should set the ACL4_PROTECTED flag.  This behavior
            is not enforced by servers, but violations of this rule may
            lead to unexpected results when applications perform automatic
            inheritance.<a href="#section-6.4.8-17" class="pilcrow">¶</a></p>
<p id="section-6.4.8-18">
            If a server also supports the mode attribute, it <span class="bcp14">SHOULD</span> set the
            mode in such a way that leaves inherited ACEs unchanged, in
            their original order, at the end of the ACL.  If it is unable
            to do so, it <span class="bcp14">SHOULD</span> set the ACL4_PROTECTED flag on the file's
            dacl.<a href="#section-6.4.8-18" class="pilcrow">¶</a></p>
<p id="section-6.4.8-19">Finally, in the case where the request that creates a new file
            or directory does not also set permissions for that file or
            directory, and there are also no ACEs to inherit from the
            parent's directory, then the server's choice of ACL for the new
            object is implementation-dependent.  In this case, the server
            <span class="bcp14">SHOULD</span> set the ACL4_DEFAULTED flag on the ACL it chooses for
            the new object.  An application performing automatic
            inheritance takes the ACL4_DEFAULTED flag as a sign that the
            ACL should be completely replaced by one generated using the
            automatic inheritance rules.<a href="#section-6.4.8-19" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="attrdef_dacl">
<section id="section-6.5">
        <h3 id="name-v41-attribute-58-dacl">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-v41-attribute-58-dacl" class="section-name selfRef">V4.1 Attribute 58: dacl</a>
        </h3>
<p id="section-6.5-1">
          The dacl attribute is like the acl attribute,
          but dacl allows 
          only ALLOW and DENY ACEs.  The dacl
          attribute supports automatic inheritance (see
          <a href="#auto_inherit" class="xref">Section 6.4.8</a>).<a href="#section-6.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attrdef_sacl">
<section id="section-6.6">
        <h3 id="name-v41-attribute-59-sacl">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-v41-attribute-59-sacl" class="section-name selfRef">V4.1 Attribute 59: sacl</a>
        </h3>
<p id="section-6.6-1">
          The sacl attribute is like the acl attribute,
          but sacl allows
          only AUDIT and ALARM ACEs. The sacl
          attribute supports automatic inheritance (see
          <a href="#auto_inherit" class="xref">Section 6.4.8</a>).<a href="#section-6.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AUTHCOMM">
<section id="section-7">
      <h2 id="name-common-considerations-for-b">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-common-considerations-for-b" class="section-name selfRef">Common Considerations for Both File access Models</a>
      </h2>
<p id="section-7-1">
     [Important structural change to be noted]: This section is
     derived from Section 6.3 of 8881, entitled "Common Methods.
     However, its content is
     different because it has been rewritten to deal with issues
     common to both file access models, which now appears to have
     not been the original intention.  Nevertheless, the following
     changes have been made:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">
          <p id="section-7-2.1.1">
       The section "Server Considerations" has been revised  to
       deal with both the mode and acl attributes, since the points
       being made apply, in almost all cases, to both attributes.<a href="#section-7-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-2.2">
          <p id="section-7-2.2.1">
       The section "Client Considerations" has been heavily revised,
       since what had been there did not make any sense to me.<a href="#section-7-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-2.3">
          <p id="section-7-2.3.1">
       The section "Computing a Mode Attribute from an ACL" has been
       moved to <a href="#AUTH-comb-computemode" class="xref">Section 8.2.1</a> since it deals with the
       co-ordination of  the posix and acl authorization models.<a href="#section-7-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="AUTHCOMM-server">
<section id="section-7.1">
        <h3 id="name-server-considerations">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-server-considerations" class="section-name selfRef">Server Considerations</a>
        </h3>
<p id="section-7.1-1"> 
       The server uses the  mode attribute or the acl attribute applying
       the algorithm described in
       <a href="#AUTHFA-acl-ace" class="xref">Section 17.1</a> to determine whether an ACL
       allows access to an object.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">
       However, these attributes might not be
       the sole determiner of access.  For example:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-3.1">
                In the case of a file system exported as read-only,
                the server will deny write access even though
                an object's file access attributes would  grant it.<a href="#section-7.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.2">
                Server implementations <span class="bcp14">MAY</span> grant ACE4_WRITE_ACL
                and ACE4_READ_ACL permissions to prevent
                a situation from arising in which there is no valid
                way to ever modify the ACL.<a href="#section-7.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.3">
                All servers will allow a user the ability to read
                the data of the file when only the execute
                permission is granted (e.g., if the ACL denies the
                user the ACE4_READ_DATA access and allows the user
                ACE4_EXECUTE, the server will allow the user to
                read the data of the file).<a href="#section-7.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.4">
                Many servers implement owner-override semantics in
                which the owner of the object is allowed to
                override accesses that are denied by the ACL.
                This may be helpful, for example, to allow users
                continued access to open files on which the
                permissions have changed.<a href="#section-7.1-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.5">
                Many servers provide for the existence of a
                "superuser" that has privileges beyond
                an ordinary user.  The superuser may be able
                to read or write data or metadata in ways that would
                not be permitted by the ACL or mode attributes.<a href="#section-7.1-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.6">
                A retention attribute might also block access otherwise
                allowed by ACLs (see Section 5.13 of
 <span>[<a href="#RFC8881" class="xref">8</a>]</span>).<a href="#section-7.1-3.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="AUTHCOMM-client">
<section id="section-7.2">
        <h3 id="name-client-considerations">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-client-considerations" class="section-name selfRef">Client Considerations</a>
        </h3>
<p id="section-7.2-1">
              Clients <span class="bcp14">SHOULD NOT</span>
       do their own access checks based on
            their interpretation of the ACL, but rather use the OPEN and
            ACCESS operations to do access checks. This allows the
            client to act on the results of having the server
            determine whether or not access should be granted based on
            its interpretation of the ACL.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">
       [Working group discussion needed]:  With regard to the use of
       "<span class="bcp14">SHOULD NOT</span>" in the paragraph above, it is not
       clear what might be valid reasons to bypass this recommendation.
       Perhaps "<span class="bcp14">MUST NOT</span>" or "should not" would be
       more appropriate.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">
            Clients must be aware of situations in which an object's
            ACL will define a certain access even though the server
            will not enforce it. In general, but especially in these
            situations, the client needs to do its part in the
            enforcement of access as defined by the ACL.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">
       [Working group input needed]:  Despite what is said later,
       the only such case I know of is the use of READ and EXECUTE
       where the client, but not the server, has any means of
       distinguishing these.   don't know of any others.  If there were,
       how could ACCESS or OPEN be used to verify access?<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">
       To do this,
            the client <span class="bcp14">MAY</span> send the appropriate ACCESS operation
            prior to servicing the request of the user or application
            in order to determine whether the user or application
            should be granted the access requested.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">
     For examples in
            which the ACL may define accesses that the server doesn't
            enforce, see <a href="#AUTHCOMM-server" class="xref">Section 7.1</a>.<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<p id="section-7.2-7">
       [Working group discussion needed]:  The sentence above is
       clearly wrong since that section is about enforcement the
       server does do.  Sigh!<a href="#section-7.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AUTH-comb">
<section id="section-8">
      <h2 id="name-combining-authorization-mod">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-combining-authorization-mod" class="section-name selfRef">Combining Authorization Models</a>
      </h2>
<p id="section-8-1">
      [To be checked]:  The section on computing mode from ACL in
      RFC3530 is quite similar to that in RFC8881.  If they are
      essentially  identical, <a href="#AUTH-comb-computemode" class="xref">Section 8.2.1</a>
      could be
      moved out of <a href="#AUTH-comb-v41" class="xref">Section 8.2</a> and apply to all
      minor versions :-).  In addition, there may be
      additional material that could be generalized in this way.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="AUTH-comb-v40">
<section id="section-8.1">
        <h3 id="name-combined-authorization-mode">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-combined-authorization-mode" class="section-name selfRef">Combined Authorization Models for V4.0</a>
        </h3>
<p id="section-8.1-1">
       V4.0 servers that support both the mode and acl attributes, like
       servers for other minor versions, have to appropriately
       co-ordinate the values.  Because much of the material in
       <a href="#AUTH-comb-v41" class="xref">Section 8.2</a> does not apply to v4.0, the
       server is relatively free about how it does this.  Nevertheless,
       that material is one useful approach and v4.0 implementers
       may want to consult it, even though the requirements in it do not
       apply and the recommendations have no normative force.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">
       One likely source of a need for different treatment is the
       absence of a set_mode_masked attribute in v4.0.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">
       Clients need to be aware that the v4.1 handling may nor may not
       be adopted
       by the server and that the client needs to adapt accordingly.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTH-comb-v41">
<section id="section-8.2">
        <h3 id="name-combined-authorization-model">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-combined-authorization-model" class="section-name selfRef">Combined Authorization Model for V4.1 and Beyond</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-8.2-1.1">
            On servers that support both the mode and the acl or
            dacl attributes, the server must keep the two consistent
            with each other.  The value of the mode attribute (with
            the exception of the three high-order bits described in
            <a href="#AUTHFA-posix-mode" class="xref">Section 6.3.1</a>) must be determined entirely
            by the value of the ACL, so that use of the mode is
            never required for anything other than setting the
            three high-order bits.  See Sections
     <a href="#AUTH-comb-setmode" class="xref">8.2.4</a> through
     <a href="#AUTH-comb-setboth" class="xref">8.2.6</a> 
            for detailed requirements.<a href="#section-8.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.2-1.2">
            When a mode attribute is set on an object, the ACL
            attributes may need to be modified in order to not conflict
            with the new mode. In such cases, it is desirable that the
            ACL keep as much information as possible. This includes
            information about inheritance, AUDIT and ALARM ACEs, and
            permissions granted and denied that do not conflict with
            the new mode.<a href="#section-8.2-1.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.2-2">
        The server that supports both mode and ACL must take care to
        synchronize the MODE4_*USR, MODE4_*GRP, and MODE4_*OTH bits with
        the ACEs that have respective who fields of "OWNER@", "GROUP@",
        and "EVERYONE@". This way, the client can see if semantically equivalent
        access permissions exist whether the client asks for the owner,
        owner_group, and mode attributes or for just the ACL.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">
          In this section, much depends on the method in
   specified <a href="#AUTH-comb-computemode" class="xref">Section 8.2.1</a>.
   Many requirements refer to this section.
          It should be noted that the methods have behaviors specified with
          "<span class="bcp14">SHOULD</span>" and that alternate approaches are discussed
   in <a href="#AUTH-comb-computealt" class="xref">Section 8.2.2</a>.  This is intentional,
   to avoid invalidating
        existing implementations that compute the mode according to the
        withdrawn POSIX ACL draft (1003.1e draft 17), rather than by
        actual permissions on owner, group, and other.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">
   [Working group discussion needed]:  Given the mixture of RFC2219
   terms, I think all of them in <a href="#AUTH-comb" class="xref">Section 8</a> need
   review.  Further, given the effort that has
   gone into <a href="#AUTH-comb" class="xref">Section 8</a>, to accommodate these
   implementations of a draft that was withdrawn decades ago.
   The idea of trying to make mode and acl match is undercut
   when there are different valid ways of computing the mode.  There
   shouldn't be.   To specify one way to do this is necessary to
   accomplish the goal here and to do so would not "invalidate"
   anything.  Rather, it would establish, correctly, that such
   implementations are not implementations of the NFSv4 ACL model,
   but of the withdrawn POSIX ACL draft.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<div id="AUTH-comb-computemode">
<section id="section-8.2.1">
          <h4 id="name-computing-a-mode-attribute-">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-computing-a-mode-attribute-" class="section-name selfRef">Computing a Mode Attribute from an ACL</a>
          </h4>
<p id="section-8.2.1-1">
          The following method can be used to calculate the MODE4_R*,
          MODE4_W*, and MODE4_X* bits of a mode attribute, based upon
          an ACL.<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-8.2.1-2">
     [Working group discussion needed]:  "can be used" says
     essentially "do whatever you choose" and would make
     <a href="#AUTH-comb" class="xref">Section 8</a> essentially pointless.  Would
     prefer "is to be used", "<span class="bcp14">MUST</span>", or
     "<span class="bcp14">SHOULD</span>" if valid reasons to do otherwise
     can be found.<a href="#section-8.2.1-2" class="pilcrow">¶</a></p>
<p id="section-8.2.1-3">
          First, for each of the special identifiers OWNER@, GROUP@, and
          EVERYONE@, evaluate the ACL in order, considering only ALLOW
          and DENY ACEs for the identifier EVERYONE@ and for the
          identifier under consideration.  The result of the evaluation
          will be an NFSv4 ACL mask showing exactly which bits are
          permitted to that identifier.<a href="#section-8.2.1-3" class="pilcrow">¶</a></p>
<p id="section-8.2.1-4">
          Then translate the calculated mask for OWNER@, GROUP@, and
          EVERYONE@ into mode bits for, respectively, the user, group,
          and other, as follows:<a href="#section-8.2.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.2.1-5">
            <li id="section-8.2.1-5.1">
              Set the read bit (MODE4_RUSR, MODE4_RGRP, or
              MODE4_ROTH) if and only if ACE4_READ_DATA is set in
              the corresponding mask.<a href="#section-8.2.1-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-8.2.1-5.2">
              Set the write bit (MODE4_WUSR, MODE4_WGRP, or
              MODE4_WOTH) if and only if ACE4_WRITE_DATA and
              ACE4_APPEND_DATA are both set in the corresponding
              mask.<a href="#section-8.2.1-5.2" class="pilcrow">¶</a>
</li>
            <li id="section-8.2.1-5.3">
              Set the execute bit (MODE4_XUSR, MODE4_XGRP, or
              MODE4_XOTH), if and only if ACE4_EXECUTE is set in the
              corresponding mask.<a href="#section-8.2.1-5.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="AUTH-comb-computealt">
<section id="section-8.2.2">
          <h4 id="name-alternatives-in-computing-m">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-alternatives-in-computing-m" class="section-name selfRef">Alternatives in Computing Mode Bits</a>
          </h4>
<p id="section-8.2.2-1">
            Some server implementations also add bits permitted to
            named users and groups to the group bits (MODE4_RGRP,
            MODE4_WGRP, and MODE4_XGRP).<a href="#section-8.2.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2.2-2">
            Implementations are discouraged from doing this, because
            it has been found to cause confusion for users who see
            members of a file's group denied access that the mode
            bits appear to allow.  (The presence of DENY ACEs may also
            lead to such behavior, but DENY ACEs are expected to be
            more rarely used.)<a href="#section-8.2.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2.2-3">
       [Working group decision needed]; the text does not seem
       to really discourage this practice and makes no reference
       to the need to standardize behavior or any
       impediment to doing so.
       "<span class="bcp14">SHOULD NOT</span>" needs to be considered if
       valid reasons to do otherwise can be found.<a href="#section-8.2.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2.2-4">
            The same user confusion seen when fetching the mode also
            results if setting the mode does not effectively control
            permissions for the owner, group, and other users; this
            motivates some of the requirements that follow.<a href="#section-8.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTH-comb-setmultacl">
<section id="section-8.2.3">
          <h4 id="name-setting-multiple-acl-attrib">
<a href="#section-8.2.3" class="section-number selfRef">8.2.3. </a><a href="#name-setting-multiple-acl-attrib" class="section-name selfRef">Setting Multiple ACL Attributes</a>
          </h4>
<p id="section-8.2.3-1">
          In the case where a server supports the sacl or
          dacl attribute, in addition to the acl attribute,
          the server <span class="bcp14">MUST</span> fail a request to set the acl
          attribute simultaneously with a dacl or sacl
          attribute.  The error to be given is NFS4ERR_ATTRNOTSUPP.<a href="#section-8.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTH-comb-setmode">
<section id="section-8.2.4">
          <h4 id="name-setting-mode-and-not-acl">
<a href="#section-8.2.4" class="section-number selfRef">8.2.4. </a><a href="#name-setting-mode-and-not-acl" class="section-name selfRef">Setting Mode and not ACL</a>
          </h4>
<p id="section-8.2.4-1">
            When any of the nine low-order mode bits
            are subject to change, either because the mode
            attribute was set or because the mode_set_masked
            attribute was set and the mask included one or more
            bits from the nine low-order mode bits,
            and no ACL attribute is explicitly
            set, the acl and dacl attributes must be modified
            in accordance with the updated value of those bits.
            This must happen
            even if the value of the low-order bits
            is the same after the mode is set as before.<a href="#section-8.2.4-1" class="pilcrow">¶</a></p>
<p id="section-8.2.4-2">
            Note that any AUDIT or ALARM ACEs (hence any ACEs in the
            sacl attribute) are unaffected by changes to the mode.<a href="#section-8.2.4-2" class="pilcrow">¶</a></p>
<p id="section-8.2.4-3">
            In cases in which the permissions bits are subject to
            change, the acl and dacl attributes
            <span class="bcp14">MUST</span> be modified such that the mode computed via the
            method in
            <a href="#AUTH-comb-computemode" class="xref">Section 8.2.1</a>
            yields the low-order nine bits (MODE4_R*, MODE4_W*,
            MODE4_X*) of the mode attribute as modified by the
            attribute change.  The ACL attributes
            <span class="bcp14">SHOULD</span> also be modified such that:<a href="#section-8.2.4-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.2.4-4">
              <li id="section-8.2.4-4.1">
                If MODE4_RGRP is not set, entities explicitly
                listed in the ACL other than OWNER@ and EVERYONE@
                <span class="bcp14">SHOULD NOT</span> be granted ACE4_READ_DATA.<a href="#section-8.2.4-4.1" class="pilcrow">¶</a>
</li>
            <li id="section-8.2.4-4.2">
                If MODE4_WGRP is not set, entities explicitly
                listed in the ACL other than OWNER@ and
                EVERYONE@ <span class="bcp14">SHOULD NOT</span> be granted
                ACE4_WRITE_DATA or ACE4_APPEND_DATA.<a href="#section-8.2.4-4.2" class="pilcrow">¶</a>
</li>
            <li id="section-8.2.4-4.3">
                If MODE4_XGRP is not set, entities explicitly
                listed in the ACL other than OWNER@ and EVERYONE@
                <span class="bcp14">SHOULD NOT</span> be granted ACE4_EXECUTE.<a href="#section-8.2.4-4.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-8.2.4-5">
            Access mask bits other than those listed above, appearing
            in ALLOW ACEs, <span class="bcp14">MAY</span> also be disabled.<a href="#section-8.2.4-5" class="pilcrow">¶</a></p>
<p id="section-8.2.4-6">
            Note that ACEs with the flag ACE4_INHERIT_ONLY_ACE set do
            not affect the permissions of the ACL itself, nor do ACEs
            of the type AUDIT and ALARM. As such, it is desirable to
            leave these ACEs unmodified when modifying the ACL
            attributes.<a href="#section-8.2.4-6" class="pilcrow">¶</a></p>
<p id="section-8.2.4-7">
            Also note that the requirement may be met by
            discarding the acl and dacl, in favor of an ACL
            that represents the mode and only the mode. This is
            permitted, but it is preferable for a server to
            preserve as much of the ACL as possible without
            violating the above requirements. Discarding the
            ACL makes it effectively impossible for a file
            created with a mode attribute to inherit an ACL
            (see <a href="#AUTH-comb-aclcreate" class="xref">Section 8.2.8</a>).<a href="#section-8.2.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTH-comb-settingacl">
<section id="section-8.2.5">
          <h4 id="name-setting-acl-and-not-mode">
<a href="#section-8.2.5" class="section-number selfRef">8.2.5. </a><a href="#name-setting-acl-and-not-mode" class="section-name selfRef">Setting ACL and Not Mode</a>
          </h4>
<p id="section-8.2.5-1">
            When setting the acl or dacl and not setting the
            mode or mode_set_masked attributes, the permission
            bits of the mode need to be derived from the ACL.
            In this case, the ACL attribute <span class="bcp14">SHOULD</span> be set as
            given. The nine low-order bits of the mode
            attribute (MODE4_R*, MODE4_W*, MODE4_X*) <span class="bcp14">MUST</span> be
            modified to match the result of the method in
     <a href="#AUTH-comb-computemode" class="xref">Section 8.2.1</a>. The three high-order bits
            of the mode (MODE4_SUID, MODE4_SGID, MODE4_SVTX)
            <span class="bcp14">SHOULD</span> remain unchanged.<a href="#section-8.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTH-comb-setboth">
<section id="section-8.2.6">
          <h4 id="name-setting-both-acl-and-mode">
<a href="#section-8.2.6" class="section-number selfRef">8.2.6. </a><a href="#name-setting-both-acl-and-mode" class="section-name selfRef">Setting Both ACL and Mode</a>
          </h4>
<p id="section-8.2.6-1">
            When setting both the mode (includes use of either the
            mode attribute or the mode_set_masked attribute) 
            and the acl or dacl attributes in the
            same operation, the attributes <span class="bcp14">MUST</span> be applied in this
            order: mode (or mode_set_masked), then ACL.  The 
            mode-related attribute is set as given,
            then the ACL attribute is set as given, possibly changing
            the final mode, as described above in
            <a href="#AUTH-comb-settingacl" class="xref">Section 8.2.5</a>.<a href="#section-8.2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTH-comb-fetchattr">
<section id="section-8.2.7">
          <h4 id="name-retrieving-the-mode-and-or-">
<a href="#section-8.2.7" class="section-number selfRef">8.2.7. </a><a href="#name-retrieving-the-mode-and-or-" class="section-name selfRef">Retrieving the Mode and/or ACL Attributes</a>
          </h4>
<p id="section-8.2.7-1">
          Some server implementations may provide for the existence of
          "objects without ACLs", meaning that all permissions
          are granted and denied according to the mode attribute and
          that no ACL attribute is stored for that object. If an ACL
          attribute is requested of such a server, the server <span class="bcp14">SHOULD</span>
          return an ACL that does not conflict with the mode; that is to
          say, the ACL returned <span class="bcp14">SHOULD</span> represent the nine low-order bits
          of the mode attribute (MODE4_R*, MODE4_W*, MODE4_X*) as
          described in <a href="#AUTH-comb-computemode" class="xref">Section 8.2.1</a>.<a href="#section-8.2.7-1" class="pilcrow">¶</a></p>
<p id="section-8.2.7-2">
          For other server implementations, the ACL attribute is always
          present for every object. Such servers <span class="bcp14">SHOULD</span> store at least
          the three high-order bits of the mode attribute (MODE4_SUID,
          MODE4_SGID, MODE4_SVTX). The server <span class="bcp14">SHOULD</span> return a mode
          attribute if one is requested, and the low-order nine bits of
          the mode (MODE4_R*, MODE4_W*, MODE4_X*) <span class="bcp14">MUST</span> match the result
          of applying the method in
          <a href="#AUTH-comb-computemode" class="xref">Section 8.2.1</a> to the ACL attribute.<a href="#section-8.2.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AUTH-comb-aclcreate">
<section id="section-8.2.8">
          <h4 id="name-creating-new-objects">
<a href="#section-8.2.8" class="section-number selfRef">8.2.8. </a><a href="#name-creating-new-objects" class="section-name selfRef">Creating New Objects</a>
          </h4>
<p id="section-8.2.8-1">
          If a server supports any ACL attributes, it may use the ACL
          attributes on the parent directory to compute an initial ACL
          attribute for a newly created object. This will be referred to
          as the inherited ACL within this section. The act of adding
          one or more ACEs to the inherited ACL that are based upon ACEs
          in the parent directory's ACL will be referred to as
          inheriting an ACE within this section.<a href="#section-8.2.8-1" class="pilcrow">¶</a></p>
<p id="section-8.2.8-2">
          Implementors should standardize the behavior of CREATE
          and OPEN depending on the presence or absence of the
          mode and ACL attributes by following the directions below:<a href="#section-8.2.8-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.2.8-3">
            <li id="section-8.2.8-3.1">
              <p id="section-8.2.8-3.1.1">If just the mode is given in the call:<a href="#section-8.2.8-3.1.1" class="pilcrow">¶</a></p>
<p id="section-8.2.8-3.1.2"> In this case, inheritance
              <span class="bcp14">SHOULD</span> take place, but the mode
       <span class="bcp14">MUST</span> be applied to the
              inherited ACL as described in <a href="#AUTH-comb-setmode" class="xref">Section 8.2.4</a>,
       thereby modifying the ACL.<a href="#section-8.2.8-3.1.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-8.2.8-3.2">
              <p id="section-8.2.8-3.2.1">If just the ACL is given in the call:<a href="#section-8.2.8-3.2.1" class="pilcrow">¶</a></p>
<p id="section-8.2.8-3.2.2">
              In this case, inheritance <span class="bcp14">SHOULD NOT</span> take place, and
              the ACL as defined in the CREATE or OPEN will be set
              without modification, and the mode modified as in
              <a href="#AUTH-comb-settingacl" class="xref">Section 8.2.5</a>.<a href="#section-8.2.8-3.2.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-8.2.8-3.3">
              <p id="section-8.2.8-3.3.1">If both mode and ACL are given in the call:<a href="#section-8.2.8-3.3.1" class="pilcrow">¶</a></p>
<p id="section-8.2.8-3.3.2"> In this case, inheritance
              <span class="bcp14">SHOULD NOT</span> take place, and both attributes will be set
              as described in <a href="#AUTH-comb-setboth" class="xref">Section 8.2.6</a>.<a href="#section-8.2.8-3.3.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-8.2.8-3.4">
              <p id="section-8.2.8-3.4.1">
              If neither mode nor ACL is given in the call:<a href="#section-8.2.8-3.4.1" class="pilcrow">¶</a></p>
<p id="section-8.2.8-3.4.2">
              In the case where an object is being created without
              any initial attributes at all, e.g., an OPEN operation
              with an opentype4 of OPEN4_CREATE and a createmode4 of
              EXCLUSIVE4, inheritance <span class="bcp14">SHOULD NOT</span> take place (note that
              EXCLUSIVE4_1 is a better choice of createmode4, since it
              does permit initial attributes).
              Instead, the server <span class="bcp14">SHOULD</span> set permissions to deny all
              access to the newly created object. It is expected
              that the appropriate client will set the desired
              attributes in a subsequent SETATTR operation, and the
              server <span class="bcp14">SHOULD</span> allow that operation to succeed,
              regardless of what permissions the object is created
              with. For example, an empty ACL denies all
              permissions, but the server should allow the owner's
              SETATTR to succeed even though WRITE_ACL is implicitly
              denied.<a href="#section-8.2.8-3.4.2" class="pilcrow">¶</a></p>
<p id="section-8.2.8-3.4.3">
              In other cases, inheritance <span class="bcp14">SHOULD</span> take place, and no
              modifications to the ACL will happen. The mode
              attribute, if supported, <span class="bcp14">MUST</span> be as computed in 
       <a href="#AUTH-comb-computemode" class="xref">Section 8.2.1</a>, with the MODE4_SUID,
              MODE4_SGID, and MODE4_SVTX bits clear.
              If no inheritable ACEs exist on the parent directory,
              the rules for creating acl, dacl, or sacl attributes
              are implementation defined.
              If either the dacl or sacl attribute is supported,
              then the ACL4_DEFAULTED flag <span class="bcp14">SHOULD</span> be set on the
              newly created attributes.<a href="#section-8.2.8-3.4.3" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="AUTH-comb-inheritreq">
<section id="section-8.2.9">
          <h4 id="name-use-of-inherited-acl-when-c">
<a href="#section-8.2.9" class="section-number selfRef">8.2.9. </a><a href="#name-use-of-inherited-acl-when-c" class="section-name selfRef">Use of Inherited ACL When Creating Objects</a>
          </h4>
<p id="section-8.2.9-1">
            If the object being created is not a directory, the
            inherited ACL <span class="bcp14">SHOULD NOT</span> inherit ACEs from the parent
            directory ACL unless the ACE4_FILE_INHERIT_ACE flag is set.<a href="#section-8.2.9-1" class="pilcrow">¶</a></p>
<p id="section-8.2.9-2">
            If the object being created is a directory, the inherited
            ACL should inherit all inheritable ACEs from the parent
            directory, that is, those that have the ACE4_FILE_INHERIT_ACE or
            ACE4_DIRECTORY_INHERIT_ACE flag set.  
If the inheritable
            ACE has ACE4_FILE_INHERIT_ACE set but
            ACE4_DIRECTORY_INHERIT_ACE is clear, the inherited ACE on
            the newly created directory <span class="bcp14">MUST</span> have the
            ACE4_INHERIT_ONLY_ACE flag set to prevent the directory
            from being affected by ACEs meant for non-directories.<a href="#section-8.2.9-2" class="pilcrow">¶</a></p>
<p id="section-8.2.9-3">
            When a new directory is created, the server <span class="bcp14">MAY</span> split
            any inherited ACE that is both inheritable and effective
            (in other words, that has neither ACE4_INHERIT_ONLY_ACE
            nor ACE4_NO_PROPAGATE_INHERIT_ACE set), into two ACEs,
            one with no inheritance flags and one with
            ACE4_INHERIT_ONLY_ACE set.  (In the case of a dacl or
            sacl attribute, both of those ACEs <span class="bcp14">SHOULD</span> also have the
            ACE4_INHERITED_ACE flag set.)  This makes it simpler to
            modify the effective permissions on the directory
            without modifying the ACE that is to be inherited to the
            new directory's children.<a href="#section-8.2.9-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AUTH-comb-v42">
<section id="section-8.3">
        <h3 id="name-combined-authorization-models">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-combined-authorization-models" class="section-name selfRef">Combined Authorization Models for V4.2</a>
        </h3>
<p id="section-8.3-1">
       The v4.1 server implementation requirements described in
       <a href="#AUTH-comb-v41" class="xref">Section 8.2</a> apply to v4.2 as well and
       v4.2 clients can assume that the server follows them.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">
       V4.2 contains an <span class="bcp14">OPTIONAL</span> extension, defined
       in <span>[<a href="#RFC8257" class="xref">13</a>]</span>, which is intended to reduce
       the interference of modes, restricted by the umask mechanism,
       with the acl inheritance mechanism.   The extension allows
       the client to specify the umask separately from the mask
       attribute.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AUTHL">
<section id="section-9">
      <h2 id="name-labelled-nfs-authorization-">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-labelled-nfs-authorization-" class="section-name selfRef">Labelled NFS Authorization Model</a>
      </h2>
<p id="section-9-1">
   The labelled NFS feature of NFSv4.2 is designed to support
   Mandatory Access control.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">
   The attribute sec_label enables an authorization model focused
   on Mandatory Access Control and is described in
   <a href="#AUTHL" class="xref">Section 9</a>.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">
   Not much can be said about this feature because the specification,
   in the interest of flexibility, has left important features
   undefined in order to allow future extension.   As a result, we have
   something that is a framework to allow Mandatory Access Control
   rather than one to provide it.  In particular,<a href="#section-9-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-4.1">
          <p id="section-9-4.1.1">
     The sec_label attribute, which provides the objects label has
     no existing specification.<a href="#section-9-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-4.2">
          <p id="section-9-4.2.1">
     There is no specification of the of the format of the subject
     label or way to authenticate them.<a href="#section-9-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-4.3">
          <p id="section-9-4.3.1">
     As a result, all authorization takes place on the client,
     and the server simply accepts the client's determination.<a href="#section-9-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-9-5">
   This arrangements shares important similarities with AUTH_SYS.
   As such it makes sense:<a href="#section-9-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-6.1">
          <p id="section-9-6.1.1">
     To require/recommend that an encrypted connection be used.<a href="#section-9-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-6.2">
          <p id="section-9-6.2.1">
     To require/recommend that client and server peers mutually
     authenticate as part of connection establishment.<a href="#section-9-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-6.3">
          <p id="section-9-6.3.1">
     That work be devoted to providing a replacement without the
     above issues.<a href="#section-9-6.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="AUTHST">
<section id="section-10">
      <h2 id="name-state-modification-authoriz">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-state-modification-authoriz" class="section-name selfRef">State Modification Authorization</a>
      </h2>
<p id="section-10-1">
   Modification of locking and session state data should not be done by
   a client other than the one that created the lock.  For this
   form of authorization, the server needs to identify and
   authenticate client peers rather than client users.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">
   Such authentication is not directly provided by any RPC
   authentication flavor.  However, RPC-based transports, when
   suitably configured, can provide this authenication.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">
   NFSv4.1 defines a number of ways to provide appropriate
   authorization facilities.   These will not be discussed in
   detail here but the following points should be noted:<a href="#section-10-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-4.1">
          <p id="section-10-4.1.1">
     NFSv4.1 defines the MACHCRED mechanism which uses the RPCSEC_GSS
     infrastrucure to provide authentication of the clients peer.
     However, this is of no value when AUTH_SYS is being used.<a href="#section-10-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.2">
          <p id="section-10-4.2.1">
     NFSv4.1 also defines the SSV mechanism which uses the RPCSEC_GSS
     infrastructure to enable it to be reliably determined whether
     two different client connections are connected to the same client.
     It is unclear whether the word "authentication" is appropriate in
     this case.  As with MACHCRED, this is of no value when
     AUTH_SYS is being used.<a href="#section-10-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-4.3">
          <p id="section-10-4.3.1">
     Because of the lack of support for AUTH_SYS and for NFSv4.0,
     it is quite desirable for clients to use and for servers to
     require the use of client-peer authentication as part of
     connection establishment.<a href="#section-10-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-10-5">
   When unauthenticated clients are allowed, their  state is exposed to
   unwanted modification as part of disruption or denial-of-service
   attacks.  As a result, the potential burdens of such  attacks are felt
   principally by clients who choose not to provide such authentication.<a href="#section-10-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="OTHACL">
<section id="section-11">
      <h2 id="name-other-uses-of-access-contro">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-other-uses-of-access-contro" class="section-name selfRef">Other Uses of Access Control Lists</a>
    </h2>
</section>
</div>
<div id="IDENT">
<section id="section-12">
      <h2 id="name-identification-and-authenti">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-identification-and-authenti" class="section-name selfRef">Identification and Authentication</a>
      </h2>
<p id="section-12-1">
      Various objects and subjects need to be identified for a protocol to
      function.   For it to be secure, many of these need to be authenticated
      so that incorrect identification is not the basis for attacks.<a href="#section-12-1" class="pilcrow">¶</a></p>
<div id="IDENT-auth">
<section id="section-12.1">
        <h3 id="name-identification-vs-authentic">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-identification-vs-authentic" class="section-name selfRef">Identification vs. Authentication</a>
        </h3>
<p id="section-12.1-1">
 It is necessary to be clear about this distinction which has been
 obscured in the past, by the use of the term "RPC Authentication
 Flavor" in connection with situation in which identification
 without authentication occurred or in which there was neither
 identification nor authentication involved.   As a result, we will
 use the term "RPC Flavors" instead<a href="#section-12.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IDENT-items">
<section id="section-12.2">
        <h3 id="name-items-to-be-identified">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-items-to-be-identified" class="section-name selfRef">Items to be Identified</a>
        </h3>
<p id="section-12.2-1">
 Some identifier are not security-relevant and can used be used
 without authentication, given that, in the authorization
 decision, the object acted upon needs only to be properly
 identified<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-2.1">
            <p id="section-12.2-2.1.1">
   File names are of this type.<a href="#section-12.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-12.2-2.1.2">
   Unlike the case for some other protocols, confusion of names that
   result from internationalization issues, while an annoyance, are
   not relevant to security. If the confusion between LATIN CAPITAL
   LETTER O and CYRILLIC CAPITAL LETTER O, results in the wrong file
          being accessed, the mechanisms described in <a href="#AUTHFA" class="xref">Section 6</a>
   prevent in appropriate access being granted.<a href="#section-12.2-2.1.2" class="pilcrow">¶</a></p>
<p id="section-12.2-2.1.3">
   Despite the above, it is desirable if file names togeter with
   similar are not transferred in the clear as the information
   exposed may give atackers useful information helpful in
   planning and executing atacks.<a href="#section-12.2-2.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-2.2">
            <p id="section-12.2-2.2.1">
   The case of file handles is similar.<a href="#section-12.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-12.2-3">
 Identifier that refer to state shared between client and server
 can be the basis of disruption attacks since clients and server
 necessaily assume that neither side will change the state corpus
 without appropriate notice.<a href="#section-12.2-3" class="pilcrow">¶</a></p>
<p id="section-12.2-4">
 While these identifiers do not need to be authenticated, they are
 associated with higher-level entities for which change of the state
 represented by those entities is subject to peer authentication.<a href="#section-12.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-5.1">
            <p id="section-12.2-5.1.1">
   Unexpected closure of stateids or changes in state sequence values
   can disrupt client access as no clients have provision to deal
   with this source of interference.<a href="#section-12.2-5.1.1" class="pilcrow">¶</a></p>
<p id="section-12.2-5.1.2">
   While encryption may make it more difficult to execute such attacks
   attackers can often guess stateid's since server generally not
   randomize them.<a href="#section-12.2-5.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-5.2">
            <p id="section-12.2-5.2.1">
   Similarly, modification to v4.1 session state information can result
   in confusion if an attacker changes the slot sequence by assuing
   spurious requests.   Even if the request is rejected, the slot
   sequence is changed and clients may
   a difficult time getting back in sync with the server.<a href="#section-12.2-5.2.1" class="pilcrow">¶</a></p>
<p id="section-12.2-5.2.2">
   While encryption may make it more difficult to execute such attacks
   attackers can often guess slot id's and obtain sessinid's since
   server generally do not randomize them.<a href="#section-12.2-5.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-5.3">
            <p id="section-12.2-5.3.1"></p><a href="#section-12.2-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-12.2-6">
 it is necessary that modification of the higher-levell entities
 be restricted to the client that created them.<a href="#section-12.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-7.1">
            <p id="section-12.2-7.1.1">
    For v4.0, the relevant entity is the clientid.<a href="#section-12.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.2-7.2">
            <p id="section-12.2-7.2.1">
    for v4.1, the releant entity is the sessionid.<a href="#section-12.2-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-12.2-8">
 Identifiers describing the issuer of the request, whether in numeric
 or string form always require authentication.<a href="#section-12.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IDENT-flavor">
<section id="section-12.3">
        <h3 id="name-authentication-provided-by-">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-authentication-provided-by-" class="section-name selfRef">Authentication Provided by specific RPC Flavors</a>
        </h3>
<p id="section-12.3-1">
 Different flavors differ quite consderably, as discussed below;<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.3-2.1">
            <p id="section-12.3-2.1.1">
   When AUTH_NONE is used, the user making the request is neither
   authenticated nor identified to the server.<a href="#section-12.3-2.1.1" class="pilcrow">¶</a></p>
<p id="section-12.3-2.1.2">
   Also, the server is not authenticated to the client and has no
   way to determine whether the server it is communicating with is
   an imposter.<a href="#section-12.3-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-2.2">
            <p id="section-12.3-2.2.1">
   When AUTH_SYS is used, the user making is the request identified
   but there
   no authentication of that identification.<a href="#section-12.3-2.2.1" class="pilcrow">¶</a></p>
<p id="section-12.3-2.2.2">
   As in the previous case, the server is not authenticated to
   the client and has no
   way to determine whether the server it is communicating with is
   an imposter.<a href="#section-12.3-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.3-2.3">
            <p id="section-12.3-2.3.1">
   When RPCSEC_GSS is used, the user making the request is authenticated
   as is the server peer responding.<a href="#section-12.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="IDENT-xport">
<section id="section-12.4">
        <h3 id="name-authentication-provided-by-t">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-authentication-provided-by-t" class="section-name selfRef">Authentication Provided by the RPC Transport</a>
        </h3>
<p id="section-12.4-1">
 Different transports differ quite consderably, as discussed below.
 In contrast to the case of RPC flavors, any authentication happens
 once, at connection establishment, rather than on each RPC request.
 As a result, it is the client and server peers, rather than individual
 users that is authenticated.<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.4-2.1">
            <p id="section-12.4-2.1.1">
   For most transports, such as TCP and RPC-over-RDMA version 1, there
   is no provision for peer authentication.<a href="#section-12.4-2.1.1" class="pilcrow">¶</a></p>
<p id="section-12.4-2.1.2">
   As a result use of AUTH_SYS together with such transports is
   inherently problematic.<a href="#section-12.4-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.4-2.2">
            <p id="section-12.4-2.2.1">
   Some transports provide for the possibility of mutual peer
   authentication.<a href="#section-12.4-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="DATA">
<section id="section-13">
      <h2 id="name-security-of-data-in-flight">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-security-of-data-in-flight" class="section-name selfRef">Security of Data in Flight</a>
      </h2>
<div id="DATA-flavor">
<section id="section-13.1">
        <h3 id="name-data-security-provided-by-t">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-data-security-provided-by-t" class="section-name selfRef">Data Security Provided by the Flavor-associated Services</a>
        </h3>
<p id="section-13.1-1">
 The only flavor providing these facilities is RPCSEC_GSS.  When this
 flavor is used, data security can be negotiated between client and
 server as described in <a href="#NEGO-flavor" class="xref">Section 14.2</a>.  However, when
 data security is provided at the transport level, as described in
 <a href="#DATA-xport" class="xref">Section 13.2</a>, the negotiation of privacy and integrity
 support is unnecessary,<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<p id="section-13.1-2">
 Other flavors, such as AUTH_SYS and AUTH_NONE have no such data
 security facilities.   When these flavor are used, the only data
 security is provided by the transport.<a href="#section-13.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="DATA-xport">
<section id="section-13.2">
        <h3 id="name-data-security-provided-by-th">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-data-security-provided-by-th" class="section-name selfRef">Data Security Provided by the RPC Transport</a>
        </h3>
<p id="section-13.2-1">
 Some transports provide data security for all transactions performed
 on them, eliminating the need for that security to be provided or
 negotiated by the selection of particular flavors, mechanism, or
 services.<a href="#section-13.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="NEGO">
<section id="section-14">
      <h2 id="name-security-negotiation">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-security-negotiation" class="section-name selfRef">Security Negotiation</a>
      </h2>
<p id="section-14-1">
      As previously in NFSv4, we use the term "negotiation" to characterize
      the process of the server providing a set of options and the client
      selecting one.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">
      The use of SECINFO, possibly with SECINFO_NONAME, remains the
      primary means by which the security parameters are determined.  The
      addition of transports to flavors in providing security has resulted
      in the following changes:<a href="#section-14-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14-3.1">
          <p id="section-14-3.1.1">
        Transport-related security choices are typically decided at
 connection-establishment so there needs to be provision for
 negotiation at this point.<a href="#section-14-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-14-3.2">
          <p id="section-14-3.2.1">
        Despite the above, because the choices of flavor and transport
 affect one another, SECINFO has been extended by the addition
 of pseudo-flavors, while retaining the existing XDR, to allow
 negotiation of transport choices and accompanying connection
 establishment options, in addition to selection of flavors and
 accompanying services.   This allows server policies for such
 matters to be different for different portions of the namespace.<a href="#section-14-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="NEGO-flandpfl">
<section id="section-14.1">
        <h3 id="name-flavors-and-pseudo-flavors">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-flavors-and-pseudo-flavors" class="section-name selfRef">Flavors and Pseudo-flavors</a>
        </h3>
<p id="section-14.1-1">
 The flavor field of the secinfo4 items returned by SECINFO and
 SECINO_NONAME have always allowed pseudo flavors to be included.
 However, previous treatments of these operations have not provided
 information
 about how responses containing such pseudo-flavors are to be
 interpreted.<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<p id="section-14.1-2">
 Those pseudo-flavors now provide a means of extending the
 negotiation process so it is capable of providing
 for the negotiation of the use particular RPC transports and
 security-related options for the connections established using
 those transports.<a href="#section-14.1-2" class="pilcrow">¶</a></p>
<p id="section-14.1-3">
 The flavors AUTH_NONE, AUTH_SYS and RPCSEC_GSS continue to indicate the
 acceptability of the corresponding method of user authentication,
 user identification, or user non-identification, when used with
 a particular RPC transport.<a href="#section-14.1-3" class="pilcrow">¶</a></p>
<p id="section-14.1-4">
 The flavor AUTH_TLS, which is not used as part of issuing
 requests is not included in this list and is treated as a
 connetion-type--specifying pseudo-flavor.<a href="#section-14.1-4" class="pilcrow">¶</a></p>
<p id="section-14.1-5">
 secinfo4s for the flavor RPCSEC_GSS contains additional
 information describing the specific secrity lgorithm to be used
 and the ancillary services to be provided (e.g. integrity, privacy)
 when these services are not provided by the trnsport.<a href="#section-14.1-5" class="pilcrow">¶</a></p>
<p id="section-14.1-6">
 Such flavors are referred to as "flavor-specifying flavors"<a href="#section-14.1-6" class="pilcrow">¶</a></p>
<p id="section-14.1-7">
 The classification below organizes the flavors and pseudo-flavors
 used in security negotiation while <a href="#NEGO-algo" class="xref">Section 14.4</a>
 describes how the set of secinfos in a response can be used by
 the client to select acceptble combinations of security flavor,
 security mechanism, security services, security-related transports,
 and security-related connection chractertics.<a href="#section-14.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.1-8.1">
            <p id="section-14.1-8.1.1">
   The pseudo-flavors designating a security-relevant transport
   type, together with AUTH-TLS, nominally a flavor but used as a
   pseudo-flavor in connection with SECINFO.<a href="#section-14.1-8.1.1" class="pilcrow">¶</a></p>
<p id="section-14.1-8.1.2">
   Such pseudo-flavors are referred to as "transport-
   specifying flavors".<a href="#section-14.1-8.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-8.2">
            <p id="section-14.1-8.2.1">
   The pseudo-flavors designating restrictions on acceptble connnection
   characteristics include XPCH_ENCRYPT, 
   XPCH_PEERAUTH, and XPCH_SECURE.<a href="#section-14.1-8.2.1" class="pilcrow">¶</a></p>
<p id="section-14.1-8.2.2">
   Such pseudo-flavors are referred to as "transport-restriction
   flavors".<a href="#section-14.1-8.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-8.3">
            <p id="section-14.1-8.3.1">
   The pseudo-flavors combining a flavor designation together with
   a restriction conerninng the connections it is relevant to
   include AUTHXP_CLIENTPEER, AUTHXP_ENCRYPT, AUTHXP_SECURE.<a href="#section-14.1-8.3.1" class="pilcrow">¶</a></p>
<p id="section-14.1-8.3.2">
   Such pseudo-flavors are referred as tranport-hybridized flavors.<a href="#section-14.1-8.3.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.1-8.4">
            <p id="section-14.1-8.4.1">
   The special pseudo-flavors, XPBREAK and XPCURRENT<a href="#section-14.1-8.4.1" class="pilcrow">¶</a></p>
<p id="section-14.1-8.4.2">
   Such pseudo-flavors are referred to connection-organizing flavors.<a href="#section-14.1-8.4.2" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="NEGO-flavor">
<section id="section-14.2">
        <h3 id="name-negotiation-of-security-fla">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-negotiation-of-security-fla" class="section-name selfRef">Negotiation of Security Flavors and Mechanisms</a>
        </h3>
<p id="section-14.2-1">
 For the current connection, this proceeds as it has previously, when
 security-relevant transports were not available.  Flavor entties,
 including those including mechanism information are listed in order
 of server preference and apply, by default, to the current connection,
 which normally is favored by the server.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<p id="section-14.2-2">
 When other transport-identifying pseudo-flavors appear before the
 flavor entries, then the server is indicating that these transport
 types, with the server preference following the ordering of the
 entries.  In this case, any flavor entries that follow a transport
 entry specify that flavor is usable with the transport types denoted
 by that transport entry.<a href="#section-14.2-2" class="pilcrow">¶</a></p>
<p id="section-14.2-3"></p>
</section>
</div>
<div id="NEGO-xports">
<section id="section-14.3">
        <h3 id="name-negotiation-of-rpc-transpor">
<a href="#section-14.3" class="section-number selfRef">14.3. </a><a href="#name-negotiation-of-rpc-transpor" class="section-name selfRef">Negotiation of RPC Transports and Characteristics</a>
        </h3>
<p id="section-14.3-1">
 First we define some necessary terminology.<a href="#section-14.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.3-2.1">
            <p id="section-14.3-2.1.1">
   A transport type specifies one of a small set of RPC transport
   types such as TCP or RDMA. Each such transport type has an
   associated pseudoflavor. There are also pseudo-flavors that
   specify a set of transport types such as XPT_ALL.<a href="#section-14.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.3-2.2">
            <p id="section-14.3-2.2.1">
   Connection characteristics are designations of security-relevant
   characteristics or sets of characteristics  that connections might
   have.<a href="#section-14.3-2.2.1" class="pilcrow">¶</a></p>
<p id="section-14.3-2.2.2">
   There are pseudo-flavors associated with connection characteristics
   such as CONCH_CPAUTH, denoting client-peer authentication and
   CONCH_ENCRYPT, denoting the presence of an encrypted channel.
   The pseudo-flavor CONCH_SECURE denotes the presence of peer mutual
   authentication together with the use of an encrypted channel.<a href="#section-14.3-2.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.3-2.3">
            <p id="section-14.3-2.3.1">
   The combination of a transport type with a set of connection
   chracteristics is considered a connection type..while many
   connection types are designated by a combination of a flavor
   designating a transport with on designating a set of connection
   chacteristics, ther are pseudo flavor that designate a
   connection type directly.<a href="#section-14.3-2.3.1" class="pilcrow">¶</a></p>
<p id="section-14.3-2.3.2">
 For example, the flavor AUTH_TLS is equivalent to XP_TCP
 combined with CONCH_ENCRYPT, while the pseudo-flavor
 XP_TCP_SECURE equivalent to XP_TCP comnined with
 CONCH_SECURE.<a href="#section-14.3-2.3.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.3-2.4">
            <p id="section-14.3-2.4.1">
   A flavor specification designates a specific flavor, or, in
   the case of RPCSEC_GSS, a flavor combined with additional
   mechanism and service information.<a href="#section-14.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.3-2.5">
            <p id="section-14.3-2.5.1">
   A flavor assigment denote the assiciation of a specific
   flavor specification with a connection type.<a href="#section-14.3-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-14.3-3">
 A secinfo response will designate a set of valid flavor assigments
 with an implied server ordering derived from the order that the entries
 appear in.<a href="#section-14.3-3" class="pilcrow">¶</a></p>
<p id="section-14.3-4">
 In interpreting the response array the client is to maintain sets
 of designated transport typtes, connection characteristics  and
 connection types specified indidually (i.e. without separately
 specifying transport types and connection characteristics).
 When a flavor soecfication is encuntered, that flavor is considered
 valid when used with all curently active connection types,
 defined by the unionof the individually specified connection types
 and the cartesian product of the current transport types and
 current connection types.<a href="#section-14.3-4" class="pilcrow">¶</a></p>
<p id="section-14.3-5">
 The presumed ordering of these assigments is as follows:<a href="#section-14.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.3-6.1">
   When one of the connection types was specified directly by
   a connection type, the positionof that specification is compared
   to that of either the other individually-specified connection
   type or the earlier of the transport-type specification and the
   connection characteristics specification.<a href="#section-14.3-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.3-6.2">
   in other cases, the position of the transport type specifications
   are considered first withe the position of the connection
   characteristics considered if necessary.<a href="#section-14.3-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.3-6.3">
   If neithe of the above resolve issue, the positionof the
   flavor specification is considered.<a href="#section-14.3-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.3-6.4">
   The type of the current connection is considered to be
   specified first, implicitly.<a href="#section-14.3-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.3-6.5">
   There are provisions, described in <a href="#NEGO-algo" class="xref">Section 14.4</a>
   to modify this ordering, as may be necessary, for example,
   when the current connection, while acceptsble is of lower
   server preference.<a href="#section-14.3-6.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="NEGO-algo">
<section id="section-14.4">
        <h3 id="name-overall-interpretation-of-s">
<a href="#section-14.4" class="section-number selfRef">14.4. </a><a href="#name-overall-interpretation-of-s" class="section-name selfRef">Overall Interpretation of SECINFO Response Arrays</a>
        </h3>
<p id="section-14.4-1">
        [TBD in -01]<a href="#section-14.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="NEGO-secinfo">
<section id="section-14.5">
        <h3 id="name-secinfo">
<a href="#section-14.5" class="section-number selfRef">14.5. </a><a href="#name-secinfo" class="section-name selfRef">SECINFO</a>
        </h3>
<p id="section-14.5-1">
 The description in the sub-sections below, while it adheres
 to the XDR appearing <span>[<a href="#RFC7530" class="xref">6</a>]</span>,
 <span>[<a href="#RFC7531" class="xref">7</a>]</span>, <span>[<a href="#RFC8881" class="xref">8</a>]</span>, 
 <span>[<a href="#RFC5662" class="xref">9</a>]</span> and <span>[<a href="#RFC7863" class="xref">11</a>]</span>.
 will supersede the descriptions in
 <span>[<a href="#RFC7531" class="xref">7</a>]</span> and <span>[<a href="#RFC8881" class="xref">8</a>]</span>.<a href="#section-14.5-1" class="pilcrow">¶</a></p>
<p id="section-14.5-2">
 This is necessary to adapt the security negotiation process
 to the presence of transport-level security services such as
 encryption and peer authentication.<a href="#section-14.5-2" class="pilcrow">¶</a></p>
<p id="section-14.5-3">
 Sumilar changes are necessary in the parallel SECINFO_NONAME
 operation introduced in NFSv4.1.   These are expected to be done as
 part of the rfc5661bis effort.<a href="#section-14.5-3" class="pilcrow">¶</a></p>
<div id="NEGO-secinfo-args">
<section id="section-14.5.1">
          <h4 id="name-secinfo-arguments">
<a href="#section-14.5.1" class="section-number selfRef">14.5.1. </a><a href="#name-secinfo-arguments" class="section-name selfRef">SECINFO ARGUMENTS</a>
          </h4>
<figure id="figure-1">
            <div class="artwork art-text alignLeft" id="section-14.5.1-1.1">
<pre>
struct SECINFO4args {
        /* CURRENT_FH: directory */
        component4      name;
};

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a></figcaption></figure>
</section>
</div>
<div id="NEGO-secinfo-resulta">
<section id="section-14.5.2">
          <h4 id="name-secinfo-results">
<a href="#section-14.5.2" class="section-number selfRef">14.5.2. </a><a href="#name-secinfo-results" class="section-name selfRef">SECINFO RESULTS</a>
          </h4>
<figure id="figure-2">
            <div class="artwork art-text alignLeft" id="section-14.5.2-1.1">
<pre>
/*
 * From RFC 2203
 */
enum rpc_gss_svc_t {
        RPC_GSS_SVC_NONE        = 1,
        RPC_GSS_SVC_INTEGRITY   = 2,
        RPC_GSS_SVC_PRIVACY     = 3
};

struct rpcsec_gss_info {
        sec_oid4        oid;
        qop4            qop;
        rpc_gss_svc_t   service;
};

/* RPCSEC_GSS has a value of '6' - See RFC 2203 */
union secinfo4 switch (uint32_t flavor) {
 case RPCSEC_GSS:
         rpcsec_gss_info        flavor_info;
 default:
         void;
};

typedef secinfo4 SECINFO4resok&lt;&gt;;

union SECINFO4res switch (nfsstat4 status) {
 case NFS4_OK:
        /* CURRENTFH: consumed */
         SECINFO4resok resok4;
 default:
         void;
};

</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a></figcaption></figure>
</section>
</div>
<div id="NEGO-secinfo-descr">
<section id="section-14.5.3">
          <h4 id="name-secinfo-description">
<a href="#section-14.5.3" class="section-number selfRef">14.5.3. </a><a href="#name-secinfo-description" class="section-name selfRef">SECINFO DESCRIPTION</a>
          </h4>
<p id="section-14.5.3-1">
   The SECINFO operation is used by the client determine the
   appropriate RPC authentication flavors, security mechanisms and
   encrypting transports to access a specific directory
   filehandle, file name pair.  SECINFO should apply the same
   access approach used for LOOKUP when evaluating the name.
   In consequence, if the requester does not have the appropriate
          access to LOOKUP the name, then SECINFO will behave the same way and
          return NFS4ERR_ACCESS.<a href="#section-14.5.3-1" class="pilcrow">¶</a></p>
<p id="section-14.5.3-2">
          The result will contain an array that represents the security
      flavor, security mechanisms and transports available, with an
      order corresponding to the
      server's preferences, the most preferred being first in the
      array. The client is free to pick whatever security flavors, mechanisms
      and transports it both desires and supports, or to pick in the server's
      preference
      order the first one it supports.  The array entries are
      represented by the secinfo4 structure.  The field 'flavor' will
      contain one of the following sorts of values:<a href="#section-14.5.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.5.3-3.1">
              <p id="section-14.5.3-3.1.1">
        a value of AUTH_NONE, AUTH_SYS (as defined in
 <span><a href="#RFC5531" class="xref">RFC 5531</a> [<a href="#RFC5531" class="xref">4</a>]</span>).<a href="#section-14.5.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.5.3-3.2">
              <p id="section-14.5.3-3.2.1">
 AUTH_TLS  as described in ...<a href="#section-14.5.3-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.5.3-3.3">
              <p id="section-14.5.3-3.3.1">
        A pseudo-flavor defined in <a href="#IANA-flavors" class="xref">Section 16.2</a><a href="#section-14.5.3-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.5.3-3.4">
              <p id="section-14.5.3-3.4.1">
 RPCSEC_GSS (as defined in <span><a href="#RFC2203" class="xref">RFC 2203</a> [<a href="#RFC2203" class="xref">2</a>]</span>).<a href="#section-14.5.3-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-14.5.3-3.5">
              <p id="section-14.5.3-3.5.1">
 Any other security flavor or pseudo-flavor registered with IANA.<a href="#section-14.5.3-3.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-14.5.3-4">
      For the flavors other than RPCSEC_GSS, no additional security
      information is returned.  For a return value of
      RPCSEC_GSS, a security triple is returned that contains the
      mechanism object identifier (OID, as defined in <span><a href="#RFC2743" class="xref">RFC 2743</a> [<a href="#RFC2743" class="xref">3</a>]</span>), the quality of protection (as
      defined in <span><a href="#RFC2743" class="xref">RFC 2743</a> [<a href="#RFC2743" class="xref">3</a>]</span>), and the
      service type (as defined in <span><a href="#RFC2203" class="xref">RFC 2203</a> [<a href="#RFC2203" class="xref">2</a>]</span>).  It is possible for SECINFO to
      return multiple entries with flavor equal to RPCSEC_GSS with
      different security triple values.<a href="#section-14.5.3-4" class="pilcrow">¶</a></p>
<p id="section-14.5.3-5">
      On success, the current filehandle is consumed, so that, if the
      operation following SECINFO tries to use the current filehandle,
      that operation will fail with the status NFS4ERR_NOFILEHANDLE.<a href="#section-14.5.3-5" class="pilcrow">¶</a></p>
<p id="section-14.5.3-6">
      If the name has a length of zero, or if the name does not obey
      the UTF-8 definition in cirsumstanes in which UTF-8 names are
      required, the error NFS4ERR_INVAL will be returned.<a href="#section-14.5.3-6" class="pilcrow">¶</a></p>
<p id="section-14.5.3-7">
      See Sections <a href="#NEGO-flavor" class="xref">14.2</a> through 
      <a href="#NEGO-algo" class="xref">14.4</a> for additional
      information on the use of SECINFO.<a href="#section-14.5.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="NEGO-secinfo-impl">
<section id="section-14.5.4">
          <h4 id="name-secinfo-implementation-gene">
<a href="#section-14.5.4" class="section-number selfRef">14.5.4. </a><a href="#name-secinfo-implementation-gene" class="section-name selfRef">SECINFO IMPLEMENTATION (general)</a>
          </h4>
<p id="section-14.5.4-1">
          The SECINFO operation is expected to be used by the NFS client
          when the error value of NFS4ERR_WRONGSEC is returned from
          another NFS operation.  This signifies to the client that the
          server's security policy is different from what the client is
          currently using.  At this point, the client is expected to
          obtain a list of possible security flavors and choose what best
          suits its policies.<a href="#section-14.5.4-1" class="pilcrow">¶</a></p>
<div id="NEGO-secinfo-impl0">
<section id="section-14.5.4.1">
            <h5 id="name-secinfo-implementation-for-">
<a href="#section-14.5.4.1" class="section-number selfRef">14.5.4.1. </a><a href="#name-secinfo-implementation-for-" class="section-name selfRef">SECINFO IMPLEMENTATION (for v4.0)</a>
            </h5>
<p id="section-14.5.4.1-1">
   [TBD in -01]<a href="#section-14.5.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="NEGO-secinfo-impl1">
<section id="section-14.5.4.2">
            <h5 id="name-secinfo-implementation-for-v">
<a href="#section-14.5.4.2" class="section-number selfRef">14.5.4.2. </a><a href="#name-secinfo-implementation-for-v" class="section-name selfRef">SECINFO IMPLEMENTATION (for v4.1 and v4.2)</a>
            </h5>
<p id="section-14.5.4.2-1">
          As mentioned, the server's security
          policies will determine when a client
          request receives NFS4ERR_WRONGSEC.<a href="#section-14.5.4.2-1" class="pilcrow">¶</a></p>
<p id="section-14.5.4.2-2">
   See
          Table 14 of <span>[<a href="#RFC8881" class="xref">8</a>]</span> for a list of operations
          that can return NFS4ERR_WRONGSEC. in the case of v4.2, there
   might be extensions alloed to return NFS4ERR_WRONGSEC.  In addition,
          when READDIR returns attributes, the rdattr_error
          (Section 5.8.1.12 of <span>[<a href="#RFC8881" class="xref">8</a>]</span>)
          can contain NFS4ERR_WRONGSEC.<a href="#section-14.5.4.2-2" class="pilcrow">¶</a></p>
<p id="section-14.5.4.2-3">
   Note that CREATE and
          REMOVE MUST NOT return NFS4ERR_WRONGSEC. The
          rationale for CREATE is that unless the
          target name exists, it cannot have a separate
          security policy from the parent directory,
          and the security policy of the parent was
          checked when its filehandle was injected into
          the COMPOUND request's operations stream (for
          similar reasons, an OPEN operation that creates
          the target MUST NOT return NFS4ERR_WRONGSEC). If
          the target name exists, while it might have a
          separate security policy, that is irrelevant
          because CREATE MUST return NFS4ERR_EXIST.
          The rationale for REMOVE is that while that
          target might have a separate security policy, the
          target is going to be removed, and so the
          security policy of the parent trumps that of the
          object being removed. RENAME and LINK MAY return
          NFS4ERR_WRONGSEC, but the NFS4ERR_WRONGSEC error
          applies only to the saved filehandle (see
   Section 2.6.3.1.2 of <span>[<a href="#RFC8881" class="xref">8</a>]</span>). Any NFS4ERR_WRONGSEC
          error on the current filehandle used by LINK and
          RENAME MUST be returned by the PUTFH, PUTPUBFH,
          PUTROOTFH, or RESTOREFH operation that injected
          the current filehandle.<a href="#section-14.5.4.2-3" class="pilcrow">¶</a></p>
<p id="section-14.5.4.2-4">
          With the exception of LINK and RENAME,
          the set of operations that can return NFS4ERR_WRONGSEC
          represents the point at which the client can inject a
          filehandle into the "current filehandle" at the server.  The
          filehandle is either provided by the client (PUTFH, PUTPUBFH,
          PUTROOTFH), generated as a result of a name-to-filehandle
          translation (LOOKUP and OPEN), or generated from the saved filehandle
          via RESTOREFH. As oSection 2.6.3.1.1.1 of <span>[<a href="#RFC8881" class="xref">8</a>]</span>
   states,
          a put filehandle operation followed by SAVEFH MUST NOT
          return NFS4ERR_WRONGSEC. Thus, the RESTOREFH operation, under
          certain conditions (see Section 2.6.3.1.1 of
   <span>[<a href="#RFC8881" class="xref">8</a>]</span>), is
          permitted to return NFS4ERR_WRONGSEC so that security policies
          can be honored.<a href="#section-14.5.4.2-4" class="pilcrow">¶</a></p>
<p id="section-14.5.4.2-5">
          The READDIR operation will not directly return the
          NFS4ERR_WRONGSEC error.  However, if the READDIR request
          included a request for attributes, it is possible that the
          READDIR request's security triple did not match that of a
          directory entry.  If this is the case and the client has
          requested the rdattr_error attribute, the server will return the
          NFS4ERR_WRONGSEC error in rdattr_error for the entry.<a href="#section-14.5.4.2-5" class="pilcrow">¶</a></p>
<p id="section-14.5.4.2-6">
          To resolve an error return of
          NFS4ERR_WRONGSEC, the client does the following:<a href="#section-14.5.4.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.5.4.2-7.1">
                <p id="section-14.5.4.2-7.1.1">
              For LOOKUP and OPEN, the client will use SECINFO with the
              same current filehandle and name as provided in the
              original LOOKUP or OPEN to enumerate the available security
              triples.<a href="#section-14.5.4.2-7.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.5.4.2-7.2">
                <p id="section-14.5.4.2-7.2.1">
              For the rdattr_error, the client will use
              SECINFO with the same current filehandle
              as provided in the original READDIR. The
              name passed to SECINFO will be that of the
              directory entry (as returned from READDIR)
              that had the NFS4ERR_WRONGSEC error in the
              rdattr_error attribute.<a href="#section-14.5.4.2-7.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.5.4.2-7.3">
                <p id="section-14.5.4.2-7.3.1">
              For PUTFH, PUTROOTFH, PUTPUBFH,
              RESTOREFH, LINK, and RENAME, the client will
              use SECINFO_NO_NAME { style =
              SECINFO_STYLE4_CURRENT_FH }. The client
              will prefix the SECINFO_NO_NAME operation
              with the appropriate PUTFH, PUTPUBFH,
              or PUTROOTFH operation that provides the
              filehandle originally provided by the PUTFH,
              PUTPUBFH, PUTROOTFH, or RESTOREFH operation.<a href="#section-14.5.4.2-7.3.1" class="pilcrow">¶</a></p>
<p id="section-14.5.4.2-7.3.2">
              NOTE: In NFSv4.0, the client was required
              to use SECINFO, and had to reconstruct the
              parent of the original filehandle and the
              component name of the original filehandle. The
              introduction in NFSv4.1 of SECINFO_NO_NAME
              obviates the need for reconstruction.<a href="#section-14.5.4.2-7.3.2" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-14.5.4.2-7.4">
                <p id="section-14.5.4.2-7.4.1">
              For LOOKUPP, the client will
              use SECINFO_NO_NAME { style =
              SECINFO_STYLE4_PARENT } and provide the
              filehandle that equals the filehandle
              originally provided to LOOKUPP.<a href="#section-14.5.4.2-7.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="SECCON-needs">
<section id="section-14.6">
        <h3 id="name-future-security-needs">
<a href="#section-14.6" class="section-number selfRef">14.6. </a><a href="#name-future-security-needs" class="section-name selfRef">Future Security Needs</a>
        </h3>
<p id="section-14.6-1">
      [To be fleashed out in -01]:  This section is basically an outline
      for now, to be filled out laater based on Working Group input,
      particularly from Chuck lever who suggested this section and has ideas
      about many of the items in it.<a href="#section-14.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.6-2.1">
            <p id="section-14.6-2.1.1">
 Security for data-at-rest, most probably based on facilities defined
 within SAN.<a href="#section-14.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-2.2">
            <p id="section-14.6-2.2.1">
 Support for content signing.<a href="#section-14.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-2.3">
            <p id="section-14.6-2.3.1">
 Revision/extension of labelled NFS to provide true interoperability
 and server-based authorization.<a href="#section-14.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-14.6-2.4">
            <p id="section-14.6-2.4.1">
 Work to provide more security for RDMA-based transports.  This would
 include the peer authentication infrastructure now being developed
 as part of RPC-over-RDMA version 2.   In addition, there is a need
 for an RPC-based transport that provides for encyption, which might
 be provided in  number of ways.<a href="#section-14.6-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="SECCON">
<section id="section-15">
      <h2 id="name-security-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="SECCON-changes">
<section id="section-15.1">
        <h3 id="name-changes-in-security-conside">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-changes-in-security-conside" class="section-name selfRef">Changes in Security Considerations</a>
        </h3>
<p id="section-15.1-1">
 Beyond the needed inclusion of a threat analysis and the fact that
 all minor versions are dealt with together, there are a number of
 substantive changes in the approach to NFSv4 security presented
 in RFCs 7530 and 8881 and that appearing in this document.<a href="#section-15.1-1" class="pilcrow">¶</a></p>
<p id="section-15.1-2">
        This document will not seek to speculate how the previous treatment,
 now viewed as incorrect, came to be written, approved, and published.
 However, it will, for the benefit of those familiar with the
 previous treatment of these matters, draw attention to the
 important  changes listed here.<a href="#section-15.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1-3.1">
            <p id="section-15.1-3.1.1">
   There is a vastly expanded range of threats being considered
   as described in <a href="#SECCON-changes-wider" class="xref">Section 15.1.1</a><a href="#section-15.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-15.1-3.2">
            <p id="section-15.1-3.2.1">
   New facilities available at the RPC transport level can be used
   to deal with security issues, as described in 
   <a href="#SECCON-changes-xport" class="xref">Section 15.1.2</a><a href="#section-15.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="SECCON-changes-wider">
<section id="section-15.1.1">
          <h4 id="name-wider-view-of-threats">
<a href="#section-15.1.1" class="section-number selfRef">15.1.1. </a><a href="#name-wider-view-of-threats" class="section-name selfRef">Wider View of Threats</a>
          </h4>
<p id="section-15.1.1-1">    
   Although the absence of a threat analysis in previous treatments
   makes comparison most difficult, the security-related features
   described in previous specifications and the associated discussion
   in their security considerations sections makes it clear that
   earlier specifications took a quite narrow view of threats to
   be protected against.<a href="#section-15.1.1-1" class="pilcrow">¶</a></p>
<p id="section-15.1.1-2">
   One aspect of that narrow view that merits special attention is
   the handling of AUTH_SYS, at that time in the clear, with no client
   peer authentication.<a href="#section-15.1.1-2" class="pilcrow">¶</a></p>
<p id="section-15.1.1-3">    
   With regard to specific threats, there is no mention in existing
   security consideration sections of:<a href="#section-15.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1.1-4.1">
              <p id="section-15.1.1-4.1.1">
       Denial-of-service attacks.<a href="#section-15.1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.1-4.2">
              <p id="section-15.1.1-4.2.1">
     Client-impersonation attacks.<a href="#section-15.1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.1-4.3">
              <p id="section-15.1.1-4.3.1">
     Server-impersonation attacks.<a href="#section-15.1.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-15.1.1-5">
   The handling of data security in-flight is even more troubling.<a href="#section-15.1.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1.1-6.1">
              <p id="section-15.1.1-6.1.1">
     Although there was considerable work in the protocol to allow
     use of encryption to be negotiated when using RPCSEC_GSS. The
     existing security considerations do not mention the potential
     need for encryption at all.<a href="#section-15.1.1-6.1.1" class="pilcrow">¶</a></p>
<p id="section-15.1.1-6.1.2">
     It is not clear why this was omitted but it is a pattern that
     cannnot repeated in this document.<a href="#section-15.1.1-6.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.1-6.2">
              <p id="section-15.1.1-6.2.1">
     The case of negotiation of integrity services is similar and uses
     the same negotiation infrastructure.<a href="#section-15.1.1-6.2.1" class="pilcrow">¶</a></p>
<p id="section-15.1.1-6.2.2">
     In this case, use of integrity is recommended but not to prevent
     the corruption of user data being read or written.<a href="#section-15.1.1-6.2.2" class="pilcrow">¶</a></p>
<p id="section-15.1.1-6.2.3">
     The use of integrity services is recommended in connetion with
     issuing SECINFO (and for NFSv4.1, SECINFO_NONAME).  The presence
     of this recommendation in the associated security considerations
     sections has the unfortunate effect of suggesting that the
     protection of user data is of relatively low impotance.<a href="#section-15.1.1-6.2.3" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="SECCON-changes-xport">
<section id="section-15.1.2">
          <h4 id="name-transport-layer-security-fa">
<a href="#section-15.1.2" class="section-number selfRef">15.1.2. </a><a href="#name-transport-layer-security-fa" class="section-name selfRef">Transport-layer Security Facilities</a>
          </h4>
<p id="section-15.1.2-1">
   Such transport-level RPC facilitites as RPC-over-TLS provide
   important ways of proving better security for all the NFSv4
   minor versions.<a href="#section-15.1.2-1" class="pilcrow">¶</a></p>
<p id="section-15.1.2-2">
   In particular:<a href="#section-15.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1.2-3.1">
              <p id="section-15.1.2-3.1.1">
     The presence of encryption by default will deal with security
     issue regarding data-in-flight, for both RPCSEC_GSS and AUTH_SYS.<a href="#section-15.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.2-3.2">
              <p id="section-15.1.2-3.2.1">
     Peer authentication provided by the server eliminates the
     possibility of a server-impersonation attack, even when using
     AUTH_SYS.<a href="#section-15.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.2-3.3">
              <p id="section-15.1.2-3.3.1">
     When mutual authentication is part of connection establishment,
     there is a possibility, where an appropriate trust relationship
     exisrts of treating the userid's presented in AUTH_SYS, as
     effectively authenticated, based on the authetication of the
     client peer.<a href="#section-15.1.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="SECCON-changes-compat">
<section id="section-15.1.3">
          <h4 id="name-compatibility-and-maturity-">
<a href="#section-15.1.3" class="section-number selfRef">15.1.3. </a><a href="#name-compatibility-and-maturity-" class="section-name selfRef">Compatibility and Maturity Issues</a>
          </h4>
<p id="section-15.1.3-1">
          Given the need to drastically change the NFSv4 security approach
   from that specified previously, it is necessary for us to be
   mindful of:<a href="#section-15.1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1.3-2.1">
              <p id="section-15.1.3-2.1.1">
     The difficulty that might be faced in adapting to the newer
     guidance because the delays involved in designing, developing,
     and testing new transport- level security facilities such as
     RPC-over-TLS.<a href="#section-15.1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.3-2.2">
              <p id="section-15.1.3-2.2.1">
     The difficulty in discarding or substantially modifying
     previous existing deployments and practices, developed on the
     basis of previous normative guidance.<a href="#section-15.1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-15.1.3-3">    
          For these reasons, we will not use the term "<span class="bcp14">MUST NOT</span>"
   in some situations in which the use of that term might have been
   justified earlier.  In such cases, previous guidance together with
   the passsage of time may have created a situation in which the
   considerations mentioned above in this section may be valid reasons
   to defer, for
   a limited time,
   correction of the current sitution making the term
   "<span class="bcp14">SHOULD NOT</span>" appropriate, since the difficulties
   cited would constitute a valid reason to not allow what hsd been
   recommended against.<a href="#section-15.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-changes-authsys">
<section id="section-15.1.4">
          <h4 id="name-discussion-of-authsys">
<a href="#section-15.1.4" class="section-number selfRef">15.1.4. </a><a href="#name-discussion-of-authsys" class="section-name selfRef">Discussion of AUTHSYS</a>
          </h4>
<p id="section-15.1.4-1">
   An important change concerns the treatment of AUTH_SYS which is now
   divided into two subcases given the possible availabillity of
   support from the transport layer.<a href="#section-15.1.4-1" class="pilcrow">¶</a></p>
<p id="section-15.1.4-2">
   When such support is not available, AUTH_SYS
   <span class="bcp14">SHOULD NOT</span> be used, since it makes the following
   attacks quite easy to execute:<a href="#section-15.1.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.1.4-3.1">
              <p id="section-15.1.4-3.1.1">
     The absence of authentication of the server to the client
     allow server impersonation in which an imposter server can
     obtain data to be written by the user and supply corrupted data
     to read requests.<a href="#section-15.1.4-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.4-3.2">
              <p id="section-15.1.4-3.2.1">
     The absence of authentication of the client user to the server
     allow server impersonation in which an imposter client can
     issue requests and have them executed as a user designated by
     imposter client, vitiating the server's authorization policy.<a href="#section-15.1.4-3.2.1" class="pilcrow">¶</a></p>
<p id="section-15.1.4-3.2.2">
     With no authentication of the client peer, common approaches,
     such as using the source IP address can be easily defeated,
     allowing unauthenticated execution of requests made by the
     pseudo clients<a href="#section-15.1.4-3.2.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-15.1.4-3.3">
              <p id="section-15.1.4-3.3.1">
     The absence of any support to protect data-in-flight when AUTH_SYS
     is used result in further serious security weaknesses.<a href="#section-15.1.4-3.3.1" class="pilcrow">¶</a></p>
<p id="section-15.1.4-3.3.2"></p>
<p id="section-15.1.4-3.3.3"></p>
</li>
          </ul>
<p id="section-15.1.4-4">
   In connection with the use of the term "<span class="bcp14">SHOULD NOT</span>"
   above, it is understood that the "valid reasons" to use this form
   of access reflect the Compatibility and Maturity Issue discussed
   above in <a href="#SECCON-changes-compat" class="xref">Section 15.1.3</a> and that it is
   expected that, over time, these will become less applicable.<a href="#section-15.1.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="SECCON-scope">
<section id="section-15.2">
        <h3 id="name-security-considerations-sco">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-security-considerations-sco" class="section-name selfRef">Security Considerations Scope</a>
        </h3>
<div id="SECCON-scope-levels">
<section id="section-15.2.1">
          <h4 id="name-discussion-of-potential-cla">
<a href="#section-15.2.1" class="section-number selfRef">15.2.1. </a><a href="#name-discussion-of-potential-cla" class="section-name selfRef">Discussion of Potential Classification of Environments</a>
          </h4>
<p id="section-15.2.1-1">
   [Working group discussion needed]: For now, we will not consider
   different security policies for different sorts of environments.
   This is because,<a href="#section-15.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.2.1-2.1">
     Doing so would add considrable complexity to this document.<a href="#section-15.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-15.2.1-2.2">
     The additional complexity would undecut our main goal here, which
     is to discuss secure use on the internet, which remain an
     important NFSv4 goal.<a href="#section-15.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-15.2.1-2.3">
     The ubiquity of internet acess makes it hard to treat corporate
     network separately from the internet per se.<a href="#section-15.2.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-15.2.1-2.4">
     While small networks might be sufficiently isolated to make
     it reasonable use NFSv4 without serious attention to
     security issues, the complexity of characterizing the necessary
     isolation makes it impractical to deal with such cases in this
     document.<a href="#section-15.2.1-2.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="SECCON-scope-env">
<section id="section-15.2.2">
          <h4 id="name-discussion-of-environments">
<a href="#section-15.2.2" class="section-number selfRef">15.2.2. </a><a href="#name-discussion-of-environments" class="section-name selfRef">Discussion of Environments</a>
          </h4>
<p id="section-15.2.2-1">
   Although the security goal for Nfsv4 has been and remains
   "secure use on the internet", much use of NFSv4 occurs on more
   restricted IP networks with NFS access from outside the owning
   organization prevented by firewalls.<a href="#section-15.2.2-1" class="pilcrow">¶</a></p>
<p id="section-15.2.2-2">
   This security considerations section will not deal separately
   with such environments since the threats that need to be discussed
   are essentially the same, despite the assumption by many that
   the restricted network access would eliminate the possibility
   of attacks originating inside the network by attackers who have
   some legitimate Nfsv4 access within it.<a href="#section-15.2.2-2" class="pilcrow">¶</a></p>
<p id="section-15.2.2-3">
          In organizations of significant size, this sort of assumption of
   trusted access is usually not valid and this document will not
   deal with them explicitly.  In any case, there is little point in
   doing so, since, if everyone can be trusted, there can be no
   attackers, rendering threat analysis superfluous.<a href="#section-15.2.2-3" class="pilcrow">¶</a></p>
<p id="section-15.2.2-4">
   This does not mean that NFSv4 use cannot, as a practical matter,
   be made secure through means outside the scope of this document
   including strict administrative controls on all software running
   within it, frequent polygraph tests, and threats of prosecution.
   However, this document is not prepared to discuss the details of 
   such policies, their implementation, or legal issues associated
   with them and treats
   such matters as out-of-scope.<a href="#section-15.2.2-4" class="pilcrow">¶</a></p>
<p id="section-15.2.2-5">
   Nfsv4 can be used in very restrictive IP network environments
   where outside access is quite restricted and there is sufficient
   trust to allow, for example, every node to have the same root
   password. The case of a simple network only accessible by a
   single user is similar.  In such networks, many thing thats this
   document says "SHOULD NOT" be done are unexceptionable but the
   responsibility for making that determination is one for those
   creating such networks to take on. This document will not deal
   further with NFSv4 use on such networks.<a href="#section-15.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="SECCON-major">
<section id="section-15.3">
        <h3 id="name-major-new-recommendations">
<a href="#section-15.3" class="section-number selfRef">15.3. </a><a href="#name-major-new-recommendations" class="section-name selfRef">Major New Recommendations</a>
        </h3>
<div id="SECCON-major-data">
<section id="section-15.3.1">
          <h4 id="name-recommendations-regarding-s">
<a href="#section-15.3.1" class="section-number selfRef">15.3.1. </a><a href="#name-recommendations-regarding-s" class="section-name selfRef">Recommendations Regarding Security of Data in Flight</a>
          </h4>
<p id="section-15.3.1-1">
          We RECOMMEND that requesters always issue requests with data
   security (i.e. with protection from disclosure or modification
   in flight) whether provided at the RPC request level or by the
   RPC transport, irrespective of the responder's requirements.<a href="#section-15.3.1-1" class="pilcrow">¶</a></p>
<p id="section-15.3.1-2">
          We RECOMMEND that implementers provide servers the ability
   to configure policies in which requests without data security
   will be rejected as having insufficient security.<a href="#section-15.3.1-2" class="pilcrow">¶</a></p>
<p id="section-15.3.1-3">
          We RECOMMEND that servers use such policies over either their
   entire local namespace or for all file systems except those
   clearly designed for the general dissemination of non-sensitive data.<a href="#section-15.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-major-cpeer">
<section id="section-15.3.2">
          <h4 id="name-recommendations-regarding-c">
<a href="#section-15.3.2" class="section-number selfRef">15.3.2. </a><a href="#name-recommendations-regarding-c" class="section-name selfRef">Recommendations Regarding Client Peer Authentication</a>
          </h4>
<p id="section-15.3.2-1">
          We RECOMMEND that clients provide authentication material
   whenever a connection is established with a server capable
   of using it to provide client peer authentication.<a href="#section-15.3.2-1" class="pilcrow">¶</a></p>
<p id="section-15.3.2-2">
          We RECOMMEND that implementers provide servers the ability to
   configure policies in which attempts to establish connections
   without client peer authentication will be rejected.<a href="#section-15.3.2-2" class="pilcrow">¶</a></p>
<p id="section-15.3.2-3">
          We RECOMMEND that servers adopt such policies whenever requests
   not using RPCSEC_GSS are allowed to be executed.<a href="#section-15.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-major-bypass">
<section id="section-15.3.3">
          <h4 id="name-issues-regarding-valid-reas">
<a href="#section-15.3.3" class="section-number selfRef">15.3.3. </a><a href="#name-issues-regarding-valid-reas" class="section-name selfRef">Issues Regarding Valid Reasons to Bypass Recommendations</a>
          </h4>
<p id="section-15.3.3-1">
          Clearly, the maturity and compatibility issues mentioned in
   <a href="#SECCON-changes-compat" class="xref">Section 15.1.3</a> are valid reasons to
   nypass the above recommenations, as loong as thse issues
   continue to exist.<a href="#section-15.3.3-1" class="pilcrow">¶</a></p>
<p id="section-15.3.3-2">
   [Working group discussion needed}: The question the working group
   needs to address is whether other valid reasons exist.<a href="#section-15.3.3-2" class="pilcrow">¶</a></p>
<p id="section-15.3.3-3">
   [Working group discussion needed}: In particular, some members of
   the group might feel that the performance cost of encrypted
   transports constitutes, in itself, a valid reason to ignore the
   above recommendations.<a href="#section-15.3.3-3" class="pilcrow">¶</a></p>
<p id="section-15.3.3-4">
          [Working group discussion needed}: I cannot agree and feel that
   accepting that as a valid reason would undercut Nfsv4 security
   improvement, and probably would not be acceptable to the
   security directorate.  However, I do want to work out an a
   generally acceptable compromise.  I propose something along
   the following lines:<a href="#section-15.3.3-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.3.3-5.1">
            The transport-based encryption facilities are designed to be
     compatible with facilities to offload the work of encryption
     and decryption.  When such facilities are not available, at a
     reasonable cost, to NFSv4 servers and clients anticipating
     heavy use of NFSv4, then the lack of such facilities can be
     considered a valid reason to bypass the above recommendations,
     as long as that situation continues.<a href="#section-15.3.3-5.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="SECCON-data">
<section id="section-15.4">
        <h3 id="name-data-security-threats">
<a href="#section-15.4" class="section-number selfRef">15.4. </a><a href="#name-data-security-threats" class="section-name selfRef">Data Security Threats</a>
        </h3>
<p id="section-15.4-1">
 [TBD in -01]<a href="#section-15.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-auth">
<section id="section-15.5">
        <h3 id="name-authentication-based-threat">
<a href="#section-15.5" class="section-number selfRef">15.5. </a><a href="#name-authentication-based-threat" class="section-name selfRef">Authentication-based threats</a>
        </h3>
<div id="SECCON-auth-sys">
<section id="section-15.5.1">
          <h4 id="name-attacks-based-on-the-use-of">
<a href="#section-15.5.1" class="section-number selfRef">15.5.1. </a><a href="#name-attacks-based-on-the-use-of" class="section-name selfRef">Attacks based on the use of AUTH_SYS</a>
          </h4>
<p id="section-15.5.1-1">
   [TBD in -01]<a href="#section-15.5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-auth-mapping">
<section id="section-15.5.2">
          <h4 id="name-attacks-on-name-userid-mapp">
<a href="#section-15.5.2" class="section-number selfRef">15.5.2. </a><a href="#name-attacks-on-name-userid-mapp" class="section-name selfRef">Attacks on Name/Userid Mapping Facilities</a>
          </h4>
<p id="section-15.5.2-1">
   [TBD in -01]<a href="#section-15.5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="SECCON-denial">
<section id="section-15.6">
        <h3 id="name-disruption-and-denial-of-se">
<a href="#section-15.6" class="section-number selfRef">15.6. </a><a href="#name-disruption-and-denial-of-se" class="section-name selfRef">Disruption and Denial-of-Service Attacks</a>
        </h3>
<div id="SECCON-denial-disrupt">
<section id="section-15.6.1">
          <h4 id="name-attacks-based-on-the-disrup">
<a href="#section-15.6.1" class="section-number selfRef">15.6.1. </a><a href="#name-attacks-based-on-the-disrup" class="section-name selfRef">Attacks Based on the Disruption of Client-Server Shared State</a>
          </h4>
<p id="section-15.6.1-1">
   [TBD in -01]<a href="#section-15.6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SECCON-denial-resource">
<section id="section-15.6.2">
          <h4 id="name-attacks-based-on-forcing-th">
<a href="#section-15.6.2" class="section-number selfRef">15.6.2. </a><a href="#name-attacks-based-on-forcing-th" class="section-name selfRef">Attacks Based on Forcing the Misuse of Server Resources</a>
          </h4>
<p id="section-15.6.2-1">
   [TBD in -01]<a href="#section-15.6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-16">
      <h2 id="name-iana-considerations">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-16-1">
      Because of the shift from implementing security-related services
      only in connection with RPCSEC_GSS to one in which transport-level
      security has a prominent role, a number if new values need to be
      assigned.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">
      These include new authstat values to guide selection of a
      Transports aceptable to both client and server, presented in
      <a href="#IANA-authstat" class="xref">Section 16.1</a> and new pseudo-flavors to be used
      in the process of security negotion, presented in
      <a href="#IANA-flavors" class="xref">Section 16.2</a>.<a href="#section-16-2" class="pilcrow">¶</a></p>
<div id="IANA-authstat">
<section id="section-16.1">
        <h3 id="name-new-authstat-values">
<a href="#section-16.1" class="section-number selfRef">16.1. </a><a href="#name-new-authstat-values" class="section-name selfRef">New Authstat Values</a>
        </h3>
<p id="section-16.1-1">
 The following new authstat values are necessary to enable a
 server to indicate that the server's policy does not allows
 requests to be made on the current connection because of
 security issues associated with the rpc transport.  In the
 event they are received, the client needs to establish a new
 connection.<a href="#section-16.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.1-2.1">
            <p id="section-16.1-2.1.1">
   The value XP_CRYPT indicates that the server will not support
   access using unencrypted connections while the current connection
   is not encrypted.<a href="#section-16.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-16.1-2.2">
            <p id="section-16.1-2.2.1">
   The value XP_CPAUTH indicates that the server will not support
   access using connections for which the client peer has not
   authenticated itelf as part of connection while the current
   connection has not been set up in that way.<a href="#section-16.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="IANA-flavors">
<section id="section-16.2">
        <h3 id="name-new-authentication-pseudo-f">
<a href="#section-16.2" class="section-number selfRef">16.2. </a><a href="#name-new-authentication-pseudo-f" class="section-name selfRef">New Authentication Pseudo-Flavors</a>
        </h3>
<p id="section-16.2-1">
 The following new pseudo-flavors are made available to allow their
 return as part of the response to SECINFO operation described
 in <a href="#NEGO-secinfo" class="xref">Section 14.5</a> and for similar operations.<a href="#section-16.2-1" class="pilcrow">¶</a></p>
<p id="section-16.2-2">
 [TBD in -01]<a href="#section-16.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="DUMMY">
<section id="section-17">
      <h2 id="name-dummy-sections">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-dummy-sections" class="section-name selfRef">Dummy Sections</a>
      </h2>
<div id="AUTHFA-acl-ace">
<section id="section-17.1">
        <h3 id="name-dummy-section-authfa-acl-ac">
<a href="#section-17.1" class="section-number selfRef">17.1. </a><a href="#name-dummy-section-authfa-acl-ac" class="section-name selfRef">Dummy Section AUTHFA-acl-ace</a>
      </h3>
</section>
</div>
<div id="AUTHFA-acl-aclsupport">
<section id="section-17.2">
        <h3 id="name-dummy-section-authfa-acl-acl">
<a href="#section-17.2" class="section-number selfRef">17.2. </a><a href="#name-dummy-section-authfa-acl-acl" class="section-name selfRef">Dummy Section AUTHFA-acl-aclsupport</a>
      </h3>
</section>
</div>
</section>
</div>
<section id="section-18">
      <h2 id="name-references">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-18.1">
        <h3 id="name-normative-references">
<a href="#section-18.1" class="section-number selfRef">18.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[1]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2203">[2]</dt>
        <dd>
<span class="refAuthor">Eisler, M.</span>, <span class="refAuthor">Chiu, A.</span>, and <span class="refAuthor">L. Ling</span>, <span class="refTitle">"RPCSEC_GSS Protocol Specification"</span>, <span class="seriesInfo">RFC 2203</span>, <span class="seriesInfo">DOI 10.17487/RFC2203</span>, <time datetime="1997-09" class="refDate">September 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2203">https://www.rfc-editor.org/info/rfc2203</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2743">[3]</dt>
        <dd>
<span class="refAuthor">Linn, J.</span>, <span class="refTitle">"Generic Security Service Application Program Interface Version 2, Update 1"</span>, <span class="seriesInfo">RFC 2743</span>, <span class="seriesInfo">DOI 10.17487/RFC2743</span>, <time datetime="2000-01" class="refDate">January 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2743">https://www.rfc-editor.org/info/rfc2743</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5531">[4]</dt>
        <dd>
<span class="refAuthor">Thurlow, R.</span>, <span class="refTitle">"RPC: Remote Procedure Call Protocol Specification Version 2"</span>, <span class="seriesInfo">RFC 5531</span>, <span class="seriesInfo">DOI 10.17487/RFC5531</span>, <time datetime="2009-05" class="refDate">May 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5531">https://www.rfc-editor.org/info/rfc5531</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[5]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7530">[6]</dt>
        <dd>
<span class="refAuthor">Haynes, T., Ed.</span> and <span class="refAuthor">D. Noveck, Ed.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Protocol"</span>, <span class="seriesInfo">RFC 7530</span>, <span class="seriesInfo">DOI 10.17487/RFC7530</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7530">https://www.rfc-editor.org/info/rfc7530</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7531">[7]</dt>
        <dd>
<span class="refAuthor">Haynes, T., Ed.</span> and <span class="refAuthor">D. Noveck, Ed.</span>, <span class="refTitle">"Network File System (NFS) Version 4 External Data Representation Standard (XDR) Description"</span>, <span class="seriesInfo">RFC 7531</span>, <span class="seriesInfo">DOI 10.17487/RFC7531</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7531">https://www.rfc-editor.org/info/rfc7531</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8881">[8]</dt>
        <dd>
<span class="refAuthor">Noveck, D., Ed.</span> and <span class="refAuthor">C. Lever</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 1 Protocol"</span>, <span class="seriesInfo">RFC 8881</span>, <span class="seriesInfo">DOI 10.17487/RFC8881</span>, <time datetime="2020-08" class="refDate">August 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8881">https://www.rfc-editor.org/info/rfc8881</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5662">[9]</dt>
        <dd>
<span class="refAuthor">Shepler, S., Ed.</span>, <span class="refAuthor">Eisler, M., Ed.</span>, and <span class="refAuthor">D. Noveck, Ed.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 1 External Data Representation Standard (XDR) Description"</span>, <span class="seriesInfo">RFC 5662</span>, <span class="seriesInfo">DOI 10.17487/RFC5662</span>, <time datetime="2010-01" class="refDate">January 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5662">https://www.rfc-editor.org/info/rfc5662</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7862">[10]</dt>
        <dd>
<span class="refAuthor">Haynes, T.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 2 Protocol"</span>, <span class="seriesInfo">RFC 7862</span>, <span class="seriesInfo">DOI 10.17487/RFC7862</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7862">https://www.rfc-editor.org/info/rfc7862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7863">[11]</dt>
        <dd>
<span class="refAuthor">Haynes, T.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 2 External Data Representation Standard (XDR) Description"</span>, <span class="seriesInfo">RFC 7863</span>, <span class="seriesInfo">DOI 10.17487/RFC7863</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7863">https://www.rfc-editor.org/info/rfc7863</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-nfsv4-rpc-tls">[12]</dt>
      <dd>
<span class="refAuthor">Myklebust, T.</span> and <span class="refAuthor">C. Lever</span>, <span class="refTitle">"Towards Remote Procedure Call Encryption By Default"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-nfsv4-rpc-tls-11</span>, <time datetime="2020-11-23" class="refDate">23 November 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-nfsv4-rpc-tls-11">https://datatracker.ietf.org/doc/html/draft-ietf-nfsv4-rpc-tls-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-18.2">
        <h3 id="name-informative-references">
<a href="#section-18.2" class="section-number selfRef">18.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC8257">[13]</dt>
      <dd>
<span class="refAuthor">Bensley, S.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Balasubramanian, P.</span>, <span class="refAuthor">Eggert, L.</span>, and <span class="refAuthor">G. Judd</span>, <span class="refTitle">"Data Center TCP (DCTCP): TCP Congestion Control for Data Centers"</span>, <span class="seriesInfo">RFC 8257</span>, <span class="seriesInfo">DOI 10.17487/RFC8257</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8257">https://www.rfc-editor.org/info/rfc8257</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="CHG">
<section id="appendix-A">
      <h2 id="name-changes-made">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-changes-made" class="section-name selfRef">Changes Made</a>
      </h2>
<p id="appendix-A-1">
      This section summarizes the substantive changes between the treatment
      of security in previous minor version specification documents
      (i.e. RFCs 7530 and 8881) and the new treatment applying to NFSv4 as
      a whole.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">
      This is expected to be helpful to implementers familiar with previous
      specifications but also has an important role in verifying the working
      group consensus for these changes and in guiding the search for
      potential compatibility issues.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div id="CHG-motive">
<section id="appendix-A.1">
        <h3 id="name-motivating-changes">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-motivating-changes" class="section-name selfRef">Motivating Changes</a>
        </h3>
<p id="appendix-A.1-1">
        A number of changes reflect the basic motivation for a new
 treatment of NFSv4 security.  These include the ability to
 obtain privacy and integrity services from the RPC transport
 rather than as a service ancillary to a specific authentication
 flavor.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">
 This motivated a major reorganization of the treatment of
 security together with a needed emphasis on the security of
 data in flight.  In addition, the security negotiation framework
 for NFSv4 has been significantly enhanced to support the
 combined negotiation of authentication-related services and
 transport characteristics.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">
 Despite these major changes there are not expected to be
 compatibility issues between peers supporting secure transport
 characteristics and those without such support.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1-4">
 Another such change was in the treatment of AUTH_SYS, previously
 described, inaccurately, as an "OPTIONAL means of authentication"
 with the unfortunate use of the RFC2119 keyword obscuring the negative
 consequences of the typical use of AUTH_SYS (in the clear;
 without client-peer authentication) for security by enabling the
 execution of unauthenticated requests.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<p id="appendix-A.1-5">
        The new treatment avoids the inappropriate use of term
 "authentication" for all activities triggered by the use of RPC
 authentication flavors and clearly distinguishes those flavors
 providing authentication from those procinding identification only
 or neither identification nor authentication.<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CHG-other">
<section id="appendix-A.2">
        <h3 id="name-other-changes">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-other-changes" class="section-name selfRef">Other Changes</a>
        </h3>
<p id="appendix-A.2-1">
 The need to make the major changes discussed in
 <a href="#CHG-motive" class="xref">Appendix A.1</a> has meant that much text dealing
 with security has needed to be significantly revised or
 rewritten.  As a result of the process, may issues involving
 unclear, inconsistent, or otherwise inappropriate text were
 uncovered and needed to be dealt with.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">
 While the author believes such changes are necessary, the fact
 that we are changing a document adopted by consensus requires
 the working group to be clear about the acceptability of the
 changes.   This applies to both the troublesome issues
 discussed in <a href="#INTRO-tbd" class="xref">Section 3.4</a> and to the other
 changes included below.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-3">
 Because of concurrent re-organizations, the ordering of the
 list  follows the text of the current version which may differ
 considrably from that in earlier versions of the I-D.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-4.1">
            <p id="appendix-A.2-4.1.1">
   In order to deal better with the fact that ACLs have multiple uses
   some signifcant structural changes have been made.<a href="#appendix-A.2-4.1.1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4.1.2">
   <a href="#ACL" class="xref">Section 4</a>, a new top-level section describes the
   the structure of ACLs,<a href="#appendix-A.2-4.1.2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4.1.3"></p>
<p id="appendix-A.2-4.1.4"></p>
</li>
          <li class="normal" id="appendix-A.2-4.2">
            <p id="appendix-A.2-4.2.1">
   In <a href="#AUTHFA-two" class="xref">Section 6.1</a>,
   makes clear that owner and owner group are essentially
   <span class="bcp14">REQUIRED</span> attributes.<a href="#appendix-A.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-4.3">
            <p id="appendix-A.2-4.3.1">
   Also in <a href="#AUTHFA-two" class="xref">Section 6.1</a>,
   there is added clarity in the discussion of support for multiple
   authorization approaches by
   eliminating use of the subjective term "reasonable semantics".<a href="#appendix-A.2-4.3.1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4.3.2">
   In connection with this clarification, we mave switched from
   describing the needed co-ordination between modes and acls
   as "goals" to describing them as "requirements" to give
   clients some basis for expecting interoperability in handling
   these issues.<a href="#appendix-A.2-4.3.2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4.3.3">
   As a result of this shift to a prescriptive framework applying
   to all minor versions it becomes possible to treat all minor
   versions together.  In earlier versions of this document, it had
   been assumed that v4.0 was free to ignore the relevant
   prescriptions first put forth in RFC 5661 and only needed to
   address the "goals" for this co-ordination.<a href="#appendix-A.2-4.3.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-4.4">
            <p id="appendix-A.2-4.4.1"></p><a href="#appendix-A.2-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.2-4.5">
            <p id="appendix-A.2-4.5.1"></p><a href="#appendix-A.2-4.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="ACK">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">
      The author wishes to thank Tom Haynes for his helpful suggestion
      to deal with security for all NFSv4 minor versions in the same
      document.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">
      The author wishes to draw people's attention to Nico Williams'
      remark that NFSv4 security was not so bad, except that there was
      no provision for authentication of the client peer.  This
      perceptive remark, which now seems like common sense, did not seem
      so when made, but it has served as a beacon for those putting NFSv4
      security on a firmer footing.  Our gratitude is appropriate.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">
      The author wishes to acknowledge the important role of the authors
      of RPC-with-TLS, Chuck Lever and Trond Myklebust, in moving the
      NFS security agenda forward and thank them for all their efforts
      to improve NFS security.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">
      The author wishes to thank Chuck Lever for his many helpful
      comments about nfsv4 security issues, his explanation of many
      unclear points, and and much important guidance he provided that
      is reflected in this document.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<p id="appendix-B-5">
      The author wishes to thank Rick Macklem for his role in
      clarifying possible server policies regarding RPC-over-TLS
      and bringing possible approaches to the attention of the working group.<a href="#appendix-B-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Noveck (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">NetApp</span></div>
<div dir="auto" class="left"><span class="street-address">1601 Trapelo Road, Suite 16</span></div>
<div dir="auto" class="left">
<span class="locality">Waltham</span>, <span class="region">MA</span> <span class="postal-code">02451</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1-781-572-8038" class="tel">+1-781-572-8038</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:davenoveck@gmail.com" class="email">davenoveck@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
