<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>A SASL & GSS-API Mechanism for OpenID </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Applicability">
<link href="#rfc.section.2" rel="Chapter" title="2 Applicability for non-HTTP Use Cases">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Binding SASL to OpenID in the Relying Party">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Discussion">
<link href="#rfc.section.3" rel="Chapter" title="3 OpenID SASL Mechanism Specification">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Initiation">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Authentication Request">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Server Response">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Error Handling">
<link href="#rfc.section.4" rel="Chapter" title="4 OpenID GSS-API Mechanism Specification">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 GSS-API Principal Name Types for OpenID">
<link href="#rfc.section.5" rel="Chapter" title="5 Example">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Binding OpenIDs to Authorization Identities">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 RP redirected by malicious URL to take an improper action">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 User Privacy">
<link href="#rfc.section.7" rel="Chapter" title="7 Room for Improvement">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Changes">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="OpenID has found its usage on the Internet for Web Single Sign-On. Simple Authentication and Security Layer (SASL) and the Generic Security Service Application Program Interface (GSS-API) are application frameworks to generalize authentication. This memo specifies a SASL and GSS-API mechanism for OpenID that allows the integration of existing OpenID Identity Providers with applications using SASL and GSS-API." />
  <meta name="description" content="OpenID has found its usage on the Internet for Web Single Sign-On. Simple Authentication and Security Layer (SASL) and the Generic Security Service Application Program Interface (GSS-API) are application frameworks to generalize authentication. This memo specifies a SASL and GSS-API mechanism for OpenID that allows the integration of existing OpenID Identity Providers with applications using SASL and GSS-API." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">E. Lear</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Cisco Systems GmbH</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">H. Tschofenig</td>
</tr>
<tr>
<td class="left">Expires: March 31, 2012</td>
<td class="right">Nokia Siemens Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">H. Mauldin</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Cisco Systems, Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">S. Josefsson</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">SJD AB</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">September 28, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">A SASL & GSS-API Mechanism for OpenID <br />
  <span class="filename">draft-ietf-kitten-sasl-openid-06</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>OpenID has found its usage on the Internet for Web Single Sign-On. Simple Authentication and Security Layer (SASL) and the Generic Security Service Application Program Interface (GSS-API) are application frameworks to generalize authentication. This memo specifies a SASL and GSS-API mechanism for OpenID that allows the integration of existing OpenID Identity Providers with applications using SASL and GSS-API.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on March 31, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Terminology</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Applicability</a>
</li>
<li>2.   <a href="#rfc.section.2">Applicability for non-HTTP Use Cases</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Binding SASL to OpenID in the Relying Party</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Discussion</a>
</li>
<li>3.   <a href="#rfc.section.3">OpenID SASL Mechanism Specification</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Initiation</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Authentication Request</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Server Response</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Error Handling</a>
</li>
<li>4.   <a href="#rfc.section.4">OpenID GSS-API Mechanism Specification</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">GSS-API Principal Name Types for OpenID</a>
</li>
<li>5.   <a href="#rfc.section.5">Example</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Binding OpenIDs to Authorization Identities</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">RP redirected by malicious URL to take an improper action</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">User Privacy</a>
</li>
<li>7.   <a href="#rfc.section.7">Room for Improvement</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgments</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Changes</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p><a href="#OpenID">OpenID</a> <cite title="NONE">[OpenID]</cite> is a web-based three-party protocol that provides a means for a user to offer identity assertions and other attributes to a web server (Relying Party) via the help of an identity provider. The purpose of this system is to provide a way to verify that an end user controls an identifier.</p>
<p><a href="#RFC4422">Simple Authentication and Security Layer (SASL)</a> <cite title="NONE">[RFC4422]</cite>  (SASL) is used by application protocols such <a href="#RFC3501">IMAP</a> <cite title="NONE">[RFC3501]</cite>, <a href="#RFC1939">POP</a> <cite title="NONE">[RFC1939]</cite> and <a href="#RFC3920">XMPP</a> <cite title="NONE">[RFC3920]</cite>, with the goal of modularizing authentication and security layers, so that newer mechanisms can be added as needed. This memo specifies just such a mechanism. </p>
<p id="rfc.section.1.p.3">The <a href="#RFC2743">Generic Security Service Application Program Interface (GSS-API)</a> <cite title="NONE">[RFC2743]</cite> provides a framework for applications to support multiple authentication mechanisms through a unified interface.  This document defines a pure SASL mechanism for OpenID, but it conforms to the new bridge between SASL and the GSS-API called <a href="#RFC5801">GS2</a> <cite title="NONE">[RFC5801]</cite>.  This means that this document defines both a SASL mechanism and a GSS-API mechanism.  Implementors of the SASL component MAY implement the GSS-API interface as well.  </p>
<p id="rfc.section.1.p.4">As currently envisioned, this mechanism is to allow the interworking between SASL and OpenID in order to assert identity and other attributes to relying parties. As such, while servers (as relying parties) will advertise SASL mechanisms, clients will select the OpenID mechanism. </p>
<p id="rfc.section.1.p.5">The OpenID mechanism described in this memo aims to re-use the OpenID mechanism to the maximum extent and therefore does not establish a separate authentication, integrity and confidentiality mechanism. It is anticipated that existing security layers, such as <a href="#RFC5246">Transport Layer Security (TLS)</a> <cite title="NONE">[RFC5246]</cite>, will continued to be used.  This specification is appropriate for use when a browser is available.  </p>
<p><a href="#overview">Figure 1</a> describes the interworking between OpenID and SASL.  This document requires enhancements to the Relying Party and to the Client (as the two SASL communication end points) but no changes to the OpenID Provider (OP) are necessary. To accomplish this goal indirect messaging required by the OpenID specification is tunneled through the SASL/GSS-API mechanism.</p>
<div id="#rfc.figure.1"></div>
<div id="#overview"></div>
<pre>
                                 +-----------+
                                 |           |
                                &gt;|  Relying  |
                               / |  Party    |
                             //  |           |
                           //    +-----------+
                         //            ^
                OpenID //           +--|--+
                     //             | O|  | G
                    /             S | p|  | S
                  //              A | e|  | S
                //                S | n|  | A
              //                  L | I|  | P
            //                      | D|  | I
          &lt;/                        +--|--+
   +------------+                      v
   |            |                 +----------+
   |  OpenID    |   OpenID        |          |
   |  Provider  |&lt;---------------&gt;|  Client  |
   |            |                 |          |
   +------------+                 +----------+
</pre>
<p></p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119 <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.1.1.p.2">The reader is assumed to be familiar with the terms used in the OpenID 2.0 specification.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#applicability" id="applicability">Applicability</a>
</h1>
<p id="rfc.section.1.2.p.1">Because this mechanism transports information that should not be controlled by an attacker, the OpenID mechanism MUST only be used over channels protected by TLS, and the client MUST successfully validate the server certificate, or similar integrity protected and authenticated channels. <a href="#RFC5280">[RFC5280]</a><a href="#RFC6125">[RFC6125]</a></p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Applicability for non-HTTP Use Cases</h1>
<p id="rfc.section.2.p.1">OpenID was originally envisioned for <a href="#RFC2616">HTTP</a> <cite title="NONE">[RFC2616]</cite> and <a href="#W3C.REC-html401-19991224">HTML</a> <cite title="NONE">[W3C.REC-html401-19991224]</cite> based communications, and with the associated semantic, the idea being that the user would be redirected by the Relying Party to an identity provider who authenticates the user, and then sends identity information and other attributes (either directly or indirectly) to the Relying Party.  The identity provider in the OpenID specifications is referred to as an OpenID Provider (OP). The actual protocol flow, as copied from the OpenID 2.0 specification, is as follows: </p>
<p></p>

<ol>
<li>The end user initiates authentication by presenting a User-Supplied Identifier to the Relying Party via their User-Agent (e.g., https://user.example.com).</li>
<li>After normalizing the User-Supplied Identifier as described in Section 7.2 of <a href="#OpenID">[OpenID]</a>, the Relying Party performs discovery on the URI specified and establishes the OP Endpoint URL that the end user uses for authentication. It should be noted that the User-Supplied Identifier may be an OP Identifier, which allows selection of a Claimed Identifier at the OP or for the protocol to proceed without a Claimed Identifier if something else useful is being done via an extension. </li>
<li>The Relying Party and the OP optionally establish an association -- a shared secret established using Diffie-Hellman Key Exchange. The OP uses an association to sign subsequent messages and the Relying Party to verify those messages; this removes the need for subsequent direct requests to verify the signature after each authentication request/response. This process is desccribed in Section 8 of <a href="#OpenID">[OpenID]</a>.</li>
<li>The Relying Party redirects the end user's User-Agent to the OP with an OpenID Authentication request. This occurs as stated in Section 10.3 of <a href="#RFC2616">[RFC2616]</a>.</li>
<li>The OP authenticates the end user and establishes whether the end user will authenticate to, and share specific attributes with, the Relying Party.  For instance, the OP often asks the user what to do.  The manner in which the end user authenticates to their OP and any policies surrounding such authentication is out of scope of OpenID. </li>
<li>The OP redirects the end user's User-Agent back to the Relying Party with either an assertion that authentication is approved or a message that authentication failed.</li>
<li>The Relying Party verifies the information received from the OP including checking the Return URL, verifying the discovered information, checking the nonce, and verifying the signature by using either the shared key established during the association or by sending a direct request to the OP. </li>
</ol>

<p> </p>
<p id="rfc.section.2.p.3">When considering this flow in the context of SASL, we note that while the RP and the client both need to change their code to implement this SASL mechanism, it is a design constraint that the OP behavior remain untouched, in order for implementations to interoperate with existing IdPs.  Hence, an analog flow that interfaces the three parties needs to be created.  In the analog, we note that unlike a web server, the SASL server already has some sort of session (probably a TCP connection) established with the client.  However, it may be necessary for a SASL client to invoke to another application.  This will be discussed below.  By doing so, we externalize much of the authentiction from SASL.  </p>
<p id="rfc.section.2.p.4">The steps are listed below:</p>
<p></p>

<ol>
<li>The Relying Party or SASL server advertises support for the SASL OpenID mechanism to the client. </li>
<li>The client initiates a SASL authentication and transmits the User-Supplied Identifier as its first response.  The SASL mechanism is client-first, and as explained in <a href="#RFC4422">[RFC4422]</a> the server will send an empty challenge if needed.</li>
<li>After normalizing the User-Supplied Identifier as discussed in <a href="#OpenID">[OpenID]</a>, the Relying Party performs discovery on it and establishes the OP Endpoint URL that the end user uses for authentication.</li>
<li>The Relying Party and the OP optionally establish an association -- a shared secret established using Diffie-Hellman Key Exchange. The OP uses an association to sign subsequent messages and the Relying Party to verify those messages; this removes the need for subsequent direct requests to verify the signature after each authentication request/response. </li>
<li>The Relying Party transmits an authentication request to the OP to obtain an assertion in the form of an indirect request. These messages are passed through the client rather than directly between the RP and the OP. OpenID defines two methods for indirect communication, namely HTTP redirects and HTML form submission. Both mechanisms are not directly applicable for usage with SASL. To ensure that a standard OpenID 2.0 capable OP can be used a new method is defined in this document that requires the OpenID message content to be encoded using a <a href="#RFC3986">Universal Resource Idenitifier (URI).</a> <cite title="NONE">[RFC3986]</cite> </li>
<li>The SASL client now sends an response consisting of "=", to indicate that authentication continues via the normal OpenID flow.  </li>
<li>At this point the client application MUST construct a URL containing the content received in the previous message from the RP. This URL is transmitted to the OP either by the SASL client application or an appropriate handler, such as a browser.</li>
<li>Next the client optionally authenticates to the OP and then approves or disapproves authentication to the Relying Party.  The manner in which the end user is authenticated to their respective OP and any policies surrounding such authentication is out of scope of OpenID and and hence also out of scope for this specification. This step happens out of band from SASL.</li>
<li>The OP will convey information about the success or failure of the authentication phase back to the RP, again using an indirect response via the client browser or handler.  The client transmits over HTTP/TLS the redirect of the OP result to the RP.  This step happens out of band from SASL.</li>
<li>The RP MAY send an OpenID check_authentication request directly to the OP, if no association has been established, and the OP should be expected to respond.  Again this step happens out of band from SASL.</li>
<li>The SASL server sends an appropriate SASL response to the client, with optional Open Simple Registry (SREG) attributes. </li>
</ol>

<p> </p>
<div id="#rfc.figure.2"></div>
<pre>
      SASL Serv.       Client          OP
         |&gt;-----(1)-----&gt;|              | Advertisement
         |               |              |
         |&lt;-----(2)-----&lt;|              | Initiation
         |               |              |
         |&gt; - - (3) - - - - - - - - - -&gt;| Discovery
         |                              |
         |&gt;- - -(4)- - - - - - - - - - &gt;| Association
         |&lt;- - -(4)- - - - - - - - - - &lt;|
         |               |              |
         |&gt;-----(5)-----&gt;|              | Indirect Auth Request
         |               |              |
         |&lt;-----(6)-----&lt;|              | Client "=" Response
         |               |               |
         |               |&gt;- - (7)- - -&gt;| Client GET to the OP (ext)
         |               |              |
         |               |&lt;- - (8)- - -&gt;| Client / OP Auth. (ext.)
         |               |              |
         |&lt;- - -(9)- - - + - - - - - - &lt;| HTTPs Indirect id_res
         |               |              |
         |&lt;- - -(10)- - - - - - - - - -&gt;| Optional check_authenticate
         |               |              |
         |&gt;-----(11)----&gt;|              | SASL completion with status

     ----- = SASL
     - - - = HTTPS

</pre>
<p></p>
<p id="rfc.section.2.p.7">Note the directionality in SASL is such that the client MUST send the "=" response.  Specifically, the SASL client processes the redirect and then awaits a final SASL decision, while the rest of the OpenID authentication process continues.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Binding SASL to OpenID in the Relying Party</h1>
<p id="rfc.section.2.1.p.1">To ensure that a specific request is bound, and in particular to ease interprocess communication, it may be necessary for the relying party to encode some sort of nonce or transaction-id in the URIs it transmits through the client for success or failure.  This can be done in any number of ways.  Examples would include making changes to the base URI or otherwise including an additional fragment.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Discussion</h1>
<p id="rfc.section.2.2.p.1">As mentioned above OpenID is primarily designed to interact with web-based applications.  Portions of the authentication stream are only defined in the crudest sense.  That is, when one is prompted to approve or disapprove an authentication, anything that one might find on a browser is allowed, including JavaScript, fancy style-sheets, etc.  Because of this lack of structure, implementations will need to invoke a fairly rich browser in order to ensure that the authentication can be completed.  </p>
<p id="rfc.section.2.2.p.2">Once there is an outcome, the SASL server needs to know about it.  The astute will hopefully by now have noticed an "=" client SASL response.  This is not to say that nothing is happening, but rather that authentication flow has shifted from SASL to OpenID, and will return when the server has an outcome to hand to the client.  The alternative to this flow is some signal from the HTML browser to the SASL client of the results that is in turn passed to the SASL server.  The IPC issue this raises is substantial.  Better, we conclude, to externalize the authentication to the browser, and have an "=" client response.  </p>
<p id="rfc.section.2.2.p.3">OpenID is also meant to be used in serial within the web.  As such, there are no transaction-ids within the protocol.  A transaction id, MUST be included by the RP by appending it to the return_to URL.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> OpenID SASL Mechanism Specification</h1>
<p id="rfc.section.3.p.1">This section specifies the details of the OpenID SASL mechanism.  Recall section 5 of <a href="#RFC4422">[RFC4422]</a> for what needs to be described here.</p>
<p id="rfc.section.3.p.2">The name of this mechanism "OPENID20".  The mechanism is capable of transferring an authorization identity (via "gs2-header").  The mechanism does not offer a security layer.</p>
<p id="rfc.section.3.p.3">The mechanism is client-first.  The first mechanism message from the client to the server is the "initial-response" described below.  As described in <a href="#RFC4422">[RFC4422]</a>, if the application protocol does not support sending a client-response together with the authentication request, the server will send an empty server-challenge to let the client begin.</p>
<p id="rfc.section.3.p.4">The second mechanism message is from the server to the client, the "authentication_request" described below.</p>
<p id="rfc.section.3.p.5">The third mechanism message is from client to the server, and is the fixed message consisting of "=".</p>
<p id="rfc.section.3.p.6">The fourth mechanism message is from the server to the client, described below as "outcome_data" (with SREG attributes), sent as additional data when indicating a successful outcome.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#initiation" id="initiation">Initiation</a>
</h1>
<p id="rfc.section.3.1.p.1">A client initiates an OpenID authentication with SASL by sending the GS2 header followed by the URI, as specified in the OpenID specification. The GS2 header carries the optional authorization identity.</p>
<div id="#rfc.figure.3"></div>
<pre>
    initial-response = gs2-header Auth-Identifier
    Auth-Identifier = Identifier ; authentication identifier
    Identifier = URI       ;  Identifier is specified in
                           ;  Sec. 7.2 of the OpenID 2.0 spec.


</pre>
<p id="rfc.section.3.1.p.2">The "gs2-header" is specified in <a href="#RFC5801">[RFC5801]</a>, and it is used as follows.  The "gs2-nonstd-flag" MUST NOT be present.  The "gs2-cb-flag" MUST be "n" because channel binding is not supported by this mechanism.  The "gs2-authzid" carries the optional authorization identity.</p>
<p id="rfc.section.3.1.p.3">URI is specified in <a href="#RFC3986">[RFC3986]</a>. <a href="#XRI2.0">XRIs MUST NOT be used.</a> <cite title="NONE">[XRI2.0]</cite> </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#request" id="request">Authentication Request</a>
</h1>
<p id="rfc.section.3.2.p.1">The SASL Server sends the URL resulting from the OpenID authentication request, containing an "openid.mode" of either "checkid_immediate" or "checkid_setup", as specified in Section 9.1 of the OpenID 2.0 specification.</p>
<div id="#rfc.figure.4"></div>
<pre>
       authentication-request = URI
</pre>
<p id="rfc.section.3.2.p.2">As part of this request, the SASL server MUST append a unique transaction id to the "return_to" portion of the request.  The form of this transaction is left to the RP to decide, but SHOULD be large enough to be resistant to being guessed or attacked.  </p>
<p id="rfc.section.3.2.p.3">The client now sends that request via an HTTP GET to the OP, as if redirected to do so from an HTTP server.</p>
<p id="rfc.section.3.2.p.4">The client MUST handle both user authentication to the OP and confirmation or rejection of the authentiation by the RP via this SASL mechanism.</p>
<p id="rfc.section.3.2.p.5">After all authentication has been completed by the OP, and after the response has been sent to the client, the client will relay the response to the Relying Party via HTTP/TLS, as specified previously in the transaction ("return_to").  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#response2" id="response2">Server Response</a>
</h1>
<p id="rfc.section.3.3.p.1">The Relying Party now validates the response it received from the client via HTTP/TLS, as specified in the OpenID specification, using the "return_to" URI given previsiously in the transaction.</p>
<p id="rfc.section.3.3.p.2">The response by the Relying Party constitutes a SASL mechanism outcome, and SHALL be used to set state in the server accordingly, and it SHALL be used by the server to report that state to the SASL client as described in [RFC4422] Section 3.6.  In the additional data, the server MAY include OpenID Simple Registry (SREG) attributes that are listed in Section 4 of <a href="#SREG1.0">[SREG1.0]</a>.  They are encoded as follows:</p>
<p></p>

<ol>
<li>Strip "openid.sreg." from each attribute name.</li>
<li>Treat the concatentation of results as URI parameters that are separated by an ampersand (&amp;) and encode as one would a URI, absent the scheme, authority, and the question mark.  </li>
</ol>

<p> </p>
<p></p>
<p id="rfc.section.3.3.p.5">For example: email=lear@example.com&amp;fullname=Eliot%20Lear </p>
<div id="#rfc.figure.5"></div>
<pre>

      outcome-data = [ sreg-avp *( "," sreg-avp ) ]
      sreg-avp     = sreg-attr "=" sreg-val
      sreg-attr    = sreg-word
      sreg-val     = sreg-word
      sreg-word    = 1*( unreserved / pct-encoded )
                     ; pct-encoded from Section 2.1 of RFC 3986
                     ; unreserved from Section 2.3 of RFC 3986

		     </pre>
<p id="rfc.section.3.3.p.6">More formally: </p>
<p id="rfc.section.3.3.p.7">A client who does not support SREG MUST ignore SREG attributes sent by the server.  Similarly, a client MUST ignore unknown attributes.  </p>
<div id="#rfc.figure.6"></div>
<pre>
     outcome_data = "openid.error" "=" sreg_val *( "," sregp_avp )
     </pre>
<p id="rfc.section.3.3.p.8">In the case of failures, the response MUST follow this syntax: </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Error Handling</h1>
<p><a href="#RFC4422">[RFC4422]</a> Section 3.6 explicitly prohibits additional information in an unsuccessful authentication outcome.  Therefore, the openid.error and openid.error_code are to be sent as an additional challenge in the event of an unsuccessful outcome.  In this case, as the protocol is lock step,  the client will follow with an additional exchange containing "=", after which the server will respond with an application-level outcome.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> OpenID GSS-API Mechanism Specification</h1>
<p id="rfc.section.4.p.1">This section and its sub-sections and appropriate references of it not referenced elsewhere in this document are not required for SASL implementors, but this section MUST be observed to implement the GSS-API mechanism discussed below.</p>
<p id="rfc.section.4.p.2">The OpenID SASL mechanism is actually also a GSS-API mechanism.  The OpenID user takes the role of the GSS-API Initiator and the OpenID Relying Party takes the role of the GSS-API Acceptor.  The OpenId Provider does not have a role in GSS-API, and is considered an internal matter for the OpenID mechanism.  The messages are the same, but a) the GS2 header on the client's first message and channel binding data is excluded when OpenID is used as a GSS-API mechanism, and b) the RFC2743 section 3.1 initial context token header is prefixed to the client's first authentication message (context token).</p>
<p id="rfc.section.4.p.3">The GSS-API mechanism OID for OpenID is OID-TBD (IANA to assign: see IANA considerations).  </p>
<p id="rfc.section.4.p.4">OpenID security contexts MUST have the mutual_state flag (GSS_C_MUTUAL_FLAG) set to TRUE.  OpenID does not support credential delegation, therefore OpenID security contexts MUST have the deleg_state flag (GSS_C_DELEG_FLAG) set to FALSE.  </p>
<p id="rfc.section.4.p.5">The mutual authentication property of this mechanism relies on successfully comparing the TLS server identity with the negotiated target name.  Since the TLS channel is managed by the application outside of the GSS-API mechanism, the mechanism itself is unable to confirm the name while the application is able to perform this comparison for the mechanism.  For this reason, applications MUST match the TLS server identity with the target name, as discussed in <a href="#RFC6125">[RFC6125]</a>.</p>
<p id="rfc.section.4.p.6">The OpenID mechanism does not support per-message tokens or GSS_Pseudo_random.</p>
<p id="rfc.section.4.p.7">The <a href="#RFC5587">[RFC5587]</a> mechanism attributes for this mechanism are GSS_C_MA_MECH_CONCRETE, GSS_C_MA_ITOK_FRAMED, and GSS_C_MA_AUTH_INIT.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> GSS-API Principal Name Types for OpenID</h1>
<p id="rfc.section.4.1.p.1">OpenID supports standard generic name syntaxes for acceptors such as GSS_C_NT_HOSTBASED_SERVICE (see <a href="#RFC2743">[RFC2743]</a>, Section 4.1).</p>
<p id="rfc.section.4.1.p.2">OpenID supports only a single name type for initiators: GSS_C_NT_USER_NAME.  GSS_C_NT_USER_NAME is the default name type for OpenID.</p>
<p id="rfc.section.4.1.p.3">OpenID name normalization is covered by the OpenID specification, see <a href="#OpenID">[OpenID]</a> section 7.2.</p>
<p id="rfc.section.4.1.p.4">The query, display, and exported name syntaxes for OpenID principal names are all the same.  There are no OpenID-specific name syntaxes -- applications should use generic GSS-API name types such as GSS_C_NT_USER_NAME and GSS_C_NT_HOSTBASED_SERVICE (see <a href="#RFC2743">[RFC2743]</a>, Section 4).  The exported name token does, of course, conform to <a href="#RFC2743">[RFC2743]</a>, Section 3.2, but the "NAME" part of the token should be treated as a potential input string to the OpenID name normalization rules.  For example, the OpenID identifier "https://openid.example/" will have a GSS_C_NT_USER_NAME value of "https://openid.example/".  </p>
<p id="rfc.section.4.1.p.5">GSS-API name attributes may be defined in the future to hold the normalized OpenID Identifier.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Example</h1>
<p id="rfc.section.5.p.1">Suppose one has an OpenID of https://openid.example, and wishes to authenticate his IMAP connection to mail.example (where .example is the top level domain specified in <a href="#RFC2606">[RFC2606]</a>).  The user would input his Openid into his mail user agent, when he configures the account.  In this case, no association is attempted between the OpenID Consumer and the OP.  The client will make use of the return_to attribute to capture results of the authentication to be redirected to the server.   Note the use of <a href="#RFC4959">[RFC4959]</a> for initial response. The authentication on the wire would then look something like the following: </p>
<div id="#rfc.figure.7"></div>
<pre>

    (S = IMAP server; C = IMAP client)

    C: &lt; connects to IMAP port&gt;
    S: * OK
    C: C1 CAPABILITY
    S: * CAPABILITY IMAP4rev1 SASL-IR SORT [...] AUTH=OPENID20
    S: C1 OK Capability Completed
    C: C2 AUTHENTICATE OPENID biwsaHR0cHM6Ly9vcGVuaWQuZXhhbXBsZS8=
    [  This is the base64 encoding of "n,,https://openid.example/".
       Server performs discovery on http://openid.example/ ]
    S: + aHR0cHM6Ly9vcGVuaWQuZXhhbXBsZS9vcGVuaWQvP29wZW5pZC5ucz1
         odHRwOi8vc3BlY3Mub3BlbmlkLm5ldC9hdXRoLzIuMCZvcGVuaWQucm
         V0dXJuX3RvPWh0dHBzOi8vbWFpbC5leGFtcGxlL2NvbnN1bWVyLzFlZ
         jg4OGMmb3BlbmlkLmNsYWltZWRfaWQ9aHR0cHM6Ly9vcGVuaWQuZXhh
         bXBsZS8mb3BlbmlkLmlkZW50aXR5PWh0dHBzOi8vb3BlbmlkLmV4YW1
         wbGUvJm9wZW5pZC5yZWFsbT1pbWFwOi8vbWFpbC5leGFtcGxlJm9wZW
         5pZC5tb2RlPWNoZWNraWRfc2V0dXA=

    [ This is the base64 encoding of "https://openid.example/openid/
          ?openid.ns=http://specs.openid.net/auth/2.0
          &amp;openid.return_to=https://mail.example/consumer/1ef888c
          &amp;openid.claimed_id=https://openid.example/
          &amp;openid.identity=https://openid.example/
          &amp;openid.realm=imap://mail.example
          &amp;openid.mode=checkid_setup"
       with line breaks and spaces added here for readibility. 
    ]
    C: PQ==
    [ The client now sends the URL it received to a browser for
      processing. The user logs into https://openid.example, and
      agrees to authenticate imap://mail.example.  A redirect is
      passed back to the client browser who then connects to
      https://imap.example/consumer via SSL with the results.
      From an IMAP perspective, however, the client sends the "="
      response, and awaits mail.example.
      Server mail.example would now contact openid.example with an
      openid.check_authenticate message.  After that...
    ]
    S: + ZW1haWw9bGVhckBtYWlsLmV4YW1wbGUsZnVsbG5hbWU9RWxp
         b3QlMjBMZWFy
      [ Here the IMAP server has returned an SREG attribute of
        email=lear@mail.example,fullname=Eliot%20Lear.
        Line break in response added in this example for clarity. ]
    C: 
      [ In IMAP client must send a blank response to receive data
        that is included in a success response. ]
    S: C2 OK
</pre>
<p id="rfc.section.5.p.2">In this example, the SASL server / RP has made use of a transaction id 1ef888c.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Security Considerations</h1>
<p id="rfc.section.6.p.1">This section will address only security considerations associated with the use of OpenID with SASL and GSS-API.  For considerations relating to OpenID in general, the reader is referred to the OpenID specification and to other literature <a href="http://sites.google.com/site/openidreview/resources">http://sites.google.com/site/openidreview/resources</a>.  Similarly, for general <a href="#RFC4422">SASL</a> <cite title="NONE">[RFC4422]</cite> and <a href="#RFC5801">GSS-API</a> <cite title="NONE">[RFC5801]</cite> Security Considerations, the reader is referred to those specifications.  </p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Binding OpenIDs to Authorization Identities</h1>
<p id="rfc.section.6.1.p.1">As specified in <a href="#RFC4422">[RFC4422]</a>, the server is responsible for binding credentials to a specific authorization identity.  It is therefore necessary that either some sort of registration process takes place to register specific OpenIDs, or that only specific trusted OpenID Providers be allowed.  Some out of band knowledge may help this process along.  For instance, users of a particular domain may utilize a particular OP that enforces a mapping.  </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> RP redirected by malicious URL to take an improper action</h1>
<p id="rfc.section.6.2.p.1">In the initial SASL client response a user or host can transmit a malicious response to the RP for purposes of taking advantage of weaknesses in the RP's OpenID implementation.  It is possible to add port numbers to the URL so that the outcome is the RP does a port scan of the site.  The URL could  send the connection to an internal host or even the local host, which the attacker would not normally have access to.  The URL could contain a protocol other than http or https, such as file or ftp.  </p>
<p id="rfc.section.6.2.p.2">To mitigate this attack, implementations should carefully analyze URLs received, eliminating any that would in some way be privileged.  A log of those sites that fail SHOULD be kept, and limitations on queries from clients SHOULD be imposed, just as with any other authentication attempt.  It is RECOMMENDED that only http or https schemes be accepted.  </p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> User Privacy</h1>
<p id="rfc.section.6.3.p.1">The OP is aware of each RP that a user logs into.  There is nothing in the protocol to hide this information from the OP.  It is not a requirement to track the visits, but there is nothing that prohibits the collection of information.  SASL servers should be aware that OpenID Providers will be able to track - to some extent - user access to their services and any additional information that OP provides.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Room for Improvement</h1>
<p id="rfc.section.7.p.1">We note one area where there is possible room for improvement over existing OpenID implementations.  Because SASL is often implemented atop protocols that have required some amount of provisioning, it may be possible for the SASL client to signal the browser that the given URL is the beginning of a sensitive transaction, and that increased scrutiny should be given.  A signal of some form would need to come from an appropriately authorized agent that the sensitive transaction is complete.  An example behavior during this sensitive period might be increased scrutiny of broken trust chains in certificates, or perhaps disallowing such trust chains altogether.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> IANA Considerations</h1>
<p id="rfc.section.8.p.1">The IANA is requested to update the SASL Mechanism Registry using the following template, as described in <a href="#RFC4422">[RFC4422]</a>.</p>
<p></p>
<p id="rfc.section.8.p.3">SASL mechanism name: OPENID20</p>
<p id="rfc.section.8.p.4">Security Considerations: See this document</p>
<p id="rfc.section.8.p.5">Published specification: See this document</p>
<p id="rfc.section.8.p.6">Person &amp; email address to contact for further information: Authors of this document</p>
<p id="rfc.section.8.p.7">Intended usage: COMMON</p>
<p id="rfc.section.8.p.8">Owner/Change controller: IETF</p>
<p id="rfc.section.8.p.9">Note: None</p>
<p id="rfc.section.8.p.10">The IANA is further requested to assign an OID for this GSS mechanism in the SMI numbers registry, with the prefix of iso.org.dod.internet.security.mechanisms (1.3.6.1.5.5) and to reference this specification in the registry.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Acknowledgments</h1>
<p id="rfc.section.9.p.1">The authors would like to thank Alexey Melnikov, Joe Hildebrand, Mark Crispin, Chris Newman, Leif Johansson, Sam Hartman, Nico Williams, and Klaas Wierenga for their review and contributions.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="OpenID">[OpenID]</b></td>
<td class="top">
<a>OpenID Foundation</a>, "<a>OpenID Authentication 2.0 - Final</a>", December 2007.</td>
</tr>
<tr>
<td class="reference"><b id="SREG1.0">[SREG1.0]</b></td>
<td class="top">
<a>OpenID Foundation</a>, "<a>OpenID Simple Registration Extension version 1.0</a>", June 2006.</td>
</tr>
<tr>
<td class="reference"><b id="XRI2.0">[XRI2.0]</b></td>
<td class="top">
<a href="mailto:drummond.reed@cordance.net" title="Cordance">Reed, D.</a> and <a href="mailto:dave.mcalpin@epokinc.com" title="Epok">D. McAlpin</a>, "<a>Extensible Resource Identifier (XRI) Syntax V2.0</a>", OASIS Standard xri-syntax-V2.0-cs, September 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2743">[RFC2743]</b></td>
<td class="top">
<a href="mailto:jlinn@rsasecurity.com" title="RSA Laboratories">Linn, J.</a>, "<a href="http://tools.ietf.org/html/rfc2743">Generic Security Service Application Program Interface Version 2, Update 1</a>", RFC 2743, January 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4422">[RFC4422]</b></td>
<td class="top">
<a>Melnikov, A.</a> and <a>K. Zeilenga</a>, "<a href="http://tools.ietf.org/html/rfc4422">Simple Authentication and Security Layer (SASL)</a>", RFC 4422, June 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2606">[RFC2606]</b></td>
<td class="top">
<a href="mailto:dee3@us.ibm.com" title="IBM">Eastlake, D.E.</a> and <a href="mailto:buglady@fuschia.net">A. Panitz</a>, "<a href="http://tools.ietf.org/html/rfc2606">Reserved Top Level DNS Names</a>", BCP 32, RFC 2606, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2616">[RFC2616]</b></td>
<td class="top">
<a href="mailto:fielding@ics.uci.edu" title="Department of Information and Computer Science">Fielding, R.</a>, <a href="mailto:jg@w3.org" title="World Wide Web Consortium">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com" title="Compaq Computer Corporation">Mogul, J.</a>, <a href="mailto:frystyk@w3.org" title="World Wide Web Consortium">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox Corporation">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.</a> and <a href="mailto:timbl@w3.org" title="World Wide Web Consortium">T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2616, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a href="mailto:timbl@w3.org" title="World Wide Web Consortium">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com" title="Day Software">Fielding, R.</a> and <a href="mailto:LMM@acm.org" title="Adobe Systems Incorporated">L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5587">[RFC5587]</b></td>
<td class="top">
<a>Williams, N.</a>, "<a href="http://tools.ietf.org/html/rfc5587">Extended Generic Security Service Mechanism Inquiry APIs</a>", RFC 5587, July 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5801">[RFC5801]</b></td>
<td class="top">
<a>Josefsson, S.</a> and <a>N. Williams</a>, "<a href="http://tools.ietf.org/html/rfc5801">Using Generic Security Service Application Program Interface (GSS-API) Mechanisms in Simple Authentication and Security Layer (SASL): The GS2 Mechanism Family</a>", RFC 5801, July 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6125">[RFC6125]</b></td>
<td class="top">
<a>Saint-Andre, P.</a> and <a>J. Hodges</a>, "<a href="http://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>", RFC 6125, March 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="W3C.REC-html401-19991224">[W3C.REC-html401-19991224]</b></td>
<td class="top">
<a>Raggett, D.</a>, <a>Hors, A.</a> and <a>I. Jacobs</a>, "<a>HTML 4.01 Specification</a>", World Wide Web Consortium Recommendation REC-html401-19991224, December 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1939">[RFC1939]</b></td>
<td class="top">
<a href="mailto:jgm+@cmu.edu" title="Carnegie-Mellon University">Myers, J.G.</a> and <a href="mailto:mrose@dbc.mtview.ca.us" title="Dover Beach Consulting, Inc.">M.T. Rose</a>, "<a href="http://tools.ietf.org/html/rfc1939">Post Office Protocol - Version 3</a>", STD 53, RFC 1939, May 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3501">[RFC3501]</b></td>
<td class="top">
<a>Crispin, M.</a>, "<a href="http://tools.ietf.org/html/rfc3501">INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1</a>", RFC 3501, March 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3920">[RFC3920]</b></td>
<td class="top">
<a href="mailto:stpeter@jabber.org" title="Jabber Software Foundation">Saint-Andre, P.</a>, "<a href="http://tools.ietf.org/html/rfc3920">Extensible Messaging and Presence Protocol (XMPP): Core</a>", RFC 3920, October 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4959">[RFC4959]</b></td>
<td class="top">
<a>Siemborski, R.</a> and <a>A. Gulbrandsen</a>, "<a href="http://tools.ietf.org/html/rfc4959">IMAP Extension for Simple Authentication and Security Layer (SASL) Initial Client Response</a>", RFC 4959, September 2007.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Changes</h1>
<p id="rfc.section.Appendix A.p.1">This section to be removed prior to publication.</p>
<p></p>

<ul>
<li>03 Clarifies messages and ordering, and replace the empty message with a "=" message.</li>
<li>02 Address all WGLC comments.</li>
<li>01 Specific text around possible improvements for OOB browser control in security considerations.  Also talk about transaction id.</li>
<li>00 WG -00 draft.  Slight wording modifications abou design constraints per Alexey.</li>
<li>02 Correct single (significant) error on mechanism name.</li>
<li>01 Add nonce discussion, add authorized identity, explain a definition. Add gs2 support.</li>
<li>00 Initial Revision. </li>
</ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Eliot Lear</span> 
	  <span class="n hidden">
		<span class="family-name">Lear</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems GmbH</span>
	<span class="adr">
	  <span>Richtistrasse 7</span>

	  <span class="vcardline">
		<span class="locality">Wallisellen</span>,  
		<span class="region">ZH</span> 
		<span class="code">CH-8304</span>
	  </span>
	  <span class="country-name vcardline">Switzerland</span>
	</span>
	<span class="vcardline">Phone: +41 44 878 9200</span>

<span class="vcardline">EMail: <a href="mailto:lear@cisco.com">lear@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Hannes Tschofenig</span> 
	  <span class="n hidden">
		<span class="family-name">Tschofenig</span>
	  </span>
	</span>
	<span class="org vcardline">Nokia Siemens Networks</span>
	<span class="adr">
	  <span>Linnoitustie 6</span>

	  <span class="vcardline">
		<span class="locality">Espoo</span>,  
		<span class="region"></span>
		<span class="code">02600</span>
	  </span>
	  <span class="country-name vcardline">Finland</span>
	</span>
	<span class="vcardline">Phone: +358 (50) 4871445</span>

<span class="vcardline">EMail: <a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></span>

<span class="vcardline">URI: <a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Henry Mauldin</span> 
	  <span class="n hidden">
		<span class="family-name">Mauldin</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span>170 West Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">Phone: +1 (800) 553-6387</span>

<span class="vcardline">EMail: <a href="mailto:hmauldin@cisco.com">hmauldin@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Simon Josefsson</span> 
	  <span class="n hidden">
		<span class="family-name">Josefsson</span>
	  </span>
	</span>
	<span class="org vcardline">SJD AB</span>
	<span class="adr">
	  <span>Hagagatan 24</span>

	  <span class="vcardline">
		<span class="locality">Stockholm</span>,  
		<span class="region"></span>
		<span class="code">113 47</span>
	  </span>
	  <span class="country-name vcardline">SE</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:simon@josefsson.org">simon@josefsson.org</a></span>

<span class="vcardline">URI: <a href="http://josefsson.org/">http://josefsson.org/</a></span>

  </address>
</div>

</body>
</html>