<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>The OAuth Core 1.0 Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="The OAuth Core 1.0 Protocol">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">E. Hammer-Lahav, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Yahoo!</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">B. Cook</td></tr>
<tr><td class="header">Expires: March 26, 2010</td><td class="header">September 22, 2009</td></tr>
</table></td></tr></table>
<h1><br />The OAuth Core 1.0 Protocol<br />draft-hammer-oauth-03</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on March 26, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>
        This document specifies the OAuth Core 1.0 protocol. OAuth provides a method for clients
        to access server resources on behalf of another party (such as a different client or an end
        user). It also provides a redirection-based user agent process for end users to authorize
        access to another party by substituting their credentials (typically, a username and password
        pair) with a different set of delegation-specific credentials. This document is based
				on revision A of the community specification and includes a few clarifications.
      
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Terminology<br />
<a href="#anchor3">2.</a>&nbsp;
Notational Conventions<br />
<a href="#requests">3.</a>&nbsp;
Authenticated Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Protocol Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#nonce">3.2.</a>&nbsp;
Nonce and Timestamp<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#signature">3.3.</a>&nbsp;
Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.3.1.</a>&nbsp;
Signature Base String<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.2.</a>&nbsp;
HMAC-SHA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.3.3.</a>&nbsp;
RSA-SHA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.3.4.</a>&nbsp;
PLAINTEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#param_include">3.4.</a>&nbsp;
Parameter Transmission<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_header">3.4.1.</a>&nbsp;
Authorization Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_body">3.4.2.</a>&nbsp;
Form-Encoded Body<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_query">3.4.3.</a>&nbsp;
Request URI Query<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_response">3.5.</a>&nbsp;
Server Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#encoding">3.6.</a>&nbsp;
Percent Encoding<br />
<a href="#redirect_workflow">4.</a>&nbsp;
Redirection-Based Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_step1">4.1.</a>&nbsp;
Temporary Credentials<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_step2">4.2.</a>&nbsp;
Resource Owner Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_step3">4.3.</a>&nbsp;
Token Credentials<br />
<a href="#IANA">5.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">6.1.</a>&nbsp;
Credentials Transmission<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">6.2.</a>&nbsp;
RSA-SHA1 Signature Method<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">6.3.</a>&nbsp;
PLAINTEXT Signature Method<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">6.4.</a>&nbsp;
Confidentiality of Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">6.5.</a>&nbsp;
Spoofing by Counterfeit Servers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">6.6.</a>&nbsp;
Proxying and Caching of Authenticated Content<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">6.7.</a>&nbsp;
Plaintext Storage of Credentials<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#client_cred_sec">6.8.</a>&nbsp;
Secrecy of the Client Credentials<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">6.9.</a>&nbsp;
Phishing Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">6.10.</a>&nbsp;
Scoping of Access Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">6.11.</a>&nbsp;
Entropy of Secrets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">6.12.</a>&nbsp;
Denial of Service / Resource Exhaustion Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">6.13.</a>&nbsp;
Cryptographic Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">6.14.</a>&nbsp;
Signature Base String Limitations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">6.15.</a>&nbsp;
Cross-Site Request Forgery (CSRF)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">6.16.</a>&nbsp;
User Interface Redress<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">6.17.</a>&nbsp;
Automatic Processing of Repeat Authorizations<br />
<a href="#anchor25">Appendix&nbsp;A.</a>&nbsp;
Examples<br />
<a href="#anchor26">Appendix&nbsp;A.1.</a>&nbsp;
Obtaining Temporary Credentials<br />
<a href="#anchor27">Appendix&nbsp;A.2.</a>&nbsp;
Requesting Resource Owner Authorization<br />
<a href="#anchor28">Appendix&nbsp;A.3.</a>&nbsp;
Obtaining Token Credentials<br />
<a href="#anchor29">Appendix&nbsp;A.4.</a>&nbsp;
Accessing protected resources<br />
<a href="#sig_base_example">Appendix&nbsp;A.4.1.</a>&nbsp;
Generating Signature Base String<br />
<a href="#anchor30">Appendix&nbsp;A.4.2.</a>&nbsp;
Calculating Signature Value<br />
<a href="#anchor31">Appendix&nbsp;A.4.3.</a>&nbsp;
Requesting protected resource<br />
<a href="#anchor32">Appendix&nbsp;B.</a>&nbsp;
Differences from the Community Edition<br />
<a href="#anchor33">Appendix&nbsp;C.</a>&nbsp;
Acknowledgments<br />
<a href="#history">Appendix&nbsp;D.</a>&nbsp;
Document History<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
        The OAuth protocol provides a method for servers to allow third-party access to protected
        resources, without forcing their end users to share their credentials. This pattern is
				common among services that allow third-party developers to extend the service functionality,
				by building applications using an open API.
      
</p>
<p>
        For example, a web user (resource owner) can grant a printing service (client) access to
        its private photos stored at a photo sharing service (server), without sharing its
        credentials with the printing service. Instead, the user authenticates directly with
        the photo sharing service and issues the printing service delegation-specific credentials.
      
</p>
<p>
        OAuth introduces a third role to the traditional client-server authentication model: the
        resource owner. In the OAuth model, the client requests access to resources hosted by the
        server but not controlled by the client, but by the resource owner. In addition, OAuth
        allows the server to verify not only the resource owner's credentials, but also those of
        the client making the request.
      
</p>
<p>
        In order for the client to access resources, it first has to obtain permission from the
        resource owner. This permission is expressed in the form of a token and matching
        shared-secret. The purpose of the token is to substitute the need for the resource owner to
        share its server credentials (usually a username and password pair) with the client. Unlike
        server credentials, tokens can be issued with a restricted scope and limited lifetime.
      
</p>
<p>
        This specification consists of two parts. The first part defines a method for making
        authenticated HTTP requests using two sets of credentials, one identifying the client
        making the request, and a second identifying the resource owner on whose behalf the
				request is being made.
      
</p>
<p>
        The second part defines a redirection-based user agent process for end users to authorize
        client access to their resources, by authenticating directly with the server and
        provisioning tokens to the client for use with the authentication method.
      
</p>
<p>
        [[ This draft is submitted for informational purposes to document the current use of the
				protocol. It is not an item of the OAUTH working group. Please discuss this draft on the
				<a href='https://www.ietf.org/mailman/listinfo/oauth'>oauth@ietf.org</a> mailing
				list. ]]
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>client</dt>
<dd>
              
              An HTTP client (per <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>) capable of making
              <a class='info' href='#requests'>OAuth-authenticated requests<span> (</span><span class='info'>Authenticated Requests</span><span>)</span></a>.
            
</dd>
<dt>server</dt>
<dd>
              
              An HTTP server (per <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>) capable of accepting
              <a class='info' href='#requests'>OAuth-authenticated requests<span> (</span><span class='info'>Authenticated Requests</span><span>)</span></a>.
            
</dd>
<dt>protected resource</dt>
<dd>
              
              An access-restricted resource (per <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>) which can be obtained
              from the server using an <a class='info' href='#requests'>OAuth-authenticated request<span> (</span><span class='info'>Authenticated Requests</span><span>)</span></a>.
            
</dd>
<dt>resource owner</dt>
<dd>
              
              An entity capable of accessing and controlling protected resources by using credentials
              to authenticate with the server.
            
</dd>
<dt>token</dt>
<dd>
              
              An unique identifier issued by the server and used by the client to associate
              authenticated requests with the resource owner whose authorization is requested or
              has been obtained by the client. Tokens have a matching shared-secret that is used
              by the client to establish its ownership of the token, and its authority to represent
              the resource owner.
            
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Notational Conventions</h3>

<p>
        The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
        <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
      
</p>
<a name="requests"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Authenticated Requests</h3>

<p>
        The HTTP authentication methods defined by <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>, enable clients
        to make authenticated HTTP requests. Clients using these methods gain access to protected
        resource by using their server credentials (typically a username and password pair), which
        allows the server to verify their authenticity. Using these methods for delegation requires
        the client to pretend it is the resource owner.
      
</p>
<p>
        OAuth provides a method designed to include two sets of credentials with each request, one
        to identify the client, and another to identify the resource owner. Before a client can
        make authenticated requests on behalf of the resource owner, it must obtain a token
        authorized by the resource owner. <a class='info' href='#redirect_workflow'>Section&nbsp;4<span> (</span><span class='info'>Redirection-Based Authorization</span><span>)</span></a> provides one such
        method in which the client can obtain a token authorized by the resource owner.
      
</p>
<p>
        The client credentials take the form of a unique identifier, and an associated share-secret
        or RSA key pair. Prior to making authenticated requests, the client establishes a set of
        credentials with the server. The process and requirements for provisioning these are
        outside the scope of this specification. Implementers are urged to consider the security
        ramification of using client credentials, some of which are described in
        <a class='info' href='#client_cred_sec'>Section&nbsp;6.8<span> (</span><span class='info'>Secrecy of the Client Credentials</span><span>)</span></a>.
      
</p>
<p>
        Making authenticated requests requires prior knowledge of the server's configuration.
        OAuth provides multiple methods for including protocol parameters in requests
				(<a class='info' href='#param_include'>Section&nbsp;3.4<span> (</span><span class='info'>Parameter Transmission</span><span>)</span></a>), as well as multiple methods for the client to
        prove its rightful ownership of the credentials used (<a class='info' href='#signature'>Section&nbsp;3.3<span> (</span><span class='info'>Signature</span><span>)</span></a>).
        The way in which clients discover the required configuration is outside the scope of
        this specification.
      
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Protocol Parameters</h3>

<p>
          An OAuth-authenticated request includes several protocol parameters. Each parameter name
          begins with the <tt>oauth_</tt> prefix, and the parameter names
          and values are case sensitive. Protocol parameters MUST NOT appear more than once per
          request. The parameters are:

          </p>
<blockquote class="text"><dl>
<dt>oauth_consumer_key</dt>
<dd>
              
              The identifier portion of the client credentials (equivalent to a username). The
              parameter name reflects a deprecated term (Consumer Key) used in previous revisions
              of the specification, and has been retained to maintain backward compatibility.
            
</dd>
<dt>oauth_token</dt>
<dd>
              
              The token value used to associate the request with the resource owner. If the request
              is not associated with a resource owner (no token), clients MAY omit the parameter.
            
</dd>
<dt>oauth_signature_method</dt>
<dd>
              
              The name of the signature method used by the client to sign the request,
							as defined in <a class='info' href='#signature'>Section&nbsp;3.3<span> (</span><span class='info'>Signature</span><span>)</span></a>.
            
</dd>
<dt>oauth_signature</dt>
<dd>
              
              The signature value as defined in <a class='info' href='#signature'>Section&nbsp;3.3<span> (</span><span class='info'>Signature</span><span>)</span></a>.
            
</dd>
<dt>oauth_timestamp</dt>
<dd>
              
              The timestamp value as defined in <a class='info' href='#nonce'>Section&nbsp;3.2<span> (</span><span class='info'>Nonce and Timestamp</span><span>)</span></a>.
            
</dd>
<dt>oauth_nonce</dt>
<dd>
              
              The nonce value as defined in <a class='info' href='#nonce'>Section&nbsp;3.2<span> (</span><span class='info'>Nonce and Timestamp</span><span>)</span></a>.
            
</dd>
<dt>oauth_version</dt>
<dd>
              
              The protocol version. If omitted, the protocol version defaults to
              <tt>1.0</tt>.
            
</dd>
</dl></blockquote><p>
        
</p>
<p>
          Server-specific request parameters MUST NOT begin with the
          <tt>oauth_</tt> prefix.
        
</p>
<a name="nonce"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Nonce and Timestamp</h3>

<p>
          Unless otherwise specified by the server, the timestamp is expressed in the number of
          seconds since January 1, 1970 00:00:00 GMT. The timestamp value MUST be a positive
          integer and MUST be equal or greater than the timestamp used in previous requests with
					the same client credentials and token credentials combination.
        
</p>
<p>
          A nonce is a random string, uniquely generated to allows the server to verify that a
          request has never been made before and helps prevent replay attacks when requests are
          made over a non-secure channel. The nonce value MUST be unique across all requests with
          the same timestamp, client credentials, and token combinations.
        
</p>
<p>
          To avoid the need to retain an infinite number of nonce values for future checks, servers
          MAY choose to restrict the time period after which a request with an old timestamp is
          rejected. Server applying such restriction SHOULD provide a way for the client to sync
          its clock with the server's clock.
        
</p>
<a name="signature"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Signature</h3>

<p>
					OAuth-authenticated requests can have two sets of credentials: those passed via the
					<tt>oauth_consumer_key</tt> parameter and those in the
					<tt>oauth_token</tt> parameter. In order for the server to
          verify the authenticity of the request and prevent unauthorized access, the client needs
          to prove it is the rightful owner of the credentials. This is accomplished using the
          shared-secret (or RSA key) part of each set of credentials.
        
</p>
<p>
          OAuth provides three methods for the client to prove its rightful ownership of the
          credentials: <tt>HMAC-SHA1</tt>, <tt>RSA-SHA1</tt>,
          and <tt>PLAINTEXT</tt>. These methods are generally referred to as
          signature methods, even though <tt>PLAINTEXT</tt> does not involve a
          signature. In addition, <tt>RSA-SHA1</tt> utilizes an RSA key instead
          of the shared-secrets associated with the client credentials.
        
</p>
<p>
          OAuth does not mandate a particular signature method, as each implementation can have its
          own unique requirements. Servers are free to implement and document their own custom
          methods. Recommending any particular method is beyond the scope of this specification.
        
</p>
<p>
          The client declares which signature method is used via the
          <tt>oauth_signature_method</tt> parameter. It then generates a signature
          (or a sting of an equivalent value), and includes it in the
          <tt>oauth_signature</tt> parameter. The server verifies the signature
          as specified for each method.
        
</p>
<p>
          The signature process does not change the request or its parameter, with the exception of
          the <tt>oauth_signature</tt> parameter.
        
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
Signature Base String</h3>

<p>
            The signature base string is a consistent, reproducible concatenation of several
            request elements into a single string. The string is used as an input to the
            <tt>HMAC-SHA1</tt> and <tt>RSA-SHA1</tt>
            signature methods, or potential future extension.
          
</p>
<p>
            The signature base string does not cover the entire HTTP request. Most notably, it
            does not include the entity-body in most requests, nor does it include most HTTP
            entity-headers. The importance of the signature base string scope is that the
            authenticity of the excluded components cannot be verified using the signature.
          
</p>
<a name="collect_param"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1.1"></a><h3>3.3.1.1.&nbsp;
Collect Request Parameters</h3>

<p>
              The signature base string includes a specific set of request parameters. In order for
              the parameter to be included in the signature base string, they MUST be used in their
              unencoded form.

              
<p>
                  For example, the URI:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  http://example.com/request?b5=%3D%253D&amp;a3=a&amp;c%40=&amp;a2=r%20b&amp;c2&amp;a3=2q
</pre></div>
<p>
                  contains the following raw-form parameters:
                
</p>
            
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">Name</th><th align="center">Value</th></tr>
<tr>
<td align="center">b5</td>
<td align="center">=%3D</td>
</tr>
<tr>
<td align="center">a3</td>
<td align="center">a</td>
</tr>
<tr>
<td align="center">c@</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">a2</td>
<td align="center">r b</td>
</tr>
<tr>
<td align="center">c2</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">a3</td>
<td align="center">2q</td>
</tr>
</table>
<br clear="all" />

<p>
              Note that the value of <tt>b5</tt> is <tt>=%3D</tt>
              and not <tt>==</tt>. Both <tt>c@</tt> and
              <tt>c2</tt> have empty values.
            
</p>
<p>
              The request parameters, which include both protocol parameters and request-specific
              parameters, are extracted and restored to their original unencoded form, from
              the following sources:
              </p>
<ul class="text">
<li>
                  The <a class='info' href='#auth_header'>OAuth HTTP Authorization header<span> (</span><span class='info'>Authorization Header</span><span>)</span></a>. The
                  <tt>realm</tt> parameter MUST be excluded if present.
                
</li>
<li>
                  The HTTP request entity-body, but only if:

                  
<ul class="text">
<li>
                      The entity-body is single-part.
                    
</li>
<li>
                      The entity-body follows the encoding requirements of the
                      <tt>application/x-www-form-urlencoded</tt> content-type as
                      defined by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>.
                    
</li>
<li>
                      The HTTP request entity-header includes the <tt>Content-Type</tt>
                      header set to <tt>application/x-www-form-urlencoded</tt>.
                    
</li>
</ul>
                
</li>
<li>
                  The query component of the HTTP request URI as defined by
                  <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> section 3.
                
</li>
</ul><p>
            
</p>
<p>
              The <tt>oauth_signature</tt> parameter MUST be
              excluded if present.
            
</p>
<p>
              In many cases, clients have direct access to the parameters in their original,
              unencoded form. In such cases, clients SHOULD use the unencoded values instead of
              extracting them. This option is not available for servers when validating incoming
              requests. Even though the parameters are encoded again in the process, they are
							decoded because each of the three sources uses a different encoding algorithm.
            
</p>
<p>
              The output of this step is a list of unencoded parameter name / value pairs.
            
</p>
<a name="sig_norm_param"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1.2"></a><h3>3.3.1.2.&nbsp;
Normalize Request Parameters</h3>

<p>
              The parameter collected in <a class='info' href='#collect_param'>Section&nbsp;3.3.1.1<span> (</span><span class='info'>Collect Request Parameters</span><span>)</span></a> are normalized into a
              single string as follows:

              </p>
<ol class="text">
<li>
                  First, the name and value of each parameter are <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
								
</li>
<li>
                  The parameters are sorted by name, using lexicographical byte value ordering. If
                  two or more parameters share the same name, they are sorted by their value.
                
</li>
<li>
                  The name of each parameter is concatenated to its corresponding value using an
                  <tt>=</tt> character (ASCII code 61) as separator, even if the
                  value is empty.
                
</li>
<li>
                  The sorted name / value pairs are concatenated together into a single string by
                  using an <tt>&amp;</tt> character (ASCII code 38) as separator.
                
</li>
</ol><p>
            
</p>
<p>
              For example, the list of parameters from the previous section would be normalized as
              follows:
            
</p>
<p style='text-align: center'>
                Encoded:
              
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">Name</th><th align="center">Value</th></tr>
<tr>
<td align="center">b5</td>
<td align="center">%3D%253D</td>
</tr>
<tr>
<td align="center">a3</td>
<td align="center">a</td>
</tr>
<tr>
<td align="center">c%40</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">a2</td>
<td align="center">r%20b</td>
</tr>
<tr>
<td align="center">c2</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">a3</td>
<td align="center">2q</td>
</tr>
</table>
<br clear="all" />

<p style='text-align: center'>
                Sorted:
              
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">Name</th><th align="center">Value</th></tr>
<tr>
<td align="center">a2</td>
<td align="center">r%20b</td>
</tr>
<tr>
<td align="center">a3</td>
<td align="center">2q</td>
</tr>
<tr>
<td align="center">a3</td>
<td align="center">a</td>
</tr>
<tr>
<td align="center">b5</td>
<td align="center">%3D%253D</td>
</tr>
<tr>
<td align="center">c%40</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">c2</td>
<td align="center">&nbsp;</td>
</tr>
</table>
<br clear="all" />

<p style='text-align: center'>
                Concatenated Pairs:
              
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center">
<tr><th align="center">Name=Value</th></tr>
<tr>
<td align="center">a2=r%20b</td>
</tr>
<tr>
<td align="center">a3=2q</td>
</tr>
<tr>
<td align="center">a3=a</td>
</tr>
<tr>
<td align="center">b5=%3D%253D</td>
</tr>
<tr>
<td align="center">c%40=</td>
</tr>
<tr>
<td align="center">c2=</td>
</tr>
</table>
<br clear="all" />

<p>
                And concatenated together into a single string:
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  a2=r%20b&amp;a3=2q&amp;a3=a&amp;b5=%3D%253D&amp;c%40=&amp;c2=
</pre></div>
<a name="sig_uri"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1.3"></a><h3>3.3.1.3.&nbsp;
Construct Base String URI</h3>

<p>
              The signature base string incorporates the scheme, authority, and path of the request
              URI as defined by <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> section 3. The request URI query component
              is included through the <a class='info' href='#sig_norm_param'>normalized parameters string<span> (</span><span class='info'>Normalize Request Parameters</span><span>)</span></a>,
              and the fragment component is excluded.
            
</p>
<p>
              This is done by constructing a base string URI representing the request without the query
              or fragment components. The base string URI is constructed as follows:

              </p>
<ol class="text">
<li>
                  The scheme and host MUST be in lowercase.
                
</li>
<li>
                  The host and port values MUST match the content of the HTTP request
                  <tt>Host</tt> header, if present. If the
                  <tt>Host</tt> header is not present, the client MUST use the
                  hostname and port used to make the request. Servers SHOULD remove potential
                  ambiguity in such cases by specifying the expected host value.
                
</li>
<li>
                  The port MUST be included if it is not the default port for the scheme, and MUST
                  be excluded if it is the default. Specifically, the port MUST be excluded when an
                  <tt>http</tt> request uses port 80 or when an
                  <tt>https</tt> request uses port 443. All other non-default
                  port numbers MUST be included.
                
</li>
<li>
                  If the URI includes an empty path, it MUST be included as <tt>/</tt>.
                
</li>
</ol><p>
            
</p>
<p>
              For example:
            
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">The request URI</th><th align="left">Is included in base string as</th></tr>
<tr>
<td align="left">HTTP://EXAMPLE.com:80/r/x?id=123</td>
<td align="left">http://example.com/r/x</td>
</tr>
<tr>
<td align="left">https://example.net:8080?q=1#top</td>
<td align="left">https://example.net:8080/</td>
</tr>
</table>
<br clear="all" />

<a name="base_string"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1.4"></a><h3>3.3.1.4.&nbsp;
Concatenate Base String Elements</h3>

<p>
              Finally, the signature base string is put together by concatenating its elements
              together. The elements MUST be concatenated in the following order:

              </p>
<ol class="text">
<li>
                  The HTTP request method in uppercase. For example: <tt>HEAD</tt>,
                  <tt>GET</tt>, <tt>POST</tt>, etc. If the
                  request uses a custom HTTP method, it MUST be <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
                
</li>
<li>
                  An <tt>&amp;</tt> character (ASCII code 38).
                
</li>
<li>
                  The base string URI from <a class='info' href='#sig_uri'>Section&nbsp;3.3.1.3<span> (</span><span class='info'>Construct Base String URI</span><span>)</span></a>, after being
                  <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
                
</li>
<li>
                  An <tt>&amp;</tt> character (ASCII code 38).
                
</li>
<li>
                  The normalized request parameters string from <a class='info' href='#sig_norm_param'>Section&nbsp;3.3.1.2<span> (</span><span class='info'>Normalize Request Parameters</span><span>)</span></a>,
                  after being <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
                
</li>
</ol><p>
            
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2"></a><h3>3.3.2.&nbsp;
HMAC-SHA1</h3>

<p>
            The <tt>HMAC-SHA1</tt> signature method uses the HMAC-SHA1 signature
            algorithm as defined in <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a>:

            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  digest = HMAC-SHA1 (key, text)
</pre></div><p>

          
</p>
<p>
            The HMAC-SHA1 function variables are used in following way:

            </p>
<blockquote class="text"><dl>
<dt>text</dt>
<dd>
                
                is set to the value of the signature base string from <a class='info' href='#base_string'>Section&nbsp;3.3.1.4<span> (</span><span class='info'>Concatenate Base String Elements</span><span>)</span></a>.
              
</dd>
<dt>key</dt>
<dd>
                
                is set to the concatenated values of:

                
<ol class="text">
<li>
                    The client shared-secret, after being <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
                  
</li>
<li>
                    An <tt>&amp;</tt> character (ASCII code 38), which MUST be
                    included even when either secret is empty.
                  
</li>
<li>
                    The token shared-secret, after being <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
                  
</li>
</ol>
              
</dd>
<dt>digest</dt>
<dd>
                
                is used to set the value of the <tt>oauth_signature</tt>
                protocol parameter, after the result octet string is base64-encoded per
                <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a> section 6.8.
              
</dd>
</dl></blockquote><p>
          
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3"></a><h3>3.3.3.&nbsp;
RSA-SHA1</h3>

<p>
            The <tt>RSA-SHA1</tt> signature method uses the RSASSA-PKCS1-v1_5
            signature algorithm as defined in <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a> section 8.2 (also known as
            PKCS#1), using SHA-1 as the hash function for EMSA-PKCS1-v1_5. To use this method, the
            client MUST have established client credentials with the server which included its RSA
            public key (in a manner which is beyond the scope of this specification).
          
</p>
<p>
            The signature base string is signed using the client's RSA private key per
            <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a> section 8.2.1:

            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  S = RSASSA-PKCS1-V1_5-SIGN (K, M)
</pre></div><p>


            Where:

            </p>
<blockquote class="text"><dl>
<dt>K</dt>
<dd>
                
                is set to the client's RSA private key,
              
</dd>
<dt>M</dt>
<dd>
                
                is set to the value of the signature base string from <a class='info' href='#base_string'>Section&nbsp;3.3.1.4<span> (</span><span class='info'>Concatenate Base String Elements</span><span>)</span></a>, and
              
</dd>
<dt>S</dt>
<dd>
                
                is the result signature used to set the value of the <tt>oauth_signature</tt>
                protocol parameter, after the result octet string is base64-encoded per <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a>
                section 6.8.
              
</dd>
</dl></blockquote><p>
          
</p>
<p>
            The server verifies the signature per <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a> section 8.2.2:

            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  RSASSA-PKCS1-V1_5-VERIFY ((n, e), M, S)
</pre></div><p>


            Where:

            </p>
<blockquote class="text"><dl>
<dt>(n, e)</dt>
<dd>
                
                is set to the client's RSA public key,
              
</dd>
<dt>M</dt>
<dd>
                
                is set to the value of the signature base string from <a class='info' href='#base_string'>Section&nbsp;3.3.1.4<span> (</span><span class='info'>Concatenate Base String Elements</span><span>)</span></a>, and
              
</dd>
<dt>S</dt>
<dd>
                
                is set to the octet string value of the <tt>oauth_signature</tt>
                protocol parameter received from the client.
              
</dd>
</dl></blockquote><p>
          
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.4"></a><h3>3.3.4.&nbsp;
PLAINTEXT</h3>

<p>
            The <tt>PLAINTEXT</tt> method does not employ a signature algorithm
            and does not provide any security as it transmits secrets in the clear. It SHOULD only
            be used with a transport-layer mechanisms such as TLS or SSL. It does not use the
            signature base string.
          
</p>
<p>
            The <tt>oauth_signature</tt> protocol parameter is set to the
            concatenated value of:

            </p>
<ol class="text">
<li>
                The client shared-secret, after being <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
              
</li>
<li>
                An <tt>&amp;</tt> character (ASCII code 38), which MUST be
                included even when either secret is empty.
              
</li>
<li>
                The token shared-secret, after being <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
              
</li>
</ol><p>
          
</p>
<a name="param_include"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Parameter Transmission</h3>

<p>
          When making an OAuth-authenticated request, protocol parameters SHALL be included in
          the request using one and only one of the following locations, listed in order of
          decreasing preference:

          </p>
<ol class="text">
<li>
              The HTTP <tt>Authorization</tt> header as described in
              <a class='info' href='#auth_header'>Section&nbsp;3.4.1<span> (</span><span class='info'>Authorization Header</span><span>)</span></a>.
            
</li>
<li>
              The HTTP request entity-body as described in <a class='info' href='#auth_body'>Section&nbsp;3.4.2<span> (</span><span class='info'>Form-Encoded Body</span><span>)</span></a>.
            
</li>
<li>
              The HTTP request URI query as described in <a class='info' href='#auth_query'>Section&nbsp;3.4.3<span> (</span><span class='info'>Request URI Query</span><span>)</span></a>.
            
</li>
</ol><p>
        
</p>
<p>
          In addition to these three methods, future extensions may provide other methods for
          including protocol parameters in the request.
        
</p>
<a name="auth_header"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1"></a><h3>3.4.1.&nbsp;
Authorization Header</h3>

<p>
            Protocol parameters can be transmitted using the HTTP
            <tt>Authorization</tt> header as defined by <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>
            with the auth-scheme name set to <tt>OAuth</tt> (case-insensitive).
          
</p>
<p>
              For example:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Authorization: OAuth realm="http://server.example.com/",
     oauth_consumer_key="0685bd9184jfhq22",
     oauth_token="ad180jjd733klru7",
     oauth_signature_method="HMAC-SHA1",
     oauth_signature="wOJIO9A2W5mFwDgiDvZbTSMK%2FPY%3D",
     oauth_timestamp="137131200",
     oauth_nonce="4572616e48616d6d65724c61686176",
     oauth_version="1.0"
</pre></div>
<p>
            Protocol parameters SHALL be included in the <tt>Authorization</tt>
            header as follows:

            </p>
<ol class="text">
<li>
                Parameter names and values are encoded per
                <a class='info' href='#encoding'>Parameter Encoding<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
              
</li>
<li>
                Each parameter's name is immediately followed by an <tt>=</tt>
                character (ASCII code 61), a <tt>"</tt> character (ASCII code 34),
                the parameter value (MAY be empty), and another <tt>"</tt> character
                (ASCII code 34).
              
</li>
<li>
                Parameters are separated by a <tt>,</tt> character (ASCII code 44)
                and OPTIONAL linear whitespace per <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>.
              
</li>
<li>
                The OPTIONAL <tt>realm</tt> parameter MAY be added and
                interpreted per <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>, section 1.2.
              
</li>
</ol><p>
          
</p>
<p>
            Servers MAY indicate their support for the <tt>OAuth</tt>
            auth-scheme by returning the HTTP <tt>WWW-Authenticate</tt>
            response header upon client requests for protected resources. As per
            <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a> such a response MAY include additional HTTP
            <tt>WWW-Authenticate</tt> headers:
          
</p>
<p>
              For example:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  WWW-Authenticate: OAuth realm="http://server.example.com/"
</pre></div>
<p>
            The realm parameter defines a protection realm per <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>,
            section 1.2.
          
</p>
<a name="auth_body"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2"></a><h3>3.4.2.&nbsp;
Form-Encoded Body</h3>

<p>
            Protocol parameters can be transmitted in the HTTP request entity-body, but only if the
            following REQUIRED conditions are met:

            </p>
<ul class="text">
<li>
                The entity-body is single-part.
              
</li>
<li>
                The entity-body follows the encoding requirements of the
                <tt>application/x-www-form-urlencoded</tt> content-type as
                defined by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>.
              
</li>
<li>
                The HTTP request entity-header includes the <tt>Content-Type</tt>
                header set to <tt>application/x-www-form-urlencoded</tt>.
              
</li>
</ul><p>

            
<p>
                For example (line breaks are for display purposes only):
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  oauth_consumer_key=0685bd9184jfhq22&amp;oauth_token=ad180jjd733klr
  u7&amp;oauth_signature_method=HMAC-SHA1&amp;oauth_signature=wOJIO9A2W5
  mFwDgiDvZbTSMK%2FPY%3D&amp;oauth_timestamp=137131200&amp;oauth_nonce=4
  572616e48616d6d65724c61686176&amp;oauth_version=1.0
</pre></div>
            
            The entity-body MAY include other request-specific parameters, in which case, the
            protocol parameters SHOULD be appended following the request-specific parameters,
            properly separated by an <tt>&amp;</tt> character (ASCII code 38).
          

<a name="auth_query"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.3"></a><h3>3.4.3.&nbsp;
Request URI Query</h3>

<p>
            Protocol parameters can be transmitted by being added to the HTTP request URI as a
            query parameter as defined by <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> section 3.

            
<p>
                For example (line breaks are for display purposes only):
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /example/path?oauth_consumer_key=0685bd9184jfhq22&amp;
  oauth_token=ad180jjd733klru7&amp;oauth_signature_method=HM
  AC-SHA1&amp;oauth_signature=wOJIO9A2W5mFwDgiDvZbTSMK%2FPY%
  3D&amp;oauth_timestamp=137131200&amp;oauth_nonce=4572616e48616
  d6d65724c61686176&amp;oauth_version=1.0 HTTP/1.1
</pre></div>

            The request URI MAY include other request-specific query parameters, in which case,
            the protocol parameters SHOULD be appended following the request-specific parameters,
            properly separated by an <tt>&amp;</tt> character (ASCII code 38).
          

<a name="auth_response"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Server Response</h3>

<p>
          Servers receiving an authenticated request MUST:
          
          </p>
<ul class="text">
<li>
              Recalculate the request signature independently and compare it to the value
              received from the client.
            
</li>
<li>
              Ensure that the nonce / timestamp / token combination has not been used before, and
              MAY reject requests with stale timestamps.
            
</li>
<li>
              If a token is present, verify the scope and status of the client authorization by
              using the token, and MAY choose to restrict token usage to the client to which it
              was issued.
            
</li>
<li>
              Ensure that the protocol version used is <tt>1.0</tt>.
            
</li>
</ul><p>
          
          If the request fails verification, the server SHOULD respond with the appropriate HTTP
          response status code. The server MAY include further details about why the request was
          rejected in the response body. The following status codes SHOULD be used:

          </p>
<ul class="text">
<li>
              400 (Bad Request)
              
              
<ul class="text">
<li>
                  Unsupported parameters
                
</li>
<li>
                  Unsupported signature method
                
</li>
<li>
                  Missing parameters
                
</li>
<li>
                  Duplicated protocol parameters
                
</li>
</ul>
            
</li>
<li>
              401 (Unauthorized)
              
<ul class="text">
<li>
                  Invalid client credentials
                
</li>
<li>
                  Invalid or expired token
                
</li>
<li>
                  Invalid signature
                
</li>
<li>
                  Invalid or used nonce
                
</li>
</ul>
            
</li>
</ul><p>
        
</p>
<a name="encoding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Percent Encoding</h3>

<p>
          OAuth uses the following percent-encoding rules:

          </p>
<ol class="text">
<li>
              Text values are first encoded as UTF-8 octets per <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a> if they are
              not already. This does not include binary values which are not intended for human
              consumption.
            
</li>
<li>
              The values are then escaped using the <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> percent-encoding
              (%XX) mechanism as follows:

              
<ul class="text">
<li>
                  Characters in the unreserved character set as defined by <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>
                  section 2.3 (ALPHA, DIGIT, "-", ".", "_", "~") MUST NOT be encoded.
                
</li>
<li>
                  All other characters MUST be encoded.
                
</li>
<li>
                  The two hexadecimal characters use to represent encoded characters MUST be
                  upper case.
                
</li>
</ul>
            
</li>
</ol><p>
        
</p>
<a name="redirect_workflow"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Redirection-Based Authorization</h3>

<p>
        OAuth uses a set of token credentials to represent the authorization granted
        to the client by the resource owner. Typically, token credentials are issued by the server
        at the resource owner's request, after authenticating the resource owner's identity using
        its server credentials (usually a username and password pair).
      
</p>
<p>
        There are many ways in which a resource owner can facilitate the provisioning of token
        credentials. This section defines one such way, using HTTP redirections and the resource
				owner's user agent. This redirection-based authorization method includes three steps:

        </p>
<ol class="text">
<li>
            The client obtains a set of temporary credentials from the server.
          
</li>
<li>
            The resource owner authorizes the server to issue token credentials to the client
            using the temporary credentials.
          
</li>
<li>
            The client uses the temporary credentials to request a set of token credentials from
            the server, which will enable it to access the resource owner's protected resources.
						The temporary credentials discarded.
          
</li>
</ol><p>
      
</p>
<p>
        The temporary credentials MUST be revoked after being used once to obtain the token credentials.
        It is RECOMMENDED that the temporary credentials have a limited lifetime. Servers SHOULD
        enable resource owners to revoke token credentials after they have been issued to clients.
      
</p>
<p>
        In order for the client to perform these steps, the server needs to advertise the URIs of
				these three endpoints, as well as the HTTP method (GET, POST, etc.) used to make each requests.
				To assist in communicating these endpoint, each is given a name:

        </p>
<blockquote class="text"><dl>
<dt>Temporary Credential Request</dt>
<dd>
            
            The endpoint used by the client to obtain temporary credentials as described in
            <a class='info' href='#auth_step1'>Section&nbsp;4.1<span> (</span><span class='info'>Temporary Credentials</span><span>)</span></a>.
          
</dd>
<dt>Resource Owner Authorization</dt>
<dd>
            
            The endpoint to which the resource owner is redirected to grant authorization as
            described in <a class='info' href='#auth_step2'>Section&nbsp;4.2<span> (</span><span class='info'>Resource Owner Authorization</span><span>)</span></a>.
          
</dd>
<dt>Token Request</dt>
<dd>
            
            The endpoint used by the client to request a set of token credentials using the
            temporary credentials as described in <a class='info' href='#auth_step3'>Section&nbsp;4.3<span> (</span><span class='info'>Token Credentials</span><span>)</span></a>.
          
</dd>
</dl></blockquote><p>
      
</p>
<p>
        The three URIs MAY include a query component as defined by <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>
        section 3, but if present, the query MUST NOT contain any parameters beginning with the
        <tt>oauth_</tt> prefix.
      
</p>
<p>
        The method in which the server advertises its three endpoint is beyond the scope of this
        specification.
      
</p>
<a name="auth_step1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Temporary Credentials</h3>

<p>
          The client obtains a set of temporary credentials from the server by making an
          <a class='info' href='#requests'>authenticated request<span> (</span><span class='info'>Authenticated Requests</span><span>)</span></a> to the Temporary Credential Request endpoint URI.
					The server SHOULD use the HTTP POST method and the client MUST use the HTTP method
					advertised by the server. The client constructs a request URI by adding the following
					parameter to the request:

					</p>
<blockquote class="text"><dl>
<dt>oauth_callback:</dt>
<dd>
							An absolute URI to which the server will redirect the resource owner back when the
							Resource Owner Authorization step (<a class='info' href='#auth_step2'>Section&nbsp;4.2<span> (</span><span class='info'>Resource Owner Authorization</span><span>)</span></a>) is completed. If the
							client is unable to receive callbacks or a callback URI has been established via other
							means, the parameter value MUST be set to <tt>oob</tt> (case sensitive),
							to indicate an out-of-band configuration.
						
</dd>
<dt>Servers MAY specify additional parameters.</dt>
<dd>
						
</dd>
</dl></blockquote><p>
				
</p>
<p>
					When making the request, the client authenticates using only the client credentials. The
					client MUST omit the <tt>oauth_token</tt> protocol parameter from the
					request and use an empty string as the token secret value.
				
</p>
<p>
          The server MUST <a class='info' href='#auth_response'>verify<span> (</span><span class='info'>Server Response</span><span>)</span></a> the request and if valid,
          respond back to the client with a set of temporary credentials. The temporary credentials
          are included in the HTTP response body using the
          <tt>application/x-www-form-urlencoded</tt> content type as defined by
          <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>.
        
</p>
<p>
          The response contains the following parameters:

          </p>
<blockquote class="text"><dl>
<dt>oauth_token</dt>
<dd>
              
              The temporary credentials identifier.
            
</dd>
<dt>oauth_token_secret</dt>
<dd>
              
              The temporary credentials shared-secret.
            
</dd>
<dt>oauth_callback_confirmed:</dt>
<dd>
							MUST be present and set to <tt>true</tt>. The client
							MAY use this to confirm that the server received the callback value.
						
</dd>
</dl></blockquote><p>
        
</p>
<p>
          Note that even though the parameter names include the term 'token', these credentials are
          not token credentials, but are used in the next two steps in a similar manner to token
          credentials.
        
</p>
<p>
						For example (line breaks are for display purposes only):
					
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  oauth_token=ab3cd9j4ks73hf7g&amp;oauth_token_secret=xyz4992k83j47x0b&amp;
  oauth_callback_confirmed=true
</pre></div>
<a name="auth_step2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Resource Owner Authorization</h3>

<p>
          Before the client requests a set of token credentials from the server, it MUST send
          the user to the server to authorize the request. The client constructs a request URI by
          adding the following parameters to the Resource Owner Authorization endpoint URI:

          </p>
<blockquote class="text"><dl>
<dt>oauth_token</dt>
<dd>
              
              REQUIRED. The temporary credentials identifier obtained in <a class='info' href='#auth_step1'>Section&nbsp;4.1<span> (</span><span class='info'>Temporary Credentials</span><span>)</span></a>
              in the <tt>oauth_token</tt> parameter. Servers MAY declare this
              parameter as OPTIONAL, in which case they MUST provide a way for the resource owner
              to indicate the identifier through other means.
            
</dd>
<dt>Servers MAY specify additional parameters.</dt>
<dd>
            
</dd>
</dl></blockquote><p>
        
</p>
<p>
          The client redirects the resource owner to the constructed URI using an HTTP redirection
          response, or by other means available to it via the resource owner's user agent. The
          request MUST use the HTTP GET method.
        
</p>
<p>
          The way in which the server handles the authorization request is beyond the scope of this
          specification. However, the server MUST first verify the identity of the resource owner.
				
</p>
<p>
          When asking the resource owner to authorize the requested access, the server SHOULD
          present to the resource owner information about the client requesting access based on the
          association of the temporary credentials with the client identity. When displaying any
          such information, the server SHOULD indicate if the information has been verified.
        
</p>
<p>
          After receiving an authorization decision from the resource owner, the server redirects
          the resource owner to the callback URI if one was provided in the
					<tt>oauth_callback</tt> parameter or by other means.
				
</p>
<p>
					To make sure that the resource owner granting access is the same resource owner returning
					back to the client to complete the process, the server MUST generate a verification code:
					an unguessable value passed to the client via the resource owner and REQUIRED to complete
					the process. The server constructs the request URI by adding the following parameter to the
					callback URI query component:

          </p>
<blockquote class="text"><dl>
<dt>oauth_token</dt>
<dd>
							
              The temporary credentials identifier the resource owner authorized or denied access
              to.
            
</dd>
<dt>oauth_verifier:</dt>
<dd>
							The verification code.
						
</dd>
</dl></blockquote><p>
          
					If the callback URI already includes a query component, the server MUST append the
					OAuth parameters to the end of the existing query.
				
</p>
<p>
						For example (line breaks are for display purposes only):
					
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  http://client.example.net/cb?state=1&amp;oauth_token=ab3cd9j4ks73hf7g&amp;
  oauth_verifier=473829k9302sa
</pre></div>
<p>
					If the client did not provide a callback URI, the server SHOULD display the value of the
					verification code, and instruct the resource owner to manually inform the client that
					authorization is completed. If the server knows a client to be running on a limited device
					it SHOULD ensure that the verifier value is suitable for manual entry.
				
</p>
<a name="auth_step3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Token Credentials</h3>

<p>
          The client obtains a set of token credentials from the server by making an
          <a class='info' href='#requests'>authenticated request<span> (</span><span class='info'>Authenticated Requests</span><span>)</span></a> to the Token Request endpoint URI.
					The server SHOULD use the HTTP POST method and the client MUST use the HTTP method
					advertised by the server. The client constructs a request URI by adding the following
					parameter to the request:

					</p>
<blockquote class="text"><dl>
<dt>oauth_verifier:</dt>
<dd>
							The verification code received from the server in the previous step.
						
</dd>
</dl></blockquote><p>
				
</p>
<p>
          When making the request, the client authenticates using the client credentials as well as
          the temporary credentials. The temporary credentials are used as a substitution for token
          credentials in the authenticated request.
        
</p>
<p>
          The server MUST <a class='info' href='#auth_response'>verify<span> (</span><span class='info'>Server Response</span><span>)</span></a> the validity of the request,
					ensure that the resource owner has authorized the provisioning of token credentials to
					the client, and that the temporary credentials have not expired or used before. The server
					MUST also verify the verification code received from the client. If the
					request is valid and authorized, the token credentials are included in the HTTP response
					body using the <tt>application/x-www-form-urlencoded</tt> content type
          as defined by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>.
        
</p>
<p>
          The response contains the following parameters:

          </p>
<blockquote class="text"><dl>
<dt>oauth_token</dt>
<dd>
              
              The token identifier.
            
</dd>
<dt>oauth_token_secret</dt>
<dd>
              
              The token shared-secret.
            
</dd>
</dl></blockquote><p>
        
</p>
<p>
            For example:
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  oauth_token=j49ddk933skd9dks&amp;oauth_token_secret=ll399dj47dskfjdk
</pre></div>
<p>
          The token credentials issued by the server MUST reflect the exact scope, duration, and
          other attributes approved by the resource owner.
        
</p>
<p>
          Once the client receives the token credentials, it can proceed to access protected
          resources on behalf of the resource owner by making
          <a class='info' href='#requests'>authenticated request<span> (</span><span class='info'>Authenticated Requests</span><span>)</span></a> using the client credentials and the
          token credentials received.
        
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>
        This memo includes no request to IANA.
      
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
        As stated in <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>, the greatest sources of risks are usually found not
        in the core protocol itself but in policies and procedures surrounding its use. Implementers
        are strongly encouraged to assess how this protocol addresses their security requirements.
      
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Credentials Transmission</h3>

<p>
          The OAuth specification does not describe any mechanism for protecting tokens and
          shared-secrets from eavesdroppers when they are transmitted from the server to the
          client during the authorization phase. Servers should ensure that these transmissions are
          protected using transport-layer mechanisms such as TLS or SSL.
        
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
RSA-SHA1 Signature Method</h3>

<p>
          When used with <tt>RSA-SHA1</tt> signatures, the
          OAuth protocol does not use the token shared-secret, or any provisioned client
          shared-secret. This means the protocol relies completely on the secrecy of the private
          key used by the client to sign requests.
        
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
PLAINTEXT Signature Method</h3>

<p>
          When used with the <tt>PLAINTEXT</tt> method, the protocol makes no
          attempts to protect credentials from eavesdroppers or man-in-the-middle attacks. The
          <tt>PLAINTEXT</tt> method is only intended to be used in conjunction
          with a transport-layer security mechanism such as TLS or SSL which does provide such
          protection.
        
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Confidentiality of Requests</h3>

<p>
          While OAuth provides a mechanism for verifying the integrity of requests, it provides no
          guarantee of request confidentiality. Unless further precautions are taken, eavesdroppers
          will have full access to request content. Servers should carefully consider the kinds of
          data likely to be sent as part of such requests, and should employ transport-layer
          security mechanisms to protect sensitive resources.
        
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
Spoofing by Counterfeit Servers</h3>

<p>
          OAuth makes no attempt to verify the authenticity of the server. A hostile party could
          take advantage of this by intercepting the client's requests and returning misleading or
          otherwise incorrect responses. Service providers should consider such attacks when
          developing services based on OAuth, and should require transport-layer security for any
          requests where the authenticity of the server or of request responses is an issue.
        
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
Proxying and Caching of Authenticated Content</h3>

<p>
          The <a class='info' href='#auth_header'>HTTP Authorization scheme<span> (</span><span class='info'>Authorization Header</span><span>)</span></a> is optional. However,
          <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> relies on the <tt>Authorization</tt> and
          <tt>WWW-Authenticate</tt> headers to distinguish authenticated content
          so that it can be protected. Proxies and caches, in particular, may fail to adequately
          protect requests not using these headers.
        
</p>
<p>
          For example, private authenticated content may be stored in (and thus retrievable from)
          publicly-accessible caches. Servers not using the
          <a class='info' href='#auth_header'>HTTP Authorization header<span> (</span><span class='info'>Authorization Header</span><span>)</span></a> should take care to use other
          mechanisms, such as the <tt>Cache-Control</tt> header, to ensure that
          authenticated content is protected.
        
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7"></a><h3>6.7.&nbsp;
Plaintext Storage of Credentials</h3>

<p>
          The client shared-secret and token shared-secret function the same way passwords do in
          traditional authentication systems. In order to compute the signatures used in methods
          other than <tt>RSA-SHA1</tt>, the server must have access to these
          secrets in plaintext form. This is in contrast, for example, to modern operating systems,
          which store only a one-way hash of user credentials.
        
</p>
<p>
          If an attacker were to gain access to these secrets - or worse, to the server's database
          of all such secrets - he or she would be able to perform any action on behalf of any
          resource owner. Accordingly, it is critical that servers protect these secrets from
          unauthorized access.
        
</p>
<a name="client_cred_sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.8"></a><h3>6.8.&nbsp;
Secrecy of the Client Credentials</h3>

<p>
          In many cases, the client application will be under the control of potentially untrusted
          parties. For example, if the client is a freely available desktop application, an
          attacker may be able to download a copy for analysis. In such cases, attackers will be
          able to recover the client credentials.
        
</p>
<p>
          Accordingly, servers should not use the client credentials alone to verify the identity
          of the client. Where possible, other factors such as IP address should be used as well.
        
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.9"></a><h3>6.9.&nbsp;
Phishing Attacks</h3>

<p>
          Wide deployment of OAuth and similar protocols may cause resource owners to become inured
          to the practice of being redirected to websites where they are asked to enter their
          passwords. If resource owners are not careful to verify the authenticity of these
          websites before entering their credentials, it will be possible for attackers to exploit
          this practice to steal resource owners' passwords.
        
</p>
<p>
          Servers should attempt to educate resource owners about the risks phishing attacks pose,
          and should provide mechanisms that make it easy for resource owners to confirm the
          authenticity of their sites.
        
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.10"></a><h3>6.10.&nbsp;
Scoping of Access Requests</h3>

<p>
          By itself, OAuth does not provide any method for scoping the access rights granted to a
          client. However, most applications do require greater granularity of access rights. For
          example, servers may wish to make it possible to grant access to some protected resources
          but not others, or to grant only limited access (such as read-only access) to those
          protected resources.
        
</p>
<p>
          When implementing OAuth, servers should consider the types of access resource owners may
          wish to grant clients, and should provide mechanisms to do so. Servers should also take
          care to ensure that resource owners understand the access they are granting, as well as
          any risks that may be involved.
        
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.11"></a><h3>6.11.&nbsp;
Entropy of Secrets</h3>

<p>
          Unless a transport-layer security protocol is used, eavesdroppers will have full access
          to OAuth requests and signatures, and will thus be able to mount offline brute-force
          attacks to recover the credentials used. Servers should be careful to assign
          shared-secrets which are long enough, and random enough, to resist such attacks for at
          least the length of time that the shared-secrets are valid.
        
</p>
<p>
          For example, if shared-secrets are valid for two weeks, servers should ensure that it is
          not possible to mount a brute force attack that recovers the shared-secret in less than
          two weeks. Of course, servers are urged to err on the side of caution, and use the longest
          secrets reasonable.
        
</p>
<p>
          It is equally important that the pseudo-random number generator (PRNG) used to generate
          these secrets be of sufficiently high quality. Many PRNG implementations generate number
          sequences that may appear to be random, but which nevertheless exhibit patterns or other
          weaknesses which make cryptanalysis or brute force attacks easier. Implementers should be
          careful to use cryptographically secure PRNGs to avoid these problems.
        
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.12"></a><h3>6.12.&nbsp;
Denial of Service / Resource Exhaustion Attacks</h3>

<p>
          The OAuth protocol has a number of features which may make resource exhaustion attacks
          against servers possible. For example, OAuth requires servers to track used nonces. If an attacker is able to use
          many nonces quickly, the resources required to track them may exhaust available capacity.
          And again, OAuth can require servers to perform potentially expensive computations in
          order to verify the signature on incoming requests. An attacker may exploit this to
          perform a denial of service attack by sending a large number of invalid requests to the
          server.
        
</p>
<p>
          Resource Exhaustion attacks are by no means specific to OAuth. However, OAuth implementers
          should be careful to consider the additional avenues of attack that OAuth exposes, and
          design their implementations accordingly. For example, entropy starvation typically
          results in either a complete denial of service while the system waits for new entropy or
          else in weak (easily guessable) secrets. When implementing OAuth, servers should consider
          which of these presents a more serious risk for their application and design accordingly.
        
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.13"></a><h3>6.13.&nbsp;
Cryptographic Attacks</h3>

<p>
          SHA-1, the hash algorithm used in <tt>HMAC-SHA1</tt> signatures, has
          been <a class='info' href='#SHA1-CHARACTERISTICS'>shown<span> (</span><span class='info'>De Canniere, C. and C. Rechberger, &ldquo;Finding SHA-1 Characteristics: General Results and Applications,&rdquo; .</span><span>)</span></a> [SHA1&#8209;CHARACTERISTICS] to have a number of cryptographic
          weaknesses that significantly reduce its resistance to collision attacks. Practically
          speaking, these weaknesses are difficult to exploit, and by themselves do not pose a
          significant risk to users of OAuth. They may, however, make more efficient attacks
          possible, and NIST has <a class='info' href='#SHA-COMMENTS'>announced<span> (</span><span class='info'>National Institute of Standards and Technology, NIST., &ldquo;NIST Brief Comments on Recent Cryptanalytic Attacks on Secure Hashing Functions and the Continued Security Provided by SHA-1, August, 2004.,&rdquo; .</span><span>)</span></a> [SHA&#8209;COMMENTS] that it will phase
          out use of SHA-1 by 2010. Servers should take this into account when considering whether
          SHA-1 provides an adequate level of security for their applications.
        
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.14"></a><h3>6.14.&nbsp;
Signature Base String Limitations</h3>

<p>
          The signature base string has been designed to support the signature methods defined in
          this specification. When designing additional signature methods, the signature base
          string should be evaluated to ensure compatibility with the algorithms used.
        
</p>
<p>
          Since the signature base string does not cover the entire HTTP request, such as most
          request entity-body, most entity-headers, and the order in which parameters are sent,
          servers should employ additional mechanisms to protect such elements.
        
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.15"></a><h3>6.15.&nbsp;
Cross-Site Request Forgery (CSRF)</h3>

<p>
					Cross-Site Request Forgery (CSRF) is a web-based attack whereby HTTP requests
					are transmitted from a user that the website trusts or has authenticated.
					CSRF attacks on OAuth approvals can allow an attacker to obtain authorization to
					protected resources without the consent of the User. Servers SHOULD strongly
					consider best practices in CSRF prevention at all OAuth endpoints.
				
</p>
<p>
					CSRF attacks on OAuth callback URIs hosted by client are also possible.
					Clients should prevent CSRF attacks on OAuth callback URIs by verifying that
					the resource owner at the client site intended to complete the OAuth negotiation with the
					server.
				
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.16"></a><h3>6.16.&nbsp;
User Interface Redress</h3>

<p>
					Servers should protect the authorization process against UI Redress attacks
					(also known as "clickjacking"). As of the time of this writing, no complete defenses
					against UI redress are available. Servers can mitigate the risk of UI
					redress attacks through the following techniques:

					</p>
<ul class="text">
<li>Javascript frame busting.
</li>
<li>Javascript frame busting, and requiring that browsers have javascript enabled on the authorization page.
</li>
<li>Browser-specific anti-framing techniques.
</li>
<li>Requiring password reentry before issuing OAuth tokens.
</li>
</ul><p>
				
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.17"></a><h3>6.17.&nbsp;
Automatic Processing of Repeat Authorizations</h3>

<p>
					Servers may wish to automatically process authorization requests
					(<a class='info' href='#auth_step2'>Section&nbsp;4.2<span> (</span><span class='info'>Resource Owner Authorization</span><span>)</span></a>) from clients which have been previously
					authorized by the resource owner. When the resource owner is redirected to the server
					to grant access, the server detects that the resource owner has already granted
					access to that particular client. Instead of prompting the resource owner for approval,
					the server automatically redirects the resource owner back to the client.
				
</p>
<p>
					If the client credentials are compromised, automatic processing creates additional
					security risks. An attacker can use the stolen client credentials to redirect
					the resource owner to the server with an authorization request. The server
					will then grant access to the resource owner's data without the resource owner's
					explicit approval, or even awareness of an attack. If no automatic approval is
					implemented, an attacker must use social engineering to convince the resource owner to
					approve access.
				
</p>
<p>
					Servers can mitigate the risks associated with automatic processing by
					limiting the scope of token credentials obtained through automated approvals. Tokens
					credentials obtained through explicit resource owner consent can remain unaffected. clients
					can mitigate the risks associated with automatic processing by protecting their client
					credentials.
				
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Examples</h3>

<p>
        In this example, photos.example.net is a photo sharing website (server), and
        printer.example.com is a photo printing service (client). Jane (resource owner) would like
        printer.example.com to print a private photo stored at photos.example.net.
      
</p>
<p>
        When Jane signs-into photos.example.net using her username and password, she can access the
        photo by requesting the URI <tt>http://photos.example.net/photo?file=vacation.jpg</tt>
        (which also supports the optional <tt>size</tt> parameter).
        Jane does not want to share her username and password with printer.example.com, but would
        like it to access the photo and print it.
      
</p>
<p>
        The server documentation advertises support for the <tt>HMAC-SHA1</tt>
        and <tt>PLAINTEXT</tt> methods, with <tt>PLAINTEXT</tt>
        restricted to secure (HTTPS) requests. It also advertises the following endpoint URIs:

        </p>
<blockquote class="text"><dl>
<dt>Temporary Credential Request</dt>
<dd>
            
            https://photos.example.net/initiate, using HTTP POST
          
</dd>
<dt>Resource Owner Authorization URI:</dt>
<dd>
            
            http://photos.example.net/authorize, using HTTP GET
          
</dd>
<dt>Token Request URI:</dt>
<dd>
            
            https://photos.example.net/token, using HTTP POST
          
</dd>
</dl></blockquote><p>
      
</p>
<p>
        The printer.example.com has already established client credentials with photos.example.net:

        </p>
<blockquote class="text"><dl>
<dt>Client Identifier</dt>
<dd>
            
            <tt>dpf43f3p2l4k3l03</tt>
          
</dd>
<dt>Client Shared-Secret:</dt>
<dd>
            
            <tt>kd94hf93k423kf44</tt>
          
</dd>
</dl></blockquote><p>
      
</p>
<p>
        When printer.example.com attempts to print the request photo, it receives an HTTP response
        with a 401 (Unauthorized) status code, and a challenge to use OAuth:

        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  WWW-Authenticate: OAuth realm="http://photos.example.net/"
</pre></div><p>

      
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>Appendix A.1.&nbsp;
Obtaining Temporary Credentials</h3>

<p>
          The client sends the following HTTPS POST request to the server:

          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /initiate HTTP/1.1
  Host: photos.example.net
  Authorization: OAuth realm="http://photos.example.com/",
     oauth_consumer_key="dpf43f3p2l4k3l03",
     oauth_signature_method="PLAINTEXT",
     oauth_signature="kd94hf93k423kf44%26",
     oauth_timestamp="1191242090",
     oauth_nonce="hsu94j3884jdopsl",
     oauth_version="1.0",
     oauth_callback="http%3A%2F%2Fprinter.example.com%2Fready"
</pre></div><p>

        
</p>
<p>
          The server validates the request and replies with a set of temporary credentials in the body
          of the HTTP response:

          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  oauth_token=hh5s93j4hdidpola&amp;oauth_token_secret=hdhd0244k9j7ao03&amp;
  oauth_callback_confirmed=true
</pre></div><p>

        
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>Appendix A.2.&nbsp;
Requesting Resource Owner Authorization</h3>

<p>
          The client redirects Jane's browser to the server's Resource Owner Authorization endpoint
          URI to obtain Jane's approval for accessing her private photos.

          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  http://photos.example.net/authorize?oauth_token=hh5s93j4hdidpola
</pre></div><p>

        
</p>
<p>
          The server asks Jane to sign-in using her username and password and if successful, asks
          her if she approves granting printer.example.com access to her private photos. Jane approves
          the request and is redirects her back to the client's callback URI:

          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  http://printer.example.com/ready?
  oauth_token=hh5s93j4hdidpola&amp;oauth_verifier=hfdp7dh39dks9884
</pre></div><p>

        
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>Appendix A.3.&nbsp;
Obtaining Token Credentials</h3>

<p>
          After being informed by the callback request that Jane approved authorized access,
          printer.example.com requests a set of token credentials using its temporary credentials:

          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /token HTTP/1.1
  Host: photos.example.net
  Authorization: OAuth realm="http://photos.example.com/",
     oauth_consumer_key="dpf43f3p2l4k3l03",
     oauth_token="hh5s93j4hdidpola",
     oauth_signature_method="PLAINTEXT",
     oauth_signature="kd94hf93k423kf44%26hdhd0244k9j7ao03",
     oauth_timestamp="1191242092",
     oauth_nonce="dji430splmx33448",
     oauth_version="1.0",
     oauth_verifier="hfdp7dh39dks9884"
</pre></div><p>

        
</p>
<p>
          The server validates the request and replies with a set of token credentials in the body
          of the HTTP response:

          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  oauth_token=nnch734d00sl2jdk&amp;oauth_token_secret=pfkkdhi9sl3r4s00
</pre></div><p>

        
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.4"></a><h3>Appendix A.4.&nbsp;
Accessing protected resources</h3>

<p>
          The printer is now ready to request the private photo. Since the photo URI does not use
          HTTPS, the <tt>HMAC-SHA1</tt> method is required.
        
</p>
<a name="sig_base_example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.4.1"></a><h3>Appendix A.4.1.&nbsp;
Generating Signature Base String</h3>

<p>
            To generate the signature, it first needs to generate the signature base string. The
            request contains the following parameters (<tt>oauth_signature</tt>
            excluded) which need to be ordered and concatenated into a normalized string:

            </p>
<blockquote class="text"><dl>
<dt>oauth_consumer_key</dt>
<dd>
                
                <tt>dpf43f3p2l4k3l03</tt>
              
</dd>
<dt>oauth_token</dt>
<dd>
                
                <tt>nnch734d00sl2jdk</tt>
              
</dd>
<dt>oauth_signature_method</dt>
<dd>
                
                <tt>HMAC-SHA1</tt>
              
</dd>
<dt>oauth_timestamp</dt>
<dd>
                
                <tt>1191242096</tt>
              
</dd>
<dt>oauth_nonce</dt>
<dd>
                
                <tt>kllo9940pd9333jh</tt>
              
</dd>
<dt>oauth_version</dt>
<dd>
                
                <tt>1.0</tt>
              
</dd>
<dt>file</dt>
<dd>
                
                <tt>vacation.jpg</tt>
              
</dd>
<dt>size</dt>
<dd>
                
                <tt>original</tt>
              
</dd>
</dl></blockquote><p>
          
</p>
<p>
            The following inputs are used to generate the signature base string:

            </p>
<ol class="text">
<li>
                The HTTP request method: <tt>GET</tt>
              
</li>
<li>
                The request URI: <tt>http://photos.example.net/photos</tt>
              
</li>
<li>
                The encoded normalized request parameters string:                
                <tt>file=vacation.jpg&amp;oauth_consumer_key=dpf43f3p2l4k3l03&amp;oauth_nonce=kllo9940pd9333jh&amp;oauth_signature_method=HMAC-SHA1&amp;oauth_timestamp=1191242096&amp;oauth_token=nnch734d00sl2jdk&amp;oauth_version=1.0&amp;size=original</tt>
              
</li>
</ol><p>
          
</p>
<p>
            The signature base string is (line breaks are for display purposes only):

            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET&amp;http%3A%2F%2Fphotos.example.net%2Fphotos&amp;file%3Dvacation.jpg%26
  oauth_consumer_key%3Ddpf43f3p2l4k3l03%26oauth_nonce%3Dkllo9940pd933
  3jh%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D119124
  2096%26oauth_token%3Dnnch734d00sl2jdk%26oauth_version%3D1.0%26size%
  3Doriginal
</pre></div><p>

          
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.4.2"></a><h3>Appendix A.4.2.&nbsp;
Calculating Signature Value</h3>

<p>
            HMAC-SHA1 produces the following <tt>digest</tt> value as a base64-encoded
            string (using the signature base string as <tt>text</tt> and
            <tt>kd94hf93k423kf44&amp;pfkkdhi9sl3r4s00</tt> as <tt>key</tt>):

            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  tR3+Ty81lMeYAr/Fid0kMTYa/WM=
</pre></div><p>

          
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.4.3"></a><h3>Appendix A.4.3.&nbsp;
Requesting protected resource</h3>

<p>
            All together, the client request for the photo is:

            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /photos?file=vacation.jpg&amp;size=original HTTP/1.1
  Host: photos.example.com
  Authorization: OAuth realm="http://photos.example.net/",
     oauth_consumer_key="dpf43f3p2l4k3l03",
     oauth_token="nnch734d00sl2jdk",
     oauth_signature_method="HMAC-SHA1",
     oauth_signature="tR3%2BTy81lMeYAr%2FFid0kMTYa%2FWM%3D",
     oauth_timestamp="1191242096",
     oauth_nonce="kllo9940pd9333jh",
     oauth_version="1.0"
</pre></div><p>

          
</p>
<p>
            The photos.example.net sever validates the request and responds with the requested
            photo.
          
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Differences from the Community Edition</h3>

<p>
				This specification includes the following changes made to the original community document
				in order to correct mistakes and omissions identified since the document has been published:
				
				</p>
<ul class="text">
<li>
						Adjusted nonce language to indicate it is unique per token / timestamp / client combination.
					
</li>
<li>
						Extended signature base string coverage which includes <tt>application/x-www-form-urlencoded</tt>
						entity-body parameters when the HTTP method used is other than POST and URI query
						parameters when the HTTP method used is other than GET.
					
</li>
<li>
						Requirement to normalize empty request URI paths as <tt>/</tt>.
					
</li>
<li>
						Corrections to the instructions in each signature method to encode the signature value before
						inserting it into the <tt>oauth_signature</tt> parameter, removing errors
						which would have caused double-encoded values.
					
</li>
</ul><p>
			
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Acknowledgments</h3>

<p>
				This specification is directly based on the OAuth Core 1.0 Revision A community
				specification which is the product of the OAuth community. OAuth was modeled after
				existing proprietary protocols and best practices that have been independently implemented
				by various web sites. The community specification was authored by: Mark Atwood,
				Dirk Balfanz, Darren Bounds, Richard M. Conlan, Blaine Cook, Leah Culver, Breno de Medeiros,
				Brian Eaton, Kellan Elliott-McCrea, Larry Halff, Eran Hammer-Lahav, Ben Laurie, Chris Messina,
				John Panzer, Sam Quigley, David Recordon, Eran Sandler, Jonathan Sergent, Todd Sieling,
				Brian Slesinsky, and Andy Smith.
			
</p>
<a name="history"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
Document History</h3>

<p>
        [[ To be removed by the RFC editor before publication as an RFC. ]]
      
</p>
<p>
				-03

				</p>
<ul class="text">
<li>
						Updated draft with changes from OAuth Core 1.0 Revision A to fix a session fixation exploit.
					
</li>
<li>
						Small editorial corrections.
					
</li>
<li>
						Removed confusing language from 'Denial of Service / Resource Exhaustion Attacks'.
					
</li>
<li>
						Added new 'Differences from the Community Edition' appendix.
					
</li>
<li>
						Updated acknowledgements section.
					
</li>
</ul><p>
			
</p>
<p>
        -02

        </p>
<ul class="text">
<li>
            Corrected mistake in parameter sorting order (c%40 comes before c2).
          
</li>
<li>
            Added requirement to normalize empty paths as '/'.
          
</li>
</ul><p>
      
</p>
<p>
        -01

        </p>
<ul class="text">
<li>
            Complete rewrite of the entire specification from scratch. Separated the spec structure
            into two parts and flipped their order.
          
</li>
<li>
            Corrected errors in instructions to encode the signature base sting by some methods. The
            signature value is encoded using the transport rules, not the spec method for encoding.
          
</li>
<li>
            Replaced the entire terminology.
          
</li>
</ul><p>
      
</p>
<p>
        -00

        </p>
<ul class="text">
<li>
            Initial draft based on the OAuth Core 1.0 community specification
            with the following changes.
          
</li>
<li>
            Various changes required to accommodate the strict format requirements of the IETF,
            such as moving sections around (Security, Contributors, Introduction, etc.), cleaning
            references, adding IETF specific text, etc.
          
</li>
<li>
            Moved the Parameter Encoding sub-section from section 5 (Parameters) to section 9.1
            (Signature Base String) to make it clear it only applies to the signature base string.
          
</li>
<li>
            Nonce language adjusted to indicate it is unique per token/timestamp/consumer
            combination.
          
</li>
<li>
            Added security language regarding lack of token secrets in RSA-SHA1.
          
</li>
<li>
            Fixed the bug in the Normalize Request Parameters section. Removed the 'GET' limitation
            from the third bullet (query parameters).
          
</li>
<li>
            Removed restriction of only signing application/x-www-form-urlencoded in POST requests,
            allowing the entity-body to be used with all HTTP request methods.
          
</li>
</ul><p>
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2045">[RFC2045]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com">N. Borenstein</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2045">Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</a>,&rdquo; RFC&nbsp;2045, November&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2045.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2617">[RFC2617]</a></td>
<td class="author-text"><a href="mailto:john@math.nwu.edu">Franks, J.</a>, <a href="mailto:pbaker@verisign.com">Hallam-Baker, P.</a>, <a href="mailto:jeff@AbiSource.com">Hostetler, J.</a>, <a href="mailto:lawrence@agranat.com">Lawrence, S.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, Luotonen, A., and <a href="mailto:stewart@OpenMarket.com">L. Stewart</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2617">HTTP Authentication: Basic and Digest Access Authentication</a>,&rdquo; RFC&nbsp;2617, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2617.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2617.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2617.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3447">[RFC3447]</a></td>
<td class="author-text">Jonsson, J. and B. Kaliski, &ldquo;<a href="http://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</a>,&rdquo; RFC&nbsp;3447, February&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3447.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3986">[RFC3986]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.REC-html40-19980424">[W3C.REC-html40-19980424]</a></td>
<td class="author-text">Hors, A., Jacobs, I., and D. Raggett, &ldquo;<a href="http://www.w3.org/TR/1998/REC-html40-19980424">HTML 4.0 Specification</a>,&rdquo; World Wide Web Consortium Recommendation&nbsp;REC-html40-19980424, April&nbsp;1998 (<a href="http://www.w3.org/TR/1998/REC-html40-19980424">HTML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="SHA-COMMENTS">[SHA-COMMENTS]</a></td>
<td class="author-text">National Institute of Standards and Technology, NIST., &ldquo;<a href="http://csrc.nist.gov/hash_standards_comments.pdf">NIST Brief Comments on Recent Cryptanalytic Attacks on Secure Hashing Functions and the Continued Security Provided by SHA-1, August, 2004.</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="SHA1-CHARACTERISTICS">[SHA1-CHARACTERISTICS]</a></td>
<td class="author-text">De Canniere, C. and C. Rechberger, &ldquo;<a href="http://dx.doi.org/10.1007/11935230_1">Finding SHA-1 Characteristics: General Results and Applications</a>.&rdquo;</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eran Hammer-Lahav (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yahoo!</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:eran@hueniverse.com">eran@hueniverse.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://hueniverse.com">http://hueniverse.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Blaine Cook</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:romeda@gmail.com">romeda@gmail.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://romeda.org/">http://romeda.org/</a></td></tr>
</table>
</body></html>
