



NETCONF Working Group                                              Q. Wu
Internet-Draft                                                   X. Ding
Intended status: Standards Track                                  Huawei
Expires: September 4, 2018                                 March 3, 2018


                  NETCONF Base Notifications for NMDA
               draft-wu-netconf-base-notification-nmda-00

Abstract

   NMDA introduces additional datastores for systems that support more
   advanced processing chains converting configuration to operational
   state.  Support the monitoring of the base system events pertaining
   to these datatores hasn't been discussed in Network Configuration
   Protocol (NETCONF) Base Notifications [RFC6470].  This document
   updates [RFC6470] to support the Network Management Datastore
   Architecture (NMDA) defined in [I-D.ietf-netmod-revised-datastores].

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 4, 2018.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of



Wu & Ding               Expires September 4, 2018               [Page 1]

Internet-Draft           Base notifications NMDA              March 2018


   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   3
   2.  Summary of Updates to RFC 6470  . . . . . . . . . . . . . . .   3
   3.  NETCONF Base Notifications YANG Model extension for NMDA  . .   3
     3.1.  Overview  . . . . . . . . . . . . . . . . . . . . . . . .   3
     3.2.  Definitions . . . . . . . . . . . . . . . . . . . . . . .   5
   4.  Security Considerations . . . . . . . . . . . . . . . . . . .   8
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   9
   6.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  10
   7.  Normative References  . . . . . . . . . . . . . . . . . . . .  10
   Appendix A.  Appendix . . . . . . . . . . . . . . . . . . . . . .  11
     A.1.  Tree diagram  . . . . . . . . . . . . . . . . . . . . . .  11
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  11

1.  Introduction

   [RFC6470] provides standard mechanisms to support the monitoring of
   the base system events within the NETCONF server.  Such mechanism
   allows a NETCONF client to receive notifications for some common
   system events (e.g., a change in NETCONF server capabilities, that
   may impact management applications.).

   This document updates Network Configuration Protocol (NETCONF) Base
   Notifications [RFC6470] to support the Network Management Datastore
   Architecture (NMDA) defined in [I-D.ietf-netmod-revised-datastores].
   Specifically, with NMDA, there are several additional datastores that
   are subject to system events.  Extensions are needed to indicate the
   affected datastore and affected phase (because it is no longer simply
   about <running>; there are now also (for example) <intended> and
   <operational>).

   The solution presented in this document is backwards compatible with
   [RFC6470].  This is achieved by only adding new top-level resources,
   and thereby leaving the semantics of all existing resources alone.

   Note that "push-change-update" notification and "push-update"
   notification defined in [I-D.ietf-netconf-yang-push] are not general
   purpose notifications. and used to send to the receivers of a
   subscription entire or a portion of datastore contents.  The solution
   presented in this document can work together with "push-change-
   update" notification and "push-update" notification defined in [I-
   D.ietf-netconf-yang-push] to indicate to yang push client fine
   granularity of data change metadata properties (e.g. who made



Wu & Ding               Expires September 4, 2018               [Page 2]

Internet-Draft           Base notifications NMDA              March 2018


   configuration changes, identify specific location of configuration
   changes or phase of configuration changes) pertaining to multiple
   subscriptions of the same receivers.

1.1.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

   The following terms are defined in [I-D.ietf-netmod-revised-
   datastores] and are not redefined here:

   o  operational state datastore

   o  running configuration datastore

   o  intended configuration datastore

2.  Summary of Updates to RFC 6470

   This document is intended to provide an extension of notifications
   initially defined within [RFC6470], with the development of NMDA
   architcture and data model.  Key relationships between these two
   documents include:

   o  the existing notifications defined in [RFC6470] are remain
      unchanged, no additional information is added.

   o  an extra event notification is defined in this document to
      overcome the shortcoming of [RFC6470] for supporting NMDA.

3.  NETCONF Base Notifications YANG Model extension for NMDA

3.1.  Overview

   The YANG module in NETCONF Base Notifications [RFC6470] specifies the
   following 5 event notifications for the 'NETCONF' stream to notify a
   client application that the NETCONF server state has changed:

   o  netconf-config-change

   o  netconf-capability-change

   o  netconf-session-start




Wu & Ding               Expires September 4, 2018               [Page 3]

Internet-Draft           Base notifications NMDA              March 2018


   o  netconf-session-end

   o  netconf-confirmed-commit

   These event notifications used within the 'NETCONF' stream are
   accessible to clients via the subscription mechanism described in
   [RFC5277].

   This document extends the YANG module defined in [RFC6470] to include
   NMDA specific extension which allows a NETCONF client to receive
   notifications for additional common system event as follows:

   netconf-data-change:

      Generated when the NETCONF server detects that the conventional
      configuration datastore or 'config true' objects in the
      operational state datastore has been changed by a management
      session.  The notification summarizes the edits that have been
      detected.

   The following is an example of a netconf-data-change notification
   message:

<notification xmlns="urn:ietf:params:xml:ns:netconf:notification:1.0">
 <eventTime>2017-06-16T16:30:59.137045+09:00</eventTime>
 <netconf-data-change xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-notifications-nmda">
        <changed-by>
            <username>admin</username>
            <session-id>0</session-id>
            <source-host>10.251.93.83</source-host>
        </changed-by>
        <datastore>operational</datastore>
        <edit>
            <target>/ietf-interfaces:interfaces/ietf-interfaces:statistics</target>
            <operation>create</operation>
            <origin>default</orign>
            <current-phase>inactive</current-phase>
        </edit>
        <edit>
            <target>/ietf-interfaces:interfaces/ietf-interfaces:statistics/ietf-interfaces:in-octets</target>
            <operation>merge</operation>
            <origin>system</orign>
            <current-phase>in-use</current-phase>
        </edit>
 </netconf-config-change>
</notification>





Wu & Ding               Expires September 4, 2018               [Page 4]

Internet-Draft           Base notifications NMDA              March 2018


3.2.  Definitions

   This section presents the YANG module defined in this document.

 <CODE BEGINS> file "ietf-netconf-notifications-nmda@2018-02-01.yang"
module ietf-netconf-notifications-nmda {
  namespace "urn:ietf:params:xml:ns:yang:ietf-netconf-notifications-nmda";
  prefix ncdn;

  import ietf-netconf {
    prefix nc;
  }
  import ietf-datastores {
    prefix ds;
  }
  import ietf-origin {
    prefix or;
  }
  import ietf-netconf-notifications {
    prefix ncn;
  }

  organization
    "IETF NETCONF (Network Configuration Protocol) Working Group";
  contact
    "WG Web:   <http://tools.ietf.org/wg/netconf/>
     WG List:  <mailto:netconf@ietf.org>

     WG Chair: Kent Watsen
               <mailto:kwatsen@juniper.net>

     WG Chair: Mahesh Jethanandani
               <mailto:mjethanandani@gmail.com>

     Editor:   Qin Wu
               <mailto:bill.wu@huawei.com>

     Editor:   Xiaojian Ding
               <mailto:dingxiaojian1@huawei.com>";
  description
    "This module defines a YANG data model for use with the
     NETCONF protocol that allows the NETCONF client to
     receive additional common NETCONF base event notifications
      related to NMDA.

     Copyright (c) 2012 IETF Trust and the persons identified as
     the document authors.  All rights reserved.




Wu & Ding               Expires September 4, 2018               [Page 5]

Internet-Draft           Base notifications NMDA              March 2018


     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD License
     set forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (http://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC xxxx; see
     the RFC itself for full legal notices.";

  revision 2018-02-01 {
    description
      "Initial version.";
    reference "RFC xxx: NETCONF Base Notifications for NMDA";
  }
  identity change-phase {
    description
      "Base identity for change phanse.";
  }

  identity inactive {
    base change-phase;
    description
      "Identity for inactive data.It is referred to as
      configuration that is not currently used.";
  }

  identity in-use {
    base change-phase;
    description
      "Identity for the in use data. It is referred to as
       configuration that is actively used.";
  }

  identity Remnant  {
    base in-use;
    description
      "Identity for the remnant configuration. It indicates that
       both the previous and current configuration coexist.";
  }

  identity miss-resource {
    base in-use;
    description
      "Identity for the missing resource.It indicates that
       Configuration in <intended> can refer to resources that are not
      available or otherwise not physically present and parts of <intended>
      are not applied.";



Wu & Ding               Expires September 4, 2018               [Page 6]

Internet-Draft           Base notifications NMDA              March 2018


  }

  identity sys-resource {
    base in-use;
    description
      "Identity for the system congtrolled resource.It indicates that
       a system controlled resource has matching configuration in
      <intended>.";
  }
  notification netconf-data-change {
    description
      "Generated when the NETCONF server detects that the
       <operational> datastore or conventional configuration datastore
       has been changed by a management session.
       The notification summarizes the edits that
       have been detected.

       The server MAY choose to also generate this
       notification while loading a datastore during the
       boot process for the device.";
    uses ncn:changed-by-parms;
    leaf datastore {
      type identityref {
        base ds:datastore;
      }
      default "ds:operational";
      description
        "Indicates which datastore has changed or which datastore is
         target of edit-data operation.";
    }

    list edit {
      description
        "An edit record SHOULD be present for each distinct
         edit operation that the server has detected on
         the target datastore.  This list MAY be omitted
         if the detailed edit operations are not known.
         The server MAY report entries in this list for
         changes not made by a NETCONF session (e.g., CLI).";
      leaf target {
        type instance-identifier;
        description
          "Topmost node associated with the configuration change.
           A server SHOULD set this object to the node within
           the datastore that is being altered.  A server MAY
           set this object to one of the ancestors of the actual
           node that was changed, or omit this object, if the
           exact node is not known.";



Wu & Ding               Expires September 4, 2018               [Page 7]

Internet-Draft           Base notifications NMDA              March 2018


      }
      leaf origin {
        type identityref {
          base or:origin;
        }
        description
          "Indicate origin that most accurately reflects the source of the
           configuration that is in use by the system.";
      }
    leaf current-phase {
        type identityref {
          base change-phase;
        }
        description
          "Indicate the current phase of the <operational> datastore or
           conventional configuration datastore change, e.g.,the intended
           datastore is validating, the intended datastore is validated,
           the configuration is applying, the configuration is applied.";
      }
      leaf operation {
        type nc:edit-operation-type;
        description
          "Type of edit operation performed.
           A server MUST set this object to the NETCONF edit
           operation performed on the target datastore.";
      }
    }
  }
}
<CODE ENDS>

4.  Security Considerations

   The YANG module defined in this memo is designed to be accessed via
   the NETCONF protocol [RFC6241].  The lowest NETCONF layer is the
   secure transport layer and the mandatory-to-implement secure
   transport is SSH, defined in [RFC6242].

   Some of the readable data nodes in this YANG module may be considered
   sensitive or vulnerable in some network environments.  It is thus
   important to control read access (e.g., via get, get-config, get-data
   or notification) to these data nodes.  These are the subtrees and
   data nodes and their sensitivity/vulnerability:

   /netconf-data-change:






Wu & Ding               Expires September 4, 2018               [Page 8]

Internet-Draft           Base notifications NMDA              March 2018


      Event type itself indicates that the system configuration has
      changed.  This event could alert an attacker that specific
      configuration data nodes have been altered.

   /netconf-data-change/changed-by:

      Indicates whether the server or a specific user management session
      made the configuration change.  Identifies the user name, session-
      id, and source host address associated with the configuration
      change, if any.

   /netconf-data-change/datastore:

      Indicates which datastore has been changed.  This data can be used
      to determine if the running configuration data, the intended
      configuration data or the operational state datastore data has
      been changed.

   /netconf-data-change/edit:

      Identifies the specific edit operations and specific datastore
      subtree(s), specific source of configuration that have changed.
      the current stage of the datastore change(e.g.,inactive, in use or
      remnant).  This data could be used to determine if specific server
      vulnerabilities may now be present.

5.  IANA Considerations

   This document registers one XML namespace URN in the 'IETF XML
   registry', following the format defined in [RFC3688]:

      URI: urn:ietf:params:xml:ns:yang:ietf-netconf-notifications-nmda

      Registrant Contact: The IESG.

      XML: N/A, the requested URI is an XML namespace.

   This document registers one module name in the 'YANG Module Names'
   registry, defined in [RFC7950]:

      name: ietf-netconf-notifications-nmda

      prefix: ncdn

      namespace: urn:ietf:params:xml:ns:yang:ietf-netconf-notifications-
      nmda

      RFC: xxxx



Wu & Ding               Expires September 4, 2018               [Page 9]

Internet-Draft           Base notifications NMDA              March 2018


6.  Acknowledgements

   Thanks to Juergen Schoenwaelder and Alex Clemm to review this draft
   and provide important input to this document.

7.  Normative References

   [I-D.ietf-netconf-yang-push]
              Clemm, A., Voit, E., Prieto, A., Tripathy, A., Nilsen-
              Nygaard, E., Bierman, A., and B. Lengyel, "YANG Datastore
              Subscription", draft-ietf-netconf-yang-push-15 (work in
              progress), February 2018.

   [I-D.ietf-netmod-revised-datastores]
              Bjorklund, M., Schoenwaelder, J., Shafer, P., Watsen, K.,
              and R. Wilton, "Network Management Datastore
              Architecture", draft-ietf-netmod-revised-datastores-10
              (work in progress), January 2018.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC3688]  Mealling, M., "The IETF XML Registry", BCP 81, RFC 3688,
              DOI 10.17487/RFC3688, January 2004,
              <https://www.rfc-editor.org/info/rfc3688>.

   [RFC5277]  Chisholm, S. and H. Trevino, "NETCONF Event
              Notifications", RFC 5277, DOI 10.17487/RFC5277, July 2008,
              <https://www.rfc-editor.org/info/rfc5277>.

   [RFC6020]  Bjorklund, M., Ed., "YANG - A Data Modeling Language for
              the Network Configuration Protocol (NETCONF)", RFC 6020,
              DOI 10.17487/RFC6020, October 2010,
              <https://www.rfc-editor.org/info/rfc6020>.

   [RFC6021]  Schoenwaelder, J., Ed., "Common YANG Data Types",
              RFC 6021, DOI 10.17487/RFC6021, October 2010,
              <https://www.rfc-editor.org/info/rfc6021>.

   [RFC6241]  Enns, R., Ed., Bjorklund, M., Ed., Schoenwaelder, J., Ed.,
              and A. Bierman, Ed., "Network Configuration Protocol
              (NETCONF)", RFC 6241, DOI 10.17487/RFC6241, June 2011,
              <https://www.rfc-editor.org/info/rfc6241>.






Wu & Ding               Expires September 4, 2018              [Page 10]

Internet-Draft           Base notifications NMDA              March 2018


   [RFC6242]  Wasserman, M., "Using the NETCONF Protocol over Secure
              Shell (SSH)", RFC 6242, DOI 10.17487/RFC6242, June 2011,
              <https://www.rfc-editor.org/info/rfc6242>.

   [RFC6470]  Bierman, A., "Network Configuration Protocol (NETCONF)
              Base Notifications", RFC 6470, DOI 10.17487/RFC6470,
              February 2012, <https://www.rfc-editor.org/info/rfc6470>.

Appendix A.  Appendix

A.1.  Tree diagram

     module: ietf-netconf-notifications
     notifications:
       +---n netconf-data-change
          +--ro changed-by
          |  +--ro (server-or-user)
          |     +--:(server)
          |     |  +--ro server?        empty
          |     +--:(by-user)
          |        +--ro username       string
          |        +--ro session-id     nc:session-id-or-zero-type
          |        +--ro source-host?   inet:ip-address
          +--ro datastore?    identityref
          +--ro edit*
             +--ro target?      instance-identifier
             +--ro origin?
             +--ro current-phase?
             +--ro operation?   nc:edit-operation-type

Authors' Addresses

   Qin Wu
   Huawei
   101 Software Avenue, Yuhua District
   Nanjing, Jiangsu  210012
   China

   Email: bill.wu@huawei.com


   Xiaojian Ding
   Huawei
   101 Software Avenue, Yuhua District
   Nanjing, Jiangsu  210012
   China

   Email: dingxiaojian1@huawei.com



Wu & Ding               Expires September 4, 2018              [Page 11]
