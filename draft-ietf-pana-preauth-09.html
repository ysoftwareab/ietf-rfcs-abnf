<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Pre-authentication Support for PANA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Pre-authentication Support for PANA">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">PANA Working Group</td><td class="header">Y. Ohba</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Toshiba</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">A. Yegin</td></tr>
<tr><td class="header">Expires: August 14, 2010</td><td class="header">Samsung</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 10, 2010</td></tr>
</table></td></tr></table>
<h1><br />Pre-authentication Support for PANA<br />draft-ietf-pana-preauth-09</h1>

<h3>Abstract</h3>

<p>
         This document defines an extension to the Protocol for
         carrying Authentication for Network Access (PANA) for
         proactively establishing a PANA security association between a
         PANA client in one access network and a PANA authentication
         agent in another access network to which the PANA client may
         move.
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 14, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Specification of Requirements<br />
<a href="#anchor3">2.</a>&nbsp;
Terminology<br />
<a href="#section-pre-authentication">3.</a>&nbsp;
Pre-authentication Procedure<br />
<a href="#section-pana-extensions">4.</a>&nbsp;
PANA Extensions<br />
<a href="#section-backward-compatibility">5.</a>&nbsp;
Backward Compatibility<br />
<a href="#anchor4">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor5">7.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor6">8.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
        The Protocol for carrying Authentication for Network Access
        (PANA) <a class='info' href='#RFC5191'>[RFC5191]<span> (</span><span class='info'>Forsberg, D., Ohba, Y., Patil, B., Tschofenig, H., and A. Yegin, &ldquo;Protocol for Carrying Authentication for Network Access (PANA),&rdquo; May&nbsp;2008.</span><span>)</span></a> carries EAP messages between a
        PaC (PANA Client) and a PAA (PANA Authentication Agent) in the
        access network.  If the PaC is a mobile device and is capable
        of moving from one access network to another while running its
        applications, it is critical for the PaC to perform a handover
        seamlessly without degrading the performance of the
        applications during the handover period.  When the handover
        requires the PaC to establish a PANA session with the PAA in
        the new access network, the signaling to establish the PANA
        session should be completed as fast as possible.  See <a class='info' href='#I-D.ietf-hokey-preauth-ps'>[I&#8209;D.ietf&#8209;hokey&#8209;preauth&#8209;ps]<span> (</span><span class='info'>Ohba, Y. and G. Zorn, &ldquo;Extensible Authentication Protocol (EAP) Early Authentication Problem Statement,&rdquo; January&nbsp;2010.</span><span>)</span></a> for the handover latency
        requirements.
      
</p>
<p>
        This document defines an extension to the PANA protocol <a class='info' href='#RFC5191'>[RFC5191]<span> (</span><span class='info'>Forsberg, D., Ohba, Y., Patil, B., Tschofenig, H., and A. Yegin, &ldquo;Protocol for Carrying Authentication for Network Access (PANA),&rdquo; May&nbsp;2008.</span><span>)</span></a> used for proactively executing EAP
        authentication and establishing a PANA SA (Security
        Association) between a PaC in an access network and a PAA in
        another access network to which the PaC may move.  The
        extension to the PANA protocol is designed to realize direct
        pre-authentication defined in <a class='info' href='#I-D.ietf-hokey-preauth-ps'>[I&#8209;D.ietf&#8209;hokey&#8209;preauth&#8209;ps]<span> (</span><span class='info'>Ohba, Y. and G. Zorn, &ldquo;Extensible Authentication Protocol (EAP) Early Authentication Problem Statement,&rdquo; January&nbsp;2010.</span><span>)</span></a>.  How to realize
        authorization and accounting with the use of the
        pre-authentication extension is out of the scope of this
        document.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Specification of Requirements</h3>

<p>
          In this document, several words are used to signify the
          requirements of the specification.  These words are often
          capitalized.  The key words "MUST", "MUST NOT", "REQUIRED",
          "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",
          "MAY", and "OPTIONAL" in this document are to be interpreted
          as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>
        The following terms are used in this document in addition to
        the terms defined in <a class='info' href='#RFC5191'>[RFC5191]<span> (</span><span class='info'>Forsberg, D., Ohba, Y., Patil, B., Tschofenig, H., and A. Yegin, &ldquo;Protocol for Carrying Authentication for Network Access (PANA),&rdquo; May&nbsp;2008.</span><span>)</span></a>.
      
</p>
<blockquote class="text"><dl>
<dt>Serving Network:</dt>
<dd>
          The access network to which the host is currently attached.
        
</dd>
<dt>Candidate Network:</dt>
<dd>
          An access network that is a potential target of host's
          handover.
        
</dd>
<dt>Serving PAA (SPAA):</dt>
<dd>
            A PAA that resides in the serving network and provides
            network access authentication for a particular PaC.
        
</dd>
<dt>Candidate PAA (CPAA):</dt>
<dd>
            A PAA that resides in a candidate network to which the
            PaC may move.  A CPAA for a particular PaC may be a SPAA
            for another PaC.
        
</dd>
<dt>Pre-authentication:</dt>
<dd>
           Pre-authentication refers to EAP pre-authentication and
           defined as the utilization of EAP to pre-establish EAP
           keying material on an authenticator prior to arrival of the
           peer at the access network served by that authenticator
           <a class='info' href='#I-D.ietf-hokey-preauth-ps'>[I&#8209;D.ietf&#8209;hokey&#8209;preauth&#8209;ps]<span> (</span><span class='info'>Ohba, Y. and G. Zorn, &ldquo;Extensible Authentication Protocol (EAP) Early Authentication Problem Statement,&rdquo; January&nbsp;2010.</span><span>)</span></a>.  In this draft,
           EAP pre-authentication is performed between a PaC and a
           CPAA.
        
</dd>
</dl></blockquote>
<a name="section-pre-authentication"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Pre-authentication Procedure</h3>

<p>
        A PaC that supports pre-authentication may establish a PANA
        session for each CPAA.
      
</p>
<p>
        There may be several mechanisms for a PaC to discover a CPAA.
        An IP address of the discovered CPAA is the output of those
        mechanisms.  PANA pre-authentication is performed between the
        PaC and CPAA using the discovered IP address of the CPAA. 
        IEEE 802.21 <a class='info' href='#802.21'>[802.21]<span> (</span><span class='info'>IEEE, &ldquo;Standard for Local and Metropolitan Area Networks:             Media Independent Handover Services,&rdquo; .</span><span>)</span></a> Information Service MAY be
        used as a CPAA discovery mechanism.
      
</p>
<p>
        There may be a number of criteria for CPAA selection, the
        timing to start pre-authentication and the timing as to when
        the CPAA becomes the SPAA.  Such criteria can be
        implementation specific and thus are outside the scope of this
        document.
      
</p>
<p>
        Pre-authentication is initiated by a PaC in a similar way as
        normal authentication.  A new 'E' (prE-authentication) bit is
        defined in the PANA header.  When pre-authentication is
        performed, the 'E' (prE-authentication) bit of PANA messages
        is set in order to indicate that this PANA run is for
        pre-authentication.  Use of pre-authentication is negotiated
        as follows.
      
</p>
<p>
        </p>
<ul class="text">
<li>
            When a PaC initiates pre-authentication, it sends a
            PANA-Client-Initiation (PCI) message with the 'E'
            (prE-authentication) bit set.  The CPAA responds with a
            PANA-Auth-Request (PAR) message with the 'S' (Start) and
            'E' (prE-authentication) bits set only if it supports
            pre-authentication.  Otherwise, the 'E'
            (prE-authentication) bit of the PAR message will be
            cleared according to Section 6.2 of <a class='info' href='#RFC5191'>[RFC5191]<span> (</span><span class='info'>Forsberg, D., Ohba, Y., Patil, B., Tschofenig, H., and A. Yegin, &ldquo;Protocol for Carrying Authentication for Network Access (PANA),&rdquo; May&nbsp;2008.</span><span>)</span></a>, which results in a negotiation
            failure.
          
</li>
<li>
            Once the PaC and CPAA have successfully negotiated on
            performing pre-authentication using the 'S' (Start) and
            'E' (prE-authentication) bits, the subsequent PANA
            messages exchanged between them MUST have the 'E'
            (prE-authentication) bit set until CPAA becomes SPAA of
            the PaC.  The PaC may conduct this exchange with more than
            one CPAA.  If the PaC and CPAA have failed to negotiate on
            performing pre-authentication, the PaC or CPAA that sent a
            message with both the 'S' (Start) and 'E'
            (prE-authentication) bits set MUST discard the message
            received from the peer with 'S' (Start) bit set and the
            'E' (prE-authentication) bit cleared, which will
            eventually result in PANA session termination.
          
</li>
</ul><p>
      
</p>
<p>
        If IP reconfiguration is needed in the access network
        associated with the CPAA, the 'I' (IP Reconfiguration) bit in
        PAR messages used for pre-authentication between the PaC and
        CPAA is also set.  The 'I' (IP Reconfiguration) bit in these
        messages takes effect only after the CPAA becomes the SPAA.
      
</p>
<p>
        When a CPAA of the PaC becomes the SPAA due to, e.g., movement
        of the PaC, the PaC informs the PAA of the change using
        PANA-Notification-Request (PNR) and PANA-Notification-Answer
        (PNA) messages with the 'P' (Ping) bit set and the 'E'
        (prE-authentication) bit cleared.  The 'E'
        (prE-authentication) bit MUST be cleared in subsequent PANA
        messages.
      
</p>
<p>
        A PANA SA is required for pre-authentication in order to
        securely associate the PNR/PNA exchange to the earlier
        authentication.
      
</p>
<p>
        The PANA session between the PaC and a CPAA is deleted by
        entering the termination phase of the PANA protocol.
      
</p>
<p>
        Example call flows for pre-authentication is shown in <a class='info' href='#figure-call-flow'>Figure&nbsp;1<span> (</span><span class='info'>Pre-authentication Call Flow</span><span>)</span></a>.  Note that EAP
        authentication is performed over PAR and PAN exchanges.
      
</p><br /><hr class="insert" />
<a name="figure-call-flow"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     PaC                                               CPAA
      |                                                 |
+------------------+                                    |
|Pre-authentication|                                    |
|trigger           |                                    |
+------------------+                                    |
      |                  PCI w/'E' bit set              |
      |------------------------------------------------&gt;|
      |            PAR w/'S' and 'E' bits set           |
      |&lt;------------------------------------------------|
      |            PAN w/'S' and 'E' bits set           |
      |------------------------------------------------&gt;|
      |           PAR-PAN exchange w/'E' bit set        |
      |&lt;-----------------------------------------------&gt;|
      |            PAR w/'C' and 'E' bits set           |
      |&lt;------------------------------------------------|
      |            PAN w/'C' and 'E' bits set           |
      |------------------------------------------------&gt;|
      .                        .                        .
      .                        .                        .
+----------+                                            |
| Movement |                                            |
+----------+                                            |
      |        PNR w/ 'P' bit set and w/o 'E' bit set   |
      |------------------------------------------------&gt;|
      |                                        +-----------------+
      |                                        |CPAA becomes SPAA|
      |                                        +-----------------+
      |        PNA w/ 'P' bit set and w/o 'E' bit set   |
      |&lt;------------------------------------------------|
      |                                                 |

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Pre-authentication Call Flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="section-pana-extensions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
PANA Extensions</h3>

<p>
        A new 'E' (prE-authentication) bit is defined in Flags field
        of PANA header as follows.
        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|R S C A P I E r r r r r r r r r|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>

        </p>
<blockquote class="text"><dl>
<dt>E(PrE-authentication)</dt>
<dd>
              When pre-authentication is performed, the 'E'
              (prE-authentication) bit of PANA messages is set in
              order to indicate whether this PANA run is for
              pre-authentication.  The exact usage of this bit is
              described in <a class='info' href='#section-pre-authentication'>Section&nbsp;3<span> (</span><span class='info'>Pre-authentication Procedure</span><span>)</span></a>.  This bit is to
              be assigned by IANA.
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="section-backward-compatibility"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Backward Compatibility</h3>

<p>
         Backward compatibility between a PANA entity that does not
         support the pre-authentication extension and another PANA
         entity that supports the pre-authentication extension is
         maintained as follows.
      
</p>
<p>
         When a PaC that supports the pre-authentication extension
         initiates PANA pre-authentication by sending a PCI message
         with the 'E' (prE-authentication) bit set to a PAA that does
         not support the pre-authentication extension, the PAA will
         ignore the E-bit according to Section 6.2 of <a class='info' href='#RFC5191'>[RFC5191]<span> (</span><span class='info'>Forsberg, D., Ohba, Y., Patil, B., Tschofenig, H., and A. Yegin, &ldquo;Protocol for Carrying Authentication for Network Access (PANA),&rdquo; May&nbsp;2008.</span><span>)</span></a>, and try to process the message as a
         normal authentication attempt.  As a result, the PaC will
         receive a PAR message with the 'E' (prE-authentication) bit
         cleared.  In this case, the negotiation on the use of
         pre-authentication will fail and eventually the PANA session
         will be terminated as described in Section <a class='info' href='#section-pre-authentication'>Section&nbsp;3<span> (</span><span class='info'>Pre-authentication Procedure</span><span>)</span></a>.
      
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
      This specification is based on the PANA protocol and it exhibits
      the same security properties, except for one important
      difference: Pre- authenticating PaCs are not physically
      connected to an access network associated with the PAA, but they
      are connected to some other network somewhere else on the
      Internet.  This distinction can create greater DoS vulnerability
      for systems using PANA pre-authentication if appropriate
      measures are not taken.  An unprotected PAA can be forced to
      create state by an attacker PaC which merely sends PCI messages.
    
</p>
<p> 
      <a class='info' href='#RFC5191'>[RFC5191]<span> (</span><span class='info'>Forsberg, D., Ohba, Y., Patil, B., Tschofenig, H., and A. Yegin, &ldquo;Protocol for Carrying Authentication for Network Access (PANA),&rdquo; May&nbsp;2008.</span><span>)</span></a> describes how PAA can stay stateless
      while responding to incoming PCIs.  PAAs using
      pre-authentication SHOULD be following those guidelines (see
      <a class='info' href='#RFC5191'>[RFC5191]<span> (</span><span class='info'>Forsberg, D., Ohba, Y., Patil, B., Tschofenig, H., and A. Yegin, &ldquo;Protocol for Carrying Authentication for Network Access (PANA),&rdquo; May&nbsp;2008.</span><span>)</span></a> Section 4.1).
    
</p>
<p>
      Furthermore, it is recommended that PANA pre-authentication
      messages are only accepted from PaCs originating from well-known
      IP networks (e.g., physically adjacent networks) for a given
      PAA. These IP networks can be used with a white-list implemented
      either on the firewall protecting the perimeter around the PAA,
      or on the PAA itself. This prevention measure SHOULD be used
      whenever it can be practically applied to a given deployment.
    
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>
        As described in <a class='info' href='#section-pana-extensions'>Section&nbsp;4<span> (</span><span class='info'>PANA Extensions</span><span>)</span></a> and
        following the new IANA allocation policy on PANA message <a class='info' href='#I-D.arkko-pana-iana'>[I&#8209;D.arkko&#8209;pana&#8209;iana]<span> (</span><span class='info'>Arkko, J. and A. Yegin, &ldquo;IANA Rules for PANA (Protocol for Carrying Authentication for Network Access),&rdquo; February&nbsp;2010.</span><span>)</span></a>, bit 6 of the Flags field of
        the PANA Header needs to be assigned by IANA for the 'E'
        (prE-authentication) bit.
      
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgments</h3>

<p>
        The author would like to thank Basavaraj Patil, Ashutosh
        Dutta, Julien Bournelle, Sasikanth Bharadwaj, Subir Das, Rafa
        Marin Lopez, Lionel Morand, Victor Fajardo, Glen Zorn, Qin Wu,
        Jari Arrko, Pasi Eronen and Joseph Salowey for their support
        and valuable feedback.
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC5191">[RFC5191]</a></td>
<td class="author-text">Forsberg, D., Ohba, Y., Patil, B., Tschofenig, H., and A. Yegin, &ldquo;<a href="http://tools.ietf.org/html/rfc5191">Protocol for Carrying Authentication for Network Access (PANA)</a>,&rdquo; RFC&nbsp;5191, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5191.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.arkko-pana-iana">[I-D.arkko-pana-iana]</a></td>
<td class="author-text">Arkko, J. and A. Yegin, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-arkko-pana-iana-02.txt">IANA Rules for PANA (Protocol for Carrying Authentication for Network Access)</a>,&rdquo; draft-arkko-pana-iana-02 (work in progress), February&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-arkko-pana-iana-02.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-hokey-preauth-ps">[I-D.ietf-hokey-preauth-ps]</a></td>
<td class="author-text">Ohba, Y. and G. Zorn, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-hokey-preauth-ps-12.txt">Extensible Authentication Protocol (EAP) Early Authentication Problem Statement</a>,&rdquo; draft-ietf-hokey-preauth-ps-12 (work in progress), January&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-hokey-preauth-ps-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="802.21">[802.21]</a></td>
<td class="author-text">IEEE, &ldquo;Standard for Local and Metropolitan Area Networks:
            Media Independent Handover Services,&rdquo; LAN MAN Standards Committee of the IEEE
        Computer Society 802.21&nbsp;2008.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yoshihiro Ohba</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Toshiba Corporate Research and Development Center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1 Komukai-Toshiba-cho</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Saiwai-ku, Kawasaki, Kanagawa  212-8582</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Japan</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+81 44 549 2230</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:yoshihiro.ohba@toshiba.co.jp">yoshihiro.ohba@toshiba.co.jp</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alper Yegin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Samsung</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Istanbul</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Turkey</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:alper.yegin@yegin.org">alper.yegin@yegin.org</a></td></tr>
</table>
</body></html>
