q_avg = alpha*q + (1-alpha)*q_avg. 

alpha=1 corresponds to performing no smoothing at all. 

p = 0, if q < q_lo; 

                   q_avg - q_lo
p = p_max*--------------, if q_lo <= q < q_hi; 
                   q_hi - q_lo

p = 1, if q >= q_hi. 

p = 0, if b-b_tk < b_lo; 

                    b-b_tk-b_lo
p = p_max* --------------, if b_lo<= b-b_tk <b_hi; 
                     b_hi-b_lo

p = 1, if b-b_tk>=b_hi. 

x_n = t_r,n - t_s,n, 
 




d_n = x_n - d_f. 

d_tilde_n = (d_hat_n),  if d_hat_n < d_th; 

                         (d_max - d_hat_n)^4
d_tilde_n = d_th --------------------, if  d_th<d_hat_n<d_max; 
                          (d_max - d_th)^4

d_tilde_n = 0,   if d_hat_n > d_max. 


x_n = d_tilde_n + p_M*d_M + p_L*d_L,      (1) 

gamma = min [gamma_0, ---------------]      (3)
                           RTT_0+delta_0


R_n  =  (1+gamma) R_r                     (4)

                                    

theta = w*(R_max - R_min)*x_ref.    (6)

x_hat = x_n + eta*tau_o* x'_n       (7)



R_v = R_n - beta_v * -------.       (8) 
                              tau_v

R_s = R_n + beta_s * -------.       (9) 
                              tau_v


