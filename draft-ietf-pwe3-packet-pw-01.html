<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Packet Pseudowire Encapsulation over an MPLS PSN</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction ">
<link href="#rfc.section.2" rel="Chapter" title="2 Network Reference Model">
<link href="#rfc.section.3" rel="Chapter" title="3 Client Network Layer Model">
<link href="#rfc.section.4" rel="Chapter" title="4 Forwarding Model">
<link href="#rfc.section.5" rel="Chapter" title="5 Packet PW Encapsulation ">
<link href="#rfc.section.6" rel="Chapter" title="6 Ethernet Functional Restrictions">
<link href="#rfc.section.7" rel="Chapter" title="7 Congestion Considerations ">
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 IANA Considerations ">
<link href="#rfc.section.10" rel="Chapter" title="10 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="11 References">
<link href="#rfc.references.1" rel="Chapter" title="11.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="11.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Encapsulation Approaches Considered">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 A Protocol Identifier in the Control Word">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 PID Label ">
<link href="#rfc.appendix.Appendix%20A.3" rel="Chapter" title="Appendix A.3 Parallel PWs">
<link href="#rfc.appendix.Appendix%20A.4" rel="Chapter" title="Appendix A.4 Virtual Ethernet">
<link href="#rfc.appendix.Appendix%20A.5" rel="Chapter" title="Appendix A.5 Recommended Encapsulation">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document describes a pseudowire mechanism that is used to transport a packet service over an MPLS PSN is the case where the client LSR and the server PE are co-resident in the same equipment. This pseudowire mechanism may be used to carry all of the required layer 2 and layer 3 protocols between the pair of client LSRs." />
  <meta name="description" content="This document describes a pseudowire mechanism that is used to transport a packet service over an MPLS PSN is the case where the client LSR and the server PE are co-resident in the same equipment. This pseudowire mechanism may be used to carry all of the required layer 2 and layer 3 protocols between the pair of client LSRs." />
  <meta name="keywords" content="Sample, Draft" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">S. Bryant, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">L. Martini</td>
</tr>
<tr>
<td class="left">Intended status: Best Current Practice</td>
<td class="right">G. Swallow</td>
</tr>
<tr>
<td class="left">Expires: January 09, 2012</td>
<td class="right">Cisco Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">A. Malis</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Verizon Communications</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">July 08, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Packet Pseudowire Encapsulation over an MPLS PSN<br />
  <span class="filename">draft-ietf-pwe3-packet-pw-01.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes a pseudowire mechanism that is used to transport a packet service over an MPLS PSN is the case where the client LSR and the server PE are co-resident in the same equipment. This pseudowire mechanism may be used to carry all of the required layer 2 and layer 3 protocols between the pair of client LSRs.</p>
<h1><a>Requirements Language</a></h1>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 09, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction </a>
</li>
<li>2.   <a href="#rfc.section.2">Network Reference Model</a>
</li>
<li>3.   <a href="#rfc.section.3">Client Network Layer Model</a>
</li>
<li>4.   <a href="#rfc.section.4">Forwarding Model</a>
</li>
<li>5.   <a href="#rfc.section.5">Packet PW Encapsulation </a>
</li>
<li>6.   <a href="#rfc.section.6">Ethernet Functional Restrictions</a>
</li>
<li>7.   <a href="#rfc.section.7">Congestion Considerations </a>
</li>
<li>8.   <a href="#rfc.section.8">Security Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">IANA Considerations </a>
</li>
<li>10.   <a href="#rfc.section.10">Acknowledgements</a>
</li>
<li>11.   <a href="#rfc.references">References</a>
</li>
<li>11.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>11.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Encapsulation Approaches Considered</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">A Protocol Identifier in the Control Word</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">PID Label </a>
</li>
<li>Appendix A.3.   <a href="#rfc.appendix.Appendix%20A.3">Parallel PWs</a>
</li>
<li>Appendix A.4.   <a href="#rfc.appendix.Appendix%20A.4">Virtual Ethernet</a>
</li>
<li>Appendix A.5.   <a href="#rfc.appendix.Appendix%20A.5">Recommended Encapsulation</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction </h1>
<p id="rfc.section.1.p.1">There is a need to provide a method of carrying a packet service over an MPLS PSN in a way that provides isolation between the two networks.  The server MPLS network may be an MPLS network or a network conforming to the MPLS-TP <a href="#RFC5317">[RFC5317]</a>. The client may also be either a MPLS network of a network conforming to the MPLS-TP.  Considerations regarding the use of an MPLS network as a server for an MPLS-TP network are outside the scope of this document.</p>
<p id="rfc.section.1.p.2">Where the client equipment is connected to the server equipment via physical interface, the same data-link type MUST be used to attach the clients to the Provider Edge equipments (PE)s, and a pseudowire (PW) of the same type as the data-link MUST be used <a href="#RFC3985">[RFC3985]</a>. The reason that inter-working between different physical and data-link attachment types is specifically disallowed in the pseudowire architecture is because this is a complex task and not a simple bit-mapping exercise. The inter-working is not limited to the physical and data-link interfaces and the state-machines.  It also requires a compatible approach to the formation of the adjacencies between attached client network equipment. As an example the reader should consider the differences between router adjacency formation on a point to point link compared to a multi-point to multi-point interface (e.g. Ethernet).</p>
<p id="rfc.section.1.p.3">A further consideration is that two adjacent MPLS LSRs do not simply exchange MPLS packets. They exchange IP packets for adjacency formation, control, routing, label exchange, management and monitoring purposes. In addition they may exchange data-link packets as part of routing (e.g.  IS-IS hellos and IS-IS LSPs) and for OAM purposes such as Link Layer Discovery protocol [IEEE standard 802.1AB-2009]. Thus the two clients require an attachment mechanism that can be used to multiplex a number of protocols. In addition it is essential to the correct operation of the network layer that all of these protocols fate share.</p>
<p id="rfc.section.1.p.4">Where the client LSR and server PE is co-located in the same equipment, the data-link layer can be simplified to a simple protocol identifier (PID) that is used to multiplex the various data-link types onto a pseudowire. This is the method that described in this document.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Network Reference Model</h1>
<p id="rfc.section.2.p.1">The network reference model for the packet pseudowire operating in an MPLS network is shown in <a href="#PKT-PW-NR">Figure 1</a>. This is an extension of Figure 3 "Pre-processing within the PWE3 Network Reference Model" from <a href="#RFC3985">[RFC3985]</a>.</p>
<div id="#rfc.figure.1"></div>
<div id="#PKT-PW-NR"></div>
<pre>

               PW                            PW
            End Service                   End Service
                |                            |
                |&lt;------- Pseudowire -------&gt;|
                |                            |
                |          Server            |
                |     |&lt;- PSN Tunnel -&gt;|     |
                |     V                V     |   
-------   +-----+-----+                +-----+-----+   -------
       )  |     |     |================|     |     |  (
client  ) | MPLS| PE1 |      PW1       | PE2 | MPLS| ( Client
MPLS PSN )+ LSR1+............................+ LSR2+( MPLS PSN
        ) |     |     |                |     |     | (
       )  |     |     |================|     |     |  (
-------   +-----+-----+                +-----+-----+   --------
                ^                            ^
                |                            |
                |                            |
                |&lt;---- Emulated Service-----&gt;|
                |                            |
         Virtual physical             Virtual physical
            termination                  termination

</pre>
<p></p>
<p id="rfc.section.2.p.3">In this model LSRs, LSR1 and LSR2, are part of the client MPLS packet switched network (PSN). The PEs, PE1 and PE2 are part of the server PSN, that is to be used to provide connectivity between the client LSRs. The attachment circuit that is used to connect the MPLS LSRs to the PEs is a virtual interface within the equipment. A packet pseudowire is used to provide connectivity between these virtual interfaces. This packet pseudowire is used to transport all of the required layer 2 and layer 3 between protocols between LSR1 and LSR2.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Client Network Layer Model</h1>
<p id="rfc.section.3.p.1">The packet PW appears as a single point to point link to the client layer. Network Layer adjacency formation and maintenance between the client equipments will the follow normal practice needed to support the required relationship in the client layer. The assignment of metrics for this point to point link is a matter for the client layer. In a hop by hop routing network the metrics would normally be assigned by appropriate configuration of the embedded client network layer equipment (e.g. the embedded client LSR). Where the client was using the packet PW as part of a traffic engineered path, it is up to the operator of the client network to ensure that the server layer operator provides the necessary service level agreement.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Forwarding Model</h1>
<p id="rfc.section.4.p.1">The packet PW forwarding model is illustrated in <a href="#fwd-model">Figure 2</a>. The forwarding operation can be likened to a virtual private network (VPN), in which a forwarding decision is first taken at the client layer, an encapsulation is applied and then a second forwarding decision is taken at the server layer.</p>
<div id="#rfc.figure.2"></div>
<div id="#fwd-model"></div>
<pre>
         +------------------------------------------------+
         |                                                |
         |  +--------+                        +--------+  |
         |  |        |   Pkt   +-----+        |        |  |
      ------+        +---------+ PW1 +--------+        +------
         |  | Client |    AC   +-----+        | Server |  |
  Client |  | LSR    |                        | LSR    |  | Server 
 Network |  |        |   Pkt   +-----+        |        |  | Network
      ------+        +---------+ PW2 +--------+        +------
         |  |        |    AC   +-----+        |        |  |
         |  +--------+                        +--------+  |
         |                                                |
         +------------------------------------------------+

</pre>
<p></p>
<p id="rfc.section.4.p.3">A packet PW PE comprises three components, the client LSR, PW processor and a server LSR. Note that <a href="#RFC3985">[RFC3985]</a> does not formally indicate the presence of the server LSR because it does not concern itself with the server layer. However it is useful in this document to recognise that the server LSR exists.</p>
<p id="rfc.section.4.p.4">It may be useful to first recall the operation of a layer two PW such as an Ethernet PW <a href="#RFC4448">[RFC4448]</a> within this model. The client LSR is not present and packets arrive directly on the attachment circuit (AC) which is part of the client network. The PW undertakes any header processing, if configured to do so, it then pushes the PW control word (CW), and finally pushes the PW label. The PW function then passes the packet to the LSR function which pushes the label needed to reach the egress PE and forwards the packet to the next hop in the server network. At the egress PE, the packet typically arrives with the PW label at top of stack, the packet is thus directed to the correct PW instance. The PW instance performs any required reconstruction using, if necessary, the CW and the packet is sent directly to the attachment circuit.</p>
<p id="rfc.section.4.p.5">Now let us consider the case client layer MPLS traffic being carried over a packet PW. An LSR belonging to the client layer is embedded within the PE equipment. This is a type of native service processing element <a href="#RFC3985">[RFC3985]</a>. This LSR determines the next hop in the client layer, and pushes the label needed by the next hop in the client layer. It then passes the packet to the correct PW instance indicating the packet protocol type. If the PW is configured to require a CW this is pushed. The PW instance then examines the protocol type and pushes a label that identifies the protocol type to the egress PE. The PW instance then proceeds as it would for a layer two PW, by pushing the PW label and then handing the packet to the server layer LSR for delivery. At egress, the packet again arrives with the PW label at the top of stack which causes the packet to be passed to the correct PW instance. This PW instance knows that the PW type is a packet PW, and hence that it needs to interpret the next label as a protocol type identifier. If necessary the CW is then popped and processed. The packet is then passed to the egress client LSR together with information that identifies the packet protocol type. The egress client LSR then forwards the packet in the normal manner for a protocol of that type.</p>
<p id="rfc.section.4.p.6">Note that although the description above is written in terms of the behaviour of an MPLS LSR, the processing model would be similar for an IP packet, or indeed any other protocol type.</p>
<p id="rfc.section.4.p.7">Note that the semantics of the PW between the client LSRs is a point to point link.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Packet PW Encapsulation </h1>
<p id="rfc.section.5.p.1">The client network work layer packet encapsulation into a packet PW is shown in <a href="#pktPWps">Figure 3</a>.</p>
<div id="#rfc.figure.3"></div>
<div id="#pktPWps"></div>
<pre>   +-------------------------------+
   |            Client             |
   |          Network Layer        |
   |            packet             |  n octets
   |                               |
   +-------------------------------+
   |                               |
   |          Ethernet             | 14 octets 
   |           Header              |
   |               +---------------+
   |               |
   +---------------+---------------+ 
   |    Optional Control Word      |  4 octets 
   +-------------------------------+
   |          PW label             |  4 octets
   +-------------------------------+
   |   Server MPLS Tunnel Label(s) |  n*4 octets (four octets per label)
   +-------------------------------+
 </pre>
<p></p>
<p id="rfc.section.5.p.3">This conforms to the PW protocols stack as defined in <a href="#RFC4448">[RFC4448]</a>. The protocol stack is unremarkable except to note that the stack does not retain 32 bit alignment between the virtual Ethernet header and the PW optional control word (or the PW label when the optional components are not present in the PW header). This loss of 32 bit of alignment is necessary to preserve backwards compatibility with the Ethernet PW design <a href="#RFC4448">[RFC4448]</a></p>
<p id="rfc.section.5.p.4">Ethernet Raw Mode (PW type 5) MUST be used for the packet PW.</p>
<p id="rfc.section.5.p.5">The PEs MAY use a local Ethernet address for the Ethernet header used to encapsulate the client network layer packet. Alternatively the PEs may use the following proceedure.</p>
<p id="rfc.section.5.p.6">IANA are requested to allocate two unicast Ethernet addresses <a href="#RFC5342">[RFC5342]</a> to this protocol (PacketPWEthA and PacketPWEthB). PacketPWEthA is the value lower Ethernet address and PacketPWEthB is the higher value Ethernet address. Where <a href="#RFC4447">[RFC4447]</a> signalling is used to set up the PW, the LDP peers compare IP addresses and with the PE with the higher IP address uses PacketPWEthA, whilst the LDP peer with the lower IP address uses PacketPWEthB.</p>
<p id="rfc.section.5.p.7">Where no signalling PW protocol is used, suitable Ethernet addresses MUST be configured at each PE.</p>
<p id="rfc.section.5.p.8">Not withstanding the fact that this PW represents a point to point connection, some client layer protocols require the use of a destination mulitcast address in the Ethernet encapsulation. This mode of operation MUST be supported.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Ethernet Functional Restrictions</h1>
<p id="rfc.section.6.p.1">The use of Ethernet as the encapsulation mechanism for traffic between the server LSRs is a convenience based on the widespread availability of existing hardware. In this application there is no requirement for any Ethernet feature other than its protocol multiplexing capability. Thus, for example, the Ethernet OAM is NOT REQUIRED.</p>
<p id="rfc.section.6.p.2">The use and applicability of Ethernet VLANs, 802.1p, and 802.1Q between PEs is not supported.</p>
<p id="rfc.section.6.p.3">Point to multipoint and multipoint to multipoint operation of the virtual Ethernet is not supported.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Congestion Considerations </h1>
<p id="rfc.section.7.p.1">A packet pseudowire is normally used to carry IP, MPLS and their associated support protocols over an MPLS network. There are no congestion considerations beyond those that ordinarily apply to an IP or MPLS network. Where the packet protocol being carried is not IP or MPLS and the traffic volumes are greater than that ordinarily associated with the support protocols in an IP or MPLS network, the congestion considerations being developed for PWs apply <a href="#RFC3985">[RFC3985]</a>, <a href="#RFC5659">[RFC5659]</a>.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Security Considerations</h1>
<p id="rfc.section.8.p.1">The virtual Ethernet approach to packet PW introduces no new security risks. A more detailed discussion of pseudowire security is given in <a href="#RFC3985">[RFC3985]</a>, <a href="#RFC4447">[RFC4447]</a> and <a href="#RFC3916">[RFC3916]</a>.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> IANA Considerations </h1>
<p id="rfc.section.9.p.1">IANA are requested to allocate two Ethernet unicast addresses from the IANA Ethernet Aaddress Block - Unicast Use</p>
<p></p>
<div id="#rfc.figure.4"></div>
<pre>Dotted Decimal           Description                       Reference
-----------------------  --------------------------------  ---------

000.00x.000-000.00x.001  PacketPWEthA and PacketPWEthB     [This RFC]

</pre>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Acknowledgements</h1>
<p id="rfc.section.10.p.1">The authors acknowledge the contribution make by Sami Boutros, Giles Herron, Siva Sivabalan and David Ward to this document.</p>
<h1 id="rfc.references">
<a href="#rfc.references">11.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">11.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4447">[RFC4447]</b></td>
<td class="top">
<a>Martini, L.</a>, <a>Rosen, E.</a>, <a>El-Aawar, N.</a>, <a>Smith, T.</a> and <a>G. Heron</a>, "<a href="http://tools.ietf.org/html/rfc4447">Pseudowire Setup and Maintenance Using the Label Distribution Protocol (LDP)</a>", RFC 4447, April 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4448">[RFC4448]</b></td>
<td class="top">
<a>Martini, L.</a>, <a>Rosen, E.</a>, <a>El-Aawar, N.</a> and <a>G. Heron</a>, "<a href="http://tools.ietf.org/html/rfc4448">Encapsulation Methods for Transport of Ethernet over MPLS Networks</a>", RFC 4448, April 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5342">[RFC5342]</b></td>
<td class="top">
<a>Eastlake, D.</a>, "<a href="http://tools.ietf.org/html/rfc5342">IANA Considerations and IETF Protocol Usage for IEEE 802 Parameters</a>", BCP 141, RFC 5342, September 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">11.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3985">[RFC3985]</b></td>
<td class="top">
<a>Bryant, S.</a> and <a>P. Pate</a>, "<a href="http://tools.ietf.org/html/rfc3985">Pseudo Wire Emulation Edge-to-Edge (PWE3) Architecture</a>", RFC 3985, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5317">[RFC5317]</b></td>
<td class="top">
<a>Bryant, S.</a> and <a>L. Andersson</a>, "<a href="http://tools.ietf.org/html/rfc5317">Joint Working Team (JWT) Report on MPLS Architectural Considerations for a Transport Profile</a>", RFC 5317, February 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3916">[RFC3916]</b></td>
<td class="top">
<a>Xiao, X.</a>, <a>McPherson, D.</a> and <a>P. Pate</a>, "<a href="http://tools.ietf.org/html/rfc3916">Requirements for Pseudo-Wire Emulation Edge-to-Edge (PWE3)</a>", RFC 3916, September 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5659">[RFC5659]</b></td>
<td class="top">
<a>Bocci, M.</a> and <a>S. Bryant</a>, "<a href="http://tools.ietf.org/html/rfc5659">An Architecture for Multi-Segment Pseudowire Emulation Edge-to-Edge</a>", RFC 5659, October 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5385">[RFC5385]</b></td>
<td class="top">
<a>Touch, J.</a>, "<a href="http://tools.ietf.org/html/rfc5385">Version 2.0 Microsoft Word Template for Creating Internet Drafts and RFCs</a>", RFC 5385, February 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5921">[RFC5921]</b></td>
<td class="top">
<a>Bocci, M.</a>, <a>Bryant, S.</a>, <a>Frost, D.</a>, <a>Levrau, L.</a> and <a>L. Berger</a>, "<a href="http://tools.ietf.org/html/rfc5921">A Framework for MPLS in Transport Networks</a>", RFC 5921, July 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Encapsulation Approaches Considered</h1>
<p id="rfc.section.Appendix A.p.1">A number of approaches to the design of a packet pseudowire (PW) have been investigated and have been described at the IETF. This section discusses the approaches that were analysed and the technical issues that the authors took into consideration in arriving at the proposed approach.</p>
<p id="rfc.section.Appendix A.p.2">In a typical network there are usually no more that four network layer protocols that need to be supported: IPv4, IPv6, MPLS and CLNS although any solution needs to be scalable to a larger number of protocols. The approaches considered in this document all satisfy this minimum requirement, but vary in their ability to support larger numbers of network layer protocols.</p>
<p id="rfc.section.Appendix A.p.3">Additionally it is beneficial if the complete set of protocols carried over the network between in support of a set of CE peers fate share. It is additionally beneficial if a single OAM session can be used to monitor the behaviour of this complete set. During the investigation various views were expressed as to where on the scale from absolutely required to "nice to have" these benefits lay, but in the end they were not a factor in reaching our conclusion.</p>
<p id="rfc.section.Appendix A.p.4">There are four candidate approaches that have been analysed:</p>
<p></p>

<ol>
<li>A protocol identifier (PID) in the PW Control Word (CW)</li>
<li>A PID label</li>
<li>Parallel PWs - one per protocol.</li>
<li>Virtual Ethernet</li>
</ol>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> A Protocol Identifier in the Control Word</h1>
<p id="rfc.section.Appendix A.1.p.1">This is the approach that we proposed in draft 0 of this document .  The proposal was that a Protocol Identifier (PID) would included in the PW control word (CW), by appending it to the generic control word <a href="#RFC5385">[RFC5385]</a> to make a 6 byte CW (the version 0 draft actually included two reserved bytes to provide 32bit alignment, but let us assume that was optimized out). A variant of this is just to use a 2 byte PID without a control word.</p>
<p id="rfc.section.Appendix A.1.p.2">This is a simple approach, and is basically a virtual PPP interface without the PPP control protocol. This has a smaller MTU than for example a virtual Ethernet would need, however in forwarding terms it is not as simple as the PID label or multiple PW approaches described next, and may not be deployable on a number of existing hardware platforms.</p>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> PID Label </h1>
<p id="rfc.section.Appendix A.2.p.1">This is the approach that we described in Version 2 of this document. The in this mechanism the PID is indicated by including a label after the PW label that indicates the protocol type as shown in <a href="#PEn">Figure 5</a>.</p>
<div id="#rfc.figure.5"></div>
<div id="#PEn"></div>
<pre> 
   +-------------------------------+
   |            Client             |
   |          Network Layer        |
   |            packet             |  n octets
   |                               |
   +-------------------------------+ 
   |    Optional Control Word      |  4 octets
   +-------------------------------+
   |        PID Label (S=1)        |  4 Octets
   +-------------------------------+
   |          PW label             |  4 octets
   +-------------------------------+
   |   Server MPLS Tunnel Label(s) |  n*4 octets (four octets per label)
   +-------------------------------+

</pre>
<p></p>
<p id="rfc.section.Appendix A.2.p.3">In the PID Label approach a new Label Distribution protocol (LDP) Forwarding Equivalence Class (FEC) element is used to signal the mapping between protocol type and the PID label. This approach complies with RFC3031.</p>
<p id="rfc.section.Appendix A.2.p.4">A similar approach to PID label is described in Section 3.4.5 of <a href="#RFC5921">[RFC5921]</a>. In this case when the client is a network layer packet service such as IP or MPLS, a service label and demultiplexer label (which may be combined) is used to provide the necessary identifications needed to carry this traffic over an LSP.</p>
<p id="rfc.section.Appendix A.2.p.5">The authors surveyed the hardware designs produced by a number of companies across the industry and concluded that whilst the approach complies with the MPLS architecture, it may conflict with a number of designer's interpretation of the existing MPLS architecture. This led to concerns that the approach may result in unexpected difficulties in the future. Specifically there is an assumption in many designs that a forwarding decision should be made on the basis of a single label.  Whilst the approach is attractive, it cannot be supported by many commodity chip sets and this would require new hardware which would increase the cost of deployment and delay the introduction of a packet PW service.</p>
<h1 id="rfc.appendix.Appendix A.3">
<a href="#rfc.appendix.Appendix%20A.3">Appendix A.3.</a> Parallel PWs</h1>
<p id="rfc.section.Appendix A.3.p.1">In this approach one PW is constructed for each protocol type that must be carried between the PEs. Thus a complete packet PW would therefore consist of a bundle of PWs . This model would be very simple and efficient from a forwarding point of view. The number of parallel PWs required would normally be relatively small. In a typical network there are usually no more that four network layer protocols that need to be supported: IPv4, IPv6, MPLS and CLNS although any solution needs to be scalable to a larger number of protocols.</p>
<p id="rfc.section.Appendix A.3.p.2">The are a number of serious downsides with this approach:</p>
<p></p>

<ol>
<li>From an operational point of view the lack of fate sharing between the protocol types can lead to complex faults which are difficult to diagnose.</li>
<li>There is an undesirable trade off in the OAM related to the first point. Either we would have to run an OAM on each PW and bind them together which lead to significant protocol and software complexity and does not scale well. Alternatively we would need to run a single OAM session on one of the PWs as a proxy for the others and the diagnose any more complex failure on a case by case basis. To some extent the issue of fate sharing between protocol in the bundle (for example the assumed fate sharing between CLNS and IP in IS-IS) can be mitigated through the use of BFD.</li>
<li>The need to configure manage and synchronize the behaviour of a group of PWs as if they were a single PW leads to an increase in control plane complexity.</li>
</ol>
<p id="rfc.section.Appendix A.3.p.4">The Parallel PW mechanism is therefore an approach which simplifies the forwarding plane, but only at a cost of a considerable increase in other aspects of the design and in particular operation of the PW.</p>
<h1 id="rfc.appendix.Appendix A.4">
<a href="#rfc.appendix.Appendix%20A.4">Appendix A.4.</a> Virtual Ethernet</h1>
<p id="rfc.section.Appendix A.4.p.1">Using a virtual Ethernet to provide a packet PW would require PEs to include a virtual (internal) Ethernet interface and then to use an Ethernet PW <a href="#RFC4448">[RFC4448]</a> to carry the user traffic.  This is conceptually simple and can be implemented today without any further standards action, although there are a number of applicability considerations that it is useful to draw to the attention of the community.</p>
<p id="rfc.section.Appendix A.4.p.2">Conceptually this is a simple approach and some deployed equipments can already do this. However the requirement to run a complete Ethernet adjacency lead us to conclude that there was a need to identify a simpler approach. The packets encapsulated in an Ethernet header have a larger MTU than the other approaches, although this is not considered to be an issue on the networks needing to carry packet PWs.</p>
<p id="rfc.section.Appendix A.4.p.3">The virtual Ethernet mechanism was the first approach that the authors considered, before the merits of the other approaches appeared to make them more attractive. As we shall see below however, the other approaches were not without issues and it appears that the virtual Ethernet is preferred approach to providing a packet PW.</p>
<h1 id="rfc.appendix.Appendix A.5">
<a href="#rfc.appendix.Appendix%20A.5">Appendix A.5.</a> Recommended Encapsulation</h1>
<p id="rfc.section.Appendix A.5.p.1">The operational complexity and the breaking of fate sharing assumptions associated with the parallel PW approach would suggest that this is not an approach that should be further pursued.</p>
<p id="rfc.section.Appendix A.5.p.2">The PID Label approach gives rise to the concerns that it will break implicit behavioural and label stack size assumptions in many implementations. Whilst those assumptions may be addressed with new hardware this would delay the introduction of the technology to the point where it was unlikely to gain acceptance in competition with an approach that needed no new protocol design and is already supportable on many existing hardware platforms.</p>
<p id="rfc.section.Appendix A.5.p.3">The PID in the CW leads to the most compact protocol stack, is simple and requires minimal protocol work. However it is a new forwarding design, and apart from the issue of the larger packet header and the simpler adjacency formation offers no advantage over the virtual Ethernet.</p>
<p id="rfc.section.Appendix A.5.p.4">The above considerations bring us back to the virtual Ethernet, which is a well known protocol stack, with a well known (internal) client interface. It is already implemented in many hardware platforms and is therefore readily deployable. The authors conclude that having considered a number of initially promising alternatives, the simplicity and existing hardware make the virtual Ethernet approach to the packet PW the most attractive solution.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Stewart Bryant</span> editor
	  <span class="n hidden">
		<span class="family-name">Bryant</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>250, Longwater, Green Park,</span>

	  <span class="vcardline">
		<span class="locality">Reading</span>,  
		<span class="region">Berks</span> 
		<span class="code">RG2 6GB</span>
	  </span>
	  <span class="country-name vcardline">UK</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:stbryant@cisco.com">stbryant@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Luca Martini</span> 
	  <span class="n hidden">
		<span class="family-name">Martini</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>9155 East Nichols Avenue, Suite 400</span>

	  <span class="vcardline">
		<span class="locality">Englewood</span>,  
		<span class="region">CO</span> 
		<span class="code">80112</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:lmartini@cisco.com">lmartini@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">George Swallow</span> 
	  <span class="n hidden">
		<span class="family-name">Swallow</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span>1414 Massachusetts Ave</span>

	  <span class="vcardline">
		<span class="locality">Boxborough</span>,  
		<span class="region">MA</span> 
		<span class="code">01719</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:swallow@cisco.com">swallow@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Andy Malis</span> 
	  <span class="n hidden">
		<span class="family-name">Malis</span>
	  </span>
	</span>
	<span class="org vcardline">Verizon Communications</span>
	<span class="adr">
	  <span>117 West St.</span>

	  <span class="vcardline">
		<span class="locality">Waltham</span>,  
		<span class="region">MA</span> 
		<span class="code">02451</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:andrew.g.malis@verizon.com">andrew.g.malis@verizon.com</a></span>

  </address>
</div>

</body>
</html>