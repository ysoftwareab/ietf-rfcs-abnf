 



INTERNET-DRAFT                                              Sami Boutros
Intended Status: Standard Track                              Ankur Dubey
                                                                  VMware
                                                                        
                                                           Reshad Rahman
                                                                   Cisco

Expires: November 15, 2017                                  May 14, 2017


                     Service Redundancy using BFD 
                 draft-adubey-bfd-service-redundancy-00


Abstract

   In a data center, when multiple routing/service nodes are providing
   single active redundancy for a set of L2, L3 and/or L4-L7 services.
   Both non-revertive and revertive fail over modes are required for the
   services. This draft describes a method to achieve the non-revertive
   and revertive fail over modes for services using Bidirectional
   Forwarding Detection (BFD).

Status of this Memo

   This Internet-Draft is submitted to IETF in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as
   Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/1id-abstracts.html

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html


Copyright and License Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
 


Dubey-Boutros          Expires November 15, 2017                [Page 1]

INTERNET DRAFT        Service Redundancy using BFD          May 14, 2017


   document authors. All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document. Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Table of Contents

   1  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . .  3
     1.1  Terminology . . . . . . . . . . . . . . . . . . . . . . . .  3
   2. Solution Overview . . . . . . . . . . . . . . . . . . . . . . .  4
   3 Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . .  5
   4 Security Considerations  . . . . . . . . . . . . . . . . . . . .  5
   5  IANA Considerations . . . . . . . . . . . . . . . . . . . . . .  5
   6  References  . . . . . . . . . . . . . . . . . . . . . . . . . .  5
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . .  5
























 


Dubey-Boutros          Expires November 15, 2017                [Page 2]

INTERNET DRAFT        Service Redundancy using BFD          May 14, 2017


1  Introduction

   This document describes how can a group of service/routing nodes in a
   data center providing single active redundancy for multiple L2/L3
   and/or L4/L7 services, can use BFD protocol to support non-revertive
   as well as revertive fail over mode.

   Typically, BFD is used between the group of service nodes to verify
   the connectivity as well as the aliveness of the service nodes. The
   assignment of which node in the group is the primary designated
   forwarder for a given service can be determined using a centralized
   or distributed control plane. 

   The use of BFD will be to communicate the set of services that are
   being currently active on a given service node to the other service
   nodes. On a given node failure, for a given service the backup node
   will take over. If the service was configured to have a non-revertive
   fail over mode, then the backup node should continue to perform the
   service forwarding even after the primary node recovers and comes
   back up. In order to do that, the backup node MUST inform the primary
   node that it is currently active for the service. This is achieved
   through the extension we are proposing to the BFD protocol as will be
   described in the following sections.

   It is to be noted that for revertive fail over mode of operation, the
   primary node should be able to take over the active role from the
   backup node when the primary node goes back to an operational state.
   This can be as well communicated using the BFD session establishment
   between the primary node and the backup node.

1.1  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].













 


Dubey-Boutros          Expires November 15, 2017                [Page 3]

INTERNET DRAFT        Service Redundancy using BFD          May 14, 2017


2. Solution Overview



                  +----------+
                  |Controller|   
                  +----------+    
                  //    |    \                
                //      |      \
              //        |        \ 
      +-------+     +-------+     +-------+
      |Node1  |-BFD-|Node2  |-BFD-|Node3  |
      +-------+     +-------+     +-------+
           |--------------BFD--------|  

   Figure 1: 

   Figure 1 shows 3 routing nodes using BFD to implement the single
   active redundancy for revertive and non-revertive services. 

   Multiple L2/L3 and/or L4/L7 services are offered in a data center by
   a set of routing/service nodes providing single active redundancy.
   The provisioning of the services can be done using a centralized
   control plane implemented in a controller or using a distributed
   dynamic control plane. 

   Every L2/L3 and/or L4/L7 service is identified by a unique ID known
   across the routing/service nodes providing the services.

   A bitmap will be used to represent the services, where each service
   is represented by one bit in the bit map. All the service nodes MUST
   have the same mapping of the bit position to the service unique ID.
   The bitmap position and the unique service ID could be maintained by
   a network controller. The bitmap will be used in the payload of the
   BFD packets sent by the service node to indicate which service the
   node maintain an active status for.

   Service nodes providing single active redundancy will communicate
   using BFD this bitmap carried in the BFD control packet payload. When
   a backup service node takes over a service with a non-revertive fail
   over mode after primary node failure. The backup node once the BFD
   session comes up with the recovered primary node, will set the bit
   associated with this service in the bitmap payload carried in the BFD
   control packet sent to the primary node. Furthermore, the backup node
   will use a new Diag code in the BFD control packet to inform the
   primary node that it out-lived it and took over the set of non-
   preemptive services encoded in the bitmap of the BFD control packet
   payload.
 


Dubey-Boutros          Expires November 15, 2017                [Page 4]

INTERNET DRAFT        Service Redundancy using BFD          May 14, 2017


   The BFD control packet with the new Diag code and the bitmap will be
   sent after the BFD session came up in the BFD control packets for at
   least twice the detection multiplier count. Only the non-revertive
   services associated bits in the bitmap will be set by a service node
   acting as a backup for those services after a primary node failure
   recovery. Primary node upon receiving the BFD control packet with the
   bit set for the corresponding non-revertive service MUST not attempt
   to activate the service, but should remain in standby state for the
   service until the backup node that took over fails.

   Revertive services are assumed to revert back to the primary node
   after primary node recovers. Once the BFD session comes up between
   the primary and backup node, the backup node should stop forwarding
   for any revertive services. A node MUST start forwarding all
   revertive services for which it is configured as a primary once the
   BFD session comes up with the corresponding backup nodes. A node MUST
   stop forwarding for revertive services for which it is a backup once
   the BFD session comes up with the corresponding primary.


3 Acknowledgements


4 Security Considerations

   This document does not introduce any additional security constraints.

5  IANA Considerations

   IANA is requested to assign a new diag code from the "BFD Diagnostic
   Codes"


    Value    BFD Diagnostic Code Name
    -----    ------------------------------------------------------------
    0xNN     Out-lived and BitMap payload set with non-revertive services


6  References

   [RFC5880] D. Katz, D. Ward "Bidirectional Forwarding Detection
   (BFD)".



Authors' Addresses


 


Dubey-Boutros          Expires November 15, 2017                [Page 5]

INTERNET DRAFT        Service Redundancy using BFD          May 14, 2017


   Sami Boutros
   VMware 
   Email: sboutros@vmware.com

   Ankur Dubey
   VMware 
   Email: adubey@vmware.com

   Reshad Rahman
   Cisco
   Email: rrahman@cisco.com








































Dubey-Boutros          Expires November 15, 2017                [Page 6]
