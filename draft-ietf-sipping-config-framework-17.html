<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>A Framework for Session Initiation Protocol User Agent Profile Delivery</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="A Framework for Session Initiation Protocol User Agent Profile Delivery">
<meta name="keywords" content="SIP, Configuration, Framework, User Agent, profile">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SIPPING</td><td class="header">D. Petrie</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">SIPez LLC.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">S. Channabasappa, Ed.</td></tr>
<tr><td class="header">Expires: August 21, 2010</td><td class="header">CableLabs</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 17, 2010</td></tr>
</table></td></tr></table>
<h1><br />A Framework for Session Initiation Protocol User Agent Profile Delivery<br />draft-ietf-sipping-config-framework-17</h1>

<h3>Abstract</h3>

<p>
                This document specifies a framework to enable configuration of Session Initiation Protocol (SIP) User Agents in SIP deployments. The framework provides a means to deliver profile data that User Agents need to be functional, automatically and with minimal or no User and Administrative intervention. The framework describes how SIP User Agents can discover sources, request profiles and receive notifications related to profile modifications.  As part of this framework, a new SIP event package is defined for notification of profile changes. The framework provides minimal data retrieval options to ensure interoperability. The framework does not include specification of the profile data within its scope.
                
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 21, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#Introduction">1.</a>&nbsp;
Introduction<br />
<a href="#Terminology">2.</a>&nbsp;
Terminology<br />
<a href="#Overview">3.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ReferenceModel">3.1.</a>&nbsp;
Reference Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Motivation">3.2.</a>&nbsp;
Motivation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ProfileTypes">3.3.</a>&nbsp;
Profile Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#OverviewProfileDeliveryStages">3.4.</a>&nbsp;
Profile delivery stages<br />
<a href="#UseCases">4.</a>&nbsp;
Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UseCaseDeviceDifferentSPs">4.1.</a>&nbsp;
Simple Deployment Scenario<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UseCaseDeviceMultipleUsers">4.2.</a>&nbsp;
Devices supporting multiple users from different Service Providers<br />
<a href="#ProfileDeliveryFramework">5.</a>&nbsp;
Profile Delivery Framework<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ProfileDeliveryStages">5.1.</a>&nbsp;
Profile delivery stages<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ProfileEnrollment">5.1.1.</a>&nbsp;
Profile Enrollment<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ProfileDeliveryContentRetrieval">5.1.2.</a>&nbsp;
Content Retrieval<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ProfileDeliveryChangeNotification">5.1.3.</a>&nbsp;
Change Notification<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#EnrollmentDataDiscoveryAndCaching">5.1.4.</a>&nbsp;
Enrollment Data and Caching<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecuringProfileDelivery">5.2.</a>&nbsp;
Securing Profile Delivery<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecuringProfileEnrollment">5.2.1.</a>&nbsp;
Securing Profile Enrollment<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecuringContentRetrieval">5.2.2.</a>&nbsp;
Securing Content Retrieval<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecuringChangeNotification">5.2.3.</a>&nbsp;
Securing Change Notification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AdditionalConsiderations">5.3.</a>&nbsp;
Additional Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IdentitiesAndCredentials">5.3.1.</a>&nbsp;
Bootstrapping Identities and Credentials<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ProfileEnrollmentRequestAttempt">5.3.2.</a>&nbsp;
Profile Enrollment Request Attempt<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DeviceTypes">5.3.3.</a>&nbsp;
Device Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ProfileData">5.3.4.</a>&nbsp;
Profile Data<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ProfileDataFrameworks">5.3.5.</a>&nbsp;
Profile Data Frameworks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AdditionalProfileTypes">5.3.6.</a>&nbsp;
Additional Profile Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#EntityRelationships">5.3.7.</a>&nbsp;
Deployment considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#OutboundUsage">5.4.</a>&nbsp;
Support for NATs<br />
<a href="#EventPackageDefinition">6.</a>&nbsp;
Event Package Definition<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#EventPackageName">6.1.</a>&nbsp;
Event Package Name<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#EventPackageParameters">6.2.</a>&nbsp;
Event Package Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SUBSCRIBEBodies">6.3.</a>&nbsp;
SUBSCRIBE Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SubscriptionDuration">6.4.</a>&nbsp;
Subscription Duration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#NOTIFYBodies">6.5.</a>&nbsp;
NOTIFY Bodies<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#NotifierProcessingOfSUBSCRIBERequests">6.6.</a>&nbsp;
Notifier Processing of SUBSCRIBE Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#NotifierGenerationOfNOTIFYRequests">6.7.</a>&nbsp;
Notifier Generation of NOTIFY Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SubscriberProcessingOfNOTIFYRequests">6.8.</a>&nbsp;
Subscriber Processing of NOTIFY Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HandlingOfForkedRequests">6.9.</a>&nbsp;
Handling of Forked Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RateOfNotifications">6.10.</a>&nbsp;
Rate of Notifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#StateAgents">6.11.</a>&nbsp;
State Agents<br />
<a href="#FrameworkExamples">7.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#FrameworkExamples1">7.1.</a>&nbsp;
Example 1: Device requesting profile<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#FrameworkExamples2">7.2.</a>&nbsp;
Example 2: Device obtaining change notification<br />
<a href="#IANAConsiderations">8.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SIPEventPackage">8.1.</a>&nbsp;
SIP Event Package<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#RegistryOfSIPConfigurationProfileTypes">8.2.</a>&nbsp;
Registry of SIP configuration profile types<br />
<a href="#SecurityConsiderations">9.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SCForLocalNetworkProfile">9.1.</a>&nbsp;
Local-network profile<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SCForDeviceProfile">9.2.</a>&nbsp;
Device profile<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SCForUserProfile">9.3.</a>&nbsp;
User profile<br />
<a href="#anchor1">10.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="Introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
                SIP User Agents require configuration data to function properly. Examples include local network, device and user specific information. A configuration data set specific to an entity is termed a profile. For example, device profile contains the configuration data related to a device. The process of providing devices with one or more profiles is termed profile delivery. Ideally, this profile delivery process should be automatic and require minimal or no user intervention. 
                <br />
<br />

                Many deployments of SIP User Agents require dynamic configuration and cannot rely on pre-configuration. This framework provides a standard means of providing dynamic configuration which simplifies deployments containing SIP User Agents from multiple vendors. This framework also addresses change notifications when profiles change. However, the framework does not define the content or format of the profile, leaving that to future standardization activities.
                <br />
<br />

                This document is organized as follows. Section 3 provides a high-level overview of the abstract components, profiles, and the profile delivery stages. Section 4 provides some motivating use cases. Section 5 provides details of the framework operation and requirements. Section 6 provides a concise event package definition. Section 7 follows with illustrative examples of the framework in use.
                
</p>
<a name="Terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>
                  The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in  <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].        
                        <br />
<br />

                This document also reuses the SIP terminology defined in <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> and <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>, and specifies the usage of the following terms.
                <br />
<br />


                </p>
<blockquote class="text"><dl>
<dt>Device:</dt>
<dd>
                        software or hardware entity containing one or more SIP user agents. It may also contain entities such as a DHCP client.
                        <br />
<br />

                        
</dd>
<dt>Device Provider:</dt>
<dd>
                                    the entity responsible for managing a given device.
                        <br />
<br />

                        
</dd>
<dt>Local Network Provider:</dt>
<dd>
                                    the entity that controls the local network to which a given device is connected.
                        <br />
<br />

                        
</dd>
<dt>SIP Service Provider:</dt>
<dd>
                                    the entity providing SIP services to users. This can refer to private enterprises or public entities.
                        <br />
<br />

                                    
</dd>
<dt>Profile:</dt>
<dd>
                        configuration data set specific to an entity (e.g., user, device, local network or other). 
                        <br />
<br />

                        
</dd>
<dt>Profile Type:</dt>
<dd>
                        a particular category of Profile data (e.g., User, Device, Local Network or other). 
                        <br />
<br />

                        
</dd>
<dt>Profile Delivery Server (PDS):</dt>
<dd>
                        the source of a Profile, it is the logical collection of the Profile Notification Component (PNC) and the Profile Content Component(PCC). 
                        <br />
<br />

                        
</dd>
<dt>Profile Notification Component (PNC):</dt>
<dd>
                        the logical component of a Profile Delivery Server that is responsible for enrolling devices and providing profile notifications. 
                        <br />
<br />

                        
</dd>
<dt>Profile Content Component (PCC):</dt>
<dd>
                        the logical component of a Profile Delivery Server that is responsible for storing, providing access to, and accepting profile content. 
                        <br />
<br />

			
</dd>
<dt>Profile Delivery Stages:</dt>
<dd>
	                the processes that lead a device to obtain profile data, and any subsequent changes, are collectively called profile delivery stages.
                        <br />
<br />

			
</dd>
<dt>Bootstrapping:</dt>
<dd>
                        Bootstrapping is the process  by which a new (or factory reset) device, with no configuration or minimal "factory" pre-configuration, enrolls with the PDS.  The device may use a temporary identity and credentials to authenticate itself to enroll and receive profiles, which may provide more permanent identities and credentials for future enrollments.
                        <br />
<br />

                        
</dd>
</dl></blockquote><p>
                
                
</p>
<a name="Overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Overview</h3>

<p>
			This section provides an overview of the configuration framework. It presents the reference model, the motivation, the profile delivery stages and a mapping of the concepts to specific use cases. It is meant to serve as a reference section for the document, rather than providing a specific logical flow of material, and it may be necessary to revisit these sections for a complete appreciation of the framework. 
			<br />
<br />

                        The SIP UA Profile Delivery Framework uses a combination of SIP event messages (SUBSCRIBE and NOTIFY; <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>) and traditional file retrieval protocols, such as HTTP <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>, to discover, monitor, and retrieve configuration profiles. The framework defines three types of profiles (local-network, device, and user) in order to separate aspects of the configuration which may be independently managed by different administrative domains. The initial SUBSCRIBE message for each profile allows the UA to describe itself (both its implementation and the identity requesting the profile), while requesting access to a profile by type, without prior knowledge of the profile name or location. Discovery mechanisms are specified to help the UA form the subscription URI (the Request-URI for the SIP SUBSCRIBE). The SIP UAS handling these subscriptions is the Profile Delivery Server (PDS). When the PDS accepts a subscription, it sends a NOTIFY to the device. The initial NOTIFY from the PDS for each profile may contain profile data or a reference to the location of the profile, to be retrieved using HTTP or similar file retrieval protocols. By maintaining a subscription to each profile, the UA will receive additional NOTIFY messages if the profile is later changed. These may contain a new profile, a reference to a new profile, or a description of profile changes, depending on the Content-Type <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> in use by the subscription. The framework describes the mechanisms for obtaining three different profile types, but does not describe the data model they utilize (the data model is out of scope for this specification).
               
</p>
<a name="ReferenceModel"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Reference Model</h3>

<p>
                        The design of the framework was the result of a careful analysis to identify the configuration needs of a wide range of SIP deployments. As such, the reference model provides for a great deal of flexibility, while breaking down the interactions to their basic forms, which can be reused in many different scenarios. 
                        <br />
<br />

                        The reference model for the framework defines the interactions between the Profile Delivery Server(PDS) and the device. The device needs the profile data to function effectively in the network. The PDS is responsible for responding to device requests and providing the profile data. The reference model is illustrated in <a class='info' href='#FrameworkReferenceModel'>Figure&nbsp;1<span> (</span><span class='info'>Framework Reference Model</span><span>)</span></a>.

                        <br /><hr class="insert" />
<a name="FrameworkReferenceModel"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                                       +-------------------------+
 +--------+                            | Profile Delivery Server |
 | Device |&lt;==========================&gt;|  +---+          +---+   |
 +--------+                            |  |PNC|          |PCC|   |
                                       |  +---+          +---+   |
                                       +-------------------------+

                             PNC = Profile Notification Component
                             PCC = Profile Content Component


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Framework Reference Model&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


                        <br />
<br />


                        The PDS is subdivided into two logical components: 
                        </p>
<ul class="text">
<li>
Profile Notification Component (PNC), responsible for enrolling devices for profiles and providing profile change notifications;  
                                
</li>
<li>
Profile Content Component (PCC), responsible for storing, providing access to, and accepting modifications related to profile content. 
                                
</li>
</ul><p>

			<br />
<br />

			
</p>
<a name="Motivation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Motivation</h3>

<p>
			The motivation for the framework can be demonstrated by applying the reference model presented in <a class='info' href='#ReferenceModel'>Section&nbsp;3.1<span> (</span><span class='info'>Reference Model</span><span>)</span></a> to two scenarios that are representative of the two ends of a spectrum of potential SIP deployments.
                        <br />
<br />

                        
                        In the simplest deployment scenario, a device connects through a network that is controlled by a single provider who provides the local-network, manages the devices, and offers services to the users. The provider propagates profile data to the device that contains all the necessary information to obtain services in the network (including information related to the local-network and the users). This is illustrated in <a class='info' href='#SimpleDeploymentModel'>Figure&nbsp;2<span> (</span><span class='info'>Simple Deployment Model</span><span>)</span></a>. An example is a simple enterprise network that supports SIP-based devices.
                        
			
</p><br /><hr class="insert" />
<a name="SimpleDeploymentModel"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


         --------------
       / Local-network, \
      | Device &amp; Service |
       \    Provider    /
        ----------------
               |
               |
            --------
           | Device |
            --------
               |
               |
             ----
            |User|
             ----


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Simple Deployment Model&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                In more complex deployments, devices connect via a local network that is not controlled by the SIP Service Provider, such as devices that connect via available public WiFi hot spots. In such cases, local network providers may wish to provide local network information such as bandwidth constraints to the devices. 
                                <br />
<br />

                Devices may also be controlled by device providers that are independent of the SIP service provider who provides user services, such as kiosks that allow users to access services from remote locations. In such cases the profile data may have to be obtained from different profile sources: local network provider, device provider and SIP service provider. This is indicated in <a class='info' href='#ComplexDeploymentModel'>Figure&nbsp;3<span> (</span><span class='info'>Complex Deployment Model</span><span>)</span></a> .
		
</p><br /><hr class="insert" />
<a name="ComplexDeploymentModel"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

        --------
      /   SIP    \
     |   Service  |                -&gt; Provides 'user' profile
     |  Provider  |                   data (e.g., services
      \          /                    configuration)
        --------      --------
            |       /          \
            |      |   Device   |  -&gt; Provides 'device' profile
            |      |  Provider  |     data (e.g., device specifics)
            |       \          /
            |         ---------
            |        /
            |       /    -------
            |      /   /  Local  \
            |     /   |  Network  |
            |    |    |  Provider | -&gt; Provides 'local-network' profile
            |    |     \         /     data (e.g., bandwidth)
            |    |       -------
            |    |        /
            |    |       /
            |    |      |
       ===================
      (   Local Network   )
       ===================
               |
               |
            --------
           | Device |              -&gt; Needs the 'local-network'
            --------                  and 'device' profile
            /     \
           /       \
         ------   ------
        |User A| |User B|          -&gt; Users need 'user' profiles
         ------   ------

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Complex Deployment Model&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                <br />
<br />

		In either case, Providers need to deliver to the device, profile data that is required to participate in their network. Examples of profile data include the list of codecs that can be used and the SIP proxies to connect to for services. Pre-configuration of such information is one option if the device is always served by the same set of Providers. In all other cases, the profile delivery needs to be automated and consistent across Providers. Given the presence of a number of large deployments where pre-configuration is neither desired nor optimal, there is a need for a common configuration framework such as the one described in this document.
                <br />
<br />

		Further, the former deployment model can be accomplished by the device obtaining profile data from a single provider. However, the latter deployment model requires the device to obtain profile data from different providers. To address either deployment, or any variation in between, one needs to allow for profile delivery via one, or more, Providers. The framework accomplishes this by specifying multiple profile types and a set of profile delivery stages to obtain them. These are introduced in the sub-sections to follow.
                <br />
<br />

                        
</p>
<a name="ProfileTypes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Profile Types</h3>

<p>
			The framework handles the presence of potentially different Providers by allowing for multiple profile types. Clients request each profile separately, and obtain them from the same, or different, Providers. A deployment can also choose to pre-configure the device to request only a subset of the specified profile types. The framework specifies three basic profile types, as follows:
			<br />
<br />

                        </p>
<blockquote class="text"><dl>
<dt>Local Network Profile:</dt>
<dd>
                                contains configuration data related to the local network to which a device is directly connected, provided by the Local Network Provider.
                                <br />
<br />

                                
</dd>
<dt>Device Profile:</dt>
<dd>
                                contains configuration data related to a specific device, provided by the Device Provider.
                                <br />
<br />

                                
</dd>
<dt>User Profile:</dt>
<dd>
                                contains configuration data related to a specific User, as required to reflect that user's preferences and the particular services subscribed to. It is provided by the SIP Service Provider.
                                <br />
<br />

                                  
</dd>
<dt>Additional profile types may also be specified.</dt>
<dd>
                                  <br />
<br />

                                  
</dd>
</dl></blockquote><p>
			  PDSs and devices will implement all the three profile types. A device that has not been configured otherwise will try to obtain all the three profile types, in the order specified by this framework. A device being bootstrapped SHOULD request the device profile type (see <a class='info' href='#IdentitiesAndCredentials'>Section&nbsp;5.3.1<span> (</span><span class='info'>Bootstrapping Identities and Credentials</span><span>)</span></a> for more information). The device can be configured with a different behavior via profile data previously obtained by the device, or by using other means such as pre-configuration or manual configuration. The data models associated with each profile type are out of scope for this document. Follow-on standardization activities are expected to specify such data models.
			
</p>
<a name="OverviewProfileDeliveryStages"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Profile delivery stages</h3>

<p>
                        The framework specified in this document requires a device to explicitly request profiles. It also requires one or more PDSs which provide the profile data. The processes that lead a device to obtain profile data, and any subsequent changes, can be explained in three stages, termed the profile delivery stages. 
                        <br />
<br />


                        </p>
<blockquote class="text"><dl>
<dt>Profile Enrollment:</dt>
<dd>
                                the process by which a device requests, and if successful, enrolls with a PDS capable of providing a profile. A successful enrollment is indicated by a notification containing the profile information (contents or content indirection information). Depending on the request, this could also result in a subscription to notification of profile changes.
                                <br />
<br />

                                
</dd>
<dt>Profile Content Retrieval:</dt>
<dd>
                                the process by which a device retrieves profile contents, if the profile enrollment resulted in content indirection information.
                                <br />
<br />

                                
</dd>
<dt>Profile Change Notification:</dt>
<dd>
                                the process by which a device is notified of any changes to an enrolled profile. This may provide the device with modified profile data or content indirection information.
                                <br />
<br />

                                
</dd>
</dl></blockquote><p>                
                        
</p>
<a name="UseCases"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Use Cases</h3>

<p>
                        This section provides a small, non-comprehensive set of representative use cases to further illustrate how this Framework can be utilized in SIP deployments. The first use case is simplistic in nature, whereas the second is relatively complex. The use cases illustrate the effectiveness of the framework in either scenario.
                        <br />
<br />

			For Security Considerations please refer to <a class='info' href='#ProfileDeliveryFramework'>Section&nbsp;5<span> (</span><span class='info'>Profile Delivery Framework</span><span>)</span></a> and <a class='info' href='#SecurityConsiderations'>Section&nbsp;9<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>.
                
</p>
<a name="UseCaseDeviceDifferentSPs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Simple Deployment Scenario</h3>

<p>
			Description: Consider a deployment scenario (e.g., a small private enterprise) where a participating device implements this framework and is configured, using previously obtained profile data, to request only the device profile. Assume that the device operates in the same network as the PDS (i.e., there is no NAT) and it obtains its IP configuration using DHCP. Typical communication between the device and the PDS will traverse one or more SIP proxies, but is not required, and is omitted in this illustration.

                        <br />
<br />

<a class='info' href='#UseCase1'>Figure&nbsp;4<span> (</span><span class='info'>Use Case 1</span><span>)</span></a> illustrates the sequence of events that include device startup and a successful profile enrollment for the device profile that results in device profile data. It then illustrates how a change in the profile data is delivered via Profile Change Notification.
                        <br />
<br />


                        <br /><hr class="insert" />
<a name="UseCase1"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


                                      +----------------------+
 +--------+                           |  Provider's Network  |
 | Device |                           |                      |
 |        |                           |                      |
 +--------+                           |  DHCP        PDS     |
                                      +----------------------+
      |                                   |          |
 (A)  |&lt;============== DHCP =============&gt;|          |
      |                                              |
      |                                              |
      |                                              |
 (B)  |&lt;=========== Profile Enrollment  ============&gt;|
      |                                              | Profile data
      |                                              | is modified
      |                                              |
 (C)  |&lt;============ Profile Change  ================|
      |               Notification                   |
      |                                              |
      |                                              |




</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Use Case 1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

                        <br />
<br />

                                The following is an explanation of the interactions in <a class='info' href='#UseCase1'>Figure&nbsp;4<span> (</span><span class='info'>Use Case 1</span><span>)</span></a>.
                        </p>
<blockquote class="text"><dl>
<dt>(A)</dt>
<dd>
                                Upon initialization, the device obtains IP configuration parameters such as IP address using DHCP.
                                
</dd>
<dt>(B)</dt>
<dd>
                                The device requests profile enrollment for the device profile. Successful enrollment provides it with a notification containing the device profile data.
                                
</dd>
<dt>(C)</dt>
<dd>
                                Due to a modification of the device profile, a profile change notification is sent across to the device, along with the modified profile.
                                
</dd>
</dl></blockquote><p>

                        
</p>
<a name="UseCaseDeviceMultipleUsers"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Devices supporting multiple users from different Service Providers</h3>

<p>
                        Description: Consider a single device that allows multiple users to obtain services from different SIP Service Providers, e.g., a kiosk at an airport.

                        <br />
<br />

                                
                        The following assumptions apply:
                        </p>
<ul class="text">
<li>
                                Provider A is the Device and Local Network Provider for the device, and the SIP Service Provider for user A; Provider B is the SIP Service Provider for user B.
                                
</li>
<li>
                                Profile enrollment always results in content indirection information requiring profile content retrieval.
                                
</li>
<li>
                                Communication between the device and the PDSs is facilitated via one or more SIP proxies (only one is shown in the illustration).
                                
</li>
</ul><p>
                        <br />
<br />

<a class='info' href='#UseCase2'>Figure&nbsp;5<span> (</span><span class='info'>Use Case 2</span><span>)</span></a> illustrates the use case and highlights the communications relevant to the framework specified in this document. 
                        <br />
<br />

                        <br /><hr class="insert" />
<a name="UseCase2"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  User User
    A   B        +----------------------+  +----------------------+
 +--------+      |       Provider       |  |       Provider       |
 | Device |      |           A          |  |          B           |
 |        |      |                      |  |                      |
 +--------+      | DHCP    PROXY   PDS  |  |  PROXY        PDS    |
                 +----------------------+  +----------------------+
      |              |        |      |          |           |
  (A) |&lt;====DHCP====&gt;|        |      |          |           |
      |                       |      |          |           |
      |                       |      |          |           |
      |  Profile Enrollment   |      |          |           |
  (B) |&lt;local-network profile&gt;|&lt;====&gt;|          |           |
      |
      |   &lt;&lt;Profile content retrieval&gt;&gt;
      |
      |
      |  Profile Enrollment   |      |          |           |
  (C) |&lt;== device profile ==&gt; |&lt;====&gt;|          |           |
      |
      |   &lt;&lt;Profile content retrieval&gt;&gt;
      |
                   .
                   .
                   .


      |   Profile Enrollment  |      |          |           |
  (D) |&lt;= user profile (A) =&gt; |&lt;====&gt;|          |           |
      |                       |      |          |           |
      |
      |   &lt;&lt;Profile content retrieval&gt;&gt;
                           .
          [[User A obtains services]]
                   .
                   .
                   .

      |
      |            Profile Enrollment           |           |
  (E) |&lt;=========== user profile (B) ==========&gt;|&lt;=========&gt;|
      |                                         |           |
      |   &lt;&lt;Profile content retrieval&gt;&gt;
      |

          [[User B obtains services]]



</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Use Case 2&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

                        The following is an explanation of the interactions in <a class='info' href='#UseCase2'>Figure&nbsp;5<span> (</span><span class='info'>Use Case 2</span><span>)</span></a>. 
                        </p>
<blockquote class="text"><dl>
<dt>(A)</dt>
<dd>
                                Upon initialization, the device obtains IP configuration parameters using DHCP. This also provides the local domain information to help with local-network profile enrollment.
                                
</dd>
<dt>(B)</dt>
<dd>
                                The device requests profile enrollment for the local network profile. It receives an enrollment notification containing content indirection information from Provider A's PDS. The device retrieves the profile (this contains useful information such as firewall port restrictions and available bandwidth).
                                
</dd>
<dt>(C)</dt>
<dd>
                                The device then requests profile enrollment for the device profile. It receives an enrollment notification resulting in device profile content retrieval. The device initializes the user interface for services.
                                
</dd>
<dt>(D)</dt>
<dd>
                                User A with a pre-existing service relationship with Provider A attempts communication via the user Interface. The device uses the user supplied information (including any credential information) and requests profile enrollment for user A's profile. Successful enrollment and profile content retrieval results in services for user A. 
                                
</dd>
<dt>(E)</dt>
<dd>
                                At a different point in time, user B with a service relationship with Provider B attempts communication via the user Interface. It enrolls and retrieves user B's profile and this results in services for user B.
                                
</dd>
</dl></blockquote><p>
                        <br />
<br />

			The discovery mechanisms for profile enrollment described by the framework, or the profile data themselves, can result in outbound proxies that support devices behind NATs, using procedures specified in  <a class='info' href='#RFC5626'>[RFC5626]<span> (</span><span class='info'>Jennings, C., Mahy, R., and F. Audet, &ldquo;Managing Client-Initiated Connections in the Session Initiation Protocol (SIP),&rdquo; October&nbsp;2009.</span><span>)</span></a>.
                        
</p>
<a name="ProfileDeliveryFramework"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Profile Delivery Framework</h3>

<p>
			This section specifies the profile delivery framework. It provides the requirements for the three profile delivery stages introduced in <a class='info' href='#OverviewProfileDeliveryStages'>Section&nbsp;3.4<span> (</span><span class='info'>Profile delivery stages</span><span>)</span></a> and presents the associated security requirements. It also presents considerations such as back-off and retry mechanisms. 
                
</p>
<a name="ProfileDeliveryStages"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Profile delivery stages</h3>

<p>
			The three profile delivery stages - enrollment, content retrieval and change notification - apply separately to each profile type specified for use with this framework. The following sub-sections provide the requirements associated with each stage.
                        
</p>
<a name="ProfileEnrollment"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Profile Enrollment</h3>

<p>
                                Profile enrollment is the process by means of which a device requests, and receives, profile data. Each profile type specified in this document requires an independent enrollment request. However, a particular PDS can support enrollment for one or more profile types.  
                                        <br />
<br />

                                        Profile enrollment consists of the following operations, in the specified order.
                                        <br />
<br />

                                        </p>
<blockquote class="text"><dl>
<dt>Enrollment request transmission</dt>
<dd>
                                                <br />

                                                Profile enrollment is initiated when the device transmits a SIP SUBSCRIBE request <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> for the 'ua-profile' event package, specified in <a class='info' href='#EventPackageDefinition'>Section&nbsp;6<span> (</span><span class='info'>Event Package Definition</span><span>)</span></a>. The profile being requested is indicated using the 'profile-type' parameter. The device MUST transmit the SIP SUBSCRIBE message via configured outbound proxies for the destination domain, or in accordance with RFC 3263 <a class='info' href='#RFC3263'>[RFC3263]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;Session Initiation Protocol (SIP): Locating SIP Servers,&rdquo; June&nbsp;2002.</span><span>)</span></a>. 
                                                <br />
<br />

						The device needs certain data to create an enrollment request, form a Request-URI, and authenticate to the network. This includes the profile provider's domain name, identities and credentials. Such data can be "configured" during device manufacturing, by the user, or via profile data enrollment (see <a class='info' href='#IdentitiesAndCredentials'>Section&nbsp;5.3.1<span> (</span><span class='info'>Bootstrapping Identities and Credentials</span><span>)</span></a>). The data can also be "discovered" using the procedures specified by this framework. The "discovered" data can be retained across device resets (but not across factory resets) and such data is referred to as "cached". Thus, data can be configured, discovered or cached. The following requirements apply. 
                                                <br />
<br />

                                                
<ul class="text">
<li>
								If the device is configured with a specific domain name (for the local network provider or device provider), it MUST NOT attempt "discovery" of the domain name. This is the case when the device is pre-configured (e.g., via a user interface) to be managed by specific entities.
							
</li>
<li>
                                                        The device MUST only use data associated with the provider's domain in an enrollment request. As an example, when the device is requesting a local-network profile in the domain 'example.net', it cannot present a user AoR associated with the local domain 'example.com'.
                                                        
</li>
<li>
                                                        The device SHOULD adhere to the following order of data usage: configured, cached and discovered. An exception is when the device is explicitly configured to use a different order.
                                                        
</li>
</ul>
                                                <br />
<br />

                                                Upon failure to obtain the profile using any methods specified in this framework, the device MAY provide a user interface to allow for user intervention. This can result in temporary, one-time data to bootstrap the device. Such temporary data is not considered to be "configured" and SHOULD NOT not be cached across resets. The configuration obtained using such data MAY provide the configuration data required for the device to continue functioning normally.
                                                <br />
<br />

                                                Devices attempting enrollment MUST comply with the SIP-specific event notification specified in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>, the event package requirements specified in <a class='info' href='#EventPackageParameters'>Section&nbsp;6.2<span> (</span><span class='info'>Event Package Parameters</span><span>)</span></a>, and the security requirements specified in <a class='info' href='#SecuringProfileDelivery'>Section&nbsp;5.2<span> (</span><span class='info'>Securing Profile Delivery</span><span>)</span></a>.
                                                <br />
<br />
<br />

                                                
</dd>
<dt>Enrollment request admittance</dt>
<dd>
                                                <br />

                                                A PDS or a SIP proxy will receive a transmitted enrollment request. If a SIP infrastructure element receives the request, it will relay it to the authoritative proxy for the domain indicated in the Request-URI (the same way it would handle any other SUBSCRIBE message). The authoritative proxy is required to examine the request (e.g., event package) and transmit it to a PDS capable of addressing the profile enrollment request.
                                                <br />
<br />
<br />

                                                A PDS receiving the enrollment request SHOULD respond to the request, or proxy it to a PDS that can respond. An exception to responding or proxying the request is when a policy prevents response (e.g., recognition of a DoS attack, an invalid device, etc.). The PDS then verifies the identity presented in the request and performs any necessary authentication. Once authentication is successful, the PDS MUST either admit or reject the enrollment request, based on applicable authorization policies. A PDS admitting the enrollment request indicates it via a 2xx-class response, as specified in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>. 
                                                <br />
<br />

                                                Refer to <a class='info' href='#NotifierProcessingOfSUBSCRIBERequests'>Section&nbsp;6.6<span> (</span><span class='info'>Notifier Processing of SUBSCRIBE Requests</span><span>)</span></a> and <a class='info' href='#SecuringProfileDelivery'>Section&nbsp;5.2<span> (</span><span class='info'>Securing Profile Delivery</span><span>)</span></a> for more information on subscription request handling and security requirements, respectively.
                                                <br />
<br />
<br />

                                                
</dd>
<dt>Enrollment request acceptance</dt>
<dd>
                                                <br />

                                                A PDS that admits the enrollment request verifies applicable policies, identifies the requested profile data and prepares a SIP NOTIFY message to the device. Such a notification can either contain the profile data or contain content indirection information that results in the device performing profile content retrieval. The PDS then transmits the prepared SIP notification. When the device successfully receives and accepts the SIP notification, profile enrollment is complete. 
                                                <br />
<br />
<br />

                                                When it receives the SIP NOTIFY message, indicating successful profile enrollment, the device SHOULD make the new profile effective within the specified time frame, as described in <a class='info' href='#EventPackageParameters'>Section&nbsp;6.2<span> (</span><span class='info'>Event Package Parameters</span><span>)</span></a>. The exception is when the profile data is delivered via content indirection, and the device cannot obtain the profile data within the specified time frame.
                                                <br />
<br />

                                                Once profile enrollment is successful, the PDS MUST consider the device enrolled for the specific profile, for the duration of the subscription. 
                                                <br />
<br />
<br />

                                                
</dd>
</dl></blockquote><p>
                                
</p>
<a name="ProfileDeliveryContentRetrieval"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
Content Retrieval</h3>

<p>
					A successful profile enrollment leads to an initial SIP notification, and may result in subsequent change notifications. Each of these notifications can either contain profile data, or content indirection information. If it contains content indirection information, the device is required to retrieve the profile data using the specified content retrieval protocols. This process is termed profile content retrieval. For information regarding the use of the SIP NOTIFY message body please refer to <a class='info' href='#NOTIFYBodies'>Section&nbsp;6.5<span> (</span><span class='info'>NOTIFY Bodies</span><span>)</span></a>.
                                <br />
<br />

                                Devices and PDSs implementing this framework MUST implement two content retrieval protocols: HTTP and HTTPS as specified in <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> and <a class='info' href='#RFC2818'>[RFC2818]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>, respectively. Future enhancements or usage of this framework may specify additional or alternative content retrieval protocols.  For security requirements and considerations please refer to <a class='info' href='#SecuringProfileDelivery'>Section&nbsp;5.2<span> (</span><span class='info'>Securing Profile Delivery</span><span>)</span></a>.
                                       
</p>
<a name="ProfileDeliveryChangeNotification"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
Change Notification</h3>

<p>
                                Profile data can change over time. Changes can be initiated by various entities (e.g., via the device, back-office components and end-user web interfaces) and for various reasons (e.g., change in user preferences and modifications to services). Profiles may also be shared by multiple devices simultaneously. When a profile is changed the PDS MUST inform all the devices currently enrolled for the specific profile. This process of informing a device of any changes to the profile that it is currently enrolled for is termed change notification.
                                <br />
<br />

                                The PDS provides change notification using a SIP notification (SIP NOTIFY message as specified in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>). The SIP notification may provide the changes, a revised profile or content indirection which contains a pointer to the revised data. When a device successfully receives a profile change notification for an enrolled profile, it MUST act upon the changes prior to the expiration of the 'effective-by' parameter.
                                <br />
<br />

        
                                For NOTIFY content please refer to <a class='info' href='#NOTIFYBodies'>Section&nbsp;6.5<span> (</span><span class='info'>NOTIFY Bodies</span><span>)</span></a>. 
                                <br />
<br />

                                        
                                       
</p>
<a name="EnrollmentDataDiscoveryAndCaching"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.4"></a><h3>5.1.4.&nbsp;
Enrollment Data and Caching</h3>

<p>
                                The requirements for the contents of the SIP SUBSCRIBE used to request profile enrollment are described in this section. The data required can be configured, cached or discovered - depending on the profile type. If the data is not configured, the device MUST use relevant cached data or proceed with data discovery. This section describes the requirements for creating a SIP SUBSCRIBE for enrollment, the caching requirements and how data can be discovered. 
                                
</p>
<a name="SubscriptionURIForLocalNetworkprofile"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.4.1"></a><h3>5.1.4.1.&nbsp;
Local-Network Profile</h3>

<p>
                                To create a Subscription URI to request the local-network profile a device needs the local network domain name, the device identifier and optionally a user AoR with associated credentials (if one is configured). Since the device can be potentially initialized in a different local-network each time, it SHOULD NOT cache the local network domain, the SIP subscription URI or the local-network profile data across resets. An exception to this is when the device can confirm that it is reinitialized in the same network (using means outside the scope of this document). Thus, in most cases, the device needs to discover the local network domain name. The device discovers this by establishing IP connectivity in the local network (such as via DHCP or pre-configured IP information). Once established, the device MUST attempt to use the local network domain obtained via pre-configuration, if available. If it is not pre-configured, it MUST employ dynamic discovery using DHCPv4 (<a class='info' href='#RFC2132'>[RFC2132]<span> (</span><span class='info'>Alexander, S. and R. Droms, &ldquo;DHCP Options and BOOTP Vendor Extensions,&rdquo; March&nbsp;1997.</span><span>)</span></a>, Domain Name option) or DHCPv6 (<a class='info' href='#RFC4704'>[RFC4704]<span> (</span><span class='info'>Volz, B., &ldquo;The Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Client Fully Qualified Domain Name (FQDN) Option,&rdquo; October&nbsp;2006.</span><span>)</span></a>).  Once the local network domain is obtained, the device creates the SIP SUBSCRIBE for enrollment as described below.
                                </p>
<ul class="text">
<li>
                                        The device MUST NOT populate the user part of the Request-URI. The device MUST set the host portion of the Request-URI to the dot-separated concatenation of "_sipuaconfig" and the local network domain (see example below).
                                        
</li>
<li>
                                        If the device has been configured with a user AoR for the local network domain (verified as explained in <a class='info' href='#SecuringProfileDelivery'>Section&nbsp;5.2<span> (</span><span class='info'>Securing Profile Delivery</span><span>)</span></a>) it MUST use it to populate the "From" field, unless configured not to (due to privacy concerns, for example). Otherwise, the device MUST set the "From" field to a value of "anonymous@anonymous.invalid".
                                        
</li>
<li>
                                        The device MUST include the +sip.instance parameter within the 'Contact' header, as specified in <a class='info' href='#RFC5626'>[RFC5626]<span> (</span><span class='info'>Jennings, C., Mahy, R., and F. Audet, &ldquo;Managing Client-Initiated Connections in the Session Initiation Protocol (SIP),&rdquo; October&nbsp;2009.</span><span>)</span></a>. The device MUST ensure that the value of this parameter is the same as that included in any subsequent profile enrollment request.
                                        
</li>
</ul><p>

                                <br />
<br />


                                 For example, if the device requested and received the local domain name via DHCP to be: airport.example.net, then the local-network Profile SUBSCRIBE Request-URI would look like: 

                                <br />
<br />

                                sip:_sipuaconfig.airport.example.net
                                <br />
<br />


                               The local-network profile SUBSCRIBE Request-URI does not have a user part so that the URI is distinct between the "local" and "device" URIs when the domain is the same for the two.  This provides a means of routing to the appropriate PDS in domains where there are distinct servers.  
                                <br />
<br />

                               
                                The From field is populated with the user AoR, if available. This allows the local network provider to propagate user-specific profile data, if available. The "+sip.instance" parameter within the "Contact" header is set to the device identifier or specifically, the SIP UA instance. Even though every device may get the same (or similar) local-network Profile, the uniqueness of the "+sip.instance" parameter provides an important capability.  Having unique instance ID fields allows the management of the local network to track devices present in the network and consequently also manage resources such as bandwidth allocation.

                                <br />
<br />

                              
</p>
<a name="SubscriptionURIForDeviceProfile"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.4.2"></a><h3>5.1.4.2.&nbsp;
Device Profile Type</h3>

<p>
					       Once associated with a device, the device provider is not expected to change frequently. Thus, the device is allowed to, and SHOULD cache the Subscription URI for the device profile upon successful enrollment. Exceptions include cases where the device identifier has changed (e.g., new network card), device provider information has changed (e.g., user initiated change) or the device cannot obtain its profile using the Subscription URI. Thus, when available, the device MUST use a cached Subscription URI. If no cached URI is available then it needs to create a Subscription URI. To create a Subscription URI, the device needs a device identity and the device provider's domain name. Unless already configured, the device needs to discover the necessary information and form the subscription URI. In such cases, the following requirements apply for creating a Subscription URI for requesting the device profile:
                                <br />
<br />


                                </p>
<ul class="text">
<li>
                                        The device MUST populate the user part of the Request-URI with the device identifier. The device MUST set the host portion of the Request-URI to the domain name of the device provider. The device identifier format is explained in detail later in this section.
                                        
</li>
<li>
                                        The device MUST set the "From" field to a value of anonymous@&lt;device provider's domain&gt;.
                                        
</li>
<li>
                                        The device MUST include the +sip.instance parameter within the 'Contact' header, as specified in <a class='info' href='#RFC5626'>[RFC5626]<span> (</span><span class='info'>Jennings, C., Mahy, R., and F. Audet, &ldquo;Managing Client-Initiated Connections in the Session Initiation Protocol (SIP),&rdquo; October&nbsp;2009.</span><span>)</span></a>. The device MUST use the same value as the one presented while requesting the local-network profile. 
                                        
</li>
</ul><p>
				<br />
<br />

				Note that the discovered AoR for the Request-URI can be overridden by a special, provisioned, AoR that is unique to the device. In such cases, the provisioned AoR is used to form the Request-URI and to populate the From field. 
				<br />
<br />

				If the device is not configured with an AoR, and needs a domain name to populate the Request-URI and the From field, it can either use a configured domain name, if available, or discover it. The options to discover are described below. The device MUST use the results of each successful discovery process for one enrollment attempt, in the order specified below.
                                <br />
<br />

                                </p>
<ul class="text">
<li>
                                        Option 1: Devices that support DHCP MUST attempt to obtain the domain name of the outbound proxy during the DHCP process, using the DHCP option for SIP servers defined in <a class='info' href='#RFC3361'>[RFC3361]<span> (</span><span class='info'>Schulzrinne, H., &ldquo;Dynamic Host Configuration Protocol (DHCP-for-IPv4) Option for Session Initiation Protocol (SIP) Servers,&rdquo; August&nbsp;2002.</span><span>)</span></a> or <a class='info' href='#RFC3319'>[RFC3319]<span> (</span><span class='info'>Schulzrinne, H. and B. Volz, &ldquo;Dynamic Host Configuration Protocol (DHCPv6) Options for Session Initiation Protocol (SIP) Servers,&rdquo; July&nbsp;2003.</span><span>)</span></a> (for IPv4 and IPv6 respectively).
                                
</li>
<li>
					Option 2: Devices that support DHCP MUST attempt to obtain the local IP network domain during the DHCP process (refer to <a class='info' href='#RFC2132'>[RFC2132]<span> (</span><span class='info'>Alexander, S. and R. Droms, &ldquo;DHCP Options and BOOTP Vendor Extensions,&rdquo; March&nbsp;1997.</span><span>)</span></a> and <a class='info' href='#RFC4704'>[RFC4704]<span> (</span><span class='info'>Volz, B., &ldquo;The Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Client Fully Qualified Domain Name (FQDN) Option,&rdquo; October&nbsp;2006.</span><span>)</span></a> ).

                                
</li>
<li>
                                        Option 3: Devices MUST use the local network domain name (configured or discovered to retrieve the local-network profile), prefixing it with the label "_sipuaconfig". 
                                
</li>
</ul><p>
                                <br />
<br />

                               
                                If the device needs to create a subscription URI and needs to use its device identifier, it MUST use the UUID-based URN representation as specified in <a class='info' href='#RFC4122'>[RFC4122]<span> (</span><span class='info'>Leach, P., Mealling, M., and R. Salz, &ldquo;A Universally Unique IDentifier (UUID) URN Namespace,&rdquo; July&nbsp;2005.</span><span>)</span></a>. The following requirements apply:
                                </p>
<ul class="text">
<li>
                                	When the device has a non-alterable MAC address it SHOULD use version 1 UUID representation with the timestamp and clock sequence bits set to a value of '0'. This will allow for easy recognition, and uniqueness of MAC address based UUIDs. An exception is the case where the device supports independent device configuration for more than one SIP UA. An example would be multiple SIP UAs on the same platform.
                                        
</li>
<li>
					If the device cannot use a non-alterable device identifier, it SHOULD use an alternative non-alterable device identifier. For example, the International Mobile Equipment Identity (IMEI) for mobile devices.
					
</li>
<li>
					If the device cannot use a non-alterable MAC Address, it MUST use the same approach as defining a user agent Instance ID in <a class='info' href='#RFC5626'>[RFC5626]<span> (</span><span class='info'>Jennings, C., Mahy, R., and F. Audet, &ldquo;Managing Client-Initiated Connections in the Session Initiation Protocol (SIP),&rdquo; October&nbsp;2009.</span><span>)</span></a>.
                                        
</li>
<li>
                                        Note: when the URN is used as the user part of the Request-URI, it MUST be URL escaped since the colon (":") is not a legal character in the user part of an addr-spec (<a class='info' href='#RFC4122'>[RFC4122]<span> (</span><span class='info'>Leach, P., Mealling, M., and R. Salz, &ldquo;A Universally Unique IDentifier (UUID) URN Namespace,&rdquo; July&nbsp;2005.</span><span>)</span></a>), and must be escaped. 
                                        
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                                <br />

                                                For example, the instance ID: urn:uuid:f81d4fae-7ced-11d0-a765-00a0c91e6bf6@example.com
                                                <br />
<br />

                                                would be escaped to look as follows in a URI: 
                                                <br />
<br />

                                                sip:urn%3auuid%3af81d4fae-7ced-11d0-a765-00a0c91e6bf6@example.com 
                                                <br />
<br />

                                                The ABNF for the UUID representation is provided in <a class='info' href='#RFC4122'>[RFC4122]<span> (</span><span class='info'>Leach, P., Mealling, M., and R. Salz, &ldquo;A Universally Unique IDentifier (UUID) URN Namespace,&rdquo; July&nbsp;2005.</span><span>)</span></a>
                                                
</dd>
</dl></blockquote>
                                        
</li>
</ul><p>
			
                                
</p>
<a name="SubscriptionURIForUserProfiles"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.4.3"></a><h3>5.1.4.3.&nbsp;
User Profile Type</h3>

<p>
					To create a Subscription URI to request the user profile on behalf of a user, the device needs to know the user's AoR. This can be statically or dynamically configured on the device (e.g., user input, or propagated as part of the device profile). Similar to device profiles, the content and propagation of user profiles may differ, based on deployment scenarios (i.e., users belonging to the same domain may - or may not - be provided the same profile). To create a subscription URI, the following rules apply:
                        <br />
<br />

                                		</p>
<ul class="text">
<li>
                                       	 	The device MUST set the Request-URI to the user AoR. 
                                        	
</li>
<li>
                                        	The device MUST populate the "From" field with the user AoR.
                                        	
</li>
</ul><p>
                        		<br />
<br />

					An authoritative SIP proxy for a SIP provider's network that receives a profile enrollment request for the user profile type will route based on the Event Header field values, thus allowing a subscription to the user's AoR to be routed to the appropriate PDS.
					
</p>
<a name="SecuringProfileDelivery"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Securing Profile Delivery</h3>

<p>
				Profile data can contain sensitive information that needs to be secured, such as identities and credentials. Security involves authentication, message integrity and privacy. Authentication is the process by which you verify that an entity is who it claims to be, such as a user AoR presented during profile enrollment. Message integrity provides the assurance that the message contents transmitted between two entities, such as between the PDS and the device, has not been modified during transit. Privacy ensures that the message contents have not been subjected to monitoring by unwanted elements during transit. Authentication and message integrity are required to ensure that the profile contents were received by a valid entity, from a valid source, and without any modifications during transit. For profiles that contain sensitive data, privacy is also required.
                       	<br />
<br />

			For an overview of potential security threats, refer to <a class='info' href='#SecurityConsiderations'>Section&nbsp;9<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>. For information on how the device can be configured with identities and credentials, refer to <a class='info' href='#IdentitiesAndCredentials'>Section&nbsp;5.3.1<span> (</span><span class='info'>Bootstrapping Identities and Credentials</span><span>)</span></a>. The following subsections provide the security requirements associated with each profile delivery stage, and applies to each of profile types specified by this framework.
			
</p>
<a name="SecuringProfileEnrollment"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Securing Profile Enrollment</h3>

<p>
					Profile enrollment may result in sensitive profile data. In such cases, the PDS MUST authenticate the device, except during the bootstrapping scenario when the device does not have existing credentials (see <a class='info' href='#IdentitiesAndCredentials'>Section&nbsp;5.3.1<span> (</span><span class='info'>Bootstrapping Identities and Credentials</span><span>)</span></a> for more information on bootstrapping). Additionally, the device MUST authenticate the PDS to ensure that it is obtaining sensitive profile data from a valid PDS.
                        		<br />
<br />

					To authenticate a device that has been configured with identities and credentials as specified in <a class='info' href='#IdentitiesAndCredentials'>Section&nbsp;5.3.1<span> (</span><span class='info'>Bootstrapping Identities and Credentials</span><span>)</span></a> and support profiles containing sensitive profile data (refer to <a class='info' href='#ProfileData'>Section&nbsp;5.3.4<span> (</span><span class='info'>Profile Data</span><span>)</span></a>), devices and PDSs MUST support Digest Authentication as specified in <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>. Future enhancements may provide other authentication methods such as authentication using X.509 certificates. For the device to authenticate the PDS, the device MUST mutually authenticate with the PDS during digest authentication (device challenges the PDS, which responds with the Authorization header). Transmission of sensitive profile data also requires message integrity. This can be accomplished by configuring the device with, or by ensuring that the discovery process during profile enrollment provides, a SIPS URI resulting in TLS establishment (<a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>). TLS also prevents offline dictionary attacks when digest authentication is used. Thus, in the absence of TLS, the device MUST NOT respond to any authentication challenges. It is to be noted that the digest credentials used for obtaining profile data via this framework may, or may not, be the same as that used for SIP registration (see <a class='info' href='#IdentitiesAndCredentials'>Section&nbsp;5.3.1<span> (</span><span class='info'>Bootstrapping Identities and Credentials</span><span>)</span></a>). 
                        		<br />
<br />

					When the PDS challenges a profile enrollment request, and it fails, the PDS MAY refuse enrollment or provide profile data without the user-specific information (e.g., to bootstrap a device as indicated in <a class='info' href='#IdentitiesAndCredentials'>Section&nbsp;5.3.1<span> (</span><span class='info'>Bootstrapping Identities and Credentials</span><span>)</span></a>). If the device challenges, but fails to authenticate the PDS, it MUST reject the initial notification and retry the profile enrollment process. If the device is configured with, or discovers, a SIPS URI but TLS establishment fails because the next-hop SIP entity does not support TLS, the device SHOULD attempt other resolved next-hop SIP entities.  When the device establishes TLS with the next-hop entity, the device MUST use the procedures specified in <a class='info' href='#RFC2818'>[RFC2818]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>, Section 3.1, for authentication, unless it does not have any configured information (e.g., CA certificate) to perform authentication (like prior to bootstrapping). The 'Server Identity' for authentication is always the domain of the next-hop SIP entity. If the device attempts validation, and it fails, it MUST reject the initial notification and retry profile enrollment. In the absence of a SIPS URI for the device and a mechanism for mutual authentication, the PDS MUST NOT present any sensitive profile data in the initial notification, except when the device is being bootstrapped. It MAY still use content indirection to transmit sensitive profile data.
					
					<br />
<br />

					When a device is being provided with bootstrapping profile data within the notification, and it contains sensitive information, the SIP Identity header SHOULD be used as specified in <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>. This helps with devices that MAY be pre-configured with certificates to validate bootstrapping sources (e.g., list of allowed domain certificates, or a list of root CA certificates using PKI). When the SIP Identity header is used, the PDS MUST set the host portion of the AoR in the 'From' header to the Provider's domain (the user portion is a entity-specific identifier). If the device is capable of validating the SIP Identity, and it fails, it MUST reject bootstrapping profile data.
				   
</p>
<a name="SecuringContentRetrieval"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Securing Content Retrieval</h3>

<p>
                                        Initial or change notifications following a successful enrollment can provide a device with the requested profile data, or use content indirection to direct it to a PCC that can provide the profile data. This document specifies HTTP and HTTPS as content retrieval protocols. 

                                        <br />
<br />


					If the profile is provided via content indirection and contains sensitive profile data then the PDS MUST use a HTTPS URI for content indirection. PCCs and devices MUST NOT use HTTP for sensitive profile data, except for bootstrapping a device via the device profile. A device MUST authenticate the PCC as specified in <a class='info' href='#RFC2818'>[RFC2818]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>, Section 3.1. A device that is being provided with profile data that contains sensitive data MUST be authenticated using digest authentication as specified in <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>, with the exception of a device that is being bootstrapped for the first time via the device profile. The resulting TLS channel also provides message integrity and privacy.
                                
</p>
<a name="SecuringChangeNotification"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.3"></a><h3>5.2.3.&nbsp;
Securing Change Notification</h3>

<p>
				If the device requested enrollment via a SIP subscription with a non-zero 'Expires' parameter, it can also result in change notifications for the duration of the subscription. For change notifications containing sensitive profile data, this framework RECOMMENDS the use of the SIP Identity header as specified in <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>. When the SIP Identity header is used, the PDS MUST set the host portion of the AoR in the 'From' header to the Provider's domain (the user portion is a entity-specific identifier). This provides header and body integrity as well. However, for sensitive profile data requiring privacy, if the contact URI to which the NOTIFY request is to be sent is not SIPS, the PDS MUST use content indirection. Additionally, the PDS MUST also use content indirection for notifications containing sensitive profile data, when the profile enrollment was not authenticated.
                                
</p>
<a name="AdditionalConsiderations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Additional Considerations</h3>

<p>
   This section provides additional considerations such as details on how a device obtains identities and credentials, backoff and retry methods, guidelines on profile data and additional profile types.  
                                
</p>
<a name="IdentitiesAndCredentials"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
Bootstrapping Identities and Credentials</h3>

<p>
                                When requesting a profile the profile delivery server will likely require the device to provide an identity (i.e., a user AoR), and associated credentials for authentication. During this process (e.g., digest authentication), the PDS is also required to present its knowledge of the credentials to ensure mutual authentication (see <a class='info' href='#SecuringProfileEnrollment'>Section&nbsp;5.2.1<span> (</span><span class='info'>Securing Profile Enrollment</span><span>)</span></a>). For mutual authentication with the PDS, the device needs to be provided with the necessary identities and credentials (e.g., username/password, certificates). This is done via bootstrapping. For a discussion around the security considerations related to bootstrapping, please see <a class='info' href='#SCForDeviceProfile'>Section&nbsp;9.2<span> (</span><span class='info'>Device profile</span><span>)</span></a>.

                                <br />
<br />


Bootstrapping a device with the required identities and credentials can be accomplished in one of the following ways:
        
                                <br />
<br />

                                 </p>
<blockquote class="text"><dl>
<dt>Pre-configuration</dt>
<dd>
                                        <br />

                                         The device may be pre-configured with identities and associated credentials, such as a user AoR and digest password.
                                        <br />
<br />
<br />

                                        
</dd>
<dt>Out-of-band methods</dt>
<dd>
                                        <br />

					A device or Provider may provide hardware- or software-based credentials such as SIM cards or Universal Serial Bus (USB) drives.
                                        <br />
<br />
<br />

                                        
</dd>
<dt>End-user interface</dt>
<dd>
                                        <br />

                                        The end-user may be provided with the necessary identities and credentials. The end-user can then configure the device (using a user interface), or present when required (e.g., IM login screen). 
                                        <br />
<br />
<br />

                                        
</dd>
<dt>Using this framework</dt>
<dd>
                                        <br />

                                        When a device is initialized, even if it has no pre-configured information, it can request the local-network and device profiles. For purposes of bootstrapping, this framework recommends that the device profile provide one of the following to bootstrap the device:
                                                 
<ul class="text">
<li>
                                                        Profile data that allows the end-user to communicate with the device provider or SIP service provider using non-SIP methods. For example, the profile data can direct the end-user to a web portal to obtain a subscription. Upon obtaining a successful subscription, the end-user or the device can be provided with the necessary identities and credentials.
                                                        
</li>
<li>
                                                        Content indirection information to a PCC that can provide identities and credentials. As an example, consider a device that has a X.509 certificate that can be authenticated by the PCC. In such a case, the PCC can use HTTPS to provide identities and associated credentials.
                                                        
</li>
<li>
								Profile data containing identities and credentials that can be used to bootstrap the device (see <a class='info' href='#ProfileData'>Section&nbsp;5.3.4<span> (</span><span class='info'>Profile Data</span><span>)</span></a> for profile data recommendations). This can be used in cases where the device is initialized for the first time, or after a factory reset. This can be considered only in cases where the device is initialized in the Provider's network, for obvious security reasons.
                                                        
</li>
</ul>
                                        
</dd>
</dl></blockquote><p>
                                <br />
<br />
<br />
<br />

        
                                Additionally, AoRs are typically known by PDSs that serve the domain indicated by the AoR. Thus, devices can only present the configured AoRs in the respective domains. An exception is the use of federated identities. This allows a device to use a user's AoR in multiple domains. Further even within the same domain, the device's domain proxy and the PDS may be in two different realms, and as such may be associated with different credentials for digest authentication. In such cases, multiple credentials may be configured, and associated with the realms in which they are to be used. This framework specifies only  digest authentication for profile enrollment and the device is not expected to contain any other credentials. For profile retrieval using content indirection, the device will need to support additional credentials such as X.509 certificates (for TLS). Future enhancements can specify additional credential types for profile enrollment and retrieval.
        
                                <br />
<br />

                                
        
                                
</p>
<a name="ProfileEnrollmentRequestAttempt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
Profile Enrollment Request Attempt</h3>

<p>
   A state diagram representing a device requesting any specific profile defined by this framework is shown in <a class='info' href='#StateDiagram'>Figure&nbsp;6<span> (</span><span class='info'>Device State Diagram</span><span>)</span></a>. 
                 
                                        <br /><hr class="insert" />
<a name="StateDiagram"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


                             +------------+
                             | Initialize |
                             +-----+------+
                                   |
                                   |
                                   V
                            +-------------+
                            |   Prepare   |
                 +---------&gt;|  Enrollment |&lt;------------------+
                 |          |   Request   |                   |
                 |          +------+------+                   |
          +------+------+          |                          |
          |   Failure   | Enroll. Req. prepared               |
      +--&gt;|  Handling &amp; |      /Send Req                      |
      |   |   Delay     |          |                          |
      |   +-------------+          V                          |
      |       ^    ^        +-------------+                   |
      |       |    |        |    Await    |                   |
      |       |    +--------+  Enrollment |                   |
      |       |    Timeout, |  acceptance |                   |
      |       |   non-2xx/- +------+------+                   |
      |       |                    |                          |
      |   Timeout            200 OK/-                    Enrollment
      |  /Terminate                |                       Timeout/-
      |   Enrollment               V                          |
      |       |            +--------------+                   |
      |       |            |  Enrollment  |                   |
      |       +------------+   accepted   |                   |
 Retries Exceeded          |(await NOTIFY)|                   |
/Retry Enrollment          +---+------+---+                   |
      |                        |      |                       |
      |                        |      |                       |
      |   NOTIFY w. Content Ind|      |  NOTIFY w. Profile    |
      |     /Retrieve Profile  |      |  /Accept Profile      |
      |           +------------+      +------------+          |
      |           |                                |          |
      |           V                                V          |
      |     +------------+                   +------------+   |
      +-----+ Retrieving |    Retrieved      | Enrollment +---+
         ,-&gt;|   Profile  +--/Apply Profile--&gt;| Successful |
        /   |            |                   |(monitoring)|&lt;--.
   Timeout  +--+---------+                   +--+----+----+    :
   /Retry      ;      ^                         |    :         ;
        `------'      |   NOTIFY w. Cont.Ind    |    `-------'
                      +---/Retrieve Profile-----+   NOTIFY w. Profile
                                                       /Apply Profile


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: Device State Diagram&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


As a reminder:
                                        </p>
<ul class="text">
<li>
                                                The timeout for SIP messages is specified by <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>. In the cases where this is not specified such as the timeout to wait for the initial notification during profile enrollment, it is left to device implementations or future protocol enhancements. 
                                                
</li>
<li>
                                                The timeout for profile retrieval using content indirection will be as specified by profile retrieval protocols employed. If none exists, it is left to device implementations.
                                                
</li>
</ul><p>  
                                	<br />
<br />


In addition, since profile enrollment is a process unique to this framework, the device MUST follow the enrollment attempt along with exponential backoff and retry mechanisms as indicated in <a class='info' href='#ProfileEnrollmentAttempt_pseudo-code'>Figure&nbsp;7<span> (</span><span class='info'>Profile Enrollment Attempt (pseudo-code)</span><span>)</span></a>.
                                        <br /><hr class="insert" />
<a name="ProfileEnrollmentAttempt_pseudo-code"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  Function for Profile Enrollment ()

     Init Function: Iteration i=0

     Loop 1: Attempt

          Loop 2: For each SIP Subscription URI

               Loop 3: For each next-hop SIP entity

                  - Prepare &amp; transmit Enrollment Request

                  - Await Enrollment Acceptance and initial NOTIFY

                  + If the profile enrollment is successful
                    = Exit this function()

                  + If profile enrollment fails due to an explicit
                    failure or a timeout as specified in RFC3261
                    = Continue with the next-hop SIP entity (Loop 3)

               End Loop: Loop 3

          End Loop: Loop 2

          (Note: If you are here, profile enrollment did not succeed)

          + Is any valid cached profile data available?
            = If yes, use it and continue with Loop 1

          + If the enrollment request is for a non-mandatory profile
            = Start profile enrollment for the next profile,
              if applicable

          - Delay for 2^i*(64*T1); -- this is exponential backoff

          - increment i;

          - If i&gt;8, reset i=8;

    End loop: Loop 1

End Function()

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: Profile Enrollment Attempt (pseudo-code)&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

                                        The pseudo-code above (<a class='info' href='#ProfileEnrollmentAttempt_pseudo-code'>Figure&nbsp;7<span> (</span><span class='info'>Profile Enrollment Attempt (pseudo-code)</span><span>)</span></a>) allows for cached profiles to be used. However, any cached Local Network profile MUST NOT be used unless the device can ensure that it is in the same local network which provided the cached data. This framework does not provide any procedures for local network recognition. Any cached device and user profiles MUST only be used in domains that they are associated with. For example, a cached device profile is used only when the associated domain matches the current device provider's domain. If a PDS wants to invalidate a profile it may do so by transmitting a NOTIFY with an 'empty profile', i.e.,  profile instance without any included data (if supported by the profile data model; not to be confused with an empty NOTIFY), or via an explicit profile data element that invalidates the data. A device receiving such a NOTIFY MUST discard the applicable profile (i.e., it cannot even store it in the cache). Additionally, if a factory reset is available and performed on a device, it MUST reset the device to its initial state prior to any configuration. Specifically, the device MUST set the device back to the state when it was originally distributed.
                                        <br />
<br />

                                        The order of profile enrollment is important. For the profiles specified in this framework, the device must enroll in the following default order: local-network, device and user. The pseudo-code presented earlier (<a class='info' href='#ProfileEnrollmentAttempt_pseudo-code'>Figure&nbsp;7<span> (</span><span class='info'>Profile Enrollment Attempt (pseudo-code)</span><span>)</span></a>) differentiates between 'mandatory' and 'non-mandatory' profiles. This distinction is left to profile data definitions. 
					<br />
<br />

					It is to be noted that this framework does not allow the devices to inform the PDSs of profile retrieval errors such as invalid data.  Follow-on standardization activities are expected to address this feature.
                                        
</p>
<a name="DeviceTypes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.3"></a><h3>5.3.3.&nbsp;
Device Types</h3>

<p>
The examples in this framework tend to associate devices with entities that are accessible to end-users.  However, this is not necessarily the only type of device that can utilize the specified Framework.  Devices can be entities such as SIP Phones or soft clients, with or without user interfaces (that allow for device Configuration), entities in the network that do not directly communicate with any users (e.g., gateways, media servers, etc) or network infrastructure elements e.g., SIP servers).
                                
</p>
<a name="ProfileData"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.4"></a><h3>5.3.4.&nbsp;
Profile Data</h3>

<p>
                                                This framework does not specify the contents for any profile type. Follow-on standardization activities are expected to address profile contents. However, the framework provides the following requirements and recommendations for profile data definitions:
                                <br />
<br />


                                                </p>
<ul class="text">
<li>
								The device profile type SHOULD specify parameters to configure the identities and credentials for use in scenarios such as bootstrapping (see <a class='info' href='#IdentitiesAndCredentials'>Section&nbsp;5.3.1<span> (</span><span class='info'>Bootstrapping Identities and Credentials</span><span>)</span></a>) and run-time modifications to identities and credentials. This framework recommends the device profile to provide the identities and credentials due to a couple of reasons. The local-network profile may not always be available, and even if present, may not be controlled by the device provider who controls device configuration to provide services. Further, the device may not have any users configured prior to being bootstrapped, resulting in an absence of user profile requests. However, this framework does not prevent other profile types from providing identities and credentials to meet deployment needs. For example, the user profile can contain identities and credentials for communicating with specific applications.
                                                        
</li>
<li>
                                                        Each profile MUST clearly identify if it may contain any sensitive data. Such profiles MUST also identify the data elements that are considered sensitive, i.e., data that cannot be compromised. As an example, a device profile definition may identify itself as containing sensitive data and indicate data such as device credentials to be sensitive.
                                                        
</li>
<li>
                                                        When the device receives multiple profiles, the contents of each profile type SHOULD only contain data relevant to the entity it represents. As an example, consider a device that obtains all the defined profiles. Information pertaining to the local network is contained in the 'local-network' profile and not the 'user' profile. This does not preclude relevant data about a different entity from being included in a profile type, e.g., the 'device' profile type may contain information about the users allowed to access services via the device. A profile may also contain starting information to obtain subsequent Profiles.
                                                        
</li>
<li>
                                                        Data overlap SHOULD be avoided across profile types, unless necessary. If data overlap is present, prioritization of the data is left to data definitions. As an example, the device profile may contain the list of codecs to be used by the device and the user Profile (for a user on the device) may contain the codecs preferred by the user. Thus, the same data (usable codecs) is present in two profiles. However, the data definitions may indicate that to function effectively, any codec chosen for communication needs to be present in both the profiles.
                                                        
</li>
</ul><p>
                                
</p>
<a name="ProfileDataFrameworks"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.5"></a><h3>5.3.5.&nbsp;
Profile Data Frameworks</h3>

<p>
                                The framework specified in this document does not address profile data representation, storage or retrieval protocols. It assumes that the PDS has a PCC based on existing or other Profile Data Frameworks. 
                                <br />
<br />


                                While this framework does not impose specific constraints on any such framework, it does allow for the propagation of profile content to the PDS (specifically the PCC) from a network element or the device. Thus, Profile Data or Retrieval frameworks used in conjunction with this framework MAY consider techniques for propagating incremental, atomic changes to the PDS. One means for propagating changes to a PDS is defined in XCAP (<a class='info' href='#RFC4825'>[RFC4825]<span> (</span><span class='info'>Rosenberg, J., &ldquo;The Extensible Markup Language (XML) Configuration Access Protocol (XCAP),&rdquo; May&nbsp;2007.</span><span>)</span></a>).

                                <br />
<br />

                                
</p>
<a name="AdditionalProfileTypes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.6"></a><h3>5.3.6.&nbsp;
Additional Profile Types</h3>

<p>
                                        This document specifies three profile types: local-network, device and user. However, there may be use cases for additional profile types. e.g., profile types for application specific profile data or to provide enterprise-specific policies. Definition of such additional profile types is not prohibited, but considered out of scope for this document. Such profile definitions MUST specify the order of retrieval with respect to all the other profiles such as the local-network, device and user profile types defined in this document.
                                        
</p>
<a name="EntityRelationships"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.7"></a><h3>5.3.7.&nbsp;
Deployment considerations</h3>

<p>
                                        The framework defined in this document was designed to address various deployment considerations, some of which are highlighted below.
                                                
                                        <br />
<br />


                                        Provider relationships:
                                        </p>
<ul class="text">
<li>
                                                The local network provider and the SIP service provider can often be different entities, with no administrative or business relationship with each other.  
                                                
</li>
<li>
                                                There may be multiple SIP service providers involved, one for each service that a user subscribes to (telephony service, instant messaging, etc.); this Framework does not specify explicit behavior in such a scenario, but it does not prohibit its usage either.
                                                
</li>
<li>
                                                Each user accessing services via the same device may subscribe to different sets of services, from different Service Providers.
                                                
</li>
</ul><p>

                                        <br />
<br />


                                        User-device relationship:
                                        </p>
<ul class="text">
<li>
                                                The relationship between devices and users can be many-to-many (e.g., a particular device may allow for many users to obtain subscription services through it, and individual users may have access to multiple devices).
                                                
</li>
<li>
                                                Each user may have different preferences for use of services, and presentation of those services in the device user interface.
                                                
</li>
<li>
                                                Each user may have different personal information applicable to use of the device, either as related to particular services, or independent of them. 
                                                
</li>
</ul><p>
                                        
</p>
<a name="OutboundUsage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Support for NATs</h3>

<p>
					PDSs that support devices behind NATs, and devices that can be behind NATs can use procedures specified in <a class='info' href='#RFC5626'>[RFC5626]<span> (</span><span class='info'>Jennings, C., Mahy, R., and F. Audet, &ldquo;Managing Client-Initiated Connections in the Session Initiation Protocol (SIP),&rdquo; October&nbsp;2009.</span><span>)</span></a>. The Outbound proxies can be configured or discovered. Clients that support such behavior MUST include the 'outbound' option-tag in a Supported header field value, and add the "ob" parameter as specified in <a class='info' href='#RFC5626'>[RFC5626]<span> (</span><span class='info'>Jennings, C., Mahy, R., and F. Audet, &ldquo;Managing Client-Initiated Connections in the Session Initiation Protocol (SIP),&rdquo; October&nbsp;2009.</span><span>)</span></a> within the SIP SUBSCRIBE for profile enrollment.
				
</p>
<a name="EventPackageDefinition"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Event Package Definition</h3>

<p>
                                The framework specified in this document proposes and specifies a new SIP Event Package as allowed by <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>. The purpose is to allow for devices to subscribe to specific profile types with PDSs and for the PDSs to notify the devices with the profile data or content indirection information. 
                                <br />
<br />

                                                The requirements specified in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> apply to this package. The following sub-sections specify the Event Package description and the associated requirements. The framework requirements are defined in <a class='info' href='#ProfileDeliveryFramework'>Section&nbsp;5<span> (</span><span class='info'>Profile Delivery Framework</span><span>)</span></a>.
                                <br />
<br />


                
</p>
<a name="EventPackageName"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Event Package Name</h3>

<p>
                        The name of this package is "ua-profile". This value appears in the Event header field present in SUBSCRIBE and NOTIFY requests for this package as defined in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>.
                        
</p>
<a name="EventPackageParameters"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Event Package Parameters</h3>

<p>
                                                

                        This package defines the following new parameters for the event header: 

                         </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                "profile-type", "vendor", "model", "version", and "effective-by"
                                
</dd>
</dl></blockquote><p>

                        <br />
<br />

                        The following rules apply:
                        </p>
<ul class="text">
<li>
                                All the new parameters, with the exception of the "effective-by" parameter MUST only be used in SUBSCRIBE requests and ignored if they appear in NOTIFY requests.
                                
</li>
<li>
                                The "effective-by" parameter is for use in NOTIFY requests only and MUST be ignored if it appears in SUBSCRIBE requests.
                                
</li>
</ul><p>
                        <br />
<br />

                        The semantics of these new parameters are specified in the following sub-sections.
                        <br />
<br />


                        
</p>
<a name="ProfileTypeParameterUsage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.1"></a><h3>6.2.1.&nbsp;
profile-type</h3>

<p>
                                The "profile-type" parameter is used to indicate the token name of the profile type the user agent wishes to obtain and to be notified of subsequent changes. This document defines three logical types of profiles and their token names. They are as follows:
                                <br />
<br />

                                 </p>
<blockquote class="text"><dl>
<dt>local-network:</dt>
<dd>
                                        specifying the "local-network" type profile indicates the desire for profile data, and potentially, profile change notifications specific to the local network.  
                                        <br />

                                        
</dd>
<dt>device:</dt>
<dd>
                                        specifying the "device" type profile(s) indicates the desire for the profile data, and potentially, profile change notification that is specific to the device or user agent.  
                                        <br />

                                        
</dd>
<dt>user:</dt>
<dd>
                                        Specifying "user" type profile indicates the desire for the profile data, and potentially, profile change notification specific to the user.  
                                        <br />

                                        
</dd>
</dl></blockquote><p>
                                <br />
<br />

				The profile type is identified in the Event header parameter: "profile-type". A separate SUBSCRIBE dialog is used for each profile type. Thus, the subscription dialog on which a NOTIFY arrives implies which profile's data is contained in, or referred to, by the NOTIFY message body. The Accept header of the SUBSCRIBE request MUST include the MIME types for all profile content types for which the subscribing user agent wishes to retrieve profiles, or receive change notifications.  
                                <br />
<br />


                                In the following syntax definition using ABNF, EQUAL and token are defined in <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>. It is to be noted that additional profile types may be defined in subsequent documents. 
                                <br />
<br />


                                </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Profile-type   = "profile-type" EQUAL profile-value
profile-value  =  profile-types / token
profile-types  = "device" / "user" / "local-network"
</pre></div><p>


                                The "device", "user" or "local-network" token in the profile-type parameter may represent a class or set of profile properties. Follow-on standards defining specific profile contents may find it desirable to define additional tokens for the profile-type parameter.  Also, additional content types may be defined along with the profile formats that can be used in the Accept header of the SUBSCRIBE to filter or indicate what data sets of the profile are desired.
                                <br />
<br />

                                
</p>
<a name="VendorModelVersionParametersUsage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.2"></a><h3>6.2.2.&nbsp;
vendor, model and version</h3>

<p>
                                The "vendor", "model" and "version" parameter values are tokens specified by the implementer of the user agent.  These parameters MUST be provided in the SUBSCRIBE request for all profile types.  The implementer SHOULD use their DNS domain name (e.g., example.com) as the value of the "vendor" parameter so that it is known to be unique.  These parameters are useful to the PDS to affect the profiles provided.  In some scenarios it is desirable to provide different profiles based upon these parameters.  e.g., feature property X in a profile may work differently on two versions of the same user agent.  This gives the PDS the ability to compensate for or take advantage of the differences.  In the following ABNF defining the syntax, EQUAL and quoted-string are defined in <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>.

                                <br />
<br />


                                </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Vendor       =  "vendor" EQUAL quoted-string
Model        =  "model" EQUAL quoted-string
Version      =  "version" EQUAL quoted-string
</pre></div><p>


                                <br />
<br />

                                
                                
</p>
<a name="EffectiveByParameterUsage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.3"></a><h3>6.2.3.&nbsp;
effective-by parameter</h3>

<p>
                                The "effective-by" parameter in the Event header of the NOTIFY request specifies the maximum number of seconds before the user agent must attempt to make the new profile effective.  The "effective-by" parameter MAY be provided in the NOTIFY request for any of the profile types.  A value of 0 (zero) indicates that the subscribing user agent must attempt to make the profiles effective immediately (despite possible service interruptions).  This gives the PDS the power to control when the profile is effective.  This may be important to resolve an emergency problem or disable a user agent immediately.  If it is absent, the device SHOULD attempt to make the profile data effective at the earliest possible opportunity that does not disrupt any services being offered. The "effective-by" parameter is ignored in all messages other than the NOTIFY request.  In the following ABNF, EQUAL and DIGIT are defined in <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>.
                                </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Effective-By =  "effective-by" EQUAL 1*DIGIT
</pre></div><p>

                                
</p>
<a name="Summary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.4"></a><h3>6.2.4.&nbsp;
Summary of event parameters</h3>

<p>
                                The following are example Event headers which may occur in SUBSCRIBE requests.  These examples are not intended to be complete SUBSCRIBE requests.

                                        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Event: ua-profile;profile-type=device;
       vendor="vendor.example.com";model="Z100";version="1.2.3"

Event: ua-profile;profile-type=user;
       vendor="premier.example.com";model="trs8000";version="5.5"
</pre></div><p>

       
                                        The following are example Event headers which may occur in NOTIFY requests.  These example headers are not intended to be complete SUBSCRIBE requests.


                                        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Event: ua-profile;effective-by=0

Event: ua-profile;effective-by=3600
</pre></div><p>


                                        The following table shows the use of Event header parameters in SUBSCRIBE requests for the three profile types:

                                        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
profile-type || device | user | local-network
=============================================
vendor       ||   m    |  m   |        m
model        ||   m    |  m   |        m
version      ||   m    |  m   |        m
effective-by ||        |      |

m - mandatory
s - SHOULD be provided
o - optional
</pre></div><p>

Non-specified means that the parameter has no meaning and should be ignored.

                                        <br />
<br />


                                        The following table shows the use of Event header parameters in NOTIFY requests for the three profile types:

                                        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
profile-type || device | user | local-network
=============================================
vendor       ||        |      |
model        ||        |      |
version      ||        |      |
effective-by ||   o    |  o   |        o
</pre></div><p>

                                
</p>
<a name="SUBSCRIBEBodies"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
SUBSCRIBE Bodies</h3>

<p>
                                                                This package defines no use of the SUBSCRIBE request body. If present, it SHOULD be ignored. Exceptions include future enhancements to the framework which may specify a use for the SUBSCRIBE request body.
                        
                        
</p>
<a name="SubscriptionDuration"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Subscription Duration</h3>

<p>
                                                The duration of a subscription is specific to SIP deployments and no specific recommendation is made by this Event Package. If absent, a value of 86400 seconds (24 hours; 1 day) is RECOMMENDED since the presence (or absence) of a device subscription is not time critical to the regular functioning of the PDS.
                                                <br />
<br />


                                                It is to be noted that a one-time fetch of a profile, without ongoing subscription, can be accomplished by setting the 'Expires' parameter to a value of Zero, as specified in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>.
                        
</p>
<a name="NOTIFYBodies"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
NOTIFY Bodies</h3>

<p>
                                                        The framework specifying the Event Package allows for the NOTIFY body to contain the profile data, or a pointer to the profile data using content indirection. For profile data delivered via content indirection, i.e., a pointer to a PCC, then the Content-ID MIME header, as described in <a class='info' href='#RFC4483'>[RFC4483]<span> (</span><span class='info'>Burger, E., &ldquo;A Mechanism for Content Indirection in Session Initiation Protocol (SIP) Messages,&rdquo; May&nbsp;2006.</span><span>)</span></a> MUST be used for each Profile document URI. At a minimum, the "http:" <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> and "https:" <a class='info' href='#RFC2818'>[RFC2818]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> URI schemes MUST be supported; other URI schemes MAY be supported based on the Profile Data Frameworks (examples include FTP <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a>, LDAP <a class='info' href='#RFC4510'>[RFC4510]<span> (</span><span class='info'>Zeilenga, K., &ldquo;Lightweight Directory Access Protocol (LDAP): Technical Specification Road Map,&rdquo; June&nbsp;2006.</span><span>)</span></a> and XCAP <a class='info' href='#RFC4825'>[RFC4825]<span> (</span><span class='info'>Rosenberg, J., &ldquo;The Extensible Markup Language (XML) Configuration Access Protocol (XCAP),&rdquo; May&nbsp;2007.</span><span>)</span></a> ).
                                <br />
<br />

                                                        
                                                A non-empty NOTIFY body MUST include a MIME type specified in the 'Accept' header of the SUBSCRIBE. Further, if the Accept header of the SUBSCRIBE included the MIME type message/external-body (indicating support for content indirection) then the PDS MAY use content indirection in the NOTIFY body for providing the profiles. 
                                <br />
<br />

                        
</p>
<a name="NotifierProcessingOfSUBSCRIBERequests"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
Notifier Processing of SUBSCRIBE Requests</h3>

<p>
                        A successful SUBSCRIBE request results in a NOTIFY with either profile contents or a pointer to it (via Content Indirection). The SUBSCRIBE SHOULD be either authenticated, or transmitted over an integrity protected SIP communications channel. Exceptions include cases where the identity of the Subscriber is unknown and the Notifier is configured to accept such requests. 
                        <br />
<br />


                        The Notifier MAY also authenticate SUBSCRIBE messages even if the NOTIFY is expected to only contain a pointer to profile data. Securing data sent via Content Indirection is covered in <a class='info' href='#SecurityConsiderations'>Section&nbsp;9<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>.
                        <br />
<br />


			If the profile type indicated in the "profile-type" Event header parameter is unavailable or the Notifier is configured not to provide it, the Notifier SHOULD return a 404 response to the SUBSCRIBE request. If the specific user or device is unknown, the Notifier MAY accept the subscription, or else it may reject the subscription (with a 403 response). 
                        <br />
<br />


                        
</p>
<a name="NotifierGenerationOfNOTIFYRequests"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7"></a><h3>6.7.&nbsp;
Notifier Generation of NOTIFY Requests</h3>

<p>
                        As specified in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>, the Notifier MUST always send a NOTIFY request upon accepting a subscription. If the device or user is unknown and the Notifier chooses to accept the subscription, the Notifier MAY either respond with profile data (e.g., default profile data) or provide no profile information (i.e., empty NOTIFY). 
                        <br />
<br />


                        If the identity indicated in the SUBSCRIBE request (From header) is a known identity and the requested profile information is available (i.e. as specified in the profile-type parameter of the Event header), the Notifier SHOULD send a NOTIFY with profile data. Profile data MAY be sent as profile contents or via Content Indirection (if the content indirection MIME type was included in the Accept header). The Notifier MUST NOT use any scheme that was not indicated in the "schemes" Contact header field. 
                        <br />
<br />


                        The Notifier MAY specify when the new profiles must be made effective by the Subscriber by specifying a maximum time in seconds (zero or more) in the "effective-by" event header parameter.
                        <br />
<br />


                        If the SUBSCRIBE was received over an integrity protected SIP communications channel, the Notifier SHOULD send the NOTIFY over the same channel. 
                        
</p>
<a name="SubscriberProcessingOfNOTIFYRequests"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.8"></a><h3>6.8.&nbsp;
Subscriber Processing of NOTIFY Requests</h3>

<p>
                        A Subscriber to this event package MUST adhere to the NOTIFY request processing behavior specified in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>. If the Notifier indicated an effective time (using the "effective-by" Event Header parameter), the Subscriber SHOULD attempt to make the profiles effective within the specified time. Exceptions include deployments that prohibit such behavior in certain cases (e.g., emergency sessions are in progress). When profile data cannot be applied within the recommended time frame and this affects device behavior, any actions to be taken SHOULD be defined by the profile data definitions. By default, the Subscriber is RECOMMENDED to make the profiles effective as soon as possible. 
                        <br />
<br />


                        When accepting content indirection, the Subscriber MUST always support "http:" or "https:" and be prepared to accept NOTIFY messages with those URI schemes. If the Subscriber wishes to support alternative URI schemes they MUST each be indicated in the "schemes" Contact header field parameter as defined in <a class='info' href='#RFC4483'>[RFC4483]<span> (</span><span class='info'>Burger, E., &ldquo;A Mechanism for Content Indirection in Session Initiation Protocol (SIP) Messages,&rdquo; May&nbsp;2006.</span><span>)</span></a>. The Subscriber MUST also be prepared to receive a NOTIFY request with no body. The subscriber MUST NOT reject the NOTIFY request with no body. The subscription dialog MUST NOT be terminated by a empty NOTIFY, i.e., with no body. 
                        <br />
<br />


                        
</p>
<a name="HandlingOfForkedRequests"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.9"></a><h3>6.9.&nbsp;
Handling of Forked Requests</h3>

<p>
                                This Event package allows the creation of only one dialog as a result of an initial SUBSCRIBE request as described in section 4.4.9 of <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>. It does not support the creation of multiple subscriptions using forked SUBSCRIBE requests.
                        
</p>
<a name="RateOfNotifications"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.10"></a><h3>6.10.&nbsp;
Rate of Notifications</h3>

<p>
                                The rate of notifications for the profiles in this framework is deployment specific, but expected to be infrequent. Hence, the Event Package specification does not specify a throttling or minimum period between NOTIFY requests 
                       
</p>
<a name="StateAgents"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.11"></a><h3>6.11.&nbsp;
State Agents</h3>

<p>
                                State agents are not applicable to this Event Package.
                        
</p>
<a name="FrameworkExamples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Examples</h3>

<p>
                This section provides examples along with sample SIP message bodies relevant to this framework. Both the examples are derived from the use case illustrated in <a class='info' href='#UseCaseDeviceDifferentSPs'>Section&nbsp;4.1<span> (</span><span class='info'>Simple Deployment Scenario</span><span>)</span></a>, specifically the request for the device profile. The examples are informative only. 
                <br />
<br />


                        
                
</p>
<a name="FrameworkExamples1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Example 1: Device requesting profile</h3>

<p>
                        This example illustrates the detailed message flows between the device and the SIP Service Provider's network for requesting and retrieving the profile (the flow uses the device profile as an example).
                        <br />
<br />


                        The following are assumed for this example:
                        <br />
<br />


                        </p>
<ul class="text">
<li>
                                Device is assumed to have established local network connectivity; NAT and Firewall considerations are assumed to have been addressed by the SIP Service Provider.
                                
</li>
<li>
                                Examples are snapshots only and do not illustrate all the interactions between the device and the Service Provider's network (and none between the entities in the SIP Service Provider's network).
                                
</li>
<li>
                                All SIP communication with the SIP Service Provider happens via a SIP Proxy.
                                
</li>
<li>
                                HTTP over TLS is assumed to be the Content Retrieval method used (any suitable alternative can be used as well).
                                
</li>
</ul><p>
                        <br />
<br />


                        The flow diagram and an explanation of the messages follow.
                        <br />
<br />

                                
                               </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


                                   +----------------------+
 +--------+                        | SIP Service Provider |
 | Device |                        |                      |
 |(SIP UA)|                        |  SIP     PDS   HTTP  |
 +--------+                        | PROXY         Server |
                                   |                      |
                                   +----------------------+
      |                                |       |      |
      |                                |       |      |
      |          SUBSCRIBE             |       |      |
(SReq)|--------device profile---------&gt;|       |      |
      |                                |------&gt;|      |
      |                                |200 OK |      |
      |            200 OK              |&lt;------|      |
(SRes)|&lt;-------------------------------|       |      |
      |                                |       |      |
      |                                | NOTIFY|      |
      |    NOTIFY (Content Indirection)|&lt;------|      |
(NTFY)|&lt;-------------------------------|       |      |
      |            200 OK              |       |      |
(NRes)|-------------------------------&gt;|200 OK |      |
      |                                |------&gt;|      |
      |                                               |
      |                                               |
      |                                               |
      |&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;  TLS establishment  &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;|
      |                                               |
      |                HTTP Request                   |
(XReq)|----------------------------------------------&gt;|
      |                                               |
      |                HTTP Response                  |
(XRes)|&lt;----------------------------------------------|
      |                                               |



</pre></div><p>


                        </p>
<blockquote class="text"><dl>
<dt>(SReq)</dt>
<dd>

                                <br />


                                the device transmits a request for the 'device' profile using the SIP SUBSCRIBE utilizing the Event Package specified in this framework.
                                <br />
<br />


                                
<ul class="text">
<li>
                                        Note: Some of the header fields (e.g., SUBSCRIBE, Event, via) are continued on a separate line due to format constraints of this document.
                                        
</li>
</ul>

                                       <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

SUBSCRIBE sip:urn%3auuid%3a00000000-0000-1000-0000-00FF8D82EDCB
          @example.com  SIP/2.0
Event: ua-profile;profile-type=device;vendor="vendor.example.net";
       model="Z100";version="1.2.3"
From: anonymous@example.com;tag=1234
To: sip:urn%3auuid%3a00000000-0000-1000-0000-00FF8D82EDCB@example.com
Call-ID: 3573853342923422@192.0.2.44
CSeq: 2131 SUBSCRIBE
Contact: sip:urn%3auuid%3a00000000-0000-1000-0000-00FF8D82EDCB
   @192.168.1.44
   ;+sip.instance="&lt;urn:uuid:00000000-0000-0000-0000-123456789AB0&gt;"
   ;schemes="http,https"
Via: SIP/2.0/TCP 192.0.2.41;
  branch=z9hG4bK6d6d35b6e2a203104d97211a3d18f57a
Accept: message/external-body, application/x-z100-device-profile
Content-Length: 0


</pre></div>
                                                

                                <br />
<br />


                                
</dd>
<dt>(SRes)</dt>
<dd>

                                <br />


                                the SUBSCRIBE request is received by a SIP Proxy in the Service Provider's network which transmits it to the PDS. The PDS accepts the response and responds with a 200 OK

                                
<ul class="text">
<li>
                                        Note: The device and the SIP proxy may have established a secure communications channel (e.g., TLS).
                                        
</li>
</ul>

                                <br />
<br />



                                
</dd>
<dt>(NTFY)</dt>
<dd>

                                <br />


                                subsequently, the PDS transmits a SIP NOTIFY message indicating the profile location 

                                
<ul class="text">
<li>
                                        Note:  Some of the fields (e.g., content-type) are continued on a separate line due to format constraints of this document.
                                        
</li>
</ul>

                                      <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

NOTIFY sip:urn%3auuid%3a00000000-0000-1000-0000-00FF8D82EDCB
       @192.168.1.44 SIP/2.0
Event: ua-profile;effective-by=3600
From: sip:urn%3auuid%3a00000000-0000-1000-0000-00FF8D82EDCB@example.com
      ;tag=abca
To: sip:urn%3auuid%3a00000000-0000-1000-0000-00FF8D82EDCB@example.com
    ;tag=1234
Call-ID: 3573853342923422@192.0.2.44
CSeq: 322 NOTIFY
Via: SIP/2.0/UDP 192.0.2.3;
  branch=z9hG4bK1e3effada91dc37fd5a0c95cbf6767d0
MIME-Version: 1.0
Content-Type: message/external-body; access-type="URL";
              expiration="Mon, 01 Jan 2010 09:00:00 UTC";
              URL="http://example.com/z100-000000000000.html";
              size=9999;
              hash=10AB568E91245681AC1B

Content-Type: application/x-z100-device-profile
Content-ID: &lt;39EHF78SA@example.com&gt;
.
.
.


</pre></div>


                                <br />
<br />



                                
</dd>
<dt>(NRes)</dt>
<dd>

                                <br />


                                Device accepts the NOTIFY message and responds with a 200 OK

                                <br />
<br />


                                
</dd>
<dt>(XReq)</dt>
<dd>

                                <br />


                                once the necessary secure communications channel is established, the device sends an HTTP request to the HTTP server indicated in the NOTIFY

                                <br />
<br />


                                
</dd>
<dt>(XRes)</dt>
<dd>

                                <br />


                                the HTTP server responds to the request via a HTTP response containing the profile contents

                                <br />
<br />


                                
</dd>
</dl></blockquote><p>


                        
</p>
<a name="FrameworkExamples2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Example 2: Device obtaining change notification</h3>

<p>
                        The following example illustrates the case where a user (X) is simultaneously accessing services via two different devices (e.g., Multimedia entities on a PC and PDA) and has access to a user interface that allows for changes to the user profile.
                               <br />
<br />

                        The following are assumed for this example:

                        </p>
<ul class="text">
<li>
                                The devices (A &amp; B) obtain the necessary profiles from the same SIP Service Provider.
                                
</li>
<li>
                                The SIP Service Provider also provides a user interface that allows the user to change preferences that impact the user profile.
                                
</li>
</ul><p>
                                
                        <br />
<br />


                        The flow diagram and an explanation of the messages follow.
                        </p>
<ul class="text">
<li>
                        Note: The example only shows retrieval of user X's profile, but it may request and retrieve other profiles (e.g., local-network, Device).
                                
</li>
</ul><p>
                               <br />
<br />


                               </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


            -----           -----
           |User |_________| UI* | * = User Interface
           |  X  |         |     |
            -----           -----
          /       \
         /         \
        /           \              +----------------------+
 +--------+      +--------+        | SIP Service Provider |
 | Device |      | Device |        |                      |
 |    A   |      |    B   |        |  SIP     PDS   HTTP  |
 +--------+      +--------+        | PROXY         Server |
                                   +----------------------+
      |                                |       |      |
      |                                |       |      |
(A-EX)|&lt;=Enrolls for User X's profile=&gt;|&lt;=====&gt;|      |
      |                                |       |      |
      |                                               |
(A-RX)|&lt;===Retrieves User X's profile================&gt;|
      |                                               |
      |               |                |       |      |
      |               |  Enrolls for   |       |      |
      |         (B-EX)|&lt;== User X's ==&gt;|&lt;=====&gt;|      |
      |               |    profile     |       |      |
      |               |                |       |      |
      |               |                               |
      |         (B-RX)|&lt;= Retrieves User X's profile=&gt;|
      |                                               |
      |                       |                       |
      |                 (HPut)|----------------------&gt;|
      |                       |                       |
      |                 (HRes)|&lt;----------------------|
      |                                               |
      |                                |       |      |
      |                                | NOTIFY|      |
      |            NOTIFY              |&lt;------|      |
(A-NT)|&lt;-------------------------------|       |      |
      |            200 OK              |       |      |
(A-RS)|-------------------------------&gt;|200 OK |      |
      |                                |------&gt;|      |
      |                                               |
      |               |                | NOTIFY|      |
      |               |    NOTIFY      |&lt;------|      |
      |         (B-NT)|&lt;---------------|       |      |
      |               |    200 OK      |       |      |
      |         (B-RS)|---------------&gt;|200 OK |      |
      |               |                |------&gt;|      |
      |                                               |
      |                                               |
(A-RX)|&lt;===Retrieves User X's profile================&gt;|
      |                                               |
      |               |                               |
      |               |                               |
      |         (B-RX)|&lt;= Retrieves User X's profile=&gt;|
      |               |                               |




</pre></div><p>


                        </p>
<blockquote class="text"><dl>
<dt>(A-EX)</dt>
<dd>
                                Device A discovers, enrolls and obtains notification related to user X's profile.
                                
</dd>
<dt>(A-RX)</dt>
<dd>
                                Device A retrieves user X's profile.
                                
</dd>
<dt>(B-EX)</dt>
<dd>
                                Device B discovers, enrolls and obtains notification related to user X's profile.
                                
</dd>
<dt>(B-RX)</dt>
<dd>
                                Device B retrieves user X's profile.
                                
</dd>
<dt>(HPut)</dt>
<dd>
                                Changes affected by the user via the user interface are uploaded to the HTTP Server.
                                        
<ul class="text">
<li>
                                                Note: The UI itself can act as a device and subscribe to user X's profile. This is not the case in the example shown.
                                                
</li>
</ul>
                                
</dd>
<dt>(HRes)</dt>
<dd>
                                Changes are accepted by the HTTP server.
                                
</dd>
<dt>(A-NT)</dt>
<dd>


                                PDS transmits a NOTIFY message to device A indicating the changed profile. A sample message is shown below:
                                        
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                                Note: Some of the fields (e.g., Via) are continued on a separate line due to format constraints of this document.
                                                
</dd>
</dl></blockquote>

                                               <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

NOTIFY sip:userX@192.0.2.44 SIP/2.0
Event: ua-profile;effective-by=3600
From: sip:userX@sip.example.net;tag=abcd
To: sip:userX@sip.example.net.net;tag=1234
Call-ID: 3573853342923422@192.0.2.44
CSeq: 322 NOTIFY
Via: SIP/2.0/UDP 192.0.2.3;
  branch=z9hG4bK1e3effada91dc37fd5a0c95cbf6767d1
MIME-Version: 1.0
Content-Type: message/external-body; access-type="URL";
              expiration="Mon, 01 Jan 2010 09:00:00 UTC";
              URL="http://www.example.com/user-x-profile.html";
              size=9999;
              hash=123456789AAABBBCCCDD
.
.
.


</pre></div>

                                        <br />
<br />


                                
</dd>
<dt>(A-RS)</dt>
<dd>
                                Device A accepts the NOTIFY and sends a 200 OK
                                
</dd>
<dt>(B-NT)</dt>
<dd>
                                        PDS transmits a NOTIFY message to device B indicating the changed profile. A sample message is shown below:
                                        
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                                Note: Some of the fields (e.g., Via) are continued on a separate line due to format constraints of this document.
                                                
</dd>
</dl></blockquote>

                                               <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

NOTIFY sip:userX@192.0.2.43 SIP/2.0
Event: ua-profile;effective-by=3600
From: sip:userX@sip.example.net;tag=abce
To: sip:userX@sip.example.net.net;tag=1234
Call-ID: 3573853342923422@192.0.2.43
CSeq: 322 NOTIFY
Via: SIP/2.0/UDP 192.0.2.3;
  branch=z9hG4bK1e3effada91dc37fd5a0c95cbf6767d2
MIME-Version: 1.0
Content-Type: message/external-body; access-type="URL";
              expiration="Mon, 01 Jan 2010 09:00:00 UTC";
              URL="http://www.example.com/user-x-profile.html";
              size=9999;
              hash=123456789AAABBBCCCDD
.
.
.


</pre></div>

                                        <br />
<br />



                                
</dd>
<dt>(B-RS)</dt>
<dd>
                                Device B accepts the NOTIFY and sends a 200 OK
                                
</dd>
<dt>(A-RX)</dt>
<dd>
                                Device A retrieves the updated profile pertaining to user X
                                
</dd>
<dt>(B-RX)</dt>
<dd>
                                Device B retrieves the updated profile pertaining to user X
                                
</dd>
</dl></blockquote><p>
                        
</p>
<a name="IANAConsiderations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>
                There are two IANA considerations associated with this document, SIP Event Package and SIP configuration profile types. These are outlined in the following sub-sections.
                
</p>
<a name="SIPEventPackage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
SIP Event Package</h3>

<p>
                        This specification registers a new event package as defined in <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>.  The following information required for this registration:
                        <br />
<br />


                        </p>
<blockquote class="text">
<p>
                                Package Name: ua-profile
                                
</p>
<p>
                                Package or Template-Package: This is a package
                                
</p>
<p>
                                Published Document: RFC XXXX (Note to RFC Editor: Please fill in XXXX with the RFC number of this specification)
                                
</p>
<p>
                                Persons to Contact: Daniel Petrie dan.ietf AT SIPez DOT com, sumanth@cablelabs.com
                                
</p>
<p>
                                New event header parameters: profile-type, vendor, model, version, effective-by (the profile-type parameter has predefined values. The new event header parameters do not)
                                
</p>
</blockquote><p>

                        The following table illustrates the additions to the IANA SIP Header Field Parameters and Parameter Values: (Note to RFC Editor: Please fill in XXXX with the RFC number of this specification)
                        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                               Predefined
Header Field                  Parameter Name     Values     Reference
----------------------------  ---------------   ---------   ---------
Event                         profile-type      Yes         [RFCXXXX]
Event                         vendor            No          [RFCXXXX]
Event                         model             No          [RFCXXXX]
Event                         version           No          [RFCXXXX]
Event                         effective-by      No          [RFCXXXX]
</pre></div><p>

                        
</p>
<a name="RegistryOfSIPConfigurationProfileTypes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Registry of SIP configuration profile types</h3>

<p>
                        This document requests IANA to register new SIP configuration profile types at http://www.iana.org/assignments/sip-parameters under "SIP Configuration Profile Types".  
                        <br />
<br />

                        SIP configuration profile types allocations fall under the category "Specification Required", as explained in "Guidelines for Writing an IANA Considerations Section in RFCs" (<a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>).
                        <br />
<br />

Registrations with the IANA MUST include a the profile type, and a published document which describes its purpose and usage.
                        <br />
<br />

                        As this document specifies three SIP configuration profile types, the initial IANA registration will contain the information shown in the table below.  It also demonstrates the type of information maintained by the IANA.
                        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Profile Type                          Reference
      --------------                         ---------
      local-network                          [RFCXXXX]
      device                                 [RFCXXXX]
      user                                   [RFCXXXX]


      CONTACT:
      -------
      sumanth@cablelabs.com
      Daniel Petrie dan.ietf AT SIPez DOT com
</pre></div><p>

Note to RFC editor: Please replace RFCXXXX with the RFC number assigned to this document.
                        
</p>
<a name="SecurityConsiderations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>
			The framework specified in this document specifies profile delivery stages, an event package and three profile types to enable profile delivery. The profile delivery stages are: enrollment, content retrieval, and change notification. The event package helps with enrollment and change notifications. Each profile type allows for profile retrieval from a PDS belonging to a specific provider.
			<br />
<br />

			Enrollment allows a device to request, and if successful, enroll with a PDS to obtain profile data. To transmit the request the device relies on configured, cached or discovered data. Such data includes provider domain names, identities, and credentials. The device either uses configured outbound proxies or discovers the next-hop entity using <a class='info' href='#RFC3263'>[RFC3263]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;Session Initiation Protocol (SIP): Locating SIP Servers,&rdquo; June&nbsp;2002.</span><span>)</span></a> that can result in a SIP proxy or the PDS. It then transmits the request. A SIP Proxy receving the request uses the Request-URI and event header contents to route it to a PDS (via other SIP proxies, if required). 
                        <br />
<br />

                        When a PDS receives the enrollment request, it can either challenge any contained identity or admit the enrollment. Authorization rules then decide if the enrollment gets accepted. If accepted, the PDS sends an initial notification that contains either the profile data, or content indirection information. The profile data can contain generic profile data (common across multiple devices) or information specific to an entity (such as the device or a user). If specific to an entity, it may contain sensitive information such as credentials. Compromise of sensitive data can lead to threats such as impersonation attacks (establishing rogue sessions), theft of service (if services are obtainable), and zombie attacks. It is important for the device to ensure the authenticity of the PNC and the PCC since impersonation of the SIP service provider can lead to Denial of Service and Man-in-the-Middle attacks. 
                        <br />
<br />

			Profile content retrieval allows a device to retrieve profile data via content indirection from a PCC. This communication is accomplished using one of many profile delivery protocols or frameworks, such as HTTP or HTTPS as specified in this document. However, since the profile data returned is subject to the same considerations as that sent via profile notification, similar threats exist. For example, denial of service attacks (rogue devices bombard the PCC with requests for a specific profile) and attempts to modify erroneous data onto the PCC (since the location and format may be known). Thus, for the delivery of any sensitive profile data, authentication of the entity requesting profile data is required. It is also important for the requesting entity to authenticate the profile source via content indirection, and ensure that the sensitive profile data is protected via message integrity. For sensitive data that should not be subject to snooping, privacy is also required.
                        <br />
<br />

                        The following sub-sections highlight the security considerations that are specific to each profile type. 
                        <br />
<br />

                
</p>
<a name="SCForLocalNetworkProfile"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Local-network profile</h3>

<p>
                                A local network may or may not (e.g., home router) support local-network profiles as specified in this framework. Even if supported, the PDS may only be configured with a generic local-network profile that is provided to every device that requests the local-network profile. Such a PDS may not implement any authentication requirements or TLS.
                                <br />
<br />


				Alternatively, certain deployments may require the entities - device and the PDS - to authenticate each other prior to successful profile enrollment. Such networks may pre-configure user identities to the devices and allow user-specific local-network profiles.  In such networks the PDS will support digest, and the devices are configured with user identities and credentials as specified in <a class='info' href='#IdentitiesAndCredentials'>Section&nbsp;5.3.1<span> (</span><span class='info'>Bootstrapping Identities and Credentials</span><span>)</span></a>. If sensitive profile data is being transmitted, the user identity is a SIPS URI that results in TLS with the next-hop (which is authenticated), and digest authentication is used by the PDS and the device. 
                                <br />
<br />


				This framework supports both use cases and any variations in-between. However, devices obtaining local-network profiles from an unauthenticated PDS are cautioned against potential Man-in-the-Middle or PDS impersonation attacks. This framework requires that a device reject sensitive data, such as credentials, from unauthenticated local-network sources. It also prohibits devices from responding to authentication challenges in the absence of TLS on all hops as a result of using a SIPS URI. Responding to unauthenticated challenges allows for dictionary attacks that can reveal weak passwords. The only exception to accepting such sensitive data without authentication of the PDS is in the case of bootstrapping (see <a class='info' href='#IdentitiesAndCredentials'>Section&nbsp;5.3.1<span> (</span><span class='info'>Bootstrapping Identities and Credentials</span><span>)</span></a>). In the case of bootstrapping, the methods employed need to be aware of potential security threats such as impersonation.
                                <br />
<br />


                                The use of SIP Identity is useful for the device to validate notifications in the absence of a secure channel such as TLS when a SIPS URI is used. In such cases the device can validate the SIP Identity header to verify the source of the profile notification, and the source of the profile data when content indirection is not used. However, the presence of the header does not guarantee the validity of the data. It verifies the source and confirms data integrity, but the data obtained from an undesired source may still be invalid, e.g., invalid outbound proxy information, resulting in Denial of Service. Thus, devices requesting the local-network profile from unknown networks need to be prepared to discard information that prevent retrieval of other, required, profiles.
                                <br />
<br />


                               
</p>
<a name="SCForDeviceProfile"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
Device profile</h3>

<p>
                                Device profiles deal with device-specific configuration. They may be provided to unknown devices that are attempting to obtaining profiles for purposes such as trials, self-subscription (not to be confused with <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;Session Initiation Protocol (SIP)-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a>) and emergency services (<a class='info' href='#I-D.ietf-ecrit-phonebcp'>[I&#8209;D.ietf&#8209;ecrit&#8209;phonebcp]<span> (</span><span class='info'>Rosen, B. and J. Polk, &ldquo;Best Current Practice for Communications Services in support of Emergency Calling,&rdquo; January&nbsp;2010.</span><span>)</span></a>).

				<br />
<br />

				This framework allows for the device profile to be used for bootstrapping a device. Such bootstrapping profile data may contain enough information to connect to a Provider. For example, it may enable the device to communicate with a device provider, allowing for trial or self-subscription services via visual or audio interfaces (e.g., interactive voice response), or  customer service representatives. The profile data may also allow the device a choice of device providers and allow the end-user to choose one. The profile data may also contain identities and credentials (temporary or long-term) that can be used to obtain further profile data from the network. This framework recommends the use of the SIP Identity header by the PDS. However, to be able to validate the SIP Identity header, the device needs to be pre-configured with the knowledge of allowable domains or certificates for validation (e.g., using PKI). If not, the device can still guarantee header and body integrity if the profile data contains the domain certificate (but the data can still be invalid or malicious). In such cases, devices supporting user interfaces may obtain confirmation from the user trying to bootstrap the device (confirming header and body integrity). However, when the SIP Identity header is not present, or the device is not capable of validating it, the bootstrapping data is unauthenticated and obtained without any integrity protection. Such bootstrapping data, however, may contain only temporary credentials (SIPS URI and digest credentials) that can be used to reconnect to the network to ensure message integrity and privacy prior to obtaining long-term credentials. It is to be noted that such devices are at the mercy of the network they request the device profile from. If they are initialized in a rogue network, or get hijacked by a rogue PDS, the end-user may be left without desired device operation or, worse, unwanted operation. To mitigate such factors the device provider may communicate temporary credentials (e.g., passwords that can be entered via an interface) or permanent credentials (e.g., a USB device) to the end-user for connectivity. If such methods are used, those credentials MUST be quickly replaced by large-entropy credentials, to minimize the impact of dictionary attacks. Future enhancements to this framework may specify device capabilities that allow for authentication without any provider specific configuration (e.g., X.509 certificates using PKI can allow for authentication by any provider with access to the CA certificate). Alternatively, the device may be pre-configured with with credentials for use with content indirection mechanisms. In such circumstances a PDS can use secure content indirection mechanism, such as HTTPS, to provide the bootstrapping data.
                                <br />
<br />

				Once a device is associated with a device provider the device profile is vital to device operation. This is because the device profile can contain important operational information such as users that are to be allowed access (white-list or black-list), user credentials (if required) and other sensitive information. Thus, it is necessary to ensure that any device profile containing sensitive information is obtained via an authenticated source, with integrity protection, and delivered to an authenticated device. For sensitive information such as credentials, privacy is also required. The framework requires that devices obtain sensitive information only from authenticated entities except while it is being bootstrapped. In cases where privacy needs to be mandated for notifications, the device provider can configure the device with a SIPS URI, to be used as the subscription URI, during profile enrollment. The framework also requires a PDS presenting sensitive profile data to use digest authentication. This ensures that the data is delivered to an authenticated entity. Authentication of profile retrieval via content indirection for sensitive profiles is via HTTPS utilizing HTTP digest.
                                <br />
<br />

                               
</p>
<a name="SCForUserProfile"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
User profile</h3>

<p>
			Devices can only request user profiles for users that are known by a SIP service provider. PDSs are required to reject user profile enrollment requests for any users that are unknown in the network. For known user AoRs that are allowed to retrieve profiles, the security considerations are similar to that of the device profile (except for bootstrapping). 
                               
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgements</h3>

<p>
The author appreciates all those who contributed and commented on the many iterations of this document.  

Detailed comments were provided by the following individuals: 
Jonathan Rosenberg from Cisco, 
Henning Schulzrinne from Columbia University, 
Cullen Jennings from Cisco, 
Rohan Mahy from Plantronics, 
Rich Schaaf from Pingtel, 
Volker Hilt from Bell Labs, 
Adam Roach of Estacado Systems, 
Hisham Khartabil from Telio, 
Henry Sinnreich from MCI, 
Martin Dolly from AT&amp;T Labs, 
John Elwell from Siemens, 
Elliot Eichen and Robert Liao from Verizon, 
Dale Worley from Pingtel, 
Francois Audet from Nortel, 
Roni Even from Polycom, 
Jason Fischl from Counterpath, 
Josh Littlefield from Cisco, 
Nhut Nguyen from Samsung.
            <br />
<br />

	    The final revisions of this document were a product of design team discussions. The editor wishes to extend special appreciation to the following design team members for their numerous reviews and specific contributions to various sections: Josh Littlefield from Cisco (Overview, Section 6), Peter Blatherwick from Mitel (Section 6), Cullen Jennings (Security), Sam Ganesan (Section 6) and Mary Barnes (layout, Section 6). 
            <br />
<br />

	    
	    The following design team members are thanked for numerous reviews and general contributions: Martin Dolly from AT&amp;T Labs, Jason Fischl from Counterpath, Alvin Jiang of Engin and Francois Audet from Nortel. 
            <br />
<br />

	    The following SIPPING WG members are thanked for numerous reviews, comments and recommendations: John Elwell from Siemens, Donald Lukacs from Telcordia, Roni Even from Polycom, David Robbins from Verizon, Shida Schubert from NTT Advanced Technology Corporation, and Eugene Nechamkin from Broadcom. The editor would also like to extend a special thanks to the comments and recommendations provided by the SIPPING WG, specifically Keith Drage from Lucent (restructuring proposal) and John Elwell from Siemens (numerous reviews and recommendations).
	    <br />
<br />

	    Additionally, appreciation is also due to Peter Koch for expert DNS advice. 
	    <br />
<br />

	    And finally, sincere appreciation is extended to the chairs (Mary Barnes from Nortel and Gonzalo Camarillo from Ericsson), the past/current Area Directors (Cullen Jennings from Cisco, Jon Peterson from Neustar, and Robert Sparks from Tekelec) for facilitating discussions, reviews and contributions; and, the expert reviewers from the IESG (Peter McCann from Motorola, Catherine Meadows from Naval Research Laboratory). 
            
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2617">[RFC2617]</a></td>
<td class="author-text"><a href="mailto:john@math.nwu.edu">Franks, J.</a>, <a href="mailto:pbaker@verisign.com">Hallam-Baker, P.</a>, <a href="mailto:jeff@AbiSource.com">Hostetler, J.</a>, <a href="mailto:lawrence@agranat.com">Lawrence, S.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, Luotonen, A., and <a href="mailto:stewart@OpenMarket.com">L. Stewart</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2617">HTTP Authentication: Basic and Digest Access Authentication</a>,&rdquo; RFC&nbsp;2617, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2617.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2617.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2617.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2818">[RFC2818]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3263">[RFC3263]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3263">Session Initiation Protocol (SIP): Locating SIP Servers</a>,&rdquo; RFC&nbsp;3263, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3263.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3265">[RFC3265]</a></td>
<td class="author-text">Roach, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3265">Session Initiation Protocol (SIP)-Specific Event Notification</a>,&rdquo; RFC&nbsp;3265, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3265.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3319">[RFC3319]</a></td>
<td class="author-text">Schulzrinne, H. and B. Volz, &ldquo;<a href="http://tools.ietf.org/html/rfc3319">Dynamic Host Configuration Protocol (DHCPv6) Options for Session Initiation Protocol (SIP) Servers</a>,&rdquo; RFC&nbsp;3319, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3319.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3361">[RFC3361]</a></td>
<td class="author-text">Schulzrinne, H., &ldquo;<a href="http://tools.ietf.org/html/rfc3361">Dynamic Host Configuration Protocol (DHCP-for-IPv4) Option for Session Initiation Protocol (SIP) Servers</a>,&rdquo; RFC&nbsp;3361, August&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3361.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4122">[RFC4122]</a></td>
<td class="author-text"><a href="mailto:paulle@microsoft.com">Leach, P.</a>, <a href="mailto:michael@refactored-networks.com">Mealling, M.</a>, and <a href="mailto:rsalz@datapower.com">R. Salz</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4122">A Universally Unique IDentifier (UUID) URN Namespace</a>,&rdquo; RFC&nbsp;4122, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4122.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4122.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4122.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4474">[RFC4474]</a></td>
<td class="author-text">Peterson, J. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4474">Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4474, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4474.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4483">[RFC4483]</a></td>
<td class="author-text">Burger, E., &ldquo;<a href="http://tools.ietf.org/html/rfc4483">A Mechanism for Content Indirection in Session Initiation Protocol (SIP) Messages</a>,&rdquo; RFC&nbsp;4483, May&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4483.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4704">[RFC4704]</a></td>
<td class="author-text">Volz, B., &ldquo;<a href="http://tools.ietf.org/html/rfc4704">The Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Client Fully Qualified Domain Name (FQDN) Option</a>,&rdquo; RFC&nbsp;4704, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4704.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5626">[RFC5626]</a></td>
<td class="author-text">Jennings, C., Mahy, R., and F. Audet, &ldquo;<a href="http://tools.ietf.org/html/rfc5626">Managing Client-Initiated Connections in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;5626, October&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5626.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ecrit-phonebcp">[I-D.ietf-ecrit-phonebcp]</a></td>
<td class="author-text">Rosen, B. and J. Polk, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-phonebcp-14.txt">Best Current Practice for Communications Services in support of Emergency Calling</a>,&rdquo; draft-ietf-ecrit-phonebcp-14 (work in progress), January&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ecrit-phonebcp-14.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0959">[RFC0959]</a></td>
<td class="author-text">Postel, J. and J. Reynolds, &ldquo;<a href="http://tools.ietf.org/html/rfc959">File Transfer Protocol</a>,&rdquo; STD&nbsp;9, RFC&nbsp;959, October&nbsp;1985 (<a href="http://www.rfc-editor.org/rfc/rfc959.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2132">[RFC2132]</a></td>
<td class="author-text"><a href="mailto:sca@engr.sgi.com">Alexander, S.</a> and <a href="mailto:droms@bucknell.edu">R. Droms</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2132">DHCP Options and BOOTP Vendor Extensions</a>,&rdquo; RFC&nbsp;2132, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2132.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2132.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2132.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4510">[RFC4510]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4510">Lightweight Directory Access Protocol (LDAP): Technical Specification Road Map</a>,&rdquo; RFC&nbsp;4510, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4510.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4825">[RFC4825]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4825">The Extensible Markup Language (XML) Configuration Access Protocol (XCAP)</a>,&rdquo; RFC&nbsp;4825, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4825.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Daniel Petrie</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">SIPez LLC.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">34 Robbins Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Arlington, MA  02476</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dan.ietf AT SIPez DOT com">dan.ietf AT SIPez DOT com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.SIPez.com/">http://www.SIPez.com/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sumanth Channabasappa (Editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">CableLabs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">858 Coal Creek Circle</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Louisville, Co  80027</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:sumanth@cablelabs.com">sumanth@cablelabs.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.cablelabs.com/">http://www.cablelabs.com/</a></td></tr>
</table>
</body></html>
