Network Working Group                                        Rob Weltman
INTERNET-DRAFT                             Netscape Communications Corp.
                                                              Mark Smith
                                           Netscape Communications Corp.
                                                          February, 2000


                  LDAP Authentication Response Control
               draft-weltman-ldapv3-auth-response-01.txt


Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Task Force
   (IETF), its areas, and its working groups.  Note that other groups
   may also distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.


Abstract

   This document defines support for the Authentication Response
   Control. Controls are an LDAP protocol version 3 extension, to allow
   passing arbitrary control information along with a standard request
   to a server, and to receive arbitrary information back with a
   standard result. The Authentication Response Control may be returned
   by an LDAP server in a bind response to a client authenticating with
   version 3 of the LDAP protocol. The control contains the identity
   assumed by the client. This is useful when there is a mapping step or
   other indirection during the bind, so that the client can be told
   what LDAP identity was granted. Client authentication with
   certificates is the primary situation where this applies. Also, some
   SASL authentication mechanisms may not involve the client explicitly
   providing a DN.


1. Introduction

   Version 3 of the LDAP protocol provides a means of supplying
   arbitrary additional information along with a request to an LDAP
   server, and receiving arbitrary additional response information. The

Expires August 2000                                           [Page 1]

AUTHENTICATION RESPONSE CONTROL                         February, 2000


   Control protocol extension is described in [LDAPv3], section 4.1.12.
   This document defines a way for a server to return the identity
   assumed by a client on binding using the Control mechanism.

   The key words "MUST", "SHOULD", and "MAY" used in this document  are
   to be interpreted as described in [RFCKeyWords].


2. Publishing support for the Authentication Response Control

   Support for the Authentication Response Control is indicated by the
   presence of the OID "TBD" in the supportedExtensions attribute of a
   server's root DSE.


3. Authentication Response Control


   This control may be included in any final bind response where the
   bind request specified protocol version 3, as part of the controls
   field of the LDAPMessage as defined in [LDAPv3]. The control is not
   solicited by the client.

   AuthResponseControl ::= SEQUENCE {
           controlType     TBD,
           criticality     BOOLEAN DEFAULT FALSE,
           controlValue    AuthResponseValue
   }

   The criticality field is not used. The controlValue contains the DN
   of the identity established during the bind request, and the
   mechanism used to authenticate:

   AuthResponseValue::= SEQUENCE {
           authDN LDAPDN
           authMechanism OCTET STRING
   }

   If the bind request failed, the authDN and authMechanism values have
   zero length. Also, if the bind request resulted in anonymous
   authentication, the authDN and authMechanism values have zero length.
   If SASL was used for authentication, the value MUST be "SASL/"
   followed by the IANA-registered SASL mechanism which was used, for
   example:

       SASL/DIGEST-MD5

   For simple authentication, the value of authMechanism MUST be:

       simple

   During client authentication with certificates [AUTH], a client may
   possess more than one certificate and not be able to determine which

Expires August 2000                                            [Page 2

AUTHENTICATION RESPONSE CONTROL                         February, 2000


   one was ultimately selected for authentication to the server. The
   subject DN field in the selected certificate may not correspond
   exactly to a DN in the directory, but rather have gone through a
   mapping process controlled by the server. On completing the
   certificate-based authentication, the client may issue a SASL [SASL]
   bind request, specifying the EXTERNAL mechanism. The bind response
   may include an authentication response control indicating the DN in
   the server's DIT which the certificate was mapped to.


4. Security Considerations

   The Authentication Response Control is subject to standard LDAP
   security considerations. The control may be passed over a secure as
   well as over an insecure channel. No additional confidential
   information is passed in the control.


5. Copyright

   Copyright (C) The Internet Society (1999). All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the  purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


6. Bibliography

   [LDAPv3] M. Wahl, T. Howes, S. Kille, "Lightweight Directory Access
        Protocol (v3)", Internet Draft draft-ietf-asid-ldapv3-protocol-
        06.txt, July 1997.


Expires August 2000                                            [Page 3

AUTHENTICATION RESPONSE CONTROL                         February, 2000


   [RFCKeyWords] Bradner, Scott, "Key Words for use in RFCs to Indicate
        Requirement Levels", draft-bradner-key-words-03.txt, January,
        1997.

   [AUTH] M. Wahl, H. Alvestrand, J. Hodges, RL "Bob" Morgan,
        "Authentication Methods for LDAP", draft-ietf-ldapext-authmeth-
        04.txt, June, 1999.

   [SASL] J. Myers, "Simple Authentication and Security Layer (SASL",
        RFC 2222, October, 1997.

   [ASN.1] X.680 : ITU-T Recommendation X.680 (1997) | ISO/IEC 8824-
        1:1998, Information Technology - Abstract Syntax Notation One
        (ASN.1): Specification of Basic Notation


7. Author's Addresses

   Rob Weltman
   Netscape Communications Corp.
   MV-068
   501 E. Middlefield Rd.
   Mountain View, CA 94043
   USA
   +1 650 937-3301
   rweltman@netscape.com

   Mark Smith
   Netscape Communications Corp.
   MV-068
   501 E. Middlefield Rd.
   Mountain View, CA 94043
   USA
   +1 650 937-3477
   mcs@netscape.com

8. Changes from draft-weltman-ldapv3-auth-response-00.txt


8.1 Capitalization of ASN.1 macros


   AuthResponseControl and AuthResponseValue are capitalized.


8.2 Clarifications


   Added sentence on behavior for anonymous binds.







Expires August 2000                                            [Page 4

