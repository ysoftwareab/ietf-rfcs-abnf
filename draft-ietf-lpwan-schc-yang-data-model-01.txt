



lpwan Working Group                                          A. Minaburo
Internet-Draft                                                    Acklio
Intended status: Standards Track                              L. Toutain
Expires: July 26, 2020            Institut MINES TELECOM; IMT Atlantique
                                                        January 23, 2020


        Data Model for Static Context Header Compression (SCHC)
                draft-ietf-lpwan-schc-yang-data-model-01

Abstract

   This document describes a YANG data model for the SCHC (Static
   Context Header Compression) compression and fragmentation rules.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on July 26, 2020.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





Minaburo & Toutain        Expires July 26, 2020                 [Page 1]

Internet-Draft           LPWAN SCHC YANG module             January 2020


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  SCHC rules  . . . . . . . . . . . . . . . . . . . . . . . . .   2
     2.1.  Compression Rules . . . . . . . . . . . . . . . . . . . .   3
     2.2.  Field Identifier  . . . . . . . . . . . . . . . . . . . .   4
     2.3.  Field length  . . . . . . . . . . . . . . . . . . . . . .   6
     2.4.  Field position  . . . . . . . . . . . . . . . . . . . . .   7
     2.5.  Direction Indicator . . . . . . . . . . . . . . . . . . .   7
     2.6.  Target Value  . . . . . . . . . . . . . . . . . . . . . .   8
     2.7.  Matching Operator . . . . . . . . . . . . . . . . . . . .   9
       2.7.1.  Matching Operator arguments . . . . . . . . . . . . .  10
     2.8.  Compression Decompresison Actions . . . . . . . . . . . .  10
       2.8.1.  Compression Decompression Action arguments  . . . . .  12
   3.  Rule definition . . . . . . . . . . . . . . . . . . . . . . .  12
     3.1.  Compression rule  . . . . . . . . . . . . . . . . . . . .  14
       3.1.1.  Compression context representation. . . . . . . . . .  14
       3.1.2.  Rule definition . . . . . . . . . . . . . . . . . . .  16
     3.2.  Fragmentation rule  . . . . . . . . . . . . . . . . . . .  16
     3.3.  YANG Tree . . . . . . . . . . . . . . . . . . . . . . . .  17
   4.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  17
   5.  Security considerations . . . . . . . . . . . . . . . . . . .  17
   6.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  18
   7.  YANG Module . . . . . . . . . . . . . . . . . . . . . . . . .  18
   8.  Normative References  . . . . . . . . . . . . . . . . . . . .  18
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  18

1.  Introduction

2.  SCHC rules

   SCHC is a compression and fragmentation mechanism for constrained
   networks defined in [I-D.ietf-lpwan-ipv6-static-context-hc] it is
   based on a static context shared by two entities at the boundary this
   contrained network.  Draft [I-D.ietf-lpwan-ipv6-static-context-hc]
   provides an abstract representation of the rules used either for
   compression/decompression (or C/D) or fragmentation/reassembly (or F/
   R).  The goal of this document is to formalize the description of the
   rules to offer:

   o  universal representation of the rule to allow the same rule
      represention on both ends.  For instance; a device can provide the
      rule it uses to store them in the core SCHC C/D and F/R.

   o  a device or the core SCHC instance may update the other end to set
      upsome specific values (e.g.  IPv6 prefix, Destination
      address,...)




Minaburo & Toutain        Expires July 26, 2020                 [Page 2]

Internet-Draft           LPWAN SCHC YANG module             January 2020


   o  ...

   This document defines a YANG module to represent both compression and
   fragmentation rules, which leads to common representation and values
   for the elements of the rules.  SCHC compression is generic, the main
   mechanism do no refers to a specific fields.  A field is abstractedh
   through an ID, a position, a direction and a value that can be a
   numerical value or a string.

   [I-D.ietf-lpwan-ipv6-static-context-hc] and
   [I-D.ietf-lpwan-coap-static-context-hc] specifies fields for IPv6,
   UDP, CoAP and OSCORE.

   Fragmentation requires a set of common parameters that are included
   in a rule.

2.1.  Compression Rules

   [I-D.ietf-lpwan-ipv6-static-context-hc] proposes an abstract
   representation of the compression rule.  A compression context for a
   device is composed of a set of rules.  Each rule contains information
   to describe a specific field in the header to be compressed.

     +-----------------------------------------------------------------+
     |                      Rule N                                     |
    +-----------------------------------------------------------------+|
    |                    Rule i                                       ||
   +-----------------------------------------------------------------+||
   |  (FID)            Rule 1                                        |||
   |+-------+--+--+--+------------+-----------------+---------------+|||
   ||Field 1|FL|FP|DI|Target Value|Matching Operator|Comp/Decomp Act||||
   |+-------+--+--+--+------------+-----------------+---------------+|||
   ||Field 2|FL|FP|DI|Target Value|Matching Operator|Comp/Decomp Act||||
   |+-------+--+--+--+------------+-----------------+---------------+|||
   ||...    |..|..|..|   ...      | ...             | ...           ||||
   |+-------+--+--+--+------------+-----------------+---------------+||/
   ||Field N|FL|FP|DI|Target Value|Matching Operator|Comp/Decomp Act|||
   |+-------+--+--+--+------------+-----------------+---------------+|/
   |                                                                 |
   \-----------------------------------------------------------------/


                Figure 1: Compression Decompression Context








Minaburo & Toutain        Expires July 26, 2020                 [Page 3]

Internet-Draft           LPWAN SCHC YANG module             January 2020


2.2.  Field Identifier

   In the process of compression, the headers of the original packet are
   first parsed to create a list of fields.  This list of fields is
   matched again the rules to find the appropriate one and apply
   compression.  The link between the list given by the parsed fields
   and the rules is doen through a field ID.
   [I-D.ietf-lpwan-ipv6-static-context-hc] do not state how the field ID
   value can be constructed.  In the given example, it was given through
   a string indexed by the protocol name (e.g.  IPv6.version,
   CoAP.version,...).

   Using the YANG model, each field can be identified through a global
   YANG identityref.  A YANG field ID derives from the field-id-base-
   type.  Figure 2 gives some field ID definitions.  Note that some
   field IDs can be splitted is smaller pieces.  This is the case for
   "fid-ipv6-trafficclass-ds" and "fid-ipv6-trafficclass-ecn" which are
   a subset of "fid-ipv6-trafficclass-ds".

































Minaburo & Toutain        Expires July 26, 2020                 [Page 4]

Internet-Draft           LPWAN SCHC YANG module             January 2020


     identity field-id-base-type  {
              description "Field ID with SID";
     }

     identity fid-ipv6-version {
              base field-id-base-type;
              description "IPv6 version field from RFC8200";
     }

     identity fid-ipv6-trafficclass {
              base field-id-base-type;
              description "IPv6 Traffic Class field from RFC8200";
     }

     identity fid-ipv6-trafficclass-ds {
             base field-id-base-type;
               description "IPv6 Traffic Class field from RFC8200,
                             DiffServ field from RFC3168";
     }

     identity fid-ipv6-trafficclass-ecn {
             base field-id-base-type;
               description "IPv6 Traffic Class field from RFC8200,
                      ECN field from RFC3168";
     }

     ...

     identity fid-coap-option-if-match {
             base field-id-base-type;
               description "CoAP option If-Match from RFC 7252";
     }

     identity fid-coap-option-uri-host {
             base field-id-base-type;
               description "CoAP option URI-Host from RFC 7252";
     }

     ...


            Figure 2: Definition of indentityref for field IDs

   Figure 2 gives an example of field ID identityref definitions.  The
   base identity is field-id-base-type, and field id are derived for it.
   The naming convention is "fid" followed by the protocol name and the
   field name.




Minaburo & Toutain        Expires July 26, 2020                 [Page 5]

Internet-Draft           LPWAN SCHC YANG module             January 2020


   The yang model in annex gives the full definition of the field ID for
   [I-D.ietf-lpwan-ipv6-static-context-hc] and
   [I-D.ietf-lpwan-coap-static-context-hc].

The type associated to this identity is field-id-type (cf. {{Fig-field-id-type}})

    typedef field-id-type {
        description "Field ID generic type.";
        type identityref {
            base field-id-base-type;
        }
    }

            Figure 3: Definition of indentityref for field IDs

2.3.  Field length

   Field length is either an integer giving the size of a field in bits
   or a function.  [I-D.ietf-lpwan-ipv6-static-context-hc] defines the
   "var" function which allows variable length fields in byte and
   [I-D.ietf-lpwan-coap-static-context-hc] defines the "tkl" function
   for managing the CoAP Token length field.

     identity field-length-base-type {
           description "used to extend field length functions";
     }

     identity fl-variable {
              base field-length-base-type;
              description "residue length in Byte is sent";
     }

     identity fl-token-length {
              base field-length-base-type;
              description "residue length in Byte is sent";
     }


             Figure 4: Definition of indetntyref for field IDs

   As for field ID, field length function can be defined as a
   identityref as shown in Figure 4.

   Therefore the type for field length is a union between an integer
   giving in bits the size of the length and the identityref (cf.
   Figure 5).





Minaburo & Toutain        Expires July 26, 2020                 [Page 6]

Internet-Draft           LPWAN SCHC YANG module             January 2020


       typedef field-length-type {
           type union {
               type int64; /* positive length */
               type identityref { /* function */
                   base field-length-base-type;
               }
           }
       }

             Figure 5: Definition of indetntyref for field IDs

   The naming convention is fl followed by the function name as defined
   in SCHC specifications.

2.4.  Field position

   Field position is a positive integer which gives the position of a
   field, the default value is 1, but if the field is repeated several
   times, the value is higher.  value 0 indicates that the position is
   not important and is not taken into account during the rule selection
   process.

   Field position is a positive integer.  The type is an uint8.

2.5.  Direction Indicator

   The Direction Indicator (DI) is used to tell if a field appears in
   both direction (Bi) or only uplink (Up) or Downlink (Dw).























Minaburo & Toutain        Expires July 26, 2020                 [Page 7]

Internet-Draft           LPWAN SCHC YANG module             January 2020


     identity direction-indicator-base-type {
           description "used to extend field length functions";
     }

     identity di-bidirectional {
              base direction-indicator-base-type;
              description "Direction Indication of bi directionality";
     }

     identity di-up {
              base direction-indicator-base-type;
              description "Direction Indication of upstream";
     }

     identity di-down {
              base direction-indicator-base-type;
              description "Direction Indication of downstream";
     }


       Figure 6: Definition of identityref for direction indicators

   Figure 6 gives the identityref for Direction Indicators.

   The type is "direction-indicator-type" (cf.  Figure 7).

       typedef direction-indicator-type {
           type identityref {
               base direction-indicator-base-type;
           }
       }

       Figure 7: Definition of identityref for direction indicators

2.6.  Target Value

   Target Value may be either a string or binary sequence.  For match-
   mapping, several of these values can be contained in a Target Value
   field.  In the data model, this is generalized by adding a position,
   which orders the list of values.  By default the position is set to
   0.

   The leaf "value" is not mandatory to represent a non existing value
   in a TV.







Minaburo & Toutain        Expires July 26, 2020                 [Page 8]

Internet-Draft           LPWAN SCHC YANG module             January 2020


     grouping target-values-struct {
       leaf value {
         type union {
           type binary;
           type string;
         }
       }
       leaf position {
             type uint16;
       }
     }


                   Figure 8: Definition of target value

   Figure 8 gives the definition of a single element of a Target Value.
   In the rule, this will be used as a list, with position as a key.

2.7.  Matching Operator

   Matching Operator (MO) is a function applied between a field value
   provided by the parsed header and the target value.
   [I-D.ietf-lpwan-ipv6-static-context-hc] defines 4 MO.




























Minaburo & Toutain        Expires July 26, 2020                 [Page 9]

Internet-Draft           LPWAN SCHC YANG module             January 2020


     identity matching-operator-base-type {
        description "used to extend Matching Operators with SID values";
     }

     identity mo-equal {
        base matching-operator-base-type;
        description "SCHC draft";
     }

     identity mo-ignore {
        base matching-operator-base-type;
        description "SCHC draft";
     }

     identity mo-msb {
        base matching-operator-base-type;
        description "SCHC draft";
     }

     identity mo-matching {
        base matching-operator-base-type;
        description "SCHC draft";
     }

            Figure 9: Definition of Matching Operator identity

   the type is "matching-operator-type" (cf.  Figure 10)

      typedef matching-operator-type {
           type identityref {
               base matching-operator-base-type;
           }
       }

              Figure 10: Definition of Matching Operator type

2.7.1.  Matching Operator arguments

   Some Matching Operator such as MSB can take some values.  Even if
   currently LSB is the only MO takes only one argument, in the future
   some MO may require several arguments.  They are viewed as a list of
   target-values-type.

2.8.  Compression Decompresison Actions

   Compresion Decompression Action (CDA) idenfied the function to use
   either for compression or decompression.
   [I-D.ietf-lpwan-ipv6-static-context-hc] defines 6 CDA.



Minaburo & Toutain        Expires July 26, 2020                [Page 10]

Internet-Draft           LPWAN SCHC YANG module             January 2020


       identity compression-decompression-action-base-type;

       identity cda-not-sent {
           base compression-decompression-action-base-type;
              description "from SCHC draft";
       }

       identity cda-value-sent {
           base compression-decompression-action-base-type;
              description "from SCHC draft";
       }

       identity cda-lsb {
           base compression-decompression-action-base-type;
              description "from SCHC draft";
       }

       identity cda-mapping-sent {
           base compression-decompression-action-base-type;
              description "from SCHC draft";
       }

       identity cda-compute-length {
           base compression-decompression-action-base-type;
              description "from SCHC draft";
       }

       identity cda-compute-checksum {
           base compression-decompression-action-base-type;
              description "from SCHC draft";
       }

       identity cda-deviid {
           base compression-decompression-action-base-type;
              description "from SCHC draft";
       }

      identity cda-appiid {
           base compression-decompression-action-base-type;
              description "from SCHC draft";
       }


     Figure 11: Definition of Compresion Decompression Action identity

   The type is "comp-decomp-action-type" (cf.  Figure 12)





Minaburo & Toutain        Expires July 26, 2020                [Page 11]

Internet-Draft           LPWAN SCHC YANG module             January 2020


      typedef comp-decomp-action-type {
           type identityref {
               base compression-decompression-action-base-type;
           }
       }


       Figure 12: Definition of Compresion Decompression Action type

2.8.1.  Compression Decompression Action arguments

   Currently no CDA requires argumetns, but the future some CDA may
   require several arguments.  They are viewed as a list of target-
   values-type.

3.  Rule definition

   A rule is either a C/D or an F/R rule.  A rule is identified by the
   rule ID value and its associated length.  The YANG grouping rule-id-
   type defines the structure used to represent a rule ID.  Length of 0
   is allowed to represent an implicit rule.






























Minaburo & Toutain        Expires July 26, 2020                [Page 12]

Internet-Draft           LPWAN SCHC YANG module             January 2020


// Define rule ID. Rule ID is composed of a RuleID value and a Rule ID Length

  grouping rule-id-type {
      leaf rule-id {
        type uint32;
        description "rule ID value, this value must be unique combined with the length";
      }
      leaf rule-length {
        type uint8 {
          range 0..32;
        }
                  description "rule ID length in bits, value 0 is for implicit rules";
      }
  }

// SCHC table for a specific device.

  container schc {
    leaf version{
        type uint64;
        mandatory false;
        description "used as an indication for versioning";
    }
    list rule {
        key "rule-id rule-length";
                uses rule-id-type;
                  choice nature {
                          case fragmentation {
                uses fragmentation-content;
              }
                case compression {
                uses compression-content;
         }
       }
         }
   }


                  Figure 13: Definition of a SCHC Context

   To access to a specfic rule, rule-id and its specific length is used
   as a key.  The rule is either a compression or a fragmentation rule.

   Each context can be identify though a version id.







Minaburo & Toutain        Expires July 26, 2020                [Page 13]

Internet-Draft           LPWAN SCHC YANG module             January 2020


3.1.  Compression rule

   A compression rule is composed of entries describing its processing
   (cf.  Figure 14).  An entry contains all the information defined in
   Figure 1 with the types defined above.

3.1.1.  Compression context representation.

   The compression rule described Figure 1 is associated to a rule ID.
   The compression rule entry is defined in Figure 14.  Each column in
   the table is either represented by a leaf or a list.  Note that
   Matching Operators and Compression Decompression actions can have
   arguments.  They are viewed a ordered list of strings and numbers as
   in target values.





































Minaburo & Toutain        Expires July 26, 2020                [Page 14]

Internet-Draft           LPWAN SCHC YANG module             January 2020


  grouping compression-rule-entry {
      leaf field-id {
          mandatory true;
          type schc-id:field-id-type;
      }
      leaf field-length {
          mandatory true;
          type schc-id:field-length-type;
      }
      leaf field-position {
          mandatory true;
          type uint8;
      }
      leaf direction-indicator {
          mandatory true;
          type schc-id:direction-indicator-type;
      }
      list target-values {
          key position;

                    uses target-values-struct;
      }
      leaf mo {
          mandatory true;
          type schc-id:matching-operator-type;
      }
      // /!\ Not always good, it allows to give several arguments to a MO, but
      // theses arguments are only int or strings, cannot be arrays. Is it necessary?
      list mo-value {
          key position;
          uses target-values-struct;
      }
      leaf cda {
          mandatory true;
          type schc-id:cda-type;
      }
      list cda-value {
          key position;
                    uses target-values-struct;
      }
  }

               Figure 14: Definition of a compression entry








Minaburo & Toutain        Expires July 26, 2020                [Page 15]

Internet-Draft           LPWAN SCHC YANG module             January 2020


3.1.2.  Rule definition

   A compression rule is a list of entries.

  grouping compression-content {
    list entry {
        key "field-id field-position direction-indicator"; // field-position direction-indicator";
              uses compression-rule-entry;
    }
  }

                Figure 15: Definition of a compression rule

   To identify a specific entry Field ID, position and direction is
   needed.

3.2.  Fragmentation rule

   TBD

     grouping fragmentation-content {
          leaf dtagsize {
             type uint8;
          }
          leaf wsize {
             type uint8;
          }
          leaf fcnsize {
             type uint8;
          }
          choice mode {
             case no-ack;
                       case ack-always;
                   case ack-on-error {
                           leaf ack-method {
                                   type enumeration {
                                           enum afterAll0;
                                           enum afterAll1;
                                           enum always;
                                   }
                           }
                  }
          }
     }

               Figure 16: Definition of a fragmentation rule





Minaburo & Toutain        Expires July 26, 2020                [Page 16]

Internet-Draft           LPWAN SCHC YANG module             January 2020


3.3.  YANG Tree

module: schc
  +--rw schc
     +--rw version?   uint64
     +--rw rule* [rule-id rule-length]
        +--rw rule-id                   uint32
        +--rw rule-length               uint8
        +--rw (nature)?
           +--:(fragmentation)
           |  +--rw dtagsize?           uint8
           |  +--rw wsize?              uint8
           |  +--rw fcnsize?            uint8
           |  +--rw (mode)?
           |     +--:(no-ack)
           |     +--:(ack-always)
           |     +--:(ack-on-error)
           |        +--rw ack-method?   enumeration
           +--:(compression)
              +--rw entry* [field-id field-position direction-indicator]
                 +--rw field-id               schc-id:field-id-type
                 +--rw field-length           schc-id:field-length-type
                 +--rw field-position         uint8
                 +--rw direction-indicator    schc-id:direction-indicator-type
                 +--rw target-values* [position]
                 |  +--rw value?      union
                 |  +--rw position    uint16
                 +--rw mo                     schc-id:matching-operator-type
                 +--rw mo-value* [position]
                 |  +--rw value?      union
                 |  +--rw position    uint16
                 +--rw cda                    schc-id:comp-decomp-action-type
                 +--rw cda-value* [position]
                    +--rw value?      union
                    +--rw position    uint16


                                 Figure 17

4.  IANA Considerations

   This document has no request to IANA.

5.  Security considerations

   This document does not have any more Security consideration than the
   ones already raised on [I-D.ietf-lpwan-ipv6-static-context-hc]




Minaburo & Toutain        Expires July 26, 2020                [Page 17]

Internet-Draft           LPWAN SCHC YANG module             January 2020


6.  Acknowledgements

   The authors would like to thank Dominique Barthel, Carsten Bormann,
   Alexander Pelov.

7.  YANG Module

8.  Normative References

   [I-D.ietf-lpwan-coap-static-context-hc]
              Minaburo, A., Toutain, L., and R. Andreasen, "LPWAN Static
              Context Header Compression (SCHC) for CoAP", draft-ietf-
              lpwan-coap-static-context-hc-12 (work in progress),
              December 2019.

   [I-D.ietf-lpwan-ipv6-static-context-hc]
              Minaburo, A., Toutain, L., Gomez, C., Barthel, D., and J.
              Zuniga, "Static Context Header Compression (SCHC) and
              fragmentation for LPWAN, application to UDP/IPv6", draft-
              ietf-lpwan-ipv6-static-context-hc-24 (work in progress),
              December 2019.

   [RFC7252]  Shelby, Z., Hartke, K., and C. Bormann, "The Constrained
              Application Protocol (CoAP)", RFC 7252,
              DOI 10.17487/RFC7252, June 2014,
              <https://www.rfc-editor.org/info/rfc7252>.

Authors' Addresses

   Ana Minaburo
   Acklio
   1137A avenue des Champs Blancs
   35510 Cesson-Sevigne Cedex
   France

   Email: ana@ackl.io


   Laurent Toutain
   Institut MINES TELECOM; IMT Atlantique
   2 rue de la Chataigneraie
   CS 17607
   35576 Cesson-Sevigne Cedex
   France

   Email: Laurent.Toutain@imt-atlantique.fr





Minaburo & Toutain        Expires July 26, 2020                [Page 18]
