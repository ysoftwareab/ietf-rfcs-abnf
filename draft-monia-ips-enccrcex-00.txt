

IPS                                                            C. Monia
Internet Draft                                           Nishan Systems
Document: draft-monia-ips-enccrcex-00.txt                September 2001
Category: Individual Submission


                       Common Encapsulation CRC Format

Status of this Memo

   This document is an Internet-Draft and is in full conformance with all
   provisions of Section 10 of RFC2026 [RFC2026].

   Internet-Drafts are working documents of the Internet Engineering Task
   Force (IETF), its areas, and its working groups. Note that other groups
   may also distribute working documents as Internet-Drafts. Internet-Drafts
   are draft documents valid for a maximum of six months and may be updated,
   replaced, or obsoleted by other documents at any time. It is
   inappropriate to use Internet- Drafts as reference material or to cite
   them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.





























Monia                     Expires March 2002                  [Page 1]

                   Common Encapsulation CRC Format     September 2001




Status of this Memo.......................................................1
1.   Abstract.............................................................3
2.   Conventions used in this document....................................3
3.   Proposed Change......................................................3
4.   Security Considerations..............................................5
5.   References...........................................................5
6.   Author's Addresses...................................................5
Full Copyright Statement..................................................6












































Monia                     Expires March 2001                  [Page 2]

                   Common Encapsulation CRC Format     September 2001



1. Abstract

   This document proposes a change to the FC Common Encapsulation
   specification [ENCAP] to define how a Fibre Channel CRC is instantiated
   for transmission over an IP network.

2. Conventions used in this document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC-2119 [RFC2119].

3. Proposed Change

   As specified in [ENCAP], the method for generating the fibre channel CRC
   is fully defined in [FC-FS].  Although the process for CRC computation is
   given, the encapsulation specification does not describe how the
   resulting value is instantiated and transmitted over the IP network.

   The following proposed changes define the required format by example.

   Add the text delimited by the left and right arrows to the last paragraph
   of section 2.1 on page 6:

   " ....When the CRCV Flag bit is one, the CRC field SHALL contain a CRC
   for words 0 to 5 of the FC Encapsulation Header computed using the
   polynomial, initial value, and bit order defined for Fibre Channel [3].
   <The resulting CRC value is instantiated and formatted for transmission
   on the IP network as shown in section 3.2.>

   Modify figures 4 and 5 to show the fibre channel CRC as part of the FC
   frame.

   Add the following new section

   Start of new section

   ==============

   3.2 CRC Format

   The CRC for the header or fibre channel frame is generated and formatted
   for transmission on the IP network as shown in the following example.

   Figure 1 shows a fibre channel ACK_1 frame as it appears in memory.








Monia                     Expires March 2001                  [Page 3]

                   Common Encapsulation CRC Format     September 2001


   +--------+-------------+-------------+-------------+--------------+
   |  Word  | Byte 0(msb) | Byte 1      | Byte 2      | Byte 3 (lsb) |
   +--------+-------------+-------------+-------------+--------------+
   |   0    |     C0      |    01       |     02      |      03      |
   +--------+-------------+-------------+-------------+--------------+
   |   1    |     00      |    04       |     05      |      06      |
   +--------+-------------+-------------+-------------+--------------+
   |   2    |     00      |    C0       |     00      |      00      |
   +--------+-------------+-------------+-------------+--------------+
   |   3    |     02      |    00       |     00      |      03      |
   +--------+-------------+-------------+-------------+--------------+
   |   4    |     FF      |    FF       |     FF      |      FF      |
   +--------+-------------+-------------+-------------+--------------+
   |   5    |     00      |    00       |     00      |      00      |
   +--------+-------------+-------------+-------------+--------------+
     Figure 1 -- Memory Image of Data Block (ACK_1) in Big Endian Format

   In accordance with FC-FS [FC-FS], the CRC is generated from a bit stream
   in fibre channel format. As shown in Figure 2, the bit stream is obtained
   by transposing the contents of each byte and serializing the result
   starting with the least significant bit of word 0, byte 0.  The resulting
   CRC is appended to the bit stream as shown.

   +--------+-------------+-------------+-------------+--------------+
   |  Word  | Byte 0(msb) | Byte 1      | Byte 2      | Byte 3 (lsb) |
   +--------+-------------+-------------+-------------+--------------+
   |   0    |     03      |    80       |     40      |      C0      |
   +--------+-------------+-------------+-------------+--------------+
   |   1    |     00      |    20       |     A0      |      60      |
   +--------+-------------+-------------+-------------+--------------+
   |   2    |     00      |    03       |     00      |      00      |
   +--------+-------------+-------------+-------------+--------------+
   |   3    |     40      |    00       |     00      |      C0      |
   +--------+-------------+-------------+-------------+--------------+
   |   4    |     FF      |    FF       |     FF      |      FF      |
   +--------+-------------+-------------+-------------+--------------+
   |   5    |     00      |    00       |     00      |      00      |
   +--------+-------------+-------------+-------------+--------------+
   |  CRC   |     9B      |    61       |     F4      |      08      |
   +--------+-------------+-------------+-------------+--------------+
           Figure 2 -- Data Block and CRC in FC Bit Stream Format

   Figure 3 shows the memory image of the corresponding data block and CRC
   before encapsulation and transmission on the IP network. The CRC is an
   extension of the payload and SHALL be transmitted with the payload in
   network byte order.








Monia                     Expires March 2001                  [Page 4]

                   Common Encapsulation CRC Format     September 2001


   +--------+-------------+-------------+-------------+--------------+
   |  Word  | Byte 0(msb) | Byte 1      | Byte 2      | Byte 3 (lsb) |
   +--------+-------------+-------------+-------------+--------------+
   |   0    |     C0      |    01       |     02      |      03      |
   +--------+-------------+-------------+-------------+--------------+
   |   1    |     00      |    03       |     04      |      05      |
   +--------+-------------+-------------+-------------+--------------+
   |   2    |     00      |    C0       |     00      |      00      |
   +--------+-------------+-------------+-------------+--------------+
   |   3    |     02      |    00       |     00      |      03      |
   +--------+-------------+-------------+-------------+--------------+
   |   4    |     FF      |    FF       |     FF      |      FF      |
   +--------+-------------+-------------+-------------+--------------+
   |   5    |     00      |    00       |     00      |      00      |
   +--------+-------------+-------------+-------------+--------------+
   |  CRC   |     D9      |    86       |     2F      |      10      |
   +--------+-------------+-------------+-------------+--------------+
     Figure 3 -- Memory Image of Data Block and CRC in Big Endian format

   =================

   End of new section

4. Security Considerations

   No changes to the security considerations in [ENCAP] are required.

5. References


   [RFC2026] Bradner, S., "The Internet Standards Process -- Revision 3",
      BCP 9, RFC 2026, October 1996.

   [ENCAP] Rajagopal, M, et-al, " "FC Frame Encapsulation ", draft-ietf-ips-
      fcencapsulation-02.txt, August 2001

   [RFC2119] Bradner, S., "Key words for use in RFCs to Indicate Requirement
      Levels", BCP 14, RFC 2119, March 1997

   [FC-FS] dpANS X3.XXX-200X, "Fibre Channel Framing and Signaling
      Interface", Revision 1.2, NCITS Project 1331-D, February 2001



6. Author's Addresses

   Charles Monia

   Nishan Systems
   3850 North First Street
   San Jose, CA 95134



Monia                     Expires March 2001                  [Page 5]

                   Common Encapsulation CRC Format     September 2001


   Phone: (408) 519-3986
   Email: cmonia@nishansystems.com

Full Copyright Statement

   "Copyright (C) The Internet Society (date). All Rights Reserved.
   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implmentation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph
   are included on all such copies and derivative works. However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into




































Monia                     Expires March 2001                  [Page 6]

                   Common Encapsulation CRC Format     September 2001
























































Monia                     Expires March 2001                  [Page 7]

