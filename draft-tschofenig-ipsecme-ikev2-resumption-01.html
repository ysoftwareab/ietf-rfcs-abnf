<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>IKEv2 Session Resumption</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="IKEv2 Session Resumption">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">Y. Sheffer</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Check Point</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">Expires: May 7, 2009</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">L. Dondeti</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">V. Narayanan</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">QUALCOMM, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">November 03, 2008</td></tr>
</table></td></tr></table>
<h1><br />IKEv2 Session Resumption<br />draft-tschofenig-ipsecme-ikev2-resumption-01.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 7, 2009.</p>

<h3>Abstract</h3>

<p> The Internet Key Exchange version 2 (IKEv2) protocol has a certain computational and
    communication overhead with respect to the number of round-trips required and the cryptographic
    operations involved. In remote access situations, the Extensible Authentication Protocol (EAP)
    is used for authentication, which adds several more round trips and consequently latency. 
</p>
<p> To re-establish security associations (SA) upon a failure recovery condition is time
    consuming, especially when an IPsec peer, such as a VPN gateway, needs to re-establish a large
    number of SAs with various end points. A high number of concurrent sessions might cause
    additional problems for an IPsec peer during SA re-establishment. 
</p>
<p>In order to avoid the need to re-run the key exchange protocol from scratch it would be useful
    to provide an efficient way to resume an IKE/IPsec session. This document proposes an extension
    to IKEv2 that allows a client to re-establish an IKE SA with a gateway in a highly efficient
    manner, utilizing a previously established IKE SA. 
</p>
<p> A client can reconnect to a gateway from which it was disconnected. The proposed approach
    uses a IKEv2 state (or a reference into a state store).
    to store state information that is later made available to the IKEv2 responder for
    re-authentication. Restoring state information by utilizing a ticket is one possible way. 
    This document does not specify the format of the ticket but recommendations are provided.
   
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#usage">3.</a>&nbsp;
Usage Scenario<br />
<a href="#anchor3">4.</a>&nbsp;
Protocol Details<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#request-ticket">4.1.</a>&nbsp;
Requesting a Ticket<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#present-ticket">4.2.</a>&nbsp;
Presenting a Ticket<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#protect-resume">4.2.1.</a>&nbsp;
Protection of the IKE_SESSION_RESUME Exchange<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ticket-cookie">4.2.2.</a>&nbsp;
Presenting a Ticket: The DoS Case<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#request-resume">4.2.3.</a>&nbsp;
Requesting a ticket during resumption<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#notifications">4.3.</a>&nbsp;
IKE Notifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ticket-encoding">4.4.</a>&nbsp;
TICKET_OPAQUE Notify Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ike-sa">4.5.</a>&nbsp;
Processing Guidelines for IKE SA Establishment<br />
<a href="#anchor4">5.</a>&nbsp;
Ticket Recommendations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#content">5.1.</a>&nbsp;
Ticket Content<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#lifecycle">5.2.</a>&nbsp;
Ticket Identity and Lifecycle<br />
<a href="#anchor5">6.</a>&nbsp;
IANA Considerations<br />
<a href="#security">7.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">7.1.</a>&nbsp;
Stolen Tickets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">7.2.</a>&nbsp;
Forged Tickets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">7.3.</a>&nbsp;
Denial of Service Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">7.4.</a>&nbsp;
Ticket Protection Key Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">7.5.</a>&nbsp;
Ticket Lifetime<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">7.6.</a>&nbsp;
Ticket Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">7.7.</a>&nbsp;
Identity Privacy, Anonymity, and Unlinkability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">7.8.</a>&nbsp;
Replay Protection in the IKE_SESSION_RESUME Exchange<br />
<a href="#anchor14">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#format">Appendix&nbsp;A.</a>&nbsp;
Ticket Format<br />
<a href="#anchor17">Appendix&nbsp;B.</a>&nbsp;
Change Log<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">B.1.</a>&nbsp;
-01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">B.2.</a>&nbsp;
-00<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">B.3.</a>&nbsp;
-04<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">B.4.</a>&nbsp;
-03<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">B.5.</a>&nbsp;
-02<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">B.6.</a>&nbsp;
-01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">B.7.</a>&nbsp;
-00<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> The Internet Key Exchange version 2 (IKEv2) protocol has a certain computational and
    communication overhead with respect to the number of round-trips required and the cryptographic
    operations involved. In particular the Extensible Authentication Protocol (EAP) is used for
    authentication in remote access cases, which increases latency. 
</p>
<p> To re-establish security associations (SA) upon a failure recovery condition is
    time-consuming, especially when an IPsec peer, such as a VPN gateway, needs to re-establish a
    large number of SAs with various end points. A high number of concurrent sessions might cause
    additional problems for an IPsec responder. 
</p>
<p> In many failure cases it would be useful to provide an efficient way to resume an interrupted
    IKE/IPsec session. This document proposes an extension to IKEv2 that allows a client to
    re-establish an IKE SA with a gateway in a highly efficient manner, utilizing a previously
    established IKE SA. 
</p>
<p> A client can reconnect to a gateway from which it was disconnected. One way to ensure that
    the IKEv2 responder is able to recreate the state information is by maintaining IKEv2 state (or a reference into a state store)    
    in a
    "ticket", an opaque data structure. This ticket is created by the server and forwarded to the
    client. The IKEv2 protocol is extended to allow a client to request and
    present a ticket. 
</p>
<p> This approach is similar to the one taken by TLS session resumption <a class='info' href='#RFC4507'>[RFC4507]<span> (</span><span class='info'>Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig, &ldquo;Transport Layer Security (TLS) Session Resumption without Server-Side State,&rdquo; May&nbsp;2006.</span><span>)</span></a>
    with the required adaptations for IKEv2, e.g., to accommodate the two-phase protocol structure.
    We have borrowed heavily from that specification. 
</p>
<p> The proposed solution should additionally meet the following goals: 
</p>
<p>
    </p>
<ul class="text">
<li>Using only symmetric cryptography to minimize CPU consumption.
</li>
<li>Allowing a gateway to push state to clients.
</li>
<li>Providing cryptographic agility.
</li>
<li>Having no negative impact on IKEv2 security features. 
</li>
</ul><p>
   
</p>
<p> The following are non-goals of this solution: </p>
<ul class="text">
<li>Providing load balancing among gateways.
</li>
<li>Specifying how a client detects the need for a failover.
</li>
</ul><p>
   
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
     <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p> This document uses terminology defined in <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>, <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>,
    and <a class='info' href='#RFC4555'>[RFC4555]<span> (</span><span class='info'>Eronen, P., &ldquo;IKEv2 Mobility and Multihoming Protocol (MOBIKE),&rdquo; June&nbsp;2006.</span><span>)</span></a>. In addition, this document uses the following terms: 
</p>
<p>
    </p>
<blockquote class="text"><dl>
<dt>Ticket:</dt>
<dd>An IKEv2 ticket is a data structure that contains all the necessary
      information that allows an IKEv2 responder to 
      re-establish an IKEv2 security association.<br />

</dd>
</dl></blockquote><p>
   
</p>
<p>
    In this document we use the term ticket and thereby refer to an opaque data structure that may either contain IKEv2 state as described above or a reference pointing to such state.

</p>
<a name="usage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Usage Scenario</h3>

<p> This specification envisions two usage scenarios for efficient IKEv2 and IPsec SA session
    re-establishment. 
</p>
<p>The first is similar to the use case specified in Section 1.1.3 of the IKEv2 specification
     <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>, where the IPsec tunnel mode is used to establish a secure channel
    between a remote access client and a gateway; the traffic flow may be between the client and
    entities beyond the gateway.
</p>
<p>The second use case focuses on the usage of transport (or tunnel) mode to secure the
    communicate between two end points (e.g., two servers). The two endpoints have a client-server
    relationship with respect to a protocol that runs using the protections afforded by the IPsec
    SA. 
</p>
<p>
    <br /><hr class="insert" />
<a name="Case1GWfig"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 (a)

 +-+-+-+-+-+                          +-+-+-+-+-+
 !         !      IKEv2/IKEv2-EAP     !         !     Protected
 ! Remote  !&lt;------------------------&gt;!         !     Subnet
 ! Access  !                          ! Access  !&lt;--- and/or
 ! Client  !&lt;------------------------&gt;! Gateway !     Internet
 !         !      IPsec tunnel        !         !
 +-+-+-+-+-+                          +-+-+-+-+-+


 (b)

 +-+-+-+-+-+                          +-+-+-+-+-+
 !         !    IKE_SESSION_RESUME    !         !
 ! Remote  !&lt;------------------------&gt;!         !
 ! Access  !                          ! Access  !
 ! Client  !&lt;------------------------&gt;! Gateway !
 !         !      IPsec tunnel        !         !
 +-+-+-+-+-+                          +-+-+-+-+-+


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Resuming a Session with a Remote Access Gateway&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

   
</p>
<p> In this scenario, an end-host (an entity with a host implementation of IPsec <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> ) establishes a tunnel mode IPsec SA with a gateway in a remote network
    using IKEv2. The end-host in this scenario is sometimes referred to as a remote access client.
    At a later stage when a client needs to re-establish the IKEv2 session it may choose to
    establish IPsec SAs using a full IKEv2 exchange or the IKE_SESSION_RESUME exchange (shown in
     <a class='info' href='#Case1GWfig'>Figure&nbsp;1<span> (</span><span class='info'>Resuming a Session with a Remote Access Gateway</span><span>)</span></a>). 
</p>
<p> In this scenario, the client needs to get an IP address from the remote network so that
    traffic can be encapsulated by the remote access gateway before reaching the client. In the
    initial exchange, the gateway may acquire IP addresses from the address pool of a local DHCP
    server. The session resumption exchange may need to support the assignment of a new IP address. 
</p>
<p> The protocol defined in this document supports the re-allocation of an IP address to the
    client, if this capability is provided by the network. This capability is implicit in the use of
    the IKE configuration mechanism, which allows the client to present its existing IP address and
    receive the same address back, if allowed by the gateway. 
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protocol Details</h3>

<p>This section provides protocol details and contains the normative parts. This document defines
    two protocol exchanges, namely requesting a ticket, see <a class='info' href='#request-ticket'>Section&nbsp;4.1<span> (</span><span class='info'>Requesting a Ticket</span><span>)</span></a>, and
    presenting a ticket, see <a class='info' href='#present-ticket'>Section&nbsp;4.2<span> (</span><span class='info'>Presenting a Ticket</span><span>)</span></a>. 
</p>
<a name="request-ticket"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Requesting a Ticket</h3>

<p> A client MAY request a ticket in the following exchanges: 
</p>
<p>
     </p>
<ul class="text">
<li>In an IKE_AUTH exchange, as shown in the example message exchange in <a class='info' href='#request-ticket-example'>Figure&nbsp;2<span> (</span><span class='info'>Example Message Exchange for Requesting a Ticket</span><span>)</span></a> below.
</li>
<li>In a CREATE_CHILD_SA exchange, when an IKE SA is rekeyed.
</li>
<li>In an Informational exchange, if the gateway previously replied with an N(TICKET_ACK)
       instead of providing a ticket.
</li>
<li>In an Informational exchange, when the ticket lifetime is about to expire.
</li>
<li>In an IKE_SESSION_RESUME exchange, see <a class='info' href='#request-resume'>Section&nbsp;4.2.3<span> (</span><span class='info'>Requesting a ticket during resumption</span><span>)</span></a>.
</li>
</ul><p>
    
</p>
<p> Normally, a client requests a ticket in the third message of an IKEv2 exchange (the first of
     IKE_AUTH). <a class='info' href='#request-ticket-example'>Figure&nbsp;2<span> (</span><span class='info'>Example Message Exchange for Requesting a Ticket</span><span>)</span></a> shows the message exchange for this typical
     case. 
</p>
<p>
     <br /><hr class="insert" />
<a name="request-ticket-example"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  Initiator                Responder
  -----------              -----------
 HDR, SAi1, KEi, Ni  --&gt;

                     &lt;--    HDR, SAr1, KEr, Nr, [CERTREQ]

 HDR, SK {IDi, [CERT,] [CERTREQ,] [IDr,]
 AUTH, SAi2, TSi, TSr, N(TICKET_REQUEST)}     --&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Example Message Exchange for Requesting a Ticket&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

    
</p>
<p> The notification payloads are described in <a class='info' href='#notifications'>Section&nbsp;4.3<span> (</span><span class='info'>IKE Notifications</span><span>)</span></a>. The above is an
     example, and IKEv2 allows a number of variants on these messages. A complete description of
     IKEv2 can be found in <a class='info' href='#RFC4718'>[RFC4718]<span> (</span><span class='info'>Eronen, P. and P. Hoffman, &ldquo;IKEv2 Clarifications and Implementation Guidelines,&rdquo; October&nbsp;2006.</span><span>)</span></a>. 
</p>
<p>When an IKEv2 responder receives a request for a ticket using the N(TICKET_REQUEST) payload
     it MUST perform one of the following operations if it supports the extension defined in this
     document: </p>
<ul class="text">
<li>it creates a ticket and returns it with the N(TICKET_OPAQUE) payload in a subsequent
       message towards the IKEv2 initiator. This is shown in <a class='info' href='#request-ticket-example2'>Figure&nbsp;3<span> (</span><span class='info'>Receiving a Ticket</span><span>)</span></a>.
</li>
<li>it returns an N(TICKET_NACK) payload, if it refuses to grant a ticket for some reason.
</li>
<li>it returns an N(TICKET_ACK), if it cannot grant a ticket immediately, e.g., due to packet
       size limitations. In this case the client MAY request a ticket later using an Informational
       exchange, at any time during the lifetime of the IKE SA.
</li>
</ul><p>
    
</p>
<p> Provided the IKEv2 exchange was successful, the IKEv2 initiator can accept the requested
     ticket. The ticket may be used later with an IKEv2 responder that supports this extension.
      <a class='info' href='#request-ticket-example2'>Figure&nbsp;3<span> (</span><span class='info'>Receiving a Ticket</span><span>)</span></a> shows how the initiator receives the ticket. 
</p>
<p>
     <br /><hr class="insert" />
<a name="request-ticket-example2"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  Initiator                Responder
  -----------              -----------
         &lt;--    HDR, SK {IDr, [CERT,] AUTH, SAr2, TSi,
                     TSr, N(TICKET_OPAQUE) [,N(TICKET_GATEWAY_LIST)]}

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Receiving a Ticket&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

    
</p>
<a name="present-ticket"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Presenting a Ticket</h3>

<p>A client MAY initiate a regular (non-ticket-based) IKEv2 exchange even if it is in possession
     of a valid ticket. A client MUST NOT present a ticket when it knows that the ticket's lifetime
     has expired. 
</p>
<p>It is up to the client's local policy to decide when the communication with the IKEv2
     responder is seen as interrupted and a new exchange needs to be initiated and the session
     resumption procedure to be initiated.
</p>
<p>Tickets are intended for one-time use: a client MUST NOT reuse a ticket, either with the same
     or with a different gateway. A gateway SHOULD reject a reused ticket.
</p>
<p>This document specifies a new IKEv2 exchange type called IKE_SESSION_RESUME whose value is
     TBA by IANA. This exchange is somewhat similar to the IKE_AUTH exchange, and results in the
     creation of a Child SA. The client SHOULD NOT use this exchange type unless it knows that the
     gateway supports it. 
</p>
<p>
     </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 Initiator                Responder
 -----------              -----------
 HDR, Ni, N(TICKET_OPAQUE), [N+,]
      SK {IDi, [IDr,] SAi2, TSi, TSr [, CP(CFG_REQUEST)]} --&gt;
</pre></div><p>

    
</p>
<p>The exchange type in HDR is set to 'IKE_SESSION_RESUME'.
</p>
<p>See <a class='info' href='#protect-resume'>Section&nbsp;4.2.1<span> (</span><span class='info'>Protection of the IKE_SESSION_RESUME Exchange</span><span>)</span></a> for details on computing the protected (SK) payload.
</p>
<p>When the IKEv2 responder receives a ticket using the N(TICKET_OPAQUE) payload it MUST perform
     one of the following steps if it supports the extension defined in this document: </p>
<ul class="text">
<li>If it is willing to accept the ticket, it responds as shown in <a class='info' href='#ticket-present-success'>Figure&nbsp;4<span> (</span><span class='info'>IKEv2 Responder accepts the ticket</span><span>)</span></a>.
</li>
<li>It responds with an unprotected N(TICKET_NACK) notification, if it rejects the ticket for
       any reason. In that case, the initiator should re-initiate a regular IKE exchange. One such
       case is when the responder receives a ticket for an IKE SA that has previously been
       terminated on the responder itself, which may indicate inconsistent state between the IKEv2
       initiator and the responder. However, a responder is not required to maintain the state for
       terminated sessions.
</li>
<li>When the responder receives a ticket for an IKE SA that is still active and if the
       responder accepts it, then the old SAs SHOULD be silently deleted without sending a DELETE
      informational exchange. 
</li>
</ul><p>
    
</p>
<p>
     <br /><hr class="insert" />
<a name="ticket-present-success"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 Initiator                Responder
 -----------              -----------
                 &lt;--  HDR, SK {IDr, Nr, SAr2, [TSi, TSr],
                      [CP(CFG_REPLY)]}
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: IKEv2 Responder accepts the ticket&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

    
</p>
<p>Again, the exchange type in HDR is set to 'IKE_SESSION_RESUME'.
</p>
<p>The SK payload is protected using the cryptographic parameters derived from the ticket, see
      <a class='info' href='#protect-resume'>Section&nbsp;4.2.1<span> (</span><span class='info'>Protection of the IKE_SESSION_RESUME Exchange</span><span>)</span></a> below.
</p>
<p> At this point a new IKE SA is created by both parties, see <a class='info' href='#ike-sa'>Section&nbsp;4.5<span> (</span><span class='info'>Processing Guidelines for IKE SA Establishment</span><span>)</span></a>. This is
     followed by normal derivation of a child SA, per Section 2.17 of <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. 
</p>
<a name="protect-resume"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Protection of the IKE_SESSION_RESUME Exchange</h3>

<p>The two messages of this exchange are protected by a "subset" IKE SA. The key material is
      derived from the ticket, as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

     {SK_d2 | SK_ai | SK_ar | SK_ei | SK_er} = prf+(SK_d_old, Ni)
</pre></div>
<p> where SK_d_old is the SK_d value of the original IKE SA, as retrieved from the ticket. Ni
      guarantees freshness of the key material. SK_d2 is used later to derive the new IKE SA, see
       <a class='info' href='#ike-sa'>Section&nbsp;4.5<span> (</span><span class='info'>Processing Guidelines for IKE SA Establishment</span><span>)</span></a>. 
</p>
<p> See <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> for the notation. "prf" is determined from the SA value in the
      ticket. 
</p>
<a name="ticket-cookie"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Presenting a Ticket: The DoS Case</h3>

<p> When receiving the first message of the IKE_SESSION_RESUME exchange, the gateway may decide
      that it is under a denial-of-service attack. In such a case, the gateway SHOULD defer the
      establishment of session state until it has verified the identity of the client. We use a
      variation of the IKEv2 Cookie mechanism, whereby the cookie is protected. 
</p>
<p> In the two messages that follow, the gateway responds that it is unwilling to resume the
      session until the client is verified, and the client resubmits its first message, this time
      with the cookie: 
</p>
<p>
      </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 Initiator                Responder
 -----------              -----------
                 &lt;-- HDR, SK{N(COOKIE)}

HDR, Ni, N(TICKET_OPAQUE), [N+,]
     SK {N(COOKIE), IDi, [IDr,] SAi2, TSi, TSr [, CP(CFG_REQUEST)]} --&gt;
</pre></div><p>

     
</p>
<p> Assuming the cookie is correct, the gateway now replies normally. 
</p>
<p> This now becomes a 4-message exchange. The entire exchange is protected as defined in <a class='info' href='#protect-resume'>Section&nbsp;4.2.1<span> (</span><span class='info'>Protection of the IKE_SESSION_RESUME Exchange</span><span>)</span></a>. 
</p>
<p> See Section 2.6 and Section 3.10.1 of <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> for more guidance regarding
      the usage and syntax of the cookie. Note that the cookie is completely independent of the
      IKEv2 ticket. 
</p>
<a name="request-resume"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Requesting a ticket during resumption</h3>

<p>When resuming a session, a client will typically request a new ticket immediately, so it is
      able to resume the session again in the case of a second failure. Therefore, the
      N(TICKET_REQUEST) and N(TICKET_OPAQUE) notifications may be piggybacked as protected payloads
      to the IKE_SESSION_RESUME exchange.
</p>
<p>The returned ticket (if any) will correspond to the IKE SA created per the rules described
      in <a class='info' href='#ike-sa'>Section&nbsp;4.5<span> (</span><span class='info'>Processing Guidelines for IKE SA Establishment</span><span>)</span></a>.
</p>
<a name="notifications"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
IKE Notifications</h3>

<p> This document defines a number of notifications. The notification numbers are TBA by IANA.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Notification Name</th><th align="left">Number</th><th align="left">Data</th></tr>
<tr>
<td align="left">TICKET_OPAQUE</td>
<td align="left">TBA1</td>
<td align="left">See <a class='info' href='#ticket-encoding'>Section&nbsp;4.4<span> (</span><span class='info'>TICKET_OPAQUE Notify Payload</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">TICKET_REQUEST</td>
<td align="left">TBA2</td>
<td align="left">None</td>
</tr>
<tr>
<td align="left">TICKET_ACK</td>
<td align="left">TBA3</td>
<td align="left">None</td>
</tr>
<tr>
<td align="left">TICKET_NACK</td>
<td align="left">TBA4</td>
<td align="left">None</td>
</tr>
</table>
<br clear="all" />

<a name="ticket-encoding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
TICKET_OPAQUE Notify Payload</h3>

<p> The data for the TICKET_OPAQUE Notify payload consists of the Notify message header, a
     lifetime field and the ticket itself. The four octet lifetime field contains the number of
     seconds until the ticket expires (encoded as an unsigned integer).
</p>
<p>
     <br /><hr class="insert" />
<a name="ticket"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       0                     1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      ! Next Payload  !C!  Reserved   !      Payload Length           !
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      ! Protocol ID   ! SPI Size = 0  !    Notify Message Type        !
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      !                       Lifetime                                !
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      !                                                               !
      ~                        Ticket                                 ~
      !                                                               !
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: TICKET_OPAQUE Notify Payload&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

    
</p>
<a name="ike-sa"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Processing Guidelines for IKE SA Establishment</h3>

<p> When a ticket is presented, the gateway parses the ticket to retrieve the state of the old
     IKE SA, and the client retrieves this state from its local store. Both peers now create state
     for the new IKE SA as follows: 
</p>
<p>
     </p>
<ul class="text">
<li>The SA value (transforms etc.) is taken directly from the ticket.
</li>
<li>The sequence numbers are reset to 0.
</li>
<li>The IDi value is obtained from the ticket.
</li>
<li>The IDr value is obtained from the new exchange. The gateway MAY make policy decisions
       based on the IDr value encoded in the ticket.
</li>
<li>The SPI values are created anew, similarly to a regular IKE exchange. SPI values from the
       ticket SHOULD NOT be reused. This restriction is to avoid problems caused by collisions with
       other SPI values used already by the initiator/responder. The SPI value should only be reused
       if collision avoidance can be ensured through other means.
</li>
</ul><p>
    
</p>
<p> The cryptographic material is refreshed based on the ticket and the nonce values, Ni, and
     Nr, from the current exchange. A new SKEYSEED value is derived as follows: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

     SKEYSEED = prf(SK_d2, Ni | Nr)
</pre></div>
<p> where SK_d2 was computed earlier (<a class='info' href='#protect-resume'>Section&nbsp;4.2.1<span> (</span><span class='info'>Protection of the IKE_SESSION_RESUME Exchange</span><span>)</span></a>). 
</p>
<p> The keys are derived as follows, unchanged from IKEv2: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

     {SK_d | SK_ai | SK_ar | SK_ei | SK_er | SK_pi | SK_pr} =
                                 prf+(SKEYSEED, Ni | Nr | SPIi | SPIr)
</pre></div>
<p> where SPIi, SPIr are the SPI values created in the new IKE exchange. 
</p>
<p> See <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> for the notation. "prf" is determined from the SA value in the
     ticket. 
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Ticket Recommendations</h3>

<a name="content"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Ticket Content</h3>

<p>
     
     As noted above, the ticket represents a partial IKEv2 state, either by reference or by value. When passing the state by value, the ticket MUST contain an integrity-protected reference to partial IKEv2 state, containing the state items described further in this section. We note that such a ticket is analogous to the concept of 'stub', as defined in <a class='info' href='#I-D.xu-ike-sa-sync'>[I&#8209;D.xu&#8209;ike&#8209;sa&#8209;sync]<span> (</span><span class='info'>Xu, Y., Yang, P., Ma, Y., Deng, H., and H. Deng, &ldquo;IKEv2 SA Synchronization for session resumption,&rdquo; October&nbsp;2008.</span><span>)</span></a>, or the concept of a Session ID from TLS.
</p>
<p>     When the state is passed by value, the ticket MUST encode at least the following state from an IKE SA.  These values MUST be encrypted and authenticated.
   
</p>
<p>
     </p>
<ul class="text">
<li>IDi, IDr.
</li>
<li>SPIi, SPIr.
</li>
<li>SAr (the accepted proposal).
</li>
<li>SK_d.
</li>
</ul><p>
    
</p>
<p>In addition, the ticket MUST encode a protected ticket expiration value.
</p>
<p>The ticket MUST include a key identity field, so that encryption and authentication can be
     changed, and when necessary, algorithms can be replaced.
</p>
<a name="lifecycle"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Ticket Identity and Lifecycle</h3>

<p> Each ticket is associated with a single IKE SA. In particular, when an IKE SA is deleted,
     the client MUST delete its stored ticket. A ticket is therefore associated with the tuple (IDi,
     IDr).
</p>
<p> The lifetime of the ticket carried in the N(TICKET_OPAQUE) notification SHOULD be the
     minimum of the IKE SA lifetime (per the gateway's local policy) and its re-authentication time,
     according to <a class='info' href='#RFC4478'>[RFC4478]<span> (</span><span class='info'>Nir, Y., &ldquo;Repeated Authentication in Internet Key Exchange (IKEv2) Protocol,&rdquo; April&nbsp;2006.</span><span>)</span></a>. Even if neither of these are enforced by the gateway, a
     finite lifetime MUST be specified for the ticket. 
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This document requires a number of IKEv2 notification status types in <a class='info' href='#notifications'>Section&nbsp;4.3<span> (</span><span class='info'>IKE Notifications</span><span>)</span></a>, to be registered by IANA. The corresponding registry was established
    by IANA.
</p>
<p> The document defines a new IKEv2 exchange in <a class='info' href='#present-ticket'>Section&nbsp;4.2<span> (</span><span class='info'>Presenting a Ticket</span><span>)</span></a>. The
    corresponding registry was established by IANA. 
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p> This section addresses security issues related to the usage of a ticket. 
    The text below assumes that the IKE state is contained explicitly in the ticket ("passed by value"). 
    In most cases, there are similar risks when the state is passed by reference.
   
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Stolen Tickets</h3>

<p>An eavesdropper or man-in-the-middle may try to obtain a ticket and use it to establish a
     session with the IKEv2 responder. This can happen in different ways: by eavesdropping on the
     initial communication and copying the ticket when it is granted and before it is used, or by
     listening in on a client's use of the ticket to resume a session. However, since the ticket's
     contents is encrypted and the attacker does not know the corresponding secret key, a stolen
     ticket cannot be used by an attacker to succesfully resume a session. An IKEv2 responder MUST
     use strong encryption and integrity protection of the ticket to prevent an attacker from
     obtaining the ticket's contents, e.g., by using a brute force attack. 
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Forged Tickets</h3>

<p> A malicious user could forge or alter a ticket in order to resume a session, to extend its
     lifetime, to impersonate as another user, or to gain additional privileges. This attack is not
     possible if the ticket is protected using a strong integrity protection algorithm. 
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Denial of Service Attacks</h3>

<p>An adversary could generate and send a large number of tickets to a gateway for verification.
     To minimize the possibility of such denial of service, ticket verification should be
     lightweight (e.g., using efficient symmetric key cryptographic algorithms).
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Ticket Protection Key Management</h3>

<p> A full description of the management of the keys used to protect the ticket is beyond the
     scope of this document. A list of RECOMMENDED practices is given below. </p>
<ul class="text">
<li>The keys should be generated securely following the randomness recommendations in <a class='info' href='#RFC4086'>[RFC4086]<span> (</span><span class='info'>Eastlake, D., Schiller, J., and S. Crocker, &ldquo;Randomness Requirements for Security,&rdquo; June&nbsp;2005.</span><span>)</span></a>.
</li>
<li>The keys and cryptographic protection algorithms should be at least 128 bits in strength.
</li>
<li>The keys should not be used for any other purpose than generating and verifying tickets.
</li>
<li>The keys should be changed regularly.
</li>
<li>The keys should be changed if the ticket format or cryptographic protection algorithms
       change.
</li>
</ul><p>
    
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
Ticket Lifetime</h3>

<p> An IKEv2 responder controls the lifetime of a ticket, based on the operational and security
     requirements of the environment in which it is deployed. The responder provides information
     about the ticket lifetime to the IKEv2 initiator, allowing it to manage its tickets. 
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.6"></a><h3>7.6.&nbsp;
Ticket Format</h3>

<p> Great care must be taken when defining a ticket format such that the requirements outlined
     in <a class='info' href='#content'>Section&nbsp;5.1<span> (</span><span class='info'>Ticket Content</span><span>)</span></a> are met. In particular, if confidential information, such as a
     secret key, is transferred to the client, it MUST be done using secure communication to prevent
     attackers from obtaining or modifying the key. Also, the ticket MUST have its integrity and
     confidentiality protected with strong cryptographic techniques to prevent a breach in the
     security of the system. 
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.7"></a><h3>7.7.&nbsp;
Identity Privacy, Anonymity, and Unlinkability</h3>

<p>Since opaque state information is passed around between the IKEv2 initiator and the IKEv2 responder it is important that 
     leakage of information, such as the identities of an IKEv2 initiator and a responder, MUST be avoided (e.g., with the help of encryption. Thus, it
     prevents the disclosure of potentially sensitive information. 
</p>
<p> When an IKEv2 initiator presents a ticket as part of the IKE_SESSION_RESUME exchange,
     confidentiality is not provided for the exchange. There
     is thereby the possibility for an on-path adversary to observe multiple exchange handshakes
     where the same state information is used and therefore to conclude that they belong to the same
     communication end points.
</p>
<p>This document therefore envisions that the ticket is presented to the IKEv2 responder only once; multiple usage of the ticket is not provided. 
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.8"></a><h3>7.8.&nbsp;
Replay Protection in the IKE_SESSION_RESUME Exchange</h3>

<p>A major design goal of this protocol extension has been the two-message exchange for session
     resumption. There is a tradeoff between this abbreviated exchange and replay protection. It is
     RECOMMENDED that an IKEv2 responder should cache tickets, and reject replayed ones. However, some
     gateways may not do that in order to reduce state size. An adversary may attempt to replay a
     ticket. To mitigate these risks a client may be required by the gateway to show that it knows
     the ticket's secret, before any state is committed on the gateway side. Note that this is a
     stronger guarantee than the regular IKE cookie mechanism, which only shows IP return
     routability of the client. This is enabled by including the cookie in the protected portion of
     the message. 
</p>
<p> For performance reasons, the cookie mechanism is optional, and invoked by the gateway only
     when it suspects that it is the subject of a denial-of-service attack. 
</p>
<p> In any case, a ticket replayed by an adversary only causes partial IKE state to be created
     on the gateway. The IKE exchange cannot be completed and an IKE SA cannot be created unless the
     client knows the ticket's secret values. 
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p> We would like to thank Paul Hoffman, Pasi Eronen, Florian Tegeler, Xiaoming Fu, Stjepan Gros,
    Yoav Nir and Tero Kivinen for their many helpful comments. We would to particularly thank
    Florian Tegeler and Stjepan Gros for their help with their implementation efforts and Florian
    Tegeler for his formal verification using the CASPER tool set. 
</p>
<p>We would furthermore like to thank the authors of <a class='info' href='#I-D.xu-ike-sa-sync'>[I&#8209;D.xu&#8209;ike&#8209;sa&#8209;sync]<span> (</span><span class='info'>Xu, Y., Yang, P., Ma, Y., Deng, H., and H. Deng, &ldquo;IKEv2 SA Synchronization for session resumption,&rdquo; October&nbsp;2008.</span><span>)</span></a> for their input on using a reference to a ticket.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.rescorla-stateless-tokens">[I-D.rescorla-stateless-tokens]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-rescorla-stateless-tokens-01.txt">How to Implement Secure (Mostly) Stateless Tokens</a>,&rdquo; draft-rescorla-stateless-tokens-01 (work in progress), March&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-rescorla-stateless-tokens-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.xu-ike-sa-sync">[I-D.xu-ike-sa-sync]</a></td>
<td class="author-text">Xu, Y., Yang, P., Ma, Y., Deng, H., and H. Deng, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-xu-ike-sa-sync-01.txt">IKEv2 SA Synchronization for session resumption</a>,&rdquo; draft-xu-ike-sa-sync-01 (work in progress), October&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-xu-ike-sa-sync-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4086">[RFC4086]</a></td>
<td class="author-text">Eastlake, D., Schiller, J., and S. Crocker, &ldquo;<a href="http://tools.ietf.org/html/rfc4086">Randomness Requirements for Security</a>,&rdquo; BCP&nbsp;106, RFC&nbsp;4086, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4086.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4301">[RFC4301]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4301.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4478">[RFC4478]</a></td>
<td class="author-text">Nir, Y., &ldquo;<a href="http://tools.ietf.org/html/rfc4478">Repeated Authentication in Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4478, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4478.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4507">[RFC4507]</a></td>
<td class="author-text">Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc4507">Transport Layer Security (TLS) Session Resumption without Server-Side State</a>,&rdquo; RFC&nbsp;4507, May&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4507.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4555">[RFC4555]</a></td>
<td class="author-text">Eronen, P., &ldquo;<a href="http://tools.ietf.org/html/rfc4555">IKEv2 Mobility and Multihoming Protocol (MOBIKE)</a>,&rdquo; RFC&nbsp;4555, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4555.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4718">[RFC4718]</a></td>
<td class="author-text">Eronen, P. and P. Hoffman, &ldquo;<a href="http://tools.ietf.org/html/rfc4718">IKEv2 Clarifications and Implementation Guidelines</a>,&rdquo; RFC&nbsp;4718, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4718.txt">TXT</a>).</td></tr>
</table>

<a name="format"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Ticket Format</h3>

<p> This document does not specify a mandatory-to-implement or a mandatory-to-use ticket format.
    The following format is RECOMMENDED.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

struct {
    [authenticated] struct {
        octet format_version;    // 1 for this version of the protocol
        octet reserved[3];       // sent as 0, ignored by receiver.
        octet key_id[8];         // arbitrary byte string
        opaque IV[0..255];       // actual length (possibly 0) depends
                                 // on the encryption algorithm

        [encrypted] struct {
            opaque IDi, IDr;     // the full payloads
            octet SPIi[8], SPIr[8];
            opaque SA;           // the full SAr payload
            octet SK_d[0..255];  // actual length depends on SA value
            int32 expiration;    // an absolute time value, seconds
                                 // since Jan. 1, 1970
        } ikev2_state;
    } protected_part;
    opaque MAC[0..255];          // the length (possibly 0) depends
                                 // on the integrity algorithm
} ticket;
</pre></div>
<p> Note that the key defined by "key_id" determines the encryption and authentication
    algorithms used for this ticket. Those algorithms are unrelated to the transforms defined by
    the SA payload. 
</p>
<p> The reader is referred to a recent draft <a class='info' href='#I-D.rescorla-stateless-tokens'>[I&#8209;D.rescorla&#8209;stateless&#8209;tokens]<span> (</span><span class='info'>Rescorla, E., &ldquo;How to Implement Secure (Mostly) Stateless Tokens,&rdquo; March&nbsp;2007.</span><span>)</span></a> that
    recommends a similar (but not identical) ticket format, and discusses related security
    considerations in depth. 
</p>
<p>
   For implementations that prefer to pass a reference to IKE state in the ticket, rather than the state itself, we RECOMMEND the following format:
   
</p>
<p>
   </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

struct {
      [authenticated] struct {
          octet format_version;  // 1 for this version of the protocol
          octet reserved[3];     // sent as 0, ignored by receiver.
          octet key_id[8];       // arbitrary byte string

          struct {
              opaque state_ref;  // reference to IKE state
              int32 expiration;  // an absolute time value, seconds
                                 // since Jan. 1, 1970
          } ikev2_state_ref;
      } protected_part;
      opaque MAC[0..255];        // the length depends
                                 // on the integrity algorithm
} ticket;
</pre></div><p>

   
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Change Log</h3>

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
-01</h3>

<p>Added reference to <a class='info' href='#I-D.xu-ike-sa-sync'>[I&#8209;D.xu&#8209;ike&#8209;sa&#8209;sync]<span> (</span><span class='info'>Xu, Y., Yang, P., Ma, Y., Deng, H., and H. Deng, &ldquo;IKEv2 SA Synchronization for session resumption,&rdquo; October&nbsp;2008.</span><span>)</span></a>
</p>
<p>Included recommended ticket format into the appendix
</p>
<p>Various editorial improvements within the document
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2"></a><h3>B.2.&nbsp;
-00</h3>

<p>Issued a -00 version for the IPSECME working group. Reflected discussions at IETF#72
     regarding the strict focus on session resumption. Consequently, text about failover was
     removed. 
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.3"></a><h3>B.3.&nbsp;
-04</h3>

<p>Editorial fixes; references cleaned up; updated author's contact address 
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.4"></a><h3>B.4.&nbsp;
-03</h3>

<p> Removed counter mechanism. Added an optional anti-DoS mechanism, based on IKEv2 cookies
     (removed previous discussion of cookies). Clarified that gateways may support reallocation of
     same IP address, if provided by network. Proposed a solution outline to the problem of key
     exchange for the keys that protect tickets. Added fields to the ticket to enable
     interoperability. Removed incorrect MOBIKE notification. 
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.5"></a><h3>B.5.&nbsp;
-02</h3>

<p> Clarifications on generation of SPI values, on the ticket's lifetime and on the integrity
     protection of the anti-replay counter. Eliminated redundant SPIs from the notification
     payloads. 
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.6"></a><h3>B.6.&nbsp;
-01</h3>

<p> Editorial review. Removed 24-hour limitation on ticket lifetime, lifetime is up to local
     policy.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.7"></a><h3>B.7.&nbsp;
-00</h3>

<p> Initial version. This draft is a selective merge of draft-sheffer-ike-session-resumption-00
     and draft-dondeti-ipsec-failover-sol-00.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yaron Sheffer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Check Point Software Technologies Ltd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5 Hasolelim St.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tel Aviv  67897</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Israel</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:yaronf@checkpoint.com">yaronf@checkpoint.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lakshminath Dondeti</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">QUALCOMM, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5775 Morehouse Dr</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Diego, CA</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 858-845-1267</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ldondeti@qualcomm.com">ldondeti@qualcomm.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Vidya Narayanan</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">QUALCOMM, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5775 Morehouse Dr</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Diego, CA</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 858-845-2483</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:vidyan@qualcomm.com">vidyan@qualcomm.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
