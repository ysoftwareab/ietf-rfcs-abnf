



Sieve Working Group                                         K. Murchison
Internet-Draft                                        Oceana Matrix Ltd.
Obsoletes: 3598 (if approved)                           February 7, 2005
Expires: August 11, 2005


             Sieve Email Filtering -- Subaddress Extension
                   draft-ietf-sieve-rfc3598bis-00.txt

Status of this Memo

   This document is an Internet-Draft and is subject to all provisions
   of Section 3 of RFC 3667.  By submitting this Internet-Draft, each
   author represents that any applicable patent or other IPR claims of
   which he or she is aware have been or will be disclosed, and any of
   which he or she become aware will be disclosed, in accordance with
   RFC 3668.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as
   Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on August 11, 2005.

Copyright Notice

   Copyright (C) The Internet Society (2005).

Abstract

   On email systems that allow for "subaddressing" or "detailed
   addressing" (e.g., "ken+sieve@example.org"), it is sometimes
   desirable to make comparisons against these sub-parts of addresses.
   This document defines an extension to the Sieve mail filtering
   language that allows users to compare against the user and detail
   parts of an address.



Murchison                Expires August 11, 2005                [Page 1]

Internet-Draft        Sieve -- Subaddress Extension        February 2005


Meta-information on this document

   This information is intended to facilitate discussion.  It will be
   removed when this document leaves the Internet-Draft stage.

   This document is intended to be an update to the existing
   "subaddress" extension to the Sieve mail filtering language,
   available from the RFC repository as
   <ftp://ftp.isi.edu/in-notes/rfc3598.txt> and
   <ftp://ftp.isi.edu/in-notes/rfc3028.txt> respectively.

   This document and the Sieve language itself are being discussed on
   the MTA Filters mailing list at <mailto:ietf-mta-filters@imc.org>.
   Subscription requests can be sent to
   <mailto:ietf-mta-filters-request@imc.org?body=subscribe> (send an
   email message with the word "subscribe" in the body).  More
   information on the mailing list along with a WWW archive of back
   messages is available at <http://www.imc.org/ietf-mta-filters/>.

































Murchison                Expires August 11, 2005                [Page 2]

Internet-Draft        Sieve -- Subaddress Extension        February 2005


Table of Contents

   1.   Introduction . . . . . . . . . . . . . . . . . . . . . . . .   4
   2.   Capability Identifier  . . . . . . . . . . . . . . . . . . .   5
   3.   Subaddress Comparisons . . . . . . . . . . . . . . . . . . .   6
   4.   IANA Considerations  . . . . . . . . . . . . . . . . . . . .   8
   5.   Security Considerations  . . . . . . . . . . . . . . . . . .   9
   6.   Normative References . . . . . . . . . . . . . . . . . . . .   9
        Author's Address . . . . . . . . . . . . . . . . . . . . . .   9
   A.   Acknowledgments  . . . . . . . . . . . . . . . . . . . . . .  10
   B.   Changes since RFC3598  . . . . . . . . . . . . . . . . . . .  11
        Intellectual Property and Copyright Statements . . . . . . .  12







































Murchison                Expires August 11, 2005                [Page 3]

Internet-Draft        Sieve -- Subaddress Extension        February 2005


1.  Introduction

   Subaddressing is the practice of appending some "detail" information
   to the local-part of an [RFC2822] address to indicate that the
   message should be delivered to the mailbox specified by the "detail"
   information.  The "detail" information is prefixed with a special
   "separator character" (typically "+") which forms the boundary
   between the "user" (original local-part) and the "detail" sub-parts
   of the address, much like the "@" character forms the boundary
   between the local-part and domain.

   Typical uses of subaddressing might be:

   o  A message addressed to "ken+sieve@example.org" is delivered into a
      mailbox called "sieve" belonging to the user "ken".
   o  A message addressed to "5551212#123@example.org" is delivered to
      the voice mailbox number "123" at phone number "5551212".

   This document describes an extension to the Sieve language defined by
   [RFC3028] for comparing against the "user" and "detail" sub-parts of
   an address.

   Conventions for notations are as in [RFC3028] section 1.1, including
   use of [RFC2119].



























Murchison                Expires August 11, 2005                [Page 4]

Internet-Draft        Sieve -- Subaddress Extension        February 2005


2.  Capability Identifier

   The capability string associated with the extension defined in this
   document is "subaddress".















































Murchison                Expires August 11, 2005                [Page 5]

Internet-Draft        Sieve -- Subaddress Extension        February 2005


3.  Subaddress Comparisons

   Commands that act exclusively on addresses may take the optional
   tagged arguments ":user"  and ":detail" to specify what sub-part of
   the local-part of the address will be acted upon.

      NOTE: In most cases, the envelope "to" address is the preferred
      address to examine for subaddress information when the desire is
      to sort messages based on how they were addressed so as to get to
      a specific recipient.  The envelope address is, after all, the
      reason a given message is being processed by a given sieve script
      for a given user.  This is particularly true when mailing lists,
      aliases, and "virtual domains" are involved since the envelope may
      be the only source of detail information for the specific
      recipient.

   The ":user" argument specifies that sub-part of the local-part which
   lies to the left of the separator character (e.g., "ken" in
   "ken+sieve@example.org").  If no separator character exists, then
   ":user" specifies the entire left-side of the address (equivalent to
   ":localpart").

   The ":detail" argument specifies that sub-part of the local-part
   which lies to the right of the separator character (e.g., "sieve" in
   "ken+sieve@example.org").  If no separator character exists, the test
   evaluates to false.  If nothing lies to the right of the separator
   character, then ":detail" ":is" the null key ("").  Otherwise, the
   ":detail" sub-part contains the null key.

      NOTE: If the separator character occurs more than once in the
      local-part, then the address MUST be split at the left-most
      separator.

   Implementations MUST make sure that the separator character matches
   that which is used and/or allowed by the encompassing mail system,
   otherwise unexpected results might occur.  Implementations SHOULD
   allow the separator character to be configurable so that they may be
   used with a variety of mail systems.  Note that the mechanisms used
   to define and/or query the separator character used by the mail
   system are outside the scope of this document.

   The ":user" and ":detail" address parts are subject to the same rules
   and restrictions as the standard address parts defined in [RFC3028].

   For convenience, the "ADDRESS-PART" syntax element defined in
   [RFC3028] is augmented here as follows:

         ADDRESS-PART  =/  ":user" / ":detail"



Murchison                Expires August 11, 2005                [Page 6]

Internet-Draft        Sieve -- Subaddress Extension        February 2005


   A diagram showing the ADDRESS-PARTs of a email address utilizing a
   separator character of '+' is shown below:

          :user "+" :detail  "@" :domain
         `-----------------'
             :local-part

   Example:

      require "subaddress";

      # File mailing list messages (subscribed as "ken+mta-filters").
      if envelope :detail "to" "mta-filters" {
        fileinto "inbox.ietf-mta-filters";
      }

      # If a message is not to me (ignoring +detail), junk it.
      if not allof (address :user ["to", "cc", "bcc"] "ken",
           address :domain ["to", "cc", "bcc"] "example.org") {
        discard;

      # Redirect all mail sent to +foo.
      if envelope :detail "to" "foo" {
        redirect "ken@example.edu";
      }


























Murchison                Expires August 11, 2005                [Page 7]

Internet-Draft        Sieve -- Subaddress Extension        February 2005


4.  IANA Considerations

   This document requests that the IANA update the entry for the
   "subaddress" Sieve extension to point at this document.















































Murchison                Expires August 11, 2005                [Page 8]

Internet-Draft        Sieve -- Subaddress Extension        February 2005


5.  Security Considerations

   Security considerations are discussed in [RFC3028].  It is believed
   that this extension does not introduce any additional security
   concerns.

6.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2822]  Resnick, P., "Internet Message Format", RFC 2822, April
              2001.

   [RFC3028]  Showalter, T., "Sieve: A Mail Filtering Language",
              RFC 3028, January 2001.


Author's Address

   Kenneth Murchison
   Oceana Matrix Ltd.
   21 Princeton Place
   Orchard Park, NY  14127
   US

   Phone: +1 716 662 8973
   Email: ken@oceana.com























Murchison                Expires August 11, 2005                [Page 9]

Internet-Draft        Sieve -- Subaddress Extension        February 2005


Appendix A.  Acknowledgments

   Thanks to Tim Showalter, Alexey Melnikov, Michael Salmon, Randall
   Gellens, Philip Guenther and Jutta Degener for their help with this
   document.














































Murchison                Expires August 11, 2005               [Page 10]

Internet-Draft        Sieve -- Subaddress Extension        February 2005


Appendix B.  Changes since RFC3598

   o  Added note regarding processing of local-part with multiple
      separator characters.
   o  Fixed envelope test example to only use "to" address.














































Murchison                Expires August 11, 2005               [Page 11]

Internet-Draft        Sieve -- Subaddress Extension        February 2005


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Disclaimer of Validity

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Copyright Statement

   Copyright (C) The Internet Society (2005).  This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and
   except as set forth therein, the authors retain all their rights.


Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.




Murchison                Expires August 11, 2005               [Page 12]
