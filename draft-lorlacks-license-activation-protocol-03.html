<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>License Activation Protocol</title>
<meta content="Maximilian Lorlacks" name="author">
<meta content="
       
    This document defines an experimental method for uniform license
    activation mechanism for use in digital rights management (DRM).
       
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="licensing" name="keyword">
<meta content="license activation" name="keyword">
<meta content="digital rights management" name="keyword">
<meta content="DRM" name="keyword">
<meta content="draft-lorlacks-license-activation-protocol-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-lorlacks-license-activation-protocol-03.exp-a7qkhemh.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">License Activation Protocol</td>
<td class="right">August 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Lorlacks</td>
<td class="center">Expires 21 February 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Internet Engineering Task Force</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-lorlacks-license-activation-protocol-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-08-20" class="published">20 August 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-02-21">21 February 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Lorlacks</div>
<div class="org">Independent</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">License Activation Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
    This document defines an experimental method for uniform license
    activation mechanism for use in digital rights management (DRM).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 February 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulBare compact ulEmpty toc">
<li class="ulBare compact ulEmpty toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions" class="xref">Conventions</a></p>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-protocol" class="xref">Protocol</a></p>
<ul class="ulEmpty toc ulBare compact">
<li class="ulEmpty toc ulBare compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-provisioning" class="xref">Provisioning</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-service-discovery" class="xref">Service Discovery</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-request" class="xref">Request</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-response" class="xref">Response</a></p>
</li>
            </ul>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref"></a><a href="#name-document-history-rfc-editor" class="xref">Document History [RFC Editor: Please remove this section]</a></p>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref"></a><a href="#name-references" class="xref">References</a></p>
<ul class="ulEmpty toc ulBare compact">
<li class="ulEmpty toc ulBare compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref"></a><a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref"></a><a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
    A common issue with on-premises software licensing is ensuring that
    licensing limitations are enforced.
    Digital rights management (DRM) is an umbrella term for modeling
    legal licensing requirements in the form of executable code.
    Part of DRM implementation is often communication with a server to
    ensure central knowledge of licenses in circulation.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
    DRM implementations are in practice almost always one-off solutions
    for a particular product.
    No observable efforts to standardize DRM have been made.
    While DRM necessarily relies on either hardware or
    on security by obscurity,
    another use for DRM is to simplify license compliance for honest
    customers.
    Consolidating the license information on a single server
    within an organization brings obvious benefits for keeping track of
    software inventory,
    obviating the need of manually triangulating licenses in use.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
    It therefore seems beneficial to standardize a license management
    protocol that is both suitable for obfuscation without giving away
    too much information to active adversaries observing traffic
    and at the same time has reasonable implementation semantics for
    simplified cases where active adversaries are ignored,
    such as when it is too costly to spend great effort on software
    protection;
    modern obfuscation techniques are complex and accordingly expensive
    to implement, see e.g. <span>[<a href="#virtsc" class="xref">virtsc</a>]</span>.
    The license activation protocol presented herein aims to satisfy
    both of these needs.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
      </h2>
<p id="section-2-1">
    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY",
    and "OPTIONAL" in this document are to be interpreted as described
    in <span>[<a href="#BCP14" class="xref">BCP14</a>]</span> when, and only when,
    they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
    A "byte" refers to an octet of bits.
    It is generally assumed that fixed-szie integer types for 8-,
    16-, 32-bit integers are available.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">
    A "UUID" is a Universally Unique IDentifier in the sense of
    <span>[<a href="#RFC4122" class="xref">RFC4122</a>]</span>.
    It is always respresented as a sequence of bytes.
    The byte sequences use <em>big-endian</em> encoding for all numerical
    components of the UUID.
    For example, this means that the UUID
    "00112233-4455-6677-8899-aabbccddeeff" is encoded as the
    following sequence of bytes:
    0x00, 0x11, 0x22, 0x33,
    0x44, 0x55,
    0x66, 0x77,
    0x88,
    0x99,
    0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff.
    This is mandated by <span>[<a href="#RFC4122" class="xref">RFC4122</a>]</span>;
    <em>all other integer values in this document use little-endian encoding</em>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<aside id="section-2-4">
        <p id="section-2-4.1">
      Blocks marked up like this are "asides".
      They contain rationale or examples to clarify as well as help with interpretation of the main text,
      but are not normative sections.<a href="#section-2-4.1" class="pilcrow">¶</a></p>
</aside>
</section>
<section id="section-3">
      <h2 id="name-protocol">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol" class="section-name selfRef">Protocol</a>
      </h2>
<p id="section-3-1">
    The protocol operates between a client and a server
    in a request-response fashion.
    The client sends a request and the server sends a response.
    Both request and response are each UDP datagrams<span>[<a href="#RFC0768" class="xref">RFC0768</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
    The protocol can both be used in a direct setup (customer client and
    vendor server communicate directly over the Internet)
    and an indirect setup (customer client and customer intermediate
    server communicate directly; customer intermediate server and vendor
    server communicate with each other using this same protocol).
    Practical considerations may necessitate one or the other setup.
    The choice between the setups must be made at provisioning time.<a href="#section-3-2" class="pilcrow">¶</a></p>
<section id="section-3.1">
        <h3 id="name-provisioning">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-provisioning" class="section-name selfRef">Provisioning</a>
        </h3>
<p id="section-3.1-1">
      Prior to executing the protocol,
      every client must first be "provisioned".
      Provisioning means equipping the client with:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1-2">
      <li id="section-3.1-2.1">a UUID that remains static for the installation time of the client (client base ID),<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-2.2">a UUID that remains static for the installation time of the client and SKU (client add-on ID),<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-2.3">unique, hard-to-predict information (client seed),<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-2.4">information about the expected server.<a href="#section-3.1-2.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.1-3">
      The client IDs <span class="bcp14">MUST</span> be generated
      at installation time.
      It is <span class="bcp14">RECOMMENDED</span> that a version 4 UUID
      using a cryptographically secure random number generator is used.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">
      The client base ID refers to a "base installation";
      if there are add-ons to a product, the client add-on ID can be used to distinguish
      an activation request for the base installation and the add-on
      while still being able to correlate the requests due to different SKU fields in the request.
      If this is a base installation or no add-ons exist at all,
      the client add-on ID <span class="bcp14">MUST</span> be set to the nil UUID (all bits are zero).<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<aside id="section-3.1-5">
          <p id="section-3.1-5.1">
        For example, take an on-premise version control system hosting platform.
        The base installation needs to be activated for the product to work at all.
        Layered on top, a second activation is needed for an add-on, such as single-sign on support.
        If there were only the SKU and client ID, it would not be possible to correlate the two
        installations on the server, especially when considering NAT,
        except through use of such information in the client seed field.
        The client base ID is the same for both the base installation and the add-on SKU,
        whereas the SKU and client add-on ID vary between two activation requests.<a href="#section-3.1-5.1" class="pilcrow">¶</a></p>
</aside>
<div id="clientseed">
<p id="section-3.1-6">
      The client-side unique, hard-to-predict information (client seed)
      is typically supplied and generated at installation time.
      It could, for example, consist of a unique license key
      concatenated with hardware information.
      No format is specified;
      the actual value of the client seed is out of scope,
      but it <span class="bcp14">MUST</span> be a byte string consisting of
      one or more bytes;
      it is <span class="bcp14">RECOMMENDED</span> to include at least 16 bytes
      of cryptographically secure random data.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
</div>
<p id="section-3.1-7">
      Additionally, the client must be aware of
      its own stock-keeping unit (SKU) identifier.
      This is a UUID<span>[<a href="#RFC4122" class="xref">RFC4122</a>]</span>.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">
      The server information is typically hard-coded at compile time.
      It consists of an X25519 public key<span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>
      and an Ed25519 signing key<span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<aside id="section-3.1-9">
          <p id="section-3.1-9.1">
        In particular, this means that the server information could possibly be
        obtained dynamically during installation time,
        for example validated through some kind of public key signature system
        with only, say, a root certificate built-in at compile time.
        Similarly, it is possible to provision <em>all</em> client information
        at compile time;
        this implies that every installation package shipped is unique,
        but has the upside that all identifiers are known ahead of time and can
        be checked against a central database.<a href="#section-3.1-9.1" class="pilcrow">¶</a></p>
</aside>
</section>
<div id="service-discovery">
<section id="section-3.2">
        <h3 id="name-service-discovery">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-service-discovery" class="section-name selfRef">Service Discovery</a>
        </h3>
<p id="section-3.2-1">
      The license activation server has a
      DNS SRV record<span>[<a href="#RFC2782" class="xref">RFC2782</a>]</span>
      for the service name "lap",
      e.g. _lap._udp.licensing.example.com.
      The record describes the UDP port to use for the protocol.
      No fixed UDP port is assigned;
      the UDP port for an individual deployment may
      therefore be chosen in accordance with IANA policy and
      the constraints of the network(s) involved.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">
      The license activation server <span class="bcp14">MAY</span> be auto-discovered
      using DNS-based service discovery (DNS-SD)<span>[<a href="#RFC6763" class="xref">RFC6763</a>]</span>.
      The associated TXT record is empty.
      Individual clients <span class="bcp14">MUST</span> provide
      a documented mechanism to manually override
      an auto-discovered server address.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-3.3">
        <h3 id="name-request">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-request" class="section-name selfRef">Request</a>
        </h3>
<p id="section-3.3-1">
      Once the client has discovered the license activation server
      to use (hostname, UDP port), it sends the request.
      The request has this structure:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<span id="name-client-request-packet-struc"></span><table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-client-request-packet-struc" class="selfRef">Client request packet structure</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Size (bytes)</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Version</td>
              <td class="text-left" rowspan="1" colspan="1">Protocol version, currently always 1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Size</td>
              <td class="text-left" rowspan="1" colspan="1">Size of the request in bytes in little-endian byte order</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">ClientTime</td>
              <td class="text-left" rowspan="1" colspan="1">The client's idea of the current time in Seconds Since the Epoch</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">ClientBaseId</td>
              <td class="text-left" rowspan="1" colspan="1">Client-generated UUID uniquely identifying the base installation</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">ClientAddOnId</td>
              <td class="text-left" rowspan="1" colspan="1">Client-generated UUID uniquely identifying the installation of the add-on</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">SKUId</td>
              <td class="text-left" rowspan="1" colspan="1">Stock-keeping unit (SKU) UUID that identifies the product of the client</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">(variable)</td>
              <td class="text-left" rowspan="1" colspan="1">ClientSeed</td>
              <td class="text-left" rowspan="1" colspan="1">The client seed value</td>
            </tr>
          </tbody>
        </table>
<p id="section-3.3-3">
      There <span class="bcp14">MUST NOT</span> be any padding between the fields.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">
      The Size field is computed starting at the Version field.
      Since the client seed (and thus the ClientSeed field) is
      not permitted to be empty (see <a href="#clientseed" class="xref">Section 3.1, Paragraph 6</a>),
      the minimum value for the Size field is 73.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<div id="unix-time">
<p id="section-3.3-5">
      The term "Seconds Since the Epoch" is defined in section 4.16
      of the Base Definitions volume of <span>[<a href="#POSIX.1-2017" class="xref">POSIX.1-2017</a>]</span>;
      the "Epoch" itself is defined in section 3.150 thereof.
      "Seconds Since the Epoch" is commonly known as "UNIX time".
      This field is 5 bytes in length to ensure this protocol working
      at least until the year 10,000.
      This integer value is transmitted in little-endian byte order and does not
      include fractions of a second.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
</div>
<div id="key-derivation">
<p id="section-3.3-6">
      The client then generates an ephemeral
      X25519<span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> key pair.
      Therefore, the client <span class="bcp14">MUST</span> have access to a
      cryptographically secure random number generator.
      It performs X25519 with its ephemeral key and the server's public
      key that was obtained at provisioning time.
      The nonce is set to 0.
      The key is the result of applying HKDF<span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>
      as follows, where | signifies concatenation:<a href="#section-3.3-6" class="pilcrow">¶</a></p>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3.3-7">
      <li id="section-3.3-7.1">Hash = SHA-512<span>[<a href="#SHS" class="xref">SHS</a>]</span> (thus HashLen = 64)<a href="#section-3.3-7.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-7.2">PRK = HKDF-Extract(salt=none, IKM=client's ephemeral X25519 public key |
        server's X25519 public key |
        server's Ed25519 public key |
        the X25519 shared secret)<a href="#section-3.3-7.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-7.3">OKM = HKDF-Expand(PRK, info=[ASCII representation of "56065c4d-d2e0-4ba9-bf9f-76f9159e2987-LAP-V02"], L=64)<a href="#section-3.3-7.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-7.4">the symmetric key for the client-to-server packet is now the first 32 bytes of OKM;<a href="#section-3.3-7.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-7.5">the symmetric key for the server-to-client packet is now the second 32 bytes of OKM.<a href="#section-3.3-7.5" class="pilcrow">¶</a>
</li>
        </ol>
<aside id="section-3.3-8">
          <p id="section-3.3-8.1">
        Since this use of HKDF is trivial, determining PRK and OKM in practice simplifies to:<a href="#section-3.3-8.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-8.2">
        <li id="section-3.3-8.2.1">PRK = HMAC-SHA512(key=[64 all-zero bytes], msg=client's ephemeral X25519 public key |
          server's X25519 public key |
          server's Ed25519 public key |
          the X25519 shared secret)<a href="#section-3.3-8.2.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.3-8.2.2">OKM = HMAC-SHA512(key=PRK, msg=[ASCII representation of "56065c4d-d2e0-4ba9-bf9f-76f9159e2987-LAP-V02"] | 0x01)<a href="#section-3.3-8.2.2" class="pilcrow">¶</a>
</li>
          </ol>
</aside>
<p id="section-3.3-9">
      The encryption key is used with ChaCha20 and Poly1305
      (AEAD_CHACHA20_POLY1305)<span>[<a href="#RFC8439" class="xref">RFC8439</a>]</span>
      to encrypt the request.
      There is no additional authenticated data.
      The client then transmits:<a href="#section-3.3-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-10">
      <li id="section-3.3-10.1">its 32-byte ephemeral X25519 public key;<a href="#section-3.3-10.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-10.2">the encrypted request;<a href="#section-3.3-10.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-10.3">the 16-byte Poly1305 authentication tag.<a href="#section-3.3-10.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-11">
      The client <span class="bcp14">MUST</span> transmit this information
      in a single UDP packet,
      in that particular order and
      without padding inbetween
      to the server.
      This implies that a packet may not exceed the size of what
      can be transmitted in a single UDP packet.<a href="#section-3.3-11" class="pilcrow">¶</a></p>
</section>
<section id="section-3.4">
        <h3 id="name-response">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-response" class="section-name selfRef">Response</a>
        </h3>
<p id="section-3.4-1">
      Before issuing a response, the server validates
      the client's request.
      If the result of the validation process is negative,
      the server does not respond to the request and
      drops the UDP packet.
      Clients <span class="bcp14">MUST NOT</span> probe whether servers drop
      invalid requests.
      In particular, the server <span class="bcp14">MUST</span> validate that:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.4-2">
      <li id="section-3.4-2.1">the result of the X25519 function is not all-zero;<a href="#section-3.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.2">decryption succeeded (Poly1305 tag is valid);<a href="#section-3.4-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.3">the Version field is 1;<a href="#section-3.4-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.4">the Size field is equal to or greater than 73;<a href="#section-3.4-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.5">the ClientTime fields match the server's idea
        of the current time
        with at most 30 seconds of difference;<a href="#section-3.4-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.6">the SKU ID is known to the server;<a href="#section-3.4-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.7">the SKU ID may be for a base installation if the ClientAddOnId is the nil UUID
        or that the SKU ID may be used for an add-on installation if the ClientAddOnId is not the nil UUID;<a href="#section-3.4-2.7" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.8">the ClientSeed field is valid according to the rules known
        to the server;<a href="#section-3.4-2.8" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.9">the client is licensed according to the rules known to the server.<a href="#section-3.4-2.9" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.4-3">
      Additionally, the server <span class="bcp14">MAY</span> check whether the UUIDs
      match the generation procedures outlined in <span>[<a href="#RFC4122" class="xref">RFC4122</a>]</span>
      and follow the expected UUID generation algorithm for that particular SKU.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<aside id="section-3.4-4">
          <p id="section-3.4-4.1">
        There is no impetus to validate the UUID format of the UUIDs sent
        by the client closely.
        For one, it is possible that new UUID formats will be released and used,
        otherwise causing churn on the server-side if the teams working on the
        clients and the server work separately.
        On the other hand, if the type of UUID is known ahead of time,
        it may be an extra vector of verification;
        however, it is questionable if much beyond UUID variant and version
        can even be verified.
        Time-based UUIDs cannot be checked for accuracy because at installation
        time, the system may not yet have had access to a network-synchronized
        clock.
        The node ID does not have to be an IEEE 802 address (and,
        for privacy reasons, shouldn't be one in the first place),
        so there is not much to verify there.
        Name-based UUIDs would, however, lend themselves to extra validation.
        Choosing an appropriate name space and data is out of scope for this
        document.
        It remains questionable if this has any tangible benefit.<a href="#section-3.4-4.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-3.4-5">
      If the validation passes,
      the server sends the following response structure:<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<span id="name-server-response-packet-stru"></span><table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-server-response-packet-stru" class="selfRef">Server response packet structure</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Size (bytes)</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Version</td>
              <td class="text-left" rowspan="1" colspan="1">Protocol version, currently always 1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Size</td>
              <td class="text-left" rowspan="1" colspan="1">Size of the response in bytes in little-endian byte order</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">ServerTime</td>
              <td class="text-left" rowspan="1" colspan="1">The server's idea of the current time in Seconds Since the Epoch in little-endian byte order, see <a href="#unix-time" class="xref">Section 3.3, Paragraph 5</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">ClientId</td>
              <td class="text-left" rowspan="1" colspan="1">The client-generated UUID echoed back</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">SKUId</td>
              <td class="text-left" rowspan="1" colspan="1">The SKU ID echoed back</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">LicenseId</td>
              <td class="text-left" rowspan="1" colspan="1">A UUID that identifies the license; in case of volume licensing, multiple clients <span class="bcp14">MAY</span> share the same value</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">(variable)</td>
              <td class="text-left" rowspan="1" colspan="1">ServerData</td>
              <td class="text-left" rowspan="1" colspan="1">Application-specific data for the client, which <span class="bcp14">MAY</span> be empty</td>
            </tr>
          </tbody>
        </table>
<p id="section-3.4-7">
      There <span class="bcp14">MUST NOT</span> be any padding between the fields.<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<p id="section-3.4-8">
      The Size field is computed starting at the Version field,
      i.e. the very beginning of the message.
      Since the server data is permitted to be empty,
      the minimum value for the Size field is 56.<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<p id="section-3.4-9">
      The ClientId field refers to the client-generated ClientBaseId if ClientAddOnId was the nil UUID
      and to the ClientAddOnId otherwise.<a href="#section-3.4-9" class="pilcrow">¶</a></p>
<p id="section-3.4-10">
      The ServerData field may be used, for example,
      to transmit a date/time by which the client must consider itself
      de-activated and needs to re-authenticate
      or to transmit feature flags that are supposed to be enabled.<a href="#section-3.4-10" class="pilcrow">¶</a></p>
<p id="section-3.4-11">
      The server encryption key that was derived in <a href="#key-derivation" class="xref">Section 3.3, Paragraph 6</a> is
      then used to encrypt the response.
      The nonce is set to 0.
      There is no additional authenticated data.
      The server then transmits:<a href="#section-3.4-11" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.4-12">
      <li id="section-3.4-12.1">its 64-byte Ed25519 signature over the rest;<a href="#section-3.4-12.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-12.2">the encrypted response;<a href="#section-3.4-12.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-12.3">the 16-byte Poly1305 authentication tag.<a href="#section-3.4-12.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.4-13">
      The server <span class="bcp14">MUST</span> transmit this information
      in a single UDP packet,
      in that particular order and
      without padding inbetween
      to the client.
      This implies that a packet may not exceed the size of what
      can be transmitted in a single UDP packet.<a href="#section-3.4-13" class="pilcrow">¶</a></p>
<p id="section-3.4-14">
      The client finally validates the server response according to the
      criteria it deems fit, but it <span class="bcp14">MUST</span> at least verify
      the Ed25519 signature.
      The client considers itself activated if the response validated
      successfully.<a href="#section-3.4-14" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">
    The client <span class="bcp14">SHOULD NOT</span> be considered trusted.
    Tampering with DRM is a notorious issue.
    In particular, as noted in the previous sections,
    an implementation <span class="bcp14">MUST</span> verify all inputs rigorously.
    Conversely, the client <span class="bcp14">SHOULD NOT</span> rely
    on the server's response being well-formed in principle;
    practical considerations (such as with embedded microprocessors)
    may necessitate this nonetheless.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
    All routines and secrets pertaining to DRM <span class="bcp14">SHOULD</span>
    be protected by hardware-based mechanisms
    such as trusted platform modules (TPMs),
    hardware security modules (HSMs),
    and trusted execution environment technologies.
    Obfuscation can also aid longevity of DRM by deterring
    insufficiently motivated attackers.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">
    The server information secrets <span class="bcp14">SHOULD</span> be protected
    by hardware security modules.
    Cloud-based hardware security modules <span class="bcp14">MAY</span> be chosen for this task.
    It is <span class="bcp14">RECOMMENDED</span> that accesses to these keys is monitored;
    for example, an automated system could cross-reference accesses to
    the secrets with timing of incoming requests.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
    While the contents of activation responses in the ServerData field
    are unspecified, 
    because activation procedures are often time-limited,
    the accuracy of the client's clock is important.
    Otherwise, the server may issue responses that are too far into
    the future or already in the past for the client,
    bypassing temporal licensing limitations.
    It is therefore <span class="bcp14">RECOMMENDED</span> that clients synchronize
    their time over the network, for example using NTP<span>[<a href="#RFC5905" class="xref">RFC5905</a>]</span>.<a href="#section-4-4" class="pilcrow">¶</a></p>
<aside id="section-4-5">
        <p id="section-4-5.1">
      While an accurate clock on the host system should by now have become the
      norm, it is still not possible to rely on the existence of one.
      SNTP, which is essentially a stripped-down version of NTP for clients
      and also described in <span>[<a href="#RFC5905" class="xref">RFC5905</a>]</span>,
      is relatively easy to implement.
      It is therefore considered no issue to obtain an accurate timestamp
      when one is required.<a href="#section-4-5.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-4-6">
    In considering an implementation,
    care should be taken to avoid network amplification attacks.
    Notably, the server response packet <span class="bcp14">SHOULD NOT</span> exceed
    the size of a client packet under any circumstances.<a href="#section-4-6" class="pilcrow">¶</a></p>
<aside id="section-4-7">
        <p id="section-4-7.1">
      Larger server response packets may be an option in highly trusted setups
      or on a delegated setup with an intermediate server on the local network,
      where the software vendor does not bear the cost of the network traffic.
      However, this is rare.
      It is possible that the language may change from a recommendation
      to a hard requirement in the future.<a href="#section-4-7.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-4-8">
    Using a fixed nonce for the encryption of the request and response is
    unproblematic because there is a new AEAD_CHACHA20_POLY1305 key for every request.
    Nonces only need to be unique per key.
    Access to a cryptographically secure random number generator is
    required.
    It is therefore no issue to fix the nonce since keys are guaranteed
    to be unique.<a href="#section-4-8" class="pilcrow">¶</a></p>
</section>
<div id="IANA">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">
    The discovery mechanism described in section
    <a href="#service-discovery" class="xref">Section 3.2</a> requires a service name.
    The Service Name and Transport Protocol Port Number Registry
    therefore needs to be updated accordingly.
    In accordance with <span>[<a href="#BCP165" class="xref">BCP165</a>]</span>,
    it is hereby requested that IANA create a new entry in
    the Service Name and Transport Protocol Port Number Registry
    reading:<a href="#section-5-1" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
        <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Service Name</td>
            <td class="text-left" rowspan="1" colspan="1">lap</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Transport Protocols</td>
            <td class="text-left" rowspan="1" colspan="1">udp</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Assignee</td>
            <td class="text-left" rowspan="1" colspan="1">Maximilian Lorlacks &lt;maxlorlax@protonmail.com&gt;</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Contact</td>
            <td class="text-left" rowspan="1" colspan="1">Maximilian Lorlacks &lt;maxlorlax@protonmail.com&gt;</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Description</td>
            <td class="text-left" rowspan="1" colspan="1">License Activation Protocol</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Reference</td>
            <td class="text-left" rowspan="1" colspan="1">[this document]</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Port Number</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Service Code</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Known Unauthorized Uses</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Assignment Notes</td>
            <td class="text-left" rowspan="1" colspan="1">Defined TXT keys: None.</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<section id="section-6">
      <h2 id="name-document-history-rfc-editor">
<a href="#name-document-history-rfc-editor" class="section-name selfRef">Document History [RFC Editor: Please remove this section]</a>
      </h2>
<p id="section-6-1">Note to the RFC Editor: Please remove this section before publication.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
    draft-lorlacks-license-activation-protocol-03<a href="#section-6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-3.1">A pedantic note regarding the definition of a "byte" has been added.<a href="#section-6-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.2">Drop the requirement to validate UUIDs per se.
      It seems exceedingly unrealistic for an attacker to be able to desync the UUID in a meaningful way.
      Assume network interference: The Poly1305 tag identifies this.
      Assume unauthorized code modification: A reverse engineer would not blindly flip bytes in the code;
      if anything, the UUID generation code would be identified, labeled and then mostly ignored
      because it's not very interesting.
      The SKU IDs are known to the server ahead of time, so validation is pointless.
      The request IDs are client-generated and thus mostly meaningless.
      The only exception to this are UUIDv1 and v2, which contain actual time information,
      which an attacker may genuinely forget about and thus give away tampering easily.<a href="#section-6-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.3">Remove the request ID from the Request packet.
      A client-generated request ID may be helpful, but is untrusted.
      An attacker may intentionally modify request IDs to impersonate another client's request ID,
      so request IDs may not be relied upon for anything in the first place.
      In its place, the client ID was split into the client installation ID and client product ID.<a href="#section-6-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.4">Bump the version field from 0 to 1 in light of the aforementioned change.<a href="#section-6-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.5">Do not assume version 1 UUIDs are the only kind of UUID with time information.
      Version 2 UUIDs also contain time informations (though RFC 4122 does not explicitly
      detail them), and looking at the work in draft-peabody-dispatch-new-uuid-format,
      it is quite possible that new UUID formats with time information may follow on the future.
      Not accounting for this would just cause unnecessary churn in this document immediately thereafter.
      Not only that, but the client IDs are generated at <em>installation</em> time,
      so by the time they're sent over the wire, their timestamps have become completely meaningless.<a href="#section-6-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.6">Clarify that the server validation of the client packet is a requirement.<a href="#section-6-3.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.7">Fix one more instance of grammatical fall-out from the removal of the ClientDate/ClientTime split.<a href="#section-6-3.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.8">Add various &lt;aside&gt;s with additional explanations and rationale.<a href="#section-6-3.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-3.9">Clarify HKDF info constant to be the ASCII representation of the string.<a href="#section-6-3.9" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-4">
    draft-lorlacks-license-activation-protocol-02<a href="#section-6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-5.1">Replaced a custom BLAKE2b key derivation with HKDF using SHA-512 for key exchange.
      Ed25519 has a hard requirement on SHA-512 anyway,
      so having redundant hash function is wasteful spending of code size resources.<a href="#section-6-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-5.2">Split the single symmetric key into two symmetric keys, one for each side.
      Additionally, this simplifies nonce handling in that both nonces can be all-zero.<a href="#section-6-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-5.3">Removed specification of the counter value for the ChaPoly construction.
      The pertinent RFC already says how the counter value should be handled,
      so this was pointless at best and contradictory at worst.<a href="#section-6-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-5.4">Replaced mention of "ChaPoly" in the text with the formal name.<a href="#section-6-5.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-6">
    draft-lorlacks-license-activation-protocol-01<a href="#section-6-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-7.1">Because IETF ChaCha20 doesn't use numeric nonces like djb ChaCha20 but rather a concatendation
      of three 32-bit little-endian integers for the nonce,
      the statement "The nonce is set to 1." in the Response section was unclear.
      This was clarified to mean the first byte (= first 32-bit little-endian integer).<a href="#section-6-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-7.2">Removed references to a ClientDate field in the request.
      This was an artifact from early in development and entirely superseded by ClientTime.<a href="#section-6-7.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-7.3">Made the Poly1305 tag come after the encrypted request;
      the previous version violated section 2.8 of RFC 8439 by putting the tag first.<a href="#section-6-7.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-7.4">Actually use the X25519 shared secret in the key derivation function.<a href="#section-6-7.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-7.5">Specified endianness of UUID byte representation;
      simultaneously removed copious amounts of xref tags to RFC 4122.<a href="#section-6-7.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-7.6">Moved reference to RFC 5905 to the informative references as
      usage of NTP is only a suggestion, not a requirement.
      (The provenance thereof as a normative suggestion dates back to a
      very early draft that used the NTP date and timestamp formats
      instead of five-byte UNIX time.)<a href="#section-6-7.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-7.7">Added a section to the Security Consideration on why fixing the nonces is safe.<a href="#section-6-7.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-7.8">Made access to a cryptographically secure random number generator a requirement.<a href="#section-6-7.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-7.9">Gave &lt;name&gt;s to all content tables.<a href="#section-6-7.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-7.10">Fixed a formatting issue where a BCP14 "MAY" wasn't marked up as such in the Service Discovery section.<a href="#section-6-7.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-7.11">Fixed a formatting issue regarding a reference within the Request section.<a href="#section-6-7.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-7.12">Grammar fix (lower-case continuation after semicolon in the Provisioning section)<a href="#section-6-7.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-7.13">Grammar fix ("If a client-generated UUID contain a timestamp [...]" -&gt; "contains")<a href="#section-6-7.13" class="pilcrow">¶</a>
</li>
      </ul>
</section>
<section id="section-7">
      <h2 id="name-references">
<a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BCP14">[BCP14]</dt>
        <dd><div class="refInstance" id="RFC2119">
            <span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>. </div>
<div class="refInstance" id="RFC8174">
            <span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>. </div>
<span>&lt;<a href="https://www.rfc-editor.org/info/bcp14">https://www.rfc-editor.org/info/bcp14</a>&gt;</span>
</dd>
<dd class="break"></dd>
<dt id="BCP165">[BCP165]</dt>
        <dd><div class="refInstance" id="RFC6335">
            <span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Eggert, L.</span>, <span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Westerlund, M.</span>, and <span class="refAuthor">S. Cheshire</span>, <span class="refTitle">"Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry"</span>, <span class="seriesInfo">BCP 165</span>, <span class="seriesInfo">RFC 6335</span>, <time datetime="2011-08" class="refDate">August 2011</time>. </div>
<div class="refInstance" id="RFC7605">
            <span class="refAuthor">Touch, J.</span>, <span class="refTitle">"Recommendations on Using Assigned Transport Port Numbers"</span>, <span class="seriesInfo">BCP 165</span>, <span class="seriesInfo">RFC 7605</span>, <time datetime="2015-08" class="refDate">August 2015</time>. </div>
<span>&lt;<a href="https://www.rfc-editor.org/info/bcp165">https://www.rfc-editor.org/info/bcp165</a>&gt;</span>
</dd>
<dd class="break"></dd>
<dt id="POSIX.1-2017">[POSIX.1-2017]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"Standard for Information Technology--Portable Operating System Interface (POSIX(R)) Base Specifications, Issue 7"</span>, <span class="seriesInfo">IEEE 1003.1, 2017 Edition</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2018.8277153</span>, <time datetime="2017-01-31" class="refDate">31 January 2017</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/servlet/opac?punumber=8277151">https://ieeexplore.ieee.org/servlet/opac?punumber=8277151</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0768">[RFC0768]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08" class="refDate">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc768">https://www.rfc-editor.org/info/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2782">[RFC2782]</dt>
        <dd>
<span class="refAuthor">Gulbrandsen, A.</span>, <span class="refAuthor">Vixie, P.</span>, and <span class="refAuthor">L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time datetime="2000-02" class="refDate">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2782">https://www.rfc-editor.org/info/rfc2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4122">[RFC4122]</dt>
        <dd>
<span class="refAuthor">Leach, P.</span>, <span class="refAuthor">Mealling, M.</span>, and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"A Universally Unique IDentifier (UUID) URN Namespace"</span>, <span class="seriesInfo">RFC 4122</span>, <span class="seriesInfo">DOI 10.17487/RFC4122</span>, <time datetime="2005-07" class="refDate">July 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4122">https://www.rfc-editor.org/info/rfc4122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6763">[RFC6763]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"DNS-Based Service Discovery"</span>, <span class="seriesInfo">RFC 6763</span>, <span class="seriesInfo">DOI 10.17487/RFC6763</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6763">https://www.rfc-editor.org/info/rfc6763</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8439">[RFC8439]</dt>
        <dd>
<span class="refAuthor">Nir, Y.</span> and <span class="refAuthor">A. Langley</span>, <span class="refTitle">"ChaCha20 and Poly1305 for IETF Protocols"</span>, <span class="seriesInfo">RFC 8439</span>, <span class="seriesInfo">DOI 10.17487/RFC8439</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8439">https://www.rfc-editor.org/info/rfc8439</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHS">[SHS]</dt>
      <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Secure Hash Standard (SHS)"</span>, <span class="seriesInfo">FIPS PUB 180-4</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.180-4</span>, <time datetime="2015-08-04" class="refDate">4 August 2015</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.FIPS.180-4">https://doi.org/10.6028/NIST.FIPS.180-4</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC5905">[RFC5905]</dt>
        <dd>
<span class="refAuthor">Mills, D.</span>, <span class="refAuthor">Martin, J., Ed.</span>, <span class="refAuthor">Burbank, J.</span>, and <span class="refAuthor">W. Kasch</span>, <span class="refTitle">"Network Time Protocol Version 4: Protocol and Algorithms Specification"</span>, <span class="seriesInfo">RFC 5905</span>, <span class="seriesInfo">DOI 10.17487/RFC5905</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5905">https://www.rfc-editor.org/info/rfc5905</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="virtsc">[virtsc]</dt>
      <dd>
<span class="refAuthor">Ahmadvand, M.</span>, <span class="refAuthor">Below, D.</span>, <span class="refAuthor">Banescu, S.</span>, and <span class="refAuthor">A. Pretschner</span>, <span class="refTitle">"VirtSC: Combining Virtualization Obfuscation with Self-Checksumming"</span>, <span class="seriesInfo">SPRO '19, Proceedings of the 3rd ACM Workshop on Software Protection pp. 53-64</span>, <span class="seriesInfo">DOI 10.1145/3338503.3357723</span>, <time datetime="2019-11" class="refDate">November 2019</time>, <span>&lt;<a href="https://doi.org/10.1145/3338503.3357723">https://doi.org/10.1145/3338503.3357723</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Maximilian Lorlacks</span></div>
<div dir="auto" class="left"><span class="org">Independent</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:maxlorlax@protonmail.com" class="email">maxlorlax@protonmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
