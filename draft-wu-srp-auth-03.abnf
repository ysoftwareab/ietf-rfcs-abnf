i = S[n-1] + 256 * S[n-2] + 256^2 * S[n-3] + ... + 256^(n-1) * S[0]

x = SHA(<salt> | SHA(<username> | ":" | <raw password>))
U = <username>              -->
                                    <--    s = <salt from passwd file>

a = random()
A = g^a % N                 -->
v = <stored password verifier>
b = random()
p = <raw password>
x = SHA(s | SHA(U | ":" | p))

S = (B - g^x) ^ (a + u * x) % N    S = (A * v^u) ^ b % N
K = SHA_Interleave(S)              K = SHA_Interleave(S)
M = H(H(N) XOR H(g) | H(U) | s | A | B | K)
                                    -->
                                    <--    H(A | M | K)

E = T[0] | T[2] | T[4] | ...
F = T[1] | T[3] | T[5] | ...

G = SHA(E)
H = SHA(F)

result = G[0] | H[0] | G[1] | H[1] | ... | G[19] | H[19]

