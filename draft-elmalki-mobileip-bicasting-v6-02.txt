


Mobile IP Working Group                                   Karim El Malki
INTERNET-DRAFT                                            Hesham Soliman
Expires: Dec 2002                                            Ericsson AB


                                                               June 2002


            Simultaneous Bindings for Mobile IPv6 Fast Handoffs
               <draft-elmalki-mobileip-bicasting-v6-02.txt>


Status of this memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC 2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that other
   groups may also distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time. It is inappropriate to use Internet-Drafts as reference
   material or cite them other than as "work in progress".

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/lid-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   This document is an individual submission to the IETF.


Abstract

   Fast Handover for Mobile IPv6 [1] and Bidirectional Edge Tunnel
   Handover [1] describe protocols to minimise the amount of service
   disruption when performing layer-3 handoffs. This draft extends the
   Fast Handover protocol with a simultaneous bindings function and the
   BETH capabilities with a bicasting function to minimise packet loss
   at the MN. Traffic for the MN is therefore bicast or n-cast for a
   short period to its current location and to one or more locations
   where the MN is expected to move to shortly. This removes the timing
   ambiguity regarding when to start sending traffic for the MN to its
   new point of attachment followng a Fast Handover and allows the
   decoupling of layer-2 and layer-3 handoffs. It also saves the MN
   periods of service disruption in the case of ping-pong movement.




El Malki and Soliman                                            [Page 1]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002



TABLE OF CONTENTS

   1. Introduction.....................................................2
   1.1 Terminology.....................................................3

   2. Simultaneous Bindings............................................3

   3. Fast Handovers in Mobile IPv6....................................4

   4. Bidirectional Edge Tunnel Handover (BETH)........................5

   5. Decoupling L3 Handoffs from L2 handoffs using Simultaneous
   Bindings ...........................................................6

   6. Avoiding service disruption due to ping-pong movement............7

   7. Changes to the Fast Handover and BETH Operations.................7
      7.1 MN Operation ................................................7
      7.1 HA/MAP/AR Operation .........................................8

   8. Simultaneous Bindings Flag in Fast Binding Update (F-BU) message.9

   9. Simultaneous Bindings suboption for Fast Binding Acknowledgement.9
   (F-BA) message......................................................9

   10. Multiple copies of packets received at AR......................10

   11. Reception of multiple copies in the MN.........................10

   12. References.....................................................10

   13. Authors' Addresses.............................................11

   14. Full Copyright Statement.......................................12


1. Introduction

   Fast Handover for Mobile IPv6 [1] and Bidirectional Edge Tunnel
   Handover [1] describe protocols to minimise the amount of service
   disruption when performing layer-3 handoffs. This draft extends the
   Fast Handover protocol with a simultaneous bindings function and the
   BETH capabilities with a bicasting function to minimise packet loss
   at the MN. Traffic for the MN is therefore bicast or n-cast for a
   short period to its current location and to one or more locations
   where the MN is expected to move to shortly. This removes the timing
   ambiguity regarding when to start sending traffic for the MN to its
   new point of attachment followng a Fast Handover and allows the
   decoupling of layer-2 and layer-3 handoffs. It also saves the MN
   periods of service disruption in the case of ping-pong movement.



El Malki and Soliman                                            [Page 2]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


   Appendix A contains some calculations illustrating how to achieve
   zero service disruption at L3 using [1] and bicasting.


1.1 Terminology

   This section presents a few terms used throughout the document.

      oAR _ old Access Router.

      nAR - new Access Router.

      L2 handoff - Movement of a MN's point of Layer 2 (L2)
         connection from one wireless access point to another.

      L3 handoff - Movement of a MN between ARs which involves
         changing the on-link care-of address at Layer 3 (L3).

      L2 trigger - Information from L2 that informs L3 of particular
         events before and after L2 handoff. The descriptions of L2
         triggers in this document are not specific to any particular
         L2, but rather represent generalizations of L2 information
         available from a wide variety of L2 protocols.

      Bicasting/n-casting - The splitting of a stream of packets
         destined for a MN via its current AR (the oAR) into two or
         more streams, and the simultaneous transmission of the
         streams to oAR and one or more nAR. Bicasting is a technique
         used to reduce packet loss during handover.

      ping-ponging - Rapid back and forth movement between two
         wireless access points due to failure of L2 handoff. Ping-
         ponging can occur if radio conditions for both the old and
         new access points are about equivalent and less than optimal
         for establishing a good, low error L2 connection.


2. Simultaneous Bindings

   Simultaneous bindings are built into the Mobile IPv4 protocol [2]. To
   enable multiple simultaneous bindings using Mobile IPv4 the MN simply
   sends the first normal Registration Request for a care-of address and
   then sends other Registration messages for another set of care-of
   addresses having the `S' bit set. The receiver of the Registration
   Requests (e.g. the HA) will then maintain all these care-of address
   bindings for the MN contemporarily rather than only servicing the MN
   at the care-of address in its most recent Registration Request (which
   would be the case had the `S' bit not been set). This results in
   bicasting or n-casting of packets to all the care-of addresses. This
   draft extends the Mobile IPv6 protocol [3] with similar functionality
   and describes a new Simultaneous Bindings flag for the Fast Binding



El Malki and Soliman                                            [Page 3]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


   Update in [1]. Although BETH [1] is not based on MN Binding Updates,
   it is possible to extend it with the same resulting bicasting
   capability.

   Multiple simultaneous bindings and bicasting can be an important tool
   to decouple L3 handoffs from L2 handoffs and to reduce packet loss.
   In [1] this mechanism instructs the recipient of the F-BU with the
   simultaneous bindings flag to make multiple copies of packets
   destined to the MN and send them to multiple MN care-of addresses
   before the MN actually moves there. In a similar way for BETH [1]
   this mechanism instructs the anchor FA (aFA), after receiving an L2
   source-trigger (L2-ST) or target-triggered HRqst message, to make
   multiple copies of packets destined to the MN and send them to
   multiple MN care-of addresses before the MN actually moves there.
   This allows a smoothing of the L3 handoff, meaning that packet loss
   is minimised or even eliminated. Simultaneous bindings are also
   useful to prevent service disruption due to ping-ponging as described
   later.


3. Fast Handovers in Mobile IPv6

   The mechanism to obtain fast L3 handoffs for Mobile IPv6 is described
   in [1] and illustrated in Figure 1. This mechanism involves the use
   of L2 triggers which allow the L3 handoff to be anticipated rather
   than being performed after the L2 handoff completion as normal. Fast
   Handoffs are required to ensure that the layer 3 (Mobile IP) handoff
   delay is minimised, thus also minimising and possibly eliminating the
   period of service disruption which normally occurs when a MN moves
   between two ARs. This period of service disruption usually occurs due
   to the time required by the MN to update its HA after it moves
   between ARs. During this time period the MN cannot resume or continue
   communications. Following is a short summary of the Fast Handover
   mechanism described in [1].


                     +-----------+  1a. HI          +-----+
                     |           | ---------------->| nAR |
                     |    oAR    |  1b. HAck        |     |
                     +-----------+ <----------------+-----+
                     ^  |        ^
       (2a. RtSolPr) |  | 2b     |
                     |  | Pr     | 3. Fast BU (F-BU)
                     |  | RtAdv  | 4. Fast BA  (F-BACK)
                     |  v        v
                     +------------+
                     |     MN     |
                     +------------+    - - - - - ->
                                       Movement

                    Figure 1 - Fast MIPv6 Handover Protocol



El Malki and Soliman                                            [Page 4]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


   While the MN is connected to its old Access Router (oAR) and is about
   to move to a new Access Router (nAR), the Fast Handoffs in Mobile
   IPv6 requires:

   - the MN to obtain a new care-of address at the nAR while connected
   to the oAR the MN to send a BU to its old anchor point (e.g. oAR) to
   update its binding cache with the MN's new care-of address.

   - the old anchor point (e.g. oAR) to start forwarding packets
   destined for the MN to nAR.

   The MN or oAR may initiate the Fast Handoff procedure by using
   wireless link-layer information or link-layer _triggers_ which inform
   that the MN will soon be handed off between two wireless access
   points respectively attached to oAR and nAR. If the _trigger_ is
   received at the MN, the MN will initiate the layer-3 handoff process
   by sending a Proxy Router Solicitation message to oAR. Instead if the
   _trigger_ is received at oAR then it will transmit a Proxy Router
   Advertisement to the appropriate MN, without the need for
   solicitations.

   The MN obtains a new care-of address while connected to oAR by means
   of router advertisements containing information from the nAR (Proxy
   Router Advertisement, PrRtAdv, which may be sent due to a Proxy
   Router Solicitation, RtSolPr).  The oAR will validate the MN's new
   COA by sending a Handoff Initiate (HI) message to the nAR. Based on
   the response generated in the Handoff Acknowledge (HAck) message, the
   oAR will either generate a tunnel to the MN's new COA (if the address
   was valid) or generate a tunnel to the nAR's address (if the address
   was already in use on the new subnet). If the address was already in
   use on the new subnet, the nAR will generate a host route for the MN
   using its old COA. The new COA sent in the HI message is formed by
   appending the MN's _current_ interface identifier to the nAR's
   prefix. Note that the HI/HAck exchange is decoupled from the handoff
   procedure and should be performed in advance so as not to add latency
   to the protocol exchange.


4. Bidirectional Edge Tunnel Handover (BETH)

   The following figure is taken from [1].













El Malki and Soliman                                            [Page 5]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


                          +------+   HRqst  +------+
                          | oAR  |<-------->| nAR  |
                          +------+   HRply  +------+
                             ^                  ^
                     old L2  |                  |  new L2
                             +-------+    +-----+
                                     |    |
                                     |    |
                                     V    V
                                    +------+  movement
                                    |  MN  | --------->
                                    +------+

                          Figure 2 - BETH Handover


   BETH describes a way to implement fast handoffs without involving
   messages from the MN. Upon receipt of L2 triggers, which communicate
   the upcoming movement of a MN between two ARs, the oAR will establish
   a bidirectional tunnel between itself and the nAR (or viceversa). As
   soon as the oAR detects that the MN has disconnected as described in
   [1], the oAR will start forwarding traffic it receives for the MN
   over to nAR. In the opposite direction the nAR will reverse tunnel
   traffic sent by the MN on its new link back to oAR.


5. Decoupling L3 Handoffs from L2 handoffs using Simultaneous Bindings

   The mechanisms described in [1] allow the anticipation of the
   layer 3 handoff such that data traffic can be redirected to the MN's
   new location before it moves there. However it is not simple to
   determine the correct time to start forwarding between oAR and nAR,
   which has an impact on how smooth the handoff will be. Packet loss
   will occur if this is performed too late or too early with respect to
   the time in which the MN detaches from oAR and attaches to nAR. Also,
   some measure is needed to support the case in which the MN moves
   quickly back-and-forth between ARs (ping-pong).

   In many wireless networks it is not possible to know in advance
   precisely when a MN will detach from the wireless link to oAR and
   attach to the one connected to nAR. Therefore determining the time
   when to start forwarding packets between oAR and nAR is not possible.
   Certain wireless technologies involve layer-2 messages which instruct
   the MN to handoff immediately or simply identify that the MN has
   already detached/attached. Even if the ARs could extract this
   information, there may not be sufficient time for the oAR to detect
   the MN's detachment and start getting packets tunnelled over to nAR
   before the MN attached to nAR. This is because wireless layer-2
   handoff times are quite small (i.e. range from 10's to 100's ms).
   Thus a period of service disruption may occur due to this timing
   uncertainty unless further enhancements are made to the handoff



El Malki and Soliman                                            [Page 6]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


   mechanism. If the L3 handoff is anticipated and the oAR starts
   forwarding data to nAR upon receipt of the Fast BU in [1] or upon
   receipt of the L2-LD trigger in BETH [1], then the period of service
   disruption will be according to the following:

   A = L3 handoff anticipation (time difference between the start of the
       L3 fast handoff and the moment in which the L2 handoff occurs)
   h = L2 handoff time (disconnection time due to L2 handoff)

   Approximate period before MN receives packets again = A + h

   It is therefore necessary to decouple layer-3 handoff timing from
   layer-2 handoff timing. One solution is to bicast or n-cast packets
   destined to the MN for a short period from the old anchor point (e.g.
   oAR) to one or more potential future MN locations (e.g. nAR/s) before
   the MN actually moves there. This means that the handoff procedure
   described previously would be enhanced by having the old anchor point
   (e.g. oAR) send one copy of packets to the MN's old on-link care-of
   address and another copy of the packets to the MN's new care-of
   address (or addresses) connected to nAR. The MN is thus able to
   receive traffic independently of the exact layer-2 handoff timing
   during the handoff period.


6. Avoiding service disruption due to ping-pong movement

   It is possible that the layer-2 handoff procedure may fail or
   terminate abruptly in wireless systems. Therefore a MN which expects
   to move between oAR and nAR may unexpectedly never complete the
   layer-2 handoff and find itself connected to oAR. Another undesired
   effect is that the MN could ping-pong between ARs due to layer-2
   mobility issues. Both these cases would leave the MN unable to resume
   communication and have to transmit a new F-BU in [1] or wait for a
   new bidirectional tunnel setup in BETH [1] before resuming
   communications.

   This may be solved through the use of simultaneous bindings which
   allow the MN to maintain layer-3 connectivity with the oAR during the
   affected handoff period, thus smoothing the handoff. This eliminates
   the need for continuous transmission of Fast Binding Updates in [1]
   or continuous bidirectional tunnel setups in BETH [1]. It also
   prevents the period of service disruption from being extended due to
   the effect of the above link-layer issues on L3 handoff.


7. Changes to the Fast Handover and BETH Operations

7.1 MN Operation

   The MN operation in [1] (excl. BETH) is affected by the changes
   introduced by this document. The addition to [1] is that a MN with an
   existing active binding which receives a new router advertisement


El Malki and Soliman                                            [Page 7]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


   (PrRtAdv) MUST be "eager" to establish new bindings. When a MN has at
   least one existing binding and receives a new PrRtAdv it MUST send a
   Fast Binding Update (F-BU) with the Simultaneous Bindings flag set
   ("B" flag). The new flag is described in section 8. In addition the
   MN MUST be able to process the new simultaneous bindings suboption in
   the Fast Binding Acknowledgement message described in section 9. The
   lifetime field returned in this suboption MUST be used by the MN to
   identify the lifetime of the simultaneous binding requested. Two BU
   lifetime values will be returned: Bicasting lifetime (in the
   simultaneous bindings suboption) and new CoA lifetime (in the BA
   option) as described in the following sections. The new CoA lifetime
   (placed in the BA option as specified in [3]) runs in parallel with
   the Bicasting lifetime. Hence, when the bicasting lifetime ends, the
   MN will remove this entry from the Binding Update list and simply
   keep one entry for the new CoA with the remaining new CoA lifetime.


7.1 HA/MAP/AR Operation

   The HA [3], MAP [4] and AR [1] are the possible recipients of a F-BU
   message. Upon receiving a F-BU message having the "B" flag set (see
   section 8), the HA/MAP/oAR MUST create a new binding cache sub-entry
   (linked to the original entry for the old CoA) for the MN's new CoA.
   This sub-entry contains the same fields as normal binding cache
   entries but it MUST not replace any existing entries for the MN. The
   new sub-entry will have two lifetimes instead of one: the normal new
   CoA BU lifetime (sent in the BA) and a Bicasting lifetime set to
   SHORT_BINDING_LIFETIME (sent in the BA sub-option). The new CoA
   lifetime runs in parallel with the Bicasting lifetime. Until the
   Bicasting lifetime expires, the HA/MAP/oAR MUST send a copy of the
   data destined for the MN to the old CoA and to the new CoA/s in the
   linked binding cache sub-entry or sub-entries. When the Bicasting
   lifetime expires, the MAP/HA/oAR MUST remove the bicasting lifetime
   field and replace the old binding cache entry for the old CoA with
   the new CoA sub-entry. As a result, the HA/MAP/AR will end up with
   one entry for the MN's new CoA with the remaining new CoA lifetime.

   In BETH [1] the F-BU messages are not used. When a bidirectional tunnel
   is established for the first time (i.e. not renewed) between oAR and
   nAR, the oAR MUST maintain two lifetime entries for the tunnel:
   normal tunnel lifetime (already described in [1]) and a Bicasting
   lifetime set to SHORT_BINDING_LIFETIME. Until the Bicasting lifetime
   expires the oAR MUST copy data destined to the MN both to its on-link
   CoA and through the tunnel to nFA. When the Bicasting lifetime
   expires, the oAR MUST stop bicasting and only forward traffic for the
   MN through the tunnel to nFA until the tunnel lifetime itself
   expires.

   The default value for SHORT_BINDING_LIFETIME is 2s. This parameter
   MUST be configurable as it my vary depending on the type of radio
   link in the system.



El Malki and Soliman                                            [Page 8]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


8. Simultaneous Bindings Flag in Fast Binding Update (F-BU) message


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                    |  Option Type  | Option Length |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Rsv     |B|Rsv| Prefix Length |        Sequence Number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                            Lifetime                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Sub-Options...
    +-+-+-+-+-+-+-+-+-+-+-+-

    Description of the flag added to the F-BU option already defined in
   [1]:

        B              When set indicates a request for bicasting all
                       packets to both COAs of the MN (in the source
                       address field and the alternate-CoA suboption).
                       This BU will add another COA to the Binding
                       Cache.


9. Simultaneous Bindings suboption for Fast Binding Acknowledgement
   (F-BA) message


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                    |Sub-Option Type| Sub-Option Len|
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   status      |  Reserved     |           Lifetime            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


         Sub-Option Type        TBD

         Sub-Option Len

         Status                 Indicates success (0) or failure (128
                                and above).

         Lifetime               The bicasting lifetime for the
                                simultaneous binding requested in the
                                F-BU.


   The alignment requirement for this sub-option is 2n+2.



El Malki and Soliman                                            [Page 9]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


10. Multiple copies of packets received at AR

   If the MN has simultaneous active bindings with HA/MAP/AR, it could
   (but preferably should not) receive multiple copies of the same
   traffic directed to it. The use of simultaneous bindings does not
   mean that the MN is receiving packets contemporarily from multiple
   sources. This depends on the characteristics of the access (L2)
   technology. The bicasting of packets involves sending a copy of the
   data to the AR which the MN is moving to (the nAR). Until the MN
   actually completes the L2 handoff to the nAR and fully establishes
   the new L2 link, the nAR MAY receive packets for a MN to which it
   does not have a direct link layer connection. If the new AR is aware
   that the MN is performing a handover (due to earlier reception of the
   HI message) The AR MAY:

   - drop all packets for the MN, or

   - buffer packets for the MN.

   The choice of which action to take may depend on the type of traffic
   involved (e.g. real-time or non real-time), but this is outside the
   scope of this document. The AR MAY also in parallel attempt to
   establish a link-layer connection with the MN. However an AR MUST NOT
   send ICMP Destination Unreachable messages if it drops packets or is
   unable to deliver the received IP packets due to unavailability of
   direct layer connection with the MN. This is because the MN will be
   receiving one copy of the packets.


11. Reception of multiple copies in the MN

   In some rare scenarios it may be possible that the MN receives more
   than one copy of the same packet. Generally the Internet routing
   mechanisms can not guarantee a delivery of a single copy of an IP
   packet to a node. However some TCP congestion avoidance
   implementations are known to react negatively to the reception of 3
   duplicate acknowledgements. The algorithm in [5] addresses this
   problem. When using [5] bicasting should not cause any negative
   performance impacts for TCP.


12. References

   [1] G. Dommety (Editor) et al, "Fast Handovers for Mobile IPv6",
   draft-ietf-mobileip-fast-mipv6-04.txt, work in progress, March 2002.


   [2] C. Perkins (Editor), "IP Mobility Support for IPv4", RFC3220,
   January 2002.






El Malki and Soliman                                           [Page 10]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


   [3] D. Johnson, C. Perkins and J. Arkko, "Mobility Support in IPv6",
   draft-ietf-mobileip-ipv6-17.txt, work in progress, May 2002.

   [4] H. Soliman, C. Castelluccia, K. El Malki and L. Bellier,
   "Hierarchical MIPv6 mobility management", draft-ietf-mobileip-hmipv6-
   05.txt, work in progress, November 2001.

   [5] R. Ludwig, "The Eifel algorithm for TCP", draft-ietf-tsvwg-tcp-
   eifel-alg-03.txt, work in progress, February 2002.


13. Authors' Addresses

   The authors may be contacted at the addresses below:

   Karim El Malki
   Ericsson AB
   LM Ericssons Vag. 8
   126 25 Stockholm
   SWEDEN

   Phone:  +46 8 7195803
   Fax:    +46 8 7190170
   E-mail: Karim.El-Malki@era.ericsson.se


   Hesham Soliman
   Ericsson AB
   Torshamnsgatan 23, Kista
   Stockholm
   SWEDEN

   Phone:  +46 8 4046619
   Fax:    +46 8 4043630
   E-mail: Hesham.Soliman@era.ericsson.se


   The working group can be contacted via the current chairs:

           Basavaraj Patil               Phil Roberts
           Nokia Corporation             Megisto Systems Inc.
           6000 Connection Drive         Suite 120, 20251 Century Blvd
           Irving, TX 75039              Germantown MD 20874
           USA                           USA
           Phone:  +1 972-894-6709       Phone:  +1 847-202-9314
           EMail:  Raj.Patil@nokia.com   EMail:  proberts@megisto.com
           Fax :   +1 972-894-5349







El Malki and Soliman                                           [Page 11]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


14. Full Copyright Statement

   Copyright (C) The Internet Society (2001). All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works. However, this
   document itself may not be modified in anyway, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English. The limited permissions granted above are perpetual and will
   not be revoked by the Internet Society or its successors or assigns.
   This document and the information contained herein is provided onan
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE."






























El Malki and Soliman                                           [Page 12]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


   Appendix A - Timing Calculations for bicasting


   Example 1
   ---------
                               +--------+
                        +------| MAP/HA |------+
                        |      +--------+      |
                        |                      |
                        v                      v
                     +-----+                +-----+
                     | oAR |                | nAR |
                     +-----+                +-----+


                          +-----+
                          | MN  |
                          +-----+   - - - - - >
                                     Movement

   This is the case specified by [1] with the extension of using the MAP
   from [4].

   A  = anticipation time (F-BU is sent from MN at time t-A, where t is
        the time when the MN actually hands-off at L2)
   h  = handoff time (L2 only)
   D1 = MN to MAP delay (through oAR)
   D2 = MN to MAP delay (through nAR)
   p =  F-BU and routing table processing time in the MAP and MN

   To achieve zero L3 service disruption it is necessary for the time
   period between starting the fast handoff and the MN completing the L2
   handoff to be greater than or equal to the tiem it take for traffic
   to reach the MN at its new link (through nAR). This is represented by
   the following formula:

                 (A+h)>=((D1+D2)+p)

   Assuming that p<<(D1+D2) this can be simplified to:

                 (A+h)>=(D1+D2)

   To achieve maximum performance from simultaneous bindings it is
   necessary for the above relation to hold.

   The Anticipation time (A) is important and needs to be calculated
   appropriately for the link-layer being used. Depending on the L2 this
   may need engineering to synchronise the L2 and L3 handoffs.

   Once the MN has moved to nAR, it will be receiving traffic delayed by
   (D2-D1) with respect to when it was attached to oAR. To smooth this



El Malki and Soliman                                           [Page 13]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


   delay variation (jitter), which may be a problem for real-time
   services, it may be necessary to implement a smoothing buffer at nAR.


   Example 2
   ---------
                     +-----+                +-----+
                     | oAR | -------------->| nAR |
                     +-----+                +-----+
                          |
                          |
                          |
                          v
                         +-----+
                         | MN  |
                         +-----+   - - - - - >
                                     Movement

   When the MAP/HA/oAR are one entity (as considered in [1]), the
   following calculations apply.

   A  = anticipation time (F-BU is sent from MN at time t-A, where t is
        the time when the MN actually hands-off at L2)
   h  = handoff time (L2 only)
   d  = MN to AR delay (assume constant as MN moves ARs)
   L  = oAR to nAR delay


   As previously, the following must be true for the simultaneous
   bindings to yield zero L3 disruption:

                             (A+h)>=(d+L+d)
                          => (A+h)>=(2d+L)

   The Anticipation time (A) is important and needs to be calculated
   appropriately for the link-layer being used. Depending on the L2 this
   may need engineering to synchronise the L2 and L3 handoffs.

   Once the MN has moved to nAR, it will be receiving traffic delayed by
   an amount L with respect to when it was attached to oAR. To smooth
   this delay variation (jitter), which may be a problem for real-time
   services, it may be necessary to implement a smoothing buffer at nAR.


   Example 3
   ---------

   In BETH [1], a similar calculation applies as that in Example 2 but
   there is no need for the MN-AR communication. Therefore the following
   formula must be true to achieve zero service disruption at L3:




El Malki and Soliman                                           [Page 14]

INTERNET-DRAFT   Simultaneous Bindings for MIPv6 Fast Handovers Jun 2002


                              (A+h)>=(L+d)

   The Anticipation time (A) is important and needs to be calculated
   appropriately for the link-layer being used.

   Once the MN has moved to nAR, it will be receiving traffic delayed by
   an amount L with respect to when it was attached to oAR. To smooth
   this delay variation (jitter), which may be a problem for real-time
   services, it may be necessary to implement a smoothing buffer at nAR.













































El Malki and Soliman                                           [Page 15]



