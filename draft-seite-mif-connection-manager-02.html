<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Connection Manager requirements</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Connection Manager requirements">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">P. Seite</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">France Telecom - Orange</td></tr>
<tr><td class="header">Intended status: BCP</td><td class="header">G. Feige</td></tr>
<tr><td class="header">Expires: April 28, 2011</td><td class="header">Cisco</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">T. Melia</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Alcatel-Lucent</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">JC. Zuniga</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">InterDigital</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 25, 2010</td></tr>
</table></td></tr></table>
<h1><br />Connection Manager requirements<br />draft-seite-mif-connection-manager-02.txt</h1>

<h3>Abstract</h3>

<p>It is a common practice for multiple interface terminals to use a connection manager to perform provisioning domain selection and interface configuration. The concept of connection managers for personal computers is well known, and similar logic is now common in mobile phones that have multiple radio interfaces [3GPP TS 23.402]. The Problem Statement document highlights the lack of standardized behavior for terminals in regard to managing multiple interfaces and their respective properties. To address this issue, this document proposes a set of functional requirements for a generic MIF Connection Manager.
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on April 28, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#USE_CASES">2.</a>&nbsp;
Use-cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">2.1.</a>&nbsp;
Provisioning domain selection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.2.</a>&nbsp;
Reselection<br />
<a href="#anchor4">3.</a>&nbsp;
MIF Connection manager requirement<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ARCHI">3.1.</a>&nbsp;
Functional architecture <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Interfaces<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.2.1.</a>&nbsp;
Network SAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.2.2.</a>&nbsp;
User SAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.2.3.</a>&nbsp;
Operator SAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.2.4.</a>&nbsp;
Cloud SAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.2.5.</a>&nbsp;
OS SAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.2.6.</a>&nbsp;
Execution SAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.2.7.</a>&nbsp;
Application  SAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.2.8.</a>&nbsp;
Authentication SAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.3.</a>&nbsp;
Functions of the connection manager<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">3.3.1.</a>&nbsp;
Initiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">3.3.2.</a>&nbsp;
Decision<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">3.3.3.</a>&nbsp;
Execution function<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">3.3.3.1.</a>&nbsp;
IP connectivity check<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#MAPPING">3.3.3.2.</a>&nbsp;
IP address and interface mapping<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">3.3.3.3.</a>&nbsp;
Virtual Interface Configuration<br />
<a href="#anchor20">4.</a>&nbsp;
Security Considerations<br />
<a href="#anchor21">5.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor22">6.</a>&nbsp;
Contributors<br />
<a href="#anchor23">7.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Informative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>As shown in <a class='info' href='#I-D.ietf-mif-current-practices'>[I&#8209;D.ietf&#8209;mif&#8209;current&#8209;practices]<span> (</span><span class='info'>Wasserman, M. and P. Seite, &ldquo;Current Practices for Multiple Interface Hosts,&rdquo; October&nbsp;2010.</span><span>)</span></a>, it
      is a common practice for multiple interfaces terminals to leverage on a
      connection manager to perform provisioning domain selection and
      interface configuration. The connection manager can make its decision
      based on user preferences, applications inputs or many other criteria.
      There are various ways to provide information to a connection manager
      (static configuration, user provisioned, out-of- band mechanisms, etc)
      and a large number of possible strategies that a connection manager can
      implement to perform selection. This variety of situations may lead to
      specific issues, as identified in <a class='info' href='#I-D.ietf-mif-problem-statement'>[I&#8209;D.ietf&#8209;mif&#8209;problem&#8209;statement]<span> (</span><span class='info'>Blanchet, M. and P. Seite, &ldquo;Multiple Interfaces and Provisioning Domains Problem Statement,&rdquo; October&nbsp;2010.</span><span>)</span></a>. For instance, issues
      may rise up because connection managers do not behave in the same way
      depending on the operating systems and/or platforms. High level API may
      also differ across different operating systems and/or platforms. Also,
      implementation of different connection manager on a same node may lead
      to inconsistencies and unexpected behavior in interface selection. 
</p>
<p>Obviously, more consistency in connection managers behavior and API
      specifications is needed for applications developers, operators, users,
      etc. This document addresses this issue by specifying functional
      requirements for a generic connection manager, and proposes a functional
      architecture for the connection manager, describing the interfaces and
      required functions. 
</p>
<a name="USE_CASES"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Use-cases</h3>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Provisioning domain selection</h3>

<p>According to <a class='info' href='#I-D.ietf-mif-current-practices'>[I&#8209;D.ietf&#8209;mif&#8209;current&#8209;practices]<span> (</span><span class='info'>Wasserman, M. and P. Seite, &ldquo;Current Practices for Multiple Interface Hosts,&rdquo; October&nbsp;2010.</span><span>)</span></a>
        one of the basic operations of the connection manager is the selection
        of the provisioning domain. This selection comes into play when the
        MIF host bootstraps, or when it discovers a new provisioning domain.
        Such provisioning domains can be:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>o</dt>
<dd>Domain learned on a Ethernet or 802.11 interface
            either from DHCP or IPV6 RA 
</dd>
<dt>o</dt>
<dd>Domain associated with a 3GPP enabled interface
            
</dd>
<dt>o</dt>
<dd>Domain associated with a WIMAX enabled interface
            
</dd>
<dt>o</dt>
<dd>Domain associated with any otehr IP level
            interface over other link layer technologies such as bluetooth,
            802.15 
</dd>
</dl></blockquote><p>Domains are independent one from another and possibly IP
        addresses / prefixes assigned by a domain to a host could overlap.
        This is a valid configuration that the Connection Manager SHOULD
        support. The selection could be based on various criteria, among them
        are: </p>
<ul class="text">
<li>preferences provided by the user,
</li>
<li>policies provided by network operator,
</li>
<li>quality of the radio link,
</li>
<li>network resource considerations (i.e. available QoS, IP address
            families, IP connectivity check,...),
</li>
<li>Operating system hints (e.g. battery),
</li>
<li>and so on...
</li>
</ul>

<p>In a MIF context, the Connection Manager must handle multiple
        domains simultaneously in particular for host supporting multiple
        access technologies. In this situation, when the user starts an
        application, the Connection Manager SHOULD select the best domain
        taking into account the application constraints besides aforementioned
        selection criteria. Among these application constraints we can mention
        for example the access restriction for a given application or minimum
        required quality of service. By default, the Connection Manager MUST
        select the provisioning domain provided by user and/or operator. If
        the application is restricted to one provisioning domain, the
        application MUST start on it. If the default provisioning domain is
        not available, the application cannot start. If the application can
        run over several provisioning domains, the Connection Manager SHOULD
        select the provisioning domain which provides the best quality and/or
        which satisfy the user preferences, operator policies, and service
        provider preferences, e.g. selection of the access with lower cost. If
        the user starts more than one application on a MIF host, the
        connection manager SHOULD be able to select for each application the
        most appropriate domain based on above mentioned criteria. 
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Reselection</h3>

<p>Once attached, if quality of the link degrades and/or the link
        becomes unavailable and/or other domains with higher preferences
        become available, the Connection Manager SHOULD re-select an
        alternative provisioning domain.
</p>
<p>If IP communication is ongoing and if IP session continuity must be
        provided, the connection manager MAY trigger specific mobility
        management mechanisms (e.g. trigger MIPv6 signalling <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>) or associated configuration operations, e.g.
        configuration of a logical interface for inter-access handover support
        with PMIPv6 (as proposed in <a class='info' href='#I-D.ietf-netext-logical-interface-support'>[I&#8209;D.ietf&#8209;netext&#8209;logical&#8209;interface&#8209;support]<span> (</span><span class='info'>Melia, T. and S. Gundavelli, &ldquo;Logical Interface Support for multi-mode IP Hosts,&rdquo; October&nbsp;2010.</span><span>)</span></a>). 
</p>
<p>Reselection may also happen following an attachment failure (at
        Layer 2 or 3). For instance, the connection manager should select an
        alternative provisioning domain if: <br />
<br />
 </p>
<ul class="text">
<li>the host fails to get L2 attachment;
</li>
<li>the host has managed to get L2 attachment but fails to set up
            the IP connectivity (e.g. cannot obtained a valid IP address);
</li>
<li>the host has managed to get L2 attachment and IP connectivity,
            but it has no access to the services (see <a class='info' href='#I-D.ietf-mif-problem-statement'>[I&#8209;D.ietf&#8209;mif&#8209;problem&#8209;statement]<span> (</span><span class='info'>Blanchet, M. and P. Seite, &ldquo;Multiple Interfaces and Provisioning Domains Problem Statement,&rdquo; October&nbsp;2010.</span><span>)</span></a> for details on MIF
            issues).
</li>
</ul>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
MIF Connection manager requirement</h3>

<p>This section describes the generic framework of a MIF connection
      connection manager.
</p>
<a name="ARCHI"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Functional architecture </h3>

<p>It can be deduced from the use-cases described in <a class='info' href='#USE_CASES'>Section&nbsp;2<span> (</span><span class='info'>Use-cases</span><span>)</span></a> that a connection manager SHOULD support at
        least three main functions: <br />
<br />
 </p>
<ol class="text">
<li>initiation function: it monitors for events which possibly
            required connection management operations. Events may be related
            to access link characteristics, application hints, user triggers,
            etc. When detecting an event which may require multiple interfaces
            management operations (e.g. selection of a new provisioning
            domain), the initiation function triggers the decision function
            (see next item). 
</li>
<li>decision function: upon triggers and information fired by the
            initiation Function, the decision function makes decision about
            multiple interfaces management (e.g. select the best appropriate
            provisioning domain to be used, source address selection, etc.).
            The decision is also made using local information (e.g. policies,
            user preferences) fetched from a local/remote repository. 
</li>
<li>execution function: once the decision made, the decision
            function triggers the execution if required, e.g. attachment to
            the targeted interface interface configuration, control of
            associated mechanisms for communication continuity if needed (e.g.
            configuration of a virtual interface, trigger mobile IP
            procedures, and so on,&hellip;.).
</li>
</ol>

<p>An example of a functional architecture of a Connection Manager is
        given on <a class='info' href='#CM_ARCHI'>Figure&nbsp;1<span> (</span><span class='info'>A functional architecture for the connection manager</span><span>)</span></a>. The Connection Manager
        supports the functions described above and it implements interfaces
        with all the involved actors (e.g., user, application, operator, etc.)
        and with other functional modules on the terminal (i.e., access
        monitoring, mobility management protocol, etc.). Interface endpoints
        on the connection manager side are called Service Access Points
        (SAPs). The following figure depicts the required SAPs in order to
        allow other functional modules to interact with the Connection
        Manager. 
		
		<br /><hr class="insert" />
<a name="CM_ARCHI"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


    +------------+    +--------+    +------------+    +------------+
    |User Tools  |    | Appli. |    | policies   |    |Authent.    |
    |            |    |        |    | server     |    | Framework  |
    +-----x------+    +---x----+    +------x-----+    +-----x------+
          |               |                |                |
     _____x____       ____x_____      _____x______    ______x___
 __ / user SAP \____ / Appli SAP\___ / Oper/cloud \__/ Auth. SAP\_
|   \__________/     \__________/    \____________/  \__________/  |
|                                                                  |
|   Connection Manager                                             |
|                                                                  |
|          +------------+  get info     +------------+             |
|          | Decision   | -------------&gt;| Repository |             |
|          |            | &lt;------------ |            |             |
|          +------------+  send info    +------------+             |
|   __________       __________        __________      ________    |
|_ / 3GPP SAP \____ / Exec. SAP\_____ /WiFi SAP  \____/OS SAP  \___|
   \__________/     \__________/      \__________/    \________/
        x                x                    x           x
        |   +------------x-----------------+  |           |
        |   |  virtual Intf,               |  |     +---- x------+
        |   |  MIP stack, IP stack         |  |     |    OS      |
        |   +------------------------------+  |     +------------+
   +--- x-------+                       +-----x------+
   |3GPP Intf.  |                       |WiFi Intf.  |
   |            |                       |            |
   +------------+                       +------------+


</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: A functional architecture for the connection manager&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Interfaces</h3>

<p>This section focuses on the interfaces endpoints on the connection
        manager side. It is reminded that interface endpoints on the
        connection manager side are called Service Access Points (SAPs). 
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Network SAP</h3>

<p>The Network SAP relates to features directly integrated with the
          link layer access technologies and network interface. For instance,
          the Network SAP should provide the following capabilities: <br />
<br />
 </p>
<ul class="text">
<li>Switching ON/OFF a specific network interface ( 3GPP APN PDP
              context, 802.11 ESSID, &hellip;).
</li>
<li>Provision the MN with the appropriate Access Point Name (APN)
              to be used to access the 3GPP network (it should be noted that
              in the 3GPP context different APNs can be used to access
              different services and that according to EPC specifications
              there is a one to one mapping between one APN and one IP
              address).
</li>
<li>Requesting an active network scan.
</li>
<li>Switching on/off a passive network scan (e.g. a scan which
              does not disturb current traffic flows).
</li>
<li>An early link loss detection trigger ( e.g. link going down).
              This should be based on local algorithms implemented within the
              monitoring feature of the interfaces. The Network SAP should
              have the capability to activate a specific supported algorithm
              as such a early link loss detection will vary according to other
              parameters such as the speed of the terminal, the neighboring
              environment of the same technology.
</li>
<li>A link lost trigger (e.g. link down).
</li>
<li>A Link handover trigger (disconnect and reconnect to the same
              network), this is used currently to verify the IP properties of
              the newly attached base station.
</li>
<li>List of neighboring base stations of the same technology and
              if possible of any technology.
</li>
<li>QOS: Interface queue packet loss.
</li>
<li>Information brought by Layer 2 (e.g. IEEE 802.21 <a class='info' href='#802.21'>[802.21]<span> (</span><span class='info'>IEEE, &ldquo;IEEE Standard for Local and Metropolitan Area Networks - Part           21: Media Independent Handover Services&quot;, IEEE LAN/MAN Std           802.21-2008, January 2009.,&rdquo; 2010.</span><span>)</span></a>).
</li>
<li>Access to information about the connected network provided y
              mechanisms such as 802.11u.
</li>
</ul>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
User SAP</h3>

<p>The User SAP SHOULD allow the user to give his preferences
          expected to influence the interface management, e.g. modification of
          the application profiles, preferred provisioning domain per
          application, etc. These preferences CAN be stored by the connection
          manager in a local repository. 
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.3"></a><h3>3.2.3.&nbsp;
Operator SAP</h3>

<p>The Operator SAP provides services between the client and an
          operator which could be either the network operator of any service
          operator over the top. These services are not integrated within the
          link layer protocols. If they were, these SAP primitives would then
          be migrated to the Network SAP. The Operator SAP SHOULD provide the
          following capabilities: <br />
<br />
 </p>
<ul class="text">
<li>Neighboring information on networks (e.g. 802.21 MIH server
              (<a class='info' href='#802.21'>[802.21]<span> (</span><span class='info'>IEEE, &ldquo;IEEE Standard for Local and Metropolitan Area Networks - Part           21: Media Independent Handover Services&quot;, IEEE LAN/MAN Std           802.21-2008, January 2009.,&rdquo; 2010.</span><span>)</span></a>) or 3GPP ANDSF (<a class='info' href='#TS23.402'>[TS23.402]<span> (</span><span class='info'>3GPP, &ldquo;3GPP TS 23.402; Architecture enhancements for non-3GPP           accesses,&rdquo; 2010.</span><span>)</span></a>). Query of neighboring environment
              (e.g. list of neighbor networks). This could be under a map
              format. This can also be achieved depending on network
              capabilities by the Network SAP.
</li>
<li>Policy interface for allowing the network to push connection
              policies and flow mobility policies. These policies COULD be one
              time policies with immediate effect if the network operator
              wants to change the behaviour of the client at once point in
              time. These policies SHOULD only be accepted if the client has
              agreed to such behaviour and not set an override policy with
              higher 
</li>
</ul>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.4"></a><h3>3.2.4.&nbsp;
Cloud SAP</h3>

<p>The cloud SAP is the operator SAP dedicated to Over The Top
          service provider. Obviously, this SAP is very similar to the
          operator SAP, the interface between MIF host and server uses same
          mechanisms than operator SAP. But, in this case, services MAY be
          specific to OTT operator. More specifically: <br />
<br />
 </p>
<ul class="text">
<li>The Cloud SAP should allow cloud services to request sensor
              information from the client device.
</li>
<li>The Cloud SAP should allow a client to send sensor
              information to a cloud server( e.g. location and speed,
              temperature, humidity, available networks and their measured
              quality, &hellip;).
</li>
<li>The cloud SAP could exchange information with Over-the-top
              services (e.g. geolocation).
</li>
</ul>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.5"></a><h3>3.2.5.&nbsp;
OS SAP</h3>

<p>The OS SAP makes interface with terminal Operating system. This
          SAP could provide the following capabilities: <br />
<br />
 </p>
<ul class="text">
<li>Notification of IP address network assignment and
              notification of any extra information about this IP address such
              as the scope of an address (locally serviced or anchor based in
              case the network was performing PMIP/GTP services, <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a>, <a class='info' href='#RFC5014'>[RFC5014]<span> (</span><span class='info'>Nordmark, E., Chakrabarti, S., and J. Laganier, &ldquo;IPv6 Socket API for Source Address Selection,&rdquo; September&nbsp;2007.</span><span>)</span></a>).
              Typically, these informations are needed for the control of
              virtual( CMIP / DSMIP / VPN(Enterprise &amp; I-WLAN )
              )/physical(PMIP / GTP ) interfaces and source address selection
              mechanisms. 
</li>
<li>Notification of DHCP events such as IP address assignment,
              DHCP options such as ANDSF extensions (<a class='info' href='#I-D.das-mipshop-andsf-dhcp-options'>[I&#8209;D.das&#8209;mipshop&#8209;andsf&#8209;dhcp&#8209;options]<span> (</span><span class='info'>Das, S. and G. Bajko, &ldquo;Dynamic Host Configuration Protocol (DHCPv4 and DHCPv6) Options for Access Network Discovery and Selection Function(ANDSF) Discovery,&rdquo; October&nbsp;2010.</span><span>)</span></a>).
</li>
<li>Power consumption triggers / queries.
</li>
<li>Energy status triggers / queries.
</li>
</ul>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.6"></a><h3>3.2.6.&nbsp;
Execution SAP</h3>

<p>The execution SAP allows to command actions on connectivity
          layers (e.g., IP configuration, trigger IP session continuity
          management protocols). The Execution SAP is tightly integrated with
          OS features and capabilities. The Execution SAP SHOULD provide the
          following capabilities: <br />
<br />
 </p>
<ul class="text">
<li>Provisioning of static IP addresses.
</li>
<li>Generation of automatic WEB Auth methods and insertion into
              the routing table of the default route once authentication
              successful.
</li>
<li>DHCP state machine control : 
<ul class="text">
<li>let DHCP know it must wait for default route into routing
                  table insertion.
</li>
<li>IP address request on demand, in particular for IPv4
                  addresses.
</li>
</ul>
</li>
<li>Control of OS virtual interfaces and binding (bridge or
              routed mode ) to physical interface.
</li>
</ul>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.7"></a><h3>3.2.7.&nbsp;
Application  SAP</h3>

<p>The Application SAP allows to exchange application triggers (e.g.
          application start/stop, notification for QoS requirements) and to
          provide notification of selection decision from the connection
          manager towards applications (i.e., to let the applications change
          their behavior if it is appropriate). Typically, the Application SAP
          SHOULD: <br />
<br />
 </p>
<ul class="text">
<li>allow applications to register with the Connection Manager
              for receiving notifications of other SAP interfaces. The
              Connection Management behaves as a message routing entity in
              this case with rules and filters. As an example in session
              persistency an application may want to know of a &ldquo;link
              going down event&rdquo; in order to anticipate any changes
              required rather than reacting to a &ldquo;link down&rdquo;
              event.
</li>
<li>allow applications a feedback mechanism into the Connection
              Manager for giving real time updates on the QOS observed.
</li>
<li>Allow applications to query the identity store function
              within the Connection manager and retrieve authentication
              methods.
</li>
<li>Allows some application to provide specific information to
              feed the decision function(e.g. GPS positioning or
              velocity).
</li>
<li>terminal built in sensors listing and query/trigger of supported
              options.
</li>
</ul>

<p>it is worth mentioning that the data traffic is exchanged
          directly between the applications and the transport/IP layers,
          through the standard socket, i.e. without traversing the Connection
          Manager.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.8"></a><h3>3.2.8.&nbsp;
Authentication SAP</h3>

<p>The Authentication SAP provides access to all supported
          authentication protocols in a shared fashion for all interfaces. For
          instance, these protocols MAY include: <br />
<br />

          </p>
<ul class="text">
<li>802.1x
</li>
<li>EAP frameworks
</li>
<li>WEB based mechanism such as WISPR 1.0 and WISPR 2.0, IPASS,
              &hellip;
</li>
</ul>

<p>In addition to network authentication solutions, the
          Authentication SAP can provide shared mechanisms for applications to
          use Single-Sign-On solutions such as Open ID, HTTP digest or any
          other proposal.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Functions of the connection manager</h3>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
Initiation</h3>

<p>According to <a class='info' href='#ARCHI'>Section&nbsp;3.1<span> (</span><span class='info'>Functional architecture </span><span>)</span></a> The decision is made on
          triggers and the parameters provided by the initiation function.
          This function SHOULD manage, at least, the following triggers:
          <br />
<br />
 </p>
<ul class="text">
<li>Access link triggers (via Network SAP): used to compute
              network triggers like "access link is going down", "discover a
              new access link", etc. This module is likely to implement a
              technology dependant interface towards the network specific
              layers in order to get e.g., radio/QoS measurements.
</li>
<li>Application triggers (via Application SAP): application
              starting or closing should trigger the decision process to
              select the most appropriate provisioning domain.
</li>
<li>User/Operator hints (via User/Cloud/Operator SAPs): these
              hints may be modification of preferences, operator policies,
              manual selection, etc.
</li>
</ul>

<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2"></a><h3>3.3.2.&nbsp;
Decision</h3>

<p>The decision function is the core of the connection manager, it
          consists in two main functional blocks: <br />
<br />

          </p>
<ul class="text">
<li>Decision Algorithm: when triggered by a given event (e.g..,
              network, user/operator, or applicative), this module selects the
              data path (e.g. provisioning domain, source address, ...). the
              Decision Algorithm consults, if necessary the local policies
              from the repository, and then it makes decision which is
              transmitted to the execution function.
</li>
<li>Repository: this function stores static inputs for the
              decision-making process that will be used to feed the selection
              algorithm . For instance, such information can be related to
              user's preferences, operator's policies or application profiles
              (storing application needs, in term of QoS, and per application
              preferences for access). These information could be provisioned
              to the terminal via out-of-band mechanisms ( e.g., download of
              policies at bootstrapping via link layer mechanisms, during DHCP
              process <a class='info' href='#I-D.sarikaya-mif-dhcpv6solution'>[I&#8209;D.sarikaya&#8209;mif&#8209;dhcpv6solution]<span> (</span><span class='info'>Sarikaya, B., Xia, F., and P. Seite, &ldquo;DHCPv6 Extension for Configuring Hosts with Multiple Interfaces,&rdquo; July&nbsp;2010.</span><span>)</span></a>
              or via 3GPP ANDSF (<a class='info' href='#TS23.402'>[TS23.402]<span> (</span><span class='info'>3GPP, &ldquo;3GPP TS 23.402; Architecture enhancements for non-3GPP           accesses,&rdquo; 2010.</span><span>)</span></a>)).
              Information could be also provisioned through dedicated
              application, for instance allowing the user to indicate its
              preferences (e.g. manage its list of preferred access
              network).
</li>
</ul>

<p>Several criteria could be used to make a decision. For instance,
          the following criteria COULD be considered: <br />
<br />
 </p>
<ul class="text">
<li>User Profile (user's rights in terms of QoS, roaming partners
              allowed, etc.).
</li>
<li>User/Operator ordered list of preferred Wi-Fi networks.
</li>
<li>Access preference based on application type and destination,
              e.g. IPTV is preferred on WLAN when available.
</li>
<li>Link Quality: signal strength (assuming radio link), QoS
              (throughput, packet loss, delay, etc.).
</li>
<li>Application QoS requirements: throughput required per
              application type/class, maximum accepted packet loss.
</li>
<li>Source address selection policy, i.e. the connection manager
              may want to use such interface if IPv6 is available then select
              the source address (e.g. use Global address for Internet
              destination and LLA for on-net services).
</li>
</ul>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3"></a><h3>3.3.3.&nbsp;
Execution function</h3>

<p>After making a decision, the execution function is triggered,
          e.g. operation for attachment to a new interface, IP connectivity
          check, source address selection, trigger other virtual interface
          like tunnel interface (e.g. IPSEC) or steer the mobility protocol
          e.g. MIPv6 <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>), if IP session continuity
          must be ensured. <a class='info' href='#CM_SM'>Figure&nbsp;2<span> (</span><span class='info'>State machine of connection manager</span><span>)</span></a> shows interaction
          between functions of the generic MIF connection manager. 
</p>
<p><br /><hr class="insert" />
<a name="CM_SM"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  +-----------------+     +-----------------+
  |Event Monitoring |     |policies, address|
  |(e.g. monitoring |     |selection policy,|
  |  access link)   |     |preferences,...  |
  +-----------------+     +-----------------+
        ||                        ||                 ,---------.
        ||                        ||              ,-'           `-.
        \/                        \/             |  Execution      |
     ,---------.              ,---------.        |  (connectivity  |
  ,-'           `-.        ,-'           `-.     |   check,        |
 (    Initiation  |------&gt;(   Decision      )---&gt;|   interface     |
  `-.           ,-'        `-.           ,-'     |   control,      |
     `---------'              `---------'        |   Handover      |
       ^  ^                         | ^          |   management,.. ,
       |  |         fail            | |           `---------------'
       |  +------(e.g. no access&lt;---+ |                      |  |
       |          available)          |                      |  |
       |                              +-- reselection    &lt;---+  |
       |                                due to execution        |
       |                                failure                 |
       |                                                        |
       +---------------- execution completed  &lt;-----------------+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: State machine of connection manager&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3.1"></a><h3>3.3.3.1.&nbsp;
IP connectivity check</h3>

<p>This sub-function of the execution deals with IP connectivity
            verification (via OS SAP). This function triggers reselection in
            case of layer 3 failure, during attachment or when a handover
            happens and the layer 2 is still connected. 
</p>
<p>Various situations may occur and various mechanisms CAN be used
            to ensure IP connectivity, for example: <br />
<br />

            </p>
<ul class="text">
<li>While a client moves from one 802.11 access point to
                another, both having the same (E)SSID does not mean they are
                part of the same network. Hence the client SHOULD verify its
                IP address parameters. In order to avoid a complete
                reconfiguration when not needed; initial checks can be
                performed. Such mechanisms are ARPing of the default gateway
                or PING of that same default gateway. If provisioning domain
                parameters, such as MAC address and IP, are similar then it
                can be expected the client is on the same network and avoid
                hence a full IP renewal process. 
</li>
<li>When a client associates to a network it MAY be required to
                authenticate over HTTP and would have limited connectivity
                initially. Mechanisms are needed to check access to the
                authentication web portal.
</li>
<li>The IP connectivity can be limited if there is a high level
                of layer 2 errors. When on the edge of a 802.11 cell, the
                radio parameters may be such that small IP packets would go
                through but higher MTU packets would not get through. In this
                case a client may get an IP address but not be capable of
                further utilising it. 
</li>
<li>The end to end IP connectivity could be disturbed. A
                mechanism is needed which would also differentiate between no
                connectivity at all versus just some disturbed destinations
                only. 
</li>
</ul>

<a name="MAPPING"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3.2"></a><h3>3.3.3.2.&nbsp;
IP address and interface mapping</h3>

<p>In a MIF context, the notion of path is indeed a key issue
            since even a single interface could be providing multiple paths,
            e.g. in IPv6 when delivering multiple prefixes. For example,
            current IP mobility solutions use one IP address for local access
            and another for anchored traffic through a mobility anchor (i.e.
            HA or LMA). The mechanism for selecting anyof the available paths
            SHOULD reside within the Connection Manager. 
</p>
<p>Selection of a source address MUST at least rely on default
            address selection as per <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a> which
            defines algorithms for source and destination IP address
            selections. However, more sophisticated selection mechanism COULD
            also be provided. For instance, IP flows can be mapped
            independently to different interfaces. Also, dynamic information
            about the status of an interface CAN be used when deciding the
            best available interface. 
</p>
<p>The Connection Manager SHOULD select the path (i.e. source
            address) based on dynamic local information (e.g. access
            monitoring)and current policies (i.e., operator, user,
            application, etc.). Once the decision is made the execution
            function MUST configure, in a transparent manner for applications,
            the appropriate mapping of IP communication with the selected
            local interface. 
</p>
<p>Information on IP address type (e.g. local, global, assigned to
            a virtual interface, etc.) MUST be known and used by the
            Connection Manager as an input for path selection. This
            information MAY be provided by specific extensions to IP address
            allocation mechanisms (e.g. DHCP, IPCP, RA, or any other). 
</p>
<p>A typical example of IP address and interface mapping is the 
	    MultiPDN Access Connectivity (MAPCON) support currently being specified in 3GPP. 
	    
	    MAPCON is a 3GPP technology (see <a class='info' href='#mapcon'>Figure&nbsp;3<span> (</span><span class='info'>Connection Manager for MAPCON-enabled terminal</span><span>)</span></a> and refers to the 
	    capability of the Evolved Packet Core (EPC) network to
            configure and maintain two or more PDN connections for a given
            mobile device across heterogeneous wireless access networks <a class='info' href='#TS23.402'>[TS23.402]<span> (</span><span class='info'>3GPP, &ldquo;3GPP TS 23.402; Architecture enhancements for non-3GPP           accesses,&rdquo; 2010.</span><span>)</span></a>).
            According to 3GPP, a one to one mapping exists between a PDN
            connection and an APN. That is, every time that a terminal requests to
            activate a specific APN (either resolved to the same P-GW or to
            different P-GWs) the network assigns a new IP address (v4, v6 or
            v4v6). This APN (or IP address) can be configured on a 3GPP
            network at time T0 and moved at time T1 to the WLAN network. It
            derives that all the sessions associated to this IP address (alias
            Home Network Prefix) are handed over from the 3GPP to the non-3GPP
            access network. If the terminal has configured two different APNs on the
            3GPP access network, after the handover procedure takes place it
            will continue to use one APN for each of the available wireless
            channels.
</p>
<p>In a 3GPP context and from an application perspective, the
            selection of an IP address corresponds to map a specific
            application to a given APN. In the IETF world the APN concept does
            not exist and IP address selection has been studied in <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a> and <a class='info' href='#RFC5014'>[RFC5014]<span> (</span><span class='info'>Nordmark, E., Chakrabarti, S., and J. Laganier, &ldquo;IPv6 Socket API for Source Address Selection,&rdquo; September&nbsp;2007.</span><span>)</span></a>. In
            particular <a class='info' href='#RFC5014'>[RFC5014]<span> (</span><span class='info'>Nordmark, E., Chakrabarti, S., and J. Laganier, &ldquo;IPv6 Socket API for Source Address Selection,&rdquo; September&nbsp;2007.</span><span>)</span></a> provides socket API
            extensions to influence the rules specified in <a class='info' href='#RFC3484'>[RFC3484]<span> (</span><span class='info'>Draves, R., &ldquo;Default Address Selection for Internet Protocol version 6 (IPv6),&rdquo; February&nbsp;2003.</span><span>)</span></a> (e.g. prefer a public IPv4 address over a
            private one, prefer a HoA over a CoA). However, such extensions do
            not consider the particular requirements imposed by 3GPP.
</p>
<p>The use of the CM in the context of the MAPCON scenario
            simplifies the operations executed at the mobile device. The
            routing of flows to interfaces is achieved by means of the
            policies reveiced through the Operator SAP and not according to
            the IP address destination. In this sense the routing operations
            at the MN are extremely simplified with respect to the extensive
            use of multiple interfaces and advance routing capabilities. The
            granularity for routing can for instance be based on prefixes or
            flows, providing great flexibility to the MN configuration and
            associated CM operations.
</p><br /><hr class="insert" />
<a name="mapcon"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

		        +----------------------------+
                        |          TCP/UDP           |
 Session to IP       -- |                            |
 Address binding    &lt;   +---(MN-IP1)---(MN-IP2)------+
                     -- |          IP Layer          |
 IP Address(es)      -- |                            |
 binding            &lt;   +----------------------------+
                     -- |       L2     |     L2      |
                        |     (IF#1)   |   (IF#2)    |
                        +--------------+-------------+
                        |       L1     |     L1      |
                        |              |             |
                        +--------------+-------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Connection Manager for MAPCON-enabled terminal&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3.3"></a><h3>3.3.3.3.&nbsp;
Virtual Interface Configuration</h3>

<p>Work has been carried out in the NetExt WG to define ways in
            which a Logical Interface can help inter-access handover and
            IP Flow Mobility (IFOM) for Proxy Mobile IPv6 <a class='info' href='#I-D.ietf-netext-logical-interface-support'>[I&#8209;D.ietf&#8209;netext&#8209;logical&#8209;interface&#8209;support]<span> (</span><span class='info'>Melia, T. and S. Gundavelli, &ldquo;Logical Interface Support for multi-mode IP Hosts,&rdquo; October&nbsp;2010.</span><span>)</span></a>. The
            NetExt Logical Interface terminology is equivalent to the MIF 
            Virtual Interface (VIF) terminology. This VIF allows a mobile 
	    node sharing a set of IP addresses on multiple physical interfaces. 
	    The same VIF can also help other mobility management solutions 
	    like 3GPP GPRS Tunnelling Protocol (GTP) or DSMIPv6 and it can 
	    add benefits to multi-access scenarios such as 3GPP Multi Access 
	    PDN Connectivity (MAPCON) <a class='info' href='#S2-103593'>[S2&#8209;103593]<span> (</span><span class='info'>3GPP, &ldquo;S2-103593 - Virtual Interface Support on UE               - Requirements and Properties,&rdquo; 2010.</span><span>)</span></a>. 
</p>
<p>For some implementations, the VIF is known as the master, and
            the different sub-interfaces that are mapped below it are
            referred-to as slaves. In most cases, the VIF will map several
            physical network interfaces. Nevertheless, virtual interfaces
	    themseleves could be slaves of a higher level abstracted VIF.
</p>
<p><a class='info' href='#CM_VF'>Figure&nbsp;4<span> (</span><span class='info'>Connection Manager and Virtual Interface (VIF) relationship</span><span>)</span></a> illustrates the relationship
            between the connection manager and the virtual interface. 
</p><br /><hr class="insert" />
<a name="CM_VF"></a>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>

 +---------------------+
 |      TCP/UDP        |
 +---------------------+
 |        IP           |
 +---------------------+    +------------+
 |      Virtual        |    | Connection |
 |      Interface      |&lt;---|  Manager   |
 +---------------------+    +------------+
 +---------+ +---------+         ^
 |   if_1  | |  if_2   |         |
 |  (WLAN) | | (3GPP)  |&lt;--------+
 +---------+ +---------+   IF/CM interface

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Connection Manager and Virtual Interface (VIF) relationship&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The connection manager SHOULD control the mapping between the
            VIF and the sub-interfaces. The mapping control MUST take into
            account class of the IP address, which can differ if:
			<br />
<br />
 </p>
<ul class="text">
<li>this IP is learned directly from the network with PMIP/GTP
                service, in which case the IP is on the physical interface and
                must be bridged onto the virtual interface.
</li>
<li>this IP is assigned to a tunnel originating from the
                virtual interface and bound to a physical interface getting an
                IP address allocation from a non PMIP enabled network 
				(e.g; CMIP, DSMIP, VPN)
</li>
</ul><p>
		
</p>
<p>In order to support IP flow mobility and other mobility
            features, the VIF MUST accept packets arriving on any of its
            sub-interfaces, as long as the destination IP address is a valid
            local address. Also, when the link layer technology of the
            sub-interface encapsulates IP packets into frames, the link-layer
            identifier of the VIF SHOULD be used in the link-layer header of
            frames transmitted over this sub-interface. 
</p>
<p>Independent flows need to be monitored at the VIF. Flows can be
            identified by a 5-tuple comprised of source address, destination
            address, source port, destination port and protocol. Once a flow
            is identified, it SHOULD be mapped to the sub-interface that has
            first been used to perform the packet transmission and reception
            functions for this specific flow. This mapping SHOULD be kept for
            the lifespan of the flow (e.g. TCP session). 
</p>
<p>For IPv6, the VIF MUST be aware of the hosted prefixes based on
            the received Router Advertisement (RA) messages. For instance,
            provided that RAs HNP1 are received on interface if1, any packet
            with source address generated using HNP1 SHOULD be forwarded
            through interface if1. In case packets from a certain flow are
            suddenly received on a different sub-interface, an update to the
            flow mapping table COULD be done so that the corresponding packets
            are then forwarded though this new sub-interface. 
</p>
<p><a class='info' href='#PMIP'>Figure&nbsp;5<span> (</span><span class='info'>VIF for terminal supporting network-based Proxy Mobile IPv6 / 3GPP GTP IFOM</span><span>)</span></a> depicts the use of the Virtual 
		    Interface in a terminal supporting PMIPv6 / GTP advanced mobility 
		    features in the network, and <a class='info' href='#DSMIP'>Figure&nbsp;6<span> (</span><span class='info'>VIF in terminal with DSMIPv6 stack</span><span>)</span></a> shows 
		    the use of the Virtual Interface in a terminal with a DSMIPv6 stack.
</p><br /><hr class="insert" />
<a name="PMIP"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

			         +----------------------------+
                                 |          TCP/UDP           |
          Session to IP        --|                            |
          Address binding    &lt;   +----------------------------+
                               --|             IP             |
          IP Address(es)      ---|                            |
          binding           &lt;    +----------(MN-HoA)----------+
                              ---|     Logical Interface      |
          Logical to             |                            |
          Physical           --&gt; +----------------------------+
          Interface              |  L2  |  L2  |       |  L2  |
          mapping                |(IF#1)|(IF#2)| ..... |(IF#n)|
                                 +------+------+       +------+
                                 |  L1  |  L1  |       |  L1  |
                                 |      |      |       |      |
				 +------+------+       +------+</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: VIF for terminal supporting network-based Proxy Mobile IPv6 / 3GPP GTP IFOM&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="DSMIP"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                         +----------------------------+
                         |          TCP/UDP           |
  Session to IP        --|                            |
  Address binding    &lt;   +----------(MN-HoA)----------+
                       --|     IP in IP tunneling     |
  IP Address(es)      ---|                            |
  binding           &lt;    +---(MN-CoA1)---(MN-CoA2)----+
                      ---|         IP Layer           |
                         |                            |
                         +----------------------------+
                         |       L2     |     L2      |
                         |     (IF#1)   |   (IF#2)    |
                         +--------------+-------------+
                         |       L1     |     L1      |
                         |              |             |
                         +--------------+-------------+</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: VIF in terminal with DSMIPv6 stack&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>TBD
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>This document has no actions for IANA.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Contributors</h3>

<p>The following people contributed to this document:
</p>
<p></p>
<blockquote class="text">
<p>Lucian Suciu
</p>
<p>France telecom - Orange
</p>
<p>lucian.suciu@orange-ftfroup.com
</p>
</blockquote>

<p></p>
<blockquote class="text">
<p>Patrice Nivagiolli
</p>
<p>Cisco
</p>
<p>pnivaggi@cisco.com
</p>
</blockquote>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>The authors would like to acknowledge (in no specific order) Sri
      Gundavelli, Hidetoshi Yokota, Hui Deng and Dapeng Liu
      for all the fruitful discussions on this topic.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3484">[RFC3484]</a></td>
<td class="author-text">Draves, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3484">Default Address Selection for Internet Protocol version 6 (IPv6)</a>,&rdquo; RFC&nbsp;3484, February&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3484.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="802.21">[802.21]</a></td>
<td class="author-text">IEEE, &ldquo;<a href=" http://www.ieee802.org/21/private/Published%20Spec/                 802.21-2008.pdf">IEEE Standard for Local and Metropolitan Area Networks - Part
          21: Media Independent Handover Services", IEEE LAN/MAN Std
          802.21-2008, January 2009.</a>,&rdquo; 2010.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.cao-mif-analysis">[I-D.cao-mif-analysis]</a></td>
<td class="author-text">Laganier, J., Montenegro, G., Korhonen, J., Savolainen, T., and Z. Cao, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-cao-mif-analysis-01.txt">MIF Current Practice Analysis</a>,&rdquo; draft-cao-mif-analysis-01 (work in progress), July&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-cao-mif-analysis-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.das-mipshop-andsf-dhcp-options">[I-D.das-mipshop-andsf-dhcp-options]</a></td>
<td class="author-text">Das, S. and G. Bajko, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-das-mipshop-andsf-dhcp-options-07.txt">Dynamic Host Configuration Protocol (DHCPv4 and DHCPv6) Options for Access Network Discovery and Selection Function(ANDSF) Discovery</a>,&rdquo; draft-das-mipshop-andsf-dhcp-options-07 (work in progress), October&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-das-mipshop-andsf-dhcp-options-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mif-current-practices">[I-D.ietf-mif-current-practices]</a></td>
<td class="author-text">Wasserman, M. and P. Seite, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mif-current-practices-05.txt">Current Practices for Multiple Interface Hosts</a>,&rdquo; draft-ietf-mif-current-practices-05 (work in progress), October&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mif-current-practices-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mif-problem-statement">[I-D.ietf-mif-problem-statement]</a></td>
<td class="author-text">Blanchet, M. and P. Seite, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mif-problem-statement-08.txt">Multiple Interfaces and Provisioning Domains Problem Statement</a>,&rdquo; draft-ietf-mif-problem-statement-08 (work in progress), October&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mif-problem-statement-08.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-netext-logical-interface-support">[I-D.ietf-netext-logical-interface-support]</a></td>
<td class="author-text">Melia, T. and S. Gundavelli, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-netext-logical-interface-support-01.txt">Logical Interface Support for multi-mode IP Hosts</a>,&rdquo; draft-ietf-netext-logical-interface-support-01 (work in progress), October&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-netext-logical-interface-support-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.melia-netext-logical-interface-support">[I-D.melia-netext-logical-interface-support]</a></td>
<td class="author-text">Melia, T., Gundavelli, S., Yokota, H., and C. Bernardos, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-melia-netext-logical-interface-support-01.txt">Logical Interface Support for multi-mode IP Hosts</a>,&rdquo; draft-melia-netext-logical-interface-support-01 (work in progress), July&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-melia-netext-logical-interface-support-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.sarikaya-mif-dhcpv6solution">[I-D.sarikaya-mif-dhcpv6solution]</a></td>
<td class="author-text">Sarikaya, B., Xia, F., and P. Seite, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-sarikaya-mif-dhcpv6solution-04.txt">DHCPv6 Extension for Configuring Hosts with Multiple Interfaces</a>,&rdquo; draft-sarikaya-mif-dhcpv6solution-04 (work in progress), July&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-sarikaya-mif-dhcpv6solution-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3775">[RFC3775]</a></td>
<td class="author-text">Johnson, D., Perkins, C., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3775">Mobility Support in IPv6</a>,&rdquo; RFC&nbsp;3775, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3775.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5014">[RFC5014]</a></td>
<td class="author-text">Nordmark, E., Chakrabarti, S., and J. Laganier, &ldquo;<a href="http://tools.ietf.org/html/rfc5014">IPv6 Socket API for Source Address Selection</a>,&rdquo; RFC&nbsp;5014, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5014.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5213">[RFC5213]</a></td>
<td class="author-text">Gundavelli, S., Leung, K., Devarapalli, V., Chowdhury, K., and B. Patil, &ldquo;<a href="http://tools.ietf.org/html/rfc5213">Proxy Mobile IPv6</a>,&rdquo; RFC&nbsp;5213, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5213.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="S2-103593">[S2-103593]</a></td>
<td class="author-text">3GPP, &ldquo;S2-103593 - Virtual Interface Support on UE

             - Requirements and Properties,&rdquo; 2010.</td></tr>
<tr><td class="author-text" valign="top"><a name="TS23.402">[TS23.402]</a></td>
<td class="author-text">3GPP, &ldquo;3GPP TS 23.402; Architecture enhancements for non-3GPP
          accesses,&rdquo; 2010.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Pierrick Seite</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France Telecom - Orange</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">4, rue du Clos Courtel, BP 91226</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cesson-Sevigne  35512</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:pierrick.seite@orange-ftgroup.com">pierrick.seite@orange-ftgroup.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gaetan Feige</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">11 rue Camille Desmoulin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Issy les Moulineaux  92782</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gfeige@cisco.com">gfeige@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Telemaco Melia</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alcatel-Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Route de Villejust</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nozay  91620</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+33672662903</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:telemaco.melia@alcatel-lucent.com">telemaco.melia@alcatel-lucent.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juan-Carlos Zuniga</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">InterDigital</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1000 Sherbrooke W</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Montreal, QC</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:juancarlos.zuniga.interdigital.com">juancarlos.zuniga.interdigital.com</a></td></tr>
</table>
</body></html>
