<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Datagram Congestion Control Protocol (DCCP) Encapsulation for NAT Traversal (DCCP-NAT)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Datagram Congestion Control Protocol (DCCP) Encapsulation for NAT Traversal (DCCP-NAT)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Datagram Congestion Control</td><td class="header">T. Phelan</td></tr>
<tr><td class="header">Protocol</td><td class="header">Sonus</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">February 11, 2010</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">&nbsp;</td></tr>
<tr><td class="header">Expires: August 15, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Datagram Congestion Control Protocol (DCCP) Encapsulation for NAT Traversal (DCCP-NAT)<br />draft-ietf-dccp-udpencap-00</h1>

<h3>Abstract</h3>

<p>This document specifies an alternative encapsulation of the Datagram
			Congestion Control Protocol (DCCP), referred to as DCCP-NAT.  This
			encapsulation will allow DCCP to be carried through the current generation
			of Network Address Translation (NAT) middleboxes without modification of
			those middleboxes.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 15, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
DCCP-NAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
UDP Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
DCCP-NAT Generic Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
DCCP-NAT Checksum Procedures<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.3.1.</a>&nbsp;
Minimum Checksum Coverage Feature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.4.</a>&nbsp;
Explicit Congestion Notification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.5.</a>&nbsp;
Path Maximum Transmission Unit Discovery<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.6.</a>&nbsp;
Other DCCP Headers and Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.7.</a>&nbsp;
Service Codes and the DCCP Port Registry<br />
<a href="#anchor12">4.</a>&nbsp;
DCCP-NAT and Higher-Layer Protocols<br />
<a href="#anchor13">5.</a>&nbsp;
Signaling the Use of DCCP-NAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sdp">5.1.</a>&nbsp;
SDP for RTP over DCCP<br />
<a href="#anchor14">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor15">7.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The Datagram Congestion Control Protocol (DCCP), specified in
			<a class='info' href='#RFC4340'>[RFC4340]<span> (</span><span class='info'>Kohler, E., Handley, M., and S. Floyd, &ldquo;Datagram Congestion Control Protocol (DCCP),&rdquo; March&nbsp;2006.</span><span>)</span></a>, is
			a transport-layer protocol that provides upper layers with the capability of
			using unreliable but congestion controlled flows.  According to
			<a class='info' href='#RFC4340'>[RFC4340]<span> (</span><span class='info'>Kohler, E., Handley, M., and S. Floyd, &ldquo;Datagram Congestion Control Protocol (DCCP),&rdquo; March&nbsp;2006.</span><span>)</span></a>,
			DCCP packets are directly encapsulated in IPv4 or IPv6 packets.
</p>
<p>In order for the <a class='info' href='#RFC4340'>[RFC4340]<span> (</span><span class='info'>Kohler, E., Handley, M., and S. Floyd, &ldquo;Datagram Congestion Control Protocol (DCCP),&rdquo; March&nbsp;2006.</span><span>)</span></a>
			encapsulation to pass through Network Address
			Translation (NAT) devices, these devices must be updated to recognize and
			properly modify DCCP.  This is the long-term objective for DCCP, and work is
			underway to specify the necessary operations.
</p>
<p>However, in the short term it would be useful to have an encapsulation for
			DCCP that would be compatible with NAT devices conforming to
			<a class='info' href='#RFC4787'>[RFC4787]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>.  This
			document specifies that encapsulation, which is referred to as DCCP-NAT.  For
			convenience, the 
			<a class='info' href='#RFC4340'>[RFC4340]<span> (</span><span class='info'>Kohler, E., Handley, M., and S. Floyd, &ldquo;Datagram Congestion Control Protocol (DCCP),&rdquo; March&nbsp;2006.</span><span>)</span></a> encapsulation is referred to as DCCP-STD.
</p>
<p>The DCCP-NAT encapsulation specified here supports all of the features
			contained in DCCP-STD.  However, support of partial checksums and ECN might be
			impractical for some implementations.  Those implementations MAY choose to not
			support one or both of these features.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
			"SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
			interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
DCCP-NAT</h3>

<p>The basic approach here is to insert a UDP
			(<a class='info' href='#RFC0768'>[RFC0768]<span> (</span><span class='info'>Postel, J., &ldquo;User Datagram Protocol,&rdquo; August&nbsp;1980.</span><span>)</span></a>) "shim" layer between
			the IP header and a DCCP packet with a modified generic header (modified to
			eliminate redundancies between UDP and DCCP).  Note that this is not strictly
			a tunneling approach.  The IP addresses of the communicating end systems are
			carried in the IP header (which could be modified by NAT devices) and there are
			no other IP addresses embedded.
</p>
<p>Devices offering or using DCCP services via DCCP-NAT encapsulation listen on
			a UDP port (default port awaiting IANA action) for incoming packets and pass
			received packets along to the DCCP protocol.  DCCP implementations MAY allow
			services to be simultaneously offered over any or all combinations of DCCP-STD
			and DCCP-NAT encapsulations with IPv4 and IPv6.
</p>
<p>The basic format of a DCCP-NAT packet is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 +-----------------------------------+
 |     IP Header (IPv4 or IPv6)      |  Variable length
 +-----------------------------------+
 |            UDP Header             |  8 bytes
 +-----------------------------------+
 |     DCCP-NAT Generic Header       |  12 bytes
 +-----------------------------------+
 | Additional (type-specific) Fields |  Variable length (could be 0)
 +--------------------------------------+
 |           DCCP Options            |  Variable length (could be 0)
 +-----------------------------------+
 |      Application Data Area        |  Variable length (could be 0)
 +-----------------------------------+
</pre></div>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
UDP Header</h3>

<p>The format of the UDP header is taken from <a class='info' href='#RFC0768'>[RFC0768]<span> (</span><span class='info'>Postel, J., &ldquo;User Datagram Protocol,&rdquo; August&nbsp;1980.</span><span>)</span></a>:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          Source Port          |           Dest Port           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             Length            |           Checksum            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>For DCCP-NAT, the fields are interpreted as follows:
</p>
<p>Source and Dest(ination) Ports: 16 bits each
</p>
<blockquote class="text">
<p>These fields identify the UDP ports on which the source and destination
					(respectively) of the packet are listening for incoming DCCP-NAT packets
					(normally both are the default port to be assigned by IANA).  Note that
					they do not identify the DCCP source and destination ports.
</p>
</blockquote>
<p>Length: 16 bits
</p>
<blockquote class="text">
<p>This field is the length of the portion of the UDP datagram, including
					the UDP header and the payload (which for DCCP-NAT is the DCCP-NAT
					datagram) that is covered by the UDP Checksum.
</p>
</blockquote>
<p>Checksum: 16 bits
</p>
<blockquote class="text">
<p>This field is the Internet checksum of a network-layer pseudoheader and
					Length bytes of the UDP packet.
</p>
</blockquote>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
DCCP-NAT Generic Header</h3>

<p>Unlike the DCCP-STD generic header, the DCCP-NAT generic header takes
				only one form; it does not support short sequence numbers.  Its format is
				as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          Source Port          |           Dest Port           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Data Offset  | CCVal | Type  |  Sequence Number (high bits)  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   .                  Sequence Number (low bits)                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>All DCCP-NAT generic header fields function as specified in
				[RFC4340].
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
DCCP-NAT Checksum Procedures</h3>

<p>For DCCP-NAT, the functions of the DCCP-STD generic header fields
				Checksum and CsCov are performed by the UDP Checksum and Length fields.
</p>
<p>If the UDP Length field is less than 20 (UDP Header length and minimum
				DCCP-NAT header length), the packet MUST be dropped.
</p>
<p>If the UDP Checksum field, computed using standard UDP methods except 
				including only UDP Length bytes of the UDP packet, is invalid, the packet
				MUST be dropped.
</p>
<p>If the UDP Length field in a received packet is less than the length of
				the UDP header plus the entire DCCP-NAT header (including the generic
				header and type-specific fields and options, if present), or the UDP Length
				field is greater than the length of the packet from the beginning of the
				UDP header to the end of the packet, that packet MUST be dropped.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
Minimum Checksum Coverage Feature</h3>

<p>The Minimum Checksum Coverage Feature lets a DCCP endpoint determine
					whether its peer is willing to accept packets with partial checksum
					coverage.  It takes values from 0 to 15.  For DCCP-NAT the feature
					values are interpreted as follows:
</p>
<ul class="text">
<li>Minimum Checksum Coverage = 0, the peer will not accept packets
						with partial checksum.  If the UDP Length field is less than the
						length of the entire UDP packet, then the packet has unacceptable
						Checksum Coverage, as defined in DCCP-STD section 9.2.1.
</li>
<li>Minimum Checksum Coverage > 0, the peer will accept packets with
						partial checksum.  If the UDP Length field is less than the size of
						the UDP Header (8 bytes) plus the size of the DCCP-NAT header
						(including type-specific fields and options) plus (Minimum Checksum
						Coverage - 1)*4, then the packet has unacceptable Checksum
						Coverage.
</li>
</ul>
<p>As defined in DCCP-STD section 9.2.1, peers MAY refuse to process
					packets with unacceptable Checksum Coverage.
</p>
<p>It might be impractical for an implementation to set the UDP Length
					field to less than the full length in outgoing packets or to receive
					incoming packets with UDP Length less than the full length (e.g.,
					user-space implementations using the socket interface).  These
					implementations MAY choose to not support Minimum Checksum Coverage
					values other than 0.  Implementations that make this choice MUST always
					answer a "Change R(Minimum Checksum Coverage, any value)" with a
					"Confirm L(Minimum Checksum Coverage, 0)".  These implementations MAY
					choose to drop packets with UDP Length less than the full packet length,
					rather invoke the procedures of DCCP-STD section 9.2.1.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Explicit Congestion Notification</h3>

<p>DCCP-NAT implementations SHOULD follow the procedures of DCCP-STD section
				12 by setting the ECN fields in the IP Headers of outgoing packets and
				examining the values received in the ECN fields of incoming packets.
</p>
<p>However, some implementations might find it impractical to set or receive
				the ECN fields (e.g., user-space implementations using the socket
				interface).  These implementations MUST follow the procedures in DCCP-STD
				section 12.1 for implementations that are not ECN capable.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Path Maximum Transmission Unit Discovery</h3>

<p>DCCP-NAT implementations should follow DCCP-STD section 14 with regard to
				maximum packet size and Path Maximum Transmission Unit Discovery (PMTUD).
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Other DCCP Headers and Options</h3>

<p>All type-specific DCCP headers are as in DCCP-STD, except that the short
				sequence number version of the acknowledgement header is not supported.  All
				option and feature encodings are as in DCCP-STD.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Service Codes and the DCCP Port Registry</h3>

<p>There is one Service Code registry and one DCCP port registry and they
				apply to all combinations of encapsulation and IP version.  A DCCP Service
				Code specifies an application using DCCP regardless of the combination of
				DCCP encapsulation and IP version.  An application MAY choose not to support
				some combinations of encapsulation and IP version, but its Service Code will
				remain registered for those combinations and MUST NOT be used by other
				applications.  An application SHOULD NOT register different Service Codes
				for different combinations of encapsulation and IP version.
</p>
<p>Similarly, a port registration is applicable to all combinations of
				encapsulation and IP version.  Again, an application MAY choose not to
				support some combinations of encapsulation and IP version on its registered
				port, although the port will remain registered for those combinations.
				Applications SHOULD NOT register different ports just for the purpose of
				using different encapsulation combinations.  Since the port registry
				supports multiple applications registering the same port (as long as the
				Service Codes are different), other applications MAY register on the same
				port, but those registrations are also applicable to all combinations of
				encapsulation and IP version.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
DCCP-NAT and Higher-Layer Protocols</h3>

<p>In general, the encapsulation of a higher-layer protocol within DCCP SHOULD
			be the same in both DCCP-STD and DCCP-NAT.  At this time, encapsulations of DTLS
			over DCCP, defined in 
			<a class='info' href='#RFC5238'>[RFC5238]<span> (</span><span class='info'>Phelan, T., &ldquo;Datagram Transport Layer Security (DTLS) over the Datagram Congestion Control Protocol (DCCP),&rdquo; May&nbsp;2008.</span><span>)</span></a> and RTP over DCCP, defined in 
			<a class='info' href='#I-D.ietf-dccp-rtp'>[I&#8209;D.ietf&#8209;dccp&#8209;rtp]<span> (</span><span class='info'>Perkins, C., &ldquo;RTP and the Datagram Congestion Control Protocol (DCCP),&rdquo; June&nbsp;2007.</span><span>)</span></a>, have
			been already defined.  The encapsulations of those protocols in DCCP-NAT SHALL
			be the same as specified in those documents.
</p>
<p>Higher-layer protocols that require different encapsulations for different
			DCCP modes MUST justify the reasons for the difference and MUST specify the
			encapsulations for both DCCP-STD and DCCP-NAT.  If a document does not specify
			different encapsulations for DCCP-STD and DCCP-NAT, the specified encapsulation
			SHALL apply to both DCCP-STD and DCCP-NAT.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Signaling the Use of DCCP-NAT</h3>

<p>Applications often signal transport connection parameters through outside
			means, such as the Session Description Protocol (SDP).  Applications that define
			such methods for DCCP MUST define how the DCCP encapsulation is chosen, and MUST
			allow either type of encapsulation to be signaled.
</p>
<a name="sdp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
SDP for RTP over DCCP</h3>

<p><a class='info' href='#I-D.ietf-dccp-rtp'>[I&#8209;D.ietf&#8209;dccp&#8209;rtp]<span> (</span><span class='info'>Perkins, C., &ldquo;RTP and the Datagram Congestion Control Protocol (DCCP),&rdquo; June&nbsp;2007.</span><span>)</span></a>
			 defines SDP extensions for signaling RTP over DCCP connections.
			Since it predates this document, it does not define a method for determining
			the DCCP encapsulation type.  This document updates 
			<a class='info' href='#I-D.ietf-dccp-rtp'>[I&#8209;D.ietf&#8209;dccp&#8209;rtp]<span> (</span><span class='info'>Perkins, C., &ldquo;RTP and the Datagram Congestion Control Protocol (DCCP),&rdquo; June&nbsp;2007.</span><span>)</span></a> to add a method
			for determining the DCCP encapsulation type.
</p>
<p>A new SDP attribute "dccp-encap" is defined for signaling the DCCP
			encapsulation according to the following ABNF <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    dccp-encap-attr = %x61 "=dccp-in-udp" [":" udp-port-num]

    udp-port-num    = *DIGIT
</pre></div>
<p>where *DIGIT is as defined in <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
</p>
<p>The presence of "a=dccp-in-udp" in an SDP offer indicates that the offerer
			is listening for DCCP-NAT connections on the indicated UDP port (if udp-port-num
			is included) or on the IANA allocated port for the DCCP-NAT service if no port
			is included.
</p>
<p>The absence of "a=dccp-in-udp" in an SDP offer indicates that the offerer is
			listening for DCCP-STD connections.  The presence of "a=dccp-in-udp" conveys no
			information about whether or not the offerer is listening for DCCP-STD
			connections.
</p>
<p>For example (adapted from examples in 
			<a class='info' href='#I-D.ietf-dccp-rtp'>[I&#8209;D.ietf&#8209;dccp&#8209;rtp]<span> (</span><span class='info'>Perkins, C., &ldquo;RTP and the Datagram Congestion Control Protocol (DCCP),&rdquo; June&nbsp;2007.</span><span>)</span></a>):
</p>
<p>An offerer at 192.0.2.47 signals its availability for an H.261 video session,
			using RTP/AVP over DCCP with service code "RTPV" (using the hexadecimal encoding
			of the service code in the SDP).  RTP and RTCP packets are multiplexed onto a
			single DCCP connection and DCCP-NAT encapsulation is supported:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       v=0
       o=alice 1129377363 1 IN IP4 192.0.2.47
       s=-
       c=IN IP4 192.0.2.47
       t=0 0
       m=video 5004 DCCP/RTP/AVP 99
       a=rtcp-mux
       a=rtpmap:99 h261/90000
       a=dccp-service-code:SC=x52545056
       a=setup:passive
       a=connection:new
       a=dccp-in-udp
</pre></div>
<p>An answerer at 192.0.2.128 receives this offer and responds with the
			following answer:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       v=0
       o=bob 1129377364 1 IN IP4 192.0.2.128
       s=-
       c=IN IP4 192.0.2.128
       t=0 0
       m=video 9 DCCP/RTP/AVP 99
       a=rtcp-mux
       a=rtpmap:99 h261/90000
       a=dccp-service-code:SC:RTPV
       a=setup:active
       a=connection:new
       a=dccp-in-udp
</pre></div>
<p>The end point at 192.0.2.128 then initiates a DCCP-NAT connection to UDP port
			to-be-allocated and DCCP port 5004 at 192.0.2.47. DCCP port 5004 is used for both
			the RTP and RTCP data, and port 5005 is unused. The textual encoding of
			the service code is used in the answer, and represents the same service
			code as in the offer.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>DCCP-NAT provides all of the security risk-mitigation measures present in
			DCCP-STD, and also all of the security risks, except those associated with short
			sequence numbers (since DCCP-NAT does not support that feature).
</p>
<p>The purpose of DCCP-NAT is to allow DCCP to pass through NAT devices, and
			therefore it exposes DCCP to the risks associated with passing through NAT
			devices.  It does not create any new risks with regard to NAT devices.
</p>
<p>DCCP-NAT may also allow DCCP applications to pass through existing firewall
			devices, if the administrators of the devices so choose.  The option is a
			binary one however; either allow all DCCP applications or allow none.  Proper
			control of DCCP application-by-application will require enhancements to
			firewalls.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>A port allocation request will be placed with IANA for the dccp-nat service
			port in UDP.
</p>
<p>The following new SDP attribute ("att-field") is to be registered:
</p>
<blockquote class="text">
<p>Contact name:  Tom Phelan &lt;tphelan@sonusnet.com>
</p>
<p>Attribute name:  dccp-in-udp
</p>
<p>Long-form attribute name in English:  DCCP in UDP Encapsulation
</p>
<p>Type of attribute:  Media level
</p>
<p>Subject to charset attribute?  No
</p>
<p>Purpose of the attribute:  See this document section <a class='info' href='#sdp'>Section&nbsp;5.1<span> (</span><span class='info'>SDP for RTP over DCCP</span><span>)</span></a>
</p>
<p>Allowed attribute values:  See this document section <a class='info' href='#sdp'>Section&nbsp;5.1<span> (</span><span class='info'>SDP for RTP over DCCP</span><span>)</span></a>
</p>
</blockquote>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.&nbsp;References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dccp-rtp">[I-D.ietf-dccp-rtp]</a></td>
<td class="author-text">Perkins, C., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dccp-rtp-07.txt">RTP and the Datagram Congestion Control Protocol (DCCP)</a>,&rdquo; draft-ietf-dccp-rtp-07 (work in progress), June&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dccp-rtp-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0768">[RFC0768]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc768">User Datagram Protocol</a>,&rdquo; STD&nbsp;6, RFC&nbsp;768, August&nbsp;1980 (<a href="http://www.rfc-editor.org/rfc/rfc768.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4340">[RFC4340]</a></td>
<td class="author-text">Kohler, E., Handley, M., and S. Floyd, &ldquo;<a href="http://tools.ietf.org/html/rfc4340">Datagram Congestion Control Protocol (DCCP)</a>,&rdquo; RFC&nbsp;4340, March&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4340.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4787">[RFC4787]</a></td>
<td class="author-text">Audet, F. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4787">Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</a>,&rdquo; BCP&nbsp;127, RFC&nbsp;4787, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4787.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5234.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5238">[RFC5238]</a></td>
<td class="author-text">Phelan, T., &ldquo;<a href="http://tools.ietf.org/html/rfc5238">Datagram Transport Layer Security (DTLS) over the Datagram Congestion Control Protocol (DCCP)</a>,&rdquo; RFC&nbsp;5238, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5238.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tom Phelan</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sonus Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">7 Technology Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Westford, MA  01886</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 978 614 8456</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:tphelan@sonusnet.com">tphelan@sonusnet.com</a></td></tr>
</table>
</body></html>
