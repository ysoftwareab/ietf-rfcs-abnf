


ENUM -- Telephone Number Mapping                                O. Lendl
Working Group                                                    enum.at
Internet-Draft                                         February 10, 2006
Expires: August 14, 2006


                ENUM Validation Token Format Definition
                  draft-ietf-enum-validation-token-01

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on August 14, 2006.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   An ENUM domain name is tightly coupled with the underlying E.164
   number.  The process of verifying whether the Registrant of an ENUM
   domain name is identical to the Assignee of the corresponding E.164
   number is commonly called "validation".  This document describes an
   signed XML data format -- the Validation Token -- with which
   Validation Entities can convey successful completion of a validation
   procedure in a secure fashion.




Lendl                    Expires August 14, 2006                [Page 1]

Internet-Draft            ENUM Validation Token            February 2006


Table of Contents

   1.   Introduction . . . . . . . . . . . . . . . . . . . . . . . .   3

   2.   Data Requirements  . . . . . . . . . . . . . . . . . . . . .   3

   3.   Digital Signature  . . . . . . . . . . . . . . . . . . . . .   3

   4.   Field Descriptions . . . . . . . . . . . . . . . . . . . . .   4
     4.1  Mandatory Section  . . . . . . . . . . . . . . . . . . . .   4
     4.2  Optional Section . . . . . . . . . . . . . . . . . . . . .   5

   5.   Examples . . . . . . . . . . . . . . . . . . . . . . . . . .   5
     5.1  Unsigned Token without Registrant Information  . . . . . .   5
     5.2  Signed token . . . . . . . . . . . . . . . . . . . . . . .   6

   6.   Formal Syntax  . . . . . . . . . . . . . . . . . . . . . . .   8
     6.1  Token Core Schema  . . . . . . . . . . . . . . . . . . . .   8
     6.2  Token Data Schema  . . . . . . . . . . . . . . . . . . . .  10

   7.   Other applications of the Token concept  . . . . . . . . . .  12

   8.   IANA Considerations  . . . . . . . . . . . . . . . . . . . .  12

   9.   Security Considerations  . . . . . . . . . . . . . . . . . .  13

   10.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . .  13

   11.  References . . . . . . . . . . . . . . . . . . . . . . . . .  14
     11.1   Normative References . . . . . . . . . . . . . . . . . .  14
     11.2   Informative References . . . . . . . . . . . . . . . . .  14

        Author's Address . . . . . . . . . . . . . . . . . . . . . .  15

        Intellectual Property and Copyright Statements . . . . . . .  16
















Lendl                    Expires August 14, 2006                [Page 2]

Internet-Draft            ENUM Validation Token            February 2006


1.  Introduction

   In the case where an ENUM (E.164 Number Mapping [1]) domain name
   corresponds to an existing E.164 number [2] the delegation of this
   domain needs to be authorized by the Assignee of the corresponding
   E.164 number.  In the role model described in [12] the entity which
   performs this check is called the Validation Entity (VE).

   By conveying an ENUM Validation Token - a signed XML document - to
   the Registry a VE certifies that delegation requirements have been
   met and are current.

2.  Data Requirements

   In this model, the Token is the only piece of data passed from the VE
   to the Registry.  Therefore, the Token needs to contain as least as
   much information as the Registry requires to grant the delegation of
   the requested ENUM domain according to its registration policy.  As
   such, the Registry will need confirmation that
   o  the Token was created by an accredited VE,
   o  the Token's duration of validity conforms to the policy,
   o  the validation procedure employed has met minimum requirements as
      set forth by policy,
   o  and that the Token is protected against tampering and replay
      attacks.

   Beyond such mandatory information, the Token may optionally include
   number holder information, in particular to simplify future re-
   validations.

   For example, if initial validation requires the steps "Check the
   identity of the Registrant" and "Check the ownership of an E.164
   number" then a later revalidation only needs to re-check the
   ownership as the identity of the Registrant does not change.

   As the Token will be included (see e.g. [13]) in XML-based Registry/
   Registrar protocols like the Extensible Provisioning Protocol (EPP)
   [10] it is a natural choice to use XML to encode Validation Tokens.

3.  Digital Signature

   According to the architecture model the propriety of an ENUM
   delegation depends on the trust relationship between the Registry and
   the VE.  For generality, an untrusted link between Registry and VE
   should be assumed (for instance the Token is passed along with the
   registration request by a Registrar, who might have no role in
   asserting the right-to-use).  Therefore, the Token must be protected
   against forgery, tampering and replay-attacks.



Lendl                    Expires August 14, 2006                [Page 3]

Internet-Draft            ENUM Validation Token            February 2006


   A digital signature on the token
   o  asserts that the token was indeed generated by the indicated VE
      (authenticity)
   o  guarantees that the token was not tampered with in transit
      (integrity)
   o  enables auditing the validation process (non-repudiation).

   The cryptographic signature on the token follows RFC 3275 (XML-DSIG
   [4]).  As tokens might be transmitted as part of an already XML based
   protocol the exclusive XML canonicalization [8] is used.  This
   transform guarantees that namespace declarations inherited from the
   surrounding XML do not invalidate the signature.  In order to make
   the signature an integral part of the token the "enveloped"-signature
   mode is employed.  The signature covers all information contained in
   the Token.

   While XML-DSIG offers a number of cryptographic algorithms, local
   policy should define which algorithms will be accepted by the
   Registry.  It is suggested to use the RSA-SHA1 algorithm with
   embedded X.509 [9] certificates.

   The choice of RSA-SHA1 does not require a public key infrastructure.
   Whether the Registry acts as a certificate authority, accepts certs
   from a public Certification Authority, or only accepts pre-registered
   keys is a local policy choice.

4.  Field Descriptions

4.1  Mandatory Section

   A token must contain a <validation> element which contains the
   following:
   o  A single validation "serial" attribute identifying a validation
      token for a certain VE.  It must be unique per VE.
   o  A single <E164Number> element containing the underlying E.164
      number in fully qualified (international) format.
   o  An optional <lastE164Number> element.  If present it indicates
      that the whole number block starting with <E164Number> up to and
      including <lastE164Number> has been validated.  To avoid
      ambiguity, both numbers must be of the same length.
   o  A single <validationEntityID> element identifying the VE.
   o  A single <registrarID> element identifying the Registrar on whose
      behalf the validation was performed.
   o  A single <methodID> element identifying the method used by the VE
      for validation.
   o  A single <executionDate> attribute containing the date of
      validation formatted as "full-date" according to RFC 3339 [5].




Lendl                    Expires August 14, 2006                [Page 4]

Internet-Draft            ENUM Validation Token            February 2006


   o  An optional <expirationDate> attribute marking the expiration date
      of the validation token formatted as "full-date" according to RFC
      3339.  The Registry will automatically revoke the delegation at
      this date unless a new Token has been submitted that extends the
      lifetime of the validation.  A missing expirationDate indicates
      infinite validity of the Token.

   The format and the uniqueness-constraints of these IDs is left to the
   local policy of the Registry.

4.2  Optional Section

   A token may contain a <tokendata> section containing information
   about the number holder.
   o  A single <organization> element containing the full name of the
      entity.
   o  A single <commercialregisternumber> element.  If the Registrant is
      a company, then this field can be used to uniquely identify that
      company by its official registration number.  The interpretation
      of this field is country-specific.
   o  A single <title> element
   o  A single <firstname> element
   o  A single <lastname> element
   o  A single <address> section containing the following elements:
      *  A single mandatory <streetname>
      *  A single optional <streetnumber>
      *  A single optional <apartment>
      *  A single mandatory <postalcode>
      *  A single mandatory <city>
      *  A single optional <state>
      *  A single mandatory <country>
   o  up to 10 <phone> elements containing full E.164 numbers
   o  up to 10 <fax> elements containing full E.164 numbers
   o  up to 10 <email> elements

   All attributes are optional.  In case an address section is used,
   several components are mandatory for conformance with the
   Computerized Directory Assistance E.115 [3] recommendation.  The
   reason for this is that databases accessible through the E.115
   interface may be a source of validation information.

5.  Examples

5.1  Unsigned Token without Registrant Information

   This basic Token without any information about the Registrant and
   without the cryptographic signature shows the basic layout of the
   required elements.



Lendl                    Expires August 14, 2006                [Page 5]

Internet-Draft            ENUM Validation Token            February 2006


   <?xml version="1.0" encoding="utf-8" standalone="no" ?>
   <token xmlns="urn:ietf:params:xml:ns:enum-token-1.0" Id="TOKEN"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation=
     "urn:ietf:params:xml:ns:enum-token-1.0 enum-token-1.0.xsd">
     <validation serial="acmeve-000002">
       <E164Number>+43780837842</E164Number>
       <validationEntityID>ACME-VE</validationEntityID>
       <registrarID>reg-4711</registrarID>
       <methodID>42</methodID>
       <executionDate>2005-10-06</executionDate>
       <expirationDate>2006-01-01</expirationDate>
     </validation>
   </token>





5.2  Signed token

   This example uses an X.509 based signature which includes the
   certificate of the signing validation entity.  Thus the validity of
   the signature can be verified without the need for a key-server.


   <?xml version="1.0" encoding="utf-8" standalone="no" ?>
   <token xmlns="urn:ietf:params:xml:ns:enum-token-1.0" Id="TOKEN"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation=
     "urn:ietf:params:xml:ns:enum-token-1.0 enum-token-1.0.xsd">
     <validation serial="acmeve-000001">
       <E164Number>+43780837800</E164Number>
       <lastE164Number>+43780837899</lastE164Number>
       <validationEntityID>ACME-VE</validationEntityID>
       <registrarID>reg-4711</registrarID>
       <methodID>42</methodID>
       <executionDate>2005-10-06</executionDate>
     </validation>
     <tokendata xmlns="urn:ietf:params:xml:ns:enum-tokendata-1.0"
      xsi:schemaLocation=
   "urn:ietf:params:xml:ns:enum-tokendata-1.0 enum-tokendata-1.0.xsd">
       <contact>
         <organisation>Example GmbH</organisation>
         <commercialregisternumber>4711</commercialregisternumber>
         <title>Dr.</title>
         <firstname>Max</firstname>
         <lastname>Mustermann</lastname>



Lendl                    Expires August 14, 2006                [Page 6]

Internet-Draft            ENUM Validation Token            February 2006


         <address>
           <streetname>Hauptplatz</streetname>
           <streetnumber>10</streetnumber>
           <apartment>25</apartment>
           <postalcode>1010</postalcode>
           <city>Wien</city>
           <state>Wien</state>
           <country>Austria</country>
         </address>
         <phone>+43101234567</phone>
         <email>mm@example.com</email>
       </contact>
     </tokendata>
     <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
       <SignedInfo>
         <CanonicalizationMethod
          Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
         <SignatureMethod
          Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
         <Reference URI="#TOKEN">
           <Transforms>
             <Transform Algorithm=
              "http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
             <Transform Algorithm=
              "http://www.w3.org/2001/10/xml-exc-c14n#">
               <InclusiveNamespaces
                xmlns="http://www.w3.org/2001/10/xml-exc-c14n#"
                PrefixList="enum-token enum-tokendata"/>
             </Transform>
           </Transforms>
           <DigestMethod
            Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
           <DigestValue>ezSwD7BAiuqgSlfTzPOjKBomE5M=</DigestValue>
         </Reference>
       </SignedInfo>
       <SignatureValue>
   MngTodVv7tAQxVicC2J1/HSDFFwk6JdF9xtmiIqKXfeh9xAKsuEV18s5NoomgoG5
   s46OvsnBrYZ09C/5nWUgAPuUHjPcfekeF2H36aPquq5Dz/K2ncUbgbx5ACDYxXdd
   CtLrmlWFV9X+2uBTaRPufrPTbVsGXsLLA0Zn4SGB6ok=</SignatureValue>
     <KeyInfo>
   <X509Data>
   <X509Certificate>
   MIIDZjCCAs+gAwIBAgIBBDANBgkqhkiG9w0BAQQFADB0MQswCQYDVQQGEwJBVDEP
   MA0GA1UEBxMGVmllbm5hMRQwEgYDVQQKEwtCT0ZIIENlcnRzLjEbMBkGA1UEAxMS
   Q0VSVFMuYm9maC5wcml2LmF0MSEwHwYJKoZIhvcNAQkBFhJjZXJ0c0Bib2ZoLnBy
   aXYuYXQwHhcNMDQwNzIwMTMxNTA5WhcNMDUwNzIwMTMxNTA5WjB/MQswCQYDVQQG
   EwJBVDEKMAgGA1UECBMBLTEPMA0GA1UEBxMGVmllbm5hMR0wGwYDVQQKExRBY21l
   IEVOVU0gVmFsaWRhdGlvbjEQMA4GA1UEAxMHYWNtZS1WRTEiMCAGCSqGSIb3DQEJ



Lendl                    Expires August 14, 2006                [Page 7]

Internet-Draft            ENUM Validation Token            February 2006


   ARYTbm9ib2R5QGVudW0tYWNtZS5hdDCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkC
   gYEArJPcjMFc54/zwztSdQXGxUtodJT9r1qGI2lQPNjLvtPJg93+7o5SIOsZGSpg
   zWbztDAV5qc7PHZWUVIyf6MbM5qSgQDVrjNRhTosNtyqmwi23BH52SKkX3P7eGit
   LmqEkiUZRxZhZ6upRbtcqvKSwmXitvW4zXZhkVHYJZ2HuMcCAwEAAaOB/DCB+TAJ
   BgNVHRMEAjAAMCwGCWCGSAGG+EIBDQQfFh1PcGVuU1NMIEdlbmVyYXRlZCBDZXJ0
   aWZpY2F0ZTAdBgNVHQ4EFgQUyK4otTQtvv6KdSlMBOPT5Ve18JgwgZ4GA1UdIwSB
   ljCBk4AUvfPadpm0HhmZx2iAVumQTwgnG2eheKR2MHQxCzAJBgNVBAYTAkFUMQ8w
   DQYDVQQHEwZWaWVubmExFDASBgNVBAoTC0JPRkggQ2VydHMuMRswGQYDVQQDExJD
   RVJUUy5ib2ZoLnByaXYuYXQxITAfBgkqhkiG9w0BCQEWEmNlcnRzQGJvZmgucHJp
   di5hdIIBADANBgkqhkiG9w0BAQQFAAOBgQCB9CHBnIUhrdic4h5Ar4hdxjHSQkDH
   sJWd+MYrNcuSrv3TIOsUkUgNpNNhmkZPtiXqfy3388IRdJtJiLWXSOb/XlZHOM9I
   MvwKYwhcpQ9UdM/w7VpXQqf+CEj0XSyqxGw65UsHIOijgiG/WyhSj+Lzriw7CTge
   P2iAJkJVC4t2XA==
   </X509Certificate>
   </X509Data>
   </KeyInfo>
   </Signature>
   </token>



6.  Formal Syntax

   The formal syntax of the validation token is specified using XML
   schema notation [6] [7].  Two schemas are defined: The "token core
   schema" contains mandatory attribute definitions, the "token data
   schema" defines the format of the optional "tokendata" section.  The
   BEGIN and END tags are not part of the schema; they are used to note
   the beginning and ending of the schema for URI registration purposes.

6.1  Token Core Schema

   BEGIN
   <?xml version="1.0" encoding="UTF-8"?>

   <schema targetNamespace="urn:ietf:params:xml:ns:enum-token-1.0"
     xmlns:enum-token="urn:ietf:params:xml:ns:enum-token-1.0"
     xmlns:enum-tokendata="urn:ietf:params:xml:ns:enum-tokendata-1.0"
     xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
     xmlns="http://www.w3.org/2001/XMLSchema"
     elementFormDefault="qualified">

   <!--  Import common element types.  -->

     <import namespace="http://www.w3.org/2000/09/xmldsig#"
             schemaLocation="xmldsig-core-schema.xsd"/>
     <import namespace="urn:ietf:params:xml:ns:enum-tokendata-1.0"
             schemaLocation="enum-tokendata-1.0.xsd"/>



Lendl                    Expires August 14, 2006                [Page 8]

Internet-Draft            ENUM Validation Token            February 2006


     <annotation>
       <documentation>
         enum.at Validation Token core schema
       </documentation>
     </annotation>

     <element name="token" type="enum-token:tokenBaseType"/>

     <simpleType name="shortTokenType">
       <restriction base="token">
         <minLength value="1"/>
         <maxLength value="20"/>
       </restriction>
     </simpleType>

     <simpleType name="e164numberType">
       <restriction base="token">
         <maxLength value="20"/>
         <pattern value="\+\d\d*"/>
       </restriction>
     </simpleType>

     <complexType name="validationDataType">
       <sequence>
         <element name="E164Number"
                         type="enum-token:e164numberType"/>
         <element name="lastE164Number" minOccurs="0"
                         type="enum-token:e164numberType"/>
         <element name="validationEntityID"
                         type="enum-token:shortTokenType"/>
         <element name="registrarID"
                         type="enum-token:shortTokenType"/>
         <element name="methodID"
                         type="enum-token:shortTokenType"/>
         <element name="executionDate" type="date"/>
         <element name="expirationDate"
                         type="date" minOccurs="0"/>
       </sequence>
       <attribute name="serial" type="enum-token:shortTokenType"
        use="required"/>
     </complexType>

     <complexType name="tokenBaseType">
       <sequence>
         <element name="validation"
          type="enum-token:validationDataType"/>
         <any namespace="urn:ietf:params:xml:ns:enum-tokendata-1.0"
          minOccurs="0"/>



Lendl                    Expires August 14, 2006                [Page 9]

Internet-Draft            ENUM Validation Token            February 2006


         <any namespace="http://www.w3.org/2000/09/xmldsig#"/>
       </sequence>
       <attribute name="Id" type="ID" use="required"/>
     </complexType>
   </schema>

   END

6.2  Token Data Schema

   BEGIN
   <?xml version="1.0" encoding="UTF-8"?>

   <schema targetNamespace="urn:ietf:params:xml:ns:enum-tokendata-1.0"
     xmlns:enum-tokendata="urn:ietf:params:xml:ns:enum-tokendata-1.0"
     xmlns="http://www.w3.org/2001/XMLSchema"
     elementFormDefault="qualified">

     <annotation>
       <documentation>
         enum.at Validation Token tokendata schema.
       </documentation>
     </annotation>

     <element name="tokendata" type="enum-tokendata:tokenDataType"/>

     <simpleType name="streetNameType">
       <restriction base="token">
         <minLength value="1"/>
         <maxLength value="128"/>
       </restriction>
     </simpleType>

     <simpleType name="shortTokenType">
       <restriction base="token">
         <minLength value="1"/>
         <maxLength value="20"/>
       </restriction>
     </simpleType>

     <simpleType name="longTokenType">
       <restriction base="token">
         <minLength value="1"/>
         <maxLength value="64"/>
       </restriction>
     </simpleType>

     <complexType name="addressType">



Lendl                    Expires August 14, 2006               [Page 10]

Internet-Draft            ENUM Validation Token            February 2006


       <sequence>
         <element name="streetname"
          type="enum-tokendata:streetNameType"/>
         <element name="streetnumber"
          type="enum-tokendata:shortTokenType" minOccurs="0"/>
         <element name="apartment"
          type="enum-tokendata:shortTokenType" minOccurs="0"/>
         <element name="postalcode"
          type="enum-tokendata:shortTokenType"/>
         <element name="city"
          type="enum-tokendata:longTokenType"/>
         <element name="state"
          type="enum-tokendata:longTokenType" minOccurs="0"/>
         <element name="country"
          type="enum-tokendata:longTokenType"/>
       </sequence>
     </complexType>

     <group name="tokenContactBaseGroup">
       <sequence>
         <element name="organisation"
          type="enum-tokendata:shortTokenType" minOccurs="0"/>
         <element name="commercialregisternumber"
          type="enum-tokendata:shortTokenType" minOccurs="0"/>
         <element name="title"
          type="enum-tokendata:shortTokenType" minOccurs="0"/>
         <element name="firstname"
          type="enum-tokendata:longTokenType" minOccurs="0"/>
         <element name="lastname"
          type="enum-tokendata:longTokenType" minOccurs="0"/>
         <element name="address"
          type="enum-tokendata:addressType" minOccurs="0"/>
         <element name="phone" type="enum-tokendata:shortTokenType"
          minOccurs="0" maxOccurs="10" />
         <element name="fax"   type="enum-tokendata:shortTokenType"
          minOccurs="0" maxOccurs="10" />
         <element name="email" type="enum-tokendata:shortTokenType"
          minOccurs="0" maxOccurs="10" />
       </sequence>
     </group>

     <complexType name="contactType">
       <sequence>
         <group ref="enum-tokendata:tokenContactBaseGroup"/>
       </sequence>
     </complexType>

     <complexType name="tokenDataType">



Lendl                    Expires August 14, 2006               [Page 11]

Internet-Draft            ENUM Validation Token            February 2006


       <sequence>
         <element name="contact" type="enum-tokendata:contactType"/>
       </sequence>
     </complexType>

   </schema>

   END

7.  Other applications of the Token concept

   The concept of the validation token may be useful in other registry-
   type applications where the proof of an underlying right is a
   condition for a valid registration.

   An example is a TLD (Top Level Domain) where registration is subject
   to proof of some precondition, like a trade mark or the right in a
   name.  Such situations often arise during the introduction of a new
   TLD, e.g. during a "sunrise" phase.

   A Number Portability (NP) database faces very similar verification
   issues.  An NP system based on the Token concept could potentially be
   superior to current methods, and aid in the convergence of NP and
   ENUM.

8.  IANA Considerations

   This document uses URNs to describe XML namespaces and XML schemas
   conforming to a registry mechanism described in RFC 3688 [11].  Four
   URI assignments are requested.
   1.  Registration request for the Token namespace:
       *  URI: urn:ietf:params:xml:ns:enum-token-1.0
       *  Registrant Contact: See the "Author's Address" section of this
          document.
       *  XML: None.  Namespace URIs do not represent an XML
          specification.
   2.  Registration request for the Token XML schema:
       *  URI: urn:ietf:params:xml:schema:enum-token-1.0
       *  Registrant Contact: See the "Author's Address" section of this
          document.
       *  XML: See Section 6.1 of this document.
   3.  Registration request for the Token Data namespace:
       *  URI: urn:ietf:params:xml:ns:enum-tokendata-1.0
       *  Registrant Contact: See the "Author's Address" section of this
          document.
       *  XML: None.  Namespace URIs do not represent an XML
          specification.




Lendl                    Expires August 14, 2006               [Page 12]

Internet-Draft            ENUM Validation Token            February 2006


   4.  Registration request for the Token Data XML schema:
       *  URI: urn:ietf:params:xml:schema:enum-tokendata-1.0
       *  Registrant Contact: See the "Author's Address" section of this
          document.
       *  XML: See Section 6.2 of this document.

   The IDs used in the validationEntityID, RegistrarID, and methodID
   elements are subject to local policy and thus do not require IANA
   registration.

9.  Security Considerations

   The security of the Validation Token depends on the security of the
   underlying XML DSIG algorithms.  As such, all the security
   considerations from [4] apply here as well.  Two points from there
   merit repetition:

   Transforms are used to select the relevant data for signing and to
   discard irrelevant information (e.g. pretty-printing and name-space
   local names).

   The <Reference URI="#TOKEN"> element and attribute combined with the
   Id="TOKEN" attribute in <token> specifies that the signature should
   cover the complete token.  Moving the Id="TOKEN" attribute to e.g.
   the <tokendata> element would make the signature worthless.

   It is thus critical that the Registry does not only check whether the
   Token passes a generic XML-DSIG signature check, but also that the
   signature uses approved transforms and references the <token> element
   as well as that the certificate belongs to an accredited VE.

   The Token content is not encrypted.  If local policy dictates that
   the information contained within the token should be protected then
   this has to be handled through a different mechanism.

   When processing a delegation request the Registry must verify that
   the information contained in the Token matches the delegation
   request.  To avert replay attacks, local policy has to specify for
   how long after <executionDate> the Token can be used to authorize a
   delegation.  The <registrarID> element in the Token prevents a
   malicious second Registrar from using an eavesdropped Token to
   register a domain in his name.

10.  Acknowledgements

   The author would like to thank the following persons for their
   valuable suggestions and contributions: Michael Haberler, Alexander
   Mayrhofer, Bernie Hoeneisen, Michael Braunoeder, Staffan Hagnell,



Lendl                    Expires August 14, 2006               [Page 13]

Internet-Draft            ENUM Validation Token            February 2006


   Lawrence Conroy.

11.  References

11.1  Normative References

   [1]  Faltstrom, P. and M. Mealling, "The E.164 to Uniform Resource
        Identifiers (URI) Dynamic Delegation Discovery System (DDDS)
        Application (ENUM)", RFC 3761, April 2004.

   [2]  ITU-T, "The international public telecommunication numbering
        plan", Recommendation E.164, May 1997.

   [3]  ITU-T, "Computerized Directory Assistance",
        Recommendation E.115, February 1995.

   [4]  Eastlake, D., Reagle, J., and D. Solo, "(Extensible Markup
        Language) XML-Signature Syntax and Processing", RFC 3275,
        March 2002.

   [5]  Klyne, G. and C. Newman, "Date and Time on the Internet:
        Timestamps", RFC 3339, July 2002.

   [6]  Maloney, M., Beech, D., Mendelsohn, N., and H. Thompson, "XML
        Schema Part 1: Structures", W3C REC REC-xmlschema-1-20010502,
        May 2001.

   [7]  Malhotra, A. and P. Biron, "XML Schema Part 2: Datatypes", W3C
        REC REC-xmlschema-2-20010502, May 2001.

   [8]  3rd, D., Boyer, J., and J. Reagle, "Exclusive XML
        Canonicalization Version 1.0", W3C REC REC-xml-exc-c14n-
        20020718, July 2002.

   [9]  International Telecommunications Union, "Information technology
        - Open Systems Interconnection - The Directory: Public-key and
        attribute certificate frameworks", ITU-T Recommendation X.509,
        ISO Standard 9594-8, March 2000.

11.2  Informative References

   [10]  Hollenbeck, S., "Extensible Provisioning Protocol (EPP)",
         RFC 3730, March 2004.

   [11]  Mealling, M., "The IETF XML Registry", BCP 81, RFC 3688,
         January 2004.

   [12]  Mayrhofer, A. and B. Hoeneisen, "ENUM Validation Architecture",



Lendl                    Expires August 14, 2006               [Page 14]

Internet-Draft            ENUM Validation Token            February 2006


         draft-ietf-enum-validation-arch-00 (work in progress),
         October 2005.

   [13]  Hoeneisen, B., "ENUM Validation Information Mapping for the
         Extensible Provisioning  Protocol",
         draft-ietf-enum-validation-epp-01 (work in progress),
         October 2005.


Author's Address

   Otmar Lendl
   enum.at GmbH
   Karlsplatz 1/2/9
   Wien  A-1010
   Austria

   Phone: +43 1 5056416 33
   Email: otmar.lendl@enum.at
   URI:   http://www.enum.at/































Lendl                    Expires August 14, 2006               [Page 15]

Internet-Draft            ENUM Validation Token            February 2006


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Disclaimer of Validity

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Copyright Statement

   Copyright (C) The Internet Society (2006).  This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and
   except as set forth therein, the authors retain all their rights.


Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.




Lendl                    Expires August 14, 2006               [Page 16]

