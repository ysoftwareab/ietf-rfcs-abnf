



SIPREC                                                            M. Yan
Internet-Draft                                                P. Kyzivat
Intended status: Informational                                    Huawei
Expires: November 29, 2014                                  May 28, 2014


              Overview for MSRP Recording based on SIPREC
                   draft-yan-siprec-msrp-recording-01

Abstract

   SIPREC is capable of recording interactive text media that is
   transmitted via RTP.  However that format is not commonly used for
   message or chat scenarios.  There is also a need for recording text
   media carried via MSRP.  One case of note is exchange of text between
   hearing-impaired users and emergence service bureaus.  Also,
   recording support is needed for MSRP used in chat conferences and
   multimedia conferences.

   This document describes how to achieve MSRP channel recording within
   the mechanism of SIP Recording (SIPREC).

Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on November 29, 2014.







Yan & Kyzivat           Expires November 29, 2014               [Page 1]

Internet-Draft         Overview for MSRP Recording              May 2014


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Definitions . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  MSRP Recording Architecture . . . . . . . . . . . . . . . . .   3
     3.1.  MSRP Client acts as SRC . . . . . . . . . . . . . . . . .   3
     3.2.  MSRP Relay acts as SRC  . . . . . . . . . . . . . . . . .   4
     3.3.  MSRP Switch acts as SRC . . . . . . . . . . . . . . . . .   5
   4.  MSRP Media Stream Mixing  . . . . . . . . . . . . . . . . . .   5
   5.  MSRP Session Usage by the SRC . . . . . . . . . . . . . . . .   5
   6.  MSRP Session Usage by the SRS . . . . . . . . . . . . . . . .   6
   7.  File Transfer . . . . . . . . . . . . . . . . . . . . . . . .   6
   8.  Recording Chatrooms . . . . . . . . . . . . . . . . . . . . .   6
   9.  Metadata  . . . . . . . . . . . . . . . . . . . . . . . . . .   7
   10. Open Issues . . . . . . . . . . . . . . . . . . . . . . . . .   7
     10.1.  Handling MSRP failure reports  . . . . . . . . . . . . .   7
     10.2.  Recording Nickname usage . . . . . . . . . . . . . . . .   7
   11. IANA Considerations . . . . . . . . . . . . . . . . . . . . .   7
   12. Security Considerations . . . . . . . . . . . . . . . . . . .   7
   13. References  . . . . . . . . . . . . . . . . . . . . . . . . .   7
     13.1.  Normative References . . . . . . . . . . . . . . . . . .   7
     13.2.  Informative References . . . . . . . . . . . . . . . . .   8
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   8

1.  Introduction

   SIPREC is capable of recording interactive text media that is
   transmitted via RTP, as defined by [RFC4103].  However that format is
   not commonly used for message or chat scenarios.  There is also a
   need for recording text media carried via MSRP.  One case of note is
   exchange of text between hearing-impaired users and emergence service
   bureaus.  Also, recording support is needed for MSRP used in chat




Yan & Kyzivat           Expires November 29, 2014               [Page 2]

Internet-Draft         Overview for MSRP Recording              May 2014


   conferences (as defined by [I-D.ietf-simple-chat]) and multimedia
   conferences (as defined by [RFC4597]).

   Instant message media is carried by a variety of protocols such as
   IRC, MSRP and XMPP/JINGLE.  The SIP based MSRP protocol (as defined
   by [RFC4975] and [RFC4976]) supports the delivery of messages and
   files from one SIP UA to another.  When a SIPREC SRC is recording a
   CS that contains an MSRP channel, it may want to record the messages
   passing over that channel.  To gain access to the messages, the SRC
   may act as an MSRP client, relay, or switch.  The SRC needs to
   replicate and deliver the messages over an MSRP channel within a
   Recording Session (RS) to an SRS.  The replicated content could be in
   Message/CPIM format containing plain text, HTML, images, etc.  In
   this document, file delivering sessions have not yet been considered.
   Other instant message protocols, like IRC or XMPP, are out of scope.

   This document describes how MRSP sessions are established between an
   SRC and SRS, and used for conveying the replicated MSRP Media, and
   also specifies metadata that describes the recorded MSRP sessions.  A
   Recording Session employing MSRP is established using the normal
   procedures for establishing INVITE initiated dialogs [RFC3261] and
   uses SDP [RFC4566]  for describing the media to be used during the
   session as described by the SIPREC Architecture [RFC7245].

2.  Definitions

   (TBD...)

3.  MSRP Recording Architecture

   For consistency with the SIPREC Architecture [RFC7245] and the SIPREC
   Protocol [I-D.ietf-siprec-protocol] MSRP recording needs to deliver
   duplicated MSRP message content from the SRC to the SRS, with
   suitable descriptive metadata.  The SRC may be associated with SIP UA
   (endpoint) with an MSRP client, or with a SIP B2BUA that accesses the
   media via an MRSP Relay.  An SRC may also be associated with a SIP
   conference focus and an MSRP switch.

3.1.  MSRP Client acts as SRC

   [RFC4975] and [RFC4976] describe how an MSRP client communicates to
   another MSRP client via a SIP session.  A MSRP client that has access
   to the MSRP content to be recorded may act as SRC.  The MSRP client
   may send the replicated media to the SRS along with corresponding
   metadata.

   If the MSRP client/SRC is aware the MSRP session needs to be
   recorded, it can initiate the establishment of a SIP RS by sending an



Yan & Kyzivat           Expires November 29, 2014               [Page 3]

Internet-Draft         Overview for MSRP Recording              May 2014


   INVITE to SRS, or vice-versa.  The MSRP client/SRC is responsible for
   notifying the other MSRP client involved in the CS that the MSRP
   session is being recorded.  The MSRP client/SRC is responsible for
   complying with request from recording aware UAs or through some
   configured policies indicating that the CS should not be recorded.

       +-------------+
       | MSRP CLIENT |
       +-------------+
         ^
         | (Communication Session)
         |
         |  SIP
         v
       +-------------+   (Recording Session)  +-------------+
       | MSRP CLIENT |<---------------------->|   Recorder  |
       |    (SRC)    |      SIP/Metadata      |    (SRS)    |
       +-------------+                        +-------------+



                     Figure 1: MSRP Client Acts as SRC

3.2.  MSRP Relay acts as SRC

   (TBD... RFC4976)

       +-------------+
       | MSRP CLIENT |
       +-------------+
         ^
         | (Communication Session)
         |  SIP
       +-------------+   (Recording Session)  +-------------+
       | MSRP RELAY  |<---------------------->|   Recorder  |
       |    (SRC)    |      SIP/Metadata      |    (SRS)    |
       +-------------+                        +-------------+
         |
         |
         v
       +-------------+
       | MSRP CLIENT |
       +-------------+


                     Figure 2: MSRP Relay Acts as SRC





Yan & Kyzivat           Expires November 29, 2014               [Page 4]

Internet-Draft         Overview for MSRP Recording              May 2014


3.3.  MSRP Switch acts as SRC

   (TBD... ietf-simple-chat)

       +-------------+    +-------------+
       | MSRP CLIENT |    | MSRP CLIENT |
       +-------------+    +-------------+
              ^            ^
               \ SIP      / (Communication Session)
                \        /  SIP
              +-------------+                     +-------------+
              | MSRP switch | (Recording Session) |   Recorder  |
              |    (SRC)    |<------------------->|    (SRS)    |
              +-------------+    SIP/Metadata     +-------------+
                /        \
               / SIP      \ SIP
              v            v
       +-------------+    +-------------+
       | MSRP CLIENT |    | MSRP CLIENT |
       +-------------+    +-------------+


                     Figure 3: MSRP Switch Acts as SRC

4.  MSRP Media Stream Mixing

   As with RTP-based media, CS MSRP media streams from different
   participants may be mixed into a single RS media stream, or they may
   be conveyed as separate MSRP streams.  In RTP, when media from
   different participants is mixed, it is distinguished by CNAME and
   SSRC or CSRC.  In MSRP, media from different participants is
   distinguished by wrapping the the message in a CPIM body, with the
   sender identified by the From header in the CPIM.  If the SRC mixes
   MSRP media from multiple senders, then each message that isn't
   already in CPIM format SHOULD be embedded in a CPIM message, and the
   From and To headers of that CPIM wrapper SHOULD identify the sending
   and receiving participants for that message.

5.  MSRP Session Usage by the SRC

   When preparing to record a CS MSRP media stream, the SRC MUST choose
   a corresponding RS MSRP session.  CS MSRP sessions that are being
   mixed share an RS MSRP session, while those that are not being mixed
   are assigned to unique RS MSRP sessions.

   The RS MSRP session MAY be newly created, or a pre-existing RS MSRP
   session that is no longer in use MAY be repurposed.  When an MSRP
   session is repurposed, the SRC communicates this change to the SRS



Yan & Kyzivat           Expires November 29, 2014               [Page 5]

Internet-Draft         Overview for MSRP Recording              May 2014


   via a change in the metadata.  The SRC is responsible for ensuring
   that messages for the new session are not sent until the SRS has
   received the metadata describing this new session.

   MSRP message flow on a RS MSRP session is always from the SRC to the
   SRS.  The SRC generates SEND messages, and may receive REPORT
   messages.  It does not receive SEND messages or send REPORT messages.

6.  MSRP Session Usage by the SRS

   The SRS MUST be able handle a case where an RS MSRP session if first
   used to record one CS MSRP session and then is repurposed to record a
   different CS MSRP session.  The SRS is learns of this change via a
   change in the metadata.

   MSRP message flow on a RS MSRP session is always from the SRC to the
   SRS.  The SRS receives SEND messages, and sends REPORT messages.  It
   does not generate SEND messages or receive REPORT messages.

7.  File Transfer

   A mechanism for doing file transfer via MSRP is specified in
   [RFC5547].  If this mechanism is used in the CS, then the SRC MAY use
   it in the RS to record those files.  In turn, the SRS MAY choose to
   accept some or all of those file transfer requests, or MAY reject
   them.

   Both file push and file pull operations are defined.  If the SRC
   chooses to record a file transfer, whether it is initiated in the CS
   via a push operation or a pull operation, within the RS the SRC MUST
   initiate the transfer with a push operation in an SDP Offer.

   (SRS initiation of a file transfer is out of scope of this document.)

   It is possible that the SRC may support file transfer while the SRS
   does not.  If the SRC sends an SDP offer to the SRS containing an
   m-line initiating a file transfer, and the SRS sends an answer
   accepting the MSRP session, but fails to include a matching file-
   transfer-id, then the SRC MUST abort the file transfer without
   sending any file content.

8.  Recording Chatrooms

   An CS MSRP session might involve a chatroom.  The SRC discovers this
   by observing use of the features defined in [I-D.ietf-simple-chat]

   When the CS MSRP session involves a chatroom, the SRC MUST indicate
   this in the corresponding RS MSRP session.  The key unique features



Yan & Kyzivat           Expires November 29, 2014               [Page 6]

Internet-Draft         Overview for MSRP Recording              May 2014


   of chatrooms are nicknames and private messages.  If either of these
   features is indicated in a 'chatroom' attribute in the CS, then this
   MUST also be indicated in the RS.

   How to reflect the use of nicknames from the CS to the RS is TBD.

9.  Metadata

   The metadata defined in [I-D.ietf-siprec-metadata] can be used
   without change to describe MSRP streams.

10.  Open Issues

10.1.  Handling MSRP failure reports

   What the SRC should do if it observes a MSRP error response or a
   failure report is TBD?

10.2.  Recording Nickname usage

   Recording chat sessions that use nicknames presents difficult
   problems.  The chat mechanism doesn't have provision for a single
   MSRP endpoint to concurrently use multiple nicknames.  Perhaps we can
   handle nicknames via metadata - as an additional attribute to a
   Participant.

11.  IANA Considerations

   This document contains no IANA considerations.

12.  Security Considerations

   Not explicitly covered in this version.

13.  References

13.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC3261]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", RFC 3261,
              June 2002.

   [RFC4975]  Campbell, B., Mahy, R., and C. Jennings, "The Message
              Session Relay Protocol (MSRP)", RFC 4975, September 2007.



Yan & Kyzivat           Expires November 29, 2014               [Page 7]

Internet-Draft         Overview for MSRP Recording              May 2014


   [RFC4976]  Jennings, C., Mahy, R., and A. Roach, "Relay Extensions
              for the Message Sessions Relay Protocol (MSRP)", RFC 4976,
              September 2007.

   [RFC5547]  Garcia-Martin, M., Isomaki, M., Camarillo, G., Loreto, S.,
              and P. Kyzivat, "A Session Description Protocol (SDP)
              Offer/Answer Mechanism to Enable File Transfer", RFC 5547,
              May 2009.

   [RFC7245]  Hutton, A., Portman, L., Jain, R., and K. Rehor, "An
              Architecture for Media Recording Using the Session
              Initiation Protocol", RFC 7245, May 2014.

   [I-D.ietf-siprec-metadata]
              R, R., Ravindran, P., and P. Kyzivat, "Session Initiation
              Protocol (SIP) Recording Metadata", draft-ietf-siprec-
              metadata-15 (work in progress), February 2014.

   [I-D.ietf-siprec-protocol]
              Portman, L., Lum, H., Eckel, C., Johnston, A., and A.
              Hutton, "Session Recording Protocol", draft-ietf-siprec-
              protocol-12 (work in progress), February 2014.

   [I-D.ietf-simple-chat]
              Niemi, A., Garcia, M., and G. Sandbakken, "Multi-party
              Chat Using the Message Session Relay Protocol (MSRP)",
              draft-ietf-simple-chat-18 (work in progress), January
              2013.

13.2.  Informative References

   [RFC4103]  Hellstrom, G. and P. Jones, "RTP Payload for Text
              Conversation", RFC 4103, June 2005.

   [RFC4566]  Handley, M., Jacobson, V., and C. Perkins, "SDP: Session
              Description Protocol", RFC 4566, July 2006.

   [RFC4597]  Even, R. and N. Ismail, "Conferencing Scenarios", RFC
              4597, August 2006.

Authors' Addresses

   Michael Yan
   Huawei

   Email: michael.yan@huawei.com





Yan & Kyzivat           Expires November 29, 2014               [Page 8]

Internet-Draft         Overview for MSRP Recording              May 2014


   Paul H. Kyzivat
   Huawei

   Email: pkyzivat@alum.mit.edu















































Yan & Kyzivat           Expires November 29, 2014               [Page 9]
