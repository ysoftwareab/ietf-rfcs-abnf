



PKIX Working Group                               S. Santesson (AddTrust)
INTERNET-DRAFT                             R. Housley (RSA Laboratories)
Expires April 2003                                T. Freeman (Microsoft)
                                                            October 2002

               Internet X.509 Public Key Infrastructure:
                    Logotypes in X.509 certificates
                   <draft-ietf-pkix-logotypes-07.txt>

Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that other
   groups may also distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time. It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   Copyright (C) The Internet Society (2002). All Rights Reserved.

Abstract

   This document specifies a certificate extension for including
   logotypes in public key certificates and attribute certificates.

   Please send comments on this document to the ietf-pkix@imc.org
   mailing list.













Santesson, Housley, & Freeman                                   [Page 1]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   Table of Contents

   1 Introduction .................................................    3
     1.1 Certificate-based Identification .........................    4
     1.2 Selection of Certificates ................................    4
     1.3 Combination of Verification Techniques ...................    5
     1.4 Terminology ..............................................    6
   2 Different types of logotypes in Certificates .................    6
   3 Logotype data ................................................    6
   4 Logotype extension ...........................................    7
     4.1 Extension format .........................................    7
     4.2 Other Logotypes ..........................................   10
   5 Type of certificates .........................................   11
   6 Use in Clients ...............................................   11
   7 Security considerations ......................................   12
   8 References ...................................................   14
   A ASN.1 Module .................................................   15
   B Logotype placement ...........................................   18
     B.1 Qualifier ................................................   18
     B.2 Issuer and Subject Alt Names .............................   18
     B.3 New extension ............................................   19
     B.4 Conclusion ...............................................   19
   C Author Addresses .............................................   20
   D Acknowledgments ..............................................   20



























Santesson, Housley, & Freeman                                   [Page 2]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


1. Introduction

   The basic function of a certificate is to bind a public key to the
   identity of an entity (the subject). From a strictly technical
   viewpoint, this goal could be achieved by signing the identity of the
   subject together with its public key. However, the art of PKI has
   developed certificates far beyond this functionality in order to meet
   the needs of modern global networks and heterogeneous IT structures.

   Certificate users must be able to determine certificate policies,
   appropriate key usage, assurance level, and name form constraints.
   Before a relying party can make an informed decision whether a
   particular certificate is trustworthy and relevant for its intended
   usage, a certificate may be examined from several different
   perspectives.

   Systematic processing is necessary to determine whether a particular
   certificate meets the predefined prerequisites for an intended usage.
   Much of the information contained in certificates is appropriate and
   effective for machine processing; however, this information is not
   suitable for a corresponding human trust and recognition process.

   Humans prefer to structure information into categories and symbols.
   Most humans associate complex structures of reality with easy
   recognizable logotypes and marks. Humans tend to trust things that
   they recognize from previous experiences. Humans may examine
   information to confirm their initial reaction. Very few consumers
   actually read all terms and conditions they accept when accepting a
   service, rather they commonly act on trust derived from previous
   experience and recognition.

   A big part of this process is branding. Service providers and product
   vendors invest a lot of money and resources into creating a strong
   relation between positive user experiences and easily recognizable
   trademarks, servicemarks, and logotypes.

   Branding is also pervasive in identification instruments, including
   identification cards, passports, driver's licenses, credit cards,
   gasoline cards, and loyalty cards. Identification instruments are
   intended to identify the holder as a particular person or as member
   of community. The community may represent the subscribers of a
   service or any other group. Identification instruments, in physical
   form, commonly use logotypes and symbols, solely to enhance human
   recognition and trust in the identification instrument itself. They
   may also include a registered trademark to allow legal recourse for
   unauthorized duplication.

   Since certificates play an equivalent role in electronic exchanges,



Santesson, Housley, & Freeman                                   [Page 3]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   we examine the inclusion of logotypes in certificates. We consider
   certificate-based identification and certificate selection.

1.1. Certificate-based Identification

   The need for human recognition depends on the manner in which
   certificates are used and whether certificates need to be visible to
   human users. If certificates are to be used in open environments and
   in applications that bring the user in conscious contact with the
   result of a certificate-based identification process, then human
   recognition is highly relevant, and it may be a necessity.

   Examples of such applications include:

     - Web server identification where a user identifies the owner
       of the web site.
     - Peer e-mail exchange in B2B, B2C, and private communications.
     - Exchange of medical records, and system for medical
       prescriptions.
     - Unstructured e-business applications (i.e., non-EDI
       applications).
     - Wireless client authenticating to a service provider.

   Most applications provide the human user with an opportunity to view
   the results of a successful certificate-based identification process.
   When the user takes the steps necessary to view these results, the
   user is presented with a view of a certificate. This solution has two
   major problems.  First, the function to view a certificate is often
   rather hard to find for a non-technical user. Second, the
   presentation of the certificate is too technical and, it is not user
   friendly. It contains no graphic symbols or logotypes to enhance
   human recognition.

   Many investigations have shown that users of today's applications do
   not take the steps necessary to view certificates. This could be due
   to poor user interfaces. Further, many applications are structured to
   hide certificates from users.  The application designers do not want
   to expose certificates to users at all.

1.2. Selection of Certificates

   One situation where software applications must expose human users to
   certificates is when the user must select a single certificate from a
   portfolio of certificates. In some cases, the software application
   can use information within the certificates to filter the list for
   suitability; however, the user must be queried if more than one
   certificate is suitable. The human user must select one of them.




Santesson, Housley, & Freeman                                   [Page 4]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   This situation is comparable to a person selecting a suitable plastic
   card from his wallet. In this situation, substantial assistance is
   provided by card color, location, and branding.

   In order to provide similar support for certificate selection, the
   users need tools to easily recognize and distinguish certificates.
   Introduction of logotypes into certificates provides the necessary
   graphic.

1.3. Combination of Verification Techniques

   The use of logotypes will in many cases affect the users decision to
   trust and use a certificate. It is therefore important that there is
   a distinct and clear architectural and functional distinction between
   the processes and objectives of the automated certificate
   verification and human recognition.

   Since logotypes are only aimed for human interpretation and contain
   data that is inappropriate for computer based verification schemes,
   the logotype extension MUST NOT be an active component in automated
   certification path validation.

   Automated certification path verification determines whether the end-
   entity certificate can be verified according to defined policy. The
   algorithm for this verification is specified in RFC 3280 [PKIX-1].

   The automated processing provides assurance that the certificate is
   valid. It does not indicate whether the subject is entitled to any
   particular information or whether the subject ought to be trusted to
   perform a particular service. These are access control decisions.
   Automatic processing will make some access control decisions, but
   others, depending on the application context, involve the human user.

   In some situations, where automated procedures have failed to
   establish the suitability of the certificate to the task, the human
   user is the final arbitrator of the post certificate verification
   access control decisions. In the end, the human will decide whether
   or not to accept an executable email attachment, to release personal
   information, or follow the instructions displayed by a web browser.
   This decision will often be based on recognition and previous
   experience.

   The distinction between systematic processing and human processing is
   rather straightforward. They can be complementary. While the
   systematic process is focused on certification path construction and
   verification, the human acceptance process is focused on recognition
   and related previous experience.




Santesson, Housley, & Freeman                                   [Page 5]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   There are some situations where systematic processing and human
   processing interfere with each other.  These issues are discussed in
   the Security Considerations section.

1.4. Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [STDWORDS].

2. Different Types of Logotypes in Certificates

   This specification defines the inclusion of three standard logotype
   types.

     1) Community logotype
     2) Issuer organization logotype
     3) Subject organization logotype

   The community logotype - is the general mark for a community. It
   identifies a service concept for entity identification and
   certificate issuance. Many issuers may use a community logotype to
   co-brand with a global community in order to gain global recognition
   of its local service provision. This type of community branding is
   very common in the credit card business where local independent card
   issuers include a globally recognized brand (such as VISA and
   MasterCard).

   Issuer organization logotype - is a logotype representing the
   organization identified as part of the issuer name in the
   certificate.

   Subject organization logotype - is a logotype representing the
   organization identified in the subject name in the certificate.

   In addition to the standard logotype types this specification
   accommodates inclusion of other logotype types where each class of
   logotype is defined by an object identifier. The object identifier
   can be either locally defined or an identifier defined in section 4.2
   of this standard.


3. Logotype data

   This specification defines two types of logotype data: image data and
   audio data. Implementations MUST support image data; however, support
   for audio data is OPTIONAL.




Santesson, Housley, & Freeman                                   [Page 6]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   There is no need to significantly increase the size of the
   certificate by including image and audio data of logotypes. Rather, a
   URI identifying the location to the logotype data and a one-way hash
   of the referenced data is included in the certificate.

   Several image files, representing the same image in different
   formats, sizes, and color palates, may represent each logotype image.
   Several audio files may further represent the same audio sequence in
   different formats and resolutions.

   If a logotype is represented by more than one image file, then the
   image files MUST contain variants of the roughly the same image.
   Likewise, if a logotype is represented by more than one audio file,
   then the audio files MUST contain variants of the roughly the same
   audio sequence. Compliant applications MUST display more just one (or
   none) of the images and play just one (or none) of the audio
   sequences at the same time.

   Each logotype present in a certificate MUST be represented by at
   least one image data file.

   Applications SHOULD enhance processing and off-line functionality by
   caching logotype data.

4. Logotype extension

   This section specifies the syntax and semantics of the logotype
   extension.

4.1 Extension format

   The logotype extension MAY be included in public key certificates
   [PKIX-1] or attribute certificates [PKIX-AC]. The logotype extension
   MUST be identified by the following object identifier:

      id-pe-logotype  OBJECT IDENTIFIER  ::=
         { iso(1) identified-organization(3) dod(6) internet(1)
           security(5) mechanisms(5) pkix(7) id-pe(1) 12 }

   This extension MUST NOT be marked critical.

   Logotype data may be referenced through either direct or indirect
   addressing. Clients MUST support both direct and indirect addressing.
   CAs that include logotypes in certificates that they issue MUST
   support direct addressing, and CAs SHOULD support indirect
   addressing.

   The direct addressing includes information about each logotype in the



Santesson, Housley, & Freeman                                   [Page 7]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   certificate, and URIs point to the image and audio data files. Direct
   addressing supports cases where just one or a few images and audio
   files are referenced.

   The indirect addressing includes one reference to an external hashed
   data structure that contains information on the type, content and
   location of each image and audio file. Indirect addressing supports
   cases where each logotype is represented by many audio or image
   files.

   Both direct and indirect addressing accommodate alternative URIs to
   obtain exactly the same item. This opportunity for replication is
   intended to improve availability. Therefore, if a client is unable to
   fetch the item form one URI, the client SHOULD try another URI in the
   sequence.

   The logotype extension MUST have the following syntax:

      LogotypeExtn ::= SEQUENCE {
         communityLogo   [0] EXPLICIT LogotypeInfo OPTIONAL,
         issuerLogo      [1] EXPLICIT LogotypeInfo OPTIONAL,
         subjectLogo     [2] EXPLICIT LogotypeInfo OPTIONAL,
         otherLogos      [3] SEQUENCE OF OtherLogotypeInfo OPTIONAL }

      LogotypeInfo ::= CHOICE {
         direct          [0] LogotypeData,
         indirect        [1] LogotypeReference }

      LogotypeData ::= SEQUENCE {
         image           SEQUENCE OF LogotypeImage OPTIONAL,
         audio           [1] SEQUENCE OF LogotypeAudio OPTIONAL }

      LogotypeImage ::= SEQUENCE {
         imageSubtype    IA5String, -- MIME image subtype
         imageHash       SEQUENCE SIZE (1..MAX) OF HashAlgAndValue,
         imageURI        SEQUENCE SIZE (1..MAX) OF IA5String,
         imageInfo       LogotypeImageInfo OPTIONAL }

      LogotypeAudio ::= SEQUENCE {
         audioSubtype    IA5String, -- MIME audio subtype
         audioHash       SEQUENCE SIZE (1..MAX) OF HashAlgAndValue,
         audioURI        SEQUENCE SIZE (1..MAX) OF IA5String,
         audioInfo       LogotypeAudioInfo OPTIONAL }

      LogotypeImageInfo ::= CHOICE {
         grayScale       [0] LogotypeGrayScaleImageInfo,
         color           [1] LogotypeGrayScaleImageInfo }




Santesson, Housley, & Freeman                                   [Page 8]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


      LogotypeGrayScaleImageInfo ::= SEQUENCE {
         fileSize        INTEGER,  -- In octets
         xSize           INTEGER,  -- In pixels
         ySize           INTEGER,  -- In pixels
         numLevels       INTEGER } -- In bits

      LogotypeColorImageInfo ::= SEQUENCE {
         fileSize        INTEGER,  -- In octets
         xSize           INTEGER,  -- In pixels
         ySize           INTEGER,  -- In pixels
         numColors       INTEGER } -- In bits

      LogotypeAudioInfo ::= SEQUENCE {
         fileSize        INTEGER, -- In octets
         playTime        INTEGER, -- In milliseconds
         sampleRate      INTEGER, -- Samples per second
         channels        INTEGER, -- 1=mono, 2=stereo, 4=quad
         language        IA5String OPTIONAL } -- RFC 3066 Language Tag

      OtherLogotypeInfo ::= SEQUENCE {
         logotypeType    OBJECT IDENTIFIER,
         info            LogotypeInfo }

      LogotypeReference ::= SEQUENCE {
         refStructHash   SEQUENCE SIZE (1..MAX) OF HashAlgAndValue,
         refStructURI    SEQUENCE SIZE (1..MAX) OF IA5String }

      HashAlgAndValue ::= SEQUENCE {
         hashAlg         AlgorithmIdentifier,
         hashValue       OCTET STRING }

   When using indirect addressing, the URI (refStructURI) pointing to
   the external data structure MUST point to a binary file containing
   the DER encoded data with the syntax LogotypeData. The referenced
   file name SHOULD include a file extension of "LTD".

   At least one of the optional elements in the LogotypeExtn structure
   MUST be present. Avoid the use of otherLogos whenever possible.

   The LogotypeReference, LogotypeImage and LogotypeAudio structures
   explicitly identify one or more one-way hash functions employed.
   Clients MUST support the SHA-1 [SHS] one-way hash function, and
   clients MAY support other one-way hash functions. CAs MUST include a
   SHA-1 hash value in every logotypes extension, and CAs MAY include
   other one-way hash values. If more than one is present, clients MUST
   validate at least one value.





Santesson, Housley, & Freeman                                   [Page 9]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   A MIME type is used to specify the format of the file containing the
   logotype data. Implementations MUST support both the JPEG and GIF
   image formats (with MIME types of "image/jpeg" and "image/gif",
   respectively). Animated images SHOULD NOT be used. Implementations
   that support audio MUST support the MP3 audio format (with a MIME
   type of "audio/mpeg").

   When language is specified within the LogotypeAudioInfo structure,
   the language tag MUST use the RFC 3066 [LANGCODES] syntax.

   The predefined logotype types are:

      Community Logotype. If communityLogo is present, the logotype MUST
      represent the community to which the certificate issuer is
      affiliated. The communityLogo MAY be present in an end entity
      certificate, a CA certificate or an attribute certificate.

      Issuer Organization Logotype.  If issuerLogo is present, the
      logotype MUST represent the issuer's organization. The logotype
      MUST be consistent with, and require the presence of, an
      organization name stored in the organization attribute in the
      issuer field (for either a public key certificate or attribute
      certificate). The issuerLogo MAY be present in an end entity
      certificate, a CA certificate, or an attribute certificate.

      Subject Organization Logotype. If subjectLogo is present, the
      logotype MUST represent the subject's organization. The logotype
      MUST be consistent with, and require the presence of, an
      organization name stored in the organization attribute in the
      subject field (for either a public key certificate or attribute
      certificate). The subjectLogo MAY be present in an end entity
      certificate, a CA certificate, or an attribute certificate.

   The relationship between the subject organization and the subject
   organization logotype and the relationship between the issuer and
   either the issuer organization logotype or the community logotype,
   are relationships asserted by the issuer. The policies and practices
   employed by the issuer to check subject organization logotypes or
   claims its issuer and community logotypes is outside the scope of
   this standard.

4.2 Other Logotypes

   Logotypes identified by otherLogos (as defined in 4.1) can be used to
   enhance display of logotypes and marks that represent partners,
   products, services, or any other characteristic associated with the
   certificate or its intended application environment when the standard
   logotype types are insufficient.



Santesson, Housley, & Freeman                                  [Page 10]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   The conditions and context of the intended use of these logotypes is
   defined at the discretion of the local client application.

   The following other logotype types are defined in this standard:

      - Certificate Background logotype
      - Loyalty logotype

   OID Definitions:

      id-logo OBJECT IDENTIFIER ::= { id-pkix 20 }

      id-logo-loyalty    OBJECT IDENTIFIER ::= { id-logo 1 }
      id-logo-background OBJECT IDENTIFIER ::= { id-logo 2 }

   A loyalty logotype, if present, MUST contain a logotype associated
   with a loyalty program related to the certificate or its use. The
   relation between the certificate and the identified loyalty program
   is beyond the scope of this standard. The logotype extension MAY
   contain more than one Loyalty logotype.

   The certificate background logotype, if present, MUST contain a
   graphical image intended as background image for the certificate,
   and/or a general audio sequence for the certificate. The background
   image MUST allow black text to be clearly read when placed on top of
   the background image. The logotype extension MUST NOT contain more
   than one certificate background logotype.

5. Type of certificates

   Logotypes MAY included in public key certificates and attribute
   certificates at the discretion of the certificate issuer; however;
   logotypes MUST NOT be part of certification path validation or any
   type of automated processing. The sole purpose of logotypes is to
   enhance display of a particular certificate, regardless of its
   position in a certification path.

6. Use in Clients

   All PKI implementations require relying party software to have some
   mechanism to determine whether a trusted CA issues a particular
   certificate. This is an issue for certification path validation,
   including consistent policy and name checking.

   After a certification path is successfully validated, the replying
   party trusts the information that the CA includes in the certificate,
   including any certificate extensions. The client software can choose
   to make use of such information, or the client software can ignore



Santesson, Housley, & Freeman                                  [Page 11]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   it. If client is unable to support a provided logotype, the client
   MUST NOT report an error, rather the client MUST behave as though no
   logotype extension was included in the certificate. Current standards
   do not provide any mechanism for cross-certifying CAs to constrain
   subordinate CAs from including private extensions (see the security
   considerations section).

   Consequently, if relying party software accepts a CA, then it should
   be prepared to (unquestioningly) display the associated logotypes to
   its human user, given that it is configured to do so. Information
   about the logotypes is provided so that the replying party software
   can select the one that will best meet the needs of the human user.
   This choice depends on the abilities of the human user as well as the
   capabilities of the platform on which the replaying party software is
   running. If none of the provided logotypes meets the needs of the
   human user or matches the capabilities of the platform, then the
   logotypes can be ignored.

   The logotype is to be displayed in conjunction with other identity
   information contained in the certificate. The logotype is not a
   replacement for this identity information.

   Care is needed when designing replying party software to ensure that
   appropriate context of logotype information is provided. This is
   especially difficult with audio logotypes. It is important that the
   human user is able to distinguish the context of the logotype even if
   other audio streams are being played.

   If the relying party software is unable to successfully validate a
   particular certificate, then it MUST NOT display any logotype data
   associated with that certificate unless the end user is given a clear
   warning that the certificate, including its associated logotypes
   cannot be trusted.

7. Security considerations

   Logotypes are very difficult to securely and accurately define. Names
   are also difficult in this regard, but logotypes are even worse. It
   is quite difficult to specify what is, and what is not, a legitimate
   logotype of an organization. There is a whole legal structure around
   this issue, and it will not be repeated here. However, issuers should
   be aware of the implications of including images associated with a
   trademark or servicemark before doing so.

   As logotypes can be difficult (and sometimes expensive) to verify,
   this increases the possibility of errors related to assigning wrong
   logotypes to organizations.




Santesson, Housley, & Freeman                                  [Page 12]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   This is not a new issue for electronic identification instruments. It
   is already dealt with in numerous of similar situations in the
   physical world, including physical employee identification cards.
   Secondly, there are situations where identification of logotypes is
   rather simple and straightforward, such as logotypes for well-known
   industries and institutes. These issues should not stop those service
   providers who want to issue logotypes from doing so, where relevant.

   It is impossible to prevent fraudulent creation of certificates by
   dishonest or badly performing issuers, containing names and logotypes
   that the issuer has no claim to or has failed to check correctly.
   Such certificates could be created in an attempt to socially engineer
   a user into accepting a certificate. The premise used for the
   logotype work is thus that logotype graphics in a certificate are
   trusted only if the certificate is successfully validated within a
   valid path. It is thus imperative that the representation of any
   certificate that fails to validate is not enhanced in any way by
   using the logotype graphic unless an appropriate warning is given to
   the end user.

   Certification paths may also impose name constraints that are
   systematically checked during certification path processing, which,
   in theory, may be circumvented by logotypes.

   Certificate path processing as defined in RFC 3280 [PKIX-1] does not
   constrain the inclusion of logotype data in certificates. A parent CA
   can constrain certification path validation such that subordinate CAs
   cannot issue valid certificates to end-entities outside a limited
   name space or outside specific certificate polices. A malicious CA
   can comply with these name and policy requirements and still include
   inappropriate logotypes in the certificates that it issues. These
   certificates will pass the certification path validation algorithm,
   which means the client will trust the logotypes in the certificates.
   Since there is no technical mechanism to prevent or control
   subordinate CAs from including the logotype extension or its
   contents, where appropriate, a parent CA could employ a legal
   agreement to impose a suitable restriction on the subordinate CA.
   This situation is not unique to the logotype extension.

   The controls available to a parent CA to protect itself from rogue
   subordinate CAs are non-technical. They include:

     - Contractual agreements of suitable behavior, including
       terms of liability and severance pay in case of material
       breach.

     - Control mechanisms and procedures to monitor and
       follow-up behavior of subordinate CAs.



Santesson, Housley, & Freeman                                  [Page 13]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


     - Use of certificate policies to declare assurance level
       of logotype data as well as to guide applications on how
       to treat and display logotypes.

     - Use of revocation functions to revoke any misbehaving CA.

   There is not a simple, straightforward, and absolute technical
   solution. Rather, involved parties must settle some aspects of PKI
   outside the scope of technical controls. As such, issuers need to
   clearly identify and communicate the associated risks.

8. References

   [CMS]        R. Housley, Cryptographic Message Syntax (CMS), RFC 3369,
                August 2002.

   [LANGCODES]  H. T. Alvestrand, "Tags for Identification of Languages",
                RFC 3066, January 2001.

   [PKIX-1]     R. Housley, W. Polk, W. Ford, and D. Solo, "Internet
                X.509 Public Key Infrastructure: Certificate and
                Certificate Revocation List (CRL) Profile", RFC 3280,
                April 2002.

   [SHS]        Federal Information Processing Standards Publication
                (FIPS PUB) 180-1, Secure Hash Standard, 17 April 1995.
                [Supersedes FIPS PUB 180 dated 11 May 1993.]

   [STDWORDS]   S. Bradner, "Key words for use in RFCs to Indicate
                Requirement Levels", RFC 2119, March 1997.





















Santesson, Housley, & Freeman                                  [Page 14]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


APPENDIX A. ASN.1 Module

   LogotypeCertExtn
     { iso(1) identified-organization(3) dod(6) internet(1)
       security(5) mechanisms(5) pkix(7) id-mod(0)
       id-mod-logotype(22) }

   DEFINITIONS IMPLICIT TAGS ::=
   BEGIN

   IMPORTS
      AlgorithmIdentifier FROM PKIX1Explicit88 -- RFC 3280
        { iso(1) identified-organization(3) dod(6) internet(1)
          security(5) mechanisms(5) pkix(7) id-mod(0)
          id-pkix1-explicit(18) };


   -- Logotype Extension OID

   id-pe-logotype  OBJECT IDENTIFIER  ::=
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-pe(1) 12 }


   -- Logotype Extension Syntax

   LogotypeExtn ::= SEQUENCE {
      communityLogo   [0] EXPLICIT LogotypeInfo OPTIONAL,
      issuerLogo      [1] EXPLICIT LogotypeInfo OPTIONAL,
      subjectLogo     [2] EXPLICIT LogotypeInfo OPTIONAL,
      otherLogos      [3] SEQUENCE OF OtherLogotypeInfo OPTIONAL }

   LogotypeInfo ::= CHOICE {
      direct          [0] LogotypeData,
      indirect        [1] LogotypeReference }

   LogotypeData ::= SEQUENCE {
      image           SEQUENCE OF LogotypeImage OPTIONAL,
      audio           [1] SEQUENCE OF LogotypeAudio OPTIONAL }

   LogotypeImage ::= SEQUENCE {
      imageSubtype    IA5String, -- MIME image subtype
      imageHash       SEQUENCE SIZE (1..MAX) OF HashAlgAndValue,
      imageURI        SEQUENCE SIZE (1..MAX) OF IA5String,
      imageInfo       LogotypeImageInfo OPTIONAL }






Santesson, Housley, & Freeman                                  [Page 15]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   LogotypeAudio ::= SEQUENCE {
      audioSubtype    IA5String, -- MIME audio subtype
      audioHash       SEQUENCE SIZE (1..MAX) OF HashAlgAndValue,
      audioURI        SEQUENCE SIZE (1..MAX) OF IA5String,
      audioInfo       LogotypeAudioInfo OPTIONAL }

   LogotypeImageInfo ::= CHOICE {
      grayScale       [0] LogotypeGrayScaleImageInfo,
      color           [1] LogotypeGrayScaleImageInfo }

   LogotypeGrayScaleImageInfo ::= SEQUENCE {
      fileSize        INTEGER,  -- In octets
      xSize           INTEGER,  -- In pixels
      ySize           INTEGER,  -- In pixels
      numLevels       INTEGER } -- In bits

   LogotypeColorImageInfo ::= SEQUENCE {
      fileSize        INTEGER,  -- In octets
      xSize           INTEGER,  -- In pixels
      ySize           INTEGER,  -- In pixels
      numColors       INTEGER } -- In bits

   LogotypeAudioInfo ::= SEQUENCE {
      fileSize        INTEGER, -- In octets
      playTime        INTEGER, -- In milliseconds
      sampleRate      INTEGER, -- Samples per second
      channels        INTEGER, -- 1=mono, 2=stereo, 4=quad
      language        IA5String OPTIONAL } -- RFC 3066 Language Tag

   OtherLogotypeInfo ::= SEQUENCE {
      logotypeType    OBJECT IDENTIFIER,
      info            LogotypeInfo }

   LogotypeReference ::= SEQUENCE {
      refStructHash   SEQUENCE SIZE (1..MAX) OF HashAlgAndValue,
      refStructURI    SEQUENCE SIZE (1..MAX) OF IA5String }
                         -- Places to get the same "LTD" file

   -- Note: The content of referenced "LTD" files is defined by the
   --       LogotypeData type

   HashAlgAndValue ::= SEQUENCE {
      hashAlg         AlgorithmIdentifier,
      hashValue       OCTET STRING }







Santesson, Housley, & Freeman                                  [Page 16]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   -- Other logotype type OIDs

   id-logo OBJECT IDENTIFIER ::= { iso(1) identified-organization(3)
      dod(6) internet(1) security(5) mechanisms(5) pkix(7) 20 }

   id-logo-loyalty    OBJECT IDENTIFIER ::= { id-logo 1 }
   id-logo-background OBJECT IDENTIFIER ::= { id-logo 2 }


   END









































Santesson, Housley, & Freeman                                  [Page 17]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


APPENDIX B. Logotype Placement

   This Appendix documents reasons and rationales behind the technical
   solution selected in this standard.

   Three alternatives for the placement of the logotypes in a
   certificate have been considered.  They are:

     1. Inclusion in a policy qualifier;
     2. Inclusion in Issuer and Subject Alternative names extensions;
        and
     3. Inclusion in a separate certificate extension.

B.1 Qualifier

   This alternative would include logotype data as a newly defined
   policy qualifier.

   Pros:

   - This solution provides a mechanism to directly control the use and
     display of logotypes under a particular policy.

   Cons:

   - RFC 3280 [PKIX-1] recommends against use of qualifiers.

   - This is generally considered to be a major hack and stretch of
     semantics, since this type of data doesn't qualify a policy in any
     way.

B.2 Issuer and Subject Alt Names

   This solution would use the other name form to include the issuer and
   community logotypes in the issuer alt name extension, and subject
   organization logo in the subject alt name extension.

   Pros:

   - This mechanism could possibly enable cross-certifying CAs to deny
     any subordinate CA the right to include logotypes in descending end
     entity certificates by listing the logotypes name form in
     excludedSubtrees.

   Cons:

   - Logotypes are not a name form and should not be treated as a
     displayable name.



Santesson, Housley, & Freeman                                  [Page 18]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   - It is generally understood that it should be possible to apply
     general name constraint mechanisms (as described in RFC 2459 as
     well as RFC <TBD> [PKIX-1]) to names in the subject and issuer
     alt name extension. This is not possible to do with logotypes
     since it is not a name form.

   - This split storage of logotype data into 2 different locations,
     which may make life worse for applications with no interest in
     logotypes.

   - It is generally agreed that inclusion of logotype data by no means
     should be regarded as critical data. This may interfere with the
     criticality policy of the alt name extensions, especially if the
     certificate has no attributes in the subject field, forcing the
     subject alt name to be set to critical.

   - This usage would possibly interfere with the resolution between
     IETF and ITU-T regarding use of permitted subtrees.

   - Since this solution may break current implementations it would
     possibly block adoption of logotypes.

B.3 New extension

   This solution places logotype data in a new extension.

   Pros:

   - This is the cleanest solution.

   - This does not impact on legacy implementations.

   Cons:

   - This solution activates the issue whether this extension may be
     abused by a CA who include logotypes (in EE certificates) that
     violates the intention of a name constraints set by a chaining CA.
     This issue is addressed in the security consideration section
     below.

B.4 Conclusion

   We must not destroy current structures. We must not create problems
   or confusion.

   Only the private extension solution satisfies both of these criteria.
   Therefore, the private extension was selected to carry logotype
   information.



Santesson, Housley, & Freeman                                  [Page 19]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


   While the syntax and semantics of the X.509 public key certificate
   were used in this analysis, the logotype private extension can also
   be included in an X.509 attribute certificate.

APPENDIX C. Author Addresses

   Stefan Santesson
   AddTrust AB
   P.O. Box 465
   S-201 24 Malmoe
   Sweden
   stefan@addtrust.com

   Russell Housley
   RSA Laboratories
   918 Spring Knoll Drive
   Herndon, VA 20170
   USA
   rhousley@rsasecurity.com

   Trevor Freeman
   Microsoft Corporation
   One Microsoft Way
   Redmond WA 98052
   USA
   trevorf@microsoft.com

APPENDIX D. Acknowledgments

   This document is the result of contributions from many professionals.
   The authors appreciate contributions from all members of the IETF
   PKIX Working Group. We extend a special thanks to Al Arsenault, David
   Cross, Tim Polk, Russel Weiser, Terry Hayes, Alex Deacon, Andrew
   Hoag, Randy Sabett and Phil Griffin for their efforts and support.

















Santesson, Housley, & Freeman                                  [Page 20]

INTERNET DRAFT       Logotypes in X.509 Certificates        October 2002


Full Copyright Statement

   Copyright (C) The Internet Society (2002). All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  In addition, the
   ASN.1 modules presented in Appendices A and B may be used in whole or
   in part without inclusion of the copyright notice.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process shall be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns. This
   document and the information contained herein is provided on an "AS
   IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING TASK
   FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT
   LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN WILL
   NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY
   OR FITNESS FOR A PARTICULAR PURPOSE.























Santesson, Housley, & Freeman                                  [Page 21]
