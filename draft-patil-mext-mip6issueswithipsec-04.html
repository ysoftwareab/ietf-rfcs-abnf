<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Problems with the use of IPsec as the security protocol for Mobile IPv6</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology and Abbreviations">
<link href="#rfc.section.3" rel="Chapter" title="3 Background">
<link href="#rfc.section.4" rel="Chapter" title="4 Problem statement">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Problem Statement">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 General issues with the use of IPsec for MIP6     security">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Security Association Management">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Bootstrapping of Additional Mobile IPv6 Parameters">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 Protecting Traffic Between Mobile Node and Home Agent">
<link href="#rfc.section.5" rel="Chapter" title="5 Mobile Node to Home Agent Controller Communication">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Request-response Message Framing over TLS-tunnel">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Request-response Message Content Encoding">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Request-Response Message Exchange">
<link href="#rfc.section.5.4" rel="Chapter" title="5.4 Home Agent Controller Discovery">
<link href="#rfc.section.5.5" rel="Chapter" title="5.5 Generic Request-Response Parameters">
<link href="#rfc.section.5.5.1" rel="Chapter" title="5.5.1 Mobile Node Identifier">
<link href="#rfc.section.5.5.2" rel="Chapter" title="5.5.2 Authentication Method">
<link href="#rfc.section.5.5.3" rel="Chapter" title="5.5.3 Extensible Authentication Protocol Payload">
<link href="#rfc.section.5.5.4" rel="Chapter" title="5.5.4 Status Code">
<link href="#rfc.section.5.5.5" rel="Chapter" title="5.5.5 Message Authenticator">
<link href="#rfc.section.5.5.6" rel="Chapter" title="5.5.6 Retry After">
<link href="#rfc.section.5.5.7" rel="Chapter" title="5.5.7 End of Message Content">
<link href="#rfc.section.5.5.8" rel="Chapter" title="5.5.8 Random Values">
<link href="#rfc.section.5.6" rel="Chapter" title="5.6 Security Association Configuration Parameters">
<link href="#rfc.section.5.6.1" rel="Chapter" title="5.6.1 Security Parameter Index">
<link href="#rfc.section.5.6.2" rel="Chapter" title="5.6.2 MN-HA Shared Keys">
<link href="#rfc.section.5.6.3" rel="Chapter" title="5.6.3 Security Association Validity Time">
<link href="#rfc.section.5.6.4" rel="Chapter" title="5.6.4 Security association scope (SAS)">
<link href="#rfc.section.5.6.5" rel="Chapter" title="5.6.5 CipherSuites and Ciphersuite-to-Algorithm Mapping">
<link href="#rfc.section.5.7" rel="Chapter" title="5.7 Mobile IPv6 Bootstrapping Parameters">
<link href="#rfc.section.5.7.1" rel="Chapter" title="5.7.1 Home Agent Address">
<link href="#rfc.section.5.7.2" rel="Chapter" title="5.7.2 Home Addresses and Home Network Prefix">
<link href="#rfc.section.5.8" rel="Chapter" title="5.8 Authentication of the Mobile Node">
<link href="#rfc.section.5.9" rel="Chapter" title="5.9 Extensible Authentication Protocol Methods">
<link href="#rfc.section.6" rel="Chapter" title="6 Mobile Node to Home Agent communication">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 General">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Security Parameter Index">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 Binding Management Message Formats">
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 Reverse Tunneled User Data Packet Formats">
<link href="#rfc.section.7" rel="Chapter" title="7 Route Optimization">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 New Registry: Packet Type">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 HTTP Headers">
<link href="#rfc.section.8.3" rel="Chapter" title="8.3 Status Codes">
<link href="#rfc.section.8.4" rel="Chapter" title="8.4 Port Numbers">
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Discovery of the HAC">
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 Authentication and Key Exchange executed between the MN             and the HAC">
<link href="#rfc.section.9.3" rel="Chapter" title="9.3 Protection of MN and HA Communication">
<link href="#rfc.section.9.4" rel="Chapter" title="9.4 AAA Interworking">
<link href="#rfc.section.10" rel="Chapter" title="10 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="11 References">
<link href="#rfc.references.1" rel="Chapter" title="11.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="11.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Mobile IPv6 as specified in RFC3775 relies on IPsec for securing the signaling messages and user plane traffic between the mobile node and home agent.  An IPsec SA between the mobile node and the home agent provides security for the mobility signaling.  Use of IPsec for securing the data traffic between the mobile node and home agent is optional.  This document analyses the implications of the design decision to mandate IPsec as the default security protocol for Mobile IPv6 and consequently Dual-stack Mobile IPv6 and recommends revisiting this decision in view of the experience gained from implementation and adoption in other standards bodies. " />
  <meta name="description" content="Mobile IPv6 as specified in RFC3775 relies on IPsec for securing the signaling messages and user plane traffic between the mobile node and home agent.  An IPsec SA between the mobile node and the home agent provides security for the mobility signaling.  Use of IPsec for securing the data traffic between the mobile node and home agent is optional.  This document analyses the implications of the design decision to mandate IPsec as the default security protocol for Mobile IPv6 and consequently Dual-stack Mobile IPv6 and recommends revisiting this decision in view of the experience gained from implementation and adoption in other standards bodies. " />
  <meta name="keywords" content="Internet-Draft, Mobile IPv6, Security" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Mobility Extensions (MEXT)</td>
<td class="right">B. Patil</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Nokia</td>
</tr>
<tr>
<td class="left">Intended status: Experimental Protocol</td>
<td class="right">C. Perkins</td>
</tr>
<tr>
<td class="left">Expires: April 13, 2012</td>
<td class="right">Tellabs</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">H. Tschofenig</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Nokia Siemens Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">D. Premec</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Unaffiliated</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 11, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Problems with the use of IPsec as the security protocol for Mobile IPv6<br />
  <span class="filename">draft-patil-mext-mip6issueswithipsec-04.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Mobile IPv6 as specified in RFC3775 relies on IPsec for securing the signaling messages and user plane traffic between the mobile node and home agent.  An IPsec SA between the mobile node and the home agent provides security for the mobility signaling.  Use of IPsec for securing the data traffic between the mobile node and home agent is optional.  This document analyses the implications of the design decision to mandate IPsec as the default security protocol for Mobile IPv6 and consequently Dual-stack Mobile IPv6 and recommends revisiting this decision in view of the experience gained from implementation and adoption in other standards bodies. </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 13, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology and Abbreviations</a>
</li>
<li>3.   <a href="#rfc.section.3">Background</a>
</li>
<li>4.   <a href="#rfc.section.4">Problem statement</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Problem Statement</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">General issues with the use of IPsec for MIP6     security</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Security Association Management</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Bootstrapping of Additional Mobile IPv6 Parameters</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">Protecting Traffic Between Mobile Node and Home Agent</a>
</li>
<li>5.   <a href="#rfc.section.5">Mobile Node to Home Agent Controller Communication</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Request-response Message Framing over TLS-tunnel</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Request-response Message Content Encoding</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Request-Response Message Exchange</a>
</li>
<li>5.4.   <a href="#rfc.section.5.4">Home Agent Controller Discovery</a>
</li>
<li>5.5.   <a href="#rfc.section.5.5">Generic Request-Response Parameters</a>
</li>
<li>5.5.1.   <a href="#rfc.section.5.5.1">Mobile Node Identifier</a>
</li>
<li>5.5.2.   <a href="#rfc.section.5.5.2">Authentication Method</a>
</li>
<li>5.5.3.   <a href="#rfc.section.5.5.3">Extensible Authentication Protocol Payload</a>
</li>
<li>5.5.4.   <a href="#rfc.section.5.5.4">Status Code</a>
</li>
<li>5.5.5.   <a href="#rfc.section.5.5.5">Message Authenticator</a>
</li>
<li>5.5.6.   <a href="#rfc.section.5.5.6">Retry After</a>
</li>
<li>5.5.7.   <a href="#rfc.section.5.5.7">End of Message Content</a>
</li>
<li>5.5.8.   <a href="#rfc.section.5.5.8">Random Values</a>
</li>
<li>5.6.   <a href="#rfc.section.5.6">Security Association Configuration Parameters</a>
</li>
<li>5.6.1.   <a href="#rfc.section.5.6.1">Security Parameter Index</a>
</li>
<li>5.6.2.   <a href="#rfc.section.5.6.2">MN-HA Shared Keys</a>
</li>
<li>5.6.3.   <a href="#rfc.section.5.6.3">Security Association Validity Time</a>
</li>
<li>5.6.4.   <a href="#rfc.section.5.6.4">Security association scope (SAS)</a>
</li>
<li>5.6.5.   <a href="#rfc.section.5.6.5">CipherSuites and Ciphersuite-to-Algorithm Mapping</a>
</li>
<li>5.7.   <a href="#rfc.section.5.7">Mobile IPv6 Bootstrapping Parameters</a>
</li>
<li>5.7.1.   <a href="#rfc.section.5.7.1">Home Agent Address</a>
</li>
<li>5.7.2.   <a href="#rfc.section.5.7.2">Home Addresses and Home Network Prefix</a>
</li>
<li>5.8.   <a href="#rfc.section.5.8">Authentication of the Mobile Node</a>
</li>
<li>5.9.   <a href="#rfc.section.5.9">Extensible Authentication Protocol Methods</a>
</li>
<li>6.   <a href="#rfc.section.6">Mobile Node to Home Agent communication</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">General</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Security Parameter Index</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">Binding Management Message Formats</a>
</li>
<li>6.4.   <a href="#rfc.section.6.4">Reverse Tunneled User Data Packet Formats</a>
</li>
<li>7.   <a href="#rfc.section.7">Route Optimization</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>8.1.   <a href="#rfc.section.8.1">New Registry: Packet Type</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">HTTP Headers</a>
</li>
<li>8.3.   <a href="#rfc.section.8.3">Status Codes</a>
</li>
<li>8.4.   <a href="#rfc.section.8.4">Port Numbers</a>
</li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a>
</li>
<li>9.1.   <a href="#rfc.section.9.1">Discovery of the HAC</a>
</li>
<li>9.2.   <a href="#rfc.section.9.2">Authentication and Key Exchange executed between the MN             and the HAC</a>
</li>
<li>9.3.   <a href="#rfc.section.9.3">Protection of MN and HA Communication</a>
</li>
<li>9.4.   <a href="#rfc.section.9.4">AAA Interworking</a>
</li>
<li>10.   <a href="#rfc.section.10">Acknowledgements</a>
</li>
<li>11.   <a href="#rfc.references">References</a>
</li>
<li>11.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>11.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Mobile IPv6 as specified in  <a href="#RFC3775">[RFC3775]</a> requires an IPsec security association between the mobile node (MN) and home agent (HA).  The IPsec SA protects the mobility signaling messages between the MN and HA.  The user data may be optionally protected by the IPsec SA but is not required.  The use of IPsec by most hosts today is primarily as a solution for enterprise connectivity through VPN applications.  IPsec has not evolved into a generic security protocol. </p>
<p id="rfc.section.1.p.2">The use of IPsec and IKE (v1 and v2) with Mobile IPv6 are specified in RFCs 3776 <a href="#RFC3776">[RFC3776]</a> and 4877 <a href="#RFC4877">[RFC4877]</a>.  The Mobile IP and MIP6 working groups in the IETF chose to mandate IPsec as the default security protocol for Mobile IPv6 based on various criteria and lengthy discussions that occured between the years 2000 and 2004.  Implementation experience with Mobile IPv6 and the security variants with which it has been specified in some SDOs indicates a need to revisit the design choice for MIP6 signaling security.  The analysis and recommendation to revisit the security protocol architecture for MIP6 should not be interpreted as a recommendation for Authentication Protocol for Mobile IPv6 <a href="#RFC4285">[RFC4285]</a>.  The objective is to highlight the misfit of IPsec and IKEv2 as the security protocol for MIP6 and hence the need for considering alternatives.  A simpler security architecture for securing the signaling and traffic between the MN and HA can co-exist with the IPsec based solution as well.  </p>
<p id="rfc.section.1.p.3">The objective of Mobile IPv6 <a href="#RFC3775">[RFC3775]</a> is to enable IP mobility for IPv6 hosts. The security aspect of the protocol is a critical component for consideration in terms of deployment and operation on large scales. If complexity of implementation were a consideration then the current specification dealing with Mobile IPv6, i.e RFC3775 <a href="#RFC3775">[RFC3775]</a> and RFC5555 <a href="#RFC5555">[RFC5555]</a> would win high accolades. An implementer spends 20% of his time on implementing the Mobile IPv6 protocol and 80% of the time integrating it with IPsec and IKEv2. And even after that interoperability of the client with home agents is not guaranteed. The IPsec/IKEv2 security architecture may work in implementations wherein the OS, the IPsec/IKEv2 stack and mobile ipv6 client software are all implemented by a single entity. It just does not work on open systems.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#terms" id="terms">Terminology and Abbreviations</a>
</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>. </p>
<p id="rfc.section.2.p.2">This document refers to [RFC3775][RFC4877] for terminology.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Background</h1>
<p id="rfc.section.3.p.1">IP mobility support in IPv6 was considered to be an integral feature of the IPv6 stack based on the experience gained from developing mobility support for IPv4.  The design of Mobile IPv6 was worked on by the Mobile IP WG in the late 90s and by the MIP6 WG until its publication as <a href="#RFC3775">[RFC3775]</a> in 2004.  </p>
<p id="rfc.section.3.p.2">IPsec [RFC4301] was also intended to be a default component of the IPv6 stack and was the preferred protocol choice for use by any other IPv6 protocol that needed security.  Rather than design security into every protocol feature, the intent was to reuse a well-defined security protocol to meet the security needs.  Hence Mobile IPv6 has been designed with a security architecture that relies on reusing IPsec.  </p>
<p id="rfc.section.3.p.3">The Mobile IPv6 specification <a href="#RFC3775">[RFC3775]</a> was published along with the companion specification "Using IPsec to Protect Mobile IPv6 Signaling Between Mobile Nodes and Home Agents", <a href="#RFC3776">[RFC3776]</a>.  The establishment of the IPsec SA between the MN and HA as per RFC 3776 is based on the use of IKE.  The use of IKE in the context of Mobile IPv6 for IPsec SA establishment did not gain traction because of factors such as complexity of IKE and the IETF transitioning to IKEv2.  The MIP6 WG completed the specification, Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture <a href="#RFC4877">[RFC4877]</a> in April 2007.  This <a href="#RFC4877">[RFC4877]</a> is considered as the default security protocol solution for MIP6 and updates <a href="#RFC3776">[RFC3776]</a>.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Problem statement</h1>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Problem Statement</h1>
<p id="rfc.section.4.1.p.1">Mobile IPv6 is encumbered by its reliance on IPsec <a href="#RFC4301">[RFC4301]</a> from an implementation and deployment perspective.  As a protocol solution for host based mobility, MIP6 can be simpler without the IPsec baggage.  The issues with IPsec are even more exacerbated in the case of dual-stack MIP6 <a href="#RFC5555">[RFC5555]</a>.  </p>
<p id="rfc.section.4.1.p.2">IPsec SAs between the MN and HA are established either manually or via the use of IKEv2 <a href="#RFC4306">[RFC4306]</a>.  Manual SA configuration is not a scalable solution and hence MIP6 hosts and Home agents rely on IKEv2 for establishing dynamically IPsec SAs.  As a result MIP6 depends on the existence of IPsec and IKEv2 for successful operation.  </p>
<p id="rfc.section.4.1.p.3">IPsec is unable to provide security protection for MIP6 in a transparent way, and numerous interactions between the host's security subsystems and the MIP6 application are needed in the course of the regular operation of the MIP6 application.  Besides requiring an extensive communications channel between the security subsystems and the MIP6 application, those interactions often also require modification of the MNs security subsystems code.  The situation today is such that the communications channel between the IPsec subsystems and the MIP6 application is non existent and this is generally true for most of the commercially available platforms.  Even if such a channel were to be available, there does not exist a standardized protocol over that channel which would enable the MIP6 application to communicate with the security modules in a non- implementation specific way.  </p>
<p id="rfc.section.4.1.p.4">Considering a third party application developer who would like to provide a MIP6 application for a particular platform, the need for numerous interactions with the IPsec subsystem and the unavailability of the standardized communications channel through which such interactions could take place is a major obstacle to the implementation of the mobility protocol.  Without such a communication channel being available it is not possible to implement a MIP6 application as a third party developer. </p>
<p id="rfc.section.4.1.p.5">Even if the platform would provide such a communication interface for the MIP6 daemon, this is still insufficient as the MIP6 protocol standardized today <a href="#RFC3775">[RFC3775]</a> requires numerous changes to the host's IPsec and IKEv2 implementation.  This document enumerates various implementation issues related to the interactions between the MIP6 application and the host's security subsystems.</p>
<p id="rfc.section.4.1.p.6">An argument can be made that the MIP6 application itself should provide the required changes to the IPsec subsystems of the platform (maybe in the form of patches).  While this is possible at least for some open source platforms to provide modifications to the host's IPsec implementation as well as the key management application(s), this is still an issue for several reasons: </p>
<p></p>

<ul class="empty">
<li>Target platform could be a commercial platform for which no source code for the security modules (IPsec and IKEv2) is available.</li>
<li>If the MIP6 application were to patch the IPsec subsystems, then multiple MIP6 applications from different developers would implement it in different ways, which would inevitably lead to variations and problems with interoperability at a minimum, for instance when the user tries to install several MIP6 applications it is difficult to determine which one is the best suited for his/ her needs.</li>
<li>Key management daemons are usually provided as third party software for which no source code may be available, even if the platform itself is available as open source.</li>
<li>Even if the MIP6 application developer would be willing to provide patches for the key management daemon to make it work with his MIP6 application, how would the MIP6 application developer know which of the several available key management daemons the user is running?</li>
<li>Each application would be able to work only with a single key management daemon, namely the one for which the MIP6 application provides the patches.  The user may be running another key management daemon and may be unwilling to change its daemon to the one that comes as part of the MIP6 application.</li>
<li>Patches for the IPsec part in the kernel and the key management daemon would typically be valid only for the particular version of the kernel and the key management daemon for which they were written.  This might prevent the user from upgrading the platform or applying OS security patches that are provided as part of the regular platform maintenance since this would in all probability make the MIP6 application defunct.</li>
<li>Modifying the security subsystems by a third party is a security issue and users are generally advised to refrain from allowing the security subsystems to be modified in any way.</li>
<li>he developer may not have the knowledge or the time to modify the platform's IKEv2 and IPsec subsystems, although it might be perfectly capable to deliver the MIP6 application itself.</li>
<li>There could be copyright issues as well that would prevent modifications of the platform's security subsystems or the delivery of the modifications by the third party.</li>
<li>Even if the MIP6 application developer is able to come up with the necessary patches for the security subsystem, it is not realistic to expect the prospective user of MIPv6 to first patch the kernel and the key management daemons before using the MIPv6 service.</li>
</ul>

<p> </p>
<p id="rfc.section.4.1.p.8">The above discussion shows why it is unrealistic to expect that the MIP6 application could provide the needed modifications to the IKEv2 and IPsec subsystems of the host.  Section 6 presents a more technical discussion of various implementation issues related to the interworking between the MIP6 application and the IPsec/key management modules.</p>
<p id="rfc.section.4.1.p.9">The problem in a nutshell for MIP6 is the dependence on IPsec and IKEv2 for successful operation.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> General issues with the use of IPsec for MIP6     security</h1>
<p id="rfc.section.4.2.p.1">This section captures several issues with the use of IPsec by MIP6.  </p>
<p></p>

<ol>
<li>The design of Mobile IPv6 emphasized the reuse of IPv6 features such as IPsec.  IPsec for IPv4 was a bolt-on solution.  With the increasing need for security, IPv6 designers chose to incorporate IPsec as a default feature.  There existed an assumption in the MIP6 working group that every IPv6 host would have IPsec capability as a standard feature.  While this is true in many host implementations today, the existence of IPsec in every IPv6 stack is not a given.  Hence a host which needs to implement Mobile IPv6 must ensure that IPsec and IKEv2 are also available.  As a result of this dependence, MIP6 is no longer a standalone host-based mobility protocol.  A good example of a host based mobility protocol that works as a self-sufficient module is Mobile IPv4 <a href="#RFC3344">[RFC3344]</a>.  The security associated with MIP4 signaling is integrated into the protocol itself.  MIP4 has been successfully deployed on a large scale in several networks.  </li>
<li>IPsec use in most hosts is generally for the purpose of VPN connectivity to enterprises.  It has not evolved into a generic security protocol that can be used by Mobile IPv6 easily.  While <a href="#RFC4877">[RFC4877]</a> does specify the details which enable only the MIP6 signaling to be encapsulated with IPsec, the general method of IPsec usage has been such that all traffic between a host and the IPsec gateway is carried via the tunnel.  Selective application of IPsec to protocols is not the norm.  Use of IPsec with Mobile IPv6 requires configuration which in many cases is not easily achievable because of reasons such as enterprise environments preventing changes to IPsec policies.  </li>
<li>A MIP6 home agent is one end of the IPsec SA in a many-to-one relationship.  A MIP6 HA may support a very large number of mobile nodes which could be in the hundreds of thousands to millions.  The ability to terminate a large number of IPsec SAs (millions) requires signifiant hardware and platform capability.  The cost issues of such an HA are detrimental and hence act as a barrier to deployment.  </li>
<li>The implementation complexity of Mobile IPv6 is greatly increased because of the interaction with IKEv2.  The complexity of the protocol implementation is even more so in the case of Dual stack MIP6 <a href="#RFC5555">[RFC5555]</a> wherein NAT traversal scenarios are considered.  </li>
<li>IPsec and IKEv2 are not implemented or available by default in every IPv6 or dual stack host.  Mobile IPv6 support on such devices is not an option.  Many low-end cellular hosts have IP stacks.  The need for IPsec and IKEv2 in these devices is not important whereas mobility support is needed in many cases.  A simpler security protocol than the use of IPsec/IKEv2 would make MIP6 much more attractive to implement and deploy.  </li>
<li>
<a href="#RFC4877">[RFC4877]</a> which specifies the use of IKEv2 and IPsec with Mobile IPv6 essentially results in a variant of IPsec which is specific to Mobile IP.  Hence this results in added complexity to implementations.  </li>
<li>Mobile IPv6 needs to be capable of being deployed in situations where alternative security mechanisms are already well- understood by the network administration.  It should be possible to enable Mobile IPv6 to work in situations where alternative security mechanisms already supply the necessary authentication and privacy.  </li>
<li>IPsec has been successfully applied to VPN and other infrastructure operations, but not for general end-to-end applications.  Thus, the granularity for selectors was originally not at all sufficient for Mobile IPv6.  </li>
<li>The way that the IPsec code sits in the usual kernel, and the access mechanisms for the SA database, are not very convenient for use by straightforward implementations of Mobile IPv6.  Unusual calling sequences and parameter passing seems to be required on many platforms.  </li>
<li>In certain environments the use of IPsec and IKEv2 for establishing the SA is considered as an overhead.  Bandwidth constrained links such as cellular networks and air interfaces which are in the licensed spectrum tend to be optimized for user traffic.  MIP6 signaling with the IPsec overhead and the IKEv2 messages are viewed negatively.  It is more acceptable to have signaling without IPsec encapsulation.  </li>
</ol>

<p> </p>
<p id="rfc.section.4.2.p.3">The issues listed above can be speculatively attributed as some of the causes for MIP6 not being implemented widely.  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Security Association Management</h1>
<p id="rfc.section.4.3.p.1">Once the MN has contacted the HAC and mutual authentication has taken place between the MN and the HAC inside the TLS protected tunnel, the HAC provisions the MN with all security related information inside the TLS protected tunnel. This security related information constitutes a security association (SA) between the MN and the HA. The created SA MUST NOT be tied to the Care-of Address (CoA) of the MN.  </p>
<p id="rfc.section.4.3.p.2">The HAC may proactively distribute the SA information to HAs under its management, or the HA may query the SA information from the HAC once the MN contacts the HA. If the HA queries for the SA information from the HAC, then the HA MUST be able to query/index the SA information from the HAC based on the Security Parameter Index (SPI).  </p>
<p id="rfc.section.4.3.p.3">In certain situations, the HA may want the MN to re-establish the SA even if the existing SA is still valid. The HA can indicate this to the MN using a dedicated Status Code in a BA (value set to REINIT_SA_WITH_HAC). As a result, the MN would contact the HAC prior the SA times out, and the HAC would provision the MN and HAs with a new SA information.  </p>
<p id="rfc.section.4.3.p.4">The SA contains at least the following information: </p>
<p></p>

<dl>
<dt>Mobility SPI:</dt>
<dd style="margin-left: 8">
<br><br>This parameter is an SPI used by the MN and the HA to index the SA between the MN and the HA. The HAC is responsible for assigning SPIs to MNs.  There is only one SPI for both binding management messaging and possible user data protection. The same SPI is used for both directions between the MN and the HA. The SPI values are assigned by the HAC. The HAC MUST ensure uniqueness of the SPI values across all MNs controlled by the HAC.  <br><br> </dd>
<dt>MN-HA shared key for ciphering:</dt>
<dd style="margin-left: 8">
<br><br>This parameter is a key used for ciphering Mobile IPv6 traffic between the MN and the HA. The HAC is responsible for generating this key. The key generation algorithm is specific to the HAC implementation.  <br><br> </dd>
<dt>MN-HA shared key for integrity protection:</dt>
<dd style="margin-left: 8">
<br><br>This parameter is a key used for integrity protecting Mobile IPv6 traffic between the MN and the HA. This includes both binding management messages and reverse tunneled user data traffic between the MN and the HA.  The HAC is responsible for generating this key. The key generation algorithm is specific to the HAC implementation. In case of combined algorithms a separate integrity protection key is not needed and may be omitted.  <br><br> </dd>
<dt>Security association validity time:</dt>
<dd style="margin-left: 8">
<br><br>This parameter represents the validity time for the security association. The HAC is responsible for defining the lifetime value based on its policies. The lifetime may be in the order of hours or weeks. The MN MUST re-contact the HAC before the SA validity time ends.  <br><br> </dd>
<dt>Security Association Scope:</dt>
<dd style="margin-left: 8">
<br><br>This parameter defines whether the security association is applied to Mobile IPv6 signaling messages only, or to both Mobile IPv6 signaling messages and data traffic.  <br><br> </dd>
<dt>Selected ciphersuite:</dt>
<dd style="margin-left: 8">
<br><br>This parameter is the ciphersuite used to protect the traffic between the MN and the HA.  This includes both binding management messages and reverse tunneled user data traffic between the MN and the HA. The selected algorithms SHOULD be one of the mutually supported ciphersuites of the negotiated TLS version between the MN and the HAC. The HAC is responsible for choosing the mutually supported ciphersuite that complies with the policy of the HAC. Obviously, the HAs under HAC's management must have at least one ciphersuite with the HAC in common and need to be aware of the implemented ciphersuites.  <br><br> </dd>
<dt>Sequence number:</dt>
<dd style="margin-left: 8">
<br><br>This parameter represents a monotonically increasing unsigned sequence number used in all protected packets exchanged between the MN and the HA. The initial sequence number MUST always be set to 0 (zero). The sequence number may cycle to 0 (zero) when it increases beyond its maximum defined value.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> Bootstrapping of Additional Mobile IPv6 Parameters</h1>
<p id="rfc.section.4.4.p.1">When the MN contacts the HAC to distribute of the security related               information, the HAC may also provision the MN with various Mobile IPv6 related bootstrapping information. Bootstrapping of the following information SHOULD at least be possible: </p>
<p></p>

<dl>
<dt>Home Agent IP Address:</dt>
<dd style="margin-left: 8">
<br><br>Concerns both IPv6 and IPv4 home agent addresses.  <br><br> </dd>
<dt>Home Address:</dt>
<dd style="margin-left: 8">
<br><br>Concerns both IPv6 and IPv4 Home Addresses.  <br><br> </dd>
<dt>Home Link Prefix:</dt>
<dd style="margin-left: 8">
<br><br>Concerns the IPv6 Home link prefix and the associated prefix length.  </dd>
</dl>

<p> </p>
<p id="rfc.section.4.4.p.3">The Mobile IPv6 related bootstrapping information is delivered from the HAC to the MN over the same TLS protected tunnel as the security related information. </p>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> Protecting Traffic Between Mobile Node and Home Agent</h1>
<p id="rfc.section.4.5.p.1">The same integrity and confidentiality algorithms MUST be used to protect both binding management messages and reverse tunneled user data traffic between the MN and the HA. Generally, all binding management messages (BUs, BAs and so on) MUST be both integrity and SHOULD be confidentially protected. The reverse tunneled user data traffic SHOULD be equivalently protected.  Generally, the rules stated in <a href="#RFC3775">[RFC3775]</a> concerning the protection of the traffic between the MN and the HA apply also in this specification.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Mobile Node to Home Agent Controller Communication</h1>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#record" id="record">Request-response Message Framing over TLS-tunnel</a>
</h1>
<p id="rfc.section.5.1.p.1">The MN and the HAC communicate with each other using a simple lock-step request-response protocol that is run directly on top of the TLS-tunnel. We define only one message container framing for the request messages and for the response messages. The message containers are only meant to be exchanged on top of connection oriented TLS-layer. Therefore, the end of message exchange is determined by the other end closing the transport connection (assuming the "application layer" has also indicated the completion of the message exchange).  The peer initiating the TLS-connection is always sending "Requests" and the peer accepting the TLS-connection is always sending "Responses". The format of the message container is shown in <a href="#container">Figure 1</a>.  </p>
<div id="#rfc.figure.1"></div>
<div id="#container"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Ver |  Rsrvd  | Identifier    | Length                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Content portion..                                             ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.5.1.p.2">All data inside the Content portion of the message container MUST be encoded using octets. Fragmentation of message containers is not supported, which means one request or response at the "application layer" MUST NOT exceed the maximum size allowed by the message container format.  </p>
<p id="rfc.section.5.1.p.3">The three bit Ver field identifies the protocol version. The current version is 0 i.e. all bits are set to value 0 (zero).  </p>
<p id="rfc.section.5.1.p.4">The Rsrvd field MUST be set to value 0 (zero), </p>
<p id="rfc.section.5.1.p.5">The Identifier field is meant for matching requests and responses. The valid Identifier values are between 1-255. The value 0 MUST NOT be used. The first request for each communication session between the MN and the HAC MUST have the Identifier values set to 1.  </p>
<p id="rfc.section.5.1.p.6">The Length field tells the length of the Content portion of the container (i.e. Reserved octet, Identifier octet and Length field are excluded).  The Content portion length MUST always be at least one octet up to 65535 octets. The value is in network order.  </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Request-response Message Content Encoding</h1>
<p id="rfc.section.5.2.p.1">The encoding of the message content is similar to HTTP header encoding, and complies to the augmented Backus-Naur Form (BNF) defined in Section 2.1 of <a href="#RFC2616">[RFC2616]</a>. All presented hexadecimal numbers are in network byte order. From now on, we use TypeValue header (TV-header) term to refer request-response message content HTTP-like headers.  </p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> Request-Response Message Exchange</h1>
<p id="rfc.section.5.3.p.1">The message exchange between the MN and the HAC is a simple lock-step request-response type as stated in <a href="#record">Section 5.1</a>. A request message includes monotonically increasing Identifier value that is copied to the corresponding response message. Each request MUST have a different Identifier value and due the assumption of a reliable connection oriented transport below the message container framing. The number of request-response message exchanges MUST NOT exceed 255.  </p>
<p id="rfc.section.5.3.p.2">Each new communication session between the MN and the HAC MUST reset the Identifier value to 1. The MN is also the peer that always sends only request messages and the HAC only sends response messages. Once the request-response message exchange completes, the HAC and the MN MUST close the transport connection and the corresponding TLS-tunnel.  </p>
<p id="rfc.section.5.3.p.3">In a case of a HAC side error, the HAC MUST send a response back to a MN with an appropriate status code and then close the transport connection.  </p>
<p id="rfc.section.5.3.p.4">The first request message - MHAuth-Init - (i.e. the Identifier is 1) MUST always contain at least the following parameters: </p>
<p></p>

<ul class="empty">
<li>MN-Identity - See <a href="#mn-id">Section 5.5.1</a>.</li>
<li>Authentication Method - See <a href="#auth-method">Section 5.5.2</a>.</li>
</ul>
<p id="rfc.section.5.3.p.6">The first response message - MHAuth-Init - (i.e. the Identifier is 1) MUST contain at minimum the following parameters: </p>
<p></p>

<ul class="empty"><li>Selected authentication Method - See <a href="#auth-method">Section 5.5.2</a>.</li></ul>
<p id="rfc.section.5.3.p.8">The last request message from the MN side - MHAuth-Done - MUST contain the following parameters: </p>
<p></p>

<ul class="empty">
<li>Security Association Scope - See <a href="#sas">Section 5.6.4</a>.</li>
<li>Proposed ciphersuites - See <a href="#ciphersuite">Section 5.6.5</a>.</li>
<li>Message Authenticator - See <a href="#msg-auth">Section 5.5.5</a>.</li>
</ul>
<p id="rfc.section.5.3.p.10">The last response message  - MHAuth-Done - that ends the request-response message exchange MUST contain the following parameters: </p>
<p></p>

<ul class="empty">
<li>Status Code - See <a href="#status-code">Section 5.5.4</a>.</li>
<li>Message Authenticator - See <a href="#msg-auth">Section 5.5.5</a>.</li>
</ul>
<p id="rfc.section.5.3.p.12">And in a case of successful authentication the following additional parameters: </p>
<p></p>

<ul class="empty">
<li>Selected ciphersuite - See <a href="#ciphersuite">Section 5.6.5</a>.</li>
<li>Security Association Scope - See <a href="#sas">Section 5.6.4</a>.</li>
<li>The rest of the security association data - See <a href="#httpsa">Section 5.6</a>.</li>
</ul>
<h1 id="rfc.section.5.4">
<a href="#rfc.section.5.4">5.4.</a> Home Agent Controller Discovery</h1>
<p id="rfc.section.5.4.p.1">All bootstrapping information, whether for setting up the SA or for bootstrapping Mobile IPv6 specific information, is exchanged between the MN and the HAC using the framing protocol defined in <a href="#record">Section 5.1</a>. The IP address of the HAC MAY be statically configured to the MN or dynamically discovered using for example DNS. In a case of DNS-based HAC discovery, the MN either queries an A/AAAA or a SRV record for the HAC IP address.  The actual domain name used in queries is up to the deployment to decide and out of scope of this specification.  </p>
<h1 id="rfc.section.5.5">
<a href="#rfc.section.5.5">5.5.</a> Generic Request-Response Parameters</h1>
<h1 id="rfc.section.5.5.1">
<a href="#rfc.section.5.5.1">5.5.1.</a> <a href="#mn-id" id="mn-id">Mobile Node Identifier</a>
</h1>
<p id="rfc.section.5.5.1.p.1">An identifier that identifies a MN. The Mobile Node Identifier is in form of a Network Access Identifier (NAI) <a href="#RFC4282">[RFC4282]</a>.  </p>
<p></p>

<ul class="empty"><li>mn-id = "mn-id" ":" nai CRLF <br> nai = username <br>&#160;&#160;&#160; | "@" realm <br>&#160;&#160;&#160; | username "@" realm <br> ...  </li></ul>
<h1 id="rfc.section.5.5.2">
<a href="#rfc.section.5.5.2">5.5.2.</a> <a href="#auth-method" id="auth-method">Authentication Method</a>
</h1>
<p id="rfc.section.5.5.2.p.1">The HAC is the peer that mandates the used authentication method.  The MN sends its proposal to the HAC but eventually the used authentication method returned from the HAC defines the one to be used. The MN MUST propose at least one authentication method and it SHOULD propose more than one. The HAC MUST select exactly one authentication method, or return an error and then close the connection.  </p>
<p></p>

<ul class="empty"><li>auth-method = "auth-method" ":" a-method *("," a-method) CRLF <br> a-method = <br>&#160;&#160;&#160;&#160; "psk" ; Pre-sharer key based authentication <br>&#160;&#160; | "eap" ; EAP-based authentication </li></ul>
<h1 id="rfc.section.5.5.3">
<a href="#rfc.section.5.5.3">5.5.3.</a> <a href="#eap-payload" id="eap-payload">Extensible Authentication Protocol Payload</a>
</h1>
<p id="rfc.section.5.5.3.p.1">Each Extensible Authentication Protocol (EAP) <a href="#RFC3748">[RFC3748]</a> message is encoded string of hexadecimal numbers. The "eap-payload" is completely transparent what EAP-method or EAP message is carried inside it. The "eap-payload" can appear in both request and response messages: </p>
<p></p>

<ul class="empty"><li>eap-payload = "eap-payload" ":" 1*(HEX HEX) CRLF</li></ul>
<h1 id="rfc.section.5.5.4">
<a href="#rfc.section.5.5.4">5.5.4.</a> <a href="#status-code" id="status-code">Status Code</a>
</h1>
<p id="rfc.section.5.5.4.p.1">The "status-code" MUST only be present in the response message that ends the request-response message exchange. The "status-code" follows the principles of HTTP and the definitions found in Section 10 of RFC 2616 also apply for these status codes listed below: </p>
<p></p>

<ul class="empty"><li>status-code = "status-code" ":" status-value CRLF <br> status-value = <br>&#160;&#160;&#160;&#160; "100"  ; Continue <br>&#160;&#160; | "200" ; OK <br>&#160;&#160; | "400"  ; Bad Request <br>&#160;&#160; | "401"  ; Unauthorized <br>&#160;&#160; | "500"  ; Internal Server Error <br>&#160;&#160; | "501"  ; Not Implemented <br>&#160;&#160; | "503"  ; Service Unavailable <br>&#160;&#160; | "504"  ; Gateway Time-out </li></ul>
<h1 id="rfc.section.5.5.5">
<a href="#rfc.section.5.5.5">5.5.5.</a> <a href="#msg-auth" id="msg-auth">Message Authenticator</a>
</h1>
<p id="rfc.section.5.5.5.p.1">The "auth" header contains data used for authentication purposes. It MUST be the last TV-header in the message and calculated over the whole message till the start of the "msg-header": </p>
<p></p>

<ul class="empty"><li>msg-auth = "auth" ":" 1*(HEX HEX) CRLF</li></ul>
<h1 id="rfc.section.5.5.6">
<a href="#rfc.section.5.5.6">5.5.6.</a> <a href="#retry-after" id="retry-after">Retry After</a>
</h1>
<p></p>

<ul class="empty"><li>reply-after = "retry-after" ":" rfc1123-date CRLF</li></ul>
<h1 id="rfc.section.5.5.7">
<a href="#rfc.section.5.5.7">5.5.7.</a> <a href="#eof" id="eof">End of Message Content</a>
</h1>
<p></p>

<ul class="empty"><li>end-of-message = 2CRLF</li></ul>
<h1 id="rfc.section.5.5.8">
<a href="#rfc.section.5.5.8">5.5.8.</a> <a href="#rand" id="rand">Random Values</a>
</h1>
<p id="rfc.section.5.5.8.p.1">Random number generated by the MN or the HAC. The length of the random number MUST be 32 octets (before TV-header encoding): </p>
<p></p>

<ul class="empty">
<li>mn-rand = "mn-rand" ":" 32(HEX HEX) CRLF</li>
<li>hac-rand = "hac-rand" ":" 32(HEX HEX) CRLF</li>
</ul>
<h1 id="rfc.section.5.6">
<a href="#rfc.section.5.6">5.6.</a> <a href="#httpsa" id="httpsa">Security Association Configuration Parameters</a>
</h1>
<p id="rfc.section.5.6.p.1">During the Mobile IPv6 bootstrapping, the MN and the HAC negotiate a single ciphersuite for protecting the traffic between the MN and the HA. The allowed ciphersuites for this specification are a subset of those in TLS v1.2 (see Annex A.5 of <a href="#RFC5246">[RFC5246]</a>) as per <a href="#ciphersuite">Section 5.6.5</a>. This might appear as a constraint as the HA and the HAC may have implemented different ciphersuites. These two nodes are, however, assumed to belong to the same administrative domain. In order to avoid exchanging supported MN-HA ciphersuites in the MN-HAC protocol and to reuse the TLS ciphersuite negotiation procedure we make this simplifying assumption. The selected ciphersuite MUST provide integrity and confidentially protection.  </p>
<p><a href="#ciphersuite">Section 5.6.5</a> provides the mapping from  the TLS ciphersuites to the integrity and encryption algorithms allowed for MN-HA protection. This mapping mainly ignores the authentication algorithm part that is not required within the context of this specification. For example, <a href="#RFC3268">[RFC3268]</a> defines a number of AES based ciphersuites for TLS including 'TLS_RSA_WITH_AES_128_CBC_SHA'. For this specification the relevant part is 'AES_128_CBC_SHA'.  </p>
<p id="rfc.section.5.6.p.3">All the parameters described in the following sections apply only to a request-response protocol response message to the MN. The MN has no way affecting to the provisioning decision of the HAC.  </p>
<h1 id="rfc.section.5.6.1">
<a href="#rfc.section.5.6.1">5.6.1.</a> <a href="#spi" id="spi">Security Parameter Index</a>
</h1>
<p id="rfc.section.5.6.1.p.1">The 28-bit unsigned SPI number identifies the SA used between the MN and the HA. The value 0 (zero) is reserved and MUST NOT be used. Therefore, values ranging from 1 to 268435455 are valid.  </p>
<p id="rfc.section.5.6.1.p.2">The TV-header corresponding to the SPI number is: </p>
<p></p>

<ul class="empty"><li>mip6-spi = "mip6-spi" ":" 1*DIGIT CRLF</li></ul>

<p> </p>
<h1 id="rfc.section.5.6.2">
<a href="#rfc.section.5.6.2">5.6.2.</a> <a href="#mnhakey" id="mnhakey">MN-HA Shared Keys</a>
</h1>
<p id="rfc.section.5.6.2.p.1">The MN-HA shared integrity (ikey) and encryption (ekey) keys are used to protect the traffic between the MN and the HA. The length of these keys depend on the selected ciphersuite.  </p>
<p id="rfc.section.5.6.2.p.2">The TV-headers that carry these two parameters are: </p>
<p></p>

<ul class="empty">
<li>mip6-mn-to-ha-ikey = "mip6-mn-to-ha-ikey" ":" 1*(HEX HEX) CRLF</li>
<li>mip6-ha-to-mn-ikey = "mip6-ha-to-mn-ikey" ":" 1*(HEX HEX) CRLF</li>
<li>mip6-mn-to-ha-ekey = "mip6-mn-to-ha-ekey" ":" 1*(HEX HEX) CRLF</li>
<li>mip6-ha-to-mn-ekey = "mip6-ha-to-mn-ekey" ":" 1*(HEX HEX) CRLF</li>
</ul>

<p> </p>
<h1 id="rfc.section.5.6.3">
<a href="#rfc.section.5.6.3">5.6.3.</a> <a href="#salifetime" id="salifetime">Security Association Validity Time</a>
</h1>
<p id="rfc.section.5.6.3.p.1">The end of the SA validity time is encoded using the "rfc1123-date" format, as defined in Section 3.3.1 of <a href="#RFC2616">[RFC2616]</a>. </p>
<p id="rfc.section.5.6.3.p.2">The TV-header corresponding to the SA validity time value is: </p>
<p></p>

<ul class="empty"><li>mip6-sa-validity-end = "mip6-sa-validity-end" ":" rfc1123-date CRLF</li></ul>

<p> </p>
<h1 id="rfc.section.5.6.4">
<a href="#rfc.section.5.6.4">5.6.4.</a> <a href="#sas" id="sas">Security association scope (SAS)</a>
</h1>
<p id="rfc.section.5.6.4.p.1">The SA is applied either to Mobile IPv6 signaling messages only, or to both Mobile IPv6 signaling messages and data traffic. This parameter MUST be agreed between the MN and HA prior to using the SA. Otherwise the receiving side would not be aware of whether the SA applies to data traffic and could not decide how to act when receiving unprotected packets of PType 1 (see <a href="#dtamsg">Section 6.4</a>).  </p>
<p></p>

<ul class="empty"><li>mip6-sas = "mip6-sas" ":" 1DIGIT CRLF</li></ul>

<p> </p>
<p id="rfc.section.5.6.4.p.3">where a value of &#8220;0&#8221; indicates that the SA does not protect data traffic and a value of &#8220;1&#8221; indicates that all data traffic MUST be protected by the SA. If the mip6-sas value of an SA is set to 1, any packet with PType = 0 MUST be silently discarded when received.  </p>
<p id="rfc.section.5.6.4.p.4">The HAC is the peer that mandates the used security association scope. The MN sends its proposal to the HAC but eventually the security association scope returned from the HAC defines the used scope.  </p>
<h1 id="rfc.section.5.6.5">
<a href="#rfc.section.5.6.5">5.6.5.</a> <a href="#ciphersuite" id="ciphersuite">CipherSuites and Ciphersuite-to-Algorithm Mapping</a>
</h1>
<p id="rfc.section.5.6.5.p.1">The ciphersuite negotiation between HAC and MN uses a subset of the TLS 1.2 ciphersuites and follows  the TLS 1.2 numeric representation defined in Annex A.5 of <a href="#RFC5246">[RFC5246]</a>.  The TV-headers corresponding to the selected ciphersuite and ciphersuite list are: </p>
<p></p>

<ul class="empty">
<li>mip6-ciphersuite = "mip6-ciphersuite" ":" csuite CRLF <br> csuite = "{" suite "}" <br> suite = <br>&#160;&#160;&#160;&#160; "00" "," "02" ; CipherSuite NULL_SHA&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = {0x00,0x02} <br>&#160;&#160; | "00" "," "3B" ; CipherSuite NULL_SHA256&#160;&#160;&#160;&#160;&#160;&#160;&#160; = {0x00,0x3B} <br>&#160;&#160; | "00" "," "0A" ; CipherSuite 3DES_EDE_CBC_SHA&#160;&#160; = {0x00,0x0A}                     <br>&#160;&#160; | "00" "," "2F" ; CipherSuite AES_128_CBC_SHA&#160;&#160;&#160; = {0x00,0x2F}                     <br>&#160;&#160; | "00" "," "3C" ; CipherSuite AES_128_CBC_SHA256 = {0x00,0x3C}                     </li>
<li>mip6-suitelist = "mip6-suitelist" ":" csuite *("," csuite) CRLF </li>
</ul>

<p> </p>
<p id="rfc.section.5.6.5.p.3">All other Ciphersuite values are reserved and subject to future specifications.  </p>
<div id="#rfc.figure.2"></div>
<pre>    HMAC-SHA1-96                    [RFC2404]   AES-XCBC-MAC-96                 [RFC3566]		 </pre>
<p id="rfc.section.5.6.5.p.4">The following integrity algorithms MUST be supported by all implementations: </p>
<p id="rfc.section.5.6.5.p.5">The binding management messages between the MN and HA MUST be integrity protected. Implementations MUST NOT use a NULL integrity algorithm.  </p>
<div id="#rfc.figure.3"></div>
<pre>    NULL                            [RFC2410]   TripleDES-CBC                   [RFC2451]   AES-CBC with 128-bit keys       [RFC3602]		 </pre>
<p id="rfc.section.5.6.5.p.6">The following encryption algorithms MUST be supported: </p>
<p id="rfc.section.5.6.5.p.7">Traffic between MN and HA MAY be encrypted. Any integrity-only CipherSuite makes use of the NULL encryption algorithm.  </p>
<div id="#rfc.figure.4"></div>
<pre> 
+-------------------+-----------------+--------------------------+|Ciphersuite        |Integ. Algorithm |Encr. Algorithm           |
+-------------------+-----------------+--------------------------+|NULL_SHA           |HMAC-SHA1-96     |NULL                      ||NULL_SHA256        |AES-XCBC-MAC-96  |NULL                      ||3DES_EDE_CBC_SHA   |HMAC-SHA1-96     |TripleDES-CBC             ||AES_128_CBC_SHA    |HMAC-SHA1-96     |AES-CBC with 128-bit keys ||AES_128_CBC_SHA256 |AES-XCBC-MAC-96  |AES-CBC with 128-bit keys |
+-------------------+----------------+---------------------------+		 </pre>
<p id="rfc.section.5.6.5.p.8">Note: In the present version, this document does not consider combined algorithms. The following table provides the mapping of each ciphersuite to a combination of integrity and encryption algorithms that are part of the negotiated SA between MN and HA.  </p>
<h1 id="rfc.section.5.7">
<a href="#rfc.section.5.7">5.7.</a> <a href="#httpmip" id="httpmip">Mobile IPv6 Bootstrapping Parameters</a>
</h1>
<p id="rfc.section.5.7.p.1">In parallel with the SA bootstrapping, the HAC SHOULD provision the MN with relevant Mobile IPv6 related bootstrapping information.  </p>
<div id="#rfc.figure.5"></div>
<pre> 
   ip6-addr   = 7( word ":" ) word CRLF
   word       = 1*4HEX
   ip6-prefix = ip6-addr "/" 1*2DIGIT
   ip4-addr   = 1*3DIGIT "." 1*3DIGIT "." 1*3DIGIT "." 1*3DIGIT
		 </pre>
<p id="rfc.section.5.7.p.2">The following generic BNFs are used to form IP addresses and prefixes. They are used in subsequent sections.  </p>
<h1 id="rfc.section.5.7.1">
<a href="#rfc.section.5.7.1">5.7.1.</a> Home Agent Address</h1>
<p id="rfc.section.5.7.1.p.1">The HAC MAY provision the MN with an IPv4 or an IPv6 address of a HA, or both. </p>
<p></p>

<ul class="empty">
<li>mip6-haa-ip6 = "mip6-haa-ip6" ":" ip6-addr CRLF</li>
<li>mip6-haa-ip4 = "mip6-haa-ip4" ":" ip4-addr CRLF</li>
</ul>

<p> </p>
<h1 id="rfc.section.5.7.2">
<a href="#rfc.section.5.7.2">5.7.2.</a> Home Addresses and Home Network Prefix</h1>
<p id="rfc.section.5.7.2.p.1">The HAC MAY provision the MN with an IPv4 or an IPv6 home address, or both. The HAC MAY also provision the MN with its home network prefix.  </p>
<p></p>

<ul class="empty">
<li>mip6-ip6-hoa = "mip6-ip6-hoa" ":" ip6-addr CRLF</li>
<li>mip6-ip4-hoa = "mip6-ip4-hoa" ":" ip4-addr CRLF</li>
<li>mip6-hnp-ip6 = "mip6-ip6-hnp" ":" ip6-prefix CRLF</li>
</ul>

<p> </p>
<h1 id="rfc.section.5.8">
<a href="#rfc.section.5.8">5.8.</a> Authentication of the Mobile Node</h1>
<p id="rfc.section.5.8.p.1">This section describes the basic operation required for the MN-HAC            mutual authentication and the channel binding.  The authentication            protocol described as part of this section is a simple exchange that            follows the GPSK exchange used by EAP-GPSK <a href="#RFC5433">[RFC5433]</a>.  It is secured by the TLS tunnel and is cryptographically bound to the TLS tunnel through channel binding based on <a href="#RFC5056">[RFC5056]</a> and on the channel binding type 'tls-server-endpoint' described in <a href="#I-D.altman-tls-channel-bindings">[I-D.altman-tls-channel-bindings]</a>. As a result of the channel binding type, this method can only be used with TLS ciphersuites that use server certificates and the Certificate handshake message. For example, TLS ciphersuites based on PSK or anonymous authentication cannot be used.  </p>
<p id="rfc.section.5.8.p.2">The authentication exchange MUST be performed through the encrypted TLS tunnel. It performs mutual authentication between the MN and the HAC based on a pre-shared key (PSK) or based on an EAP-method (see <a href="#eap-method">Section 5.9</a>).  The PSK protocol is described in this section. It consists of the message exchanges (MHAuth-Init, MHAuth-Mid, MHAuth-Done) in which both sides exchange nonces and their identities, and compute and exchange a message authenticator 'auth' over the previously exchanged values, keyed with the pre-shared key.  The MHAuth-Done messages are used to deal with error situations. Key binding with the TLS tunnel is ensured by channel binding of the type "tls-server-endpoint" as described by <a href="#I-D.altman-tls-channel-bindings">[I-D.altman-tls-channel-bindings]</a> where the hash of the TLS server certificate serves as input to the 'auth' calculation of the MHAuth messages.  </p>
<p id="rfc.section.5.8.p.3">Note: The authentication exchange is based on the GPSK exchange used by EAP-GPSK. In comparison to GPSK, it does not support exchanging an encrypted container (it always runs through an already protected TLS tunnel). Furthermore, the initial request of the authentication exchange (MHAuth-Init) is sent by the MN (client side) and is comparable to EAP-Response/Identity, which reverses the roles of request and response messages compared to EAP-GPSK. <a href="#psk">Figure 6</a> shows a successful protocol exchange.  </p>
<div id="#rfc.figure.6"></div>
<div id="#psk"></div>
<pre>
MN                                                      HAC
 |                                                       |
 | Request/MHAuth-Init (...)                             |
 |------------------------------------------------------&gt;|
 |                                                       |
 |                            Response/MHAuth-Init (...) |
 |&lt;------------------------------------------------------|
 |                                                       |
 | Request/MHAuth-Done (...)                             |
 |------------------------------------------------------&gt;|
 |                                                       |
 |                            Response/MHAuth-Done (...) |
 |&lt;------------------------------------------------------|
 |                                                       |
</pre>
<p></p>
<p></p>

<dl>
<dt>1 )</dt>
<dd>Request/MHAuth-Init: (MN -&gt; HAC) <ul class="empty"><li>mn-id, mn-rand, auth-method=psk</li></ul>
<p> </p>
<br><br> </dd>
<dt>2 )</dt>
<dd>Response/MHAuth-Init: (MN &lt;- HAC) <ul class="empty"><li>[mn-rand, hac-rand, auth-method=psk, [status],] auth</li></ul>
<p> </p>
<br><br> </dd>
<dt>3 )</dt>
<dd>Request/MHAuth-Done: (MN -&gt; HAC) <ul class="empty"><li>mn-rand, hac-rand, sa-scope, ciphersuite-list, auth</li></ul>
<p> </p>
<br><br> </dd>
<dt>4 )</dt>
<dd>Response/MHAuth-Done: (MN &lt;- HAC) <ul class="empty"><li>[sa-scope, sa-data, ciphersuite, bootstrapping-data,] mn-rand, hac-rand, status, auth</li></ul>
<p> </p>
</dd>
</dl>

<p> </p>
<p id="rfc.section.5.8.p.6">Where:</p>
<p></p>

<ul class="empty"><li>auth = HMAC-SHA256(PSK, msg-octets | CB-octets)</li></ul>

<p> </p>
<p id="rfc.section.5.8.p.8">The length "mn-rand", "hac-rand" is 32 octets. Note that "|" indicates concatenation and optional parameters are shown in square brackets [..]. The square brackets can be nested.  </p>
<p id="rfc.section.5.8.p.9">The shared secret PSK can be variable length. 'msg-octets' includes all payload parameters of the respective message to be signed except the 'auth' payload. CB-octets is the channel binding input to the auth calculation that is the "TLS-server-endpoint" channel binding type. The content and algorithm (only required for the "TLS-server-endpoint" type) are the same as described in <a href="#I-D.altman-tls-channel-bindings">[I-D.altman-tls-channel-bindings]</a>.  </p>
<p id="rfc.section.5.8.p.10">The MN starts by selecting a random number 'mn-rand' and choosing a list of supported authentication methods coded in 'auth-method'.  The MN sends its identity 'mn-id', 'mn-rand' and 'auth-method' to the HAC in MHAuth-Init. The decision of which authentication method to offer and  which to pick is policy- and implementation-dependent and, therefore, outside the scope of this document.  </p>
<p id="rfc.section.5.8.p.11">In MHAuth-Done, the HAC sends a random number 'hac-rand' and the selected ciphersuite. The selection MUST be one of the MN-supported ciphersuites as received in 'ciphersuite-list'. Furthermore, it repeats the received parameters of the MHAuth-Init message 'mn-rand'. It computes a message authenticator 'auth' over all the transmitted parameters except 'auth' itself. The HAC calculates 'auth' over all parameters and appends it to the message.  </p>
<p id="rfc.section.5.8.p.12">The MN verifies the received MAC and the consistency of the identities, nonces, and ciphersuite parameters transmitted in MHAuth-Auth. In case of successful verification, the MN computes a MAC over the session parameter and returns it to the HAC in MHAuth-Done. The HAC verifies the received MAC and the consistency of the identities, nonces, and ciphersuite parameters transmitted in MHAuth-Init.  If the verification is successful, MHAuth-Done is prepared and sent by the HAC to confirm successful completion of the exchange.  </p>
<h1 id="rfc.section.5.9">
<a href="#rfc.section.5.9">5.9.</a> <a href="#eap-method" id="eap-method">Extensible Authentication Protocol Methods</a>
</h1>
<p id="rfc.section.5.9.p.1">Basic operation required for the MN-HAC mutual authentication using EAP-based methods.  </p>
<div id="#rfc.figure.7"></div>
<div id="#eap"></div>
<pre>
MN                                                      HAC
 |                                                       |
 | Request/MHAuth-Init (...)                             |
 |------------------------------------------------------&gt;|
 |                                                       |
 |                            Response/MHAuth-Init (..., |
 |                     eap-payload=EAP-Request/Identity) |
 |&lt;------------------------------------------------------|
 |                                                       |
 | Request/MHAuth-Mid (eap-payload=                      | 
 |              EAP-Response/Identity)                   |
 |------------------------------------------------------&gt;|
 |                                                       |
 |     Response/MHAuth-Mid (eap-payload=EAP-Request/...) |
 |&lt;------------------------------------------------------|
 |                                                       |
 :                                                       :
 :        ..EAP-method specific exchanges..              :
 :                                                       :
 |                                                       |
 | Request/MHAuth-Done (eap-payload=EAP-Response/...,    |
 |                      ..., auth)                       |
 |------------------------------------------------------&gt;|
 |                                                       |
 |        Response/MHAuth-Done (eap-payload=EAP-Success, |
 |                              ..., auth)               |
 |&lt;------------------------------------------------------|
 |                                                       |
</pre>
<p></p>

<dl>
<dt>1 )</dt>
<dd>Request/MHAuth-Init: (MN -&gt; HAC) <ul class="empty"><li>mn-id, mn-rand, auth-method=eap</li></ul>
<p> </p>
<br><br> </dd>
<dt>2 )</dt>
<dd>Response/MHAuth-Init: (MN &lt;- HAC) <ul class="empty"><li>[auth-method=eap, eap, [status,]] auth</li></ul>
<p> </p>
<br><br> </dd>
<dt>3 )</dt>
<dd>Request/MHAuth-Mid: (MN &#8211;&gt; HAC) <ul class="empty"><li>eap, auth</li></ul>
<p> </p>
<br><br> </dd>
<dt>4 )</dt>
<dd>Response/MHAuth-Mid: (MN &lt;- HAC) <ul class="empty"><li>eap, auth</li></ul>
<p> </p>
<br><br> MHAuth-Mid exchange is repeated as many times as needed by the used EAP-method.  <br><br> </dd>
<dt>5 )</dt>
<dd>Request/MHAuth-Done: (MN -&gt; HAC) <ul class="empty"><li>sa-scope, ciphersuite-list, eap, auth</li></ul>
<p> </p>
<br><br> </dd>
<dt>6 )</dt>
<dd>Response/MHAuth-Done: (MN &lt;- HAC) <ul class="empty"><li>[sa-scope, sa-data, ciphersuite, bootstrapping-data,] eap, status, auth</li></ul>
<p> </p>
</dd>
</dl>

<p> </p>
<p id="rfc.section.5.9.p.3">Where:</p>
<p></p>

<ul class="empty"><li>auth = HMAC-SHA256(shared-key, msg-octets | CB-octets)</li></ul>

<p> </p>
<p id="rfc.section.5.9.p.5">In MHAuth-Init and MHAuth-Mid messages, shared-key is set to "1".  If the EAP-method is key-deriving and creates a shared MSK key as a side effect of Authentication shared-key MUST be the MSK in all MHAuth-Done messages.  This MSK MUST NOT be used for any other purpose. In case the EAP method does not generate an MSK key, shared-key is set to "1".  </p>
<p id="rfc.section.5.9.p.6">'msg-octets' includes all payload parameters of the respective message to be signed except the 'auth' payload. CB-octets is the channel binding input to the AUTH calculation that is the "TLS-server-endpoint" channel binding type. The content and algorithm (only required for the "TLS-server-endpoint" type) are the same as described in <a href="#I-D.altman-tls-channel-bindings">[I-D.altman-tls-channel-bindings]</a>.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Mobile Node to Home Agent communication</h1>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#packets" id="packets">General</a>
</h1>
<p id="rfc.section.6.1.p.1">The following sections describe the packet formats used for the traffic between the MN and the HA. This traffic includes binding management messages (for example, BU and BA messages), reverse tunneled and encrypted user data, and reverse tunneled plain text user data. This specification defines a generic packet format, where everything is encapsulated inside UDP. See <a href="#bmmmsg">Section 6.3</a> and <a href="#dtamsg">Section 6.4</a> for detailed illustrations of the corresponding packet formats.  </p>
<p id="rfc.section.6.1.p.2">The Mobile IPv6 service port number (HALTSEC), where the HA expects to receive UDP packets, is reserved by IANA. The same port number is used for both binding management messages and user data packets. The reason for multiplexing data and control messages over the same port number is due to the possibility of Network Address and Port Translators located along the path between the MN and the HA. The Mobile IPv6 service MAY use any ephemeral port number as the UDP source port, and MUST use the Mobile IPv6 service port number (HALTSEC) as the UDP destination port.  </p>
<p id="rfc.section.6.1.p.3">The encapsulating UDP header is immediately followed by a 4-bit Packet Type (PType) field that defines whether the packet contains an encrypted mobility management message or a, an encrypted user data packet, or a plain text user data packet.  </p>
<p id="rfc.section.6.1.p.4">The Packet Type field is followed by a 28-bit SPI value, which identifies the correct SA concerning the encrypted packet. For any packet that is neither integrity protected nor encrypted (i.e.  no SA is applied by the originator) the SPI MUST be set to 0 (zero). ). Mobility management messages MUST always be at least integrity protected. Hence, mobility management messages MUST NOT be sent with a SPI value of 0 (zero).  </p>
<p id="rfc.section.6.1.p.5">There is always only one SPI per MN-HA mobility session and the same SPI is used for all types of protected packets independent of the direction.  </p>
<p id="rfc.section.6.1.p.6">The SPI value is followed by a 32-bit Sequence Number value that is used to identify retransmissions of encrypted messages. Each endpoint in the security association maintains two "current" Sequence Numbers: the next one to be used for a packet it initiates and the next one it expects to see in a packet from the other end. If the MN and the HA ends initiate very different numbers of messages, the Sequence Numbers in the two directions can be very different. In a case encryption is not used, the Sequence Number MUST be set to 0 (zero). Note that the HA SHOULD initiate a re-establishement of the SA before any of the Sequence Number cycle.  </p>
<p id="rfc.section.6.1.p.7">Finally, the Sequence Number field is followed by the data portion, whose content is identified by the Packet Type. The data portion may be protected.  </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Security Parameter Index</h1>
<div id="#rfc.figure.8"></div>
<div id="#spifig"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| PType |                        SPI                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.2.p.1">The SPI is a 32-bit field, where the first 4 bits indicate the Packet Type (PType) of the UDP encapsulated packet. The SPI value itself consists of the remaining 28-bit of the SPI field. The SPI field is treated as one 32-bit field during the integrity protection calculation.  </p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> <a href="#bmmmsg" id="bmmmsg">Binding Management Message Formats</a>
</h1>
<p id="rfc.section.6.3.p.1">The binding management messages that are only meant to be exchanged between the MN and the HA MUST be integrity protected and MAY be encrypted. They MUST use the packet format shown in <a href="#ptype8">Figure 9</a>. All packets that are specific to the Mobile IPv6 protocol and contain a Mobility Header (as defined in Section 6.1.1. of RFC 3775) SHOULD use the packet format shown in <a href="#ptype8">Figure 9</a>.  (This means that some Mobile IPv6 mobility management messages, such as the HoTI message, as treated as data packets and using encapsulation described in <a href="#dtamsg">Section 6.4</a>).  </p>
<div id="#rfc.figure.9"></div>
<div id="#ptype8"></div>
<pre>
 0                   1                   2                   3 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+|                                                               |:         IPv4 or IPv6 header (src-addr=Xa, dst-addr=Ya)        :|                                                               |+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+|                                                               |:            UDP header (src-port=Xp,dst-port=Yp)               :|                                                               |+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------|PType=8|                    SPI                                | ^Int.+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |Cov-|                      Sequence Number                          | |ered+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | ----|                    Payload Data* (variable)                   | |   ^:                                                               : |   ||                                                               | |Conf.+               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |Cov-|               |     Padding (0-255 bytes)                     | |ered*+-+-+-+-+-+-+-+-+               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |   ||                               |  Pad Length   | Next Header   | v   v+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------|         Integrity Check Value-ICV   (variable)                |:                                                               :|                                                               |+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
<p></p>
<p id="rfc.section.6.3.p.3">The PType value 8 (eight) identifies that the UDP encapsulated packet contains a RFC 3775 defined Mobility Header and other relevant IPv6 extension headers. Note, there is no additional IP header inside the encapsulated part. The Next Header field MUST be set to value of the first encapsulated header. The encapsulated headers follow the natural IPv6 and Mobile IPv6 extension header alignment and formatting rules.  </p>
<p id="rfc.section.6.3.p.4">The Padding, Pad Length, Next Header and ICV fields follow the rules of Section 2.4 to 2.8 of <a href="#RFC4303">[RFC4303]</a> unless otherwise stated in this document. For a SPI value of 0 (zero) that indicates an unprotected packet, the Padding, Pad Length, Next Header and ICV fields MUST NOT be present.  </p>
<p id="rfc.section.6.3.p.5">The source and destination IP addresses of the outer IP header (i.e. the src-addr and the dst-addr in <a href="#ptype8">Figure 9</a>) use the current care-of address of the MN and the HA address.  </p>
<h1 id="rfc.section.6.4">
<a href="#rfc.section.6.4">6.4.</a> <a href="#dtamsg" id="dtamsg">Reverse Tunneled User Data Packet Formats</a>
</h1>
<div id="#rfc.figure.10"></div>
<div id="#ptype1"></div>
<pre>
 0                   1                   2                   3 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+|                                                               |:         IPv4 or IPv6 header (src-addr=Xa, dst-addr=Ya)        :|                                                               |+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+|                                                               |:            UDP header (src-port=Xp,dst-port=Yp)               :|                                                               |+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+|PType=1|                    SPI                                | ^Int.+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |Cov-|                      Sequence Number                          | |ered+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | ----|                    Payload Data* (variable)                   | |   ^:                                                               : |   ||                                                               | |Conf.+               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |Cov-|               |     Padding (0-255 bytes)                     | |ered*+-+-+-+-+-+-+-+-+               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |   ||                               |  Pad Length   | Next Header   | v   v+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ------|         Integrity Check Value-ICV   (variable)                |:                                                               :|                                                               |+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p id="rfc.section.6.4.p.1">There are two types of reverse tunneled user data packets between the MN and the HA. Those that are integrity protected and encrypted and those that are plaintext. The MN or the HA decide whether to apply integrity protection and encryption to a packet or to send it in plaintext based on the mip6-sas value in the SA. If the mip6-sas is set to 1 the originator MUST NOT send any plaintext packet, and the receiver MUST silently discard any packet with the PType set to 0 (unprotected). It is RECOMMENDED to apply confidentiality and integrity protection of user data traffic. The reverse tunneled IPv4 or IPv6 user data packets are encapsulated as-is inside the 'Payload Data' shown in <a href="#ptype1">Figure 10</a>.  and <a href="#ptype0">Figure 11</a>.  </p>
<p id="rfc.section.6.4.p.2">The PType value 1 (one) identifies that the UDP encapsulated packet contains an encrypted tunneled IPv4/IPv6 user data packet. The Next Header field header MUST be set to value corresponding the tunneled IP packet (e.g., 41 for IPv6).  </p>
<p id="rfc.section.6.4.p.3">The Padding, Pad Length, Next Header and ICV fields follow the rules of Section 2.4 to 2.8 of <a href="#RFC4303">[RFC4303]</a> unless otherwise stated in this document. For a SPI value of 0 (zero) that indicates an unprotected packet, the Padding, Pad Length, Next Header and ICV fields MUST NOT be present.  </p>
<p id="rfc.section.6.4.p.4">The source and destination IP addresses of the outer IP header (i.e., the src-addr and the dst-addr in <a href="#ptype1">Figure 10</a>) use the current care-of address of the MN and the HA address. The ESP protected inner IP header, which is not shown in <a href="#ptype1">Figure 10</a>, uses the home address of the MN and the correspondent node (CN) address.  </p>
<div id="#rfc.figure.11"></div>
<div id="#ptype0"></div>
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
:         IPv4 or IPv6 header (src-addr=Xa, dst-addr=Ya)        :
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
:            UDP header (src-port=Xp,dst-port=Yp)               :
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|PType=0|                        0                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                0                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
:           Payload Data (plain IPv4 or IPv6 Packet)            :
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
<p></p>
<p id="rfc.section.6.4.p.6">The PType value 0 (zero) identifies that the UDP encapsulated packet contains a plaintext tunneled IPv4/IPv6 user data packet. Also the SPI and the Sequence Number fields MUST be set to 0 (zero).  </p>
<p id="rfc.section.6.4.p.7">The source and destination IP addresses of the outer IP header (i.e., the src-addr and the dst-addr in <a href="#ptype0">Figure 11</a>) use the current care-of address of the MN and the HA address. The plain text inner IP header uses the home address of the MN and the CN address.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#ro" id="ro">Route Optimization</a>
</h1>
<p id="rfc.section.7.p.1">The treatment of MN-CN route optimization is outside the scope of this document.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> IANA Considerations</h1>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> New Registry: Packet Type</h1>
<div id="#rfc.figure.12"></div>
<pre>
Packet Type                       | Value
----------------------------------+----------------------------------
non-encrypted IP packet           | 0
encrypted IP packet               | 1
mobility header                   | 8
           </pre>
<p id="rfc.section.8.1.p.1">IANA is requested to create a new registry for the Packet Type as described in <a href="#packets">Section 6.1</a>. </p>
<p id="rfc.section.8.1.p.2">Following the allocation policies from <a href="#RFC5226">[RFC5226]</a> new values for the Packet Type AVP MUST be assigned based on the "RFC Required" policy. </p>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> HTTP Headers</h1>
<p id="rfc.section.8.2.p.1">A number of HTTP headers with their respective parameters are reserved. See <a href="#httpsa">Section 5.6</a> and <a href="#httpmip">Section 5.7</a> for a list of header names and their parameters. </p>
<h1 id="rfc.section.8.3">
<a href="#rfc.section.8.3">8.3.</a> Status Codes</h1>
<div id="#rfc.figure.13"></div>
<pre>
    REINIT_SA_WITH_HAC       TBD1
           </pre>
<p id="rfc.section.8.3.p.1">A new Status Code (to be used in BA messages) is reserved for the cases where the HA wants to indicate to the MN that it needs to re-establish the SA information with the HAC. The Result Code is reserved from the 0-127 code space: </p>
<h1 id="rfc.section.8.4">
<a href="#rfc.section.8.4">8.4.</a> Port Numbers</h1>
<div id="#rfc.figure.14"></div>
<pre>
    HALTSEC                  TBD2
           </pre>
<p id="rfc.section.8.4.p.1">A new port number (HALTSEC) for UDP packets is reserved from the PORT NUMBERS registry.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Security Considerations</h1>
<p id="rfc.section.9.p.1">This document describes and uses a number of building blocks that introduce security mechanisms and need to interwork in a secure manner.  </p>
<p id="rfc.section.9.p.2">The following building blocks are considered from a security point of view: </p>
<p></p>

<ol>
<li>Discovery of the HAC </li>
<li>Authentication and MN-HA SA establishment executed between the MN and the HAC (PSK or EAP-based) through a TLS tunnel</li>
<li>Protection of MN-HA communication </li>
<li>AAA Interworking </li>
</ol>

<p> </p>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> Discovery of the HAC</h1>
<p id="rfc.section.9.1.p.1">No dynamic procedure for discovering the HAC by the MN is described in this document.  As such, no specific security considerations apply to the scope of this document.  </p>
<h1 id="rfc.section.9.2">
<a href="#rfc.section.9.2">9.2.</a> Authentication and Key Exchange executed between the MN             and the HAC</h1>
<p id="rfc.section.9.2.p.1">This document describes a simple authentication and MN-HA SA negotiation exchange over TLS. The TLS procedures remain unchanged; however, channel binding is provided.  </p>
<p></p>

<dl>
<dt>Authentication:</dt>
<dd style="margin-left: 8">Server-side certificate based authentication MUST be performed  using TLS 1.2 <a href="#RFC5246">[RFC5246]</a>.  <br><br> The client-side authentication may depend on the specific deployment and is therefore not mandated. Note that TLS-PSK <a href="#RFC4279">[RFC4279]</a> cannot be used in conjunction with the methods described in section 5.8 and 5.9 of this document due to the limitations of the channel binding type used.  <br><br> Through the protected TLS tunnel, an additional authentication exchange is performed that provides client-side or mutual authentication and exchanges SA parameters and optional configuration data to be used in the subsequent protection of MN-HA communication. The additional authentication exchange can either be PSK-based (section 5.8) or EAP-based (section 5.9). Both exchanges are always performed within the protected TLS tunnel and MUST NOT be used as standalone protocols.                     <br><br> The simple PSK-based authentication exchange provides mutual authentication and follows the GPSK exchange used by EAP-GPSK <a href="#RFC5433">[RFC5433]</a> and has similar properties, although some features of GPSK like the exchange of a protected container are not supported.                     <br><br> The EAP-based authentication exchange simply defines message containers to allow carrying the EAP packets between the MN and the HAC. In principle, any EAP method can be used. However, it is strongly recommended to use only EAP methods that provide mutual authentication and that derive keys including an MSK key in compliance with <a href="#RFC3748">[RFC3748]</a>.                     <br><br> Both exchanges use channel binding with the TLS tunnel.  The channel binding type &#8216;TLS-server-endpoint&#8217; as per <a href="#I-D.altman-tls-channel-bindings">[I-D.altman-tls-channel-bindings]</a> MUST be used.  <br><br> </dd>
<dt>Dictionary Attacks:</dt>
<dd style="margin-left: 8">All messages of the authentication exchanges specified in this document are protected by TLS. However, any implementation SHOULD assume that the properties of the authentication exchange are the same as for GPSK <a href="#RFC5433">[RFC5433]</a> in case the PSK-based method as per section 5.8. is used, and are the same as those of the underlying EAP method in case the EAP-based exchange as per section 5.9 is used.  <br><br> </dd>
<dt>Replay Protection:</dt>
<dd style="margin-left: 8">The underlying TLS protection provides protection against replays.  <br><br> </dd>
<dt>Key Derivation and Key Strength:</dt>
<dd style="margin-left: 8">For TLS, the TLS specific considerations apply unchanged. For the authentication exchanges defined in this document, no key derivation step is performed as the MN-HA keys are generated by the HAC and are distributed to the MN through the secure TLS connection.  <br><br> </dd>
<dt>Key Control:</dt>
<dd style="margin-left: 8">No joint key control for MN-HA keys is provided by this version of the specification.  <br><br> </dd>
<dt>Lifetime:</dt>
<dd style="margin-left: 8">The TLS-protected authentication exchange between the MN and the HAC is only to bootstrap keys and other parameters for usage with MN-HA security. The SAs that contain the keys have an associated lifetime. The usage of Transport Layer Security (TLS) Session Resumption without Server-Side State, described in <a href="#RFC5077">[RFC5077]</a>, provides the ability for the MN to minimize the latency of future exchanges towards the HA without having to keep state at the HA itself.  <br><br> </dd>
<dt>Denial of Service Resistance:</dt>
<dd style="margin-left: 8">The level of resistance against denial of service attacks SHOULD be considered the same as for common TLS operation, as TLS is used unchanged. For the PSK-based authentication exchange, no additional factors are known. For the EAP-based authentication exchange, any considerations regarding denial-of-service resistance specific to the chosen EAP method are expected to be applicable and need to be be taken into account.  <br><br> </dd>
<dt>Session Independence:</dt>
<dd style="margin-left: 8">Each individual TLS protocol run is independent from any previous exchange based on the security properties of the TLS handshake protocol. However, several PSK or EAP-based authentication exchanges can be performed across the same TLS connection.  <br><br> </dd>
<dt>Fragmentation:</dt>
<dd style="margin-left: 8">TLS runs on top of TCP and no fragmentation specific considerations apply to the MN-HAC authentication exchanges.  <br><br> </dd>
<dt>Channel Binding:</dt>
<dd style="margin-left: 8">Both the PSK and the EAP-based exchanges use channel binding with the TLS tunnel. The channel binding type &#8216;TLS-server-endpoint&#8217; as per <a href="#I-D.altman-tls-channel-bindings">[I-D.altman-tls-channel-bindings]</a> MUST be used.  <br><br> </dd>
<dt>Fast Reconnect:</dt>
<dd style="margin-left: 8">This protocol provides session resumption as part of TLS and optionally the support for <a href="#RFC5077">[RFC5077]</a>. No fast reconnect is supported for the PSK-based authentication exchange. For the EAP-based authentication exchange, availability of fast reconnect depends on the EAP method used.  <br><br> </dd>
<dt>Identity Protection:</dt>
<dd style="margin-left: 8">Based on the security properties of the TLS tunnel, passive user identity protection is provided. An attacker acting as man-in-the-middle in the TLS connection would be able to observe the MN identity value sent in MHAuth-Init messages.  <br><br> </dd>
<dt>Protected Ciphersuite Negotiation:</dt>
<dd style="margin-left: 8">This protocol provides ciphersuite negotiation based on TLS.  <br><br> </dd>
<dt>Confidentiality:</dt>
<dd style="margin-left: 8">Confidentiality protection of payloads exchanged between the MN and the HAC are protected with the TLS Record Layer. TLS ciphersuites with confidentiality and integrity protection MUST be negotiated and used in order to exchange security sensitive material inside the TLS connection.  <br><br> </dd>
<dt>Cryptographic Binding:</dt>
<dd style="margin-left: 8">No cryptographic bindings are provided by this protocol specified in this document.  <br><br> </dd>
<dt>Perfect Forward Secrecy:</dt>
<dd style="margin-left: 8">Perfect forward secrecy is provided with appropriate TLS ciphersuites.  <br><br> </dd>
<dt>Key confirmation:</dt>
<dd style="margin-left: 8">Key confirmation of the keys established with TLS is provided by the TLS Record Layer when the keys are used to protect the subsequent TLS exchange.  <br><br> </dd>
</dl>

<p> </p>
<h1 id="rfc.section.9.3">
<a href="#rfc.section.9.3">9.3.</a> Protection of MN and HA Communication</h1>
<p></p>

<dl>
<dt>Authentication:</dt>
<dd style="margin-left: 8">Data origin authentication is provided for the communication between the MN and the HA. The chosen level of security of this authentication depends on the selected ciphersuite. Entity authentication is offered by the MN to HAC protocol exchange.  <br><br> </dd>
<dt>Dictionary Attacks:</dt>
<dd style="margin-left: 8">The concept of dictionary attacks is not applicable to the MN-HA communication as the keying material used for this communication is randomly created by the HAC and its length depends on the chosen cryptographic algorithms.  <br><br> </dd>
<dt>Replay Protection:</dt>
<dd style="margin-left: 8">Replay protection for the communication between the MN and the HA is provided based on sequence numbers and follows the design of IPsec ESP.  <br><br> </dd>
<dt>Key Derivation and Key Strength:</dt>
<dd style="margin-left: 8">The strength of the keying material established for the communication between the MN and the HA is selected based on the negotiated ciphersuite (based on the MN-HAC exchange) and the key created by the HAC. The randomness requirements for security described in RFC 4086 <a href="#RFC4086">[RFC4086]</a> are applicable to the key generation by the HAC.  <br><br> </dd>
<dt>Key Control:</dt>
<dd style="margin-left: 8">The keying material established during the MN-HAC protocol exchange for subsequent protection of the MN-HA communication is created by the HA and therefore no joint key control is provided for it.  <br><br> </dd>
<dt>Key Naming:</dt>
<dd style="margin-left: 8">For the MN-HA communication the security associations are indexed with the help of the SPI and additionally based on the direction (in-bound communication or out-bound communication).  <br><br> </dd>
<dt>Lifetime:</dt>
<dd style="margin-left: 8">The lifetime of the MN-HA security associations is based on the value in the mip6-sa-validity-end HTTP header field exchanged during the MN-HAC exchange. The HAC controls the SA lifetime.  <br><br> </dd>
<dt>Denial of Service Resistance:</dt>
<dd style="margin-left: 8">For the communication between the MN and the HA there are no heavy cryptographic operations (such as public key computations). As such, there are no DoS concerns.  <br><br> </dd>
<dt>Session Independence:</dt>
<dd style="margin-left: 8">Sessions are independent from each other when new keys are created by via the MN-HAC protocol. A new MN-HAC protocol run produces fresh and unique keying material for protection of the MN-HA communication.  <br><br> </dd>
<dt>Fragmentation:</dt>
<dd style="margin-left: 8">There is no additional fragmentation support provided beyond what is offered by the network layer.  <br><br> </dd>
<dt>Channel Binding:</dt>
<dd style="margin-left: 8">Channel binding is not applicable to the MN-HA communication.  <br><br> </dd>
<dt>Fast Reconnect:</dt>
<dd style="margin-left: 8">The concept of fast reconnect is not applicable to the MN-HA communication.  <br><br> </dd>
<dt>Identity Protection:</dt>
<dd style="margin-left: 8">User identities SHOULD NOT be exchanged between the MN and the HA. In a case binding management messages contain the user identity, the messages SHOULD be confidentity protected.  <br><br> </dd>
<dt>Protected Ciphersuite Negotiation:</dt>
<dd style="margin-left: 8">The MN-HAC protocol provides protected ciphersuite negotiation through a secure TLS connection.  <br><br> </dd>
<dt>Confidentiality:</dt>
<dd style="margin-left: 8">Confidentiality protection of payloads exchanged between the MN and the HAC (for Mobile IPv6 signaling and optionally for the data traffic) is provided utilizing algorithms negotiated during the MN-HAC exchange.  <br><br> </dd>
<dt>Cryptographic Binding:</dt>
<dd style="margin-left: 8">No cryptographic bindings are provided by this protocol specified in this document.  <br><br> </dd>
<dt>Perfect Forward Secrecy:</dt>
<dd style="margin-left: 8">Perfect forward secrecy is provided when the MN bootstraps new keying material with the help of the MN-HAC protocol (assuming that a proper TLS ciphersuite is used).  <br><br> </dd>
<dt>Key confirmation:</dt>
<dd style="margin-left: 8">Key confirmation of the MN-HA keying material conveyed from the HAC to the MN is provided when the first packets are exchanged between the MN and the HA (in both directions as two different keys are used).  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.9.4">
<a href="#rfc.section.9.4">9.4.</a> AAA Interworking</h1>
<p id="rfc.section.9.4.p.1">The AAA backend infrastructure interworking is not defined in this document and therefore out-of-scope. </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Acknowledgements</h1>
<p id="rfc.section.10.p.1">The authors would like to thank Pasi Eronen, Domagoj Premec, and Christian Bauer for their comments.</p>
<h1 id="rfc.references">
<a href="#rfc.references">11.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">11.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3775">[RFC3775]</b></td>
<td class="top">
<a>Johnson, D.</a>, <a>Perkins, C.</a> and <a>J. Arkko</a>, "<a href="http://tools.ietf.org/html/rfc3775">Mobility Support in IPv6</a>", RFC 3775, June 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5226">[RFC5226]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 5226, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2616">[RFC2616]</b></td>
<td class="top">
<a href="mailto:fielding@ics.uci.edu" title="Department of Information and Computer Science">Fielding, R.</a>, <a href="mailto:jg@w3.org" title="World Wide Web Consortium">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com" title="Compaq Computer Corporation">Mogul, J.</a>, <a href="mailto:frystyk@w3.org" title="World Wide Web Consortium">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox Corporation">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.</a> and <a href="mailto:timbl@w3.org" title="World Wide Web Consortium">T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2616, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5056">[RFC5056]</b></td>
<td class="top">
<a>Williams, N.</a>, "<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>", RFC 5056, November 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4282">[RFC4282]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Beadles, M.</a>, <a>Arkko, J.</a> and <a>P. Eronen</a>, "<a href="http://tools.ietf.org/html/rfc4282">The Network Access Identifier</a>", RFC 4282, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2404">[RFC2404]</b></td>
<td class="top">
<a href="mailto:cmadson@cisco.com" title="Cisco Systems, Inc.">Madson, C.</a> and <a href="mailto:rob.glenn@nist.gov" title="NIST">R. Glenn</a>, "<a href="http://tools.ietf.org/html/rfc2404">The Use of HMAC-SHA-1-96 within ESP and AH</a>", RFC 2404, November 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3566">[RFC3566]</b></td>
<td class="top">
<a>Frankel, S.</a> and <a>H. Herbert</a>, "<a href="http://tools.ietf.org/html/rfc3566">The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec</a>", RFC 3566, September 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2410">[RFC2410]</b></td>
<td class="top">
<a href="mailto:rob.glenn@nist.gov" title="NIST">Glenn, R.</a> and <a href="mailto:kent@bbn.com" title="BBN Corporation">S. Kent</a>, "<a href="http://tools.ietf.org/html/rfc2410">The NULL Encryption Algorithm and Its Use With IPsec</a>", RFC 2410, November 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2451">[RFC2451]</b></td>
<td class="top">
<a href="mailto:rpereira@timestep.com" title="TimeStep Corporation">Pereira, R.</a> and <a href="mailto:adams@cisco.com" title="Cisco Systems Inc.">R. Adams</a>, "<a href="http://tools.ietf.org/html/rfc2451">The ESP CBC-Mode Cipher Algorithms</a>", RFC 2451, November 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3602">[RFC3602]</b></td>
<td class="top">
<a>Frankel, S.</a>, <a>Glenn, R.</a> and <a>S. Kelly</a>, "<a href="http://tools.ietf.org/html/rfc3602">The AES-CBC Cipher Algorithm and Its Use with IPsec</a>", RFC 3602, September 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4285">[RFC4285]</b></td>
<td class="top">
<a>Patel, A.</a>, <a>Leung, K.</a>, <a>Khalil, M.</a>, <a>Akhtar, H.</a> and <a>K. Chowdhury</a>, "<a href="http://tools.ietf.org/html/rfc4285">Authentication Protocol for Mobile IPv6</a>", RFC 4285, January 2006.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.altman-tls-channel-bindings">[I-D.altman-tls-channel-bindings]</b></td>
<td class="top">
<a>Altman, J</a>, <a>Williams, N</a> and <a>L Zhu</a>, "<a href="http://tools.ietf.org/html/draft-altman-tls-channel-bindings-10">Channel Bindings for TLS</a>", Internet-Draft draft-altman-tls-channel-bindings-10, March 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">11.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC4301">[RFC4301]</b></td>
<td class="top">
<a>Kent, S.</a> and <a>K. Seo</a>, "<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>", RFC 4301, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4303">[RFC4303]</b></td>
<td class="top">
<a>Kent, S.</a>, "<a href="http://tools.ietf.org/html/rfc4303">IP Encapsulating Security Payload (ESP)</a>", RFC 4303, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4306">[RFC4306]</b></td>
<td class="top">
<a>Kaufman, C.</a>, "<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>", RFC 4306, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3776">[RFC3776]</b></td>
<td class="top">
<a>Arkko, J.</a>, <a>Devarapalli, V.</a> and <a>F. Dupont</a>, "<a href="http://tools.ietf.org/html/rfc3776">Using IPsec to Protect Mobile IPv6 Signaling Between Mobile Nodes and Home Agents</a>", RFC 3776, June 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4877">[RFC4877]</b></td>
<td class="top">
<a>Devarapalli, V.</a> and <a>F. Dupont</a>, "<a href="http://tools.ietf.org/html/rfc4877">Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture</a>", RFC 4877, April 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3344">[RFC3344]</b></td>
<td class="top">
<a>Perkins, C.</a>, "<a href="http://tools.ietf.org/html/rfc3344">IP Mobility Support for IPv4</a>", RFC 3344, August 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5555">[RFC5555]</b></td>
<td class="top">
<a>Soliman, H.</a>, "<a href="http://tools.ietf.org/html/rfc5555">Mobile IPv6 Support for Dual Stack Hosts and Routers</a>", RFC 5555, June 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3268">[RFC3268]</b></td>
<td class="top">
<a>Chown, P.</a>, "<a href="http://tools.ietf.org/html/rfc3268">Advanced Encryption Standard (AES) Ciphersuites for Transport Layer Security (TLS)</a>", RFC 3268, June 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4279">[RFC4279]</b></td>
<td class="top">
<a>Eronen, P.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/rfc4279">Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)</a>", RFC 4279, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4086">[RFC4086]</b></td>
<td class="top">
<a>Eastlake, D.</a>, <a>Schiller, J.</a> and <a>S. Crocker</a>, "<a href="http://tools.ietf.org/html/rfc4086">Randomness Requirements for Security</a>", BCP 106, RFC 4086, June 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5077">[RFC5077]</b></td>
<td class="top">
<a>Salowey, J.</a>, <a>Zhou, H.</a>, <a>Eronen, P.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/rfc5077">Transport Layer Security (TLS) Session Resumption without Server-Side State</a>", RFC 5077, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3748">[RFC3748]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Blunk, L.</a>, <a>Vollbrecht, J.</a>, <a>Carlson, J.</a> and <a>H. Levkowetz</a>, "<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>", RFC 3748, June 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5433">[RFC5433]</b></td>
<td class="top">
<a>Clancy, T.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/rfc5433">Extensible Authentication Protocol - Generalized Pre-Shared Key (EAP-GPSK) Method</a>", RFC 5433, February 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Basavaraj Patil</span> 
	  <span class="n hidden">
		<span class="family-name">Patil</span>
	  </span>
	</span>
	<span class="org vcardline">Nokia</span>
	<span class="adr">
	  <span>6021 Connection Drive</span>

	  <span class="vcardline">
		<span class="locality">Irving,</span>,  
		<span class="region"></span>
		<span class="code">TX  75039</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:basavaraj.patil@nokia.com">basavaraj.patil@nokia.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Charles Perkins</span> 
	  <span class="n hidden">
		<span class="family-name">Perkins</span>
	  </span>
	</span>
	<span class="org vcardline">Tellabs</span>
	<span class="adr">
	  <span>3590 N. 1st Street, Suite 300</span>

	  <span class="vcardline">
		<span class="locality">San Jose,</span>,  
		<span class="region"></span>
		<span class="code">CA 95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:charles.perkins@tellabs.com">charles.perkins@tellabs.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Hannes Tschofenig</span> 
	  <span class="n hidden">
		<span class="family-name">Tschofenig</span>
	  </span>
	</span>
	<span class="org vcardline">Nokia Siemens Networks</span>
	<span class="adr">
	  <span>Linnoitustie 6</span>

	  <span class="vcardline">
		<span class="locality">Espoo</span>,  
		<span class="region"></span>
		<span class="code">02600</span>
	  </span>
	  <span class="country-name vcardline">Finland</span>
	</span>
	<span class="vcardline">Phone: +358 (50) 4871445</span>

<span class="vcardline">EMail: <a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></span>

<span class="vcardline">URI: <a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Domagoj Premec</span> 
	  <span class="n hidden">
		<span class="family-name">Premec</span>
	  </span>
	</span>
	<span class="org vcardline">Unaffiliated</span>
	<span class="adr">
	  <span>Heinzelova 70a</span>

	  <span class="vcardline">
		<span class="locality">Zagreb</span>,  
		<span class="region"></span>
		<span class="code">10000</span>
	  </span>
	  <span class="country-name vcardline">Croatia</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:domagoj.premec@gmail.com">domagoj.premec@gmail.com</a></span>

  </address>
</div>

</body>
</html>