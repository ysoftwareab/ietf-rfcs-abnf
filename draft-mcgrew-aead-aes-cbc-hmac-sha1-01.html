<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Authenticated Encryption with AES-CBC and HMAC-SHA1
      (and other generic combinations of ciphers and MACs)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Authenticated Encryption with AES-CBC and HMAC-SHA1
      (and other generic combinations of ciphers and MACs)">
<meta name="keywords" content="Encryption, Authentication">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. McGrew</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">March 10, 2009</td></tr>
<tr><td class="header">Expires: September 11, 2009</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Authenticated Encryption with AES-CBC and HMAC-SHA1
      (and other generic combinations of ciphers and MACs)<br />draft-mcgrew-aead-aes-cbc-hmac-sha1-01.txt</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 11, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>
	This document specifies algorithms for authenticated
	encryption with additional authenticated data (AEAD) that are
	based on the composition of the Advanced Encryption Standard
	(AES) in the Cipher Block Chaining (CBC) mode of operation for
	encryption, and the HMAC-SHA1 message authentication code
	(MAC).  It also separately defines a generic composition
	method that can be used with other MACs and randomized ciphers
	(that is, ciphers that use random initialization vectors).
      
</p>
<p>
	These algorithms are randomized, and thus are suitable for 
	use with applications that cannot provide distinct nonces
	to each invocation of the AEAD encrypt operation.
	
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Conventions Used In This Document<br />
<a href="#generic">2.</a>&nbsp;
A Generic Composition Method<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Encryption<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Decryption<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Length<br />
<a href="#aesHmac">3.</a>&nbsp;
AEAD_AES_CBC_128_HMAC_SHA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.1.</a>&nbsp;
Encryption<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.2.</a>&nbsp;
Message Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.3.</a>&nbsp;
Decryption<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.4.</a>&nbsp;
Length Restrictions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.5.</a>&nbsp;
Test Cases<br />
<a href="#aesHmac2">4.</a>&nbsp;
AEAD_AES_256_HMAC_SHA_256<br />
<a href="#Rationale">5.</a>&nbsp;
Rationale<br />
<a href="#anchor11">6.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Authenticated encryption <a class='info' href='#BN00'>[BN00]<span> (</span><span class='info'>, &ldquo;Authenticated encryption: Relations among notions and           analysis of the generic composition paradigm,&rdquo; .</span><span>)</span></a> is a form of
      encryption that, in addition to providing confidentiality for
      the plaintext that is encrypted, provides a way to check its
      integrity and authenticity. Authenticated encryption with
      Associated Data, or AEAD, adds the ability to check the
      integrity and authenticity of some associated data (also called
      "additional authenticated data") that is not encrypted.  This
      document defines two AEAD algorithms, using the interface defined
      in <a class='info' href='#RFC5116'>[RFC5116]<span> (</span><span class='info'>McGrew, D., &ldquo;An Interface and Algorithms for Authenticated Encryption,&rdquo; January&nbsp;2008.</span><span>)</span></a>, based on AES and HMAC-SHA1, 
	with key sizes of 128 bits and 256 bits.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Conventions Used In This Document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="generic"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
A Generic Composition Method</h3>

<p>
	  This section defines a particular "generic composition"
	  method, using the the encrypt-then-MAC method defined in
	  Section 4.3 of <a class='info' href='#AE'>[AE]<span> (</span><span class='info'>, &ldquo;Authenticated encryption: Relations among notions and           analysis of the generic composition paradigm,&rdquo; .</span><span>)</span></a>.  The method
	  describes how to make a randomized AEAD algorithm out of a
	  randomized cipher, such as a block cipher mode of operation
	  that uses a random initialization vector, and a MAC.
	  
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Encryption</h3>

<p> We briefly recall the interface defined in Section 2 of
	  <a class='info' href='#RFC5116'>[RFC5116]<span> (</span><span class='info'>McGrew, D., &ldquo;An Interface and Algorithms for Authenticated Encryption,&rdquo; January&nbsp;2008.</span><span>)</span></a>.  The AEAD encryption algorithm takes
	  as input four octet strings: a secret key K, a plaintext P,
	  associated data A, and a nonce N.  An authenticated
	  ciphertext value is provided as output.  The data in the
	  plaintext are encrypted and authenticated, and the
	  associated data are authenticated, but not encrypted.  The
	  AEAD encryption process is as follows, or uses an equivalent
	  set of steps:
	  </p>
<ol class="text">
<li> The secondary keys MAC_KEY and ENC_KEY are generated
            from the input key K as follows.  Each of these two
	      keys is an octet string.
             
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>MAC_KEY consists of the first MAC_KEY_LEN octets of
                K, in order.
</dd>
<dt>B.</dt>
<dd>ENC_KEY consists of the last ENC_KEY_LEN octets of
                K, in order.
</dd>
</dl></blockquote> 
            Here we denote the number of octets in the MAC_KEY as
	    MAC_KEY_LEN, and the number of bits in ENC_KEY as
	    ENC_KEY_LEN.  
	    
</li>
<li> An Initialization Vector (IV) is generated uniformly
            at random, for use in the cipher.  (Note that this IV is
            distinct from the nonce that may be provided as an input
            to the authenticated encryption operation.)
	    
</li>
<li>
	      The plaintext P is encrypted using the cipher with
	      ENC_KEY as the key, and the IV generated in the previous
	      step.  We denote the ciphertext output from this step
	      as S, and it MUST include the IV as its prefix.  
	      
</li>
<li>A message authentication code (MAC) is computed by
            applying the MAC to the following data, in order:
	      
<blockquote class="text"><dl>
<dt>A.</dt>
<dd> the nonce N, 
</dd>
<dt>B.</dt>
<dd> the associated data A, 
</dd>
<dt>C.</dt>
<dd> the ciphertext S computed in the previous step 
</dd>
<dt>D.</dt>
<dd> the number of bits in N expressed as a 64-bit
            unsigned integer in network byte order, 
</dd>
<dt>E.</dt>
<dd> and the number of bits in A expressed as a 64-bit
            unsigned integer in network byte order.
</dd>
</dl></blockquote>
	      The string MAC_KEY is used as the MAC key.  We denote
	      the output of the MAC computed in this step as T.
	      
</li>
<li>The AEAD Ciphertext consists of the string S, with the
	      string T appended to it.  This Ciphertext is returned as
	      the output of the AEAD encryption operation.
	    
</li>
</ol>

<p>
	  The encryption process can be illustrated as follows.  Here
	  P, A, and C denote the AEAD plaintext, associated data, and
	  ciphertext, respectively.
	  </p>
<blockquote class="text">
<p>
	      S = ENC(ENC_KEY, P) 
	      
</p>
<p>
	      T = MAC(MAC_KEY, N || A || S || len(N) || len(A))
	      
</p>
<p>
	      C = S || T
	      
</p>
</blockquote><p>
	  Here ENC(X,P) denotes the encryption of P using the cipher
	  with the key X; recall that the IV is included in its
	  output.  The expression MAC(Y,M) denotes the application of
	  the MAC to the message M, using the key Y.  The
	  concatenation of two octet strings A and B is denoted as A
	  || B, and len(X) denotes the number of bits in the string X,
	  expressed as an unsigned integer in network byte order.
	
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Decryption</h3>

<p>
            The authenticated decryption operation has four inputs: K, N,
            and A, as defined above, and the Ciphertext C.  It has only
            a single output, either a plaintext value P or a special
            symbol FAIL that indicates that the inputs are not
            authentic.  The authenticated decryption algorithm takes is
            as follows, or uses an equivalent set of steps:
	    
	  </p>
<ol class="text">
<li> The secondary keys MAC_KEY and ENC_KEY are generated
            from the input key K as follows.  Each of these two
	      keys is an octet string.
             
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>MAC_KEY consists of the first MAC_KEY_LEN octets of
                K, in order.
</dd>
<dt>B.</dt>
<dd>ENC_KEY consists of the last ENC_KEY_LEN octets of
                K, in order.
</dd>
</dl></blockquote> 
	     As above, we denote the number of octets in the
            MAC_KEY as MAC_KEY_LEN, and the number of bits in ENC_KEY
            as ENC_KEY_LEN.
	    
</li>
<li>
	      The final T_LEN octets are stripped from C.  Here T_LEN
	      denotes the number of octets in the MAC, which is a
	      fixed parameter of the AEAD algorithm.  We denote
	      the initial octets of C as S, and denote the final
	      T_LEN octets as T.
	    
</li>
<li> The integrity and authenticity of N, A, and C are
	      checked by computing MAC validation algorithm, using the
	      same inputs as in Step 5 of the encryption operation.
	      In the MAC-validation step, the message consists of N,
	      A, the number of bits in N expressed as a 64-bit
	      unsigned integer in network byte order, the number of
	      bits in A expressed as a 64-bit unsigned integer in
	      network byte order, as S, in that order.  The value
	      MAC_KEY is used as the key.  The value T, from the
	      previous step, is used as the correct MAC value for
	      validation purposes.  If the MAC-validation operation
	      indicates that the MAC T is valid, then the processing
	      is continued. Otherwise, all of the data used in the MAC
	      validation are discard, and the AEAD decryption
	      operation returns an indication that it failed, and the
	      operation halts.
</li>
<li> The value S is decrypted, using the first 128 bits of
            the ciphertext as the IV.   The value ENC_KEY is used
	      as the decryption key.
</li>
<li> The plaintext value is returned..
</li>
</ol>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Length</h3>

<p>The length of the ciphertext can be inferred from that of the
        plaintext. The number L of octets in the ciphertext is given by 
	  </p>
<blockquote class="text">
<p>L = 16 * ( floor(M / 16) + 2)
</p>
</blockquote><p> where M denotes the number of octets in the
	  plaintext, and the function floor() rounds its argument down
	  to the nearest integer.  This fact is useful to applications
	  that need to reserve space for a ciphertext within a message
	  or data structure.
</p>
<a name="aesHmac"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
AEAD_AES_CBC_128_HMAC_SHA1</h3>

<p>This algorithm is randomized and stateless. It is based on
        the "generic composition" of CBC encryption with HMAC
        authentication, with the the encrypt-then-MAC method defined
        in Section 4.3 of <a class='info' href='#AE'>[AE]<span> (</span><span class='info'>, &ldquo;Authenticated encryption: Relations among notions and           analysis of the generic composition paradigm,&rdquo; .</span><span>)</span></a>. It uses the HMAC
        message authentication code <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a>
        with the SHA-1 hash function <a class='info' href='#SHA1'>[SHA1]<span> (</span><span class='info'>, &ldquo;FIPS 180-1: Secure Hash Standard,,&rdquo; .</span><span>)</span></a> to
        provide message authentication. Test cases for HMAC_SHA1 are
        provided in <a class='info' href='#RFC2202'>[RFC2202]<span> (</span><span class='info'>Cheng, P. and R. Glenn, &ldquo;Test Cases for HMAC-MD5 and HMAC-SHA-1,&rdquo; September&nbsp;1997.</span><span>)</span></a>. For encryption, it
        uses AES in the cipher block chaining (CBC) mode of operation
        as defined in Section 6.2 of <a class='info' href='#MODES'>[MODES]<span> (</span><span class='info'>Dworkin, M., &ldquo;NIST Special Publication 800-38: Recommendation for             Block Cipher Modes of Operation,&rdquo; .</span><span>)</span></a>,
        with the padding method defined by Appendix A of the same
        reference. 
</p>
<p>
	  The input key K is 36 octets long. 
	  
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Encryption</h3>

<p>
	    The AES CBC IV is 16 octets long.  ENC_KEY_LEN is 16
	    octets.
	  
</p>
<p>Prior to CBC encryption, the plaintext is padded by
            appending a single '1' bit to that data and then appending
            to the resulting string as few '0' bits as are necessary
            to make the number of bits in the plaintext into a
            multiple of 128. Note that padding MUST be added to the
            data; if the number of bits in the payload data is a
            multiple of 128, then 128 bits of padding will be
            added.
</p>
<p>The plaintext is then encrypted using AES-128 in CBC mode,
            using ENC_KEY as the key and the random IV.  The IV is 
	    included in the ciphertext as its initial 16 octets.  
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Message Authentication</h3>

<p>
	    HMAC-SHA1 is used as the MAC.  MAC_KEY_LEN is 20 octets. 	    
	    The HMAC-SHA1 output is truncated to 16 octets, by 
	    stripping off the final four octets.
	    
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Decryption</h3>

<p>After CBC decryption, the padding is removed by
            deleting the final '1' bit and all of the following '0'
            bits. The remaining data forms the plaintext.
</p>
<p>
	      The HMAC-SHA1 validation operation consists of computing
	      the HMAC-SHA1 value of the message, truncating it to 16
	      octets by discarding the final four octets, then
	      comparing that value with the MAC value.  If values are
	      not equal, then the message is rejected.  Otherwise, it
	      is accepted.
	      
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Length Restrictions</h3>

<p>The lengths of the inputs are restricted as follows:
</p>
<p></p>
<blockquote class="text">
<p>K_LEN is 36 octets,
</p>
<p>P_MAX is 2^64 - 1 octets,
</p>
<p>A_MAX is 2^64 - 1 octets,
</p>
<p>N_MIN is zero octets,
</p>
<p> N_MAX is 2^64 octets, and
</p>
<p>C_MAX is 2^64 + 47 octets.
</p>
</blockquote>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Test Cases</h3>

<p>A future version of this document will include test cases.
</p>
<a name="aesHmac2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
AEAD_AES_256_HMAC_SHA_256</h3>

<p>
	AEAD_AES_CBC_256_HMAC_SHA_256 is like AEAD_AES_CBC_128_HMAC_SHA1,
	with the following differences:
	</p>
<blockquote class="text">
<p>
	    AES-256 is used instead of AES-128.
	    
</p>
<p>
	    HMAC-SHA-256 is used instead of HMAC-SHA1.  
	    
</p>
<p>
	    ENC_KEY_LEN and MAC_KEY_LEN are each  
	    32 octets.
	    
</p>
<p>
	    The input key length is 64 octets.
	    
</p>
</blockquote><p>
      
</p>
<a name="Rationale"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Rationale</h3>

<p>
 The AEAD_AES_CBC_128_HMAC_SHA1 and AEAD_AES_CBC_256_HMAC_SHA_256
 algorithms are intended for use in applications that make use of the
 AEAD interface.  It is expected to be useful with cryptomodules that
 contain efficient implementations of AES-CBC and HMAC-SHA1, but which
 do not implement any other AEAD algorithms.  They are not intended to
 replace existing uses of AES-CBC and HMAC-SHA1, except in those
 circumstances where the existing use is not sufficiently secure or
 sufficiently general-purpose.

</p>
<p>
 One advantage of these algorithms is that they are suitable for use
 in applications that cannot provide distinct nonces to each
 invocation of the AEAD encryption operation.  In short, they can be
 used with zero-length nonces.  However, the algorithms can accept
 nonces; this ensures that they can be used with applications that
 are designed to work primarily with algorithms that expect nonces.
 The nonce data is authenticated.

</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
This initial version of this document has not been reviewed; regarding
security, it should be considered guilty until proven innocent.
Review has been requested from the IRTF Crypto Forum Research Group
(CFRG).

</p>
<p>
The algorithms defined in this document use the "generic composition"
of CBC encryption with HMAC authentication, with the encrypt-then-MAC
method defined in Section 4.3 of <a class='info' href='#AE'>[AE]<span> (</span><span class='info'>, &ldquo;Authenticated encryption: Relations among notions and           analysis of the generic composition paradigm,&rdquo; .</span><span>)</span></a>.  This
method has sound and well-understood security properties; for details,
please see that reference.

</p>
<p>
 As with any block cipher mode of operation, the security of AES-CBC
degrades as the amount of data that is process increases.  Each fixed
key value SHOULD NOT be used to protect more than 2^64 bytes of data.
This limit ensures that the AES-CBC algorithm will stay under the
"birthday bound", i.e., that it is unlikely that there will be two AES
plaintext inputs that are equal.  (If this event occurs, information
about the colliding plaintexts is leaked, so it is desirable to bound
 the amount of plaintext processed in order to make it unlikely.)
  
</p>
<p>
  The nonce data is authenticated, as is expected in <a class='info' href='#RFC5116'>[RFC5116]<span> (</span><span class='info'>McGrew, D., &ldquo;An Interface and Algorithms for Authenticated Encryption,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
  
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="MODES">[MODES]</a></td>
<td class="author-text">Dworkin, M., &ldquo;NIST Special Publication 800-38: Recommendation for
            Block Cipher Modes of Operation,&rdquo; U.S. National Institue of Standards and Technology&nbsp;http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2202">[RFC2202]</a></td>
<td class="author-text"><a href="mailto:pau@watson.ibm.com">Cheng, P.</a> and <a href="mailto:rob.glenn@nist.gov">R. Glenn</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2202">Test Cases for HMAC-MD5 and HMAC-SHA-1</a>,&rdquo; RFC&nbsp;2202, September&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2202.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2202.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2202.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5116">[RFC5116]</a></td>
<td class="author-text">McGrew, D., &ldquo;<a href="http://tools.ietf.org/html/rfc5116">An Interface and Algorithms for Authenticated Encryption</a>,&rdquo; RFC&nbsp;5116, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5116.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SHA1">[SHA1]</a></td>
<td class="author-text">&ldquo;FIPS 180-1: Secure Hash Standard,,&rdquo; Federal Information Processing Standard (FIPS)&nbsp;http://www.itl.nist.gov/fipspubs/fip180-1.htm.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="AE">[AE]</a></td>
<td class="author-text">&ldquo;Authenticated encryption: Relations among notions and
          analysis of the generic composition paradigm,&rdquo; Proceedings of ASIACRYPT 2000, Springer-Verlag, LNCS 1976, pp. 531-545&nbsp;http://www.</td></tr>
<tr><td class="author-text" valign="top"><a name="BN00">[BN00]</a></td>
<td class="author-text">&ldquo;Authenticated encryption: Relations among notions and
          analysis of the generic composition paradigm,&rdquo; Proceedings of ASIACRYPT 2000, Springer-Verlag, LNCS 1976, pp. 531-545&nbsp;http://www-cse.ucsd.edu/users/mihir/papers/oem.html.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David A. McGrew</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">510 McCarthy Blvd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Milpitas, CA  95035</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">(408) 525 8651</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mcgrew@cisco.com">mcgrew@cisco.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.mindspring.com/~dmcgrew/dam.htm">http://www.mindspring.com/~dmcgrew/dam.htm</a></td></tr>
</table>
</body></html>
