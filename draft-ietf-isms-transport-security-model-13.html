<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Transport Security Model
    for SNMP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Transport Security Model
    for SNMP">
<meta name="keywords" content="Network Management, Simple Network Management Protocol, SNMP, Transport Security Model, Security Model">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. Harrington</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Huawei Technologies (USA)</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">W. Hardaker</td></tr>
<tr><td class="header">Expires: October 29, 2009</td><td class="header">Sparta, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">April 27, 2009</td></tr>
</table></td></tr></table>
<h1><br />Transport Security Model
    for SNMP<br />draft-ietf-isms-transport-security-model-13</h1>

<h3>Status of This Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on October 29, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This memo describes a Transport Security Model for the Simple Network
      Management Protocol.
</p>
<p>This memo also defines a portion of the Management Information Base
      (MIB) for monitoring and managing the Transport Security Model for SNMP.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
The Internet-Standard Management Framework<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
Modularity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">1.4.</a>&nbsp;
Motivation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">1.5.</a>&nbsp;
Constraints<br />
<a href="#anchor7">2.</a>&nbsp;
How the Transport Security Model Fits in the Architecture<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.1.</a>&nbsp;
Security Capabilities of this Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.1.1.</a>&nbsp;
Threats<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">2.1.2.</a>&nbsp;
Security Levels<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">2.2.</a>&nbsp;
Transport Sessions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">2.3.</a>&nbsp;
Coexistence<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">2.3.1.</a>&nbsp;
Coexistence with Message Processing Models<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">2.3.2.</a>&nbsp;
Coexistence with Other Security Models<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">2.3.3.</a>&nbsp;
Coexistence with Transport Models<br />
<a href="#anchor16">3.</a>&nbsp;
Cached Information and References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">3.1.</a>&nbsp;
Transport Security Model Cached Information<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">3.1.1.</a>&nbsp;
securityStateReference<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">3.1.2.</a>&nbsp;
tmStateReference<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">3.1.3.</a>&nbsp;
Prefixes and securityNames<br />
<a href="#anchor21">4.</a>&nbsp;
Processing an Outgoing Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.1.</a>&nbsp;
Security Processing for an Outgoing Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.2.</a>&nbsp;
Elements of Procedure for Outgoing Messages<br />
<a href="#anchor24">5.</a>&nbsp;
Processing an Incoming SNMP Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">5.1.</a>&nbsp;
Security Processing for an Incoming Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">5.2.</a>&nbsp;
Elements of Procedure for Incoming Messages<br />
<a href="#anchor27">6.</a>&nbsp;
MIB Module Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">6.1.</a>&nbsp;
Structure of the MIB Module<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">6.1.1.</a>&nbsp;
The snmpTsmStats Subtree<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">6.1.2.</a>&nbsp;
The snmpTsmConfiguration Subtree<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">6.2.</a>&nbsp;
Relationship to Other MIB Modules<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">6.2.1.</a>&nbsp;
MIB Modules Required for IMPORTS<br />
<a href="#anchor33">7.</a>&nbsp;
MIB module definition<br />
<a href="#anchor34">8.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">8.1.</a>&nbsp;
MIB module security<br />
<a href="#anchor36">9.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor37">10.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#anchor40">Appendix&nbsp;A.</a>&nbsp;
Notification Tables Configuration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">A.1.</a>&nbsp;
Transport Security Model Processing for Notifications<br />
<a href="#anchor42">Appendix&nbsp;B.</a>&nbsp;
Processing Differences between USM and Secure Transport<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">B.1.</a>&nbsp;
USM and the RFC3411 Architecture<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">B.2.</a>&nbsp;
Transport Subsystem and the RFC3411 Architecture<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This memo describes a Transport Security Model for the Simple Network
      Management Protocol, for use with secure Transport Models in the
      Transport Subsystem <a class='info' href='#I-D.ietf-isms-tmsm'>[I&#8209;D.ietf&#8209;isms&#8209;tmsm]<span> (</span><span class='info'>Harrington, D. and J. Schoenwaelder, &ldquo;Transport Subsystem for the Simple Network Management Protocol (SNMP),&rdquo; May&nbsp;2009.</span><span>)</span></a>.
</p>
<p>This memo also defines a portion of the Management Information Base
      (MIB) for monitoring and managing
      the Transport Security Model for SNMP.
</p>
<p>It is important to understand the SNMP architecture and the
      terminology of the architecture to understand where the Transport
      Security Model described in this memo fits into the architecture and
      interacts with other subsystems and models within the architecture. It
      is expected that reader will have also read and understood RFC3411 <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>, RFC3412 <a class='info' href='#RFC3412'>[RFC3412]<span> (</span><span class='info'>Case, J., Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;Message Processing and Dispatching for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>,
      RFC3413 <a class='info' href='#RFC3413'>[RFC3413]<span> (</span><span class='info'>Levi, D., Meyer, P., and B. Stewart, &ldquo;Simple Network Management Protocol (SNMP) Applications,&rdquo; December&nbsp;2002.</span><span>)</span></a>, and RFC3418 <a class='info' href='#RFC3418'>[RFC3418]<span> (</span><span class='info'>Presuhn, R., &ldquo;Management Information Base (MIB) for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
The Internet-Standard Management Framework</h3>

<p>For a detailed overview of the documents that describe the current
        Internet-Standard Management Framework, please refer to section 7 of
        RFC 3410 <a class='info' href='#RFC3410'>[RFC3410]<span> (</span><span class='info'>Case, J., Mundy, R., Partain, D., and B. Stewart, &ldquo;Introduction and Applicability Statements for Internet-Standard Management Framework,&rdquo; December&nbsp;2002.</span><span>)</span></a>.
</p>
<p>Managed objects are accessed via a virtual information store,
        termed the Management Information Base or MIB. MIB objects are
        generally accessed through the Simple Network Management Protocol
        (SNMP). Objects in the MIB are defined using the mechanisms defined in
        the Structure of Management Information (SMI). This memo specifies a
        MIB module that is compliant to the SMIv2, which is described in STD
        58, RFC 2578 <a class='info' href='#RFC2578'>[RFC2578]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Structure of Management Information Version 2 (SMIv2),&rdquo; April&nbsp;1999.</span><span>)</span></a>, STD 58, RFC 2579 <a class='info' href='#RFC2579'>[RFC2579]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Textual Conventions for SMIv2,&rdquo; April&nbsp;1999.</span><span>)</span></a> and STD 58, RFC 2580 <a class='info' href='#RFC2580'>[RFC2580]<span> (</span><span class='info'>McCloghrie, K., Perkins, D., and J. Schoenwaelder, &ldquo;Conformance Statements for SMIv2,&rdquo; April&nbsp;1999.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Conventions</h3>

<p>For consistency with SNMP-related specifications, this document
        favors terminology as defined in STD62 rather than favoring
        terminology that is consistent with non-SNMP specifications that use
        different variations of the same terminology. This is consistent with
        the IESG decision to not require the SNMPv3 terminology be modified to
        match the usage of other non-SNMP specifications when SNMPv3 was
        advanced to Full Standard.
</p>
<p>Authentication in this document typically refers to the English
        meaning of "serving to prove the authenticity of" the message, not
        data source authentication or peer identity authentication.
</p>
<p>The terms "manager" and "agent" are not used in this document,
        because in the RFC 3411 architecture, all SNMP entities have the
        capability of acting as either manager or agent or both depending on
        the SNMP applications included in the engine. Where distinction is
        required, the application names of Command Generator, Command
        Responder, Notification Originator, Notification Receiver, and Proxy
        Forwarder are used. See "SNMP Applications" <a class='info' href='#RFC3413'>[RFC3413]<span> (</span><span class='info'>Levi, D., Meyer, P., and B. Stewart, &ldquo;Simple Network Management Protocol (SNMP) Applications,&rdquo; December&nbsp;2002.</span><span>)</span></a> for further information.
</p>
<p>While security protocols frequently refer to a user, the
        terminology used in RFC3411 <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a> and in this
        memo is "principal". A principal is the "who" on whose behalf services
        are provided or processing takes place. A principal can be, among
        other things, an individual acting in a particular role; a set of
        individuals, with each acting in a particular role; an application or
        a set of applications, or a combination of these within an
        administrative domain.
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Modularity</h3>

<p>The reader is expected to have read and understood the description
        of the SNMP architecture, as defined in <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>, and the architecture extension specified in
        "Transport Subsystem for the Simple Network Management Protocol" <a class='info' href='#I-D.ietf-isms-tmsm'>[I&#8209;D.ietf&#8209;isms&#8209;tmsm]<span> (</span><span class='info'>Harrington, D. and J. Schoenwaelder, &ldquo;Transport Subsystem for the Simple Network Management Protocol (SNMP),&rdquo; May&nbsp;2009.</span><span>)</span></a>, which enables the use of external
        "lower layer transport" protocols to provide message security, tied
        into the SNMP architecture through the Transport Subsystem. The
        Transport Security Model is designed to work with such lower-layer
        secure Transport Models.
</p>
<p>In keeping with the RFC 3411 design decisions to use self-contained
        documents, this memo includes the elements of procedure plus
        associated MIB objects which are needed for processing the Transport
        Security Model for SNMP. These MIB objects SHOULD NOT be referenced in
        other documents. This allows the Transport Security Model to be
        designed and documented as independent and self-contained, having no
        direct impact on other modules, and allowing this module to be
        upgraded and supplemented as the need arises, and to move along the
        standards track on different time-lines from other modules.
</p>
<p>This modularity of specification is not meant to be interpreted as
        imposing any specific requirements on implementation.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4"></a><h3>1.4.&nbsp;
Motivation</h3>

<p>This memo describes a Security Model to make use of Transport
        Models that use lower layer secure transports and existing and
        commonly deployed security infrastructures. This Security Model is
        designed to meet the security and operational needs of network
        administrators, maximize usability in operational environments to
        achieve high deployment success and at the same time minimize
        implementation and deployment costs to minimize the time until
        deployment is possible.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.5"></a><h3>1.5.&nbsp;
Constraints</h3>

<p>The design of this SNMP Security Model is also influenced by the
        following constraints: </p>
<ol class="text">
<li>In times of network stress, the security protocol and its
            underlying security mechanisms SHOULD NOT depend solely upon the
            ready availability of other network services (e.g., Network Time
            Protocol (NTP) or Authentication, Authorization, and Accounting
            (AAA) protocols).
</li>
<li>When the network is not under stress, the Security Model and
            its underlying security mechanisms MAY depend upon the ready
            availability of other network services.
</li>
<li>It may not be possible for the Security Model to determine when
            the network is under stress.
</li>
<li>A Security Model should require no changes to the SNMP
            architecture.
</li>
<li>A Security Model should require no changes to the underlying
            security protocol.
</li>
</ol>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
How the Transport Security Model Fits in the Architecture</h3>

<p>The Transport Security Model is designed to fit into the RFC3411
      architecture as a Security Model in the Security Subsystem, and to
      utilize the services of a secure Transport Model.
</p>
<p>   For incoming messages, a secure Transport Model will pass
   a tmStateReference cache, described later.  To maintain RFC3411 modularity, the Transport Model will not know
      which securityModel will process the incoming message; the Message
      Processing Model will determine this. If the Transport Security Model is used with a non-secure
      Transport Model, then the cache will not exist or not be populated with
      security parameters, which will cause the Transport Security Model to
      return an error (see section 5.2) 
</p>
<p>The Transport Security Model will create the securityName and securityLevel to be passed to applications, and verify that the tmTransportSecurityLevel reported by the Transport Model is at least as strong as the securityLevel requested by the Message Processing Model.
</p>
<p>For outgoing messages, the Transport Security Model will create a tmStateReference cache (or use an existing one), and pass the tmStateReference to the specified Transport Model.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Security Capabilities of this Model</h3>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.1"></a><h3>2.1.1.&nbsp;
Threats</h3>

<p>The Transport Security Model is compatible with the RFC3411 architecture, and provides protection against the threats identified
          by the RFC 3411 architecture. However, the Transport Security
          Model does not provide security mechanisms such as authentication
          and encryption itself, so it SHOULD always be used with a Transport
          Model that provides appropriate security. Which threats are addressed and how they are mitigated depends on the Transport Model.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.2"></a><h3>2.1.2.&nbsp;
Security Levels</h3>

<p>The RFC 3411 architecture recognizes three levels of security:
          </p>
<blockquote class="text">
<p>- without authentication and without privacy
              (noAuthNoPriv)
</p>
<p>- with authentication but without privacy (authNoPriv)
</p>
<p>- with authentication and with privacy (authPriv)
</p>
</blockquote>

<p>The model-independent securityLevel parameter is used to request
          specific levels of security for outgoing messages, and to assert
          that specific levels of security were applied during the transport
          and processing of incoming messages.
</p>
<p>The transport layer algorithms used to provide security SHOULD
          NOT be exposed to the Transport Security Model, as the Transport
          Security Model has no mechanisms by which it can test whether an
          assertion made by a Transport Model is accurate.
</p>
<p>The Transport Security Model trusts that the underlying secure
          transport connection has been properly configured to support
          security characteristics at least as strong as reported in
          tmTransportSecurityLevel.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Transport Sessions</h3>

<p>The Transport Security Model does not work with transport sessions
   directly.  Instead the transport-related state is associated with
   a unique combination of transportDomain, transportAddress, securityName
   and securityLevel, and referenced via the tmStateReference parameter.
   How and if this is mapped to a particular transport or channel is
   the responsibility of the Transport Subsystem.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Coexistence</h3>

<p>In the RFC3411 architecture, a Message Processing Model determines
        which Security Model should be called. As of this writing, IANA has
        registered four Message Processing Models (SNMPv1, SNMPv2c,
        SNMPv2u/SNMPv2*, and SNMPv3) and three other Security Models (SNMPv1,
        SNMPv2c, and the User-based Security Model).
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1"></a><h3>2.3.1.&nbsp;
Coexistence with Message Processing Models</h3>

<p>The SNMPv1 and SNMPv2c message processing described in RFC3584 (BCP
        74) <a class='info' href='#RFC3584'>[RFC3584]<span> (</span><span class='info'>Frye, R., Levi, D., Routhier, S., and B. Wijnen, &ldquo;Coexistence between Version 1, Version 2, and Version 3 of the Internet-standard Network Management Framework,&rdquo; August&nbsp;2003.</span><span>)</span></a> always selects the SNMPv1(1)
        and SNMPv2c(2) Security Models. Since there is no mechanism defined in RFC3584 to
   select an alternative Security Model, SNMPv1 and SNMPv2c messages
   cannot use the Transport Security Model.  Such messages can still
   be conveyed over a secure transport protocol, but the Transport
   Security Model will not be invoked.
</p>
<p>The SNMPv2u/SNMPv2* Message Processing Model is a historic artifact for which there is no existing IETF specification.
</p>
<p>The SNMPv3 message processing defined in RFC3412 <a class='info' href='#RFC3412'>[RFC3412]<span> (</span><span class='info'>Case, J., Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;Message Processing and Dispatching for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>, extracts the securityModel from the
        msgSecurityModel field of an incoming SNMPv3Message. When this
        value is transportSecurityModel(YY),
        security processing is directed to the Transport Security Model. For
        an outgoing message to be secured using the Transport Security Model,
        the application should specify a securityModel parameter value of transportSecurityModel(YY) in the sendPdu ASI.
</p>
<p>[-- NOTE to RFC editor: replace YY with actual IANA-assigned
        number, and remove this note. ]
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2"></a><h3>2.3.2.&nbsp;
Coexistence with Other Security Models</h3>

<p>The Transport Security Model uses its own MIB module for processing
        to maintain independence from other Security Models. This allows the
        Transport Security Model to coexist with other Security Models, such
        as the User-based Security Model <a class='info' href='#RFC3414'>[RFC3414]<span> (</span><span class='info'>Blumenthal, U. and B. Wijnen, &ldquo;User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3),&rdquo; December&nbsp;2002.</span><span>)</span></a>.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.3"></a><h3>2.3.3.&nbsp;
Coexistence with Transport Models</h3>

<p>The Transport Security Model may work with multiple
   Transport Models, but the RFC3411 application service
   interfaces (ASIs) do not carry a value for the Transport Model. 
The MIB module defined in this memo allows an administrator
        to configure whether or not TSM prepends a
        transport model prefix to the securityName. This will allow SNMP applications to consider transport model as a factor when making decisions, such as access control, notification generation, and proxy forwarding.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Cached Information and References</h3>

<p>When performing SNMP processing, there are two levels of state
   information that may need to be retained:  the immediate state
   linking a request-response pair, and potentially longer-term state
   relating to transport and security. <a class='info' href='#I-D.ietf-isms-tmsm'>"Transport Subsystem for the Simple Network Management Protocol"<span> (</span><span class='info'>Harrington, D. and J. Schoenwaelder, &ldquo;Transport Subsystem for the Simple Network Management Protocol (SNMP),&rdquo; May&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;isms&#8209;tmsm] defines general requirements for caches and references. 
</p>
<p>This document defines additional cache requirements related to the Transport Security Model.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Transport Security Model Cached Information</h3>

<p>The Transport Security Model has specific responsibilities regarding the cached information.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
securityStateReference</h3>

<p>The Transport Security Model adds   
              the tmStateReference received from the processIncomingMsg ASI to the
               securityStateReference.  This tmStateReference can then be retrieved during the 
               generateResponseMsg ASI, so that it can be passed back to the Transport Model.

</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
tmStateReference</h3>

<p>For outgoing messages, the Transport Security Model uses
        parameters provided by the SNMP application to lookup or create a
        tmStateReference.
</p>
<p>The Transport Security Model REQUIRES that the security parameters
	    used for a response are the same as those used for the 
	    corresponding request.  This security model uses the tmStateReference stored as 
	    part of the securityStateReference when appropriate. For responses and reports, 
	    this security model sets the tmSameSecurity flag to true in the tmStateReference 
	    before passing it to a transport model.
</p>
<p>For incoming messages, the Transport Security Model uses
        parameters provided in the tmStateReference cache to establish a securityName, and to verify adequate security levels. 
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
Prefixes and securityNames</h3>

<p>The SNMP-VIEW-BASED-ACM-MIB <a class='info' href='#RFC3415'>[RFC3415]<span> (</span><span class='info'>Wijnen, B., Presuhn, R., and K. McCloghrie, &ldquo;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>, the SNMP-TARGET-MIB module <a class='info' href='#RFC3413'>[RFC3413]<span> (</span><span class='info'>Levi, D., Meyer, P., and B. Stewart, &ldquo;Simple Network Management Protocol (SNMP) Applications,&rdquo; December&nbsp;2002.</span><span>)</span></a>,  and other MIB modules contain objects to configure security parameters for use by applications such as access control, notification generation, and proxy forwarding. 
</p>
<p>IANA maintains a registry for transport domains and the corresponding prefix.
</p>
<p>If snmpTsmConfigurationUsePrefix is set to true then all securityNames provided by, or provided to, the Transport Security Model MUST include a valid transport domain prefix.
</p>
<p>If snmpTsmConfigurationUsePrefix is set to false then all securityNames provided by, or provided to, the Transport Security Model MUST NOT include a transport domain prefix.
</p>
<p>The tmSecurityName in the tmStateReference stored as part of the securityStateReference does not contain a prefix.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Processing an Outgoing Message</h3>

<p>An error indication may return an OID and value for an incremented
      counter and a value for securityLevel, and values for contextEngineID
      and contextName for the counter, and the securityStateReference if the
      information is available at the point where the error is detected.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Security Processing for an Outgoing Message</h3>

<p>This section describes the procedure followed by the Transport
        Security Model.
</p>
<p>The parameters needed for generating a message are supplied to the
        Security Model by the Message Processing Model via the
        generateRequestMsg() or the generateResponseMsg() ASI. The Transport
        Subsystem architectural extension has added the transportDomain,
        transportAddress, and tmStateReference parameters to the original
        RFC3411 ASIs.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  statusInformation =                -- success or errorIndication
        generateRequestMsg(
        IN   messageProcessingModel  -- typically, SNMP version
        IN   globalData              -- message header, admin data
        IN   maxMessageSize          -- of the sending SNMP entity
        IN   transportDomain         -- (NEW) specified by application
        IN   transportAddress        -- (NEW) specified by application
        IN   securityModel           -- for the outgoing message
        IN   securityEngineID        -- authoritative SNMP entity
        IN   securityName            -- on behalf of this principal
        IN   securityLevel           -- Level of Security requested
        IN   scopedPDU               -- message (plaintext) payload
        OUT  securityParameters      -- filled in by Security Module
        OUT  wholeMsg                -- complete generated message
        OUT  wholeMsgLength          -- length of generated message
        OUT  tmStateReference        -- (NEW)  transport info
             )
</pre></div><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
statusInformation = -- success or errorIndication
        generateResponseMsg(
        IN   messageProcessingModel  -- typically, SNMP version
        IN   globalData              -- message header, admin data
        IN   maxMessageSize          -- of the sending SNMP entity
        IN   transportDomain         -- (NEW) specified by application
        IN   transportAddress        -- (NEW) specified by application
        IN   securityModel           -- for the outgoing message
        IN   securityEngineID        -- authoritative SNMP entity
        IN   securityName            -- on behalf of this principal
        IN   securityLevel           -- Level of Security requested
        IN   scopedPDU               -- message (plaintext) payload
        IN   securityStateReference  -- reference to security state
                                     -- information from original
                                     -- request
        OUT  securityParameters      -- filled in by Security Module
        OUT  wholeMsg                -- complete generated message
        OUT  wholeMsgLength          -- length of generated message
        OUT  tmStateReference        -- (NEW) transport info
             )</pre></div>
<p>
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Elements of Procedure for Outgoing Messages</h3>

<p>1) If there is a securityStateReference (Response or Report
         message), then this security model uses the cached information rather 
         than the information provided by the ASI. Extract the 
         tmStateReference from the securityStateReference cache. Set the
        tmRequestedSecurityLevel to the value of the extracted
        tmTransportSecurityLevel. Set the tmSameSecurity parameter in the
        tmStateReference cache to true. The cachedSecurityData for this 
        message can now be discarded. 
</p>
<p>2) If there is no securityStateReference (e.g., a Request-type or Notification message) then create a
        tmStateReference cache. Set tmTransportDomain to the value of transportDomain, 
        tmTransportAddress to the value of transportAddress,  and tmRequestedSecurityLevel to the value of securityLevel. 
        (Implementers might optimize by pointing to saved copies of these session-specific 
        values.) Set the transaction-specific tmSameSecurity parameter to false.
</p>
<p>If the snmpTsmConfigurationUsePrefix object is set to false, then set tmSecurityName 
        to the value of securityName.
</p>
<p>If the snmpTsmConfigurationUsePrefix object is set to
	    true, then use the transportDomain to look up the corresponding prefix. (Since the
	     securityStateReference stores the tmStateReference with the tmSecurityName 
	     for the incoming message, and tmSecurityName never has a prefix, the prefix 
	     stripping step only occurs when we are not using the securityStateReference).
	  </p>
<blockquote class="text">
<p>  	
	    If the prefix lookup fails for any reason, then the 
	    snmpTsmUnknownPrefixes counter is incremented, an error indication 
	    is returned to the calling module, and message processing stops.  
   	                  <br />
<br />

   	    If the lookup succeeds, but there is no prefix in the securityName, or
   	    the prefix returned does not match the prefix in the securityName,   
   	    or the length of the prefix is less than 1 or greater than four ASCII
   	    characters, then the snmpTsmInvalidPrefixes
   	    counter is incremented, an error indication is returned
   	    to the calling module, and message processing stops.
              <br />
<br />
 	
        Strip the transport-specific prefix and trailing ':'
	    character (ASCII 0x3a) from the securityName.  
	    Set tmSecurityName to the value of securityName.
</p>
</blockquote><p>
	
</p>
<p>3) Set securityParameters to a zero-length OCTET STRING ('0400').
</p>
<p>4) Combine the message parts into a wholeMsg and calculate
        wholeMsgLength.
</p>
<p>5) The wholeMsg, wholeMsgLength, securityParameters and
        tmStateReference are returned to the calling Message Processing Model
        with the statusInformation set to success.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Processing an Incoming SNMP Message</h3>

<p>An error indication may return an OID and value for an incremented
      counter and a value for securityLevel, and values for contextEngineID
      and contextName for the counter, and the securityStateReference if the
      information is available at the point where the error is detected.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Security Processing for an Incoming Message</h3>

<p>This section describes the procedure followed by the Transport
        Security Model whenever it receives an incoming message from a Message
        Processing Model. The ASI from a Message Processing Model to the
        Security Subsystem for a received message is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
statusInformation =  -- errorIndication or success
                         -- error counter OID/value if error
processIncomingMsg(
IN   messageProcessingModel    -- typically, SNMP version
IN   maxMessageSize            -- from the received message
IN   securityParameters        -- from the received message
IN   securityModel             -- from the received message
IN   securityLevel             -- from the received message
IN   wholeMsg                  -- as received on the wire
IN   wholeMsgLength            -- length as received on the wire
IN   tmStateReference          -- (NEW) from the Transport Model
OUT  securityEngineID          -- authoritative SNMP entity
OUT  securityName              -- identification of the principal
OUT  scopedPDU,                -- message (plaintext) payload
OUT  maxSizeResponseScopedPDU  -- maximum size sender can handle
OUT  securityStateReference    -- reference to security state
 )                         -- information, needed for response
</pre></div>
<p>
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Elements of Procedure for Incoming Messages</h3>

<p>1) Set the securityEngineID to the local snmpEngineID.
</p>
<p>2) If tmStateReference does not refer to a cache containing
        values for tmTransportDomain, tmTransportAddress, tmSecurityName and
        tmTransportSecurityLevel, then the snmpTsmInvalidCaches
        counter is incremented, an error indication is returned to the
        calling module, and Security Model processing stops for this
        message.
</p>
<p>3) Copy the tmSecurityName to securityName. 
</p>
<p>If the snmpTsmConfigurationUsePrefix object is set to true, then 
        use the tmTransportDomain to look up the corresponding prefix.
	  </p>
<blockquote class="text">
<p> If the prefix lookup fails for any
	    reason, then the snmpTsmUnknownPrefixes counter is
	    incremented, an error indication is returned to the
	    calling module, and message processing stops.
   	                  <br />
<br />

   	    If the lookup succeeds, but the prefix length is less than one or greater 
   	    than four octets, then the snmpTsmInvalidPrefixes counter is incremented, an 
   	    error indication is returned to the calling module, and message 
   	    processing stops.	    
	      <br />
<br />

	    Set the securityName to be the concatenation of
	    the prefix, a ':' character (ASCII 0x3a)
	    and the tmSecurityName. 
	    
</p>
</blockquote><p>
	
</p>
<p>4) Compare the value of tmTransportSecurityLevel in the
        tmStateReference cache to the value of the securityLevel parameter
        passed in the processIncomingMsg ASI. If securityLevel specifies
        privacy (Priv), and tmTransportSecurityLevel specifies no privacy
        (noPriv), or securityLevel specifies authentication (auth) and
        tmTransportSecurityLevel specifies no authentication (noAuth) was
        provided by the Transport Model, then the
        snmpTsmInadequateSecurityLevels counter is incremented, an error
        indication (unsupportedSecurityLevel) together with the OID and value
        of the incremented counter is returned to the calling module, and
        Transport Security Model processing stops for this message.
</p>
<p>5) The tmStateReference is cached as cachedSecurityData, so that a
        possible response to this message will use the same security
        parameters. Then securityStateReference is set for subsequent reference 
        to this cached data.
</p>
<p>6) The scopedPDU component is extracted from the wholeMsg.
</p>
<p>7) The maxSizeResponseScopedPDU is calculated. This is the maximum
        size allowed for a scopedPDU for a possible Response message.
</p>
<p>8) The statusInformation is set to success and a return is made to
        the calling module passing back the OUT parameters as specified in the
        processIncomingMsg ASI.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
MIB Module Overview</h3>

<p>This MIB module provides objects for use only by the Transport Security
      Model. It defines a configuration scalar and related error counters.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Structure of the MIB Module</h3>

<p>Objects in this MIB module are arranged into subtrees. Each subtree
        is organized as a set of related objects. The overall structure and
        assignment of objects to their subtrees, and the intended purpose of
        each subtree, is shown below.
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
The snmpTsmStats Subtree</h3>

<p>This subtree contains error counters specific to the Transport Security
        Model.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.2"></a><h3>6.1.2.&nbsp;
The snmpTsmConfiguration Subtree</h3>

<p>This
      subtree contains a configuration object that enables
      administrators to specify if they want a transport domain prefix 
      prepended to securityNames for use by applications.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Relationship to Other MIB Modules</h3>

<p>Some management objects defined in other MIB modules are applicable
        to an entity implementing the Transport Security Model. In particular,
        it is assumed that an entity implementing the Transport Security Model
        will implement the SNMP-FRAMEWORK-MIB <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>, the SNMP-TARGET-MIB <a class='info' href='#RFC3413'>[RFC3413]<span> (</span><span class='info'>Levi, D., Meyer, P., and B. Stewart, &ldquo;Simple Network Management Protocol (SNMP) Applications,&rdquo; December&nbsp;2002.</span><span>)</span></a>, the SNMP-VIEW-BASED-ACM-MIB <a class='info' href='#RFC3415'>[RFC3415]<span> (</span><span class='info'>Wijnen, B., Presuhn, R., and K. McCloghrie, &ldquo;View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>, and the SNMPv2-MIB <a class='info' href='#RFC3418'>[RFC3418]<span> (</span><span class='info'>Presuhn, R., &ldquo;Management Information Base (MIB) for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>. These are
         not needed to implement the SNMP-TSM-MIB.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.1"></a><h3>6.2.1.&nbsp;
MIB Modules Required for IMPORTS</h3>

<p>The following MIB module imports items from <a class='info' href='#RFC2578'>[RFC2578]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Structure of Management Information Version 2 (SMIv2),&rdquo; April&nbsp;1999.</span><span>)</span></a>,  <a class='info' href='#RFC2579'>[RFC2579]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Textual Conventions for SMIv2,&rdquo; April&nbsp;1999.</span><span>)</span></a>,   and <a class='info' href='#RFC2580'>[RFC2580]<span> (</span><span class='info'>McCloghrie, K., Perkins, D., and J. Schoenwaelder, &ldquo;Conformance Statements for SMIv2,&rdquo; April&nbsp;1999.</span><span>)</span></a>.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
MIB module definition</h3>

<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SNMP-TSM-MIB DEFINITIONS ::= BEGIN

IMPORTS
    MODULE-IDENTITY, OBJECT-TYPE,
    mib-2, Counter32
      FROM SNMPv2-SMI
    MODULE-COMPLIANCE, OBJECT-GROUP
      FROM SNMPv2-CONF
    TruthValue
       FROM SNMPv2-TC
    ;

snmpTsmMIB MODULE-IDENTITY
    LAST-UPDATED "200903090000Z"
    ORGANIZATION "ISMS Working Group"
    CONTACT-INFO "WG-EMail:   isms@lists.ietf.org
                  Subscribe:  isms-request@lists.ietf.org

                  Chairs:
                    Juergen Quittek
                    NEC Europe Ltd.
                    Network Laboratories
                    Kurfuersten-Anlage 36
                    69115 Heidelberg
                    Germany
                    +49 6221 90511-15
                    quittek@netlab.nec.de

                    Juergen Schoenwaelder
                    Jacobs University Bremen
                    Campus Ring 1
                    28725 Bremen
                    Germany
                    +49 421 200-3587
                    j.schoenwaelder@iu-bremen.de

                  Editor:
                    David Harrington
                    Huawei Technologies USA
                    1700 Alma Dr.
                    Plano TX 75075
                    USA
                    +1 603-436-8634
                    ietfdbh@comcast.net

	            Wes Hardaker
	            Sparta, Inc.
	            P.O. Box 382
	            Davis, CA  95617
	            USA
	            +1 530 792 1913
	            ietf@hardakers.net
                 "
    DESCRIPTION "The Transport Security Model MIB

                 In keeping with the RFC 3411 design decisions
                 to use self-contained documents, the RFC which
                 contains the definition of this MIB module also
                 includes the elements of procedure which are
                 needed for processing the Transport Security
                 Model for SNMP. These MIB objects
                 SHOULD NOT be modified via other subsystems
                 or models defined in other document..
                 This allows the Transport Security Model
                 for SNMP to be designed and documented as
                 independent and self- contained, having no
                 direct impact on other modules, and this
                 allows this module to be upgraded and
                 supplemented as the need arises, and to
                 move along the standards track on different
                 time-lines from other modules.

   Copyright (c) 2009 IETF Trust and the persons identified as
    authors of the MIB module. All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions
    are met:
    - Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
    - Redistributions in binary form must reproduce the above
      copyright notice, this list of conditions and the following
      disclaimer in the documentation and/or other materials provided
      with the distribution.
    - Neither the name of Internet Society, IETF or IETF Trust, nor the
      names of specific contributors, may be used to endorse or promote
      products derived from this software without specific prior written
      permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND
    CONTRIBUTORS 'AS IS' AND ANY EXPRESS OR IMPLIED WARRANTIES,
    INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
    MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
    DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
    CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
    USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
    AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
    LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
    ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
    POSSIBILITY OF SUCH DAMAGE.

    This version of this MIB module is part of RFC XXXX;
    see the RFC itself for full legal notices.
-- NOTE to RFC editor: replace XXXX with actual RFC number
--                     for this document and remove this note
                "

    REVISION    "200903090000Z"
    DESCRIPTION "The initial version, published in RFC XXXX.
-- NOTE to RFC editor: replace XXXX with actual RFC number
--                     for this document and remove this note
                "

    ::= { mib-2 xxxx }
-- RFC Ed.: replace xxxx with IANA-assigned number and
--          remove this note

-- ---------------------------------------------------------- --
-- subtrees in the SNMP-TSM-MIB
-- ---------------------------------------------------------- --

snmpTsmNotifications OBJECT IDENTIFIER ::= { snmpTsmMIB 0 }
snmpTsmMIBObjects    OBJECT IDENTIFIER ::= { snmpTsmMIB 1 }
snmpTsmConformance   OBJECT IDENTIFIER ::= { snmpTsmMIB 2 }

-- -------------------------------------------------------------
-- Objects
-- -------------------------------------------------------------

-- Statistics for the Transport Security Model


snmpTsmStats         OBJECT IDENTIFIER ::= { snmpTsmMIBObjects 1 }

snmpTsmInvalidCaches OBJECT-TYPE
    SYNTAX       Counter32
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The number of incoming messages dropped because the
                 tmStateReference referred to an invalid cache.
                "
    ::= { snmpTsmStats 1 }

snmpTsmInadequateSecurityLevels OBJECT-TYPE
    SYNTAX       Counter32
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The number of incoming messages dropped because
                 the securityLevel asserted by the transport model was
                 less than the securityLevel requested by the
                 application.
                "
    ::= { snmpTsmStats 2 }

snmpTsmUnknownPrefixes OBJECT-TYPE
    SYNTAX       Counter32
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The number of messages dropped because
                 snmpTsmConfigurationUsePrefix was set to true and
                 there is no known prefix for the specified transport
                 domain.
                "
    ::= { snmpTsmStats 3 }

snmpTsmInvalidPrefixes OBJECT-TYPE
    SYNTAX       Counter32
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The number of messages dropped because
                 the securityName associated with an outgoing message
                 did not contain a valid transport domain prefix.
                "
    ::= { snmpTsmStats 4 }

-- -------------------------------------------------------------
-- Configuration
-- -------------------------------------------------------------

-- Configuration for the Transport Security Model


snmpTsmConfiguration   OBJECT IDENTIFIER ::= { snmpTsmMIBObjects 2 }

snmpTsmConfigurationUsePrefix OBJECT-TYPE
    SYNTAX      TruthValue
    MAX-ACCESS  read-write
    STATUS      current
    DESCRIPTION "If this object is set to true then securityNames
                 passing to and from the application are expected to
                 contain a transport domain specific prefix. If this
                 object is set to true then a domain specific prefix
                 will be added by the TSM to the securityName for
                 incoming messages and removed from the securityName
                 when processing outgoing messages. Transport domains
                 and prefixes are maintained in a registry by IANA.
                 This object SHOULD persist across system reboots.
                "
    DEFVAL { false }
    ::= { snmpTsmConfiguration 1 }

-- -------------------------------------------------------------
-- snmpTsmMIB - Conformance Information
-- -------------------------------------------------------------

snmpTsmCompliances OBJECT IDENTIFIER ::= { snmpTsmConformance 1 }

snmpTsmGroups      OBJECT IDENTIFIER ::= { snmpTsmConformance 2 }

-- -------------------------------------------------------------
-- Compliance statements
-- -------------------------------------------------------------

snmpTsmCompliance MODULE-COMPLIANCE
    STATUS      current
    DESCRIPTION "The compliance statement for SNMP engines that support
                 the SNMP-TSM-MIB
                "
    MODULE
        MANDATORY-GROUPS { snmpTsmGroup }
    ::= { snmpTsmCompliances 1 }

-- -------------------------------------------------------------
-- Units of conformance
-- -------------------------------------------------------------
snmpTsmGroup OBJECT-GROUP
    OBJECTS {
        snmpTsmInvalidCaches,
        snmpTsmInadequateSecurityLevels,
        snmpTsmUnknownPrefixes,
        snmpTsmInvalidPrefixes,
        snmpTsmConfigurationUsePrefix
    }
    STATUS      current
    DESCRIPTION "A collection of objects for maintaining
                 information of an SNMP engine which implements
                 the SNMP Transport Security Model.
                "

    ::= { snmpTsmGroups 2 }


END

</pre></div>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>This document describes a Security Model, compatible with
      the RFC3411 architecture, that permits SNMP to utilize
      security services provided through an SNMP Transport Model. The
      Transport Security Model relies on Transport Models for mutual
      authentication, binding of keys, confidentiality and integrity. 
</p>
<p>The Transport Security Model relies on secure Transport Models to
      provide an authenticated principal identifier and an assertion of 
      whether authentication and privacy are used during transport. This 
      Security Model SHOULD always be used with Transport
      Models that provide adequate security, but "adequate security" is a 
      configuration and/or 
      run-time decision of the operator or management application. The security 
      threats and how these threats are mitigated
      should be covered in detail in the specifications of the
      Transport Models and the underlying secure transports.
</p>
<p>An authenticated principal identifier (securityName) is used in SNMP 
      applications, for purposes such as access control, notification 
      generation, and proxy forwarding. This security model supports multiple transport models. 
      Operators might judge some transports to be more secure than others, 
      so this security model can be configured to prepend a prefix to 
      the securityName to indicate the transport model used to authenticate the
      principal. Operators can use the prefixed securityName when making 
      application decisions about levels of access.
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
MIB module security</h3>

<p>There are a number of management objects defined in this MIB module
      with a MAX-ACCESS clause of read-write and/or read-create. Such objects
      may be considered sensitive or vulnerable in some network environments.
      The support for SET operations in a non-secure environment without
      proper protection can have a negative effect on network operations.
      These are the tables and objects and their
      sensitivity/vulnerability:
</p>
<p></p>
<ul class="text">
<li>The snmpTsmConfigurationUsePrefix object could be
          modified, creating a denial of service or authorizing
          SNMP messages that would not have previously been authorized
          by an Access Control Model (e.g. the VACM).
</li>
</ul>

<p>Some of the readable objects in this MIB module (i.e., objects with
        a MAX-ACCESS other than not-accessible) may be considered sensitive or
        vulnerable in some network environments. It is thus important to
        control even GET and/or NOTIFY access to these objects and possibly to
        even encrypt the values of these objects when sending them over the
        network via SNMP. These are the tables and objects and their
        sensitivity/vulnerability: </p>
<ul class="text">
<li>All the counters in this module refer to configuration errors and do not expose sensitive information.
</li>
</ul>

<p>SNMP versions prior to SNMPv3 did not include adequate security.
        Even if the network itself is secure (for example by using IPsec),
        even then, there is no control as to who on the secure network is
        allowed to access and GET/SET (read/change/create/delete) the objects
        in this MIB module.
</p>
<p>It is RECOMMENDED that implementers consider the security features
        as provided by the SNMPv3 framework (see <a class='info' href='#RFC3410'>[RFC3410]<span> (</span><span class='info'>Case, J., Mundy, R., Partain, D., and B. Stewart, &ldquo;Introduction and Applicability Statements for Internet-Standard Management Framework,&rdquo; December&nbsp;2002.</span><span>)</span></a> section 8), including full support for the
        USM and Transport Security Model cryptographic mechanisms (for
        authentication and privacy).
</p>
<p>Further, deployment of SNMP versions prior to SNMPv3 is NOT
        RECOMMENDED. Instead, it is RECOMMENDED to deploy SNMPv3 and to enable
        cryptographic security. It is then a customer/operator responsibility
        to ensure that the SNMP entity giving access to an instance of this
        MIB module is properly configured to give access to the objects only
        to those principals (users) that have legitimate rights to indeed GET
        or SET (change/create/delete) them.
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>IANA is requested to assign: </p>
<ol class="text">
<li>an SMI number with a prefix of mib-2, in the MIB module registry under http://www.iana.org/assignments/smi-numbers, for the MIB module in this
          document,
</li>
<li>a value, preferably 4, to identify the Transport Security Model,
          in the Security Models registry at
          http://www.iana.org/assignments/snmp-number-spaces. This should
          result in the following table of values:
</li>
</ol>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>Value   Description                         References
-----   -----------                         ----------
  0     reserved for 'any'                  [RFC3411]
  1     reserved for SNMPv1                 [RFC3411]
  2     reserved for SNMPv2c                [RFC3411]
  3     User-Based Security Model (USM)     [RFC3411]
  YY    Transport Security Model (TSM)      [RFCXXXX]

-- NOTE to RFC editor: replace XXXX with actual RFC number
--                     for this document and remove this note
-- NOTE to RFC editor: replace YY with actual IANA-assigned number,
                       throughout this document and remove this note.
</pre></div>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgements</h3>

<p>The editors would like to thank Jeffrey Hutzelman for sharing his SSH
      insights, and Dave Shield for an outstanding job wordsmithing
      the existing document to improve organization and clarity.
</p>
<p>Additionally, helpful document reviews were received from:
      Juergen Schoenwaelder.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2578">[RFC2578]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K., Ed.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D., Ed.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder, Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2578">Structure of Management Information Version 2 (SMIv2)</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2578, April&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2578.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2579">[RFC2579]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K., Ed.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D., Ed.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder, Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2579">Textual Conventions for SMIv2</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2579, April&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2579.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2580">[RFC2580]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2580">Conformance Statements for SMIv2</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2580, April&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2580.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3411">[RFC3411]</a></td>
<td class="author-text">Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;<a href="http://tools.ietf.org/html/rfc3411">An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3411, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3411.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3412">[RFC3412]</a></td>
<td class="author-text">Case, J., Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;<a href="http://tools.ietf.org/html/rfc3412">Message Processing and Dispatching for the Simple Network Management Protocol (SNMP)</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3412, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3412.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3413">[RFC3413]</a></td>
<td class="author-text">Levi, D., Meyer, P., and B. Stewart, &ldquo;<a href="http://tools.ietf.org/html/rfc3413">Simple Network Management Protocol (SNMP) Applications</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3413, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3413.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3414">[RFC3414]</a></td>
<td class="author-text">Blumenthal, U. and B. Wijnen, &ldquo;<a href="http://tools.ietf.org/html/rfc3414">User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3)</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3414, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3414.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-isms-tmsm">[I-D.ietf-isms-tmsm]</a></td>
<td class="author-text">Harrington, D. and J. Schoenwaelder, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-isms-tmsm-18.txt">Transport Subsystem for the Simple Network Management Protocol (SNMP)</a>,&rdquo; draft-ietf-isms-tmsm-18 (work in progress), May&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-isms-tmsm-18.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3410">[RFC3410]</a></td>
<td class="author-text">Case, J., Mundy, R., Partain, D., and B. Stewart, &ldquo;<a href="http://tools.ietf.org/html/rfc3410">Introduction and Applicability Statements for Internet-Standard Management Framework</a>,&rdquo; RFC&nbsp;3410, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3410.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3415">[RFC3415]</a></td>
<td class="author-text">Wijnen, B., Presuhn, R., and K. McCloghrie, &ldquo;<a href="http://tools.ietf.org/html/rfc3415">View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP)</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3415, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3415.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3418">[RFC3418]</a></td>
<td class="author-text">Presuhn, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3418">Management Information Base (MIB) for the Simple Network Management Protocol (SNMP)</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3418, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3418.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3584">[RFC3584]</a></td>
<td class="author-text">Frye, R., Levi, D., Routhier, S., and B. Wijnen, &ldquo;<a href="http://tools.ietf.org/html/rfc3584">Coexistence between Version 1, Version 2, and Version 3 of the Internet-standard Network Management Framework</a>,&rdquo; BCP&nbsp;74, RFC&nbsp;3584, August&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3584.txt">TXT</a>).</td></tr>
</table>

<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Notification Tables Configuration</h3>

<p>The SNMP-TARGET-MIB and SNMP-NOTIFICATION-MIB <a class='info' href='#RFC3413'>[RFC3413]<span> (</span><span class='info'>Levi, D., Meyer, P., and B. Stewart, &ldquo;Simple Network Management Protocol (SNMP) Applications,&rdquo; December&nbsp;2002.</span><span>)</span></a> are used to configure notification originators
      with the destinations to which notifications should be sent.
</p>
<p>Most of the configuration is security-model-independent and
      transport-model-independent.
</p>
<p>The values we will use in the examples for the five model-independent
      security and transport parameters are: </p>
<blockquote class="text">
<p>transportDomain = snmpSSHDomain
</p>
<p>transportAddress = 192.0.2.1:PPP
</p>
<p>securityModel = Transport Security Model
</p>
<p>securityName = alice
</p>
<p>securityLevel = authPriv
</p>
</blockquote>

<p>[-- NOTE to RFC editor: replace PPP above with actual
        IANA-assigned port number for SNMP notifications over SSH, 
        from draft-ietf-isms-secshell, and remove this note. ]
</p>
<p>The following example will configure the Notification
      Originator to send informs to a Notification Receiver at
      192.0.2.1:PPP using the securityName "alice". "alice" is the
      name for the recipient from the standpoint of the notification
      originator, and is used for processing access controls before
      sending a notification.
</p>
<p>[-- NOTE to RFC editor: replace PPP above with actual
        IANA-assigned port number for SNMP notifications over SSH, and
        remove this note. ]
</p>
<p>The columns marked with a "*" are the
      items that are Security Model or Transport Model specific.
</p>
<p>The configuration for the "alice" settings in the
      SNMP-VIEW-BASED-ACM-MIB objects are not shown here for brevity. First we
      configure which type of notification should be sent for this taglist
      (toCRTag). In this example, we choose to send an Inform.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>  snmpNotifyTable row:
       snmpNotifyName                 CRNotif
       snmpNotifyTag                  toCRTag
       snmpNotifyType                 inform
       snmpNotifyStorageType          nonVolatile
       snmpNotifyColumnStatus         createAndGo</pre></div>
<p>Then we configure a transport address to which notifications
      associated with this taglist should be sent, and we specify which
      snmpTargetParamsEntry should be used (toCR) when sending to this
      transport address.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>       snmpTargetAddrTable row:
          snmpTargetAddrName              toCRAddr
      *   snmpTargetAddrTDomain           snmpSSHDomain
      *   snmpTargetAddrTAddress          192.0.2.1:PPP
          snmpTargetAddrTimeout           1500
          snmpTargetAddrRetryCount        3
          snmpTargetAddrTagList           toCRTag
          snmpTargetAddrParams            toCR   (must match below)
          snmpTargetAddrStorageType       nonVolatile
          snmpTargetAddrColumnStatus      createAndGo

</pre></div>
<p>[-- NOTE to RFC editor: replace PPP above with actual
        IANA-assigned port number for SNMP notifications over SSH, and
        remove this note. ]
</p>
<p>Then we configure which principal at the host should receive the
      notifications associated with this taglist. Here we choose "alice",
      who uses the Transport Security Model.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>      snmpTargetParamsTable row:
          snmpTargetParamsName            toCR
          snmpTargetParamsMPModel         SNMPv3
      *   snmpTargetParamsSecurityModel   TransportSecurityModel
          snmpTargetParamsSecurityName    "alice"
          snmpTargetParamsSecurityLevel   authPriv
          snmpTargetParamsStorageType     nonVolatile
          snmpTargetParamsRowStatus       createAndGo

</pre></div>
<p>
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Transport Security Model Processing for Notifications</h3>

<p>The Transport Security Model is called using the
        generateRequestMsg() ASI, with the following parameters (* are from
        the above tables):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  statusInformation =                -- success or errorIndication
        generateRequestMsg(
        IN   messageProcessingModel  -- *snmpTargetParamsMPModel
        IN   globalData              -- message header, admin data
        IN   maxMessageSize          -- of the sending SNMP entity
        IN   transportDomain         -- *snmpTargetAddrTDomain
        IN   transportAddress        -- *snmpTargetAddrTAddress
        IN   securityModel           -- *snmpTargetParamsSecurityModel
        IN   securityEngineID        -- immaterial; TSM will ignore.
        IN   securityName            -- snmpTargetParamsSecurityName
        IN   securityLevel           -- *snmpTargetParamsSecurityLevel
        IN   scopedPDU               -- message (plaintext) payload
        OUT  securityParameters      -- filled in by Security Module
        OUT  wholeMsg                -- complete generated message
        OUT  wholeMsgLength          -- length of generated message
        OUT  tmStateReference        -- reference to transport info
             )
</pre></div>
<p>The Transport Security Model will determine the Transport Model
        based on the snmpTargetAddrTDomain. The selected Transport Model will
        select the appropriate transport connection using the tmStateReference cache 
        created from the values of snmpTargetAddrTAddress, 
        snmpTargetParamsSecurityName, and
        snmpTargetParamsSecurityLevel.
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Processing Differences between USM and Secure Transport</h3>

<p>USM and secure transports differ in the processing order and
      responsibilities within the RFC3411 architecture. While the steps are
      the same, they occur in a different order, and may be done by different
      subsystems. The following lists illustrate the difference in the flow
      and the responsibility for different processing steps for incoming
      messages when using USM and when using a secure transport. (These lists are simplified for illustrative purposes, and do not
      represent all details of processing. Transport Models must provide the
      detailed elements of procedure.)
</p>
<p>With USM, SNMPv1, and SNMPv2c Security Models, security processing starts when
      the Message Processing Model decodes portions of the ASN.1 message to
      extract header fields that are used to determine which Security Model should process 
      the message to perform
      authentication, decryption, timeliness checking, integrity checking, and
      translation of parameters to model-independent parameters. By comparison, a secure
      transport performs those security functions on the message, before the
      ASN.1 is decoded.
</p>
<p>Step 6 cannot occur until after decryption occurs. Step 6 and beyond
      are the same for USM and a secure transport.
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
USM and the RFC3411 Architecture</h3>

<p></p>
<blockquote class="text"><dl>
<dt>1)</dt>
<dd>decode the ASN.1 header (Message Processing
            Model)
</dd>
<dt>2)</dt>
<dd>determine the SNMP Security Model and parameters
            (Message Processing Model)
</dd>
<dt>3)</dt>
<dd>verify securityLevel. [Security Model]
</dd>
<dt>4)</dt>
<dd>translate parameters to model-independent
            parameters (Security Model)
</dd>
<dt>5)</dt>
<dd>authenticate the principal, check message
            integrity and timeliness, and decrypt the message. [Security
            Model]
</dd>
<dt>6)</dt>
<dd>determine the pduType in the decrypted portions
            (Message Processing Model), and
</dd>
<dt>7)</dt>
<dd>pass on the decrypted portions with
            model-independent parameters.
</dd>
</dl></blockquote>

<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2"></a><h3>B.2.&nbsp;
Transport Subsystem and the RFC3411 Architecture</h3>

<p></p>
<blockquote class="text"><dl>
<dt>1)</dt>
<dd>authenticate the principal, check integrity and
            timeliness of the message, and decrypt the message. [Transport
            Model]
</dd>
<dt>2)</dt>
<dd>translate parameters to model-independent
            parameters (Transport Model)
</dd>
<dt>3)</dt>
<dd>decode the ASN.1 header (Message Processing
            Model)
</dd>
<dt>4)</dt>
<dd>determine the SNMP Security Model and parameters
            (Message Processing Model)
</dd>
<dt>5)</dt>
<dd>verify securityLevel [Security Model]
</dd>
<dt>6)</dt>
<dd>determine the pduType in the decrypted portions
            (Message Processing Model), and
</dd>
<dt>7)</dt>
<dd>pass on the decrypted portions with
            model-independent security parameters
</dd>
</dl></blockquote>

<p>If a message is secured using a secure transport layer, then the
        Transport Model should provide the translation from the authenticated
        identity (e.g., an SSH user name) to a human-friendly identifier (tmSecurityName) in step 2.
        The security model will provide a mapping from that identifier to a model-independent
        securityName.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David Harrington</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei Technologies (USA)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1700 Alma Dr. Suite 100</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Plano, TX 75075</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 603 436 8634</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:dharrington@huawei.com">dharrington@huawei.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Wes Hardaker</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sparta, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P.O. Box 382</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Davis, CA  95617</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 530 792 1913</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:ietf@hardakers.net">ietf@hardakers.net</a></td></tr>
</table>
</body></html>
