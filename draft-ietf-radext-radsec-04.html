<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>TLS encryption for RADIUS over TCP (RadSec)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="TLS encryption for RADIUS over TCP (RadSec)">
<meta name="keywords" content="RADIUS, AAA, Security, Reliability">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">RADIUS Extensions Working Group</td><td class="header">S. Winter</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">RESTENA</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">M. McCauley</td></tr>
<tr><td class="header">Expires: September 7, 2009</td><td class="header">OSC</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Venaas</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">UNINETT</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">K. Wierenga</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 06, 2009</td></tr>
</table></td></tr></table>
<h1><br />TLS encryption for RADIUS over TCP (RadSec)<br />draft-ietf-radext-radsec-04</h1>

<h3>Status of This Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 7, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document specifies security on the transport layer (TLS) for the RADIUS protocol <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> when transmitted over TCP <a class='info' href='#I-D.dekok-radext-tcp-transport'>[I&#8209;D.dekok&#8209;radext&#8209;tcp&#8209;transport]<span> (</span><span class='info'>DeKok, A., &ldquo;RADIUS Over TCP,&rdquo; November&nbsp;2008.</span><span>)</span></a>. This enables dynamic trust relationships between RADIUS servers.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#reqlang">1.1.</a>&nbsp;
Requirements Language<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#terms">1.2.</a>&nbsp;
Terminology<br />
<a href="#TLS">2.</a>&nbsp;
Normative: Transport Layer Security for RADIUS over TCP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ports">2.1.</a>&nbsp;
TCP port and packet types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#conn-setup">2.2.</a>&nbsp;
Connection Setup<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">2.3.</a>&nbsp;
RADIUS Datagrams<br />
<a href="#design">3.</a>&nbsp;
Informative: Design Decisions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#design-cert">3.1.</a>&nbsp;
X.509 Certificate Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#design-cipher">3.2.</a>&nbsp;
Ciphersuites and Compression Negotiation Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#design-radius">3.3.</a>&nbsp;
RADIUS Datagram Considerations<br />
<a href="#radius-compat">4.</a>&nbsp;
Compatibility with other RADIUS transports<br />
<a href="#compat">5.</a>&nbsp;
Diameter Compatibility<br />
<a href="#security">6.</a>&nbsp;
Security Considerations<br />
<a href="#iana">7.</a>&nbsp;
IANA Considerations<br />
<a href="#acks">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#radiator">Appendix&nbsp;A.</a>&nbsp;
Implementation Overview: Radiator<br />
<a href="#radsecproxy">Appendix&nbsp;B.</a>&nbsp;
Implementation Overview: radsecproxy<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The RADIUS protocol <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> is a widely deployed authentication and authorisation protocol. The supplementary RADIUS Accounting specification <a class='info' href='#RFC2866'>[RFC2866]<span> (</span><span class='info'>Rigney, C., &ldquo;RADIUS Accounting,&rdquo; June&nbsp;2000.</span><span>)</span></a> also provides accounting mechanisms, thus delivering a full AAA solution. However, RADIUS is experiencing several shortcomings, such as its dependency on the unreliable transport protocol UDP and the lack of security for large parts of its packet payload. RADIUS security is based on the MD5 algorithm, which has been proven to be insecure.
</p>
<p>The main focus of RadSec is to provide a means to secure the communication between RADIUS/TCP peers on the transport layer. The most important use of RadSec lies in roaming environments where RADIUS packets need to be transferred through different administrative domains and untrusted, potentially hostile networks. An example for a world-wide roaming environment that uses RadSec to secure communication is "eduroam", see <a class='info' href='#eduroam'>[eduroam]<span> (</span><span class='info'>Trans-European Research and Education Networking Association, &ldquo;eduroam Homepage,&rdquo; 2007.</span><span>)</span></a>.
</p>
<p>There are multiple known attacks on the MD5 algorithm which is used in RADIUS to provide integrity protection and a limited confidentiality protection. RadSec wraps the entire RADIUS packet payload into a TLS stream and thus mitigates the risk of attacks on MD5.
</p>
<p>Because of the static trust establishment between RADIUS peers (IP address and shared secret) the only scalable way of creating a massive deployment of RADIUS-servers under control by different administrative entities is to introduce some form of a proxy chain to route the access requests to their home server. This creates a lot of overhead in terms of possible points of failure, longer transmission times as well as middleboxes through which authentication traffic flows. These middleboxes may learn privacy-relevant data while forwarding requests. The new features in RadSec obsolete the use of IP addresses and shared MD5 secrets to identify other peers and thus allow the dynamic establishment of connections to peers that are not previously configured, and thus makes it possible to avoid intermediate aggregation proxies. One mechanism discover RadSec peers with DNS is specified in <a class='info' href='#I-D.winter-dynamic-discovery'>[I&#8209;D.winter&#8209;dynamic&#8209;discovery]<span> (</span><span class='info'>Winter, S. and M. McCauley, &ldquo;NAI-based Dynamic Peer Discovery for RADIUS over TLS and DTLS,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="reqlang"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Language</h3>

<p>In this document, several words are used to signify the requirements of the specification.  The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119. <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>
</p>
<a name="terms"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Terminology</h3>

<p>RadSec node: a RadSec client or server
</p>
<p>RadSec Client: a RadSec instance which initiates a new connection.
</p>
<p>RadSec Server: a RadSec instance which listens on a RadSec port and accepts new connections
</p>
<a name="TLS"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Normative: Transport Layer Security for RADIUS over TCP</h3>

<a name="ports"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
TCP port and packet types</h3>

<p>The default destination port number for RadSec is TCP/2083. There are no separate ports for authentication, accounting and dynamic authorisation changes. The source port is arbitrary.
</p>
<a name="conn-setup"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Connection Setup</h3>

<p>RadSec nodes
			</p>
<ol class="text">
<li>establish TCP connections as per <a class='info' href='#I-D.dekok-radext-tcp-transport'>[I&#8209;D.dekok&#8209;radext&#8209;tcp&#8209;transport]<span> (</span><span class='info'>DeKok, A., &ldquo;RADIUS Over TCP,&rdquo; November&nbsp;2008.</span><span>)</span></a>
</li>
<li>negotiate TLS sessions according to <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> or its predecessor TLS 1.1. The following restrictions apply:
					
<ul class="text">
<li>
							The authentication MUST be mutual, i.e. both the RadSec server and the RadSec client authenticate each other.
						
</li>
<li>
							The client MUST NOT negotiate cipher suites which only provide integrity protection.
						
</li>
<li>
							The TLS session MAY use mutual PSKs for connection setup.
						
</li>
<li>
							RADSEC implementations MUST support he mandatory to implement cipher suites specified in TLS.  For purposes of compatibility with some current deployments implementations SHOULD support TLS_RSA_WITH_RC4_128_SHA as well (see <a class='info' href='#design-cipher'>Section&nbsp;3.2<span> (</span><span class='info'>Ciphersuites and Compression Negotiation Considerations</span><span>)</span></a> (1) ).
						
</li>
</ul>
				
</li>
<li>
					If TLS is used in an X.509 certificate based operation mode, the following list of certificate validation options applies: 
<ul class="text">
<li>
							Implementations MUST allow to configure a list of acceptable Certification Authorities for incoming connections.
						
</li>
<li>
							Certificate validation MUST include the verification rules as per <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>. If service names as per <a class='info' href='#RFC4985'>[RFC4985]<span> (</span><span class='info'>Santesson, S., &ldquo;Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name,&rdquo; August&nbsp;2007.</span><span>)</span></a> are present in the certificate and dynamic discovery utilizing SRVs in DNS is used (see <a class='info' href='#I-D.winter-dynamic-discovery'>[I&#8209;D.winter&#8209;dynamic&#8209;discovery]<span> (</span><span class='info'>Winter, S. and M. McCauley, &ldquo;NAI-based Dynamic Peer Discovery for RADIUS over TLS and DTLS,&rdquo; February&nbsp;2009.</span><span>)</span></a>), the SRV entry SHOULD be validated.
						
</li>
<li>
							Implementations SHOULD indicate their acceptable Certification Authorities as per section 7.4.4 (server side) and x.y.z ["Trusted CA Indication"] (client side) of <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>  (see <a class='info' href='#design-cert'>Section&nbsp;3.1<span> (</span><span class='info'>X.509 Certificate Considerations</span><span>)</span></a> (1) )
						
</li>
<li>
							Implementations SHOULD allow to configure a list of acceptable certificates, identified via certificate fingerprint. When a fingerprint configured, the fingerprint is prepended with an   ASCII label identifying the hash function followed by a colon. Implementations MUST support SHA-1 as the hash algorithm and use the ASCII label "sha-1" to identify the SHA-1 algorithm.  The length of a SHA-1 hash is 20 bytes and the length of the corresponding fingerprint string is 65 characters.  An example certificate fingerprint is:     sha-1:E1:2D:53:2B:7C:6B:8A:29:A2:76:C8:64:36:0B:08:4B:7A:F1:9E:9D
						
</li>
<li>
							Peer validation always includes a check on whether the DNS name or the IP address of the server that is contacted matches its certificate. DNS names and IP addresses can be contained in the Common Name (CN) or subjectAltName entries. For verification, only one these entries is to be considered. The following precedence applies: for DNS name validation, subjectAltName:DNS has precedence over CN; for IP address validation, subjectAltName:iPAddr has precedence over CN.
						
</li>
<li>
							Implementations SHOULD allow to configure a set of acceptable values for subjectAltName:URI.
						
</li>
</ul>
				
</li>
<li>
					start exchanging RADIUS datagrams. Note <a class='info' href='#design-radius'>Section&nbsp;3.3<span> (</span><span class='info'>RADIUS Datagram Considerations</span><span>)</span></a> (1) ). The shared secret to compute the (obsolete) MD5 integrity checks and attribute encryption MUST be "radsec" (see <a class='info' href='#design-radius'>Section&nbsp;3.3<span> (</span><span class='info'>RADIUS Datagram Considerations</span><span>)</span></a> (2) ).
				
</li>
</ol><p>
		
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
RADIUS Datagrams</h3>

<p>Authentication, Accounting and Authorization packets are sent according to the following rules:
</p>
<p>RadSec clients handle the following packet types from <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>, <a class='info' href='#RFC2866'>[RFC2866]<span> (</span><span class='info'>Rigney, C., &ldquo;RADIUS Accounting,&rdquo; June&nbsp;2000.</span><span>)</span></a>, <a class='info' href='#RFC5176'>[RFC5176]<span> (</span><span class='info'>Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B. Aboba, &ldquo;Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS),&rdquo; January&nbsp;2008.</span><span>)</span></a> on the connection they initiated (see <a class='info' href='#design-radius'>Section&nbsp;3.3<span> (</span><span class='info'>RADIUS Datagram Considerations</span><span>)</span></a> (3) and (4) ):
			</p>
<ul class="text">
<li>send Access-Request
</li>
<li>send Accounting-Request
</li>
<li>send Status-Server
</li>
<li>send Disconnect-ACK
</li>
<li>send Disconnect-NAK
</li>
<li>send CoA-ACK
</li>
<li>send CoA-NAK
</li>
<li>receive Access-Challenge
</li>
<li>receive Access-Accept
</li>
<li>receive Access-Reject
</li>
<li>receive Accounting-Response
</li>
<li>receive Disconnect-Request
</li>
<li>receive CoA-Request
</li>
</ul>

<p>RadSec servers handle the following packet types from <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>, <a class='info' href='#RFC2866'>[RFC2866]<span> (</span><span class='info'>Rigney, C., &ldquo;RADIUS Accounting,&rdquo; June&nbsp;2000.</span><span>)</span></a>, <a class='info' href='#RFC5176'>[RFC5176]<span> (</span><span class='info'>Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B. Aboba, &ldquo;Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS),&rdquo; January&nbsp;2008.</span><span>)</span></a> on the connections they serve to clients:
			</p>
<ul class="text">
<li>receive Access-Request
</li>
<li>receive Accounting-Request
</li>
<li>receive Status-Server
</li>
<li>receive Disconnect-ACK
</li>
<li>receive Disconnect-NAK
</li>
<li>receive CoA-ACK
</li>
<li>receive CoA-NAK
</li>
<li>send Access-Challenge
</li>
<li>send Access-Accept
</li>
<li>send Access-Reject
</li>
<li>send Accounting-Response
</li>
<li>send Disconnect-Request
</li>
<li>send CoA-Request
</li>
</ul>

<a name="design"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Informative: Design Decisions</h3>

<p>This section explains the design decisions that led to the rules defined in the previous section.
</p>
<a name="design-cert"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
X.509 Certificate Considerations</h3>

<p>
				(1) If a RadSec client is in possession of multiple certificates from different CAs (i.e. is part of multiple roaming consortia) and dynamic discovery is used, the discovery mechanism possibly does not yield sufficient information to identify the consortium uniquely (e.g. DNS discovery). Subsequently, the client may not know by itself which client certificate to use for the TLS handshake. Then it is necessary for the server to signal which consortium it belongs to, and which certificates it expects. If there is no risk of confusing multiple roaming consortia, providing this information in the handshake is not crucial.
			
</p>
<p>
				(2) If a RadSec server is in possession of multiple certificates from different CAs (i.e. is part of multiple roaming consortia), it will need to select one of its certificates to present to the RadSec client. If the client sends the Trusted CA Indication, this hint can make the server select the appropriate certificate and prevent a handshake failure. Omitting this indication makes it impossible to deterministically select the right certificate in this case. If there is no risk of confusing multiple roaming consortia, providing this indication in the handshake is not crucial.
			
</p>
<p>
				(4) If dynamic peer discovery as per <a class='info' href='#I-D.winter-dynamic-discovery'>[I&#8209;D.winter&#8209;dynamic&#8209;discovery]<span> (</span><span class='info'>Winter, S. and M. McCauley, &ldquo;NAI-based Dynamic Peer Discovery for RADIUS over TLS and DTLS,&rdquo; February&nbsp;2009.</span><span>)</span></a> is used, peer authentication alone is not sufficient; the peer must also be authorised to perform user authentications. In these cases, the trust fabric cannot depend on peer authentication methods like DNSSEC to identify RadSec nodes. The RadSec nodes also need to be properly authorised. Typically, this can be achieved by adding appropriate authorisation fields into a X.509 certificate. Such fields include SRV authority (x.y.z... reference), subjectAltName:URI, or a defined list of certificate fingerprints. Operators of a RadSec infrastructure should define their own authorisation trust model and apply this model to the certificates. The checks enumerated in <a class='info' href='#conn-setup'>Section&nbsp;2.2<span> (</span><span class='info'>Connection Setup</span><span>)</span></a> provide sufficient flexibility for the implementation of authorisation trust models.
			
</p>
<a name="design-cipher"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Ciphersuites and Compression Negotiation Considerations</h3>

<p>RadSec implementations need not necessarily support all TLS ciphersuites listed in <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>. Not all TLS ciphersuites are supported by available TLS tool kits and licenses may be required in some cases. The existing implementations of RadSec use OpenSSL as cryptographic backend, which supports all of the ciphersuites listed in the rules in the normative section.
</p>
<p>The TLS ciphersuite TLS_RSA_WITH_3DES_EDE_CBC_SHA is mandatory-to-implement according to <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> and thus has to be supported by RadSec nodes.
</p>
<p>The two other ciphersuites in the normative section (TLS_RSA_WITH_RC4_128_SHA and TLS_RSA_WITH_AES_128_CBC_SHA) are widely implemented in TLS toolkits and are considered good practice to implement.
</p>
<p>TLS also supports compression. Compression is an optional feature. During the RadSec conversation the client and server may negotiate compression, but must continue the conversation even if the other peer rejects compression.
</p>
<a name="design-radius"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
RADIUS Datagram Considerations</h3>

<p>(1) After the TLS session is established, RADIUS packet payloads are exchanged over the encrypted TLS tunnel. In plain RADIUS, the packet size can be determined by evaluating the size of the datagram that arrived. Due to the stream nature of TCP and TLS, this does not hold true for RadSec packet exchange. Instead, packet boundaries of RADIUS packets that arrive in the stream are calculated by evaluating the packet's Length field. Special care needs to be taken on the packet sender side that the value of the Length field is indeed correct before sending it over the TLS tunnel, because incorrect packet lengths can no longer be detected by a differing datagram boundary.
</p>
<p>(2) Within RADIUS <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>, a shared secret is used for hiding of attributes such as User-Password, as well as in computation of the Response Authenticator.  In RADIUS accounting <a class='info' href='#RFC2866'>[RFC2866]<span> (</span><span class='info'>Rigney, C., &ldquo;RADIUS Accounting,&rdquo; June&nbsp;2000.</span><span>)</span></a>, the shared secret is used in computation of both the Request Authenticator and the Response Authenticator. Since TLS  provides integrity protection and encryption sufficient to substitute for RADIUS application-layer security, it is not necessary to configure a RADIUS shared secret. The use of a fixed string for the obsolete shared secret eliminates possible node misconfigurations.
</p>
<p>(3) RADIUS <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> uses different UDP ports for authentication, accounting and dynamic authorisation changes. RadSec allocates a single port for all RADIUS packet types. Nevertheless, in RadSec the notion of a client which sends authentication requests and processes replies associated with it's users' sessions and the notion of a server which receives requests, processes them and sends the appropriate replies is to be preserved. The normative rules about acceptable packet types for clients and servers mirror the packet flow behaviour from RADIUS.
</p>
<p>(4) RADIUS <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> used negative ICMP responses to a newly allocated UDP port to signal that a peer RADIUS server does not support reception and processing of the packet types in <a class='info' href='#RFC5176'>[RFC5176]<span> (</span><span class='info'>Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B. Aboba, &ldquo;Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS),&rdquo; January&nbsp;2008.</span><span>)</span></a>. These packet types are listed as to be received in RadSec implementations. Note well: it is not required for an implementation to actually process these packet types. It is sufficient that upon receiving such a packet, an unconditional NAK is sent back to indicate that the action is not supported.
</p>
<a name="radius-compat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Compatibility with other RADIUS transports</h3>

<p>
		    Ongoing work in the IETF defines multiple alternative transports to the classic UDP transport model as defined in <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>, namely RADIUS over TCP <a class='info' href='#I-D.dekok-radext-tcp-transport'>[I&#8209;D.dekok&#8209;radext&#8209;tcp&#8209;transport]<span> (</span><span class='info'>DeKok, A., &ldquo;RADIUS Over TCP,&rdquo; November&nbsp;2008.</span><span>)</span></a>, RADIUS over DTLS <a class='info' href='#I-D.dekok-radext-dtls'>[I&#8209;D.dekok&#8209;radext&#8209;dtls]<span> (</span><span class='info'>DeKok, A., &ldquo;DTLS as a Transport Layer for RADIUS,&rdquo; March&nbsp;2010.</span><span>)</span></a> and the present document on RadSec.
</p>
<p>
		    RadSec does not specify any inherent backwards compatibility to classic RADIUS or cross compatibility to the other transports, i.e. an implementation which implements RadSec only will not be able to receive or send RADIUS packet payloads over other transports. An implementation wishing to be backward or cross compatible (i.e. wishes to serve clients using other transports than RadSec) will need to implement the other transports and RadSec transport and be prepared to send and receive on all implemented transports, which is called a multi-stack implementation.
	    
</p>
<p>
		If a given IP device is able to receive RADIUS payloads on multiple transports, this may or may not be the same instance of software, and it may or may not serve the same purposes. It is not safe to assume that both ports are interchangeable. In particular, it can not be assumed that state is maintained for the packet payloads between the transports. Two such instances MUST be considered separate RADIUS server entities.
	    
</p>
<p>
		As a consequence, the selection of transports to communicate from a client to a server is a manual administrative action. An automatic fallback to classic RADIUS is NOT RECOMMENDED, as it may lead to down-bidding attacks on the peer communication.
	    
</p>
<a name="compat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Diameter Compatibility</h3>

<p>
		    Since RadSec is only a new transport profile for RADIUS, compatibility of RadSec - Diameter <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> vs. RADIUS <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> - Diameter <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is identical. The considerations regarding payload size in <a class='info' href='#I-D.dekok-radext-tcp-transport'>[I&#8209;D.dekok&#8209;radext&#8209;tcp&#8209;transport]<span> (</span><span class='info'>DeKok, A., &ldquo;RADIUS Over TCP,&rdquo; November&nbsp;2008.</span><span>)</span></a> apply.
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
		    The computational resources to establish a TLS tunnel are significantly higher than simply sending mostly unencrypted UDP datagrams. Therefore, clients connecting to a RadSec node will more easily create high load conditions and a malicious client might create a Denial-of-Service attack more easily.
</p>
<p>
		    In the case of dynamic peer discovery as per <a class='info' href='#I-D.winter-dynamic-discovery'>[I&#8209;D.winter&#8209;dynamic&#8209;discovery]<span> (</span><span class='info'>Winter, S. and M. McCauley, &ldquo;NAI-based Dynamic Peer Discovery for RADIUS over TLS and DTLS,&rdquo; February&nbsp;2009.</span><span>)</span></a>, a RadSec node needs to be able to accept connections from a large, not previously known, group of hosts, possibly the whole internet. In this case, the server's RadSec port can not be protected from unauthorised connection attempts with measures on the network layer, i.e. access lists and firewalls. This opens more attack vectors for Distributed Denial of Service attacks, just like any other service that is supposed to serve arbitrary clients (like for example web servers).
	    
</p>
<p>
		    In the case of dynamic peer discovery as per <a class='info' href='#I-D.winter-dynamic-discovery'>[I&#8209;D.winter&#8209;dynamic&#8209;discovery]<span> (</span><span class='info'>Winter, S. and M. McCauley, &ldquo;NAI-based Dynamic Peer Discovery for RADIUS over TLS and DTLS,&rdquo; February&nbsp;2009.</span><span>)</span></a>, X.509 certificates are the only proof of authorisation for a connecting RadSec nodes. Special care needs to be taken that certificates get verified properly according to the chosen trust model (particularly: consulting CRLs, checking critical extensions, checking subjectAltNames etc.) to prevent unauthorised connections.
	    
</p>
<p>
		    Some TLS ciphersuites only provide integrity validation of their payload, and provide no encryption. This specification forbids the use of such ciphersuites. Since the RADIUS payload's shared secret is fixed and well-known, failure to comply with this requirement will expose the entire datagram payload in plain text, including User-Password, to intermediate IP nodes.
	    
</p>
<p>
		    If peer communication between two devices is configured for both RadSec and classic RADIUS, a failover from RadSec to classic RADIUS opens the way for a down-bidding attack if an adversary can maliciously close the TCP connection, or prevent it from being established. In this case, security of the packet payload is reduced from the selected TLS cipher suite packet encryption to the classic MD5 per-attribute encryption.
	    
</p>
<p>
		    The RadSec transport provides authentication and encryption between RADIUS peers. In the presence of proxies, the intermediate proxies can still inspect the individual RADIUS packets, i.e. "end-to-end" encryption is not provided. Where intermediate proxies are untrusted, it is desirable to use other RADIUS mechanisms to prevent RADIUS packet payload from inspection by such proxies. One common method to protect passwords is the use of EAP methods which utilize TLS.
	    
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This document has no actions for IANA. The TCP port 2083 was already previously assigned by IANA for RadSec. No new RADIUS attributes or packet codes are defined.
</p>
<a name="acks"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>RadSec version 1 was first implemented by Open Systems Consultants, Currumbin Waters, Australia, for their &quot;Radiator&quot; RADIUS server product (see <a class='info' href='#radsec-whitepaper'>[radsec&#8209;whitepaper]<span> (</span><span class='info'>Open System Consultants, &ldquo;RadSec - a secure, reliable RADIUS Protocol,&rdquo; May&nbsp;2005.</span><span>)</span></a>).
</p>
<p>Funding and input for the development of this Internet Draft was provided by the European Commission co-funded project "GEANT2" <a class='info' href='#geant2'>[geant2]<span> (</span><span class='info'>Delivery of Advanced Network Technology to Europe, &ldquo;European Commission Information Society and Media: GEANT2,&rdquo; 2008.</span><span>)</span></a> and further feedback was provided by the TERENA Task Force Mobility <a class='info' href='#terena'>[terena]<span> (</span><span class='info'>TERENA, &ldquo;Trans-European Research and Education Networking Association,&rdquo; 2008.</span><span>)</span></a>.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2865">[RFC2865]</a></td>
<td class="author-text">Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;2865, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2865.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2866">[RFC2866]</a></td>
<td class="author-text">Rigney, C., &ldquo;<a href="http://tools.ietf.org/html/rfc2866">RADIUS Accounting</a>,&rdquo; RFC&nbsp;2866, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2866.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4985">[RFC4985]</a></td>
<td class="author-text">Santesson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4985">Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name</a>,&rdquo; RFC&nbsp;4985, August&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4985.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5280">[RFC5280]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5176">[RFC5176]</a></td>
<td class="author-text">Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B. Aboba, &ldquo;<a href="http://tools.ietf.org/html/rfc5176">Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;5176, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5176.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.dekok-radext-tcp-transport">[I-D.dekok-radext-tcp-transport]</a></td>
<td class="author-text">DeKok, A., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-dekok-radext-tcp-transport-01.txt">RADIUS Over TCP</a>,&rdquo; draft-dekok-radext-tcp-transport-01 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-dekok-radext-tcp-transport-01.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.dekok-radext-dtls">[I-D.dekok-radext-dtls]</a></td>
<td class="author-text">DeKok, A., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-dekok-radext-dtls-02.txt">DTLS as a Transport Layer for RADIUS</a>,&rdquo; draft-dekok-radext-dtls-02 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-dekok-radext-dtls-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.winter-dynamic-discovery">[I-D.winter-dynamic-discovery]</a></td>
<td class="author-text">Winter, S. and M. McCauley, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-winter-dynamic-discovery-00.txt">NAI-based Dynamic Peer Discovery for RADIUS over TLS and DTLS</a>,&rdquo; draft-winter-dynamic-discovery-00 (work in progress), February&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-winter-dynamic-discovery-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3588">[RFC3588]</a></td>
<td class="author-text">Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3588">Diameter Base Protocol</a>,&rdquo; RFC&nbsp;3588, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3588.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="radsec-whitepaper">[radsec-whitepaper]</a></td>
<td class="author-text">Open System Consultants, &ldquo;<a href="http://www.open.com.au/radiator/radsec-whitepaper.pdf">RadSec - a secure, reliable RADIUS Protocol</a>,&rdquo; May&nbsp;2005 (<a href="http://www.open.com.au/radiator/radsec-whitepaper.pdf">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="radiator-manual">[radiator-manual]</a></td>
<td class="author-text">Open System Consultants, &ldquo;<a href="http://www.open.com.au/radiator/ref.html">Radiator Radius Server - Installation and Reference Manual</a>,&rdquo; 2006 (<a href="http://www.open.com.au/radiator/ref.html">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="radsecproxy-impl">[radsecproxy-impl]</a></td>
<td class="author-text">Venaas, S., &ldquo;<a href="http://software.uninett.no/radsecproxy/">radsecproxy Project Homepage</a>,&rdquo; 2007 (<a href="http://software.uninett.no/radsecproxy/">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="eduroam">[eduroam]</a></td>
<td class="author-text">Trans-European Research and Education Networking Association, &ldquo;<a href="http://www.eduroam.org/">eduroam Homepage</a>,&rdquo; 2007 (<a href="http://www.eduroam.org/">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="geant2">[geant2]</a></td>
<td class="author-text">Delivery of Advanced Network Technology to Europe, &ldquo;<a href="http://www.geant2.net/">European Commission Information Society and Media: GEANT2</a>,&rdquo; 2008 (<a href="http://www.geant2.net/">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="terena">[terena]</a></td>
<td class="author-text">TERENA, &ldquo;<a href="http://www.terena.org/">Trans-European Research and Education Networking Association</a>,&rdquo; 2008 (<a href="http://www.terena.org/">TXT</a>).</td></tr>
</table>

<a name="radiator"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Implementation Overview: Radiator</h3>

<p>Radiator implements the RadSec protocol for proxying requests with the &lt;Authby RADSEC&gt; and &lt;ServerRADSEC&gt; clauses in the Radiator configuration file.
</p>
<p>The &lt;AuthBy RADSEC&gt; clause defines a RadSec client, and causes Radiator to send RADIUS requests to the configured RadSec server using the RadSec protocol.
</p>
<p>The &lt;ServerRADSEC&gt; clause defines a RadSec server, and causes Radiator to listen on the configured port and address(es) for connections from &lt;Authby RADSEC&gt; clients. When an &lt;Authby RADSEC&gt; client connects to a &lt;ServerRADSEC&gt; server, the client sends RADIUS requests through the stream to the server. The server then handles the request in the same way as if the request had been received from a conventional UDP RADIUS client.
</p>
<p>Radiator is compliant to version 2 of RadSec if the following options are used:
	    	</p>
<blockquote class="text">
<p>&lt;AuthBy RADSEC&gt;
				</p>
<ul class="text">
<li>Protocol tcp
</li>
<li>UseTLS
</li>
<li>TLS_CertificateFile
</li>
<li>Secret radsec
</li>
</ul>
			

<p>&lt;ServerRADSEC&gt;
				</p>
<ul class="text">
<li>Protocol tcp
</li>
<li>UseTLS
</li>
<li>TLS_RequireClientCert
</li>
<li>Secret radsec
</li>
</ul>
			

</blockquote><p>
		As of Radiator 3.15, the default shared secret for RadSec connections is configurable and defaults to "mysecret" (without quotes). For compliance with this document, this setting needs to be configured for the shared secret "radsec". The implementation uses TCP keepalive socket options, but does not send Status-Server packets. Once established, TLS connections are kept open throughout the server instance lifetime.
	    
</p>
<a name="radsecproxy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Implementation Overview: radsecproxy</h3>

<p>The RADIUS proxy named radsecproxy was written in order to allow use of RadSec in current RADIUS deployments. This is a generic proxy that supports any number and combination of clients and servers, supporting RADIUS over UDP and RadSec. The main idea is that it can be used on the same host as a non-RadSec client or server to ensure RadSec is used on the wire, however as a generic proxy it can be used in other circumstances as well.
</p>
<p>The configuration file consists of client and server clauses, where there is one such clause for each client or server. In such a clause one specifies either "type tls" or "type udp" for RadSec or UDP transport. For RadSec the default shared secret "mysecret" (without quotes), the same as Radiator, is used. A secret may be specified by putting say "secret somesharedsecret" inside a client or server clause.
</p>
<p>In order to use TLS for clients and/or servers, one must also specify where to locate CA certificates, as well as certificate and key for the client or server. This is done in a TLS clause. There may be one or several TLS clauses. A client or server clause may reference a particular TLS clause, or just use a default one. One use for multiple TLS clauses may be to present one certificate to clients and another to servers.
</p>
<p>If any RadSec (TLS) clients are configured, the proxy will at startup listen on port 2083, as assigned by IANA for the OSC RadSec implementation. An alternative port may be specified. When a client connects, the client certificate will be verified, including checking that the configured FQDN or IP address matches what is in the certificate. Requests coming from a RadSec client are treated exactly like requests from UDP clients.
	    
</p>
<p>The proxy will at startup try to establish a TLS connection to each (if any) of the configured RadSec (TLS) servers. If it fails to connect to a server, it will retry regularly. There is some back-off where it will retry quickly at first, and with longer intervals later. If a connection to a server goes down it will also start retrying regularly. When setting up the TLS connection, the server certificate will be verified, including checking that the configured FQDN or IP address matches what is in the certificate. Requests are sent to a RadSec server just like they would to a UDP server.
</p>
<p>The proxy supports Status-Server messages. They are only sent to a server if enabled for that particular server. Status-Server requests are always responded to.
</p>
<p>This RadSec implementation has been successfully tested together with Radiator. It is a freely available open-source implementation. For source code and documentation, see <a class='info' href='#radsecproxy-impl'>[radsecproxy&#8209;impl]<span> (</span><span class='info'>Venaas, S., &ldquo;radsecproxy Project Homepage,&rdquo; 2007.</span><span>)</span></a>.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stefan Winter</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fondation RESTENA</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">6, rue Richard Coudenhove-Kalergi</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Luxembourg  1359</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">LUXEMBOURG</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+352 424409 1</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+352 422473</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:stefan.winter@restena.lu">stefan.winter@restena.lu</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.restena.lu.">http://www.restena.lu.</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mike McCauley</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Open Systems Consultants</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">9 Bulbul Place</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Currumbin Waters  QLD 4223</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">AUSTRALIA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+61 7 5598 7474</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+61 7 5598 7070</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:mikem@open.com.au">mikem@open.com.au</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.open.com.au.">http://www.open.com.au.</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stig Venaas</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">UNINETT</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Abels gate 5 – Teknobyen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trondheim  7465</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NORWAY</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+47 73 55 79 00</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+47 73 55 79 01</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:stig.venaas@uninett.no">stig.venaas@uninett.no</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.uninett.no.">http://www.uninett.no.</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Klaas Wierenga</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems International BV</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Haarlerbergweg 13-19</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Amsterdam  1101 CH</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">The Netherlands</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+31 (0)20 3571752</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:kwiereng@cisco.com">kwiereng@cisco.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.cisco.com.">http://www.cisco.com.</a></td></tr>
</table>
</body></html>
