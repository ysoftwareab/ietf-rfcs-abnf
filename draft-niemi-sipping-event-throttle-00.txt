



Network Working Group                                           A. Niemi
Internet-Draft                                                     Nokia
Expires: April 19, 2004                                 October 20, 2003



     Session Initiation Protocol (SIP) Event Notification Throttles
                 draft-niemi-sipping-event-throttle-00


Status of this Memo


   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.


   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that other
   groups may also distribute working documents as Internet-Drafts.


   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time. It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."


   The list of current Internet-Drafts can be accessed at http://
   www.ietf.org/ietf/1id-abstracts.txt.


   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.


   This Internet-Draft will expire on April 19, 2004.


Copyright Notice


   Copyright (C) The Internet Society (2003). All Rights Reserved.


Abstract


   This memo specifies a throttle mechanism for limiting the rate of
   Session Initiation Protocol (SIP) event notifications. This mechanism
   can be applied in subscriptions to all SIP event packages.














Niemi                    Expires April 19, 2004                 [Page 1]
Internet-Draft               Event Throttle                 October 2003



Table of Contents


   1.    Introduction . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.    Definitions and Document Conventions . . . . . . . . . . . .  3
   3.    Overview . . . . . . . . . . . . . . . . . . . . . . . . . .  3
   3.1   Event Throttle Model . . . . . . . . . . . . . . . . . . . .  4
   3.2   Basic Operation  . . . . . . . . . . . . . . . . . . . . . .  4
   4.    Operation of Event Throttles . . . . . . . . . . . . . . . .  5
   4.1   Negotiating the Use of Throttle  . . . . . . . . . . . . . .  5
   4.2   Setting the Throttle . . . . . . . . . . . . . . . . . . . .  5
   4.2.1 Subscriber Behavior  . . . . . . . . . . . . . . . . . . . .  5
   4.2.2 Notifier Behavior  . . . . . . . . . . . . . . . . . . . . .  6
   4.3   Selecting the Throttle interval  . . . . . . . . . . . . . .  6
   5.    Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . .  7
   5.1   "event-throttle" SIP Option Tag  . . . . . . . . . . . . . .  7
   5.2   "throttle" Header Parameter  . . . . . . . . . . . . . . . .  7
   5.3   Augmented BNF Definitions  . . . . . . . . . . . . . . . . .  7
   6.    IANA Considerations  . . . . . . . . . . . . . . . . . . . .  7
   7.    Security Considerations  . . . . . . . . . . . . . . . . . .  8
   8.    Acknowledgements . . . . . . . . . . . . . . . . . . . . . .  8
         Normative References . . . . . . . . . . . . . . . . . . . .  8
         Informative References . . . . . . . . . . . . . . . . . . .  8
         Author's Address . . . . . . . . . . . . . . . . . . . . . .  9
         Intellectual Property and Copyright Statements . . . . . . . 10




























Niemi                    Expires April 19, 2004                 [Page 2]
Internet-Draft               Event Throttle                 October 2003



1. Introduction


   The SIP events framework [2] defines a generic framework for
   subscriptions to and notifications of events related to SIP systems.
   This framework defines the methods SUBSCRIBE and NOTIFY, and
   introduces the concept of an event package, which is a concrete
   application of the SIP events framework to a particular class of
   events.


   One of the things the SIP events framework mandates is that each
   event package specification defines an absolute maximum on the rate
   at which notifications are allowed to be generated by a single
   notifier. Such a limit is provided in order to reduce network
   congestion.


   All of the existing event package specifications include a maximum
   notification rate recommendation, ranging from once in every five
   seconds [4], [5], [6] to once per second [7].


   Per the SIP events framework, each event package specification is
   also allowed to define additional throttle mechanisms which allow the
   subscriber to further limit the rate of event notification. So far
   none of the event package specifications have defined such a
   mechanism. Requirements and model for generic event throttles are
   discussed in [8].


   This document defines an extension to the SIP events framework that
   allows a subscriber to set a throttle to event notifications
   generated by the notifier. A throttle is simply a timer value that
   indicates the minimum time period allowed between two notifications.
   As a result of this throttle, a compliant notifier will limit the
   rate at which it generates notifications.


2. Definitions and Document Conventions


   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [1] and
   indicate requirement levels for compliant implementations.


      Indented passages such as this one are used in this document to
      provide additional information and clarifying text. They do not
      contain normative protocol behavior.



3. Overview






Niemi                    Expires April 19, 2004                 [Page 3]
Internet-Draft               Event Throttle                 October 2003



3.1 Event Throttle Model


   Using notations from traffic theory, we can model the notifier as a
   statistical multiplexer with an input rate of Ci (i = 1,...,n), and
   an output rate of C <= C1 + ... + Cn. Typically, the statistical
   multiplexer is lossy, with a finite buffer size. The loss probability
   of the statistical multiplexer can be decreased by enlarging this
   buffer. Figure 1 illustrates the model.


                      C1 |\
              1 ---------|  \
                ---------|    \        C
                ---------| ||||O---------- 1
                ---------|    /
              n ---------|  /
                      Cn |/



        Figure 1: Notifier modeled as a statistical multiplexer


   The output connection has a default rate that is generally dictated
   by each individual event package. The rate can also be set using the
   throttle mechanism described in this document. A notifer that accepts
   a subscriber-defined throttle, adjusts its output rate accordingly.


   There is typically only a single input connection, characterized by
   the event package, and consisting of a stream of event notification
   packets. Properties of the buffer, such as buffer size, policy (e.g.,
   FIFO, LIFO), and packet treatment in lossy conditions, are all
   implementation and event package specific.


   In general, applying a throttle MUST NOT alter the properties of the
   buffer. I.e., the event notifications are expected to deliver
   consistent information even when throttled.


3.2 Basic Operation


   A subscriber that wants to limit the rate of event notification in a
   specific subscription does so by suggesting a throttle as part of the
   SUBSCRIBE message. The throttle indicating the minimum time allowed
   between two notifications in a subscription is given as an Event
   header parameter in the SUBSCRIBE request.


   The subscriber also indicates that it requires the throttle to be
   applied to the subscription. This is done using the SIP option-tag
   mechanism, by insisting that the notifier applies the event throttle
   extension when processing the request. A notifier that does not
   support the event throttle extension will reject the subscription.




Niemi                    Expires April 19, 2004                 [Page 4]
Internet-Draft               Event Throttle                 October 2003



   A notifier that supports the throttle mechanism will comply with
   value given in the throttle, and adjust its rate of notification
   accordingly.


   Throttled notifications will have exactly the same properties as the
   un-throttled ones, with the exception that they will not be generated
   more frequent than what the throttle allows.


4. Operation of Event Throttles


4.1 Negotiating the Use of Throttle


   This specification uses the SIP option-tag mechanism for negotiating
   use of the throttle mechanism. Use of the "Require" header field and
   the 420 (Bad Extension) are according to SIP [3].


   A subscriber that wishes to apply a throttle to notifications in a
   subscription insists that the notifier applies this throttle by
   including an "event-throttle" option-tag to the Require header field
   of the SUBSCRIBE request.


   A notifier that does not understand the event-throttle extension,
   will respond with a 420 (Bad Extension) response. Otherwise, the
   throttle is processed by the notifier, and the notification rate is
   adjusted accordingly.


4.2 Setting the Throttle


4.2.1 Subscriber Behavior


   In general, the way in which a subscriber generates SUBSCRIBE
   requests and processes NOTIFY requests is according to RFC 3265 [2].


   A subscriber that wishes to throttle the notifications in a
   subscription, MUST include a "throttle" Event header parameter in the
   SUBSCRIBE request, indicating in seconds the throttle value. The
   value of this parameter is an integral number of seconds in decimal.


   In case the notifier does not support the "event-throttle" extension,
   the subscriber SHOULD retry the subscription without that extension,
   i.e., without the "throttle" parameter.


      In this case the subscriber can resort to other means of limiting
      the notification rate. For example, instead of a subscription, it
      can fetch or poll the event state.







Niemi                    Expires April 19, 2004                 [Page 5]
Internet-Draft               Event Throttle                 October 2003



4.2.2 Notifier Behavior


   In general, the way in which a notifier processes SUBSCRIBE requests
   and generates NOTIFY requests is according to RFC 3265 [2].


   A notifier that supports the "event-throttle" extension extracts the
   value of the "throttle" Event header parameter, and uses it as the
   minimum time allowed between two notifications. However, a notifier
   MUST set the throttle to a value that is within the general throttle
   resoulution, and is less than the subscription expiration. This
   ensures that the throttle does not end up quenching the subscription.


      OPEN ISSUE: Is this appropriate? Should we also handle somehow the
      scenario where a notification is generated at such time that the
      remaining subscription lifetime is less than the throttle value?


   A notifier MUST include the selected throttle value in a "throttle"
   parameter to the Subscription-State header field of the NOTIFY
   requests sent to the subscriber.


   A compliant notifier MUST NOT generate notifications more frequent
   than what the throttle allows for, except when generating the
   notification upon termination of the subscription. A notifier also
   MUST NOT alter its notification buffer properties when applying a
   throttle to it.


   As specified in RFC 3261 [3] a notifier that supports event throttles
   SHOULD advertise its support by including the "event-throttle"
   option-tag in the Supported header field of a response to an OPTIONS
   request.


4.3 Selecting the Throttle interval


   Special care needs to be taken when selecting the throttle value.
   Using the throttle syntax it is potentially possible to insist both
   very short and very long throttles to be applied to the subscription.
   For example, a throttle could potentially set a minimum time value
   between notifications that exceeds the subscription expiration value.
   Such a configuration would effectively quench the notifier, resulting
   in a useless subscription.


   To avoid such complications, certain limits for the throttle value
   are used. A throttle MUST be greater than the default minimum time
   between two notifications, for a given event package. This ensures
   that the notifications always follow the default notification rate
   given by each event package. The throttle also MUST NOT exceed 600
   seconds.





Niemi                    Expires April 19, 2004                 [Page 6]
Internet-Draft               Event Throttle                 October 2003



      OPEN ISSUE: This hard limit is open to discussion, but
      intuitively, this seems as good a value as any. This resolution
      seems to give enough flexibility so that the throttle mechanism is
      usable, with being low enough to keep clear of most default
      subscription expiration values.


   Implementations MUST consider values greater than 600 seconds as
   equal to 600, and values lower than the event package default as
   equal to the event package default.


5. Syntax


   This section describes the syntax extensions required for watcherinfo
   history. Note that the formal syntax definitions described in this
   section are expressed in the Augmented BNF format used in SIP [3],
   and contain references to elements defined therein.


5.1 "event-throttle" SIP Option Tag


   The "event-throttle" SIP option-tag is added to the "option-tag"
   definition in the SIP grammar. Usage of this option-tag is defined in
   Section 4.1.


5.2 "throttle" Header Parameter


   The "throttle" header parameter is added to the "generic-param"
   definition in the SIP grammar. Usage of this Event header parameter
   is described in section Section 4.2.


   The maximum value of this parameter is 600.


5.3 Augmented BNF Definitions


   This section describes the Augmented BNF definitions for the new
   syntax element. The notation is as used in SIP [3] and the documents
   to which is refers.


      generic-param  =  throttle-param / token [ EQUAL gen-value ]
      throttle-param =  "throttle" EQUAL delta-seconds ; value less than 600
      option-tag     =  throttle-tag / token
      throttle-tag   =  "event-throttle"



6. IANA Considerations


   TBD: New SIP option tag (event-throttle), and possibly new header
   parameter (throttle) need to be registered with IANA.





Niemi                    Expires April 19, 2004                 [Page 7]
Internet-Draft               Event Throttle                 October 2003



7. Security Considerations


   Naturally, the security considerations listed in SIP events [2],
   which the throttle mechanism extends, apply in entirety. In
   particular, authentication and message integrity SHOULD be applied to
   subscriptions with the event-throttle extension.


8. Acknowledgements


   Thanks for Pekka Pessi for comments and suggestions on the draft.


Normative References


   [1]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", BCP 14, RFC 2119, March 1997.


   [2]  Roach, A., "Session Initiation Protocol (SIP)-Specific Event
        Notification", RFC 3265, June 2002.


   [3]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,
        Peterson, J., Sparks, R., Handley, M. and E. Schooler, "SIP:
        Session Initiation Protocol", RFC 3261, June 2002.


Informative References


   [4]  Rosenberg, J., "A Presence Event Package for the Session
        Initiation Protocol (SIP)", draft-ietf-simple-presence-10 (work
        in progress), January 2003.


   [5]  Rosenberg, J., "A Session Initiation Protocol (SIP) Event
        Package for Registrations", draft-ietf-sipping-reg-event-00
        (work in progress), October 2002.


   [6]  Rosenberg, J., "A Watcher Information Event Template-Package for
        the Session Initiation  Protocol (SIP)",
        draft-ietf-simple-winfo-package-05 (work in progress), January
        2003.


   [7]  Mahy, R., "A Message Summary and Message Waiting Indication
        Event Package for the  Session Initiation Protocol (SIP)",
        draft-ietf-sipping-mwi-03 (work in progress), July 2003.


   [8]  Niemi, A., "Requirements for Limiting the Rate of Event
        Notifications", draft-ietf-sipping-event-throttle-reqs-00 (work
        in progress), September 2003.







Niemi                    Expires April 19, 2004                 [Page 8]
Internet-Draft               Event Throttle                 October 2003



Author's Address


   Aki Niemi
   Nokia
   P.O. Box 321
   NOKIA GROUP, FIN  00045
   Finland


   Phone: +358 50 389 1644
   EMail: aki.niemi@nokia.com










































Niemi                    Expires April 19, 2004                 [Page 9]
Internet-Draft               Event Throttle                 October 2003



Intellectual Property Statement


   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights. Information on the
   IETF's procedures with respect to rights in standards-track and
   standards-related documentation can be found in BCP-11. Copies of
   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementors or users of this specification can
   be obtained from the IETF Secretariat.


   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard. Please address the information to the IETF Executive
   Director.



Full Copyright Statement


   Copyright (C) The Internet Society (2003). All Rights Reserved.


   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works. However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.


   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assignees.


   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION




Niemi                    Expires April 19, 2004                [Page 10]
Internet-Draft               Event Throttle                 October 2003



   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.



Acknowledgement


   Funding for the RFC Editor function is currently provided by the
   Internet Society.












































Niemi                    Expires April 19, 2004                [Page 11]