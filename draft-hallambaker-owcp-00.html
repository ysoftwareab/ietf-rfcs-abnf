<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Open Web Confirmation Protocol (OWCP)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Background">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Second Factor Authentication">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Confirmation vs. Authentication">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Use Scenarios">
<link href="#rfc.section.1.3.1" rel="Chapter" title="1.3.1 Use in Financial Services">
<link href="#rfc.section.1.3.2" rel="Chapter" title="1.3.2 Machine Binding">
<link href="#rfc.section.1.3.3" rel="Chapter" title="1.3.3 Tethered Use">
<link href="#rfc.section.1.3.4" rel="Chapter" title="1.3.4 Co-Browser">
<link href="#rfc.section.2" rel="Chapter" title="2 Description">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Parties">
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Accounts">
<link href="#rfc.section.2.1.1.1" rel="Chapter" title="2.1.1.1 Dispatcher Discovery">
<link href="#rfc.section.2.1.1.2" rel="Chapter" title="2.1.1.2 Third Party Domain Names">
<link href="#rfc.section.2.1.1.3" rel="Chapter" title="2.1.1.3 Open and Closed Services">
<link href="#rfc.section.2.1.2" rel="Chapter" title="2.1.2 User Experience">
<link href="#rfc.section.2.1.2.1" rel="Chapter" title="2.1.2.1 Dispatcher Subscription">
<link href="#rfc.section.2.1.2.2" rel="Chapter" title="2.1.2.2 Registration">
<link href="#rfc.section.2.1.2.3" rel="Chapter" title="2.1.2.3 Requestor Subscription">
<link href="#rfc.section.2.1.2.4" rel="Chapter" title="2.1.2.4 Confirmation">
<link href="#rfc.section.2.1.3" rel="Chapter" title="2.1.3 Examples of Use [Non Normative]">
<link href="#rfc.section.2.1.3.1" rel="Chapter" title="2.1.3.1 Access Control">
<link href="#rfc.section.2.1.3.2" rel="Chapter" title="2.1.3.2 Payment">
<link href="#rfc.section.2.1.3.3" rel="Chapter" title="2.1.3.3 Ticket and Transaction Acknowledgement">
<link href="#rfc.section.3" rel="Chapter" title="3 Protocol Messages">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Common Format">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Request">
<link href="#rfc.section.3.1.2" rel="Chapter" title="3.1.2 Response">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Requestor to Dispatcher">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Operation RD-Confirm">
<link href="#rfc.section.3.2.1.1" rel="Chapter" title="3.2.1.1 RD-Confirm Request">
<link href="#rfc.section.3.2.1.2" rel="Chapter" title="3.2.1.2 RD-Confirm Response">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Operation RD-Register">
<link href="#rfc.section.3.2.2.1" rel="Chapter" title="3.2.2.1 RD-Register Request">
<link href="#rfc.section.3.2.2.2" rel="Chapter" title="3.2.2.2 RD-Register Response">
<link href="#rfc.section.3.2.3" rel="Chapter" title="3.2.3 Operation RD-Deregister">
<link href="#rfc.section.3.2.3.1" rel="Chapter" title="3.2.3.1 RD-Deregister Request">
<link href="#rfc.section.3.2.3.2" rel="Chapter" title="3.2.3.2 RD-Deregister Response">
<link href="#rfc.section.3.2.4" rel="Chapter" title="3.2.4 Operation RD-Status">
<link href="#rfc.section.3.2.4.1" rel="Chapter" title="3.2.4.1 RD-Status Request">
<link href="#rfc.section.3.2.4.2" rel="Chapter" title="3.2.4.2 RD-Status Response">
<link href="#rfc.section.3.2.5" rel="Chapter" title="3.2.5 Operation RD-Final">
<link href="#rfc.section.3.2.5.1" rel="Chapter" title="3.2.5.1 RD-Final Request">
<link href="#rfc.section.3.2.5.2" rel="Chapter" title="3.2.5.2 RD-Final Response">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Dispatcher to Requestor">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 Operation DR-Complete">
<link href="#rfc.section.3.3.1.1" rel="Chapter" title="3.3.1.1 DR-Complete Request">
<link href="#rfc.section.3.3.1.2" rel="Chapter" title="3.3.1.2 DR-Complete Response">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Client to Dispatcher">
<link href="#rfc.section.3.4.1" rel="Chapter" title="3.4.1 Operation CD-Register">
<link href="#rfc.section.3.4.1.1" rel="Chapter" title="3.4.1.1 CD-Register Request">
<link href="#rfc.section.3.4.1.2" rel="Chapter" title="3.4.1.2 CD-Register Response">
<link href="#rfc.section.3.4.2" rel="Chapter" title="3.4.2 Operation CD-Deregister">
<link href="#rfc.section.3.4.2.1" rel="Chapter" title="3.4.2.1 CD-Deregister Request">
<link href="#rfc.section.3.4.2.2" rel="Chapter" title="3.4.2.2 CD-Deregister Response">
<link href="#rfc.section.3.4.3" rel="Chapter" title="3.4.3 Operation CD-List">
<link href="#rfc.section.3.4.3.1" rel="Chapter" title="3.4.3.1 CD-List Request">
<link href="#rfc.section.3.4.3.2" rel="Chapter" title="3.4.3.2 RD-List Response">
<link href="#rfc.section.3.4.4" rel="Chapter" title="3.4.4 Operation CD-Reply">
<link href="#rfc.section.3.4.4.1" rel="Chapter" title="3.4.4.1 CD-Reply Request">
<link href="#rfc.section.3.4.4.2" rel="Chapter" title="3.4.4.2 CD-Reply Response">
<link href="#rfc.section.4" rel="Chapter" title="4 Service Discovery">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 ESRV Discovery">
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 ESRV Properties">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Manual Discovery">
<link href="#rfc.section.5" rel="Chapter" title="5 Bindings">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 HTTP/JSON Binding">
<link href="#rfc.section.5.1.1" rel="Chapter" title="5.1.1 Transport">
<link href="#rfc.section.5.1.2" rel="Chapter" title="5.1.2 HTTP Encapsulation">
<link href="#rfc.section.5.1.3" rel="Chapter" title="5.1.3 Binary Multipart Container">
<link href="#rfc.section.5.1.3.1" rel="Chapter" title="5.1.3.1 Data Segment Format">
<link href="#rfc.section.5.1.3.2" rel="Chapter" title="5.1.3.2 Data Section Format">
<link href="#rfc.section.5.1.4" rel="Chapter" title="5.1.4 JSON Object Syntax">
<link href="#rfc.section.6" rel="Chapter" title="6 Request Schema">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Namespace">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Request">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 &lt;Header&gt;">
<link href="#rfc.section.6.3.1" rel="Chapter" title="6.3.1 &lt;From&gt; and &lt;To&gt;">
<link href="#rfc.section.6.3.2" rel="Chapter" title="6.3.2 &lt;Verification&gt;">
<link href="#rfc.section.6.3.3" rel="Chapter" title="6.3.3 &lt;Summary&gt;">
<link href="#rfc.section.6.3.4" rel="Chapter" title="6.3.4 &lt;Reference&gt;">
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 &lt;Body&gt;">
<link href="#rfc.section.6.4.1" rel="Chapter" title="6.4.1 &lt;P&gt;">
<link href="#rfc.section.6.4.2" rel="Chapter" title="6.4.2 &lt;Barcode&gt;">
<link href="#rfc.section.6.5" rel="Chapter" title="6.5 &lt;Table&gt;">
<link href="#rfc.section.6.5.1" rel="Chapter" title="6.5.1 &lt;TH&gt; and &lt;TR&gt;">
<link href="#rfc.section.6.6" rel="Chapter" title="6.6 &lt;TD&gt;">
<link href="#rfc.section.6.7" rel="Chapter" title="6.7 Text">
<link href="#rfc.section.6.7.1" rel="Chapter" title="6.7.1 &lt;Money&gt;">
<link href="#rfc.section.6.7.2" rel="Chapter" title="6.7.2 &lt;B&gt;, &lt;I&gt; and &lt;U&gt;">
<link href="#rfc.section.6.8" rel="Chapter" title="6.8 End">
<link href="#rfc.section.7" rel="Chapter" title="7 Internationalization Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Non Normative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Collected Schema">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Open Web Confirmation Protocol (OWCP) is a three party Web Service that supports a transactional second factor confirmation mechanism that provides a superset of the capabilities of traditional second factor authentication schemes.  " />
  <meta name="description" content="Open Web Confirmation Protocol (OWCP) is a three party Web Service that supports a transactional second factor confirmation mechanism that provides a superset of the capabilities of traditional second factor authentication schemes.  " />
  <meta name="keywords" content="DNS, DNSSEC, PKIX" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">P. M. Hallam-Baker</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Comodo Group Inc.</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">June 22, 2011</td>
</tr>
<tr>
<td class="left">Expires: December 24, 2011</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Open Web Confirmation Protocol (OWCP)<br />
  <span class="filename">draft-hallambaker-owcp-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Open Web Confirmation Protocol (OWCP) is a three party Web Service that supports a transactional second factor confirmation mechanism that provides a superset of the capabilities of traditional second factor authentication schemes.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on December 24, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Background</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Second Factor Authentication</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Confirmation vs. Authentication</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Use Scenarios</a>
</li>
<li>1.3.1.   <a href="#rfc.section.1.3.1">Use in Financial Services</a>
</li>
<li>1.3.2.   <a href="#rfc.section.1.3.2">Machine Binding</a>
</li>
<li>1.3.3.   <a href="#rfc.section.1.3.3">Tethered Use</a>
</li>
<li>1.3.4.   <a href="#rfc.section.1.3.4">Co-Browser</a>
</li>
<li>2.   <a href="#rfc.section.2">Description</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Parties</a>
</li>
<li>2.1.1.   <a href="#rfc.section.2.1.1">Accounts</a>
</li>
<li>2.1.1.1.   <a href="#rfc.section.2.1.1.1">Dispatcher Discovery</a>
</li>
<li>2.1.1.2.   <a href="#rfc.section.2.1.1.2">Third Party Domain Names</a>
</li>
<li>2.1.1.3.   <a href="#rfc.section.2.1.1.3">Open and Closed Services</a>
</li>
<li>2.1.2.   <a href="#rfc.section.2.1.2">User Experience</a>
</li>
<li>2.1.2.1.   <a href="#rfc.section.2.1.2.1">Dispatcher Subscription</a>
</li>
<li>2.1.2.2.   <a href="#rfc.section.2.1.2.2">Registration</a>
</li>
<li>2.1.2.3.   <a href="#rfc.section.2.1.2.3">Requestor Subscription</a>
</li>
<li>2.1.2.4.   <a href="#rfc.section.2.1.2.4">Confirmation</a>
</li>
<li>2.1.3.   <a href="#rfc.section.2.1.3">Examples of Use [Non Normative]</a>
</li>
<li>2.1.3.1.   <a href="#rfc.section.2.1.3.1">Access Control</a>
</li>
<li>2.1.3.2.   <a href="#rfc.section.2.1.3.2">Payment</a>
</li>
<li>2.1.3.3.   <a href="#rfc.section.2.1.3.3">Ticket and Transaction Acknowledgement</a>
</li>
<li>3.   <a href="#rfc.section.3">Protocol Messages</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Common Format</a>
</li>
<li>3.1.1.   <a href="#rfc.section.3.1.1">Request</a>
</li>
<li>3.1.2.   <a href="#rfc.section.3.1.2">Response</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Requestor to Dispatcher</a>
</li>
<li>3.2.1.   <a href="#rfc.section.3.2.1">Operation RD-Confirm</a>
</li>
<li>3.2.1.1.   <a href="#rfc.section.3.2.1.1">RD-Confirm Request</a>
</li>
<li>3.2.1.2.   <a href="#rfc.section.3.2.1.2">RD-Confirm Response</a>
</li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">Operation RD-Register</a>
</li>
<li>3.2.2.1.   <a href="#rfc.section.3.2.2.1">RD-Register Request</a>
</li>
<li>3.2.2.2.   <a href="#rfc.section.3.2.2.2">RD-Register Response</a>
</li>
<li>3.2.3.   <a href="#rfc.section.3.2.3">Operation RD-Deregister</a>
</li>
<li>3.2.3.1.   <a href="#rfc.section.3.2.3.1">RD-Deregister Request</a>
</li>
<li>3.2.3.2.   <a href="#rfc.section.3.2.3.2">RD-Deregister Response</a>
</li>
<li>3.2.4.   <a href="#rfc.section.3.2.4">Operation RD-Status</a>
</li>
<li>3.2.4.1.   <a href="#rfc.section.3.2.4.1">RD-Status Request</a>
</li>
<li>3.2.4.2.   <a href="#rfc.section.3.2.4.2">RD-Status Response</a>
</li>
<li>3.2.5.   <a href="#rfc.section.3.2.5">Operation RD-Final</a>
</li>
<li>3.2.5.1.   <a href="#rfc.section.3.2.5.1">RD-Final Request</a>
</li>
<li>3.2.5.2.   <a href="#rfc.section.3.2.5.2">RD-Final Response</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Dispatcher to Requestor</a>
</li>
<li>3.3.1.   <a href="#rfc.section.3.3.1">Operation DR-Complete</a>
</li>
<li>3.3.1.1.   <a href="#rfc.section.3.3.1.1">DR-Complete Request</a>
</li>
<li>3.3.1.2.   <a href="#rfc.section.3.3.1.2">DR-Complete Response</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Client to Dispatcher</a>
</li>
<li>3.4.1.   <a href="#rfc.section.3.4.1">Operation CD-Register</a>
</li>
<li>3.4.1.1.   <a href="#rfc.section.3.4.1.1">CD-Register Request</a>
</li>
<li>3.4.1.2.   <a href="#rfc.section.3.4.1.2">CD-Register Response</a>
</li>
<li>3.4.2.   <a href="#rfc.section.3.4.2">Operation CD-Deregister</a>
</li>
<li>3.4.2.1.   <a href="#rfc.section.3.4.2.1">CD-Deregister Request</a>
</li>
<li>3.4.2.2.   <a href="#rfc.section.3.4.2.2">CD-Deregister Response</a>
</li>
<li>3.4.3.   <a href="#rfc.section.3.4.3">Operation CD-List</a>
</li>
<li>3.4.3.1.   <a href="#rfc.section.3.4.3.1">CD-List Request</a>
</li>
<li>3.4.3.2.   <a href="#rfc.section.3.4.3.2">RD-List Response</a>
</li>
<li>3.4.4.   <a href="#rfc.section.3.4.4">Operation CD-Reply</a>
</li>
<li>3.4.4.1.   <a href="#rfc.section.3.4.4.1">CD-Reply Request</a>
</li>
<li>3.4.4.2.   <a href="#rfc.section.3.4.4.2">CD-Reply Response</a>
</li>
<li>4.   <a href="#rfc.section.4">Service Discovery</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">ESRV Discovery</a>
</li>
<li>4.1.1.   <a href="#rfc.section.4.1.1">ESRV Properties</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Manual Discovery</a>
</li>
<li>5.   <a href="#rfc.section.5">Bindings</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">HTTP/JSON Binding</a>
</li>
<li>5.1.1.   <a href="#rfc.section.5.1.1">Transport</a>
</li>
<li>5.1.2.   <a href="#rfc.section.5.1.2">HTTP Encapsulation</a>
</li>
<li>5.1.3.   <a href="#rfc.section.5.1.3">Binary Multipart Container</a>
</li>
<li>5.1.3.1.   <a href="#rfc.section.5.1.3.1">Data Segment Format</a>
</li>
<li>5.1.3.2.   <a href="#rfc.section.5.1.3.2">Data Section Format</a>
</li>
<li>5.1.4.   <a href="#rfc.section.5.1.4">JSON Object Syntax</a>
</li>
<li>6.   <a href="#rfc.section.6">Request Schema</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Namespace</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Request</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">&lt;Header&gt;</a>
</li>
<li>6.3.1.   <a href="#rfc.section.6.3.1">&lt;From&gt; and &lt;To&gt;</a>
</li>
<li>6.3.2.   <a href="#rfc.section.6.3.2">&lt;Verification&gt;</a>
</li>
<li>6.3.3.   <a href="#rfc.section.6.3.3">&lt;Summary&gt;</a>
</li>
<li>6.3.4.   <a href="#rfc.section.6.3.4">&lt;Reference&gt;</a>
</li>
<li>6.4.   <a href="#rfc.section.6.4">&lt;Body&gt;</a>
</li>
<li>6.4.1.   <a href="#rfc.section.6.4.1">&lt;P&gt;</a>
</li>
<li>6.4.2.   <a href="#rfc.section.6.4.2">&lt;Barcode&gt;</a>
</li>
<li>6.5.   <a href="#rfc.section.6.5">&lt;Table&gt;</a>
</li>
<li>6.5.1.   <a href="#rfc.section.6.5.1">&lt;TH&gt; and &lt;TR&gt;</a>
</li>
<li>6.6.   <a href="#rfc.section.6.6">&lt;TD&gt;</a>
</li>
<li>6.7.   <a href="#rfc.section.6.7">Text</a>
</li>
<li>6.7.1.   <a href="#rfc.section.6.7.1">&lt;Money&gt;</a>
</li>
<li>6.7.2.   <a href="#rfc.section.6.7.2">&lt;B&gt;, &lt;I&gt; and &lt;U&gt;</a>
</li>
<li>6.8.   <a href="#rfc.section.6.8">End</a>
</li>
<li>7.   <a href="#rfc.section.7">Internationalization Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Security Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">IANA Considerations</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Non Normative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Collected Schema</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Background</h1>
<p id="rfc.section.1.p.1">Authentication of end users is one of the biggest challenges for Internet and Web security today. Despite an abundance of technology that offers authentication mechanisms that are more robust, more secure and easier to use, the default mechanism for user authentication is the use of usernames and passwords.  </p>
<p id="rfc.section.1.p.2">Unlike traditional schemes, OWCP is designed for implementation on a device that has at least the capabilities of a modern 'smartphone'. In particular an OWCP client device must support a display, a means of accepting text input from the user and a connection to the Internet.  </p>
<p id="rfc.section.1.p.3">While mobile devices offering this degree of functionality were rare in 2007, they have since become ubiquitous. It is thus now a practical proposition for a site requiring second factor authentication to support at least a part of its users using a technology that requires this level of capability. Indeed software applications that emulate traditional second factor authentication protocols on such devices have been available for some time.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Second Factor Authentication</h1>
<p id="rfc.section.1.1.p.1">Second factor authentication mechanisms offer greater security over the use of passwords alone by combining a first factor (typically a password) with a biometric or proof of possession of a physical token.  </p>
<p id="rfc.section.1.1.p.2">Traditional second factor authentication techniques have suffered from the need to distribute physical tokens and the difficulty of ensuring that a biometric authentication is presented to a trustworthy terminal.  </p>
<p id="rfc.section.1.1.p.3">The usability of traditional second factor authentication techniques has been poor or worse. Even the simplest scheme in which the user is required to read in a 'one time use' numeric code from the authentication token device and enter it into a password field. While such operations are relatively simple they require the user to engage in a sequence of operations that bears no necessary or natural relationship to the underlying task for which the authentication is required.  </p>
<p id="rfc.section.1.1.p.4">Nor does the act of engaging in a traditional second factor scheme offer proof of anything other than that the user was authenticated. Any correspondence between the act of authentication and the purpose for which the authentication was provided must be maintained separately.  </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Confirmation vs. Authentication</h1>
<p id="rfc.section.1.2.p.1">A second factor confirmation service addresses the limitations of traditional second factor authentication schemes.  </p>
<p id="rfc.section.1.2.p.2">A confirmation service allows the user experience to be precisely matched to the action that the user is attempted. Instead of beinf asked to read a random number from one device and enter it into another, the user is asked if they really want to perform the action for which authentication is requested.  </p>
<p id="rfc.section.1.2.p.3">A confirmation service offers better accountability for end users than a traditional authentication service.  An authentication service only provides an assertion that the user was present. A confirmation service provides an assertion that the user was present and that they confirmed a specific transaction.  </p>
<p id="rfc.section.1.2.p.4">For example, Alice has been granted access to a machine storing classified data. If an authentication service is used for access control, the authentication service log will only record the dates and times that Alice accessed the system. to find out if Alice accessed a particular file on a particular day it is necessary to consult and correlate both the authentication log of the system and the activity log for the application.  </p>
<p id="rfc.section.1.2.p.5">If instead a confirmation service is used the confirmation log contains an authenticated record of both the authentication events and the transactions for which the authentication was requested.  </p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> Use Scenarios</h1>
<p id="rfc.section.1.3.p.1">A confirmation service complements rather than replaces a traditional authentication scheme. Providing a highly secure and convenient means of authenticating requests that carry a high degree of risk mitigates the risk of using convenient but intrinsically low security techniques for other actions.  </p>
<h1 id="rfc.section.1.3.1">
<a href="#rfc.section.1.3.1">1.3.1.</a> Use in Financial Services</h1>
<p id="rfc.section.1.3.1.p.1">If an attacker is to profit from breaching a an account with a financial service such as a bank or a brokerage they must find a way to move money out of the account. Thus adding bill payment recipients, initiating wire transfers and trading in low volume 'penny stocks' represent high risk activities.  </p>
<p id="rfc.section.1.3.1.p.2">For example: Bank of Ethel might permit customers to use a simple username and password scheme to gain access to their account for the purpose of checking their balance or paying bills to existing reciepients but require use of the second factor confirmation device for a high risk transaction such as paying a bill.  </p>
<h1 id="rfc.section.1.3.2">
<a href="#rfc.section.1.3.2">1.3.2.</a> Machine Binding</h1>
<p id="rfc.section.1.3.2.p.1">A second factor confirmation service may be combined with a machine level authentication scheme to permit a transparent form of authentication for low risk transactions.  </p>
<p id="rfc.section.1.3.2.p.2">For example: Alice stores her low risk authentication credentials (e.g usernames and passwords) using a 'cloud' service. When she wishes to use those credentials an agent on her personal machine fetches credentials from the cloud service as necessary. When Alice wishes to access a site from a different machine she receives a confirmation request on her mobile device to grant access from that machine.  </p>
<p id="rfc.section.1.3.2.p.3">Use of such a mechanism is clearly more satisfactory when suitable cryptographic protocols such as SAML or Kerberos are employed to limit the disclosure and hence possible compromise of the credentials. The specification of such protocols is outside the scope of this document.  </p>
<h1 id="rfc.section.1.3.3">
<a href="#rfc.section.1.3.3">1.3.3.</a> Tethered Use</h1>
<p id="rfc.section.1.3.3.p.1">Although OWCP is designed for use in a three party scenario, there are situations in which a two party mode may be preferred.  </p>
<p id="rfc.section.1.3.3.p.2">For example: Bob is a roadwarrior who requires access to confidential documents stored on his laptop device from anywhere in the world, including locations where Internet access is not possible. To permit access in such circumstances, Bob's OWCP client supports use of a tethered mode in which the mobile device is plugged into his laptop via a USB port.  </p>
<p id="rfc.section.1.3.3.p.3">For example: Carol is a network manager of a large computing facility that uses OWCP to authenticate and track all changes to critical resources. Since OWCP is itself a network resource a bootstrap consideration arises: How can Carol confirm her network configuration requests using OWCP when the network itself is down? Support for a tethered mode in which the OWCP device communicates via USB or similar wired protocol allows this use case to be supported.  </p>
<p id="rfc.section.1.3.3.p.4">While availability of a tethered mode is clearly essential if OWCP is to be used in certain applications, support for this feature outside the scope of this version of the specification.  </p>
<h1 id="rfc.section.1.3.4">
<a href="#rfc.section.1.3.4">1.3.4.</a> Co-Browser</h1>
<p id="rfc.section.1.3.4.p.1">While OWCP is designed for deployment on a secondary device, deployment on the same device as the one for which confirmation is being requested is also possible and can provide security benefits.  </p>
<p id="rfc.section.1.3.4.p.2">Modern Web browsers are large and complex with many features such as support for mobile code that are incompatible with a high security environment. Separating the confirmation protocol from the Web Browsing protocol permits implementation in a minimal client designed to permit detailed security analysis.  Such a client might be embedded in or support means of secure interaction with a trustworthy operating system component.  </p>
<p id="rfc.section.1.3.4.p.3">While this means of deployment does not provide a true second factor confirmation, it is likely to provide a sufficient degree of authentication for many transactions.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Description</h1>
<p id="rfc.section.2.p.1">OWCP is a Web Service that permits a Requestor to request that a User confirm or reject a specified action. If the user responds, the response is signed with a digital signature under a key that is unique to the user account, the client and the device.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Parties</h1>
<p id="rfc.section.2.1.p.1">Each OWCP protocol interaction takes place between a connection pair of the following parties: </p>
<p></p>

<ul class="empty">
<li>A party that initiates a confirmation request.  </li>
<li>A clearing house that stores and forwards requests from requestors and responses from Clients. The dispatcher is only trusted to perform routing filtering and recording of requests and responses.  The dispatcher is not trusted with respect to the responses returned.  </li>
<li>A Dispatcher Service MAY impose a use policy on Requestors, Clients and Users.  </li>
<li>Issue and maintenance of Client Device credentials is a trusted function that is logically independent of the store and forward operation of the Dispatcher.  </li>
<li>The Client interacts with the User and the Dispatcher.  If Dispatcher policy permits, a User MAY register multiple Devices to serve as confirmation devices for the same account. In this case each Device MUST have a separate signature key.  </li>
<li>The User is the person being asked to grant or refuse confirmation. A User MAY have multiple accounts with multiple Dispatcher Services.  </li>
</ul>

<p> </p>
<div id="#rfc.figure.1"></div>
<pre>
            
+-------------+         +------------+         +-------------+
|  Requestor  | &lt;-----&gt; | Dispatcher | &lt;------ |   Client    |
+-------------+         +------------+         +-------------+
                               ^                      ^
                               |                      |
                               V                      V
                        +------------+         +-------------+
                        |     PKI    |         |     User    |
                        +------------+         +-------------+

          </pre>
<h1 id="rfc.section.2.1.1">
<a href="#rfc.section.2.1.1">2.1.1.</a> Accounts</h1>
<p id="rfc.section.2.1.1.p.1">Users and Requestors are identified by means of an account identifier. The display presentation of an account identifier is the form of an RFC2822 email address identifier without the enclosing angle braces, for example: </p>
<p id="rfc.section.2.1.1.p.2">alice@example.com </p>
<p id="rfc.section.2.1.1.p.3">The account identifier is used by the User when registering the use of the confirmation service with a dispatcher.  </p>
<h1 id="rfc.section.2.1.1.1">
<a href="#rfc.section.2.1.1.1">2.1.1.1.</a> Dispatcher Discovery</h1>
<p id="rfc.section.2.1.1.1.p.1">The domain component of the account identifier is the DNS name of the corresponding Dispatcher Web Service.  </p>
<p id="rfc.section.2.1.1.1.p.2">DNS Service discovery is used by Requestors and Clients to discover the Dispatcher service corresponding to a specified account.  </p>
<h1 id="rfc.section.2.1.1.2">
<a href="#rfc.section.2.1.1.2">2.1.1.2.</a> Third Party Domain Names</h1>
<p id="rfc.section.2.1.1.2.p.1">OWCP requires that the provider of a Dispatcher service have control over the DNS names used in the corresponding account identifiers.  </p>
<p id="rfc.section.2.1.1.2.p.2">It is thus not possible for any party other than the holder of the domain name example.com to provide OWCP service for alice@example.com. If Alice, the holder of the alice@example.com email address wishes to use an OWCP confirmation service, her choices are limited to persuading the holder of example.com to provide an OWCP dispatcher service and allow her to use her email identifier or registering with another confirmation service provider and accepting a different identifier.  </p>
<p id="rfc.section.2.1.1.2.p.3">Requiring a strong binding between the Dispatcher service and the account identifier permits the use of the account identifier to be used as a proxy for authorization.  </p>
<h1 id="rfc.section.2.1.1.3">
<a href="#rfc.section.2.1.1.3">2.1.1.3.</a> Open and Closed Services</h1>
<p id="rfc.section.2.1.1.3.p.1">An OWCP service MAY be Open or Closed. An Open service provider provides OWCP service to the general public. A Closed service provider only provides service to a specific community.  </p>
<p id="rfc.section.2.1.1.3.p.2">For example: An Internet Service Provider or DNS Registrar might provide an open OWCP service as a part of their standard service offering to customers. An employer might operate a closed OWCP service to be used for company business.  </p>
<h1 id="rfc.section.2.1.2">
<a href="#rfc.section.2.1.2">2.1.2.</a> User Experience</h1>
<p id="rfc.section.2.1.2.p.1">Since the purpose of OWCP is to support user interaction, the user experience is an important part of the OWCP specification.  </p>
<p id="rfc.section.2.1.2.p.2">While the realization of the User Experience is outside the scope of the specification, the specification will inevitably constrain the User Experiences that an implementer can provide.  </p>
<h1 id="rfc.section.2.1.2.1">
<a href="#rfc.section.2.1.2.1">2.1.2.1.</a> Dispatcher Subscription</h1>
<p id="rfc.section.2.1.2.1.p.1">Dispatcher Subscription is the procedure whereby a User creates an account with a new account identifier.  </p>
<p id="rfc.section.2.1.2.1.p.2">OWCP Dispatcher Subscription is equivalent to establishing an account for email or for computer access.  </p>
<h1 id="rfc.section.2.1.2.2">
<a href="#rfc.section.2.1.2.2">2.1.2.2.</a> Registration</h1>
<p id="rfc.section.2.1.2.2.p.1">To make use of a Client, A User must register it for use with at least one OWCP account.  </p>
<p id="rfc.section.2.1.2.2.p.2">If the User is attempting to register a Client for use with an existing account, the registration request SHOULD be authenticated to ensure that the it comes from the authorized account holder. A One Time Use authentication code or a confirmation from a device that has already been registered MAY be used for this purpose.  </p>
<p id="rfc.section.2.1.2.2.p.3">A Client MAY support a mode in which the Dispatcher Subscription procedure is combined with registration. In this case the Dispatcher service policy MAY permit registration without additional authentication if the account has never existed before.  </p>
<h1 id="rfc.section.2.1.2.3">
<a href="#rfc.section.2.1.2.3">2.1.2.3.</a> Requestor Subscription</h1>
<p id="rfc.section.2.1.2.3.p.1">To make use of OWCP with a requestor, a User simply provides their OWCP account identifier.  </p>
<p id="rfc.section.2.1.2.3.p.2">In the case that the OWCP account identifier is also the email address supplied when the User established an account with the Requestor, the Requestor MAY perform the subscription process automatically.  </p>
<h1 id="rfc.section.2.1.2.4">
<a href="#rfc.section.2.1.2.4">2.1.2.4.</a> Confirmation</h1>
<p id="rfc.section.2.1.2.4.p.1">In the typical case, use of the Confirmation service is triggered by a User request to the Requestor or an event that requires the User's attention.  </p>
<p id="rfc.section.2.1.2.4.p.2">For example: Alice attempts to access the personnel file causing the access control system to generate a confirmation request that is received on Alice's mobile device. Alice accepts the confirmation and access is granted.  </p>
<p id="rfc.section.2.1.2.4.p.3">For example: Bob is working as a network manager and the datacenter cooling system has started leaking. He attempts to engage an emergency plumming service which in turn requires authorization from Carol, the Finance Director.  </p>
<h1 id="rfc.section.2.1.3">
<a href="#rfc.section.2.1.3">2.1.3.</a> Examples of Use [Non Normative]</h1>
<p id="rfc.section.2.1.3.p.1">For clarity, only the XML Message component of the requests are shown.  The HTTP Headers and CMS packaging is omitted.  </p>
<h1 id="rfc.section.2.1.3.1">
<a href="#rfc.section.2.1.3.1">2.1.3.1.</a> Access Control</h1>
<p id="rfc.section.2.1.3.1.p.1">Alice (alice@example.com) is an employee of Example Corp.  She is attempting to log into the corporporate network from the laptop (#234) issued by her employer.  </p>
<p id="rfc.section.2.1.3.1.p.2">When Alice attempts to connect to the VPN, the VPN generates the following request and sends it to the Dispatcher service that services example.com: </p>
<div id="#rfc.figure.2"></div>
<pre>
                
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;Request xmlns="http://schema.comodo.com/2011/owcp/0.1"&gt;
  &lt;Header issued="2011-06-08T09:30:10Z" 
          identifier="http://access.example.com/2737827178"
          type="Access"&gt;
    &lt;From&gt;access@example.com&lt;/From&gt;
    &lt;To&gt;alice@example.com&lt;/To&gt;
    &lt;Verification&gt;PIN&lt;/Verification&gt;
    &lt;Summary&gt;Do you wish to connect to the corporate network from 
    Laptop #234 issued to Alice?&lt;/Summary&gt;
  &lt;/Header&gt;
&lt;/Request&gt;

              </pre>
<p id="rfc.section.2.1.3.1.p.3">If Alice's mobile device supports a notification service this MAY be used to alert Alice to the fact that a new confirmation request is pending. Alternatively, Alice picks up her mobile device and starts the confirmation client manualy. In either case, Alice is shown the following dialog: </p>
<div id="#rfc.figure.3"></div>
<pre>
                
From:  access@example.com
To:    alice@example.com

Do you wish to connect to the corporate 
network from Laptop #234 issued to Alice?

      [Accept]   [Reject]

              </pre>
<p id="rfc.section.2.1.3.1.p.4">Since the request specifies PIN verification, Alice is asked to provide her PIN before a response can be generated.  Note that the PIN MUST be supplied regardless of whether the action is accepted or rejected.  </p>
<p id="rfc.section.2.1.3.1.p.5">Alice accepts the request and the client generates a receipt message that contains the original request message and Alice's response. The receipt message is then digitally signed using a signature key that is unique to the account, device and the client.  </p>
<div id="#rfc.figure.4"></div>
<pre>
                
[TBS response]

              </pre>
<p id="rfc.section.2.1.3.1.p.6">The reciept is sent to the dispatcher which forwards at least the result of the request to the Requestor.  </p>
<p id="rfc.section.2.1.3.1.p.7">In this case the Requestor is trusted to receive digitally signed responses for the specific action requested and the original request and signature is forwarded to the Requestor.  </p>
<h1 id="rfc.section.2.1.3.2">
<a href="#rfc.section.2.1.3.2">2.1.3.2.</a> Payment</h1>
<p id="rfc.section.2.1.3.2.p.1">A confirmation service MAY be used to support payment transactions. In this use case there is often a need to present the User with both a high level summary of the action being requested and a more detailed description.  </p>
<p id="rfc.section.2.1.3.2.p.2">The following message asks Alice if she wishes to transfer a sum of money to a person she met in an Internet chat room.  </p>
<div id="#rfc.figure.5"></div>
<pre>
                
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;Request xmlns="http://schema.comodo.com/2011/owcp/0.1"&gt;
  &lt;Header issued="2011-06-08T09:30:10Z" 
          identifier="http://access.example.com/2737827178"
          type="Payment"&gt;
    &lt;From&gt;access@example.com&lt;/From&gt;
    &lt;To&gt;alice@example.com&lt;/To&gt;
    &lt;Verification&gt;PIN&lt;/Verification&gt;
    &lt;Summary&gt;Do you wish to transfer &lt;Money currency="usd" 
    amount="9825.00"/&gt; to the account of Barrister Mugu 
    #666-201919 at Bank of Nigeria?
  &lt;/Summary&gt;
  &lt;/Header&gt;
  &lt;Body&gt;
    &lt;P&gt;
      Form of transfer: Wire
    &lt;/P&gt;
    &lt;Table&gt;
      &lt;TH&gt;
        &lt;TD&gt;
          Item
        &lt;/TD&gt;
        &lt;TD&gt;
          Amount
        &lt;/TD&gt;
      &lt;/TH&gt;
      &lt;TR&gt;
        &lt;TD&gt;
          Expeditiary Fee
        &lt;/TD&gt;
        &lt;TD&gt;
          &lt;Money currency="usd" amount="9825.00"/&gt;
        &lt;/TD&gt;
      &lt;/TR&gt;
    &lt;/Table&gt;
  &lt;/Body&gt;
&lt;/Request&gt;

              </pre>
<p id="rfc.section.2.1.3.2.p.3">In this case Alice (wisely) declines the request.  </p>
<div id="#rfc.figure.6"></div>
<pre>
                
[TBS response]

              </pre>
<h1 id="rfc.section.2.1.3.3">
<a href="#rfc.section.2.1.3.3">2.1.3.3.</a> Ticket and Transaction Acknowledgement</h1>
<p id="rfc.section.2.1.3.3.p.1">In the case that the confirmation service is used to authenticate a purchase for non-tangible goods, it is in some cases convenient to deliver the goods themselves through the confirmation service client.  In this case the receipt is also the ticket.  </p>
<p id="rfc.section.2.1.3.3.p.2">Alice purchases tickets for a concert tour. The ticket and the instructions to find her seat are returned to her through the confirmation service.  </p>
<p id="rfc.section.2.1.3.3.p.3">The Requestor sends the following message to the dispatcher: </p>
<div id="#rfc.figure.7"></div>
<pre>
                
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;Request xmlns="http://schema.comodo.com/2011/owcp/0.1"&gt;
  &lt;Header issued="2011-06-08T09:30:10Z" 
          identifier="http://tickets.example.com/23iudi2u"
          type="Acknowledgement"&gt;
    &lt;From&gt;concerts@example.com&lt;/From&gt;
    &lt;To&gt;alice@example.com&lt;/To&gt;
    &lt;Summary&gt;
      Tickets for Spinal Tap Reonion Tour DC 24th June Seats A15+A16
    &lt;/Summary&gt;
  &lt;/Header&gt;
  &lt;Body&gt;
    &lt;P&gt;
      This is your ticket.
    &lt;/P&gt;
    &lt;P&gt;
      Present the barcode to the barcode reader at the turnstile.
    &lt;/P&gt;
    &lt;Barcode width="33" height="33" data="wusdjkw2owehofwoih=="/&gt;

  &lt;/Body&gt;
&lt;/Request&gt;

              </pre>
<p id="rfc.section.2.1.3.3.p.4">When Alice receives the message on her mobile device it displays a 2D barcode that can be read at the turnstile. Alice gains admission to the concert without the need to queue at the ticket booth.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Protocol Messages</h1>
<p id="rfc.section.3.p.1">OWCP protocol messages are defined here in an abstract form to permit them to be expressed in different protocol bindings. OWCP 0.1 services MUST support the HTTP+CMS binding defined in section [].  </p>
<p id="rfc.section.3.p.2">OWCP messages MUST be exchanged over an encrypted, authenticated transport such as TLS or IPSEC.  OWCP 0.1 services MUST support use of TLS transport.  </p>
<p id="rfc.section.3.p.3">Since the function of the Dispatcher is to store and forward messages, a sequence of OWCP messages will always be initiated by either a Requestor or a Client.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Common Format</h1>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> Request</h1>
<p id="rfc.section.3.1.1.p.1">All OWCP request messages specify an operation code.  </p>
<p id="rfc.section.3.1.1.p.2">The following parameters are common to all requests.  </p>
<p></p>

<dl>
<dt>Transaction [Transaction Identifier][Required]</dt>
<dd style="margin-left: 8">The transaction identifier is unique for all requests except for RD-Status, RD-Final and DR-Complete in which case the transaction identifier of the original transaction for which status is being requested is used.  </dd>
<dt>Certificate Chain [Attachment][Optional]</dt>
<dd style="margin-left: 8">Certificate chain for the public key used in the Signature.  </dd>
<dt>Authentication [Authentication Code][Optional]</dt>
<dd style="margin-left: 8">Digital Signature or Message Authentication Code of the Request.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.1.2">
<a href="#rfc.section.3.1.2">3.1.2.</a> Response</h1>
<p id="rfc.section.3.1.2.p.1">All responses return a response code. The following response codes are defined: </p>
<p></p>

<dl>
<dt>200 Success</dt>
<dd style="margin-left: 8">The operation succeeded and the result of the operation is returned.  </dd>
<dt>303 Incomplete</dt>
<dd style="margin-left: 8">The operation requested by the Requestor has not completed and the result of the operation will be returned asynchronously.  </dd>
<dt>400 Bad Request</dt>
<dd style="margin-left: 8"></dd>
<dt>401 Unauthorized</dt>
<dd style="margin-left: 8">The Requestor or Client is not permitted to perform the requested operation..  </dd>
<dt>404 Not Found</dt>
<dd style="margin-left: 8">The requested User account or Transaction ID was not found.  </dd>
<dt>408 Timeout</dt>
<dd style="margin-left: 8">The requested operation did not complete in the specified time or status was requested for a transaction that has expired.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.1.2.p.3">In addition an OWCP service MAY return any error or status code defined by the protocol binding and/or the transport layer.  </p>
<p id="rfc.section.3.1.2.p.4">The following parameters are common to all responses: </p>
<p></p>

<dl>
<dt>Transaction [Transaction Identifier][Required]</dt>
<dd style="margin-left: 8">The transaction identifier of the original request.  </dd>
<dt></dt>
<dd style="margin-left: 8">Note that the transaction identifier is a required parameter for the protocol even though its value might be implicit from the context in many protocol bindings (e.g. HTTP).  This is necessary to ensure that the authentication of the response also covers the request.  </dd>
<dt>Certificate Chain [Attachment][Optional]</dt>
<dd style="margin-left: 8">Certificate chain for the public key used in the Signature.  </dd>
<dt>Authentication [Authentication Code][Optional]</dt>
<dd style="margin-left: 8">Digital Signature or Message Authentication Code of the Request.  </dd>
<dt>Request-Link [Digest][Optional]</dt>
<dd style="margin-left: 8">Message Digest of the Request. This is only relevant when a response is digitally signed and allows the response to be cryptographically linked to the original request.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Requestor to Dispatcher</h1>
<p id="rfc.section.3.2.p.1">Operations initiated by the Responder are logically a single request followed by a single response but may take longer to complete than it is desiable for the Responder to wait for a status code. Support for asynchronous completion is therefore necessary.  </p>
<p id="rfc.section.3.2.p.2">If the Dispatcher is unable to complete an operation immediately it MUST return the Incomplete response code.  A Responder MAY recover the result of an incomplete operation by polling using the STATUS operation or by accepting asynchronous completion by means of the Complete operation.  </p>
<p id="rfc.section.3.2.p.3">In order to accept asynchronous completion of a request, a dispatcher specifies the </p>
<p id="rfc.section.3.2.p.4">Dispatchers MUST support completion of incomplete operations by use of the polling mechanism and MAY support asynchronous completion by means of the Complete operation.  </p>
<div id="#rfc.figure.8"></div>
<pre>
            
+------------+         +-------------+
| Requestor  | ....... |  Dispatcher |
+------------+         +-------------+

               Request
               ------&gt;
               Resonse
               &lt;------

              [Complete]
               &lt;------
             [Acknolwedge]
               ------&gt;

          </pre>
<p id="rfc.section.3.2.p.5">The following parameters are common to all RD-Operation requests: </p>
<p></p>

<dl>
<dt>Reply-To [DNS Name][Optional]</dt>
<dd style="margin-left: 8">DNS Name of a server that will accept completion of the request via the DR-Complete operation.  </dd>
<dt>Expiry [Date Time][Optional]</dt>
<dd style="margin-left: 8">A date and time beyond which the result of the request is no longer relevant. A Dispatcher MAY refuse to recognize the expiry term requested by Requestor and impose its own limit which MAY be shorter or longer.  </dd>
<dt></dt>
<dd style="margin-left: 8">A Responder SHOULD NOT rely on an expiry time of less than ten minutes for any operation that requires User interaction. Machines should serve people, not the other way round.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> Operation RD-Confirm</h1>
<p id="rfc.section.3.2.1.p.1">The RD-Confirm operation is used to present a confirmation request to the User with the Dispatcher and Client(s) acting as intermediaries.  </p>
<h1 id="rfc.section.3.2.1.1">
<a href="#rfc.section.3.2.1.1">3.2.1.1.</a> RD-Confirm Request</h1>
<p id="rfc.section.3.2.1.1.p.1">The RD-Confirm request takes the following parameters: </p>
<p></p>

<dl>
<dt>Registration [Registrarion Identifier][Optional]</dt>
<dd style="margin-left: 8">Registration identifier assigned by the Dispatcher to represent the Dispatcher-Responder relationship in a prior Registration operation.  </dd>
<dt>Expiry [Date Time][Optional]</dt>
<dd style="margin-left: 8">Date and Time at which the confirmation request will expire.  </dd>
<dt>Message [Attachment/XML][Optional]</dt>
<dd style="margin-left: 8">The Confirmation request message formatted according to the XML schema specified in section [XXX] </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2.1.2">
<a href="#rfc.section.3.2.1.2">3.2.1.2.</a> RD-Confirm Response</h1>
<p></p>

<dl>
<dt>Reply [Attachment/XML][Optional]</dt>
<dd style="margin-left: 8">The Confirmation response message formatted according to the XML schema specified in section [XXX] </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> Operation RD-Register</h1>
<p id="rfc.section.3.2.2.p.1">The RD-Register operation allows a Requestor to pre-register with a Dispatcher. This allows the Responder to check that it is likely to be able to use the confirmation service before relying on it.  </p>
<p id="rfc.section.3.2.2.p.2">The RD-Register operation is essentially a confirmation request without the actual confirmation.  </p>
<p id="rfc.section.3.2.2.p.3">Use of the RD-Register operation is optional according to the OWCP protocol but MAY be required by the dispatcher policy.  </p>
<h1 id="rfc.section.3.2.2.1">
<a href="#rfc.section.3.2.2.1">3.2.2.1.</a> RD-Register Request</h1>
<p id="rfc.section.3.2.2.1.p.1">Operation Code: RD-Register </p>
<p></p>

<dl>
<dt>Responder [Account Identifier][Optional]</dt>
<dd style="margin-left: 8">The account identifier the responder is attempting to register. This is only required in cases where the dispatcher needs to check the responder account against the certificate chain.  </dd>
<dt>User [Account Identifier][Optional]</dt>
<dd style="margin-left: 8">The account identifier a specific user that the responder is attempting to register. If no account is specified the Responder is attempting to register for all accounts.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2.2.2">
<a href="#rfc.section.3.2.2.2">3.2.2.2.</a> RD-Register Response</h1>
<p></p>

<dl>
<dt>Registration [Registrarion Identifier][Required]</dt>
<dd style="margin-left: 8">Registration identifier assigned by the Dispatcher to represent the Dispatcher-Responder relationship.  </dd>
<dt>Scope [Scope][Optional]</dt>
<dd style="margin-left: 8">If the Scope is specified as 'User', the registration is accepted for that specific user alone. If the scope is specified as 'global' the registration is applies to all User accounts held by the dispatcher.  </dd>
<dt>Policy [Attachment/XML][Optional]</dt>
<dd style="margin-left: 8">Dispatcher policy statement.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2.3">
<a href="#rfc.section.3.2.3">3.2.3.</a> Operation RD-Deregister</h1>
<p id="rfc.section.3.2.3.p.1">The RD-Deregister operation cancels a previous registration request.  </p>
<h1 id="rfc.section.3.2.3.1">
<a href="#rfc.section.3.2.3.1">3.2.3.1.</a> RD-Deregister Request</h1>
<p id="rfc.section.3.2.3.1.p.1">Operation Code: RD-Deregister </p>
<p></p>

<dl>
<dt>Registration [Registrarion Identifier][Required]</dt>
<dd style="margin-left: 8">Registration identifier assigned by the Dispatcher to represent the Dispatcher-Responder relationship in the original RD-Register operation.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2.3.2">
<a href="#rfc.section.3.2.3.2">3.2.3.2.</a> RD-Deregister Response</h1>
<p id="rfc.section.3.2.3.2.p.1">No additional data is returned if the operation succeeds </p>
<h1 id="rfc.section.3.2.4">
<a href="#rfc.section.3.2.4">3.2.4.</a> Operation RD-Status</h1>
<p id="rfc.section.3.2.4.p.1">The operation RD-Status is used to request the result of an earlier request made by that Responder.  </p>
<h1 id="rfc.section.3.2.4.1">
<a href="#rfc.section.3.2.4.1">3.2.4.1.</a> RD-Status Request</h1>
<p id="rfc.section.3.2.4.1.p.1">No additional parameters are specified.  </p>
<h1 id="rfc.section.3.2.4.2">
<a href="#rfc.section.3.2.4.2">3.2.4.2.</a> RD-Status Response</h1>
<p id="rfc.section.3.2.4.2.p.1">If successful the RD-Status response returns the parameters defined for the original transaction request.  </p>
<h1 id="rfc.section.3.2.5">
<a href="#rfc.section.3.2.5">3.2.5.</a> Operation RD-Final</h1>
<p id="rfc.section.3.2.5.p.1">The operation RD-Final is used to request the result of an earlier request made by that Responder and cancel the request if it has not yet completed.  </p>
<h1 id="rfc.section.3.2.5.1">
<a href="#rfc.section.3.2.5.1">3.2.5.1.</a> RD-Final Request</h1>
<p id="rfc.section.3.2.5.1.p.1">No additional parameters are specified.  </p>
<h1 id="rfc.section.3.2.5.2">
<a href="#rfc.section.3.2.5.2">3.2.5.2.</a> RD-Final Response</h1>
<p id="rfc.section.3.2.5.2.p.1">If the original operation completed successfully, the RD-Final response returns the parameters defined for the original transaction request.  </p>
<p id="rfc.section.3.2.5.2.p.2">If the Dispatcher accepts the request to attempt to cancel the operation the response code 408 Timeout is returned. But returning this response code in an RD-Final response does not guarantee that the operation will not be completed subsequently.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Dispatcher to Requestor</h1>
<p id="rfc.section.3.3.p.1">The only circumstance in which a Dispatcher initiates a protocol exchange is when it is providing an asynchronous completion response for a previous request.  </p>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> Operation DR-Complete</h1>
<p id="rfc.section.3.3.1.p.1">The DR-Complete operation returns the result of a previously requested operation for which an Incomplete status was returned.  </p>
<h1 id="rfc.section.3.3.1.1">
<a href="#rfc.section.3.3.1.1">3.3.1.1.</a> DR-Complete Request</h1>
<p id="rfc.section.3.3.1.1.p.1">The request contains the result of the original response:</p>
<p></p>

<dl>
<dt>Status [Response Code][Required]</dt>
<dd style="margin-left: 8">The response code of the request.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.3.1.1.p.3">If the operation was successful, the DR-Complete response returns the parameters defined for the original transaction request.  </p>
<h1 id="rfc.section.3.3.1.2">
<a href="#rfc.section.3.3.1.2">3.3.1.2.</a> DR-Complete Response</h1>
<p id="rfc.section.3.3.1.2.p.1">No additional parameters are specified.  </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Client to Dispatcher</h1>
<p id="rfc.section.3.4.p.1">Protocol exchanges between the Dispatcher and the Client consist of a single request from the Client followed by a single response from the Dispatcher.  </p>
<div id="#rfc.figure.9"></div>
<pre>

+------------+         +-------------+
| Dispatcher | ....... |   Client    |
+------------+         +-------------+

               Request
               &lt;------
               Resonse
               ------&gt;


          </pre>
<h1 id="rfc.section.3.4.1">
<a href="#rfc.section.3.4.1">3.4.1.</a> Operation CD-Register</h1>
<p id="rfc.section.3.4.1.p.1">The CD-Register operation is used to register a Client to a Dispatcher.  </p>
<h1 id="rfc.section.3.4.1.1">
<a href="#rfc.section.3.4.1.1">3.4.1.1.</a> CD-Register Request</h1>
<p id="rfc.section.3.4.1.1.p.1">The CD-Register request specifies the following parameters: </p>
<p></p>

<dl>
<dt>Account [Account Identifier][Required]</dt>
<dd style="margin-left: 8">Account identifier for the account being requested.  </dd>
<dt>Passphrase [String][Optional]</dt>
<dd style="margin-left: 8">Optional Passphrase value that MAY be used by the Dispatcher to authenticate the registration request.  </dd>
<dt>Key [Attachment][Required]</dt>
<dd style="margin-left: 8">Key to be used to authenticate messages from the client to the Dispatcher.  </dd>
<dt>Client [Client Identifier][Optional]</dt>
<dd style="margin-left: 8">Client identifier returned in a previous registration request.  </dd>
<dt></dt>
<dd style="margin-left: 8">The client identifier is only specified by a client in the case of a rekeying operation.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.4.1.2">
<a href="#rfc.section.3.4.1.2">3.4.1.2.</a> CD-Register Response</h1>
<p id="rfc.section.3.4.1.2.p.1">The CD-Register response specifies the following parameters: </p>
<p></p>

<dl>
<dt>Client [Client Identifier][Optional]</dt>
<dd style="margin-left: 8">Identifier that the Client MUST use in future interactions with the dispatcher under this account.  </dd>
<dt></dt>
<dd style="margin-left: 8"></dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.4.2">
<a href="#rfc.section.3.4.2">3.4.2.</a> Operation CD-Deregister</h1>
<p id="rfc.section.3.4.2.p.1">The CD-Deregister operation is used to unregister a previously registered Client.  </p>
<p id="rfc.section.3.4.2.p.2">Note that a Client may also be deregistered through other, out of band mechsanisms. For example through an account management interface for the account.  </p>
<h1 id="rfc.section.3.4.2.1">
<a href="#rfc.section.3.4.2.1">3.4.2.1.</a> CD-Deregister Request</h1>
<p id="rfc.section.3.4.2.1.p.1">The Deregister request specifies only the client identifier.  </p>
<p></p>

<dl>
<dt>Client [Client Identifier][Optional]</dt>
<dd style="margin-left: 8">Client identifier.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.4.2.2">
<a href="#rfc.section.3.4.2.2">3.4.2.2.</a> CD-Deregister Response</h1>
<p id="rfc.section.3.4.2.2.p.1">The Deregister response only reports success or failure.  </p>
<p id="rfc.section.3.4.2.2.p.2">[TBS Should it tell the user that they have other devices?] </p>
<h1 id="rfc.section.3.4.3">
<a href="#rfc.section.3.4.3">3.4.3.</a> Operation CD-List</h1>
<p id="rfc.section.3.4.3.p.1">The CD-List operation is used to request that the Dispatcher return all pending confirmations.  </p>
<h1 id="rfc.section.3.4.3.1">
<a href="#rfc.section.3.4.3.1">3.4.3.1.</a> CD-List Request</h1>
<p id="rfc.section.3.4.3.1.p.1">The CD-List request takes the following parameters: </p>
<p></p>

<dl>
<dt>Client [Client Identifier][Required]</dt>
<dd style="margin-left: 8">Registration identifier assigned by the Dispatcher to represent the Client-Responder relationship in a prior Registration operation.  </dd>
<dt>Since [Transaction Identifier][Optional]</dt>
<dd style="margin-left: 8">If specified directs the server to only return confirmation messages recieved since the specified transaction identifier.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.4.3.2">
<a href="#rfc.section.3.4.3.2">3.4.3.2.</a> RD-List Response</h1>
<p id="rfc.section.3.4.3.2.p.1">If successful, the CD-List response takes the following parameters: </p>
<p></p>

<dl>
<dt>Now [Transaction Identifier][Optional]</dt>
<dd style="margin-left: 8">Specifies an identifier that the client can specify in a request to indicate that the </dd>
<dt>Requests [Attachment/Multipart][Required]</dt>
<dd style="margin-left: 8">A sequence of confirmation requests packaged as a multipart object.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.4.4">
<a href="#rfc.section.3.4.4">3.4.4.</a> Operation CD-Reply</h1>
<p id="rfc.section.3.4.4.p.1">The CD-Reply Operation is used by the client to notify the Dispatcher that the user has responded to a confirmation request.  </p>
<h1 id="rfc.section.3.4.4.1">
<a href="#rfc.section.3.4.4.1">3.4.4.1.</a> CD-Reply Request</h1>
<p id="rfc.section.3.4.4.1.p.1">The CD-Reply Request specifies the transaction identifier of the confirmation for which a reply is being given and a response value.  </p>
<p></p>

<dl>
<dt>Transaction [Transaction Identifier][Required]</dt>
<dd style="margin-left: 8">The transaction identifier being responded to.  </dd>
<dt>Response [String][Required]</dt>
<dd style="margin-left: 8">The response value.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.4.4.2">
<a href="#rfc.section.3.4.4.2">3.4.4.2.</a> CD-Reply Response</h1>
<p id="rfc.section.3.4.4.2.p.1">The CD-Reply operation only returns a status code value. No additional parameters are returned.  </p>
<p id="rfc.section.3.4.4.2.p.2">[TBS May want to revist this. Wouldn't a client want to be able to confirm that an asyn completion has in fact been delivered?] </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Service Discovery</h1>
<p id="rfc.section.4.p.1">Requestors and Clients discover the client using DNS service discovery.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> ESRV Discovery</h1>
<p id="rfc.section.4.1.p.1">Requestors and Clients MUST support the ESRV discovery Mechanism and the SRV and URI extended discovery mechanisms.  </p>
<h1 id="rfc.section.4.1.1">
<a href="#rfc.section.4.1.1">4.1.1.</a> ESRV Properties</h1>
<p id="rfc.section.4.1.1.p.1">ESRV properties permit clients and servers to negotiate service protocol and properties such as the protocol version and/or protocol binding.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Manual Discovery</h1>
<p id="rfc.section.4.2.p.1">ESRV service discovery depends on support for new DNS Resource Record types at the DNS Resolver used.  Clients SHOULD and Requestors MAY support manual configuration of the Dispatcher service.  </p>
<p id="rfc.section.4.2.p.2">Manual configuration does not provide the support for redundancy or fault tolerance provided in the ESRV discovery mechanism.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Bindings</h1>
<p id="rfc.section.5.p.1">The abstract OWCP protocol is mapped to the wire-transport by means of a binding. Currently only one binding is defined.  </p>
<p id="rfc.section.5.p.2">OWCP Responders and Dispatchers MUST support the HTTP/JSON binding and MAY support other bindings.  </p>
<p id="rfc.section.5.p.3">OWCP Clients SHOULD support the HTTP/JSON binding and MAY support other bindings.  </p>
<p></p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> HTTP/JSON Binding</h1>
<p id="rfc.section.5.1.p.1">The HTTP/JSON binding is designed to permit efficient implementation of an OWCP Requestor or Dispatcher without the need for XML support beyond the ability to generate Confirmation messages.  </p>
<h1 id="rfc.section.5.1.1">
<a href="#rfc.section.5.1.1">5.1.1.</a> Transport</h1>
<h1 id="rfc.section.5.1.2">
<a href="#rfc.section.5.1.2">5.1.2.</a> HTTP Encapsulation</h1>
<p id="rfc.section.5.1.2.p.1">The service discovery process returns the Web Service Endpoint og the OWCP service as a URI.  </p>
<p id="rfc.section.5.1.2.p.2">OWCP requests are mapped to HTTP Requests as follows: </p>
<p></p>

<dl>
<dt>Method</dt>
<dd style="margin-left: 8">The request method is always POST.  </dd>
<dt>Request URI</dt>
<dd style="margin-left: 8">The request URI consists of the web service endpoint concatenated with a '/' character concatenated with the OWCP operation code.  </dd>
<dt>Content-Encoding</dt>
<dd style="margin-left: 8">The Content Encoding type MUST be either "8bit" or "Binary".  </dd>
<dt>Content</dt>
<dd style="margin-left: 8">The content of the request message is a Binary Multipart Container in which the first data segment MUST be the JSON parameter block.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.5.1.3">
<a href="#rfc.section.5.1.3">5.1.3.</a> Binary Multipart Container</h1>
<p id="rfc.section.5.1.3.p.1">An OWCP message typically contains X.509 certificate chains, XML data objects and other data objects most suitably exchanged in binary form. The Binary Multipart representation is used to encapsulate the message parameter object and related attachments as binary objects.  </p>
<p id="rfc.section.5.1.3.p.2">A Binary Multipart Container consists of a sequence of data segments.  </p>
<h1 id="rfc.section.5.1.3.1">
<a href="#rfc.section.5.1.3.1">5.1.3.1.</a> Data Segment Format</h1>
<p id="rfc.section.5.1.3.1.p.1">A Data Segment consists of a sequence of a segment type identifier followed by a sequence of sections as specified by the segment type identifier.  </p>
<p></p>

<ul class="empty">
<li>Indicates that a parameter label item is present.  </li>
<li>Indicates that a MIME Content-Type item is present.  </li>
<li>Indicates that an Identifier is present.  </li>
<li>Indicates that a Data section is present.  </li>
<li>Indicates that an Object Digest Identifier of the Data section is present.  </li>
<li>Reserved for future use.  </li>
<li>If set the data segment is the final segment in the container. Otherwise at least one more data segment follows.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.5.1.3.2">
<a href="#rfc.section.5.1.3.2">5.1.3.2.</a> Data Section Format</h1>
<p id="rfc.section.5.1.3.2.p.1">Data sections are presented in the same order as the segment type identifier bits starting with the low order bit.  </p>
<p id="rfc.section.5.1.3.2.p.2">Each data section consists of a length specifier followed by the corresponding data.  </p>
<p id="rfc.section.5.1.3.2.p.3">ASN.1 length encoding format is used to represent the length specifier.  </p>
<p id="rfc.section.5.1.3.2.p.4">For length values less than 128 octets, the length is represented as a single octet and consists of the length value.  </p>
<p id="rfc.section.5.1.3.2.p.5">For longer lengths, the high order bit of the first order octet is 1 and the remaining 7 bits specify the number of octets following used to specify the length.  </p>
<p id="rfc.section.5.1.3.2.p.6">For example: A data segment that contains a MIME Content-Type section and a Data section will have the segment type specifier 5 (00000101 in binary). The first section will contain the Content-Type and the Second section the Data value.  </p>
<p id="rfc.section.5.1.3.2.p.7">Contrary to the practice in ASN.1 DER encoding, the length specifier MAY contain leading zeros. Thus the octet sequence '0x13', the octext sequence '0x11 0x13' and the octet sequence '0x14 0x00 0x00 0x00 0x13' are all valid and each specifies that the length of the following data is 19 octets.  </p>
<h1 id="rfc.section.5.1.4">
<a href="#rfc.section.5.1.4">5.1.4.</a> JSON Object Syntax</h1>
<p id="rfc.section.5.1.4.p.1">OWCP data objects are encoded using the JSON syntax [TBS].  </p>
<p id="rfc.section.5.1.4.p.2">The correspondance between OWCP data types and JSON object types is given below: </p>
<p id="rfc.section.5.1.4.p.3">[TBS] </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Request Schema</h1>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Namespace</h1>
<p id="rfc.section.6.1.p.1">The OWCP Request schema is defined in W3C XML Schema notation.  The version specified in this document has the following namespace assigned: </p>
<p id="rfc.section.6.1.p.2">XML Namespace: http://schema.comodo.com/2011/owcp/0.1 </p>
<div id="#rfc.figure.10"></div>
<pre>

&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;schema id="XMLSchema1"
    targetNamespace="http://schema.comodo.com/2011/owcp/0.1"
    elementFormDefault="qualified"
    xmlns:owcp="http://schema.comodo.com/2011/owcp/0.1"
    xmlns="http://www.w3.org/2001/XMLSchema"&gt;

          </pre>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Request</h1>
<p id="rfc.section.6.2.p.1">The  &lt;Request&gt; element </p>
<p id="rfc.section.6.2.p.2">The  &lt;Request&gt; element contains the following sequence of elements: </p>
<p></p>

<dl>
<dt>&lt;Header&gt;</dt>
<dd style="margin-left: 8"></dd>
<dt>&lt;Body&gt;</dt>
<dd style="margin-left: 8"></dd>
</dl>

<p> </p>
<p id="rfc.section.6.2.p.4">The following XML Schema declares the &lt;Request&gt; element: </p>
<div id="#rfc.figure.11"></div>
<pre>

  &lt;complexType name="RequestType"&gt;
    &lt;sequence&gt;
      &lt;element ref="owcp:Header" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:Body" minOccurs="0" maxOccurs="1"/&gt;
    &lt;/sequence&gt;
  &lt;/complexType&gt;
  &lt;element name="Request" type="owcp:RequestType"/&gt;

          </pre>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> &lt;Header&gt;</h1>
<p id="rfc.section.6.3.p.1">The  &lt;Header&gt; element </p>
<p id="rfc.section.6.3.p.2">The  &lt;Header&gt; element contains the following attributes and sequence of elements: </p>
<p></p>

<dl>
<dt>issued [Required]</dt>
<dd style="margin-left: 8"></dd>
<dt>identifier [Required]</dt>
<dd style="margin-left: 8"></dd>
<dt>type [Required]</dt>
<dd style="margin-left: 8"></dd>
<dt>&lt;From&gt;</dt>
<dd style="margin-left: 8"></dd>
<dt>&lt;To&gt;</dt>
<dd style="margin-left: 8"></dd>
<dt>&lt;Verification&gt;</dt>
<dd style="margin-left: 8"></dd>
<dt>&lt;Summary&gt;</dt>
<dd style="margin-left: 8"></dd>
<dt>Reference* [Optional]</dt>
<dd style="margin-left: 8">Identifier of previous confirmation messages that this confirmation message is cross-referenced to.  </dd>
</dl>

<p> </p>
<p id="rfc.section.6.3.p.4">The following XML Schema declares the &lt;Header&gt; element: </p>
<div id="#rfc.figure.12"></div>
<pre>

  &lt;complexType name="HeaderType"&gt;
    &lt;sequence&gt;
      &lt;element ref="owcp:From" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:To" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:Verification" minOccurs="0" 
            maxOccurs="unbounded"/&gt;
      &lt;element ref="owcp:Summary" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:Reference" minOccurs="0" 
            maxOccurs="unbounded"/&gt;      
    &lt;/sequence&gt;
    &lt;attribute name="issued" type="dateTime"/&gt;
    &lt;attribute name="identifier" type="anyURI"/&gt;
    &lt;attribute name="type" type="string"/&gt;
  &lt;/complexType&gt;
  &lt;element name="Header" type="owcp:HeaderType"/&gt;

          </pre>
<h1 id="rfc.section.6.3.1">
<a href="#rfc.section.6.3.1">6.3.1.</a> &lt;From&gt; and &lt;To&gt;</h1>
<p id="rfc.section.6.3.1.p.1">The  &lt;From&gt; and &lt;To&gt; elements </p>
<p id="rfc.section.6.3.1.p.2">The  &lt;From&gt; and &lt;To&gt; elements are of type string.  </p>
<p id="rfc.section.6.3.1.p.3">The following XML Schema declares the &lt;From&gt; element: </p>
<div id="#rfc.figure.13"></div>
<pre>

  &lt;element name="From" type="string"/&gt;


            </pre>
<h1 id="rfc.section.6.3.2">
<a href="#rfc.section.6.3.2">6.3.2.</a> &lt;Verification&gt;</h1>
<p id="rfc.section.6.3.2.p.1">The  &lt;Verification&gt; element </p>
<p id="rfc.section.6.3.2.p.2">The  &lt;Verification&gt; element is of type string and contains an OWCP verification mechansim identifier as registered by IANA.  [TBS extensions by RFC] </p>
<p id="rfc.section.6.3.2.p.3">The following Verification methods are initially defined: </p>
<p></p>

<dl>
<dt>PIN</dt>
<dd style="margin-left: 8"></dd>
<dt>GPS</dt>
<dd style="margin-left: 8"></dd>
<dt>Photo</dt>
<dd style="margin-left: 8"></dd>
<dt>Voice</dt>
<dd style="margin-left: 8"></dd>
</dl>

<p> </p>
<p id="rfc.section.6.3.2.p.5">If a client encounters an unknown Verification element, the request MUST be refused with the error return 'Unknown Verification Type'.  </p>
<p id="rfc.section.6.3.2.p.6">[TBS: Should it be possible to specify Verification mechanisms as being required/optional or can this be handled in the negotiation profile?] </p>
<p id="rfc.section.6.3.2.p.7">The following XML Schema declares the &lt;Verification&gt; element: </p>
<div id="#rfc.figure.14"></div>
<pre>

  &lt;element name="Verification" type="string"/&gt;


            </pre>
<h1 id="rfc.section.6.3.3">
<a href="#rfc.section.6.3.3">6.3.3.</a> &lt;Summary&gt;</h1>
<p id="rfc.section.6.3.3.p.1">The  &lt;Summary&gt; element </p>
<p id="rfc.section.6.3.3.p.2">The  &lt;Summary&gt; element is of type TextType and contains formatted text as described below.  </p>
<p id="rfc.section.6.3.3.p.3">The following XML Schema declares the &lt;Summary&gt; element: </p>
<div id="#rfc.figure.15"></div>
<pre>

  &lt;element name="Summary" type="owcp:TextType"/&gt;


            </pre>
<h1 id="rfc.section.6.3.4">
<a href="#rfc.section.6.3.4">6.3.4.</a> &lt;Reference&gt;</h1>
<p id="rfc.section.6.3.4.p.1">The  &lt;Reference&gt; element </p>
<p id="rfc.section.6.3.4.p.2">The  &lt;Reference&gt; element is of type string.  </p>
<p id="rfc.section.6.3.4.p.3">The following XML Schema declares the &lt;Reference&gt; element: </p>
<div id="#rfc.figure.16"></div>
<pre>
              
  &lt;element name="Reference" type="string"/&gt;


            </pre>
<h1 id="rfc.section.6.4">
<a href="#rfc.section.6.4">6.4.</a> &lt;Body&gt;</h1>
<p id="rfc.section.6.4.p.1">The  &lt;Body&gt; element </p>
<p id="rfc.section.6.4.p.2">The  &lt;Body&gt; element: </p>
<p></p>

<dl>
<dt>&lt;P&gt;</dt>
<dd style="margin-left: 8"></dd>
<dt>&lt;Table&gt;</dt>
<dd style="margin-left: 8"></dd>
<dt>&lt;Barcode&gt;</dt>
<dd style="margin-left: 8"></dd>
</dl>

<p> </p>
<p id="rfc.section.6.4.p.4">The following XML Schema declares the &lt;Body&gt; element: </p>
<div id="#rfc.figure.17"></div>
<pre>

  &lt;complexType name="BodyType"&gt;
    &lt;choice minOccurs="0" maxOccurs="unbounded"&gt;
      &lt;element ref="owcp:P" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:Table" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:Barcode" minOccurs="1" maxOccurs="1"/&gt;
    &lt;/choice&gt;
  &lt;/complexType&gt;
  &lt;element name="Body" type="owcp:BodyType"/&gt;

          </pre>
<h1 id="rfc.section.6.4.1">
<a href="#rfc.section.6.4.1">6.4.1.</a> &lt;P&gt;</h1>
<p id="rfc.section.6.4.1.p.1">The  &lt;P&gt; element </p>
<p id="rfc.section.6.4.1.p.2">The  &lt;P&gt; element is of type TextType and contains formatted text as described below.: </p>
<p id="rfc.section.6.4.1.p.3">The following XML Schema declares the &lt;P&gt; element: </p>
<div id="#rfc.figure.18"></div>
<pre>

  &lt;element name="P" type="owcp:TextType"/&gt;

            </pre>
<h1 id="rfc.section.6.4.2">
<a href="#rfc.section.6.4.2">6.4.2.</a> &lt;Barcode&gt;</h1>
<p id="rfc.section.6.4.2.p.1">The  &lt;&gt; element </p>
<p id="rfc.section.6.4.2.p.2">In order to minimize the complexity of the client while maximizing the range of barcode formats that can be supported, the barcode is represented as a bitstring corresponding to the values of pixels in a grid of the specified size.  </p>
<p id="rfc.section.6.4.2.p.3">Note that this mechanism is NOT intended to provide a mechanism for display of arbitrary images. While the format described is capable of supporting the most comonly used 1D and 2D barcode formats, support for arbitrary formats is considered to be a non-requirement.  </p>
<p id="rfc.section.6.4.2.p.4">The low order bit (0) of the first octect in the bitstream corresponds to the top left corner of the barcode image which is by definition the origin. A bit value of 1 corresponds to a black pixel and a bit value of 0 to a white pixel.  </p>
<p id="rfc.section.6.4.2.p.5">The next bit, bit 1 corresponds to the pixel immediately to the right of the origin and so on. Octects are read from the bitstream as needed.  Until the entire first row of pixels is presented.  </p>
<p id="rfc.section.6.4.2.p.6">The low order bit of the next octet in the bitstream represents the pixel immediately below the origin and so on for the remainder of the row.  </p>
<p id="rfc.section.6.4.2.p.7">A QR code Version 4 barcode is displayed in a 33x33 grid of pixels.  Thus the bitstream representation of such a bitstream will require 5 octets per row for each of the 33 rows, a total of 155 octets.  </p>
<p id="rfc.section.6.4.2.p.8">[TBS: decide whether this is acceptable and if it may lead to GIF abuse type issues with the barcode being used as a substitute for an icon.] </p>
<p id="rfc.section.6.4.2.p.9">The  &lt;&gt; element: </p>
<p></p>

<dl>
<dt>width</dt>
<dd style="margin-left: 8"></dd>
<dt>height</dt>
<dd style="margin-left: 8"></dd>
<dt>data</dt>
<dd style="margin-left: 8"></dd>
</dl>

<p> </p>
<p id="rfc.section.6.4.2.p.11">The following XML Schema declares the &lt;Barcode&gt; element: </p>
<div id="#rfc.figure.19"></div>
<pre>

  &lt;complexType name="BarcodeType" &gt;
    &lt;attribute name="width" type="integer"/&gt;
    &lt;attribute name="height" type="integer"/&gt;
    &lt;attribute name="data" type="base64Binary"/&gt;
  &lt;/complexType&gt;
  &lt;element name="Barcode" type="owcp:BarcodeType"/&gt;

            </pre>
<h1 id="rfc.section.6.5">
<a href="#rfc.section.6.5">6.5.</a> &lt;Table&gt;</h1>
<p id="rfc.section.6.5.p.1">The  &lt;Table&gt; element </p>
<p id="rfc.section.6.5.p.2">The  &lt;Table&gt; element: </p>
<p></p>

<dl>
<dt>&lt;TH&gt;</dt>
<dd style="margin-left: 8"></dd>
<dt>&lt;TR&gt;</dt>
<dd style="margin-left: 8"></dd>
</dl>

<p> </p>
<p id="rfc.section.6.5.p.4">The following XML Schema declares the &lt;Table&gt; element: </p>
<div id="#rfc.figure.20"></div>
<pre>


  &lt;complexType name="TableType"&gt;
    &lt;choice minOccurs="0" maxOccurs="unbounded"&gt;

      &lt;element ref="owcp:TH" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:TR" minOccurs="1" maxOccurs="1"/&gt;
    &lt;/choice&gt;
  &lt;/complexType&gt;
  &lt;element name="Table" type="owcp:TableType"/&gt;

          </pre>
<h1 id="rfc.section.6.5.1">
<a href="#rfc.section.6.5.1">6.5.1.</a> &lt;TH&gt; and &lt;TR&gt;</h1>
<p id="rfc.section.6.5.1.p.1">The  &lt;TH&gt; and &lt;TR&gt; element </p>
<p id="rfc.section.6.5.1.p.2">The  &lt;TH&gt; and &lt;TR&gt; elements are of RowType and may contain the following element: </p>
<p></p>

<dl>
<dt>&lt;TD&gt;</dt>
<dd style="margin-left: 8"></dd>
</dl>

<p> </p>
<p id="rfc.section.6.5.1.p.4">The following XML Schema declares the &lt;TH&gt; and &lt;TR&gt; elements: </p>
<div id="#rfc.figure.21"></div>
<pre>

  &lt;complexType name="RowType"&gt;
    &lt;choice minOccurs="0" maxOccurs="unbounded"&gt;
      &lt;element ref="owcp:TD" minOccurs="1" maxOccurs="1"/&gt;
    &lt;/choice&gt;
  &lt;/complexType&gt;  
  &lt;element name="TH" type="owcp:RowType"/&gt;
  &lt;element name="TR" type="owcp:RowType"/&gt;

            </pre>
<h1 id="rfc.section.6.6">
<a href="#rfc.section.6.6">6.6.</a> &lt;TD&gt;</h1>
<p id="rfc.section.6.6.p.1">The &lt;TD&gt; element is of type TextType and MAY contain formatted text content.  </p>
<p id="rfc.section.6.6.p.2">The following XML Schema declares the &lt;TD&gt; element: </p>
<div id="#rfc.figure.22"></div>
<pre>

  &lt;element name="TD" type="owcp:TextType"/&gt;

          </pre>
<h1 id="rfc.section.6.7">
<a href="#rfc.section.6.7">6.7.</a> Text</h1>
<p id="rfc.section.6.7.p.1">The &lt;Summary&gt; &lt;P&gt; and &lt;TD&gt; elements are used to present free form text. Each of these elements are of the type TextType which is the only type of mixed content in the OWCP message markup.  </p>
<p id="rfc.section.6.7.p.2">An element of type TextType MAY contain the following content and elements: </p>
<p></p>

<ul class="empty">
<li>Text data.  </li>
<li>&lt;Money&gt; elements used to represent quantities of money.  </li>
<li>&lt;B&gt; elements used to highlight regions of the text with bold font.  </li>
<li>&lt;I&gt; elements used to highlight regions of the text with italic font.  </li>
<li>&lt;U&gt; elements used to highlight regions of the text with underlining.  </li>
</ul>

<p> </p>
<p id="rfc.section.6.7.p.4">The following XML Schema declares the TextType: </p>
<div id="#rfc.figure.23"></div>
<pre>

  &lt;complexType name="TextType" mixed="true"&gt;
    &lt;choice minOccurs="0" maxOccurs="unbounded"&gt;
      &lt;element ref="owcp:Money" maxOccurs="1"/&gt;
      &lt;element ref="owcp:B" maxOccurs="1"/&gt;
      &lt;element ref="owcp:I" maxOccurs="1"/&gt;
      &lt;element ref="owcp:U" maxOccurs="1"/&gt;
    &lt;/choice&gt;
  &lt;/complexType&gt;

          </pre>
<h1 id="rfc.section.6.7.1">
<a href="#rfc.section.6.7.1">6.7.1.</a> &lt;Money&gt;</h1>
<p id="rfc.section.6.7.1.p.1">The &lt;Money&gt; element is used to specify a sum of money in a specified currency within an element of type TextType.  This permits the client to assit the user by providing an instant conversion into the currency of the user's choice.</p>
<p id="rfc.section.6.7.1.p.2">The following attributes are defined for the &lt;Money&gt; element: </p>
<p></p>

<dl>
<dt>currency [Required]</dt>
<dd style="margin-left: 8">The ISO 4217 currency code for the amount specified.  </dd>
<dt>amount [Required]</dt>
<dd style="margin-left: 8">The amount specified in the currency indicated.  </dd>
</dl>

<p> </p>
<p id="rfc.section.6.7.1.p.4">The following XML Schema declares the &lt;Money&gt; element: </p>
<div id="#rfc.figure.24"></div>
<pre>

  &lt;complexType name="MoneyType"&gt;
    &lt;attribute name="currency" type="string" use="required"/&gt;
    &lt;attribute name="amount" type="decimal" use="required"/&gt;
  &lt;/complexType&gt;
  &lt;element name="Money" type="owcp:MoneyType"/&gt;

            </pre>
<h1 id="rfc.section.6.7.2">
<a href="#rfc.section.6.7.2">6.7.2.</a> &lt;B&gt;, &lt;I&gt; and &lt;U&gt;</h1>
<p id="rfc.section.6.7.2.p.1">The &lt;B&gt;, &lt;I&gt; and &lt;U&gt; elements are used to identify spans of text to be presented with Bold, Italic and Underline emphasis respectively. Each element is of type TextType and permit the same content to be used inside the element as is permitted in the enclosing element.  </p>
<p id="rfc.section.6.7.2.p.2">The following XML Schema declares the &lt;B&gt;, &lt;I&gt; and &lt;U&gt; elements: </p>
<div id="#rfc.figure.25"></div>
<pre>
              
  &lt;element name="B" type="owcp:TextType"/&gt;
  &lt;element name="I" type="owcp:TextType"/&gt;
  &lt;element name="U" type="owcp:TextType"/&gt;

            </pre>
<h1 id="rfc.section.6.8">
<a href="#rfc.section.6.8">6.8.</a> End</h1>
<p id="rfc.section.6.8.p.1">The following XML Schema completes the OWCP schema declarations: </p>
<div id="#rfc.figure.26"></div>
<pre>

&lt;/schema&gt;
               </pre>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Internationalization Considerations</h1>
<p id="rfc.section.7.p.1">Might want to consider how a requestor can attempt to provide a request that is presented in a language that the requestor understands.  </p>
<p id="rfc.section.7.p.2">Any such feature would have to be presented outside the XML Request message format since this needs to be kept as clean and compact and with as little room for ambiguity as possible.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Security Considerations</h1>
<p id="rfc.section.8.p.1">Consider spam control, how do users prevent unwanted requests? (EV accreditatio, filtering at dispatcher) </p>
<p id="rfc.section.8.p.2">People deploying OWCP as a means of controlling access to networking infrastructure must consider the bootstrap issue. In particular since OWCP requires Internet access the network administrator must ensure that it is possible to manage the network resources necessary to support an OXCP service when that service is down.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> IANA Considerations</h1>
<p id="rfc.section.9.p.1">Mention the following:</p>
<p id="rfc.section.9.p.2">Registry of barcode encoding types (QR/DataMatrix/Bitfield)</p>
<p id="rfc.section.9.p.3">Register Schema URI</p>
<p id="rfc.section.9.p.4">Mime type for OWCP message?</p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody><tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a title="USC/ISI">Mockapetris, P.</a>, "<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, November 1987.</td>
</tr></tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Non Normative References</h1>
<table><tbody><tr>
<td class="reference"><b id="RFC5395">[RFC5395]</b></td>
<td class="top">
<a>Eastlake, D.</a>, "<a href="http://tools.ietf.org/html/rfc5395">Domain Name System (DNS) IANA Considerations</a>", RFC 5395, November 2008.</td>
</tr></tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Collected Schema</h1>
<div id="#rfc.figure.27"></div>
<pre>
          
          
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;schema id="XMLSchema1"
    targetNamespace="http://schema.comodo.com/2011/owcp/0.1"
    elementFormDefault="qualified"
    xmlns:owcp="http://schema.comodo.com/2011/owcp/0.1"
    xmlns="http://www.w3.org/2001/XMLSchema"&gt;

  &lt;complexType name="RequestType"&gt;
    &lt;sequence&gt;
      &lt;element ref="owcp:Header" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:Body" minOccurs="0" maxOccurs="1"/&gt;
    &lt;/sequence&gt;
  &lt;/complexType&gt;
  &lt;element name="Request" type="owcp:RequestType"/&gt;

  &lt;complexType name="HeaderType"&gt;
    &lt;sequence&gt;
      &lt;element ref="owcp:From" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:To" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:Verification" minOccurs="0" 
          maxOccurs="unbounded"/&gt;
      &lt;element ref="owcp:Summary" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:Reference" minOccurs="0" 
          maxOccurs="unbounded"/&gt;
    &lt;/sequence&gt;
    &lt;attribute name="issued" type="dateTime"/&gt;
    &lt;attribute name="identifier" type="anyURI"/&gt;
    &lt;attribute name="type" type="string"/&gt;
  &lt;/complexType&gt;
  &lt;element name="Header" type="owcp:HeaderType"/&gt;
  
  &lt;element name="From" type="string"/&gt;
  &lt;element name="To" type="string"/&gt;
  &lt;element name="Verification" type="string"/&gt;
  &lt;element name="Summary" type="owcp:TextType"/&gt;
  &lt;element name="Reference" type="string"/&gt;
  
  &lt;complexType name="BodyType"&gt;
    &lt;choice minOccurs="0" maxOccurs="unbounded"&gt;
      &lt;element ref="owcp:P" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:Table" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:Barcode" minOccurs="1" maxOccurs="1"/&gt;
    &lt;/choice&gt;
  &lt;/complexType&gt;
  &lt;element name="Body" type="owcp:BodyType"/&gt;

  &lt;element name="P" type="owcp:TextType"/&gt;

  &lt;complexType name="BarcodeType" &gt;
    &lt;attribute name="width" type="integer"/&gt;
    &lt;attribute name="height" type="integer"/&gt;
    &lt;attribute name="data" type="base64Binary"/&gt;
  &lt;/complexType&gt;
  &lt;element name="Barcode" type="owcp:BarcodeType"/&gt;
  
  &lt;complexType name="TableType"&gt;
    &lt;choice minOccurs="0" maxOccurs="unbounded"&gt;

      &lt;element ref="owcp:TH" minOccurs="1" maxOccurs="1"/&gt;
      &lt;element ref="owcp:TR" minOccurs="1" maxOccurs="1"/&gt;
    &lt;/choice&gt;
  &lt;/complexType&gt;
  &lt;element name="Table" type="owcp:TableType"/&gt;

  &lt;complexType name="RowType"&gt;
    &lt;choice minOccurs="0" maxOccurs="unbounded"&gt;
      &lt;element ref="owcp:TD" minOccurs="1" maxOccurs="1"/&gt;
    &lt;/choice&gt;
  &lt;/complexType&gt;  
  &lt;element name="TH" type="owcp:RowType"/&gt;
  &lt;element name="TR" type="owcp:RowType"/&gt;
  
  &lt;element name="TD" type="owcp:TextType"/&gt;


  &lt;complexType name="TextType" mixed="true"&gt;
    &lt;choice minOccurs="0" maxOccurs="unbounded"&gt;
      &lt;element ref="owcp:Money" maxOccurs="1"/&gt;
      &lt;element ref="owcp:B" maxOccurs="1"/&gt;
      &lt;element ref="owcp:I" maxOccurs="1"/&gt;
      &lt;element ref="owcp:U" maxOccurs="1"/&gt;
    &lt;/choice&gt;
  &lt;/complexType&gt;
  
  &lt;complexType name="MoneyType"&gt;
    &lt;attribute name="currency" type="string" use="required"/&gt;
    &lt;attribute name="amount" type="decimal" use="required"/&gt;
  &lt;/complexType&gt;
  &lt;element name="Money" type="owcp:MoneyType"/&gt;

  &lt;element name="B" type="owcp:TextType"/&gt;
  &lt;element name="I" type="owcp:TextType"/&gt;
  &lt;element name="U" type="owcp:TextType"/&gt;  

&lt;/schema&gt;

        </pre>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Phillip Hallam-Baker</span> 
	  <span class="n hidden">
		<span class="family-name">Hallam-Baker</span>
	  </span>
	</span>
	<span class="org vcardline">Comodo Group Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:philliph@comodo.com">philliph@comodo.com</a></span>

  </address>
</div>

</body>
</html>