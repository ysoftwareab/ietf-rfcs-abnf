



Kitten                                                         T. Hansen
Internet-Draft                                         AT&T Laboratories
Updates: 5802 (if approved)                                July 20, 2015
Intended status: Standards Track
Expires: January 21, 2016


          SCRAM-SHA-256 and SCRAM-SHA-256-PLUS SASL Mechanisms
                      draft-hansen-scram-sha256-03

Abstract

   This document registers the SASL mechanisms SCRAM-SHA-256 and SCRAM-
   SHA-256-PLUS.  It also updates the SCRAM registration procedures of
   RFC 5802.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on January 21, 2016.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




Hansen                  Expires January 21, 2016                [Page 1]

Internet-Draft    SASL SCRAM-SHA-256/SCRAM-SHA-256-PLUS        July 2015


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Key Word Definitions  . . . . . . . . . . . . . . . . . . . .   2
   3.  SCRAM-SHA-256 and SCRAM-SHA-256-PLUS  . . . . . . . . . . . .   3
   4.  Security Considerations . . . . . . . . . . . . . . . . . . .   3
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   4
     5.1.  Updates to SCRAM-* Registration . . . . . . . . . . . . .   4
     5.2.  SASL-SCRAM Family Mechanisms Registration Procedure . . .   4
   6.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   6
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   6
     7.1.  Normative References  . . . . . . . . . . . . . . . . . .   6
     7.2.  Informative References  . . . . . . . . . . . . . . . . .   7
     7.3.  URIs  . . . . . . . . . . . . . . . . . . . . . . . . . .   7
   Appendix A.  Change Log . . . . . . . . . . . . . . . . . . . . .   7
     A.1.  Changes for -02 to -03  . . . . . . . . . . . . . . . . .   7
     A.2.  Changes for -01 to -02  . . . . . . . . . . . . . . . . .   8
     A.3.  Changes for -00 to -01  . . . . . . . . . . . . . . . . .   8
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .   8

1.  Introduction

   This document registers the SASL mechanisms SCRAM-SHA-256 and SCRAM-
   SHA-256-PLUS.  SHA-256 has stronger security properties than SHA-1,
   and it is expected that SCRAM mechanisms based on it will have
   greater predicted longevity than the SCRAM mechanisms based on SHA-1.

   The registration form for the SCRAM family of algorithms is also
   updated from [RFC5802].

   Note: this paragraph may be removed before publication.
   This document was written because [RFC5802] requires that new SASL
   mechanisms in the SCRAM family be subject to IETF review.  This
   document is being discussed in the KITTEN working group (see the
   kitten@ietf.org [1] mailing list).  It was pursued further because of
   a desire for its use within a document being discussed in the HTTP-
   AUTH working group (see the httpauth@ietf.org [2] mailing list).

2.  Key Word Definitions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].








Hansen                  Expires January 21, 2016                [Page 2]

Internet-Draft    SASL SCRAM-SHA-256/SCRAM-SHA-256-PLUS        July 2015


3.  SCRAM-SHA-256 and SCRAM-SHA-256-PLUS

   The SCRAM-SHA-256 and SCRAM-SHA-256-PLUS SASL mechanisms are defined
   in the same way that SCRAM-SHA-1 and SCRAM-SHA-1-PLUS are defined in
   [RFC5802], except that the hash function for HMAC() and H() uses
   SHA-256 instead of SHA-1 [RFC6234].

   For the SCRAM-SHA-256 and SCRAM-SHA-256-PLUS SASL mechanisms, the
   hash iteration-count announced by a server SHOULD be at least 4096.

   The GSS-API mechanism OID for SCRAM-SHA-256 is TBD1 (see Section 5).

   This is a simple example of a SCRAM-SHA-256 authentication exchange
   when the client doesn't support channel bindings.  The username
   'user' and password 'pencil' are being used.

   C: n,,n=user,r=rOprNGfwEbeRWgbNEkqO

   S: r=rOprNGfwEbeRWgbNEkqO%hvYDpWUa2RaTCAfuxFIlj)hNlF$k0,
      s=W22ZaJ0SNY7soEsUEjb6gQ==,i=4096

   C: c=biws,r=rOprNGfwEbeRWgbNEkqO%hvYDpWUa2RaTCAfuxFIlj)hNlF$k0,
      p=dHzbZapWIk4jUhN+Ute9ytag9zjfMHgsqmmiz7AndVQ=

   S: v=6rriTRBi23WpRR/wtup+mMhUZUn/dB5nLTJRsjl95G4=

4.  Security Considerations

   The security considerations from [RFC5802] still apply.

   See [RFC4270] and [RFC6194] for reasons to move from SHA-1 to a
   strong security mechanism like SHA-256.

   The strength of this mechanism is dependent in part on the hash-
   iteration count, as denoted by "i" in [RFC5802].  As a rule of thumb,
   the hash-iteration count should be such that a modern machine will
   take 0.1 seconds to perform the complete algorithm; however this is
   unlikely to be practical on mobile devices and other relatively low-
   performance systems.  At the time this was written, the rule of thumb
   gives around 15,000 iterations required; however an iteration count
   of 4096 takes around 0.5 seconds on current mobile handsets.  This
   computational cost can be avoided by caching the ClientKey (assuming
   the Salt and iteration count is stable).  Therefore the
   recommendation of this specification is that the iteration count
   SHOULD be at least 4096, but careful consideration ought to be given
   to using a significantly higher value, particularly where mobile use
   is less important.




Hansen                  Expires January 21, 2016                [Page 3]

Internet-Draft    SASL SCRAM-SHA-256/SCRAM-SHA-256-PLUS        July 2015


5.  IANA Considerations

5.1.  Updates to SCRAM-* Registration

   The IANA registry for SCRAM-* (the SCRAM family of SASL mechanisms)
   in the SASL Mechanism registry ([RFC4422]) is updated as follows.
   The email address for reviews has been updated, and the note at the
   end changed.

      To: iana@iana.org
      Subject: Registration of a new SASL family SCRAM

      SASL mechanism name (or prefix for the family): SCRAM-*
      Security considerations: Section 7 of [RFC5802]
      Published specification (optional, recommended): RFCXXXX
      Person & email address to contact for further information: IETF
      KITTEN WG kitten@ietf.org
      Intended usage: COMMON
      Owner/Change controller: IESG iesg@ietf.org
      Note: Members of this family MUST be explicitly registered using
      the "IETF Review" [RFC5226] registration procedure.  Reviews MUST
      be requested on the KITTEN mailing list kitten@ietf.org (or a
      successor designated by the responsible Security AD).

      Note to future SCRAM-mechanism designers: each new SASL SCRAM
      mechanism MUST be explicitly registered with IANA within the SASL
      SCRAM Family Mechanisms registry.

5.2.  SASL-SCRAM Family Mechanisms Registration Procedure

   A new IANA registry is to be added for members of the SCRAM family of
   SASL mechanisms, named SASL SCRAM Family Mechanisms.  It adds two new
   fields to the existing SCRAM mechanism registry: Minimum iteration-
   count and Associated OID.

      To: iana@iana.org
      Subject: Registration of a new SASL SCRAM family mechanism

      SASL mechanism name (or prefix for the family): SCRAM-<NAME>
      Security considerations: Section 7 of [RFC5802]
      Published specification (optional, recommended): RFCXXXX
      Minimum iteration-count: The minimum iteration-count that servers
      SHOULD announce
      Associated OID: TBD-BY-IANA
      Person & email address to contact for further information: IETF
      KITTEN WG kitten@ietf.org
      Intended usage: COMMON
      Owner/Change controller: IESG iesg@ietf.org



Hansen                  Expires January 21, 2016                [Page 4]

Internet-Draft    SASL SCRAM-SHA-256/SCRAM-SHA-256-PLUS        July 2015


      Note: Members of this family MUST be explicitly registered using
      the "IETF Review" [RFC5226] registration procedure.  Reviews MUST
      be requested on the KITTEN mailing list kitten@ietf.org (or a
      successor designated by the responsible Security Area Director).

      Note: At publication of a new SASL SCRAM Family Mechanism, IANA
      SHOULD assign a GSS-API mechanism OID for this mechanism from the
      iso.org.dod.internet.security.mechanisms prefix (see the "SMI
      Security for Mechanism Codes" registry) and fill in the value for
      "TBD-BY-IANA" above.  Only one OID needs to be assigned for a
      SCRAM-<NAME> and SCRAM-<NAME>-PLUS pair.  The same OID should be
      assigned to both entries in the registry.

      [RFC Editor: This note should be removed before publication.]
      Note to IANA and the RFC Editor: The above string "TBD-BY-IANA" is
      NOT to be filled in with an OID within THIS document, but is to be
      placed as is within the registry.

      Note to future SASL SCRAM mechanism designers: each new SASL SCRAM
      mechanism MUST be explicitly registered with IANA and MUST comply
      with the SCRAM-mechanism naming convention defined in Section 4 of
      [RFC5802].

   The existing entries for SASL SCRAM-SHA-1 and SCRAM-SHA-1-PLUS are to
   be moved from the existing SASL Mechanism registry to the SASL SCRAM
   Family Mechanism registry.  When doing so, the following values are
   to be added:

      Minimum iteration-count: 4096
      OID: 1.3.6.1.5.5.14 (from [RFC5802])

   The following new SASL SCRAM mechanisms are added to the SASL SCRAM
   Family Mechanism registry:

      IANA has added the following entries to the SASL SCRAM Family
      Mechanism registry established by RFCXXXX:

      To: iana@iana.org
      Subject: Registration of a new SASL SCRAM Family mechanism SCRAM-
      SHA-256

      SASL mechanism name (or prefix for the family): SCRAM-SHA-256
      Security considerations: Section Section 4 of RFCXXXX
      Published specification (optional, recommended): RFCXXXX
      Minimum iteration-count: 4096
      OID: TBD1
      Person & email address to contact for further information: IETF
      KITTEN WG kitten@ietf.org



Hansen                  Expires January 21, 2016                [Page 5]

Internet-Draft    SASL SCRAM-SHA-256/SCRAM-SHA-256-PLUS        July 2015


      Intended usage: COMMON
      Owner/Change controller: IESG iesg@ietf.org
      Note:

      To: iana@iana.org
      Subject: Registration of a new SASL SCRAM Family mechanism SCRAM-
      SHA-256-PLUS

      SASL mechanism name (or prefix for the family): SCRAM-SHA-256-PLUS
      Security considerations: Section Section 4 of RFCXXXX
      Published specification (optional, recommended): RFCXXXX
      Minimum iteration-count: 4096
      OID: "TBD1"
      Person & email address to contact for further information: IETF
      KITTEN WG kitten@ietf.org
      Intended usage: COMMON
      Owner/Change controller: IESG iesg@ietf.org
      Note:

   [This note may be removed on publication.]  IANA needs to assign the
   GSS-API mechanism OID TBD1 listed above from the
   iso.org.dod.internet.security.mechanisms prefix (see the "SMI
   Security for Mechanism Codes" registry).

6.  Acknowledgements

   This document benefited from discussions on the KITTEN WG mailing
   list.  The author would like to specially thank Russ Albery, Dave
   Cridland, Shawn Emery, Simon Josefsson, Pearl Liang, Alexey Melnikov,
   Peter Saint-Andre, Martin Thompson and Nico Williams for their
   comments on this topic.

7.  References

7.1.  Normative References

   [RFC4422]  Melnikov, A., Ed. and K. Zeilenga, Ed., "Simple
              Authentication and Security Layer (SASL)", RFC 4422,
              DOI 10.17487/RFC4422, June 2006,
              <http://www.rfc-editor.org/info/rfc4422>.

   [RFC5802]  Newman, C., Menon-Sen, A., Melnikov, A., and N. Williams,
              "Salted Challenge Response Authentication Mechanism
              (SCRAM) SASL and GSS-API Mechanisms", RFC 5802,
              DOI 10.17487/RFC5802, July 2010,
              <http://www.rfc-editor.org/info/rfc5802>.





Hansen                  Expires January 21, 2016                [Page 6]

Internet-Draft    SASL SCRAM-SHA-256/SCRAM-SHA-256-PLUS        July 2015


   [RFC6234]  Eastlake 3rd, D. and T. Hansen, "US Secure Hash Algorithms
              (SHA and SHA-based HMAC and HKDF)", RFC 6234,
              DOI 10.17487/RFC6234, May 2011,
              <http://www.rfc-editor.org/info/rfc6234>.

7.2.  Informative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC4270]  Hoffman, P. and B. Schneier, "Attacks on Cryptographic
              Hashes in Internet Protocols", RFC 4270,
              DOI 10.17487/RFC4270, November 2005,
              <http://www.rfc-editor.org/info/rfc4270>.

   [RFC5226]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", BCP 26, RFC 5226,
              DOI 10.17487/RFC5226, May 2008,
              <http://www.rfc-editor.org/info/rfc5226>.

   [RFC6194]  Polk, T., Chen, L., Turner, S., and P. Hoffman, "Security
              Considerations for the SHA-0 and SHA-1 Message-Digest
              Algorithms", RFC 6194, DOI 10.17487/RFC6194, March 2011,
              <http://www.rfc-editor.org/info/rfc6194>.

7.3.  URIs

   [1] mailto:kitten@ietf.org

   [2] mailto:httpauth@ietf.org

Appendix A.  Change Log

   This section should be removed before publication as an RFC.

A.1.  Changes for -02 to -03

   Changed from Informational document to Standards Track.

   Beefed up the Security Considerations (Section 4) section.

   At the request of IANA, reworked the IANA Considerations (Section 5)
   section.






Hansen                  Expires January 21, 2016                [Page 7]

Internet-Draft    SASL SCRAM-SHA-256/SCRAM-SHA-256-PLUS        July 2015


A.2.  Changes for -01 to -02

   Removed !!!!!!!!!!!!!!!! comments requesting discussion after
   discussion on kitten mailing list.

A.3.  Changes for -00 to -01

   Added Security Considerations (Section 4) section.

   Added Minimum iteration-count and associated OID fields to
   registration forms and reworked the IANA Considerations (Section 5)
   section.

Author's Address

   Tony Hansen
   AT&T Laboratories
   200 Laurel Ave. South
   Middletown, NJ  07748
   USA

   Email: tony+scramsha256@maillennium.att.com





























Hansen                  Expires January 21, 2016                [Page 8]
