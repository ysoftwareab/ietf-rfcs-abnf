<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DKIM Author Domain Signing Practices (ADSP) Security Issues</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DKIM Author Domain Signing Practices (ADSP) Security Issues">
<meta name="keywords" content="email, e-mail, rfc2822, rfc 2822, rfc822, rfc 822, rfc2821, rfc 2821, rfc821, rfc 821,
      rfc4871, rfc 4871, DKIM, domain keys, domainkeys, ADSP, ADSP, SSP, architecture, mta, user,
      delivery, smtp, submission, email, e-mail, smtp, Internet, mailfrom, mail from, author, return
      address, sender signing, signing practices, key domain, author key domain, author address,
      author domain, security issues">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">DKIM Working Group</td><td class="header">D. Otis</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Trend Micro, NSSG</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">October 01, 2008</td></tr>
<tr><td class="header">Expires: April 4, 2009</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />DKIM Author Domain Signing Practices (ADSP) Security Issues<br />draft-otis-dkim-adsp-sec-issues-03</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 4, 2009.</p>

<h3>Abstract</h3>

<p>The proposed <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> defines DNS records that advertise the
        extent to which a domain employs <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> to sign <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a>
        messages, and defines how other hosts can access these advertisements. Its laudable goal is
        to allow domains control over the use of the From header field. When a message is not
        adequately signed, advertised assertions, referenced by a domain in the From header field,
        assist in resolving the message's intended disposition.
</p>
<p>Rather than dealing with keys that impose a restriction on the
        &quot;on-behalf-of&quot; identity as a separate security consideration to be handled
        independently from an assertion that a domain signs their messages, <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> instead employs a flawed two-stage signature validation
        process that works in conjunction with advertised practices. The two-stage approach will
        most likely occur after message acceptance, and impairs the range of authentication
        assertions permitted by a single signature. The limitations on authentication assertions
        inhibits tactics needed to deal with replay abuse.
</p>
<p>As currently structured, advertised practices not only assert whether a signature should be
        expected, they also constrain the &quot;on-behalf-of&quot; identity applied by
        signing agents that are not otherwise so restricted by <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. By
        constraining the &quot;on-behalf-of&quot; identity for all signing agents, the draft
        neglects the predominate role of the domain as a point of trust, and incorrectly assumes the
        signature is limited to supporting assertions regarding the identity of the author. By
        limiting the DKIM signature's &quot;on-behalf-of&quot; value to being representative
        of only the message's author, the draft goes well beyond the working group's charter and
        appears to infringe on S/MIME's and OpenPGP's role.
</p>
<p><a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> impairs security in other ways as well, such as the only
        directly actionable practice is defined using a term likely to negatively impact the
        integrity of delivery status. Fortunately minor changes to the definition of a compliant
        signature can remedy the impairment created, where the critical security issues are best
        handled independent of any <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> assertion.
</p>
<h3>Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
          <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Imparing DKIM Signature's Utility<br />
<a href="#anchor3">3.</a>&nbsp;
Errors and Omissions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Factual Errors<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Factual Omissions<br />
<a href="#anchor6">4.</a>&nbsp;
DKIM and SMTP's transition to IPv6<br />
<a href="#anchor7">5.</a>&nbsp;
Recommended Changes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.1.</a>&nbsp;
2.7.  Author Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.2.</a>&nbsp;
Section 4.1.  DNS Representation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.3.</a>&nbsp;
3.1.  ADSP Applicability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.4.</a>&nbsp;
4.2.1.  Record Syntax<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.5.</a>&nbsp;
6. Security Considerations<br />
<a href="#anchor13">6.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor14">7.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">7.1.</a>&nbsp;
Considerations not managed by draft-ietf-dkim-ssp<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
References - Normative<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
References - Informative<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Both <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> would benefit from a
        general security requirement for signatures with keys that restrict a remote signing agent's
        &quot;on-behalf-of&quot; identity, where this identity must also match against the
        From header field before being considered valid. This change to the definition of a valid
        signature would significantly remedy what is likely to become critical security issues, but
        this check should be independent of the ADSP assertions.
</p>
<p><a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> makes a statement that is emblematic of how the signature's role
        can be distorted. This statement can not be applied as a basis for message acceptance, does
        not acknowledge that restricted identities for remote signing agents require greater control
        be afforded the domain, and ignores the predominate role of the domain by assuming the DKIM
        signature is to make assertions regarding the identity of the author. In section 6.3
        paragraph 5, </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>&quot;If the message is signed on behalf of any address other than that in the
            From: header field, the mail system SHOULD take pains to ensure that the actual signing
            identity is clear to the reader.&quot;
</dd>
</dl></blockquote>

<p>At best, DKIM might make a weak assertion regarding the identity of the author. However,
        these assertions lack a wide range of supporting conventions where reliance upon an author
        identity would be unsafe. For example, ancillary Display Names are not controlled by the
        signing domain when remote signing agents are used.
</p>
<p>To sustain delivery integrity, whether the signature is valid must remain clear. There is
        no reason why the &quot;on-behalf-of&quot; identity can not be opaque whenever the
        key employed by the signing agent can sign on behalf of the entire domain. Signing agents,
        afforded unrestricted keys, can be considered able to verify the entire message's compliance
        with the domain's practices. The established trust is with the signing domain, and can never
        be based upon a dubious identity within the From header field.
</p>
<p>Conceptually, receiving hosts verify a DKIM signature by obtaining the corresponding public
        key. A valid signature confirms the message is attested to by a party in possession of the
        private key, and in control of a portion of the domain publishing the public key. Ideally,
          <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> should only introduce practices that ensure the From
        header field domains are within their signing domain.
</p>
<p>As providers block SMTP's public port 25 for a growing number of IP addresses, compromised
        systems, often containing account information, are prevalently being used by bad actors to
        gain access to larger domains. Blocking the combined outbound messages from larger domains
        often proves impractical. Ordinarily, larger domains are either unwilling or unable to
        affirm the identity in the From header field and, as a result, end up leaving the
        &quot;on-behalf-of&quot; identity tag and value blank. Leaving the identity tag
        value blank severely limits a recipient's defence against replay abuse, and as such, should
        be considered a bad practice. The &quot;on-behalf-of&quot; identity tag and value
        should always reflect the element authenticated, even when this value is opaque and dynamic.
</p>
<p>The constraints imposed by <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> make it impractical for the
        &quot;on-behalf-of&quot; identity to always indicate what was authenticated, as
        intended in <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. Ironically, an ability to always indicate an
        authenticated identity was lost as a result of optimizing a two-stage signature validation
        scheme that considered signatures with a restricted &quot;on-behalf-of&quot;
        identity that does not match against the From header field, to be initially valid. Schemes
        that consider signatures valid when a restricted &quot;on-behalf-of&quot; identity
        fails to match against the From header field places recipients in significant peril.
        Signature headers, which are seldom visible, contain the &quot;on-behalf-of&quot;
        identity. Any annotation or handling of these signatures as being valid, that also have a
        restricted &quot;on-behalf-of&quot; identity that does not match against the From
        header field, would leave the From header field open to exploitation.
</p>
<p>Detecting inappropriate use of an identity restricted key should occur quickly and prior to
        message acceptance. Based upon independent security considerations, signatures using keys
        that impose restrictions upon local-parts that fail to match against the From header field
        should not be treated as a valid signature. This check must not be prefaced upon discovering
        whether the domain advertises practices. In other words, in addition to keys placing
        restrictions upon the &quot;on-behalf-of&quot; identity within the signature for
        remote signing agents, the From header field should also match against the key's local-part
        restrictions as well.
</p>
<p>Currently, <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> advertised practices may affect messages that
        lack signatures, or where the From header field address is not within the signing domain, or
        where the &quot;on-behalf-of&quot; identity does not match against the From header
        field. The impact of an advertised practice and the resulting
        &quot;on-behalf-of&quot; identity requirement occurs irrespective of the type of
        signing agent and key used. This creates a security vulnerability that may encourage DNS
        attack, and unnecessarily limits the practical utility of the DKIM signature. A massive
        dispersal of spoofed messages is likely able to defeat an advertised practice whenever there
        is an intervening DNS resolver between the recipient's MTA and the signing domain's name
        server.
</p>
<p>Unfortunately, the two-stage conditional valid signature requirement imposed by <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> unnecessarily affects all signing agents. Signature validity
        becomes dependent upon the success of advertisement discovery, where this two-stage process
        is likely to negatively impact both delivery integrity and security. Limitations imposed on
        the &quot;on-behalf-of&quot; identity within the second stage may alter what is
        considered valid by <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. When the signing agent employs unrestricted
        keys, this change is wholly without merit. This also means that a domain is not assured that
        a restricted &quot;on-behalf-of&quot; identity that does not match with the From
        header field will be considered invalid, except by publishing advertised practices at every
        existing subdomain.
</p>
<p>Per <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>, the &quot;on-behalf-of&quot; identity is not required
        to be that of a message author, and may even indicate the authentication of a system or an
        access account. This distinction is important since predominately compromised systems,
        rather than individuals, are the source of abuse. Unfortunately, <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> places constraints on what may be placed within the
        &quot;on-behalf-of&quot; identity. It is unrealistic to suggest the impractical use
        of multiple signatures as a solution, since this doubles the overhead related to signatures
        and signature validation. <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> has already defined an
        &quot;on-behalf-of&quot; identity. There is no reason to reinvent the meaning of the
        &quot;on-behalf-of&quot; identity in support of a flawed, two-stage, conditional,
        valid signature definition.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Imparing DKIM Signature's Utility</h3>

<p>The DKIM WG mailing list provides little insight as to why factual errors and security
        concerns were not fully discussed, or why a safer, simpler, and more compliant valid DKIM
        signature definition wasn't accepted. Perhaps the only remaining consideration is whether
        the WG has unsafely exceeded their charter.
</p>
<p>The charter states:</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>The DKIM working group will produce standards-track specifications that allow a domain
            to take responsibility, using digital signatures, for having taken part in the
            transmission of an email message and to publish "policy" information about how it
            applies those signatures. Taken together, these will assist receiving domains in
            detecting (or ruling out) certain forms of spoofing as it pertains to the signing <tt>domain</tt>.
</dd>
<dt></dt>
<dd>... To prevent this task from becoming unwieldy, several related topics are considered
            out of scope for the DKIM working group. These topics include:
<blockquote class="text"><dl>
<dt></dt>
<dd>* Signatures that attempt to make strong assertions about the identity of the
                  <tt>message author</tt>, and details of user-level signing of
                messages (as distinguished from domain-level keys that are restricted to specific
                users).
</dd>
<dt></dt>
<dd>* Duplication of prior work in signed email, including S/MIME and OpenPGP.
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>

<p>One will not find an explanation as to why a signature's &quot;on-behalf-of&quot;
        value must match against an email-address found within the From header field, or that it be
        left blank to be compliant with an ADSP message signing assertion.
</p>
<p>Why isn't it enough to ensure that a message was directly signed by the From domain, as
        suggested in <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> Section 3.2? Why should a recipient consider
        signatures to be valid when a local-part restricted by a key fails to match against a From
        email-address? The errors and omissions in <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> are not
        harmless and will significantly weaken both the utility and security of DKIM signatures.
</p>
<p>The current Author Signature definition inhibits:</p>
<ul class="text">
<li>Future adoption of other DKIM signing practice assertions.
</li>
<li>Future adoption of best practices where the &quot;on-behalf-of&quot; values
            correlate with what the signing domain authenticated.
</li>
<li>A practical means to assert &quot;on-behalf-of&quot; values that represent what
            the domain authenticated when the values differ from the local-part of a From
            email-address.
</li>
<li>Opaque &quot;on-behalf-of&quot; values that obfuscate relationships with an
            email-address, while also offering recipients a means to defend against possible replay
            abuse.
</li>
<li>Ensuring restricted keys for remote signing agents are not abused without requiring an
            inordinate amount of ADSP resource records and &quot;_domainkey&quot; subdomains
            be published throughout the domain hierarchy.
</li>
<li>Use of email-addresses not resolved by DNS.
</li>
<li>An ability to determine whether DKIM signatures might be generated by a domain.
</li>
<li>An acceptance scheme that can replace the role of the IPv4 address for SMTP sessions
            over IPv6.
</li>
</ul><p>
      
</p>
<p>If differentiating between remote and direct signing agents is considered outside of the
        charter's scope, then <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> section 2.7 and sections 4.2.1
        Record Syntax definitions that depend upon an &quot;Author Signature&quot; exceed
        this charter to an even greater degree.
</p>
<p>The motivation for the current draft likely results from larger domains protecting their
        ability to limit recipients to an &quot;all-or-nothing&quot; acceptance of their
        messages. The recommended changes do not require that a non-blank
        &quot;on-behalf-of&quot; be used. However, these changes allow a practice that
        always offers recipients a means to differentiate between opaque sources internal to the
        signing domain.
</p>
<p>Asserting the &quot;on-behalf-of&quot; as an opaque value that correlates with what
        the domain authenticated is a reasonable use of the &quot;on-behalf-of&quot; value,
        since such information offers a defence against possible replay abuse. From the larger
        domain's perspective, recipients basing acceptance upon the signing-domain and
        &quot;on-behalf-of&quot; as an authentication token will be placing smaller domains
        on an equal footing. The increased granularity afforded by the
        &quot;on-behalf-of&quot; value thereby mitigates the influence that a large domain
        would have in coercing acceptance of their domain's messages.
</p>
<p>Larger domains are currently able to send a fair amount of spam without much risk of being
        blocked. The level of this spam is rising, where a greater tolerance to this spam is
        necessitated. As a result, large providers are able ignore a spam problem when it represents
        a source of revenue or when dealing with the source incurs support costs. Although the
        changes to ADSP being recommended will not prevent large domains from continuing to use
        blank &quot;on-behalf-of&quot; in their signatures, this strategy is much more
        likely to be considered a bad practice in the future.
</p>
<p>The charter correctly excludes attempts to transform DKIM into being a scheme that affirms
        the identity of the author. This limitation was prudent since DKIM does not control the
        Display Name, and does not ensure which, if any, header field corresponds with the
        &quot;on-behalf-of&quot; identity. By adopting the recommended changes, it is more
        likely that a compromised system of a user will cause them to receive error messages that
        indicate that their system appears to be compromised. The use of opaque
        &quot;on-behalf-of&quot; values allows the signing domain a means to modify the
        token and unilaterally redeem the account without needing to change their email-address.
</p>
<p>The typical abuse driving demand for <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> has been the flood
        of phishing attempts. ADSP should permit more stringent filtering based upon message content
        that fails to correlate with a From header. However, the Author Signature definition is
        unlikely to play a significant role in this effort.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Errors and Omissions</h3>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Factual Errors</h3>

<p>Section 3.2 of <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> makes a factual error in stating that a
          valid signature by an Author Domain is already known to be compliant with any possible
          ADSP for that domain. Compliance with ADSP currently requires an Author Signature, not
          just a signature by the Author domain.
</p>
<p>The Author Signature requires the &quot;on-behalf-of&quot; identity to match
          against the author's address. A valid signature by the Author Domain per <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> will not impose this limitation, where the <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> Author Signature requirements limit interchange without
          justification.
</p>
<p>For example, office administrators might submit messages authored by their managers. The
          authenticated DKIM signature &quot;on-behalf-of&quot; identity could be that of
          the office administrator whose email-address was placed within the Sender header field as
          permitted by <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a>. When a signing domain's practice permits office
          administrators to send messages on behalf of managers, a manager's email-address could be
          placed within the From header field to signify the manager's role as author.
</p>
<p>A valid signature, verified with a key that lacks identity restrictions, clearly
          indicates the signature was applied by a trusted signing agent. A trusted signing agent
          can sign on behalf of the entire domain and should ensure message conformance prior to
          signing. A signature by the Author domain, with a key that lacks identity restrictions, is
          sufficient to ensure the domain's ability to fully control the use of the From header
          field, and to assert any sundry list of message conformance requirements.
</p>
<p>A valid signature applied by the Author Domain using a key that lacks identity
          restrictions should be considered compliant with any possible ADSP. However, the current
          Author Signature definition, in conjunction with the discovery of a practice, may cause a
          valid signature to become invalid when assessing ADSP compliance where the
          &quot;on-behalf-of&quot; identity does not match against the author's address.
          This restriction would only have merit in the case of a local-part restricted key, but
          this security consideration should be made in this instance irrespective of any ADSP
          assertions.
</p>
<p>To be in strict compliance with the WG charter, the issue of remote signing agents can be
          ignored as something that is self-evident based upon the key information and the From
          header field content. A recipient should always deal with this concern as a separate issue
          unrelated to whether a message should have been signed.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Factual Omissions</h3>

<p><a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> attempts to define practices used by a domain, but
          then fails to specify which public transport protocol or protocols meet the advertised
          practice. Misapplication of practice compliance assessments could lead to interchange
          problems when only a portion of the possible <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a> related transports
          employ <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</p>
<p>Omitting public transport specifics might seem reasonable, since there are many possible
          protocol gateways into SMTP provided by various third-parties. However, remaining silent
          on the relevant transport will lead to various ad-hoc methods for dealing with protocol
          gateways. As a result of the omission, <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> fails to warn of
          potential problems, such as various NNTP messages being dropped, for example.
</p>
<p>Omitting transport specifics has also lead to the general requirement in <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> Section 4.3 that any ADSP related transport will use DNS at
          the domain of the address. A lack of transport agility results from there not being any
          ADSP parameter that makes a specific public transport assertion to clarify where and what
          resources are available. The positive identification of DNS resources would be essential
          for determining whether a domain in question is within scope of the ADSP compliance
          requirements. Unfortunately, ADSP is structured to expect the existence of any DNS
          resource in determining the acceptance of a message that is not already in compliance with
          any possible ADSP.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
DKIM and SMTP's transition to IPv6</h3>

<p>As IPv4 addresses become less available, a demand is growing for the acceptance of IPv6
        SMTP clients over port 25. IPv6 supports 340,000 decillion (340,000 x 10^33) unique
        addresses that operate over dual-stacks, IPv6/IPv4 gateways, and tunnels. Currently,
        protective services defend MTAs from abusive clients by processing logs that resolve on the
        order of 200 million unique IPv4 addresses every few minutes. These protective services are
        time sensitive while providing a dynamic shield against sporadic, and often high levels of
        abuse, when these sources are aggregated.
</p>
<p>The resources consumed, and cost expended, in providing protective services is not
        insignificant. A desire to use IPv6 addresses with SMTP happens at a time where companies
        are striving to reduce their expenditures. There is some justification in cutting back on
        SMTP specific protections. Surveys indicate email represents a small and falling percentage
        of one's direct exposure to malware. The browser, rather than the MUA, offers a greater
        target of opportunity for bad actors.
</p>
<p>Although DKIM has a potential for replay abuse, combining the signing domain with the
        &quot;on-behalf-of&quot; identity can better establish a defensible basis for
        acceptance, as opposed to a virtually unlimited IPv6 address space that is also more likely
        to represent a mixture of good and bad actors. Using the DKIM domain and
        &quot;on-behalf-of&quot; identity tuple to tracking tens of millions of opaque
        accounts within hundreds of thousands of large domains represents a manageable dataset of
        about 6 billion.
</p>
<p>This dataset represents an increase of about 30,000 times over the dataset now defending
        IPv4. Even with this sizable increase, DKIM still offers a simpler, more reliable, more
        effective, and much smaller dataset than what is likely needed to track a more complex range
        of IPv6 addresses that extend well beyond a human comprehensible scale.
</p>
<p>For DKIM to provide a defensible basis for acceptance, the signing domain needs to offer
        valid &quot;on-behalf-of&quot; identities that track the elements authenticated by
        the signing domain. A domain, that can be trusted to offer opaque identifiers of what they
        authenticate, provides a safe basis for acceptance. These identifiers might represent that
        of an account, an IP address within a network, or a system's certificate, and not that of an
        email-address found within the From header field.
</p>
<p>Most abuse is enabled by compromised accounts or systems that are seldom directly
        associated with a From email-address. Since ADSP is unlikely to alter what a domain
        authenticates, DKIM can be far more effective against abuse wrought by compromised systems
        by allowing the &quot;on-behalf-of&quot; identity to represent an account or system
        as well. Unfortunately, <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> requires a bad practice where the
        &quot;on-behalf-of&quot; must be blank when it does not represent that of the From
        header field. The imposition of a bad practice results from the failure of <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> to differentiate between remote and trusted signing agents.
          <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> prevents the good practice of always indicating the
        element authenticated. <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> also fails to satisfy a goal of
        controlling the From header field when remote signing agents are used.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Recommended Changes</h3>

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
2.7.  Author Signature</h3>

<p>CHANGE:
</p>
<p>An &quot;Author Signature&quot; is any Valid Signature where the identity of the
          user or agent on behalf of which the message is signed (listed in the
          &quot;i=&quot; tag or its default value from the &quot;d=&quot; tag)
          matches an Author Address in the message. When the identity of the user or agent includes
          a Local-part, the identities match if the Local-parts are the same string, and the domains
          are the same string.
</p>
<p>TO:
</p>
<p>An &quot;Author Signature&quot; is any Valid Signature per section 3.2, where an
          Author Address domain is within the signature's &quot;d=&quot; tag and value
          domain.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Section 4.1.  DNS Representation</h3>

<p>CHANGE:
</p>
<p>_adsp._domainkey.
</p>
<p>TO:
</p>
<p>_adsp. (preferably adopt a specific resource record instead).<br />
<br />

          </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>There is no practice that asserts no email is signed, so the presence of the
              &quot;_domainkey.&quot; subdomain at every existing node creates a misleading
              appearance of DKIM support at each node. The absence of the
              &quot;_domainkey.&quot; subdomain clarifies that the domain does not support
              DKIM.
</dd>
</dl></blockquote>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
3.1.  ADSP Applicability</h3>

<p>CHANGE:
</p>
<p>ADSP as defined in this document is bound to DNS.
</p>
<p>TO:
</p>
<p>ADSP as defined in this document is bound to DNS and SMTP.<br />
<br />

</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
4.2.1.  Record Syntax</h3>

<p>CHANGE TERMS:
</p>
<p>Discardable and discard
</p>
<p>TO:
</p>
<p>Dismissable and dismiss<br />

          </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>Even for the example cases sighted in the DKIM mailing list, arrangements are being
              made to offer feedback to the sender so they can determine the level of abuse. The
              term discardable is likely to thwart adoption when the integrity of the delivery
              status is also important. If the mechanism proves effective, the level of abuse should
              also dramatically wane.
</dd>
</dl></blockquote>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
6. Security Considerations</h3>

<p>Consider appending portions of this draft's Security Considerations.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This document requires no IANA consideration.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Considerations not managed by draft-ietf-dkim-ssp</h3>

<p>DKIM keys with a restrictive local-part template in the <tt>g=</tt>
          tag and value are likely to be employed by remote signing agents beyond the direct control
          of the signing domain. As a result, additional consideration is required when a
          restrictive local-part template does not match against the From header field. Signatures
          should not be considered valid whenever a restrictive local-part key <tt>g=</tt> tag and value, and the signature <tt>d=</tt> tag and
          value, do not match against a From header field address.
</p>
<p>Signatures by keys lacking a restrictive local-part template are only safely used when
          the signing agent is able to directly evaluate the signed header fields and content.
          Recognition of signing agents able to apply policy over the entire message improves
          security in several ways:</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>Discerns potentially deceptive signatures, independent of advertised signing practice
              discovery.
</dd>
<dt></dt>
<dd>Permits an accurate indication of on whose behalf the signature was added, even when
              not on behalf of the author's address.
</dd>
<dt></dt>
<dd>Permits the &quot;on behalf of&quot; identity to be derived from an account,
              instead of being left blank, when a signing domain is unable or unwilling to affirm
              the identity of the author's address.
</dd>
<dt></dt>
<dd>Permits the identity to track either the author or the account used. In response to a
              growing portion of the IP address space being blocked, bot-nets increasingly send
              their mail through a provider's outbound server after obtaining access to valid
              accounts. Being able to track the element granted access by a domain is most useful to
              third-parties wanting to implement a safe basis for refusing problematic accounts.
              Blocking problematic accounts will likely isolate bot-net 0wned systems.
</dd>
</dl></blockquote>

<p>A valid DKIM signature does not safely provide an assertion of the author's identity, and
          only the domain contained within the signature will have been verified by DKIM signature
          validation. In addition, when the &quot;on-behalf-of&quot; identity signing is
          restricted, and does not match against the From header field, the signature should not be
          considered valid.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1.1"></a><h3>7.1.1.&nbsp;
Lack of transport specificity</h3>

<p><a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> fails to signal which transport protocol implements
            an advertised practice. As such, it also fails to indicate which DNS resource, if any,
            supports the transport. Although verifying a domain's existence might query resource
            records specified by <a class='info' href='#RFC2821'>[RFC2821]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; April&nbsp;2001.</span><span>)</span></a>, the associated transport is never
            specified, where only returned query errors are meaningful.
</p>
<p>Since the goal is to control use of a domain in the From header field, a DNS error will
            then likely require a message to be refused, because the proposed methods are unable to
            resolve practices over a domain hierarchy. <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> also never
            specifies a transport or the related resource records. This means any wildcard resource
            record within the domain will thereby allow domain spoofing. Any domain that uses
            wildcards will permit any synthesized domain appear to lack advertised practice
            assertions.
</p>
<p>Contrary to the MUST NOT use wildcards mandate, a solution for covering the entire
            domain hierarchy or for coping with wildcard resources will likely be wildcard TXT
            resource records containing restrictive practice assertions. The sanctioned alternative
            would be to publish separate resource records at each existing domain node. As if a per
            node alternative was not bad enough, this alternative is made even less attractive by
            requiring more entries and by consuming more resources than otherwise required had a
            specific resource record been defined for ADSP, or had just a single prefix been used.
</p>
<p>The additional DNS overhead occurs with the use of two prefixed subdomain labels
            locating the TXT resource record. Instead of just the 6 byte &quot;_adsp.&quot;,
            the additional &quot;_domainkey.&quot; label introduces an additional 11 bytes
            and subdomain for every DNS node protected. The logic for having any label was to
            accommodate typical web-based commodity provider tools that often do not support new
            resource record types.
</p>
<p>Justification for the second label is likely based upon a false assumption that the
            delegation of the &quot;_domainkey.&quot; subdomain will also facilitate the
            typical needs of third-party providers that advertise practices at only the domain
            supporting the transport. Use of the &quot;_domainkey.&quot; subdomain for
            placement of ADSP resource records also makes it impossible to ascertain whether the
            domain might have generated a signature that can not be verified.
</p>
<p>There are transport protocols in wide use that employ <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a>
            messages, but that might not utilize DNS. There are also cases where a domain contained
            within a message is intentionally not found in DNS. Such domains may be used to deal
            with a different name space, or to ensure the related email address is not exploited by
            spammers. Without any transport or related resources being defined, <a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> fails offer a practical a means to deal with messages
            that might conflict with its strategy that depends upon the lack of DNS errors as an
            implied basis for acceptance.
</p>
<p><a class='info' href='#I-D.ietf-dkim-ssp'>[I&#8209;D.ietf&#8209;dkim&#8209;ssp]<span> (</span><span class='info'>field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP),&rdquo; May&nbsp;2009.</span><span>)</span></a> should recommend that recipients be advised to use
          automated folder placement for trusted signing domains to reduce deceptions that utilize
          domain look-alike and subdomain based tactics.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1.2"></a><h3>7.1.2.&nbsp;
DNS Wildcards and specifying SMTP as the transport</h3>

<p>With the exception of wildcard MX records, wildcards within a domain that also publish
            ADSP records should not pose a significant problem. Although referencing SMTP related
            records will not provide <tt>NXDOMAIN</tt> results when a domain
            contains a wildcard, SMTP discovery records, such as MX or A records, still offer
            evidence of SMTP support. Whether AAAA records, absent MX or A records, can be
            considered evidence of SMTP support has not withstood the widespread use of AAAA only
            servers.
</p>
<p>For security reasons, SMTP should also adopt an MX resource record mandate for the
            acceptance of public exchanges. This would then mean advertised practice discovery could
            be limited to subdomains containing MX records, and ensure failure of a single
            transaction obtaining an MX record would curtail all other message related transactions.
            An MX resource record mandate would thereby shelter domains not publishing MX records
            from the additional assortment of transactions often associated with any number of
            spoofed email-addresses and DKIM signatures that might be generated per message.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;References - Normative</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dkim-ssp">[I-D.ietf-dkim-ssp]</a></td>
<td class="author-text">field, h., Domain, A., error, r., Allman, E., Fenton, J., Delany, M., and J. Levine, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dkim-ssp-10.txt">DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)</a>,&rdquo; draft-ietf-dkim-ssp-10 (work in progress), May&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dkim-ssp-10.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;References - Informative</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2181">[RFC2181]</a></td>
<td class="author-text"><a href="mailto:kre@munnari.OZ.AU">Elz, R.</a> and <a href="mailto:randy@psg.com">R. Bush</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2181">Clarifications to the DNS Specification</a>,&rdquo; RFC&nbsp;2181, July&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2181.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2181.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2181.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2606">[RFC2606]</a></td>
<td class="author-text"><a href="mailto:dee3@us.ibm.com">Eastlake, D.</a> and <a href="mailto:buglady@fuschia.net">A. Panitz</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2606">Reserved Top Level DNS Names</a>,&rdquo; BCP&nbsp;32, RFC&nbsp;2606, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2606.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2782">[RFC2782]</a></td>
<td class="author-text"><a href="mailto:arnt@troll.no">Gulbrandsen, A.</a>, Vixie, P., and <a href="mailto:levone@microsoft.com">L. Esibov</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>,&rdquo; RFC&nbsp;2782, February&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2782.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2821">[RFC2821]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc2821">Simple Mail Transfer Protocol</a>,&rdquo; RFC&nbsp;2821, April&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc2821.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2822">[RFC2822]</a></td>
<td class="author-text">Resnick, P., &ldquo;<a href="http://tools.ietf.org/html/rfc2822">Internet Message Format</a>,&rdquo; RFC&nbsp;2822, April&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc2822.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[RFC4033]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4034">[RFC4034]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4034">Resource Records for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4034, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4686">[RFC4686]</a></td>
<td class="author-text">Fenton, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4686">Analysis of Threats Motivating DomainKeys Identified Mail (DKIM)</a>,&rdquo; RFC&nbsp;4686, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4686.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4871">[RFC4871]</a></td>
<td class="author-text">Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;<a href="http://tools.ietf.org/html/rfc4871">DomainKeys Identified Mail (DKIM) Signatures</a>,&rdquo; RFC&nbsp;4871, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4871.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5016">[RFC5016]</a></td>
<td class="author-text">Thomas, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5016">Requirements for a DomainKeys Identified Mail (DKIM) Signing Practices Protocol</a>,&rdquo; RFC&nbsp;5016, October&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5016.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5234.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Douglas Otis</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trend Micro, NSSG</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10101 N. De Anza Blvd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cupertino, CA  95014</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1.408.257-1500</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:doug_otis@trendmicro.com">doug_otis@trendmicro.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
