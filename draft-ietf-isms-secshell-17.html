<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Secure Shell
    Transport Model for SNMP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Secure Shell
    Transport Model for SNMP">
<meta name="keywords" content="Network Management, Simple Network Management Protocol, SNMP, Secure Shell, SSH">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. Harrington</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Huawei Technologies (USA)</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">J. Salowey</td></tr>
<tr><td class="header">Expires: November 7, 2009</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">W. Hardaker</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Sparta, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">May 06, 2009</td></tr>
</table></td></tr></table>
<h1><br />Secure Shell
    Transport Model for SNMP<br />draft-ietf-isms-secshell-17</h1>

<h3>Status of This Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on November 7, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This memo describes a Transport Model for the Simple Network
      Management Protocol, using the Secure Shell protocol (SSH).
</p>
<p>This memo also defines a portion of the Management Information Base
      (MIB) for use with network management protocols in TCP/IP based
      internets. In particular it defines objects for monitoring and managing
      the Secure Shell Transport Model for SNMP.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
The Internet-Standard Management Framework<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
Modularity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">1.4.</a>&nbsp;
Motivation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">1.5.</a>&nbsp;
Constraints<br />
<a href="#anchor7">2.</a>&nbsp;
The Secure Shell Protocol<br />
<a href="#anchor8">3.</a>&nbsp;
How SSHTM Fits into the Transport Subsystem<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.1.</a>&nbsp;
Security Capabilities of this Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.1.1.</a>&nbsp;
Threats<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.1.2.</a>&nbsp;
Message Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.1.3.</a>&nbsp;
Authentication Protocol Support<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.1.4.</a>&nbsp;
SSH Subsystem<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.2.</a>&nbsp;
Security Parameter Passing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">3.3.</a>&nbsp;
Notifications and Proxy<br />
<a href="#anchor16">4.</a>&nbsp;
Cached Information and References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.1.</a>&nbsp;
Secure Shell Transport Model Cached Information<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.1.1.</a>&nbsp;
tmSecurityName<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.1.2.</a>&nbsp;
tmSessionID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">4.1.3.</a>&nbsp;
Session State<br />
<a href="#eop">5.</a>&nbsp;
Elements of Procedure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#incomingeop">5.1.</a>&nbsp;
Procedures for an Incoming Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">5.2.</a>&nbsp;
Procedures for sending an Outgoing Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#establish">5.3.</a>&nbsp;
Establishing a Session<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">5.4.</a>&nbsp;
Closing a Session<br />
<a href="#anchor23">6.</a>&nbsp;
MIB Module Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">6.1.</a>&nbsp;
Structure of the MIB Module<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">6.2.</a>&nbsp;
Textual Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">6.3.</a>&nbsp;
Relationship to Other MIB Modules<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">6.3.1.</a>&nbsp;
MIB Modules Required for IMPORTS<br />
<a href="#anchor28">7.</a>&nbsp;
MIB Module Definition<br />
<a href="#anchor29">8.</a>&nbsp;
Operational Considerations<br />
<a href="#anchor30">9.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">9.1.</a>&nbsp;
Skipping Public Key Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">9.2.</a>&nbsp;
Notification Authorizaton Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">9.3.</a>&nbsp;
SSH User and Key Selection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">9.4.</a>&nbsp;
Conceptual Differences Between USM and SSHTM<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">9.5.</a>&nbsp;
The 'none' MAC Algorithm<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">9.6.</a>&nbsp;
Use with SNMPv1/v2c Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">9.7.</a>&nbsp;
MIB Module Security<br />
<a href="#anchor38">10.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor39">11.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This memo describes a Transport Model for the Simple Network
      Management Protocol, using the Secure Shell protocol (SSH) <a class='info' href='#RFC4251'>[RFC4251]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Protocol Architecture,&rdquo; January&nbsp;2006.</span><span>)</span></a> within a transport subsystem <a class='info' href='#I-D.ietf-isms-tmsm'>[I&#8209;D.ietf&#8209;isms&#8209;tmsm]<span> (</span><span class='info'>Harrington, D. and J. Schoenwaelder, &ldquo;Transport Subsystem for the Simple Network Management Protocol (SNMP),&rdquo; May&nbsp;2009.</span><span>)</span></a>. The transport model specified in
      this memo is referred to as the Secure Shell Transport Model
      (SSHTM).
</p>
<p>This memo also defines a portion of the Management Information Base
      (MIB) for use with network management protocols in TCP/IP based
      internets. In particular it defines objects for monitoring and managing
      the Secure Shell Transport Model for SNMP.
</p>
<p>It is important to understand the SNMP architecture <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a> and the terminology of the architecture to
      understand where the Transport Model described in this memo fits into
      the architecture and interacts with other subsystems within the
      architecture.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
The Internet-Standard Management Framework</h3>

<p>For a detailed overview of the documents that describe the current
        Internet-Standard Management Framework, please refer to section 7 of
        RFC 3410 <a class='info' href='#RFC3410'>[RFC3410]<span> (</span><span class='info'>Case, J., Mundy, R., Partain, D., and B. Stewart, &ldquo;Introduction and Applicability Statements for Internet-Standard Management Framework,&rdquo; December&nbsp;2002.</span><span>)</span></a>.
</p>
<p>Managed objects are accessed via a virtual information store,
        termed the Management Information Base or MIB. MIB objects are
        generally accessed through the Simple Network Management Protocol
        (SNMP). Objects in the MIB are defined using the mechanisms defined in
        the Structure of Management Information (SMI). This memo specifies a
        MIB module that is compliant to the SMIv2, which is described in STD
        58, RFC 2578 <a class='info' href='#RFC2578'>[RFC2578]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Structure of Management Information Version 2 (SMIv2),&rdquo; April&nbsp;1999.</span><span>)</span></a>, STD 58, RFC 2579 <a class='info' href='#RFC2579'>[RFC2579]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Textual Conventions for SMIv2,&rdquo; April&nbsp;1999.</span><span>)</span></a> and STD 58, RFC 2580 <a class='info' href='#RFC2580'>[RFC2580]<span> (</span><span class='info'>McCloghrie, K., Perkins, D., and J. Schoenwaelder, &ldquo;Conformance Statements for SMIv2,&rdquo; April&nbsp;1999.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Conventions</h3>

<p>For consistency with SNMP-related specifications, this document
        favors terminology as defined in STD62 rather than favoring
        terminology that is consistent with non-SNMP specifications. This is
        consistent with the IESG decision to not require the SNMPv3
        terminology be modified to match the usage of other non-SNMP
        specifications when SNMPv3 was advanced to Full Standard.
</p>
<p>Authentication in this document typically refers to the English
        meaning of "serving to prove the authenticity of" the message, not
        data source authentication or peer identity authentication.
</p>
<p>The terms "manager" and "agent" are not used in this document,
        because in the RFC 3411 architecture <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>,
        all SNMP entities have the capability of acting in either manager or
        agent or in both roles depending on the SNMP application types
        supported in the implementation. Where distinction is required, the
        application names of Command Generator, Command Responder,
        Notification Originator, Notification Receiver, and Proxy Forwarder
        are used. See "SNMP Applications" <a class='info' href='#RFC3413'>[RFC3413]<span> (</span><span class='info'>Levi, D., Meyer, P., and B. Stewart, &ldquo;Simple Network Management Protocol (SNMP) Applications,&rdquo; December&nbsp;2002.</span><span>)</span></a> for
        further information.
</p>
<p>Throughout this document, the terms "client" and "server" are used
        to refer to the two ends of the SSH transport connection. The client
        actively opens the SSH connection, and the server passively listens
        for the incoming SSH connection. Either SNMP entity may act as client
        or as server, as discussed further below.
</p>
<p>The User-Based Security Model (USM) <a class='info' href='#RFC3414'>[RFC3414]<span> (</span><span class='info'>Blumenthal, U. and B. Wijnen, &ldquo;User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3),&rdquo; December&nbsp;2002.</span><span>)</span></a>
        is a mandatory-to-implement Security Model in STD 62. While SSH and
        USM frequently refer to a user, the terminology preferred in RFC3411
        <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a> and in this memo is "principal". A
        principal is the "who" on whose behalf services are provided or
        processing takes place. A principal can be, among other things, an
        individual acting in a particular role; a set of individuals, with
        each acting in a particular role; an application or a set of
        applications, or a combination of these within an administrative
        domain.
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>Non uppercased versions of the keywords should be read as in normal
        English. They will usually, but not always, be used in a context
        relating to compatibility with the RFC3411 architecture or the
        subsystem defined here, but which might have no impact on on-the-wire
        compatibility. These terms are used as guidance for designers of
        proposed IETF models to make the designs compatible with RFC3411
        subsystems and Abstract Service Interfaces (ASIs) (see section 3.2).
        Implementers are free to implement differently. Some usages of these
        lowercase terms are simply normal English usage.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Modularity</h3>

<p>The reader is expected to have read and understood the description
        of the SNMP architecture, as defined in <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>, and the Transport Subsystem architecture
        extension specified in "Transport Subsystem for the Simple Network
        Management Protocol" <a class='info' href='#I-D.ietf-isms-tmsm'>[I&#8209;D.ietf&#8209;isms&#8209;tmsm]<span> (</span><span class='info'>Harrington, D. and J. Schoenwaelder, &ldquo;Transport Subsystem for the Simple Network Management Protocol (SNMP),&rdquo; May&nbsp;2009.</span><span>)</span></a>.
</p>
<p>This memo describes the Secure Shell Transport Model for SNMP, a
        specific SNMP transport model to be used within the SNMP transport
        subsystem to provide authentication, encryption, and integrity
        checking of SNMP messages.
</p>
<p>In keeping with the RFC 3411 design decision to use self-contained
        documents, this document defines the elements of procedure and
        associated MIB module objects which are needed for processing the
        Secure Shell Transport Model for SNMP.
</p>
<p>This modularity of specification is not meant to be interpreted as
        imposing any specific requirements on implementation.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.4"></a><h3>1.4.&nbsp;
Motivation</h3>

<p>Version 3 of the Simple Network Management Protocol (SNMPv3) added
        security to the protocol. The User-based Security Model (USM) <a class='info' href='#RFC3414'>[RFC3414]<span> (</span><span class='info'>Blumenthal, U. and B. Wijnen, &ldquo;User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3),&rdquo; December&nbsp;2002.</span><span>)</span></a> was designed to be independent of other
        existing security infrastructures, to ensure it could function when
        third party authentication services were not available, such as in a
        broken network. As a result, USM utilizes a separate user and key
        management infrastructure. Operators have reported that deploying
        another user and key management infrastructure in order to use SNMPv3
        is a reason for not deploying SNMPv3.
</p>
<p>This memo describes a transport model that will make use of the
        existing and commonly deployed Secure Shell security infrastructure.
        This transport model is designed to meet the security and operational
        needs of network administrators, maximize usability in operational
        environments to achieve high deployment success and at the same time
        minimize implementation and deployment costs to minimize deployment
        time.
</p>
<p>This document addresses the requirement for the SSH client to
        authenticate the SSH server, for the SSH server to authenticate the
        SSH client, and describes how SNMP can make use of the authenticated
        identities in authorization policies for data access, in a manner that
        is independent of any specific access control model.
</p>
<p>This document addresses the requirement to utilize client
        authentication and key exchange methods which support different
        security infrastructures and provide different security properties.
        This document describes how to use client authentication as described
        in "SSH Authentication Protocol" <a class='info' href='#RFC4252'>[RFC4252]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Authentication Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>. The
        SSH Transport Model should work with any of the ssh-userauth methods
        including the "publickey", "password", "hostbased", "none",
        "keyboard-interactive", "gssapi-with-mic", ."gssapi-keyex", "gssapi",
        and "external-keyx" (see
        http://www.iana.org/assignments/ssh-parameters). The use of the "none"
        authentication method is NOT RECOMMENDED, as described in Security
        Considerations. Local accounts may be supported through the use of the
        publickey, hostbased or password methods. The password method allows
        for integration with deployed password infrastructure such as AAA
        servers using the RADIUS protocol <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>. The
        SSH Transport Model SHOULD be able to take advantage of future defined
        ssh-userauth methods, such as those that might make use of X.509
        certificate credentials.
</p>
<p>It is desirable to use mechanisms that could unify the approach for
        administrative security for SNMPv3 and Command Line interfaces (CLI)
        and other management interfaces. The use of security services provided
        by Secure Shell is the approach commonly used for the CLI, and is the
        approach being adopted for use with NETCONF <a class='info' href='#RFC4742'>[RFC4742]<span> (</span><span class='info'>Wasserman, M. and T. Goddard, &ldquo;Using the NETCONF Configuration Protocol over Secure SHell (SSH),&rdquo; December&nbsp;2006.</span><span>)</span></a>. This memo describes a method for invoking
        and running the SNMP protocol within a Secure Shell (SSH) session as
        an SSH subsystem.
</p>
<p>This memo describes how SNMP can be used within a Secure Shell
        (SSH) session, using the SSH connection protocol <a class='info' href='#RFC4254'>[RFC4254]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Connection Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a> over the SSH transport protocol, using SSH
        user-auth <a class='info' href='#RFC4252'>[RFC4252]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Authentication Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a> for authentication.
</p>
<p>There are a number of challenges to be addressed to map Secure
        Shell authentication method parameters into the SNMP architecture so
        that SNMP continues to work without any surprises. These are discussed
        in detail below.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.5"></a><h3>1.5.&nbsp;
Constraints</h3>

<p>The design of this SNMP Transport Model is influenced by the
        following constraints: </p>
<ol class="text">
<li>In times of network stress, the transport protocol and its
            underlying security mechanisms SHOULD NOT depend upon the ready
            availability of other network services (e.g., Network Time
            Protocol (NTP) or AAA protocols).
</li>
<li>When the network is not under stress, the transport model and
            its underlying security mechanisms MAY depend upon the ready
            availability of other network services.
</li>
<li>It may not be possible for the transport model to determine
            when the network is under stress.
</li>
<li>A transport model SHOULD NOT require changes to the SNMP
            architecture.
</li>
<li>A transport model SHOULD NOT require changes to the underlying
            security protocol.
</li>
</ol>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
The Secure Shell Protocol</h3>

<p>SSH is a protocol for secure remote login and other secure network
      services over an insecure network. It consists of three major protocol
      components, and add-on methods for user authentication: </p>
<ul class="text">
<li>The Transport Layer Protocol <a class='info' href='#RFC4253'>[RFC4253]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Transport Layer Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>
          provides server authentication, and message confidentiality and
          integrity. It may optionally also provide compression. The transport
          layer will typically be run over a TCP/IP connection, but might also
          be used on top of any other reliable data stream.
</li>
<li>The User Authentication Protocol <a class='info' href='#RFC4252'>[RFC4252]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Authentication Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>
          authenticates the client-side principal to the server. It runs over
          the transport layer protocol.
</li>
<li>The Connection Protocol <a class='info' href='#RFC4254'>[RFC4254]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Connection Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>
          multiplexes the encrypted tunnel into several logical channels. It
          runs over the transport after successfully authenticating the
          principal.
</li>
<li>Generic Message Exchange Authentication <a class='info' href='#RFC4256'>[RFC4256]<span> (</span><span class='info'>Cusack, F. and M. Forssen, &ldquo;Generic Message Exchange Authentication for the Secure Shell Protocol (SSH),&rdquo; January&nbsp;2006.</span><span>)</span></a> is a general purpose authentication method
          for the SSH protocol, suitable for interactive authentications where
          the authentication data should be entered via a keyboard
</li>
<li>Generic Security Service Application Program Interface (GSS-API)
          Authentication and Key Exchange for the Secure Shell (SSH) Protocol
          <a class='info' href='#RFC4462'>[RFC4462]<span> (</span><span class='info'>Hutzelman, J., Salowey, J., Galbraith, J., and V. Welch, &ldquo;Generic Security Service Application Program Interface (GSS-API) Authentication and Key Exchange for the Secure Shell (SSH) Protocol,&rdquo; May&nbsp;2006.</span><span>)</span></a> describes methods for using the
          GSS-API for authentication and key exchange in SSH. It defines an
          SSH user authentication method that uses a specified GSS-API
          mechanism to authenticate a user, and a family of SSH key exchange
          methods that use GSS-API to authenticate a Diffie-Hellman key
          exchange.
</li>
</ul><p>The client sends a service request once a secure transport
      layer connection has been established. A second service request is sent
      after client authentication is complete. This allows new protocols to be
      defined and coexist with the protocols listed above.
</p>
<p>The connection protocol provides channels that can be used for a wide
      range of purposes. Standard methods are provided for setting up secure
      interactive shell sessions and for forwarding ("tunneling") arbitrary
      TCP/IP ports and X11 connections.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
How SSHTM Fits into the Transport Subsystem</h3>

<p>A transport model is a component of the Transport Subsystem <a class='info' href='#I-D.ietf-isms-tmsm'>[I&#8209;D.ietf&#8209;isms&#8209;tmsm]<span> (</span><span class='info'>Harrington, D. and J. Schoenwaelder, &ldquo;Transport Subsystem for the Simple Network Management Protocol (SNMP),&rdquo; May&nbsp;2009.</span><span>)</span></a> within the SNMP architecture. The SSH
      Transport Model thus fits between the underlying SSH transport layer and
      the message dispatcher <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>.
</p>
<p>The SSH Transport Model will establish a channel between itself and
      the SSH Transport Model of another SNMP engine. The sending transport
      model passes unencrypted messages from the dispatcher to SSH to be
      encrypted, and the receiving transport model accepts decrypted incoming
      messages from SSH and passes them to the dispatcher.
</p>
<p>After an SSH Transport model channel is established, then SNMP
      messages can conceptually be sent through the channel from one SNMP
      message dispatcher to another SNMP message dispatcher. Multiple SNMP
      messages MAY be passed through the same channel.
</p>
<p>The SSH Transport Model of an SNMP engine will perform the
      translation between SSH-specific security parameters and SNMP-specific,
      model-independent parameters.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Security Capabilities of this Model</h3>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Threats</h3>

<p>The Secure Shell Transport Model provides protection against the
          threats identified by the RFC 3411 architecture <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>:
</p>
<p></p>
<ol class="text">
<li>Modification of Information - SSH provides for
	      verification that the contents of each message has not
	      been modified during its transmission through the
	      network, by digitally signing each SSH packet.
</li>
<li>Masquerade - SSH provides for verification of the
              identity of the SSH server and the identity of the SSH
              client.

	      <br />
<br />


	      SSH provides for verification of the identity of the SSH
	      server through the SSH Transport Protocol server
	      authentication <a class='info' href='#RFC4253'>[RFC4253]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Transport Layer Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>. This allows
	      an operator or management station to ensure the
	      authenticity of the SNMP engine that provides MIB data.

	      <br />
<br />


              SSH provides a number of mechanisms for
              verification of the identity of the SSH client-side
              principal, using the Secure Shell Authentication
              Protocol <a class='info' href='#RFC4252'>[RFC4252]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Authentication Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>. These include
              public key, password and host-based mechanisms. This
              allows the SNMP access control subsystem to ensure that
              only authorized principals have access to potentially
              sensitive data.

	      <br />
<br />


              Verification of client's principal identity is important
              for use with the SNMP access control subsystem, to
              ensure that only authorized principals have access to
              potentially sensitive data.  The SSH user identity is
              provided to the transport model, so it can be used to
              map to an SNMP model-independent securityName for use
              with SNMP access control and notification configuration.
              (The identity may undergo various transforms before it
              maps to the securityName.)
</li>
<li>Message Stream Modification - SSH protects against
	      malicious re-ordering or replaying of messages within a
	      single SSH session by using sequence numbers and
	      integrity checks. SSH protects against replay of
	      messages across SSH sessions by ensuring that the
	      cryptographic keys used for encryption and integrity
	      checks are generated afresh for each session.
</li>
<li>Disclosure - SSH provides protection against the
	      disclosure of information to unauthorized recipients or
	      eavesdroppers by allowing for encryption of all traffic
	      between SNMP engines.
</li>
</ol>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Message Authentication</h3>

<p>The RFC 3411 architecture recognizes three levels of security:
          </p>
<blockquote class="text">
<p>- without authentication and without privacy
              (noAuthNoPriv)
</p>
<p>- with authentication but without privacy (authNoPriv)
</p>
<p>- with authentication and with privacy (authPriv)
</p>
</blockquote>

<p>The Secure Shell protocol provides support for encryption and
          data integrity. While it is technically possible to support no
          authentication and no encryption in SSH it is NOT RECOMMENDED by
          <a class='info' href='#RFC4253'>[RFC4253]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Transport Layer Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>.
</p>
<p>The SSH Transport Model determines from SSH the identity of the
          authenticated principal, and the type and address associated with an
          incoming message, and provides this
          information to SSH for an outgoing message. The SSH transport layer
          algorithms used to provide authentication, data integrity and
          encryption SHOULD NOT be exposed to the SSH Transport Model layer.
          The SNMPv3 WG deliberately avoided this and settled for an assertion
          by the security model that the requirements of securityLevel were
          met. The SSH Transport Model has no mechanisms by which it can test
          whether an underlying SSH connection provides auth or priv, so the
          SSH Transport Model trusts that the underlying SSH connection has
          been properly configured to support authPriv security
          characteristics.
</p>
<p>An SSH Transport
	  Model-compliant implementation MUST use an SSH connection
	  that provides authentication, data integrity and encryption
	  that meets the highest level of SNMP security
	  (authPriv). Outgoing messages specified with a securityLevel
	  of noAuthNoPriv or authNoPriv, are actually sent by the SSH
	  Transport Model with authPriv-level protection.
</p>
<p>The security protocols used in the Secure Shell Authentication
          Protocol <a class='info' href='#RFC4252'>[RFC4252]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Authentication Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a> and the Secure Shell
          Transport Layer Protocol <a class='info' href='#RFC4253'>[RFC4253]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Transport Layer Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a> are
          considered acceptably secure at the time of writing. However, the
          procedures allow for new authentication and privacy methods to be
          specified at a future time if the need arises.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
Authentication Protocol Support</h3>

<p>The SSH Transport Model should support any server or client
          authentication mechanism supported by SSH. This includes the three
          authentication methods described in the SSH Authentication Protocol
          document <a class='info' href='#RFC4252'>[RFC4252]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Authentication Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a> - publickey, password, and
          host-based - and keyboard interactive and others.
</p>
<p>The password authentication mechanism allows for integration with
          deployed password based infrastructure. It is possible to hand a
          password to a service such as RADIUS <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>
          or Diameter <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> for validation. The
          validation could be done using the user-name and user-password
          attributes. It is also possible to use a different password
          validation protocol such as CHAP <a class='info' href='#RFC1994'>[RFC1994]<span> (</span><span class='info'>Simpson, W., &ldquo;PPP Challenge Handshake Authentication Protocol (CHAP),&rdquo; August&nbsp;1996.</span><span>)</span></a> or
          digest authentication <a class='info' href='#RFC5090'>[RFC5090]<span> (</span><span class='info'>Sterman, B., Sadolevsky, D., Schwartz, D., Williams, D., and W. Beck, &ldquo;RADIUS Extension for Digest Authentication,&rdquo; February&nbsp;2008.</span><span>)</span></a> to integrate
          with RADIUS or Diameter. At some point in the processing, these
          mechanisms require the password be made available as clear text on
          the device that is authenticating the password which might introduce
          threats to the authentication infrastructure.
</p>
<p>GSSKeyex <a class='info' href='#RFC4462'>[RFC4462]<span> (</span><span class='info'>Hutzelman, J., Salowey, J., Galbraith, J., and V. Welch, &ldquo;Generic Security Service Application Program Interface (GSS-API) Authentication and Key Exchange for the Secure Shell (SSH) Protocol,&rdquo; May&nbsp;2006.</span><span>)</span></a> provides a framework for
          the addition of client authentication mechanisms which support
          different security infrastructures and provide different security
          properties. Additional authentication mechanisms, such as one that
          supports X.509 certificates, may be added to SSH in the future.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.4"></a><h3>3.1.4.&nbsp;
SSH Subsystem</h3>

<p>This document describes the use of an SSH subsystem for SNMP to
          make SNMP usage distinct from other usages.
</p>
<p>An SSH subsystem of type "snmp" is opened by the SSH Transport
          Model during the elements of procedure for an outgoing SNMP message.
          Since the sender of a message initiates the creation of an SSH
          session if needed, the SSH session will already exist for an
          incoming message or the incoming message would never reach the SSH
          Transport Model.
</p>
<p>Implementations may choose to instantiate SSH sessions in
          anticipation of outgoing messages. This approach might be useful to
          ensure that an SSH session to a given target can be established
          before it becomes important to send a message over the SSH session.
          Of course, there is no guarantee that a pre-established session will
          still be valid when needed.
</p>
<p>SSH sessions are uniquely identified within the SSH Transport
          Model by the combination of tmTransportAddress and tmSecurityName 
	    associated with each session.
</p>
<p>Because naming policies might differ between administrative
	    domains, many SSH client software packages support a
	    user@hostname:port addressing syntax that operators can use
	    to align non-equivalent account names. The SnmpSSHAddress
	    Textual Convention echos this common SSH notation.
</p>
<p>When this notation is used in an SnmpSSHAddress, the SSH
	    connection should be established with a SSH user name matching
	    the "user" portion of the notation when establishing a
	    session with the remote SSH server. The user name
        must be encoded in UTF-8 (per RFC4252 <a class='info' href='#RFC4252'>[RFC4252]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Authentication Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>). 
        The "user" portion may
	    or may not match the tmSecurityName parameter passed from
	    the security model.  If no "user@" portion is specified in
	    the SnmpSSHAddress, then the SSH connection should be
	    established using the tmSecurityName as the SSH user name when
	    establishing a session with the remote SSH server.
</p>
<p>The SnmpSSHAddress and tmSecurityName associated with an
	    SSH session MUST remain constant during the life of the
	    session. Different SnmpSSHAddress values (with different
	    hostnames, "user@" prefix names and/or port numbers) will
	    each result in individual SSH sessions.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Security Parameter Passing</h3>

<p>For incoming messages, SSH-specific security parameters are
        translated by the transport model into security parameters independent
        of the transport and security models. The transport model accepts
        messages from the SSH subsystem, and records the transport-related and
        SSH-security-related information, including the authenticated
        identity, in a cache referenced by tmStateReference, and passes the
        WholeMsg and the tmStateReference to the dispatcher using the
        receiveMessage() ASI (Application Service Interface).
</p>
<p>For outgoing messages, the transport model takes input provided by
        the dispatcher in the sendMessage() ASI. The SSH Transport Model
        converts that information into suitable security parameters for SSH,
        establishes sessions as needed, and passes messages to the SSH
        subsystem for sending.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Notifications and Proxy</h3>

<p>SSH connections may be initiated by command generators or by
        notification originators. Command generators are frequently operated
        by a human, but notification originators are usually unmanned
        automated processes. As a result, it may be necessary to provision
        authentication credentials on the SNMP engine containing the
        notification originator, or use a third party key provider such as
        Kerberos, so the engine can successfully authenticate to an engine
        containing a notification receiver.
</p>
<p>The targets to whom notifications or proxy requests should
        be sent is typically determined and configured by a network
        administrator. The SNMP-NOTIFICATION-MIB contains a list of
        targets to which notifications should be sent. The
        SNMP-TARGET-MIB module <a class='info' href='#RFC3413'>[RFC3413]<span> (</span><span class='info'>Levi, D., Meyer, P., and B. Stewart, &ldquo;Simple Network Management Protocol (SNMP) Applications,&rdquo; December&nbsp;2002.</span><span>)</span></a> contains
        objects for defining these management targets, including
        transport domains and addresses and security parameters, for
        applications such as notification generators and proxy
        forwarders.
</p>
<p>For the SSH Transport Model, transport type and address are
        configured in the snmpTargetAddrTable, and the securityName,
        and securityLevel parameters are configured in the
        snmpTargetParamsTable.  The default approach is for an
        administrator to statically preconfigure this information to
        identify the targets authorized to receive notifications or
        received proxied messages.  Local access control processing needs to be
        performed by a Notification Originator before notifications are actually sent and this
        processing is done using the configured securityName.  An
        important characteristic of this is that authorization is done
        prior to determining if the connection can succeed.  Thus the
        locally configured securityName is entirely trusted within the
        Notification Originator.
</p>
<p>The SNMP-TARGET-MIB and NOTIFICATION-MIB MIB modules may be
        configured using SNMP or other implementation-dependent
        mechanisms, such as CLI scripting or loading a configuration
        file. It may be necessary to provide additional
        implementation-specific configuration of SSH parameters.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Cached Information and References</h3>

<p>When performing SNMP processing, there are two levels of state
   information that may need to be retained:  the immediate state
   linking a request-response pair, and potentially longer-term state
   relating to transport and security. <a class='info' href='#I-D.ietf-isms-tmsm'>"Transport Subsystem for the Simple Network Management Protocol"<span> (</span><span class='info'>Harrington, D. and J. Schoenwaelder, &ldquo;Transport Subsystem for the Simple Network Management Protocol (SNMP),&rdquo; May&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;isms&#8209;tmsm] defines general requirements for caches and references. 
</p>
<p>This document defines additional cache requirements related to the Secure Shell Transport Model.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Secure Shell Transport Model Cached Information</h3>

<p>The Secure Shell Transport Model has specific
          responsibilities regarding the cached information. See the
          Elements of Procedure in <a class='info' href='#eop'>Section&nbsp;5<span> (</span><span class='info'>Elements of Procedure</span><span>)</span></a> for detailed processing instructions on the use of the tmStateReference fields by the SSH Transport Model.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
tmSecurityName</h3>

<p>The tmSecurityName MUST be a human-readable name (in
        snmpAdminString format) representing the identity that has
        been set according to the procedures in <a class='info' href='#eop'>Section&nbsp;5<span> (</span><span class='info'>Elements of Procedure</span><span>)</span></a>.
        The tmSecurityName MUST be constant for all traffic passing
        through an SSHTM session.  Messages MUST NOT be sent through
        an existing SSH session that was established using a different
        tmSecurityName.
</p>
<p>On the SSH server side of a connection:
</p>
<p>
        </p>
<blockquote class="text">
<p>The tmSecurityName should be the SSH user name.  How the SSH user
	   name is extracted from the SSH layer is
	   implementation-dependent.
</p>
<p>The SSH protocol is not always clear on whether the user name field 
must be filled in, so for some implementations, such as those using
GSSAPI authentication, it may be necessary to use a mapping algorithm
to transform an SSH identity to a tmSecurityName, or to transform a tmSecurityName to an SSH identity. 
</p>
<p>In other cases the user name may not be verified by the server, 
      so for these implementations, it may be necessary to obtain the 
      user name from other credentials exchanged during the SSH
exchange.
</p>
</blockquote>

<p>On the SSH client side of a connection:
</p>
<p>
        </p>
<blockquote class="text">
<p>The tmSecurityName is presented to the SSH Transport Model
            by the application (possibly because of configuration
            specified in the SNMP-TARGET-MIB).
</p>
</blockquote>

<p>The securityName MAY be derived from the tmSecurityName by a security model, and MAY be used to configure notifications and  access controls in MIB modules. Transport models SHOULD generate a predictable tmSecurityName so operators will know what to use when configuring MIB modules that use securityNames derived from tmSecurityNames.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
tmSessionID</h3>

<p> The tmSessionID MUST be recorded per message at the time of receipt. When 
        tmSameSecurity is set, the recorded tmSessionID can be used to determine whether the SSH
        session available for sending a corresponding outgoing message is the same SSH session as
        was used when receiving the  incoming message (e.g., a response to a request).
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.3"></a><h3>4.1.3.&nbsp;
Session State</h3>

<p>The per-session state that is referenced by tmStateReference may be saved across multiple messages in a Local Configuration Datastore. Additional session/connection state information might also be stored in a Local Configuration Datastore.
</p>
<a name="eop"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Elements of Procedure</h3>

<p>Abstract service interfaces have been defined by <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a> and
      further augmented by <a class='info' href='#I-D.ietf-isms-tmsm'>[I&#8209;D.ietf&#8209;isms&#8209;tmsm]<span> (</span><span class='info'>Harrington, D. and J. Schoenwaelder, &ldquo;Transport Subsystem for the Simple Network Management Protocol (SNMP),&rdquo; May&nbsp;2009.</span><span>)</span></a> to describe
      the conceptual data flows between the various subsystems within an SNMP
      entity. The Secure Shell Transport Model uses some of these conceptual
      data flows when communicating between subsystems.
</p>
<p>To simplify the elements of procedure, the release of state
      information is not always explicitly specified. As a general rule, if
      state information is available when a message gets discarded, the
      message-state information should also be released, and if state
      information is available when a session is closed, the session state
      information should also be released.
</p>
<p>An error indication in statusInformation will typically include
   the OID and value for an incremented error counter.  This may be
   accompanied by the requested securityLevel, and the
   tmStateReference.  Per-message context information is not
   accessible to Transport Models, so for the returned counter OID and
   value, contextEngine would be set to the local value of
   snmpEngineID, and contextName to the default context for error
   counters.
</p>
<a name="incomingeop"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Procedures for an Incoming Message</h3>

<p>
	</p>
<ol class="text">
<li>The SSH Transport Model queries the SSH engine, in an
            implementation-dependent manner, to determine the
            address the message originated from, the user name
            authenticated by SSH, and a session identifier. 
	    
</li>
<li>Determine the tmTransportAddress to be associated with the
	    incoming message:
	      
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>If this is a client-side SSH session, then the
		  tmTransportAddress is set to the tmTransportAddress
		  used to establish the session.  It MUST exactly
		  include any "user@" prefix associated with the
		  address provided to the openSession() ASI.
</dd>
<dt>B.</dt>
<dd>If this is a server-side SSH session and this is
		  the first message received over the session, then
		  the tmTransportAddress is set to the address the
		  message originated from, determined in an
		  implementation-dependent way.  This value MUST be
		  constant for the entire SSH session and future
		  messages received MUST result in the
		  tmTransportAddress being set to the same value.
</dd>
<dt>C.</dt>
<dd>If this is a server-side SSH session and this is
		  not the first message received over the session,
		  then the tmTransportAddress is set to the previously
		  established tmTransportAddress for the session
		  (the value from step B. determined from a
		  previous incoming message).
</dd>
</dl></blockquote>
	    
</li>
<li>Determine the tmSecurityName to be associated with the
	    incoming message:
	      
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>If this is a client-side SSH session, then the
		  tmSecurityName MUST be set to the tmSecurityName
		  used to establish the session.
</dd>
<dt>B.</dt>
<dd>If this is a server-side SSH session and this is
		  the first message received over the session, then
		  the tmSecurityName is set to the SSH user name.  How
		  the SSH user name is extracted from the SSH layer is
		  implementation-dependent.  This value MUST be
		  constant for the entire SSH session and future
		  messages received MUST result in the tmSecurityName
		  being set to the same value.
</dd>
<dt>C.</dt>
<dd>If this is a server-side SSH session and this is
		  not the first message received over the session,
		  then the tmSecurityName is set to the previously
		  established tmSecurityName for the session (the
		  value from step B. determined from a previous
		  incoming message).
</dd>
</dl></blockquote>
	    
</li>
<li>Create a tmStateReference cache for subsequent
            reference to the information.

            
<blockquote class="text">
<p>tmTransportDomain = snmpSSHDomain
</p>
<p>tmTransportAddress = the derived tmTransportAddress
                from step 2.
</p>
<p>tmSecurityName = The derived tmSecurityName from
                step 3.
</p>
<p>tmTransportSecurityLevel = "authPriv"
                (authentication and confidentiality MUST be used to
                comply with this transport model.)
</p>
<p>tmSessionID = an implementation-dependent value
                that can be used to detect when a session has closed
                and been replaced by another session. The value in
                tmStateReference MUST uniquely identify the session
                over which the message was received.  This session
                identifier MUST NOT be reused until there are no
                references to it remaining.
</p>
</blockquote>
	    
</li>
</ol><p>
	
</p>
<p>Then the Transport model passes the message to the Dispatcher using
        the following ASI:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
statusInformation =
receiveMessage(
IN   transportDomain       -- snmpSSHDomain
IN   transportAddress      -- The tmTransportAddress for the message
IN   wholeMessage          -- the whole SNMP message from SSH
IN   wholeMessageLength    -- the length of the SNMP message
IN   tmStateReference      -- (NEW) transport info
 )
</pre></div>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Procedures for sending an Outgoing Message</h3>

<p>The Dispatcher passes the information to the Transport Model using
        the ASI defined in the transport subsystem:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

statusInformation =
sendMessage(
IN   destTransportDomain           -- transport domain to be used
IN   destTransportAddress          -- transport address to be used
IN   outgoingMessage               -- the message to send
IN   outgoingMessageLength         -- its length
IN   tmStateReference              -- (NEW) transport info
)
</pre></div>
<p>The SSH Transport Model performs the following tasks.
</p>
<p></p>
<ol class="text">
<li>If tmStateReference does not refer to a cache containing 
             values for tmTransportDomain, tmTransportAddress, tmSecurityName, 
             tmRequestedSecurityLevel, and tmSameSecurity,
            then increment the snmpSshtmSessionInvalidCaches counter,
            discard the message and return the error indication in the
            statusInformation. Processing of this message stops.
</li>
<li>Extract the tmTransportDomain, tmTransportAddress,
            tmSecurityName, tmRequestedSecurityLevel, tmSameSecurity, 
            and tmSessionID from the tmStateReference.
</li>
<li>Identify an SSH session to send the messages over:
	      
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>If tmSameSecurity is true and there is no existing
		  session with a matching tmSessionID, tmSecurityName and
		  tmTransportAddress, then increment the
		  snmpSshtmSessionNoSessions counter, discard the
		  message and return the error indication in the
		  statusInformation. Processing of this message stops.
</dd>
<dt>B.</dt>
<dd>If there is a session with a matching tmSessionID,
		  tmTransportAddress and tmSecurityName, then
		  select that session.
</dd>
<dt>C.</dt>
<dd>If there is a session that matches the
		  tmTransportAddress and tmSecurityName, then select that
		  session.
</dd>
<dt>D.</dt>
<dd>If the above steps failed to select a session to
		  use, then call openSession() with the
		  tmStateReference as a parameter.
		  
<ul class="text">
<li>If openSession fails, then discard the message,
		      release tmStateReference and pass the error
		      indication returned by openSession back to the
		      calling module.  Processing stops for this
		      message.
</li>
<li>If openSession succeeds, then record the
		      destTransportDomain, destTransportAddress,
		      tmSecurityname and tmSessionID in an
		      implementation-dependent manner. This will be
		      needed when processing an incoming message.
</li>
</ul>
		
</dd>
</dl></blockquote>
	    
</li>
<li>Pass the wholeMessage to SSH for encapsulation as
	      data in an SSH message over the identified SSH session.
	      Any necessary additional SSH-specific parameters should be
	      provided in an implementation-dependent manner.
</li>
</ol><p>
	
</p>
<a name="establish"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Establishing a Session</h3>

<p>The Secure Shell Transport Model provides the following abstract
        service interface (ASI) to describe the data passed between the
        SSH Transport Model and the SSH service. It is an implementation decision
        how such data is passed.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
statusInformation =
openSession(
IN   tmStateReference       -- transport information to be used
OUT  tmStateReference       -- transport information to be used
IN   maxMessageSize           -- of the sending SNMP entity
 )

</pre></div>
<p>The following describes the procedure to follow to establish a
        session between a client and server to run SNMP over SSH. This process
        is used by any SNMP engine establishing a session for subsequent
        use.
</p>
<p>This will be done automatically for an SNMP application that
        initiates a transaction, such as a Command Generator or a Notification
        Originator or a Proxy Forwarder.
</p>
<p></p>
<ol class="text">
<li>Increment the snmpSshtmSessionOpens counter.
</li>
<li> Using tmTransportAddress, the client will establish an SSH
        transport connection using the SSH transport protocol,
        authenticate the server, and exchange keys for message
        integrity and encryption. The transportAddress associated with
        a session MUST remain constant during the lifetime of the SSH
        session.  Implementations may need to cache the
        transportAddress passed to the openSession API for later use
        when performing incoming message processing (see section <a class='info' href='#incomingeop'>Section&nbsp;5.1<span> (</span><span class='info'>Procedures for an Incoming Message</span><span>)</span></a>).
        
<ol class="text">
<li>To authenticate the server, the client usually stores
	    (tmTransportAddress, server host public key) pairs in an
	    implementation-dependent manner.
</li>
<li>The other parameters of the transport
        connection are provided in an implementation-dependent manner.
</li>
<li>If the attempt to establish a connection is unsuccessful, or server
        authentication fails, then snmpSshtmSessionOpenErrors is incremented,
        an openSession error indication is returned, and openSession
        processing stops.
</li>
</ol>     
        
</li>
<li>
        The client will then invoke an SSH authentication service to
        authenticate the principal, such as that described in the SSH
        authentication protocol <a class='info' href='#RFC4252'>[RFC4252]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Authentication Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>. 
        
<ol class="text">
<li>If the tmTransportAddress field contains a user-name followed by 
        an '@' character (US-ASCII 0x40), that user-name 
        string should be presented to the ssh server as the "user name" for user
        authentication purposes. If there is no user-name in the
        tmTransportAddress then the tmSecurityName should be used
        as the user-name.
</li>
<li>The credentials used to authenticate the SSH principal are determined in an
        implementation-dependent manner.
</li>
<li>In an implementation-specific manner, invoke the SSH user authentication 
        service using the calculated user-name. 
</li>
<li>If the user authentication is unsuccessful, then the transport
        connection is closed,  the snmpSshtmSessionUserAuthFailures counter 
        is incremented, an error indication is returned to the calling module, 
        and processing stops for this message.
</li>
</ol>
        
</li>
<li>The client should invoke the "ssh-connection" service (also
        known as the SSH connection protocol <a class='info' href='#RFC4254'>[RFC4254]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Connection Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>), and request a channel of type "session". If unsuccessful, the
        transport connection is closed, the snmpSshtmSessionNoChannels
        counter is incremented, an error indication is returned to the
        calling module, and processing stops for this message.
</li>
<li>The client invokes "snmp" as an SSH subsystem, as indicated in the
        "subsystem" parameter.  If unsuccessful, the transport
        connection is closed, the snmpSshtmSessionNoSubsystems
        counter is incremented, an error indication is returned to the
        calling module, and processing stops for this message.
	      <br />
<br />

        In order to allow SNMP traffic to be easily identified and filtered
        by firewalls and other network devices, servers associated with SNMP
        entities using the Secure Shell Transport Model MUST default to
        providing access to the "snmp" SSH subsystem if the SSH session is
        established using the IANA-assigned TCP ports (YYY and ZZZ). Servers SHOULD be
        configurable to allow access to the SNMP SSH subsystem over other
        ports.
</li>
<li>Set tmSessionID in the tmStateReference cache to an 
        implementation-dependent value to identify the session. 
</li>
<li>The tmSecurityName used to establish the SSH session must
	    be the only tmSecurityName used with the session.
	    Incoming messages for the session MUST be associated with
	    this tmSecurityName value.  How this is accomplished is
	    implementation-dependent.
</li>
</ol>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Closing a Session</h3>

<p>The Secure Shell Transport Model provides the following ASI to
        close a session:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
statusInformation =
closeSession(
IN   tmSessionID     -- transport address to be used
)


</pre></div>
<p>The following describes the procedure to follow to close a session
        between a client and server . This process is followed by any SNMP
        engine to close an SSH session. It is implementation-dependent
        when a session should be closed. The calling code should release
        the associated tmStateReference.
</p>
<p></p>
<ol class="text">
<li>Increment the snmpSshtmSessionCloses counter.
</li>
<li>If there is no session corresponding to tmSessionID, then 
            closeSession processing is completed.
</li>
<li>Have SSH close the session associated with tmSessionID. 
            
</li>
</ol>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
MIB Module Overview</h3>

<p>This MIB module provides management of the Secure Shell Transport
	Model. It defines an OID to identify the SNMP-over-SSH transport
	domain, a textual convention for SSH Addresses and several statistics
	counters.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Structure of the MIB Module</h3>

<p>Objects in this MIB module are arranged into subtrees. Each subtree
        is organized as a set of related objects. The overall structure and
        assignment of objects to their subtrees, and the intended purpose of
        each subtree, is shown below.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Textual Conventions</h3>

<p>Generic and Common Textual Conventions used in this document can be
        found summarized at http://www.ops.ietf.org/mib-common-tcs.html
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Relationship to Other MIB Modules</h3>

<p>Some management objects defined in other MIB modules are
        applicable to an entity implementing the SSH Transport
        Model. In particular, it is assumed that an entity
        implementing the SNMP-SSH-TM-MIB will implement the SNMPv2-MIB <a class='info' href='#RFC3418'>[RFC3418]<span> (</span><span class='info'>Presuhn, R., &ldquo;Management Information Base (MIB) for the Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>, and the SNMP-FRAMEWORK-MIB <a class='info' href='#RFC3411'>[RFC3411]<span> (</span><span class='info'>Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks,&rdquo; December&nbsp;2002.</span><span>)</span></a>.  It is expected that an entity
        implementing this MIB will also support the Transport Security
        Model <a class='info' href='#I-D.ietf-isms-transport-security-model'>[I&#8209;D.ietf&#8209;isms&#8209;transport&#8209;security&#8209;model]<span> (</span><span class='info'>Harrington, D. and W. Hardaker, &ldquo;Transport Security Model for SNMP,&rdquo; May&nbsp;2009.</span><span>)</span></a>, and therefore implement the SNMP-TSM-MIB.
</p>
<p>This MIB module is for monitoring SSH Transport Model information.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3.1"></a><h3>6.3.1.&nbsp;
MIB Modules Required for IMPORTS</h3>

<p>The following MIB module imports items from <a class='info' href='#RFC2578'>[RFC2578]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Structure of Management Information Version 2 (SMIv2),&rdquo; April&nbsp;1999.</span><span>)</span></a>, <a class='info' href='#RFC2579'>[RFC2579]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Textual Conventions for SMIv2,&rdquo; April&nbsp;1999.</span><span>)</span></a>, <a class='info' href='#RFC2580'>[RFC2580]<span> (</span><span class='info'>McCloghrie, K., Perkins, D., and J. Schoenwaelder, &ldquo;Conformance Statements for SMIv2,&rdquo; April&nbsp;1999.</span><span>)</span></a>.
</p>
<p>This MIB module also references <a class='info' href='#RFC1033'>[RFC1033]<span> (</span><span class='info'>Lottor, M., &ldquo;Domain administrators operations guide,&rdquo; November&nbsp;1987.</span><span>)</span></a>, <a class='info' href='#RFC4252'>,<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Authentication Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a> [RFC4252]<a class='info' href='#RFC3490'>[RFC3490]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a>
          and <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>
</p>
<p>This document uses TDomain textual conventions for the SNMP-internal MIB modules defined here for compatibility with the RFC3413 MIB modules and the RFC3411 Abstract Service Interfaces.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
MIB Module Definition</h3>

<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SNMP-SSH-TM-MIB DEFINITIONS ::= BEGIN

IMPORTS
    MODULE-IDENTITY, OBJECT-TYPE,
    OBJECT-IDENTITY, mib-2, snmpDomains,
    Counter32
      FROM SNMPv2-SMI -- RFC 2578
    TEXTUAL-CONVENTION
      FROM SNMPv2-TC -- RFC 2579
    MODULE-COMPLIANCE, OBJECT-GROUP
      FROM SNMPv2-CONF -- RFC 2580
    ;

snmpSshtmMIB MODULE-IDENTITY
    LAST-UPDATED "200903090000Z"
    ORGANIZATION "ISMS Working Group"
    CONTACT-INFO "WG-EMail:   isms@lists.ietf.org
                  Subscribe:  isms-request@lists.ietf.org

                  Chairs:
                    Juergen Quittek
                    NEC Europe Ltd.
                    Network Laboratories
                    Kurfuersten-Anlage 36
                    69115 Heidelberg
                    Germany
                    +49 6221 90511-15
                     quittek@netlab.nec.de

                     Juergen Schoenwaelder
                     Jacobs University Bremen
                     Campus Ring 1
                     28725 Bremen
                     Germany
                     +49 421 200-3587
                     j.schoenwaelder@iu-bremen.de

                  Co-editors:
                     David Harrington
                     Huawei Technologies USA
                     1700 Alma Drive
                     Plano Texas 75075
                     USA
                     +1 603-436-8634
                     ietfdbh@comcast.net

                     Joseph Salowey
                     Cisco Systems
                     2901 3rd Ave
                     Seattle, WA 98121
                     USA
                     jsalowey@cisco.com

	             Wes Hardaker
	             Sparta, Inc.
	             P.O. Box 382
	             Davis, CA  95617
	             USA
	             +1 530 792 1913
	             ietf@hardakers.net
                 "
    DESCRIPTION  "The Secure Shell Transport Model MIB

   Copyright (c) 2009 IETF Trust and the persons identified as
    authors of the MIB module. All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions
    are met:
    - Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
    - Redistributions in binary form must reproduce the above
      copyright notice, this list of conditions and the following
      disclaimer in the documentation and/or other materials provided
      with the distribution.
    - Neither the name of Internet Society, IETF or IETF Trust, nor the
      names of specific contributors, may be used to endorse or promote
      products derived from this software without specific prior written
      permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND
    CONTRIBUTORS 'AS IS' AND ANY EXPRESS OR IMPLIED WARRANTIES,
    INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
    MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
    DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
    CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
    USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
    AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
    LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
    ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
    POSSIBILITY OF SUCH DAMAGE.

    This version of this MIB module is part of RFC XXXX;
    see the RFC itself for full legal notices.
-- NOTE to RFC editor: replace XXXX with actual RFC number
--                     for this document and remove this note
                 "

    REVISION     "200903090000Z"
    DESCRIPTION  "The initial version, published in RFC XXXX.
-- NOTE to RFC editor: replace XXXX with actual RFC number
--                     for this document and remove this note
                 "

    ::= { mib-2 xxxx }
-- RFC Ed.: replace xxxx with IANA-assigned number and
--          remove this note

-- ---------------------------------------------------------- --
-- subtrees in the SNMP-SSH-TM-MIB
-- ---------------------------------------------------------- --

snmpSshtmNotifications    OBJECT IDENTIFIER ::= { snmpSshtmMIB 0 }
snmpSshtmObjects          OBJECT IDENTIFIER ::= { snmpSshtmMIB 1 }
snmpSshtmConformance      OBJECT IDENTIFIER ::= { snmpSshtmMIB 2 }

-- -------------------------------------------------------------
-- Objects
-- -------------------------------------------------------------

snmpSSHDomain OBJECT-IDENTITY
    STATUS      current
    DESCRIPTION
        "The SNMP over SSH transport domain. The corresponding
         transport address is of type SnmpSSHAddress.

         When an SNMP entity uses the snmpSSHDomain transport
         model, it must be capable of accepting messages up to
         and including 8192 octets in size. Implementation of
         larger values is encouraged whenever possible.

         The securityName prefix to be associated with the
         snmpSSHDomain is 'ssh'. This prefix may be used by security
         models or other components to identify which secure transport
         infrastructure authenticated a securityName."
    ::= { snmpDomains yy }

-- RFC Ed.: Please replace the I-D reference with a proper one once it
-- has been published.

-- RFC Ed.: replace yy with IANA-assigned number and
--          remove this note

-- RFC Ed.: replace 'ssh' with the actual IANA assigned prefix string
--          if 'ssh' is not assigned to this document.

SnmpSSHAddress ::= TEXTUAL-CONVENTION
    DISPLAY-HINT "1a"
    STATUS      current
    DESCRIPTION
        "Represents either a hostname or IP address, along with a port
         number and an optional user name.

         The beginning of the address specification may contain a
         user name followed by an '@' (US-ASCII character 0x40). This
         portion of the address will indicate the user name that should
         be used when authenticating to an SSH server. The user name
         must be encoded in UTF-8 (per RFC4252). If missing, the
         SNMP securityName should be used. After the optional user name
         field and '@' character comes the hostname or IP address.

         The hostname is always in US-ASCII (as per 1033),
         Internationalized hostnames are encoded in US-ASCII as
         specified in RFC 3490. The hostname is followed by a colon
         ':' (US-ASCII character 0x3A) and a decimal port number in
         US-ASCII. The name SHOULD be fully qualified whenever
         possible.

         An IPv4 address must be in dotted decimal format followed
         by a colon ':' (US-ASCII character 0x3A) and a decimal port
         number in US-ASCII.

         An IPv6 address must be in colon separated format, surrounded
         by square brackets ('[' US-ASCII character 0x5B and ']'
         US-ASCII character 0x5D), followed by a colon ':' (US-ASCII
         character 0x3A) and a decimal port number in US-ASCII.

         Values of this textual convention might not be directly useable
         as transport-layer addressing information, and may require
         runtime resolution. As such, applications that write them
         must be prepared for handling errors if such values are
         not supported, or cannot be resolved (if resolution occurs
         at the time of the management operation).

         The DESCRIPTION clause of TransportAddress objects that may
         have snmpSSHAddress values must fully describe how (and
         when) such names are to be resolved to IP addresses and vice
         versa.

         This textual convention SHOULD NOT be used directly in
         object definitions since it restricts addresses to a
         specific format. However, if it is used, it MAY be used
         either on its own or in conjunction with
         TransportAddressType or TransportDomain as a pair.

         When this textual convention is used as a syntax of an
         index object, there may be issues with the limit of 128
         sub-identifiers specified in SMIv2, STD 58. It is
         RECOMMENDED that all MIB documents using this textual
         convention make explicit any limitations on index
         component lengths that management software must observe.
         This may be done either by including SIZE constraints on
         the index components or by specifying applicable
         constraints in the conceptual row DESCRIPTION clause or
         in the surrounding documentation.
"
    REFERENCE
      "RFC 1033: DOMAIN ADMINISTRATORS OPERATIONS GUIDE
       RFC 3490: Internationalizing Domain Names in Applications
       RFC 3986: Uniform Resource Identifier (URI): Generic Syntax
       RFC 4252: The Secure Shell (SSH) Authentication Protocol"
    SYNTAX      OCTET STRING (SIZE (1..255))


-- The snmpSshtmSession Group

snmpSshtmSession       OBJECT IDENTIFIER ::= { snmpSshtmObjects 1 }

snmpSshtmSessionOpens  OBJECT-TYPE
    SYNTAX       Counter32
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The number of times an openSession() request has been
                 executed as an SSH client, whether it succeeded or
                 failed.
                "
    ::= { snmpSshtmSession 1 }

snmpSshtmSessionCloses  OBJECT-TYPE
    SYNTAX       Counter32
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The number of times a closeSession() request has been
                 executed as an SSH client, whether it succeeded or
                 failed.
                "
    ::= { snmpSshtmSession 2 }

snmpSshtmSessionOpenErrors  OBJECT-TYPE
    SYNTAX       Counter32
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The number of times an openSession() request
                 failed to open a transport connection, or failed to
                 authenticate the server.
                "
    ::= { snmpSshtmSession 3 }

snmpSshtmSessionUserAuthFailures  OBJECT-TYPE
    SYNTAX       Counter32
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The number of times an openSession() request
                 failed to open a session as a SSH client due to user
                 authentication failures.
                "
    ::= { snmpSshtmSession 4 }

snmpSshtmSessionNoChannels  OBJECT-TYPE
    SYNTAX       Counter32
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The number of times an openSession() request
                 failed to open a session as a SSH client due to
                 channel open failures.
                "
    ::= { snmpSshtmSession 5 }

snmpSshtmSessionNoSubsystems OBJECT-TYPE
    SYNTAX       Counter32
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The number of times an openSession() request
                 failed to open a session as a SSH client due to
                 inability to connect to the requested subsystem.
                "
    ::= { snmpSshtmSession 6 }

snmpSshtmSessionNoSessions  OBJECT-TYPE
    SYNTAX       Counter32
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The number of times an outgoing message
                 was dropped because the same
                 session was no longer available.
                "
    ::= { snmpSshtmSession 7 }

snmpSshtmSessionInvalidCaches OBJECT-TYPE
    SYNTAX       Counter32
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION "The number of outgoing messages dropped because the
                 tmStateReference referred to an invalid cache.
                "
    ::= { snmpSshtmSession 8 }

-- ************************************************
-- snmpSshtmMIB - Conformance Information
-- ************************************************

snmpSshtmCompliances OBJECT IDENTIFIER ::= { snmpSshtmConformance 1 }

snmpSshtmGroups      OBJECT IDENTIFIER ::= { snmpSshtmConformance 2 }

-- ************************************************
-- Compliance statements
-- ************************************************

snmpSshtmCompliance MODULE-COMPLIANCE
    STATUS      current

    DESCRIPTION "The compliance statement for SNMP engines that
                 support the SNMP-SSH-TM-MIB"
    MODULE
        MANDATORY-GROUPS { snmpSshtmGroup }
    ::= { snmpSshtmCompliances 1 }

-- ************************************************
-- Units of conformance
-- ************************************************
snmpSshtmGroup OBJECT-GROUP
    OBJECTS {
      snmpSshtmSessionOpens,
      snmpSshtmSessionCloses,
      snmpSshtmSessionOpenErrors,
      snmpSshtmSessionUserAuthFailures,
      snmpSshtmSessionNoChannels,
      snmpSshtmSessionNoSubsystems,
      snmpSshtmSessionNoSessions,
      snmpSshtmSessionInvalidCaches
    }
    STATUS      current
    DESCRIPTION "A collection of objects for maintaining
                 information of an SNMP engine which implements the
                 SNMP Secure Shell Transport Model.
                "


    ::= { snmpSshtmGroups 2 }


END

</pre></div>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Operational Considerations</h3>

<p>The SSH Transport Model will likely not work in conditions where
      remote access to the CLI has stopped working. Remote access to a CLI is often
      over TCP, which is also used by SSH. In situations where SNMP access
      has to work when the CLI has stopped working, a UDP transport model
      should be considered instead of the SSH Transport Model.
</p>
<p>To have SNMP properly utilize the security services 
      provided by SSH, the SSH Transport Model MUST be used
      with a Security Model that knows how to process a tmStateReference,
      such as the Transport Security Model for SNMP <a class='info' href='#I-D.ietf-isms-transport-security-model'>[I&#8209;D.ietf&#8209;isms&#8209;transport&#8209;security&#8209;model]<span> (</span><span class='info'>Harrington, D. and W. Hardaker, &ldquo;Transport Security Model for SNMP,&rdquo; May&nbsp;2009.</span><span>)</span></a>.
</p>
<p>If the SSH Transport Model is configured to utilize AAA services,
      operators should consider configuring support for local authentication
      mechanisms, such as local passwords, so SNMP can continue operating
      during times of network stress.
</p>
<p>The SSH protocol has its own window mechanism, defined in RFC
	4254. The SSH specifications leave it open when window adjustments
	messages should be created, and some implementations send
	these whenever received data has been passed to the
	application.  There are noticeable bandwidth and processing
	overheads to handling such window adjustment messages, which
	can be avoided by sending them less frequently.
</p>
<p>The SSH protocol requires the execution of CPU intensive calculations
      to establish a session key during session establishment. This means that
      short lived sessions become computationally expensive compared to USM,
      which does not have a notion of a session key. Other transport security
      protocols such as TLS support a session resumption feature that allows
      reusing a cached session key. Such a mechanism does not exist for SSH
      and thus SNMP applications should keep SSH sessions for longer time
      periods.
</p>
<p>To initiate SSH connections, an entity must be configured with 
      SSH client credentials plus information to authenticate the server. While 
      hosts are often configured to be SSH clients, most internetworking devices 
      are not. To send notifications over SSHTM,
      the internetworking device will need to be configured as an SSH client.
      How this credential configuration is done is implementation and deployment specific.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>This document describes a transport model that permits SNMP to
      utilize SSH security services. The security threats and how the SSH
      Transport Model mitigates those threats is covered in detail throughout
      this memo.
</p>
<p>The SSH Transport Model relies on SSH mutual authentication, binding
      of keys, confidentiality and integrity. Any authentication method that
      meets the requirements of the SSH architecture will provide the
      properties of mutual authentication and binding of keys. 
</p>
<p>SSHv2 provides Perfect Forward Security (PFS) for encryption keys.
      PFS is a major design goal of SSH, and any well-designed keyex algorithm
      will provide it.
</p>
<p>The security implications of using SSH are covered in <a class='info' href='#RFC4251'>[RFC4251]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Protocol Architecture,&rdquo; January&nbsp;2006.</span><span>)</span></a>.
</p>
<p>The SSH Transport Model has no way to verify that server
      authentication was performed, to learn the host's public key in advance,
      or verify that the correct key is being used. The SSH Transport Model
      simply trusts that these are properly configured by the implementer and
      deployer.
</p>
<p>SSH provides the "none" userauth method. The SSH
        Transport Model MUST NOT be used with an SSH connection with the
        "none" userauth method. While SSH does
      support turning off confidentiality and integrity, they MUST NOT be
      turned off when used with the SSH Transport Model.
</p>
<p>The SSH protocol is not always clear on whether the user name field 
must be filled in, so for some implementations, such as those using
GSSAPI authentication, it may be necessary to use a mapping algorithm
to transform an SSH identity to a tmSecurityName, or to transform a tmSecurityName to an SSH identity. 
</p>
<p>In other cases the user name may not be verified by the server, 
      so for these implementations, it may be necessary to obtain the 
      user name from other credentials exchanged during the SSH
exchange.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Skipping Public Key Verification</h3>

<p>Most key exchange algorithms are able to authenticate the SSH
        server's identity to the client. However, for the common case of DH
        signed by public keys, this requires the client to know the host's
        public key a priori and to verify that the correct key is being used.
        If this step is skipped, then authentication of the SSH server to the
        SSH client is not done. Data confidentiality and data integrity
        protection to the server still exist, but these are of dubious value
        when an attacker can insert himself between the client and the real
        SSH server. Note that some userauth methods may defend against this
        situation, but many of the common ones (including password and
        keyboard-interactive) do not, and in fact depend on the fact that the
        server's identity has been verified (so passwords are not disclosed to
        an attacker).
</p>
<p>SSH MUST NOT be configured to skip public key verification for use
        with the SSH Transport Model.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
Notification Authorizaton Considerations</h3>

<p>SNMP Notifications are authorized to be sent to a receiver
	  based on the securityName used by the notification
	  originator's SNMP engine.  This authorization is performed
	  before the message is actually sent and before the
	  credentials of the remote receiver have been verified.  It
	  is thus critical that the credentials presented by a
	  notification receiver MUST match the expected value(s) for a
	  given transport address and that ownership of the
	  credentials MUST be properly cryptographically verified.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
SSH User and Key Selection</h3>

<p>If a "user@" prefix is used within a SnmpSSHAddress value
	  to specify a SSH user name to use for authentication
	  then the key presented to the remote entity MUST be the key
	  expected by the server for the "user".  This may be 
	  different than a locally cached key identified by the
	  securityName value.
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.4"></a><h3>9.4.&nbsp;
Conceptual Differences Between USM and SSHTM</h3>

<p>The User Based Security Model <a class='info' href='#RFC3414'>[RFC3414]<span> (</span><span class='info'>Blumenthal, U. and B. Wijnen, &ldquo;User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3),&rdquo; December&nbsp;2002.</span><span>)</span></a>
        employed symmetric cryptography and user naming conventions.
        SSH employs an asymmetric cryptographic and naming model.
        Unlike USM, cryptographic keys will be different on both sides
        of the SSH connection.  Both sides are responsible for
        verifying that the remote entity presents the right key.  The
        optional "user@" prefix component of the SnmpSSHAddress
        Textual Convention allows the client SNMP stack to associate
        the connection with a securityName that may be different than
        the SSH user name presented to the SSH server.
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.5"></a><h3>9.5.&nbsp;
The 'none' MAC Algorithm</h3>

<p>SSH provides the "none" MAC algorithm, which would allow you to
        turn off data integrity while maintaining confidentiality. However, if
        you do this, then an attacker may be able to modify the data in
        flight, which means you effectively have no authentication.
</p>
<p>SSH MUST NOT be configured using the "none" MAC algorithm for use
        with the SSH Transport Model.
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.6"></a><h3>9.6.&nbsp;
Use with SNMPv1/v2c Messages</h3>

<p>The SNMPv1 and SNMPv2c message processing described in RFC3584 (BCP
        74) <a class='info' href='#RFC3584'>[RFC3584]<span> (</span><span class='info'>Frye, R., Levi, D., Routhier, S., and B. Wijnen, &ldquo;Coexistence between Version 1, Version 2, and Version 3 of the Internet-standard Network Management Framework,&rdquo; August&nbsp;2003.</span><span>)</span></a> always select the SNMPv1 or SNMPv2c Security Models respectively.
   Both of these, and the User-based Security Model typically used with
   SNMPv3, derive the securityName and securityLevel from the SNMP
   message received, even when the message was received over a secure
   transport.  Access control decisions are therefore made based on the
   contents of the SNMP message, rather than using the authenticated
   identity and securityLevel provided by the SSH Transport Model.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.7"></a><h3>9.7.&nbsp;
MIB Module Security</h3>

<p>There are no management objects defined in this MIB module that
        have a MAX-ACCESS clause of read-write and/or read-create. So, if this
        MIB module is implemented correctly, then there is no risk that an
        intruder can alter or create any management objects of this MIB module
        via direct SNMP SET operations.
</p>
<p>Some of the readable objects in this MIB module (i.e., objects with
        a MAX-ACCESS other than not-accessible) may be considered sensitive or
        vulnerable in some network environments. It is thus important to
        control even GET and/or NOTIFY access to these objects and possibly to
        even encrypt the values of these objects when sending them over the
        network via SNMP. These are the tables and objects and their
        sensitivity/vulnerability: </p>
<ul class="text">
<li>The readable objects in this MIB module are not sensitive.
</li>
</ul>

<p>SNMP versions prior to SNMPv3 did not include adequate security.
        Even if the network itself is secure (for example by using IPSec or
        SSH), even then, there is no control as to who on the secure network
        is allowed to access and GET/SET (read/change/create/delete) the
        objects in this MIB module.
</p>
<p>It is RECOMMENDED that implementers consider the security features
        as provided by the SNMPv3 framework (see <a class='info' href='#RFC3410'>[RFC3410]<span> (</span><span class='info'>Case, J., Mundy, R., Partain, D., and B. Stewart, &ldquo;Introduction and Applicability Statements for Internet-Standard Management Framework,&rdquo; December&nbsp;2002.</span><span>)</span></a> section 8), including full support for the
        USM and the SSH Transport Model cryptographic mechanisms (for
        authentication and privacy).
</p>
<p>Further, deployment of SNMP versions prior to SNMPv3 is NOT
        RECOMMENDED. Instead, it is RECOMMENDED to deploy SNMPv3 and to enable
        cryptographic security. It is then a customer/operator responsibility
        to ensure that the SNMP entity giving access to an instance of this
        MIB module is properly configured to give access to the objects only
        to those principals (users) that have legitimate rights to indeed GET
        or SET (change/create/delete) them.
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>IANA is requested to assign: </p>
<ol class="text">
<li>two TCP registered port numbers in the 
          http://www.iana.org/assignments/port-numbers registry which will be
          the default ports for SNMP over an SSH Transport Model as defined in
          this document, and SNMP over an SSH Transport Model for 
          notifications as defined in this document. It would be good if the
          assigned keywords were "snmpssh" and "snmpssh-trap" and the port numbers were x161 and x162.
</li>
<li>an SMI number under mib-2, for the MIB module in this
          document,
</li>
<li>an SMI number under snmpDomains, for the snmpSSHDomain,
</li>
<li>"ssh" as the corresponding prefix for the snmpSSHDomain in the SNMP Transport Model registry; defined in <a class='info' href='#I-D.ietf-isms-tmsm'>[I&#8209;D.ietf&#8209;isms&#8209;tmsm]<span> (</span><span class='info'>Harrington, D. and J. Schoenwaelder, &ldquo;Transport Subsystem for the Simple Network Management Protocol (SNMP),&rdquo; May&nbsp;2009.</span><span>)</span></a>
</li>
<li>"snmp" as an SSH Subsystem Name in the
          http://www.iana.org/assignments/ssh-parameters registry.
</li>
</ol>

<p>-- note to RFC editor
-- Please replace YYY and ZZZ in this document with the assigned port numbers and remove this note.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgements</h3>

<p>The editors would like to thank Jeffrey Hutzelman for sharing his SSH
      insights, and Dave Shield for an outstanding job wordsmithing the existing document to improve organization and clarity.
</p>
<p>Additionally, helpful document reviews were received from: Juergen
      Schoenwaelder.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1033">[RFC1033]</a></td>
<td class="author-text">Lottor, M., &ldquo;<a href="http://tools.ietf.org/html/rfc1033">Domain administrators operations guide</a>,&rdquo; RFC&nbsp;1033, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2578">[RFC2578]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K., Ed.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D., Ed.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder, Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2578">Structure of Management Information Version 2 (SMIv2)</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2578, April&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2578.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2579">[RFC2579]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K., Ed.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D., Ed.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder, Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2579">Textual Conventions for SMIv2</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2579, April&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2579.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2580">[RFC2580]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2580">Conformance Statements for SMIv2</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2580, April&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2580.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3411">[RFC3411]</a></td>
<td class="author-text">Harrington, D., Presuhn, R., and B. Wijnen, &ldquo;<a href="http://tools.ietf.org/html/rfc3411">An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3411, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3411.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3413">[RFC3413]</a></td>
<td class="author-text">Levi, D., Meyer, P., and B. Stewart, &ldquo;<a href="http://tools.ietf.org/html/rfc3413">Simple Network Management Protocol (SNMP) Applications</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3413, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3413.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3414">[RFC3414]</a></td>
<td class="author-text">Blumenthal, U. and B. Wijnen, &ldquo;<a href="http://tools.ietf.org/html/rfc3414">User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3)</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3414, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3414.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3418">[RFC3418]</a></td>
<td class="author-text">Presuhn, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3418">Management Information Base (MIB) for the Simple Network Management Protocol (SNMP)</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3418, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3418.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3490">[RFC3490]</a></td>
<td class="author-text">Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;<a href="http://tools.ietf.org/html/rfc3490">Internationalizing Domain Names in Applications (IDNA)</a>,&rdquo; RFC&nbsp;3490, March&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3490.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3584">[RFC3584]</a></td>
<td class="author-text">Frye, R., Levi, D., Routhier, S., and B. Wijnen, &ldquo;<a href="http://tools.ietf.org/html/rfc3584">Coexistence between Version 1, Version 2, and Version 3 of the Internet-standard Network Management Framework</a>,&rdquo; BCP&nbsp;74, RFC&nbsp;3584, August&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3584.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4251">[RFC4251]</a></td>
<td class="author-text">Ylonen, T. and C. Lonvick, &ldquo;<a href="http://tools.ietf.org/html/rfc4251">The Secure Shell (SSH) Protocol Architecture</a>,&rdquo; RFC&nbsp;4251, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4251.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4252">[RFC4252]</a></td>
<td class="author-text">Ylonen, T. and C. Lonvick, &ldquo;<a href="http://tools.ietf.org/html/rfc4252">The Secure Shell (SSH) Authentication Protocol</a>,&rdquo; RFC&nbsp;4252, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4252.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4253">[RFC4253]</a></td>
<td class="author-text">Ylonen, T. and C. Lonvick, &ldquo;<a href="http://tools.ietf.org/html/rfc4253">The Secure Shell (SSH) Transport Layer Protocol</a>,&rdquo; RFC&nbsp;4253, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4253.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4254">[RFC4254]</a></td>
<td class="author-text">Ylonen, T. and C. Lonvick, &ldquo;<a href="http://tools.ietf.org/html/rfc4254">The Secure Shell (SSH) Connection Protocol</a>,&rdquo; RFC&nbsp;4254, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4254.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-isms-tmsm">[I-D.ietf-isms-tmsm]</a></td>
<td class="author-text">Harrington, D. and J. Schoenwaelder, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-isms-tmsm-18.txt">Transport Subsystem for the Simple Network Management Protocol (SNMP)</a>,&rdquo; draft-ietf-isms-tmsm-18 (work in progress), May&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-isms-tmsm-18.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1994">[RFC1994]</a></td>
<td class="author-text"><a href="mailto:wsimpson@GreenDragon.com">Simpson, W.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1994">PPP Challenge Handshake Authentication Protocol (CHAP)</a>,&rdquo; RFC&nbsp;1994, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1994.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2865">[RFC2865]</a></td>
<td class="author-text">Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;2865, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2865.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3410">[RFC3410]</a></td>
<td class="author-text">Case, J., Mundy, R., Partain, D., and B. Stewart, &ldquo;<a href="http://tools.ietf.org/html/rfc3410">Introduction and Applicability Statements for Internet-Standard Management Framework</a>,&rdquo; RFC&nbsp;3410, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3410.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3588">[RFC3588]</a></td>
<td class="author-text">Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3588">Diameter Base Protocol</a>,&rdquo; RFC&nbsp;3588, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3588.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3986">[RFC3986]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4256">[RFC4256]</a></td>
<td class="author-text">Cusack, F. and M. Forssen, &ldquo;<a href="http://tools.ietf.org/html/rfc4256">Generic Message Exchange Authentication for the Secure Shell Protocol (SSH)</a>,&rdquo; RFC&nbsp;4256, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4256.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4462">[RFC4462]</a></td>
<td class="author-text">Hutzelman, J., Salowey, J., Galbraith, J., and V. Welch, &ldquo;<a href="http://tools.ietf.org/html/rfc4462">Generic Security Service Application Program Interface (GSS-API) Authentication and Key Exchange for the Secure Shell (SSH) Protocol</a>,&rdquo; RFC&nbsp;4462, May&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4462.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5090">[RFC5090]</a></td>
<td class="author-text">Sterman, B., Sadolevsky, D., Schwartz, D., Williams, D., and W. Beck, &ldquo;<a href="http://tools.ietf.org/html/rfc5090">RADIUS Extension for Digest Authentication</a>,&rdquo; RFC&nbsp;5090, February&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5090.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4742">[RFC4742]</a></td>
<td class="author-text">Wasserman, M. and T. Goddard, &ldquo;<a href="http://tools.ietf.org/html/rfc4742">Using the NETCONF Configuration Protocol over Secure SHell (SSH)</a>,&rdquo; RFC&nbsp;4742, December&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4742.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-isms-transport-security-model">[I-D.ietf-isms-transport-security-model]</a></td>
<td class="author-text">Harrington, D. and W. Hardaker, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-isms-transport-security-model-14.txt">Transport Security Model for SNMP</a>,&rdquo; draft-ietf-isms-transport-security-model-14 (work in progress), May&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-isms-transport-security-model-14.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David Harrington</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei Technologies (USA)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1700 Alma Dr. Suite 100</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Plano, TX 75075</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 603 436 8634</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:dharrington@huawei.com">dharrington@huawei.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Joseph Salowey</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2901 3rd Ave</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, WA 98121</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:jsalowey@cisco.com">jsalowey@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Wes Hardaker</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sparta, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P.O. Box 382</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Davis, CA  95617</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 530 792 1913</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:ietf@hardakers.net">ietf@hardakers.net</a></td></tr>
</table>
</body></html>
