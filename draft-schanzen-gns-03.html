<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The GNU Name System</title>
<meta content="Martin Schanzenbach" name="author">
<meta content="Christian Grothoff" name="author">
<meta content="Bernd Fix" name="author">
<meta content="
       This document contains the GNU Name System (GNS) technical specification. 
    " name="description">
<meta content="xml2rfc 3.7.0" name="generator">
<meta content="name systems" name="keyword">
<meta content="draft-schanzen-gns-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.7.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.4
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 56.0.0
    six 1.15.0
-->
<link href="/tmp/draft-schanzen-gns-03-qxd_8tfu.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">The GNU Name System</td>
<td class="right">April 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Schanzenbach, et al.</td>
<td class="center">Expires 19 October 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Independent Stream</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-schanzen-gns-02</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-04-17" class="published">17 April 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-10-19">19 October 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Schanzenbach</div>
<div class="org">GNUnet e.V.</div>
</div>
<div class="author">
      <div class="author-name">C. Grothoff</div>
<div class="org">Berner Fachhochschule</div>
</div>
<div class="author">
      <div class="author-name">B. Fix</div>
<div class="org">GNUnet e.V.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The GNU Name System</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document contains the GNU Name System (GNS) technical specification.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 19 October 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-zones" class="xref">Zones</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-zone-types" class="xref">Zone Types</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-resource-records" class="xref">Resource Records</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-record-types" class="xref">Record Types</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-pkey" class="xref">PKEY</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-edkey" class="xref">EDKEY</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-gns2dns" class="xref">GNS2DNS</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-leho" class="xref">LEHO</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-nick" class="xref">NICK</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-box" class="xref">BOX</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.  <a href="#name-vpn" class="xref">VPN</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-publishing-records" class="xref">Publishing Records</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-dht-key-derivations" class="xref">DHT Key Derivations</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-resource-records-block" class="xref">Resource Records Block</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-record-data-encryption-and-" class="xref">Record Data Encryption and Decryption</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-internationalization-and-ch" class="xref">Internationalization and Character Encoding</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-name-resolution" class="xref">Name Resolution</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-recursion" class="xref">Recursion</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-record-processing" class="xref">Record Processing</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="xref">8.2.1</a>.  <a href="#name-encountering-zone-delegatio" class="xref">Encountering zone delegation records</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="xref">8.2.2</a>.  <a href="#name-gns2dns-2" class="xref">GNS2DNS</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.3">
                    <p id="section-toc.1-1.8.2.2.2.3.1"><a href="#section-8.2.3" class="xref">8.2.3</a>.  <a href="#name-cname" class="xref">CNAME</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.4">
                    <p id="section-toc.1-1.8.2.2.2.4.1"><a href="#section-8.2.4" class="xref">8.2.4</a>.  <a href="#name-box-2" class="xref">BOX</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.5">
                    <p id="section-toc.1-1.8.2.2.2.5.1"><a href="#section-8.2.5" class="xref">8.2.5</a>.  <a href="#name-vpn-2" class="xref">VPN</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2.2.6">
                    <p id="section-toc.1-1.8.2.2.2.6.1"><a href="#section-8.2.6" class="xref">8.2.6</a>.  <a href="#name-nick-2" class="xref">NICK</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-zone-revocation" class="xref">Zone Revocation</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-determining-the-root-zone-a" class="xref">Determining the Root Zone and Zone Governance</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-cryptography" class="xref">Cryptography</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-abuse-mitigation" class="xref">Abuse mitigation</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="xref">11.3</a>.  <a href="#name-zone-management" class="xref">Zone management</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="xref">11.4</a>.  <a href="#name-impact-of-underlying-dht" class="xref">Impact of underlying DHT</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-11.5" class="xref">11.5</a>.  <a href="#name-revocations" class="xref">Revocations</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-gana-considerations" class="xref">GANA Considerations</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-test-vectors" class="xref">Test Vectors</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
       The Domain Name System (DNS) is a unique distributed database and a vital
       service for most Internet applications. While DNS is distributed, it
       relies on centralized, trusted registrars to provide globally unique
       names. As the awareness of the central role DNS plays on the Internet
       rises, various institutions are using their power (including legal means)
       to engage in attacks on the DNS, thus threatening the global availability
       and integrity of information on the Internet.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
       DNS was not designed with security as a goal. This makes it very
       vulnerable, especially to attackers that have the technical capabilities
       of an entire nation state at their disposal.
       This specification describes a censorship-resistant, privacy-preserving
       and decentralized name system: The GNU Name System (GNS). It is designed
       to provide a secure alternative to DNS, especially when censorship or
       manipulation is encountered. GNS can bind names to any kind of
       cryptographically secured token, enabling it to double in some respects as
       even as an alternative to some of today's Public Key Infrastructures, in
       particular X.509 for the Web.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
       This document contains the GNU Name System (GNS) technical specification
       of the GNU Name System <span>[<a href="#GNS" class="xref">GNS</a>]</span>, a fully decentralized and censorship-resistant
       name system. GNS provides a privacy-enhancing alternative to the Domain
       Name System (DNS). The design of GNS incorporates the capability to
       integrate and coexist with DNS. GNS is based on the principle of a petname
       system and builds on ideas from the Simple Distributed Security
       Infrastructure (SDSI), addressing a central issue with the decentralized
       mapping of secure identifiers to memorable names: namely the impossibility
       of providing a global, secure and memorable mapping without a trusted
       authority. GNS uses the transitivity in the SDSI design to replace the
       trusted root with secure delegation of authority thus making petnames
       useful to other users while operating under a very strong adversary model.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
       This document defines the normative wire format of resource records, resolution processes,
       cryptographic routines and security considerations for use by implementors.
       GNS requires a distributed hash table (DHT) for record storage.
       Specification of the DHT is out of scope of this document.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
       The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
       NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
       "OPTIONAL" in this document are to be interpreted as described
       in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6"></p>
</section>
</div>
<div id="zones">
<section id="section-2">
      <h2 id="name-zones">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-zones" class="section-name selfRef">Zones</a>
      </h2>
<p id="section-2-1">
       A zone in GNS is defined by a zone type "ztype" that identifies
       a cryptosystem and a public/private key pair "(d,zk)",
       where "d" is the private key and "zk" the corresponding public key
       in the public key cipher identified by the "ztype".
       The contents of a zone are cryptographically signed before
       being published a distributed hash table (DHT).
       Records are grouped by their label and encrypted (<a href="#recordencryption" class="xref">Section 6.3</a>)
       using an encryption key derived from the label and the zone public key.
       Instead of the zone private key "d", the signature MUST
       be created using a blinded public/private key pair "d'" and "zk'".
       This blinding is realized using a hierarchical deterministic key
       derivation (HDKD) scheme.
       Such a scheme allows the deterministic derivation of keys from
       the original public and private zone keys using "label" values.
       Specifically, the zone owner can derive private keys "d'", and a
       resolver to derive the corresponding public keys "zk'".  Using
       different "label" values in the derivation results in different
       keys.  Without knowledge of the "label" values, the different
       derivations are unlinkable both to the original key and to each
       other.
       This prevents zone enumeration and requires knowledge
       of both "zk" and the "label" to confirm affiliation with a
       specific zone. At the same time, the blinded "zk'" provides nodes
       with the ability to verifiy the integrity of the published information
       without disclosing the originating zone.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
       The following variables are associated with a zone in GNS:<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">ztype</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">
         is the unique type of the zone type as registered in the
         GNUnet Assigned Numbers Authority <span>[<a href="#GANA" class="xref">GANA</a>]</span>.
         The zone type determines which cryptosystem is used for the
         asymmetric and symmetric key operations of the zone. A 32-bit number.<a href="#section-2-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">d</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.4">
         is the private zone key. The specific format depends on the zone type.<a href="#section-2-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">zk</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.6">
         is the public zone key. The specific format depends on the zone type.<a href="#section-2-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">zid</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.8">
         is the unique public identifier of a zone. It consists of the "ztype"
         and the public zone key "zk".<a href="#section-2-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">zTLD</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.10">
         is a string which encodes the "ztype" as well as the zone
         key "zk" into a domain name. The "zTLD" is used as a
         globally unique reference to a specific namespace in the
         process of name resolution.<a href="#section-2-3.10" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-4">
       The "zid" wire format is defined as follows:<a href="#section-2-4" class="pilcrow">¶</a></p>
<div id="figure_zid">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-2-5.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|       ZONE TYPE       |      PUBLIC ZONE KEY  /
+-----+-----+-----+-----+                       /
/                                               /
/                                               /
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a></figcaption></figure>
</div>
<p id="section-2-6">
       For the string representation of the "zid", we use a base-32 encoding
       "StringEncode".
       However, instead of following <span>[<a href="#RFC4648" class="xref">RFC4648</a>]</span> we base
       our character map on the optical character recognition friendly
       proposal of Crockford <span>[<a href="#CrockfordB32" class="xref">CrockfordB32</a>]</span>.
       The only difference to Crockford is that the letter
       "U" decodes to the same base-32 value as the letter "V" (27).<a href="#section-2-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2-7">
<pre>
zkl := &lt;StringEncode(zid)&gt;
</pre><a href="#section-2-7" class="pilcrow">¶</a>
</div>
<p id="section-2-8">
       If "zkl" is less than 63 characters, it is also the "zTLD".
       If the resulting "zkl" should be longer than 63 characters, the
       string must be divided into smaller labels separated by the label
       separator ".".  Here, the most significant bytes of the "zid" must be contained
       in the rightmost label of the resulting string and the least significant
       bytes in the leftmost label of the resulting string. For example,
       assuming a "zkl" of 130 characters, the encoding would be:<a href="#section-2-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2-9">
<pre>
zTLD := zkl[126:129].zkl[63:125].zkl[0:62]
</pre><a href="#section-2-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="zone_types">
<section id="section-3">
      <h2 id="name-zone-types">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-zone-types" class="section-name selfRef">Zone Types</a>
      </h2>
<p id="section-3-1">
       A zone type identifies a family of eight functions:<a href="#section-3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-2">
        <dt id="section-3-2.1">Private-KeyGen() -&gt; d</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.2">
         is a function to generate a fresh private key "d".<a href="#section-3-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.3">Public-KeyGen(d) -&gt; zk</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.4">
         is a function to derive a public key "zk" from a private key "d".<a href="#section-3-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.5">HDKD-Private(d,label) -&gt; d'</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.6">
         is an HDKD function which blinds a private zone key "d"
         using "label", resulting in another private key which
         can be used to create cryptographic signatures.<a href="#section-3-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.7">S-Encrypt(zk,label,nonce,expiration,rdata) -&gt; bdata</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.8">
         is a deterministic symmetric encryption function which encrypts the record
         data "rdata" based on key material derived from "zk", "label",
         "nonce" and "expiration".
         A deterministic encryption scheme is
         required to improve performance by leveraging caching features
         of DHTs.<a href="#section-3-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.9">Sign(d',bdata) -&gt; sig</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.10">
         is a function to sign "bdata" using the (blinded) private key
         "d'", yielding an unforgable cryptographic signature "sig".<a href="#section-3-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.11">HDKD-Public(zk,label) -&gt; zk'</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.12">
         is a HDKD function which blinds a public zone key "zk"
         using "label". "zk" and "zk'" must be unlinkable. Furthermore,
         blinding "zk" with different values for "label" must result
         in unlinkable different resulting values for "zk'".<a href="#section-3-2.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.13">Verify(zk',bdata,sig) -&gt; valid</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.14">
         is a function to verify the signature "sig" was created by
         the a private key "d'" derived from "d" and "label" if
         "zk'" was derived from the corresponding to
         "zk := Public-Keygen(d)" and "label".
         The function returns "true" if the signature is valid,
         and otherwise "false".<a href="#section-3-2.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.15">S-Decrypt(zk,label,nonce,expiration,bdata) -&gt; rdata</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.16">
         is a symmetric encryption function which decrypts the encrypted record
         data "bdata" based on key material derived from "zk", "label",
         "nonce" and "expiration".<a href="#section-3-2.16" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-3">
       Zone types are identified by a 32-bit resource record type number.
       Resource record types are discussed in the next section.<a href="#section-3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rrecords">
<section id="section-4">
      <h2 id="name-resource-records">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-resource-records" class="section-name selfRef">Resource Records</a>
      </h2>
<p id="section-4-1">
       A GNS implementor MUST provide a mechanism to create and manage resource
       records for local zones. A local zone is established by selecting a
       zone type and creating a zone
       key pair. Implementations SHOULD select a secure zone type automatically
       and not leave the zone type selection to the user.
       Records may be added to each zone, hence a (local) persistency
       mechanism for resource records and zones must be provided.
       This local zone database is used by the GNS resolver implementation
       and to publish record information.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
       A GNS resource record holds the data of a specific record in a zone.
       The resource record format is defined as follows:<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="figure_gnsrecord">
<figure id="figure-2">
        <div class="artwork art-text alignLeft" id="section-4-3.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|       DATA SIZE       |          TYPE         |
+-----+-----+-----+-----+-----+-----+-----+-----+
|           FLAGS       |        DATA           /
+-----+-----+-----+-----+                       /
/                                               /
/                                               /
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a></figcaption></figure>
</div>
<p id="section-4-4">where:<a href="#section-4-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-5">
        <dt id="section-4-5.1">EXPIRATION</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.2">
         denotes the absolute 64-bit expiration date of the record.
         In microseconds since midnight (0 hour), January 1, 1970 in network
         byte order.<a href="#section-4-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.3">DATA SIZE</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.4">
         denotes the 32-bit size of the DATA field in bytes and in network byte
         order.<a href="#section-4-5.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.5">TYPE</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.6">
         is the 32-bit resource record type. This type can be one of the GNS resource
         records as defined in <a href="#rrecords" class="xref">Section 4</a> or a DNS record
         type as defined in <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span> or any of the
         complementary standardized DNS resource record types. This value must be
         stored in network byte order. Note that values
         below 2^16 are reserved for allocation via IANA (<span>[<a href="#RFC6895" class="xref">RFC6895</a>]</span>),
         while values above 2^16 are allocated by the
         GNUnet Assigned Numbers Authority <span>[<a href="#GANA" class="xref">GANA</a>]</span>.<a href="#section-4-5.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.7">FLAGS</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.8">
         is a 32-bit resource record flags field (see below).<a href="#section-4-5.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-5.9">DATA</dt>
        <dd style="margin-left: 1.5em" id="section-4-5.10">
         the variable-length resource record data payload. The contents are defined
         by the
         respective type of the resource record.<a href="#section-4-5.10" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-6">
       Flags indicate metadata surrounding the resource record. A flag
       value of 0 indicates that all flags are unset. The following
       illustrates the flag distribution in the 32-bit flag value of a
       resource record:<a href="#section-4-6" class="pilcrow">¶</a></p>
<div id="figure_flag">
<figure id="figure-3">
        <div class="artwork art-text alignLeft" id="section-4-7.1">
<pre>
... 5       4         3        2        1        0
------+--------+--------+--------+--------+--------+
/ ... | SHADOW | EXPREL | SUPPL  | PRIVATE|    /   |
------+--------+--------+--------+--------+--------+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a></figcaption></figure>
</div>
<p id="section-4-8">
       where:<a href="#section-4-8" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4-9">
        <dt id="section-4-9.1">SHADOW</dt>
        <dd style="margin-left: 1.5em" id="section-4-9.2">
         If this flag is set, this record should be ignored by resolvers unless all (other)
         records of the same record type have expired.  Used to allow zone publishers to
         facilitate good performance when records change by allowing them to put future
         values of records into the DHT. This way, future values can propagate and may be
         cached before the transition becomes active.<a href="#section-4-9.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-9.3">EXPREL</dt>
        <dd style="margin-left: 1.5em" id="section-4-9.4">
         The expiration time value of the record is a relative time (still in microseconds)
         and not an absolute time. This flag should never be encountered by a resolver
         for records obtained from the DHT, but might be present when a resolver looks up
         private records of a zone hosted locally.<a href="#section-4-9.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-9.5">
         SUPPL
        </dt>
        <dd style="margin-left: 1.5em" id="section-4-9.6">
         This is a supplemental record. It is provided in addition to the
         other records. This flag indicates that this record is not explicitly
         managed alongside the other records under the respective name but
         may be useful for the application. This flag should only be encountered
         by a resolver for records obtained from the DHT.<a href="#section-4-9.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-9.7">PRIVATE</dt>
        <dd style="margin-left: 1.5em" id="section-4-9.8">
         This is a private record of this peer and it should thus not be
         published in the DHT.  Thus, this flag should never be encountered by
         a resolver for records obtained from the DHT.
         Private records should still be considered just like
         regular records when resolving labels in local zones.<a href="#section-4-9.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="gnsrecords_numbers">
<section id="section-5">
      <h2 id="name-record-types">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-record-types" class="section-name selfRef">Record Types</a>
      </h2>
<p id="section-5-1">
       A registry of GNS Record Types is described in <a href="#gana" class="xref">Section 12</a>.  The
       registration policy for this registry is "First Come First Served", as
       described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="gnsrecords_pkey">
<section id="section-5.1">
        <h3 id="name-pkey">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-pkey" class="section-name selfRef">PKEY</a>
        </h3>
<p id="section-5.1-1">In GNS, a delegation of a label to a zone of type "PKEY" is
         represented through a PKEY record.  The PKEY number is a zone
         type and thus also implies the cryptosystem for the zone that
         is being delegated to.
         A PKEY resource record contains the public key of the zone to
         delegate to.
         A PKEY record MUST be the only record under a label. No other
         records are allowed. A PKEY DATA entry has the following format:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="figure_pkeyrecord">
<figure id="figure-4">
          <div class="artwork art-text alignLeft" id="section-5.1-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   PUBLIC KEY                  |
|                                               |
|                                               |
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a></figcaption></figure>
</div>
<p id="section-5.1-3">
         where:<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-4">
          <dt id="section-5.1-4.1">PUBLIC KEY</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-4.2">
           A 256-bit ECDSA zone key.<a href="#section-5.1-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-5">
         For PKEY zones the zone key material is derived using the
         curve parameters of the twisted edwards representation
         of Curve25519 <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> (a.k.a. edwards25519)
         with the ECDSA scheme (<span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span>).
         Consequently , we use the following naming convention for our
         cryptographic primitives for PKEY zones:<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-6">
          <dt id="section-5.1-6.1">d</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.2">
           is a 256-bit ECDSA private zone key.<a href="#section-5.1-6.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.3">zk</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.4">
           is the ECDSA public zone key corresponding to d. It is defined in
           <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span> as the curve point d*G where G is the group
           generator of the elliptic curve. The public key is used to uniquely
           identify a GNS zone and is referred to as the "zone key".<a href="#section-5.1-6.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.5">p</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.6">
           is the prime of edwards25519 as defined in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, i.e.
           2^255 - 19.<a href="#section-5.1-6.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.7">G</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.8">
           is the group generator (X(P),Y(P)) of edwards25519 as defined in
           <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-5.1-6.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.9">L</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-6.10">
           is the prime-order subgroup of edwards25519 in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-5.1-6.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-7">
         The "zid" of a PKEY is 32 + 4 bytes in length. This means that
         a "zTLD" will always fit into a single label and does
         not need any further conversion.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">
         Given a label, the output d' of the HDKD-Private(d,label) function for zone
         key blinding is calculated as follows for PKEY zones:<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-9">
<pre>
zk := d * G
PRK_h := HKDF-Extract ("key-derivation", zk)
h := HKDF-Expand (PRK_h, label | "gns", 512 / 8)
d' := h * d mod L
</pre><a href="#section-5.1-9" class="pilcrow">¶</a>
</div>
<p id="section-5.1-10">
         Equally, given a label, the output zk' of the HDKD-Public(zk,label) function is
         calculated as follows for PKEY zones:<a href="#section-5.1-10" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-11">
<pre>
PRK_h := HKDF-Extract ("key-derivation", zk)
h := HKDF-Expand (PRK_h, label | "gns", 512 / 8)
zk' := h mod L * zk
</pre><a href="#section-5.1-11" class="pilcrow">¶</a>
</div>
<p id="section-5.1-12">
         The PKEY cryptosystem uses a hash-based key derivation function (HKDF) as defined in
         <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>, using HMAC-SHA512 for the extraction
         phase and HMAC-SHA256 for the expansion phase.
         "PRK_h" is key material retrieved using an HKDF using the string
         "key-derivation" as salt and the public zone key "zk" as initial
         keying material.
         "h" is the 512-bit HKDF expansion result. The expansion info input is
         a concatenation of the label and string "gns".
         "label" is a UTF-8 string under which the resource records are
         published.<a href="#section-5.1-12" class="pilcrow">¶</a></p>
<p id="section-5.1-13">
         We point out that the multiplication of "zk" with "h" is a point multiplication,
         while the multiplication of "d" with "h" is a scalar multiplication.<a href="#section-5.1-13" class="pilcrow">¶</a></p>
<p id="section-5.1-14">
         The Sign() and Verify() functions
         for PKEY zones are implemented using 512-bit ECDSA deterministic
         signatures as specified in <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span>.<a href="#section-5.1-14" class="pilcrow">¶</a></p>
<p id="section-5.1-15">
         The S-Encrypt() and S-Decrypt() functions use AES in counter mode
         as defined in <span>[<a href="#MODES" class="xref">MODES</a>]</span> (CTR-AES-256):<a href="#section-5.1-15" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-16">
<pre>
RDATA := CTR-AES256(K, IV, BDATA)
BDATA := CTR-AES256(K, IV, RDATA)
</pre><a href="#section-5.1-16" class="pilcrow">¶</a>
</div>
<p id="section-5.1-17">
         The key "K" and counter "IV" are derived from
         the record "label" and the zone key "zk" as follows:<a href="#section-5.1-17" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-18">
<pre>
PRK_k := HKDF-Extract ("gns-aes-ctx-key", zk)
PRK_n := HKDF-Extract ("gns-aes-ctx-iv", zk)
K := HKDF-Expand (PRK_k, label, 256 / 8);
NONCE := HKDF-Expand (PRK_n, label, 32 / 8)
</pre><a href="#section-5.1-18" class="pilcrow">¶</a>
</div>
<p id="section-5.1-19">
         HKDF is a hash-based key derivation function as defined in
         <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>. Specifically, HMAC-SHA512 is used for the
         extraction phase and HMAC-SHA256 for the expansion phase.
         The output keying material is 32 octets (256 bits) for the symmetric
         key and 4 octets (32 bits) for the nonce.
         The symmetric key "K" is a 256-bit AES <span>[<a href="#RFC3826" class="xref">RFC3826</a>]</span> key.<a href="#section-5.1-19" class="pilcrow">¶</a></p>
<p id="section-5.1-20">
         The nonce is combined with a 64-bit initialization vector and a
         32-bit block counter as defined in <span>[<a href="#RFC3686" class="xref">RFC3686</a>]</span>.
         The block counter begins with the value of 1, and it is incremented
         to generate subsequent portions of the key stream.
         The block counter is a 32-bit integer value in network byte order.
         The initialization vector is the expiration time of the
         resource record block in network byte order.
         The resulting counter ("IV") wire format is as follows:<a href="#section-5.1-20" class="pilcrow">¶</a></p>
<div id="figure_hkdf_ivs_pkey">
<figure id="figure-5">
          <div class="artwork art-text alignLeft" id="section-5.1-21.1">
<pre>
0     8     16    24    32
+-----+-----+-----+-----+
|         NONCE         |
+-----+-----+-----+-----+
|       EXPIRATION      |
|                       |
+-----+-----+-----+-----+
|      BLOCK COUNTER    |
+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a></figcaption></figure>
</div>
</section>
</div>
<div id="gnsrecords_edkey">
<section id="section-5.2">
        <h3 id="name-edkey">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-edkey" class="section-name selfRef">EDKEY</a>
        </h3>
<p id="section-5.2-1">
         In GNS, a delegation of a label to a zone of type "EDKEY" is
         represented through a EDKEY record.  The EDKEY number is a zone
         type and thus also implies the cryptosystem for the zone that
         is being delegated to.
         An EDKEY resource record contains the public key of the zone to
         delegate to.
         A EDKEY record MUST be the only record under a label. No other
         records are allowed. A EDKEY DATA entry has the following format:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="figure_edkeyrecord">
<figure id="figure-6">
          <div class="artwork art-text alignLeft" id="section-5.2-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   PUBLIC KEY                  |
|                                               |
|                                               |
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a></figcaption></figure>
</div>
<p id="section-5.2-3">
         where:<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-4">
          <dt id="section-5.2-4.1">PUBLIC KEY</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-4.2">
           A 256-bit EdDSA zone key.<a href="#section-5.2-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.2-5">
           For EDKEY zones the zone key material is derived using the
           curve parameters of the twisted edwards representation
           of Curve25519 <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> (a.k.a. edwards25519)
           with the Ed25519-SHA-512 scheme <span>[<a href="#ed25519" class="xref">ed25519</a>]</span>.
           Consequently , we use the following naming convention for our
           cryptographic primitives for EDKEY zones:<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-6">
          <dt id="section-5.2-6.1">d</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-6.2">
             is a 256-bit EdDSA private zone key.<a href="#section-5.2-6.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-6.3">a</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-6.4">
             is is an integer derived from "d" using the SHA512 hash function
             as defined in <span>[<a href="#ed25519" class="xref">ed25519</a>]</span>.<a href="#section-5.2-6.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-6.5">zk</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-6.6">
             is the EdDSA public zone key corresponding to "d". It is defined in
             <span>[<a href="#ed25519" class="xref">ed25519</a>]</span> as the curve point "a*G" where "G" is the
             group generator of the elliptic curve and "a" is an integer
             derived from "d" using the SHA512 hash function.
             The public key is used to uniquely identify a GNS zone and is
             referred to as the "zone key".<a href="#section-5.2-6.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-6.7">p</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-6.8">
             is the prime of edwards25519 as defined in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, i.e.
             2^255 - 19.<a href="#section-5.2-6.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-6.9">G</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-6.10">
             is the group generator (X(P),Y(P)) of edwards25519 as defined in
            <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-5.2-6.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-6.11">L</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-6.12">
             is the prime-order subgroup of edwards25519 in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-5.2-6.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.2-7">
           The "zid" of an EDKEY is 32 + 4 bytes in length. This means that
           a "zTLD" will always fit into a single label and does
           not need any further conversion.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2-8">
           The "EDKEY" HDKD instantiation is based on <span>[<a href="#Tor224" class="xref">Tor224</a>]</span>.
           Given a label, the output of the HDKD-Private function for zone
           key blinding is calculated as follows for EDKEY zones:<a href="#section-5.2-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2-9">
<pre>
zk := a * G
PRK_h := HKDF-Extract ("key-derivation", zk)
h := HKDF-Expand (PRK_h, label | "gns", 512 / 8)
h[31] &amp;= 7
a1 := a / 8 /* 8 is the cofactor of Curve25519 */
a2 := h * a1 mod L
a' = a2 * 8 /* 8 is the cofactor of Curve25519 */
</pre><a href="#section-5.2-9" class="pilcrow">¶</a>
</div>
<p id="section-5.2-10">
           Equally, given a label, the output of the HDKD-Public function is
           calculated as follows for PKEY zones:<a href="#section-5.2-10" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2-11">
<pre>
PRK_h := HKDF-Extract ("key-derivation", zk)
h := HKDF-Expand (PRK_h, label | "gns", 512 / 8)
h[31] &amp;= 7  // Implies h mod L == h
zk' := h * zk
</pre><a href="#section-5.2-11" class="pilcrow">¶</a>
</div>
<p id="section-5.2-12">
           We note that implementors must employ a constant time scalar
           multiplication for the constructions above. Also, implementors
           must ensure that the private key "a" is an ed25519 private key
           and specifically that "a[0] &amp; 7 == 0" holds.<a href="#section-5.2-12" class="pilcrow">¶</a></p>
<p id="section-5.2-13">
           The EDKEY cryptosystem uses a
           hash-based key derivation function (HKDF) as defined in
           <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>, using HMAC-SHA512 for the extraction
           phase and HMAC-SHA256 for the expansion phase.
           "PRK_h" is key material retrieved using an HKDF using the string
           "key-derivation" as salt and the public zone key "zk" as initial
           keying material.
           "h" is the 512-bit HKDF expansion result. The expansion info input is
           a concatenation of the label and string "gns".
           The result of the HKDF must be clamped.
           "a" is the 256-bit integer corresponding to the 256-bit private zone
           key "d".
           "label" is a UTF-8 string under which the resource records are
           published.<a href="#section-5.2-13" class="pilcrow">¶</a></p>
<p id="section-5.2-14">
           We point out that the multiplication of "zk" with "h" is a point multiplication,
           while the division and multiplication of "a" and "a1" with the
           cofactor are integer operations.<a href="#section-5.2-14" class="pilcrow">¶</a></p>
<p id="section-5.2-15">
           Signatures for EDKEY zones using the derived private key "a'"
           are NOT compliant with <span>[<a href="#ed25519" class="xref">ed25519</a>]</span>.
           Instead, signatures MUST be generated as follows for any given
           message M and deterministic random-looking "r":<a href="#section-5.2-15" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2-16">
<pre>
R := r * G
S := r + SHA512(R, zk', M) * a' mod L
</pre><a href="#section-5.2-16" class="pilcrow">¶</a>
</div>
<p id="section-5.2-17">
           A signature (R,S) is valid if the following holds:<a href="#section-5.2-17" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2-18">
<pre>
SB == R + SHA512(R, zk', M) * A'
</pre><a href="#section-5.2-18" class="pilcrow">¶</a>
</div>
<p id="section-5.2-19">
           The S-Encrypt() and S-Decrypt() functions use ChaCha20
           as defined in <span>[<a href="#RFC7539" class="xref">RFC7539</a>]</span>
           (ChaCha20-Poly1305):<a href="#section-5.2-19" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2-20">
<pre>
RDATA := ChaCha20(K, IV, BDATA)
BDATA := ChaCha20(K, IV, RDATA) = CIPHERTEXT | TAG
</pre><a href="#section-5.2-20" class="pilcrow">¶</a>
</div>
<p id="section-5.2-21">
           The result of the ChaCha20 encryption function is the encrypted
           ciphertext concatenated with the 128-bit authentication
           tag "TAG".
           Accordingly, the length of BDATA equals the length of the
           RDATA plus the 16 octets of the authentication tag.<a href="#section-5.2-21" class="pilcrow">¶</a></p>
<p id="section-5.2-22">
           The key "K" and counter "IV" are derived from
           the record "label" and the zone key "zk" as follows:<a href="#section-5.2-22" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2-23">
<pre>
PRK_k := HKDF-Extract ("gns-aes-ctx-key", zk)
PRK_n := HKDF-Extract ("gns-aes-ctx-iv", zk)
K := HKDF-Expand (PRK_k, label, 256 / 8);
NONCE := HKDF-Expand (PRK_n, label, 32 / 8)
</pre><a href="#section-5.2-23" class="pilcrow">¶</a>
</div>
<p id="section-5.2-24">
           HKDF is a hash-based key derivation function as defined in
           <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>. Specifically, HMAC-SHA512 is used for the
           extraction phase and HMAC-SHA256 for the expansion phase.
           The output keying material is 32 octets (256 bits) for the symmetric
           key and 4 octets (32 bits) for the NONCE.
           The symmetric key "K" is a 256-bit ChaCha20
           <span>[<a href="#RFC7539" class="xref">RFC7539</a>]</span> key.
           No additional authenticated data (AAD) is used.<a href="#section-5.2-24" class="pilcrow">¶</a></p>
<p id="section-5.2-25">
           The nonce is combined with a 64-bit initialization vector and a
           32-bit block counter.
           The block counter begins with the value of 1, and it is incremented
           to generate subsequent portions of the key stream.
           The block counter is a 32-bit integer value treated as a 32-bit
           little-endian integer.
           The initialization vector is the expiration time of the
           resource record block in network byte order.
           The resulting counter ("IV") wire format is as follows:<a href="#section-5.2-25" class="pilcrow">¶</a></p>
<div id="figure_hkdf_ivs_edkey">
<figure id="figure-7">
          <div class="artwork art-text alignLeft" id="section-5.2-26.1">
<pre>
0     8     16    24    32
+-----+-----+-----+-----+
|         NONCE         |
+-----+-----+-----+-----+
|       EXPIRATION      |
|                       |
+-----+-----+-----+-----+
|      BLOCK COUNTER    |
+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a></figcaption></figure>
</div>
</section>
</div>
<div id="gnsrecords_gns2dns">
<section id="section-5.3">
        <h3 id="name-gns2dns">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-gns2dns" class="section-name selfRef">GNS2DNS</a>
        </h3>
<p id="section-5.3-1">It is possible to delegate a label back into DNS through a GNS2DNS record.
         The resource record contains a DNS name for the resolver to continue with
         in DNS followed by a DNS server. Both names are in the format defined in
         <span>[<a href="#RFC1034" class="xref">RFC1034</a>]</span> for DNS names.
         A GNS2DNS DATA entry has the following format:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div id="figure_gns2dnsrecord">
<figure id="figure-8">
          <div class="artwork art-text alignLeft" id="section-5.3-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                    DNS NAME                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                 DNS SERVER NAME               |
/                                               /
/                                               /
|                                               |
+-----------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a></figcaption></figure>
</div>
<p id="section-5.3-3">
         where:<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.3-4">
          <dt id="section-5.3-4.1">DNS NAME</dt>
          <dd style="margin-left: 1.5em" id="section-5.3-4.2">
           The name to continue with in DNS (0-terminated).<a href="#section-5.3-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.3-4.3">DNS SERVER NAME</dt>
          <dd style="margin-left: 1.5em" id="section-5.3-4.4">
           The DNS server to use. May be an IPv4/IPv6 address in dotted decimal
           form or a DNS name. It may also be a relative GNS name ending with a
           "+" top-level domain. The value is UTF-8 encoded (also for DNS names)
           and 0-terminated.<a href="#section-5.3-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="gnsrecords_leho">
<section id="section-5.4">
        <h3 id="name-leho">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-leho" class="section-name selfRef">LEHO</a>
        </h3>
<p id="section-5.4-1">Legacy hostname records can be used by applications that are expected
         to supply a DNS name on the application layer. The most common use case
         is HTTP virtual hosting, which as-is would not work with GNS names as
         those may not be globally unique.

         A LEHO resource record is expected to be found together in a single
         resource record with an IPv4 or IPv6 address.
         A LEHO DATA entry has the following format:<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<div id="figure_lehorecord">
<figure id="figure-9">
          <div class="artwork art-text alignLeft" id="section-5.4-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                 LEGACY HOSTNAME               |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a></figcaption></figure>
</div>
<p id="section-5.4-3">
         where:<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.4-4">
          <dt id="section-5.4-4.1">LEGACY HOSTNAME</dt>
          <dd style="margin-left: 1.5em" id="section-5.4-4.2">
           A UTF-8 string (which is not 0-terminated) representing the legacy hostname.<a href="#section-5.4-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.4-5">
         NOTE: If an application uses a LEHO value in an HTTP request header
         (e.g. "Host:" header) it must be converted to a punycode representation
         <span>[<a href="#RFC5891" class="xref">RFC5891</a>]</span>.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gnsrecords_nick">
<section id="section-5.5">
        <h3 id="name-nick">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-nick" class="section-name selfRef">NICK</a>
        </h3>
<p id="section-5.5-1">
         Nickname records can be used by zone administrators to publish an
         indication on what label this zone prefers to be referred to.
         This is a suggestion to other zones what label to use when creating a
         delegation record (<a href="#zone_types" class="xref">Section 3</a>) containing this zone's
         public zone key.
         This record SHOULD only be stored under the empty label "@" but MAY be
         returned with record sets under any label as a supplemental record.
         <a href="#nick_processing" class="xref">Section 8.2.6</a> details how a resolver must process
         supplemental and non-supplemental NICK records.
         A NICK DATA entry has the following format:<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<div id="figure_nickrecord">
<figure id="figure-10">
          <div class="artwork art-text alignLeft" id="section-5.5-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                  NICKNAME                     |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a></figcaption></figure>
</div>
<p id="section-5.5-3">
         where:<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.5-4">
          <dt id="section-5.5-4.1">NICKNAME</dt>
          <dd style="margin-left: 1.5em" id="section-5.5-4.2">
           A UTF-8 string (which is not 0-terminated) representing the preferred
           label of the zone. This string MUST NOT include a "." character.<a href="#section-5.5-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="gnsrecords_box">
<section id="section-5.6">
        <h3 id="name-box">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-box" class="section-name selfRef">BOX</a>
        </h3>
<p id="section-5.6-1">
         In GNS, every "." in a name delegates to another zone, and
         GNS lookups are expected to return all of the required useful
         information in one record set.  This is incompatible with the
         special labels used by DNS for SRV and TLSA records.  Thus, GNS
         defines the BOX record format to box up SRV and TLSA records and
         include them in the record set of the label they are associated
         with.  For example, a
         TLSA record for "_https._tcp.example.org" will be stored in the record set of
         "example.org" as a BOX record with service (SVC) 443 (https) and protocol (PROTO) 6
         (tcp) and record TYPE "TLSA".
         For reference, see also <span>[<a href="#RFC2782" class="xref">RFC2782</a>]</span>.
         A BOX DATA entry has the following format:<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<div id="figure_boxrecord">
<figure id="figure-11">
          <div class="artwork art-text alignLeft" id="section-5.6-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|   PROTO   |    SVC    |       TYPE            |
+-----------+-----------------------------------+
|                 RECORD DATA                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a></figcaption></figure>
</div>
<p id="section-5.6-3">
         where:<a href="#section-5.6-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.6-4">
          <dt id="section-5.6-4.1">PROTO</dt>
          <dd style="margin-left: 1.5em" id="section-5.6-4.2">
           the 16-bit protocol number, e.g. 6 for tcp. In network byte order.<a href="#section-5.6-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.6-4.3">SVC</dt>
          <dd style="margin-left: 1.5em" id="section-5.6-4.4">
           the 16-bit service value of the boxed record, i.e. the port number.
           In network byte order.<a href="#section-5.6-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.6-4.5">TYPE</dt>
          <dd style="margin-left: 1.5em" id="section-5.6-4.6">
           is the 32-bit record type of the boxed record. In network byte order.<a href="#section-5.6-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.6-4.7">RECORD DATA</dt>
          <dd style="margin-left: 1.5em" id="section-5.6-4.8">
           is a variable length field containing the "DATA" format of TYPE as
           defined for the respective TYPE in DNS.<a href="#section-5.6-4.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="gnsrecords_vpn">
<section id="section-5.7">
        <h3 id="name-vpn">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-vpn" class="section-name selfRef">VPN</a>
        </h3>
<p id="section-5.7-1">
         A VPN DATA entry has the following format:<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<div id="figure_vpnrecord">
<figure id="figure-12">
          <div class="artwork art-text alignLeft" id="section-5.7-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|          HOSTING PEER PUBLIC KEY              |
|                (256 bits)                     |
|                                               |
|                                               |
+-----------+-----------------------------------+
|   PROTO   |    SERVICE  NAME                  |
+-----------+                                   +
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a></figcaption></figure>
</div>
<p id="section-5.7-3">
         where:<a href="#section-5.7-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.7-4">
          <dt id="section-5.7-4.1">HOSTING PEER PUBLIC KEY</dt>
          <dd style="margin-left: 1.5em" id="section-5.7-4.2">
           is a 256-bit EdDSA public key identifying the peer hosting the
           service.<a href="#section-5.7-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.7-4.3">PROTO</dt>
          <dd style="margin-left: 1.5em" id="section-5.7-4.4">
           the 16-bit protocol number, e.g. 6 for TCP. In network byte order.<a href="#section-5.7-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.7-4.5">SERVICE NAME</dt>
          <dd style="margin-left: 1.5em" id="section-5.7-4.6">
           a shared secret used to identify the service at the hosting peer,
           used to derive the port number requird to connect to the service.
           The service name MUST be a 0-terminated UTF-8 string.<a href="#section-5.7-4.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="publish">
<section id="section-6">
      <h2 id="name-publishing-records">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-publishing-records" class="section-name selfRef">Publishing Records</a>
      </h2>
<p id="section-6-1">
       GNS resource records are published in a distributed hash table (DHT).
       We assume that a DHT provides two functions: GET(key) and PUT(key,value).
       In GNS, resource records are grouped by their respective labels,
       encrypted and published together in a single resource records block
       (RRBLOCK) in the DHT under a key "q": PUT(q, RRBLOCK).
       The key "q" which is derived from the zone key "zk" and the respective
       "label" of the contained records.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="blinding">
<section id="section-6.1">
        <h3 id="name-dht-key-derivations">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-dht-key-derivations" class="section-name selfRef">DHT Key Derivations</a>
        </h3>
<p id="section-6.1-1">
         Given a label, the DHT key "q" is derived as follows:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.1-2">
<pre>
q := SHA512 (HDKD-Public(zk, label))
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.1-3">
          <dt id="section-6.1-3.1">label</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-3.2">is a UTF-8 string under which the resource records are published.<a href="#section-6.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.3">zk</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-3.4">
           is the public zone key.<a href="#section-6.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.5">q</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-3.6">
           Is the 512-bit DHT key under which the resource records block is
           published.
           It is the SHA512 hash over the derived public zone key.<a href="#section-6.1-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="wire">
<section id="section-6.2">
        <h3 id="name-resource-records-block">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-resource-records-block" class="section-name selfRef">Resource Records Block</a>
        </h3>
<p id="section-6.2-1">
         GNS records are grouped by their labels and published as a single
         block in the DHT. The grouped record sets MAY be paired with any
         number of supplemental records. Supplemental records must have the
         supplemental flag set (See <a href="#rrecords" class="xref">Section 4</a>).
         The contained resource records are encrypted using a symmetric
         encryption scheme.
         A GNS implementation must publish RRBLOCKs
         in accordance to the properties and recommendations of the underlying
         DHT. This may include a periodic refresh publication.
         A GNS RRBLOCK has the following format:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="figure_record_block">
<figure id="figure-13">
          <div class="artwork art-text alignLeft" id="section-6.2-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|       ZONE TYPE       |    PUBLIC ZONE KEY    |
+-----+-----+-----+-----+       (BLINDED)       |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   SIGNATURE                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|         SIZE          |       PURPOSE         |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                    BDATA                      /
/                                               /
/                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a></figcaption></figure>
</div>
<p id="section-6.2-3">where:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2-4">
          <dt id="section-6.2-4.1">ZONE TYPE</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.2">
           is the 32-bit zone type.<a href="#section-6.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.3">ZONE PUBLIC KEY</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.4">
           is the blinded public zone key "HDKD-Public(zk, label)"
           to be used to verify SIGNATURE.<a href="#section-6.2-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.5">SIGNATURE</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.6">
           The signature is computed over the data following
           the PUBLIC KEY field.
           The signature is created using the Sign() function of
           the cryptosystem of the zone and the derived private key
           "HDKD-Private(d, label)" (see <a href="#zone_types" class="xref">Section 3</a>).<a href="#section-6.2-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.7">SIZE</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.8">
           A 32-bit value containing the length of the signed data following the
           PUBLIC KEY field in network byte order. This value always includes the
           length of the fields SIZE (4), PURPOSE (4) and EXPIRATION (8) in
           addition to the length of the BDATA.  While a 32-bit value is used,
           implementations MAY refuse to publish blocks beyond a certain
           size significantly below 4 GB. However, a minimum block size of
           62 kilobytes MUST be supported.<a href="#section-6.2-4.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.9">PURPOSE</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.10">
           A 32-bit signature purpose flag. This field MUST be 15 (in network
           byte order).<a href="#section-6.2-4.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.11">EXPIRATION</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.12">
           Specifies when the RRBLOCK expires and the encrypted block
           SHOULD be removed from the DHT and caches as it is likely stale.
           However, applications MAY continue to use non-expired individual
           records until they expire.  The value MUST be set to the
           expiration time of the resource record contained within this block with the
           smallest expiration time.
           If a records block includes shadow records, then the maximum
           expiration time of all shadow records with matching type and the
           expiration times of the non-shadow records is considered.
           This is a 64-bit absolute date in microseconds since midnight
           (0 hour), January 1, 1970 in network byte order.<a href="#section-6.2-4.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.13">BDATA</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.14">
           The encrypted resource records with a total size of SIZE - 16.<a href="#section-6.2-4.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="recordencryption">
<section id="section-6.3">
        <h3 id="name-record-data-encryption-and-">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-record-data-encryption-and-" class="section-name selfRef">Record Data Encryption and Decryption</a>
        </h3>
<p id="section-6.3-1">
         A symmetric encryption scheme is used to encrypt the resource records
         set RDATA into the BDATA field of a GNS RRBLOCK.
         The wire format of the RDATA looks as follows:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div id="figure_rdata">
<figure id="figure-14">
          <div class="artwork art-text alignLeft" id="section-6.3-2.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|     RR COUNT          |        EXPIRA-        /
+-----+-----+-----+-----+-----+-----+-----+-----+
/         -TION         |       DATA SIZE       |
+-----+-----+-----+-----+-----+-----+-----+-----+
|         TYPE          |          FLAGS        |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      DATA                     /
/                                               /
/                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|       DATA SIZE       |          TYPE         |
+-----+-----+-----+-----+-----+-----+-----+-----+
|           FLAGS       |        DATA           /
+-----+-----+-----+-----+                       /
/                       +-----------------------/
/                       |                       /
+-----------------------+                       /
/                     PADDING                   /
/                                               /
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a></figcaption></figure>
</div>
<p id="section-6.3-3">where:<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.3-4">
          <dt id="section-6.3-4.1">RR COUNT</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.2">
           A 32-bit value containing the number of variable-length resource
           records which are
           following after this field in network byte order.<a href="#section-6.3-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.3">EXPIRATION, DATA SIZE, TYPE, FLAGS and DATA</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.4">
           These fields were defined
           in the resource record format in <a href="#rrecords" class="xref">Section 4</a>.
           There MUST be a total of RR COUNT of these resource records
           present.<a href="#section-6.3-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.5">PADDING</dt>
          <dd style="margin-left: 1.5em" id="section-6.3-4.6">
           The padding MUST contain the value 0 in all octets.
           The padding MUST ensure that the size of the RDATA WITHOUT the RR
           COUNT field is a power of two.
           As a special exception, record sets with (only) a zone delegation
           record type are never padded.
           Note that a record set with a delegation record MUST NOT
           contain other records.<a href="#section-6.3-4.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="encoding">
<section id="section-7">
      <h2 id="name-internationalization-and-ch">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-internationalization-and-ch" class="section-name selfRef">Internationalization and Character Encoding</a>
      </h2>
<p id="section-7-1">
       All labels in GNS are encoded in UTF-8 <span>[<a href="#RFC3629" class="xref">RFC3629</a>]</span>.
       This does not include any DNS names found in DNS records, such as CNAME
       records, which are internationalized through the IDNA specifications
       <span>[<a href="#RFC5890" class="xref">RFC5890</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resolution">
<section id="section-8">
      <h2 id="name-name-resolution">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-name-resolution" class="section-name selfRef">Name Resolution</a>
      </h2>
<p id="section-8-1">
       Names in GNS are resolved by recursively querying the DHT record storage.
       In the following, we define how resolution is initiated and each
       iteration in the resolution is processed.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">
       GNS resolution of a name must start in a given starting zone indicated using
       a zone public key.
       Details on how the starting zone may be determined is discussed in
       <a href="#governance" class="xref">Section 10</a>.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">
       When GNS name resolution is requested, a desired record type MAY be
       provided by the client.
       The GNS resolver will use the desired record type to guide
       processing, for example by providing conversion of VPN records to A
       or AAAA records, if that is desired.

       However, filtering of record sets according to the required record
       types MUST still be done by the client after the resource record set
       is retrieved.<a href="#section-8-3" class="pilcrow">¶</a></p>
<div id="recursion">
<section id="section-8.1">
        <h3 id="name-recursion">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-recursion" class="section-name selfRef">Recursion</a>
        </h3>
<p id="section-8.1-1">
           In each step of the recursive name resolution, there is an
           authoritative zone zk and a name to resolve. The name may be empty.
           Initially, the authoritative zone is the start zone. If the name
           is empty, it is interpreted as the apex label "@".<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">
           From here, the following steps are recursively executed, in order:<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.1-3">
           <li id="section-8.1-3.1">Extract the right-most label from the name to look up.<a href="#section-8.1-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-8.1-3.2">Calculate q using the label and zk as defined in
           <a href="#blinding" class="xref">Section 6.1</a>.<a href="#section-8.1-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-8.1-3.3">Perform a DHT query GET(q) to retrieve the RRBLOCK.<a href="#section-8.1-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-8.1-3.4">Verify and process the RRBLOCK and decrypt the BDATA contained
             in it as defined in <a href="#recordencryption" class="xref">Section 6.3</a>.<a href="#section-8.1-3.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-8.1-4">
           Upon receiving the RRBLOCK from the DHT, apart from verifying the
           provided signature, the resolver MUST check that the authoritative
           zone key was used to sign the record:
           The derived zone key "h*zk" MUST match the public key provided in
           the RRBLOCK, otherwise the RRBLOCK MUST be ignored and the DHT lookup
           GET(q) MUST continue.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="record_processing">
<section id="section-8.2">
        <h3 id="name-record-processing">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-record-processing" class="section-name selfRef">Record Processing</a>
        </h3>
<p id="section-8.2-1">
           Record processing occurs at the end of a single recursion. We assume
           that the RRBLOCK has been cryptographically verified and decrypted.
           At this point, we must first determine if we have received a valid
           record set in the context of the name we are trying to resolve:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.2-2">
         <li id="section-8.2-2.1">
           Case 1:
           If the remainder of the name to resolve is empty and the record set
           does not consist of a delegation, CNAME or DNS2GNS record,
           the record set is the result and the recursion is concluded.<a href="#section-8.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-8.2-2.2">
     Case 2:
     If the name to be resolved is of the format
     "_SERVICE._PROTO" and the record set contains one or more matching BOX
     records, the records in the BOX records are the result and the recusion
     is concluded (<a href="#box_processing" class="xref">Section 8.2.4</a>).<a href="#section-8.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-8.2-2.3">
           Case 3:
           If the remainder of the name to resolve is not empty and
     does not match the "_SERVICE._PROTO" syntax, then the current record set
           MUST consist of a single delegation record (<a href="#delegation_processing" class="xref">Section 8.2.1</a>),
           a single CNAME record (<a href="#cname_processing" class="xref">Section 8.2.3</a>),
           or one or more GNS2DNS records (<a href="#gns2dns_processing" class="xref">Section 8.2.2</a>),
           which are processed as described in the respective sections below.
           The record set may include any number of supplemental records.
           Otherwise, resolution fails
           and the resolver MUST return an empty record set.

     Finally, after the recursion terminates, the client preferences
     for the record type SHOULD be considered. If a VPN record is found
     and the client requests an A or AAAA record, the VPN record
     SHOULD be converted (<a href="#vpn_processing" class="xref">Section 8.2.5</a>)
     if possible.<a href="#section-8.2-2.3" class="pilcrow">¶</a>
</li>
        </ol>
<div id="delegation_processing">
<section id="section-8.2.1">
          <h4 id="name-encountering-zone-delegatio">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-encountering-zone-delegatio" class="section-name selfRef">Encountering zone delegation records</a>
          </h4>
<p id="section-8.2.1-1">
             When the resolver encounters a record of a supported
             zone delegation record type (such as PKEY or EDKEY)
             and the remainder of
             the name is not empty, resolution continues
             recursively with the remainder of the name in the
             GNS zone specified in the delegation record.
             Implementations MUST NOT allow multiple different zone type
             delegations under a single label.
             Implementations MAY support any subset of zone types.  If
             an unsupported zone type is encountered, resolution fails
             (NXDOMAIN).<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-8.2.1-2">
             If the remainder of the name to resolve is empty and we have
             received a record set containing only a single PKEY record, the
             recursion is continued with the PKEY as authoritative zone and
             the empty apex label "@" as remaining name, except in the case
             where the desired record type is PKEY, in which case the PKEY
             record is returned and the resolution is concluded without
             resolving the empty apex label.<a href="#section-8.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gns2dns_processing">
<section id="section-8.2.2">
          <h4 id="name-gns2dns-2">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-gns2dns-2" class="section-name selfRef">GNS2DNS</a>
          </h4>
<p id="section-8.2.2-1">
             When a resolver encounters one or more GNS2DNS records and the remaining name
             is empty and the desired record type is GNS2DNS, the GNS2DNS
             records are returned.<a href="#section-8.2.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2.2-2">
             Otherwise, it is expected that the resolver first resolves the
             IP(s) of the specified DNS name server(s). GNS2DNS records MAY
             contain numeric IPv4 or IPv6 addresses, allowing the resolver to
             skip this step.
             The DNS server names may themselves be names in GNS or DNS.
             If the DNS server name ends in ".+", the rest of the name is to be
             interpreted relative to the zone of the GNS2DNS record.
             If the DNS server name ends in a label representation of a
             zone key, the DNS server name is to be resolved against
             the GNS zone zk.<a href="#section-8.2.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2.2-3">
             Multiple GNS2DNS records may be stored under the same label,
             in which case the resolver MUST try all of them.
             The resolver MAY try them in any order or even in parallel.
             If multiple GNS2DNS records are present, the DNS name MUST be
             identical for all of them, if not the resolution fails and an
             emtpy record set is returned as the record set is invalid.<a href="#section-8.2.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2.2-4">
             Once the IP addresses of the DNS servers have been determined,
             the DNS name from the GNS2DNS record is appended
             to the remainder of the name to be resolved, and
             resolved by querying the DNS name server(s).  As the DNS servers
             specified are possibly authoritative DNS servers, the GNS resolver MUST
             support recursive resolution and MUST NOT delegate this to the
             authoritative DNS servers.
             The first successful recursive name resolution result
             is returned to the client.
             In addition, the resolver returns the queried DNS name as a
             supplemental LEHO record (<a href="#gnsrecords_leho" class="xref">Section 5.4</a>) with a
             relative expiration time of one hour.<a href="#section-8.2.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2.2-5">
       GNS resolvers SHOULD offer a configuration
       option to disable DNS processing to avoid information leakage
       and provide a consistent security profile for all name resolutions.
       Such resolvers would return an empty record set upon encountering
       a GNS2DNS record during the recursion. However, if GNS2DNS records
       are encountered in the record set for the apex and a GNS2DNS record
       is expicitly requested by the application, such records MUST
       still be returned, even if DNS support is disabled by the
       GNS resolver configuration.<a href="#section-8.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cname_processing">
<section id="section-8.2.3">
          <h4 id="name-cname">
<a href="#section-8.2.3" class="section-number selfRef">8.2.3. </a><a href="#name-cname" class="section-name selfRef">CNAME</a>
          </h4>
<p id="section-8.2.3-1">
             If a CNAME record is encountered, the canonical name is
             appended to the remaining name, except if the remaining name
             is empty and the desired record type is CNAME, in which case
             the resolution concludes with the CNAME record.
             If the canonical name ends in ".+",
             resolution continues in GNS with the new name in the
             current zone.  Otherwise, the resulting name is resolved via the
             default operating system name resolution process.
             This may in turn again trigger a GNS resolution process depending
             on the system configuration.<a href="#section-8.2.3-1" class="pilcrow">¶</a></p>
<p id="section-8.2.3-2">
             The recursive DNS resolution process may yield a CNAME as well
             which in turn may either point into the DNS or GNS namespace
             (if it ends in a label representation of a zone key).
             In order to prevent infinite loops, the resolver MUST
             implement loop detections or limit the number of recursive
             resolution steps.
             If the last CNAME was a DNS name, the resolver returns the DNS name
             as a supplemental LEHO record (<a href="#gnsrecords_leho" class="xref">Section 5.4</a>)
             with a relative expiration time of one hour.<a href="#section-8.2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="box_processing">
<section id="section-8.2.4">
          <h4 id="name-box-2">
<a href="#section-8.2.4" class="section-number selfRef">8.2.4. </a><a href="#name-box-2" class="section-name selfRef">BOX</a>
          </h4>
<p id="section-8.2.4-1">
             When a BOX record is received, a GNS resolver must unbox it if the
             name to be resolved continues with "_SERVICE._PROTO".
             Otherwise, the BOX record is to be left untouched. This way, TLSA
             (and SRV) records do not require a separate network request, and
             TLSA records become inseparable from the corresponding address
             records.<a href="#section-8.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vpn_processing">
<section id="section-8.2.5">
          <h4 id="name-vpn-2">
<a href="#section-8.2.5" class="section-number selfRef">8.2.5. </a><a href="#name-vpn-2" class="section-name selfRef">VPN</a>
          </h4>
<p id="section-8.2.5-1">
       At the end of the recursion,
             if the queried record type is either A or AAAA and the retrieved
             record set contains at least one VPN record, the resolver SHOULD
             open a tunnel and return the IPv4 or IPv6 tunnel address,
             respectively.
             The type of tunnel depends on the contents of the VPN record data.
             The VPN record MUST be returned if the resolver implementation
             does not support setting up a tunnnel.<a href="#section-8.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nick_processing">
<section id="section-8.2.6">
          <h4 id="name-nick-2">
<a href="#section-8.2.6" class="section-number selfRef">8.2.6. </a><a href="#name-nick-2" class="section-name selfRef">NICK</a>
          </h4>
<p id="section-8.2.6-1">
             NICK records are only relevant to the recursive resolver
             if the record set in question is the final result which is to
             be returned to the client. The encountered NICK records may either
             be supplemental (see <a href="#rrecords" class="xref">Section 4</a>) or
             non-supplemental.
             If the NICK record is supplemental, the resolver only returns the
             record set if one of the non-supplemental records matches the
             queried record type.<a href="#section-8.2.6-1" class="pilcrow">¶</a></p>
<p id="section-8.2.6-2">
             The differentiation between a supplemental and non-supplemental
             NICK record allows the client to match the record to the
             authoritative zone. Consider the following example:<a href="#section-8.2.6-2" class="pilcrow">¶</a></p>
<figure id="figure-15">
            <div class="artwork art-text alignLeft" id="section-8.2.6-3.1">
<pre>
Query: alice.example (type=A)
Result:
A: 192.0.2.1
NICK: eve
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a></figcaption></figure>
<p id="section-8.2.6-4">
          In this example, the returned NICK record is non-supplemental.
          For the client, this means that the NICK belongs to the zone
          "alice.doe" and is published under the empty label along with an A
          record. The NICK record should be interpreted as: The zone defined by
          "alice.doe" wants to be referred to as "eve".
          In contrast, consider the following:<a href="#section-8.2.6-4" class="pilcrow">¶</a></p>
<figure id="figure-16">
            <div class="artwork art-text alignLeft" id="section-8.2.6-5.1">
<pre>
Query: alice.example (type=AAAA)
Result:
AAAA: 2001:DB8::1
NICK: john (Supplemental)
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a></figcaption></figure>
<p id="section-8.2.6-6">
       In this case, the NICK record is marked as supplemental. This means that
       the NICK record belongs to the zone "doe" and is published under the
       label "alice" along with an A record. The NICK record should be
       interpreted as: The zone defined by "doe" wants to be referred to as
       "john". This distinction is likely useful for other records published as
       supplemental.<a href="#section-8.2.6-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="revocation">
<section id="section-9">
      <h2 id="name-zone-revocation">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-zone-revocation" class="section-name selfRef">Zone Revocation</a>
      </h2>
<p id="section-9-1">
         Whenever a recursive resolver encounters a new GNS zone, it MUST
         check against the local revocation list whether the respective
         zone key has been revoked.  If the zone key was revoked, the
         resolution MUST fail with an empty result set.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">
         In order to revoke a zone key, a signed revocation object SHOULD be
         published.
         This object MUST be signed using the private zone key.
         The revocation object is flooded in the overlay network. To prevent
         flooding attacks, the revocation message MUST contain a proof of work
         (PoW).
         The revocation message including the PoW MAY be calculated
         ahead of time to support timely revocation.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">
         For all occurences below, "Argon2id" is the Password-based Key
         Derivation Function as defined in <span>[<a href="#Argon2" class="xref">Argon2</a>]</span>. For the
         PoW calculations the algorithm is instantiated with the
         following parameters:<a href="#section-9-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9-4">
        <dt id="section-9-4.1">S</dt>
        <dd style="margin-left: 1.5em" id="section-9-4.2">The salt. Fixed 16-octet string: "GnsRevocationPow".<a href="#section-9-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-4.3">t</dt>
        <dd style="margin-left: 1.5em" id="section-9-4.4">Number of iterations: 3<a href="#section-9-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-4.5">m</dt>
        <dd style="margin-left: 1.5em" id="section-9-4.6">Memory size in KiB: 1024<a href="#section-9-4.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-4.7">T</dt>
        <dd style="margin-left: 1.5em" id="section-9-4.8">Output length of hash in bytes: 64<a href="#section-9-4.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-4.9">p</dt>
        <dd style="margin-left: 1.5em" id="section-9-4.10">Parallelization parameter: 1<a href="#section-9-4.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-4.11">v</dt>
        <dd style="margin-left: 1.5em" id="section-9-4.12">Algorithm version: 0x13<a href="#section-9-4.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-4.13">y</dt>
        <dd style="margin-left: 1.5em" id="section-9-4.14">Algorithm type (Argon2id): 2<a href="#section-9-4.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-4.15">X</dt>
        <dd style="margin-left: 1.5em" id="section-9-4.16">Unused<a href="#section-9-4.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-4.17">K</dt>
        <dd style="margin-left: 1.5em" id="section-9-4.18">Unused<a href="#section-9-4.18" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-9-5">
         The following is the message string "P" on which the PoW is
         calculated:<a href="#section-9-5" class="pilcrow">¶</a></p>
<div id="figure_revocation">
<figure id="figure-17">
        <div class="artwork art-text alignLeft" id="section-9-6.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      POW                      |
+-----------------------------------------------+
|                   TIMESTAMP                   |
+-----------------------------------------------+
|       ZONE TYPE       |    PUBLIC ZONE KEY    |
+-----+-----+-----+-----+                       |
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a></figcaption></figure>
</div>
<p id="section-9-7">where:<a href="#section-9-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9-8">
        <dt id="section-9-8.1">POW</dt>
        <dd style="margin-left: 1.5em" id="section-9-8.2">
           A 64-bit solution to the PoW. In network byte order.<a href="#section-9-8.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-8.3">TIMESTAMP</dt>
        <dd style="margin-left: 1.5em" id="section-9-8.4">
           denotes the absolute 64-bit date when the revocation was computed.
           In microseconds since midnight (0 hour), January 1, 1970 in network
           byte order.<a href="#section-9-8.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-8.5">PUBLIC KEY</dt>
        <dd style="margin-left: 1.5em" id="section-9-8.6">
           is the 256-bit public key "zk" of the zone which is being revoked and
           the key to be used to verify SIGNATURE. The
           wire format of this value is defined in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>,
           Section 5.1.5.<a href="#section-9-8.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-9-9">
         Traditionally, PoW schemes require to find a "POW" such that
         at least D leading zeroes are found in the hash result.
         D is then referred to as the "difficulty" of the PoW.
         In order to reduce the variance in time it takes to calculate the
         PoW, we require that a number "Z" different PoWs must be
         found that on average have "D" leading zeroes.<a href="#section-9-9" class="pilcrow">¶</a></p>
<p id="section-9-10">
         The resulting proofs may then published and disseminated. The concrete
         dissemination and publication methods are out of scope of this
         document. Given an average difficulty of "D", the proofs have an
         expiration time of EPOCH. With each additional bit difficulty, the
         lifetime of the proof is prolonged for another EPOCH.
         Consequently, by calculating a more difficult PoW, the lifetime of the
         proof can be increased on demand by the zone owner.<a href="#section-9-10" class="pilcrow">¶</a></p>
<p id="section-9-11">
         The parameters are defined as follows:<a href="#section-9-11" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9-12">
        <dt id="section-9-12.1">Z</dt>
        <dd style="margin-left: 1.5em" id="section-9-12.2">The number of PoWs required is fixed at 32.<a href="#section-9-12.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-12.3">D</dt>
        <dd style="margin-left: 1.5em" id="section-9-12.4">The difficulty is fixed at 22.<a href="#section-9-12.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-12.5">EPOCH</dt>
        <dd style="margin-left: 1.5em" id="section-9-12.6">A single epoch is fixed at 365 days.<a href="#section-9-12.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-9-13">
         Given that proof has been found, a revocation data object is defined
         as follows:<a href="#section-9-13" class="pilcrow">¶</a></p>
<div id="figure_revocationdata">
<figure id="figure-18">
        <div class="artwork art-text alignLeft" id="section-9-14.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   TIMESTAMP                   |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      TTL                      |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                     POW_0                     |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                       ...                     |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                     POW_Z-1                   |
+-----------------------------------------------+
|       ZONE TYPE       |    PUBLIC ZONE KEY    |
+-----+-----+-----+-----+                       |
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   SIGNATURE                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a></figcaption></figure>
</div>
<p id="section-9-15">where:<a href="#section-9-15" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9-16">
        <dt id="section-9-16.1">TIMESTAMP</dt>
        <dd style="margin-left: 1.5em" id="section-9-16.2">
           denotes the absolute 64-bit date when the revocation was computed.
           In microseconds since midnight (0 hour), January 1, 1970 in network
           byte order. This is the same value as the timestamp used in the
           individual PoW calculations.<a href="#section-9-16.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-16.3">TTL</dt>
        <dd style="margin-left: 1.5em" id="section-9-16.4">
           denotes the relative 64-bit time to live of of the record in
           microseconds also in network byte order. This field is informational
           for a verifier. The verifier may discard revocation if the TTL
           indicates that it is already expired. However, the actual TTL of the
           revocation must be determined by examining the leading zeros in the
           proof of work calculation.<a href="#section-9-16.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-16.5">POW_i</dt>
        <dd style="margin-left: 1.5em" id="section-9-16.6">
           The values calculated as part of the PoW, in network byte order.
           Each POW_i MUST be unique in the set of POW values.
           To facilitate fast verification
           of uniqueness, the POW values must be given in strictly
           monotonically increasing order in the message.<a href="#section-9-16.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-16.7">ZONE TYPE</dt>
        <dd style="margin-left: 1.5em" id="section-9-16.8">
           The 32-bit zone type corresponding to the zone public key.<a href="#section-9-16.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-16.9">ZONE PUBLIC KEY</dt>
        <dd style="margin-left: 1.5em" id="section-9-16.10">
           is the public key "zk" of the zone which is being revoked and
           the key to be used to verify SIGNATURE.<a href="#section-9-16.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-16.11">SIGNATURE</dt>
        <dd style="margin-left: 1.5em" id="section-9-16.12">
           A signature over a timestamp and the public zone zk of the zone
           which is revoked and corresponds to the key used in the PoW.
           The signature is created using the Sign() function of
           the cryptosystem of the zone and the private zone key
           (see <a href="#zone_types" class="xref">Section 3</a>).<a href="#section-9-16.12" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-9-17">
         The signature over the public key covers a 32-bit pseudo header
         conceptually prefixed to the public key. The pseudo header includes
         the key length and signature purpose:<a href="#section-9-17" class="pilcrow">¶</a></p>
<div id="figure_revsigwithpseudo">
<figure id="figure-19">
        <div class="artwork art-text alignLeft" id="section-9-18.1">
<pre>
0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|         SIZE (0x30)   |       PURPOSE (0x03)  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   TIMESTAMP                   |
+-----+-----+-----+-----+-----+-----+-----+-----+
|       ZONE TYPE       |     ZONE PUBLIC KEY   |
+-----+-----+-----+-----+                       |
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a></figcaption></figure>
</div>
<p id="section-9-19">where:<a href="#section-9-19" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9-20">
        <dt id="section-9-20.1">SIZE</dt>
        <dd style="margin-left: 1.5em" id="section-9-20.2">
           A 32-bit value containing the length of the signed data in bytes
           in network byte order.<a href="#section-9-20.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-20.3">PURPOSE</dt>
        <dd style="margin-left: 1.5em" id="section-9-20.4">
           A 32-bit signature purpose flag. This field MUST be 3 (in network
           byte order).<a href="#section-9-20.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-20.5">ZONE TYPE</dt>
        <dd style="margin-left: 1.5em" id="section-9-20.6">
           The 32-bit zone type corresponding to the zone public key.<a href="#section-9-20.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-9-20.7">ZONE PUBLIC KEY / TIMESTAMP</dt>
        <dd style="margin-left: 1.5em" id="section-9-20.8">Both values as defined in the revocation data object above.<a href="#section-9-20.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-9-21">
         In order to verify a revocation the following steps must be taken,
         in order:<a href="#section-9-21" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9-22">
         <li id="section-9-22.1">The current time MUST be between TIMESTAMP and
           TIMESTAMP+TTL.<a href="#section-9-22.1" class="pilcrow">¶</a>
</li>
        <li id="section-9-22.2">The signature MUST match the public key.<a href="#section-9-22.2" class="pilcrow">¶</a>
</li>
        <li id="section-9-22.3">The set of POW values MUST NOT contain duplicates.<a href="#section-9-22.3" class="pilcrow">¶</a>
</li>
        <li id="section-9-22.4">The average number of leading zeroes resulting from the provided
           POW values D' MUST be greater than D.<a href="#section-9-22.4" class="pilcrow">¶</a>
</li>
        <li id="section-9-22.5">The validation period (TTL) of the revocation is calculated as
           (D'-D) * EPOCH * 1.1. The EPOCH is extended by
           10% in order to deal with unsynchronized clocks.
           The TTL added on top of the TIMESTAMP yields the
           expiration date.<a href="#section-9-22.5" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="governance">
<section id="section-10">
      <h2 id="name-determining-the-root-zone-a">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-determining-the-root-zone-a" class="section-name selfRef">Determining the Root Zone and Zone Governance</a>
      </h2>
<p id="section-10-1">
         The resolution of a GNS name must start in a given start zone
         indicated to the resolver using any public zone key.
         The local resolver may have a local start zone configured/hard-coded
         which points to a local or remote start zone key.
         A resolver client may also determine the start zone from the
         suffix of the name given for resolution or using information
   retrieved out of band.
         The governance model of any zone is at the sole discretion
         of the zone owner. However, the choice of start zone(s) is at the sole
         discretion of the local system administrator or user.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">
         This is an important distinguishing factor from the Domain Name System
         where root zone governance is centralized at the Internet Corporation
         for Assigned Names and Numbers (ICANN).
         In DNS terminology, GNS roughly follows the idea of a hyper-hyper
   local root zone deployment, with the difference that it is not
   expected that all deployments use the same local root zone.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">
         In the following, we give examples how a local client resolver SHOULD
         discover the start zone.  The process given is not exhaustive and
         clients MAY suppliement it with other mechanisms or ignore it if the
   particular application requires a different process.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">
         GNS clients MUST first try to interpret the top-level domain of
         a GNS name as a zone key representation ("zTLD").
         If the top-level domain is indicated to be a label representation of
         a public zone key with a well-defined "ztype" value, the root zone of
         the resolution process is implicitly given by the suffic of the name:<a href="#section-10-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10-5">
<pre>
Example name: www.example.&lt;zTLD&gt;
=&gt; Root zone: zk of type ztype
=&gt; Name to resolve from root zone: www.example
</pre><a href="#section-10-5" class="pilcrow">¶</a>
</div>
<p id="section-10-6">
         In GNS, users MAY own and manage their own zones.
         Each local zone SHOULD be associated with a single GNS label,
   but users MAY choose to use longer names consisting of
   multiple labels.
         If the name of a locally managed zone matches the suffix
   of the name to be resolved,
   resolution SHOULD start from the respective local zone:<a href="#section-10-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10-7">
<pre>
Example name: www.example.org
Local zones:
fr = (d0,zk0)
gnu = (d1,zk1)
com = (d2,zk2)
...
=&gt; Entry zone: zk1
=&gt; Name to resolve from entry zone: www.example
</pre><a href="#section-10-7" class="pilcrow">¶</a>
</div>
<p id="section-10-8">
         Finally, additional "suffix to zone" mappings MAY be configured.
         Suffix to zone key mappings SHOULD be configurable through a local
         configuration file or database by the user or system administrator.
         The suffix MAY consist of multiple GNS labels concatenated with a
         ".". If multiple suffixes match the name to resolve, the longest
         matching suffix MUST BE used. The suffix length of two results
         cannot be equal, as this would indicate a misconfiguration.
   If both a locally managed zone and a configuration entry exist
   for the same suffix, the locally managed zone MUST have priority.<a href="#section-10-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10-9">
<pre>
Example name: www.example.org
Local suffix mappings:
gnu = zk0
example.org = zk1
example.com = zk2
...
=&gt; Entry zone: zk1
=&gt; Name to resolve from entry zone: www
</pre><a href="#section-10-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="security">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="security_crypto">
<section id="section-11.1">
        <h3 id="name-cryptography">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-cryptography" class="section-name selfRef">Cryptography</a>
        </h3>
<p id="section-11.1-1">
           The security of cryptographic systems depends on both the strength of
           the cryptographic algorithms chosen and the strength of the keys used
           with those algorithms.  The security also depends on the engineering
           of the protocol used by the system to ensure that there are no
           non-cryptographic ways to bypass the security of the overall system.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">
           This document concerns itself with the selection of cryptographic
           algorithms for use in GNS.
           The algorithms identified in this document are not known to be
           broken (in the cryptographic sense) at the current time, and
           cryptographic research so far leads us to believe that they are
           likely to remain secure into the foreseeable future.  However, this
           isn't necessarily forever, and it is expected that new revisions of
           this document will be issued from time to time to reflect the current
           best practices in this area.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<p id="section-11.1-3">
           GNS PKEY zone keys use ECDSA over Curve25519.
           This is an unconventional choice,
           as ECDSA is usually used with other curves.  However, traditional
           ECDSA curves are problematic for a range of reasons described in
           the Curve25519 and EdDSA papers.  Using EdDSA directly is also
           not possible, as a hash function is used on the private key which
           destroys the linearity that the GNU Name System depends upon.
           We are not aware of anyone suggesting that using Curve25519 instead
           of another common curve of similar size would lower the security of
           ECDSA.  GNS uses 256-bit curves because that way the encoded (public)
           keys fit into a single DNS label, which is good for usability.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<p id="section-11.1-4">
           In terms of crypto-agility, whenever the need for an updated cryptographic
           scheme arises to, for example, replace ECDSA over Curve25519 for
           PKEY records it may simply be introduced
           through a new record type. Such a new record type may then replace
           the delegation record type for future records.
           The old record type remains
           and zones can iteratively migrate to the updated zone keys.<a href="#section-11.1-4" class="pilcrow">¶</a></p>
<p id="section-11.1-5">
           In order to ensure ciphertext indistinguishability, care must be
           taken with respect to the initialization vector in the counter
           block. In our design, the IV is always the expiration time of the
           record block.
           For blocks with relative expiration times it is implicitly
           ensured that each time a block is published into the DHT, its IV is
           unique as the expiration time is calculated dynamically and increases
           monotonically.
           For blocks with absolute expiration times, the implementation
           MUST ensure that the expiration time is modified when the record
           data changes. For example. the expiration time may be increased
           by a single microsecond.<a href="#section-11.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security_abuse">
<section id="section-11.2">
        <h3 id="name-abuse-mitigation">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-abuse-mitigation" class="section-name selfRef">Abuse mitigation</a>
        </h3>
<p id="section-11.2-1">
           GNS names are UTF-8 strings. Consequently, GNS faces similar issues
           with respect to name spoofing as DNS does for internationalized
           domain names.
           In DNS, attackers may register similar sounding or looking
           names (see above) in order to execute phishing attacks.
           GNS zone administrators must take into account this attack vector and
           incorporate rules in order to mitigate it.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2-2">
           Further, DNS can be used to combat illegal content on the internet
           by having the respective domains seized by authorities.
           However, the same mechanisms can also be abused in order to impose
           state censorship, which ist one of the motivations behind GNS.
           Hence, such a seizure is, by design, difficult to impossible in GNS.
           In particular, GNS does not support WHOIS (<span>[<a href="#RFC3912" class="xref">RFC3912</a>]</span>).<a href="#section-11.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security_keymanagement">
<section id="section-11.3">
        <h3 id="name-zone-management">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-zone-management" class="section-name selfRef">Zone management</a>
        </h3>
<p id="section-11.3-1">
           In GNS, zone administrators need to manage and protect their zone
           keys. Once a zone key is lost it cannot be recovered. Once it is
           compromised it cannot be revoked (unless a revocation message was
           pre-calculated and is still available).
           Zone administrators, and for GNS this includes end-users, are
           required to responsibly and dilligently protect their cryptographic
           keys.  Offline signing is in principle possible, but GNS does not
           support separate zone signing and key-signing keys
           (as in <span>[<a href="#RFC6781" class="xref">RFC6781</a>]</span>) in order to provide usable security.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<p id="section-11.3-2">
           Similarly, users are required to manage their local root zone.
           In order to ensure integrity and availability or names, users must
           ensure that their local root zone information is not compromised or
           outdated.
           It can be expected that the processing of zone revocations and an
           initial root zone is provided with a GNS client implementation
           ("drop shipping").
           Extension and customization of the zone is at the full discretion of
           the user.<a href="#section-11.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security_dht">
<section id="section-11.4">
        <h3 id="name-impact-of-underlying-dht">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-impact-of-underlying-dht" class="section-name selfRef">Impact of underlying DHT</a>
        </h3>
<p id="section-11.4-1">
           This document does not specifiy the properties of the underlying
           distributed hash table (DHT) which is required by any GNS
           implementation. For implementors, it is important to note that
           the properties of the DHT are directly inherited by the
           GNS implementation. This includes both security as well as
           other non-functional properties such as scalability and performance.
           Implementors should take great care when selecting or implementing
           a DHT for use in a GNS implementation.
           DHTs with strong security and performance guarantees exist
           <span>[<a href="#R5N" class="xref">R5N</a>]</span>.
           It should also be taken into consideration that GNS implementations
           which build upon different DHT overlays are unlikely to be
           interoperable with each other.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security_rev">
<section id="section-11.5">
        <h3 id="name-revocations">
<a href="#section-11.5" class="section-number selfRef">11.5. </a><a href="#name-revocations" class="section-name selfRef">Revocations</a>
        </h3>
<p id="section-11.5-1">
           Zone administrators are advised to pre-generate zone revocations
           and securely store the revocation information in case the zone
           key is lost, compromised or replaced in the furture.
           Pre-calculated revocations may become invalid due to expirations
           or protocol changes such as epoch adjustments.
           Consequently, implementors and users must make precautions in order
           to manage revocations accordingly.<a href="#section-11.5-1" class="pilcrow">¶</a></p>
<p id="section-11.5-2">
           Revocation payloads do NOT include a 'new' key for key replacement.
           Inclusion of such a key would have two major disadvantages:<a href="#section-11.5-2" class="pilcrow">¶</a></p>
<p id="section-11.5-3">
           If revocation is used after a private key was compromised,
           allowing key replacement would be dangerous: if an
           adversary took over the private key, the adversary could then
           broadcast a revocation with a key replacement. For the replacement,
           the compromised owner would have no chance to issue even a
           revocation. Thus, allowing a revocation message to replace a private
           key makes dealing with key compromise situations worse.<a href="#section-11.5-3" class="pilcrow">¶</a></p>
<p id="section-11.5-4">
           Sometimes, key revocations are used with the objective of changing
           cryptosystems. Migration to another cryptosystem by replacing keys
           via a revocation message would only be secure as long as both
           cryptosystems are still secure against forgery. Such a planned,
           non-emergency migration to another cryptosystem should be done by
           running zones for both ciphersystems in parallel for a while. The
           migration would conclude by revoking the legacy zone key only once
           it is deemed no longer secure, and hopefully after most users have
           migrated to the replacement.<a href="#section-11.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="gana">
<section id="section-12">
      <h2 id="name-gana-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-gana-considerations" class="section-name selfRef">GANA Considerations</a>
      </h2>
<p id="section-12-1">
         GANA <span>[<a href="#GANA" class="xref">GANA</a>]</span>
         is requested to create an "GNU Name System Record Types" registry.
         The registry shall record for each entry:<a href="#section-12-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12-2.1">Name: The name of the record type (case-insensitive ASCII
           string, restricted to alphanumeric characters<a href="#section-12-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.2">Number: 32-bit, above 65535<a href="#section-12-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.3">Comment: Optionally, a brief English text describing the purpose of
           the record type (in UTF-8)<a href="#section-12-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.4">Contact: Optionally, the contact information of a person to contact for
           further information<a href="#section-12-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-12-2.5">References: Optionally, references describing the record type
           (such as an RFC)<a href="#section-12-2.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-12-3">
         The registration policy for this sub-registry is "First Come First
         Served", as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.
         GANA is requested to populate this registry as follows:<a href="#section-12-3" class="pilcrow">¶</a></p>
<div id="figure_rrtypenums">
<figure id="figure-20">
        <div class="artwork art-text alignLeft" id="section-12-4.1">
<pre>
Number | Name    | Contact | References | Description
-------+---------+---------+------------+-------------------------
65536  | PKEY    | N/A     | [This.I-D] | GNS zone delegation
65537  | NICK    | N/A     | [This.I-D] | GNS zone nickname
65538  | LEHO    | N/A     | [This.I-D] | GNS legacy hostname
65539  | VPN     | N/A     | [This.I-D] | VPN resolution
65540  | GNS2DNS | N/A     | [This.I-D] | Delegation to DNS
65541  | BOX     | N/A     | [This.I-D] | Boxed record
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a></figcaption></figure>
</div>
<p id="section-12-5">
         GANA is requested to amend the "GNUnet Signature Purpose" registry
         as follows:<a href="#section-12-5" class="pilcrow">¶</a></p>
<div id="figure_purposenums">
<figure id="figure-21">
        <div class="artwork art-text alignLeft" id="section-12-6.1">
<pre>
Purpose | Name            | References | Description
--------+-----------------+------------+--------------------------
  3     | GNS_REVOCATION  | [This.I-D] | GNS zone key revocation
 15     | GNS_RECORD_SIGN | [This.I-D] | GNS record set signature
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a></figcaption></figure>
</div>
</section>
</div>
<section id="section-13">
      <h2 id="name-test-vectors">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="section-13-1">
         The following represents a test vector for a record set with a DNS
         record of type "A" as well as a GNS record of type "PKEY"
         under the label "test".<a href="#section-13-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-13-2">
<pre>

Zone private key (d, little-endian, with ztype prepended):
0001000020110ab2
807d702f7b86dc30
6c37e8e2e0a5dbb2
7ae934727d9ca07d
69c73579

Zone identifier (zid):
0001000063db8bf0
44212617ce5db4fc
7c06fb9e35b2e177
3b4b76c05b42a1e7
17d018c6

Encoded zone identifier (zkl = zTLD):
000G0033VE5Z0H114RBWWQDMZHY0DYWY6PSE2XSV9DVC0PT2M7KHFM0RRR

Label: test
RRCOUNT: 2

Record #0
EXPIRATION: 1602865000130231
DATA_SIZE: 4
TYPE: 1
FLAGS: 0
DATA:
01020304

Record #1
EXPIRATION: 1602865000130231
DATA_SIZE: 32
TYPE: 65536
FLAGS: 2
DATA:
00010000796f4a8b
66d7780f62f46604
24c750295f31674d
052a4989cf0779a7

RDATA:
0005b1cc16f4a6b7
0000000400000001
0000000001020304
0005b1cc16f4a6b7
0000002000010000
0000000200010000
796f4a8b66d7780f
62f4660424c75029
5f31674d052a4989
cf0779a700000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000

BDATA:
4f20986bde1fbbed
b57196c1c23e35e9
f1ee62207de81297
0c2b370a9980042f
e8296cdd8ca66d69
11ebb2f3b2550959
7cb781ef56ac07d1
7c5dd0903bb94c67
c07e100079f59db3
3363fe110f435838
ef482e60b527f553
2ee435e4c0525439
3965d3dbe72e7c92
9bb4172b3bda7270
06c33578682cb212
23ac2cf389a4fbab
bb8cb55e

RRBLOCK:
000100007bc2eb40
ef056b05a5a84c35
241ca7190284a4a4
f5afdae14e8b784c
4b516dd6082d7969
2d2bbcb1328bc1df
270b2c02693bdaa9
f4d496dd850068d4
3a471fac0156b902
3536e54960fac47b
58762d82c5ad8e7f
34a121819c7ca75d
64c78d3a00000094
0000000f0005b1cc
16f4a6b74f20986b
de1fbbedb57196c1
c23e35e9f1ee6220
7de812970c2b370a
9980042fe8296cdd
8ca66d6911ebb2f3
b25509597cb781ef
56ac07d17c5dd090
3bb94c67c07e1000
79f59db33363fe11
0f435838ef482e60
b527f5532ee435e4
c05254393965d3db
e72e7c929bb4172b
3bda727006c33578
682cb21223ac2cf3
89a4fbabbb8cb55e

</pre><a href="#section-13-2" class="pilcrow">¶</a>
</div>
<p id="section-13-3">
         The following is an example revocation for a zone:<a href="#section-13-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-13-4">
<pre>

Zone private key (d, little-endian scalar, with ztype prepended):
00010000a065bf68
07cb3d90d10394a9
a56693e07087ad35
24f8e303931d4ade
946dc447

Zone identifier (zid):
00010000d06ab6d9
14e8a8064609b2b3
cb661c586042adcb
0dc5faeb61994d25
5ebdca72

Encoded zone identifier (zkl = zTLD):
000G006GDAVDJ578N034C2DJPF5PC72RC11AVJRDRQXEPRCS9MJNXFEAE8

Difficulty (5 base difficulty + 2 epochs): 7

Proof:
0005b13f536e2b0e
0000395d1827c000
5caaeaa2b955d82c
5caaeaa2b955da02
5caaeaa2b955daf0
5caaeaa2b955db20
5caaeaa2b955db2d
5caaeaa2b955dba1
5caaeaa2b955dba9
5caaeaa2b955dbc2
5caaeaa2b955dbc8
5caaeaa2b955dbd1
5caaeaa2b955dbf7
5caaeaa2b955dc0e
5caaeaa2b955dc54
5caaeaa2b955dc8c
5caaeaa2b955dca5
5caaeaa2b955dcb5
5caaeaa2b955dcf8
5caaeaa2b955dd47
5caaeaa2b955dd91
5caaeaa2b955dd98
5caaeaa2b955dd99
5caaeaa2b955ddc4
5caaeaa2b955de7f
5caaeaa2b955de80
5caaeaa2b955de92
5caaeaa2b955ded3
5caaeaa2b955df1a
5caaeaa2b955df77
5caaeaa2b955dfdf
5caaeaa2b955e06e
5caaeaa2b955e08d
5caaeaa2b955e0c4
00010000d06ab6d9
14e8a8064609b2b3
cb661c586042adcb
0dc5faeb61994d25
5ebdca7206b11f93
41f4e1649976c421
b1efe668a44becbe
5a9f76804adb6f6e
2cd16de00d81841d
cbd135aacad3bdab
3f2209bd10d55cc1
c7aed9a9bd53a1f6
cae1789d

</pre><a href="#section-13-4" class="pilcrow">¶</a>
</div>
</section>
<section id="section-14">
      <h2 id="name-normative-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC1034">[RFC1034]</dt>
      <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
      <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2782">[RFC2782]</dt>
      <dd>
<span class="refAuthor">Gulbrandsen, A.</span>, <span class="refAuthor">Vixie, P.</span>, and <span class="refAuthor">L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time datetime="2000-02" class="refDate">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2782">https://www.rfc-editor.org/info/rfc2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
      <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3686">[RFC3686]</dt>
      <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 3686</span>, <span class="seriesInfo">DOI 10.17487/RFC3686</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3686">https://www.rfc-editor.org/info/rfc3686</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3826">[RFC3826]</dt>
      <dd>
<span class="refAuthor">Blumenthal, U.</span>, <span class="refAuthor">Maino, F.</span>, and <span class="refAuthor">K. McCloghrie</span>, <span class="refTitle">"The Advanced Encryption Standard (AES) Cipher Algorithm in the SNMP User-based Security Model"</span>, <span class="seriesInfo">RFC 3826</span>, <span class="seriesInfo">DOI 10.17487/RFC3826</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3826">https://www.rfc-editor.org/info/rfc3826</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3912">[RFC3912]</dt>
      <dd>
<span class="refAuthor">Daigle, L.</span>, <span class="refTitle">"WHOIS Protocol Specification"</span>, <span class="seriesInfo">RFC 3912</span>, <span class="seriesInfo">DOI 10.17487/RFC3912</span>, <time datetime="2004-09" class="refDate">September 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3912">https://www.rfc-editor.org/info/rfc3912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
      <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
      <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5890">[RFC5890]</dt>
      <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework"</span>, <span class="seriesInfo">RFC 5890</span>, <span class="seriesInfo">DOI 10.17487/RFC5890</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5890">https://www.rfc-editor.org/info/rfc5890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5891">[RFC5891]</dt>
      <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names in Applications (IDNA): Protocol"</span>, <span class="seriesInfo">RFC 5891</span>, <span class="seriesInfo">DOI 10.17487/RFC5891</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5891">https://www.rfc-editor.org/info/rfc5891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6781">[RFC6781]</dt>
      <dd>
<span class="refAuthor">Kolkman, O.</span>, <span class="refAuthor">Mekking, W.</span>, and <span class="refAuthor">R. Gieben</span>, <span class="refTitle">"DNSSEC Operational Practices, Version 2"</span>, <span class="seriesInfo">RFC 6781</span>, <span class="seriesInfo">DOI 10.17487/RFC6781</span>, <time datetime="2012-12" class="refDate">December 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6781">https://www.rfc-editor.org/info/rfc6781</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6895">[RFC6895]</dt>
      <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Domain Name System (DNS) IANA Considerations"</span>, <span class="seriesInfo">BCP 42</span>, <span class="seriesInfo">RFC 6895</span>, <span class="seriesInfo">DOI 10.17487/RFC6895</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6895">https://www.rfc-editor.org/info/rfc6895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6979">[RFC6979]</dt>
      <dd>
<span class="refAuthor">Pornin, T.</span>, <span class="refTitle">"Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">RFC 6979</span>, <span class="seriesInfo">DOI 10.17487/RFC6979</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6979">https://www.rfc-editor.org/info/rfc6979</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7539">[RFC7539]</dt>
      <dd>
<span class="refAuthor">Nir, Y.</span> and <span class="refAuthor">A. Langley</span>, <span class="refTitle">"ChaCha20 and Poly1305 for IETF Protocols"</span>, <span class="seriesInfo">RFC 7539</span>, <span class="seriesInfo">DOI 10.17487/RFC7539</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7539">https://www.rfc-editor.org/info/rfc7539</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
      <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
      <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
      <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GANA">[GANA]</dt>
      <dd>
<span class="refAuthor">GNUnet e.V.</span>, <span class="refTitle">"GNUnet Assigned Numbers Authority (GANA)"</span>, <time datetime="2020-04" class="refDate">April 2020</time>, <span>&lt;<a href="https://gana.gnunet.org/">https://gana.gnunet.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GNS">[GNS]</dt>
      <dd>
<span class="refAuthor">Wachs, M.</span>, <span class="refAuthor">Schanzenbach, M.</span>, and <span class="refAuthor">C. Grothoff</span>, <span class="refTitle">"A Censorship-Resistant, Privacy-Enhancing and Fully Decentralized Name System"</span>, <time datetime="2014" class="refDate">2014</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-319-12280-9_9">https://doi.org/10.1007/978-3-319-12280-9_9</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="R5N">[R5N]</dt>
      <dd>
<span class="refAuthor">Evans, N. S.</span> and <span class="refAuthor">C. Grothoff</span>, <span class="refTitle">"R5N: Randomized recursive routing for restricted-route networks"</span>, <time datetime="2011" class="refDate">2011</time>, <span>&lt;<a href="https://doi.org/10.1109/ICNSS.2011.6060022">https://doi.org/10.1109/ICNSS.2011.6060022</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Argon2">[Argon2]</dt>
      <dd>
<span class="refAuthor">Biryukov, A.</span>, <span class="refAuthor">Dinu, D.</span>, <span class="refAuthor">Khovratovich, D.</span>, and <span class="refAuthor">S. Josefsson</span>, <span class="refTitle">"The memory-hard Argon2 password hash and proof-of-work function"</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-argon2/">https://datatracker.ietf.org/doc/draft-irtf-cfrg-argon2/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MODES">[MODES]</dt>
      <dd>
<span class="refAuthor">Dworkin, M.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Methods and Techniques"</span>, <time datetime="2001-12" class="refDate">December 2001</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-38A">https://doi.org/10.6028/NIST.SP.800-38A</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="CrockfordB32">[CrockfordB32]</dt>
      <dd>
<span class="refAuthor">Douglas, D.</span>, <span class="refTitle">"Base32"</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.crockford.com/base32.html">https://www.crockford.com/base32.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Tor224">[Tor224]</dt>
      <dd>
<span class="refAuthor">Goulet, D.</span>, <span class="refAuthor">Kadianakis, G.</span>, and <span class="refAuthor">N. Mathewson</span>, <span class="refTitle">"Next-Generation Hidden Services in Tor"</span>, <time datetime="2013-11" class="refDate">November 2013</time>, <span>&lt;<a href="https://gitweb.torproject.org/torspec.git/tree/proposals/224-rend-spec-ng.txt#n2135">https://gitweb.torproject.org/torspec.git/tree/proposals/224-rend-spec-ng.txt#n2135</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ed25519">[ed25519]</dt>
      <dd>
<span class="refAuthor">Bernstein, D.</span>, <span class="refAuthor">Duif, N.</span>, <span class="refAuthor">Lange, T.</span>, <span class="refAuthor">Schwabe, P.</span>, and <span class="refAuthor">B. Yang</span>, <span class="refTitle">"High-Speed High-Security Signatures"</span>, <time datetime="2011" class="refDate">2011</time>, <span>&lt;<a href="http://link.springer.com/chapter/10.1007/978-3-642-23951-9_9">http://link.springer.com/chapter/10.1007/978-3-642-23951-9_9</a>&gt;</span>. </dd>
<dd class="break"></dd></dl>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Martin Schanzenbach</span></div>
<div dir="auto" class="left"><span class="org">GNUnet e.V.</span></div>
<div dir="auto" class="left"><span class="street-address">Boltzmannstrasse 3</span></div>
<div dir="auto" class="left">
<span class="postal-code">85748</span> <span class="locality">Garching</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:schanzen@gnunet.org" class="email">schanzen@gnunet.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christian Grothoff</span></div>
<div dir="auto" class="left"><span class="org">Berner Fachhochschule</span></div>
<div dir="auto" class="left"><span class="street-address">Hoeheweg 80</span></div>
<div dir="auto" class="left">CH-<span class="postal-code">2501</span> <span class="locality">Biel/Bienne</span>
</div>
<div dir="auto" class="left"><span class="country-name">Switzerland</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:grothoff@gnunet.org" class="email">grothoff@gnunet.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Bernd Fix</span></div>
<div dir="auto" class="left"><span class="org">GNUnet e.V.</span></div>
<div dir="auto" class="left"><span class="street-address">Boltzmannstrasse 3</span></div>
<div dir="auto" class="left">
<span class="postal-code">85748</span> <span class="locality">Garching</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fix@gnunet.org" class="email">fix@gnunet.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
