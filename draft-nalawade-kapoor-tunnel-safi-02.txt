Network Working Group                               Gargi Nalawade
Internet Draft                                      Ruchi Kapoor
Expires: April 2005                                 Dan Tappan

                                                    Cisco Systems



                              Tunnel SAFI

             draft-nalawade-kapoor-tunnel-safi-02.txt



Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he is aware have been
   or will be disclosed, and any of which he becomes aware will be
   disclosed, in accordance with RFC 3668.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

Abstract

   There is a need for Tunnel end-point discovery within and across
   Autonomous Systems. BGP is the only protocol that is widely-spoken
   across Autonomous Systems and can carry this information. This
   document defines how BGP speakers can convey Tunnel end-point
   reachability information.

1. Introduction

   Two end-points of a Tunnel need to know the end-point information and



draft-nalawade-kapoor-tunnel-safi-02.txt                                [Page 1]





Internet Draft draft-nalawade-kapoor-tunnel-safi-02.txt             October 2004


   its binding to a network address at the remote point. Normally, this
   can be statically shared and configured. But in case of a large
   network where there may be a need for a large number of tunnels, the
   number of tunnel end-points that need to be exchanged and maintained,
   grows. It then needs to be exchanged and maintained using an inter-AS
   protocol.

2. The Tunnel SAFI

   This document defines a new SAFI called the Tunnel SAFI.  The <AFI,
   SAFI> [IANA-AFI] [IANA-SAFI] value pair used to identify this SAFI is
   (AFI=1, SAFI=TBD) for the IPv4 AFI and (AFI=2, SAFI=TBD) for the IPv6
   AFI.

   For BGP Speakers supporting [BGP-4], the tunnel end point address
   will be carried as an NLRI in the MP_REACH attribute for this SAFI.
   For BGP Speakers suppprting [BGP-UPDATEv2], the tunnel end point
   address will be carried as an NLRI in the NLRI section of the BGP
   Updatev2 message.

   The NLRI will be encoded as a 2-octet Identifier followed by the NLRI
   format as specified by the respective AFI. The Identifier will
   contain a 2-octet Identifier that identifies the Tunnel end point
   being advertised.  This Identifier enables multiple Tunnel end-points
   to share the same network address, thus conserving the number of
   addresses needed to be configured by the operator on each of the
   Tunnel-endpoints.

3. BGP Attribute

   The BGP SSA Attribute [BGP-SSA] will be used to carry the Tunnel
   end-point information.

   The Value Field of the BGP SSA Attribute, MUST contain at least one
   of the following valid Type codes for this SAFI. It MAY contain one
   or more TLVs with these Type codes.

   Type 1: L2TPv3 Tunnel information

   Type 2: mGRE Tunnel information

   Type 3: IPSec Tunnel information

   Type 4: MPLS Tunnel information


3.1. L2TPv3 Tunnel information TLV




draft-nalawade-kapoor-tunnel-safi-02.txt                                [Page 2]





Internet Draft draft-nalawade-kapoor-tunnel-safi-02.txt             October 2004


   The L2TPv3 Tunnel Information TLV has a type of 1.  The value part of
   the L2TPv3 Tunnel Information Type contains the following :

               - Preference (2 Octets)
               - Flags (1 Octet)
               - Cookie Length (1 Octet)
               - Session ID (4 Octets)
               - Cookie     (Variable)

   The L2TPv3 Tunnel Information TLV looks as follows :



         0                   1
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Type = 0x01              |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Length  (2 octets)       |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Preference (2 octets)    |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |S|    Flags    | Cookie Length |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Session ID (4 Octets)    |
        |                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                               |
        |      Cookie (Variable)        |
        |                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




   where

   Length A 2 Octet field that specifies the length of the L2TPv3
   attribute in octets. The value contained in this Length field MUST
   not exceed the total length of the BGP SSA [BGP-SSA] Attribute minus
   the total length of any prior TLVs.

   Preference A 2 Octet field containing a Preference associated with
   the TLV. The Preference value indicates a preferred ordering of
   tunneling encapsulations according to the sender. The recipient of
   the information SHOULD take the sender's preference into account in
   selecting which encapsulation it will use. A higher value indicates a
   higher preference.



draft-nalawade-kapoor-tunnel-safi-02.txt                                [Page 3]





Internet Draft draft-nalawade-kapoor-tunnel-safi-02.txt             October 2004


   Flags A 1 Octet field containing flag-bits. The leftmost bit
   indicates whether Sequence numbering is to be used or not. The
   remaining bits are reserved for future use.

   Cookie Length Cookie Length is a 1 Octet field that contains the
   length of the Variable length Cookie.

   Session ID A 4 Octet field containing a non-zero identifier for a
   session.

   Cookie Cookie is a variable length (maximum 64 bits), value used by
   L2TPv3 to check the association of a received data message with the
   session identified by the Session ID.

   The default value of the Length Field for the L2TPv3 Tunnel
   information TLV is between 8 and 16 bytes, depending on the length of
   the Cookie field specified in Cookie length. If the length of the TLV
   is greater than that value, the subsequent portion of the Value field
   contains one or more sub-TLVs.

   A Sub-TLV when present is of the following format :


         0                   1
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |  Sub-Type     | Length        |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Value (Variable)         |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



   where  Sub-Type & Length are of 1-Octet each & the Value field is
   variable as specified by the Length.

3.2. mGRE Tunnel Information TLV

   The mGRE Tunnel Information Type has a Type 2.  The value part of the
   mGRE Tunnel Information Type contains the following :

               - Preference (2 Oc
tets)
               - Flags (1 Octet)
               - mGRE Key   (0 or 4 Octets)

   The mGRE Tunnel Information TLV looks as follows :





draft-nalawade-kapoor-tunnel-safi-02.txt                                [Page 4]





Internet Draft draft-nalawade-kapoor-tunnel-safi-02.txt             October 2004


         0                   1
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Type = 0x02              |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Length  (2 octets)       |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Preference (2 octets)    |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |S|K|  Flags    |               |
        +-+-+-+-+-+-+-+-+               |
        |      mGRE Key (4 Octets)      |
        |                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



   Length A 2 Octet field that specifies the length of the mGRE
   information in octets. The value contained in this Length field MUST
   not exceed the total length of the BGP SSA [BGP-SSA] Attribute minus
   the total length of any prior TLVs.

   Preference A 2 Octet field containing a Preference associated with
   the TLV. The Preference value indicates a preferred ordering of
   tunneling encapsulations according to the sender. The recipient of
   the information SHOULD take the sender's preference into account in
   selecting which encapsulation it will use. A higher value indicates a
   higher preference.


   Flags A 1 Octet field containing flag-bits. The leftmost bit
   indicates whether Sequence numbering is to be used or not. The 2nd
   bit indicates whether an mGRE Key is present or not. The remaining
   bits are reserved for future use.

   mGRE Key A 4 Octet field containing an optional mGRE Key.

   If the Length field of the TLV contains a value greater than 3 Octets
   plus the value specified in the Key Length, the subsequent portion of
   the Value field contains one or more sub-TLVs.

   A Sub-TLV when present is of the following format :



         0                   1
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



draft-nalawade-kapoor-tunnel-safi-02.txt                                [Page 5]





Internet Draft draft-nalawade-kapoor-tunnel-safi-02.txt             October 2004


        |  Sub-Type     | Length        |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      Value (Variable)         |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+



   where  Sub-Type & Length are of 1-Octet each & the Value field is
   variable as specified by the Length.

3.3. IPSec Tunnel Information TLV

   The IPSec Tunnel Information Type has a Type 3.  The format of the
   IPSec Tunnel Information TLV is TBD.

3.4. MPLS TLV

   The MPLS TLV has a Type 4.  The format of the MPLS TLV is TBD.

4. Capability Advertisement

   A BGP speaker that wishes to exchange the IPv4-Tunnel SAFI, MUST use
   the MP_EXT Capability Code as defined in [BGP-MP], to advertise the
   corresponding (AFI, SAFI) pair.

   A BGP speaker MAY participate in the distribution of IPv4-Tunnel
   information.

5. Operation

   A BGP Speaker that receives the Capability for the IPv4-Tunnel or
   IPv6-Tunnel SAFI, MAY advertise the IPv4-Tunnel or IPv6-Tunnel
   prefixes to that peer respectively.

   In the UPDATE message for this SAFI sent to a peer, a BGP speaker
   MUST only advertise the SAFI-specific attribute [BGP-SSA] TLVs that
   are defined as valid for this SAFI.

   If a BGP Speaker receives an SSA TLV that it does not recognize, it
   will accept it and propagate it to other peers.

6. Deployment Considerations

   In order for the Tunnels to come up between two end-points, the BGP
   Speakers advertising the Tunnel end-points using the Ipv4 Tunnel
   SAFI, MUST exchange at least one common encapsulation option.

7. Security Considerations



draft-nalawade-kapoor-tunnel-safi-02.txt                                [Page 6]





Internet Draft draft-nalawade-kapoor-tunnel-safi-02.txt             October 2004


   This extension to BGP does not change the underlying security issues.

8. Acknowledgements

   We would like to thank Jim Guichard, Arjun Sreekantiah, Shyam Suri,
   Chandrashekhar Appanna, John Scudder and Mark Townsley for their
   comments and suggestions.

9. References

   [IANA-AFI] http://www.iana.org/assignments/address-family-numbers

   [IANA-SAFI] http://www.iana.org/assignments/safi-namespace

   [BGP-4]  Rekhter, Y. and T. Li (editors), "A Border Gateway Protocol
   4 (BGP-4)", Internet Draft draft-ietf-idr-bgp4-22.txt, February 2004.

   [BGP-CAP] Chandra, R., Scudder, J., "Capabilities Advertisement with
   BGP-4", draft-ietf-idr-rfc2842bis-02.txt, April 2002.

   [BGP-SSA] Kapoor R., Nalawade G., "BGPv4 SAFI-Specific Attribute",
   draft-nalawade-kapoor-bgp-ssa-02.txt, work in progress.

   [MULTI-BGP] Bates et al, "Multiprotocol Extensions for BGP-4", draft-
   ietf-idr-rfc2858bis-02.txt, work in progress.

   [BGP-UPDATEv2] Nalawade G.et al, "BGPv4 Update-v2 Message", draft-
   nalawade-bgp-update-v2-01.txt, work in progress.

10. Authors' Addresses

   Gargi Nalawade
   Cisco Systems, Inc
   170 West Tasman Drive
   San Jose, CA 95134
   mailto:gargi@cisco.com

   Ruchi Kapoor
   Cisco Systems, Inc
   170 West Tasman Drive
   San Jose, CA 95134
   mailto:ruchi@cisco.com

   Dan Tappan
   Cisco Systems, Inc
   170 West Tasman Drive
   San Jose, CA 95134
   mailto:tappan@cisco.com



draft-nalawade-kapoor-tunnel-safi-02.txt                                [Page 7]





Internet Draft draft-nalawade-kapoor-tunnel-safi-02.txt             October 2004


11. Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights. Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementors or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard. Please address the information to the IETF Executive
   Director.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard. Please address the information to the IETF at ietf-
   ipr@ietf.org.

12. Full Copyright Statement

   Copyright (C) The Internet Society (year). This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and
   except as set forth therein, the authors retain all their rights."

   "This document and the information contained herein are provided on
   an "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE
   REPRESENTS OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE
   INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

13. Expiratio
n Date

   This memo is filed as <draft-nalawade-kapoor-tunnel-safi-02.txt>, and
   expires April, 2004.



draft-nalawade-kapoor-tunnel-safi-02.txt                                [Page 8]