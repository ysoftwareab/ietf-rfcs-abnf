<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>OAuth Additional Security Considerations</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Laying Out the Issues">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 On Granting Access">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 On Discovering and Revoking Access">
<link href="#rfc.section.3" rel="Chapter" title="3 Recommendations">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The Open Authentication Protocol (OAuth) specifies a security protocol that involves significant end-user interaction -- the model is based on having the end-user approve the authorization that is being requested.  That aspect makes the user interaction a part of the security model, and raises additional security considerations beyond those that are typical for client/server protocols.  This document describes those considerations.  " />
  <meta name="description" content="The Open Authentication Protocol (OAuth) specifies a security protocol that involves significant end-user interaction -- the model is based on having the end-user approve the authorization that is being requested.  That aspect makes the user interaction a part of the security model, and raises additional security considerations beyond those that are typical for client/server protocols.  This document describes those considerations.  " />
  <meta name="keywords" content="IETF" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">OAuth working group</td>
<td class="right">B. Leiba</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Huawei Technologies</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">March 28, 2011</td>
</tr>
<tr>
<td class="left">Expires: September 29, 2011</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">OAuth Additional Security Considerations<br />
  <span class="filename">draft-leiba-oauth-additionalsecurityconsiderations-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The Open Authentication Protocol (OAuth) specifies a security protocol that involves significant end-user interaction -- the model is based on having the end-user approve the authorization that is being requested.  That aspect makes the user interaction a part of the security model, and raises additional security considerations beyond those that are typical for client/server protocols.  This document describes those considerations.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 29, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Laying Out the Issues</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">On Granting Access</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">On Discovering and Revoking Access</a>
</li>
<li>3.   <a href="#rfc.section.3">Recommendations</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Acknowledgements</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The Open Authentication Protocol <a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a> specifies a security protocol used to authorize one service to act on behalf of a user to a second service (to give a somewhat oversimplified description).  For example: </p>

<ul>
<li>A photo-printing service needs authorization to retrieve photos from a user's private photo albums, stored with a photo-sharing service.  </li>
<li>A social-network service needs authorization to read a user's personal address book, stored in the email service she uses.  </li>
</ul>

<p> In most use cases, part of the protocol involves prompting the user to log in to the second service and accept the authorization request.  That aspect makes the user interaction a part of the security model, and raises additional security considerations beyond those that are typical for client/server protocols.  </p>
<p></p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#issues" id="issues">Laying Out the Issues</a>
</h1>
<p id="rfc.section.2.p.1">The OAuth version 2 spec <a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a> describes, in its introduction, a typical example of the use of OAuth: </p>

<ul class="empty"><li>For example, a web user (resource owner) can grant a printing service (client) access to her protected photos stored at a photo sharing service (resource server), without sharing her username and password with the printing service.  Instead, she authenticates directly with a server trusted by the photo sharing service (authorization server) which issues the printing service delegation-specific credentials (access token).  </li></ul>

<p> </p>
<p id="rfc.section.2.p.2">In such a typical case: </p>

<ol>
<li>The user (resource owner) visits the client's web site (the printing service) and makes a web request ("Print a photo from my photo-sharing site.") </li>
<li>The client, behind the scenes and not apparent to the user, requests authorization from the resource server, and is given a request token.  </li>
<li>The client sends a response to the user's web request.  The response redirects the user's web browser to the authorization server (of the photo-sharing service) and passes the server the request token.  </li>
<li>The authorization server prompts the user to accept the requested authorization.  The user sees this authorization prompt in the browser, and it appears to be the first response to the original request.  </li>
<li>The user accepts the authorization request.  She might have to log in first, or an existing login might be used.  Typically, she will click a visual "button" that says "Accept", "Authorize", "OK", or the like.  </li>
<li>The authorization server sends a response to that action.  The response redirects the user's web browser to the client web server (the printing service) and passes the server an access token.  </li>
<li>The client (the printing service) uses the access token behind the scenes to contact the resource server (the photo-sharing service) and to perform the service for the user.  The user is given a response that indicates that the request is in the works.  </li>
</ol>

<p> </p>
<p id="rfc.section.2.p.3">From the user's point of view, the interaction has seemed simple; this is a great benefit of OAuth.  But there was actually a reasonable amount of complexity "behind the scenes" that the user did not understand, and that leaves us with a conflicted situation: </p>

<ol>
<li>the user shouldn't have to understand all of the behind-the-scenes detail, but </li>
<li>the user needs to understand what she's being asked to authorize, in order that she might make the right security decision about the request.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> On Granting Access</h1>
<p id="rfc.section.2.1.p.1">Some of the things a user might need to understand to make the decision include </p>

<ul>
<li>Who is requesting the access.  This can be a tricky point.  The authorization server might likely know only the domain name, or even just the IP address of the client that's making the request.  The user *might* be able to make some sense of the domain name, but really would do better with a real, human-readable name that matches what she calls the service.  And the authorization server has no cause to trust any human-readable string the requestor gives.  <br><br> A DKIM-like digital signature <a href="#I-D.crocker-dkim-doseta">[I-D.crocker-dkim-doseta]</a> along with a mapping of known signing identities to readable names can be a great help here.  But be aware that any name provided by the client is open to abuse by a bad actor, and should not be trusted.  </li>
<li>Who will be granting the access.  It's easy to leave this out, with the idea that it should be self-evident.  The problem is that if a client is requesting access beyond what it should be asking for, it might be asking the wrong entity as well.  If a user asks for a photo to be printed, the requested authorization should not be to the user's email account.  </li>
<li>The specific access that is being requested.  This might not always be obvious, depending upon the request, and depending upon how the prompt is worded.  "Print a photo for me," will likely translate into read access to the photo.  For "Auto-adjust the contrast before printing, and save the adjusted version," the service will need access to update the photo or to save a new copy.  <br><br> "Send e-cards to my family on their birthdays," might translate into authority to send email on her behalf, plus read access to her address book.  The address book access is somewhat less evident, and leaves a different avenue for abuse.  </li>
<li>The scope of the access.  If she wants to print a single photo, then read access to just that photo will do.  If she wants to print all photos in an album, she'll need to grant read access to the whole album.  </li>
<li>The duration of the access.  If she just wants to print a photo, then a single read access to the photo should be enough.  If she wants the service to automatically print all her new photos every week, persistent, long-term read access to her "new uploads" photo album might work.  </li>
</ul>

<p> </p>
<p id="rfc.section.2.1.p.2">Because end-users are accepting or rejecting the authorization that the client service is requesting, their understanding of what they're being asked is important to the overall security of the system.  And because end-users often know nothing about computer security, the way these various points are presented to them is a critical piece of the security design.  That is, the prompts and the user's understanding of them and response to them have to be considered part of the security model.  </p>
<p id="rfc.section.2.1.p.3">This is especially important because the user is thinking in terms of a task, while the authorization system is working in terms of what accesses are needed for the task.  The mapping between the two is often not clear to the user, and the user's trust of the service requesting the access might be tenuous.  </p>
<p id="rfc.section.2.1.p.4">We need to avoid asking users questions they're not prepared or qualified to answer.  Unfortunately, most security-related questions fall into that category.  The more we can put the request into plain language, and the better we can explain, in clear, simple terms what's being asked and what the ramifications of it are, the more likely it is that we'll be working with informed consent and will have a chance at fending off attacks on the system.  </p>
<p id="rfc.section.2.1.p.5">Consider the difference, for example, between the following two prompts.  </p>
<div id="#rfc.figure.1"></div>
<pre>
    -----------------------------------------------------------------
    Give printpix.example r/o access to
    http://photoshare.example/usr213554/fnxgrptl/250/43/342500134.jpg

    &#160;&#160;&#160;&#160; (OK) &#160;&#160;&#160;&#160; (Cancel)
    -----------------------------------------------------------------
                             Example 1a
                </pre>
<div id="#rfc.figure.2"></div>
<pre>
    -----------------------------------------------------------------
    The Print My Pix service (printpix.example) is asking PhotoShare
    for access to your photo titled "Ralph in the park" in album
    "New York". Granting access will allow Print My Pix to read, but
    not alter nor delete, your photo.  Access will be allowed one
    time only.

    For a more detailed explanation of what this means, [click here].

    Do you want to allow access?

    &#160;&#160;&#160;&#160; (Yes) &#160;&#160;&#160;&#160; (No)
    -----------------------------------------------------------------
                             Example 1b
                </pre>
<p id="rfc.section.2.1.p.6">The second prompt is wordier, but might be easier for most people to understand.  Some of the technical details (such as the URL to the photo in question) are available at a click, for users who want more details.  </p>
<p id="rfc.section.2.1.p.7">Note how that difference appears to a user when the Print My Pix service is actually abusive, and tries to get broader access than it needs.  </p>
<div id="#rfc.figure.3"></div>
<pre>
    -----------------------------------------------------------------
    Give printpix.example r/w access to
    http://photoshare.example/usr213554/

    &#160;&#160;&#160;&#160; (OK) &#160;&#160;&#160;&#160; (Cancel)
    -----------------------------------------------------------------
                             Example 2a
                </pre>
<div id="#rfc.figure.4"></div>
<pre>
    -----------------------------------------------------------------
    The Print My Pix service (printpix.example) is asking PhotoShare
    for access to all your photo albums. Granting access will allow
    Print My Pix to read, alter and delete, your photos.  Access will
    be allowed permanently.

    For a more detailed explanation of what this means, [click here].

    Do you want to allow access?

    &#160;&#160;&#160;&#160; (Yes) &#160;&#160;&#160;&#160; (No)
    -----------------------------------------------------------------
                             Example 2b
                </pre>
<p id="rfc.section.2.1.p.8">The second prompt makes it clearer that Print My Pix is asking for a lot.  Specific warnings might also be added for atypical access requests, or ones that seem to be overstepping.  </p>
<p id="rfc.section.2.1.p.9">It is not the intent, here, to give specific user-interface design advice, and the design and wording of these prompts and other user-interface elements will not necessarily come out well if given to some protocol designers.  The point, rather, is to highlight the issues and raise awareness of the security implications of how OAuth requests are communicated, so interface designers can take that into account.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> On Discovering and Revoking Access</h1>
<p id="rfc.section.2.2.p.1">As we use a great many services that each act as clients to other services we use, we soon get into a very complex and hard-to-manage situation.  Suppose our hypothetical user allows Facebook to access Flickr and to import contacts from Gmail; she allows her Blogger account to post photos to Flickr and to read the photos there; she allows Twitter to post her tweets to Facebook....  </p>
<p id="rfc.section.2.2.p.2">By the nature of these arrangements, and by the design of OAuth, there's no central place that keeps track of all the authorizations.  Each service knows what accesses she has authorized to it, but she has to check each service individually.  It's critical that she have an easy way to do that, that she can easily find the way to do that, and that she can understand the results that her queries return -- it won't do to have them in computer-geek gibberish.  </p>
<p id="rfc.section.2.2.p.3">Further, it has to be easy for her to suspend or revoke the authorizations she's made -- stale authorizations are entry points for security vulnerabilities.  She needs to be able to correct errors she has made in authorizing things, as well as to rescind the authorizations that are no longer appropriate.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#recommendations" id="recommendations">Recommendations</a>
</h1>
<p></p>

<ol>
<li>Implementations should consider clarity to end users as a critical part of the security model.  Because users who are not experts in security are being asked to make security decisions, it is very important that the questions be clear, and that it be easy to find more information.  </li>
<li>Implementations should explain exactly what is being requested by whom, and should provide one-click access to a more detailed explanation.  </li>
<li>Implementations should explain the ramifications of accepting the request.  Because the user is thinking of a specific task, other aspects of what the requested access permits are not in the user's mind.  Put them there.  Explain that this means that they will be able to put all your photos into their photo pool, send email on your behalf forever, and put everyone you know into their marketing database.  </li>
<li>Implementations should be attuned to the more usual requests, and should highlight unusual requests when they arrive.  If most reasonable requests need read access and one asks for read/write, tell the user it's unusual.  Similarly, if most requests need one-time access, or access to a single resource, let the user know that a request for permanent access to multiple resources is cause for concern.  This particular task might need it, but make sure the user is aware that this isn't what you usually see.  </li>
<li>This should be a tractable problem, because most authorization servers will be dealing with a limited set of resources, and, hence, a limited set of typical authorization requests.  The set of typical requests will often be readily enumerable, and out-of-the-ordinary ones will usually stand out.  </li>
<li>Implementations should provide an easy way, obvious to the user, to inquire about active authorizations.  This should not be hidden behind a sort of "advanced" page, but should be within easy reach of every user, along with a clear explanation of what it means.  </li>
<li>Implementations should provide an easy way, once the active authorizations are shown, to get a detailed explanation of the authorization -- what it means, what it allows access to, what the ramifications are.  Anything that should have been part of the original access prompt should be available here.  </li>
<li>Implementations should provide an easy way, once the active authorizations are shown, to suspend or revoke each authorization immediately.  </li>
<li>Client implementations should gracefully re-authorize in the event of a revoked authorization.  Failure because an expected authorization has been revoked is considered poor quality of implementation.  It is only appropriate to fail after an attempt to re-authorize is denied.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Security Considerations</h1>
<p id="rfc.section.4.p.1">This entire document is about security considerations.  Can we have the RFC Editor remove this section prior to publication? </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> IANA Considerations</h1>
<p id="rfc.section.5.p.1">There are no IANA actions needed for this document, and the RFC Editor may remove this section prior to publication.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.6.p.1">[Thanks will go here.] </p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</b></td>
<td class="top">
<a>Hammer-Lahav, E</a>, <a>Recordon, D</a> and <a>D Hardt</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-13">The OAuth 2.0 Authorization Protocol</a>", Internet-Draft draft-ietf-oauth-v2-13, February 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.crocker-dkim-doseta">[I-D.crocker-dkim-doseta]</b></td>
<td class="top">
<a>Crocker, D</a> and <a>M Kucherawy</a>, "<a href="http://tools.ietf.org/html/draft-crocker-dkim-doseta-00">DomainKeys Security Tagging (DOSETA)</a>", Internet-Draft draft-crocker-dkim-doseta-00, January 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Barry Leiba</span> 
	  <span class="n hidden">
		<span class="family-name">Leiba</span>
	  </span>
	</span>
	<span class="org vcardline">Huawei Technologies</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">Phone: +1 646 827 0648</span>

<span class="vcardline">EMail: <a href="mailto:barryleiba@computer.org">barryleiba@computer.org</a></span>

<span class="vcardline">URI: <a href="http://internetmessagingtechnology.org/">http://internetmessagingtechnology.org/</a></span>

  </address>
</div>

</body>
</html>