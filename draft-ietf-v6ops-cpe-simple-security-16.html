<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Recommended Simple Security Capabilities in Customer Premises Equipment for Providing Residential IPv6 Internet Service</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Recommended Simple Security Capabilities in Customer Premises Equipment for Providing Residential IPv6 Internet Service">
<meta name="keywords" content="IPv6, CPE, Security">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">IPv6 Operations</td><td class="header">j. woodyatt, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Apple</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">October 22, 2010</td></tr>
<tr><td class="header">Expires: April 25, 2011</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Recommended Simple Security Capabilities in Customer Premises Equipment for Providing Residential IPv6 Internet Service<br />draft-ietf-v6ops-cpe-simple-security-16</h1>

<h3>Abstract</h3>

<p>This document identifies a set of recommendations for the makers of devices describing how to provide for "simple security" capabilities at the perimeter of local-area IPv6 networks in Internet-enabled homes and small offices.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on April 25, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#req-lang">1.1.</a>&nbsp;
Special Language<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#note-well">1.2.</a>&nbsp;
Use of Normative Keywords<br />
<a href="#overview">2.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ov-basic">2.1.</a>&nbsp;
Basic Sanitation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ov-ilp">2.2.</a>&nbsp;
Internet Layer Protocols<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ov-tlp">2.3.</a>&nbsp;
Transport Layer Protocols<br />
<a href="#details">3.</a>&nbsp;
Detailed Recommendations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#stateless">3.1.</a>&nbsp;
Stateless Filters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#clts-filters">3.2.</a>&nbsp;
Connection-free Filters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#icmp6">3.2.1.</a>&nbsp;
Internet Control and Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#other">3.2.2.</a>&nbsp;
Upper-layer Transport Protocols<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#udp-filter">3.2.3.</a>&nbsp;
UDP Filters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ipsec">3.2.4.</a>&nbsp;
IPsec and Internet Key Exchange (IKE)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mobility">3.2.5.</a>&nbsp;
Mobility Support in IPv6<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#cots-filters">3.3.</a>&nbsp;
Connection-oriented Filters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tcp-filter">3.3.1.</a>&nbsp;
TCP Filters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sctp-filter">3.3.2.</a>&nbsp;
SCTP Filters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dccp-filter">3.3.3.</a>&nbsp;
DCCP Filters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#shim6">3.3.4.</a>&nbsp;
Level 3 Multihoming Shim Protocol for IPv6 (SHIM6)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#app-listen">3.4.</a>&nbsp;
Passive Listeners<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#management">3.5.</a>&nbsp;
Management Applications<br />
<a href="#summary">4.</a>&nbsp;
Summary of Recommendations<br />
<a href="#contrib">5.</a>&nbsp;
Contributors<br />
<a href="#iana">6.</a>&nbsp;
IANA Considerations<br />
<a href="#security">7.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Some IPv6 gateway devices that enable delivery of Internet services in residential and small office settings may be augmented with 'simple security' capabilities as described in <a class='info' href='#RFC4864'>"Local Network Protection for IPv6"<span> (</span><span class='info'>Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;Local Network Protection for IPv6,&rdquo; May&nbsp;2007.</span><span>)</span></a> [RFC4864]. In general, these capabilities cause packets to be discarded in an attempt to make local networks and the Internet more secure. However, it is worth noting that some packets sent by legitimate applications may also be discarded in this process, affecting reliability and ease of use for these applications.
</p>
<p>There is a constructive tension between the desires of users for transparent end-to-end connectivity on the one hand, and the need for local-area network administrators to detect and prevent intrusion by unauthorized public Internet users on the other. This document is intended to highlight reasonable limitations on end-to-end transparency where security considerations are deemed important to promote local and Internet security.
</p>
<p>The reader is cautioned always to remember that the typical residential or small office network administrator has no expertise whatsoever in Internet engineering. Configuration interfaces for router/gateway appliances marketed toward them should be easy to understand and even easier to ignore. In particular, extra care should be used in the design of baseline operating modes for unconfigured devices, since most devices will never be changed from their factory configurations.
</p>
<a name="req-lang"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Special Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>Additionally, the key word "DEFAULT" is to be interpreted in this document as pertaining to a configuration as applied by a vendor, prior to the administrator changing it for its initial activation.
</p>
<a name="note-well"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Use of Normative Keywords</h3>

<p>NOTE WELL: This document is not a standard, and conformance with it is not required in order to claim conformance with IETF standards for IPv6. It uses the normative keywords defined in the previous section only for precision.
</p>
<p>Particular attention is drawn to recommendation REC-49, which calls for an easy way to set a gateway to a transparent mode of operation.
</p>
<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Overview</h3>

<p>For the purposes of this document, residential Internet gateways are assumed to be fairly simple devices with a limited subset of the full range of possible features. They function as default routers <a class='info' href='#RFC4294'>[RFC4294]<span> (</span><span class='info'>Loughney, J., &ldquo;IPv6 Node Requirements,&rdquo; April&nbsp;2006.</span><span>)</span></a> for a single local-area network, e.g. an Ethernet, a Wi-Fi network, a bridge between two or more such segments. They have only one interface by which they can access the Internet service at any one time, using any of several possible sub-IP mechanisms including tunnels and transition mechanisms.
</p>
<p>In referring to the security capabilities of residential gateways, it is reasonable to distinguish between their "interior" network, i.e. the local-area network, and their "exterior" networks, e.g. the public Internet and the networks of Internet service providers. This document is concerned only with the behavior of IP packet filters that police the flow of traffic between the interior IPv6 network and the exterior IPv6 networks of residential Internet gateways.
</p>
<p>The operational goals of security capabilities in Internet gateways are described with more detail in "Local Network Protection for IPv6" <a class='info' href='#RFC4864'>[RFC4864]<span> (</span><span class='info'>Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;Local Network Protection for IPv6,&rdquo; May&nbsp;2007.</span><span>)</span></a>, but they can be summarized as follows.
</p>
<p></p>
<ul class="text">
<li>Check all traffic to and from the public Internet for basic sanity, e.g. anti-spoofing and "martian" <a class='info' href='#RFC4949'>[RFC4949]<span> (</span><span class='info'>Shirey, R., &ldquo;Internet Security Glossary, Version 2,&rdquo; August&nbsp;2007.</span><span>)</span></a> filters.
</li>
<li>Allow tracking of applications usage by source and destination network addresses and ports.
</li>
<li>Provide a barrier against untrusted external influences on the interior network by requiring filter state to be activated by traffic originating at interior network nodes.
</li>
<li>Allow manually configured exceptions to the stateful filtering rules according to network administrative policy.
</li>
<li>Isolate local network DHCPv6 and DNS resolver services from the public Internet.
</li>
</ul>

<p>Prior to the widespread availability of IPv6 Internet service, homes and small offices often used private IPv4 network address realms <a class='info' href='#RFC1918'>[RFC1918]<span> (</span><span class='info'>Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and E. Lear, &ldquo;Address Allocation for Private Internets,&rdquo; February&nbsp;1996.</span><span>)</span></a> with Network Address Translation (NAT) functions deployed to present all the hosts on the interior network as a single host to the Internet service provider. The stateful packet filtering behavior of NAT set user expectations that persist today with residential IPv6 service. "Local Network Protection for IPv6" <a class='info' href='#RFC4864'>[RFC4864]<span> (</span><span class='info'>Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;Local Network Protection for IPv6,&rdquo; May&nbsp;2007.</span><span>)</span></a> recommends applying stateful packet filtering at residential IPv6 gateways that conforms to the user expectations already in place.
</p>
<p>Conventional stateful packet filters activate new states as a side effect of forwarding outbound flow initiations from interior network nodes. This requires applications to have advance knowledge of the addresses of exterior nodes with which they expect to communicate. Several proposals are currently under consideration for allowing applications to solicit inbound traffic from exterior nodes without advance knowledge of their addresses. While consensus within the Internet engineering community has emerged that such protocols are necessary to implement in residential IPv6 residential gateways, the best current practice has not yet been established.
</p>
<a name="ov-basic"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Basic Sanitation</h3>

<p>In addition to the functions required of all Internet routers <a class='info' href='#RFC4294'>[RFC4294]<span> (</span><span class='info'>Loughney, J., &ldquo;IPv6 Node Requirements,&rdquo; April&nbsp;2006.</span><span>)</span></a>, residential gateways are expected to have basic stateless filters for prohibiting certain kinds of traffic with invalid headers, e.g. "martian" packets, spoofs, routing header type code zero, etc. (See <a class='info' href='#stateless'>Section&nbsp;3.1<span> (</span><span class='info'>Stateless Filters</span><span>)</span></a> for more details.)
</p>
<p>Conversely, simple Internet gateways are not expected to prohibit the development of new applications. In particular, packets with end-to-end network security and routing extension headers for mobility are expected to pass Internet gateways freely.
</p>
<p>Finally, Internet gateways that route multicast traffic are expected to implement appropriate filters for multicast traffic to limit the scope of multicast groups that span the demarcation between residential networks and service provider networks.
</p>
<a name="ov-ilp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Internet Layer Protocols</h3>

<p>As virtual private networking tunnels are regarded as an unacceptably wide attack surface, this document recommends the DEFAULT operating mode for residential IPv6 simple security is to treat Generic Packet Tunneling <a class='info' href='#RFC2473'>[RFC2473]<span> (</span><span class='info'>Conta, A. and S. Deering, &ldquo;Generic Packet Tunneling in IPv6 Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> and similar protocols as opaque transport layers, i.e. inbound tunnel initiations are denied and outbound tunnel initiations are accepted.
</p>
<p>IPsec transport and tunnel modes are explicitly secured by definition, so this document recommends the DEFAULT operating mode permit IPsec. To facilitate the use of IPsec in support of IPv6 Mobility, <a class='info' href='#RFC5996'>Internet Key Exchange (IKE) protocol<span> (</span><span class='info'>Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;Internet Key Exchange Protocol Version 2 (IKEv2),&rdquo; September&nbsp;2010.</span><span>)</span></a> [RFC5996] and <a class='info' href='#RFC5201'>"Host Identity Protocol (HIP)"<span> (</span><span class='info'>Moskowitz, R., Nikander, P., Jokela, P., and T. Henderson, &ldquo;Host Identity Protocol,&rdquo; April&nbsp;2008.</span><span>)</span></a> [RFC5201] should also be permitted in the DEFAULT operating mode.
</p>
<a name="ov-tlp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Transport Layer Protocols</h3>

<p>IPv6 simple security functions are principally concerned with the stateful filtering of <a class='info' href='#RFC4443'>Internet Control Message Protocol (ICMPv6)<span> (</span><span class='info'>Conta, A., Deering, S., and M. Gupta, &ldquo;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification,&rdquo; March&nbsp;2006.</span><span>)</span></a> [RFC4443] and transport layers like <a class='info' href='#RFC0768'>User Datagram Protocol (UDP)<span> (</span><span class='info'>Postel, J., &ldquo;User Datagram Protocol,&rdquo; August&nbsp;1980.</span><span>)</span></a> [RFC0768], <a class='info' href='#RFC3828'>Lightweight User Datagram Protocol (UDP-Lite)<span> (</span><span class='info'>Larzon, L-A., Degermark, M., Pink, S., Jonsson, L-E., and G. Fairhurst, &ldquo;The Lightweight User Datagram Protocol (UDP-Lite),&rdquo; July&nbsp;2004.</span><span>)</span></a> [RFC3828], <a class='info' href='#RFC0793'>Transport Control Protocol (TCP)<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> [RFC0793], the <a class='info' href='#RFC4960'>Stream Control Transmission Protocol (SCTP)<span> (</span><span class='info'>Stewart, R., &ldquo;Stream Control Transmission Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4960], the <a class='info' href='#RFC4340'>Datagram Congestion Control Protocol (DCCP)<span> (</span><span class='info'>Kohler, E., Handley, M., and S. Floyd, &ldquo;Datagram Congestion Control Protocol (DCCP),&rdquo; March&nbsp;2006.</span><span>)</span></a> [RFC4340], and potentially any standards-track transport protocols to be defined in the future.
</p>
<p>The general operating principle is that transport layer traffic is not forwarded into the interior network of a residential IPv6 gateway unless it has been solicited explicitly by interior transport endpoints, e.g. by matching the reverse path for previously forwarded outbound traffic, or by matching configured exceptions set by the network administrator. All other traffic is expected to be discarded or rejected with an ICMPv6 error message to indicate the traffic is administratively prohibited.
</p>
<a name="details"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Detailed Recommendations</h3>

<p>This section describes the specific recommendations made by this document in full detail. <a class='info' href='#summary'>Section&nbsp;4<span> (</span><span class='info'>Summary of Recommendations</span><span>)</span></a> is a summary.
</p>
<p>Some recommended filters are to be applied to all traffic that passes through residential Internet gateways regardless of the direction they are to be forwarded. Other recommended filters are intended to be sensitive to the "direction" of traffic flows. Applied to bidirectional transport flows, "direction" has a specific meaning in this document.
</p>
<p>Packets are said to be "outbound" if they originate at nodes located in the interior network for exterior destinations, and "inbound" if they arrive from exterior sources with interior destinations.
</p>
<p>Flows are said to be "outbound" if the originator of the initial packet in any given transport association is an interior node and one or more of the participants are located in the exterior. Flows are said to be "inbound" if the originator of the initial packet is an exterior node and one or more of the participants are nodes on the interior network.
</p>
<a name="stateless"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Stateless Filters</h3>

<p>Certain kinds of IPv6 packets MUST NOT be forwarded in either direction by residential Internet gateways regardless of network state. These include packets with multicast source addresses, packets to destinations with certain non-routable and/or reserved prefixes and packets with deprecated extension headers.
</p>
<p>Other stateless filters are recommended to implement ingress filtering (see <a class='info' href='#RFC2827'>[RFC2827]<span> (</span><span class='info'>Ferguson, P. and D. Senie, &ldquo;Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing,&rdquo; May&nbsp;2000.</span><span>)</span></a> and <a class='info' href='#RFC3704'>[RFC3704]<span> (</span><span class='info'>Baker, F. and P. Savola, &ldquo;Ingress Filtering for Multihomed Networks,&rdquo; March&nbsp;2004.</span><span>)</span></a>), to enforce multicast scope boundaries, and to isolate certain local network services from the public Internet.
</p>
<p>REC-1: Packets which bear in their outer IPv6 headers multicast source addresses MUST NOT be forwarded or transmitted on any interface.
</p>
<p>REC-2: Packets which bear in their outer IPv6 headers multicast destination addresses of equal or narrower scope (see <a class='info' href='#RFC4007'>IPv6 Scoped Address Architecture<span> (</span><span class='info'>Deering, S., Haberman, B., Jinmei, T., Nordmark, E., and B. Zill, &ldquo;IPv6 Scoped Address Architecture,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4007]) than the configured scope boundary level of the gateway MUST NOT be forwarded in any direction. The DEFAULT scope boundary level SHOULD be organization-local scope, and it SHOULD be configurable by the network administrator.
</p>
<p>REC-3: Packets bearing source and/or destination addresses forbidden to appear in the outer headers of packets transmitted over the public Internet MUST NOT be forwarded. In particular, site-local addresses are deprecated by <a class='info' href='#RFC3879'>[RFC3879]<span> (</span><span class='info'>Huitema, C. and B. Carpenter, &ldquo;Deprecating Site Local Addresses,&rdquo; September&nbsp;2004.</span><span>)</span></a>, and <a class='info' href='#RFC5156'>[RFC5156]<span> (</span><span class='info'>Blanchet, M., &ldquo;Special-Use IPv6 Addresses,&rdquo; April&nbsp;2008.</span><span>)</span></a> explicitly forbids the use of addresses with IPv4-Mapped, IPv4-Compatible, Documentation and ORCHID prefixes.
</p>
<p>REC-4: Packets bearing deprecated extension headers prior to their first upper-layer-protocol header SHOULD NOT be forwarded or transmitted on any interface. In particular, all packets with routing extension header type 0 <a class='info' href='#RFC2460'>[RFC2460]<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> preceding the first upper-layer-protocol header MUST NOT be forwarded. See <a class='info' href='#RFC5095'>[RFC5095]<span> (</span><span class='info'>Abley, J., Savola, P., and G. Neville-Neil, &ldquo;Deprecation of Type 0 Routing Headers in IPv6,&rdquo; December&nbsp;2007.</span><span>)</span></a> for additional background.
</p>
<p>REC-5: Outbound packets MUST NOT be forwarded if the source address in their outer IPv6 header does not have a unicast prefix configured for use by globally reachable nodes on the interior network.
</p>
<p>REC-6: Inbound packets MUST NOT be forwarded if the source address in their outer IPv6 header has a global unicast prefix assigned for use by globally reachable nodes on the interior network.
</p>
<p>REC-7: By DEFAULT, packets with unique local source and/or destination addresses <a class='info' href='#RFC4193'>[RFC4193]<span> (</span><span class='info'>Hinden, R. and B. Haberman, &ldquo;Unique Local IPv6 Unicast Addresses,&rdquo; October&nbsp;2005.</span><span>)</span></a> SHOULD NOT be forwarded to or from the exterior network.
</p>
<p>REC-8: By DEFAULT, inbound DNS queries received on exterior interfaces MUST NOT be processed by any integrated DNS resolving server.
</p>
<p>REC-9: Inbound DHCPv6 discovery packets <a class='info' href='#RFC3315'>[RFC3315]<span> (</span><span class='info'>Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6),&rdquo; July&nbsp;2003.</span><span>)</span></a> received on exterior interfaces MUST NOT be processed by any integrated DHCPv6 server or relay agent.
</p>
<p>NOTE WELL: nothing in this document relieves residential Internet gateways, when processing headers to identify valid sequences of upper-layer transport packets, from any of the requirements of the <a class='info' href='#RFC2460'>Internet Protocol, Version 6 (IPv6) Specification<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> [RFC2460], including any and all future updates and revisions.
</p>
<a name="clts-filters"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Connection-free Filters</h3>

<p>Some Internet applications use connection-free transport protocols with no release semantics, e.g. UDP. These protocols pose a special difficulty for stateful packet filters because most of the application state is not carried at the transport level. State records are created when communication is initiated and abandoned when no further communication is detected after some period of time.
</p>
<a name="icmp6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Internet Control and Management</h3>

<p>Recommendations for filtering ICMPv6 messages in firewall devices are described separately in <a class='info' href='#RFC4890'>[RFC4890]<span> (</span><span class='info'>Davies, E. and J. Mohacsi, &ldquo;Recommendations for Filtering ICMPv6 Messages in Firewalls,&rdquo; May&nbsp;2007.</span><span>)</span></a> and apply to residential gateways with the additional recommendation that incoming "Destination Unreachable" and "Packet Too Big" error messages that don't match any filtering state should be dropped.
</p>
<p>REC-10: IPv6 gateways SHOULD NOT forward ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing IP headers that do not match generic upper-layer transport state records.
</p>
<a name="other"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
Upper-layer Transport Protocols</h3>

<p>Residential IPv6 gateways are not expected to prohibit the use of applications to be developed using future upper-layer transport protocols. In particular, transport protocols not otherwise discussed in subsequent sections of this document are expected to be treated consistently, i.e. as having connection-free semantics and no special requirements to inspect the transport headers.
</p>
<p>In general, upper-layer transport filter state records are expected to be created when an interior endpoint sends a packet to an exterior address. The filter allocates (or reuses) a record for the duration of communications, with an idle timer to delete the state record when no further communications are detected.
</p>
<p>One key aspect of how a packet filter behaves is the way it evaluates the exterior address of an enpoint when applying a filtering rule.  A gateway is said to have "endpoint independent filtering" behavior when the exterior address is not evaluated when matching a packet with a flow.  A gateway is said to have "address dependent filtering" behavior when the exterior address of a packet is required to match the exterior address for its flow.
</p>
<p>REC-11: If application transparency is most important, then a stateful packet filter SHOULD have "endpoint independent filter" behavior for generic upper-layer transport protocols. If a more stringent filtering behavior is most important, then a filter SHOULD have "address dependent filtering" behavior. The filtering behavior MAY be an option configurable by the network administrator, and it MAY be independent of the filtering behavior for other protocols. Filtering behavior SHOULD be endpoint independent by DEFAULT in gateways intended for provisioning without service-provider management.
</p>
<p>REC-12: Filter state records for generic upper-layer transport protocols MUST NOT be deleted or recycled until an idle timer not less than two minutes has expired without having forwarded a packet matching the state in some configurable amount of time. By DEFAULT, the idle timer for such state records is five minutes.
</p>
<p>The Internet security community is never completely at rest.  New attack surfaces, and vulnerabilities in them, are typically discovered faster than they can be patched by normal equipment upgrade cycles.  It's therefore important for vendors of residential gateway equipment to provide automatic softare updates to patch vulnerabilties as they are discovered.
</p>
<p>REC-13: Residential IPv6 gateways SHOULD provide a convenient means to update their firmware securely, for the installation of security patches and other manufacturer-recommended changes.
</p>
<p>Vendors can expect users and operators to have differing viewpoints on the maintenance of patches, with some preferring automatic update and some preferring manual procedures. Those preferring automatic update may also prefer either to download from a vendor site or from one managed by their network provider. To handle the disparity, vendors are advised to provide both manual and automatic options. In the automatic case, they would do well to facilitate pre-configuration of the download URL and a means of validating the software image such as a certificate.
</p>
<a name="udp-filter"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.3"></a><h3>3.2.3.&nbsp;
UDP Filters</h3>

<p><a class='info' href='#RFC4787'>"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> [RFC4787] defines the terminology and best current practice for stateful filtering of UDP applications in IPv4 with NAT, which serves as the model for behavioral requirements for simple UDP security in IPv6 gateways, notwithstanding the requirements related specifically to network address translation.
</p>
<p>An interior endpoint initiates a UDP flow through a stateful packet filter by sending a packet to an exterior address. The filter allocates (or reuses) a filter state record for the duration of the flow. The state record defines the interior and exterior IP addresses and ports used between all packets in the flow.
</p>
<p>State records for UDP flows remain active while they are in use and only abandoned after an idle period of some time.
</p>
<p>REC-14: A state record for a UDP flow where both source and destination ports are outside the well-known port range (ports 0-1023) MUST NOT expire in less than two minutes of idle time. The value of the UDP state record idle timer MAY be configurable. The DEFAULT is five minutes.
</p>
<p>REC-15: A state record for a UDP flow where one or both of the source and destination ports are in the well-known port range (ports 0-1023) MAY expire after a period of idle time shorter than two minutes to facilitate the operation of the IANA-registered service assigned to the port in question.
</p>
<p>As <a class='info' href='#RFC4787'>[RFC4787]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> notes, outbound refresh is necessary for allowing the interior endpoint to keep the state record alive. Inbound refresh may be useful for applications with no outbound UDP traffic. However, allowing inbound refresh can allow an attacker in the exterior or a misbehaving application to keep a state record alive indefinitely. This could be a security risk. Also, if the process is repeated with different ports, over time, it could use up all the state record memory and resources in the filter.
</p>
<p>REC-16: A state record for a UDP flow MUST be refreshed when a packet is forwarded from the interior to the exterior, and it MAY be refreshed when a packet is forwarded in the reverse direction.
</p>
<p>As described in Section 5.5 of <a class='info' href='#RFC4787'>[RFC4787]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a>, the connection-free semantics of UDP pose a difficulty for packet filters in trying to recognize which packets comprise an application flow and which are unsolicited. Various strategies have been used in IPv4/NAT gateways with differing effects.
</p>
<p>REC-17: If application transparency is most important, then a stateful packet filter SHOULD have "endpoint independent filter" behavior for UDP. If a more stringent filtering behavior is most important, then a filter SHOULD have "address dependent filtering" behavior. The filtering behavior MAY be an option configurable by the network administrator, and it MAY be independent of the filtering behavior for TCP and other protocols. Filtering behavior SHOULD be endpoint independent by DEFAULT in gateways intended for provisioning without service-provider management.
</p>
<p>Applications mechanisms may depend on the reception of ICMPv6 error messages triggered by the transmission of UDP messages. One such mechanism is path MTU discovery.
</p>
<p>REC-18: If a gateway forwards a UDP flow, it MUST also forward ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing UDP headers that match the flow state record.
</p>
<p>REC-19: Receipt of any sort of ICMPv6 message MUST NOT terminate the state record for a UDP flow.
</p>
<p>REC-20: UDP-Lite flows <a class='info' href='#RFC3828'>[RFC3828]<span> (</span><span class='info'>Larzon, L-A., Degermark, M., Pink, S., Jonsson, L-E., and G. Fairhurst, &ldquo;The Lightweight User Datagram Protocol (UDP-Lite),&rdquo; July&nbsp;2004.</span><span>)</span></a> SHOULD be handled in the same way as UDP flows, except that the upper-layer transport protocol identifier for UDP-Lite is not the same as UDP, and therefore UDP packets MUST NOT match UDP-Lite state records, and vice versa.
</p>
<a name="ipsec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.4"></a><h3>3.2.4.&nbsp;
IPsec and Internet Key Exchange (IKE)</h3>

<p>The Internet protocol security suite (IPsec) offers greater flexibility and better overall security than the simple security of stateful packet filtering at network perimeters. Therefore, residential IPv6 gateways need not prohibit IPsec traffic flows.
</p>
<p>REC-21: In their DEFAULT operating mode, IPv6 gateways MUST NOT prohibit the forwarding of packets, to and from legitimate node addresses, with destination extension headers of type <a class='info' href='#RFC4302'>"Authenticated Header (AH)"<span> (</span><span class='info'>Kent, S., &ldquo;IP Authentication Header,&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4302] in their outer IP extension header chain.
</p>
<p>REC-22: In their DEFAULT operating mode, IPv6 gateways MUST NOT prohibit the forwarding of packets, to and from legitimate node addresses, with an upper layer protocol of type <a class='info' href='#RFC4303'>"Encapsulating Security Payload (ESP)"<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4303] in their outer IP extension header chain.
</p>
<p>REC-23: If a gateway forwards an ESP flow, it MUST also forward (in the reverse direction) ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing ESP headers that match the flow state record.
</p>
<p>Internet Key Exchange (IKE) is a secure mechanism for performing mutual authentication, exchanging cryptographic material and establishing IPsec Security Associations between peers. Residential IPv6 gateways are expected to facilitate the use of IPsec security policies by allowing inbound IKE flows.
</p>
<p>REC-24: In their DEFAULT operating mode, IPv6 gateways MUST NOT prohibit the forwarding of any UDP packets, to and from legitimate node addresses, with a destination port of 500, i.e. the port reserved by IANA for the <a class='info' href='#RFC5996'>Internet Key Exchange (IKE) protocol<span> (</span><span class='info'>Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;Internet Key Exchange Protocol Version 2 (IKEv2),&rdquo; September&nbsp;2010.</span><span>)</span></a> [RFC5996].
</p>
<p>REC-25: In all operating modes, IPv6 gateways SHOULD use filter state records for <a class='info' href='#RFC4303'>Encapsulating Security Payload (ESP)<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4303] that are indexable by a 3-tuple comprising the interior node address, the exterior node address and the ESP protocol identifier. In particular, the IPv4/NAT method of indexing state records also by security parameters index (SPI) SHOULD NOT be used. Likewise, any mechanism that depends on detection of <a class='info' href='#RFC5996'>Internet Key Exchange (IKE)<span> (</span><span class='info'>Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;Internet Key Exchange Protocol Version 2 (IKEv2),&rdquo; September&nbsp;2010.</span><span>)</span></a> [RFC5996] initiations SHOULD NOT be used.
</p>
<p>"Host Identity Protocol (HIP)" is a secure mechanism for establishing host identity and secure communications between authenticated hosts. Residential IPv6 gateways need not prohibit inbound HIP flows.
</p>
<p>REC-26: In their DEFAULT operating mode, IPv6 gateways MUST NOT prohibit the forwarding of packets, to and from legitimate node addresses, with destination extension headers of type <a class='info' href='#RFC5201'>"Host Identity Protocol (HIP)"<span> (</span><span class='info'>Moskowitz, R., Nikander, P., Jokela, P., and T. Henderson, &ldquo;Host Identity Protocol,&rdquo; April&nbsp;2008.</span><span>)</span></a> [RFC5201] in their outer IP extension header chain.
</p>
<a name="mobility"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.5"></a><h3>3.2.5.&nbsp;
Mobility Support in IPv6</h3>

<p><a class='info' href='#RFC3775'>Mobility support in IPv6<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> [RFC3775] relies on the use of an encapsulation mechanism in flows between mobile nodes and their correspondent nodes, involving the use of the type 2 IPv6 routing header, the Home Address destination header option and the Mobility extension header. In contrast to mobility support in IPv4, mobility is a standard feature of IPv6, and no security benefit is generally to be gained by denying communications with either interior or exterior mobile nodes.
</p>
<p>Not all usage scenarios of Mobility support in IPv6 are expected to compatible with IPv6 simple security. In particular, exterior mobile nodes are expected to be prohibited from establishing bindings with interior correspondent nodes by the filtering of unsolicited inbound Mobility Header messages unless they are the subject of an IPsec security policy.
</p>
<p>REC-27: The state records for flows initiated by outbound packets that bear a Home Address destination option <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> are distinguished by the addition of the home address of the flow as well as the interior care-of address. IPv6 gateways MUST NOT prohibit the forwarding of any inbound packets bearing type 2 routing headers, which otherwise match a flow state record, and where A) the address in the destination field of the IPv6 header matches the interior care-of address of the flow, and B) the Home Address field in the Type 2 Routing Header matches the home address of the flow.
</p>
<p>REC-28: Valid sequences of Mobility Header <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> packets MUST be forwarded for all outbound and explicitly permitted inbound Mobility Header flows.
</p>
<p>REC-29: If a gateway forwards a Mobility Header <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> flow, then it MUST also forward, in both directions, the IPv4 and IPv6 packets that are encapsulated in IPv6 associated with the tunnel between the home agent and the correspondent node.
</p>
<p>REC-30: If a gateway forwards a Mobility Header <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> flow, then it MUST also forward (in the reverse direction) ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing any headers that match the associated flow state records.
</p>
<a name="cots-filters"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Connection-oriented Filters</h3>

<p>Most Internet applications use connection-oriented transport protocols with orderly release semantics. These protocols include TCP, SCTP, DCCP, and potentially any future IETF standards-track transport protocols that use such semantics. Stateful packet filters track the state of individual transport flows and prohibit the forwarding of packets that do not match the state of an active flow and do not conform to a rule for the automatic creation of such state.
</p>
<a name="tcp-filter"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
TCP Filters</h3>

<p>An interior endpoint initiates a TCP flow through a stateful packet filter by sending a SYN packet. The filter allocates (or reuses) a filter state record for the flow. The state record defines the interior and exterior IP addresses and ports used for forwarding all packets for that flow.
</p>
<p>Some peer-to-peer applications use an alternate method of connection initiation termed simultaneous-open (Fig. 8, <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>) to traverse stateful filters. In the simultaneous-open mode of operation, both peers send SYN packets for the same TCP flow. The SYN packets cross in the network. Upon receiving the other end's SYN packet, each end responds with a SYN-ACK packet, which also cross in the network. The connection is established at each endpoint once the SYN-ACK packets are received.
</p>
<p>To provide stateful packet filtering service for TCP, it is necessary for a filter to receive, process and forward all packets for a flow that conform to valid transitions of the TCP state machine (Fig. 6, <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>).
</p>
<p>REC-31: All valid sequences of TCP packets (defined in <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>) MUST be forwarded for outbound flows and explicitly permitted inbound flows. In particular, both the normal TCP 3-way handshake mode of operation and the simultaneous-open modes of operation MUST be supported.
</p>
<p>It is possible to reconstruct enough of the state of a TCP flow to allow forwarding between an interior and exterior node even when the filter starts operating after TCP enters the established state. In this case, because the filter has not seen the TCP window-scale option, it is not possible for the filter to enforce the TCP window invariant by dropping out-of-window segments.
</p>
<p>REC-32: The TCP window invariant MUST NOT be enforced on flows for which the filter did not detect whether the window-scale option (see <a class='info' href='#RFC1323'>[RFC1323]<span> (</span><span class='info'>Jacobson, V., Braden, B., and D. Borman, &ldquo;TCP Extensions for High Performance,&rdquo; May&nbsp;1992.</span><span>)</span></a>) was sent in the 3-way handshake or simultaneous open.
</p>
<p>A stateful filter can allow an existing state record to be reused by an externally initiated flow if its security policy permits. Several different policies are possible as described in <a class='info' href='#RFC4787'>[RFC4787]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> and extended in <a class='info' href='#RFC5382'>[RFC5382]<span> (</span><span class='info'>Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;NAT Behavioral Requirements for TCP,&rdquo; October&nbsp;2008.</span><span>)</span></a>.
</p>
<p>REC-33: If application transparency is most important, then a stateful packet filter SHOULD have "endpoint independent filter" behavior for TCP. If a more stringent filtering behavior is most important, then a filter SHOULD have "address dependent filtering" behavior. The filtering behavior MAY be an option configurable by the network administrator, and it MAY be independent of the filtering behavior for UDP and other protocols. Filtering behavior SHOULD be endpoint independent by DEFAULT in gateways intended for provisioning without service-provider management.
</p>
<p>If an inbound SYN packet is filtered, either because a corresponding state record does not exist or because of the filter's normal behavior, a filter has two basic choices: to discard the packet silently, or to signal an error to the sender. Signaling an error through ICMPv6 messages allows the sender to detect that the SYN did not reach the intended destination. Discarding the packet, on the other hand, allows applications to perform simultaneous-open more reliably. A more detailed discussion of this issue can be found in <a class='info' href='#RFC5382'>[RFC5382]<span> (</span><span class='info'>Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;NAT Behavioral Requirements for TCP,&rdquo; October&nbsp;2008.</span><span>)</span></a>, but the basic outcome of it is that filters need to wait on signaling errors until simultaneous-open will not be impaired.
</p>
<p>REC-34: By DEFAULT, a gateway MUST respond with an ICMPv6 "Destination Unreachable" error code 1 (administratively prohibited) to any unsolicited inbound SYN packet after waiting at least 6 seconds without first forwarding the associated outbound SYN or SYN/ACK from the interior peer.
</p>
<p>A TCP filter maintains state associated with in-progress connections and established flows. Because of this, a filter is susceptible to a resource-exhaustion attack whereby an attacker (or virus) on the interior attempts to cause the filter to exhaust its capacity for creating state records. To defend against such attacks, a filter needs to abandon unused state records after a sufficiently long period of idleness.
</p>
<p>A common method used for TCP filters in IPv4/NAT gateways is to abandon preferentially flow state records for crashed endpoints, followed by closed flows and partially-open flows. A gateway can check if an endpoint for a session has crashed by sending a TCP keep-alive packet on behalf of the other endpoint and receiving a TCP RST packet in response. If the gateway cannot determine whether the endpoint is active, then the associated state record needs to be retained until the TCP flow has been idle for some time. Note: an established TCP flow can stay idle (but live) indefinitely; hence, there is no fixed value for an idle-timeout that accommodates all applications. However, a large idle-timeout motivated by recommendations in <a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a> and <a class='info' href='#RFC4294'>[RFC4294]<span> (</span><span class='info'>Loughney, J., &ldquo;IPv6 Node Requirements,&rdquo; April&nbsp;2006.</span><span>)</span></a> can reduce the chances of abandoning a live flow.
</p>
<p>TCP flows can stay in the established phase indefinitely without exchanging packets. Some end-hosts can be configured to send keep-alive packets on such idle flows; by default, such packets are sent every two hours, if enabled <a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a>. Consequently, a filter that waits for slightly over two hours can detect idle flows with keep-alive packets being sent at the default rate. TCP flows in the partially-open or closing phases, on the other hand, can stay idle for at most four minutes while waiting for in-flight packets to be delivered <a class='info' href='#RFC1122'>[RFC1122]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Communication Layers,&rdquo; October&nbsp;1989.</span><span>)</span></a>.
</p>
<p>The "established flow idle-timeout" for a stateful packet filter is defined as the minimum time a TCP flow in the established phase must remain idle before the filter considers the associated state record a candidate for collection. The "transitory flow idle-timeout" for a filter is defined as the minimum time a TCP flow in the partially-open or closing phases must remain idle before the filter considers the associated state record a candidate for collection. TCP flows in the TIME_WAIT state are not affected by the "transitory flow idle-timeout" parameter.
</p>
<p>REC-35: If a gateway cannot determine whether the endpoints of a TCP flow are active, then it MAY abandon the state record if it has been idle for some time. In such cases, the value of the "established flow idle-timeout" MUST NOT be less than two hours four minutes, as discussed in <a class='info' href='#RFC5382'>[RFC5382]<span> (</span><span class='info'>Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;NAT Behavioral Requirements for TCP,&rdquo; October&nbsp;2008.</span><span>)</span></a>. The value of the "transitory flow idle-timeout" MUST NOT be less than four minutes. The value of the idle-timeouts MAY be configurable by the network administrator.
</p>
<p>Behavior for handing RST packets, or TCP flows in the TIME_WAIT state is left unspecified. A gateway MAY hold state for a flow in TIME_WAIT state to accommodate retransmissions of the last ACK. However, since the TIME_WAIT state is commonly encountered by interior endpoints properly closing the TCP flow, holding state for a closed flow can limit the throughput of flows through a gateway with limited resources. <a class='info' href='#RFC1337'>[RFC1337]<span> (</span><span class='info'>Braden, B., &ldquo;TIME-WAIT Assassination Hazards in TCP,&rdquo; May&nbsp;1992.</span><span>)</span></a> discusses hazards associated with TIME_WAIT assassination.
</p>
<p>The handling of non-SYN packets for which there is no active state record is left unspecified. Such packets can be received if the gateway abandons a live flow, or abandons a flow in the TIME_WAIT state before the four minute TIME_WAIT period expires. The decision either to discard or to respond with an ICMPv6 "Destination Unreachable" error code 1 (administratively prohibited) is left up to the implementation.
</p>
<p>Behavior for notifying endpoints when abandoning live flows is left unspecified. When a gateway abandons a live flow, for example due to a timeout expiring, the filter MAY send a TCP RST packet to each endpoint on behalf of the other. Sending a RST notification allows endpoint applications to recover more quickly, however, notifying endpoints might not always be possible if, for example, state records are lost due to power interruption.
</p>
<p>Several TCP mechanisms depend on the reception of ICMPv6 error messages triggered by the transmission of TCP segments. One such mechanism is path MTU discovery, which is required for correct operation of TCP.
</p>
<p>REC-36: If a gateway forwards a TCP flow, it MUST also forward ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing TCP headers that match the flow state record.
</p>
<p>REC-37: Receipt of any sort of ICMPv6 message MUST NOT terminate the state record for a TCP flow.
</p>
<a name="sctp-filter"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2"></a><h3>3.3.2.&nbsp;
SCTP Filters</h3>

<p>Because <a class='info' href='#RFC4960'>Stream Control Transmission Protocol (SCTP)<span> (</span><span class='info'>Stewart, R., &ldquo;Stream Control Transmission Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4960] flows can be terminated at multiple network addresses, IPv6 simple security functions cannot achieve full transparency for SCTP applications. In multipath traversal scenarios, full transparency requires coordination between all the packet filter processes in the various paths between the endpoint network addresses. Such coordination is not "simple" and it is, therefore, beyond the scope of this recommendation.
</p>
<p>However, some SCTP applications are capable of tolerating the inherent unipath restriction of IPv6 simple security, even in multipath traversal scenarios. They expect similar connection-oriented filtering behaviors as for TCP, but at the level of SCTP associations, not stream connections. This section describes specific recommendations for SCTP filtering for such traversal scenarios.
</p>
<p>An interior endpoint initiates SCTP associations through a stateful packet filter by sending a packet comprising a single INIT chunk. The filter allocates (or reuses) a filter state record for the association. The state record defines the interior and exterior IP addresses and the observed verification tag used for forwarding packets in that association.
</p>
<p>Peer-to-peer applications use an alternate method of association initiation termed simultaneous-open to traverse stateful filters. In the simultaneous-open mode of operation, both peers send INIT chunks at the same time to establish an association. Upon receiving the other end's INIT chunk, each end responds with an INIT-ACK packet, which is expected to traverse the same path in reverse. Because only one SCTP association may exist between any two network addresses, one of the peers in simultaneous-open mode of operation will send an ERROR or ABORT chunk along with the INIT-ACK chunk. The association is established at each endpoint once an INIT-ACK chunks is received at one end without an ERROR or ABORT chunk.
</p>
<p>To provide stateful packet filtering service for SCTP, it is necessary for a filter to receive, process and forward all packets for an association that conform to valid transitions of the SCTP state machine (Fig. 3, <a class='info' href='#RFC4960'>[RFC4960]<span> (</span><span class='info'>Stewart, R., &ldquo;Stream Control Transmission Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a>).
</p>
<p>REC-38: All valid sequences of SCTP packets (defined in <a class='info' href='#RFC4960'>[RFC4960]<span> (</span><span class='info'>Stewart, R., &ldquo;Stream Control Transmission Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a>) MUST be forwarded for outbound associations and explicitly permitted inbound associations. In particular, both the normal SCTP association establishment and simultaneous-open modes of operation MUST be supported.
</p>
<p>If an inbound INIT packet is filtered, either because a corresponding state record does not exist or because of the filter's normal behavior, a filter has two basic choices: to discard the packet silently, or to signal an error to the sender. Signaling an error through ICMPv6 messages allows the sender to detect that the INIT packet did not reach the intended destination. Discarding the packet, on the other hand, allows applications to perform simultaneous-open more reliably. Delays in signaling errors can prevent the impairment of simultaneous-open mode of operation.
</p>
<p>REC-39: By DEFAULT, a gateway MUST respond with an ICMPv6 "Destination Unreachable" error code 1 (administratively prohibited), to any unsolicited inbound INIT packet after waiting at least 6 seconds without first forwarding the associated outbound INIT from the interior peer.
</p>
<p>An SCTP filter maintains state associated with in-progress and established associations. Because of this, a filter is susceptible to a resource-exhaustion attack whereby an attacker (or virus) on the interior attempts to cause the filter to exhaust its capacity for creating state records. To defend against such attacks, a filter needs to abandon unused state records after a sufficiently long period of idleness.
</p>
<p>A common method used for TCP filters in IPv4/NAT gateways is to abandon preferentially sessions for crashed endpoints, followed by closed associations and partially opened associations. A similar method is an option for SCTP filters in IPv6 gateways. A gateway can check if an endpoint for an association has crashed by sending HEARTBEAT chunks and looking for the HEARTBEAT ACK response. If the gateway cannot determine whether the endpoint is active, then the associated state records needs to be retained until the SCTP association has been idle for some time. Note: an established SCTP association can stay idle (but live) indefinitely, hence there is no fixed value of an idle-timeout that accommodates all applications. However, a large idle-timeout motivated by <a class='info' href='#RFC4294'>[RFC4294]<span> (</span><span class='info'>Loughney, J., &ldquo;IPv6 Node Requirements,&rdquo; April&nbsp;2006.</span><span>)</span></a> can reduce the chances of abandoning a live association.
</p>
<p>SCTP associations can stay in the ESTABLISHED state indefinitely without exchanging packets. Some end-hosts can be configured to send HEARTBEAT chunks on such idle associations, but <a class='info' href='#RFC4960'>[RFC4960]<span> (</span><span class='info'>Stewart, R., &ldquo;Stream Control Transmission Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a> does not specify (or even suggest) a default time interval. A filter that waits for slightly over two hours can detect idle associations with HEARTBEAT packets being sent at the same rate as most hosts use for TCP keep-alive, which is a reasonably similar system for this purpose. SCTP associations in the partially-open or closing states, on the other hand, can stay idle for at most four minutes while waiting for in-flight packets to be delivered (assuming the suggested SCTP protocol parameter values in Section 15 of <a class='info' href='#RFC4960'>[RFC4960]<span> (</span><span class='info'>Stewart, R., &ldquo;Stream Control Transmission Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a>).
</p>
<p>The "established association idle-timeout" for a stateful packet filter is defined as the minimum time an SCTP association in the established phase must remain idle before the filter considers the corresponding state record a candidate for collection. The "transitory association idle-timeout" for a filter is defined as the minimum time an SCTP association in the partially-open or closing phases must remain idle before the filter considers the corresponding state record a candidate for collection.
</p>
<p>REC-40: If a gateway cannot determine whether the endpoints of an SCTP association are active, then it MAY abandon the state record if it has been idle for some time. In such cases, the value of the "established association idle-timeout" MUST NOT be less than two hours four minutes. The value of the "transitory association idle-timeout" MUST NOT be less than four minutes. The value of the idle-timeouts MAY be configurable by the network administrator.
</p>
<p>Behavior for handling ERROR and ABORT packets is left unspecified. A gateway MAY hold state for an association after its closing phases have completed to accommodate retransmissions of its final SHUTDOWN ACK packets. However, holding state for a closed association can limit the throughput of associations traversing a gateway with limited resources. The discussion in <a class='info' href='#RFC1337'>[RFC1337]<span> (</span><span class='info'>Braden, B., &ldquo;TIME-WAIT Assassination Hazards in TCP,&rdquo; May&nbsp;1992.</span><span>)</span></a> regarding the hazards of TIME_WAIT assassination are relevant.
</p>
<p>The handling of inbound non-INIT packets for which there is no active state record is left unspecified. Such packets can be received if the gateway abandons a live flow, or abandons an association in the closing states before the transitory association idle-timeout expires. The decision either to discard or to respond with an ICMPv6 "Destination Unreachable" error code 1 (administratively prohibited) is left to the implementation.
</p>
<p>Behavior for notifying endpoints when abandoning live associations is left unspecified. When a gateway abandons a live association, for example due to a timeout expiring, the filter MAY send an ABORT packet to each endpoint on behalf of the other. Sending an ABORT notification allows endpoint applications to recover more quickly, however, notifying endpoints might not always be possible if, for example, state records are lost due to power interruption.
</p>
<p>Several SCTP mechanisms depend on the reception of ICMPv6 error messages triggered by the transmission of SCTP packets.
</p>
<p>REC-41: If a gateway forwards an SCTP association, it MUST also forward ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing SCTP headers that match the association state record.
</p>
<p>REC-42: Receipt of any sort of ICMPv6 message MUST NOT terminate the state record for an SCTP association.
</p>
<a name="dccp-filter"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3"></a><h3>3.3.3.&nbsp;
DCCP Filters</h3>

<p>The connection semantics described in <a class='info' href='#RFC4340'>Datagram Congestion Control Protocol (DCCP)<span> (</span><span class='info'>Kohler, E., Handley, M., and S. Floyd, &ldquo;Datagram Congestion Control Protocol (DCCP),&rdquo; March&nbsp;2006.</span><span>)</span></a> [RFC4340] are very similar to those of TCP. An interior endpoint initiates a DCCP flow through a stateful packet filter by sending a DCCP-Request packet. Simultaneous open is not defined for DCCP.
</p>
<p>In order to provide stateful packet filtering service for DCCP, it is necessary for a filter to receive, process and forward all packets for a flow that conform to valid transitions of the DCCP state machine (Section 8, <a class='info' href='#RFC4340'>[RFC4340]<span> (</span><span class='info'>Kohler, E., Handley, M., and S. Floyd, &ldquo;Datagram Congestion Control Protocol (DCCP),&rdquo; March&nbsp;2006.</span><span>)</span></a>).
</p>
<p>REC-43: All valid sequences of DCCP packets (defined in <a class='info' href='#RFC4340'>[RFC4340]<span> (</span><span class='info'>Kohler, E., Handley, M., and S. Floyd, &ldquo;Datagram Congestion Control Protocol (DCCP),&rdquo; March&nbsp;2006.</span><span>)</span></a>) MUST be forwarded for all flows to exterior servers and those flows to interior servers with explicitly permitted service codes.
</p>
<p>It is possible to reconstruct enough of the state of a DCCP flow to allow forwarding between an interior and exterior node even when the filter starts operating after DCCP enters the OPEN state. Also, a filter can allow an existing state record to be reused by an externally initiated flow if its security policy permits. As with TCP, several different policies are possible, with a good discussion of the issue involved presented in <a class='info' href='#RFC4787'>[RFC4787]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> and extended in <a class='info' href='#RFC5382'>[RFC5382]<span> (</span><span class='info'>Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;NAT Behavioral Requirements for TCP,&rdquo; October&nbsp;2008.</span><span>)</span></a>.
</p>
<p>If an inbound DCCP-Request packet is filtered, either because a corresponding state record does not already exist for it or because of the filter's normal behavior of refusing flows not explicitly permitted, then a filter has two basic choices: to discard the packet silently, or to signal an error to the sender. Signaling an error through ICMPv6 messages allows the sender to detect that the DCCP-Request did not reach the intended destination. Discarding the packet, on the other hand, only delays the failure to connect and provides no measurable security.
</p>
<p>A DCCP filter maintains state associated with in-progress connections and established flows. Because of this, a filter is susceptible to a resource-exhaustion attack whereby an attacker (or virus) on the interior attempts to cause the filter to exhaust its capacity for creating state records. To prevent such an attack, a filter needs to abandon unused state records after a sufficiently long period of idleness.
</p>
<p>A common method used for TCP filters in IPv4/NAT gateways is to abandon preferentially sessions for crashed endpoints, followed by closed TCP flows and partially-open flows. No such method exists for DCCP, and flows can stay in the OPEN phase indefinitely without exchanging packets. Hence, there is no fixed value for an idle-timeout that accommodates all applications. However, a large idle-timeout motivated by <a class='info' href='#RFC4294'>[RFC4294]<span> (</span><span class='info'>Loughney, J., &ldquo;IPv6 Node Requirements,&rdquo; April&nbsp;2006.</span><span>)</span></a> can reduce the chances of abandoning a live flow.
</p>
<p>DCCP flows in the partially-open or closing phases can stay idle for at most eight minutes while waiting for in-flight packets to be delivered.
</p>
<p>The "open flow idle-timeout" for a stateful packet filter is defined as the minimum time a DCCP flow in the open state must remain idle before the filter considers the associated state record a candidate for collection. The "transitory flow idle-timeout" for a filter is defined as the minimum time a DCCP flow in the partially-open or closing phases must remain idle before the filter considers the associated state record a candidate for collection. DCCP flows in the TIMEWAIT state are not affected by the "transitory flow idle-timeout" parameter.
</p>
<p>REC-44: A gateway MAY abandon a DCCP state record if it has been idle for some time. In such cases, the value of the "established flow idle-timeout" MUST NOT be less than two hours four minutes. The value of the "transitory flow idle-timeout" MUST NOT be less than eight minutes. The value of the idle-timeouts MAY be configurable by the network administrator.
</p>
<p>Behavior for handing DCCP-Reset packets, or flows in the TIMEWAIT state is left unspecified. A gateway MAY hold state for a flow in TIMEWAIT state to accommodate retransmissions of the last DCCP-Reset. However, since the TIMEWAIT state is commonly encountered by interior endpoints properly closing the DCCP flow, holding state for a closed flow can limit the throughput of flows through a gateway with limited resources. [RFC1337] discusses hazards associated with TIME_WAIT assassination in TCP, and similar hazards exists for DCCP.
</p>
<p>The handling of non-SYN packets for which there is no active state record is left unspecified. Such packets can be received if the gateway abandons a live flow, or abandons a flow in the TIMEWAIT state before the four minute 2MSL period expires. The decision either to discard or to respond with an ICMPv6 "Destination Unreachable" error code 1 (administratively prohibited) is left up to the implementation.
</p>
<p>Behavior for notifying endpoints when abandoning live flows is left unspecified. When a gateway abandons a live flow, for example due to a timeout expiring, the filter MAY send a DCCP-Reset packet to each endpoint on behalf of the other. Sending a DCCP-Reset notification allows endpoint applications to recover more quickly, however, notifying endpoints might not always be possible if, for example, state records are lost due to power interruption.
</p>
<p>Several DCCP mechanisms depend on the reception of ICMPv6 error messages triggered by the transmission of DCCP packets. One such mechanism is path MTU discovery, which is required for correct operation.
</p>
<p>REC-45: If an Internet gateway forwards a DCCP flow, it MUST also forward ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing DCCP headers that match the flow state record.
</p>
<p>REC-46: Receipt of any sort of ICMPv6 message MUST NOT terminate the state record for a DCCP flow.
</p>
<a name="shim6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.4"></a><h3>3.3.4.&nbsp;
Level 3 Multihoming Shim Protocol for IPv6 (SHIM6)</h3>

<p>While IPv6 simple security is applicable to residential networks with only one Internet service provider at a time, the use of <a class='info' href='#RFC5533'>Level 3 Multihoming Shim Protocol for IPv6 (SHIM6)<span> (</span><span class='info'>Nordmark, E. and M. Bagnulo, &ldquo;Shim6: Level 3 Multihoming Shim Protocol for IPv6,&rdquo; June&nbsp;2009.</span><span>)</span></a> [RFC5533] is necessary for communications with some multihomed exterior destinations.  No special recommendations are made in this document for processing the SHIM6 message format (protocol 140) beyond the recommendations in <a class='info' href='#other'>Section&nbsp;3.2.2<span> (</span><span class='info'>Upper-layer Transport Protocols</span><span>)</span></a>.  The content of the SHIM6 payload extension header may be ignored.
</p>
<p>REC-47: Valid sequences of packets bearing SHIM6 payload extension headers in their outer IP extension header chains MUST be forwarded for all outbound and explicitly permitted flows.  The content of the SHIM6 payload extension header MAY be ignored for the purpose of state tracking.
</p>
<a name="app-listen"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Passive Listeners</h3>

<p>Some applications expect to solicit traffic from exterior nodes without advance knowledge of the exterior addresses of their peers. This requirement is met by IPv4/NAT gateways typically by the use of either <a class='info' href='#I-D.cheshire-nat-pmp'>[I&#8209;D.cheshire&#8209;nat&#8209;pmp]<span> (</span><span class='info'>Cheshire, S., &ldquo;NAT Port Mapping Protocol (NAT-PMP),&rdquo; April&nbsp;2008.</span><span>)</span></a> or <a class='info' href='#UPnP-IGD'>[UPnP&#8209;IGD]<span> (</span><span class='info'>UPnP Forum, &ldquo;Universal Plug and Play Internet Gateway Device Standardized Gateway Device Protocol,&rdquo; September&nbsp;2010.</span><span>)</span></a>. On IPv4/NAT networks connected by gateways without such services, applications must use techniques like <a class='info' href='#RFC5389'>Session Traversal Utilities for NAT (STUN)<span> (</span><span class='info'>Rosenberg, J., Mahy, R., Matthews, P., and D. Wing, &ldquo;Session Traversal Utilities for NAT (STUN),&rdquo; October&nbsp;2008.</span><span>)</span></a> [RFC5389] to obtain and maintain connectivity, despite the translation and filtering effects of NAT.
</p>
<p>While NAT for IPv6 is unlikely to be used in most residential gateways, the filtering effect of the simple security functions recommended by this document are derived from those in widespread use on the IPv4 Internet, and a similar barrier to communication at passive listeners is a natural outcome of its deployment. To avoid the need for IPv6 applications to use techniques like STUN for opening and maintaining dynamic filter state, something similar to NAT-PMP and UPnP-IGD but without actually supporting NAT could be deployed. Alas, no consensus has yet emerged in the Internet engineering community as to what is most appropriate for residential IPv6 usage scenarios.
</p>
<p>One proposal that has been offered as an Internet Draft is the <a class='info' href='#I-D.woodyatt-ald'>Application Listener Discovery Protocol<span> (</span><span class='info'>Woodyatt, J., &ldquo;Application Listener Discovery (ALD) for IPv6,&rdquo; July&nbsp;2008.</span><span>)</span></a> [I&#8209;D.woodyatt&#8209;ald]. It remains to be seen whether the Internet Gateway Device profile of the Universal Plug And Play protocol will be extended for IPv6. Other proposals of note include the <a class='info' href='#RFC5189'>Middlebox Communication Protocol<span> (</span><span class='info'>Stiemerling, M., Quittek, J., and T. Taylor, &ldquo;Middlebox Communication (MIDCOM) Protocol Semantics,&rdquo; March&nbsp;2008.</span><span>)</span></a> [RFC5189] and the <a class='info' href='#RFC4080'>Next Steps in Signaling framework<span> (</span><span class='info'>Hancock, R., Karagiannis, G., Loughney, J., and S. Van den Bosch, &ldquo;Next Steps in Signaling (NSIS): Framework,&rdquo; June&nbsp;2005.</span><span>)</span></a> [RFC4080]. Until a consensus emerges around a specific method, the following recommendations are the best guidance available.
</p>
<p>REC-48: Internet gateways with IPv6 simple security capabilities SHOULD implement a protocol to permit applications to solicit inbound traffic without advance knowledge of the addresses of exterior nodes with which they expect to communicate.
</p>
<p>REC-49: Internet gateways with IPv6 simple security capabilities MUST provide an easily selected configuration option that permits a "transparent mode" of operation that forwards all unsolicited flows regardless of forwarding direction, i.e. not to use the IPv6 simple security capabilities of the gateway. The transparent mode of operation MAY be the default configuration.
</p>
<p>In general, "transparent mode" will enable more flexibility and reliability for applications which require devices to be contacted inside the home directly, particularly in absence of a protocol as described in REC-48. Operating in transparent mode may come at the expense of security if there are IPv6 nodes in the home that do not have their own host-based firewall capability and require a firewall in the gateway in order not to be compromised.
</p>
<a name="management"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Management Applications</h3>

<p>Subscriber managed residential gateways are unlikely ever to be completely zero-configuration, but their administrators will very often possess no particular expertise in Internet engineering. In general, the specification of management interfaces for residential gateways is out of scope for this document, but security of subscriber managed gateways merit special attention here.
</p>
<p>REC-50: By DEFAULT, subscriber managed residential gateways MUST NOT offer management application services to the exterior network.
</p>
<a name="summary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Summary of Recommendations</h3>

<p>This section collects all of the recommendations made in this document into a convenient list.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>REC-1</dt>
<dd>Packets bearing in their outer IPv6 headers multicast source addresses MUST NOT be forwarded or transmitted on any interface.
</dd>
<dt>REC-2</dt>
<dd>Packets which bear in their outer IPv6 headers multicast destination addresses of equal or narrower scope (see <a class='info' href='#RFC4007'>IPv6 Scoped Address Architecture<span> (</span><span class='info'>Deering, S., Haberman, B., Jinmei, T., Nordmark, E., and B. Zill, &ldquo;IPv6 Scoped Address Architecture,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4007]) than the configured scope boundary level of the gateway MUST NOT be forwarded in any direction. The DEFAULT scope boundary level SHOULD be organization-local scope, and it SHOULD be configurable by the network administrator.
</dd>
<dt>REC-3</dt>
<dd>Packets bearing source and/or destination addresses forbidden to appear in the outer headers of packets transmitted over the public Internet MUST NOT be forwarded. In particular, site-local addresses are deprecated by <a class='info' href='#RFC3879'>[RFC3879]<span> (</span><span class='info'>Huitema, C. and B. Carpenter, &ldquo;Deprecating Site Local Addresses,&rdquo; September&nbsp;2004.</span><span>)</span></a>, and <a class='info' href='#RFC5156'>[RFC5156]<span> (</span><span class='info'>Blanchet, M., &ldquo;Special-Use IPv6 Addresses,&rdquo; April&nbsp;2008.</span><span>)</span></a> explicitly forbids the use of addresses with IPv4-Mapped, IPv4-Compatible, Documentation and ORCHID prefixes.
</dd>
<dt>REC-4</dt>
<dd>Packets bearing deprecated extension headers prior to their first upper-layer-protocol header SHOULD NOT be forwarded or transmitted on any interface. In particular, all packets with routing extension header type 0 <a class='info' href='#RFC2460'>[RFC2460]<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> preceding the first upper-layer-protocol header MUST NOT be forwarded. (See <a class='info' href='#RFC5095'>[RFC5095]<span> (</span><span class='info'>Abley, J., Savola, P., and G. Neville-Neil, &ldquo;Deprecation of Type 0 Routing Headers in IPv6,&rdquo; December&nbsp;2007.</span><span>)</span></a> for additional background.)
</dd>
<dt>REC-5</dt>
<dd>Outbound packets MUST NOT be forwarded if the source address in their outer IPv6 header does not have a unicast prefix assigned for use by globally reachable nodes on the interior network.
</dd>
<dt>REC-6</dt>
<dd>Inbound packets MUST NOT be forwarded if the source address in their outer IPv6 header has a global unicast prefix assigned for use by globally reachable nodes on the interior network.
</dd>
<dt>REC-7</dt>
<dd>By DEFAULT, packets with unique local source and/or destination addresses <a class='info' href='#RFC4193'>[RFC4193]<span> (</span><span class='info'>Hinden, R. and B. Haberman, &ldquo;Unique Local IPv6 Unicast Addresses,&rdquo; October&nbsp;2005.</span><span>)</span></a> SHOULD NOT be forwarded to or from the exterior network.
</dd>
<dt>REC-8</dt>
<dd>By DEFAULT, inbound DNS queries received on exterior interfaces MUST NOT be processed by any integrated DNS resolving server.
</dd>
<dt>REC-9</dt>
<dd>Inbound DHCPv6 discovery packets <a class='info' href='#RFC3315'>[RFC3315]<span> (</span><span class='info'>Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6),&rdquo; July&nbsp;2003.</span><span>)</span></a> received on exterior interfaces MUST NOT be processed by any integrated DHCPv6 server or relay agent.
</dd>
<dt>REC-10</dt>
<dd>IPv6 gateways MUST forward ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing IP headers that match generic upper-layer transport state records.
</dd>
<dt>REC-11</dt>
<dd>If application transparency is most important, then a stateful packet filter SHOULD have "endpoint independent filter" behavior for generic upper-layer transport protocols. If a more stringent filtering behavior is most important, then a filter SHOULD have "address dependent filtering" behavior. The filtering behavior MAY be an option configurable by the network administrator, and it MAY be independent of the filtering behavior for other protocols. Filtering behavior SHOULD be endpoint independent by DEFAULT in gateways intended for provisioning without service-provider management.
</dd>
<dt>REC-12</dt>
<dd>Filter state records for generic upper-layer transport protocols MUST NOT be deleted or recycled until an idle timer not less than two minutes has expired without having forwarded a packet matching the state in some configurable amount of time. By DEFAULT, the idle timer for such state records is five minutes.
</dd>
<dt>REC-13</dt>
<dd>Residential IPv6 gateways SHOULD provide a convenient means to update their firmware securely, for the installation of security patches and other manufacturer-recommended changes.
</dd>
<dt>REC-14</dt>
<dd>A state record for a UDP flow where both source and destination ports are outside the well-known port range (ports 0-1023) MUST NOT expire in less than two minutes of idle time. The value of the UDP state record idle timer MAY be configurable. The DEFAULT is five minutes.
</dd>
<dt>REC-15</dt>
<dd>A state record for a UDP flow where one or both of the source and destination ports are in the well-known port range (ports 0-1023) MAY expire after a period of idle time shorter than two minutes to facilitate the operation of the IANA-registered service assigned to the port in question.
</dd>
<dt>REC-16</dt>
<dd>A state record for a UDP flow MUST be refreshed when a packet is forwarded from the interior to the exterior, and it MAY be refreshed when a packet is forwarded in the reverse direction.
</dd>
<dt>REC-17</dt>
<dd>If application transparency is most important, then a stateful packet filter SHOULD have "endpoint independent filter" behavior for UDP. If a more stringent filtering behavior is most important, then a filter SHOULD have "address dependent filtering" behavior. The filtering behavior MAY be an option configurable by the network administrator, and it MAY be independent of the filtering behavior for TCP and other protocols. Filtering behavior SHOULD be endpoint independent by DEFAULT in gateways intended for provisioning without service-provider management.
</dd>
<dt>REC-18</dt>
<dd>If a gateway forwards a UDP flow, it MUST also forward ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing UDP headers that match the flow state record.
</dd>
<dt>REC-19</dt>
<dd>Receipt of any sort of ICMPv6 message MUST NOT terminate the state record for a UDP flow.
</dd>
<dt>REC-20</dt>
<dd>UDP-Lite flows <a class='info' href='#RFC3828'>[RFC3828]<span> (</span><span class='info'>Larzon, L-A., Degermark, M., Pink, S., Jonsson, L-E., and G. Fairhurst, &ldquo;The Lightweight User Datagram Protocol (UDP-Lite),&rdquo; July&nbsp;2004.</span><span>)</span></a> SHOULD be handled in the same way as UDP flows, except that the upper-layer transport protocol identifier for UDP-Lite is not the same as UDP, and therefore UDP packets MUST NOT match UDP-Lite state records, and vice versa.
</dd>
<dt>REC-21</dt>
<dd>In their DEFAULT operating mode, IPv6 gateways MUST NOT prohibit the forwarding of packets, to and from legitimate node addresses, with destination extension headers of type <a class='info' href='#RFC4302'>"Authenticated Header (AH)"<span> (</span><span class='info'>Kent, S., &ldquo;IP Authentication Header,&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4302] in their outer IP extension header chain.
</dd>
<dt>REC-22</dt>
<dd>In their DEFAULT operating mode, IPv6 gateways MUST NOT prohibit the forwarding of packets, to and from legitimate node addresses, with an upper layer protocol of type <a class='info' href='#RFC4303'>"Encapsulating Security Payload (ESP)"<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4303] in their outer IP extension header chain.
</dd>
<dt>REC-23</dt>
<dd>If a gateway forwards an ESP flow, it MUST also forward (in the reverse direction) ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing ESP headers that match the flow state record.
</dd>
<dt>REC-24</dt>
<dd>In their DEFAULT operating mode, IPv6 gateways MUST NOT prohibit the forwarding of any UDP packets, to and from legitimate node addresses, with a destination port of 500, i.e. the port reserved by IANA for the <a class='info' href='#RFC5996'>Internet Key Exchange Protocol<span> (</span><span class='info'>Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;Internet Key Exchange Protocol Version 2 (IKEv2),&rdquo; September&nbsp;2010.</span><span>)</span></a> [RFC5996].
</dd>
<dt>REC-25</dt>
<dd>In all operating modes, IPv6 gateways SHOULD use filter state records for <a class='info' href='#RFC4303'>Encapsulating Security Payload (ESP)<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4303] that are indexable by a 3-tuple comprising the interior node address, the exterior node address and the ESP protocol identifier. In particular, the IPv4/NAT method of indexing state records also by security parameters index (SPI) SHOULD NOT be used. Likewise, any mechanism that depends on detection of <a class='info' href='#RFC5996'>Internet Key Exchange (IKE)<span> (</span><span class='info'>Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;Internet Key Exchange Protocol Version 2 (IKEv2),&rdquo; September&nbsp;2010.</span><span>)</span></a> [RFC5996] initiations SHOULD NOT be used.
</dd>
<dt>REC-26</dt>
<dd>In their DEFAULT operating mode, IPv6 gateways MUST NOT prohibit the forwarding of packets, to and from legitimate node addresses, with destination extension headers of type <a class='info' href='#RFC5201'>"Host Identity Protocol (HIP)"<span> (</span><span class='info'>Moskowitz, R., Nikander, P., Jokela, P., and T. Henderson, &ldquo;Host Identity Protocol,&rdquo; April&nbsp;2008.</span><span>)</span></a> [RFC5201] in their outer IP extension header chain.
</dd>
<dt>REC-27</dt>
<dd>The state records for flows initiated by outbound packets that bear a Home Address destination option <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> are distinguished by the addition of the home address of the flow as well as the interior care-of address. IPv6 gateways MUST NOT prohibit the forwarding of any inbound packets bearing type 2 routing headers, which otherwise match a flow state record, and where A) the address in the destination field of the IPv6 header matches the interior care-of address of the flow, and B) the Home Address field in the Type 2 Routing Header matches the home address of the flow.
</dd>
<dt>REC-28</dt>
<dd>Valid sequences of Mobility Header <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> packets MUST be forwarded for all outbound and explicitly permitted inbound Mobility Header flows. 
</dd>
<dt>REC-29</dt>
<dd>If a gateway forwards a Mobility Header <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> flow, then it MUST also forward, in both directions, the IPv4 and IPv6 packets that are encapsulated in IPv6 associated with the tunnel between the home agent and the correspondent node.
</dd>
<dt>REC-30</dt>
<dd>If a gateway forwards a Mobility Header <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a> flow, then it MUST also forward (in the reverse direction) ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing any headers that match the associated flow state records.
</dd>
<dt>REC-31</dt>
<dd>All valid sequences of TCP packets (defined in <a class='info' href='#RFC0793'>[RFC0793]<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>) MUST be forwarded for outbound flows and explicitly permitted inbound flows. In particular, both the normal TCP 3-way handshake mode of operation and the simultaneous-open modes of operation MUST be supported.
</dd>
<dt>REC-32</dt>
<dd>The TCP window invariant MUST NOT be enforced on flows for which the filter did not detect whether the window-scale option (see <a class='info' href='#RFC1323'>[RFC1323]<span> (</span><span class='info'>Jacobson, V., Braden, B., and D. Borman, &ldquo;TCP Extensions for High Performance,&rdquo; May&nbsp;1992.</span><span>)</span></a>) was sent in the 3-way handshake or simultaneous open.
</dd>
<dt>REC-33</dt>
<dd>If application transparency is most important, then a stateful packet filter SHOULD have "endpoint independent filter" behavior for TCP. If a more stringent filtering behavior is most important, then a filter SHOULD have "address dependent filtering" behavior. The filtering behavior MAY be an option configurable by the network administrator, and it MAY be independent of the filtering behavior for UDP and other protocols. Filtering behavior SHOULD be endpoint independent by DEFAULT in gateways intended for provisioning without service-provider management.
</dd>
<dt>REC-34</dt>
<dd>By DEFAULT, a gateway MUST respond with an ICMPv6 "Destination Unreachable" error code 1 (administratively prohibited) to any unsolicited inbound SYN packet after waiting at least 6 seconds without first forwarding the associated outbound SYN or SYN/ACK from the interior peer.
</dd>
<dt>REC-35</dt>
<dd>If a gateway cannot determine whether the endpoints of a TCP flow are active, then it MAY abandon the state record if it has been idle for some time. In such cases, the value of the "established flow idle-timeout" MUST NOT be less than two hours four minutes, as discussed in <a class='info' href='#RFC5382'>[RFC5382]<span> (</span><span class='info'>Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;NAT Behavioral Requirements for TCP,&rdquo; October&nbsp;2008.</span><span>)</span></a>. The value of the "transitory flow idle-timeout" MUST NOT be less than four minutes. The value of the idle-timeouts MAY be configurable by the network administrator.
</dd>
<dt>REC-36</dt>
<dd>If a gateway forwards a TCP flow, it MUST also forward ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing TCP headers that match the flow state record.
</dd>
<dt>REC-37</dt>
<dd>Receipt of any sort of ICMPv6 message MUST NOT terminate the state record for a TCP flow.
</dd>
<dt>REC-38</dt>
<dd>All valid sequences of SCTP packets (defined in <a class='info' href='#RFC4960'>[RFC4960]<span> (</span><span class='info'>Stewart, R., &ldquo;Stream Control Transmission Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a>) MUST be forwarded for outbound associations and explicitly permitted inbound associations. In particular, both the normal SCTP association establishment and simultaneous-open modes of operation MUST be supported.
</dd>
<dt>REC-39</dt>
<dd>By DEFAULT, a gateway MUST respond with an ICMPv6 "Destination Unreachable" error code 1 (administratively prohibited) to any unsolicited inbound INIT packet after waiting at least 6 seconds without first forwarding the associated outbound INIT from the interior peer.
</dd>
<dt>REC-40</dt>
<dd>If a gateway cannot determine whether the endpoints of an SCTP association are active, then it MAY abandon the state record if it has been idle for some time. In such cases, the value of the "established association idle-timeout" MUST NOT be less than two hours four minutes. The value of the "transitory association idle-timeout" MUST NOT be less than four minutes. The value of the idle-timeouts MAY be configurable by the network administrator.
</dd>
<dt>REC-41</dt>
<dd>If a gateway forwards an SCTP association, it MUST also forward ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing SCTP headers that match the association state record.
</dd>
<dt>REC-42</dt>
<dd>Receipt of any sort of ICMPv6 message MUST NOT terminate the state record for an SCTP association.
</dd>
<dt>REC-43</dt>
<dd>All valid sequences of DCCP packets (defined in <a class='info' href='#RFC4340'>[RFC4340]<span> (</span><span class='info'>Kohler, E., Handley, M., and S. Floyd, &ldquo;Datagram Congestion Control Protocol (DCCP),&rdquo; March&nbsp;2006.</span><span>)</span></a>) MUST be forwarded for all flows to exterior servers and those flows to interior servers with explicitly permitted service codes.
</dd>
<dt>REC-44</dt>
<dd>A gateway MAY abandon a DCCP state record if it has been idle for some time. In such cases, the value of the "established flow idle-timeout" MUST NOT be less than two hours four minutes. The value of the "transitory flow idle-timeout" MUST NOT be less than eight minutes. The value of the idle-timeouts MAY be configurable  by the network administrator.
</dd>
<dt>REC-45</dt>
<dd>If a gateway forwards a DCCP flow, it MUST also forward ICMPv6 "Destination Unreachable" and "Packet Too Big" messages containing DCCP headers that match the flow state record.
</dd>
<dt>REC-46</dt>
<dd>Receipt of any sort of ICMPv6 message MUST NOT terminate the state record for a DCCP flow.
</dd>
<dt>REC-47</dt>
<dd>Valid sequences of packets bearing SHIM6 payload extension headers in their outer IP extension header chains MUST be forwarded for all outbound and explicitly permitted flows.  The content of the SHIM6 payload extension header MAY be ignored for the purpose of state tracking.
</dd>
<dt>REC-48</dt>
<dd>Gateways SHOULD implement a protocol to permit applications to solicit inbound traffic without advance knowledge of the addresses of exterior nodes with which they expect to communicate.
</dd>
<dt>REC-49</dt>
<dd>Gateways MUST provide an easily selected configuration option that permits a "transparent mode" of operation that forwards all unsolicited flows regardless of forwarding direction, i.e. to disable the IPv6 simple security capabilities of the gateway. The transparent mode of operation MAY be the default configuration.
</dd>
<dt>REC-50</dt>
<dd>By DEFAULT, subscriber managed residential gateways MUST NOT offer management application services to the exterior network.
</dd>
</dl></blockquote>

<a name="contrib"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Contributors</h3>

<p>Comments and criticisms during the development of this document were received from the following IETF participants:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr>
<td align="left">Jari Arkko</td>
<td align="left">Ran Atkinson</td>
</tr>
<tr>
<td align="left">Fred Baker</td>
<td align="left">Norbert Bollow</td>
</tr>
<tr>
<td align="left">Cameron Byrne</td>
<td align="left">Brian Carpenter</td>
</tr>
<tr>
<td align="left">Remi Despres</td>
<td align="left">Arnaud Ebalard</td>
</tr>
<tr>
<td align="left">Fabrice Fontaine</td>
<td align="left">Jun-ichiro "itojun" Hagino</td>
</tr>
<tr>
<td align="left">Thomas Herbst</td>
<td align="left">Christian Huitema</td>
</tr>
<tr>
<td align="left">Joel Jaeggli</td>
<td align="left">Cullen Jennings</td>
</tr>
<tr>
<td align="left">Suresh Krishnan</td>
<td align="left">Erik Kline</td>
</tr>
<tr>
<td align="left">Julien Laganier</td>
<td align="left">Kurt Erik Lindqvist</td>
</tr>
<tr>
<td align="left">Boucadair Mohamed</td>
<td align="left">Keith Moore</td>
</tr>
<tr>
<td align="left">Robert Moskowitz</td>
<td align="left">Teemu Savolainen</td>
</tr>
<tr>
<td align="left">Hemant Singh</td>
<td align="left">Yaron Sheffer</td>
</tr>
<tr>
<td align="left">Mark Townsley</td>
<td align="left">Iljitsch van Beijnum</td>
</tr>
<tr>
<td align="left">Magnus Westerlund</td>
<td align="left">Dan Wing</td>
</tr>
</table>
<br clear="all" />

<p>The editor thanks them all for their contributions.
</p>
<p>It must be noted that a substantial portion of the text describing the detailed requirements for TCP and UDP filtering is derived or transposed from <a class='info' href='#RFC4787'>[RFC4787]<span> (</span><span class='info'>Audet, F. and C. Jennings, &ldquo;Network Address Translation (NAT) Behavioral Requirements for Unicast UDP,&rdquo; January&nbsp;2007.</span><span>)</span></a> and <a class='info' href='#RFC5382'>[RFC5382]<span> (</span><span class='info'>Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;NAT Behavioral Requirements for TCP,&rdquo; October&nbsp;2008.</span><span>)</span></a>. The editors of those documents, Francois Audet and Saikat Guha, also deserve substantial credit for the form of the present document.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This memo includes no request to IANA.
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>The IPv6 stateful filtering behavior described in this document is intended to be similar in function to the filtering behavior of commonly use IPv4/NAT gateways, which have been widely sold as a security tool for residential and small-office/home-office networks. As noted in the security considerations section of <a class='info' href='#RFC2993'>[RFC2993]<span> (</span><span class='info'>Hain, T., &ldquo;Architectural Implications of NAT,&rdquo; November&nbsp;2000.</span><span>)</span></a>, the true impact of these tools may be a reduction in security. It may be generally assumed that the impacts discussed in that document related to filtering (and not translation) are to be expected with the simple IPv6 security mechanisms described here.
</p>
<p>In particular, it is worth noting that stateful filters create the illusion of a security barrier, but without the managed intent of a firewall. Appropriate security mechanisms implemented in the end nodes, in conjunction with the <a class='info' href='#RFC4864'>[RFC4864]<span> (</span><span class='info'>Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;Local Network Protection for IPv6,&rdquo; May&nbsp;2007.</span><span>)</span></a> local network protection methods, function without reliance on network layer hacks and transport filters that may change over time. Also, defined security barriers assume that threats originate in the exterior, which may lead to practices that result in applications being fully exposed to interior attack and which therefore make breaches much easier.
</p>
<p>The security functions described in this document may be considered redundant in the event that all IPv6 hosts using a particular gateway have their own IPv6 host firewall capabilities enabled. At the time of this writing, the vast majority of commercially available operating systems with support for IPv6 include IPv6 host firewall capability.
</p>
<p>Also worth noting explicitly, a practical side-effect of the recommendations in <a class='info' href='#ipsec'>Section&nbsp;3.2.4<span> (</span><span class='info'>IPsec and Internet Key Exchange (IKE)</span><span>)</span></a>, to allow inbound IPsec and IKE flows from exterior to interior, is to facilitate more transparent communication by the use of <a class='info' href='#RFC5386'>Better-Than-Nothing-Security: An Unauthenticated Mode of IPsec<span> (</span><span class='info'>Williams, N. and M. Richardson, &ldquo;Better-Than-Nothing Security: An Unauthenticated Mode of IPsec,&rdquo; November&nbsp;2008.</span><span>)</span></a> [RFC5386], and this may be a departure from expectations of transparency set by traditional IPv4/NAT residential gateways.
</p>
<p>Finally, residential gateways that implement simple security functions are a bastion between the interior and the exterior, and therefore are a target of denial of service attacks against the interior network itself by processes designed to consume the resources of the gateway, e.g. a ping or SYN flood. Gateways should employ the same sorts of protection techniques as application servers on the Internet.
</p>
<p>IETF makes no statement, expressed or implied, as to whether using the capabilities described in this document ultimately improve security for any individual users or for the Internet community as a whole.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC0768">[RFC0768]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc768">User Datagram Protocol</a>,&rdquo; STD&nbsp;6, RFC&nbsp;768, August&nbsp;1980 (<a href="http://www.rfc-editor.org/rfc/rfc768.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0793">[RFC0793]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc793">Transmission Control Protocol</a>,&rdquo; STD&nbsp;7, RFC&nbsp;793, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc793.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1323">[RFC1323]</a></td>
<td class="author-text"><a href="mailto:van@CSAM.LBL.GOV">Jacobson, V.</a>, <a href="mailto:Braden@ISI.EDU">Braden, B.</a>, and <a href="mailto:dab@cray.com">D. Borman</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1323">TCP Extensions for High Performance</a>,&rdquo; RFC&nbsp;1323, May&nbsp;1992 (<a href="http://www.rfc-editor.org/rfc/rfc1323.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2460">[RFC2460]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a> and <a href="mailto:hinden@iprg.nokia.com">R. Hinden</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;2460, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2460.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2460.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2460.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3315">[RFC3315]</a></td>
<td class="author-text">Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>,&rdquo; RFC&nbsp;3315, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3315.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3775">[RFC3775]</a></td>
<td class="author-text">Johnson, D., Perkins, C., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3775">Mobility Support in IPv6</a>,&rdquo; RFC&nbsp;3775, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3775.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3828">[RFC3828]</a></td>
<td class="author-text">Larzon, L-A., Degermark, M., Pink, S., Jonsson, L-E., and G. Fairhurst, &ldquo;<a href="http://tools.ietf.org/html/rfc3828">The Lightweight User Datagram Protocol (UDP-Lite)</a>,&rdquo; RFC&nbsp;3828, July&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3828.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3879">[RFC3879]</a></td>
<td class="author-text">Huitema, C. and B. Carpenter, &ldquo;<a href="http://tools.ietf.org/html/rfc3879">Deprecating Site Local Addresses</a>,&rdquo; RFC&nbsp;3879, September&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3879.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4007">[RFC4007]</a></td>
<td class="author-text">Deering, S., Haberman, B., Jinmei, T., Nordmark, E., and B. Zill, &ldquo;<a href="http://tools.ietf.org/html/rfc4007">IPv6 Scoped Address Architecture</a>,&rdquo; RFC&nbsp;4007, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4007.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4193">[RFC4193]</a></td>
<td class="author-text">Hinden, R. and B. Haberman, &ldquo;<a href="http://tools.ietf.org/html/rfc4193">Unique Local IPv6 Unicast Addresses</a>,&rdquo; RFC&nbsp;4193, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4193.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4302">[RFC4302]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4302">IP Authentication Header</a>,&rdquo; RFC&nbsp;4302, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4302.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4303">[RFC4303]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4303">IP Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;4303, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4303.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4340">[RFC4340]</a></td>
<td class="author-text">Kohler, E., Handley, M., and S. Floyd, &ldquo;<a href="http://tools.ietf.org/html/rfc4340">Datagram Congestion Control Protocol (DCCP)</a>,&rdquo; RFC&nbsp;4340, March&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4340.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4443">[RFC4443]</a></td>
<td class="author-text">Conta, A., Deering, S., and M. Gupta, &ldquo;<a href="http://tools.ietf.org/html/rfc4443">Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;4443, March&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4443.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4787">[RFC4787]</a></td>
<td class="author-text">Audet, F. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4787">Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</a>,&rdquo; BCP&nbsp;127, RFC&nbsp;4787, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4787.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4890">[RFC4890]</a></td>
<td class="author-text">Davies, E. and J. Mohacsi, &ldquo;<a href="http://tools.ietf.org/html/rfc4890">Recommendations for Filtering ICMPv6 Messages in Firewalls</a>,&rdquo; RFC&nbsp;4890, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4890.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4960">[RFC4960]</a></td>
<td class="author-text">Stewart, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4960">Stream Control Transmission Protocol</a>,&rdquo; RFC&nbsp;4960, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4960.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5095">[RFC5095]</a></td>
<td class="author-text">Abley, J., Savola, P., and G. Neville-Neil, &ldquo;<a href="http://tools.ietf.org/html/rfc5095">Deprecation of Type 0 Routing Headers in IPv6</a>,&rdquo; RFC&nbsp;5095, December&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5095.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5156">[RFC5156]</a></td>
<td class="author-text">Blanchet, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5156">Special-Use IPv6 Addresses</a>,&rdquo; RFC&nbsp;5156, April&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5156.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5201">[RFC5201]</a></td>
<td class="author-text">Moskowitz, R., Nikander, P., Jokela, P., and T. Henderson, &ldquo;<a href="http://tools.ietf.org/html/rfc5201">Host Identity Protocol</a>,&rdquo; RFC&nbsp;5201, April&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5201.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5996">[RFC5996]</a></td>
<td class="author-text">Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc5996">Internet Key Exchange Protocol Version 2 (IKEv2)</a>,&rdquo; RFC&nbsp;5996, September&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5996.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.cheshire-nat-pmp">[I-D.cheshire-nat-pmp]</a></td>
<td class="author-text">Cheshire, S., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-cheshire-nat-pmp-03.txt">NAT Port Mapping Protocol (NAT-PMP)</a>,&rdquo; draft-cheshire-nat-pmp-03 (work in progress), April&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-cheshire-nat-pmp-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.woodyatt-ald">[I-D.woodyatt-ald]</a></td>
<td class="author-text">Woodyatt, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-woodyatt-ald-03.txt">Application Listener Discovery (ALD) for IPv6</a>,&rdquo; draft-woodyatt-ald-03 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-woodyatt-ald-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1122">[RFC1122]</a></td>
<td class="author-text"><a href="mailto:Braden@ISI.EDU">Braden, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1122">Requirements for Internet Hosts - Communication Layers</a>,&rdquo; STD&nbsp;3, RFC&nbsp;1122, October&nbsp;1989 (<a href="http://www.rfc-editor.org/rfc/rfc1122.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1337">[RFC1337]</a></td>
<td class="author-text"><a href="mailto:EMail: Braden@ISI.EDU">Braden, B.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1337">TIME-WAIT Assassination Hazards in TCP</a>,&rdquo; RFC&nbsp;1337, May&nbsp;1992 (<a href="http://www.rfc-editor.org/rfc/rfc1337.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1918">[RFC1918]</a></td>
<td class="author-text"><a href="mailto:yakov@cisco.com">Rekhter, Y.</a>, <a href="mailto:rgm3@is.chrysler.com">Moskowitz, R.</a>, <a href="mailto:Daniel.Karrenberg@ripe.net">Karrenberg, D.</a>, <a href="mailto:GeertJan.deGroot@ripe.net">Groot, G.</a>, and <a href="mailto:lear@sgi.com">E. Lear</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1918">Address Allocation for Private Internets</a>,&rdquo; BCP&nbsp;5, RFC&nbsp;1918, February&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1918.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2473">[RFC2473]</a></td>
<td class="author-text"><a href="mailto:aconta@lucent.com">Conta, A.</a> and <a href="mailto:deering@cisco.com">S. Deering</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2473">Generic Packet Tunneling in IPv6 Specification</a>,&rdquo; RFC&nbsp;2473, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2473.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2473.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2473.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2827">[RFC2827]</a></td>
<td class="author-text">Ferguson, P. and D. Senie, &ldquo;<a href="http://tools.ietf.org/html/rfc2827">Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing</a>,&rdquo; BCP&nbsp;38, RFC&nbsp;2827, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2827.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2993">[RFC2993]</a></td>
<td class="author-text">Hain, T., &ldquo;<a href="http://tools.ietf.org/html/rfc2993">Architectural Implications of NAT</a>,&rdquo; RFC&nbsp;2993, November&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2993.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3704">[RFC3704]</a></td>
<td class="author-text">Baker, F. and P. Savola, &ldquo;<a href="http://tools.ietf.org/html/rfc3704">Ingress Filtering for Multihomed Networks</a>,&rdquo; BCP&nbsp;84, RFC&nbsp;3704, March&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3704.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4080">[RFC4080]</a></td>
<td class="author-text">Hancock, R., Karagiannis, G., Loughney, J., and S. Van den Bosch, &ldquo;<a href="http://tools.ietf.org/html/rfc4080">Next Steps in Signaling (NSIS): Framework</a>,&rdquo; RFC&nbsp;4080, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4080.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4294">[RFC4294]</a></td>
<td class="author-text">Loughney, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4294">IPv6 Node Requirements</a>,&rdquo; RFC&nbsp;4294, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4294.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4864">[RFC4864]</a></td>
<td class="author-text">Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;<a href="http://tools.ietf.org/html/rfc4864">Local Network Protection for IPv6</a>,&rdquo; RFC&nbsp;4864, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4864.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4949">[RFC4949]</a></td>
<td class="author-text">Shirey, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>,&rdquo; RFC&nbsp;4949, August&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4949.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5189">[RFC5189]</a></td>
<td class="author-text">Stiemerling, M., Quittek, J., and T. Taylor, &ldquo;<a href="http://tools.ietf.org/html/rfc5189">Middlebox Communication (MIDCOM) Protocol Semantics</a>,&rdquo; RFC&nbsp;5189, March&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5189.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5382">[RFC5382]</a></td>
<td class="author-text">Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P. Srisuresh, &ldquo;<a href="http://tools.ietf.org/html/rfc5382">NAT Behavioral Requirements for TCP</a>,&rdquo; BCP&nbsp;142, RFC&nbsp;5382, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5382.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5386">[RFC5386]</a></td>
<td class="author-text">Williams, N. and M. Richardson, &ldquo;<a href="http://tools.ietf.org/html/rfc5386">Better-Than-Nothing Security: An Unauthenticated Mode of IPsec</a>,&rdquo; RFC&nbsp;5386, November&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5386.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5389">[RFC5389]</a></td>
<td class="author-text">Rosenberg, J., Mahy, R., Matthews, P., and D. Wing, &ldquo;<a href="http://tools.ietf.org/html/rfc5389">Session Traversal Utilities for NAT (STUN)</a>,&rdquo; RFC&nbsp;5389, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5389.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5533">[RFC5533]</a></td>
<td class="author-text">Nordmark, E. and M. Bagnulo, &ldquo;<a href="http://tools.ietf.org/html/rfc5533">Shim6: Level 3 Multihoming Shim Protocol for IPv6</a>,&rdquo; RFC&nbsp;5533, June&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5533.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="UPnP-IGD">[UPnP-IGD]</a></td>
<td class="author-text">UPnP Forum, &ldquo;<a href="http://upnp.org/specs/gw/igd2/">Universal Plug and Play Internet Gateway Device Standardized Gateway Device Protocol</a>,&rdquo; September&nbsp;2010.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">james woodyatt (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Apple Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1 Infinite Loop</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cupertino, CA  95014</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jhw@apple.com">jhw@apple.com</a></td></tr>
</table>
</body></html>
