<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Network Configuration Protocol Access Control Model </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology">
<link href="#rfc.section.1.1.1" rel="Chapter" title="1.1.1 Requirements Notation">
<link href="#rfc.section.1.1.2" rel="Chapter" title="1.1.2 NETCONF Terms">
<link href="#rfc.section.1.1.3" rel="Chapter" title="1.1.3 YANG Terms">
<link href="#rfc.section.1.1.4" rel="Chapter" title="1.1.4 NACM Terms">
<link href="#rfc.section.2" rel="Chapter" title="2 Access Control Requirements">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Protocol Control Points">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Simplicity">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Procedural Interface">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Datastore Access">
<link href="#rfc.section.2.4.1" rel="Chapter" title="2.4.1 Access Rights">
<link href="#rfc.section.2.4.2" rel="Chapter" title="2.4.2 &lt;get&gt; and &lt;get-config&gt; Operations">
<link href="#rfc.section.2.4.3" rel="Chapter" title="2.4.3 &lt;edit-config&gt; Operation">
<link href="#rfc.section.2.4.4" rel="Chapter" title="2.4.4 &lt;copy-config&gt; Operation">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 Users and Groups">
<link href="#rfc.section.2.6" rel="Chapter" title="2.6 Maintenance">
<link href="#rfc.section.2.7" rel="Chapter" title="2.7 Configuration Capabilities">
<link href="#rfc.section.2.8" rel="Chapter" title="2.8 Identifying Security Holes">
<link href="#rfc.section.2.9" rel="Chapter" title="2.9 Data Shadowing">
<link href="#rfc.section.2.10" rel="Chapter" title="2.10 NETCONF Specific Requirements">
<link href="#rfc.section.3" rel="Chapter" title="3 NETCONF Access Control Model (NACM)">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Introduction">
<link href="#rfc.section.3.1.1" rel="Chapter" title="3.1.1 Features">
<link href="#rfc.section.3.1.2" rel="Chapter" title="3.1.2 External Dependencies">
<link href="#rfc.section.3.1.3" rel="Chapter" title="3.1.3 Message Processing Model">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Model Components">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Users">
<link href="#rfc.section.3.2.2" rel="Chapter" title="3.2.2 Groups">
<link href="#rfc.section.3.2.3" rel="Chapter" title="3.2.3 Sessions">
<link href="#rfc.section.3.2.4" rel="Chapter" title="3.2.4 Access Permissions">
<link href="#rfc.section.3.2.5" rel="Chapter" title="3.2.5 Global Enforcement Controls">
<link href="#rfc.section.3.2.6" rel="Chapter" title="3.2.6 Access Control Rules">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Access Control Enforcement Procedures">
<link href="#rfc.section.3.3.1" rel="Chapter" title="3.3.1 Initial Operation">
<link href="#rfc.section.3.3.2" rel="Chapter" title="3.3.2 Session Establishment">
<link href="#rfc.section.3.3.3" rel="Chapter" title="3.3.3 'access-denied' Error Handling">
<link href="#rfc.section.3.3.4" rel="Chapter" title="3.3.4 Incoming RPC Message Validation">
<link href="#rfc.section.3.3.5" rel="Chapter" title="3.3.5 Data Node Access Validation">
<link href="#rfc.section.3.3.6" rel="Chapter" title="3.3.6 Outgoing &lt;rpc-reply&gt; Authorization">
<link href="#rfc.section.3.3.7" rel="Chapter" title="3.3.7 Outgoing &lt;notification&gt; Authorization">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Data Model Definitions">
<link href="#rfc.section.3.4.1" rel="Chapter" title="3.4.1 High Level Procedures">
<link href="#rfc.section.3.4.2" rel="Chapter" title="3.4.2 Data Organization">
<link href="#rfc.section.3.4.3" rel="Chapter" title="3.4.3 YANG Module">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 IANA Considerations">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="4 References">
<link href="#rfc.references.1" rel="Chapter" title="4.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="4.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Usage Examples">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 &lt;groups&gt; Example">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 &lt;module-rule&gt; Example">
<link href="#rfc.appendix.Appendix%20A.3" rel="Chapter" title="Appendix A.3 &lt;rpc-rule&gt; Example">
<link href="#rfc.appendix.Appendix%20A.4" rel="Chapter" title="Appendix A.4 &lt;data-rule&gt; Example">
<link href="#rfc.appendix.Appendix%20A.5" rel="Chapter" title="Appendix A.5 &lt;notification-rule&gt; Example">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Change Log">
<link href="#rfc.appendix.Appendix%20B.1" rel="Chapter" title="Appendix B.1 02-03">
<link href="#rfc.appendix.Appendix%20B.2" rel="Chapter" title="Appendix B.2 01-02">
<link href="#rfc.appendix.Appendix%20B.3" rel="Chapter" title="Appendix B.3 00-01">
<link href="#rfc.appendix.Appendix%20B.4" rel="Chapter" title="Appendix B.4 00">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The standardization of network configuration interfaces for use with the NETCONF protocol requires a structured and secure operating environment, which promotes human usability and multi-vendor interoperability.  There is a need for standard mechanisms to restrict NETCONF protocol access for particular users to a pre-configured subset of all available NETCONF operations and content.  This document discusses requirements for a suitable access control model, and provides one solution which meets these requirements.  " />
  <meta name="description" content="The standardization of network configuration interfaces for use with the NETCONF protocol requires a structured and secure operating environment, which promotes human usability and multi-vendor interoperability.  There is a need for standard mechanisms to restrict NETCONF protocol access for particular users to a pre-configured subset of all available NETCONF operations and content.  This document discusses requirements for a suitable access control model, and provides one solution which meets these requirements.  " />
  <meta name="keywords" content="NETCONF, YANG, XML" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">A.B. Bierman</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Brocade</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">M.B. Bjorklund</td>
</tr>
<tr>
<td class="left">Expires: September 12, 2011</td>
<td class="right">Tail-f Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">March 11, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Network Configuration Protocol Access Control Model <br />
  <span class="filename">draft-ietf-netconf-access-control-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The standardization of network configuration interfaces for use with the NETCONF protocol requires a structured and secure operating environment, which promotes human usability and multi-vendor interoperability.  There is a need for standard mechanisms to restrict NETCONF protocol access for particular users to a pre-configured subset of all available NETCONF operations and content.  This document discusses requirements for a suitable access control model, and provides one solution which meets these requirements.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 12, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Terminology</a>
</li>
<li>1.1.1.   <a href="#rfc.section.1.1.1">Requirements Notation</a>
</li>
<li>1.1.2.   <a href="#rfc.section.1.1.2">NETCONF Terms</a>
</li>
<li>1.1.3.   <a href="#rfc.section.1.1.3">YANG Terms</a>
</li>
<li>1.1.4.   <a href="#rfc.section.1.1.4">NACM Terms</a>
</li>
<li>2.   <a href="#rfc.section.2">Access Control Requirements</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Protocol Control Points</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Simplicity</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Procedural Interface</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">Datastore Access</a>
</li>
<li>2.4.1.   <a href="#rfc.section.2.4.1">Access Rights</a>
</li>
<li>2.4.2.   <a href="#rfc.section.2.4.2">&lt;get&gt; and &lt;get-config&gt; Operations</a>
</li>
<li>2.4.3.   <a href="#rfc.section.2.4.3">&lt;edit-config&gt; Operation</a>
</li>
<li>2.4.4.   <a href="#rfc.section.2.4.4">&lt;copy-config&gt; Operation</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">Users and Groups</a>
</li>
<li>2.6.   <a href="#rfc.section.2.6">Maintenance</a>
</li>
<li>2.7.   <a href="#rfc.section.2.7">Configuration Capabilities</a>
</li>
<li>2.8.   <a href="#rfc.section.2.8">Identifying Security Holes</a>
</li>
<li>2.9.   <a href="#rfc.section.2.9">Data Shadowing</a>
</li>
<li>2.10.   <a href="#rfc.section.2.10">NETCONF Specific Requirements</a>
</li>
<li>3.   <a href="#rfc.section.3">NETCONF Access Control Model (NACM)</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Introduction</a>
</li>
<li>3.1.1.   <a href="#rfc.section.3.1.1">Features</a>
</li>
<li>3.1.2.   <a href="#rfc.section.3.1.2">External Dependencies</a>
</li>
<li>3.1.3.   <a href="#rfc.section.3.1.3">Message Processing Model</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Model Components</a>
</li>
<li>3.2.1.   <a href="#rfc.section.3.2.1">Users</a>
</li>
<li>3.2.2.   <a href="#rfc.section.3.2.2">Groups</a>
</li>
<li>3.2.3.   <a href="#rfc.section.3.2.3">Sessions</a>
</li>
<li>3.2.4.   <a href="#rfc.section.3.2.4">Access Permissions</a>
</li>
<li>3.2.5.   <a href="#rfc.section.3.2.5">Global Enforcement Controls</a>
</li>
<li>3.2.6.   <a href="#rfc.section.3.2.6">Access Control Rules</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Access Control Enforcement Procedures</a>
</li>
<li>3.3.1.   <a href="#rfc.section.3.3.1">Initial Operation</a>
</li>
<li>3.3.2.   <a href="#rfc.section.3.3.2">Session Establishment</a>
</li>
<li>3.3.3.   <a href="#rfc.section.3.3.3">'access-denied' Error Handling</a>
</li>
<li>3.3.4.   <a href="#rfc.section.3.3.4">Incoming RPC Message Validation</a>
</li>
<li>3.3.5.   <a href="#rfc.section.3.3.5">Data Node Access Validation</a>
</li>
<li>3.3.6.   <a href="#rfc.section.3.3.6">Outgoing &lt;rpc-reply&gt; Authorization</a>
</li>
<li>3.3.7.   <a href="#rfc.section.3.3.7">Outgoing &lt;notification&gt; Authorization</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Data Model Definitions</a>
</li>
<li>3.4.1.   <a href="#rfc.section.3.4.1">High Level Procedures</a>
</li>
<li>3.4.2.   <a href="#rfc.section.3.4.2">Data Organization</a>
</li>
<li>3.4.3.   <a href="#rfc.section.3.4.3">YANG Module</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">IANA Considerations</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">Security Considerations</a>
</li>
<li>4.   <a href="#rfc.references">References</a>
</li>
<li>4.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>4.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Usage Examples</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">&lt;groups&gt; Example</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">&lt;module-rule&gt; Example</a>
</li>
<li>Appendix A.3.   <a href="#rfc.appendix.Appendix%20A.3">&lt;rpc-rule&gt; Example</a>
</li>
<li>Appendix A.4.   <a href="#rfc.appendix.Appendix%20A.4">&lt;data-rule&gt; Example</a>
</li>
<li>Appendix A.5.   <a href="#rfc.appendix.Appendix%20A.5">&lt;notification-rule&gt; Example</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Change Log</a>
</li>
<li>Appendix B.1.   <a href="#rfc.appendix.Appendix%20B.1">02-03</a>
</li>
<li>Appendix B.2.   <a href="#rfc.appendix.Appendix%20B.2">01-02</a>
</li>
<li>Appendix B.3.   <a href="#rfc.appendix.Appendix%20B.3">00-01</a>
</li>
<li>Appendix B.4.   <a href="#rfc.appendix.Appendix%20B.4">00</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The NETCONF protocol does not provide any standard mechanisms to restrict the operations and content that each user is authorized to use.  </p>
<p id="rfc.section.1.p.2">There is a need for inter-operable management of the controlled access to operator selected portions of the available NETCONF content within a particular server.  </p>
<p id="rfc.section.1.p.3">This document addresses access control mechanisms for the Operation and Content layers of NETCONF, as defined in <a href="#I-D.ietf-netconf-4741bis">[I-D.ietf-netconf-4741bis]</a>, and <a href="#RFC5277">[RFC5277]</a>.  It contains three main sections: </p>

<ol>
<li>Access Control Requirements</li>
<li>NETCONF Access Control Model (NACM)</li>
<li>YANG Data Model (ietf-netconf-acm.yang)</li>
</ol>

<p> </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Terminology</h1>
<h1 id="rfc.section.1.1.1">
<a href="#rfc.section.1.1.1">1.1.1.</a> Requirements Notation</h1>
<p id="rfc.section.1.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<h1 id="rfc.section.1.1.2">
<a href="#rfc.section.1.1.2">1.1.2.</a> NETCONF Terms</h1>
<p id="rfc.section.1.1.2.p.1">The following terms are defined in <a href="#I-D.ietf-netconf-4741bis">[I-D.ietf-netconf-4741bis]</a> and are not redefined here: </p>

<ul>
<li>client</li>
<li>datastore</li>
<li>operation</li>
<li>protocol operation</li>
<li>server</li>
<li>session</li>
<li>user</li>
</ul>

<p> </p>
<h1 id="rfc.section.1.1.3">
<a href="#rfc.section.1.1.3">1.1.3.</a> YANG Terms</h1>
<p id="rfc.section.1.1.3.p.1">The following terms are defined in <a href="#RFC6020">[RFC6020]</a> and are not redefined here: </p>

<ul><li>data node</li></ul>

<p> </p>
<h1 id="rfc.section.1.1.4">
<a href="#rfc.section.1.1.4">1.1.4.</a> NACM Terms</h1>
<p id="rfc.section.1.1.4.p.1">The following terms are used throughout this documentation: </p>

<dl>
<dt>access control:</dt>
<dd style="margin-left: 8">A security feature provided by the NETCONF server, which allows an operator to restrict access to a subset of all NETCONF protocol operations and data, based on various criteria.  </dd>
<dt>access control model (ACM):</dt>
<dd style="margin-left: 8">A conceptual model used to configure and monitor the access control procedures desired by the operator to enforce a particular access control policy.  </dd>
<dt>access control rule:</dt>
<dd style="margin-left: 8">The conceptual criteria used to determine if a particular NETCONF protocol operation will be permitted or denied.  </dd>
<dt>authentication:</dt>
<dd style="margin-left: 8">The process of verifying a user's identity.  </dd>
<dt>superuser:</dt>
<dd style="margin-left: 8">The special administrative user account which is given unlimited NETCONF access, and is exempt from all access control enforcement.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Access Control Requirements</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Protocol Control Points</h1>
<p id="rfc.section.2.1.p.1">The NETCONF protocol allows new operations to be added at any time, and the YANG data modeling language supports this feature.  It is not possible to design an ACM for NETCONF which only focuses on a static set of operations, like some other protocols.  Since few assumptions can be made about an arbitrary protocol operation, the NETCONF architectural server components need to be protected at several conceptual control points.  </p>
<div id="#rfc.figure.1"></div>
<div id="#control_points"></div>
<pre>
              +-------------+          +-------------+
 client       |  protocol   |          |   prune     |      client
 request --&gt;  |  operation  |          | restricted  | ---&gt; reply
              |  allowed?   |          | &lt;rpc-reply&gt; |
              +-------------+          |   nodes?    |
                    |                  +-------------+
                    | if any datastore or
                    | state data is accessed
                    | by the operation
                    V
              +-------------+          +----------------+
              |  data node  |          |   prune        | 
              |   access    |          | restricted     |
              |  allowed?   |          | &lt;notification&gt; | ---&gt; client
              +-------------+          | event or data? |     session
                                       +----------------+
            
          </pre>
<p></p>
<p id="rfc.section.2.1.p.3">The following access control points are defined: </p>

<dl>
<dt>protocol operation:</dt>
<dd style="margin-left: 8">Configurable permission to invoke specific protocol operations is required.  Wildcard or multiple target mechanisms to reduce configuration and effort are also required.  </dd>
<dt>NETCONF datastore:</dt>
<dd style="margin-left: 8">Configurable permission to read and/or alter specific data nodes within any conceptual datastore is required.  Wildcard or multiple target mechanisms to reduce configuration and effort are also required.  </dd>
<dt>RPC Reply Content:</dt>
<dd style="margin-left: 8">Configurable permission to read specific data nodes within any conceptual RPC output section is required.  Unauthorized data is silently omitted from the reply, instead of dropping the reply or sending an 'access-denied' error.  </dd>
<dt>Notification Content:</dt>
<dd style="margin-left: 8">Configurable permission to receive specific notification event types is required.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Simplicity</h1>
<p id="rfc.section.2.2.p.1">Experience has shown that a complicated ACM will not be widely deployed, because it is too hard to use.  The key factor that is ignored in such solutions is the concept of 'localized cost'.  It needs to be easy to do simple things, and hard to do complex things, instead of hard to do everything.  </p>
<p id="rfc.section.2.2.p.2">Configuration of the access control system needs to be simple to use.  Simple and common tasks need to be easy to configure, and require little expertise or domain-specific knowledge.  Complex tasks are possible using additional mechanisms, which may require additional expertise.  </p>
<p id="rfc.section.2.2.p.3">A single set of access control rules SHOULD be able to control all types of NETCONF protocol operation invocation, all conceptual datastore access, and all NETCONF session output.  </p>
<p id="rfc.section.2.2.p.4">Default access control policy needs to be as secure as possible.  </p>
<p id="rfc.section.2.2.p.5">Protocol access SHOULD be defined with a small and familiar set of permissions, while still allowing full control of NETCONF datastore access.  </p>
<p id="rfc.section.2.2.p.6">Access control does not need to be applied to NETCONF &lt;hello&gt; messages.  </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> Procedural Interface</h1>
<p id="rfc.section.2.3.p.1">The NETCONF protocol uses a procedural interface model, and an extensible set of protocol operations.  Access control for any possible protocol operation is required.  </p>
<p id="rfc.section.2.3.p.2">It MUST be possible to configure the ACM to permit or deny access to specific NETCONF operations.  </p>
<p id="rfc.section.2.3.p.3">YANG modules SHOULD be designed so that different access levels for input parameters to protocol operations is not required.  </p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> Datastore Access</h1>
<p id="rfc.section.2.4.p.1">It MUST be possible to control access to specific nodes and sub-trees within the conceptual NETCONF datastore.  </p>
<p id="rfc.section.2.4.p.2">In order for a user to obtain access to a particular datastore node, the user MUST be authorized to have the same requested access to the specified node, and all of its ancestors.  </p>
<p id="rfc.section.2.4.p.3">The same access control rules apply to all conceptual datastores.  For example, the candidate configuration or the running configuration.  </p>
<p id="rfc.section.2.4.p.4">Only the standard NETCONF datastores (candidate, running, and startup) are controlled by the ACM.  Local or remote files or datastores accessed via the &lt;url&gt; parameter are optional to support.  </p>
<p id="rfc.section.2.4.p.5">The non-volatile startup configuration needs to be loaded into the running configuration without applying any access control rules.  </p>
<h1 id="rfc.section.2.4.1">
<a href="#rfc.section.2.4.1">2.4.1.</a> Access Rights</h1>
<p id="rfc.section.2.4.1.p.1">A small set of hard-wired datastore access rights is needed to control access to all possible NETCONF datastore operations, including vendor extensions to the standard operation set.  </p>
<p id="rfc.section.2.4.1.p.2">The familiar 'CRUDX' model can support all NETCONF operations: </p>

<ul>
<li>Create:  Allows the client to add a new data node instance to a datastore.  </li>
<li>Read: Allows the client to read a data node instance from a datastore, or receive the notification event type.  </li>
<li>Update: Allows the client to update an existing data node instance in a datastore.  </li>
<li>Delete: Allows the client to delete a data node instance from a datastore.  </li>
<li>eXec: Allows the client to execute the protocol operation.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.2.4.2">
<a href="#rfc.section.2.4.2">2.4.2.</a> &lt;get&gt; and &lt;get-config&gt; Operations</h1>
<p id="rfc.section.2.4.2.p.1">Data nodes to which the client does not have 'read' access, either directly or via wildcard access, are silently omitted from the &lt;rpc-reply&gt; message.  </p>
<h1 id="rfc.section.2.4.3">
<a href="#rfc.section.2.4.3">2.4.3.</a> &lt;edit-config&gt; Operation</h1>
<p id="rfc.section.2.4.3.p.1">The NACM access rights are not directly coupled to the &lt;edit-config&gt; "operation" attribute, although they are similar.  Instead, a NACM access right applies to all operations which would result in a particular access operation to the target datastore. This section describes how these access rights apply to the specific datastore operations supported by the &lt;edit-config&gt; operation.  </p>
<p id="rfc.section.2.4.3.p.2">If the effective operation is 'none' (i.e., default-operation='none') for a particular data node, then no access control is applied to that data node.  </p>
<p id="rfc.section.2.4.3.p.3">A 'create', 'merge', or 'replace' operation on a datastore node which would result in the creation of a new data node instance, for which the user does not have 'create' access permission, is rejected with an 'access-denied' error.  </p>
<p id="rfc.section.2.4.3.p.4">A 'merge' or 'replace' operation on a datastore node which would result in the modification of an existing data node instance, for which the user does not have 'update' access permission, is rejected with an 'access-denied' error.  </p>
<p id="rfc.section.2.4.3.p.5">A 'replace', 'delete', or 'remove' operation on a datastore node which would result in the deletion of an existing data node instance, for which the user does not have 'delete' access permission, is rejected with an 'access-denied' error.  </p>
<p id="rfc.section.2.4.3.p.6">A 'merge' operation may include data nodes which do not alter portions of the existing datastore.  For example, a container or list nodes may be present for naming purposes, which do not actually alter the corresponding datastore node.  These unaltered data nodes within the scope of a 'merge' operation are ignored by the server, and do not require any access rights by the client.  </p>
<p id="rfc.section.2.4.3.p.7">A 'merge' operation may include data nodes, but not include particular child data nodes that are present in the datastore.  These missing data nodes within the scope of a 'merge' operation are ignored by the server, and do not require any access rights by the client.  </p>
<p id="rfc.section.2.4.3.p.8">The contents of specific restricted datastore nodes MUST NOT be exposed in any &lt;rpc-error&gt; elements within the reply.  </p>
<h1 id="rfc.section.2.4.4">
<a href="#rfc.section.2.4.4">2.4.4.</a> &lt;copy-config&gt; Operation</h1>
<p id="rfc.section.2.4.4.p.1">Access control for the &lt;copy-config&gt; operation requires special consideration because the operator is replacing the entire target datastore.  Read access to the entire source datastore, and write access to the entire target datastore is needed for this operation to succeed.  </p>
<p id="rfc.section.2.4.4.p.2">A client MUST have access to every datastore node, even ones that are not present in the source configuration data.  </p>
<p id="rfc.section.2.4.4.p.3">For example, consider a common use-case such as a simple backup and restore procedure.  The operator (client) MUST have full read access to the datastore in order to receive a complete copy of its contents.  If not, the server will simply omit these sub-trees from the reply.  If that copy is later used to restore the server datastore, the server will interpret the missing nodes as a request to delete those nodes, and return an error.  </p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> Users and Groups</h1>
<p id="rfc.section.2.5.p.1">The server MUST obtain a user name from the underlying NETCONF transport, such as an SSH user name.  </p>
<p id="rfc.section.2.5.p.2">It MUST be possible to specify access control rules for a single user or a configurable group of users.  </p>
<p id="rfc.section.2.5.p.3">A configurable superuser account may be needed which bypasses all access control rules.  This could be needed in case the access control rules are mis-configured, and all access is denied by mistake.  </p>
<p id="rfc.section.2.5.p.4">The ACM MUST support the concept of administrative groups, to support the well-established distinction between a root account and other types of less-privileged conceptual user accounts.  These groups MUST be configurable by the operator.  </p>
<p id="rfc.section.2.5.p.5">It MUST be possible to delegate the user-to-group mapping to a central server, such as RADIUS <a href="#RFC2865">[RFC2865]</a> <a href="#RFC5607">[RFC5607]</a>.  Since authentication is performed by the NETCONF transport layer, and RADIUS performs authentication and service authorization at the same time, it MUST be possible for the underlying NETCONF transport to report a set of group names associated with the user to the server.  </p>
<h1 id="rfc.section.2.6">
<a href="#rfc.section.2.6">2.6.</a> Maintenance</h1>
<p id="rfc.section.2.6.p.1">It SHOULD be possible to disable part or all of the access control model without deleting any configuration.  By default, only the 'superuser' SHOULD be able to perform this task.  </p>
<p id="rfc.section.2.6.p.2">It SHOULD be possible to configure a 'superuser' account so that all access control is disabled for just this user.  This allows the access control rules to always be modified without completely disabling access control for all users.  </p>
<h1 id="rfc.section.2.7">
<a href="#rfc.section.2.7">2.7.</a> Configuration Capabilities</h1>
<p id="rfc.section.2.7.p.1">Suitable control and monitoring mechanisms are needed to allow an operator to easily manage all aspects of the ACM behavior. A standard data model, suitable for use with the &lt;edit-config&gt; operation MUST be available for this purpose.  </p>
<p id="rfc.section.2.7.p.2">Access control rules to restrict operations on specific sub-trees within the configuration datastore MUST be supported. Existing mechanisms can be used to identify the sub-tree(s) for this purpose.  </p>
<h1 id="rfc.section.2.8">
<a href="#rfc.section.2.8">2.8.</a> Identifying Security Holes</h1>
<p id="rfc.section.2.8.p.1">One of the most important aspects of the data model documentation, and biggest concerns during deployment, is the identification of security-sensitive content.  This applies to operations in NETCONF, not just data and notifications.  </p>
<p id="rfc.section.2.8.p.2">It is mandatory for security-sensitive objects to be documented in the Security Considerations section of an RFC.  This is nice, but it is not good enough, for the following reasons: </p>

<ul>
<li>This documentation-only approach forces operators to study the RFC and determine if there are any potential security holes introduced by a new YANG module.  </li>
<li>If any security holes are identified, then the operator can study some more RFC text, and determine how to close the security hole(s).  </li>
<li>The ACM on each server can be configured to close the security holes, e.g., require privileged access to read or write the specific data identified in the Security Considerations section.  </li>
<li>If the ACM is not pre-configured, then there will be a time window of vulnerability, after the new module is loaded, and before the new access control rules for that module are configured, enabled, and debugged.  </li>
</ul>

<p> </p>
<p id="rfc.section.2.8.p.3">Often, the operator just wants to disable default access to the secure content, so no inadvertent or malicious changes can be made to the server.  This allows the default rules to be more lenient, without significantly increasing the security risk.  </p>
<p id="rfc.section.2.8.p.4">A data model designer needs to be able to use machine-readable statements to identify NETCONF content which needs to be protected by default.  This will allow client and server tools to automatically close data-model specific security holes, by denying access to sensitive data unless the user is explicitly authorized to perform the requested operation.  </p>
<h1 id="rfc.section.2.9">
<a href="#rfc.section.2.9">2.9.</a> Data Shadowing</h1>
<p id="rfc.section.2.9.p.1">One of the more complicated security administration problems is identifying data nodes which shadow or mirror the content of another data node.  An access control rule to prevent read operations for a particular node may be insufficient to prevent access to the data node with the copied value.  </p>
<p id="rfc.section.2.9.p.2">If the YANG leafref data type is used, then this data shadowing can be detected by applications (and the server stack), and prevented.  </p>
<p id="rfc.section.2.9.p.3">If the description statement, other documentation, or no documentation exists to identify a data shadow problem, then it may not be detected.  </p>
<p id="rfc.section.2.9.p.4">Since NETCONF allows any vendor operation to be added to the protocol, there is no way to reliably identify all of the operations that may expose copies of sensitive data nodes in &lt;rpc-reply&gt; messages.  </p>
<p id="rfc.section.2.9.p.5">A NETCONF server MUST ensure that unauthorized access to its conceptual datastores and non-configuration data nodes is prevented.  </p>
<p id="rfc.section.2.9.p.6">It is beyond the scope of this document to define access control enforcement procedures for underlying device instrumentation that may exist to support the NETCONF server operation.  An operator can identify each operation that the server provides, and decide if it needs any access control applied to it.  </p>
<p id="rfc.section.2.9.p.7">Proprietary protocol operations SHOULD be properly documented by the vendor, so it is clear to operators what data nodes (if any) are affected by the operation, and what information (if any) is returned in the &lt;rpc-reply&gt; message.  </p>
<h1 id="rfc.section.2.10">
<a href="#rfc.section.2.10">2.10.</a> NETCONF Specific Requirements</h1>
<p id="rfc.section.2.10.p.1">The server MUST be able to identify the specific protocol access request at the 4 access control points defined above.  </p>
<p id="rfc.section.2.10.p.2">The server MUST be able to identify any datastore access request, even for proprietary operations.  </p>
<p id="rfc.section.2.10.p.3">A client MUST always be authorized to invoke the &lt;close-session&gt; operation, defined in <a href="#I-D.ietf-netconf-4741bis">[I-D.ietf-netconf-4741bis]</a>.  </p>
<p id="rfc.section.2.10.p.4">A client MUST always be authorized to receive the &lt;replayComplete&gt; and &lt;notificationComplete&gt; notification events, defined in <a href="#RFC5277">[RFC5277]</a> </p>
<p id="rfc.section.2.10.p.5">The set of module name strings used within one particular server MUST be unique.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#acm" id="acm">NETCONF Access Control Model (NACM)</a>
</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Introduction</h1>
<p id="rfc.section.3.1.p.1">This section provides a high-level overview of the access control model structure.  It describes the NETCONF protocol message processing model, and the conceptual access control requirements within that model.  </p>
<h1 id="rfc.section.3.1.1">
<a href="#rfc.section.3.1.1">3.1.1.</a> Features</h1>
<p id="rfc.section.3.1.1.p.1">The NACM data model provides the following features: </p>

<ul>
<li>Independent control of RPC, data, and notification access.  </li>
<li>Very simple access control rules configuration data model which is easy to use.  </li>
<li>The concept of a 'superuser' type of account is supported, but configuration such an account is beyond the scope of this document.  If the server supports a 'superuser' account, then it MUST be able to determine the actual user name for this account.  A session associated with the superuser account will bypass all access control enforcement.  </li>
<li>A simple and familiar set of datastore permissions is used.  </li>
<li>Support for YANG security tagging (e.g., nacm:secure extension) allows default security modes to automatically exclude sensitive data.  </li>
<li>Separate default access modes for read, write, and execute permissions.  </li>
<li>Access control rules are applied to configurable groups of users.  </li>
<li>The entire ACM can be disabled during operation, in order to debug operational problems.  </li>
<li>Access control rules are simple to configure.  </li>
<li>The number of denied protocol operation requests and denied datastore write requests can be monitored by the client.  </li>
<li>Simple unconstrained YANG instance identifiers are used to configure access control rules for specific data nodes.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.3.1.2">
<a href="#rfc.section.3.1.2">3.1.2.</a> External Dependencies</h1>
<p id="rfc.section.3.1.2.p.1">The <a href="#I-D.ietf-netconf-4741bis">NETCONF</a> <cite title="NONE">[I-D.ietf-netconf-4741bis]</cite> protocol is used for all management purposes within this document.  It is expected that the mandatory transport mapping <a href="#I-D.ietf-netconf-rfc4742bis">NETCONF Over SSH</a> <cite title="NONE">[I-D.ietf-netconf-rfc4742bis]</cite> is also supported by the server, and that the server has access to the user name associated with each session.  </p>
<p id="rfc.section.3.1.2.p.2">The <a href="#RFC6020">YANG Data Modeling Language</a> <cite title="NONE">[RFC6020]</cite> is used to define the NETCONF data models specified in this document. The YANG instance-identifier data type is used to configure data-node-specific access control rules.  </p>
<h1 id="rfc.section.3.1.3">
<a href="#rfc.section.3.1.3">3.1.3.</a> Message Processing Model</h1>
<p id="rfc.section.3.1.3.p.1">The following diagram shows the NETCONF message flow model, including the points at which access control is applied, during NETCONF message processing.  </p>
<div id="#rfc.figure.2"></div>
<div id="#NACM_model"></div>
<pre>

                 +-------------------------+
                 |       session           |
                 |      (username)         |
                 +-------------------------+
                    |                 ^
                    V                 |
          +--------------+     +---------------+
          |   message    |     |   message     |
          | dispatcher   |     |   generator   |
          +--------------+     +---------------+
               |                  ^         ^
               V                  |         |
      +===========+     +-------------+   +----------------+
      |   &lt;rpc&gt;   |---&gt; | &lt;rpc-reply&gt; |   | &lt;notification&gt; |
      | acc. ctl  |     |  generator  |   |  generator     |
      +===========+     +-------------+   +----------------+
            |              ^    ^                ^
            V       +------+    |                |
      +-----------+ |   +=============+  +================+
      |   &lt;rpc&gt;   | |   | &lt;rpc-reply&gt; |  | &lt;notification&gt; |
      | processor |-+   |  acc. ctl   |  |  access ctl    |
      +-----------+     +=============+  +================+
            |   |                  ^        ^
            V   +----------------+ |        |
      +===========+              | |        |
      | data node |              | |        |
      | acc. ctl  | -----------+ | |        |
      +===========+            | | |        |
            |                  | | |        |
            V                  V V |        |
      +---------------+      +-----------------+
      | configuration | ---&gt; |     server      |
      |   datastore   |      | instrumentation |
      |               | &lt;--- |                 |
      +---------------+      +-----------------+


            </pre>
<p></p>
<p id="rfc.section.3.1.3.p.3">The following high-level sequence of conceptual processing steps is executed for each received &lt;rpc&gt; message, if access control enforcement is enabled: </p>

<ul>
<li>Access control is applied to all &lt;rpc&gt; messages (except &lt;close-session&gt;) received by the server, individually, for each active session, unless the session is associated with the 'superuser' account.  </li>
<li>If the session is authorized to execute the specified RPC operation, then processing continues, otherwise the request is rejected with an 'access-denied' error.  </li>
<li>If the configuration datastore or conceptual state data is accessed by the protocol operation, then the data node access MUST be authorized.  If the session is authorized to perform the requested operation on the requested data, then processing continues.  </li>
</ul>

<p> </p>
<p id="rfc.section.3.1.3.p.4">The following sequence of conceptual processing steps is executed for each generated notification event, if access control enforcement is enabled: </p>

<ul>
<li>Server instrumentation generates a conceptual notification, for a particular subscription.  </li>
<li>The notification access control enforcer checks the notification event type, and if it is one which the session is not authorized to read, then the notification is dropped for that subscription.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Model Components</h1>
<p id="rfc.section.3.2.p.1">This section defines the conceptual components related to access control model.  </p>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> Users</h1>
<p id="rfc.section.3.2.1.p.1">A 'user' is the conceptual entity, which is associated with the access permissions granted to a particular session.  A user is identified by a string which MUST be unique within the server.  </p>
<p id="rfc.section.3.2.1.p.2">As described in <a href="#I-D.ietf-netconf-4741bis">[I-D.ietf-netconf-4741bis]</a>, the user name string is derived from the transport layer during session establishment.  If the transport layer cannot authenticate the user, the session is terminated.  </p>
<p id="rfc.section.3.2.1.p.3">The server MAY support a 'superuser' administrative user account, which will bypass all access control enforcement.  This is useful for restricting initial access and repairing a broken access control configuration.  This account may be configurable to use a specific user, or disabled completely.  Some systems have factory-selected superuser account names.  There is no need to standardize the exact user name for the superuser account.  If no such account exists, then all NETCONF access will be controlled by NACM.  </p>
<h1 id="rfc.section.3.2.2">
<a href="#rfc.section.3.2.2">3.2.2.</a> Groups</h1>
<p id="rfc.section.3.2.2.p.1">Access to a specific NETCONF operation is granted to a session, associated with a group, not a user.  </p>
<p id="rfc.section.3.2.2.p.2">A group is identified by its name.  All group names MUST be unique within the server.  </p>
<p id="rfc.section.3.2.2.p.3">A group member is identified by a user name string.  </p>
<p id="rfc.section.3.2.2.p.4">The same user may be configured in multiple groups.  </p>
<h1 id="rfc.section.3.2.3">
<a href="#rfc.section.3.2.3">3.2.3.</a> Sessions</h1>
<p id="rfc.section.3.2.3.p.1">A session is simply a NETCONF session, which is the entity which is granted access to specific NETCONF operations.  </p>
<p id="rfc.section.3.2.3.p.2">A session is associated with a single user name for the lifetime of the session.  </p>
<h1 id="rfc.section.3.2.4">
<a href="#rfc.section.3.2.4">3.2.4.</a> Access Permissions</h1>
<p id="rfc.section.3.2.4.p.1">The access permissions are the NETCONF protocol specific set of permissions that have been assigned to a particular session.  </p>
<p id="rfc.section.3.2.4.p.2">The same access permissions MUST stay in effect for the processing of a particular message.  </p>
<p id="rfc.section.3.2.4.p.3">The server MUST use the access control rules in effect at the time the message is processed.  </p>
<p id="rfc.section.3.2.4.p.4">The access control model treats protocol operation execution separately from configuration datastore access and outgoing messages: </p>

<dl>
<dt>create:</dt>
<dd style="margin-left: 8">Permission to create conceptual server data.  </dd>
<dt>read:</dt>
<dd style="margin-left: 8">Read access to conceptual server data, &lt;rpc-reply&gt; and &lt;notification&gt; content.  </dd>
<dt>update:</dt>
<dd style="margin-left: 8">Permission to modify existing conceptual server data.  </dd>
<dt>delete:</dt>
<dd style="margin-left: 8">Permission to delete existing conceptual server data.  </dd>
<dt>exec:</dt>
<dd style="margin-left: 8">Permission to invoke an protocol operation.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2.5">
<a href="#rfc.section.3.2.5">3.2.5.</a> Global Enforcement Controls</h1>
<p id="rfc.section.3.2.5.p.1">A global on/off switch is provided to enable or disable all access control enforcement.  </p>
<p id="rfc.section.3.2.5.p.2">An on/off switch is provided to enable or disable default access to invoke protocol operations.  </p>
<p id="rfc.section.3.2.5.p.3">An on/off switch is provided to enable or disable default permission to receive data in replies and notifications.  </p>
<p id="rfc.section.3.2.5.p.4">An on/off switch is provided to enable or disable default access to alter configuration data.  </p>
<h1 id="rfc.section.3.2.6">
<a href="#rfc.section.3.2.6">3.2.6.</a> Access Control Rules</h1>
<p id="rfc.section.3.2.6.p.1">There are 4 types of rules available in NACM: </p>

<dl>
<dt>module rule:</dt>
<dd style="margin-left: 8">Controls access for definitions in a specific module, identified by its name.  </dd>
<dt>protocol operation rule:</dt>
<dd style="margin-left: 8">Controls access for a specific protocol operation, identified by its module and name.  </dd>
<dt>data node rule:</dt>
<dd style="margin-left: 8">Controls access for a specific data node, identified by its path location within the conceptual XML document for the data node.  </dd>
<dt>notification rule:</dt>
<dd style="margin-left: 8">Controls access for a specific notification event type, identified by its module and name.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Access Control Enforcement Procedures</h1>
<p id="rfc.section.3.3.p.1">There are seven separate phases that need to be addressed, four of which are related to the NETCONF message processing model.  In addition, the initial start-up mode for a NETCONF server, session establishment, and 'access-denied' error handling procedures also need to be considered.  </p>
<h1 id="rfc.section.3.3.1">
<a href="#rfc.section.3.3.1">3.3.1.</a> Initial Operation</h1>
<p id="rfc.section.3.3.1.p.1">Upon the very first start-up of the NETCONF server, the access control configuration will probably not be present. If not, a server MUST NOT allow any write access to any session role except 'superuser' type of account in this state.  </p>
<p id="rfc.section.3.3.1.p.2">There is no requirement to enforce access control rules before or while the non-volatile configuration data is processed and loaded into the running configuration.  </p>
<h1 id="rfc.section.3.3.2">
<a href="#rfc.section.3.3.2">3.3.2.</a> Session Establishment</h1>
<p id="rfc.section.3.3.2.p.1">The access control model applies specifically to the well-formed XML content transferred between a client and a server, after session establishment has been completed, and after the &lt;hello&gt; exchange has been successfully completed.  </p>
<p id="rfc.section.3.3.2.p.2">A server SHOULD NOT include any sensitive information in any &lt;capability&gt; elements within the &lt;hello&gt; exchange.  </p>
<p id="rfc.section.3.3.2.p.3">Once session establishment is completed, and a user identity has been authenticated, the NETCONF transport layer reports the username and a possibly empty set of group names associated with the user to the NETCONF server.  The NETCONF server will enforce the access control rules, based on the supplied user identity, group names, and the configuration data stored on the server.  </p>
<h1 id="rfc.section.3.3.3">
<a href="#rfc.section.3.3.3">3.3.3.</a> 'access-denied' Error Handling</h1>
<p id="rfc.section.3.3.3.p.1">The 'access-denied' error-tag is generated when the access control system denies access to either a request to invoke a protocol operation or a request to perform a particular operation on the configuration datastore.  </p>
<p id="rfc.section.3.3.3.p.2">A server MUST NOT include any sensitive information in any &lt;error-info&gt; elements within the &lt;rpc-error&gt; response.  </p>
<h1 id="rfc.section.3.3.4">
<a href="#rfc.section.3.3.4">3.3.4.</a> Incoming RPC Message Validation</h1>
<p id="rfc.section.3.3.4.p.1">The diagram below shows the basic conceptual structure of the access control processing model for incoming NETCONF &lt;rpc&gt; messages, within a server.  </p>
<div id="#rfc.figure.3"></div>
<div id="#NACM_incoming"></div>
<pre>


                NETCONF server
               +------------+
               |    XML     |
               |   message  |
               | dispatcher |
               +------------+
                      |
                      |
                      V
               +------------+
               | NC-base NS |
               |   &lt;rpc&gt;    |
               +------------+
                 |   |  |
                 |   |  +-------------------------+
                 |   +------------+               |
                 V                V               V
            +-----------+ +---------------+ +------------+
            | acme NS   | | NC-base NS    | | NC-base NS |
            | &lt;my-edit&gt; | | &lt;edit-config&gt; | | &lt;unlock&gt;   |
            +-----------+ +---------------+ +------------+
                   |               |
                   |               |
                   V               V
                 +----------------------+
                 |                      |
                 |    configuration     |
                 |      datastore       |
                 +----------------------+


           </pre>
<p></p>
<p id="rfc.section.3.3.4.p.3">Access control begins with the message dispatcher.  Only well-formed XML messages will be processed by the server.  </p>
<p id="rfc.section.3.3.4.p.4">After the server validates the &lt;rpc&gt; element, and determines the namespace URI and the element name of the protocol operation being requested, the RPC access control enforcer verifies that the session is authorized to invoke the protocol operation.  </p>
<p id="rfc.section.3.3.4.p.5">The protocol operation is authorized by following these steps: </p>

<ol>
<li>If the &lt;enable-nacm&gt; parameter is set to 'false', then the protocol operation is permitted.  </li>
<li>If the session is associated with the 'superuser' account, then the protocol operation is permitted.  </li>
<li>If the requested operation is the NETCONF &lt;close-session&gt; operation, then the protocol operation is permitted.  </li>
<li>Check all the &lt;group&gt; entries for ones that contain a &lt;user-name&gt; entry that matches the user name for the session making the request.  Add to these groups the set of groups provided by the transport layer.  </li>
<li>If no groups are found: <ul>
<li>If the requested protocol operation is associated with a YANG module advertised in the server capabilities, and the rpc statement contains a nacm:secure or nacm:very-secure extension, then the protocol operation is denied.  </li>
<li>If the &lt;exec-default&gt; parameter is set to 'permit', then permit the protocol operation, otherwise deny the request.  </li>
</ul>
<p> </p>
</li>
<li>Check if there are any matching &lt;rpc-rule&gt; entries for the requested protocol operation.  Any matching rules are processed in user-defined order, in case there are multiple &lt;rpc-rule&gt; entries for the requested protocol operation.  </li>
<li>If an &lt;rpc-rule&gt; entry is found, then check the &lt;allowed-rights&gt; bits field for the entry, otherwise continue.  The 'exec' bit MUST be present in the &lt;allowed-rights&gt; bits field for an &lt;rpc-rule&gt;, so it is not used in this procedure.  </li>
<li>If the &lt;rpc-rule&gt; entry is considered a match, then the 'nacm-action' leaf is checked.  If is equal to 'permit',  then the protocol operation is permitted, otherwise it is denied.  </li>
<li>Check if there are any matching &lt;module-rule&gt; entries for the same module as the requested protocol operation.  Any matching rules are processed in user-defined order, in case there are multiple &lt;module-rule&gt; entries for the module containing the requested protocol operation.  </li>
<li>If a &lt;module-rule&gt; entry is found, then check the &lt;allowed-rights&gt; bits field for the entry, otherwise continue.  If the 'exec' bit is present in the &lt;allowed-rights&gt; bits field then the RPC rule is considered a match.  otherwise it is not considered to match the request.  </li>
<li>If the &lt;module-rule&gt; entry is considered a match, then the 'nacm-action' leaf is checked.  If is equal to 'permit',  then the protocol operation is permitted, otherwise it is denied.  </li>
<li>If the requested operation is identified an a nacm:secure or nacm:very-secure protocol operation, then the protocol operation is denied.  </li>
<li>If the &lt;exec-default&gt; parameter is set to 'permit', then permit the protocol operation, otherwise the protocol operation is denied.  </li>
</ol>

<p> </p>
<p id="rfc.section.3.3.4.p.6">If the session is not authorized to invoke the protocol operation then an &lt;rpc-error&gt; is generated with the following information: </p>

<dl>
<dt>error-tag:</dt>
<dd style="margin-left: 8">access-denied</dd>
<dt>error-path:</dt>
<dd style="margin-left: 8">/rpc/method-QName, where 'method-QName' is a qualified name identifying the actual protocol operation name.  For example, '/rpc/edit-config' represents the &lt;edit-config&gt; operation in the NETCONF base namespace.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.3.4.p.7">If the configuration datastore is accessed, either directly or as a side effect of the protocol operation, then the server MUST intercept the operation and make sure the session is authorized to perform the requested operation on the specified data.  </p>
<h1 id="rfc.section.3.3.5">
<a href="#rfc.section.3.3.5">3.3.5.</a> Data Node Access Validation</h1>
<p id="rfc.section.3.3.5.p.1">If a data node within a configuration datastore is accessed, or a conceptual non-configuration node is accessed, then the server MUST ensure that the client session is authorized to perform the requested operation create, read, update, or delete operation on the specified data node.  </p>
<p id="rfc.section.3.3.5.p.2">The data node access request is authorized by following these steps: </p>

<ol>
<li>If the &lt;enable-nacm&gt; parameter is set to 'false', then the data node access request is permitted.  </li>
<li>If the session is associated with the 'superuser' account, then the data node access request is permitted.  </li>
<li>Check all the &lt;group&gt; entries for ones that contain a &lt;user-name&gt; entry that matches the user name for the session making the request.   Add to these groups the set of groups provided by the transport layer.  </li>
<li>If no groups are found: <ul>
<li>If the requested data node is associated with a YANG module advertised in the server capabilities, and the data definition statement or any of its ancestors contains a nacm:secure or nacm:very-secure extension, then the data node access request is denied.  </li>
<li>For a read request, if the &lt;read-default&gt; parameter is set to 'permit', then permit the data node access request, otherwise deny the request.  For a read operation, this means that the requested node is not included in the rpc-reply.  </li>
<li>For a write request, if the &lt;write-default&gt; parameter is set to 'permit', then permit the data node access request, otherwise deny the request.  </li>
</ul>
<p> </p>
</li>
<li>Check if there are any matching &lt;data-rule&gt; entries for the requested data node access request.  Any matching rules are processed in user-defined order, in case there are multiple &lt;data-rule&gt; entries for the requested data node.  </li>
<li>If an &lt;data-rule&gt; entry is found, then check the &lt;allowed-rights&gt; bits field for the entry, otherwise continue.  <ul class="empty">
<li>For a creation operation, if the 'create' bit is present in the &lt;allowed-rights&gt; bits field then the entry is considered to be a match.  </li>
<li>For a read operation, if the 'read' bit is present in the &lt;allowed-rights&gt; bits field, then the entry is considered to be a match.  </li>
<li>For an update (e.g., 'merge' or 'replace') operation, if the 'update' bit is present in the &lt;allowed-rights&gt; bits field then the entry is considered to be a match.  </li>
<li>For a deletion (e.g., 'delete') operation, if the 'delete' bit is present in the &lt;allowed-rights&gt; bits field then the entry is considered to be a match.  </li>
</ul>
<p> </p>
</li>
<li>If the &lt;data-rule&gt; entry is considered a match, then the 'nacm-action' leaf is checked.  If it is equal to 'permit',  then the data operation is permitted, otherwise it is denied. For 'read' operations, 'denied' means the requested data is not returned in the reply.  </li>
<li>Check if there are any matching &lt;module-rule&gt; entries for the same module as the requested data node.  Any matching rules are processed in user-defined order, in case there are multiple &lt;module-rule&gt; entries for the module containing the requested data node.  </li>
<li>If a &lt;module-rule&gt; entry is found, then check the &lt;allowed-rights&gt; bits field for the entry, otherwise continue.  <ul class="empty">
<li>For a creation operation, if the 'create' bit is present in the &lt;allowed-rights&gt; bits field then the entry is considered to be a match.  </li>
<li>For a read operation, if the 'read' bit is present in the &lt;allowed-rights&gt; bits field, then the entry is considered to be a match.  </li>
<li>For an update (e.g., 'merge' or 'replace') operation, if the 'update' bit is present in the &lt;allowed-rights&gt; bits field then the entry is considered to be a match.  </li>
<li>For a deletion (e.g., 'delete') operation, if the 'delete' bit is present in the &lt;allowed-rights&gt; bits field then the entry is considered to be a match.  </li>
</ul>
<p> </p>
</li>
<li>If the &lt;module-rule&gt; entry is considered a match, then the 'nacm-action' leaf is checked.  If it is equal to 'permit',  then the data operation is permitted, otherwise it is denied. For 'read' operations, 'denied' means the requested data is not returned in the reply.  </li>
<li>For a read request, if the requested data node is identified an a nacm:very-secure definition, then the requested data node is not included in the reply.  </li>
<li>For a write request, if the requested data node is identified an a nacm:secure or nacm:very-secure definition, then the data node access request is denied.  </li>
<li>For a read request, if the &lt;read-default&gt; parameter is set to 'permit', then include the requested data in the reply, otherwise do not include the requested data in the reply.  </li>
<li>For a write request, if the &lt;write-default&gt; parameter is set to 'permit', then permit the data node access request, otherwise deny the request.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.3.3.6">
<a href="#rfc.section.3.3.6">3.3.6.</a> Outgoing &lt;rpc-reply&gt; Authorization</h1>
<p id="rfc.section.3.3.6.p.1">The &lt;rpc-reply&gt; message MUST be checked by the server to make sure no unauthorized data is contained within it.  If so, the restricted data MUST be removed from the message before it is sent to the client.  </p>
<p id="rfc.section.3.3.6.p.2">For protocol operations which do not access any data nodes, then any client authorized to invoke the protocol operation is also authorized to receive the &lt;rpc-reply&gt; for that protocol operation.  </p>
<h1 id="rfc.section.3.3.7">
<a href="#rfc.section.3.3.7">3.3.7.</a> Outgoing &lt;notification&gt; Authorization</h1>
<p id="rfc.section.3.3.7.p.1">The &lt;notification&gt; message MUST be checked by the server to make sure no unauthorized data is contained within it.  If so, the restricted data MUST be removed from the message before it is sent to the client.  </p>
<p id="rfc.section.3.3.7.p.2">Configuration of access control rules specifically for descendent nodes of the notification event type element are outside the scope of this document.  If the session is authorized to receive the notification event type, then it is also authorized to receive any data it contains.  </p>
<p id="rfc.section.3.3.7.p.3">The following figure shows the conceptual message processing model for outgoing &lt;notification&gt; messages.  </p>
<div id="#rfc.figure.4"></div>
<div id="#NACM_outgoing_notification"></div>
<pre>
             

                NETCONF server
               +------------+
               |    XML     |
               |   message  |
               | generator  |
               +------------+
                     ^
                     |
             +----------------+
             | &lt;notification&gt; |
             |  generator     |
             +----------------+
                     ^
                     |
            +=================+
            | &lt;notification&gt;  |
            |  access control |
            |  &lt;eventType&gt;    |
            +=================+ 
                     ^
                     |
         +------------------------+
         | server instrumentation |
         +------------------------+
                   |     ^
                   V     |
          +----------------------+
          |    configuration     |
          |      datastore       |
          +----------------------+


           </pre>
<p></p>
<p id="rfc.section.3.3.7.p.5">The generation of a notification event for a specific subscription is authorized by following these steps: </p>

<ol>
<li>If the &lt;enable-nacm&gt; parameter is set to 'false', then the notification event is permitted.  </li>
<li>If the session is associated with the 'superuser' account, then the notification event is permitted.  </li>
<li>If the requested operation is the NETCONF &lt;replayComplete&gt; or &lt;notificationComplete&gt; event type, then the notification event is permitted.  </li>
<li>Check all the &lt;group&gt; entries for ones that contain a &lt;user-name&gt; entry that matches the user name for the session that started the notification subscription.  Add to these groups the set of groups provided by the transport layer.  </li>
<li>If no groups are found: <ul>
<li>If the requested notification is associated with a YANG module advertised in the server capabilities, and the notification statement contains a nacm:secure or nacm:very-secure extension, then the notification event is dropped for the associated subscription.  </li>
<li>If the &lt;read-default&gt; parameter is set to 'permit', then permit the notification event, otherwise drop this event type for the associated subscription.  </li>
</ul>
<p> </p>
</li>
<li>Check if there are any matching &lt;notification-rule&gt; entries for the specific notification event type being delivered to the subscription.  Any matching rules are processed in user-defined order, in case there are multiple &lt;notification-rule&gt; entries for the requested notification event type.  </li>
<li>If a &lt;notification-rule&gt; entry is found, then check the &lt;allowed-rights&gt; bits field for the entry, otherwise continue.  If the 'read' bit is present in the &lt;allowed-rights&gt; bits field then the notification event type is permitted, otherwise it is dropped for the associated subscription.  </li>
<li>Check if there are any matching &lt;module-rule&gt; entries for the same module as the notification event type.  Any matching rules are processed in user-defined order, in case there are multiple &lt;module-rule&gt; entries for the module containing the notification event type.  </li>
<li>If a &lt;module-rule&gt; entry is found, then check the &lt;allowed-rights&gt; bits field for the entry, otherwise continue.  If the 'read' bit is present in the &lt;allowed-rights&gt; bits field then the notification event type is permitted, otherwise it is dropped for the associated subscription.  </li>
<li>If the requested event type is identified an a nacm:very-secure notification definition, then the notification event type is denied.  </li>
<li>If the &lt;read-default&gt; parameter is set to 'permit', then permit the notification event type, otherwise it is dropped for the associated subscription.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#DM" id="DM">Data Model Definitions</a>
</h1>
<p id="rfc.section.3.4.p.1">This section defines the semantics of the conceptual data structures found in the data model in <a href="#DM">Section 3.4</a>.  </p>
<h1 id="rfc.section.3.4.1">
<a href="#rfc.section.3.4.1">3.4.1.</a> High Level Procedures</h1>
<p id="rfc.section.3.4.1.p.1">There are some high level management procedures that an administrator needs to consider before using this access control model: </p>

<ol>
<li>Configure the global settings.  </li>
<li>Configure one or more user groups.  </li>
<li>Configure zero or more access control rules for specific modules.  </li>
<li>Configure zero or more access control rules for specific protocol operations.  </li>
<li>Configure zero or more access control rules for data node access.  </li>
<li>Configure zero or more access control rules for notification event type access.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.3.4.2">
<a href="#rfc.section.3.4.2">3.4.2.</a> Data Organization</h1>
<p id="rfc.section.3.4.2.p.1">The top-level element is called &lt;nacm&gt;, and it is defined in the 'ietf-netconf-acm' module namespace.  </p>
<p id="rfc.section.3.4.2.p.2">There are several data structures defined as child nodes of the &lt;nacm&gt; element: </p>

<dl>
<dt>leaf &lt;enable-nacm&gt;:</dt>
<dd style="margin-left: 8">On/off boolean switch to enable or disable access control enforcement.  </dd>
<dt>leaf &lt;read-default&gt;:</dt>
<dd style="margin-left: 8">Enumeration to permit or deny default read access requests.  </dd>
<dt>leaf &lt;write-default&gt;:</dt>
<dd style="margin-left: 8">Enumeration to permit or deny default write access requests.  </dd>
<dt>leaf &lt;exec-default&gt;:</dt>
<dd style="margin-left: 8">Enumeration to permit or deny default protocol operation execution requests.  </dd>
<dt>leaf &lt;denied-rpcs&gt;:</dt>
<dd style="margin-left: 8">Read-only counter of the number of times the server has denied an RPC operation request, since the last reboot of the server.  </dd>
<dt>leaf &lt;denied-data-writes&gt;:</dt>
<dd style="margin-left: 8">Read-only counter of the number of times the server has denied a data node write request, since the last reboot of the server.  </dd>
<dt>container &lt;groups&gt;:</dt>
<dd style="margin-left: 8">Configures the groups used within the access control system.  <dl>
<dt>list &lt;group&gt;:</dt>
<dd style="margin-left: 8">A list of user names belonging to the same administrative group.  </dd>
</dl>
<p> </p>
</dd>
<dt>container &lt;rules&gt;:</dt>
<dd style="margin-left: 8">Configures the access control rules used within the server.  <dl>
<dt>list &lt;module-rule&gt;:</dt>
<dd style="margin-left: 8">Configures the access control rules for a specific module.  </dd>
<dt>list &lt;rpc-rule&gt;:</dt>
<dd style="margin-left: 8">Configures the access control rules for protocol operation invocation.  </dd>
<dt>list &lt;data-rule&gt;:</dt>
<dd style="margin-left: 8">Configures the access control rules for configuration datastore access.  </dd>
<dt>list &lt;notification-rule&gt;:</dt>
<dd style="margin-left: 8">Configures the access control rules for controlling delivery of &lt;notification&gt; events.  </dd>
</dl>
<p> </p>
</dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.4.3">
<a href="#rfc.section.3.4.3">3.4.3.</a> YANG Module</h1>
<p id="rfc.section.3.4.3.p.1">The following YANG module is provided to specify the normative NETCONF content that MUST by supported by the server.  </p>
<p id="rfc.section.3.4.3.p.2">The ietf-netconf-acm YANG module imports typedefs from <a href="#RFC6021">[RFC6021]</a>.  </p>
<div id="#rfc.figure.5"></div>
<div id="#YANG_module"></div>
<pre>
// RFC Ed.: please update the date to the date of publication
&lt;CODE BEGINS&gt; file="ietf-netconf-acm@2011-03-11.yang"

module ietf-netconf-acm {

  namespace "urn:ietf:params:xml:ns:yang:ietf-netconf-acm";

  prefix "nacm";

  import ietf-yang-types {
    prefix yang;
  }

  organization
    "IETF NETCONF (Network Configuration) Working Group";


  contact
    "WG Web:   &lt;http://tools.ietf.org/wg/netconf/&gt;
     WG List:  &lt;mailto:netconf@ietf.org&gt;

     WG Chair: Mehmet Ersue
               &lt;mailto:mehmet.ersue@nsn.com&gt;

     WG Chair: Bert Wijnen
               &lt;mailto:bertietf@bwijnen.net&gt;

     Editor:   Andy Bierman
               &lt;mailto:andy.bierman@brocade.com&gt;

     Editor:   Martin Bjorklund
               &lt;mailto:mbj@tail-f.com&gt;";

  description 
    "NETCONF Server Access Control Model.

     Copyright (c) 2011 IETF Trust and the persons identified as
     authors of the code. All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD
     License set forth in Section 4.c of the IETF Trust's
     Legal Provisions Relating to IETF Documents
     (http://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC XXXX; see
     the RFC itself for full legal notices.";
  // RFC Ed.: replace XXXX with actual RFC number and
  // remove this note

  // RFC Ed.: remove this note
  // Note: extracted from draft-ietf-netconf-access-control-03.txt

  // RFC Ed.: please update the date to the date of publication
  revision "2011-03-11" {
    description
      "Initial version";
    reference 
      "RFC XXXX: Network Configuration Protocol
                 Access Control Model";
  }

  /*
   * Extension statements
   */

  extension secure {
    description
      "Used to indicate that the data model node 
       represents a sensitive security system parameter.

       If present, and the NACM module is enabled 
       (i.e., /nacm/enable-nacm object equals 'true'),
       the NETCONF server will only allow
       the designated 'superuser' to have write or execute
       default nacm-rights-type for the node.  An explicit access
       control rule is required for all other users.

       The 'secure' extension MAY appear within a data, rpc,
       or notification node definition.  It is ignored 
       otherwise.";
  }

  extension very-secure {
    description
      "Used to indicate that the data model node 
       controls a very sensitive security system parameter.

       If present, and the NACM module is enabled 
       (i.e., /nacm/enable-nacm object equals 'true'),
       the NETCONF server will only allow
       the designated 'superuser' to have read, write, or execute
       default nacm-rights-type for the node.  An explicit access
       control rule is required for all other users.

       The 'very-secure' extension MAY appear within a data, rpc,
       or notification node definition.  It is ignored
       otherwise.";
  }

  /*
   * Derived types
   */

  typedef nacm-user-name-type {
    type string {
      length "1..max";
    }
    description
      "General Purpose User Name string.";
  }

  typedef nacm-matchall-string-type {
    type string {
      pattern "\*";
    }
    description
      "The string containing a single asterisk '*' is used
       to conceptually represent all possible values
       for the particular leaf using this data type.";
  }
  
  typedef nacm-rights-type {
    type union {
      type nacm-matchall-string-type;

      type bits {
        bit create {
          description
            "Create access allowed to all specified data.
             Any protocol operation that creates a
             new instance of the specified data is a create
             operation.";
        }
        bit read {
          description
            "Read access allowed to all specified data.
             Any protocol operation or notification that
             returns data to an application is a read 
             operation.";
        }
        bit update {
          description
            "Update access allowed to all specified data.
             Any protocol operation that alters an existing
             data node is an update operation.";
        }
        bit delete {
          description
            "Delete access allowed to all specified data.
             Any protocol operation that removes a datastore
             node instance is a delete operation.";
        }
        bit exec {
          description
            "Execution access to the specified RPC operation.
             Any RPC operation invocation is an exec operation.";
        }
      }
    }
    description 
      "NETCONF Access Rights.
       The string '*' indicates that all possible access
       rights apply to the access rule.  Otherwise, only
       the specific access rights represented by the bit names
       that are present apply to the access rule.";
  }

  typedef nacm-group-name-type {
    type string {
      length "1..max";
      pattern "[^\*].*";
    }
    description 
      "Name of administrative group that can be
       assigned to the user, and specified in
       an access control rule.";
  }

  typedef nacm-action-type {
    type enumeration {
      enum permit {
        description
          "Requested action is permitted.";
      }
      enum deny {
        description
          "Requested action is denied.";
      }
    }
    description
      "Action taken by the server when a particular
       rule matches.";
  }

  typedef schema-instance-identifier {
    type yang:xpath1.0;
    description
      "Path expression used to represent a special 
       schema-instance identifier string.
     
       A schema-instance-identifier value is an 
       unrestricted YANG instance-identifier expression.
       All the same rules as an instance-identifier apply
       except predicates for keys are optional.  If a key
       predicate is missing, then the schema-instance-identifier
       represents all possible server instances for that key.

       This XPath expression is evaluated in the following context:

         o  The set of namespace declarations are those in scope on
            the leaf element where this type is used.

         o  The set of variable bindings contains one variable,
            'USER', which contains the name of user of the current
             session.

         o  The function library is the core function library, but
            note that due to the syntax restrictions of an
            instance-identifier, no functions are allowed.

         o  The context node is the root node in the data tree.";
  }

  container nacm {
    nacm:very-secure;

    description
      "Parameters for NETCONF Access Control Model.";

    leaf enable-nacm {
      type boolean;
      default true;
      description
        "Enable or disable all NETCONF access control
         enforcement.  If 'true', then enforcement
         is enabled.  If 'false', then enforcement
         is disabled.";
    } 

    leaf read-default {
      type nacm-action-type;
      default "permit";
      description
        "Controls whether read access is granted if
         no appropriate rule is found for a
         particular read request.";
    }

    leaf write-default {
      type nacm-action-type;
      default "deny";
      description
        "Controls whether create, update, or delete access
         is granted if no appropriate rule is found for a
         particular write request.";
    }

    leaf exec-default {
      type nacm-action-type;
      default "permit";
      description
        "Controls whether exec access is granted if no appropriate
         rule is found for a particular RPC operation request.";
    }

    leaf denied-rpcs {
      type yang:zero-based-counter32;
      config false;
      mandatory true;
      description
        "Number of times an RPC operation request was denied
         since the server last restarted.";
    }

    leaf denied-data-writes {
      type yang:zero-based-counter32;
      config false;
      mandatory true;
      description
        "Number of times a request to alter a data node
         was denied, since the server last restarted.";
    }

    container groups {
      description
        "NETCONF Access Control Groups.";

      list group {
        key name;

        description
          "One NACM Group Entry.";

        leaf name {
          type nacm-group-name-type;
          description 
            "Group name associated with this entry.";
        }

        leaf-list user-name {
          type nacm-user-name-type;
          description 
            "Each entry identifies the user name of 
             a member of the group associated with 
             this entry.";
        }
      }
    }

    container rules {
      description 
        "NETCONF Access Control Rules.";

      grouping common-rule-parms {
        description
          "Common rule parameters.";

        leaf rule-name {
          type string {
            length "1..256";
          }
          description
            "Arbitrary name assigned to the
             access control rule.";
        }

        leaf allowed-rights {
          type nacm-rights-type;
          description
            "List of access rights granted to
             specified administrative groups for the
             content specified by the associated path.";
        }

        leaf-list allowed-group {
          type union {
            type nacm-matchall-string-type;
            type nacm-group-name-type;
          }
          min-elements 1;
          description
            "List of administrative groups which will be
             assigned the associated access rights
             for the content specified by the associated path.

             The string '*' indicates that all configured
             administrative groups apply to the entry.";
        }

        leaf nacm-action {
          type nacm-action-type;
          mandatory true;
          description
            "The access control action associated with the
             rule.  If a rule is determined to match a
             particular request, then this object is used
             to determine whether to permit or deny the
             request.";
        }

        leaf comment {
          type string {
            length "1..4095";
          }
          description 
            "A textual description of the access rule.";
        }
      }

      list module-rule {
        key "module-name rule-name";
        ordered-by user;

        description 
          "One Module Access Rule.

           Rules are processed in user-defined order.  A module rule
           is considered a match if the XML namespace for the
           specified module name matches the XML namespace used
           within a NETCONF PDU, and the administrative group
           associated with the requesting session is specified in the
           'allowed-group' leaf-list, and the requested operation
           is included in the 'allowed-rights' leaf.";

        leaf module-name {
          type string;
          description
            "Name of the module associated with this rule.";
        }

        uses common-rule-parms {
          refine allowed-rights {
            mandatory true;
          }
        }
      }

      list rpc-rule {
        key "module-name rpc-name rule-name";
        ordered-by user;

        description 
          "One RPC Operation Access Rule.

           Rules are processed in user-defined order.  An RPC rule is
           considered a match if the module name of the requested RPC
           operation matches 'module-name', the requested RPC
           operation matches 'rpc-name', and an administrative group
           associated with the session user is listed in the
           'allowed-group' leaf-list.  The 'allowed-rights' leaf
           is ignored by the server if it is present.
           Only the 'exec' bit can possibly cause
           a match for an RPC rule.";

        leaf module-name {
          type string;
          description
            "Name of the module defining this RPC operation.";
        }

        leaf rpc-name {
          type string;
          description
            "Name of the RPC operation.";
        }

        uses common-rule-parms;
      }

      list data-rule {
        key "rule-name";
        ordered-by user;

        description 
          "One Data Access Control Rule.

           Rules are processed in user-defined order.  A data rule is
           considered to match when the path expression identifies
           the same node that is being accessed in the NETCONF
           datastore, and the administrative group associated with the
           session is identified in the 'allowed-group' leaf-list,
           and the requested operation is included in the
           'allowed-rights' leaf.";

        leaf path {
          type schema-instance-identifier;
          mandatory true;
          description
            "Schema Instance Identifier associated with the data node
             controlled by this rule.

             Configuration data or state data instance identifiers
             start with a top-level data node.  A complete instance
             identifier is required for this type of path value.

             The special value '/' refers to all possible datastore
             contents.";
        }

        uses common-rule-parms {
          refine allowed-rights {
            mandatory true;
          }
        }
      }

      list notification-rule {
        key "module-name 
             notification-name 
             rule-name";
        ordered-by user;

        description 
          "One Notification Access Rule.

           A notification is considered a match if the module name of
           the requested event type matches
           'module-name', the requested event type
           matches the 'notification-name', and the administrative
           group associated with the requesting session is listed in
           the 'allowed-group' leaf-list.  If the 'allowed-rights'
           leaf is present, it is ignored by the server.  
           Only the 'read' bit can possibly cause
           a match for a notification rule.";

        leaf module-name {
          type string;
          description
            "Name of the module defining this 
             notification event type.";
        }

        leaf notification-name {
          type string;
          description
            "Name of the notification event.";
        }

        uses common-rule-parms;
      }
    }
  }      
}


&lt;CODE ENDS&gt;
             </pre>
<p></p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.3.5.p.1">There are two actions that are requested of IANA: This document registers one URI in "The IETF XML Registry".  Following the format in <a href="#RFC3688">[RFC3688]</a>, the following has been registered.  </p>
<div id="#rfc.figure.6"></div>
<pre>
     URI: urn:ietf:params:xml:ns:yang:ietf-netconf-acm
     Registrant Contact: The IESG.
     XML: N/A, the requested URI is an XML namespace.
             </pre>
<p></p>
<div id="#rfc.figure.7"></div>
<pre>
     name: ietf-netconf-acm
     namespace: urn:ietf:params:xml:ns:yang:ietf-netconf-acm
     prefix: nacm
     reference: RFC XXXX
        // RFC Ed.: Replace XXX with actual RFC number 
        // and remove this note
             </pre>
<p id="rfc.section.3.5.p.3">This document registers one module in the "YANG Module Names" registry.  Following the format in <a href="#RFC6020">[RFC6020]</a>, the following has been registered.  </p>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.3.6.p.1">This entire document discusses access control requirements and mechanisms for restricting NETCONF protocol behavior within a given session.  </p>
<p id="rfc.section.3.6.p.2">Configuration of the access control system is highly sensitive to system security.  A server may choose not to allow any user configuration to some portions of it, such as the global security level, or the groups which allowed access to system resources.  </p>
<p id="rfc.section.3.6.p.3">This document incorporates the optional use of a 'superuser' account, which can be used to bypass access control enforcement.  It is suggested that the 'root' account not be used for NETCONF over SSH servers, because 'root' SSH logins SHOULD be disabled in the SSH server.  </p>
<p id="rfc.section.3.6.p.4">If the server chooses to allow user configuration of the access control system, then only sessions using the 'superuser' administrative user SHOULD be allowed to have write access to the data model.  </p>
<p id="rfc.section.3.6.p.5">If the server chooses to allow user retrieval of the access control system configuration, then only sessions using the 'superuser' administrative user SHOULD be allowed to have read access to the data model.  </p>
<p id="rfc.section.3.6.p.6">There is a risk that invocation of non-standard protocol operations will have undocumented side effects.  An administrator needs to construct access control rules such that the configuration datastore is protected from such side effects.  Also, such protocol operations SHOULD never be invoked by a session using the 'superuser' administrative user.  </p>
<p id="rfc.section.3.6.p.7">There is a risk that non-standard protocol operations, or even the standard &lt;get&gt; operation, may return data which 'aliases' or 'copies' sensitive data from a different data object.  In this case, the namespace and/or the element name will not match the values for the sensitive data, which is then fully or partially copied into a different namespace and/or element.  An administrator needs to avoid using data models which use this practice.  </p>
<p id="rfc.section.3.6.p.8">An administrator needs to restrict write access to all configurable objects within this data model.  It is suggested that only sessions using the 'superuser' administrative role be permitted to configure the data model defined in this document.  </p>
<p id="rfc.section.3.6.p.9">If write access is allowed for configuration of access control rules, then care needs to be taken not to disrupt the access control enforcement.  </p>
<p id="rfc.section.3.6.p.10">An administrator needs to restrict read access to the following objects within this data model, which reveal access control configuration which could be considered sensitive.  </p>

<ul>
<li>enable-nacm</li>
<li>read-default</li>
<li>write-default</li>
<li>exec-default</li>
<li>groups</li>
<li>rules</li>
</ul>

<p> </p>
<h1 id="rfc.references">
<a href="#rfc.references">4.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">4.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3688">[RFC3688]</b></td>
<td class="top">
<a>Mealling, M.</a>, "<a href="http://tools.ietf.org/html/rfc3688">The IETF XML Registry</a>", BCP 81, RFC 3688, January 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5277">[RFC5277]</b></td>
<td class="top">
<a>Chisholm, S.</a> and <a>H. Trevino</a>, "<a href="http://tools.ietf.org/html/rfc5277">NETCONF Event Notifications</a>", RFC 5277, July 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6020">[RFC6020]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="http://tools.ietf.org/html/rfc6020">YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)</a>", RFC 6020, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6021">[RFC6021]</b></td>
<td class="top">
<a>Schoenwaelder, J.</a>, "<a href="http://tools.ietf.org/html/rfc6021">Common YANG Data Types</a>", RFC 6021, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-netconf-4741bis">[I-D.ietf-netconf-4741bis]</b></td>
<td class="top">
<a>Enns, R</a>, <a>Bjorklund, M</a>, <a>Schoenwaelder, J</a> and <a>A Bierman</a>, "<a href="http://tools.ietf.org/html/draft-ietf-netconf-4741bis-10">Network Configuration Protocol (NETCONF)</a>", Internet-Draft draft-ietf-netconf-4741bis-10, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-netconf-rfc4742bis">[I-D.ietf-netconf-rfc4742bis]</b></td>
<td class="top">
<a>Wasserman, M</a> and <a>T Goddard</a>, "<a href="http://tools.ietf.org/html/draft-ietf-netconf-rfc4742bis-08">Using the NETCONF Configuration Protocol over Secure Shell (SSH)</a>", Internet-Draft draft-ietf-netconf-rfc4742bis-08, March 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">4.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2865">[RFC2865]</b></td>
<td class="top">
<a>Rigney, C.</a>, <a>Willens, S.</a>, <a>Rubens, A.</a> and <a>W. Simpson</a>, "<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>", RFC 2865, June 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5607">[RFC5607]</b></td>
<td class="top">
<a>Nelson, D.</a> and <a>G. Weber</a>, "<a href="http://tools.ietf.org/html/rfc5607">Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management</a>", RFC 5607, July 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Usage Examples</h1>
<p id="rfc.section.Appendix A.p.1">The following XML snippets are provided as examples only, to demonstrate how NACM can be configured to perform some access control tasks.  </p>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> &lt;groups&gt; Example</h1>
<p id="rfc.section.Appendix A.1.p.1">There needs to be at least one &lt;group&gt; entry in order for any of the access control rules to be useful.  </p>
<p id="rfc.section.Appendix A.1.p.2">The following XML shows arbitrary groups, and is not intended to represent any particular use-case.  </p>
<div id="#rfc.figure.8"></div>
<pre>
&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
  &lt;groups&gt;
    &lt;group&gt;
      &lt;name&gt;admin&lt;/name&gt;
      &lt;user-name&gt;admin&lt;/user-name&gt;
      &lt;user-name&gt;andy&lt;/user-name&gt;
    &lt;/group&gt;

    &lt;group&gt;
      &lt;name&gt;monitor&lt;/name&gt;
      &lt;user-name&gt;wilma&lt;/user-name&gt;
      &lt;user-name&gt;bam-bam&lt;/user-name&gt;
    &lt;/group&gt;

    &lt;group&gt;
      &lt;name&gt;guest&lt;/name&gt;
      &lt;user-name&gt;guest&lt;/user-name&gt;
      &lt;user-name&gt;guest@example.com&lt;/user-name&gt;
    &lt;/group&gt;
  &lt;/groups&gt;
&lt;/nacm&gt;


            
          </pre>
<p></p>
<p id="rfc.section.Appendix A.1.p.4">This example shows 3 groups: </p>

<ol>
<li>The nacm:admin group contains 2 users named 'admin' and 'andy'.  </li>
<li>The nacm:monitor group contains 2 users named 'wilma' and 'bam-bam'.  </li>
<li>The nacm:guest group contains 2 users named 'guest' and 'guest@example.com'.  </li>
</ol>

<p> </p>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> &lt;module-rule&gt; Example</h1>
<p id="rfc.section.Appendix A.2.p.1">Module rules are used to control access to all the content defined in a specific module.  These rules are checked after none of the specific rules (i.e., rpc-rule, data-rule, or notification-rule) matched the current access request.  </p>
<div id="#rfc.figure.9"></div>
<pre>
&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
  &lt;rules&gt;
    &lt;module-rule&gt;
      &lt;module-name&gt;ietf-netconf-monitoring&lt;/module-name&gt;
      &lt;rule-name&gt;mod-1&lt;/rule-name&gt;
      &lt;allowed-rights&gt;*&lt;/allowed-rights&gt;
      &lt;allowed-group&gt;guest&lt;/allowed-group&gt;
      &lt;nacm-action&gt;deny&lt;/nacm-action&gt;
      &lt;comment&gt;
          Do not allow guests any access to the netconf 
          monitoring information.
      &lt;/comment&gt;
    &lt;/module-rule&gt;

    &lt;module-rule&gt;
      &lt;module-name&gt;ietf-netconf-monitoring&lt;/module-name&gt;
      &lt;rule-name&gt;mod-2&lt;/rule-name&gt;
      &lt;allowed-rights&gt;read&lt;/allowed-rights&gt;
      &lt;allowed-group&gt;monitor&lt;/allowed-group&gt;
      &lt;nacm-action&gt;permit&lt;/nacm-action&gt;
      &lt;comment&gt;
          Allow the monitor group read access to the netconf 
          monitoring information.
      &lt;/comment&gt;
    &lt;/module-rule&gt;

    &lt;module-rule&gt;
      &lt;module-name&gt;*&lt;/module-name&gt;
      &lt;rule-name&gt;mod-3&lt;/rule-name&gt;
      &lt;allowed-rights&gt;exec&lt;/allowed-rights&gt;
      &lt;allowed-group&gt;monitor&lt;/allowed-group&gt;
      &lt;nacm-action&gt;permit&lt;/nacm-action&gt;
      &lt;comment&gt;
          Allow the monitor group to invoke any of the
          supported server operations.
      &lt;/comment&gt;
    &lt;/module-rule&gt;

    &lt;module-rule&gt;
      &lt;module-name&gt;*&lt;/module-name&gt;
      &lt;rule-name&gt;mod-4&lt;/rule-name&gt;
      &lt;allowed-rights&gt;*&lt;/allowed-rights&gt;
      &lt;allowed-group&gt;admin&lt;/allowed-group&gt;
      &lt;nacm-action&gt;permit&lt;/nacm-action&gt;
      &lt;comment&gt;
          Allow the admin group complete access to all
          operations and data.
      &lt;/comment&gt;
    &lt;/module-rule&gt;

  &lt;/rules&gt;
&lt;/nacm&gt;


            
          </pre>
<p></p>
<p id="rfc.section.Appendix A.2.p.3">This example shows 4 module rules: </p>

<dl>
<dt>mod-1:</dt>
<dd style="margin-left: 8">This rule prevents the guest group from reading any monitoring information in the ietf-netconf-monitoring YANG module.  </dd>
<dt>mod-2:</dt>
<dd style="margin-left: 8">This rule allows the monitor group to read the ietf-netconf-monitoring YANG module.  </dd>
<dt>mod-3:</dt>
<dd style="margin-left: 8">This rule allows the monitor group to invoke any protocol operation supported by the server.  </dd>
<dt>mod-4:</dt>
<dd style="margin-left: 8">This rule allows the admin group complete access to all content in the server.  No subsequent rule will match for the admin group, because of this module rule.  </dd>
</dl>

<p> </p>
<h1 id="rfc.appendix.Appendix A.3">
<a href="#rfc.appendix.Appendix%20A.3">Appendix A.3.</a> &lt;rpc-rule&gt; Example</h1>
<p id="rfc.section.Appendix A.3.p.1">RPC rules are used to control access to a specific protocol operation.  </p>
<div id="#rfc.figure.10"></div>
<pre>
&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
  &lt;rules&gt;
    &lt;rpc-rule&gt;
      &lt;module-name&gt;ietf-netconf&lt;/module-name&gt;
      &lt;rpc-name&gt;kill-session&lt;/rpc-name&gt;
      &lt;rule-name&gt;rpc-1&lt;/rule-name&gt;
      &lt;allowed-group&gt;monitor&lt;/allowed-group&gt;
      &lt;allowed-group&gt;guest&lt;/allowed-group&gt;
      &lt;nacm-action&gt;deny&lt;/nacm-action&gt;
      &lt;comment&gt;
        Do not allow the monitor or guest group
        to kill another session.
      &lt;/comment&gt;
    &lt;/rpc-rule&gt;

    &lt;rpc-rule&gt;
      &lt;module-name&gt;ietf-netconf&lt;/module-name&gt;
      &lt;rpc-name&gt;delete-config&lt;/rpc-name&gt;
      &lt;rule-name&gt;rpc-2&lt;/rule-name&gt;
      &lt;allowed-group&gt;monitor&lt;/allowed-group&gt;
      &lt;allowed-group&gt;guest&lt;/allowed-group&gt;
      &lt;nacm-action&gt;deny&lt;/nacm-action&gt;
      &lt;comment&gt;
        Do not allow monitor or guest group
        to delete any configurations.
      &lt;/comment&gt;
    &lt;/rpc-rule&gt;

    &lt;rpc-rule&gt;
      &lt;module-name&gt;ietf-netconf&lt;/module-name&gt;
      &lt;rpc-name&gt;edit-config&lt;/rpc-name&gt;
      &lt;rule-name&gt;rpc-3&lt;/rule-name&gt;
      &lt;allowed-group&gt;monitor&lt;/allowed-group&gt;
      &lt;nacm-action&gt;permit&lt;/nacm-action&gt;
      &lt;comment&gt;
        Allow the monitor group to edit the configuration.
      &lt;/comment&gt;
    &lt;/rpc-rule&gt;
  &lt;/rules&gt;
&lt;/nacm&gt;

            
          </pre>
<p></p>
<p id="rfc.section.Appendix A.3.p.3">This example shows 3 protocol operation rules: </p>

<dl>
<dt>rpc-1:</dt>
<dd style="margin-left: 8">This rule prevents the monitor or guest groups from invoking the NETCONF &lt;kill-session&gt; protocol operation.  </dd>
<dt>rpc-2:</dt>
<dd style="margin-left: 8">This rule prevents the monitor or guest groups from invoking the NETCONF &lt;delete-config&gt; protocol operation.  </dd>
<dt>rpc-3:</dt>
<dd style="margin-left: 8">This rule allows the monitor group to invoke the NETCONF &lt;edit-config&gt; protocol operation.  This rule will have no real affect unless the 'exec-default' leaf is set to 'deny'.  </dd>
</dl>

<p> </p>
<h1 id="rfc.appendix.Appendix A.4">
<a href="#rfc.appendix.Appendix%20A.4">Appendix A.4.</a> &lt;data-rule&gt; Example</h1>
<p id="rfc.section.Appendix A.4.p.1">Data rules are used to control access to specific (config and non-config) data nodes within the NETCONF content provided by the server.  </p>
<div id="#rfc.figure.11"></div>
<pre>
&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
  &lt;rules&gt;
    &lt;data-rule&gt;
      &lt;rule-name&gt;data-1&lt;/rule-name&gt;
      &lt;path&gt;/nacm&lt;/path&gt;
      &lt;allowed-rights&gt;*&lt;/allowed-rights&gt;
      &lt;allowed-group&gt;guest&lt;/allowed-group&gt;
      &lt;nacm-action&gt;deny&lt;/nacm-action&gt;
      &lt;comment&gt;
        Deny the guest group any access to the /nacm data.
      &lt;/comment&gt;
    &lt;/data-rule&gt;

    &lt;data-rule&gt;
      &lt;rule-name&gt;data-acme-config&lt;/rule-name&gt;
      &lt;path xmlns:acme="http://example.com/ns/netconf"&gt;
        /acme:acme-netconf/acme:config-parameters
      &lt;/path&gt;
      &lt;allowed-rights&gt;read create update delete&lt;/allowed-rights&gt;
      &lt;allowed-group&gt;monitor&lt;/allowed-group&gt;
      &lt;nacm-action&gt;permit&lt;/nacm-action&gt;
      &lt;comment&gt;
        Allow the monitor group complete access to the acme
        netconf configuration parameters.  Showing long form
        of 'allowed-rights' instead of shorthand.
      &lt;/comment&gt;
    &lt;/data-rule&gt;

    &lt;data-rule&gt;
      &lt;rule-name&gt;dummy-itf&lt;/rule-name&gt;
      &lt;path xmlns:acme="http://example.com/ns/itf"&gt;
        /acme:interfaces/acme:interface[acme:name='dummy']
      &lt;/path&gt;
      &lt;allowed-rights&gt;read update&lt;/allowed-rights&gt;
      &lt;allowed-group&gt;monitor&lt;/allowed-group&gt;
      &lt;allowed-group&gt;guest&lt;/allowed-group&gt;
      &lt;nacm-action&gt;permit&lt;/nacm-action&gt;
      &lt;comment&gt;
        Allow the monitor and guest groups read
        and update access to the dummy interface.
      &lt;/comment&gt;
    &lt;/data-rule&gt;

    &lt;data-rule&gt;
      &lt;rule-name&gt;admin-itf&lt;/rule-name&gt;
      &lt;path xmlns:acme="http://example.com/ns/itf"&gt;
        /acme:interfaces/acme:interface
      &lt;/path&gt;
      &lt;allowed-rights&gt;*&lt;/allowed-rights&gt;
      &lt;allowed-group&gt;admin&lt;/allowed-group&gt;
      &lt;nacm-action&gt;permit&lt;/nacm-action&gt;
      &lt;comment&gt;
        Allow admin full access to all acme interfaces.
        This is an example of an unreachable rule,
        because the admin group already has full access
        to all modules (see rule 'mod-4'). 
        All 'module-rule' entries will be checked
        before this 'data-rule' entry is checked.
      &lt;/comment&gt;
    &lt;/data-rule&gt;
  &lt;/rules&gt;
&lt;/nacm&gt;

            
          </pre>
<p></p>
<p id="rfc.section.Appendix A.4.p.3">This example shows 4 data rules: </p>

<dl>
<dt>data-1:</dt>
<dd style="margin-left: 8">This rule denies the guest group any access to the &lt;nacm&gt; sub-tree.  Note that the default namespace is only applicable because this sub-tree is defined in the same namespace as the &lt;data-rule&gt; element.  </dd>
<dt>data-acme-config:</dt>
<dd style="margin-left: 8">This rule gives the monitor group read-write access to the acme &lt;config-parameters&gt;.  </dd>
<dt>dummy-itf:</dt>
<dd style="margin-left: 8">This rule gives the monitor and guest groups read-update access to the acme &lt;interface&gt;.  entry named 'dummy'.  This entry cannot be created or deleted by these groups, just altered.  </dd>
<dt>admin-itf:</dt>
<dd style="margin-left: 8">This rule gives the admin group read-write access to all acme &lt;interface&gt;.  entries.  This is an example of an unreachable rule because the 'mod-3' rule already gives the admin group full access to this data.  </dd>
</dl>

<p> </p>
<h1 id="rfc.appendix.Appendix A.5">
<a href="#rfc.appendix.Appendix%20A.5">Appendix A.5.</a> &lt;notification-rule&gt; Example</h1>
<p id="rfc.section.Appendix A.5.p.1">Notification rules are used to control access to a specific notification event type.  </p>
<div id="#rfc.figure.12"></div>
<pre>
&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
  &lt;rules&gt;
    &lt;notification-rule&gt;
      &lt;module-name&gt;acme-system&lt;/module-name&gt;
      &lt;notification-name&gt;sys-config-change&lt;/notification-name&gt;
      &lt;rule-name&gt;notif-1&lt;/rule-name&gt;
      &lt;allowed-group&gt;monitor&lt;/allowed-group&gt;
      &lt;allowed-group&gt;guest&lt;/allowed-group&gt;
      &lt;nacm-action&gt;deny&lt;/nacm-action&gt;
      &lt;comment&gt;
        Do not allow the guest or monitor groups 
        to receive config change events.
      &lt;/comment&gt;
    &lt;/notification-rule&gt;
  &lt;/rules&gt;
&lt;/nacm&gt;

            
          </pre>
<p></p>
<p id="rfc.section.Appendix A.5.p.3">This example shows 1 notification rule: </p>

<dl>
<dt>notif-1:</dt>
<dd style="margin-left: 8">This rule prevents the monitor or guest groups from receiving the acme &lt;sys-config-change&gt; event type.  </dd>
</dl>

<p> </p>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> Change Log</h1>
<p id="rfc.section.Appendix B.p.1">-- RFC Ed.: remove this section before publication.  </p>
<h1 id="rfc.appendix.Appendix B.1">
<a href="#rfc.appendix.Appendix%20B.1">Appendix B.1.</a> 02-03</h1>
<p id="rfc.section.Appendix B.1.p.1">Fixed improper usage of RFC 2119 keywords.  </p>
<p id="rfc.section.Appendix B.1.p.2">Changed term usage of 'database' to 'datastore'.  </p>
<p id="rfc.section.Appendix B.1.p.3">Clarified that 'secure' and 'very-secure' extensions only apply if the /nacm/enable-nacm object is 'true'.  </p>
<h1 id="rfc.appendix.Appendix B.2">
<a href="#rfc.appendix.Appendix%20B.2">Appendix B.2.</a> 01-02</h1>
<p id="rfc.section.Appendix B.2.p.1">Removed authentication text and objects.  </p>
<p id="rfc.section.Appendix B.2.p.2">Changed module name from ietf-nacm to ietf-netconf-acm.  </p>
<p id="rfc.section.Appendix B.2.p.3">Updated NETCONF and YANG terminology.  </p>
<p id="rfc.section.Appendix B.2.p.4">Removed open issues section.  </p>
<p id="rfc.section.Appendix B.2.p.5">Changed some must to MUST in requirements section.  </p>
<h1 id="rfc.appendix.Appendix B.3">
<a href="#rfc.appendix.Appendix%20B.3">Appendix B.3.</a> 00-01</h1>
<p id="rfc.section.Appendix B.3.p.1">Updated YANG anf YANG Types references.  </p>
<p id="rfc.section.Appendix B.3.p.2">Updated module namespace URI to standard format.  </p>
<p id="rfc.section.Appendix B.3.p.3">Updated module header meta-data to standard format.  </p>
<p id="rfc.section.Appendix B.3.p.4">Filled in IANA section.  </p>
<h1 id="rfc.appendix.Appendix B.4">
<a href="#rfc.appendix.Appendix%20B.4">Appendix B.4.</a> 00</h1>
<p id="rfc.section.Appendix B.4.p.1">Initial version cloned from draft-bierman-netconf-access-control-02.txt.  </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Andy Bierman</span> 
	  <span class="n hidden">
		<span class="family-name">Bierman</span>
	  </span>
	</span>
	<span class="org vcardline">Brocade</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:andy.bierman@brocade.com">andy.bierman@brocade.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Martin Bjorklund</span> 
	  <span class="n hidden">
		<span class="family-name">Bjorklund</span>
	  </span>
	</span>
	<span class="org vcardline">Tail-f Systems</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mbj@tail-f.com">mbj@tail-f.com</a></span>

  </address>
</div>

</body>
</html>