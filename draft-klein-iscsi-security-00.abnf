mac = MAC(key, sequence_number || unencrypted_packet) 

K1 = HASH(K || H || X || session_id) (X is e.g. "A") 
K2 = HASH(K || H || K1) 
K3 = HASH(K || H || K1 || K2) 
key = K1 || K2 || K3 || ... 

