


MSEC WG                                                       L. Dondeti
Internet-Draft                                           Nortel Networks
Expires: January 31, 2005                                 August 2, 2004



          GDOIv2: An efficient group key distribution protocol
                       draft-ietf-msec-gdoiv2-00


Status of this Memo


   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.


   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as
   Internet-Drafts.


   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."


   The list of current Internet-Drafts can be accessed at http://
   www.ietf.org/ietf/1id-abstracts.txt.


   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.


   This Internet-Draft will expire on January 31, 2005.


Copyright Notice


   Copyright (C) The Internet Society (2004).  All Rights Reserved.


Abstract


   This document specifies a group key distribution protocol based on
   IKEv2 [2]; the new protocol is similar to IKEv2 in message and
   payload formats, and message semantics to a large extent.  The
   protocol in conformance with MSEC key management architecture
   contains two components: member registration and group rekeying, and
   downloads a group security association from the GCKS to a member.
   This protocol is independent of IKEv2 except in its likeness.


Conventions Used In This Document


   This document recommends, as policy, what specifications for Internet
   protocols -- and, in particular, IETF standards track protocol




Dondeti                 Expires January 31, 2005                [Page 1]
Internet-Draft                   GDOIv2                      August 2004



   documents -- should include as normative language within them.  The
   capitalized keywords "SHOULD", "MUST", "REQUIRED", etc.  are used in
   the sense of how they would be used within other documents with the
   meanings as specified in BCP 14, RFC 2119 [1].


Table of Contents


   1.  Introduction and Overview  . . . . . . . . . . . . . . . . . .  3
     1.1   Why do we need another GSA management protocol?  . . . . .  3
     1.2   GDOIv2 usage scenarios . . . . . . . . . . . . . . . . . .  3
   2.  GDOIv2 protocol  . . . . . . . . . . . . . . . . . . . . . . .  3
     2.1   Member registration and secure channel establishment . . .  3
       2.1.1   Initial exchange:GSA_INIT_EXCH . . . . . . . . . . . .  4
       2.1.2   Authenticated exchange:GSA_AUTH_EXCH . . . . . . . . .  5
   3.  GSA maintenance channel  . . . . . . . . . . . . . . . . . . .  8
     3.1   GSA rekey protocol . . . . . . . . . . . . . . . . . . . .  8
   4.  GDOIv2 protocol details  . . . . . . . . . . . . . . . . . . .  8
   5.  Header and payload formats . . . . . . . . . . . . . . . . . .  9
   6.  Security considerations  . . . . . . . . . . . . . . . . . . .  9
   7.  Acknowledgments  . . . . . . . . . . . . . . . . . . . . . . .  9
   8.  References . . . . . . . . . . . . . . . . . . . . . . . . . .  9
   8.1   Normative References . . . . . . . . . . . . . . . . . . . .  9
   8.2   Informative References . . . . . . . . . . . . . . . . . . .  9
       Author's Address . . . . . . . . . . . . . . . . . . . . . . . 10
       Intellectual Property and Copyright Statements . . . . . . . . 11



























Dondeti                 Expires January 31, 2005                [Page 2]
Internet-Draft                   GDOIv2                      August 2004



1.  Introduction and Overview


   Data security encapsulation protocols such as IPsec and SRTP provide
   confidentiality, message integrity, replay protection, and in some
   instances access control, and data origin authentication.  These
   security services require state establishment, maintenance, and
   teardown for correct operation.  While these security associations
   can be managed manually, automatic key management protocols are
   essential for efficient and scalable operation.  In case of
   point-to-point security associations, IKE and its successor IKEv2 are
   widely used for IPsec SAs, and MIKEY for SRTP associations.  For
   multi-point SAs or group SAs (GSA), GDOI, GSAKMP, and MIKEY have been
   specified by the MSEC WG.  This specification adds another protocol,
   namely GDOIv2, to this collection.


1.1  Why do we need another GSA management protocol?


   Given the collection of key management protocols mentioned above,
   there is a question on the need for yet another group key management
   protocol.  First a look back at history: So far, we have two
   experimental RFCs, viz., RFC 1949 [3] and RFC 2093 [4], and a
   standards track RFC, RFC 3547 [5] specifying or describing group key
   management protocols.  Furthermore there is GSAKMP, currently a
   standards track MSEC I-D, which borrows quite a few concepts from
   IKEv2, but not quite similar to IKEv2.  The protocol we propose is
   mainly to reuse as much as the IKEv2 codebase, similar to GDOI
   reusing payload and message formats of IKE [7] and ISAKMP [6] .


1.2  GDOIv2 usage scenarios


   GDOIv2 is a key download protocol.  Key download as opposed to key
   negotiation has several interesting use cases.
   o  The first application is multicast security.  As with GDOI, the
      current version of the GDOIv2 spec limits the scope to single
      sender multicast applications.
   o  The second intended application is point to point data security
      associations facilitated by a centralized group key server.
   o  Others to be listed!


2.  GDOIv2 protocol


2.1  Member registration and secure channel establishment


   The first of two components in GSA establishment and maintenance is
   member registration.







Dondeti                 Expires January 31, 2005                [Page 3]
Internet-Draft                   GDOIv2                      August 2004



2.1.1  Initial exchange:GSA_INIT_EXCH


   The first step in the registration protocol is to establish a secure
   channel with the group controller and key server (GCKS).  This
   exchange is similar to IKE_SA_INIT exchange of IKEv2.  The
   registering member proposes various combinations of algorithms in
   SAi1 to constitute the secure channel, along with a nonce, Ni, and a
   DH exponent, KEi.  The GCKS has several options:
   o  In the first, it honors the member's request for registration and
      sends the necessary information to complete the DH exchange: it
      selects and specifies the parameters of the secure channel, and
      includes a nonce Nr, and a public DH value of its own, KEr.
   o  The second option is for the GCKS to consider if the request for
      secure channel establishment is spurious.  It has no way to tell
      except to throttle such requests by making the initiator do some
      work before it invests any computing resources.  This is known as
      the DoS protection mode in IKEv2 and is explained in detail in
      Section 2.1.1.1 .
   o  Finally, if none of the proposals are acceptable to the GCKS, it
      may reject the initial exchange itself.


   GSA_INIT_EXCH message is as follows:



   Member->GCKS: M1:    HDR, SAi1, KEi, Ni
   GCKS->Member: M2:    HDR, SAr1, KEr, Nr, [CERTREQ]



                 Figure 1: Secure channel establishment



2.1.1.1  DoS protection mode




















Dondeti                 Expires January 31, 2005                [Page 4]
Internet-Draft                   GDOIv2                      August 2004



   DoS protection exchange is as follows:



   Member->GCKS: IM:  HDR(A,0), SAi1, KEi, Ni
   GCKS->Member: CM:   HDR(A,0), N(COOKIE)


   Member->GCKS: M1:   HDR(A,0), N(COOKIE), SAi1, KEi, Ni
   GCKS->Member: M2:  HDR(A,B), SAr1, KEr, Nr, [CERTREQ]


   IM: Initial Message from the Member
   CM: Challenge Message from the GCKS



             Figure 2: DoS protection mode of GSA_INIT_EXCH



2.1.2  Authenticated exchange:GSA_AUTH_EXCH


   GSA_AUTH_EXCH message is as follows:



   Member->GCKS: M3: HDR, SK{ G-ID, IDi, [ID_CERT,] [ID_CERTREQ,] AUTH,
                  [IDr,] [GM_CERT,] [GM_CERTREQ,] [POP_I] }
   GCKS->Member: M4: HDR, SK{ IDr, [ID_CERT,] AUTH, GSA, KD [,SEQ]
                  [GCKS_CERT,] [,POP_R]}



                    Figure 3: Authenticated Exchange


   The various payloads in the GSA_AUTH_EXCH messages have the following
   purposes:
   o  G-ID:  The group identity payload constructed using the IKEv2
      Identification Payload specifies the secure group that M3 wants to
      join.
   o  ID_CERT: The optional ID_CERT payload contains a certificate(s)
      asserting the GCKS's or a member's claimed identity as in IDi or
      IDr payloads.
   o  GM_CERT: The optional GM_CERT payload contains a certificate
      asserting the group member's authorization to join the group G-ID
      as member.
   o  GCKS_CERT: The optional GCKS_CERT payload contains a certificate
      asserting the GCKS's authorization to serve the role of a group
      controller and key server for the group G-ID.
   o  AUTH: The AUTH payload constitues the "authenticated" portion of
      the 4 or 6 message AKE.  In other words, the member in M3 and the
      GCKS in M4 prove that they are indeed the entities that sent M1
      and M2 respectively.  A pre-established shared secret or a
      certificate (optionally specified in the CERT payload) may be used




Dondeti                 Expires January 31, 2005                [Page 5]
Internet-Draft                   GDOIv2                      August 2004



      for entity authentication.
   o  POP: Similar to the AUTH payload's use in providing host/entity
      authentication, the POP payload is for member/GCKS authorization
      to assume their claimed roles.  The GM_CERT or GCKS_CERT is used
      to sign a block of data, specified below, to constitute the POP
      payload.
   o  GSA: The GSA payload contains the rekey and data security SA
      payloads.  Note that this SA is not negotiated; the GCKS simply
      sends this SA.
   o  KD: The KD payload contains the secret keys corresponding the
      rekey and the data security SAs included in the GSA payload.
   o  SEQ: The optional SEQ payload MUST be included if the GSA payload
      contains a rekey SA.  The SEQ payload contains a SEQ number for
      replay protection of the rekey messages.


2.1.2.1  Key material computation


   The key material computation and the AUTH payload are identical to
   that described in the IKEv2 specification.


   Key material and registration SA keys are computed as follows:




   SKEYSEED = prf(Ni | Nr, g^ir)


     {SK_d | SK_ai | SK_ar | SK_ei | SK_er | SK_pi | SK_pr }
                 = prf+ (SKEYSEED, Ni | Nr | SPIi | SPIr ), where


   prf+ is defined as follows:


      prf+ (K,S) = T1 | T2 | T3 | T4 | ...


      where:
      T1 = prf (K, S | 0x01)
      T2 = prf (K, T1 | S | 0x02)
      T3 = prf (K, T2 | S | 0x03)
      T4 = prf (K, T3 | S | 0x04)



           Figure 4: Registration SA key material computation



2.1.2.2  Member and GCKS authentication


   This specification supports pre-shared keys as well certificates for
   entity authentication.  M3 and M4 contain AUTH payloads that
   essentially protect against man-in-the-middle attacks against the DH




Dondeti                 Expires January 31, 2005                [Page 6]
Internet-Draft                   GDOIv2                      August 2004



   exchange in M1 and M2.  The member and the GCKS construct AUTH
   payloads by computing an HMAC over or signing a block of data
   containing the message M1 or M2 they sent earlier, the other party's
   nonce payload, and a prf over own identity.  More formally, the block
   of data for HMAC or signature is as follows:


   Auth payload computation:



   Auth payload in M3 is computed over:


   auth-block-M3: M1 || Nr-Payload || prf(SK_pi, IDi-Payload)


   Auth payload in M4 is computed over:


   auth-block-M4: M2 || Ni-Payload || prf(SK_pr, IDr-Payload)


   For shared secret based host authentication AUTH payload is
   computed as follows:


   AUTH = prf(prf(Shared Secret,"KeyPad:GDOIv2-AUTH-MX"),
                  <auth-block-MX>)



                   Figure 5: Auth payload computation



2.1.2.3  Proof of possession


   Proof of possession payload (POP) provides a mechanism so that
   members and/or GCKS can prove to the other party that they are indeed
   authorized to be a member or the GCKS, respectively.  For POP payload
   derivation in GDOIv2, the member or the GCKS first constructs a
   message block, POP-HASH, containing the two nonces exchanged in
   GSA_INIT_EXCH and the prf over the ID payload as defined in the AUTH
   payload construction.  Next, the member or the GCKS signs the
   POP-HASH value.


   POP-HASH construction is as follows:













Dondeti                 Expires January 31, 2005                [Page 7]
Internet-Draft                   GDOIv2                      August 2004



   POP payload :



   POP payload in M3 is constructed over the following message block:


   POP-HASH-M3: "KeyPad:GDOIv2-POP-M3" ||
                 Ni-Payload || Nr-Payload || prf(SK_pi, IDi-Payload)


   POP payload in M4 is computed over:


   POP-HASH-M4: "KeyPad:GDOIv2-POP-M4" ||
                Ni-Payload || Nr-Payload || prf(SK_pr, IDr-Payload)



                Figure 6: POP payload computation block



3.  GSA maintenance channel


3.1  GSA rekey protocol


   GSA rekey protocol is optional to implement, but it plays a crucial
   role for large and dynamic groups.


   The GCKS is responsible for rekeying of the secure group as per the
   group policy.  The GCKS uses multicast or multi-unicast to transport
   the rekey message.  When multi-unicast is used, it may be appropriate
   in some scenarios to have a reply message from the member(s) to the
   GCKS.  The reply message is optional.


   Rekey message is as follows:



   Multicast:
   GCKS->Member:    HDR, SK {[N], SEQ, GSA, KD, [GCKS_CERT,] SIG}


   Unicast:
   GCKS->Member:    HDR, SK {N, SEQ, GSA, KD, [GCKS_CERT,] SIG}
   [Member->GCKS]:    [HDR, SK {N, SEQ, AUTH}]



                        Figure 7: Rekey message



4.  GDOIv2 protocol details







Dondeti                 Expires January 31, 2005                [Page 8]
Internet-Draft                   GDOIv2                      August 2004



5.  Header and payload formats


   To be copied from IKEv2 and GDOI specifications.  We do anticipate
   some minor changes however.


6.  Security considerations


7.  Acknowledgments


   GDOIv2 is based on IKEv2 and GDOI.  Several sections of this document
   are quite identical to IKEv2 and GDOI specifications.  We included
   the text for completeness of this specification.  We appreciate the
   efforts of the contributors and editors of those protocols.


8.  References


8.1  Normative References


   [1]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", BCP 14, RFC 2119, March 1997.


   [2]  Kaufman, C., "Internet Key Exchange (IKEv2) Protocol",
        Internet-Draft: draft-ietf-ipsec-ikev2-14.txt (Work in
        progress), May 2004.


8.2  Informative References


   [3]  Ballardie, T., "Scalable Multicast Key Distribution", RFC 1949,
        May 1996.


   [4]  Harney, H. and C. Muckenhirn, "Group Key Management Protocol
        (GKMP) Specification", RFC 2093, July 1997.


   [5]  Baugher, M., Weis, B., Hardjono, T. and H. Harney, "The Group
        Domain of Interpretation", RFC 3547, July 2003.


   [6]  Maughan, D., Schneider, M. and M. Schertler, "Internet Security
        Association and Key Management Protocol (ISAKMP)", RFC 2408,
        November 1998.


   [7]  Harkins, D. and D. Carrel, "The Internet Key Exchange (IKE)",
        RFC 2409, November 1998.










Dondeti                 Expires January 31, 2005                [Page 9]
Internet-Draft                   GDOIv2                      August 2004



Author's Address


   Lakshminath Dondeti
   Nortel Networks
   600 Technology Park drive
   Billerica, MA  01821
   US


   Phone: +1 978 288 6406
   EMail: ldondeti@nortelnetworks.com










































Dondeti                 Expires January 31, 2005               [Page 10]
Internet-Draft                   GDOIv2                      August 2004



Intellectual Property Statement


   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights.  Information on the
   IETF's procedures with respect to rights in standards-track and
   standards-related documentation can be found in BCP-11.  Copies of
   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementors or users of this specification can
   be obtained from the IETF Secretariat.


   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard.  Please address the information to the IETF Executive
   Director.



Full Copyright Statement


   Copyright (C) The Internet Society (2004).  All Rights Reserved.


   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.


   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assignees.


   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION




Dondeti                 Expires January 31, 2005               [Page 11]
Internet-Draft                   GDOIv2                      August 2004



   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.



Acknowledgment


   Funding for the RFC Editor function is currently provided by the
   Internet Society.












































Dondeti                 Expires January 31, 2005               [Page 12]