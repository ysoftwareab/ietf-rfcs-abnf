


INTERNET-DRAFT                                                 B. Jewell
December 4, 1997                                               D. Chuang
                                                               3Com, Inc.
 

 Definitions of Managed Objects for the Virtual Router Redundancy Protocol
                            using SNMPv2

                    <draft-ietf-vrrp-mib-00.txt>

 
Status of this Memo

 
   This document is an Internet-Draft.  Internet-Drafts are working
   documents of the Internet Engineering Task Force (IETF), its areas,
   and its working groups. Note that other groups may also distribute
   working documents as Internet-Drafts.
 
   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as ``work in progress.''
 
   To learn the current status of any Internet-Draft, please check the
   ``1id-abstracts.txt'' listing contained in the Internet-Drafts Shadow
   Directories on ds.internic.net (US East Coast), nic.nordu.net
   (Europe), ftp.isi.edu (US West Coast), or munnari.oz.au (Pacific
   Rim).


Abstract

   This specification defines an extension to the Management Information
   Base (MIB) for use with SNMP-based network management.  In
   particular, it defines objects for configuring, monitoring, and
   controlling routers that employ the Virtual Router Redundancy 
   Protocol (VRRP) [1].
 
   This memo specifies a MIB module in a manner that is both compliant
   to the SNMPv2 SMI [2], and semantically identical to the SNMPv1
   definitions [3].














draft-ietf-vrrp-mib-00.txt                                    [Page 1]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

Table of Contents
 
   1. Introduction ..........................................    1
   2. The SNMP Network Management Framework .................    2
   2.1 Object Definitions ...................................    3
   3. Overview ..............................................    4
   3.1 MIB Structure ........................................    4
   3.2 Virtual Routers ......................................    5
   3.3 Terminology ..........................................    5
   3.4 VRRP Scenarios .......................................
   4. Definitions ...........................................    6
   5. Acknowledgements ......................................   19
   6. References ............................................   19
   7. Author's Address ......................................   20


 
2.   The SNMPv2 Network Management Framework
 
   The SNMP Network Management Framework presently consists of three
   major components.  They are:
 
   o    the SMI, described in RFC 1902 [1] - the mechanisms used for
        describing and naming objects for the purpose of management.
 
   o    the MIB-II, STD 17, RFC 1213 [2] - the core set of managed
        objects for the Internet suite of protocols.
 
   o    the protocol, RFC 1157 [3] and/or RFC 1905 [4], - the protocol
        for accessing managed objects.
 
   The Framework permits new objects to be defined for the purpose of
   experimentation and evaluation.


2.1  Object Definitions
 
   Managed objects are accessed via a virtual information store, termed
   the Management Information Base or MIB.  Objects in the MIB are
   defined using the subset of Abstract Syntax Notation One (ASN.1)
   defined in the SMI.  In particular, each object type is named by an
   OBJECT IDENTIFIER, an administratively assigned name.  The object
   type together with an object instance serves to uniquely identify a
   specific instantiation of the object.  For human convenience, we
   often use a textual string, termed the descriptor, to also refer to
   the object type.

   The syntax of an object type defines the abstract data structure
   corresponding to that object type.  The ASN.1 language is used for
   this purpose.  However, the SMI [3] purposely restricts the ASN.1
   constructs which may be used.  These restrictions are explicitly made
   for simplicity.
 


draft-ietf-vrrp-mib-00.txt                                    [Page 2]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

   The encoding of an object type is simply how that object type is
   represented using the object type's syntax.  Implicitly tied to the
   notion of an object type's syntax and encoding is how the object type
   is represented when being transmitted on the network.
 
   The SMI specifies the use of the basic encoding rules of ASN.1 [8],
   subject to the additional requirements imposed by the SNMP.
 
 
3.0  Overview

   This memo identifies the set of objects for configuring, monitoring, 
   and controlling the Virtual Router Redundancy Protocol (VRRP). It is 
   based on (Revision 2) of the VRRP specification, entitled 

      "draft-ietf-vrrp-spec-03.txt"

   VRRP specifies an election protocol that dynamically allows a set of
   routers running VRRP to backup each other on a LAN.  The VRRP router
   controlling one or more IP addresses is called the Master router, and
   forwards packets sent to these IP addresses.  The election process
   provides dynamic fail over in the forwarding responsibility should
   the Master become unavailable.  This allows any of the VRRP routers
   IP addresses on the LAN to be used as the default first hop router by
   end-hosts.  The advantage gained from using the VRRP is a higher
   availability default path without requiring configuration of dynamic
   routing or router discovery protocols on every end-host.


3.1  VRRP MIB Structure

    The VRRP MIB contains three conformance groups:
 
    - vrrpOperations Group: Objects related to this virtual router's 
      configuration and control.

    - vrrpStatistics Group: Objects containing information useful in
      monitoring the operation of a virtual router.

    - vrrpNotifications Group: Consists of objects and definitions for
      use in SNMP traps.

   Tables in the MIB include the following:

   (1) The vrrpOperTable which contains objects that define the operational
       characteristics of a virtual router.

   (2) The vrrpAssoIpAddrTable which contains the adddresses of the
       router(s) that a given virtual router is backing up.

   (3) The vrrpRouterStatsTable which contains the operating statistics 
       for a virtual router.



draft-ietf-vrrp-mib-00.txt                                    [Page 3]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

3.2  Virtual Routers

   A 'virtual router' is one of a set of routers running VRRP on a LAN.
   This MIB makes the following assumptions:

   (1) One or more virtual routers can be configured on a single 'physical 
       router'. 

   (2) An instance of a virtual router (on a physical router) can be 
       uniquely identified by a combination of the 'IF Index' [4] and 
       Virtual Router Identifier (VRID). This is also refered to as
       a 'IF/VRID pair'.

   (3) A VRID can be thought of a defining a "pool" of IP addresses that
       is backed up by two or more virtual routers. The pool cannot
       span multiple routers, i.e., all the IP addresses in a pool must
       be native to a single physical router.

   The tables in the MIB have been structured with the assumption that 
   a VRRP network management application would likely be designed to
   provide configuration or display information about VRRP on a 
   per-virtual-router-basis.


3.3  Terminology

   The following definitions are used in this MIB:

   - Primary IP Address: The 'real' IP address assigned to an interface.
     A real IP address can be used as an index to the 'ipAddrTable' as
     defined in MIB-II. [4]

   - Native IP Address: Identical to a primary IP address.

   - Backup IP Address: An IP address that is specified as an entry in
     the 'vrrpAssoIpAddrTable'. These are addresses that will be assumed
     by a virtual router in the event that they become unreachable.

   - Inherited IP Address: An IP address that has been assumed by another
     virtual router due to a failure of the router that was previously
     responding to it.














draft-ietf-vrrp-mib-00.txt                                    [Page 4]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

3.4  VRRP Scenarios

   The following section provides examples of how some of the objects
   in this MIB are instantiated for two different VRRP scenarios. The
   first scenario is taken from the VRRP RFC [1].

   KEY:
   ----
   The labels in the following table diagrams correspond to the actual 
   MIB objects as follows:

   if      = vrrpOperIfIndex
   VrId    = vrrpOperVrId
   State   = vrrpOperState
   Prior   = vrrpOperPriority
   AddrCnt = vrrpOperIpAddrCount
   IpAddr  = vrrpOperMasterIpAddr
   RowStat = vrrpOperRowStatus


3.4.1  VRRP Scenario #1
   
   The following figure shows a simple network with two virtual routers.
   This topology is taken from the VRRP Specification [1].


                       VRID=1       VRID=2
                      +-----+      +-----+
                      | MR1 |      | MR2 |
                      |  &  |      |  &  |
                      | BR2 |      | BR1 |
                      +-----+      +-----+
         IP A ---------->*            *<---------- IP B
         Interface=I1    |            |            Interface=I2
                         |            |
                         |            |
       ------------------+------------+-----+--------+--------+--------+--
                                            ^        ^        ^        ^
                                            |        |        |        |
                                          (IP A)   (IP A)   (IP A)   (IP A)
                                            |        |        |        |
                                         +--+--+  +--+--+  +--+--+  +--+--+
                                         |  H1 |  |  H2 |  |  H3 |  |  H4 |
                                         +-----+  +-----+  +--+--+  +--+--+











draft-ietf-vrrp-mib-00.txt                                    [Page 5]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

            -----   MIB Tables For Router "IP A":   -----

   vrrpOperTable
   -------------

   | if | VrId | State | Prior | AddrCnt | IpAddr | ... | RowStat |
   +----+------+-------+-------+---------+--------+-( )-+---------+  
   |    |      |       |       |         |        |     |         |
   | I1 |  01  |   M   |  255  |   1     |   A    |     | active  |
   |    |      |       |       |         |        |     |         |
   +----+------+-------+-------+---------+--------+-( )-+---------+  
   |    |      |       |       |         |        |     |         |
   | I1 |  02  |   B   | 1-254 |   1     |   B    |     | active  |
   |    |      |       |       |         |        |     |         |
   +----+------+-------+-------+---------+--------+-( )-+---------+  


   vrrpAssoIpAddrTable
   -------------------

   | if | VrId | Index | IP Addr | RowStat | 
   +----+------+-------+---------+---------+
   |    |      |       |         |         |
   | I1 |  01  |   1   |    A    | active  |
   |    |      |       |         |         |
   +----+------+-------+---------+---------+
   |    |      |       |         |         |
   | I1 |  02  |   1   |    B    | active  |
   |    |      |       |         |         |
   +----+------+-------+---------+---------+


            -----   MIB Tables For Router "IP B":   -----

   vrrpOperTable
   -------------

   | if | VrId | State | Prior | AddrCnt | IpAddr | ... | RowStat |
   +----+------+-------+-------+---------+--------+-( )-+---------+  
   |    |      |       |       |         |        |     |         |
   | I2 |  01  |   B   | 1-254 |   1     |   A    |     | active  |
   |    |      |       |       |         |        |     |         |
   +----+------+-------+-------+---------+--------+-( )-+---------+  
   |    |      |       |       |         |        |     |         |
   | I2 |  02  |   M   |  255  |   1     |   B    |     | active  |
   |    |      |       |       |         |        |     |         |
   +----+------+-------+-------+---------+--------+-( )-+---------+  








draft-ietf-vrrp-mib-00.txt                                    [Page 6]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

   vrrpAssoIpAddrTable
   -------------------

   | if | VrId | Index | IP Addr | RowStat | 
   +----+------+-------+---------+---------+
   |    |      |       |         |         |
   | I1 |  01  |   1   |    A    | active  |
   |    |      |       |         |         |
   +----+------+-------+---------+---------+
   |    |      |       |         |         |
   | I1 |  02  |   1   |    B    | active  |
   |    |      |       |         |         |
   +----+------+-------+---------+---------+


   NOTES:

   1)  "I1" and "I2" are used to designate IF indices on each respective  
       router.

   2)  For "State": M = Master; B = Backup.

   3)  In the vrrpOperTable, a "priority" of 255 indicates that the 
       respective router owns the IP address, e.g., this IP address is
       native to the router


3.4.2  VRRP Scenario #2

   The following figure shows a simple network with two virtual routers.
   Here, a single interface has been configured with two IP addresses.


                       VRID=1       VRID=2
                      +-----+      +-----+
                      | MR1 |      | MR2 |
                      |  &  |      |  &  |
                      | BR2 |      | BR1 |
                      +-----+      +-----+
         IP A ---------->*            *<---------- IP B
         IP C            |            |            Interface=I2
         Interface=I1    |            |
                         |            |
                         |            |
       ------------------+------------+-----+--------+--------+--------+--
                                            ^        ^        ^        ^
                                            |        |        |        |
                                          (IP A)   (IP B)   (IP C)   (IP D)
                                            |        |        |        |
                                         +--+--+  +--+--+  +--+--+  +--+--+
                                         |  H1 |  |  H2 |  |  H3 |  |  H4 |
                                         +-----+  +-----+  +--+--+  +--+--+



draft-ietf-vrrp-mib-00.txt                                    [Page 7]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997


          -----   MIB Tables For Router "IP A" (and IP C):   -----

   vrrpOperTable
   -------------

   | if | VrId | State | Prior | AddrCnt | IpAddr | ... | RowStat |
   +----+------+-------+-------+---------+--------+-( )-+---------+  
   |    |      |       |       |         |        |     |         |
   | I1 |  01  |   M   |  255  |   2     |   A    |     | active  |
   |    |      |       |       |         |        |     |         |
   +----+------+-------+-------+---------+--------+-( )-+---------+  
   |    |      |       |       |         |        |     |         |
   | I1 |  02  |   B   | 1-254 |   1     |   B    |     | active  |
   |    |      |       |       |         |        |     |         |
   +----+------+-------+-------+---------+--------+-( )-+---------+  


   vrrpAssoIpAddrTable
   -------------------

   | if | VrId | Index | IP Addr | RowStat | 
   +----+------+-------+---------+---------+
   |    |      |       |         |         |
   | I1 |  01  |   1   |    A    | active  |
   |    |      |       |         |         |
   +----+------+-------+---------+---------+
   |    |      |       |         |         |
   | I1 |  01  |   2   |    C    | active  |
   |    |      |       |         |         |
   +----+------+-------+---------+---------+
   |    |      |       |         |         |
   | I1 |  02  |   1   |    B    | active  |
   |    |      |       |         |         |
   +----+------+-------+---------+---------+


            -----   MIB Tables For Router "IP B":   -----

   vrrpOperTable
   -------------

   | if | VrId | State | Prior | AddrCnt | IpAddr | ... | RowStat |
   +----+------+-------+-------+---------+--------+-( )-+---------+  
   |    |      |       |       |         |        |     |         |
   | I2 |  01  |   B   | 1-254 |   2     |   A    |     | active  |
   |    |      |       |       |         |        |     |         |
   +----+------+-------+-------+---------+--------+-( )-+---------+  
   |    |      |       |       |         |        |     |         |
   | I2 |  02  |   M   |  255  |   1     |   B    |     | active  |
   |    |      |       |       |         |        |     |         |
   +----+------+-------+-------+---------+--------+-( )-+---------+  



draft-ietf-vrrp-mib-00.txt                                    [Page 8]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

   vrrpAssoIpAddrTable
   -------------------

   | if | VrId | Index | IP Addr | RowStat | 
   +----+------+-------+---------+---------+
   |    |      |       |         |         |
   | I1 |  01  |   1   |    A    | active  |
   |    |      |       |         |         |
   +----+------+-------+---------+---------+
   |    |      |       |         |         |
   | I1 |  01  |   2   |    C    | active  |
   |    |      |       |         |         |
   +----+------+-------+---------+---------+
   |    |      |       |         |         |
   | I1 |  02  |   1   |    B    | active  |
   |    |      |       |         |         |
   +----+------+-------+---------+---------+


   NOTES:

   1)  The 'vrrpAssoIpAddrIndex' (labeled as 'Index' in the diagrams above)
       does not have to be consecutive numbers. These are set by the
       management application(s).































draft-ietf-vrrp-mib-00.txt                                    [Page 9]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

4. Definitions
 
 
   VRRP-MIB DEFINITIONS ::= BEGIN
 
    IMPORTS
        MODULE-IDENTITY, OBJECT-TYPE, 
        NOTIFICATION-TYPE, Counter32, 
        Integer32, TimeTicks, IpAddress     FROM SNMPv2-SMI    -- RFC1442
        TEXTUAL-CONVENTION, RowStatus,
        PhysAddress                         FROM SNMPv2-TC     -- RFC1443
        MODULE-COMPLIANCE, OBJECT-GROUP     FROM SNMPv2-CONF   -- RFC1444
        mib-2                               FROM RFC1213-MIB;
 
 
    vrrp  MODULE-IDENTITY
          LAST-UPDATED "9606040900Z"    -- Dummy value
          ORGANIZATION "IETF VRRP Working Group"
          CONTACT-INFO
                 "Brian R. Jewell
          Postal: 3Com Corporation
                  5400 BayFront Plaza
                  Santa Clara, California 95052
          Tel:    +1 408 764 6173
          E-Mail: bjewell@3com.com"
 
        DESCRIPTION
            "The MIB module to describe the VRRP Version 2 Protocol."
        ::= { mib-2 46 }


    vrrpMIB         OBJECT IDENTIFIER ::= { vrrp 1 }


-- *******************************************************************
--  Textual Conventions 
-- *******************************************************************

    VrId ::= TEXTUAL-CONVENTION
        STATUS       current
        DESCRIPTION
            "A unique number that serves to identify a router participating
            in the Virtual Router Redundancy Protocol. On an interface
            running VRRP, each virtual router can be configured with a 
            virtual router identifier (VRID).  A VRID essentially defines 
            a 'pool' of IP addresses that are backed-up by two or more 
            virtual routers."
        SYNTAX      Integer32 (1..255)







draft-ietf-vrrp-mib-00.txt                                    [Page 10]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

-- *******************************************************************
--  VRRP MIB Groups
-- *******************************************************************

    vrrpOperations      OBJECT IDENTIFIER ::= { vrrpMIB 1 }
    vrrpStatistics      OBJECT IDENTIFIER ::= { vrrpMIB 2 }
    vrrpNotifications   OBJECT IDENTIFIER ::= { vrrpMIB 3 }
    vrrpConformance     OBJECT IDENTIFIER ::= { vrrpMIB 4 }


-- *******************************************************************
--  Start of MIB objects
-- *******************************************************************

    vrrpNodeVersion  OBJECT-TYPE
        SYNTAX       OCTET STRING (SIZE (2))
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
           "This value identifies the particular version of the VRRP
            supported by this node. The current value is '02'."
        REFERENCE
           "Virtual Router Redundancy Protocol, RFC XXXX"
        DEFVAL { '0200'H }
        ::= { vrrpOperations 1 }

    vrrpTrapCntl  OBJECT-TYPE
        SYNTAX       INTEGER {
            enabled     (1),
            disabled    (2)
        }
        MAX-ACCESS   read-create
        STATUS       current
        DESCRIPTION
           "Indicates whether the VRRP-enabled node will generate
            SNMP traps for events defined in this MIB. With the value 
            of `enabled', the node will emit traps. With the value of 
            `disabled', no traps are sent. When this object is set,
            changes take place immediately."
        DEFVAL { enabled }
        ::= { vrrpOperations 2 }














draft-ietf-vrrp-mib-00.txt                                    [Page 11]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

-- *******************************************************************
--  VRRP Operations Table
-- *******************************************************************

    vrrpOperTable OBJECT-TYPE
        SYNTAX       SEQUENCE OF VrrpOperEntry
        MAX-ACCESS   not-accessible
        STATUS       current
        DESCRIPTION
            "Operations table for a VRRP router which consists of a
             list (i.e., one or more conceptual rows) of 'vrrpOperEntry'
             items."
        ::= { vrrpOperations 3 }

    vrrpOperEntry OBJECT-TYPE
        SYNTAX       VrrpOperEntry
        MAX-ACCESS   not-accessible
        STATUS       current
        DESCRIPTION
            "An entry in the table, containing information about 
             VRRP the operational characteristics of a virtual router. 
             A given IF Index can have one or more 'contexts' of VRRP 
             in operation; each context is identifed by a unique VRID."
        INDEX    { vrrpOperIfIndex, vrrpOperVrId }
        ::= { vrrpOperTable 1 }

    VrrpOperEntry ::=
        SEQUENCE {
            vrrpOperIfIndex
                Integer32,
            vrrpOperVrId
                VrId,
            vrrpOperVirtualMacAddr
                PhysAddress,
            vrrpOperState
                INTEGER,
            vrrpOperControl
                INTEGER,
            vrrpOperPriority
                Integer32,
            vrrpOperIpAddrCount
                Integer32,
            vrrpOperMasterIpAddr
                IpAddress,
            vrrpOperAuthType
                INTEGER,
            vrrpOperHMACMD5Key
                OCTET STRING,
            vrrpOperAuthKey
                OCTET STRING,
            vrrpOperAdvertisementInterval
                Integer32,



draft-ietf-vrrp-mib-00.txt                                    [Page 12]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

            vrrpOperPreemptMode
                INTEGER,
            vrrpOperVirtualRouterUpTime
                TimeTicks,
            vrrpOperRowStatus
                RowStatus
    }

    vrrpOperIfIndex OBJECT-TYPE
        SYNTAX       Integer32 
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "This object identifies the interface within the system 
             for which this entry contains information."
        REFERENCE
            "rfc1573"
        ::= { vrrpOperEntry 1 }

    vrrpOperVrId OBJECT-TYPE
        SYNTAX       VrId
        MAX-ACCESS   read-create
        STATUS       current
        DESCRIPTION
            "This object contains the Virtual Router Identifier (VRID)."
        ::= { vrrpOperEntry 2 }

    vrrpOperVirtualMacAddr OBJECT-TYPE
        SYNTAX       PhysAddress
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The virtual MAC address of the virtual router. This is derived
            as follows: 00-00-5E-XX-XX-<VRID>.

            Where the first three octets consist of the IANA's OUI; The
            next two octets (as yet to be assigned) indicate the address
            block of the VRRP protocol; and the remaining octets consist
            of the VRID.

            Although this object can be derived from the 'vrrpOperVrId'
            object, it is included here, for completeness, so that it
            is easily obtainable by a management application and can be
            included in VRRP-related SNMP traps."
        REFERENCE
            "rfc1443 - PhysAddress"
        ::= { vrrpOperEntry 3 }








draft-ietf-vrrp-mib-00.txt                                    [Page 13]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

    vrrpOperState OBJECT-TYPE
        SYNTAX       INTEGER {
            initialize(1),  -- Waiting for a startup event
            backup(2),      -- Monitoring the state/availability of
                            -- master router
            master(3)       -- Forwarding IP addresses associated with
                            -- this virtual router.
        } 
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The current state of the virtual router."
        ::= { vrrpOperEntry 4 }

    vrrpOperControl OBJECT-TYPE
        SYNTAX       INTEGER {
            enabled(1),
            disabled(2)
        }
        MAX-ACCESS   read-create
        STATUS       current
        DESCRIPTION
            "This object will enable/disable the virtual router
            function. Setting the value to 'enabled', will transition
            the state of the router from 'initialize to 'backup';
            Setting the value to 'disabled', will tranisition the
            router from 'master' or 'backup' to 'initialize'."
        DEFVAL    { enabled }
        ::= { vrrpOperEntry 5 }

    vrrpOperPriority OBJECT-TYPE
        SYNTAX       Integer32 (1..254)
        MAX-ACCESS   read-create
        STATUS       current
        DESCRIPTION
            "This object specifies the priority for the virtual 
            router with respect to other virtual routers that are
            backing up a set of IP addresses. Higher values imply
            higher priority. 

            A priority of '0', although not settable,
            is used to indicate that this router has ceased to 
            particpate in VRRP and a backup virtual router should 
            transition to become a new master.

            A priority of 255 is used for the router that owns the
            associated IP address(es), i.e., is backing up IP
            addresses which are primary."
        REFERENCE
            "VRRP Spec; page 11."
        DEFVAL       { 100 }
        ::= { vrrpOperEntry 6 }



draft-ietf-vrrp-mib-00.txt                                    [Page 14]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

    vrrpOperIpAddrCount OBJECT-TYPE
        SYNTAX       Integer32 (1..65535)
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The number of IP addresses that are associated with this 
            virtual router (i.e., the number of backup addresses).
            This number is equal to the number of rows in the
            vrrpAssoIpAddrTable that correspond to a given IF index/VRID
            pair."
        ::= { vrrpOperEntry 7 }

    vrrpOperMasterIpAddr OBJECT-TYPE
        SYNTAX       IpAddress
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The master router's real (primary) IP address. This is
            the IP address listed as the source in VRRP advertisements
            received by this virtual router"
        ::= { vrrpOperEntry 8 }

    vrrpOperAuthType OBJECT-TYPE
        SYNTAX       INTEGER {
            noAuthentication(1),       -- VRRP protocol exchanges are not
                                       -- authenticated.
            simpleTextPassword(2),     -- Exchanges are authenticated by a 
                                       -- clear text password.
            ipAuthenticationHeader(3)  -- Exchanges are authenticated using
                                       -- the IP authentication header [x].
        }
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "Authentication type used for VRRP protocol exchanges between
            virtual routers."
        ::= { vrrpOperEntry 9 }

    vrrpOperAuthKey OBJECT-TYPE
        SYNTAX       OCTET STRING
        MAX-ACCESS   read-create
        STATUS       current
        DESCRIPTION
            "The Authentication Key.  If the virtual router's Authorization
            Type is 'simpleTextPassword', and the key length is shorter
            than 8 octets, the agent will left adjust and zero fill
            to 8 octets.

            When read, ospfIfAuthKey always returns an Octet String
            of length zero."
         DEFVAL   { '0000000000000000'H }    -- 0.0.0.0.0.0.0.0
        ::= { vrrpOperEntry 10 }



draft-ietf-vrrp-mib-00.txt                                    [Page 15]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

    vrrpOperHMACMD5Key OBJECT-TYPE
        SYNTAX       OCTET STRING
        MAX-ACCESS   read-create
        STATUS       current
        DESCRIPTION
            "The Authentication Key.  If the virtual router's 'Authorization
            Type' is 'ipAuthenticationHeader', and the key length is shorter
            than 16 octets, the agent will left adjust and zero fill
            to 16 octets.
 
            When read, ospfIfAuthKey always returns an Octet String
            of length zero."
        DEFVAL   { '00000000000000000000000000000000'H }    
        -- 0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0
        ::= { vrrpOperEntry 11 }

    vrrpOperAdvertisementInterval OBJECT-TYPE
        SYNTAX       Integer32 (1..255)
        MAX-ACCESS   read-create
        STATUS       current
        DESCRIPTION
            "This is the time interval, in seconds, between sending 
            advertisement messages. Only master router sends VRRP
            advertisements. Hence, this value will be '0' on all other
            (i.e., non-master) virtual routers."
        DEFVAL       { 1 }
        ::= { vrrpOperEntry 12 }

    vrrpOperPreemptMode OBJECT-TYPE
        SYNTAX       INTEGER {
            true(1),   -- Preempt
            false(2)   -- Do not preempt
        }
        MAX-ACCESS   read-create
        STATUS       current
        DESCRIPTION
            "Controls whether a higher priority virtual router will
            preempt a lower priority master."
        DEFVAL       { true }
        ::= { vrrpOperEntry 13 }

    vrrpOperVirtualRouterUpTime OBJECT-TYPE
        SYNTAX       TimeTicks
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "This is the time interval (in hundredths of a second)  
            since this virtual router was last re-initialized."
        ::= { vrrpOperEntry 14 }






draft-ietf-vrrp-mib-00.txt                                    [Page 16]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

    vrrpOperRowStatus OBJECT-TYPE
        SYNTAX       RowStatus
        MAX-ACCESS   read-create
        STATUS       current
        DESCRIPTION
            "The row status variable, used according to installation 
            and removal conventions for conceptual rows. Setting this
            object to 'createAndGo' results in enabling the VRRP
            protocol on this interface and VRID. The information required
            to actually create the conceptual may be included in the
            SET primitive or may be initialized by the agent on the 
            virtual router. Destroying the entry or setting it to 
            'notInService' disables VRRP on the interface/VRID."
        ::= { vrrpOperEntry 15 }



-- *******************************************************************
--  VRRP Associated IP Address Table
-- *******************************************************************

    vrrpAssoIpAddrTable OBJECT-TYPE
        SYNTAX       SEQUENCE OF VrrpAssoIpAddrEntry
        MAX-ACCESS   not-accessible
        STATUS       current
        DESCRIPTION
            "The Table of addresses associated with this virtual router."
        ::= { vrrpOperations 4 }

    vrrpAssoIpAddrEntry OBJECT-TYPE
        SYNTAX       VrrpAssoIpAddrEntry
        MAX-ACCESS   not-accessible
        STATUS       current
        DESCRIPTION
            "An entry in the table contains an IP address that is 
            associated with a VRID. The number of rows for a given
            IF Index and VRID will equal the number of IP addresses
            assigned to a VRID address pool."
        INDEX    { vrrpOperIfIndex, vrrpOperVrId, vrrpAssoIpAddrIndex }
        ::= { vrrpAssoIpAddrTable 1 }

    VrrpAssoIpAddrEntry ::=
        SEQUENCE {
            vrrpAssoIpAddrIndex
                Integer32,
            vrrpAssoIpAddr
                IpAddress,
            vrrpAssoIpAddrStatus
                RowStatus
    }





draft-ietf-vrrp-mib-00.txt                                    [Page 17]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

    vrrpAssoIpAddrIndex OBJECT-TYPE
        SYNTAX       Integer32 (1..65535)
        MAX-ACCESS   not-accessible
        STATUS       current
        DESCRIPTION
            "This is an opaque object whose value is set by the management
            application creating this conceptual row in the table. Its
            purpose is to provide uniqueness and ordering. A management
            station attempting to create a row in the table with an
            'vrrpAssoIpAddrIndex' that already exists, will receive an
            error indication. If this occurs, the management station
            should increment its 'vrrpAssoIpAddrIndex' value and try 
            again."
        REFERENCE
            "rfc 1442 (auxilary objects); rfc1903"
        ::= { vrrpAssoIpAddrEntry 1 }

    vrrpAssoIpAddr OBJECT-TYPE
        SYNTAX       IpAddress
        MAX-ACCESS   read-create
        STATUS       current
        DESCRIPTION
            "The assigned IP addresses that a virtual router is responsible
            for backing up."
        ::= { vrrpAssoIpAddrEntry 2 }

    vrrpAssoIpAddrStatus OBJECT-TYPE
        SYNTAX       RowStatus
        MAX-ACCESS   read-create
        STATUS       current
        DESCRIPTION
            "The row status variable, used according to installation 
            and removal conventions for conceptual rows. Setting this
            object to 'createAndGo' results in enabling the VRRP
            protocol on this interface and VRID. The information required
            to actually create the conceptual may be included in the
            SET primitive or may be initialized by the agent on the 
            virtual router. Destroying the entry or setting it to 
            'notInService' disables VRRP on the interface/VRID."
        ::= { vrrpAssoIpAddrEntry 3 }















draft-ietf-vrrp-mib-00.txt                                    [Page 18]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

-- *******************************************************************
--  VRRP Router Statistics Table
-- *******************************************************************

    vrrpRouterStatsTable OBJECT-TYPE
        SYNTAX       SEQUENCE OF VrrpRouterStatsEntry
        MAX-ACCESS   not-accessible
        STATUS       current
        DESCRIPTION
            "Table of virtual router statistics."
        ::= { vrrpStatistics 1 }

    vrrpRouterStatsEntry OBJECT-TYPE
        SYNTAX       VrrpRouterStatsEntry
        MAX-ACCESS   not-accessible
        STATUS       current
        DESCRIPTION
            "An entry in the table, containing statistics information
            about a given virtual router."
        INDEX    { vrrpOperIfIndex, vrrpOperVrId }
        ::= { vrrpRouterStatsTable 1 }

    VrrpRouterStatsEntry ::=
        SEQUENCE {
            vrrpStatsBecomeMaster
                Counter32,
            vrrpStatsAdvertiseRcvd
                Counter32,
            vrrpStatsChecksumErrors
                Counter32,
            vrrpStatsVersionErrors
                Counter32,
            vrrpStatsVrIdErrors
                Counter32,
            vrrpStatsAdvertiseIntervalErrors
                Counter32,
            vrrpStatsPasswdSecurityViolations
                Counter32,
            vrrpStatsHmacSecurityViolations
                Counter32,
            vrrpStatsIpTtlErrors
                Counter32,
            vrrpStatsPriorityZeroPktsRcvd
                Counter32,
            vrrpStatsPriorityZeroPktsSent
                Counter32,
            vrrpStatsInvalidTypePktsRcvd
                Counter32,
            vrrpStatsUnknownPacketType 
                Counter32
    }




draft-ietf-vrrp-mib-00.txt                                    [Page 19]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

    vrrpStatsBecomeMaster OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of times that this virtual router's state
            has transitioned from BACKUP to MASTER."
        ::= { vrrpRouterStatsEntry 1 }

    vrrpStatsAdvertiseRcvd OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP advertisements received by this
            virtual router."
        ::= { vrrpRouterStatsEntry 2 }

    vrrpStatsChecksumErrors OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets received with an invalid
            checksum value."
        ::= { vrrpRouterStatsEntry 3 }

    vrrpStatsVersionErrors OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets received with an invalid 
            version number."
        ::= { vrrpRouterStatsEntry 4 }

    vrrpStatsVrIdErrors OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets received with an invalid
            VRID for this virtual router."
        ::= { vrrpRouterStatsEntry 5 }

    vrrpStatsAdvertiseIntervalErrors OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP advertisement packets received
            for which the advertisement interval is different than the
            one configured for the local virtual router."
        ::= { vrrpRouterStatsEntry 6 }

draft-ietf-vrrp-mib-00.txt                                    [Page 20]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

    vrrpStatsPasswdSecurityViolations OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets received that do not pass 
            the simple text password authentification check."
        ::= { vrrpRouterStatsEntry 7 }

    vrrpStatsHmacSecurityViolations OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets received that do not pass 
            the HMAC-MD5-96 authentification check."
        ::= { vrrpRouterStatsEntry 8 }

    vrrpStatsIpTtlErrors OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets received by the router
            with IP TTL (Time-To-Live) not equal to 255."
        ::= { vrrpRouterStatsEntry 9 }

    vrrpStatsPriorityZeroPktsRcvd OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets received by the virtual 
            router with a priority of '0'."
        ::= { vrrpRouterStatsEntry 10 }

    vrrpStatsPriorityZeroPktsSent OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets sent by the virtual router
            with a priority of '0'."
        ::= { vrrpRouterStatsEntry 11 }











draft-ietf-vrrp-mib-00.txt                                    [Page 21]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

    vrrpStatsInvalidTypePktsRcvd OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets received by the virtual   
            router with an invalid value in the 'type' field."
        ::= { vrrpRouterStatsEntry 12 }

    vrrpStatsUnknownPacketType OBJECT-TYPE
        SYNTAX       Counter32
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "The total number of VRRP packets received by the router
            with an invalid value in the VRRP type field."
        ::= { vrrpRouterStatsEntry 13 }



-- *******************************************************************
--   Trap Definitions
-- *******************************************************************

    vrrpTraps       OBJECT IDENTIFIER ::= { vrrpNotifications 0 }

    vrrpTrapPacketSrc OBJECT-TYPE
        SYNTAX       IpAddress
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION 
            "The IP address of an inbound VRRP packet. Used by 
             vrrpTrapAuthFailure trap."
        ::= { vrrpOperations 5 }

    vrrpTrapConfigErrorType OBJECT-TYPE
        SYNTAX        INTEGER {
            authTypeMismatch (1),
            authFailure (2)
        }
        MAX-ACCESS   read-only
        STATUS       current
        DESCRIPTION
            "Potential types of configuration conflicts.
            Used by vrrpAuthFailure trap."
        ::= { vrrpOperations 6 }









draft-ietf-vrrp-mib-00.txt                                    [Page 22]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

    vrrpTrapNewMaster NOTIFICATION-TYPE
        OBJECTS      { vrrpOperIfIndex, 
                       vrrpOperVrId, 
                       vrrpOperVirtualMacAddr 
                     }
        STATUS       current
        DESCRIPTION
            "The newMaster trap indicates that the sending agent
            has transitioned from 'Backup' state to 'Master' state."
        ::= { vrrpTraps 2 }

    vrrpTrapAuthFailure NOTIFICATION-TYPE
        OBJECTS      { vrrpOperIfIndex,
                       vrrpOperVrId,
                       vrrpTrapPacketSrc,
                       vrrpTrapConfigErrorType
        	     }
        STATUS       current
        DESCRIPTION
            "A vrrpAuthFailure trap signifies that a packet has
            been received from a router whose authentication key
            or authentication type conflicts with this router's
            authentication key or authentication type. Implementation
            of this trap is optional."
        ::= { vrrpTraps 3 } 


-- *******************************************************************
--  Conformance Information
-- *******************************************************************

    vrrpMIBCompliances  OBJECT IDENTIFIER ::= { vrrpConformance 1 }
    vrrpMIBGroups       OBJECT IDENTIFIER ::= { vrrpConformance 2 }

-- ...................................................................
-- Compliance Statements
-- ...................................................................
 
    vrrpMIBCompliance MODULE-COMPLIANCE
        STATUS current
        DESCRIPTION
           "The core compliance statement for all VRRP implementations."
        MODULE -- this module
            MANDATORY-GROUPS  {
                vrrpOperGroup ,
                vrrpStatsGroup 
            }
        ::= { vrrpMIBCompliances 1 } 







draft-ietf-vrrp-mib-00.txt                                    [Page 23]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997
-- ...................................................................
-- Conformance Groups
-- ...................................................................

    vrrpOperGroup  OBJECT-GROUP
        OBJECTS  {
            vrrpNodeVersion,
            vrrpTrapCntl,
            vrrpOperIfIndex,
            vrrpOperVrId,
            vrrpOperVirtualMacAddr,
            vrrpOperState,
            vrrpOperControl,
            vrrpOperPriority,
            vrrpOperIpAddrCount,
            vrrpOperMasterIpAddr,
            vrrpOperAuthType,
            vrrpOperHMACMD5Key,
            vrrpOperAuthKey,
            vrrpOperAdvertisementInterval,
            vrrpOperPreemptMode,
            vrrpOperVirtualRouterUpTime,
            vrrpOperRowStatus,
            vrrpTrapPacketSrc,
            vrrpTrapConfigErrorType,
            vrrpAssoIpAddr,
            vrrpAssoIpAddrStatus
            }
        STATUS current
        DESCRIPTION
           "Conformance group for VRRP operations."
        ::= { vrrpMIBGroups 1 }

    vrrpStatsGroup  OBJECT-GROUP
        OBJECTS  {
            vrrpStatsBecomeMaster,
            vrrpStatsAdvertiseRcvd,
            vrrpStatsChecksumErrors,
            vrrpStatsVersionErrors,
            vrrpStatsVrIdErrors,
            vrrpStatsAdvertiseIntervalErrors,
            vrrpStatsPasswdSecurityViolations,
            vrrpStatsHmacSecurityViolations,
            vrrpStatsIpTtlErrors,
            vrrpStatsPriorityZeroPktsRcvd,
            vrrpStatsPriorityZeroPktsSent,
            vrrpStatsInvalidTypePktsRcvd,
            vrrpStatsUnknownPacketType
            }
        STATUS current
        DESCRIPTION
           "Conformance group for VRRP statistics."
        ::= { vrrpMIBGroups 2 }

END

draft-ietf-vrrp-mib-00.txt                                    [Page 24]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

5.0  Acknowledgements


6.0  References

[1]  Knight, S., Weaver, D., Whipple, D., Hinden, R., Mitzel, D.,
     Hunt, P., Higginson, P., Shand, M., 
     "Virtual Router Redunancy Protocol", RFC xxxx

[2] SNMPv2 Working Group, Case, J., McCloghrie, K., Rose, M., and S.
    Waldbusser, "Structure of Management Information for version 2 of
    the Simple Network Management Protocol (SNMPv2)", RFC 1902, January
    1996.

[3] Rose, M., and K. McCloghrie, "Structure and Identification of
    Management Information for TCP/IP-based Internets", STD 16, RFC
    1155, Performance Systems International, Hughes LAN Systems, May
    1990.

[4] McCloghrie, K., and M. Rose, "Management Information Base for
    Network Management of TCP/IP-based internets - MIB-II", STD 17,
    RFC 1213, Hughes LAN Systems, Performance Systems International,
    March 1991.

[x]  Case, J., McCloghrie, K., Rose, M., and S. Waldbusser,
     "Structure of Management Information for version 2 of the
     Simple Network Management Protocol (SNMPv2)", RFC 1442,
     SNMP Research, Inc., Hughes LAN Systems, Dover Beach
     Consulting, Inc., Carnegie Mellon University, April 1993.

[x]  S. Waldbusser,
     "Remote Network Monitoring MIB", RFC 1757,
     Carnegie Mellon University, February 1995.

[x]  Postel, J., Reynolds, J.,
     "Instructions to RFC Authors", RFC 2223,
     SNMP Research, Inc., Hughes LAN Systems, Dover Beach
     Consulting, Inc., Carnegie Mellon University, October 1997.

[x]  Case, J., McCloghrie, K., Rose, M., and S. Waldbusser,
     "Textual Conventions for Version 2 of the Simple Network 
     Management Protocol (SNMPv2)", RFC 1903,
     SNMP Research, Inc., Hughes LAN Systems, Dover Beach
     Consulting, Inc., Carnegie Mellon University, October 1997.










draft-ietf-vrrp-mib-00.txt                                    [Page 25]

Internet Draft     VRRP MIB Using SNMPv2                      December 4, 1997

7.0 Authors' Addresses
 
   Brian R. Jewell
   3Com, Inc.
   5400 Bayfront Plaza
   Santa Clara, CA 95052
   US
 
   Phone: +1 408 764 6173
   EMail: bjewell@3com.com
 
 
   David Chuang 
   3Com, Inc.
   5400 Bayfront Plaza
   Santa Clara, CA 95052
   US
 
   Phone: +1 408 764 6610
   EMail: david_chuang@3com.com



































draft-ietf-vrrp-mib-00.txt                                      [Page 26]
 
Internet Draft  VRRP MIB Using SNMPv2                       November 1997

 -------------------------------------------------------------------
          Changes from Previous Drafts           
 -------------------------------------------------------------------  

This section tracks changes made during revisions of this document.  It
will be deleted when the document is published as a RFC.


* 11/19/97 (version 1.0) - Initial Draft

* 12/4/97  (version 1.0) - Update.


