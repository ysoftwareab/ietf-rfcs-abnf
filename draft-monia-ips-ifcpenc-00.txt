
IPS                                                            C. Monia
Internet Draft                                           Nishan Systems
Document: draft-monia-ips-ifcpenc-00.txt                  February 2001
[Expires August, 2001


                 iFCP Encapsulation Goals and Requirements


Status of this Memo

   This document is an Internet-Draft and is in full conformance with
      all provisions of Section 10 of RFC2026 [1].


   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that
   other groups may also distribute working documents as Internet-
   Drafts. Internet-Drafts are draft documents valid for a maximum of
   six months and may be updated, replaced, or obsoleted by other
   documents at any time. It is inappropriate to use Internet- Drafts
   as reference material or to cite them other than as "work in
   progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

1. Abstract

   This document specifies iFCP requirements and design goals
   applicable to a common FCIP/iFCP format for the encapsulation of
   Fibre Channel frames.

2. Conventions used in this document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in
   this document are to be interpreted as described in RFC-2119 [2].


3. Common Goals and Requirements

   This section describes encapsulation requirements and guidelines
   that are common to both iFCP and FCIP.

   Requirements:

   The encapsulation must:
                   iFCP Encapsulation Requirements      February, 2001


   a)  Contain the information needed to recreate the fibre channel
       frame at the receiving end, including the class-specific FC
       frame delimiters.
   b)  Backstop the TCP/IP checksum by embedding additional error
       detection information in the TCP/IP payload.
   c)  Provide some means for the detection and discard of stale
       frames.  That is, frames whose lifetime in the IP network has
       exceeded that portion of the E_D_TOV or R_A_TOV time limits
       budgeted to the IP network.
   d)  Provide some means to recover frame synchronization in the event
       that a check of the payload-embedded error information indicates
       the presence of data corruption.

   The following information should be included in the encapsulation:

   a)  The version number of the common encapsulation specification
   b)  A number identifying the client protocol (e.g., iFCP or FCIP)

3.1  Guidelines:

3.1.1  Use of CRCs by the Encapsulation and De-encapsulation processes

   The use of CRCs for supplemental error detection should be avoided.
   Although iFCP implementations must have some way to generate them,
   it is assumed that an FCIP implementation, which transports FC frame
   images, does not require such a capability. The additional error
   detection information should therefore be computationally simple to
   implement, such as checksums or repeated data patterns.

   Simple approaches can be justified on the basis that they need only
   protect the small amount of information added by encapsulation.  The
   FC payload will still be protected by its embedded CRC, which will
   be checked when the frame is received by the FC fabric interface or
   N_PORT.

4. iFCP Requirements

   The following sections discuss iFCP requirements. As discussed
   below, such requirements no longer include the need for an
   extensible header.

4.1 Augmented Data

   In iFCP, Fibre Channel Extended Link Service Messages containing
   N_PORT addresses in the payload are supplemented with augmented data
   so the destination gateway can map the payload addresses
   appropriately.

   In order to simplify the encapsulation, use of an extensible header
   to contain this data will no longer be required by iFCP.  Such
   information will either be included in the standard encapsulation
   envelope or transported using multi-frame sequences.
                   iFCP Encapsulation Requirements      February, 2001



   Special flags in the encapsulation header MUST be allocated to allow
   the receiving hardware to easily detect and direct such frames for
   processing within the iFCP layer.

4.2 Common Encapsulation Functional Template

   To illustrate the desired properties of an encapsulation, the figure
   below outlines a functional template.

                         +----------------------+
                         |   Framing Preamble   |
                         +----------------------+
                         |    Encapsulation     |
                         |    Header            |
                         +----------------------+
                         |    Header Checksum   |
                         +----------------------+
                         |                      |
                         |    FC Frame Image    |
                         |                      |
                         |                      |
                         |                      |
                         +----------------------+
                          Encapsulation Template


   The template contains the following fields:

        Framing Preamble _ Information marking the start of the
        encapsulated frame. Formatted to facilitate the recovery of
        frame synchronization in the event that data corruption is
        detected during de-encapsulation.

        Encapsulation Header _ Containing:

        a) Client protocol and encapsulation identifiers
        b) Frame length in 32-bit words
        c) Flags fields
        d) Frame time stamp
        e) Fibre channel SOF/EOF encoding

        Header Checksum

        FC Frame Image, including the FC CRC.

    This template has the following characteristics:

    a)  All the information needed for header validation is in or
        adjacent to the header itself.
    b)  The encapsulation information, including the SOF/EOF  is in the
        header and is protected by the checksum.
                   iFCP Encapsulation Requirements      February, 2001


    c)  The FC frame image is protected by its embedded CRC, which is
        checked by the FC hardware.  The de-encapsulation process need
        not validate this CRC.

    The SOF/EOF fields should contain additional check data for
    verification and consistency checking, such as the ones-complement
    of the SOF/EOF encoding. When appropriate, similar data integrity
    information should be included in other header fields.

   If a header error is detected, the de-encapsulation process may
   attempt to re-acquire frame synchronization. It is assumed that the
   process will minimally involve a scan for a series of preamble
   patterns.

   For that reason, some form of word stuffing is often used to break
   up preambles embedded in the payload.  The encapsulation SHOULD
   avoid this method if possible. A preferred alternative is to
   supplement preamble detection with additional header consistency
   checks.

5. Security Considerations

   The security considerations are those defined in the client protocol
   specifications (FCIP or iFCP).


9. References


   1  Bradner, S., "The Internet Standards Process -- Revision 3", BCP
      9, RFC 2026, October 1996.

   2  Bradner, S., "Key words for use in RFCs to Indicate Requirement
      Levels", BCP 14, RFC 2119, March 1997



10.  Acknowledgments


11. Author's Addresses

   Charles Monia
   Nishan Systems
   3850 North First Street
   San Jose, CA 95134
   Phone: +1 (408) 519-3986
   Email: cmonia@nishansystems.com
                   iFCP Encapsulation Requirements      February, 2001



Full Copyright Statement

   "Copyright (C) The Internet Society (date). All Rights Reserved.
   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implmentation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph
   are included on all such copies and derivative works. However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into
                   iFCP Encapsulation Requirements      February, 2001

