

SIMPLE WG                                                    M. Lonnfors
Internet-Draft                                     Nokia Research Center
Expires: November 5, 2003                                    E. Leppanen
                                                            H. Khartabil
                                                                   Nokia
                                                             May 7, 2003


    BINPIDF - External Object Extension to Presence Information Data
                                 Format
                    draft-lonnfors-simple-binpidf-01

Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that other
   groups may also distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time. It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at http://
   www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on November 5, 2003.

Copyright Notice

   Copyright (C) The Internet Society (2003). All Rights Reserved.

Abstract

   This memo specifies a methodology whereby external content to a
   presence information document can be referenced in XML encoded
   presence information document (PIDF). The external content can be
   either transferred directly in the payload of messages or indirectly
   as an HTTP reference. The external part might contain binary data
   such as images.






Lonnfors, et al.        Expires November 5, 2003                [Page 1]

Internet-Draft                  BINPIDF                         May 2003


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Conventions  . . . . . . . . . . . . . . . . . . . . . . . . .  3
   3.  Overview of Methodology  . . . . . . . . . . . . . . . . . . .  3
   4.  BINPIDF Elements . . . . . . . . . . . . . . . . . . . . . . .  4
   4.1 Namespace  . . . . . . . . . . . . . . . . . . . . . . . . . .  4
   4.2 'ObjLink' Element  . . . . . . . . . . . . . . . . . . . . . .  4
   5.  How To Utilize this Specification  . . . . . . . . . . . . . .  4
   5.1 Direct Link to External Content  . . . . . . . . . . . . . . .  4
   5.2 Reference to Multipart where External Object is Embedded . . .  5
   5.3 Reference to Multipart where Link and Another Information
       about the External Object is Found . . . . . . . . . . . . . .  5
   6.  Examples . . . . . . . . . . . . . . . . . . . . . . . . . . .  5
   6.1 Binary Objects both Directly Embedded and Indirectly
       Referenced in Multiparts . . . . . . . . . . . . . . . . . . .  5
   6.2 External Content Reference in Presence Information without
       MIME Multipart Definition  . . . . . . . . . . . . . . . . . .  7
   7.  XML Schema Definition  . . . . . . . . . . . . . . . . . . . .  8
   8.  Security Considerations  . . . . . . . . . . . . . . . . . . .  8
   9.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . .  8
   10. Changes from the Version 00  . . . . . . . . . . . . . . . . .  8
       References . . . . . . . . . . . . . . . . . . . . . . . . . .  9
       Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . 10
       Intellectual Property and Copyright Statements . . . . . . . . 11


























Lonnfors, et al.        Expires November 5, 2003                [Page 2]

Internet-Draft                  BINPIDF                         May 2003


1. Introduction

   The Presence Information Data Format (PIDF) is described in [2]. It
   defines a generic XML encoded format to express a presentity's
   presence information. However, it does not specify any mechanism how
   external objects, e.g. pictures, as a part of presence information
   can be represented in such XML documents.

   The Content Indirection document [4] provides an extension to the URL
   MIME External-Body Access-Type [8] to allow any MIME part in a SIP
   message to be referred indirectly via a URL. In addition there is a
   need to specify an extension to PIDF in order to use the Content
   Indirection mechanism for the Presence in a way that the XML encoded
   presence information is carried directly in MIME message while
   external objects are referenced indirectly.

   Using the SIP Events [5] as transport for PIDF documents it is
   equally feasible to deliver the external objects in the payload of a
   SIP message, namely SIP NOTIFY. The MIME Multipart/Related content
   type [6] provides a tool for placing a reference to an external
   content as a MIME multipart. An extension to PIDF is needed for
   referencing the multiparts from a PIDF formatted presence information
   document. A similar kind of approach of utilizing the MIME Multipart/
   Related with HTML can be found in [7].

2. Conventions

   In this document, the key words 'MUST', 'MUST NOT', 'REQUIRED',
   'SHALL', 'SHALL NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY',
   and 'OPTIONAL' are to be interpreted as described in RFC 2119 [1]
   and indicate requirement levels for compliant implementations.

3. Overview of Methodology

   This section provides an overview for having references to the
   external objects (direct and indirect content) in presence
   information.

   The external object can be embedded as one part of a multipart
   payload of a MIME message, can be stored at an external location
   where the multipart payload includes a URL to external object using
   Content Indirection [4], or the PIDF XML part can directly contain a
   URL link to the content. The MIME Multipart/Related content type [6]
   is used for direct delivery of the external object.

   The presence information data format is extended with an object link
   (ObjLink) XML element. Each separate external content has its own
   ObjLink value within presence information. The value of the ObjLink



Lonnfors, et al.        Expires November 5, 2003                [Page 3]

Internet-Draft                  BINPIDF                         May 2003


   is URL (see more information about the syntax of URL from [9]). The
   value might be either the Content ID of the external object part in
   the multipart payload or a URL to the location of the external
   content. The application processing the PIDF document is able to
   discover the location of the content from the scheme of the URL (see
   more information about the reserved scheme names from [9] and [10]).
   The 'cid:' scheme [10] refers to a specific body part of a message.

4. BINPIDF Elements

4.1 Namespace

   The namespace declaration to the PIDF extension specified in this
   document is 'urn:ietf:params:xml:ns:pidf-ext-cont'.

4.2 'ObjLink' Element

   The 'ObjLink' XML element contains a URL reference [9] to the
   external object. The scheme of the URL specifies how the value of the
   ObjLink element is processed. The value of the ObjLink might
   correspond to the Content ID [10] parameter of the multipart made
   according to MIME Multipart/Related content type [6], or to the
   'external' location of the content.

   The ObjLink element MAY have a ContentType attribute. The ContentType
   should be used when the URL references directly to an external
   location. The value of the attribute describes the content (see
   description of entity headers from [11]).

5. How To Utilize this Specification

   This chapter describes how the payload of a SIP message is composed
   when there is a need to convey external objects to XML encoded
   presence information document between the client and presence server.

   The following methods for delivering the external object are
   explained later in their own subchapters: a direct link to the
   external content within a PIDF based XML document and a reference to
   a multipart having either the content of the external object embedded
   or a URL (and other information) to an external location where the
   content is stored.

5.1 Direct Link to External Content

   The ObjLink XML element is included in PIDF to point to the location
   where the external content is stored. The used content type in the
   SIP message is one of the normal content type(s) of presence service.




Lonnfors, et al.        Expires November 5, 2003                [Page 4]

Internet-Draft                  BINPIDF                         May 2003


5.2 Reference to Multipart where External Object is Embedded

   The content type of the SIP message and the multiparts of the payload
   are composed according to [6] (MIME Multipart/Related). The XML
   encoded presence information in PIDF is the 'root' of the body part.
   The ObjLink XML element is used within presence information in PIDF
   to reference to the multipart where the content of the external
   object is found.

5.3 Reference to Multipart where Link and Another Information about the
    External Object is Found

   The content type of the SIP message and the multiparts of the payload
   are composed according to [6] (MIME Multipart/Related). The XML
   encoded presence information in PIDF is the 'root' of the body part.
   The ObjLink XML element is used within presence information in PIDF
   to reference the part in the multipart payload where the additional
   information (e.g., URL) of the external object is found. The
   multipart of the external object is composed according to [4].

6. Examples

6.1 Binary Objects both Directly Embedded and Indirectly Referenced in
    Multiparts

   Presence information subscription from client to server:

      SUBSCRIBE sip:john@pres.example.com SIP/2.0
      Via: SIP/2.0/TCP xxxxx;branch=z9hG4bKwYb6QREiCL
      Max-Forwards: 70
      To: <sip:john@pres.example.com>
      From: <sip:adam@example.com>;tag=ie4hbb8t
      Call-ID: cdB34qLToC@terminal.example.com
      CSeq: 322723822 SUBSCRIBE
      Contact: xxxx
      Event: presence
      Expires: 7200
      Accept: application/cpim-pidf+xml
      Accept: multipart/related
      Accept: message/external-body, text/html, text/plain, image/*
      Content-Length: 0

   	(200 OK are omitted)

   The NOTIFY looks like:

      NOTIFY sip:terminal.example.com SIP/2.0
      Via: SIP/2.0/TCP pres.example.com;branch=z9hG4bKMgRenTETmm



Lonnfors, et al.        Expires November 5, 2003                [Page 5]

Internet-Draft                  BINPIDF                         May 2003


      Max-Forwards: 70
      From: <sip:john@pres.example.com>;tag=zpNctbZq
      To: <sip:adam@example.com>;tag=ie4hbb8t
      Call-ID: cdB34qLToC@terminal.example.com
      CSeq: 997935768 NOTIFY
      Contact: <sip:pres.example.com>
      Event: presence
      Subscription-State: active;expires=7200
      Content-Type: multipart/related;type="application/cpim-pidf+xml";
          start="<nXYxAE@pres.example.com>";boundary="50UBfW7LSCVLtggUPe5z"
      Content-Length: xxx

      --50UBfW7LSCVLtggUPe5z
      Content-Transfer-Encoding: 8bit
      Content-ID: <nXYxAE@pres.example.com>
      Content-Type: application/cpim-pidf+xml;charset="UTF-8"

      <?xml version="1.0" encoding="UTF-8"?>
         <presence xmlns="urn:ietf:params:xml:ns:cpim-pidf"
             xmlns:obj="urn:ietf:params:xml:ns:pidf-ext-cont"
             entity="sip:john@pres.example.com">

          <tuple id="432sd">
             <status>
               <basic>open</basic>
             </status>
             <contact>sip:john@im.example.com</contact>
                <note>At home</note>
                <obj:ObjLink>cid:own_photo@example.com</obj:ObjLink>
                <obj:ObjLink>cid:image1@example.com</obj:ObjLink>
           </tuple>
         </presence>

       --50UBfW7LSCVLtggUPe5z
        Content-Type: image/jpeg
        Content-ID: <own_photo@example.com>
        Content-Transfer-Encoding: binary
        Content-Description: Own photo

        (encoded jpeg image)

       --50UBfW7LSCVLtggUPe5z
        Content-Type: message/external-body
        Content-ID: <image1@example.com>
        Content-Disposition: render
        Content-Description: Group photo

        Content-Type: message/external-body;



Lonnfors, et al.        Expires November 5, 2003                [Page 6]

Internet-Draft                  BINPIDF                         May 2003


                    access-type="URL";
                    expiration="Mon, 24 June 200x 09:00:00 GMT";
                    URL="http://www.ex.com/company_party/image1.png"
                    size=234422

       --50UBfW7LSCVLtggUPe5z


6.2 External Content Reference in Presence Information without MIME
    Multipart Definition

   Presence information subscription from client to server:

      SUBSCRIBE sip:john@pres.example.com SIP/2.0
      Via: SIP/2.0/TCP xxxxx;branch=z9hG4bKwYb6QREiCL
      Max-Forwards: 70
      To: <sip:john@pres.example.com>
      From: <sip:adam@example.com>;tag=ie4hbb8t
      Call-ID: cdB34qLToC@terminal.example.com
      CSeq: 322723822 SUBSCRIBE
      Contact: xxxx
      Event: presence
      Expires: 7200
      Accept: application/cpim-pidf+xml
      Accept: image/*
      Content-Length: 0

   Notification having a link to the picture:

      NOTIFY sip:terminal.example.com SIP/2.0
      Via: SIP/2.0/TCP pres.example.com;branch=z9hG4bKMgRenTETmm
      Max-Forwards: 70
      From: <sip:john@pres.example.com>;tag=zpNctbZq
      To: <sip:adam@example.com>;tag=ie4hbb8t
      Call-ID: cdB34qLToC@terminal.example.com
      CSeq: 997935768 NOTIFY
      Contact: <sip:pres.example.com>
      Event: presence
      Subscription-State: active;expires=7200
      Content-Type: application/cpim-pidf+xml
      Content-Length: xxx

         <?xml version="1.0" encoding="UTF-8"?>
         <presence xmlns="urn:ietf:params:xml:ns:cpim-pidf"
             xmlns:obj="urn:ietf:params:xml:ns:pidf-ext-cont"
             entity="sip:john@pres.example.com">

          <tuple id="432sd">



Lonnfors, et al.        Expires November 5, 2003                [Page 7]

Internet-Draft                  BINPIDF                         May 2003


             <status>
               <basic>open</basic>
             </status>
             <contact>sip:john@im.example.com</contact>
             <note>At home</note>
             <obj:ObjLink ContentType="image/jpeg">http://www.example.com/own_photo.jpg</obj:ObjLink>
           </tuple>
         </presence>


7. XML Schema Definition

      <?xml version="1.0" encoding="UTF-8"?>
      <xs:schema targetNamespace="urn:ietf:params:xml:ns:pidf-ext-cont"
   			xmlns:xs=http://www.w3.org/2001/XMLSchema
   			elementFormDetault="qualified"
   			attributeFormDefault="unqualified">
            <xs:element name="ObjLink">
                <xs:complexType>
            	    <xs:simpleContent>
            	        <xs:extension base="xs:anyURI">
                            <xs:attribute name="ContentType" type=xs:string use="optional"/>
                        </xs:extension>
                    </xs:simpleContent>
                </xs:complexType>
            <xs:/element>
      </xs:schema>


8. Security Considerations

   All security conciderations defined in [5] and [4] apply this
   document.

9. Acknowledgements

   The authors would like to thank Aki Niemi for his valuable input.

10. Changes from the Version 00

   o  Two XML extension elements (ExtLink and CId) were combined
      together and named as ObjLink.

   o  Optional ContentType attribute was added to the ObjLink element.

   o  References to the syntax of URL and pre-defined scemes were added.

   o  Content type negotiation related texts were removed from the



Lonnfors, et al.        Expires November 5, 2003                [Page 8]

Internet-Draft                  BINPIDF                         May 2003


      Section 5.

   o  Some editorial corrections.

References

   [1]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", BCP 14, RFC 2119, March 1997.

   [2]   Sugano, H., "CPIM Presence Information Data Format",
         draft-ietf-impp-cpim-pidf-07.txt, December 2002.

   [3]   Campbell, B., "SIMPLE Presence Publication Mechanism",
         draft-olson-simple-publish-02.txt, February 2003.

   [4]   Olson, S., "A Mechanism for Content Indirection in Session
         Initiation Protocol (SIP) Messages",
         draft-ietf-sip-content-indirect-mech-01, February 2003.

   [5]   Rosenberg, J., "Session Initiation Protocol (SIP) Extensions
         for Presence",  draft-ietf-simple-presence-10.txt, January
         2003.

   [6]   Levinson, E., "The MIME Multipart/Related Content Type", RFC
         2387, August 1998.

   [7]   Palme, J., "MIME Encapsulation of Aggregate Documents", RFC
         2557, March 1999.

   [8]   Freed, N., "Definition of the URL MIME External-Body
         Access-Type", RFC 2017, October 1996.

   [9]   Berners-Lee, T., "Uniform Resource Locators (URL)", RFC 1738,
         December 1994.

   [10]  Levinson, E., "Content-ID and Message-ID Uniform Resource
         Locators", RFC 2392, August 1998.

   [11]  Freed, N., "Multipurpose Internet Mail Extensions (MIME) Part
         One: Format of Internet Message Bodies", RFC 2045, November
         1996.










Lonnfors, et al.        Expires November 5, 2003                [Page 9]

Internet-Draft                  BINPIDF                         May 2003


Authors' Addresses

   Mikko Lonnfors
   Nokia Research Center
   Itamerenkatu 00180
   Helsinki
   Finland

   Phone: + 358 50 4836402
   EMail: mikko.lonnfors@nokia.com


   Eva Leppanen
   Nokia
   P.O BOX 785
   Tampere
   Finland

   Phone: +358 7180 77066
   EMail: eva-maria.leppanen@nokia.com


   Hisham Khartabil
   Nokia
   P.O. Box 321
   Helsinki
   Finland

   Phone: +358 7180 76161
   EMail: hisham.khartabil@nokia.com





















Lonnfors, et al.        Expires November 5, 2003               [Page 10]

Internet-Draft                  BINPIDF                         May 2003


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights. Information on the
   IETF's procedures with respect to rights in standards-track and
   standards-related documentation can be found in BCP-11. Copies of
   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementors or users of this specification can
   be obtained from the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard. Please address the information to the IETF Executive
   Director.


Full Copyright Statement

   Copyright (C) The Internet Society (2003). All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works. However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assignees.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION



Lonnfors, et al.        Expires November 5, 2003               [Page 11]

Internet-Draft                  BINPIDF                         May 2003


   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.











































Lonnfors, et al.        Expires November 5, 2003               [Page 12]

