<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Network Configuration Protocol Access Control Model</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Network Configuration Protocol Access Control Model">
<meta name="keywords" content="NETCONF, YANG, XML">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Internet Engineering Task Force</td><td class="header">A. Bierman</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">InterWorking Labs</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">M. Bjorklund</td></tr>
<tr><td class="header">Expires: January 5, 2011</td><td class="header">Tail-f Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 4, 2010</td></tr>
</table></td></tr></table>
<h1><br />Network Configuration Protocol Access Control Model<br />draft-bierman-netconf-access-control-02</h1>

<h3>Abstract</h3>

<p>
    The standardization of network configuration interfaces for use 
    with the NETCONF protocol requires a structured and secure 
    operating environment, which promotes human usability and 
    multi-vendor interoperability.  There is a need for standard
    mechanisms to restrict NETCONF protocol access for particular
    users to a pre-configured subset of all available NETCONF
    operations and content.  This document discusses requirements
    for a suitable access control model, and provides one solution
    which meets these requirements.
   
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on January 5, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.1.1.</a>&nbsp;
Requirements Notation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.1.2.</a>&nbsp;
NETCONF Terms<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">1.1.3.</a>&nbsp;
NACM Terms<br />
<a href="#anchor6">2.</a>&nbsp;
Authentication Requirements<br />
<a href="#anchor7">3.</a>&nbsp;
Access Control Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.1.</a>&nbsp;
Protocol Control Points<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.2.</a>&nbsp;
Simplicity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.3.</a>&nbsp;
Procedural Interface<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.4.</a>&nbsp;
Database Access<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.4.1.</a>&nbsp;
Access Rights<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.4.2.</a>&nbsp;
&lt;get&gt; and &lt;get-config&gt; Operations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.4.3.</a>&nbsp;
&lt;edit-config&gt; Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">3.4.4.</a>&nbsp;
&lt;copy-config&gt; Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">3.5.</a>&nbsp;
Users and Groups<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">3.6.</a>&nbsp;
Maintenance<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">3.7.</a>&nbsp;
Configuration Capabilities<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">3.8.</a>&nbsp;
Identifying Security Holes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">3.9.</a>&nbsp;
Data Shadowing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">3.10.</a>&nbsp;
NETCONF Specific Requirements<br />
<a href="#anchor22">4.</a>&nbsp;
NETCONF Authentication and Authorization Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.1.</a>&nbsp;
SSH Public Key Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">4.2.</a>&nbsp;
Local User Password Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">4.3.</a>&nbsp;
RADIUS Password Authentication and Service Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">4.3.1.</a>&nbsp;
Operation<br />
<a href="#acm">5.</a>&nbsp;
NETCONF Access Control Model (NACM)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">5.1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">5.1.1.</a>&nbsp;
Features<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">5.1.2.</a>&nbsp;
External Dependencies<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">5.1.3.</a>&nbsp;
Message Processing Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">5.2.</a>&nbsp;
Model Components<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">5.2.1.</a>&nbsp;
Users<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">5.2.2.</a>&nbsp;
Groups<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">5.2.3.</a>&nbsp;
Sessions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">5.2.4.</a>&nbsp;
Access Permissions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">5.2.5.</a>&nbsp;
Global Enforcement Controls<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">5.2.6.</a>&nbsp;
Access Control Rules<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">5.3.</a>&nbsp;
Access Control Enforcement Procedures<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">5.3.1.</a>&nbsp;
Initial Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">5.3.2.</a>&nbsp;
Session Establishment<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">5.3.3.</a>&nbsp;
'access-denied' Error Handling<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">5.3.4.</a>&nbsp;
Incoming RPC Message Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">5.3.5.</a>&nbsp;
Data Node Access Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">5.3.6.</a>&nbsp;
Outgoing &lt;rpc-reply&gt; Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">5.3.7.</a>&nbsp;
Outgoing &lt;notification&gt; Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DM">5.4.</a>&nbsp;
Data Model Definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">5.4.1.</a>&nbsp;
High Level Procedures<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor47">5.4.2.</a>&nbsp;
Data Organization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor48">5.4.3.</a>&nbsp;
YANG Module<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IANA">5.5.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Security">5.6.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">6.</a>&nbsp;
Normative References<br />
<a href="#anchor50">Appendix&nbsp;A.</a>&nbsp;
Usage Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor51">A.1.</a>&nbsp;
&lt;groups&gt; Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor52">A.2.</a>&nbsp;
&lt;module-rule&gt; Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor53">A.3.</a>&nbsp;
&lt;rpc-rule&gt; Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor54">A.4.</a>&nbsp;
&lt;data-rule&gt; Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor55">A.5.</a>&nbsp;
&lt;notification-rule&gt; Example<br />
<a href="#anchor56">Appendix&nbsp;B.</a>&nbsp;
Open Issues<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
      The NETCONF protocol does not provide any standard mechanisms to
      restrict the operations and content that each user is authorized
      to use.
    
</p>
<p>
      There is a need for inter-operable management of the
      controlled access to operator selected portions of the
      available NETCONF content within a particular server.
    
</p>
<p>
      This document addresses NETCONF protocol authentication and
      access control mechanisms for the Operation and Content layers,
      as defined in <a class='info' href='#RFC4741'>[RFC4741]<span> (</span><span class='info'>Enns, R., &ldquo;NETCONF Configuration Protocol,&rdquo; December&nbsp;2006.</span><span>)</span></a>, and <a class='info' href='#RFC5277'>[RFC5277]<span> (</span><span class='info'>Chisholm, S. and H. Trevino, &ldquo;NETCONF Event Notifications,&rdquo; July&nbsp;2008.</span><span>)</span></a>.  It contains five main sections:
      </p>
<ol class="text">
<li>Authentication Requirements
</li>
<li>Access Control Requirements
</li>
<li>NETCONF Authentication and Authorization Model
</li>
<li>NETCONF Access Control Model (NACM)
</li>
<li>YANG Data Model (nacm.yang)
</li>
</ol><p>
    
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1.1"></a><h3>1.1.1.&nbsp;
Requirements Notation</h3>

<p>
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
          "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
          and "OPTIONAL" in this document are to be interpreted as
          described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1.2"></a><h3>1.1.2.&nbsp;
NETCONF Terms</h3>

<p>
          The following terms are defined in RFC 4741 and 
          are not redefined here:
          </p>
<ul class="text">
<li>client
</li>
<li>operation
</li>
<li>RPC operation
</li>
<li>server
</li>
<li>session
</li>
<li>user
</li>
</ul><p>
        
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1.3"></a><h3>1.1.3.&nbsp;
NACM Terms</h3>

<p>
          The following terms are used throughout this documentation:
          </p>
<blockquote class="text"><dl>
<dt>access control:</dt>
<dd>
              A security feature provided by the NETCONF server,
              which allows an operator to restrict access to a
              subset of all NETCONF protocol operations and data,
              based on various criteria.
            
</dd>
<dt>access control model (ACM):</dt>
<dd>
              A conceptual model used to configure and monitor
              the access control procedures desired by the operator
              to enforce a particular access control policy.
            
</dd>
<dt>access control rule:</dt>
<dd>
              The conceptual criteria used to determine if a
              particular NETCONF protocol operation should be
              permitted or denied.
            
</dd>
<dt>authentication:</dt>
<dd>
	      The process of verifying a user's identity.
	    
</dd>
<dt>superuser:</dt>
<dd>
              The special administrative user account which is given
              unlimited NETCONF access, and is exempt from all access 
              control enforcement.
            
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Authentication Requirements</h3>

<p>
      The authentication mechanism must support password
      authentication over RADIUS, to support deployment scenarios with
      centralized authentication servers.  Additionally, local users
      must be supported, for scenarios when no centralized
      authentication server exists, or for situations where the
      centralized authentication server cannot be reached from the
      device.
    
</p>
<p>
      Since the mandatory transport protocol for NETCONF is SSH <a class='info' href='#RFC4742'>NETCONF Over SSH<span> (</span><span class='info'>Wasserman, M. and T. Goddard, &ldquo;Using the NETCONF Configuration Protocol over Secure SHell (SSH),&rdquo; December&nbsp;2006.</span><span>)</span></a> [RFC4742], the authentication
      model must support SSH's "publickey" and "password"
      authentication methods <a class='info' href='#RFC4252'>[RFC4252]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Authentication Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>
      
    
</p>
<p>
      The model for authentication configuration should be flexible
      enough to support authentication methods defined by other
      standard documents or by vendors.
    
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Access Control Requirements</h3>

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Protocol Control Points</h3>

<p>
        The NETCONF protocol allows new operations to be
        added at any time, and the YANG data modeling language
        supports this feature.  It is not possible to
        design an ACM for NETCONF which
        only focuses on a static set of operations,
        like some other protocols.  Since few assumptions
        can be made about an arbitrary protocol operation,
        the NETCONF architectural server components must
        be protected at several conceptual control points.
      
</p>
<p>
        <br /><hr class="insert" />
<a name="control_points"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
              +-------------+          +-------------+
 client       |    RPC      |          |   prune     |      client
 request --&gt;  |  operation  |          | restricted  | ---&gt; reply
              |  allowed?   |          | &lt;rpc-reply&gt; |
              +-------------+          |   nodes?    |
                    |                  +-------------+
                    | if any database or
                    | state data is accessed
                    | by the operation
                    V
              +-------------+          +----------------+
              |  data node  |          |   prune        |
              |   access    |          | restricted     |
              |  allowed?   |          | &lt;notification&gt; | ---&gt; client
              +-------------+          | event or data? |     session
                                       +----------------+

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<p>
        The following access control points are defined:
        </p>
<blockquote class="text"><dl>
<dt>RPC operation:</dt>
<dd>
            Configurable permission to invoke specific RPC operations
            is required.  Wildcard or multiple target mechanisms
            to reduce configuration and effort are also required.
          
</dd>
<dt>NETCONF database:</dt>
<dd>
            Configurable permission to read and/or alter
            specific data nodes within any conceptual database
            is required.  Wildcard or multiple target mechanisms
            to reduce configuration and effort are also required.
          
</dd>
<dt>RPC Reply Content:</dt>
<dd>
            Configurable permission to read
            specific data nodes within any conceptual RPC output
            section is required.  Unauthorized data is
            silently omitted from the reply, instead of
            dropping the reply or sending an 'access-denied' error.
          
</dd>
<dt>Notification Content:</dt>
<dd>
            Configurable permission to receive
            specific notification event types
            is required.
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Simplicity</h3>

<p>
        Experience has shown that a complicated ACM will not
        be widely deployed, because it is too hard to use.
        The key factor that is ignored in such solutions
        is the concept of 'localized cost'.  It should
        be easy to do simple things, and hard to do
        complex things, instead of hard to do everything.
      
</p>
<p>
        Configuration of the access control system must be simple to use.
        Simple and common tasks should be easy to configure,
        and require little expertise or domain-specific knowledge.
        Complex tasks should be possible using additional mechanisms
        which may require additional expertise.
      
</p>
<p>
        A single set of access control rules should be able
        to control all types of NETCONF RPC operation invocation, 
        all conceptual database access, and all NETCONF session output.
      
</p>
<p>
        Default access control policy needs to be as secure as possible.
      
</p>
<p>
        Protocol access should be defined with a small and familiar 
        set of permissions, while still allowing full control
        of NETCONF database access.
      
</p>
<p>
        Access control does not need to be applied to NETCONF &lt;hello&gt;
        messages.
      
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Procedural Interface</h3>

<p>
        The NETCONF protocol uses a procedural interface model,
        and an extensible set of protocol operations.
        Access control for any possible protocol operation is required.
      
</p>
<p>
        It must be possible to configure the ACM to permit or 
        deny access to specific NETCONF operations.
      
</p>
<p>
        YANG modules should be designed so that different access
        levels for input parameters to RPC operations is not required.
      
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Database Access</h3>

<p>
        It must be possible control access to specific nodes
        and sub-trees within the conceptual NETCONF database.
      
</p>
<p>
        In order for a user to obtain access to a particular
        database node, the user must be authorized to have
        the same requested access to the specified node,
        and all of its ancestors.
      
</p>
<p>
        The same access control rules apply to all conceptual
        databases.  For example, the candidate configuration
        or the running configuration.
      
</p>
<p>
        Only the standard NETCONF databases (candidate, running,
        and startup) are controlled by the ACM.  Local or remote
        files or databases accessed via the &lt;url&gt;
        parameter are optional to support.
      
</p>
<p>
        The non-volatile startup configuration needs to be loaded
        into the running configuration without applying any
        access control rules.
      
</p>
<p>
        Only a privileged user should be able to alter
        the factory-default access control rules.
      
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1"></a><h3>3.4.1.&nbsp;
Access Rights</h3>

<p>
          A small set of hard-wired database access rights is needed
          to control access to all possible NETCONF database operations,
          including vendor extensions to the standard operation set.
        
</p>
<p>
          The familiar 'CRUDX' model can support all NETCONF operations:
          </p>
<ul class="text">
<li>
              Create:  Allows the client to add a new data node 
              instance to a database.
            
</li>
<li>
              Read: Allows the client to read a data node instance 
              from a database, or receive the notification event type.
            
</li>
<li>
              Update: Allows the client to update an existing data 
              node instance in a database.
            
</li>
<li>
              Delete: Allows the client to delete a data node 
              instance from a database.
            
</li>
<li>
              eXec: Allows the client to execute the protocol operation.
            
</li>
</ul><p>
        
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2"></a><h3>3.4.2.&nbsp;
&lt;get&gt; and &lt;get-config&gt; Operations</h3>

<p>
          Read operations for restricted configuration data,
          either directly or via wildcard access, are silently
          omitted from the &lt;rpc-reply&gt; message.
        
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.3"></a><h3>3.4.3.&nbsp;
&lt;edit-config&gt; Operation</h3>

<p>
          The NACM access rights are not directly coupled to the
          NETCONF operation attribute, although they are similar.
          Instead, a NACM access right applies to all operations
          which would result in a particular access operation to
          the target database. This section describes how these
          access rights apply to the specific database
          operations supported by the &lt;edit-config&gt; operation.
        
</p>
<p>
          If the effective operation is 'none' 
          (i.e., default-operation='none')
          for a particular data node, 
          then no access control is applied to that data node.
        
</p>
<p>
          A 'create', 'merge', or 'replace' operation on a database node
          which would result in the creation of a new data node instance,
          for which the user does not have 'create' access permission, is
          rejected with an 'access-denied' error.
        
</p>
<p>
          A 'merge' or 'replace' operation on a database node
          which would result in the modification of an existing 
          data node instance,
          for which the user does not have 'update' access permission, is
          rejected with an 'access-denied' error.
        
</p>
<p>
          A 'replace' or 'delete' operation on a database node
          which would result in the deletion of an existing data node instance,
          for which the user does not have 'delete' access permission, is
          rejected with an 'access-denied' error.
        
</p>
<p>
          A 'merge' operation may include data nodes which do not alter
          portions of the existing database.  For example, a 
          container or list nodes 
          may be present for naming purposes, which do not actually alter
          the corresponding database node.  These unaltered data nodes 
          within the
          scope of a 'merge' operation are ignored by the server,
          and do not require any access rights by the client.
        
</p>
<p>
          A 'merge' operation may include data nodes, but not include
          particular child data nodes that are present in the database.
          These missing data nodes within the
          scope of a 'merge' operation are ignored by the server,
          and do not require any access rights by the client.
        
</p>
<p>
          The contents of specific restricted database nodes must not
          be exposed in any &lt;rpc-error&gt; elements
          within the reply.
        
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.4"></a><h3>3.4.4.&nbsp;
&lt;copy-config&gt; Operation</h3>

<p>
          Access control for the &lt;copy-config&gt; operation
          requires special consideration because the operator
          is replacing the entire target database.   Write access to the entire
          database is needed for this operation to succeed.
        
</p>
<p>
          A client must have access to every database node, even ones that are
          not present in the source configuration data.
        
</p>
<p>
          For example, consider a common use-case such as a simple backup and 
          restore procedure.
          The operator must have full read access to the database in order
          to receive a complete copy of its contents.  If not, the server will
          simply omit these sub-trees from the reply.  If that copy is later
          used to restore the server database, the server will interpret
          the missing nodes as a request to delete those nodes, and 
          return an error.
        
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Users and Groups</h3>

<p>
        The server must obtain a user name from the
        underlying NETCONF transport, such as an SSH
        user name.
      
</p>
<p>
        It must be possible to specify access control rules
        for a single user or a configurable group of users.
      
</p>
<p>
        A configurable superuser account is needed which bypasses all access
        control rules.  This is needed in case the access control
        rules are mis-configured, and all access is denied.
      
</p>
<p>
        The ACM must support the concept of administrative groups,
        to support the well-established distinction between
        a root account and other types of less-privileged
        conceptual user accounts.
        These groups must be configurable by the operator.
      
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Maintenance</h3>

<p>
        It should be possible to disable part or all of the
        access control model without deleting any configuration.
        By default, only the 'superuser' should be able to perform
        this task.
      
</p>
<p>
        It should be possible to configure a 'superuser' account
        so that all access control is disabled for just this
        user.  This allows the access control rules to always
        be modified without completely disabling access control
        for all users.
      
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Configuration Capabilities</h3>

<p>
        Suitable control and monitoring mechanisms
        are needed to allow an operator to easily manage all
        aspects of the ACM behavior. A standard data model,
        suitable for use with the &lt;edit-config&gt; operation
        must be available for this purpose.
      
</p>
<p>
        Access control rules to restrict operations on specific 
        sub-trees within the configuration database must
        be supported. Existing mechanisms
        should be used to identify the sub-tree(s) for this purpose.
      
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.8"></a><h3>3.8.&nbsp;
Identifying Security Holes</h3>

<p>
        One of the most important aspects of the data model
        documentation, and biggest concerns during deployment,
        is the identification of security-sensitive content.
        This applies to operations in NETCONF, not just data
        and notifications.
      
</p>
<p>
        It is customary for security-sensitive objects
        to be documented in the Security Considerations
        section of an RFC.  This is nice, but it
        is not good enough, for the following reasons:
        </p>
<ul class="text">
<li>
            This documentation-only approach forces operators to
            study the RFC and determine if there are any
            potential security holes introduced by a new
            YANG module.
          
</li>
<li>
            If any security holes are identified, then 
            the operator must study some more RFC text, 
            and determine how to close the security hole(s).
          
</li>
<li>
            The ACM on each server must be configured to
            close the security holes, e.g., require
            privileged access to read or write the
            specific data identified in the Security
            Considerations section.
          
</li>
<li>
            If the ACM is not pre-configured, then there
            will be a time window of vulnerability,
            after the new module is loaded, and before
            the new access control rules for that module
            are configured, enabled, and debugged.
          
</li>
</ul><p>
      
</p>
<p>
        Often, the operator just wants to disable
        default access to the secure content, so
        no inadvertent or malicious changes can be made
        to the server.  This allows the default rules
        to be more lenient, without significantly
        increasing the security risk.
      
</p>
<p>
        A data model designer should be able to 
        use machine-readable statements to identity
        NETCONF content which should be protected by default.
        This will allow client and server tools to automatically
        close data-model specific security holes, by
        denying access to sensitive data unless the user is
        explicitly authorized to perform the requested operation.
      
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.9"></a><h3>3.9.&nbsp;
Data Shadowing</h3>

<p>
        One of the more complicated security administration problems is
        identifying data nodes which shadow or mirror the content of
        another data node.  An access control rule to prevent read
        operations for a particular node may be insufficient
        to prevent access to the data node with the copied value.
      
</p>
<p>
        If the YANG leafref data type is used, then this data shadowing
        can be detected by applications (and the server stack),
        and prevented.
      
</p>
<p>
        If the description statement, other documentation, or
        no documentation exists to identify a data shadow problem,
        then it may not be detected.
      
</p>
<p>
        Since NETCONF allows any vendor operation to be added
        to the protocol, there is no way to reliably identify
        all of the operations that may expose copies of sensitive 
        data nodes in &lt;rpc-reply&gt; messages.
      
</p>
<p>
        A NETCONF server must insure than unauthorized access to
        its conceptual databases and non-configuration data nodes
        is prevented.
      
</p>
<p>
        It is beyond the
        scope of this document to define access control enforcement
        procedures for underlying device instrumentation that may
        exist to support the NETCONF server operation.  An operator
        must identify each operation that the server provides,
        and decide if it needs any access control applied to it.
      
</p>
<p>
        Proprietary protocol operations should be properly documented by the vendor,
        so it is clear to operators what data nodes (if any) are affected by
        the operation, and what information (if any) is returned
        in the &lt;rpc-reply&gt; message.
      
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.10"></a><h3>3.10.&nbsp;
NETCONF Specific Requirements</h3>

<p>
        The server must be able to identify the specific protocol
        access request at the 4 access control points defined above.
      
</p>
<p>
        The server must be able to identify any database access
        request, even for proprietary operations.
      
</p>
<p>
        A session must always be authorized to
        invoke the &lt;close-session&gt; operation,
        defined in <a class='info' href='#RFC4741'>[RFC4741]<span> (</span><span class='info'>Enns, R., &ldquo;NETCONF Configuration Protocol,&rdquo; December&nbsp;2006.</span><span>)</span></a>.
      
</p>
<p>
        A session must always be authorized to
        receive the &lt;replayComplete&gt; and
        &lt;notificationComplete&gt; notification events,
        defined in <a class='info' href='#RFC5277'>[RFC5277]<span> (</span><span class='info'>Chisholm, S. and H. Trevino, &ldquo;NETCONF Event Notifications,&rdquo; July&nbsp;2008.</span><span>)</span></a>
      
</p>
<p>
        The set of module name strings used within
        one particular server must be unique.
      
</p>
<p>
        Within a single server, the module namespace URI
        associated with a specific module name string 
        must persist across a reboot, and never change, once assigned.
      
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
NETCONF Authentication and Authorization Model</h3>

<p>
      This document defines three authentication methods for use
      with NETCONF: 
      </p>
<blockquote class="text">
<p>publickey for local users over SSH
</p>
<p>password for local users over any transport
</p>
<p>password for RADIUS users over any transport
</p>
</blockquote><p>
      Additional methods may be defined by other standard documents or
      by vendors.
    
</p>
<p>
      Conceptually, the NETCONF transport subsystem authenticates the
      user, and passes the name of the authenticated user to the
      NETCONF server.  The NETCONF server authorizes the user by
      mapping it to one or more groups.  Access to specific operations
      and content is then controlled by access control rules as
      described in <a class='info' href='#acm'>Section&nbsp;5<span> (</span><span class='info'>NETCONF Access Control Model (NACM)</span><span>)</span></a>.
    
</p>
<p>
      Some protocols, such as RADIUS, performs both authentication and
      authorization, and has a mechanism to report authorization
      attributes to the client.  These attributes are made available
      to the NETCONF server in an implementation specific manner.
    
</p>
<p>
      This document defines two optional YANG features, 'local-users'
      and 'radius', which the server advertises to indicate support
      for configuring local users on the device, and for configuring
      RADIUS access, respectively.
    
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
SSH Public Key Authentication</h3>

<p>
	If the NETCONF server advertises the 'local-users' feature,
	configuration of local users and their SSH public keys is
	supported in the /nacm/authentication/user list.
      
</p>
<p>
	Public key authentication is requested by the SSH client.  The
	SSH server looks up the user name provided by the client in the
	/nacm/authentication/user list, and verifies the key as described
	in <a class='info' href='#RFC4253'>[RFC4253]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Transport Layer Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>.
      
</p>
<p>
	If the 'local-users' feature is supported, then
        when a NETCONF client starts an SSH session towards the
	server, using the "publickey" authentication 'method name'
	<a class='info' href='#RFC4252'>[RFC4252]<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Authentication Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a>, the SSH server looks up the user
	name given in the SSH authentication request in the
	/nacm/authentication/user list, 
      
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Local User Password Authentication</h3>

<p>
	If the NETCONF server advertises the 'local-users' feature,
	configuration of local users and their passwords is supported
	in the /nacm/authentication/user list.
      
</p>
<p>
	For NETCONF transport protocols that support password
	authentication, the leaf-list 'user-authentication-order'
	is used to control if local user password authentication
	should be used.
      
</p>
<p>
	In SSH, password authentication is requested by the client.
	Other NETCONF transport protocols may also support password
	authentication.
      
</p>
<p>
	When local user password authentication is requested, the
	NETCONF transport looks up the user name provided by the
	client in the /nacm/authentication/user list, and verifies the
	password.
      
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
RADIUS Password Authentication and Service Authorization</h3>

<p>
	If the NETCONF server advertises the 'radius' feature, it
	supports user authentication and service authorization with
	RADIUS, as described in this section.
      
</p>
<p>
	For NETCONF transport protocols that support password
	authentication, the leaf-list 'user-authentication-order'
	is used to control if RADIUS password authentication
	should be used.
      
</p>
<p>
	In SSH, password authentication is requested by the client.
	Other NETCONF transport protocols may also support password
	authentication.
      
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Operation</h3>

<p>
          [Editor's Note: I prefer to keep this section short, and
          just refer to the relevant rfcs which have detailed
          information on radius usage, instead of duplicating this
          info here...]
        
</p>
<p>
          When RADIUS user authentication is requested, the NETCONF
          transport subsystem acts as a RADIUS client.  In the
          Access-Request request <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>, the
          following RADIUS attributes SHOULD be sent by the client
          <a class='info' href='#RFC5607'>[RFC5607]<span> (</span><span class='info'>Nelson, D. and G. Weber, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management,&rdquo; July&nbsp;2009.</span><span>)</span></a>:
          </p>
<ul class="text">
<li>
              Service-Type with the value Framed-Management
            
</li>
<li>
              Framed-Management-Protocol with the value NETCONF
            
</li>
<li>
              Management-Transport-Protection with the value
              Integrity-Confidentiality-Protection
            
</li>
</ul><p>
        
</p>
<p>
          As described in RFC 5607, if an Access-Accept message is
          received which does not authorize the requested service,
          access MUST be denied.
        
</p>
<p>
          If any Management-Policy-Id attributes are present in the
          Access-Accept message, they are treated as group names in
          the access control procedure, as described in <a class='info' href='#acm'>Section&nbsp;5<span> (</span><span class='info'>NETCONF Access Control Model (NACM)</span><span>)</span></a>.
        
</p>
<p>
          The following RADIUS attributes MAY be sent by the RADIUS
          server:
          </p>
<ul class="text">
<li>
              Session-Timeout
            
</li>
<li>
              Idle-Timeout
            
</li>
</ul><p>
          See <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> for a description of these
          attributes.  These timeout values MUST be enforced by the
          NETCONF server.
        
</p>
<a name="acm"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
NETCONF Access Control Model (NACM)</h3>

<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Introduction</h3>

<p>
        This section provides a high-level overview of the
        access control model structure.  It describes the
        NETCONF protocol message processing model, and the conceptual
        access control requirements within that model.
      
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Features</h3>

<p>
          The NACM data model provides the following features:
          </p>
<ul class="text">
<li>
              Independent control of RPC, data, and notification
              access.
            
</li>
<li>
              Very simple access control rules configuration
              data model which is easy to use.
            
</li>
<li>
              The concept of a 'superuser' type of account
              is supported, but configuration such an account
              is beyond the scope of this document.  The server
              must be able to determine if a superuser account
              is available, and if so, the actual user name
              for this account.  A session associated
              with the superuser account
              will bypass all access control enforcement.
            
</li>
<li>
              A simple and familiar set of database permissions is
              used.
            
</li>
<li>
              Support for YANG security tagging (e.g., 
              nacm:secure extension) allows default security
              modes to automatically exclude sensitive data.
            
</li>
<li>
              Separate default access modes for read, write, and
              execute permissions.
            
</li>
<li>
              Access control rules are applied to configurable groups
              of users.
            
</li>
<li>
              The entire ACM can be disabled during
              operation, in order to debug operational problems.
            
</li>
<li>
              Access control rules are simple to configure.
            
</li>
<li>
              The number of denied RPC operation requests
              and denied database write requests can be
              monitored by the client.
            
</li>
<li>
              Simple unconstrained YANG instance identifiers
              are used to configure access control rules for
              specific data nodes, or child nodes within
              specific RPC input, RPC output, and notification
              event type content.
            
</li>
</ul><p>
        
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
External Dependencies</h3>

<p>
          The <a class='info' href='#RFC4741'>NETCONF<span> (</span><span class='info'>Enns, R., &ldquo;NETCONF Configuration Protocol,&rdquo; December&nbsp;2006.</span><span>)</span></a> [RFC4741] protocol
          is used for all management purposes within this document.
          The server must support the features identified
          by the 'NETCONF-base' capability.
          It is expected that the mandatory transport mapping
          <a class='info' href='#RFC4742'>NETCONF Over SSH<span> (</span><span class='info'>Wasserman, M. and T. Goddard, &ldquo;Using the NETCONF Configuration Protocol over Secure SHell (SSH),&rdquo; December&nbsp;2006.</span><span>)</span></a> [RFC4742] is
          also supported by the server, and that the server has
          access to the user name associated with each session.
        
</p>
<p>
          The <a class='info' href='#I-D.ietf-netmod-yang'>YANG Data Modeling Language<span> (</span><span class='info'>Bjorklund, M., &ldquo;YANG - A data modeling language for the Network Configuration Protocol (NETCONF),&rdquo; June&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;netmod&#8209;yang]
          is used to define the NETCONF data models
          specified in this document. The YANG 
          instance-identifier data type can be used
          to configure data-node-specific access control rules.
        
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
Message Processing Model</h3>

<p>
          The following diagram shows the NETCONF message
          flow model, including the points at which access
          control is applied, during NETCONF message processing.
        
</p>
<p>
          <br /><hr class="insert" />
<a name="NACM_model"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                 +-------------------------+
                 |       session           |
                 |      (username)         |
                 +-------------------------+
                    |                 ^
                    V                 |
          +--------------+     +---------------+
          |   message    |     |   message     |
          | dispatcher   |     |   generator   |
          +--------------+     +---------------+
               |                  ^         ^
               V                  |         |
      +===========+     +-------------+   +----------------+
      |   &lt;rpc&gt;   |---&gt; | &lt;rpc-reply&gt; |   | &lt;notification&gt; |
      | acc. ctl  |     |  generator  |   |  generator     |
      +===========+     +-------------+   +----------------+
            |              ^    ^                ^
            V       +------+    |                |
      +-----------+ |   +=============+  +================+
      |   &lt;rpc&gt;   | |   | &lt;rpc-reply&gt; |  | &lt;notification&gt; |
      | processor |-+   |  acc. ctl   |  |  access ctl    |
      +-----------+     +=============+  +================+
            |   |                  ^        ^
            V   +----------------+ |        |
      +===========+              | |        |
      | data node |              | |        |
      | acc. ctl  | -----------+ | |        |
      +===========+            | | |        |
            |                  | | |        |
            V                  V V |        |
      +---------------+      +-----------------+
      | configuration | ---&gt; |     server      |
      |   database    |      | instrumentation |
      |               | &lt;--- |                 |
      +---------------+      +-----------------+


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>
          The following high-level sequence of conceptual processing steps
          is executed for each received &lt;rpc&gt; message,
          if access control enforcement is enabled:
         </p>
<ul class="text">
<li>
             Access control is applied to all &lt;rpc&gt; messages
             (except &lt;close-session&gt;)
             received by the server, individually, for each active session,
             unless the user identity for the session is the 'superuser'.
           
</li>
<li>
             If the session is authorized to execute the specified RPC
             operation, then processing continues, otherwise
             the request is rejected with an 'access-denied' error.
           
</li>
<li>
             If the configuration database or conceptual state data
             is accessed by the RPC operation,
             then the configuration access must be authorized first.
             If the session is authorized to perform the requested
             operation on the requested data, then processing continues.
           
</li>
</ul><p>
       
</p>
<p>
         The following sequence of conceptual processing steps
         is executed for each generated notification event,
         if access control enforcement is enabled:
         </p>
<ul class="text">
<li>
             Server instrumentation generates a conceptual notification,
             for a particular subscription.
           
</li>
<li>
             The notification access control enforcer checks the
             notification event type, and if it is one which
             the session is not authorized to read, then the
             notification is dropped for that subscription.
           
</li>
</ul><p>
       
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Model Components</h3>

<p>
        This section defines the conceptual components
        related to access control model.
      
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Users</h3>

<p>
         A 'user' is the conceptual identity, which is associated
         with the access permissions granted to a particular session.
         A user is identified by a string which must be unique 
         within the server.
       
</p>
<p>
         The user name string is usually derived from the
         transport layer during session establishment.
         A server is required to have an authenticated user name
         for a session before &lt;rpc&gt; requests will be
         accepted.  Otherwise all write requests must be rejected
         with an 'access-denied' error-tag value.
         If a read operation is not authorized, then the
         requested data is silently dropped from the reply.
       
</p>
<p>
         The server MAY support a 'superuser' administrative user
         account, which will bypass all access control enforcement.
         This is useful for restricting initial access
         and repairing a broken access control configuration.
         This account may be configurable to use a specific user, or disabled
         completely.  Some systems have factory-selected superuser
         account names.  There is no need to standardize the exact
         user name for the superuser account.  If no such account exists,
         then all NETCONF access will be controlled by NACM.
       
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Groups</h3>

<p>
         Access to a specific NETCONF operation is granted to
         a session, associated with a group, not a user.
       
</p>
<p>
         A group is identified by its name.  All group names must be
         unique within the server.
       
</p>
<p>
         A group member is identified by a user name string.
       
</p>
<p>
         The same user may be configured in multiple groups.
       
</p>
<p>
         The server should support the 3 default group identities
         defined in this document (admin, monitor, guest),
         however these roles are just unique identities,
         provided for operator convenience.
         There is no standard behavior defined for each group
         identity.  That is up to the operator who configures the
         groups.
       
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.3"></a><h3>5.2.3.&nbsp;
Sessions</h3>

<p>
         A session is simply a NETCONF session, which is the
         entity which is granted access to specific NETCONF
         operations.
       
</p>
<p>
         A session is associated with a single user name for the
         lifetime of the session.
       
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.4"></a><h3>5.2.4.&nbsp;
Access Permissions</h3>

<p>
         The access permissions are the NETCONF protocol specific
         set of permissions that have
         been assigned to a particular session role or group.
       
</p>
<p>
         The same access permissions MUST stay in effect for
         the processing of a particular message.
       
</p>
<p>
	 The server MUST use the access control rules in effect
	 at the time the message is processed.
       
</p>
<p>
         The access control model treats RPC operation execution
         separately from configuration database access
         and outgoing messages:
         </p>
<blockquote class="text"><dl>
<dt>create:</dt>
<dd>
             Permission to create conceptual server data.
           
</dd>
<dt>read:</dt>
<dd>
             Read access to conceptual server data, &lt;rpc-reply&gt; and
             &lt;notification&gt; content.
           
</dd>
<dt>update:</dt>
<dd>
             Permission to modify existing conceptual server data.
           
</dd>
<dt>delete:</dt>
<dd>
             Permission to delete existing conceptual server data.
           
</dd>
<dt>exec:</dt>
<dd>
             Permission to invoke an RPC operation.
           
</dd>
</dl></blockquote><p>
       
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.5"></a><h3>5.2.5.&nbsp;
Global Enforcement Controls</h3>

<p>
         A global on/off switch is provided to enable
         or disable all access control enforcement.
       
</p>
<p>
         An on/off switch is provided to
         enable or disable default access
         to invoke RPC operations.
       
</p>
<p>
         An on/off switch is provided to
         enable or disable default permission
         to receive data in replies and notifications.
       
</p>
<p>
         An on/off switch is provided to
         enable or disable default access
         to alter configuration data.
       
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.6"></a><h3>5.2.6.&nbsp;
Access Control Rules</h3>

<p>
         There are 4 types of rules available in NACM:
         </p>
<blockquote class="text"><dl>
<dt>module rule:</dt>
<dd>
             Controls access for definitions in
             a specific module, identified by its 
             name.
           
</dd>
<dt>RPC operation rule:</dt>
<dd>
             Controls access for a 
             specific RPC operation, identified by its 
             module and name.
           
</dd>
<dt>data node rule:</dt>
<dd>
             Controls access for a 
             specific data node, identified by its 
             path location within the conceptual
             XML document for the data node.
           
</dd>
<dt>notification rule:</dt>
<dd>
             Controls access for a 
             specific notification event type, identified by its 
             module and name.
           
</dd>
</dl></blockquote><p>
       
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Access Control Enforcement Procedures</h3>

<p>
       There are seven separate phases that must be addressed,
       four of which are related to the NETCONF message processing model.
       In addition, the initial start-up mode for a NETCONF server,
       session establishment, and 'access-denied' error handling
       procedures must also be considered.
     
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
Initial Operation</h3>

<p>
         Upon the very first start-up of the NETCONF server,
         the access control configuration will probably
         not be present. If not,
         a server should not allow any write access to
         any session role except 'superuser' type of
         account in this state.
       
</p>
<p>
         There is no requirement to enforce access control
         rules before or while the non-volatile configuration 
         data is processed and loaded into the running
         configuration.
       
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
Session Establishment</h3>

<p>
         The access control model applies specifically
         to the well-formed XML content transferred between a client
         and a server, after session establishment has been completed,
         and after the &lt;hello&gt; exchange has been successfully
         completed.
       
</p>
<p>
         A server should not include any sensitive information
         in any &lt;capability&gt; elements within the 
         &lt;hello&gt; exchange.
       
</p>
<p>
         Once session establishment is completed, and a user identity
         has been authenticated, a NETCONF server will
         enforce the access control rules, based on the 
         supplied user identity and the configuration data stored
         on the server.
       
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.3"></a><h3>5.3.3.&nbsp;
'access-denied' Error Handling</h3>

<p>
         The 'access-denied' error-tag is generated when
         the access control system denies access to either a
         request to invoke an RPC operation or a request to
         perform a particular operation on the configuration
         database.
       
</p>
<p>
         A server must not include any sensitive information
         in any &lt;error-info&gt; elements within the 
         &lt;rpc-error&gt; response.
       
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.4"></a><h3>5.3.4.&nbsp;
Incoming RPC Message Validation</h3>

<p>
         The diagram below shows the basic 
         conceptual structure of the access control processing model
         for incoming NETCONF &lt;rpc&gt; messages, within a server.
       
</p>
<p>
         <br /><hr class="insert" />
<a name="NACM_incoming"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


                NETCONF server
               +------------+
               |    XML     |
               |   message  |
               | dispatcher |
               +------------+
                      |
                      |
                      V
               +------------+
               | NC-base NS |
               |   &lt;rpc&gt;    |
               +------------+
                 |   |  |
                 |   |  +-------------------------+
                 |   +------------+               |
                 V                V               V
            +-----------+ +---------------+ +------------+
            | acme NS   | | NC-base NS    | | NC-base NS |
            | &lt;my-edit&gt; | | &lt;edit-config&gt; | | &lt;unlock&gt;   |
            +-----------+ +---------------+ +------------+
                   |               |
                   |               |
                   V               V
                 +----------------------+
                 |                      |
                 |    configuration     |
                 |      database        |
                 +----------------------+


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

       
</p>
<p>
         Access control begins with the message dispatcher.
         Only well-formed XML messages should be processed
         by the server.
       
</p>
<p>
         After the server validates the &lt;rpc&gt; element,
         and determines the namespace URI and the element
         name of the RPC operation being requested, the RPC access
         control enforcer verifies that the session is authorized
         to invoke the RPC operation.
       
</p>
<p>
         The RPC operation is authorized by following these steps:
         </p>
<ol class="text">
<li>
             If the &lt;enable-nacm&gt; parameter is set to 'false',
             then the RPC operation is permitted.
           
</li>
<li>
             If the session is associated with the 'superuser'
             account, then the RPC operation is permitted.
           
</li>
<li>
             If the requested operation is the NETCONF
             &lt;close-session&gt; operation, then
             the RPC operation is permitted.
           
</li>
<li>
             Check all the &lt;group&gt; entries
             for ones that contain a &lt;user-name&gt;
             entry that matches the user name for the
             session making the request.
           
</li>
<li>
             If no groups are found:
             
<ul class="text">
<li>
                 If the requested RPC operation is
                 associated with a YANG module
                 advertised in the server capabilities,
                 and the rpc statement contains a
                 nacm:secure or nacm:very-secure extension,
                 then the RPC operation is denied.
               
</li>
<li>
                 If the &lt;exec-default&gt; parameter is
                 set to 'permit', then permit the RPC operation,
                 otherwise deny the request.
               
</li>
</ul>
           
</li>
<li>
             Check if there are any matching &lt;rpc-rule&gt; entries
             for the requested RPC operation.  Any matching rules
             are processed in user-defined order, in case there
             are multiple &lt;rpc-rule&gt; entries for the requested 
             RPC operation.
           
</li>
<li>
             If an &lt;rpc-rule&gt; entry is found, then
             check the &lt;allowed-rights&gt; bits field
             for the entry, otherwise continue. 
             The 'exec' bit MUST be present in the
             &lt;allowed-rights&gt; bits field
             for an &lt;rpc-rule&gt;, so it is
             not used in this procedure.
           
</li>
<li>
             If the &lt;rpc-rule&gt; entry is considered
             a match, the the 'nacm-action' leaf is checked.
             If is equal to 'permit',  then the RPC operation
             is permitted, otherwise it is denied.
           
</li>
<li>
             Check if there are any matching &lt;module-rule&gt; entries
             for the same module as the requested RPC operation.
             Any matching rules are processed in user-defined order,
             in case there are multiple &lt;module-rule&gt; entries
             for the module containing the requested RPC operation.
           
</li>
<li>
             If a &lt;module-rule&gt; entry is found, then
             check the &lt;allowed-rights&gt; bits field
             for the entry, otherwise continue. 
             If the 'exec' bit is present in the
             &lt;allowed-rights&gt; bits field
             then the RPC rule is considered a match.
             otherwise it is not considered to match the request.
           
</li>
<li>
             If the &lt;module-rule&gt; entry is considered
             a match, the the 'nacm-action' leaf is checked.
             If is equal to 'permit',  then the RPC operation
             is permitted, otherwise it is denied.
           
</li>
<li>
             If the requested operation is identified an
             a nacm:secure or nacm:very-secure RPC operation,
             then the RPC operation is denied.
           
</li>
<li>
             If the &lt;exec-default&gt; parameter is
             set to 'permit', then permit the RPC operation,
             otherwise the RPC operation is denied.
           
</li>
</ol><p>
       
</p>
<p>
         If the session is not authorized to invoke the RPC operation
         then an &lt;rpc-error&gt; is generated with the following 
         information:
         </p>
<blockquote class="text"><dl>
<dt>error-tag:</dt>
<dd>access-denied
</dd>
<dt>error-path:</dt>
<dd>
             /rpc/method-QName, where
             'method-QName' is a qualified name identifying the
             actual RPC operation name.  For example, '/rpc/edit-config'
             represents the &lt;edit-config&gt; operation in the 
             NETCONF base namespace.
           
</dd>
</dl></blockquote><p>
       
</p>
<p>
         If the configuration database is accessed,
         either directly or as a side effect of the
         RPC operation, then the server
         must intercept the operation
         and make sure the session is authorized to
         perform the requested operation on the specified data.
       
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.5"></a><h3>5.3.5.&nbsp;
Data Node Access Validation</h3>

<p>
         If a data node within a configuration database
         is accessed, or a conceptual non-configuration
         node is accessed, then the server must ensure that
         the client session is authorized to perform
         the requested operation create, read, update,
         or delete operation on the specified data node.
       
</p>
<p>
         The data node access request is authorized by following 
         these steps:
         </p>
<ol class="text">
<li>
             If the &lt;enable-nacm&gt; parameter is set to 'false',
             then the data node access request is permitted.
           
</li>
<li>
             If the session is associated with the 'superuser'
             account, then the data node access request is permitted.
           
</li>
<li>
             Check all the &lt;group&gt; entries
             for ones that contain a &lt;user-name&gt;
             entry that matches the user name for the
             session making the request.
           
</li>
<li>
             If no groups are found:
             
<ul class="text">
<li>
                 If the requested data node is
                 associated with a YANG module
                 advertised in the server capabilities,
                 and the data definition statements
                 (or any of its ancestors)
                 contains a nacm:secure or nacm:very-secure extension,
                 then the data node access request is denied.
               
</li>
<li>
                 For a read request, if the &lt;read-default&gt; parameter is
                 set to 'permit', then permit the data node access request,
                 otherwise deny the request.  For a read operation,
                 this means that the requested node is not included 
                 in the rpc-reply.
               
</li>
<li>
                 For a write request, if the &lt;write-default&gt; parameter is
                 set to 'permit', then permit the data node access request,
                 otherwise deny the request.
               
</li>
</ul>
           
</li>
<li>
             Check if there are any matching &lt;data-rule&gt; entries
             for the requested data node access request.  Any matching rules
             are processed in user-defined order, in case there
             are multiple &lt;data-rule&gt; entries for the requested 
             data node.
           
</li>
<li>
             If an &lt;data-rule&gt; entry is found, then
             check the &lt;allowed-rights&gt; bits field
             for the entry, otherwise continue. 
             
<ol class="text">
<li>
                 For a creation operation, if the 'create' bit is present in the
                 &lt;allowed-rights&gt; bits field
                 then the entry is considered to be a match.
               
</li>
<li>
                 For a read operation, if the 'read' bit is present in the
                 &lt;allowed-rights&gt; bits field, then the
                 entry is considered to be a match.
               
</li>
<li>
                 For an update (e.g., 'merge' or 'replace') operation, 
                 if the 'update' bit is present in the
                 &lt;allowed-rights&gt; bits field
                 then the entry is considered to be a match.
               
</li>
<li>
                 For a deletion (e.g., 'delete') operation, 
                 if the 'delete' bit is present in the
                 &lt;allowed-rights&gt; bits field
                 then the entry is considered to be a match.
               
</li>
</ol>
           
</li>
<li>
             If the &lt;data-rule&gt; entry is considered
             a match, the the 'nacm-action' leaf is checked.
             If it is equal to 'permit',  then the data operation
             is permitted, otherwise it is denied. For 'read'
             operations, 'denied' means the requested data is not
             returned in the reply.
           
</li>
<li>
             Check if there are any matching &lt;module-rule&gt; entries
             for the same module as the requested data node.
             Any matching rules are processed in user-defined order,
             in case there are multiple &lt;module-rule&gt; entries
             for the module containing the requested data node.
           
</li>
<li>
             If a &lt;module-rule&gt; entry is found, then
             check the &lt;allowed-rights&gt; bits field
             for the entry, otherwise continue. 
             
<ol class="text">
<li>
                 For a creation operation, if the 'create' bit is present in the
                 &lt;allowed-rights&gt; bits field
                 then the entry is considered to be a match.
               
</li>
<li>
                 For a read operation, if the 'read' bit is present in the
                 &lt;allowed-rights&gt; bits field, then the
                 entry is considered to be a match.
               
</li>
<li>
                 For an update (e.g., 'merge' or 'replace') operation, 
                 if the 'update' bit is present in the
                 &lt;allowed-rights&gt; bits field
                 then the entry is considered to be a match.
               
</li>
<li>
                 For a deletion (e.g., 'delete') operation, 
                 if the 'delete' bit is present in the
                 &lt;allowed-rights&gt; bits field
                 then the entry is considered to be a match.
               
</li>
</ol>
           
</li>
<li>
             If the &lt;module-rule&gt; entry is considered
             a match, the the 'nacm-action' leaf is checked.
             If it is equal to 'permit',  then the data operation
             is permitted, otherwise it is denied. For 'read'
             operations, 'denied' means the requested data is not
             returned in the reply.
           
</li>
<li>
             For a read request, if the requested data node is identified an
             a nacm:very-secure definition, 
             then the requested data node is not included in the
             reply.
           
</li>
<li>
             For a write request, if the requested data node is identified an
             a nacm:secure or nacm:very-secure definition, 
             then the data node access request is denied.
           
</li>
<li>
             For a read request, if the &lt;read-default&gt; parameter is
             set to 'permit', then include the requested data in the reply,
             otherwise do not inlcude the requested data in the reply.
           
</li>
<li>
             For a write request, if the &lt;write-default&gt; parameter is
             set to 'permit', then permit the data node access request,
             otherwise deny the request.
           
</li>
</ol><p>
       
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.6"></a><h3>5.3.6.&nbsp;
Outgoing &lt;rpc-reply&gt; Authorization</h3>

<p>
         The &lt;rpc-reply&gt; message should be checked by the server
         to make sure no unauthorized data is contained within
         it.  If so, the restricted data must be removed
         from the message before it is sent to the client.
       
</p>
<p>
         For RPC operations which do not access any data nodes,
         then any client authorized to invoke the RPC operation
         is also authorized to receive the &lt;rpc-reply&gt;
         for that RPC operation.
       
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.7"></a><h3>5.3.7.&nbsp;
Outgoing &lt;notification&gt; Authorization</h3>

<p>
         The &lt;notification&gt; message should be checked by the server
         to make sure no unauthorized data is contained within
         it.  If so, the restricted data must be removed
         from the message before it is sent to the client.
       
</p>
<p>
         Configuration of access control rules specifically
         for descendent nodes of the notification event type
         element are outside the scope of this document.
         If the session is authorized to receive the
         notification event type, then it is also 
         authorized to receive any data it contains.
       
</p>
<p>
         The following figure shows the conceptual message processing
         model for outgoing &lt;notification&gt; messages.
       
</p>
<p>
         <br /><hr class="insert" />
<a name="NACM_outgoing_notification"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


                NETCONF server
               +------------+
               |    XML     |
               |   message  |
               | generator  |
               +------------+
                     ^
                     |
             +----------------+
             | &lt;notification&gt; |
             |  generator     |
             +----------------+
                     ^
                     |
            +=================+
            | &lt;notification&gt;  |
            |  access control |
            |  &lt;eventType&gt;    |
            +=================+
                     ^
                     |
         +------------------------+
         | server instrumentation |
         +------------------------+
                   |     ^
                   V     |
          +----------------------+
          |    configuration     |
          |      database        |
          +----------------------+


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

       
</p>
<p>
         The generation of a notification event for
         a specific subscription is authorized by following
         these steps:
         </p>
<ol class="text">
<li>
             If the &lt;enable-nacm&gt; parameter is set to 'false',
             then the notification event is permitted.
           
</li>
<li>
             If the session is associated with the 'superuser'
             account, then the notification event is permitted.
           
</li>
<li>
             If the requested operation is the NETCONF
             &lt;replayComplete&gt; or &lt;notificationComplete&gt;
             event type, then
             the notification event is permitted.
           
</li>
<li>
             Check all the &lt;group&gt; entries
             for ones that contain a &lt;user-name&gt;
             entry that matches the user name for the
             session that started the notification subscription.
           
</li>
<li>
             If no groups are found:
             
<ul class="text">
<li>
                 If the requested notification is
                 associated with a YANG module
                 advertised in the server capabilities,
                 and the notification statement contains a
                 nacm:secure or nacm:very-secure extension,
                 then the notification event is dropped
                 for the associated subscription.
               
</li>
<li>
                 If the &lt;read-default&gt; parameter is
                 set to 'permit', then permit the notification
                 event, otherwise drop this event type
                 for the associated subscription.
               
</li>
</ul>
           
</li>
<li>
             Check if there are any matching &lt;notification-rule&gt; entries
             for the specific notification event type being delivered
             to the subscription.  Any matching rules
             are processed in user-defined order, in case there
             are multiple &lt;notification-rule&gt; entries for the
             requested notification event type.
           
</li>
<li>
             If a &lt;notification-rule&gt; entry is found, then
             check the &lt;allowed-rights&gt; bits field
             for the entry, otherwise continue. 
             If the 'read' bit is present in the
             &lt;allowed-rights&gt; bits field
             then the notification event type is permitted,
             otherwise it is dropped for the associated subscription.
           
</li>
<li>
             Check if there are any matching &lt;module-rule&gt; entries
             for the same module as the notification event type.
             Any matching rules are processed in user-defined order,
             in case there are multiple &lt;module-rule&gt; entries
             for the module containing the notification event type.
           
</li>
<li>
             If a &lt;module-rule&gt; entry is found, then
             check the &lt;allowed-rights&gt; bits field
             for the entry, otherwise continue. 
             If the 'read' bit is present in the
             &lt;allowed-rights&gt; bits field
             then the notification event type is permitted,
             otherwise it is dropped for the associated subscription.
           
</li>
<li>
             If the requested event type is identified an
             a nacm:very-secure notification definition,
             then the notification event type is denied.
           
</li>
<li>
             If the &lt;read-default&gt; parameter is
             set to 'permit', then permit the notification
             event type, otherwise it is dropped for
             the associated subscription.
           
</li>
</ol><p>
       
</p>
<a name="DM"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Data Model Definitions</h3>

<p>
       This section defines the semantics of the 
       conceptual data structures found in the data model
       in <a class='info' href='#DM'>Section&nbsp;5.4<span> (</span><span class='info'>Data Model Definitions</span><span>)</span></a>.
     
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.1"></a><h3>5.4.1.&nbsp;
High Level Procedures</h3>

<p>
         There are some high level management procedures that
         an administrator needs to consider before using this
         access control model:

         </p>
<ol class="text">
<li>
             Configure the global settings.
           
</li>
<li>
             Configure one or more user groups.
           
</li>
<li>
             Configure zero or more access control rules for
             specific modules.
           
</li>
<li>
             Configure zero or more access control rules for
             specific RPC operations.
           
</li>
<li>
             Configure zero or more access control rules for
             data node access.
           
</li>
<li>
             Configure zero or more access control rules for
             notification event type access.
           
</li>
</ol><p>
       
</p>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.2"></a><h3>5.4.2.&nbsp;
Data Organization</h3>

<p>
         The top-level element is called &lt;nacm&gt;, and it
         is defined in the 'nacm' module namespace. 
       
</p>
<p>
         There are several data structures defined as child nodes
         of the &lt;nacm&gt; element:
         </p>
<blockquote class="text"><dl>
<dt>leaf &lt;enable-nacm&gt;:</dt>
<dd>
             On/off boolean switch to enable or disable
             access control enforcement.
           
</dd>
<dt>container &lt;authentication&gt;:</dt>
<dd>
             Configuration of the NETCONF server user
             authentication mechanisms.
           
</dd>
<dt>leaf &lt;read-default&gt;:</dt>
<dd>
             Enumeration to permit or deny
             default read access requests.
           
</dd>
<dt>leaf &lt;write-default&gt;:</dt>
<dd>
             Enumeration to permit or deny
             default write access requests.
           
</dd>
<dt>leaf &lt;exec-default&gt;:</dt>
<dd>
             Enumeration to permit or deny
             default RPC operation execution requests.
           
</dd>
<dt>leaf &lt;denied-rpcs&gt;:</dt>
<dd>
             Read-only counter of the number of
             times the server has denied an RPC
             operation request, since the last reboot
             of the server.
           
</dd>
<dt>leaf &lt;denied-data-writes&gt;:</dt>
<dd>
             Read-only counter of the number of
             times the server has denied a
             data node write request, since the last reboot
             of the server.
           
</dd>
<dt>container &lt;groups&gt;:</dt>
<dd>
             Configures the groups used within the access
             control system.
             
<blockquote class="text"><dl>
<dt>list &lt;group&gt;:</dt>
<dd>
                 A list of user names belonging to the
                 same administrative group.
               
</dd>
</dl></blockquote>
           
</dd>
<dt>container &lt;rules&gt;:</dt>
<dd>
             Configures the access control rules used 
             within the server.
             
<blockquote class="text"><dl>
<dt>list &lt;module-rule&gt;:</dt>
<dd>
                 Configures the access control rules for 
                 a specific module.
               
</dd>
<dt>list &lt;rpc-rule&gt;:</dt>
<dd>
                 Configures the access control rules for 
                 RPC operation invocation.
               
</dd>
<dt>list &lt;data-rule&gt;:</dt>
<dd>
                 Configures the access control rules 
                 for configuration database access.
               
</dd>
<dt>list &lt;notification-rule&gt;:</dt>
<dd>
                 Configures the access control rules for controlling
                 delivery of &lt;notification&gt; events.
               
</dd>
</dl></blockquote>
           
</dd>
</dl></blockquote><p>
       
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.3"></a><h3>5.4.3.&nbsp;
YANG Module</h3>

<p>
         The following YANG module is provided to specify
         the normative NETCONF content that must
         by supported by the server.
       
</p>
<p>
         <br /><hr class="insert" />
<a name="YANG_module"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;CODE BEGINS&gt; file="nacm@2010-06-29.yang"

m4_include(nacm.yang)

&lt;CODE ENDS&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

       
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
IANA Considerations</h3>

<p>
       There are two actions that are requested of IANA:
       </p>
<ol class="text">
<li>register data model schema namespace URI (TBD)
</li>
<li>register data model name ('nacm')
</li>
</ol><p> 
     
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
Security Considerations</h3>

<p>
       This entire document discusses access control
       requirements and mechanisms for restricting
       NETCONF protocol behavior within a given session.
     
</p>
<p>
       Configuration of the access control system is
       highly sensitive to system security.  A server may
       choose not to allow any user configuration to
       some portions of it, such as the global security level,
       or the groups which allowed access to system resources.
     
</p>
<p>
       This document incorporates the optional use of a 'superuser'
       account, which can be used to bypass access control
       enforcement.  It is suggested that the 'root' account not be
       used for NETCONF over SSH servers, because 'root' SSH logins
       should be disabled in the SSH server.
     
</p>
<p>
       If the server chooses to allow user configuration of
       the access control system, then only sessions using
       the 'superuser' administrative user should be allowed to
       have write access to the data model.
     
</p>
<p>
       If the server chooses to allow user retrieval of
       the access control system configuration, then only sessions using
       the 'superuser' administrative user should be allowed to
       have read access to the data model.
     
</p>
<p>
       There is a risk that invocation of 
       non-standard RPC operations will have undocumented side effects.
       An administrator should construct access control rules
       such that the configuration database is protected
       from such side effects.  Also, such RPC operations
       should never be invoked by a session using the 'superuser'
       administrative user.
     
</p>
<p>
       There is a risk that non-standard RPC operations, or
       even the standard &lt;get&gt; operation, may
       return data which 'aliases' or 'copies' sensitive data
       from a different data object.
       In this case, the namespace and/or the element name
       will not match the values for the sensitive data,
       which is then fully or partially copied into a different
       namespace and/or element.  An administrator should
       avoid using data models which use this practice.
     
</p>
<p>
       An administrator should restrict write access to all
       configurable objects within this data model.  It is suggested
       that only sessions using the 'superuser' administrative role
       be permitted to configure the data model defined in this document.
     
</p>
<p>
       If write access is allowed for configuration of
       access control rules, then care must be taken
       not to disrupt the access control enforcement.
     
</p>
<p>
       An administrator should restrict read access to the
       following objects within this data model, which reveal
       access control configuration which could be considered
       sensitive.
       </p>
<ul class="text">
<li>enable-nacm
</li>
<li>read-default
</li>
<li>write-default
</li>
<li>exec-default
</li>
<li>groups
</li>
<li>rules
</li>
</ul><p>
     
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2865">[RFC2865]</a></td>
<td class="author-text">Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;2865, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2865.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4252">[RFC4252]</a></td>
<td class="author-text">Ylonen, T. and C. Lonvick, &ldquo;<a href="http://tools.ietf.org/html/rfc4252">The Secure Shell (SSH) Authentication Protocol</a>,&rdquo; RFC&nbsp;4252, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4252.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4253">[RFC4253]</a></td>
<td class="author-text">Ylonen, T. and C. Lonvick, &ldquo;<a href="http://tools.ietf.org/html/rfc4253">The Secure Shell (SSH) Transport Layer Protocol</a>,&rdquo; RFC&nbsp;4253, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4253.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4741">[RFC4741]</a></td>
<td class="author-text">Enns, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4741">NETCONF Configuration Protocol</a>,&rdquo; RFC&nbsp;4741, December&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4741.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4742">[RFC4742]</a></td>
<td class="author-text">Wasserman, M. and T. Goddard, &ldquo;<a href="http://tools.ietf.org/html/rfc4742">Using the NETCONF Configuration Protocol over Secure SHell (SSH)</a>,&rdquo; RFC&nbsp;4742, December&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4742.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5277">[RFC5277]</a></td>
<td class="author-text">Chisholm, S. and H. Trevino, &ldquo;<a href="http://tools.ietf.org/html/rfc5277">NETCONF Event Notifications</a>,&rdquo; RFC&nbsp;5277, July&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5277.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5607">[RFC5607]</a></td>
<td class="author-text">Nelson, D. and G. Weber, &ldquo;<a href="http://tools.ietf.org/html/rfc5607">Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management</a>,&rdquo; RFC&nbsp;5607, July&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5607.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.REC-xml">[W3C.REC-xml]</a></td>
<td class="author-text"><a href="mailto:tbray@textuality.com">Bray, T.</a>, <a href="mailto:jeanpa@microsoft.com">Paoli, J.</a>, <a href="mailto:cmsmcq@uic.edu">Sperberg-McQueen, C.</a>, and <a href="mailto:eve.maler@east.sun.com">E. Maler</a>, &ldquo;<a href="http://www.w3.org/TR/REC-xml">Extensible Markup Language (XML) 1.0 (2nd ed)</a>,&rdquo; W3C&nbsp;REC-xml, October&nbsp;2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-netmod-yang">[I-D.ietf-netmod-yang]</a></td>
<td class="author-text">Bjorklund, M., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-netmod-yang-13.txt">YANG - A data modeling language for the Network Configuration Protocol (NETCONF)</a>,&rdquo; draft-ietf-netmod-yang-13 (work in progress), June&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-netmod-yang-13.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-netmod-yang-types">[I-D.ietf-netmod-yang-types]</a></td>
<td class="author-text">Schoenwaelder, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-netmod-yang-types-09.txt">Common YANG Data Types</a>,&rdquo; draft-ietf-netmod-yang-types-09 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-netmod-yang-types-09.txt">TXT</a>).</td></tr>
</table>

<a name="anchor50"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Usage Examples</h3>

<p>
      The following XML snippets are provided as examples only, 
      to demonstrate how NACM can be configured to perform
      some access control tasks.
    
</p>
<a name="anchor51"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
&lt;groups&gt; Example</h3>

<p>
        There must be at least one &lt;group&gt; entry
        in order for any of the access control rules
        to be useful.
      
</p>
<p>
        The following XML shows arbitrary groups,
        and is not intended to represent any particular
        use-case.
      
</p>
<p>
        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
m4_include(ex1.xml)

</pre></div><p>

      
</p>
<p>
        This example shows 3 groups:
        </p>
<ol class="text">
<li>
            The nacm:admin group contains 2 users named 'admin' and 'andy'.
          
</li>
<li>
            The nacm:monitor group contains 2 users named 
            'wilma' and 'bam-bam'.
          
</li>
<li>
            The nacm:guest group contains 2 users named 
            'guest' and 'guest@example.com'.
          
</li>
</ol><p>
      
</p>
<a name="anchor52"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
&lt;module-rule&gt; Example</h3>

<p>
        Module rules are used to control access to
        all the content defined in a specific module.
        These rules are checked after none of
        the specific
        rules (i.e., rpc-rule, data-rule, or
        notification-rule) matched the current access request.
      
</p>
<p>
        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
m4_include(ex2.xml)

</pre></div><p>

      
</p>
<p>
        This example shows 4 module rules:
        </p>
<blockquote class="text"><dl>
<dt>mod-1:</dt>
<dd>
            This rule prevents the guest group from
            reading any monitoring information in
            the ietf-netconf-monitoring YANG module.
          
</dd>
<dt>mod-2:</dt>
<dd>
            This rule allows the monitor group to read the
            ietf-netconf-monitoring YANG module.
          
</dd>
<dt>mod-3:</dt>
<dd>
            This rule allows the monitor group to invoke any
            RPC operation supported by the server.
          
</dd>
<dt>mod-4:</dt>
<dd>
            This rule allows the admin group complete access
            to all content in the server.  No subsequent rule
            will match for the admin group, because of this 
            module rule.
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor53"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
&lt;rpc-rule&gt; Example</h3>

<p>
        RPC rules are used to control access to
        a specific RPC operation.
      
</p>
<p>
        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
m4_include(ex3.xml)

</pre></div><p>

      
</p>
<p>
        This example shows 3 RPC operation rules:
        </p>
<blockquote class="text"><dl>
<dt>rpc-1:</dt>
<dd>
            This rule prevents the monitor or guest groups 
            from invoking the NETCONF
            &lt;kill-session&gt; RPC operation.
          
</dd>
<dt>rpc-2:</dt>
<dd>
            This rule prevents the monitor or guest groups 
            from invoking the NETCONF
            &lt;delete-config&gt; RPC operation.
          
</dd>
<dt>rpc-3:</dt>
<dd>
            This rule allows the monitor group
            to invoke the NETCONF
            &lt;edit-config&gt; RPC operation.
            This rule will have no real affect 
            unless the 'exec-default' leaf is set to 'deny'.
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor54"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.4"></a><h3>A.4.&nbsp;
&lt;data-rule&gt; Example</h3>

<p>
        Data rules are used to control access to
        specific (config and non-config) data nodes
        within the NETCONF content provided by the server.
      
</p>
<p>
        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
m4_include(ex4.xml)

</pre></div><p>

      
</p>
<p>
        This example shows 4 data rules:
        </p>
<blockquote class="text"><dl>
<dt>data-1:</dt>
<dd>
            This rule denies the guest group
            any access to the &lt;nacm&gt; sub-tree.
            Note that the default namespace is only
            applicable because this sub-tree is defined
            in the same namespace as the &lt;data-rule&gt;
            element.
          
</dd>
<dt>data-acme-config:</dt>
<dd>
            This rule gives the monitor group
            read-write access to the acme &lt;config-parameters&gt;.
          
</dd>
<dt>dummy-itf:</dt>
<dd>
            This rule gives the monitor and guest groups
            read-update access to the acme &lt;interface&gt;.
            entry named 'dummy'.  This entry cannot be created or
            deleted by these groups, just altered.
          
</dd>
<dt>admin-itf:</dt>
<dd>
            This rule gives the admin group
            read-write access to all acme &lt;interface&gt;.
            entries.  This is an example of an unreachable rule
            because the 'mod-3' rule already gives the admin
            group full access to this data.
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor55"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.5"></a><h3>A.5.&nbsp;
&lt;notification-rule&gt; Example</h3>

<p>
        Notification rules are used to control access to
        a specific notification event type.
      
</p>
<p>
        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
m4_include(ex5.xml)

</pre></div><p>

      
</p>
<p>
        This example shows 1 notification rule:
        </p>
<blockquote class="text"><dl>
<dt>notif-1:</dt>
<dd>
            This rule prevents the monitor or guest groups 
            from receiving the
            acme &lt;sys-config-change&gt; event type.
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor56"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Open Issues</h3>

<p>
      </p>
<ol class="text">
<li>
          Do modules need to be identified by their
          XML namespace URI, or is the module name
          good enough?
        
</li>
<li>
          Are any more wildcard mechanisms needed to
          specify the scope of an access control rule?
        
</li>
<li>
          Should regular expressions (module='foo-*') be
          allowed in schema-instance-identifier strings?
        
</li>
<li>
          Should XPath be allowed for specifying
          access control rules for data nodes?
        
</li>
<li>
          Are any 'access-denied' notifications needed?
        
</li>
<li>
          Should data rules support nodes that would
          not be eligible for retrieval with the &lt;get&gt;
          operation?  If so, should schema nodes such
          as rpc 'input' or 'output' be in the path
          expression? How would notification content
          be identified?
        
</li>
<li>
          Do any external access control models need
          to be supported somehow?  For example, should
          the &lt;groups&gt; configuration be optionally
          read-only, so it can just mirror the internal
          (external or proprietary) group configuration?
        
</li>
<li>
          Should the nacm:secure and nacm:very-secure
          extensions be optional to support, via a
          YANG feature?
        
</li>
<li>
          Should the default access levels (e.g., read-default)
          be more restrictive by default?  Shiuld these defaults
          be a vendor decision? An operator decision?
          It is important that the server be able to install
          a factory default &lt;nacm&gt; container if needed.
        
</li>
</ol><p>
    
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Andy Bierman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">InterWorking Labs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Scotts Valley, CA</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:andyb@iwl.com">andyb@iwl.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Martin Bjorklund</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tail-f Systems</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mbj@tail-f.com">mbj@tail-f.com</a></td></tr>
</table>
</body></html>
