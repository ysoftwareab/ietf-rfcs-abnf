

SIPPING Working Group                                       G. Camarillo
Internet-Draft                                                  Ericsson
Expires: April 15, 2004                                 October 16, 2003


     The Early Session Disposition Type for the Session Initiation
                             Protocol (SIP)
            draft-camarillo-sipping-early-disposition-00.txt

Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that other
   groups may also distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time. It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at http://
   www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on April 15, 2004.

Copyright Notice

   Copyright (C) The Internet Society (2003). All Rights Reserved.

Abstract

   This document defines a new disposition type (early-session) for the
   Content-Disposition header field in SIP. The treatment of
   "early-session" bodies is similar to the treatment of "session"
   bodies. That is, they follow the offer/answer model. Their only
   difference is that session descriptions whose disposition type is
   "early-session" are used to establish early media sessions within
   early dialogs, as opposed to regular sessions within regular dialogs.








Camarillo                Expires April 15, 2004                 [Page 1]

Internet-Draft       Early Session Disposition Type         October 2003


Table of Contents

   1. Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . 3
   2. Terminology  . . . . . . . . . . . . . . . . . . . . . . . . . . 3
   3. Issues Related to Early Media Session Establishment  . . . . . . 3
   4. The Early Session Disposition Type . . . . . . . . . . . . . . . 4
   5. Option tag . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
   6. Example  . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
   7. IANA Considerations  . . . . . . . . . . . . . . . . . . . . . . 7
      Normative References . . . . . . . . . . . . . . . . . . . . . . 7
      Informational References . . . . . . . . . . . . . . . . . . . . 7
      Author's Address . . . . . . . . . . . . . . . . . . . . . . . . 8
      Intellectual Property and Copyright Statements . . . . . . . . . 9






































Camarillo                Expires April 15, 2004                 [Page 2]

Internet-Draft       Early Session Disposition Type         October 2003


1. Introduction

   A SIP [2] user agent establishing an INVITE dialog may need to
   exchange media with the destination user agent (or user agents if the
   INVITE forks) or with application servers in the path before the
   dialog is established. Media exchanged this way is referred to as
   early media.

   Section 3 describes the current approach to establish early media
   sessions in SIP are discusses its problems. Section 4 defines the
   "early-session" disposition type to resolve those problems.

2. Terminology

   In this document, the key words "MUST", "MUST NOT", "REQUIRED",
   "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT
   RECOMMENDED", "MAY", and "OPTIONAL" are to be interpreted as
   described in BCP 14, RFC 2119 [1] and indicate requirement levels for
   compliant implementations.

3. Issues Related to Early Media Session Establishment

   Traditionally, early media sessions have been established in the same
   way as regular sessions. That is, using an offer/answer exchange
   where the disposition type of the session descriptions is "session".
   Application servers perform an offer/answer exchange with the UAC to
   exchange early media exclusively, while UASs use the same offer/
   answer exchange, first to exchange early media, and once the regular
   dialog is established, to exchange regular media. There are issues
   related to both, application servers and UASs using this mechanism.

   Application servers may not be able to generate an answer for an
   offer received in the INVITE. The UAC created the offer for the UAS,
   and so, it may have applied end-to-end encryption or have included
   information (e.g., related to key management) that the application
   server is not supposed to use. Therefore, application servers need a
   means to perform an offer/answer exchange with the UAC which is
   independent from the offer/answer exchange between both UAs.

   UASs using the offer/answer exchange that will carry regular media to
   send and receive early media can cause media clipping, as described
   in Section 2.1.1 of [5]. Some UACs cannot receive early media from
   different UASs at the same time. So, when an INVITE forks and several
   UASs start sending early media, the UAC mutes all the UASs but one
   (which is usually randomly chosen). If the UAS that accepts the
   INVITE (i.e., sends a 200 OK) was muted, a new offer/answer exchange
   is needed to unmute it. This usually causes media clipping.
   Therefore, UASs need a means to perform an offer/answer exchange with



Camarillo                Expires April 15, 2004                 [Page 3]

Internet-Draft       Early Session Disposition Type         October 2003


   the UAC to exchange early media which is independent from the offer/
   answer exchanged used to exchange regular media.

   A potential solution to this need would be to establish a different
   dialog using a globally routable URI to perform an independent offer/
   answer exchange. This dialog would be labelled as a dialog for early
   media and would be related to the original dialog somehow at the UAC.
   However, performing all the offer/answer exchanges within the
   original dialog has many advantages:

      It is simpler.

      It does not have synchronization problems, because all the early
      dialogs are terminated when the session is accepted.

      It does not require globally routable URIs.

      It does not introduce service interaction issues related to
      services that may be wrongly applied to the new dialog.

      It makes firewall management easier.


4. The Early Session Disposition Type

   We define a new disposition type for the Content-Disposition header
   field: early-session. User agents MUST use early-session bodies to
   establish early media sessions in the same way as they use session
   bodies to establish regular sessions, as described in RFC 3261 [2]
   and in RFC 3264 [3]. Particularly, early-session bodies MUST follow
   the offer/answer model and MAY appear in the same messages as session
   bodies do with the exceptions of 2xx responses for an INVITE and
   ACKs.

   If a UA needs to refuse an early-session offer, it MUST to so by
   refusing all the media streams in it. When SDP [4] is used, this is
   done by setting the port number of all the media streams to zero.

      This is the same mechanism that UACs use to refuse regular offers
      that arrive in a response to an empty INVITE.

   An early media session established using early-session bodies MUST be
   terminated when its corresponding early dialog is terminated or it
   transitions to a regular dialog.

5. Option tag

   We define an option tag to be used in Require and Supported header



Camarillo                Expires April 15, 2004                 [Page 4]

Internet-Draft       Early Session Disposition Type         October 2003


   fields. Its name is early-session. A UA adding the early-session
   option tag to a message indicates that it understands the
   early-session disposition type.

6. Example

   Figure 1 shows the message flow between two UAs. INVITE (1) has an
   early-session option tag in its Supported header field and the body
   shown in Figure 2. The UAS sends back a response with two body parts
   ,as shown in Figure 3; one of disposition type session and the other
   early-session. The session body part is the answer to the offer in
   the INVITE. The early-session body part is an offer to establish an
   early media session. When the UAC receives the 183 (Session Progress)
   response, it sends the answer to the early-session offer in a PRACK,
   as shown in Figure 4. This early media session is terminated when the
   early dialog transitions to a regular dialog. That is, when the UAS
   sends the (5) 200 (OK) response for the INVITE.


        A                           B
        |                           |
        |--------(1) INVITE-------->|
        |            session        |
        |                           |
        |<--(2) Session Progress----|
        |       early-session       |
        |       session             |
        |                           |
        |---------(3) PRACK-------->|
        |             early-session |
        |                           |
        |<--------(4) 200 OK--------|
        |                           |
        |  *                     *  |
        | ************************* |
        |*       Early Media       *|
        | ************************* |
        |  *                     *  |
        |                           |
        |---------(5) 200 OK------->|
        |                           |
        |<---------(6) ACK----------|
        |                           |

                                Figure 1


   Content-Type: application/sdp



Camarillo                Expires April 15, 2004                 [Page 5]

Internet-Draft       Early Session Disposition Type         October 2003


   Content-Disposition: session

   v=0
   o=alice 2890844730 2890844731 IN IP4 host.example.com
   s=
   c=IN IP4 192.0.0.1
   t=0 0
   m=audio 20000 RTP/AVP 0

                                Figure 2


   Content-Type: multipart/mixed; boundary="--boundary1"
   Content-Length: 399

   --boundary1
   Content-Type: application/sdp
   Content-Disposition: session

   v=0
   o=Bob 2890844725 2890844725 IN IP4 host.example2.com
   s=
   c=IN IP4 192.0.0.2
   t=0 0
   m=audio 30000 RTP/AVP 0
   --boundary1
   Content-Type: application/sdp
   Content-Disposition: early-session

   v=0
   o=Bob 2890844714 2890844714 IN IP4 host.example2.com
   s=
   c=IN IP4 192.0.0.2
   t=0 0
   m=audio 30002 RTP/AVP 0
   --boundary1

                                Figure 3


   Content-Type: application/sdp
   Content-Disposition: early-session

   v=0
   o=alice 2890844717 2890844717 IN IP4 host.example.com
   s=
   c=IN IP4 192.0.0.1
   t=0 0



Camarillo                Expires April 15, 2004                 [Page 6]

Internet-Draft       Early Session Disposition Type         October 2003


   m=audio 20002 RTP/AVP 0

                                Figure 4


7. IANA Considerations

   This document defines a new Content-Disposition header field
   disposition type (early-session) in Section 4. This value should be
   registered in the IANA registry for Content-Dispositions with the
   following description:


         early-session   the body describes an early communications
                         session, for example, an RFC 2327 SDP body

   This document defines a SIP option tag (early-session) in Section 5.
   It should be registered in the SIP parameters registry (http://
   www.iana.org/assignments/sip-parameters) under "Option Tags", with
   the following description.

      A UA adding the early-session option tag to a message indicates
      that it understands the early-session content disposition.

Normative References

   [1]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", BCP 14, RFC 2119, March 1997.

   [2]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,
        Peterson, J., Sparks, R., Handley, M. and E. Schooler, "SIP:
        Session Initiation Protocol", RFC 3261, June 2002.

   [3]  Rosenberg, J. and H. Schulzrinne, "An Offer/Answer Model with
        Session Description Protocol (SDP)", RFC 3264, June 2002.

Informational References

   [4]  Handley, M. and V. Jacobson, "SDP: Session Description
        Protocol", RFC 2327, April 1998.

   [5]  Camarillo, G. and H. Schulzrinne, "Early Media and Ringback Tone
        Generation in the Session Initiation  Protocol",
        draft-camarillo-sipping-early-media-02 (work in progress), July
        2003.






Camarillo                Expires April 15, 2004                 [Page 7]

Internet-Draft       Early Session Disposition Type         October 2003


Author's Address

   Gonzalo Camarillo
   Ericsson
   Hirsalantie 11
   Jorvas  02420
   Finland

   EMail: Gonzalo.Camarillo@ericsson.com










































Camarillo                Expires April 15, 2004                 [Page 8]

Internet-Draft       Early Session Disposition Type         October 2003


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights. Information on the
   IETF's procedures with respect to rights in standards-track and
   standards-related documentation can be found in BCP-11. Copies of
   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementors or users of this specification can
   be obtained from the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard. Please address the information to the IETF Executive
   Director.


Full Copyright Statement

   Copyright (C) The Internet Society (2003). All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works. However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assignees.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION



Camarillo                Expires April 15, 2004                 [Page 9]

Internet-Draft       Early Session Disposition Type         October 2003


   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.











































Camarillo                Expires April 15, 2004                [Page 10]

