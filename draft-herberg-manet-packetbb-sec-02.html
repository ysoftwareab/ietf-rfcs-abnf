<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>MANET Cryptographical Signature TLV Definition</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="MANET Cryptographical Signature TLV Definition">
<meta name="keywords" content="MANET">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Mobile Ad hoc Networking (MANET)</td><td class="header">U. Herberg</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">T. Clausen</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">LIX, Ecole Polytechnique</td></tr>
<tr><td class="header">Expires: January 28, 2010</td><td class="header">July 27, 2009</td></tr>
</table></td></tr></table>
<h1><br />MANET Cryptographical Signature TLV Definition<br />draft-herberg-manet-packetbb-sec-02</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 28, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>
      	This document describes a general and flexible TLV (type-length-value structure) for representing cryptographic signatures as well as timestamps, using the generalized MANET packet/message format <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>. It defines two Message TLVs and two Packet TLVs, for affixing a cryptographic signature and a timestamp to a packet and message, respectively.
      
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#applStatement">3.</a>&nbsp;
Applicability Statement<br />
<a href="#overview">4.</a>&nbsp;
Protocol Overview and Functioning<br />
<a href="#signatureTLVformat">5.</a>&nbsp;
General Signature TLV Structure<br />
<a href="#timestampTLVformat">6.</a>&nbsp;
General Timestamp TLV Structure<br />
<a href="#messageSignatures">7.</a>&nbsp;
Message TLVs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#signatureTLV">7.1.</a>&nbsp;
Message SIGNATURE TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#timestampTLV">7.2.</a>&nbsp;
Message TIMESTAMP TLV<br />
<a href="#packetSignatures">8.</a>&nbsp;
Packet TLVs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#packetsignatureTLV">8.1.</a>&nbsp;
Packet SIGNATURE TLV<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#packettimestampTLV">8.1.1.</a>&nbsp;
Packet TIMESTAMP TLV<br />
<a href="#IANA">9.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">9.1.</a>&nbsp;
TLV Registrations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">9.1.1.</a>&nbsp;
Expert Review: Evaluation Guidelines<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">9.1.2.</a>&nbsp;
Message TLV Type Registrations<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">9.1.3.</a>&nbsp;
Packet TLV Type Registrations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">9.2.</a>&nbsp;
New IANA registries<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">9.2.1.</a>&nbsp;
Expert Review: Evaluation Guidelines<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">9.2.2.</a>&nbsp;
Hash-Function Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">9.2.3.</a>&nbsp;
Cryptographic Algorithm Registry<br />
<a href="#Security">10.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">11.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
<a href="#anchor12">Appendix&nbsp;A.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">A.1.</a>&nbsp;
Example of a Signed Message<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
        This document:
        
        </p>
<ul class="text">
<li>
        		specifies two TLVs for carrying cryptographic signatures and timestamps in packets and messages as defined by <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>,
        	
</li>
<li>
        		requests IANA allocations for these Packet and Message TLVs from
        		the 0-127 Message TLV range and the 0-223 Packet TLV range from <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>,
        	
</li>
<li>
        		describes how cryptographic signatures are calculated, taking into account the mutable message header fields (&lt;msg-hop-limit&gt; and &lt;msg-hop-count&gt;) for messages where these fields are present,
        	
</li>
<li>
        		requests creation of two IANA registries for recording code points for hash function and signature calculation, respectively.
        	
</li>
</ul><p>
        This document does not stipulate how to sign, validate, or encrypt messages.  A specification of a routing protocol or routing protocol extension, using the security representation of this document, MUST specify appropriate interpretation of the TLVs.  This document does specifically not suggest specific cryptographic algorithms or hash functions, but rather establishes IANA registries for such.
      
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>
      	The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
        "OPTIONAL" in this document are to be interpreted as described in 
        <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
      
</p>
<p>This document uses the terminology and notation defined in  <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>. Additionally, it defines the following terminology:
        </p>
<ul class="text">
<li>Hash-Function
        	  
<blockquote class="text"><dl>
<dt></dt>
<dd>A hash function is an algorithm that takes a message of any length as input and produces a fixed-length string as output. Hash functions are used in cryptography for authentication and message integrity.
</dd>
</dl></blockquote>      
          
</li>
<li>Signature:
    	      
<blockquote class="text"><dl>
<dt></dt>
<dd>An electronic signature authenticates the signer (who often is the originator) of a message. In addition, it can be verified whether the message has been changed after it has been signed. In many cases, a signature is calculated by encrypting a hash of a message, whis is the basic assumption of this document.
</dd>
</dl></blockquote>
          
</li>
<li>Timestamp
          	
<blockquote class="text"><dl>
<dt></dt>
<dd>The timestamp indicates the time when the timestamp has been created. If a timestamp is added to a message before signing the message, this information can be useful to determine the "freshness" of the signed message. "Old" messages can indicate replayed messages.
</dd>
</dl></blockquote>
          
</li>
</ul><p>

      
</p>
<a name="applStatement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Applicability Statement</h3>

<p>
      		The packet and message format defined in <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> accords MANET routing protocols using this format the ability to carry additional information in control messages, through inclusion of TLVs. Information so included in a control message MAY be used by the routing protocol, or an extension of the routing protocol, according to its specification.
		
</p>
<p>
			This document specifies how to include a cryptographic signature for a packet or message by way of TLVs, as specified in [RFC5444].  This document also specifies how to treat "mutable" fields (&lt;msg-hop- count&gt; and &lt;msg-hop-limit&gt;) in the message header when calculating the signature, such that the resulting signature can be correctly verified by any recipient, and how to include this signature.  A MANET routing protocol, or an extension of a MANET routing protocol, MAY use such included cryptographic signatures for, for example, rejecting messages where signature verification fails.
			
		
</p>
<p>
			Basic MANET routing protocol specifications are often "oblivious to security", however have a clause allowing a control message to be rejected as "badly formed" prior to it being processed or forwarded. Protocols such as <a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; July&nbsp;2009.</span><span>)</span></a> recognize external reasons (such as failure to verify a signature) as being reasons for rejecting a message as "badly formed" and therefore "invalid for processing". This architecture is a result of the observation that with respect to security in MANETs, "one size rarely fits all" and that MANET routing protocol deployment domains have varying security requirements ranging from "unbreakable" to "virtually none". The virtue of this approach is that MANET routing protocol specifications (and implementations) can remain "generic", with extensions providing proper deployment-domain specific security mechanisms.
		
</p>
<p>
			The MANET routing protocol "security architecture", in which this specification situates itself, can therefore be summarized as follows:
			
			</p>
<ul class="text">
<li> 
					Security-oblivious MANET routing protocol specification, with a clause allowing an extension to reject a message (prior to processing/forwarding) as "badly formed".
				
</li>
<li>
					MANET routing protocol security extensions, rejecting messages as "badly formed", as appropriate for a given deployment-domain.
				
</li>
<li>
					Code-points and an exchange format for information necessary for specification of such security extensions.
				
</li>
</ul><p>
		
</p>
<p>
			This document addresses the last of these issues, by specifying a common exchange format for cryptographic signatures. This document also makes reservations from within the Message TLV and Packet TLV registries of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>, to be used (and shared) among MANET routing protocol security extensions.  Finally, this document establishes two IANA registries for code-points for hash functions and cryptographic functions for use by protocols adhering to <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
		
</p>
<p>With respect to <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>, this document:
			</p>
<ul class="text">
<li>is intended to be used in the non-normative but intended mode of use of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> as described in its Appendix B.
</li>
<li>is a specific example of the Security Considerations section of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> (the authentication part).
</li>
</ul><p>
		
</p>
<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protocol Overview and Functioning</h3>

<p>
      	This specification does not describe a protocol, nor does it mandate specific router or protocol behavior. It represents a purely syntactical representation of security related information for use with <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> messages and packets, as well as sets up IANA registrations and registries.
      
</p>
<a name="signatureTLVformat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
General Signature TLV Structure</h3>

<p>
		   The following data structure allows the representation of a cryptographic signature, including specification of the appropriate hash function and cryptographic algorithm used for calculating the signature. This &lt;signature&gt; data structure is specified, using the regular expression syntax of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>, as:
		
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
          &lt;signature&gt; := &lt;hash-function&gt;
                         &lt;cryptographic-algorithm&gt;
                         &lt;signature-value&gt;
</pre></div>
<p>
   where:
	</p>
<blockquote class="text"><dl>
<dt>&lt;hash-function&gt;</dt>
<dd> is an 8-bit unsigned integer field specifying the hash function according to <a class='info' href='#table_hash_registry'>Table&nbsp;3<span> (</span><span class='info'>Hash-Function registry</span><span>)</span></a>.
		
</dd>
<dt>&lt;cryptographic-algorithm&gt;</dt>
<dd> is an 8-bit unsigned integer field specifying the cryptographic function according to <a class='info' href='#table_cryptographic_registry'>Table&nbsp;4<span> (</span><span class='info'>Cryptographic algorithm registry</span><span>)</span></a>.
		
</dd>
<dt>&lt;signature-value&gt;</dt>
<dd> is an unsigned integer field, whose length is &lt;tlv-length&gt;-2, and which contains the cryptographic signature.
		
</dd>
</dl></blockquote><p>
	
	The basic version of this TLV assumes that calculating the signature can be decomposed into:
		</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>signature-value = cryptographic-function(hash-function(message))
</dd>
</dl></blockquote><p>
	with cryptographic-function and hash-function being selected from <a class='info' href='#table_hash_registry'>Table&nbsp;3<span> (</span><span class='info'>Hash-Function registry</span><span>)</span></a> and <a class='info' href='#table_cryptographic_registry'>Table&nbsp;4<span> (</span><span class='info'>Cryptographic algorithm registry</span><span>)</span></a> respectively (where either of them can be the identity function -- indicated by "none" in the registry). 
	
	The type extension 0 is assumed to indicate this decomposition.  Otherwise, if a signature is not decomposable in that way, the type extension field can be used for indication how signatures are to be calculated.
	
</p>
<p>
	The algorithm that is used for calculating the hash function is selected from one of those listed in <a class='info' href='#table_hash_registry'>Table&nbsp;3<span> (</span><span class='info'>Hash-Function registry</span><span>)</span></a>. Furthermore, &lt;hash-function&gt; corresponds to the number in that table assigned by IANA.
</p>
<p>The algorithm that is used for calculating the cryptographic algorithm is selected from one of those listed in <a class='info' href='#table_cryptographic_registry'>Table&nbsp;4<span> (</span><span class='info'>Cryptographic algorithm registry</span><span>)</span></a>. Furthermore, &lt;cryptographic-algorithm&gt; corresponds to the number in that table assigned by IANA. If the selected hash function is "none" (0), the cryptographic function SHOULD NOT be "none" (0).
	
</p>
<p>
	The rationale for separating the hash function and the cryptographic function into two octets instead of having all combinations in a single octet -- possibly as TLV type extension -- is twofold: 
	First, if further hash or cryptographic functions are added in the future, the number space might not be continuous any more.  More importantly, the number space of 256 possible combinations is rapidly exhausted. For example, having only 16 different hash functions and 16 different cryptographic functions would lead to exhaustion.  As new or improved cryptographic mechanism are continuously being developed and introduced, this format should be able to accommodate such for the foreseeable future.
	
</p>
<p>
	The rationale for not including a field that lists parameters of the cryptographic signature in the TLV is the following: Before being able to to validate a cryptographic signature, routers have to exchange keys (e.g. public keys). Any additional parameters can be exchanged together with the keys in this bootstrap process. It is therefore not necessary, and would even entail an extra overhead, to transmit the parameters within every message.
	
	One inherently included parameter is the length of the signature, which is tlv-length - 2 and which depends on the choice of the cryptographic function.
	
</p>
<a name="timestampTLVformat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
General Timestamp TLV Structure</h3>

<p>
		   The following data structure allows the representation of a timestamp. This &lt;timestamp&gt; data structure is specified as:
		
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       &lt;timestamp&gt; := &lt;time-value&gt;
</pre></div>
<p>
   where:
	</p>
<blockquote class="text"><dl>
<dt>&lt;time-value&gt;</dt>
<dd> is an unsigned integer field, whose length is &lt;tlv-length&gt;, and which contains the timestamp. The value of this variable is to be interpreted by the routing protocol as specified by the type extension of the Timestamp TLV (refer to <a class='info' href='#table_IANA_packet_TLV_types'>Table&nbsp;2<span> (</span><span class='info'>Packet TLV types</span><span>)</span></a>).
		
</dd>
</dl></blockquote><p>
	
	 A timestamp is essentially "freshness information".  As such, its setting and interpretation is to be determined by the routing protocol (or the extension to a routing protocol) that uses it, and may e.g. correspond to a UNIX-timestamp, GPS timestamp or a simple sequence number.  This is out of the scope of this specification.
	
</p>
<a name="messageSignatures"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Message TLVs</h3>

<p>
      	Two Message TLVs are defined, for including the cryptographic signature of a message, and for including the timestamp indicating the time at which the cryptographic signature was calculated.
      
</p>
<a name="signatureTLV"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Message SIGNATURE TLV</h3>

<p>
			A Message SIGNATURE TLV is an example of a SIGNATURE TLV as described in <a class='info' href='#signatureTLVformat'>Section&nbsp;5<span> (</span><span class='info'>General Signature TLV Structure</span><span>)</span></a>. When determining the &lt;signature-value&gt; for a message, the signature is calculated over the entire message with the following considerations:
			</p>
<ul class="text">
<li>
					the fields &lt;msg-hop-limit&gt; and &lt;msg-hop-count&gt; MUST be both assumed to have the value 0 (zero).
				
</li>
<li>
					all Message SIGNATURE TLVs MUST be removed before calculating the signature, and the message size as well as the Message TLV block size MUST be recalculated accordingly. The TLVs can be restored after having calculated the signature value.
				
</li>
</ul><p>
	
</p>
<a name="timestampTLV"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Message TIMESTAMP TLV</h3>

<p>
			A Message TIMESTAMP TLV is an example of a TIMESTAMP TLV as described in <a class='info' href='#timestampTLVformat'>Section&nbsp;6<span> (</span><span class='info'>General Timestamp TLV Structure</span><span>)</span></a>. If a message contains a TIMESTAMP TLV and a SIGNATURE TLV, the TIMESTAMP TLV SHOULD be added first to the message, in order to include it in the calculation of the signature.
	
</p>
<a name="packetSignatures"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Packet TLVs</h3>

<p>
      	Two Packet TLVs are defined, for including the cryptographic signature of a packet, and for including the timestamp indicating the time at which the cryptographic signature was calculated.
      
</p>
<a name="packetsignatureTLV"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Packet SIGNATURE TLV</h3>

<p>
			A Packet SIGNATURE TLV is an example of a SIGNATURE TLV as described in <a class='info' href='#signatureTLVformat'>Section&nbsp;5<span> (</span><span class='info'>General Signature TLV Structure</span><span>)</span></a>. When calculating the &lt;signature-value&gt; for a Packet, the signature is calculated over the entire Packet, including the packet header, all Packet TLVs (other than Packet SIGNATURE TLVs) and all included Messages and their message headers.
	
</p>
<a name="packettimestampTLV"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1.1"></a><h3>8.1.1.&nbsp;
Packet TIMESTAMP TLV</h3>

<p>
			A Packet TIMESTAMP TLV is an example of a TIMESTAMP TLV as described in <a class='info' href='#timestampTLVformat'>Section&nbsp;6<span> (</span><span class='info'>General Timestamp TLV Structure</span><span>)</span></a>.
	
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
TLV Registrations</h3>

<p>
      	This specification defines two Message TLV types which must be allocated from the 0-127 range of the "Assigned Message TLV Types" repository of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> as specified in <a class='info' href='#table_IANA_message_TLV_types'>Table&nbsp;1<span> (</span><span class='info'>Message TLV types</span><span>)</span></a> and two Packet TLV types which must be allocated from the 0-223 range of the "Assigned Packet TLV Types" repository of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> as specified in <a class='info' href='#table_IANA_packet_TLV_types'>Table&nbsp;2<span> (</span><span class='info'>Packet TLV types</span><span>)</span></a>.
		
</p>
<p>
         IANA is requested to assign the same numerical value to the Message
         TLV and Packet TLV types with the same name.
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1.1"></a><h3>9.1.1.&nbsp;
Expert Review: Evaluation Guidelines</h3>

<p>
        	For the registries for TLV type extensions where an Expert Review is required, the designated expert SHOULD take the same general recommendations into consideration as are specified by 
           <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1.2"></a><h3>9.1.2.&nbsp;
Message TLV Type Registrations</h3>

<p>
      	The Message TLVs as specified in <a class='info' href='#table_IANA_message_TLV_types'>Table&nbsp;1<span> (</span><span class='info'>Message TLV types</span><span>)</span></a> must be allocated from the "Message TLV Types" namespace of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</p><br /><hr class="insert" />
<a name="table_IANA_message_TLV_types"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center"><col align="center">
<tr><th align="center">Name</th><th align="center">Type</th><th align="center">Type Extension</th><th align="center">Description</th></tr>
<tr>
<td align="center">SIGNATURE</td>
<td align="center">TBD1</td>
<td align="center">0</td>
<td align="center">Signature of a message</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">1-223</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">224-255</td>
<td align="center">Experimental Use</td>
</tr>
<tr>
<td align="center">TIMESTAMP</td>
<td align="center">TBD2</td>
<td align="center">0</td>
<td align="center">Unsigned timestamp of arbitrary length, given by the tlv-length field. The timestamp is assumed to increase strictly monotonously by steps of 1. The MANET routing protocol has to define how to interpret this timestamp</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">1</td>
<td align="center">Unsigned 32-bit timestamp as specified in <a class='info' href='#POSIX'>[POSIX]<span> (</span><span class='info'>IEEE Computer Society, &ldquo;1003.1-2008 Standard for Information Technology - Portable Operating System Interface (POSIX),&rdquo; December&nbsp;2008.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">2</td>
<td align="center">NTP timestamp format as defined in <a class='info' href='#RFC4330'>[RFC4330]<span> (</span><span class='info'>Mills, D., &ldquo;Simple Network Time Protocol (SNTP) Version 4 for IPv4, IPv6 and OSI,&rdquo; January&nbsp;2006.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">3</td>
<td align="center">Signed timestamp of arbitrary length with no constraints such as monotonicity. In particular, it may represent any random value</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">4-223</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">224-255</td>
<td align="center">Experimental Use</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Message TLV types&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1.3"></a><h3>9.1.3.&nbsp;
Packet TLV Type Registrations</h3>

<p>
      	The Packet TLVs as specified in <a class='info' href='#table_IANA_packet_TLV_types'>Table&nbsp;2<span> (</span><span class='info'>Packet TLV types</span><span>)</span></a> must be allocated from the "Packet TLV Types" namespace of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</p><br /><hr class="insert" />
<a name="table_IANA_packet_TLV_types"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center"><col align="center">
<tr><th align="center">Name</th><th align="center">Type</th><th align="center">Type Extension</th><th align="center">Description</th></tr>
<tr>
<td align="center">SIGNATURE</td>
<td align="center">TBD3</td>
<td align="center">0</td>
<td align="center">Signature of a packet</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">1-223</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">224-255</td>
<td align="center">Experimental Use</td>
</tr>
<tr>
<td align="center">TIMESTAMP</td>
<td align="center">TBD4</td>
<td align="center">0</td>
<td align="center">Unsigned timestamp of arbitrary length, given by the tlv-length field. The timestamp is assumed to increase strictly monotonously by steps of 1. The MANET routing protocol has to define how to interpret this timestamp</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">1</td>
<td align="center">Unsigned 32-bit timestamp as specified in <a class='info' href='#POSIX'>[POSIX]<span> (</span><span class='info'>IEEE Computer Society, &ldquo;1003.1-2008 Standard for Information Technology - Portable Operating System Interface (POSIX),&rdquo; December&nbsp;2008.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">2</td>
<td align="center">NTP timestamp format as defined in <a class='info' href='#RFC4330'>[RFC4330]<span> (</span><span class='info'>Mills, D., &ldquo;Simple Network Time Protocol (SNTP) Version 4 for IPv4, IPv6 and OSI,&rdquo; January&nbsp;2006.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">3</td>
<td align="center">Signed timestamp of arbitrary length with no constraints such as monotonicity. In particular, it may represent any random value</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">4-223</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
<td align="center">224-255</td>
<td align="center">Experimental Use</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: Packet TLV types&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
New IANA registries</h3>

<p>
			This document specifies some values where IANA registries are required.
		
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.1"></a><h3>9.2.1.&nbsp;
Expert Review: Evaluation Guidelines</h3>

<p>
        		For the registries for the following tables where an Expert Review is required, the designated expert SHOULD take the same general recommendations into consideration as are specified by  <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
           
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.2"></a><h3>9.2.2.&nbsp;
Hash-Function Registry</h3>

<p>
		IANA is requested to create a new registry for the hash functions that can be used when creating a signature. The initial assignments and allocation policies are specified in <a class='info' href='#table_hash_registry'>Table&nbsp;3<span> (</span><span class='info'>Hash-Function registry</span><span>)</span></a>.
		
	
</p><br /><hr class="insert" />
<a name="table_hash_registry"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Hash function value</th><th align="center">Algorithm</th><th align="center">Description</th></tr>
<tr>
<td align="center">0</td>
<td align="center">none</td>
<td align="center">The "identity function": the hash value of a message is the message itself</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">MD5</td>
<td align="center">The hash function as specified in <a class='info' href='#RFC1321'>[RFC1321]<span> (</span><span class='info'>Rivest, R., &ldquo;The MD5 Message-Digest Algorithm,&rdquo; April&nbsp;1992.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">SHA1</td>
<td align="center">The hash function as specified in <a class='info' href='#RFC3174'>[RFC3174]<span> (</span><span class='info'>Eastlake, D. and P. Jones, &ldquo;US Secure Hash Algorithm 1 (SHA1),&rdquo; September&nbsp;2001.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">SHA256</td>
<td align="center">The hash function as specified in <a class='info' href='#SHA256'>[SHA256]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Secure Hash Algorithm,&rdquo; August&nbsp;2002.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">4-223</td>
<td align="center">&nbsp;</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">224-255</td>
<td align="center">&nbsp;</td>
<td align="center">Experimental Use</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: Hash-Function registry&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.3"></a><h3>9.2.3.&nbsp;
Cryptographic Algorithm Registry</h3>

<p>
		IANA is requested to create a new registry for the cryptographic function. Initial assignments and allocation policies are specified in <a class='info' href='#table_cryptographic_registry'>Table&nbsp;4<span> (</span><span class='info'>Cryptographic algorithm registry</span><span>)</span></a>.
		
	
</p><br /><hr class="insert" />
<a name="table_cryptographic_registry"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Cryptographic algorithm value</th><th align="center">Algorithm</th><th align="center">Description</th></tr>
<tr>
<td align="center">0</td>
<td align="center">none</td>
<td align="center">The "identity function": the value of an encrypted hash is the hash itself</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">RSA</td>
<td align="center">RSA as specified in <a class='info' href='#RFC2437'>[RFC2437]<span> (</span><span class='info'>Kaliski, B. and J. Staddon, &ldquo;PKCS #1: RSA Cryptography Specifications Version 2.0,&rdquo; October&nbsp;1998.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">DSA</td>
<td align="center">DSA as specified in <a class='info' href='#DSA'>[DSA]<span> (</span><span class='info'>National Institute of Standards & Technology, &ldquo;Digital Signature Standard,&rdquo; May&nbsp;1994.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">HMAC</td>
<td align="center">HMAC as specified in <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">3DES</td>
<td align="center">3DES as specified in <a class='info' href='#3DES'>[3DES]<span> (</span><span class='info'>American National Standards Institute, &ldquo;Triple Data Encryption Algorithm Modes of Operation,&rdquo; 1998.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">AES</td>
<td align="center">AES as specified in <a class='info' href='#AES'>[AES]<span> (</span><span class='info'>National Institute of Standards & Technology, &ldquo;Advanced Encryption Standard (AES),&rdquo; November&nbsp;2001.</span><span>)</span></a></td>
</tr>
<tr>
<td align="center">6-223</td>
<td align="center">&nbsp;</td>
<td align="center">Expert Review</td>
</tr>
<tr>
<td align="center">224-255</td>
<td align="center">&nbsp;</td>
<td align="center">Experimental Use</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 4: Cryptographic algorithm registry&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p>
      	This document does not specify a protocol itself. However, it provides a syntactical component for cryptographic signatures of messages and packets as defined in <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>. It can be used to address security issues of a protocol or extension that uses the component specified in this document. As such, it has the same security considerations as <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>.
</p>
<p>In addition, a protocol that includes this component MUST specify the usage as well as the security that is attained by the cryptographic signatures of a message or a packet.
</p>
<p>As an example, a routing protocol that uses this component to reject "badly formed" messages if a control message does not contain a valid signature, should indicate the security assumption that if the signature is valid, the message is considered valid. It also should indicate the security issues that are counteracted by this measure (e.g. link or identity spoofing) as well as the issues that are not counteracted (e.g. compromised keys). 
      	
      
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgements</h3>

<p>The authors would like to thank Jerome Milan (Ecole Polytechnique) for his advice as cryptographer. In addition, many thanks to Alan Cullen (BAE), Justin Dean (NRL), Christopher Dearlove (BAE), and Henning Rogge (FGAN) for their constructive comments on the document.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; RFC&nbsp;2119, BCP&nbsp;14, March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5444">[RFC5444]</a></td>
<td class="author-text">Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;<a href="http://tools.ietf.org/html/rfc5444">Generalized MANET Packet/Message Format</a>,&rdquo; RFC&nbsp;5444, February&nbsp;2009.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="3DES">[3DES]</a></td>
<td class="author-text">American National Standards Institute, &ldquo;Triple Data Encryption Algorithm Modes of Operation,&rdquo; ANSI&nbsp;X9.52-1998, 1998.</td></tr>
<tr><td class="author-text" valign="top"><a name="AES">[AES]</a></td>
<td class="author-text">National Institute of Standards & Technology, &ldquo;Advanced Encryption Standard (AES),&rdquo; FIPS&nbsp;197, November&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="DSA">[DSA]</a></td>
<td class="author-text">National Institute of Standards & Technology, &ldquo;Digital Signature Standard,&rdquo; NIST, FIPS PUB&nbsp;186, May&nbsp;1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="NHDP">[NHDP]</a></td>
<td class="author-text">Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; work in progress&nbsp;draft-ietf-manet-nhdp-10.txt, July&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="POSIX">[POSIX]</a></td>
<td class="author-text">IEEE Computer Society, &ldquo;1003.1-2008 Standard for Information Technology - Portable Operating System Interface (POSIX),&rdquo; Base Specifications&nbsp;Issue 7, December&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1321">[RFC1321]</a></td>
<td class="author-text">Rivest, R., &ldquo;<a href="http://tools.ietf.org/html/rfc1321">The MD5 Message-Digest Algorithm</a>,&rdquo; RFC&nbsp;1321, April&nbsp;1992 (<a href="ftp://ftp.isi.edu/in-notes/rfc1321.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text">Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2437">[RFC2437]</a></td>
<td class="author-text">Kaliski, B. and J. Staddon, &ldquo;<a href="http://tools.ietf.org/html/rfc2437">PKCS #1: RSA Cryptography Specifications Version 2.0</a>,&rdquo; RFC&nbsp;2437, October&nbsp;1998 (<a href="ftp://ftp.isi.edu/in-notes/rfc2437.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2437.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2437.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3174">[RFC3174]</a></td>
<td class="author-text">Eastlake, D. and P. Jones, &ldquo;<a href="http://tools.ietf.org/html/rfc3174">US Secure Hash Algorithm 1 (SHA1)</a>,&rdquo; RFC&nbsp;3174, September&nbsp;2001 (<a href="ftp://ftp.isi.edu/in-notes/rfc3174.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4330">[RFC4330]</a></td>
<td class="author-text">Mills, D., &ldquo;<a href="http://tools.ietf.org/html/rfc4330">Simple Network Time Protocol (SNTP) Version 4 for IPv4, IPv6 and OSI</a>,&rdquo; RFC&nbsp;4330, January&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4330.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SHA256">[SHA256]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;Secure Hash Algorithm,&rdquo; NIST FIPS&nbsp;180-2, August&nbsp;2002.</td></tr>
</table>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Examples</h3>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Example of a Signed Message</h3>

<p>
        	The sample message depicted in <a class='info' href='#exampleMessage'>Figure&nbsp;1<span> (</span><span class='info'>Example message with signature</span><span>)</span></a> is  taken from the appendix of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>. However, a SIGNATURE Message TLV has been added. It is assumed that the SIGNATURE TLV type is lesser than the TLV type of the second message TLV (i.e. it comes first  in the order of Message TLVs). The TLV value represents a 16 octet long signature of the whole message.
        
</p><br /><hr class="insert" />
<a name="exampleMessage"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 0 0 1 0 0 0|    Packet Sequence Number     | Message Type  |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |1 1 1 1 0 0 1 1|0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 0|   Orig Addr   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |           Originator Address (cont)           |   Hop Limit   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Hop Count   |    Message Sequence Number    |0 0 0 0 0 0 0 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 0 1 1 1 1 0|   SIGNATURE   |0 0 0 1 0 0 0 0|0 0 0 1 0 0 1 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Hash Func   |  Crypto Func  |        Signature Value        |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    Signature Value (cont)                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    Signature Value (cont)                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    Signature Value (cont)                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |    Signature Value (cont)     |   TLV Type    |0 0 0 1 0 0 0 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 0 0 0 1 1 0|                     Value                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                 Value (cont)                  |0 0 0 0 0 0 1 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 1 1 0 0 0 0|0 0 0 0 0 0 1 0|              Mid              |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |              Mid              | Prefix Length |0 0 0 0 0 0 0 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 0 0 0 0 0 0|0 0 0 0 0 0 1 1|1 0 0 0 0 0 0 0|0 0 0 0 0 0 1 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |             Head              |              Mid              |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |              Mid              |              Mid              |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1|   TLV Type    |0 0 0 1 0 0 0 0|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 0 0 0 0 1 0|             Value             |   TLV Type    |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |0 0 1 0 0 0 0 0|  Index Start  |  Index Stop   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Example message with signature&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ulrich Herberg</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">LIX, Ecole Polytechnique</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">91128 Palaiseau Cedex, </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+33-1-6933-4126</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ulrich@herberg.name">ulrich@herberg.name</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.herberg.name/">http://www.herberg.name/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Thomas Heide Clausen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">LIX, Ecole Polytechnique</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">91128 Palaiseau Cedex, </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+33 6 6058 9349</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:T.Clausen@computer.org">T.Clausen@computer.org</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.thomasclausen.org/">http://www.thomasclausen.org/</a></td></tr>
</table>
</body></html>
