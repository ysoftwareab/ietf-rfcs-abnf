



GROW                                                          C. Cardona
Internet-Draft                                                P. Lucente
Intended status: Standards Track                                     NTT
Expires: 8 September 2022                                        T. Graf
                                                                Swisscom
                                                               B. Claise
                                                                  Huawei
                                                            7 March 2022


                            BMP YANG Module
                      draft-cptb-grow-bmp-yang-01

Abstract

   This document proposes a YANG module for BMP (BGP Monitoring
   Protocol) configuration and monitoring.  A complementary RPC triggers
   a refresh of the session of a BMP station.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 8 September 2022.

Copyright Notice

   Copyright (c) 2022 IETF Trust and the persons identified as the
   document authors.  All rights reserved.











Cardona, et al.         Expires 8 September 2022                [Page 1]

Internet-Draft               BMP YANG Module                  March 2022


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  Model summary . . . . . . . . . . . . . . . . . . . . . . . .   2
   4.  Base ietf-bmp YANG module . . . . . . . . . . . . . . . . . .   3
     4.1.  Tree View . . . . . . . . . . . . . . . . . . . . . . . .   3
     4.2.  YANG Module . . . . . . . . . . . . . . . . . . . . . . .   4
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .  12
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  12
     6.1.  The IETF XML Registry . . . . . . . . . . . . . . . . . .  12
   7.  Open Issues . . . . . . . . . . . . . . . . . . . . . . . . .  12
   8.  Normative References  . . . . . . . . . . . . . . . . . . . .  12
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  13
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  13

1.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

   Routing Information Bases, peers, monitoring stations are defined in
   [RFC7854].

2.  Introduction

   This document specifies a YANG module for configuring and monitoring
   the BGP Monitoring Protocol (BMP) [RFC7854].  The model provides
   parameters for defining BMP monitoring stations, the selection of the
   BGP Routing Information Bases (RIBs), provides operational metrics
   and enables to reset BMP monitoring sessions.

3.  Model summary

   The BMP YANG model provides the methods for managing BMP monitoring
   stations.  It includes:



Cardona, et al.         Expires 8 September 2022                [Page 2]

Internet-Draft               BMP YANG Module                  March 2022


   *  Connectivity parameters, including station IP address and
      destination port.

   *  BMP session parameters, such as defining the BMP initiation
      message or the interval for statistics messages.

   *  BGP Data sources.  The model requires the explicit configuration
      of the RIBs and address family to send to each monitoring station.
      For Adj-RIB-in and Adj-RIB-out, both post and pre policy, the
      model also requires the peers from which to originate data.  In
      those RIBs, the value "all_peers" can be used if the operators
      desires to receive data of all peers.

   *  Per BMP station status and statistics, such as established status,
      number of route-monitoring messages, number of route-mirroring
      messages, number of peer-down and peer-up messages, number of
      initiation messages.

   *  BMP session reset RPC action.

4.  Base ietf-bmp YANG module

4.1.  Tree View

   The following tree diagram provides an overview of the ietf-bmp.yang
   data model.

   module: ietf-bmp
     +--rw bmp
        +--rw stations
        |  +--rw station* [id]
        |     +--rw id               string
        |     +--rw connection
        |     |  +--rw destination-address    inet:ip-address
        |     |  +--rw local-address?         inet:ip-address
        |     |  +--rw destination-port?      inet:ip-address
        |     +--rw bmp_session
        |     |  +--rw initiation-message?    string
        |     |  +--rw statistics-interval?   uint32
        |     +--rw bmp_sources
        |     |  +--rw adj-rib-in-pre
        |     |  |  +--rw enabled?            boolean
        |     |  |  +--rw address-families
        |     |  |     +--rw address-family* [name]
        |     |  |        +--rw name     leafref
        |     |  |        +--rw peers*   union
        |     |  +--rw adj-rib-in-post
        |     |  |  +--rw enabled?            boolean



Cardona, et al.         Expires 8 September 2022                [Page 3]

Internet-Draft               BMP YANG Module                  March 2022


        |     |  |  +--rw address-families
        |     |  |     +--rw address-family* [name]
        |     |  |        +--rw name     leafref
        |     |  |        +--rw peers*   union
        |     |  +--rw local-rib
        |     |  |  +--rw enabled?            boolean
        |     |  |  +--rw address-families*   identityref
        |     |  +--rw adj-rib-out-pre
        |     |  |  +--rw enabled?            boolean
        |     |  |  +--rw address-families
        |     |  |     +--rw address-family* [name]
        |     |  |        +--rw name     leafref
        |     |  |        +--rw peers*   union
        |     |  +--rw adj-rib-out-post
        |     |     +--rw enabled?            boolean
        |     |     +--rw address-families
        |     |        +--rw address-family* [name]
        |     |           +--rw name     leafref
        |     |           +--rw peers*   union
        |     +--rw session-stats
        |        +--ro established-session?               boolean
        |        +--ro total-route-monitoring-messages?   uint32
        |        +--ro total-statistics-messages?         uint32
        |        +--ro total-peer-down-messages?          uint32
        |        +--ro total-peer-up-messages?            uint32
        |        +--ro total-initiation-messages?         uint32
        |        +--ro total-route-mirroring-messages?    uint32
        +--rw actions
           +---x session-reset
              +---w input
              |  +---w station?   -> /bmp/stations/station/id
              +--ro output
                 +--ro (outcome)?
                    +--:(success)
                    |  +--ro success?   empty
                    +--:(failure)
                       +--ro failure?   string

4.2.  YANG Module

   <CODE BEGINS> file "ietf-bmp@2022-01-27.yang"

   module ietf-bmp {
     yang-version 1.1;
     namespace "urn:ietf:params:xml:ns:yang:ietf-bmp";
     prefix ietf-bmp;

     import ietf-inet-types {



Cardona, et al.         Expires 8 September 2022                [Page 4]

Internet-Draft               BMP YANG Module                  March 2022


       prefix inet;
       reference
         "RFC 6991: Common YANG Data Types";
     }
     import ietf-routing {
       prefix rt;
       reference
         "RFC 8349, A YANG Data Model for Routing Management
          (NMDA Version).";
     }
     import ietf-bgp-types {
       prefix bt;
       reference
         "RFC XXXX, BGP YANG Model for Service Provider Network.";
     }
     import ietf-bgp {
       prefix bgp;
       reference
         "RFC XXXX: BGP YANG module for Service Provider Network.";
     }

     organization
       "IETF GROW Working Group";
     contact
       "WG Web:   <https://datatracker.ietf.org/wg/grow/>
        WG List:  <mailto:grow@ietf.org>

        Author:  Camilo Cardona
           <mailto:camilo@ntt.net>

        Author:  Paolo Lucente
           <mailto:cpaolo@ntt.net>

        Author:  Thomas Graf
           <mailto:thomas.graf@swisscom.com>

        Author:  Benoit Claise
           <mailto:benoit.claise@huawei.com>";
     description
       "This module specifies a structure for BMP
        (BGP Monitoring Protocol) configuration and monitoring.

        The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL',
        'SHALL NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED',
        'NOT RECOMMENDED', 'MAY', and 'OPTIONAL' in this document
        are to be interpreted as described in BCP 14 (RFC 2119)
        (RFC 8174) when, and only when, they appear in all
        capitals, as shown here.



Cardona, et al.         Expires 8 September 2022                [Page 5]

Internet-Draft               BMP YANG Module                  March 2022


        Copyright (c) 2022 IETF Trust and the persons identified as
        authors of the code.  All rights reserved.

        Redistribution and use in source and binary forms, with or
        without modification, is permitted pursuant to, and subject to
        the license terms contained in, the Revised BSD License set
        forth in Section 4.c of the IETF Trust's Legal Provisions
        Relating to IETF Documents
        (https://trustee.ietf.org/license-info).

        This version of this YANG module is part of RFC 9196
        (https://www.rfc-editor.org/info/rfc9196); see the RFC itself
        for full legal notices.";

     revision 2022-01-27 {
       description
         "initial version";
       reference
         "[RFC-to-be]: BMP YANG Module";
     }

     typedef bmp_peer_types {
       type enumeration {
         enum all_peers {
           value 10;
           description
             "Selects all peers";
         }
       }
       description
         "Enum values for peer selection specific for BMP";
     }

     grouping bmp_ip_connection {
       description
         "common elements for defining connectivity
          to a bmp station";
       leaf destination-address {
         type inet:ip-address;
         mandatory true;
         description
           "Destination IP address of station";
       }
       leaf local-address {
         type inet:ip-address;
         description
           "Local IP address to source connections";
       }



Cardona, et al.         Expires 8 September 2022                [Page 6]

Internet-Draft               BMP YANG Module                  March 2022


       leaf destination-port {
         type inet:ip-address;
         description
           "Destination port for connections";
       }
     }

     grouping bmp_peer_ribs_filter {
       description
         "Leaves for configuring RIBs where
          origin/destination peers are well defined.";
       leaf enabled {
         type boolean;
         description
           "Enables the specified RIB";
       }
       container address-families {
         description
           "container for lists of address-families";
         list address-family {
           key "name";
           description
             "List of address families.
              The name of the address family, as defined
              in the BGP model is used for keying.";
           leaf name {
             type leafref {
               path "/rt:routing/rt:control-plane-protocols/"
                  + "rt:control-plane-protocol/bgp:bgp/"
                  + "bgp:global/bgp:afi-safis/bgp:afi-safi/bgp:name";
             }
             description
               "Name of the address family";
           }
           leaf-list peers {
             type union {
               type leafref {
                 path "/rt:routing/rt:control-plane-protocols/"
                    + "rt:control-plane-protocol/bgp:bgp/"
                    + "bgp:neighbors/bgp:neighbor/bgp:remote-address";
               }
               type bt:peer-type;
               type bmp_peer_types;
             }
             description
               "Peers can be identified by a remote-address,
                or by a enum value corresponding to groups of peers.
                This way an operator can select all external peers,



Cardona, et al.         Expires 8 September 2022                [Page 7]

Internet-Draft               BMP YANG Module                  March 2022


                all internal peers, or all peers.";
           }
         }
       }
     }

     grouping bmp_route_monitoring_sources {
       description
         "";
       container adj-rib-in-pre {
         description
           "Configuration for the adj-rib-in pre-policy";
         uses bmp_peer_ribs_filter;
       }
       container adj-rib-in-post {
         description
           "Configuration for the adj-rib-in post-policy";
         uses bmp_peer_ribs_filter;
       }
       container local-rib {
         description
           "Configuration for the local-rib";
         leaf enabled {
           type boolean;
           description
             "Enables the specified RIB";
         }
         leaf-list address-families {
           type identityref {
             base bt:afi-safi-type;
           }
           description
             "List of address families to enable for
              local-rib.";
         }
       }
       container adj-rib-out-pre {
         description
           "Configuration for the adj-rib-out pre-policy";
         uses bmp_peer_ribs_filter;
       }
       container adj-rib-out-post {
         description
           "Configuration for the adj-rib-out post-policy";
         uses bmp_peer_ribs_filter;
       }
     }




Cardona, et al.         Expires 8 September 2022                [Page 8]

Internet-Draft               BMP YANG Module                  March 2022


     grouping bmp_session_options {
       description
         "leaves for configuration of the bmp session";
       leaf initiation-message {
         type string;
         description
           "User defined message to append to the
            initiation message";
       }
       leaf statistics-interval {
         type uint32;
         description
           "Default Interval for statistic message.";
       }
     }

     container bmp {
       description
         "Main level for BMP configuration ";
       container stations {
         description
           "Container for the list of BMP stations";
         list station {
           key "id";
           description
             "Configuration for BMP stations.";
           leaf id {
             type string;
             description
               "Identification string for the station";
           }
           // Connection, missing tcp tuning params
           // like keep-alives, segment sizes, etc.
           container connection {
             description
               "Connection details for the station";
             uses bmp_ip_connection;
           }
           container bmp_session {
             description
               "BMP session options for the station";
             uses bmp_session_options;
           }
           container bmp_sources {
             description
               "Configuration of the data sources for the station";
             uses bmp_route_monitoring_sources;
           }



Cardona, et al.         Expires 8 September 2022                [Page 9]

Internet-Draft               BMP YANG Module                  March 2022


           container session-stats {
             description
               "stats and operational values for the station";
             leaf established-session {
               type boolean;
               config false;
               description
                 "Value indicating if the session is currently
                  established";
             }
             leaf total-route-monitoring-messages {
               type uint32;
               config false;
               description
                 "Number of route-monitoring messages sent since last
                  successful connection";
             }
             leaf total-statistics-messages {
               type uint32;
               config false;
               description
                 "Number of statistics messages sent since last
                  successful connection";
             }
             leaf total-peer-down-messages {
               type uint32;
               config false;
               description
                 "Number of peer-down messages sent since last
                  successful connection";
             }
             leaf total-peer-up-messages {
               type uint32;
               config false;
               description
                 "Number of peer-up messages sent since last successful
                  connection";
             }
             leaf total-initiation-messages {
               type uint32;
               config false;
               description
                 "Number of initiation messages sent since last
                  successful connection";
             }
             leaf total-route-mirroring-messages {
               type uint32;
               config false;



Cardona, et al.         Expires 8 September 2022               [Page 10]

Internet-Draft               BMP YANG Module                  March 2022


               description
                 "Number of route-mirroring messages sent since last
                  successful connection";
             }
           }
         }
       }
       container actions {
         description
           "Container with the actions for the BMP operation";
         action session-reset {
           description
             "Resets the session for a station.";
           input {
             leaf station {
               type leafref {
                 path "/bmp/stations/station/id";
               }
               description
                 "Identifies the station to reset";
             }
           }
           output {
             choice outcome {
               description
                 "Output of the reset operation. Either a success or
                  failure. For the latter, the reason for the
                  error is provided.";
               leaf success {
                 type empty;
                 description
                   "Reset successful";
               }
               leaf failure {
                 type string;
                 description
                   "Reset could not be performed.
                   Reason is included in the field";
               }
             }
           }
         }
       }
     }
   }

   <CODE ENDS>




Cardona, et al.         Expires 8 September 2022               [Page 11]

Internet-Draft               BMP YANG Module                  March 2022


5.  Security Considerations

   The YANG module specified in this document defines a schema for data
   that is designed to be accessed via network management protocols such
   as NETCONF [RFC6241] or RESTCONF [RFC8040].  The lowest NETCONF layer
   is the secure transport layer, and the mandatory-to-implement secure
   transport is Secure Shell (SSH) [RFC6242].  The lowest RESTCONF layer
   is HTTPS, and the mandatory-to-implement secure transport is TLS
   [RFC8446].

   BGP data is sensible for security considerations.  The model
   described in this document could be used to send BGP information to
   malicious BMP stations.  Write access to this model should therefore
   be properly protected.

   The session-reset action can demand considerable amount of resources
   from network elements.  It should thus be protected from illegal
   access.

6.  IANA Considerations

6.1.  The IETF XML Registry

   This document registers two URIs in the IETF XML registry [RFC3688].
   Following the format in [RFC3688], the following registrations are
   requested:

      URI: urn:ietf:params:xml:ns:yang:ietf-bmp
      Registrant Contact: The NETCONF WG of the IETF.
      XML: N/A, the requested URI is an XML namespace.

7.  Open Issues

      Shall we copy the TCP tuning and security parameters from the BGP
      specifications?

      The security considerations section will have to be aligned with
      https://trac.ietf.org/trac/ops/wiki/yang-security-guidelines

8.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.






Cardona, et al.         Expires 8 September 2022               [Page 12]

Internet-Draft               BMP YANG Module                  March 2022


   [RFC3688]  Mealling, M., "The IETF XML Registry", BCP 81, RFC 3688,
              DOI 10.17487/RFC3688, January 2004,
              <https://www.rfc-editor.org/info/rfc3688>.

   [RFC6241]  Enns, R., Ed., Bjorklund, M., Ed., Schoenwaelder, J., Ed.,
              and A. Bierman, Ed., "Network Configuration Protocol
              (NETCONF)", RFC 6241, DOI 10.17487/RFC6241, June 2011,
              <https://www.rfc-editor.org/info/rfc6241>.

   [RFC6242]  Wasserman, M., "Using the NETCONF Protocol over Secure
              Shell (SSH)", RFC 6242, DOI 10.17487/RFC6242, June 2011,
              <https://www.rfc-editor.org/info/rfc6242>.

   [RFC7854]  Scudder, J., Ed., Fernando, R., and S. Stuart, "BGP
              Monitoring Protocol (BMP)", RFC 7854,
              DOI 10.17487/RFC7854, June 2016,
              <https://www.rfc-editor.org/info/rfc7854>.

   [RFC8040]  Bierman, A., Bjorklund, M., and K. Watsen, "RESTCONF
              Protocol", RFC 8040, DOI 10.17487/RFC8040, January 2017,
              <https://www.rfc-editor.org/info/rfc8040>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8446]  Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", RFC 8446, DOI 10.17487/RFC8446, August 2018,
              <https://www.rfc-editor.org/info/rfc8446>.

Acknowledgements

   The authors would like to thank Pierre Vander Vorst for his review
   and feedback.

Authors' Addresses

   Camilo Cardona
   NTT
   164-168, Carrer de Numancia
   08029 Barcelona
   Spain
   Email: camilo@ntt.net








Cardona, et al.         Expires 8 September 2022               [Page 13]

Internet-Draft               BMP YANG Module                  March 2022


   Paolo Lucente
   NTT
   Siriusdreef 70-72
   2132 Hoofddorp
   Netherlands
   Email: paolo@ntt.net


   Thomas Graf
   Swisscom
   Binzring 17
   CH- Zurich 8045
   Switzerland
   Email: thomas.graf@swisscom.com


   Benoit Claise
   Huawei
   Email: benoit.claise@huawei.com
































Cardona, et al.         Expires 8 September 2022               [Page 14]
