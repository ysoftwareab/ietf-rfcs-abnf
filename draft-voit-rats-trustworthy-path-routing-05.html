<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Trusted Path Routing</title>
<meta content="Eric Voit" name="author">
<meta content="Chennakesava Reddy Gaddam" name="author">
<meta content="Guy C. Fedorkow" name="author">
<meta content="Henk Birkholz" name="author">
<meta content="Meiling Chen" name="author">
<meta content="
       There are end-users who believe encryption technologies like IPSec alone are insufficient to protect the confidentiality of their highly sensitive traffic flows.  These end-users want their flows to traverse devices which have been freshly appraised and verified for trustworthiness. This specification describes Trusted Path Routing.  Trusted Path Routing protects sensitive flows as they transit a network by forwarding traffic to/from sensitive subnets across network devices recently appraised as trustworthy. 
    " name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-voit-rats-trustworthy-path-routing-05" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-voit-rats-trustworthy-path-routing-05-eu_vjayv.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">trust-path</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Voit, et al.</td>
<td class="center">Expires 3 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">RATS Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-voit-rats-trustworthy-path-routing-05</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03-02" class="published">2 March 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-03">3 September 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">E. Voit</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">C. Gaddam</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">G. Fedorkow</div>
<div class="org">Juniper</div>
</div>
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">M. Chen</div>
<div class="org">China Mobile</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Trusted Path Routing</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">There are end-users who believe encryption technologies like IPSec alone are insufficient to protect the confidentiality of their highly sensitive traffic flows.  These end-users want their flows to traverse devices which have been freshly appraised and verified for trustworthiness. This specification describes Trusted Path Routing.  Trusted Path Routing protects sensitive flows as they transit a network by forwarding traffic to/from sensitive subnets across network devices recently appraised as trustworthy.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-3">
<a href="#name-status-of-this-memo-3" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 3 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-3">
<a href="#name-copyright-notice-3" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-3">
<a href="#name-table-of-contents-3" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-3" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology-2" class="xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-terms" class="xref">Terms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-requirements-notation" class="xref">Requirements Notation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-implementation-prerequisite" class="xref">Implementation Prerequisites</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-end-to-end-solution" class="xref">End-to-end Solution</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-network-topology-assembly" class="xref">Network Topology Assembly</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-attestation-information-flo" class="xref">Attestation Information Flows</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-step-1" class="xref">Step 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-step-2" class="xref">Step 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-step-3" class="xref">Step 3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="xref">4.2.4</a>.  <a href="#name-step-4" class="xref">Step 4</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5">
                    <p id="section-toc.1-1.4.2.2.2.5.1"><a href="#section-4.2.5" class="xref">4.2.5</a>.  <a href="#name-step-5" class="xref">Step 5</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.6">
                    <p id="section-toc.1-1.4.2.2.2.6.1"><a href="#section-4.2.6" class="xref">4.2.6</a>.  <a href="#name-step-6" class="xref">Step 6</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-yang-module" class="xref">YANG Module</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations-3" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-references-2" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-normative-references-3" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-informative-references-3" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-change-log" class="xref">Change Log</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-open-questions" class="xref">Open Questions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-D" class="xref"></a><a href="#name-authors-addresses-3" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction-3">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-3" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">There are end-users who believe encryption technologies like IPSec alone are insufficient to protect the confidentiality of their highly sensitive traffic flows.   These customers want their highly sensitive flows to be transported over only network devices recently verified as trustworthy.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">By using a router's embedded TPM based cryptoprocessors in conjunction with the Remote Attestation context established by <span>[<a href="#attestation-results" class="xref">attestation-results</a>]</span>, a network provider can identify potentially compromised devices as well as potentially exploitable (or even exploited) vulnerabilities.  Using this knowledge, it is then possible to redirect sensitive flows around these devices while other remediations are potentially considered by Network Operations.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Trusted Path Routing allows the establishing Trusted Topologies which only include trust-verified network devices.  Membership in a Trusted Topology is established and maintained via an exchange of Stamped Passports at the link layer between peering network devices. As links to Attesting Devices are appraised as meeting at least a minimum set of formally defined Trustworthiness Claims, the links are then included as members of this Trusted Topology.  Routing protocols are then used to propagate topology state throughout a network.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">IP Packets to and from end-user designated Sensitive Subnets are then forwarded into this Trusted Topology at each network boundary.  This is done by an end user identifying sensitive IP subnets where flows with applications using these IP subnets need enhanced privacy guarantees. Trusted Path Routing passes flows to/from these Sensitive Subnets over a Trusted Topology able to meet these guarantees.  The Trusted Topology itself consists of the interconnection of network devices where each potentially transited device has been verified as achieving a specific set of Trustworthiness Claims during its most recent trustworthiness appraisal. Interesting sets of Trustworthiness Claims might be marketed to end-users in the following ways:<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">all transited devices have booted with known hardware and firmware<a href="#section-1-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.2">all transited devices are from a specific set of vendors and are running known software containing the latest patches<a href="#section-1-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.3">no guarantees provided<a href="#section-1-5.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology-2">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology-2" class="section-name selfRef">Terminology</a>
      </h2>
<div id="terms">
<section id="section-2.1">
        <h3 id="name-terms">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-terms" class="section-name selfRef">Terms</a>
        </h3>
<p id="section-2.1-1">The following terms are imported from <span>[<a href="#RATS-Arch" class="xref">RATS-Arch</a>]</span>: 
Attester, Evidence, Passport, Relying Party, and Verifier.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The following terms are impored from <span>[<a href="#attestation-results" class="xref">attestation-results</a>]</span>:
Trustworthiness Claim, Trustworthiness Vector, AR-augmented Evidence<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">Newly defined terms for this document:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-4">
          <dt id="section-2.1-4.1">Attested Device --</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.2">
            <p id="section-2.1-4.2.1">a network connected Attester where a Verifier's most recent appraisal of Evidence has returned a Trustworthiness Vector.<a href="#section-2.1-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.3">Stamped Passport --</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.4">
            <p id="section-2.1-4.4.1">AR-augmented Evidence which can take two forms.  First if the Attester uses a TPM2, the the Verifier Proof-of-Freshness includes the &lt;clock&gt;, &lt;reset-counter&gt;, &lt;restart-counter&gt; and &lt;safe&gt; objects from a recent TPM2 quote made by that Attester, and the Relying Party Proof-of-Freshness is returned along with the timeticks as objects embedded within the most recent TPM quote signed by the same TPM2. Second, if the Attester uses a TPM1.2: the Verifier Proof-of-Freshness includes a global timestamp from that Verifier, and the Relying Party Proof-of-Freshness is embedded within a more recent TPM quote signed by the same TPM Attesting Environment.<a href="#section-2.1-4.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.5">Sensitive Subnet --</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.6">
            <p id="section-2.1-4.6.1">an IP address range where IP packets to or from that range desire confidentially guarantees beyond those of non-identified subnets.  In practice, flows to or from a Sensitive Subnet must only have their IP headers and encapsulated payloads accessible/visible only by Attested Devices supporting one or more Trustworthiness Vectors.<a href="#section-2.1-4.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.7">Transparently-Transited Device --</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.8">
            <p id="section-2.1-4.8.1">a network device within an network domain where any packets originally passed into that network domain are completely opaque on that network device at Layer 3 and above.<a href="#section-2.1-4.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.9">Trusted Topology --</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.10">
            <p id="section-2.1-4.10.1">a topology which includes only Attested Devices and Transparently-Transited Devices.<a href="#section-2.1-4.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="requirements-notation">
<section id="section-2.2">
        <h3 id="name-requirements-notation">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-requirements-notation" class="section-name selfRef">Requirements Notation</a>
        </h3>
<p id="section-2.2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-prerequisites">
<section id="section-3">
      <h2 id="name-implementation-prerequisite">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-implementation-prerequisite" class="section-name selfRef">Implementation Prerequisites</a>
      </h2>
<p id="section-3-1">The specification is a valid instance of <span>[<a href="#attestation-results" class="xref">attestation-results</a>]</span>.  This specification works under the following protocol and preconfiguration prerequisite assumptions:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">All Attested Devices support the TPM remote attestation profile as laid out in <span>[<a href="#RATS-Device" class="xref">RATS-Device</a>]</span>, and include either <span>[<a href="#TPM2.0" class="xref">TPM2.0</a>]</span> or <span>[<a href="#TPM1.2" class="xref">TPM1.2</a>]</span>.<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.2">One or more Verifier A's as defined in <span>[<a href="#attestation-results" class="xref">attestation-results</a>]</span> 'Interaction Model' continuously appraise each of the Attested Devices in a network domain, and these Verifiers return the Attestation Results back to each originating Attested Device.<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.3">The Attested Devices are connected via link layer protocols such as <span>[<a href="#MACSEC" class="xref">MACSEC</a>]</span> or <span>[<a href="#IEEE-802.1X" class="xref">IEEE-802.1X</a>]</span>.<a href="#section-3-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.4">Each Attester can pass a Stamped Passport to a Relying Party / Verifier B as defined in <span>[<a href="#attestation-results" class="xref">attestation-results</a>]</span> 'Interaction Model' within <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span> over that link layer protocol.<a href="#section-3-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.5">A Trusted Topology such as <span>[<a href="#I-D.ietf-lsr-flex-algo" class="xref">I-D.ietf-lsr-flex-algo</a>]</span> exists in an IGP domain for the forwarding of Sensitive Subnet traffic.  This Topology will carry traffic across a set of Attested Devices which currently meet at a defined set of Trustworthiness Vectors.<a href="#section-3-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.6">A Relying Party is able to use mechanisms such as <span>[<a href="#I-D.ietf-lsr-flex-algo" class="xref">I-D.ietf-lsr-flex-algo</a>]</span>'s affinity to include/exclude links as part of the Trusted Topology based on the appraisal of a Stamped Passport.<a href="#section-3-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.7">Customer designated Sensitive Subnets and their requested Trustworthiness Vectors have been identified and associated with external interfaces to/from Attested Devices at the edge of a network. Traffic to a Sensitive Subnet can be passed into the Trusted Topology by the Attested Device.<a href="#section-3-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.8">Relying Party/Verifier B trusts information signed by Verifier A.  Verifier B has also been pre-provisioned with certificates or public keys necessary to confirm that Stamped Passports came from Verifier A.<a href="#section-3-2.8" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="end-to-end-solution">
<section id="section-4">
      <h2 id="name-end-to-end-solution">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-end-to-end-solution" class="section-name selfRef">End-to-end Solution</a>
      </h2>
<div id="network-topology-assembly">
<section id="section-4.1">
        <h3 id="name-network-topology-assembly">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-network-topology-assembly" class="section-name selfRef">Network Topology Assembly</a>
        </h3>
<p id="section-4.1-1">To be included in a Trusted Topology, Stamped Passports are shared between Attested Devices (such as routers) as part of link layer authentication.  Upon receiving and appraising the Stamped Passport during the link layer authentication phase, the Relying Party Attested Device decides if this link should be added as an active adjacency for a particular Trusted Topology.  In <a href="#fig-topology" class="xref">Figure 1</a> below, this might be done by applying an Appraisal Policy for Attestation Results. The policy within each device might specify the evalutation of a 'hardware' claim as defined in <span>[<a href="#attestation-results" class="xref">attestation-results</a>]</span>, Section 2.3.4. With the appraisal, an Attesting Device be most recently appraised with the 'hardware' Trustworthiness Claim in the 'affirming' range.  If Attested Device has been appraised outside that range, it would not become part of the Trustworthy Topology.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">When enough links have been successfully added, the Trusted Topology will support edge-to-edge forwarding as routing protocols flood the adjacency information across the network domain.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<span id="name-trusted-path-topology-assem"></span><div id="fig-topology">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-4.1-3.1">
<pre>
               .------------.                .----------.
               | Attested   |                | Edge     |
 .----------.  | Device 'x' |                | Attested |
 | Attested |  |            |                | Device   |
 | Device   |  |            |                |          |
 |          |  |        trust&gt;---------------&lt;no_trust  |
 |  no_trust&gt;--&lt;trust       |  .----------.  |          |---Sensitive
 |          |  '------------'  |     trust&gt;==&lt;trust     |   Subnet
 |     trust&gt;==================&lt;trust     |  |          |
 '----------'                  |          |  '----------'
                               | Attested |
                               | Device   |
                               '----------'
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-trusted-path-topology-assem" class="selfRef">Trusted Path Topology Assembly</a>
          </figcaption></figure>
</div>
<p id="section-4.1-4">As the process described above repeats over time across the set of links within a network domain, Trusted Topologies can be extended and maintained. Traffic to and from Sensitive Subnets is then identified at the edges of the network domain and passed into this Trusted Topology.  Traffic exchanged with Sensitive Subnets can then be forwarded across that Trusted Topology from all edges of the network domain.  After the initial Trusted Topology establishment, new and existing devices will continue to provide incremental Stamped Passports.  As each link is added/removed from the Trusted Topology, the topology will adjust itself accordingly.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">Ultimately from an operator and users point of view, the delivered network will be more secure and therefore the service provided more valuable. As network operators attach great importance to the innate security of links, also delivering security for transited network and networking devices will also prove valuable.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attestation-information-flows">
<section id="section-4.2">
        <h3 id="name-attestation-information-flo">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-attestation-information-flo" class="section-name selfRef">Attestation Information Flows</a>
        </h3>
<p id="section-4.2-1">Critical to the establishment and maintenance of a Trusted Topology is the Stamped Passport.  A Stamped Passport is comprised of Evidence from both an Attester and a Verifier.  A Stamped Passport is a valid type of AR-augmented evidence as described in <span>[<a href="#attestation-results" class="xref">attestation-results</a>]</span>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Stamped Passports are exchanged between adjacent network devices over a link layer protocols like 802.1x or MACSEC.  As both sides of a link may need might need to appraise the other, independent Stamped Passports will often be transmitted from either side of the link.  Additionally, as link layer protocols will continuously re-authenticate the link, this allows for fresh Stamped Passports to be constantly appraised by either side of the connection.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Each Stamped Passport will include the most recent Verifier provided Attestation Results, as well as the most recent TPM Quote for that Attester.  Upon receiving this information as part of link layer authentication, the Relying Party Router appraises the results and decides if this link should be added to a Trusted Topology.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4"><a href="#fig-timing" class="xref">Figure 2</a> describes this flow of information using the time definitions described in <span>[<a href="#RATS-Arch" class="xref">RATS-Arch</a>]</span>, and the information flows defined in Section 7 of <span>[<a href="#RATS-Interactions" class="xref">RATS-Interactions</a>]</span>.  This figure is also a valid embodiment of the "Interaction Model" described within <span>[<a href="#attestation-results" class="xref">attestation-results</a>]</span>.  (Note that the Relying Party must also be an Attested Device in order to attract Sensitive Subnet traffic which may flow from the Attester.)<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<span id="name-trusted-path-timing"></span><div id="fig-timing">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-4.2-5.1">
<pre>
  .------------------.
  | Attester         |
  |                  |
  | (Attested Device |
  |   / Router)      |                           .------------------.
  |  .-------------. |                           | Relying Party    |
  |  | TPM based   | |                           |   / Verifier B   |
  |  | Attesting   | |           .----------.    |                  |
  |  | Environment | |           | Verifier |    | (Attested Device |
  |  '-------------' |           |     A    |    |   / Router)      |
  '------------------'           '----------'    '------------------'
        time(VG)                       |                 |
          |&lt;------nonce--------------time(NS)            |
          |                            |                 |
 time(EG)(1)------Evidence------------&gt;|                 |
          |                          time(RG)            |
          |&lt;------Attestation Results-(2)                |
          ~                            ~                 ~
        time(VG')?                     |                 |
          ~                            ~                 ~
          |&lt;------nonce---------------------------------(3)time(NS')
          |                            |                 |
time(EG')(4)------Stamped Passport----------------------&gt;|
          |                            |   time(RG',RA')(5)
                                                        (6)
                                                         ~
                                                      time(RX')
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-trusted-path-timing" class="selfRef">Trusted Path Timing</a>
          </figcaption></figure>
</div>
<p id="section-4.2-6">To summarize <a href="#fig-timing" class="xref">Figure 2</a> above, Evidence about a specific Attester is generated.  Some subset of this evidence will be in the form of PCR quotes which are signed by a TPM that exists as the Attester's Attesting Environment. This Evidence will be delibered to and appraised by Verifier A.  Verifier A will then appraise the Attester and give it a Trustworthiness Vector.  This Trustworthiness Vector is then signed by Verifier A and be returned as Attestation Results to the Attester. Later, when a request comes in from a Relying Party, the Attester assembles and returns a Stamped Passport.  The Stamped Passport contains all the information necessary for Verifier B to appraise the most recent Trustworthiness Vector of the Attester.  Based on the Verifier B appraisal, the link will be included or not in a Trusted Topology maintained on the Relying Party.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">More details on the mechanisms used in the construction, verification, and transmitting of the Stamped Passport are listed below.  These numbers match to both the numbered steps of <a href="#fig-timing" class="xref">Figure 2</a> and numbered steps described in Section 3 of <span>[<a href="#attestation-results" class="xref">attestation-results</a>]</span>:<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<div id="step-1">
<section id="section-4.2.1">
          <h4 id="name-step-1">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-step-1" class="section-name selfRef">Step 1</a>
          </h4>
<p id="section-4.2.1-1">Evidence about and Attester is generated.  A portion of this Evidence will include a PCR quote signed by a TPM private LDevID key that exists within the Attester's TPM based Attesting Environment.  The Attester sends a signed TPM Quote which includes PCR measurements to Verifier A at time(EG).<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">There are two alternatives for Verifier A to acquire this signed Evidence:<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-3.1">Subscription to the &lt;attestation&gt; stream defined in <span>[<a href="#stream-subscription" class="xref">stream-subscription</a>]</span>.  Note: this method is recommended as it will minimize the interval between when a PCR change is made in a TPM, and when the PCR change appraisal is incorporated within a subsequent Stamped Passport.<a href="#section-4.2.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.2.1-3.2">Periodic polling of RPC &lt;tpm20-challenge-response-attestation&gt; or the RPC &lt;tpm12-challenge-response-attestation&gt; which are defined in <span>[<a href="#RATS-YANG" class="xref">RATS-YANG</a>]</span>.<a href="#section-4.2.1-3.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="step-2">
<section id="section-4.2.2">
          <h4 id="name-step-2">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-step-2" class="section-name selfRef">Step 2</a>
          </h4>
<p id="section-4.2.2-1">Verifier A appraises the Evidence from Step 1.  A portion of this appraisal process will follow the appraisal process flow described below. This appraisal process MUST be able to set at least the following set of Trustworthiness Claims from <span>[<a href="#attestation-results" class="xref">attestation-results</a>]</span>: 'hardware', 'instance-identity', and 'executables'.  The establishment of a Trustworthiness Vector uses the following <a href="#verifier-A" class="xref">Figure 3</a> logic on the Verifier:<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<span id="name-verifier-a-appraisal-flow"></span><div id="verifier-A">
<figure id="figure-3">
            <div class="alignLeft art-text artwork" id="section-4.2.2-2.1">
<pre>
Start: TPM Quote Received, log received, or appraisal timer expired
       for the the Attesting network device.

Appraisal 0: set Trustworthiness Vector = Null

Appraisal 1: Is there sufficient fresh signed evidence to appraise?
  (yes) - No Action
  (no) -  Goto End

Appraisal 2: Appraise Hardware Integrity PCRs
   if (hardware NOT "0") - push onto vector
   if (hardware NOT affirming or warning), go to End

Appraisal 3: Appraise Attesting Environment identity
   if (instance-identity &lt;&gt; "0") - push onto vector

Appraisal 4: Appraise executable loaded and filesystem integrity
   if (executables NOT "0") - push onto vector
   if (executables NOT affirming or warning), go to End

Appraisal 5: Appraise all remaining Trustworthiness Claims
        Independently and set as appropriate.

End
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-verifier-a-appraisal-flow" class="selfRef">Verifier A Appraisal Flow</a>
            </figcaption></figure>
</div>
<p id="section-4.2.2-3">After the appraisal and generation of the Trustworthiness Vector, the following are assembled as the set of Attestation Results from this particular appraisal cycle:<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4">(2.1) the Public Attestation Key which was used to validate the TPM Quote of Step 1.  This is encoded by &lt;public-key&gt;, &lt;public-key-format&gt;, and &lt;public-key-algorithm-type&gt;.<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2.2-5">(2.2) the appraised Trustworthiness Vector of the Attester as calculated in <a href="#verifier-A" class="xref">Figure 3</a><a href="#section-4.2.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2.2-6">(2.3) the PCR state information from the TPM Quote of (1) plus the time information associated with the TPM Quote of (1).  Specifically if the Attester has a TPM2, then the values of the TPM PCRs are included (i.e., &lt;TPM2B_DIGEST&gt;, &lt;tpm20-hash-algo&gt;, and &lt;pcr-index&gt;), as are the timing counters from the TPM (i.e., &lt;clock&gt;, &lt;reset-counter&gt;, &lt;restart-counter&gt;, and &lt;safe&gt;). Likewise if the Attester has a TPM1.2, the TPM PCR values of the &lt;pcr-index&gt; and &lt;pcr-value&gt; are included.  Timing information comes from the Verifier itself via the &lt;timestamp&gt; object.<a href="#section-4.2.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2.2-7">(2.4) a Verifier A signature across (2.1) though (2.3). This signature is encoded by &lt;verifier-signature&gt;, &lt;verifier-key-algorithm-type&gt;, and &lt;verifier-signature-key-name&gt;.<a href="#section-4.2.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2.2-8">Immediately subsequent to each Verifier appraisal cycle of an Attester, these Attestation Results MUST be pushed to the Attesting Router.   This is done via a daatstore write to the following YANG model on the Attester.  A YANG tree showing the relevant YANG objects is below.  The YANG model describing each of these objects is described later in the document.  Note however that although the YANG model shows the specific objects which are needed, the specific set of objects needs to be encoded in CDDL.  This makes the payload going over TLS more efficient.  Look for this encoding in a new version of the draft which is pending.<a href="#section-4.2.2-8" class="pilcrow">¶</a></p>
<span id="name-attestation-results-tree"></span><div id="fig-results-tree">
<figure id="figure-4">
            <div id="section-4.2.2-9.1">
<pre class="lang-YANG sourcecode">
module: ietf-trustworthiness-claims
  +--rw attestation-results!
     +--rw (tpm-specification-version)?
        +--:(tpm20-attestation-results-cddl) {taa:tpm20}?
        |  +--rw tpm20-attestation-results-cddl
        |     +--rw trustworthiness-vector
        |     |  +--rw hardware?            hardware
        |     |  +--rw instance-identity?   instance-identity
        |     |  +--rw executables?         executables
        |     |  +--rw configuration?       configuration
        |     +--rw tpm20-pcr-selection* [tpm20-hash-algo]
        |     |  +--rw tpm20-hash-algo    identityref
        |     |  +--rw pcr-index*         tpm:pcr
        |     +--rw TPM2B_DIGEST                         binary
        |     +--rw clock                                uint64
        |     +--rw reset-counter                        uint32
        |     +--rw restart-counter                      uint32
        |     +--rw safe                                 boolean
        |     +--rw attester-certificate-name
        |     |       tpm:certificate-name-ref
        |     +--rw appraisal-timestamp
        |     |       yang:date-and-time
        |     +--rw verifier-algorithm-type              identityref
        |     +--rw verifier-signature                   binary
        |     +--rw verifier-certificate-keystore-ref
        |             tpm:certificate-name-ref
        +--:(tpm12-attestation-results-cddl) {taa:tpm12}?
           +--rw tpm12-attestation-results-cddl
              +--rw trustworthiness-vector
              |  +--rw hardware?            hardware
              |  +--rw instance-identity?   instance-identity
              |  +--rw executables?         executables
              |  +--rw configuration?       configuration
              +--rw pcr-index*                           pcr
              +--rw tpm12-pcr-value*                     binary
              +--rw tpm12-hash-algo                      identityref
              +--rw TPM12-quote-timestamp
              |       yang:date-and-time
              +--rw attester-certificate-name
              |       tpm:certificate-name-ref
              +--rw appraisal-timestamp
              |       yang:date-and-time
              +--rw verifier-algorithm-type              identityref
              +--rw verifier-signature                   binary
              +--rw verifier-certificate-keystore-ref
                      tpm:certificate-name-ref
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-attestation-results-tree" class="selfRef">Attestation Results Tree</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="step-3">
<section id="section-4.2.3">
          <h4 id="name-step-3">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-step-3" class="section-name selfRef">Step 3</a>
          </h4>
<p id="section-4.2.3-1">At time(NS') some form of time-based freshness (such as a nonce or Epoch Handle <span>[<a href="#RATS-Interactions" class="xref">RATS-Interactions</a>]</span>) will be generated in a way which makes it available to the Relying Party.   Soon after time(NS'), a Relying Party will make a Link Layer authentication request to an Attester via a either <span>[<a href="#MACSEC" class="xref">MACSEC</a>]</span> or <span>[<a href="#IEEE-802.1X" class="xref">IEEE-802.1X</a>]</span>.  This connection request MUST expect the return of <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span> credentials from the Attester.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="step-4">
<section id="section-4.2.4">
          <h4 id="name-step-4">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-step-4" class="section-name selfRef">Step 4</a>
          </h4>
<p id="section-4.2.4-1">Upon receipt of the Link Layer request from Step 3, a Stamped Passport is generated and sent to the Relying Party.  The Stamped Passport MUST include the following:<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
<p id="section-4.2.4-2">(4.1) The Attestation Results from Step 2<a href="#section-4.2.4-2" class="pilcrow">¶</a></p>
<p id="section-4.2.4-3">(4.2) New signed, verifiably fresh PCR measurements based on a TPM quote at time(EG') which incorporates the freshness information known by the Relying Party from Step 3.  If it is a nonce, the freshness information will have been delivered as part of the link layer connection request in Steps 3.<a href="#section-4.2.4-3" class="pilcrow">¶</a></p>
<p id="section-4.2.4-4">Stamped Passports contain following objects, defined in this document via YANG.  A subsequent draft will convert the objects below into CDDL format so that the objects can efficiently be passed over EAP.<a href="#section-4.2.4-4" class="pilcrow">¶</a></p>
<p id="section-4.2.4-5">If an Attester includes a TPM2, these YANG objects are:<a href="#section-4.2.4-5" class="pilcrow">¶</a></p>
<span id="name-yang-tree-for-a-tpm2-stampe"></span><div id="fig-tpm2-passport">
<figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-4.2.4-6.1">
<pre>
    +---n tpm20-stamped-passport
       +--ro attestation-results
       |  +--ro trustworthiness-vector
       |  |  +--ro hardware?            hardware
       |  |  +--ro instance-identity?   instance-identity
       |  |  +--ro executables?         executables
       |  |  +--ro configuration?       configuration
       |  +--ro tpm20-pcr-selection* [tpm20-hash-algo]
       |  |  +--ro tpm20-hash-algo    identityref
       |  |  +--ro pcr-index*         tpm:pcr
       |  +--ro TPM2B_DIGEST                         binary
       |  +--ro clock                                uint64
       |  +--ro reset-counter                        uint32
       |  +--ro restart-counter                      uint32
       |  +--ro safe                                 boolean
       |  +--ro attester-certificate-name
       |  |       tpm:certificate-name-ref
       |  +--ro appraisal-timestamp
       |  |       yang:date-and-time
       |  +--ro verifier-algorithm-type              identityref
       |  +--ro verifier-signature                   binary
       |  +--ro verifier-certificate-keystore-ref
       |          tpm:certificate-name-ref
       +--ro tpm20-quote
          +--ro TPMS_QUOTE_INFO    binary
          +--ro quote-signature    binary

</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-yang-tree-for-a-tpm2-stampe" class="selfRef">YANG Tree for a TPM2 Stamped Passport</a>
            </figcaption></figure>
</div>
<p id="section-4.2.4-7">Note that where a TPM2.0 is used, the PCR numbers and hash algorithms quoted in Step 1 MUST match the PCR numbers and hash algorithms quoted in this step.<a href="#section-4.2.4-7" class="pilcrow">¶</a></p>
<p id="section-4.2.4-8">And if the Attester is a TPM1.2, the YANG object are:<a href="#section-4.2.4-8" class="pilcrow">¶</a></p>
<span id="name-yang-tree-for-a-tpm12-stamp"></span><div id="fig-tpm12-passport">
<figure id="figure-6">
            <div class="alignLeft art-text artwork" id="section-4.2.4-9.1">
<pre>
    +---n tpm12-stamped-passport
       +--ro attestation-results
       |  +--ro trustworthiness-vector
       |  |  +--ro hardware?            hardware
       |  |  +--ro instance-identity?   instance-identity
       |  |  +--ro executables?         executables
       |  |  +--ro configuration?       configuration
       |  +--ro pcr-index*                           pcr
       |  +--ro tpm12-pcr-value*                     binary
       |  +--ro tpm12-hash-algo                      identityref
       |  +--ro TPM12-quote-timestamp
       |  |       yang:date-and-time
       |  +--ro attester-certificate-name
       |  |       tpm:certificate-name-ref
       |  +--ro appraisal-timestamp
       |  |       yang:date-and-time
       |  +--ro verifier-algorithm-type              identityref
       |  +--ro verifier-signature                   binary
       |  +--ro verifier-certificate-keystore-ref
       |          tpm:certificate-name-ref
       +--ro tpm12-quote
          +--ro TPM_QUOTE2?   binary
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-yang-tree-for-a-tpm12-stamp" class="selfRef">YANG Tree for a TPM1.2 Stamped Passport</a>
            </figcaption></figure>
</div>
<p id="section-4.2.4-10">With either of these passport formats, if the TPM quote is verifiably fresh, then the state of the Attester can be appraised by a network peer.<a href="#section-4.2.4-10" class="pilcrow">¶</a></p>
<p id="section-4.2.4-11">Note that with <span>[<a href="#MACSEC" class="xref">MACSEC</a>]</span> or <span>[<a href="#IEEE-802.1X" class="xref">IEEE-802.1X</a>]</span>, Step 3 plus Step 4 will repeat periodically independently of any subsequent iteration Steps 1 and Step 2. This allows for periodic reauthentication of the link layer in a way not bound to the updating of Verifier A's Attestation Results.<a href="#section-4.2.4-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="step-5">
<section id="section-4.2.5">
          <h4 id="name-step-5">
<a href="#section-4.2.5" class="section-number selfRef">4.2.5. </a><a href="#name-step-5" class="section-name selfRef">Step 5</a>
          </h4>
<p id="section-4.2.5-1">Upon receipt of the Stamped Passport generated in Step 4, the Relying Party appraises this Stamped Passport as per its Appraisal Policy for Attestation Results. The result of this application will determine how the Stamped Passport will impact adjacencies within a Trusted Topology.  The decision process is as follows:<a href="#section-4.2.5-1" class="pilcrow">¶</a></p>
<p id="section-4.2.5-2">(5.1) Verify that (4.2) includes the freshness context from Step 3.<a href="#section-4.2.5-2" class="pilcrow">¶</a></p>
<p id="section-4.2.5-3">(5.2) Use a local certificate to validate the signature (4.1).<a href="#section-4.2.5-3" class="pilcrow">¶</a></p>
<p id="section-4.2.5-4">(5.3) Verify that the hash from (4.2) matches (4.1)<a href="#section-4.2.5-4" class="pilcrow">¶</a></p>
<p id="section-4.2.5-5">(5.4) Use the identity of (2.1) to validate the signature of (4.2).<a href="#section-4.2.5-5" class="pilcrow">¶</a></p>
<p id="section-4.2.5-6">(5.5) Failure of any steps (5.1) through (5.4) means the link does not meet minimum validation criteria, therefore appraise the link as having a null Verifier B Trustworthiness Vector.  Jump to Step 6.<a href="#section-4.2.5-6" class="pilcrow">¶</a></p>
<p id="section-4.2.5-7">(5.6) Compare the time(EG) TPM state to the time(EG') TPM state<a href="#section-4.2.5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.5-8.1">
              <p id="section-4.2.5-8.1.1">If TPM2.0<a href="#section-4.2.5-8.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.5-8.1.2">
<li id="section-4.2.5-8.1.2.1">If the &lt;TPM2B_DIGEST&gt;, &lt;reset-counter&gt;, &lt;restart-counter&gt; and &lt;safe&gt; are equal between the Attestation Results and the TPM Quote at time(EG') then Relying Party can accept (2.1) as the link's Trustworthiness Vector. Jump to Step 6.<a href="#section-4.2.5-8.1.2.1" class="pilcrow">¶</a>
</li>
                <li id="section-4.2.5-8.1.2.2">If the &lt;reset-counter&gt;, &lt;restart-counter&gt; and &lt;safe&gt; are equal between the Attestation Results and the TPM Quote at time(EG'), and the &lt;clock&gt; object from time(EG') has not incremented by an unacceptable number of seconds since the Attestation Result, then Relying Party can accept (2.1) as the link's Trustworthiness Vector. Jump to Step 6.)<a href="#section-4.2.5-8.1.2.2" class="pilcrow">¶</a>
</li>
                <li id="section-4.2.5-8.1.2.3">Assign the link a null Trustworthiness Vector.<a href="#section-4.2.5-8.1.2.3" class="pilcrow">¶</a>
</li>
              </ol>
</li>
            <li class="normal" id="section-4.2.5-8.2">
              <p id="section-4.2.5-8.2.1">If TPM1.2<a href="#section-4.2.5-8.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.5-8.2.2">
<li id="section-4.2.5-8.2.2.1">If the &lt;pcr-index&gt;'s and &lt;tpm12-pcr-value&gt;'s are equal between the Attestation Results and the TPM Quote at time(EG'), then Relying Party can accept (2.1) as the link's Trustworthiness Vector. Jump to step (6).<a href="#section-4.2.5-8.2.2.1" class="pilcrow">¶</a>
</li>
                <li id="section-4.2.5-8.2.2.2">If the time hasn't incremented an unacceptable number of seconds from the Attestation Results &lt;timestamp&gt; and the system clock of the Relying Party, then Relying Party can accept (2.1) as the link's Trustworthiness Vector. Jump to step 6.)<a href="#section-4.2.5-8.2.2.2" class="pilcrow">¶</a>
</li>
                <li id="section-4.2.5-8.2.2.3">Assign the link a null Trustworthiness Vector.<a href="#section-4.2.5-8.2.2.3" class="pilcrow">¶</a>
</li>
              </ol>
</li>
          </ul>
<p id="section-4.2.5-9">(5.7) Assemble the Verifier B Trustworthiness Vector<a href="#section-4.2.5-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.5-10">
<li id="section-4.2.5-10.1">Copy Verifier A Trustworthiness Vector to Verifier B Trustworthiness Vector<a href="#section-4.2.5-10.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.2.5-10.2">Prune any Trustworthiness Claims the Relying Party doesn't accept from this Verifier.<a href="#section-4.2.5-10.2" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="step-6">
<section id="section-4.2.6">
          <h4 id="name-step-6">
<a href="#section-4.2.6" class="section-number selfRef">4.2.6. </a><a href="#name-step-6" class="section-name selfRef">Step 6</a>
          </h4>
<p id="section-4.2.6-1">After the Trustworthiness Vector has been validated or reset, based on the link's Trustworthiness Vector, the Relying Party adjusts the link affinity of the corresponding ISIS <span>[<a href="#I-D.ietf-lsr-flex-algo" class="xref">I-D.ietf-lsr-flex-algo</a>]</span> topology.  ISIS will then replicate the link state across the IGP domain.  Traffic will then avoid links which do not have a qualifying Trustworthiness Vector.<a href="#section-4.2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="YANG-Module">
<section id="section-5">
      <h2 id="name-yang-module">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-yang-module" class="section-name selfRef">YANG Module</a>
      </h2>
<p id="section-5-1">This YANG module imports modules from <span>[<a href="#RATS-YANG" class="xref">RATS-YANG</a>]</span>, <span>[<a href="#crypto-types" class="xref">crypto-types</a>]</span> and <span>[<a href="#RFC6021" class="xref">RFC6021</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="section-5-2">
<pre class="lang-YANG sourcecode">
&lt;CODE BEGINS&gt; ietf-trustworthiness-claims@2021-11-03.yang
module ietf-trustworthiness-claims {
  yang-version 1.1;
  namespace
   "urn:ietf:params:xml:ns:yang:ietf-trustworthiness-claims";
  prefix tc;

  import ietf-yang-types {
    prefix yang;
  }
  import ietf-tcg-algs {
    prefix taa;
    reference
      "draft-ietf-rats-yang-tpm-charra";
  }
  import ietf-tpm-remote-attestation {
    prefix tpm;
    reference
      "draft-ietf-rats-yang-tpm-charra";
  }

  organization "IETF";
  contact
    "WG Web:   &lt;http://tools.ietf.org/wg/rats/&gt;
     WG List:  &lt;mailto:rats@ietf.org&gt;

     Editor:   Eric Voit
               &lt;mailto:evoit@cisco.com&gt;";

  description
    "This module contains conceptual YANG specifications for
    subscribing to attestation streams being generated from TPM chips.

    Copyright (c) 2020 IETF Trust and the persons identified as
    authors of the code.  All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, is permitted pursuant to, and subject to the license
    terms contained in, the Simplified BSD License set forth in
    Section 4.c of the IETF Trust's Legal Provisions Relating to IETF
    Documents (https://trustee.ietf.org/license-info).

    This version of this YANG module is part of RFC XXXX; see the RFC
    itself for full legal notices.";

  revision 2021-11-03 {
    description
      "Initial version.";
    reference
      "draft-voit-rats-trustworthy-path-routing";
  }


  /*
   * TYPEDEF
   */

  typedef trustworthiness-claim {
    type int8;
    description
      "A Verifier asserted value designed to enable a common
      understanding of a Verifier trustworthiness appraisal.  The
      value assignments for this 8 bit signed integer will follow
      these guidelines:

      Affirming: The Verifier affirms the Attester support for this
      aspect of trustworthiness
        - Values 2 to 31: A standards enumerated reason for affirming.
        - Values -2 to -32: A non-standard reason for affirming.

      Warning: The Verifier warns about this aspect of trustworthiness.
        - Values 32 to 63: A standards enumerated reason for the
          warning.
        - Values -33 to -64: A non-standard reason for the warning.

      Contraindicated: The Verifier asserts the Attester is explicitly
      untrustworthy in regard to this aspect.
        - Values 64 to 127: A standards enumerated reason for the
          contraindication.
        - Values -65 to -128: A non-standard reason for the
          contraindication.

      None: The Verifier makes no assertions about this Trustworthiness
      Claim.  The following values are reserved with the following
      meanings across all instances of trustworthiness-claim.
        - Value 0: Note: this should always be always treated
          equivalently by the Relying Party as no claim being made.
          I.e., the RP's Appraisal Policy for Attestation Results
          SHOULD NOT make any distinction between a Trustworthiness
          Claim with enumeration '0', and no Trustworthiness Claim
          being provided.
        - Value 1: The Evidence received contains unexpected elements
          which the Verifier is unable to parse.  An example might be
          that the wrong type of Evidence has been delivered.
        - Value -1: An unexpected error occurred during the Verifier's
          appraisal processing. Note: while no claim is being made, the
          Relying Party MAY make a distinction between a
          Trustworthiness Claim with enumeration '-1', and no
          Trustworthiness Claim being provided.";
  }

  typedef hardware {
    type trustworthiness-claim;
    description
      "A Verifier has appraised any Attester hardware and firmware
      which are able to expose fingerprints of their identity and
      running code.

      The following are specific reserved values of hardware and
      the meanings of these reserved values:

      0: No assertion

      1: The Verifer cannot parse unexpected Evidence

      -1:Verifier malfunction

      2: An Attester has passed its hardware and/or firmware
         verifications needed to demonstrate that these are
         genuine/supported.

      32:An Attester contains only genuine/supported hardware and/or
         firmware, but there are known security vulnerabilities.

      96:Attester hardware and/or firmware is recognized, but its
         trustworthiness is contraindicated.

      97:A Verifier does not recognize an Attester's hardware or
         firmware, but it should be recognized.";
  }

  typedef instance-identity {
    type trustworthiness-claim;
    description
      "A Verifier has appraised an Attesting Environment's unique
      identity based upon private key signed Evidence which can be
      correlated to a unique instantiated instance of the Attester.
      (Note: this Trustworthiness Claim should only be generated if
      the Verifier actually expects to recognize the unique identity
      of the Attester.)

      The following are specific reserved values of instance-identity
      and the meanings of these reserved values:

      0: No assertion

      1: The Verifer cannot parse unexpected Evidence

      -1:Verifier malfunction

      2: The Attesting Environment is recognized, and the associated
         instance of the Attester is not known to be compromised.

      96:The Attesting Environment is recognized, and but its unique
         private key indicates a device which is not trustworthy.

      97:The Attesting Environment is not recognized; however the
         Verifier believes it should be.";
  }

  typedef executables {
    type trustworthiness-claim;
    description
      "A Verifier has appraised and evaluated relevant runtime files,
      scripts, and/or other objects which have been loaded into the
      Target environment's memory.

      The following are specific reserved values of executables and
      the meanings of these reserved values:

      0: No assertion

      1: The Verifer cannot parse unexpected Evidence

      -1:Verifier malfunction

      2: Only a recognized genuine set of approved executables,
         scripts, files, and/or objects have been loaded during
         and after the boot process.

      3: Only a recognized genuine set of approved executables have
         been loaded during the boot process.

      32:Only a recognized genuine set of executables, scripts, files,
         and/or objects have been loaded.  However the Verifier cannot
         vouch for a subset of these due to known bugs or other known
         vulnerabilities.

      33:Runtime memory includes executables, scripts, files, and/or
         objects which are not recognized.

      96:Runtime memory includes executables, scripts, files, and/or
         object which are contraindicated.

      99:Cryptographic validation of the Evidence has failed.";
  }

  typedef configuration {
    type trustworthiness-claim;
    description
      "A Verifier has appraised an Attester's configuration, and is
      able to make conclusions regarding the exposure of known
      vulnerabilities.

      The following are specific reserved values of configuration and
      the meanings of these reserved values:

      0: No assertion

      1: The Verifer cannot parse unexpected Evidence

      -1:Verifier malfunction

      2: The configuration is a known and approved config

      3: The configuration includes or exposes no known vulnerabilities

      32:The configuration includes or exposes known vulnerabilities

      64:The configuration is unsupportable as it exposes unacceptable
         security vulnerabilities.";
  }


  /*
   * GROUPINGS
   */

  grouping trustworthiness-vector {
    description
      "Allows the inclusion of a Trustworthiness Vector into
      other constructs.";
    container trustworthiness-vector {
      description
        "One or more Trustworthiness Claims assigned which expose the
        Verifiers evaluation of the Evidence associated with the
        AIK which signed as associated TPM Quote.";
      leaf hardware {
        type hardware;
        description
          "An 8 bit signed integter encoded per the typedef.";
      }
      leaf instance-identity {
        type instance-identity;
        description
          "An 8 bit signed integter encoded per the typedef.";
      }
      leaf executables {
        type executables;
        description
          "An 8 bit signed integter encoded per the typedef.";
      }
      leaf configuration {
        type configuration;
        description
          "An 8 bit signed integter encoded per the typedef.";
      }
    }
  }

  grouping verifier-evidence {
    description
      "Evidence generated by the Verifier.";
    leaf appraisal-timestamp {
      type yang:date-and-time;
      mandatory true;
      description
        "The timestamp of the Verifier's appraisal.  This can be used
        by a Relying Party to determine the freshness of the
        attestation results.";
    }
    leaf verifier-algorithm-type {
      type identityref {
        base taa:asymmetric;
      }
      mandatory true;
      description
        "Platform asymmetric algorithm used in the Verifier signature
        process.";
    }
    leaf verifier-signature {
      type binary;
      mandatory true;
      description
        "Signature of the Verifier across all the current objects in
        the attestation-results container except for 'verifier-
        signature' and 'verifier-certificate-keystore-ref'.
        This assumes CDDL encoding of the objects in the current
        order of this YANG model.";
    }
    leaf verifier-certificate-keystore-ref {
      type tpm:certificate-name-ref;
      mandatory true;
      description
        "A reference to a specific certificate to an asymmetric key
        in the Keystore for the Verifier which can be used to validate
        the 'verifier-signature'. Note that the
        'name' reference must be globally unique so that it can be
        read by the Relying Party in a way which identifies a
        specific Verifier.";
    }
  }

  grouping tpm20-cddl-attestation-results {
    description
      "Elements combined into a CDDL representation for TPM2.0.";
    uses trustworthiness-vector;
    list tpm20-pcr-selection {
      key "tpm20-hash-algo";
      description
        "Specifies the list of PCRs and Hash Algorithms used by the
        Verifier.";
      reference
        "https://www.trustedcomputinggroup.org/wp-content/uploads/
         TPM-Rev-2.0-Part-2-Structures-01.38.pdf  Section 10.9.7";
      uses tpm:tpm20-hash-algo;
      leaf-list pcr-index {
        type tpm:pcr;
        description
          "The numbers of the PCRs associated with the TPM2B_DIGEST.";
      }
    }
    leaf TPM2B_DIGEST {
      mandatory true;
      type binary;
      description
        "A hash of the latest PCR values (and the hash algorithm used)
        which have been returned from a Verifier for the selected PCRs
        identified within TPML_PCR_SELECTION.";
      reference
        "https://www.trustedcomputinggroup.org/wp-content/uploads/
        TPM-Rev-2.0-Part-2-Structures-01.38.pdf  Section 10.12.1";
    }
    leaf clock {
      mandatory true;
      type uint64;
      description
        "Clock is a monotonically increasing counter that advances
         whenever power is applied to a TPM2. The value of Clock is
         incremented each millisecond.";
      reference
        "https://www.trustedcomputinggroup.org/wp-content/uploads/
         TPM-Rev-2.0-Part-2-Structures-01.38.pdf  Section 10.11.2";
    }
    leaf reset-counter {
      mandatory true;
      type uint32;
      description
        "This counter increments on each TPM Reset.  The most common
        TPM Reset would be due to a hardware power cycle.";
      reference
        "https://www.trustedcomputinggroup.org/wp-content/uploads/
         TPM-Rev-2.0-Part-2-Structures-01.38.pdf  Section 10.11.3";
    }
    leaf restart-counter {
      mandatory true;
      type uint32;
      description
        "This counter shall increment by one for each TPM Restart or
        TPM Resume. The restartCount shall be reset to zero on a TPM
        Reset.";
      reference
        "https://www.trustedcomputinggroup.org/wp-content/uploads/
         TPM-Rev-2.0-Part-2-Structures-01.38.pdf  Section 10.11.4";
    }
    leaf safe {
      mandatory true;
      type boolean;
      description
        "This parameter is set to YES when the value reported in Clock
        is guaranteed to be unique for the current Owner. It is set to
        NO when the value of Clock may have been reported in a previous
        attestation or access.";
      reference
        "https://www.trustedcomputinggroup.org/wp-content/uploads/
        TPM-Rev-2.0-Part-2-Structures-01.38.pdf  Section 10.11.5";
    }
    leaf attester-certificate-name {
      mandatory true;
      description
        "The Attester is associated with these results.";
      type tpm:certificate-name-ref;
    }
    uses verifier-evidence;
  }

  grouping tpm12-cddl-attestation-results {
    description
      "Elements combined into a CDDL representation for TPM1.2.";
    uses trustworthiness-vector;
    uses tpm:tpm12-pcr-selection;
    leaf-list tpm12-pcr-value {
      type binary;
      description
        "The list of TPM_PCRVALUEs from each PCR selected in sequence
        of tpm12-pcr-selection.";
      reference
        "https://www.trustedcomputinggroup.org/wp-content/uploads/
         TPM-Main-Part-2-TPM-Structures_v1.2_rev116_01032011.pdf
         Section 10.9.7";
    }
    uses tpm:tpm12-hash-algo {
      refine "tpm12-hash-algo" {
        mandatory true;
      }
    }
    leaf TPM12-quote-timestamp {
      type yang:date-and-time;
      mandatory true;
      description
        "The timestamp for when the indicator of freshness (such as a
        nonce) was generated.  This is the indicator of freshness
        which was used in the generation of the TPM1.2 quote.  This
        timestamp can be used by a Relying Party to determine the
        freshness of the attestation results.";
    }
    leaf attester-certificate-name {
      mandatory true;
      description
        "The Attester is associated with these results.";
      type tpm:certificate-name-ref;
    }
    uses verifier-evidence;
  }

  /*
   * NOTIFICATIONS
   */

  notification tpm20-stamped-passport {
    description
      "The augmentation of the most recent Attestation Results
      delivered from a Verifier with a TPM2.0 Quote.";
    container attestation-results {
      description
        "The latest Verifier delivered Attestation Results.";
      uses tpm20-cddl-attestation-results;
    }
    container tpm20-quote {
      description
        "The TPM2.0 quote delivered in response to a connectivity
        request.";
      leaf TPMS_QUOTE_INFO {
        type binary;
        mandatory true;
        description
          "A hash of the latest PCR values (and the hash algorithm
           used) which have been returned from a Verifier for the
           selected PCRs and Hash Algorithms.";
        reference
          "https://www.trustedcomputinggroup.org/wp-content/uploads/
           TPM-Rev-2.0-Part-2-Structures-01.38.pdf  Section 10.12.1";
      }
      leaf quote-signature {
        type binary;
        mandatory true;
        description
          "Quote signature returned by TPM Quote.  The signature was
           generated using the key associated with the
           certificate 'name'.";
        reference
          "https://www.trustedcomputinggroup.org/wp-content/uploads/
           TPM-Rev-2.0-Part-2-Structures-01.38.pdf  Section 11.2.1";
      }
    }
  }

  notification tpm12-stamped-passport {
    description
      "The augmentation of the most recent Attestation Results
      delivered from a Verifier with a TPM1.2 Quote.";
    container attestation-results {
      description
        "The latest Verifier delivered Attestation Results.";
      uses tpm12-cddl-attestation-results;
    }
    container tpm12-quote {
      description
        "The TPM1.2 quote delivered in response to a connectivity
        request.";
      leaf TPM_QUOTE2 {
        type binary;
        description
          "Result of a TPM1.2 Quote2 operation. This includes PCRs,
           signatures, locality, the provided nonce and other data which
           can be further parsed to appraise the Attester.";
        reference
          "TPM1.2 commands rev116 July 2007, Section 16.5";
      }
    }
  }

  /*
   * DATA NODES
   */

  container attestation-results {
    presence
      "Indicates that Verifier has appraised the security posture of
      the Attester, and returned the results within this container.";
    description
      "Retains the most recent Attestation Results for this Attester.
      It must only be written by a Verfier which is to be trusted by a
      Relying Party.";

    choice tpm-specification-version {
      description
        "Identifies the cryptoprocessor API set which drove the
        Attestation Results.";
      case tpm20-attestation-results-cddl {
        if-feature "taa:tpm20";
        description
          "Attestation Results which are returned from the
           evaluation of Evidence which includes a TPM2 quote.";
        container tpm20-attestation-results-cddl {
          description
            "Attestation Results which are returned from the
             evaluation of Evidence which includes a TPM2 quote.";
          uses tpm20-cddl-attestation-results;
        }
      }
      case tpm12-attestation-results-cddl {
        if-feature "taa:tpm12";
        description
          "Attestation Results which are returned from the
           evaluation of Evidence which includes a TPM1.2 quote.";
        container tpm12-attestation-results-cddl {
          description
            "Attestation Results which are returned from the
             evaluation of Evidence which includes a TPM1.2 quote.";
          uses tpm12-cddl-attestation-results;
        }
      }
    }
  }
}
&lt;CODE ENDS&gt;
</pre><a href="#section-5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations-3">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations-3" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">Verifiers are limited to the Evidence available for appraisal from a Router.   Although the state of the art is improving, some exploits may not be visible via Evidence.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Only security measurements which are placed into PCRs are capable of being exposed via TPM Quote at time(EG').<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Successful attacks on an Verifier have the potential of affecting traffic on the Trusted Topology.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">For Trusted Path Routing, links which are part of the FlexAlgo are visible across the entire IGP domain.  Therefore a compromised device will know when it is being bypassed.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">Access control for the objects in <a href="#fig-results-tree" class="xref">Figure 4</a> should be tightly controlled so that it becomes difficult for the Stamped Passport to become a denial of service vector.<a href="#section-6-5" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-references-2">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references-2" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references-3">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references-3" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="attestation-results">[attestation-results]</dt>
        <dd>
<span class="refTitle">"Attestation Results for Connectivity"</span>, <time datetime="2021-12-02" class="refDate">2 December 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-ietf-rats-ar4si/">https://datatracker.ietf.org/doc/draft-ietf-rats-ar4si/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="crypto-types">[crypto-types]</dt>
        <dd>
<span class="refTitle">"Common YANG Data Types for Cryptography"</span>, <time datetime="2021-12-17" class="refDate">17 December 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-ietf-netconf-crypto-types/">https://datatracker.ietf.org/doc/draft-ietf-netconf-crypto-types/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RATS-Arch">[RATS-Arch]</dt>
        <dd>
<span class="refTitle">"Remote Attestation Procedures Architecture"</span>, <time datetime="2022-02-08" class="refDate">8 February 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-ietf-rats-architecture/">https://datatracker.ietf.org/doc/draft-ietf-rats-architecture/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RATS-YANG">[RATS-YANG]</dt>
        <dd>
<span class="refTitle">"A YANG Data Model for Challenge-Response-based Remote Attestation Procedures using TPMs"</span>, <time datetime="2022-02-28" class="refDate">28 February 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-ietf-rats-yang-tpm-charra/">https://datatracker.ietf.org/doc/draft-ietf-rats-yang-tpm-charra/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6021">[RFC6021]</dt>
        <dd>
<span class="refAuthor">Schoenwaelder, J., Ed.</span>, <span class="refTitle">"Common YANG Data Types"</span>, <span class="seriesInfo">RFC 6021</span>, <span class="seriesInfo">DOI 10.17487/RFC6021</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6021">https://www.rfc-editor.org/info/rfc6021</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM1.2">[TPM1.2]</dt>
        <dd>
<span class="refAuthor">TCG</span>, <span class="refTitle">"TPM 1.2 Main Specification"</span>, <time datetime="2003-10-02" class="refDate">2 October 2003</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-main-specification/">https://trustedcomputinggroup.org/resource/tpm-main-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM2.0">[TPM2.0]</dt>
      <dd>
<span class="refAuthor">TCG</span>, <span class="refTitle">"TPM 2.0 Library Specification"</span>, <time datetime="2013-03-15" class="refDate">15 March 2013</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-library-specification/">https://trustedcomputinggroup.org/resource/tpm-library-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references-3">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references-3" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-lsr-flex-algo">[I-D.ietf-lsr-flex-algo]</dt>
        <dd>
<span class="refAuthor">Psenak, P.</span>, <span class="refAuthor">Hegde, S.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Talaulikar, K.</span>, and <span class="refAuthor">A. Gulko</span>, <span class="refTitle">"IGP Flexible Algorithm"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lsr-flex-algo-18</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-lsr-flex-algo-18.txt">https://www.ietf.org/archive/id/draft-ietf-lsr-flex-algo-18.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE-802.1X">[IEEE-802.1X]</dt>
        <dd>
<span class="refAuthor">Parsons, G.</span>, <span class="refTitle">"802.1AE: MAC Security (MACsec)"</span>, <time datetime="2020-01-01" class="refDate">1 January 2020</time>, <span>&lt;<a href="https://standards.ieee.org/standard/802_1X-2010.html">https://standards.ieee.org/standard/802_1X-2010.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MACSEC">[MACSEC]</dt>
        <dd>
<span class="refAuthor">Seaman, M.</span>, <span class="refTitle">"802.1AE: MAC Security (MACsec)"</span>, <time datetime="2006-01-01" class="refDate">1 January 2006</time>, <span>&lt;<a href="https://1.ieee802.org/security/802-1ae/">https://1.ieee802.org/security/802-1ae/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RATS-Device">[RATS-Device]</dt>
        <dd>
<span class="refTitle">"Network Device Remote Integrity Verification"</span>, <span>n.d.</span>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-ietf-rats-tpm-based-network-device-attest">https://datatracker.ietf.org/doc/draft-ietf-rats-tpm-based-network-device-attest</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RATS-Interactions">[RATS-Interactions]</dt>
        <dd>
<span class="refTitle">"Reference Interaction Models for Remote Attestation Procedures"</span>, <time datetime="2022-01-26" class="refDate">26 January 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models">https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3748">[RFC3748]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Carlson, J.</span>, and <span class="refAuthor">H. Levkowetz, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3748</span>, <span class="seriesInfo">DOI 10.17487/RFC3748</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3748">https://www.rfc-editor.org/info/rfc3748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="stream-subscription">[stream-subscription]</dt>
      <dd>
<span class="refTitle">"Attestation Event Stream Subscription"</span>, <time datetime="2021-10-16" class="refDate">16 October 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-ietf-rats-network-device-subscription/">https://datatracker.ietf.org/doc/draft-ietf-rats-network-device-subscription/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">Peter Psenak, Shwetha Bhandari, Adwaith Gautham, Annu Singh, Sujal Sheth, Nancy Cam Winget, and Ned Smith.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="change-log">
<section id="appendix-B">
      <h2 id="name-change-log">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<p id="appendix-B-1">[THIS SECTION TO BE REMOVED BY THE RFC EDITOR.]<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">v04-v05<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-3.1">Tweaks to text<a href="#appendix-B-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-3.2">Added text which was morphed from that provided by Meiling<a href="#appendix-B-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-4">v03-v04<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-5.1">YANG model updated in concert with draft-voit-rats-attestation-results as Trustworthiness Claim values are added.<a href="#appendix-B-5.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-6">v03-v04<a href="#appendix-B-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-7.1">Moved in concert with draft-voit-rats-attestation-results as Trustworthiness Claims became 8 bit signed integers.<a href="#appendix-B-7.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-8">v02-v03<a href="#appendix-B-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-9.1">Integrated <span>[<a href="#attestation-results" class="xref">attestation-results</a>]</span> as prerequisite context.<a href="#appendix-B-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-9.2">Totally rearranged content.  But there were not meaningful process changes.<a href="#appendix-B-9.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-9.3">Redid YANG model, and highlighted CDDL needs.<a href="#appendix-B-9.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-10">v01-v02<a href="#appendix-B-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-11.1">Minor tweaks such as renaming and removal of a few trustworthiness-claims<a href="#appendix-B-11.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-12">v00-v01<a href="#appendix-B-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-13.1">Minor tweaks<a href="#appendix-B-13.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-14">v02-v00 of draft-voit-rats-trustworthy-path-routing-00<a href="#appendix-B-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-15.1">file rename was due to an IETF tool submission glitch<a href="#appendix-B-15.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-15.2">The Attester's AIK is included within the Stamped Passport.  This eliminates the need to provision to AIK certificate on the Relying Party.<a href="#appendix-B-15.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-15.3">Removed Centralized variant<a href="#appendix-B-15.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-15.4">Added timing diagram, and moved content around to match<a href="#appendix-B-15.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-16">v01-v02 of draft-voit-rats-trusted-path-routing<a href="#appendix-B-16" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-17.1">Extracted the attestation stream, and placed into draft-birkholz-rats-network-device-subscription<a href="#appendix-B-17.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-17.2">Introduced the Trustworthiness Vector<a href="#appendix-B-17.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-18">v00-v01 of draft-voit-rats-trusted-path-routing<a href="#appendix-B-18" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-19.1">Move all FlexAlgo terminology to allow passport definition to be more generic.<a href="#appendix-B-19.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-19.2">Edited Figure 1 so that (4) points to the egress router.<a href="#appendix-B-19.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-19.3">Added text freshness mechanisms, and articulated configured subscription support.<a href="#appendix-B-19.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-19.4">Minor YANG model clarifications.<a href="#appendix-B-19.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-19.5">Added a few open questions which Frank thinks interesting to work.<a href="#appendix-B-19.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="open-questions">
<section id="appendix-C">
      <h2 id="name-open-questions">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-open-questions" class="section-name selfRef">Open Questions</a>
      </h2>
<p id="appendix-C-1">(1) When there is no available Trusted Topology?<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">Do we need functional requirements on how to handle traffic to/from Sensitive Subnets when no Trusted Topology exists between IGP edges?  The network typically can make this unnecessary.    For example it is possible to construct a local IPSec tunnel to make untrusted devices appear as Transparently-Transited Devices.  This way Secure Subnets could be tunneled between FlexAlgo nodes where an end-to-end path doesn't currently exist.  However there still is a corner case where all IGP egress points are not considered sufficiently trustworthy.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">(2) Extension of the Stamped Passport?<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<p id="appendix-C-4">Format of the reference to the 'verifier-certificate-name' based on WG desire to include more information in the Stamped Passport.  Also we need to make sure that the keystore referenced names are globally unique, else we will need to include a node name in the object set.<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<p id="appendix-C-5">(3) Encoding of objects in CDDL.  A Verifier will want to sign encoded objects rather than YANG structures.  It is most efficient to encode the Attestation Results once on the Verifier, and push these down via a YANG model to the Attester.<a href="#appendix-C-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses-3">
<a href="#name-authors-addresses-3" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Eric Voit</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">8135 Maple Lawn Blvd</span></div>
<div dir="auto" class="left">
<span class="locality">Fulton</span>, <span class="region">Maryland</span> <span class="postal-code">20759</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:evoit@cisco.com" class="email">evoit@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chennakesava Reddy Gaddam</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">Cessna Business Park, Kadubeesanahalli</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> <span class="postal-code">560103</span>
</div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:chgaddam@cisco.com" class="email">chgaddam@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Guy C. Fedorkow</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks</span></div>
<div dir="auto" class="left"><span class="street-address">10 Technology Park Drive</span></div>
<div dir="auto" class="left">
<span class="locality">Westford</span>, <span class="region">Massachusetts</span> <span class="postal-code">01886</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gfedorkow@juniper.net" class="email">gfedorkow@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div dir="auto" class="left"><span class="street-address">Rheinstrasse 75</span></div>
<div dir="auto" class="left">
<span class="postal-code">64295</span> <span class="locality">Darmstadt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@sit.fraunhofer.de" class="email">henk.birkholz@sit.fraunhofer.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Meiling Chen</span></div>
<div dir="auto" class="left"><span class="org">China Mobile</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:chenmeiling@chinamobile.com" class="email">chenmeiling@chinamobile.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
