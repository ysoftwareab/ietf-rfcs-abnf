
          Network Working Group                         Greg Vaudreuil
          Internet Draft                        Octel Network Services
          Expires: 6/1/95                            December 29, 1994


                          Enhanced Mail System Status Codes

                          <draft-ietf-notary-status-00.txt>



          1. Status of this Memo

          This document is an Internet-Draft.  Internet-Drafts are working
          documents of the Internet Engineering Task Force (IETF), its
          areas, and its working groups.  Note that other groups may also
          distribute working documents as Internet-Drafts.

          Internet-Drafts are draft documents valid for a maximum of six
          months and may be updated, replaced, or obsoleted by other
          documents at any time.  It is inappropriate to use Internet-
          Drafts as reference material or to cite them other than as "work
          in progress."

          To learn the current status of any Internet-Draft, please check
          the "1id-abstracts.txt" listing contained in the Internet- Drafts
          Shadow Directories on ds.internic.net (US East Coast),
          nic.nordu.net (Europe), ftp.isi.edu (US West Coast), or
          munnari.oz.au (Pacific Rim).Introduction

          2. Overview

          SMTP [RFC-821] error codes have been proposed as a base for use
          in delivery status notifications to indicate the full range of
          possible mail delivery errors.  Because SMTP does not indicate
          the full range of transport or system level errors, the set of
          codes was extended.  This extension has several limitations for
          which this proposal was created to avoid.

          SMTP provides about 12 useful codes for delivery reports.  The
          majority of the codes are protocol specific response codes such
          as the 354 response to the data command.  Each of the 12 useful
          codes are each overloaded to indicate several error conditions
          each.  SMTP suffers some scars from history, most notably the
          unfortunate damage to the reply code extension mechanism by
          uncontrolled use.  This proposal facilitates future extensibility
          by requiring the client to interpret unknown error codes
          according to the theory of codes while requiring servers to
          register new response codes.

          The theory of reply codes partitioned in the number space such a
          manner that the remaining available codes will not provide the
          space needed.  The most critical example is the existence of only
          5 remaining codes for mail system errors.  The mail system
          classification includes both host and mailbox error conditions.
          The remaining third digit space will be completely consumed as


          Internet Draft    Mail System Status Codes December 29, 1994


          needed to indicate MIME and media conversion errors and security
          system errors.

          A revision to the SMTP theory of reply codes to better distribute
          the error conditions in the number space will necessarily be
          incompatible with SMTP.  Further, consumption of the remaining
          reply-code number space for delivery notification reporting will
          reduce the available codes for new ESMTP extensions.

          The following proposal starts from the SMTP theory of reply
          codes.  It adopts the success, permanent error, and transient
          error semantics of the first value, with a further description
          and classification in the second.  This proposal re-distributes
          the classifications to better distribute the error conditions,
          such as separating mailbox from host errors.  The detail value
          has been separated by a period and replaced by a two digit
          integer.  This separation into an integer provides a virtually
          unbounded space for future growth as well as visually indicates
          that the codes is not SMTP.

             Status Codes          3. 

          This document defines a new set of status codes to report
          delivery status in the DSN. The syntax of the new status codes is
          defined as:

          Status-Code = 1*Digit "." 1*Digit "." 2*Digit

          The status codes are explicit enumeration's of each of the three
          fields.  The codes space defined is intended to be extensible
          only by standards track documents.  Mail system specific status
          codes should be mapped as closely to the standard status codes.
          Servers should send only defined, registered status codes. System
          specific system errors may be carried in the DSN via protocol
          specific extension fields.  Clients should preserve the
          extensibility of the code space by reporting the general error
          described in the second protocol digit when the specific detail
          is unrecognized.

          The first digit provides a broad classification of the status.
          The enumerated values of this first digit are defined as:

          Success (1)

          Success specifies that the DSN is reporting a positive delivery
          action.  Detail digits may provide notification of
          transformations required for delivery.

          Permanent Failure (2)

          A permanent failure is one which is not likely to be resolved by
          resending the message in the current form.  Some change to the
          message or the destination must be made for successful delivery.


          Vaudreuil              Expires 6/1/95               [Page  ]                                                                    2


          Internet Draft    Mail System Status Codes December 29, 1994


          Persistent Transient Failure (3)

          A persistent transient failure is one in which the message as
          sent is valid, but some temporary event prevents the successful
          sending of the message.  Sending in the future may be successful.

          A client must recognize and report based on the first digit even
          where subsequent digits are unrecognized.

          The second digit classifies the subject of the status.  This
          digit applies to each of the three classifications.  The second
          digit, if recognized, must be reported even if the additional
          detail provided by the third digit is not recognized.  The
          enumerated values for the second digit are:

          Other or undefined status (0)
          Addressing status (1)
          Mailbox status (2)
          System status (3)
          Network and Routing Status (4)
          Protocol Status (5)
          Message Content or Media Status (6)
          Security Status (7)

          The detail value provides greater detail about the status and is
          defined relative to the subject of the status as indicated by the
          second digit.

          The following section defines and describes the detail status
          code digits.

              Other or Undefined Status (0)            1           3.

          There is no additional detail available for other or undefined
          status codes.  Only the value "0" is defined.

          3.  Address Status (1)            2 

          The address status reports problems with the address specified.
          It may include address syntax or validity.

            2          3. .1 Other Address Status (1.0)

          Something about the address specified in the message caused this
          DSN.

             .2 Bad mailbox address (1.1)            2          3.

          The mailbox specified in the address does not exist.  For domain
          names, this means the address portion to the left of the "@" sign
          is invalid.  This code is only useful for permanent failures.




          Vaudreuil              Expires 6/1/95                     3]                                                              [Page 


          Internet Draft    Mail System Status Codes December 29, 1994


                Bad system address (1.2)            2.3           3.

          The destination system specified in the address does not exist or
          is incapable of accepting mail.  For domain names, this means the
          address portion to the right of the "@" is invalid for mail.
          This codes is only useful for permanent failures.

                Bad mailbox address syntax (1.3)            2.4           3.

          The address was syntactically invalid.  This can apply to any
          field in the address.  This code is only useful for permanent
          failures.

                Mailbox address ambiguous (1.4)             .5           3.2

          The mailbox address as specified matches one or more recipients
          on the destination system.  This may result if a heuristic
          address mapping algorithm is used to map the specified address to
          a local mailbox name.  This code is only useful for permanent
          failures.

              Mailbox Status (2)            3           3.

          Mailbox status indicates that something having to do with the
          mailbox has cause this DSN.  Mailbox issues are assumed to be
          under the general control of the individual recipient.

                Other or undefined mailbox status (2.0)            3.1           3.

          The mailbox exists, but something about the destination mailbox
          has cause the sending of this DSN.

            3   Mailbox disabled, not accepting messages (2.1)             .2           3.

          The mailbox exists, but is not accepting messages.  This may be a
          permanent error if the mailbox will never be re-enabled or a
          transient error if the mailbox is only temporarily disabled.

                Mailbox full (2.2)            3.3           3.

          The mailbox is full either because the user has exceeded an
          administrative quota or the dedicated physical resources have
          been exceeded.  The general semantics implies that the recipient
          can delete messages to make more space available. .  This code
          should be used as a persistent transient failure.

            3   Message length exceeds administrative limit (2.3)          3. .4 

          A per-mailbox administrative message length limit has been
          exceeded.  This status code should be used when the per-mailbox
          message length limit is less than the general system limit.  This
          code should be used as a permanent failure.



          Vaudreuil              Expires 6/1/95                     4]                                                              [Page 


          Internet Draft    Mail System Status Codes December 29, 1994


                Mailing list expansion problem (2.4)            3.5           3.

          The mailbox is a mailing list address, and the mailing list was
          unable to be expanded.  This code may represent a permanent
          failure or a persistent transient failure.

              System Status (3)          3.4 

          System status indicates that something having to do with the
          destination system has cause this DSN.  System issues are assumed
          to be under the general control of the system administrator.

             .1 Other or undefined system status (3.0)            4          3.

          The destination system exists and normally accepts mail, but is
          something about the system has caused the generation of this DSN.

                System full (3.1)             .2           3.4

          System storage has been exceeded.  The general semantics imply
          that the individual recipient may not be able to delete material
          to make room for additional messages.  This is useful only as a
          persistent transient error.

                System not accepting network messages (3.2)             .3           3.4

          The host on which the mailbox is resident is not accepting
          messages.  Examples of such conditions include an immanent
          shutdown or system maintenance.  This is useful for both
          permanent and permanent transient errors.

                System not capable of selected features (3.3)             .4             4          3.

          Selected message features specified for the message are not
          supported by the destination system.  This is useful only as a
          permanent error.

                Message too big for system (3.4)             .5             4          3.

          The message is larger than the system can handle, either for
          physical or administrative reasons.  This is useful only as a
          permanent error.

              Network and Routing Status (4)            5           3.

          The networking or routing codes report status about the delivery
          system itself, both the network and intermediate processing.

             .1             5          3.    Other or undefined network or routing status (4.0)

          Something went wrong with the networking, but it is not clear
          what the problem is, or the problem cannot be well expressed with
          any of the other provided detail codes.


          Vaudreuil              Expires 6/1/95                     5]                                                              [Page 


          Internet Draft    Mail System Status Codes December 29, 1994


                No answer from host (4.1)            5.2           3.

          The outbound connection attempt was not answered, either because
          the remote system was busy, or otherwise unable to take a call.
          This is useful only as a persistent transient error.

             .3 Bad connection (4.2)          3.5

          The outbound connection was completed, but was otherwise unable
          to complete the message transaction, either because of time-out,
          excessive packet loss, or inadequate quality. This is useful only
          as a persistent transient error.

                Routing server failure (4.3)             .4           3.5

          The network system was unable to determine the next hop for the
          message, because a nameserver was unavailable to resolve the
          address or provide a route.  This is useful only as a persistent
          transient error.

                Unable to route (4.4)             .5           3.5

          The network was unable to determine the next hop for the message
          because the necessary routing information was unavailable from
          the routing server. This is useful for both permanent and
          persistent transient errors.

                Network congestion (4.5)             .6           3.5

          The network or system was unable to deliver the message because
          the network was congested, or the queuing was overfilled. This is
          useful only as a persistent transient error.

          3.    Routing loop detected (4.6)            5.7 

          A routing loop caused the message to be forwarded too many times,
          either because of incorrect routing tables or a user forwarding
          loop. This is useful only as a persistent transient error.

          3. .8             5   Delivery time expired (4.7)

          The message was considered too old by the rejecting system,
          either because it remained on that host too long or because the
          TTL value specified by the sender of the message was exceeded.
          This is useful only as a persistent transient error.

            6           3.  Protocol Status (5)

            6          3.    Other or undefined protocol status (0)             .1 

          Something was wrong with the protocol necessary to deliver the
          message to the next hop and the problem cannot be well expressed
          with any of the other provided detail codes.


          Vaudreuil              Expires 6/1/95                     6]                                                              [Page 


          Internet Draft    Mail System Status Codes December 29, 1994


                Invalid command (5.1)            6.2           3.

          A command was issued which was either out of sequence or
          otherwise unsupported.  This is useful only as a permanent error.

          3.    Syntax error (5.2)            6.3 

          A command was issued which could not be interpreted, either
          because the syntax was wrong or the command was not supported.
          This is useful only as a permanent error.

             .4 Too many recipients (5.3)            6          3.

          More recipients were specified for the message than could have
          been delivered by the protocol.  This error should normally
          result in the segmentation of the message into two, the remainder
          of the recipients to be delivered on a subsequent delivery
          attempt.  It is included in this list in the event that such
          segmentation is not possible. This is useful only as a permanent
          error.

                Invalid command arguments (5.4)             .5             6          3.

          A valid command was issued with invalid arguments, either because
          the arguments were out of range or represented unrecognized
          features. This is useful only as a permanent error.

                Wrong protocol version (5.5)             .6           3.6

          A protocol version mis-match existed which could not be
          automatically resolved by downgrading one of the communicating
          parties.  This should never happen in ESMTP. This is useful only
          as a permanent error.

              Message Content or Media Status (6)          3.7 

            7   Other or undefined media error (6.0)             .1           3.

          Something about the content of a message caused it to be
          considered undeliverable and the problem cannot be well expressed
          with any of the other provided detail codes.

                Media not supported (6.1)            7.2           3.

          The media of the message is not supported by the either the
          delivery protocol or a host in the forwarding path. This is
          useful only as a permanent error.

            7   Conversion required and prohibited (6.2)             .3           3.

          The content of the message must be converted before it can be
          delivered and such conversion is not permitted.  Such
          prohibitions may be the expression of the sender in the message


          Vaudreuil              Expires 6/1/95               [Page  ]                                                                    7


          Internet Draft    Mail System Status Codes December 29, 1994


          itself or the policy of the sending host. This is useful only as
          a permanent error.

                Conversion required but not supported (6.3)            7.4           3.

          The message content must be converted to be forwarded but such
          conversion is not possible by a host in the forwarding path.
          This condition may result when a relay supports ESMTP transport
          but not MIME downgrade. This is useful only as a permanent error.

                Conversion with loss performed (4)            7.5           3.

          This is a warning sent to the sender when message delivery was
          successfully but when the delivery required a conversion in which
          some data was lost.  This is useful for successful notification.

              Security Status (7)            8           3.

             .1             8          3.    Other or undefined security status (7.0)

          Something related to security caused the message to be returned,
          and the problem cannot be well expressed with any of the other
          provided detail codes.

                Delivery not authorized, message refused (7.1)             .2           3.8

          The sender is not authorized to send to the destination.  This
          can be the result of per-host or per-recipient filtering.  This
          memo does not discuss the merits of any such filtering, but
          provides a mechanism to report such. This is useful only as a
          permanent error.

            8   Mailing list expansion prohibited (7.2)             .3           3.

          The sender is not authorized to send a message to the intended
          mailing list. This is useful only as a permanent error.

             .4             8          3.    Security conversion required but not possible (7.3)

          A conversion from one secure messaging protocol to another was
          required for delivery and such conversion was not possible. This
          is useful only as a permanent error.

            8   Security features not supported (7.4)             .5           3.

          A message contained security features such as secure
          authentication which could not be supported on the delivery
          protocol. This is useful only as a permanent error.

          3. .6 Cryptographic failure (7.5)            8

          A transport system otherwise authorized to validate or decrypt a
          message in transport was unable to do so because necessary


          Vaudreuil              Expires 6/1/95               [Page 8]


          Internet Draft    Mail System Status Codes December 29, 1994


          information such as key was not available or such information was
          invalid. This is useful only as a permanent error.

                Cryptographic algorithm not supported (7.6)            8.7           3.

          A transport system otherwise authorized to validate or decrypt a
          message was unable to do so because the necessary algorithm was
          not supported. This is useful only as a permanent error.

             .8 Message integrity failure (7.7)          3.8

          A transport system otherwise authorized to validate a message was
          unable to do so because the message was corrupted or altered.
          This may be useful as a permanent, transient persistent, or
          successful delivery code.

             References          4. 

          [RFC-821] Postel, J., "Simple Mail Transfer Protocol", STD 10,
          RFC 821, USC/Information Sciences Institute, August 1982.



             Security Consideration          5. 

          This document describes a status code system with increased
          precision.  Use of these status codes may disclose information
          about how an internal mail system is implemented beyond that
          currently available.

             Author's Address          6. 

          Gregory M. Vaudreuil
          Octel Network Services
          17060 Dallas Parkway
          Suite 214
          Dallas, TX 75248-1905
          214-733-2722
          Greg.Vaudreuil@ons.octel.com
















          Vaudreuil              Expires 6/1/95                     9]                                                              [Page 


          Internet Draft    Mail System Status Codes December 29, 1994


             Appendix - Collected Status Codes          7. 

          X.1.0     Other Address Status
          X.1.1     Bad mailbox address
          X.1.2     Bad system address
          X.1.3     Bad mailbox address syntax
          X.1.4     Mailbox address ambiguous

          X.2.0     Other or undefined mailbox status
          X.2.1     Mailbox disabled, not accepting messages
          X.2.2     Mailbox full
          X.2.3     Message length exceeds administrative limit.
          X.2.4     Mailing list expansion problem

          X.3.0     Other or undefined system status
          X.3.1     System full
          X.3.2     System not accepting network messages
          X.3.3     System not capable of selected features
          X.3.4     Message too big for system

          X.4.0     Other or undefined network or routing status
          X.4.1     No answer from host
          X.4.2     Bad connection
          X.4.3     Routing server failure
          X.4.4.    Unable to route
          X.4.5     Network congestion
          X.4.6     Routing loop detected
          X.4.7     Delivery time expired

          X.5.0     Other or undefined protocol status
          X.5.1     Invalid command
          X.5.2     Syntax error
          X.5.3     Too many recipients
          X.5.4     Invalid command arguments
          X.5.5     Wrong protocol version

          X.6.0     Other or undefined media error
          X.6.1     Media not supported
          X.6.2     Conversion required and prohibited
          X.6.3     Conversion required but not supported
          X.6.4     Conversion with loss performed

          X.7.0     Other or undefined security status
          X.7.1     Delivery not authorized, message refused
          X.7.2     Mailing list expansion prohibited
          X.7.3     Security conversion required but not possible
          X.7.4     Security features not supported
          X.7.5     Cryptographic failure
          X.7.6     Cryptographic algorithm not supported
          X.7.7     Message integrity failure





          Vaudreuil              Expires 6/1/95                      ]                                                             [Page 10


          Internet Draft    Mail System Status Codes December 29, 1994


            1 Appendix - Existing SMTP Reply-Codes From RFC 821          7.

          211 System status, or system help reply
          214 Help message
              [Information on how to use the receiver or the meaning of a
              particular non-standard command; this reply is useful only
              to the human user]
          220 <domain> Service ready
          221 <domain> Service closing transmission channel
          250 Requested mail action okay, completed
          251 User not local; will forward to <forward-path>

          354 Start mail input; end with <CRLF>.<CRLF>

          421 <domain> Service not available,
              closing transmission channel
              [This may be a reply to any command if the service knows it
              must shut down]
          450 Requested mail action not taken: mailbox unavailable
              [E.g., mailbox busy]
          451 Requested action aborted: local error in processing
          452 Requested action not taken: insufficient system storage

          500 Syntax error, command unrecognized
              [This may include errors such as command line too long]
          501 Syntax error in parameters or arguments
          502 Command not implemented
          503 Bad sequence of commands
          504 Command parameter not implemented
          550 Requested action not taken: mailbox unavailable
              [E.g., mailbox not found, no access]
          551 User not local; please try <forward-path>
          552 Requested mail action aborted: exceeded storage allocation
          553 Requested action not taken: mailbox name not allowed
              [E.g., mailbox syntax incorrect]
          554 Transaction failed



















          Vaudreuil              Expires 6/1/95                      ]                                                             [Page 11

