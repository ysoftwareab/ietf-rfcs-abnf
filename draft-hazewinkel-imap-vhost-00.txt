





Internet Engineering Task Force                            H. Hazewinkel
INTERNET-DRAFT                                                     I.Net
Expires July 2003                                           January 2003


                          IMAP Virtual Hosting
                   draft-hazewinkel-imap-vhost-00.txt
                              January 2003





Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet- Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.


Copyright Notice

   Copyright (C) The Internet Society (2003).  All Rights Reserved.




Abstract

   This memo describes an extension to the IMAP protocol in order to
   enable virtual hosting. The concept of virtual hosting for HTTP is
   used and a new IMAP command is introduced to provide the virtual
   hosting feature.



H. Hazewinkel               Expires July 2003                   [Page 1]





Internet Draft            IMAP Virtual Hosting              January 2003


Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL  NOT",
   "SHOULD",  "SHOULD  NOT",  "RECOMMENDED", "MAY",  and  "OPTIONAL"  in
   this  document  are  to  be interpreted as described in [RFC2119].


Introduction

   The Internet Message Access Protocol (IMAP) [IMAP4] allows a client
   to access and manipulate electronic mail messages on a server. IMAP
   defines a transparent  protocol as if remote mailboxes are local
   mailboxes.

   This document proposes a virtual hosting command, VHOST, for IMAP.
   Such a command would identify a session as part of a FQDN in a multi-
   domain environment. the concept of virtual hosting is taken from the
   HTTP protocol [HTTP] and is application in IMAP is similar.

   For example, a generic IMAP server runs under the hostname
   imap.example.com, but serves IMAP for the virtual hosts imap.example-
   a.com and imap.example-b.com. Currently, username must be or
   identified with the inclusion of their domain name otherwise
   usernames from one domain may not exist in the other domain.

   The VHOST command would enable to provide a separation of the domain
   name from the username. The VHOST command, which should be given
   before the AUTH or LOGIN command, identifies the applicable domain
   name for the IMAP session and the username does not require the
   domain name anymore.


VHOST command

   The VHOST command indicates the domain (virtual host) for the
   following sessions. The domain name is specified by the one and only
   argument. This command may only be given in the 'Non-Authenticated'
   state.

   Arguments: virtual host that MUST be identified and is applicable for
   the following session or authenticated user.

   Response: no specific response for this command, but see 'Result'

   Result:   OK  - virtual host identification completes and
                   an IMAP service is provided.
             NO  - the server does not know this virtual host or the
                   service for this virtual host is temporarely



H. Hazewinkel               Expires July 2003                   [Page 2]





Internet Draft            IMAP Virtual Hosting              January 2003


                   unavailable.
             BAD - command unknown or arguments invalid, no virtual
                   host applicable.

   The IMAP server MUST respond with an 'OK' if it provides services for
   the specified virtual host. The following commands are then all done
   within the domain to which the virtual host belongs.

   The IMAP server MUST respond with a 'NO" if it is not able to
   identify the virtual host. The following session or commands are not
   provided as in the domain of the virtual host specified.

   The IMAP server MAY respond with a 'NO' if it is not able to provide
   services for the virtual host in case the service is temporarily is
   not available. Such an action of the server may be caused by, for
   instance, a not available message store. The following session or
   commands are not provided as in the domain of the virtual host
   specified.

   The IMAP server MUST respond with a BAD in case the request is
   received incorrect from the client.


Capability

   A server which supports the VHOST command MUST announce this in a
   CAPABILITY response with the keyword "VHOST". If this not specified a
   client SHOULD NOT use the VHOST command.


Formal Syntax

   Formal syntax is defined using ABNF [ABNF] as modified by [IMAP4].
   Non-terminals referenced but not defined below are as defined by
   [IMAP4].

   vhost_command = "VHOST" astring


Security Considerations

   No new security issues are recognized at this moment which are
   already in IMAP.


Other Considerations

   It is recognised that different domain names can also be done by



H. Hazewinkel               Expires July 2003                   [Page 3]





Internet Draft            IMAP Virtual Hosting              January 2003


   extending the <user identification> with the domain name. This
   creates a single level list of user identification in all the
   domains.

   A trade-off against a change in the state diagram on behalf of not
   changing the the AUTHENTICATE and LOGIN commands. This way the core
   IMAP specification does not require a change. Neither does it means
   that the VHOST command introduces new states or change state.  As a
   result of this, multiple VHOST commands could be given in sequence,
   but the last command always determines the virtual host for the
   following commands.

   The VHOST command could, for instance, provide a mechanism to enable
   a service not available in case of high load on a server.  In such a
   case the client does not receive an authentication or login error,
   but a message to wait some time in order to have the service
   available.


Editors' Addresses

      Harrie Hazewinkel
      I.Net
      via Darwin 85
      20019 Settimo Milanese (VA)
      Italy
      Phone: +39-02328631
      EMail: harrie@inet.it


Full Copyright statement.

   Copyright (C) The Internet Society (2003).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.




H. Hazewinkel               Expires July 2003                   [Page 4]





Internet Draft            IMAP Virtual Hosting              January 2003


   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE."


References

   [IMAP4] Crispin, M., "Internet Message Access Protocol - Version
   4rev1", RFC 2060, University of Washington, December 1996.

   [RFC2119] Bradner, "Key words for use in RFCs to Indicate
   Requirement Levels", RFC 2119, Harvard University, March 1997.

   [RFC2234] Crocker, Overell, "Augmented BNF for Syntax Specifications:
   ABNF", RFC 2234, Internet Mail Consortium, Demon Internet Ltd,
   November 1997.

   [HTTP] Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter,
   L., Leach, P. and T. Berners-Lee, "Hypertext Transfer Protocol, HTTP/1.1",
   RFC 2616, June 1999.

























H. Hazewinkel               Expires July 2003                   [Page 5]


