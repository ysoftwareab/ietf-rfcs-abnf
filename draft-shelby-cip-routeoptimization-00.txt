





INTERNET-DRAFT                                           Zach D. Shelby
                                                          Petri Mähönen
                                                     University of Oulu

                                                    Dionisios Gatzounas
                                                               Intracom

                                                   Alessandro Inzerilli
                                                            Ville Typpö
                                                        VTT Electronics

                                                              June 2001


                     Cellular IP Route Optimization
              <draft-shelby-cip-routeoptimization-00.txt>

Status of this Memo


   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet- Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.




Abstract


   This document introduces a technique for intra-domain route
   optimization.  This is applicable to both the Cellular IP [1] and
   Cellular IPv6 [2] proposals.  Appendix A is included showing text



Shelby, Gatzounas, Typpö, Inzerilli                             [Page 1]

INTERNET-DRAFT       Cellular IP Route Optimization            June 2001


   changes required to apply this to [2].



1. Introduction


   Traffic between mobile hosts within a wireless access IP network is
   an important consideration for the application of the CIP protocol.
   Currently in [1] and [2] there is a requirement that traffic must
   always be routed through the CIP gateway.  This is to retain routing
   cache consistency.

   In order to optimize the performance of these networks, a route
   optimization method is proposed here which is applicable to both Cel-
   lular IP and Cellular IPv6.  No new entities are added, and soft
   state routing is maintained throughout.  The optimization function is
   transparent to mobile hosts.

   A performance review of the technique is presented in [3]. The code
   can be downloaded from [4] for Linux.  Simulation code for OPNET may
   be available in the future. The basic performance result is as fol-
   lows (simulated). The number of hops taken on routes is less and the
   end-to-end delay of traffic across the network is lower. The perfor-
   mance gains rise as the percentage of intra-domain traffic is
   increased.



1.1. Applicability


   Applicable to all CIP and CIPv6 networks where Intra-domain traffic
   between mobile hosts is common and a multi-level hierarchy of routers
   is used.



1.2. New Architectural Entities


   None.









Shelby, Gatzounas, Typpö, Inzerilli                             [Page 2]

INTERNET-DRAFT       Cellular IP Route Optimization            June 2001


1.3. Terminology


   Crossover node
       Any node that maintains multiple downlink interfaces.

   Optimizing CIP node
       Closest common node between two Mobile Hosts used to perform the
       route optimization.

   Optimization teardown packet
       Packet sent in order to clear route optimization upon handoff. Sent
       from both downlink and uplink.

   Proxy route-update packet
       A control packet sent from an optimizing CIP node uplink towards the
       Gateway on behalf of a mobile host. The address of the mobile host
       is encoded in the Route Optimization control information field.

   Route Optimization
       Service performed by CIP node so that traffic takes the shortest
       route possible between two Mobile Hosts within the same CIP network.
       This traffic does not need to traverse the gateway.





2. Specification


   The requirement for routing all uplink traffic through the gateway,
   regardless of destination address is required for protocol con-
   sistency in CIP. However, in networks with a high level of intra-
   domain traffic, this can be a performance & congestion problem. In
   this document an optional uplink route optimization is proposed. This
   would be implemented only for active mobile hosts and in possible
   crossover nodes since any crossover node can potentially be the
   optimizing node between two communicating mobile hosts. Only one
   crossover node at any time performs route optimization for a single
   pair of communicating mobile hosts in the same Cellular IP network.
   Crossover nodes add a 6th criteria in their routing cache; The Tear-
   down Optimization (TO) flag. This TO flag is unset by default.

   When a crossover node receives a data packet from a downlink inter-
   face, it checks the downlink route cache for a mapping that
   corresponds to the packet's destination address. If a mapping is
   found without the Teardown-Optimization (TO) flag set, then route



Shelby, Gatzounas, Typpö, Inzerilli                             [Page 3]

INTERNET-DRAFT       Cellular IP Route Optimization            June 2001


   optimization is performed and the packet is relayed to the
   corresponding downlink interface. At the same time, a proxy route-
   update packet is sent to the gateway. The route optimization control
   field is added containing the IP address of the mobile host optimiza-
   tion is being performed for. While optimization is being performed,
   proxy route-update packets are sent uplink at a rate just faster than
   the route timeout. Uplink nodes then use this proxy route-update
   packet's route optimization control field to update route caches.
   When other traffic from that MH is forwarded uplink, this resets the
   timer for sending the next proxy route-update.  If no optimization is
   performed during one route-timeout period, then the sending of proxy
   update packets ceases (optimization ends).

   When an active mobile host performs a handoff to a new BS, it first
   must transmit an optimization teardown packet to the current BS. This
   packet does not erase the cache entry for this mobile host at each
   optimizing node. It only sets the TO flag of mappings making the
   mobile host "unavailable" to receive route-optimized data. Therefore,
   data can no longer be optimized to this host, but will be normally
   forwarded uplink. Upon receiving the optimization teardown packet,
   the optimizing node ceases to send proxy update packets for the
   corresponding mobile host.

   If this optimization teardown packet was lost on the wireless chan-
   nel, it would create a black out time of one route-timeout for the
   optimized traffic. To avoid this, an extra optimization teardown
   packet is also sent by the uplink crossover node of the old and new
   base stations. This is detailed in Appendix A: section 2.3.




3. Security Considerations


   The use of a proxy route-update message requires a security relation-
   ship between crossover nodes and the gateway. This is because update
   packets must be authenticated. This relationship is not problematic
   since both nodes are under a single administration.

   This draft imposes no other security concerns beyond that mentioned
   in [1] and [2].









Shelby, Gatzounas, Typpö, Inzerilli                             [Page 4]

INTERNET-DRAFT       Cellular IP Route Optimization            June 2001


Appendix A. Text changes to CIPv6 I-D [2]


(1.4 Protocol Overview)



   Paragraph 3:

   By default all IP packets transmitted by a mobile host are routed
   from the Base Station to the Gateway by hop-by-hop shortest path
   routing, regardless of the destination address. However, with route
   optimization being performed, IP traffic between two mobile hosts in
   the same CIP network is routed through the optimizing CIP node.



(2.2 Routing)


   Paragraph 1:

   Packets transmitted by mobile hosts are routed to the Gateway using
   shortest path hop-by-hop routing. However, if these packets are des-
   tined for another active mobile host in the same CIP network then
   routing is performed through the optimizing CIP node. Cellular IP
   nodes monitor these passing data packets and use them to create and
   update Route Cache mappings. These map mobile host IP addresses to
   Downlink neighbors of the Cellular IP node. Packets addressed to the
   mobile host are routed along the reverse path, on a hop-by-hop basis,
   by these Route Cache mappings.



(2.3 Handoff)


   Handoff is initiated by the mobile host.  As an active mobile host
   approaches a new Base Station, it transmits a route-update packet and
   redirects its packets from the old to the new Base Station.  It
   transmits also a route optimization teardown packet to the old Base
   Station. This packet will be routed uplink towards the gateway and
   will set the TO flag of corresponding mappings at each optimizing
   node, thus making the mobile host "unavailable" to receive any
   route-optimized data. The route-update packet will configure Route
   Caches along the way from the new Base Station to the Gateway.  (The
   paths leading to the old and new Base Stations may overlap.  In nodes
   where the two paths coincide, the route-update packet simply



Shelby, Gatzounas, Typpö, Inzerilli                             [Page 5]

INTERNET-DRAFT       Cellular IP Route Optimization            June 2001


   refreshes the old mapping and the handoff remains unnoticed.) In a
   node which is a crossover point between the old and new BSs there
   will already be an older cache entry for this MH on another inter-
   face. This older cache entry is removed and if the TO flag is not set
   (probably the teardown optimization sent through the old BS was lost)
   another route optimization teardown packet is sent downlink on that
   interface. This packet will be routed downlink following the MH's old
   cache mappings that have not yet been expired and will set the TO
   flag at each optimizing node. This assures that optimization is
   correctly ended upon handoff.

   An idle mobile host, moving to a new Base Station, transmits a
   paging-update packet only if the new Base Station is in a new Paging
   Area. During handoffs between Base Stations within the same Paging
   Area idle mobile hosts may remain silent, as paging is performed
   within the entire Paging Area.



(3.3.2. Route-Update packet)


   The following control option must be added:

   Route Optimization
       IP address of Mobile Host which route optimization is
       being performed for.




(3.3.5. Proxy route-update packet)


   A proxy route-update packet is an IPv6 packet with a Hop-by-Hop
   Options extension header where

   - the source address is the IP address of the sending optimizing CIP node;
   - the destination address is the Gateway; and
   - the Hop-by-Hop option is of proxy route-update type.

   The option of the proxy route-update packet carries control informa-
   tion in the same format as the route-update packet. The Route Optimi-
   zation control information field carries the address of the mobile
   host which route optimization is being performed for. The S and I
   flags must be 0 for proxy route-update packets.





Shelby, Gatzounas, Typpö, Inzerilli                             [Page 6]

INTERNET-DRAFT       Cellular IP Route Optimization            June 2001


(3.3.6. Route optimization teardown packet)


   A route optimization teardown packet is an IPv6 packet with a Hop-
   by-Hop Options extension header where the Hop-by-Hop option is of
   route optimization teardown type.

   If it is sent by a mobile host (uplink direction)

   - the source address is the IP address of the sending mobile host; and
   - the destination address is the Gateway;

   However, if it is sent by a node (downlink direction)

   - the source address is the address of the sending node; and
   - the destination address is the IP address of the mobile host that route
   optimization teardown is being performed for.

   The payload of the route optimization teardown packet carries control
   information in the same format as the route-update packet. The S, and
   I flags must be 0 for route optimization teardown packets. This
   packet is processed only by optimizing nodes.



(3.6.2 Uplink Routing)


   Paragraphs 1 and 2: A packet arriving at a node from one of its Down-
   link neighbors is assumed to be coming from a mobile host.  The
   packet is first used to update the node's Route and Paging Caches and
   is then forwarded to the node's Uplink neighbor. However, if the node
   is a crossover node, the route cache is searched for a mapping that
   corresponds to packet's destination address.

   To update the Caches, the node reads the packet type, port number and
   the source IP address.  Paging-update packets update the Paging Cache
   only.  Route-update packets update both Route and Paging Caches. Data
   packets only refresh the soft state of both caches, but do not change
   it.  Both types of caches consist of

   { IPv6 address, interface, MAC address, expiration time, timestamp }

   5-tuples, called mappings.  The Route Cache of crossover nodes con-
   tain an additional field being the Teardown Optimization (TO) flag.
   This TO flag is unset by default and is set each time a route optimi-
   zation teardown packet is received on either the uplink or downlink
   interface.  The IPv6 address is the address of the mobile host the



Shelby, Gatzounas, Typpö, Inzerilli                             [Page 7]

INTERNET-DRAFT       Cellular IP Route Optimization            June 2001


   mapping corresponds to.  The interface and the MAC address denote the
   Downlink neighbor toward the mobile host. The timestamp field con-
   tains the timestamp of the control packet that has established the
   mapping.


   Two additional paragraphs are needed before the last sentence: When a
   route-update packet arrives on a different downlink interface than
   that is in its mapping, a route optimization teardown packet is first
   sent on the interface that corresponds to the "old" mapping and then
   the caches are updated.

   When a route optimization teardown packet arrives on a downlink
   interface of an optimizing node then the authentication is first
   validated. For valid packets the node searches its Route Cache for a
   mapping that corresponds to packet's source address. If a mapping is
   found the TO flag is set.



(3.6.3 Downlink Routing)


   An additional paragraph is needed at the end:

   A route optimization teardown packet arriving at the uplink interface
   of an optimizing CIP node sets the TO flag of the mapping that
   corresponds to packet's destination address. Then the packet is for-
   warded to the corresponding downlink interface.  The CIP gateway is
   exempt from this function.




References



   [1] "Cellular IP," A. T. Campbell, J. Gomez, C-Y. Wan, S. Kim, Z.
       Turanyi, A. Valko, Work in Progress, <draft-ietf-mobileip-
       cellularip-00>, January 2000.

   [2] "Cellular IPv6," Z. D. Shelby, D. Gatzounas, A. T. Campbell, C-Y. Wan
       Turanyi, A. , Work in Progress, <draft-shelby-seamoby
       cellularipv6-00>, November 2000.

   [3] "Route Optimization for Cellular IP networks" D. Gatzounas A. Malataras,
       C. Chrisanthakopoulos, Z. Shelby, A. Inzerilli, IPCN' 2001, May 2001.



Shelby, Gatzounas, Typpö, Inzerilli                             [Page 8]

INTERNET-DRAFT       Cellular IP Route Optimization            June 2001


   [4] "Cellular IPv6 homepage" WINE project, <http://cipv6.intranet.gr>, June 2001.




Authors' Addresses


   Zach D. Shelby, Dr. Petri Mähönen
   University of Oil
   Center for Wireless Communications
   PO Box 4500
   90014 Oil, Finland
   phone: +358 40 779 6297
   email: zach.shelby@ee.oulu.fi

   Dionisios D. Gatzounas
   INTRACOM S.A.
   Development Programmes Department
   Panepistimiou 254
   26443  Patras
   GREECE
   phone: +30 61 465168
   fax: +30 61 465070
   email: dgat@intracom.gr

   Ville Typpö, Alessandro Inzerilli
   Technical Research Center of Finland
   Wireless Internet Laboratory
   Kaitoväylä 1
   FIN-90571   Oil,  Finland
   phone: +358 8 551 2164
   fax  : +358 8 551 2320
   email: ville.typpo@vtt.fi

















Shelby, Gatzounas, Typpö, Inzerilli                             [Page 9]

INTERNET-DRAFT       Cellular IP Route Optimization            June 2001


   Table of Contents

1. Introduction ...................................................    2
1.1. Applicability ................................................    2
1.2. New Architectural Entities ...................................    2
1.3. Terminology ..................................................    3
2. Specification ..................................................    3
3. Security Considerations ........................................    4
Appendix A. Text changes to CIPv6 I-D [2] .........................    5
(1.4 Protocol Overview) ...........................................    5
(2.2 Routing) .....................................................    5
(2.3 Handoff) .....................................................    5
(3.3.2. Route-Update packet) ......................................    6
(3.3.5. Proxy route-update packet) ................................    6
(3.3.6. Route optimization teardown packet) .......................    7
(3.6.2 Uplink Routing) ............................................    7
(3.6.3 Downlink Routing) ..........................................    8
References ........................................................    8
Authors' Addresses ................................................    9
































Shelby, Gatzounas, Typpö, Inzerilli                            [Page 10]
