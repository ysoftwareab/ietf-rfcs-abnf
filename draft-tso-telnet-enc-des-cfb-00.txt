
Network Working Group                                    T. Ts'o, Editor
Internet-Draft                     Massachusetts Institute of Technology
draft-tso-telnet-enc-des-cfb-00.txt                        February 1998


             Telnet Encryption: DES 64 bit Cipher Feedback

Status of this Memo

   This document is an Internet-Draft.  Internet-Drafts are working
   documents of the Internet Engineering Task Force (IETF), its areas,
   and its working groups.  Note that other groups may also distribute
   working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet- Drafts as reference
   material or to cite them other than as "work in progress."

   To view the entire list of current Internet-Drafts, please check the
   "1id-abstracts.txt" listing contained in the Internet-Drafts Shadow
   Directories on ftp.is.co.za (Africa), ftp.nordu.net (Europe),
   munnari.oz.au (Pacific Rim), ds.internic.net (US East Coast), or
   ftp.isi.edu (US West Coast).

1.  Command Names and Codes

   Encryption Type

      DES_CFB64        1

   Suboption Commands

      CFB64_IV         1
      CFB64_IV_OK      2
      CFB64_IV_BAD     3
      CFB64_CHALLENGE  4
      CFB64_RESPONSE   5


2.  Command Meanings

   IAC SB ENCRYPT IS DES_CFB64 CFB64_IV <initial vector> IAC SE

      The sender of this command generates a random 8 byte initial vec-
      tor, and sends it to the other side of the connection using the



                          Expires August 1998                   [Page 1]

Internet-Draft         DES 64 bit Cipher Feedback          February 1998


      CFB64_IV command.  The initial vector is sent in clear text.  Only
      the side of the connection that is WILL ENCRYPT may send the
      CFB64_IV command.

   IAC SB ENCRYPT REPLY DES_CFB64 CFB64_IV_OK IAC SE
   IAC SB ENCRYPT REPLY DES_CFB64 CFB64_IV_BAD IAC SE

      The sender of these commands either accepts or rejects the initial
      vector received in a CFB64_IV command.  Only the side of the con-
      nection that is DO ENCRYPT may send the CFB64_IV_OK and
      CFB64_IV_BAD commands.

3.  Implementation Rules

   Once a CFB64_IV_OK command has been received, the WILL ENCRYPT side
   of the connection should do keyid negotiation using the ENC_KEYID
   command.  Once the keyid negotiation has successfully identified a
   common keyid, then START and END commands may be sent by the side of
   the connection that is WILL ENCRYPT.  Data will be encrypted using
   the DES 64 bit Cipher Feedback algorithm.

   If encryption (decryption) is turned off and back on again, and the
   same keyid is used when re-starting the encryption (decryption), the
   intervening clear text must not change the state of the encryption
   (decryption) machine.

   If a START command is sent (received) with a different keyid, the en-
   cryption (decryption) machine must be re-initialized immediately fol-
   lowing the end of the START command with the new key and the initial
   vector sent (received) in the last CFB64_IV command.

   If a new CFB64_IV command is sent (received), and encryption (decryp-
   tion) is enabled, the encryption (decryption) machine must be re-
   initialized immediately following the end of the CFB64_IV command
   with the new initial vector, and the keyid sent (received) in the
   last START command.

   If encryption (decryption) is not enabled when a CFB64_IV command is
   sent (received), the encryption (decryption) machine must be re-
   initialized after the next START command, with the keyid sent (re-
   ceived) in that START command, and the initial vector sent (received)
   in this CFB64_IV command.

4.  Algorithm

   Given that V[i] is the initial 64 bit vector, V[n] is the nth 64 bit
   vector, D[n] is the nth chunk of 64 bits of data to encrypt (de-
   crypt), and O[n] is the nth chunk of 64 bits of encrypted (decrypted)
   data, then:




                          Expires August 1998                   [Page 2]

Internet-Draft         DES 64 bit Cipher Feedback          February 1998


      V[0] = DES(V[i], key)
      O[n] = D[n] <exclusive or> V[n]
      V[n+1] = DES(O[n], key)


Author's Address

   Theodore Ts'o, Editor
   Massachusetts Institute of Technology
   MIT Room E40-343
   77 Massachusetts Ave.
   Cambridge, MA 02139

   Phone: (617) 253-8091

   EMail: tytso@mit.edu





































                                                                [Page 3]



