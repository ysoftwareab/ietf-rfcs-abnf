<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Mitigating Neighbor Discovery Based Denial of Service Attacks</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Problem Summary and Solution Approach">
<link href="#rfc.section.4" rel="Chapter" title="4 Basic Behavior">
<link href="#rfc.section.5" rel="Chapter" title="5 Protocol Enhancements">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="It has been observed that with the large space of IPv6 addresses within a subnet, remote attackers can send packets that saturate a rotuers ND cache, and potentially saturate a subnet with ND Soliciation messages as well.  Some operational techniques and small protocol adjustments have been proposed that can help alleviate this problem.  This draft proposes a slightly more drastic optional behavior for routers, which can nearly eliminate this problem.  " />
  <meta name="description" content="It has been observed that with the large space of IPv6 addresses within a subnet, remote attackers can send packets that saturate a rotuers ND cache, and potentially saturate a subnet with ND Soliciation messages as well.  Some operational techniques and small protocol adjustments have been proposed that can help alleviate this problem.  This draft proposes a slightly more drastic optional behavior for routers, which can nearly eliminate this problem.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">6Man</td>
<td class="right">J.M.H. Halpern</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Ericsson</td>
</tr>
<tr>
<td class="left">Expires: April 19, 2012</td>
<td class="right">October 17, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Mitigating Neighbor Discovery Based Denial of Service Attacks<br />
  <span class="filename">draft-halpern-6man-nddos-mitigation-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>It has been observed that with the large space of IPv6 addresses within a subnet, remote attackers can send packets that saturate a rotuers ND cache, and potentially saturate a subnet with ND Soliciation messages as well.  Some operational techniques and small protocol adjustments have been proposed that can help alleviate this problem.  This draft proposes a slightly more drastic optional behavior for routers, which can nearly eliminate this problem.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 19, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Problem Summary and Solution Approach</a>
</li>
<li>4.   <a href="#rfc.section.4">Basic Behavior</a>
</li>
<li>5.   <a href="#rfc.section.5">Protocol Enhancements</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">It has been observed that with the large space of IPv6 addresses within a subnet, remote attackers can send packets that saturate a routers ND cache, and potentially saturate a subnet with ND Soliciation messages as well.  A thorough description of the problem can be found in <a href="#ndproblem">[ndproblem]</a>.  Some operational techniques and small protocol adjustments have been proposed that can help alleviate this problem are described in <a href="#ndenhance">[ndenhance]</a>.  This draft proposes a slightly more drastic optional behavior for routers, which can nearly eliminate this problem.  </p>
<p id="rfc.section.1.p.2">While the basic behavior described here can be looked upon as a local matter, there are robustness issues if a router applies this solution on its own.  Therefore, additional enhancements to the basic ND protocol behavior as defined in <a href="#RFC4861">[RFC4861]</a> are specified in this document.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p id="rfc.section.2.p.1">The terminology here follows that defined in <a href="#RFC4861">[RFC4861]</a></p>
<p id="rfc.section.2.p.2">The keywords MUST, MUST NOT, REQUIRED, SHALL, SHALL NOT, SHOULD, HOULD NOT, RECOMMENDED, MAY, and OPTIONAL, when they appear in this document, are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Problem Summary and Solution Approach</h1>
<p id="rfc.section.3.p.1">The basic problem under discussion is the ability for a remote attacker to fill a routers neighbor cache with unresolved, and unresolvable, entries.  If done at a sufficient rate, this may prevent the router from maintaining the necessaary entries for actually reaching the hosts on a subnet the router directly serves.  Depending upon circumstances, the rate of Neighbor Soliciations messages on the subnet may be high enough to casue difficulties, since these are multicast messages.  </p>
<p id="rfc.section.3.p.2">An attacker causes this problem by sending IPv6 datagrams addressed to distinct hypothetical nonexistant host systems on the subnet.  the attacker sends these messages continusously.  The router receives these messasges, and as specified in <a href="#RFC4861">[RFC4861]</a> it generates Neighbor solicitation emssages for each unknown destination, and creates INCOMPLETE Neighbor cache entries for each one.  The attacker can use random destination addresses, or even sequential addresses and count on passing the actual hosts quickly.  With IPv4, this problem could be coped with in most cases by simply having a table large enough for all the values in the subnet.  With IPv6, which reommends subnets be /64s, such sizing is no longer possible.  </p>
<p id="rfc.section.3.p.3">This proposals asks the question, what if the router never accepts packets for unknown hosts on local subnets?  In such a case, it would never create INCOMPLETE cache entries, and would never generate Neighbor Solicitation messages based upon received traffic.  Instead of soliciating such information, the router would learn of the hosts (and neighboring routers) on the subnet from received information.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Basic Behavior</h1>
<p id="rfc.section.4.p.1">The basic operational model for the router is still that it maintains a neighbor cache with IPv6-&gt;Media address resolution information.  It populates this cache upon receiving Rotuer Solicitation or Neighbor Advertisement messages from hosts on the subnet.  </p>
<p id="rfc.section.4.p.2">It is still important thaat the router be able to tell whether hosts are still reachable.  As such, routers should assign lifetime information to this ifnormation.  As the lifetime approaches, rather than discarding the information, the rotuer can issue a Neighbor Soliciation message to revalidate the information.  In the absence of a response, such revalidaiton should be attempted several times.   On links were power consumption is a significant issue, it may make sense to simply keep the neighbor cache information without expiration or revalidation.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Protocol Enhancements</h1>
<p id="rfc.section.5.p.1">While the above description prevents the attack of concern, it has several failure modes.  In particular, if a rotuer comes up after a subnet is operational, it will not learn the necessary information.  Also, it would seem desirable to provide additional robustness in the learning process, in case too many messages get lost.  </p>
<p id="rfc.section.5.p.2">There are three protocol enhancements that can be used to help this problem.  The first mechanism, which has also been proposed for other reasosn, is simply for all hosts on the subnet to keep sending Router Solicitation messages, rather than ceasing after only three transmissions.  The rate of sending could be reduced.  The message load on the subnet would not be excessive.  One might want to adjust the router response to such messages, allowing the router to simply maintain the steady rate of advertisement.  This would ensure the router learned of all the hosts on the network in a reasoanble time even if there were unexpected behaviors (partition repair at the link level, for example) which would otherwise interfere.  </p>
<p id="rfc.section.5.p.3">As a variation on the above, one could deefine a "please respond" flag in the Router Advertisement, whcih the routers could set tointermittently to refresh information.  As the repeated Router Solicitiations address other issues as well, that seems preferred.  </p>
<p id="rfc.section.5.p.4">While the above enhancement would be sufficient to ensure robustness, it is desirable to be able to deploy this solution before all the hsots on the subnet are upgraded to exhibit that behavior.  As such, other robustness techniques are recommended.  These approaches rely on the fact that the primary problem occurs when a new router joins an active subnet with an already active serving router providing the same prefix the new router would provide.</p>
<p id="rfc.section.5.p.5">One thing the existing router could do, which would provided the needed robustness, is to cause all the hsots it knows about to send new Neighbor Advertisements.  It can do this by sending each host a Neghbor soliciation with a source address of the unspecified address.  This will cause the host to multicast the Neghbor Advertisement it responds with.  </p>
<p id="rfc.section.5.p.6">One may consider that the message exchanges of such a triggering and responding sequence is excessive.  As a fall-back, one could easily define an exchange protocol by which an operational router on the subnet could send its neighbor cache to the new router.  As this is more complex, more detailed work on that is deferred until it is deemed necessary.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> IANA Considerations</h1>
<p id="rfc.section.6.p.1">There are currently no IANA considerations or assignments in this document.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Security Considerations</h1>
<p id="rfc.section.7.p.1">There are presumably security implications of this behavioral change, but they have not been evaluated yet.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4861">[RFC4861]</b></td>
<td class="top">
<a>Narten, T.</a>, <a>Nordmark, E.</a>, <a>Simpson, W.</a> and <a>H. Soliman</a>, "<a href="http://tools.ietf.org/html/rfc4861">Neighbor Discovery for IP version 6 (IPv6)</a>", RFC 4861, September 2007.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="ndproblem">[ndproblem]</b></td>
<td class="top">
<a>Kumari, W</a>, <a>Gashinsky, I</a> and <a>J Jaegglie</a>, "<a>I-D.gashinsky-v6ops-v6nd-problems-00.txt</a>", 2011.</td>
</tr>
<tr>
<td class="reference"><b id="ndenhance">[ndenhance]</b></td>
<td class="top">
<a>Kumari, W</a>, <a>Gashinsky, I</a> and <a>J Jaegglie</a>, "<a>I-D.gashinsky-v6nd-enhance-00.txt</a>", October 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Joel M. Halpern</span> 
	  <span class="n hidden">
		<span class="family-name">Halpern</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  <span>P. O. Box 6049</span>

	  <span class="vcardline">
		<span class="locality">Leesburg</span>,  
		<span class="region">VA</span> 
		<span class="code">20178</span>
	  </span>
	  <span class="country-name vcardline">US</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:joel.halpern@ericsson.com">joel.halpern@ericsson.com</a></span>

  </address>
</div>

</body>
</html>