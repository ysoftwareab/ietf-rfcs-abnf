<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>MPLS-TP Linear Protection</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Protection architectures">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Scope of the document">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Contributing authors">
<link href="#rfc.section.2" rel="Chapter" title="2 Conventions used in this document">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Acronyms">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Definitions and Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Protection switching control logic">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Local Request Logic">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Remote Requests">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 PSC Control Logic">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 PSC Message Generator">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Wait-to-Restore (WTR) timer">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 PSC Control States">
<link href="#rfc.section.3.6.1" rel="Chapter" title="3.6.1 Local and Remote state">
<link href="#rfc.section.4" rel="Chapter" title="4 Protection state coordination (PSC) protocol">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Transmission and acceptance of PSC control packets">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Protocol format">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 PSC Ver field">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 PSC Request field">
<link href="#rfc.section.4.2.3" rel="Chapter" title="4.2.3 Protection Type (PT)">
<link href="#rfc.section.4.2.4" rel="Chapter" title="4.2.4 Revertive (R) field">
<link href="#rfc.section.4.2.5" rel="Chapter" title="4.2.5 Fault path (FPath) field">
<link href="#rfc.section.4.2.6" rel="Chapter" title="4.2.6 Data path (Path) field">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Principles of Operation">
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 Basic operation">
<link href="#rfc.section.4.3.2" rel="Chapter" title="4.3.2 Priority of inputs">
<link href="#rfc.section.4.3.3" rel="Chapter" title="4.3.3 Operation of PSC States">
<link href="#rfc.section.4.3.3.1" rel="Chapter" title="4.3.3.1 Normal State">
<link href="#rfc.section.4.3.3.2" rel="Chapter" title="4.3.3.2 Unavailable State">
<link href="#rfc.section.4.3.3.3" rel="Chapter" title="4.3.3.3 Protecting administrative state">
<link href="#rfc.section.4.3.3.4" rel="Chapter" title="4.3.3.4 Protecting failure state">
<link href="#rfc.section.4.3.3.5" rel="Chapter" title="4.3.3.5 Wait-to-restore state">
<link href="#rfc.section.4.3.3.6" rel="Chapter" title="4.3.3.6 Do-not-revert state">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The Transport Profile for Multiprotocol Label Switching (MPLS-TP) is being specified jointly by IETF and ITU-T. This document addresses the functionality described in the MPLS-TP Survivability Framework document " />
  <meta name="description" content="The Transport Profile for Multiprotocol Label Switching (MPLS-TP) is being specified jointly by IETF and ITU-T. This document addresses the functionality described in the MPLS-TP Survivability Framework document " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">S. Bryant, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">E. Osborne</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Cisco</td>
</tr>
<tr>
<td class="left">Expires: September 14, 2011</td>
<td class="right">N. Sprecher, Ed.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Nokia Siemens Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">A. Fulignoli, Ed.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Ericsson</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Y. Weingarten</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Nokia Siemens Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">March 13, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">MPLS-TP Linear Protection<br />
  <span class="filename">draft-ietf-mpls-tp-linear-protection-05.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The Transport Profile for Multiprotocol Label Switching (MPLS-TP) is being specified jointly by IETF and ITU-T. This document addresses the functionality described in the MPLS-TP Survivability Framework document <a href="#SurvivFwk">[SurvivFwk]</a> and defines a protocol that may be used to fulfill the function of the Protection State Coordination for linear protection, as described in that document.</p>
<p>This document is a product of a joint Internet Engineering Task Force (IETF) / International Telecommunications Union Telecommunications Standardization Sector (ITU-T) effort to include an MPLS Transport Profile within the IETF MPLS and PWE3 architectures to support the capabilities and functionalities of a packet transport network as defined by the ITU-T. </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 14, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Protection architectures</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Scope of the document</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Contributing authors</a>
</li>
<li>2.   <a href="#rfc.section.2">Conventions used in this document</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Acronyms</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Definitions and Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Protection switching control logic</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Local Request Logic</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Remote Requests</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">PSC Control Logic</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">PSC Message Generator</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Wait-to-Restore (WTR) timer</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">PSC Control States</a>
</li>
<li>3.6.1.   <a href="#rfc.section.3.6.1">Local and Remote state</a>
</li>
<li>4.   <a href="#rfc.section.4">Protection state coordination (PSC) protocol</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Transmission and acceptance of PSC control packets</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Protocol format</a>
</li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">PSC Ver field</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">PSC Request field</a>
</li>
<li>4.2.3.   <a href="#rfc.section.4.2.3">Protection Type (PT)</a>
</li>
<li>4.2.4.   <a href="#rfc.section.4.2.4">Revertive (R) field</a>
</li>
<li>4.2.5.   <a href="#rfc.section.4.2.5">Fault path (FPath) field</a>
</li>
<li>4.2.6.   <a href="#rfc.section.4.2.6">Data path (Path) field</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Principles of Operation</a>
</li>
<li>4.3.1.   <a href="#rfc.section.4.3.1">Basic operation</a>
</li>
<li>4.3.2.   <a href="#rfc.section.4.3.2">Priority of inputs</a>
</li>
<li>4.3.3.   <a href="#rfc.section.4.3.3">Operation of PSC States</a>
</li>
<li>4.3.3.1.   <a href="#rfc.section.4.3.3.1">Normal State</a>
</li>
<li>4.3.3.2.   <a href="#rfc.section.4.3.3.2">Unavailable State</a>
</li>
<li>4.3.3.3.   <a href="#rfc.section.4.3.3.3">Protecting administrative state</a>
</li>
<li>4.3.3.4.   <a href="#rfc.section.4.3.3.4">Protecting failure state</a>
</li>
<li>4.3.3.5.   <a href="#rfc.section.4.3.3.5">Wait-to-restore state</a>
</li>
<li>4.3.3.6.   <a href="#rfc.section.4.3.3.6">Do-not-revert state</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Acknowledgements</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The MPLS Transport Profile (MPLS-TP) <a href="#TPFwk">[TPFwk]</a> is a framework for the construction and operation of packet-switched transport networks based on the architectures for MPLS (<a href="#RFC3031">[RFC3031]</a> and <a href="#RFC3032">[RFC3032]</a>) and for Pseudowires (PWs) (<a href="#RFC3985">[RFC3985]</a> and <a href="#RFC5659">[RFC5659]</a>) and the requirements of <a href="#RFC5654">[RFC5654]</a>.</p>
<p id="rfc.section.1.p.2">Network survivability is the ability of a network to recover traffic delivery following failure, or degradation of network resources.  The MPLS-TP Survivability Framework <a href="#SurvivFwk">[SurvivFwk]</a> is a framework for survivability in MPLS-TP networks, and describes recovery elements, types, methods, and topological considerations, focusing on mechanisms for recovering MPLS-TP Label Switched Paths (LSPs).</p>
<p id="rfc.section.1.p.3">Linear protection in mesh networks &#8211; networks with arbitrary interconnectivity between nodes &#8211; is described in Section 4.7 of <a href="#SurvivFwk">[SurvivFwk]</a>.  Linear protection provides rapid and simple protection switching.  In a mesh network, linear protection provides a very suitable protection mechanism because it can operate between any pair of points within the network.  It can protect against a defect in an intermediate node, a span, a transport path segment, or an end-to-end transport path.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Protection architectures</h1>
<p id="rfc.section.1.1.p.1">Protection switching is a fully allocated survivability mechanism. It is fully allocated in the sense that the route and bandwidth of the protection path is reserved for a selected working path or set of working paths. It provides a fast and simple survivability mechanism, that allows the network operator to easily grasp the active state of the network, compared to other survivability mechanisms.</p>
<p id="rfc.section.1.1.p.2">As specified in the Survivability Framework document <a href="#SurvivFwk">[SurvivFwk]</a>, protection switching is applied to a protection domain. For the purposes of this document, we define the protection domain of a P2P LSP as consisting of two Label Edge Routers (LER) and the transport paths that connect them. For a P2MP LSP the protection domain includes the root (or source) LER, the destination (or sink) LERs, and the transport paths that connect them.</p>
<p id="rfc.section.1.1.p.3">In 1+1 unidirectional architecture as presented in <a href="#SurvivFwk">[SurvivFwk]</a>, a protection transport path is dedicated to the working transport path. Normal traffic is bridged (as defined in <a href="#RFC4427">[RFC4427]</a>)and fed to both the working and the protection paths by a permanent bridge at the source of the protection domain. The sink of the protection domain selects which of the working or protection paths to receive the traffic from, based on a predetermined criteria, e.g. server defect indication. When used for bidirectional switching the 1+1 protection architecture must also support a Protection State Coordination (PSC) protocol. This protocol is used to help coordinate between both ends of the protection domain in selecting the proper traffic flow.</p>
<p id="rfc.section.1.1.p.4">In the 1:1 architecture, a protection transport path is dedicated to the working transport path of a single service and the traffic is only transmitted either on the working or the protection path, by using a selector bridge at the source of the protection domain.  A selector at the sink of the protection domain then selects the path that carries the normal traffic.  Since the source and sink need to be coordinated to ensure that the selector bridge at both ends select the same path, this architecture must support a PSC protocol.</p>
<p id="rfc.section.1.1.p.5">The 1:n protection architecture extends the 1:1 architecture above by sharing the protection path among n services. Again, the protection path is fully allocated and disjoint from any of the n working transport paths that it is being used to protect. The normal data traffic for each service is transmitted either on the normal working path for that service or, in cases that trigger protection switching (as defined in <a href="#SurvivFwk">[SurvivFwk]</a>), may be sent on the protection path.  The switching action is similar to the 1:1 case where a selector bridge is used at the source.  It should be noted that in cases where multiple working path services have triggered protection switching that some services, dependent upon their Service Level Agreement (SLA), may not be transmitted as a result of limited resources on the protection path. In this architecture there may be a need for coordination of the protection switching, and also for resource allocation negotiation. The procedures for this are for further study and may be addressed in future documents.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Scope of the document</h1>
<p id="rfc.section.1.2.p.1">As was pointed out in the Survivability Framework <a href="#SurvivFwk">[SurvivFwk]</a> and highlighted above, there is a need for coordination between the end points of the protection domain when employing bidirectional protection schemes. This is especially true when there is a need to maintain traffic over a co-routed bidirectional LSP.</p>
<p id="rfc.section.1.2.p.2">The scope of this draft is to present a protocol for the Protection State Coordination of Linear Protection.  The protocol addresses the protection of LSPs in an MPLS-TP network as required by <a href="#RFC5654">[RFC5654]</a> (in particular requirements 63-65 and 74-79) and described in <a href="#SurvivFwk">[SurvivFwk]</a>.  The basic protocol is designed for use in conjunction with the 1:1 protection architecture bidirectional protection and for 1+1 protection of a bidirectional path (for both unidirectional and bidirectional protection switching).  Applicability of the protocol for 1:1 unidirectional protection and for 1:n protection schemes may be documented in a future document.	The applicability of this protocol to additional MPLS-TP constructs and topologies may be documented in future documents.</p>
<p id="rfc.section.1.2.p.3">While the unidirectional 1+1 protection architecture does not require the use of a coordination protocol, the protocol may be used by the ingress node of the path to notify the far-side end point that a switching condition has occurred and verify the consistency of the end point configuration.  This use may be especially useful for point-to-multipoint transport paths, that are unidirectional by definition of <a href="#RFC5654">[RFC5654]</a>.  </p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> Contributing authors</h1>
<p id="rfc.section.1.3.p.1">Hao Long (Huawei), Dan Frost (Cisco), Davide Chiara (Ericsson), Francesco Fondelli (Ericsson), </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Conventions used in this document</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Acronyms</h1>
<div id="#rfc.table.1"></div>
<p>This draft uses the following acronyms:</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left"></th>
<th class="left"></th>
</tr></thead>
<tbody>
<tr>
<td class="left">DNR</td>
<td class="left">Do not revert</td>
</tr>
<tr>
<td class="left">FS</td>
<td class="left">Forced Switch</td>
</tr>
<tr>
<td class="left">G-ACh</td>
<td class="left">Generic Associated Channel Header</td>
</tr>
<tr>
<td class="left">LER</td>
<td class="left">Label Edge Router</td>
</tr>
<tr>
<td class="left">LO</td>
<td class="left">Lockout of protection</td>
</tr>
<tr>
<td class="left">MPLS-TP</td>
<td class="left">Transport Profile for MPLS</td>
</tr>
<tr>
<td class="left">MS</td>
<td class="left">Manual Switch</td>
</tr>
<tr>
<td class="left">NR</td>
<td class="left">No Request</td>
</tr>
<tr>
<td class="left">P2P</td>
<td class="left">Point-to-point</td>
</tr>
<tr>
<td class="left">P2MP</td>
<td class="left">Point-to-multipoint</td>
</tr>
<tr>
<td class="left">PSC</td>
<td class="left">Protection State Coordination Protocol</td>
</tr>
<tr>
<td class="left">SD</td>
<td class="left">Signal Degrade</td>
</tr>
<tr>
<td class="left">SF</td>
<td class="left">Signal Fail</td>
</tr>
<tr>
<td class="left">SLA</td>
<td class="left">Service Level Agreement</td>
</tr>
<tr>
<td class="left">WTR</td>
<td class="left">Wait-to-Restore</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Definitions and Terminology</h1>
<p id="rfc.section.2.2.p.1">The terminology used in this document is based on the terminology defined in <a href="#RFC4427">[RFC4427]</a> and further adapted for MPLS-TP in <a href="#SurvivFwk">[SurvivFwk]</a>. In addition, we use the term LER to refer to a MPLS-TP Network Element, whether it is a LSR, LER, T-PE, or S-PE.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Protection switching control logic</h1>
<p id="rfc.section.3.p.1">Protection switching processes the local triggers described in requirements 74-79 of <a href="#RFC5654">[RFC5654]</a> together with inputs received from the far-end LER. Based on these inputs the LER will take certain protection switching actions, e.g. switching the Selector Bridge to select the working or protection path, and transmit different protocol messages.</p>
<p id="rfc.section.3.p.2">The following figure shows the logical decomposition of the Protection Switching Control Logic into different logical processing units.  These processing units are presented in subsequent subsections of this document.  This logical decomposition is only intended for descriptive purposes, any implementation that produces the external behavior described in section 4 is acceptable.</p>
<div id="#rfc.figure.1"></div>
<div id="#figure1"></div>
<pre>
               Server Indication     Control Plane Indication
               -----------------+  +-------------
             Operator Command   |  |   OAM Indication
             ----------------+  |  |  +---------------
                             |  |  |  |
                             V  V  V  V            
                          +---------------+         +-------+ 
                          | Local Request |&lt;--------|  WTR  | 
                          |    logic      |WTR Exps | Timer | 
                          +---------------+         +-------+ 
                                 |                      ^ 
                    Highest local|request               | 
                                 V                      | Start/Stop 
                         +-----------------+            |
             Remote PSC  |  PSC  Control   |------------+                 
            ------------&gt;|      logic      |                 
               Request   +-----------------+                 
                                 |                          
                                 |  Action         +------------+
                                 +----------------&gt;|  Message   |
                                                   | Generator  |
                                                   +------------+
                                                         |
                                              Output PSC | Message
                                                         V

		  </pre>
<p><a href="#figure1">Figure 1</a> describes the logical architecture of the protection switching control. The Local Request logic unit accepts the triggers from the OAM, external operator commands, from the local control plane (when present), and the Wait-to-Restore timer.  By considering all of these local request sources it determines the highest priority local request. This high-priority request is passed to the PSC Control logic, that will cross-check this local request with the information received from the far-end LER. The PSC Control logic uses this input to determine what actions need to be taken, e.g. local actions at the LER, or what message should be sent to the far-end LER, and the current status of the protection domain.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Local Request Logic</h1>
<p id="rfc.section.3.1.p.1">The Local Request logic processes input triggers from five sources:</p>
<p></p>

<ul>
<li>Operator command &#8211; the network operator may issue local administrative commands on the LER that trigger protection switching.  The supported commands are Forced Switch, Manual Switch, Clear, Lockout of Protection, (see definitions in <a href="#RFC4427">[RFC4427]</a>).</li>
<li>Server layer alarm indication &#8211; the underlying server layer of the network detects failure conditions at the underlying layer and may issue an indication to the MPLS-TP layer.  The server layer may employ its own protection switching mechanism, and therefore this input MAY be controlled by a holdoff-timer that SHOULD be configurable by the network operator.</li>
<li>Control plane &#8211; if there is a control plane active in the network (either signaling or routing), it MAY trigger protection switching based on conditions detected by the control plane. If the control plane is based on GMPLS <a href="#RFC3945">[RFC3945]</a> then the recovery process SHALL comply with the process described in <a href="#RFC4872">[RFC4872]</a>.</li>
<li>OAM indication &#8211; OAM fault management or performance measurement tools may detect a failure or degrade condition on either the working or protection transport path and this SHOULD input an indication to the Local Request Logic.</li>
<li>WTR expires &#8211; The Wait-to-Restore timer is used in conjunction with recovery from failure conditions on the working path in revertive mode.  The timer SHALL signal the PSC control process when it expires and the end point SHOULD revert to the normal transmission of the user data traffic.</li>
</ul>
<p id="rfc.section.3.1.p.3">The Local request logic SHALL process these different input sources and, based on the priorities between them (see section 4.3.2), shall produce a current local request.  If more than one local input source generates an indicator, then the Local request logic shall select the higher priority indicator and block any lower priority indicator.  As a result, there is a single current local request that is passed to the PSC Control logic.  The different local requests that may be output from the Local Request Logic are:</p>
<p></p>

<ul>
<li>Clear &#8211; if the operator cancels an active local administrative command, i.e. LO/FS/MS.</li>
<li>Lockout of Protection (LO) &#8211; if the operator requested to prevent switching data traffic to the protection path, for any purpose.</li>
<li>Signal Fail (SF) &#8211; if any of the Server Layer, Control plane, or OAM indications signaled a failure condition on either the protection path or one of the working paths.</li>
<li>Signal Degrade (SD) &#8211; if any of the Server Layer, Control plane, or OAM indications signaled a degraded transmission condition on either the protection path or one of the working paths.  The determination and actions for SD are for further study and may appear in a separate document.  All references to SD input are place-holders for this extension.</li>
<li>Clear Signal Fail &#8211; if all of the Server Layer, Control plane, or OAM indications are no longer indicating a failure condition on a path that was previously indicating a failure condition.</li>
<li>Forced Switch (FS) &#8211; if the operator requested that traffic be switched from one of the working paths to the protection path.</li>
<li>Manual Switch (MS) &#8211; if the operator requested that traffic be switched from the working path to the protection path.  This is only relevant if there is no currently active fault condition or Operator command.</li>
<li>WTR Expires &#8211; generated by the WTR timer completing its period.</li>
</ul>
<p id="rfc.section.3.1.p.5">If none of the input sources have generated any input then the Local request logic should generate a No Request (NR) request as the current local request .</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Remote Requests</h1>
<p id="rfc.section.3.2.p.1">In addition to the local requests, generated as a result of the local triggers, indicated in the previous subsection, the PSC Control Logic SHALL accept PSC messages from the far-end LER of the transport path.   These remote messages indicate the status of the transport path from the viewpoint of the far-end LER, and may indicate if the local MEP SHOULD initiate a protection switch operation.</p>
<p id="rfc.section.3.2.p.2">The following remote requests may be received by the PSC process:</p>
<p></p>

<ul>
<li>Remote LO &#8211; indicates that the remote end point is in Unavailable state due to a Lockout of Protection operator command.</li>
<li>Remote SF &#8211; indicates that the remote end point has detected a Signal Fail condition on one of the transport paths in the protection domain.  This remote message SHALL include an indication of which transport path is affected by the SF condition.  In addition, it should be noted that the SF condition may be either a unidirectional or a bidirectional failure, even if  the transport path is bidirectional.</li>
<li>Remote SD &#8211; indicates that the remote end point has detected a Signal Degrade condition on one of the transport paths in the protection domain.  This remote message SHALL include an indication of which transport path is affected by the SD condition.  In addition, it should be noted that the SD condition may be either a unidirectional or a bidirectional failure, even if the transport path is bidirectional.</li>
<li>Remote FS &#8211; indicates that the remote end point is operating under an operator command to switch the traffic to the protection path.</li>
<li>Remote MS &#8211; indicates that the remote end point is operating under an operator command to switch the traffic to the path that was not being used previously.</li>
<li>Remote WTR &#8211; indicates that the remote end point has determined that the failure condition has recovered and has started its WTR timer in preparation for reverting to the Normal state.</li>
<li>Remote DNR &#8211; indicates that the remote end point has determined that the failure condition has recovered and will continue transporting traffic on the protection path due to operator configuration that prevents automatic reversion to the Normal state.</li>
<li>Remote NR &#8211; indicates that the remote end point has no abnormal condition to report.</li>
</ul>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> PSC Control Logic</h1>
<p id="rfc.section.3.3.p.1">The PSC Control Logic SHALL accept as input &#8211; </p>

<ol style="list-style-type: lower-alpha">
<li>the current local request output from the Local Request Logic (see section 3.1),</li>
<li>the remote request message from the remote end point of the transport path (see section 3.2), and</li>
<li>the current state of the PSC Control Logic (maintained internally by the PSC Control Logic).</li>
</ol>
<p id="rfc.section.3.3.p.2">Based on the priorities between the different inputs, the PSC Control Logic SHALL determine the new state of the PSC Control Logic and what actions need to be taken.</p>
<p id="rfc.section.3.3.p.3">The new state information SHALL be retained by the PSC Control Logic, while the requested action should be sent to the PSC Message Generator (see subsection 3.4) to generate and transmit the proper PSC message to be transmitted to the remote end point of the protection domain.</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> PSC Message Generator</h1>
<p id="rfc.section.3.4.p.1">Based on the action output from the PSC Control Logic this unit formats the PSC protocol message that is transmitted to the remote end point of the protection domain.  When the PSC control state (see section 3.6) has changed, three PSC messages SHOULD be transmitted in quick succession, and subsequent messages should be transmitted continually at a lower frequency.</p>
<p id="rfc.section.3.4.p.2">The transmission of three rapid packets allows for fast protection switching even if one or two PSC messages are lost or corrupted.  For protection switching within 50ms, it is RECOMMENDED that the default interval of the first three PSC messages SHOULD be no larger than 3.3ms.  The subsequent messages SHOULD be transmitted with an interval of 5 sec, to avoid traffic congestion.</p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> Wait-to-Restore (WTR) timer</h1>
<p id="rfc.section.3.5.p.1">The WTR timer is used to delay reversion to Normal state when recovering from a failure condition on the working path and the protection domain is configured for revertive behavior.  The length of the timer may be provisioned by the operator.  The WTR may be in one of two states &#8211; either Running or Stopped.  The control of the WTR timer is managed by the PSC Control Logic, by use of internal signals to start and stop, i.e. reset, the WTR timer.</p>
<p id="rfc.section.3.5.p.2">If the WTR timer expires prior to being stopped it shall generate a WTR Expires local signal that shall be processed by the Local Request Logic.  If the WTR timer is running, sending a Stop command shall reset the timer, and put the WTR timer into Stopped state, but shall not generate a WTR Expires local signal.  If the WTR timer is stopped, a Stop command shall be ignored.</p>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> PSC Control States</h1>
<p id="rfc.section.3.6.p.1">The PSC Control Logic SHOULD maintain information on the current state of the protection domain.  Information on the state of the domain is maintained by each LER within the protection domain.  The state information SHALL include information of the current state of the protection domain, an indication of the cause for the current state (e.g. unavailable due to local LO command, protecting due to remote FS), and, for each LER, SHOULD include an indication if the state is related to a remote or local condition.  If there are both a local indicator and remote indicator for the state then the state shall be considered a local state. For example, if the protection domain enters into a Protecting failure state and the LER identifies this due to a remote SF input, and then a local SF indication is received then even though this was initially a remote Protecting failure state, by receiving the local SF input the LER is considered to be in local Protecting failure state.</p>
<p id="rfc.section.3.6.p.2">It should be noted that when referring to the "transport" of the data traffic, in the following descriptions and later in the document that the data will be transmitted on both the working and the protection paths when using 1+1 protection, and on either the working or the protection path exclusively when using 1:1 protection.  When using 1+1 protection, the receiving LER should select the proper transmission, according to the state of the protection domain.</p>
<p id="rfc.section.3.6.p.3">The protection domain states that are supported by the PSC Control Logic are: </p>

<ul>
<li>Normal state &#8211; Both the protection and working paths are fully allocated and active, data traffic is being transported over (or selected from) the working path, and no trigger events are reported within the domain.</li>
<li>Unavailable state &#8211; The protection path is unavailable &#8211; either as a result of an operator Lockout command or a failure condition detected on the protection path.</li>
<li>Protecting failure state &#8211; The working path has reported a failure/degrade condition and the user traffic is being transported (or selected) on the protection path.</li>
<li>Protecting administrative state &#8211; The operator has issued a command switching the user traffic to the protection path.</li>
<li>Wait-to-restore state &#8211; The protection domain is recovering from a SF/SD condition on the working path that is being controlled by the Wait-to-Restore (WTR) timer.</li>
<li>Do-not-revert state &#8211; The protection domain is recovering from a Protecting state, but the operator has configured the protection domain to not automatically revert to the Normal state upon recovery.  The protection domain SHALL remain in this state until the operator issues a command to revert to the Normal state or there is a new trigger to switch to a different state.</li>
</ul>
<p id="rfc.section.3.6.p.4">See section 4.3.3 for details on what actions are taken by the PSC Process	Logic for each state and the relevant input.</p>
<h1 id="rfc.section.3.6.1">
<a href="#rfc.section.3.6.1">3.6.1.</a> Local and Remote state</h1>
<p id="rfc.section.3.6.1.p.1">An end-point may be in a given state as a result of either a local input indicator, e.g. OAM, WTR timer, or as a result of receiving a PSC message from the far-end LER.  If the state is entered as a result of a local input indicator, then the state SHOULD be considered a local state.  If the state is entered as a result of a PSC message, in the absence of a local input, then the state SHOULD be considered a remote state.  This differentiation affects how the LER should react to different inputs, as described in section 4.3.3.  The PSC Control logic should maintain, together with the current protection domain state, an indication of whether this is a local or remote state, for this LER.</p>
<p id="rfc.section.3.6.1.p.2">In any instance where the LER has both a local and remote indicators that cause the protection domain to enter a particular state, then the state SHOULD be considered a local state, regardless of the order in which the indicators were processed.  If, however, the LER has local and remote indicators that would cause the protection domain to enter different states, e.g. a Local SF on working and a Remote Lockout message, then the input with the higher priority (see section 4.3.2) will be the deciding factor and the source of that indicator will determine whether it is local or remote.  In the given example the result would be a Remote Unavailable state transmitting SF(1,0) messages.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Protection state coordination (PSC) protocol</h1>
<p id="rfc.section.4.p.1">Bidirectional protection switching, as well as unidirectional 1:1 protection, requires coordination between the two end points in determining which of the two possible paths, the working or protection path, is transmitting the data traffic in any given situation. When protection switching is triggered as described in section 3, the end points must inform each other of the switch-over from one path to the other in a coordinated fashion.</p>
<p id="rfc.section.4.p.2">There are different possibilities for the type of coordinating protocol. One possibility is a two-phased coordination in which the LER that is initiating the protection switching sends a protocol message indicating the switch but the actual switch-over is performed only after receiving an 'Ack' from the far-end LER. The other possibility is a single-phased coordination, in which the initiating LER performs the protection switchover to the alternate path and informs the far-end LER of the switch, and the far-end LER MUST complete the switchover.</p>
<p id="rfc.section.4.p.3">This protocol is a single-phased protocol, as described above.  In the following subsections we describe the protocol messages that SHALL be used between the two end points of the protection domain.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Transmission and acceptance of PSC control packets</h1>
<p id="rfc.section.4.1.p.1">The PSC control packets SHALL be transmitted over the protection path only. This allows the transmission of the messages without affecting the normal data traffic in the most prevalent case, i.e. the Normal state. In addition, limiting the transmission to a single path avoids possible conflicts and race conditions that could develop if the PSC messages were sent on both paths.</p>
<p id="rfc.section.4.1.p.2">When the protection domain state is changed due to a local input, three PSC messages SHOULD be transmitted as quickly as possible, to allow for rapid protection switching.  This set of three rapid messages allows for fast protection switching even if one or two of these packets are lost or corrupted.  When the protection domain state changes due to a remote message there is no need for the aforementioned rapid transmission of three messages.  The exception (e.g. when the rapid transmission is still required) is when going from WTR state to Normal state as a result of a remote NR message.</p>
<p id="rfc.section.4.1.p.3">The frequency of the three rapid messages and the separate frequency of the continual transmission SHOULD be configurable by the operator.  For protection switching within 50ms, it is RECOMMENDED that the default interval of the first three PSC messages SHOULD be no larger than 3.3ms.  The subsequent messages SHOULD be continuously transmitted with an interval of 5 seconds.</p>
<p id="rfc.section.4.1.p.4">If no valid PSC message is received, the last valid received message remains applicable.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Protocol format</h1>
<p id="rfc.section.4.2.p.1">The protocol messages SHALL be sent over the G-ACh as described in <a href="#RFC5586">[RFC5586]</a>. There is a single channel type for the set of PSC messages [to be assigned by IANA].  The actual message function SHALL be identified by the Request field of the ACH payload as described below.  The following figure shows the format for the complete PSC message:.</p>
<div id="#rfc.figure.2"></div>
<div id="#figure 2"></div>
<pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |0 0 0 1|Version|  Reserved     |   Channel Type = MPLS-TP PSC  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          ACH TLV Header                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ~                         Optional TLVs                         ~
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Ver|Request|PT |R|  Reserved   |     FPath     |     Path      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
		  </pre>
<p id="rfc.section.4.2.p.2">Where: </p>

<ul>
<li>MPLS-TP PSC Channel Code is the G-ACh channel number assigned to the PSC = TBD</li>
<li>The ACH TLV Header is described in <a href="#RFC5586">[RFC5586]</a>
</li>
<li>The following subsections describe the fields of the PSC payload.</li>
</ul>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> PSC Ver field</h1>
<p id="rfc.section.4.2.1.p.1">The Ver field identifies the version of the protocol.  For this version the value SHALL be 0.</p>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> PSC Request field</h1>
<p id="rfc.section.4.2.2.p.1">The PSC protocol SHALL support transmission of the following requests between the two end points of the protection domain:</p>
<p></p>

<ul>
<li>(1110) Lockout of protection &#8211; indicates that the end point has disabled the protection path as a result of an administrative command.  Both the FPath and Path fields SHALL be set to 0.</li>
<li>(1101) Forced switch &#8211; indicates that the transmitting end point has switched traffic to the protection path as a result of an administrative command.  The Fpath field SHALL indicate that the working path is being blocked (i.e. Fpath set to 1), and the Path field SHALL indicate that user data traffic is being transported on the protection path (i.e. Path set to 1).</li>
<li>(0110) Signal Fail &#8211; indicates that the transmitting end point has identified a signal fail condition on either the working or protection path.  The Fpath field SHALL identify the path that is reporting the failure condition (i.e. if protection path then Fpath is set to 0 and if working path then Fpath is set to 1), and the Path field SHALL indicate where the data traffic is being transported (i.e. if protection path is blocked then Path is set to 0 and if working path is blocked then Path is set to 1).</li>
<li>(0101) Signal Degrade &#8211; indicates that that the transmitting end point has identified a degradation of the signal, or integrity of the packet transmission on either the working or protection path.  This request is presented here only as a place-holder.  The specifics for the method of identifying this degradation is out-of-scope for this document.	The details of the actions to be taken for this situation is left for	future specification.</li>
<li>(0100) Manual switch &#8211; indicates that the transmitting end point has switched traffic to the protection path as a result of an administrative Manual Switch command.  The Fpath field SHALL indicate that the working path is being blocked (i.e. Fpath set to 1), and the Path field SHALL indicate that user data traffic is being transported on the protection path (i.e. Path set to 1).</li>
<li>(0011) Wait to restore &#8211; indicates that the transmitting end point is recovering from a failure condition of the working path and has started the Wait-to-Restore timer.  Fpath SHALL be set to 0 and ignored upon receipt.  Path SHALL indicate the working path that is currently being protected (i.e. Path set to 1).</li>
<li>(0010) Do not revert &#8211; indicates that the transmitting end point is recovering from a failure/blocked condition, but due to the local settings is requesting that the protection domain continues to transmit data over the protection path, rather than revert to the Normal state.  Fpath SHALL be set to 0 and ignored upon receipt.  Path SHALL indicate the working path that is currently being protected (i.e. Path set to 1).</li>
<li>(0000) No request &#8211; indicates that the transmitting end point has nothing to report, Fpath and Path fields SHALL be set to according to the state of the end point, see section 4.3.3 for detailed scenarios.</li>
</ul>
<h1 id="rfc.section.4.2.3">
<a href="#rfc.section.4.2.3">4.2.3.</a> Protection Type (PT)</h1>
<p id="rfc.section.4.2.3.p.1">The PT field indicates the currently configured protection architecture type, this SHOULD be validated to be consistent for both ends of the protection domain. If an inconsistency is detected then an alarm SHALL be sent to the management system. The following are the possible values:</p>
<p></p>

<ul>
<li>11: bidirectional switching using a permanent bridge</li>
<li>10: bidirectional switching using a selector bridge</li>
<li>01: unidirectional switching using a permanent bridge</li>
<li>00: for future extensions</li>
</ul>
<p id="rfc.section.4.2.3.p.3">As described in the introduction (section 1.1) a 1+1 protection architecture is characterized by the use of a permanent bridge at the source node, whereas the 1:1 and 1:n protection architectures are characterized by the use of a selector bridge at the source node.</p>
<h1 id="rfc.section.4.2.4">
<a href="#rfc.section.4.2.4">4.2.4.</a> Revertive (R) field</h1>
<p id="rfc.section.4.2.4.p.1">This field indicates that the transmitting end point is configured to work in revertive mode.  If there is an inconsistency between the two end points, i.e. one end point is configured for revertive action and the second end point is in non-revertive mode, then the management system SHOULD be notified.  Possible values are:</p>
<p></p>

<ul>
<li>0 &#8211; non-revertive mode</li>
<li>1 &#8211; revertive mode</li>
</ul>
<h1 id="rfc.section.4.2.5">
<a href="#rfc.section.4.2.5">4.2.5.</a> Fault path (FPath) field</h1>
<p id="rfc.section.4.2.5.p.1">The Fpath field indicates which path (i.e. working or protection) is identified to be in a fault condition or affected by an administrative command.  The following are the possible values:</p>
<p></p>

<ul>
<li>0: indicates that the anomaly condition is on the protection path</li>
<li>1: indicates that the anomaly condition is on the working path</li>
<li>2-255: for future extensions</li>
</ul>
<h1 id="rfc.section.4.2.6">
<a href="#rfc.section.4.2.6">4.2.6.</a> Data path (Path) field</h1>
<p id="rfc.section.4.2.6.p.1">The Path field indicates which data is being transmitted on the protection path.  Under normal conditions, the protection path (especially in 1:1 or 1:n architecture) does not need to carry any user data traffic.  If there is a failure/degrade condition on one of the working paths, then that working path's data traffic will be transmitted over the protection path.  The following are the possible values:</p>
<p></p>

<ul>
<li>0: indicates that the protection path is not transporting user data traffic (in 1:n architecture) or transporting redundant user data traffic (in 1+1 architecture).</li>
<li>1: indicates that the protection path is transmitting user traffic replacing the use of the working path.</li>
<li>2-255: for future extensions</li>
</ul>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Principles of Operation</h1>
<p id="rfc.section.4.3.p.1">In all of the following subsections, assume a protection domain between LER-A and LER-Z, using paths W (working) and P (protection) as shown in figure 3.</p>
<div id="#rfc.figure.3"></div>
<div id="#figure 3"></div>
<pre>
              +-----+ //=======================\\ +-----+
              |LER-A|//     Working Path        \\|LER-Z|
              |    /|                             |\    |
              |  ?&lt; |                             | &gt;?  |
              |    \|\\    Protection Path      //|/    |
              +-----+ \\=======================// +-----+

                  |--------Protection Domain--------|

   		  </pre>
<h1 id="rfc.section.4.3.1">
<a href="#rfc.section.4.3.1">4.3.1.</a> Basic operation</h1>
<p id="rfc.section.4.3.1.p.1">The purpose of the PSC protocol is to allow an end point of the protection domain to notify its peer of the status of the domain that is known at the end point and coordinate the transmission of the data traffic.  The current state of the end point is expressed in the values of the Request field [reflecting the local requests at that end point] and the Fpath field [reflecting knowledge of a blocked path].  The coordination between the end points is expressed by the value of the Path field [indicating where the user data traffic is being transmitted].  The value of the Path field SHOULD be identical for both end points at any particular time.  The values of the Request and Fpath fields may not be identical between the two end points.  In particular it should be noted that a remote message MAY not cause the end point to change the Request field that is being transmitted while it does affect the Path field (see details in the following subsections).</p>
<p id="rfc.section.4.3.1.p.2">The protocol is a single-phased protocol.  Single-phased implies that each end point notifies its peer of a change in the operation (switching to or from the protection path) and makes the switch without waiting for acknowledgement.</p>
<p id="rfc.section.4.3.1.p.3">The following subsections will identify the messages that SHALL be transmitted by the end point in different scenarios.  The messages are described as REQ(FP, P) &#8211; where REQ is the value of the Request field,  FP is the value of the Fpath field, and P is the value of the Path field.  All examples assume a protection domain between LER-A and LER-Z with a single working path and single protection path (as shown in figure 3).  Again it should be noted that when using 1:1 protection the data traffic will be transmitted exclusively on either the protection or working path, while when using 1+1 protection the traffic will be transmitted on both paths and the receiving LER should select the appropriate signal based on the state.  The text will refer to this transmission/selection as "transport" of the data traffic.</p>
<h1 id="rfc.section.4.3.2">
<a href="#rfc.section.4.3.2">4.3.2.</a> Priority of inputs</h1>
<p id="rfc.section.4.3.2.p.1">As noted above (in section 3.1) the PSC Control Process accepts input from five local input sources.  There is a definition of priority between the different inputs that may be triggered locally.  The list of local requests in order of priority are (from highest to lowest priority):</p>
<p></p>

<ol>
<li>Clear (Operator command)</li>
<li>Lockout of protection (Operator command)</li>
<li>Signal Fail on protection (OAM/Control Plane/Server Indication)</li>
<li>Forced switch (Operator command)</li>
<li>Signal Fail on working (OAM/Control Plane/Server Indication)</li>
<li>Signal Degrade on working (OAM/Control Plane/Server Indication)</li>
<li>Clear Signal Fail/Degrade (OAM/Control Plane/Server Indication)</li>
<li>Manual switch (Operator command)</li>
<li>WTR expires (WTR Timer)</li>
<li>No request (default)</li>
</ol>
<p id="rfc.section.4.3.2.p.3">As was noted above, the Local request logic SHALL always select the local input indicator with the highest priority as the current local request, i.e.  only the highest priority local input will be used to affect the control logic.  All local inputs with lower priority than this current local request will be ignored.</p>
<p id="rfc.section.4.3.2.p.4">The remote message from the far-end LER is assigned a priority just below the similar local input.  For example, a remote Signal Fail on protection would have a priority just below a local Signal Fail on protection but above a local Forced Switch input.  As mentioned in section 3.6.1, the state transition is determined by the higher priority input between the highest priority local input and the remote message.  This also determines the classification of the state as local or remote.  The following subsections detail the transition based on the current state and the higher priority of these two inputs.</p>
<h1 id="rfc.section.4.3.3">
<a href="#rfc.section.4.3.3">4.3.3.</a> Operation of PSC States</h1>
<p id="rfc.section.4.3.3.p.1">The following sub-sections present the operation of the different states defined in section 3.6.  For each state we define the reaction, i.e. the new state and the message to transmit, to each possible input &#8211; either the highest priority local input or the PSC message from the remote LER.  It should be noted that the new state of the protection domain is described from the point of view of the LER that is reporting the state, therefore, the language of "the LER goes into a state" is referring to the LER reporting that the protection domain is now in this new state.  If the definition states to "ignore" the message, the intention is that the protection domain should remain in its current state and the LER should continue transmitting (as presented in section 4.1) the current PSC message.</p>
<h1 id="rfc.section.4.3.3.1">
<a href="#rfc.section.4.3.3.1">4.3.3.1.</a> Normal State</h1>
<p id="rfc.section.4.3.3.1.p.1">When the protection domain has no special condition in effect, the ingress LER SHALL forward the user data along the working path, and, in the case of 1+1 protection, the Permanent Bridge will bridge the data to the protection path as well. The receiving LER SHALL read the data from the working path.</p>
<p id="rfc.section.4.3.3.1.p.2">When the protection domain is in Normal State the end-point SHALL transmit a NR(0,0) message, indicating &#8211; Nothing to report and data traffic is being transported on the working path.</p>
<p id="rfc.section.4.3.3.1.p.3">When the protection domain is in Normal State the following transitions are relevant in reaction to a local input (new state SHOULD be marked as local) to the LER: </p>

<ul>
<li>A local Lockout of protection input SHALL cause the LER to go into local Unavailable State and begin transmission of a LO(0,0) message.</li>
<li>A local Forced switch input SHALL cause the LER to go into local Protecting administrative state and begin transmission of a FS(1,1) message.</li>
<li>A local Signal Fail indication on the protection path SHALL cause the LER to go into local Unavailable state and begin transmission of a SF(0,0) message.</li>
<li>A local Signal Fail indication on the working path SHALL cause the LER to go into local Protecting failure state and begin transmission of a SF(1,1) message.</li>
<li>A local Manual switch input SHALL cause the LER to go into local Protecting administrative state and begin transmission of a MS(1,1) message.</li>
<li>All other local inputs SHALL be ignored.</li>
</ul>
<p id="rfc.section.4.3.3.1.p.4">In Normal state, remote messages would cause the following reaction from the LER (new state SHOULD be marked as remote): </p>

<ul>
<li>A remote Lockout of protection message SHALL cause the LER to go into remote Unavailable state, while continuing to transmit the NR(0,0) message.</li>
<li>A remote Forced switch message SHALL cause the LER to go into remote Protecting administrative state, and begin transmitting a NR(0,1) message.</li>
<li>A remote Signal Fail message that indicates that the failure is on the protection path SHALL cause the LER (LER-A) to go into remote Unavailable state, while continuing to transmit the NR(0,0) message.</li>
<li>A remote Signal Fail message that indicates that the failure is on the working path SHALL cause the LER to go into remote Protecting failure state, and transmit a NR(0,1) message.</li>
<li>A remote Manual switch message SHALL cause the LER to go into remote Protecting administrative state, and transmit a NR(0,1) message.</li>
<li>All other remote messages SHALL be ignored.</li>
</ul>
<h1 id="rfc.section.4.3.3.2">
<a href="#rfc.section.4.3.3.2">4.3.3.2.</a> Unavailable State</h1>
<p id="rfc.section.4.3.3.2.p.1">When the protection path is unavailable &#8211; either as a result of a Lockout operator command, or as a result of a SF detected on the protection path &#8211; then the protection domain is in the unavailable state. In this state, the data traffic is transported on the working path and is not protected.  When the domain is in unavailable state the PSC messages may not get through and therefore the protection is more dependent on the local inputs rather than the remote messages (that may not be received).</p>
<p id="rfc.section.4.3.3.2.p.2">The protection domain will exit the unavailable state and revert to the normal state when, either the operator clears the Lockout command or the protection path recovers from the signal fail or degraded situation. Both ends will continue to send the PSC messages over the protection path, as a result of this recovery.</p>
<p id="rfc.section.4.3.3.2.p.3">When the LER (assume LER-A) is in Unavailable State the following transitions are relevant in reaction to a local input (new state SHOULD be marked as local): </p>

<ul>
<li>A local Clear input SHOULD be ignored if the LER is in remote Unavailable state.  If in local Unavailable state due to a Lockout command, then the input SHALL cause the LER to go to Normal state and begin transmitting a NR(0,0) message.</li>
<li>A local Lockout of protection input SHALL cause the LER to remain in local Unavailable State and transmit a LO(0,0) message to the far-end LER (LER-Z).</li>
<li>A local Clear SF of the protection path in local Unavailable state that is due to a SF on the protection path SHALL cause the LER to go to Normal state and begin transmitting a NR(0,0) message.  If the LER is in remote Unavailable state but has an active local SF condition, then the local Clear SF SHALL clear the SF local condition and the LER SHALL remain in remote Unavailable state and begin transmitting NR(0,0) messages.  In all other cases the local Clear SF SHOULD be ignored.</li>
<li>A local Forced switch SHALL be ignored by the PSC Control Logic.</li>
<li>A local Signal Fail on the protection path input when in local Unavailable state [by implication this is due to a local SF on protection] SHALL cause the LER to remain in local Unavailable state and transmit a SF(0,0) message.</li>
<li>A local Signal Fail on the working path input when in remote Unavailable state SHALL cause the LER to remain in remote Unavailable state and transmit a SF(1,0) message.</li>
<li>All other local inputs SHALL be ignored.</li>
</ul>
<p id="rfc.section.4.3.3.2.p.4">If remote messages are being received over the protection path then they would have the following affect: </p>

<ul>
<li>A remote Lockout of protection message SHALL cause the LER to remain in Unavailable state, (note that if the LER was previously in local Unavailable state due to a Signal Fail on the protection path, then it will now be in remote Unavailable state) and continue transmission of the current message (either NR(0,0) or LO(0,0) or SF(0,0))</li>
<li>A remote Signal Fail message that indicates that the failure is on the protection path SHALL cause the LER to remain in Unavailable state and continue transmission of the current message (either NR(0,0) or SF(0,0) or LO(0,0)).</li>
<li>A remote No Request, when the LER is in remote Unavailable state SHALL cause the LER to go into Normal state and continue transmission of the current message (either NR(0,0) or SF(0,0)).  If there is a local SF indicator this may cause an immediate state change after switching into Normal state.  When in local Unavailable state, the remote message SHALL be ignored.</li>
<li>All other remote messages SHALL be ignored.</li>
</ul>
<h1 id="rfc.section.4.3.3.3">
<a href="#rfc.section.4.3.3.3">4.3.3.3.</a> Protecting administrative state</h1>
<p id="rfc.section.4.3.3.3.p.1">In the protecting state the user data traffic is being transported on the protection path, while the working path is blocked due to an operator command, i.e. Forced Switch or Manual Switch.  The difference between a local FS and local MS affects what local indicators may be received - the Local request logic will block any local SF when under the influence of a local FS, whereas the SF would override a local MS.  In general, a MS will be canceled in case of either a local or remote SF or LO condition.</p>
<p id="rfc.section.4.3.3.3.p.2">The following describe the reaction to local input: </p>

<ul>
<li>A local Clear SHOULD be ignored if in remote Protecting administrative state.  If in local Protecting administrative state then this input SHALL cause the LER to go into Normal state and begin transmitting a NR(0,0) message.</li>
<li>A local Lockout of protection input SHALL cause the LER to go into local Unavailable state and begin transmission of a LO(0,0) message.</li>
<li>A local Forced switch input SHALL cause the LER to remain in local Protecting administrative state and transmit a FS(1,1) message.</li>
<li>A local Signal Fail indication on the protection path SHALL cause the LER to go into local Unavailable state (i.e. overriding the MS or FS related Protection administrative state) and begin transmission of a SF(0,0) message.</li>
<li>A local Signal Fail indication on the working path SHALL cause the LER to go into local Protecting failure state and begin transmitting a SF(1,1) message, if the current state is due to a (local or remote) Manual switch operator command.  If the LER is in remote Protecting administrative state due to a remote Forced Switch command, then this local indication SHALL cause the LER to remain in remote Protecting administrative state and transmit a SF(1,1) message. If the LER is in local Protecting administrative state due to a local Forced Switch command then this indication SHALL be ignored (i.e. the indication should have been blocked by the Local request logic).</li>
<li>A local Clear SF when in remote Protecting administrative state SHOULD clear any local SF condition that may exist.  The LER SHALL stop transmitting the SF(x,1) message and begin transmitting an NR(0,1) message.</li>
<li>A local Manual switch input SHALL be ignored if in remote Protecting administrative state is due to a remote Forced switch command.  If the current state is due to a (local or remote) Manual switch operator command, it SHALL cause the LER to remain in local Protecting administrative state and transmit a MS(1,1) message.</li>
<li>All other local inputs SHALL be ignored.</li>
</ul>
<p id="rfc.section.4.3.3.3.p.3">While in Protecting administrative state the LER may receive and react as follows to remote PSC messages: </p>

<ul>
<li>A remote Lockout of protection message SHALL cause the LER to go into remote Unavailable state and begin transmitting a NR(0,0) message.  It should be noted that this automatically cancels the current Forced switch or Manual switch command and data traffic is reverted to the working path.</li>
<li>A remote Forced switch message SHOULD be ignored by the PSC Process Logic if there is an active local Forced switch operator command.  If the Protecting administrative state is due to a remote Forced switch message then the LER SHALL remain in remote Protecting administrative state and continue transmitting the last message.  If the Protecting administrative state is due to either a local or remote Manual switch then the LER SHALL remain in remote Protecting administrative state (updating the state information with the proper relevant information) and begin transmitting a NR(0,1) message.</li>
<li>A remote Signal Fail message indicating a failure on the protection path SHALL cause the LER to go into remote Unavailable state and begin transmitting a NR(0,0) message.  It should be noted that this automatically cancels the current Forced switch or Manual switch command and data traffic is reverted to the working path.</li>
<li>A remote Signal Fail message indicating a failure on the working path SHALL be ignored if there is an active local Forced switch command.  If the Protecting state is due to a local or remote Manual switch then the LER SHALL go to remote Protecting failure state and begin transmitting a NR(0,1) message.</li>
<li>A remote Manual switch message SHALL be ignored by the PSC Control Logic if in Protecting administrative state due to a local or remote Forced switch.  If in Protecting administrative state due to a remote Manual switch then the LER SHALL remain in remote Protecting administrative state and continue transmitting the current message.  If in local Protecting administrative state due to an active Manual switch then the LER SHALL remain in local Protecting administrative state and continue transmission of the MS(1,1) message.</li>
<li>A remote DNR(0,1) message SHALL be ignored if in local Protecting administrative state.  If in remote Protecting administrative state then the LER SHALL go to Do-not-revert state and continue transmitting the current message.</li>
<li>A remote NR(0,0) message SHALL be ignored if in local Protecting administrative state.  If in remote Protecting administrative state then the LER SHALL go to Normal state and begin transmitting a NR(0,0) message.</li>
<li>All other remote messages SHOULD be ignored.</li>
</ul>
<h1 id="rfc.section.4.3.3.4">
<a href="#rfc.section.4.3.3.4">4.3.3.4.</a> Protecting failure state</h1>
<p id="rfc.section.4.3.3.4.p.1">When the protection mechanism has been triggered and the protection domain has performed a protection switch, the domain is in the protecting failure state. In this state the normal data traffic is transported on the protection path.  When an LER is in this state it implies that there was either a local SF condition or received a remote SF PSC message.  The SF condition or message indicated that the failure is on the working path.</p>
<p id="rfc.section.4.3.3.4.p.2">This state may be overridden by the Unavailable state triggers, i.e.  Lockout of Protection or SF on the protection path, or by issuing a FS operator command.  This state will be cleared when the SF condition is cleared.  In order to prevent flapping due to an intermittent fault, the LER SHOULD employ a Wait-to-restore timer to delay return to Normal state until the network has stabilized (see section 3.5)</p>
<p id="rfc.section.4.3.3.4.p.3">The following describe the reaction to local input: </p>

<ul>
<li>A local Clear SF SHALL be ignored if in remote Protecting failure state.  If in local Protecting failure state and the LER is configured for revertive behavior then this input SHALL cause the LER to go into Wait-to-restore state, start the WTR timer, and begin transmitting a WTR(0,1) message.  If in local Protecting failure state and the LER is configured for non-revertive behavior then this input SHALL cause the LER to go into Do-not-revert state and begin transmitting a DNR(0,1) message.</li>
<li>A local Lockout of protection input SHALL cause the LER to go into Unavailable state and begin transmission of a LO(0,0) message.</li>
<li>A local Forced switch input SHALL cause the LER to go into Protecting administrative state and begin transmission of a FS(1,1) message.</li>
<li>A local Signal Fail indication on the protection path SHALL cause the LER to go into Unavailable state and begin transmission of a SF(0,0) message.</li>
<li>A local Signal Fail indication on the working path SHALL cause the LER to remain in local Protecting failure state and transmit a SF(1,1) message.</li>
<li>All other local inputs SHOULD be ignored.</li>
</ul>
<p id="rfc.section.4.3.3.4.p.4">While in Protecting failure state the LER may receive and react as follows to remote PSC messages: </p>

<ul>
<li>A remote Lockout of protection message SHALL cause the LER to go into remote Unavailable state and if in local Protecting failure state then the LER SHALL transmit a SF(1,0) message, otherwise it SHALL transmit a NR(0,0) message.  It should be noted that this may cause loss of user data since the working path is still in a failure condition.</li>
<li>A remote Forced switch message SHALL cause the LER go into remote Protecting administrative state and if in local Protecting failure state the LER SHALL transmit the SF(1,1) message, otherwise it SHALL transmit NR(0,1).</li>
<li>A remote Signal Fail message indicating a failure on the protection path SHALL cause the LER to go into remote Unavailable state and if in local Protecting failure state then the LER SHALL transmit a SF(1,0) message, otherwise it SHALL transmitting NR(0,0) message.  It should be noted that this may cause loss of user data since the working path is still in a failure condition.</li>
<li>If in remote Protecting failure state, a remote Wait-to-Restore message SHALL cause the LER to go into remote Wait-to-Restore state and continue transmission of the current message.</li>
<li>If in remote Protecting failure state, a remote Do-not-revert message SHALL cause the LER to go into remote Do-not-revert state and continue transmission of the current message.</li>
<li>If in remote Protecting failure state, a remote NR(0,0) SHALL cause the LER to go to Normal state and transmit an NR(0,0) message.</li>
<li>All other remote messages SHOULD be ignored.</li>
</ul>
<h1 id="rfc.section.4.3.3.5">
<a href="#rfc.section.4.3.3.5">4.3.3.5.</a> Wait-to-restore state</h1>
<p id="rfc.section.4.3.3.5.p.1">The Wait-to-Restore state is used by the PSC protocol to delay reverting to the normal state, when recovering from a failure condition on the working path, for the period of the WTR timer to allow the recovering failure to stabilize.  While in the Wait-to-Restore state the data traffic SHALL continue to be transported on the protection path.  The natural transition from the Wait-to-Restore state to Normal state will occur when the WTR timer expires.</p>
<p id="rfc.section.4.3.3.5.p.2">When in Wait-to-Restore state the following describe the reaction to local inputs: </p>

<ul>
<li>A local Lockout of protection command SHALL cause the LER to Stop the WTR timer, go into local Unavailable state, and begin transmitting a LO(0,0) message.</li>
<li>A local Forced switch command SHALL cause the LER to Stop the WTR timer, go into local Protecting administrative state, and begin transmission of a FS(1,1) message.</li>
<li>A local Signal Fail indication on the protection path SHALL cause the LER to Stop the WTR timer, go into local Unavailable state, and begin transmission of a SF(0,0) message.</li>
<li>A local Signal Fail indication on the working path SHALL cause the LER to Stop the WTR timer, go into local Protecting failure state, and begin transmission of a SF(1,1) message.</li>
<li>A local Manual switch input SHALL cause the LER to Stop the WTR timer, go into local Protecting administrative state and begin transmission of a MS(1,1) message.</li>
<li>A local WTR expires input SHALL cause the LER to remain in Wait-to-Restore state and begin transmitting a NR(0,1) message.</li>
<li>All other local inputs SHOULD be ignored.</li>
</ul>
<p id="rfc.section.4.3.3.5.p.3">When in Wait-to-Restore state the following describe the reaction to remote messages: </p>

<ul>
<li>A remote Lockout of protection message SHALL cause the LER to Stop the WTR timer, go into remote Unavailable state, and begin transmitting a NR(0,0) message.</li>
<li>A remote Forced switch message SHALL cause the LER to Stop the WTR timer, go into remote Protecting administrative state, and begin transmission of a NR(0,1) message.</li>
<li>A remote Signal Fail message for the protection path SHALL cause the LER to Stop the WTR timer, go into remote Unavailable state, and begin transmission of a NR(0,0) message.</li>
<li>A remote Signal Fail message for the working path SHALL cause the LER to Stop the WTR timer, go into remote Protecting failure state, and begin transmission of a NR(0,1) message.</li>
<li>A remote Manual switch message SHALL cause the LER to Stop the WTR timer, go into remote Protecting administrative state and begin transmission of a NR(0,1) message.</li>
<li>If the WTR timer is running then a remote NR message SHALL be ignored.  If the WTR timer is stopped then a remote NR message SHALL cause the LER to go into Normal state and begin transmitting a NR(0,0) message.</li>
<li>All other remote messages SHOULD be ignored.</li>
</ul>
<h1 id="rfc.section.4.3.3.6">
<a href="#rfc.section.4.3.3.6">4.3.3.6.</a> Do-not-revert state</h1>
<p id="rfc.section.4.3.3.6.p.1">Do-not-revert state is a continuation of the Protecting failure state.  When the protection domain is configured for non-revertive behavior.  While in Do-not-revert state, data traffic continues to be transported on the protection path until the administrator sends a command to revert to the Normal state.  It should be noted that there is a fundamental difference between this state and Normal &#8211; whereas Forced Switch in Normal state actually causes a switch in the transport path used, in Do-not-revert state the Forced switch just switches the state (to Protecting administrative state) but the traffic would continue to be transported on the protection path!  To revert back to Normal state the administrator SHALL issue a Lockout of protection command followed by a Clear command.</p>
<p id="rfc.section.4.3.3.6.p.2">When in Do-not-revert state the following describe the reaction to local input: </p>

<ul>
<li>A local Lockout of protection command SHALL cause the LER to go into local Unavailable state and begin transmitting a LO(0,0) message.</li>
<li>A local Forced switch command SHALL cause the LER to go into local Protecting administrative state and begin transmission of a FS(1,1) message.</li>
<li>A local Signal Fail indication on the protection path SHALL cause the LER to go into local Unavailable state and begin transmission of a SF(0,0) message.</li>
<li>A local Signal Fail indication on the working path SHALL cause the LER to go into local Protecting failure state and begin transmission of a SF(1,1) message.</li>
<li>A local Manual switch input SHALL cause the LER to go into local Protecting administrative state and begin transmission of a MS(1,1) message.</li>
<li>All other local inputs SHOULD be ignored.</li>
</ul>
<p id="rfc.section.4.3.3.6.p.3">When in Do-not-revert state the following describe the reaction to remote messages: </p>

<ul>
<li>A remote Lockout of protection message SHALL cause the LER to go into remote Unavailable state and begin transmitting a NR(0,0) message.</li>
<li>A remote Forced switch message SHALL cause the LER to go into remote Protecting administrative state and begin transmission of a NR(0,1) message.</li>
<li>A remote Signal Fail message for the protection path SHALL cause the LER to go into remote Unavailable state and begin transmission of a NR(0,0) message.</li>
<li>A remote Signal Fail message for the working path SHALL cause the LER to go into remote Protecting failure state, and begin transmission of a NR(0,1) message.</li>
<li>A remote Manual switch message SHALL cause the LER to go into remote Protecting administrative state and begin transmission of a NR(0,1) message.</li>
<li>All other remote messages SHOULD be ignored.</li>
</ul>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.5.p.1">This draft requires the allocation of a Channel Code from the G-ACh repository.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.6.p.1">To be added in future version.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.7.p.1">The authors would like to thank all members of the teams (the Joint Working Team, the MPLS Interoperability Design Team in IETF and the T-MPLS Ad Hoc Group in ITU-T) involved in the definition and specification of MPLS Transport Profile.</p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5654">[RFC5654]</b></td>
<td class="top">
<a>Niven-Jenkins, B.</a>, <a>Brungard, D.</a>, <a>Betts, M.</a>, <a>Sprecher, N.</a> and <a>S. Ueno</a>, "<a href="http://tools.ietf.org/html/rfc5654">Requirements of an MPLS Transport Profile</a>", RFC 5654, September 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3031">[RFC3031]</b></td>
<td class="top">
<a>Rosen, E.</a>, <a>Viswanathan, A.</a> and <a>R. Callon</a>, "<a href="http://tools.ietf.org/html/rfc3031">Multiprotocol Label Switching Architecture</a>", RFC 3031, Jan 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3032">[RFC3032]</b></td>
<td class="top">
<a>Rosen, E.</a>, <a>Tappan, D.</a>, <a>Fedorkow, G.</a>, <a>Rekhter, Y.</a>, <a>Farinacci, D.</a>, <a>Li, T.</a> and <a>A. Conta</a>, "<a href="http://tools.ietf.org/html/rfc3032">MPLS Label Stack Encoding</a>", RFC 3032, Jan 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5659">[RFC5659]</b></td>
<td class="top">
<a>Bocci, M.</a> and <a>S. Bryant</a>, "<a href="http://tools.ietf.org/html/rfc5659">An Architecture for Multi-Segment Pseudowire Emulation Edge-to-Edge</a>", RFC 5659, October 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3985">[RFC3985]</b></td>
<td class="top">
<a>Bryant, S.</a> and <a>P. Pate</a>, "<a href="http://tools.ietf.org/html/rfc3985">Pseudowire Emulation Edge-to-Edge (PWE3) Architecture</a>", RFC 3985, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5085">[RFC5085]</b></td>
<td class="top">
<a>Nadeau, T.</a> and <a>C. Pignataro</a>, "<a href="http://tools.ietf.org/html/rfc5085">Pseudowire Virtual Circuit Connectivity Verification (VCCV): A Control Channel for Pseudowires</a>", RFC 5085, December 2007.</td>
</tr>
<tr>
<td class="reference"><b id="TPFwk">[TPFwk]</b></td>
<td class="top">
<a>Bocci, M.</a>, <a title="Cisco">Bryant, S.</a> and <a title="Cisco">L. Levrau</a>, "<a>A Framework for MPLS in Transport Networks</a>", ID draft-ietf-mpls-tp-framework-06.txt, July 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5586">[RFC5586]</b></td>
<td class="top">
<a>Vigoureux,, M.</a>, <a>Bocci, M.</a>, <a>Swallow, G.</a>, <a>Aggarwal, R.</a> and <a>D. Ward</a>, "<a href="http://tools.ietf.org/html/rfc5586">MPLS Generic Associated Channel</a>", RFC 5586, May 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4427">[RFC4427]</b></td>
<td class="top">
<a>Mannie, E.</a> and <a>D. Papadimitriou</a>, "<a href="http://tools.ietf.org/html/rfc4427">Recovery Terminology for Generalized Multi-Protocol Label Switching</a>", RFC 4427, Mar 2006.</td>
</tr>
<tr>
<td class="reference"><b id="SurvivFwk">[SurvivFwk]</b></td>
<td class="top">
<a>Sprecher, N.</a>, <a>Farrel, A.</a> and <a>H. Shah</a>, "<a>Multi-protocol Label Switching Transport Profile Survivability Framework</a>", ID draft-ietf-mpls-tp-survive-fwk-02.txt, Feb 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4872">[RFC4872]</b></td>
<td class="top">
<a>Lang, J.P.</a>, <a>Papadimitriou, D.</a> and <a>Y. Rekhter</a>, "<a href="http://tools.ietf.org/html/rfc4872">RSVP-TE Extensions in Support of End-to-End Generalized Multi-Protocol Label Switching (GMPLS) Recovery</a>", RFC 4872, May 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3945">[RFC3945]</b></td>
<td class="top">
<a>Mannie, E.</a>, "<a href="http://tools.ietf.org/html/rfc3945">Generalized Multi-Protocol Label Switching (GMPLS) Architecture</a>", RFC 3945, Oct 2004.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Stewart Bryant</span> editor
	  <span class="n hidden">
		<span class="family-name">Bryant</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">United Kingdom</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:stbryant@cisco.com">stbryant@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Eric Osborne</span> 
	  <span class="n hidden">
		<span class="family-name">Osborne</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">United States</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:eosborne@cisco.com">eosborne@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Nurit Sprecher</span> editor
	  <span class="n hidden">
		<span class="family-name">Sprecher</span>
	  </span>
	</span>
	<span class="org vcardline">Nokia Siemens Networks</span>
	<span class="adr">
	  <span>3 Hanagar St. Neve Ne'eman B</span>

	  <span class="vcardline">
		<span class="locality">Hod Hasharon</span>,  
		<span class="region"></span>
		<span class="code">45241</span>
	  </span>
	  <span class="country-name vcardline">Israel</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:nurit.sprecher@nsn.com">nurit.sprecher@nsn.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Annamaria Fulignoli</span> editor
	  <span class="n hidden">
		<span class="family-name">Fulignoli</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">Italy</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:annamaria.fulignoli@ericsson.com">annamaria.fulignoli@ericsson.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Yaacov Weingarten</span> 
	  <span class="n hidden">
		<span class="family-name">Weingarten</span>
	  </span>
	</span>
	<span class="org vcardline">Nokia Siemens Networks</span>
	<span class="adr">
	  <span>3 Hanagar St. Neve Ne'eman B</span>

	  <span class="vcardline">
		<span class="locality">Hod Hasharon</span>,  
		<span class="region"></span>
		<span class="code">45241</span>
	  </span>
	  <span class="country-name vcardline">Israel</span>
	</span>
	<span class="vcardline">Phone: +972-9-775 1827</span>

<span class="vcardline">EMail: <a href="mailto:yaacov.weingarten@nsn.com">yaacov.weingarten@nsn.com</a></span>

  </address>
</div>

</body>
</html>