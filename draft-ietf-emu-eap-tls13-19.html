<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Using EAP-TLS with TLS 1.3 (EAP-TLS 1.3)</title>
<meta content="John PreuÃŸ Mattsson" name="author">
<meta content="Mohit Sethi" name="author">
<meta content="
       
 The Extensible Authentication Protocol (EAP), defined in RFC 3748, provides a standard mechanism for support of multiple authentication methods. This document specifies the use of EAP-Transport Layer Security (EAP-TLS) with TLS 1.3 while remaining backwards compatible with existing implementations of EAP-TLS. TLS 1.3 provides significantly improved security, privacy, and reduced latency when compared to earlier versions of TLS. EAP-TLS with TLS 1.3 (EAP-TLS 1.3) further improves security and privacy by always providing forward secrecy, never disclosing the peer identity, and by mandating use of revocation checking. This document also provides guidance on authentication, authorization, and resumption for EAP-TLS in general (regardless of the underlying TLS version used). This document updates RFC 5216.
       
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="draft-ietf-emu-eap-tls13-19" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-emu-eap-tls13-19-ltlync1c.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EAP-TLS 1.3</td>
<td class="right">August 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">PreuÃŸ Mattsson &amp; Sethi</td>
<td class="center">Expires 4 February 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-emu-eap-tls13-19</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc5216" class="eref">5216</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-08-03" class="published">3 August 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-02-04">4 February 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. PreuÃŸ Mattsson</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">M. Sethi</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Using EAP-TLS with TLS 1.3 (EAP-TLS 1.3)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
 The Extensible Authentication Protocol (EAP), defined in RFC 3748, provides a standard mechanism for support of multiple authentication methods. This document specifies the use of EAP-Transport Layer Security (EAP-TLS) with TLS 1.3 while remaining backwards compatible with existing implementations of EAP-TLS. TLS 1.3 provides significantly improved security, privacy, and reduced latency when compared to earlier versions of TLS. EAP-TLS with TLS 1.3 (EAP-TLS 1.3) further improves security and privacy by always providing forward secrecy, never disclosing the peer identity, and by mandating use of revocation checking. This document also provides guidance on authentication, authorization, and resumption for EAP-TLS in general (regardless of the underlying TLS version used). This document updates RFC 5216.<a href="#section-abstract-1" class="pilcrow">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 4 February 2022.<a href="#section-boilerplate.1-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">â–²</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc ulBare compact">
<li class="ulEmpty toc ulBare compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.Â Â <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="ulEmpty toc ulBare compact">
<li class="ulEmpty toc ulBare compact" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.Â Â <a href="#name-requirements-and-terminolog" class="xref">Requirements and Terminology</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.Â Â <a href="#name-protocol-overview" class="xref">Protocol Overview</a></p>
<ul class="ulEmpty toc ulBare compact">
<li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.Â Â <a href="#name-overview-of-the-eap-tls-con" class="xref">Overview of the EAP-TLS Conversation</a></p>
<ul class="ulEmpty toc ulBare compact">
<li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1" class="keepWithNext"><a href="#section-2.1.1" class="xref">2.1.1</a>.Â Â <a href="#name-authentication" class="xref">Authentication</a></p>
</li>
                  <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="xref">2.1.2</a>.Â Â <a href="#name-ticket-establishment" class="xref">Ticket Establishment</a></p>
</li>
                  <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a href="#section-2.1.3" class="xref">2.1.3</a>.Â Â <a href="#name-resumption" class="xref">Resumption</a></p>
</li>
                  <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.1.2.4">
                    <p id="section-toc.1-1.2.2.1.2.4.1"><a href="#section-2.1.4" class="xref">2.1.4</a>.Â Â <a href="#name-termination" class="xref">Termination</a></p>
</li>
                  <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.1.2.5">
                    <p id="section-toc.1-1.2.2.1.2.5.1"><a href="#section-2.1.5" class="xref">2.1.5</a>.Â Â <a href="#name-no-peer-authentication" class="xref">No Peer Authentication</a></p>
</li>
                  <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.1.2.6">
                    <p id="section-toc.1-1.2.2.1.2.6.1"><a href="#section-2.1.6" class="xref">2.1.6</a>.Â Â <a href="#name-hello-retry-request" class="xref">Hello Retry Request</a></p>
</li>
                  <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.1.2.7">
                    <p id="section-toc.1-1.2.2.1.2.7.1"><a href="#section-2.1.7" class="xref">2.1.7</a>.Â Â <a href="#name-identity" class="xref">Identity</a></p>
</li>
                  <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.1.2.8">
                    <p id="section-toc.1-1.2.2.1.2.8.1"><a href="#section-2.1.8" class="xref">2.1.8</a>.Â Â <a href="#name-privacy" class="xref">Privacy</a></p>
</li>
                  <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.1.2.9">
                    <p id="section-toc.1-1.2.2.1.2.9.1"><a href="#section-2.1.9" class="xref">2.1.9</a>.Â Â <a href="#name-fragmentation" class="xref">Fragmentation</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.Â Â <a href="#name-identity-verification" class="xref">Identity Verification</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.Â Â <a href="#name-key-hierarchy" class="xref">Key Hierarchy</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.Â Â <a href="#name-parameter-negotiation-and-c" class="xref">Parameter Negotiation and Compliance Requirements</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.Â Â <a href="#name-eap-state-machines" class="xref">EAP State Machines</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.Â Â <a href="#name-detailed-description-of-the" class="xref">Detailed Description of the EAP-TLS Protocol</a></p>
</li>
          <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.Â Â <a href="#name-iana-considerations" class="xref">IANA considerations</a></p>
</li>
          <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.Â Â <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="ulEmpty toc ulBare compact">
<li class="ulEmpty toc ulBare compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.Â Â <a href="#name-security-claims" class="xref">Security Claims</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.Â Â <a href="#name-peer-and-server-identities" class="xref">Peer and Server Identities</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.Â Â <a href="#name-certificate-validation" class="xref">Certificate Validation</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.Â Â <a href="#name-certificate-revocation" class="xref">Certificate Revocation</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.Â Â <a href="#name-packet-modification-attacks" class="xref">Packet Modification Attacks</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.Â Â <a href="#name-authorization" class="xref">Authorization</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.Â Â <a href="#name-resumption-2" class="xref">Resumption</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="xref">5.8</a>.Â Â <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="xref">5.9</a>.Â Â <a href="#name-pervasive-monitoring" class="xref">Pervasive Monitoring</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.5.2.10">
                <p id="section-toc.1-1.5.2.10.1"><a href="#section-5.10" class="xref">5.10</a>.Â <a href="#name-discovered-vulnerabilities" class="xref">Discovered Vulnerabilities</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.5.2.11">
                <p id="section-toc.1-1.5.2.11.1"><a href="#section-5.11" class="xref">5.11</a>.Â <a href="#name-cross-protocol-attacks" class="xref">Cross-Protocol Attacks</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.Â Â <a href="#name-references" class="xref">References</a></p>
<ul class="ulEmpty toc ulBare compact">
<li class="ulEmpty toc ulBare compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.Â Â <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.Â Â <a href="#name-informative-references" class="xref">Informative references</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-A" class="xref">Appendix A</a>.Â Â <a href="#name-updated-references" class="xref">Updated References</a></p>
</li>
          <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-B" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-C" class="xref"></a><a href="#name-contributors" class="xref">Contributors</a></p>
</li>
          <li class="ulEmpty toc ulBare compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-D" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Extensible Authentication Protocol (EAP), defined in <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span>, provides a standard mechanism for support of multiple authentication methods. EAP-Transport Layer Security (EAP-TLS) <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> specifies an EAP authentication method with certificate-based mutual authentication utilizing the TLS handshake protocol for cryptographic algorithms and protocol version negotiation and establishment of shared secret keying material. EAP-TLS is widely supported for authentication and key establishment in IEEE 802.11 <span>[<a href="#IEEE-802.11" class="xref">IEEE-802.11</a>]</span> (Wi-Fi) and IEEE 802.1AE <span>[<a href="#IEEE-802.1AE" class="xref">IEEE-802.1AE</a>]</span> (MACsec) networks using IEEE 802.1X <span>[<a href="#IEEE-802.1X" class="xref">IEEE-802.1X</a>]</span> and it's the default mechanism for certificate based authentication in 3GPP 5G <span>[<a href="#TS.33.501" class="xref">TS.33.501</a>]</span> and MulteFire <span>[<a href="#MulteFire" class="xref">MulteFire</a>]</span> networks. Many other EAP methods such as EAP-FAST <span>[<a href="#RFC4851" class="xref">RFC4851</a>]</span>, EAP-TTLS <span>[<a href="#RFC5281" class="xref">RFC5281</a>]</span>, TEAP <span>[<a href="#RFC7170" class="xref">RFC7170</a>]</span>, and PEAP <span>[<a href="#PEAP" class="xref">PEAP</a>]</span> depend on TLS and EAP-TLS.<a href="#section-1-1" class="pilcrow">Â¶</a></p>
<p id="section-1-2">EAP-TLS <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> references TLS 1.0 <span>[<a href="#RFC2246" class="xref">RFC2246</a>]</span> and TLS 1.1 <span>[<a href="#RFC4346" class="xref">RFC4346</a>]</span>, but can also work with TLS 1.2 <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span>. TLS 1.0 and 1.1 are formally deprecated and prohibited to negotiate and use <span>[<a href="#RFC8996" class="xref">RFC8996</a>]</span>. Weaknesses found in TLS 1.2, as well as new requirements for security, privacy, and reduced latency have led to the specification of TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, which obsoletes TLS 1.2 <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span>. TLS 1.3 is in large parts a complete remodeling of the TLS handshake protocol including a different message flow, different handshake messages, different key schedule, different cipher suites, different resumption, different privacy protection, and different record padding. This means that significant parts of the normative text in the previous EAP-TLS specification <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> are not applicable to EAP-TLS with TLS 1.3. Therefore, aspects such as resumption, privacy handling, and key derivation need to be appropriately addressed for EAP-TLS with TLS 1.3.<a href="#section-1-2" class="pilcrow">Â¶</a></p>
<p id="section-1-3">This document updates <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> to define how to use EAP-TLS with TLS 1.3. When older TLS versions are negotiated, RFC 5216 applies to maintain backwards compatibility. However, this document does provide additional guidance on authentication, authorization, and resumption for EAP-TLS regardless of the underlying TLS version used. This document only describes differences compared to <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>. When EAP-TLS is used with TLS 1.3, some references are updated as specified in <a href="#updateref" class="xref">Appendix A</a>. All message flow are example message flows specific to TLS 1.3 and do not apply to TLS 1.2. Since EAP-TLS couples the TLS handshake state machine with the EAP state machine it is possible that new versions of TLS will cause incompatibilities that introduce failures or security issues if they are not carefully integrated into the EAP-TLS protocol. Therefore, implementations MUST limit the maximum TLS version they use to 1.3, unless later versions are explicitly enabled by the administrator.<a href="#section-1-3" class="pilcrow">Â¶</a></p>
<p id="section-1-4">This document specifies EAP-TLS 1.3 and does not specify how other TLS-based EAP methods use TLS 1.3. The specification for how other TLS-based EAP methods use TLS 1.3 is left to other documents such as <span>[<a href="#I-D.ietf-emu-tls-eap-types" class="xref">I-D.ietf-emu-tls-eap-types</a>]</span>.<a href="#section-1-4" class="pilcrow">Â¶</a></p>
<p id="section-1-5">In addition to the improved security and privacy offered by TLS 1.3, there are other significant benefits of using EAP-TLS with TLS 1.3. Privacy, which in EAP-TLS means that no information about the underlying peer identity is disclosed, is mandatory and achieved without any additional round-trips. Revocation checking is mandatory and simplified with OCSP stapling, and TLS 1.3 introduces more possibilities to reduce fragmentation when compared to earlier versions of TLS.<a href="#section-1-5" class="pilcrow">Â¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-and-terminolog">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-and-terminolog" class="section-name selfRef">Requirements and Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">Â¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with the terms and concepts used in EAP-TLS <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> and TLS <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>. The term EAP-TLS peer is used for the entity acting as EAP peer and TLS client. The term EAP-TLS server is used for the entity acting as EAP server and TLS server.<a href="#section-1.1-2" class="pilcrow">Â¶</a></p>
<p id="section-1.1-3">Readers are expected to be familiar with the terms and concepts used in EAP-TLS <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> and TLS <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>. The term EAP-TLS peer is used for the entity acting as EAP peer and TLS client. The term EAP-TLS server is used for the entity acting as EAP server and TLS server.<a href="#section-1.1-3" class="pilcrow">Â¶</a></p>
<p id="section-1.1-4">This document follows the terminology from <span>[<a href="#I-D.ietf-tls-rfc8446bis" class="xref">I-D.ietf-tls-rfc8446bis</a>]</span> where the master secret is renamed to the main secret and the exporter_master_secret is renamed to the exporter_secret.<a href="#section-1.1-4" class="pilcrow">Â¶</a></p>
</section>
</section>
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<section id="section-2.1">
        <h3 id="name-overview-of-the-eap-tls-con">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-overview-of-the-eap-tls-con" class="section-name selfRef">Overview of the EAP-TLS Conversation</a>
        </h3>
<p id="section-2.1-1">This section updates Section 2.1 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1-2">If the TLS implementation correctly implements TLS version negotiation, EAP-TLS will automatically leverage that capability. The EAP-TLS implementation needs to know which version of TLS was negotiated to correctly support EAP-TLS 1.3 as well as to maintain backward compatibility with EAP-TLS 1.2.<a href="#section-2.1-2" class="pilcrow">Â¶</a></p>
<p id="section-2.1-3">TLS 1.3 changes both the message flow and the handshake messages compared to earlier versions of TLS. Therefore, much of Section 2.1 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> does not apply for TLS 1.3. Except for Sections <a href="#identity" class="xref">2.2</a> and <a href="#secres" class="xref">5.7</a> this document applies only when TLS 1.3 is negotiated. When TLS 1.2 is negotiated, then <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> applies.<a href="#section-2.1-3" class="pilcrow">Â¶</a></p>
<p id="section-2.1-4">TLS 1.3 introduces several new handshake messages including HelloRetryRequest, NewSessionTicket, and KeyUpdate. In general, these messages will be handled by the underlying TLS libraries and are not visible to EAP-TLS, however there are a few things to note:<a href="#section-2.1-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-5.1">The HelloRetryRequest is used by the server to reject the parameters offered in the ClientHello and suggest new parameters. When this message is encountered it will increase the number of round trips used by the protocol.<a href="#section-2.1-5.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-2.1-5.2">The NewSessionTicket message is used to convey resumption information and is covered in Sections <a href="#ticket" class="xref">2.1.2</a> and <a href="#resumption" class="xref">2.1.3</a>.<a href="#section-2.1-5.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-2.1-5.3">The KeyUpdate message is used to update the traffic keys used on a TLS connection. EAP-TLS does not encrypt significant amounts of data so this functionality is not needed. Implementations SHOULD NOT send this message, however some TLS libraries may automatically generate and process this message.<a href="#section-2.1-5.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-2.1-5.4">Early Data MUST NOT be used in EAP-TLS. EAP-TLS servers MUST NOT send an early_data extension and clients MUST NOT send an EndOfEarlyData message.<a href="#section-2.1-5.4" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-2.1-5.5">Servers MUST NOT request post-handshake client authentication.<a href="#section-2.1-5.5" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-2.1-6">After receiving an EAP-Request packet with EAP-Type=EAP-TLS as described in <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> the conversation will continue with the TLS handshake protocol encapsulated in the data fields of EAP-Response and EAP-Request packets. When EAP-TLS is used with TLS version 1.3, the formatting and processing of the TLS handshake SHALL be done as specified in version 1.3 of TLS. This document only lists additional and different requirements, restrictions, and processing compared to <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> and <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.1-6" class="pilcrow">Â¶</a></p>
<div id="section_auth">
<section id="section-2.1.1">
          <h4 id="name-authentication">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-authentication" class="section-name selfRef">Authentication</a>
          </h4>
<p id="section-2.1.1-1">This section updates Section 2.1.1 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.1.1-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1.1-2">The EAP-TLS server MUST authenticate with a certificate and SHOULD require the EAP-TLS peer to authenticate with a certificate. Certificates can be of any type supported by TLS including raw public keys. Pre-Shared Key (PSK) authentication SHALL NOT be used except for resumption. The full handshake in EAP-TLS with TLS 1.3 always provides forward secrecy by exchange of ephemeral "key_share" extensions in the ClientHello and ServerHello (e.g., containing ephemeral ECDHE public keys). SessionID is deprecated in TLS 1.3, see Sections 4.1.2 and 4.1.3 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>. TLS 1.3 introduced early application data which like all other application data is not used in EAP-TLS, see Section 4.2.10 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> for additional information of the "early_data" extension. Resumption is handled as described in <a href="#resumption" class="xref">Section 2.1.3</a>. As a protected success indication <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span> the EAP-TLS server always sends TLS application data 0x00, see Section 2.5. Note that a TLS implementation MAY not allow the EAP-TLS layer to control in which order things are sent and the application data MAY therefore be sent before a NewSessionTicket. TLS application data 0x00 is therefore to be interpreted as success after the EAP-Request that contains TLS application data 0x00. After the EAP-TLS server has sent an EAP-Request containing the TLS application data 0x00 and received an EAP-Response packet of EAP-Type=EAP-TLS and no data, the EAP-TLS server sends EAP-Success.<a href="#section-2.1.1-2" class="pilcrow">Â¶</a></p>
<p id="section-2.1.1-3"><a href="#figbase1" class="xref">Figure 1</a> shows an example message flow for a successful EAP-TLS full handshake with mutual authentication (and neither HelloRetryRequest nor post-handshake messages are sent).<a href="#section-2.1.1-3" class="pilcrow">Â¶</a></p>
<span id="name-eap-tls-mutual-authenticati"></span><div id="figbase1">
<figure id="figure-1">
            <div class="artwork art-text alignLeft" id="section-2.1.1-4.1">
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                             &lt;--------               TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)               --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;-------- (TLS Application Data 0x00)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Success
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-eap-tls-mutual-authenticati" class="selfRef">EAP-TLS mutual authentication</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="ticket">
<section id="section-2.1.2">
          <h4 id="name-ticket-establishment">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-ticket-establishment" class="section-name selfRef">Ticket Establishment</a>
          </h4>
<p id="section-2.1.2-1">This is a new section when compared to <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.1.2-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1.2-2">To enable resumption when using EAP-TLS with TLS 1.3, the EAP-TLS server MUST send one or more post-handshake NewSessionTicket messages (each associated with a PSK, a PSK identity, a ticket lifetime, and other parameters) in the initial authentication. Note that TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> limits the ticket lifetime to a maximum of 604800 seconds (7 days) and EAP-TLS servers MUST respect this upper limit when issuing tickets. The NewSessionTicket is sent after the EAP-TLS server has received the client Finished message in the initial authentication. The NewSessionTicket can be sent in the same flight as the TLS server Finished or later. The PSK associated with the ticket depends on the client Finished and cannot be pre-computed in handshakes with client authentication. The NewSessionTicket message MUST NOT include an "early_data" extension. If the "early_data" extension is received then it MUST be ignored. Servers should take into account that fewer NewSessionTickets will likely be needed in EAP-TLS than in the usual HTTPS connection scenario. In most cases a single NewSessionTicket will be sufficient. A mechanism by which clients can specify the desired number of tickets needed for future connections is defined in <span>[<a href="#I-D.ietf-tls-ticketrequests" class="xref">I-D.ietf-tls-ticketrequests</a>]</span>.<a href="#section-2.1.2-2" class="pilcrow">Â¶</a></p>
<p id="section-2.1.2-3"><a href="#figbase2" class="xref">Figure 2</a> shows an example message flow for a successful EAP-TLS full handshake with mutual authentication and ticket establishment of a single ticket.<a href="#section-2.1.2-3" class="pilcrow">Â¶</a></p>
<span id="name-eap-tls-ticket-establishmen"></span><div id="figbase2">
<figure id="figure-2">
            <div class="artwork art-text alignLeft" id="section-2.1.2-4.1">
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                             &lt;--------               TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)               --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                            (TLS NewSessionTicket,
                             &lt;-------- (TLS Application Data 0x00)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Success
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-eap-tls-ticket-establishmen" class="selfRef">EAP-TLS ticket establishment</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="resumption">
<section id="section-2.1.3">
          <h4 id="name-resumption">
<a href="#section-2.1.3" class="section-number selfRef">2.1.3. </a><a href="#name-resumption" class="section-name selfRef">Resumption</a>
          </h4>
<p id="section-2.1.3-1">This section updates Section 2.1.2 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.1.3-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1.3-2">EAP-TLS is typically used with client authentication and typically fragments the TLS flights into a large number of EAP requests and EAP responses. Resumption significantly reduces the number of round-trips and enables the EAP-TLS server to omit database lookups needed during a full handshake with client authentication. TLS 1.3 replaces the session resumption mechanisms in earlier versions of TLS with a new PSK exchange. When EAP-TLS is used with TLS version 1.3, EAP-TLS SHALL use a resumption mechanism compatible with version 1.3 of TLS.<a href="#section-2.1.3-2" class="pilcrow">Â¶</a></p>
<p id="section-2.1.3-3">For TLS 1.3, resumption is described in Section 2.2 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>. If the client has received a NewSessionTicket message from the EAP-TLS server, the client can use the PSK identity associated with the ticket to negotiate the use of the associated PSK. If the EAP-TLS server accepts it, then the resumed session has been deemed to be authenticated, and securely associated with the prior authentication or resumption. It is up to the EAP-TLS peer to use resumption, but it is RECOMMENDED that the EAP-TLS peer use resumption if it has a valid ticket that has not been used before. It is left to the EAP-TLS server whether to accept resumption, but it is RECOMMENDED that the EAP-TLS server accept resumption if the ticket which was issued is still valid.
 
However, the EAP-TLS server MAY choose to require a full handshake.  In the case a full handshake is required, the negotiation proceeds as if the session was a new authentication, and resumption had never been requested. The requirements of Sections <a href="#section_auth" class="xref">2.1.1</a> and <a href="#ticket" class="xref">2.1.2</a> then apply in their entirety. As described in Appendix C.4 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, reuse of a ticket allows passive observers to correlate different connections. EAP-TLS peers and EAP-TLS servers SHOULD follow the client tracking preventions in Appendix C.4 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-2.1.3-3" class="pilcrow">Â¶</a></p>
<p id="section-2.1.3-4">It is RECOMMENDED to use a Network Access Identifiers (NAIs) with the same realm during resumption and the original full handshake. This requirement allows EAP packets to be routed to the same destination as the original full handshake. If this recommendation is not followed, resumption is likely impossible. When NAI reuse can be done without privacy implications, it is RECOMMENDED to use the same NAI in the resumption, as was used in the original full handshake <span>[<a href="#RFC7542" class="xref">RFC7542</a>]</span>. For example, the NAI @realm can safely be reused since it does not provide any specific information to associate a user's resumption attempt with the original full handshake. However, reusing the NAI P2ZIM2F+OEVAO21nNWg2bVpgNnU=@realm enables an on-path attacker to associate a resumption attempt with the original full handshake. The TLS PSK identity is typically derived by the TLS implementation and may be an opaque blob without a routable realm. The TLS PSK identity on its own is therefore unsuitable as a NAI in the Identity Response.<a href="#section-2.1.3-4" class="pilcrow">Â¶</a></p>
<p id="section-2.1.3-5"><a href="#figresumption" class="xref">Figure 3</a> shows an example message flow for a subsequent successful EAP-TLS resumption handshake where both sides authenticate via a PSK provisioned via an earlier NewSessionTicket and where the server provisions a single new ticket.<a href="#section-2.1.3-5" class="pilcrow">Â¶</a></p>
<span id="name-eap-tls-resumption"></span><div id="figresumption">
<figure id="figure-3">
            <div class="artwork art-text alignLeft" id="section-2.1.3-6.1">
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                             &lt;--------               TLS Finished,
                                             TLS NewSessionTicket)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Finished)               --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;-------- (TLS Application Data 0x00)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Success
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-eap-tls-resumption" class="selfRef">EAP-TLS resumption</a>
            </figcaption></figure>
</div>
<p id="section-2.1.3-7">As specified in Section 2.2 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, the EAP-TLS peer SHOULD supply a "key_share" extension when attempting resumption, which allows the EAP-TLS server to potentially decline resumption and fall back to a full handshake. If the EAP-TLS peer did not supply a "key_share" extension when attempting resumption, the EAP-TLS server needs to send HelloRetryRequest to signal that additional information is needed to complete the handshake, and the EAP-TLS peer needs to send a second ClientHello containing that information. Providing a "key_share" and using the "psk_dhe_ke" pre-shared key exchange mode is also important in order to limit the impact of a key compromise. When using "psk_dhe_ke", TLS 1.3 provides forward secrecy meaning that key leakage does not compromise any earlier connections. The "psk_dh_ke" mechanism MUST be used for resumption unless the deployment has a local requirement to allow configuration of other mechanisms.<a href="#section-2.1.3-7" class="pilcrow">Â¶</a></p>
</section>
</div>
<section id="section-2.1.4">
          <h4 id="name-termination">
<a href="#section-2.1.4" class="section-number selfRef">2.1.4. </a><a href="#name-termination" class="section-name selfRef">Termination</a>
          </h4>
<p id="section-2.1.4-1">This section updates Section 2.1.3 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.1.4-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1.4-2">TLS 1.3 changes both the message flow and the handshake messages compared to earlier versions of TLS. Therefore, some normative text in Section 2.1.3 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> does not apply for TLS 1.3. The two paragraphs below replace the corresponding paragraphs in Section 2.1.3 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> when EAP-TLS is used with TLS 1.3. The other paragraphs in Section 2.1.3 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> still apply with the exception that SessionID is deprecated.<a href="#section-2.1.4-2" class="pilcrow">Â¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-2.1.4-3.1">If the EAP-TLS peer authenticates successfully, the EAP-TLS server MUST send an EAP-Request packet with EAP-Type=EAP-TLS containing TLS records conforming to the version of TLS used. The message flow ends with a protected success indication from the EAP-TLS server, follwed by an EAP-Response packet of EAP-Type=EAP-TLS and no data from the EAP-TLS peer, follwed by EAP-Success from the server.<a href="#section-2.1.4-3.1" class="pilcrow">Â¶</a>
</li>
            <li class="ulEmpty normal" id="section-2.1.4-3.2">If the EAP-TLS server authenticates successfully, the EAP-TLS peer MUST send an EAP-Response message with EAP-Type=EAP-TLS containing TLS records conforming to the version of TLS used.<a href="#section-2.1.4-3.2" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-2.1.4-4">Figures <a href="#figterm1" class="xref">4</a>, <a href="#figterm2" class="xref">5</a>, and <a href="#figterm3" class="xref">6</a> illustrate message flows in several cases where the EAP-TLS peer or EAP-TLS server sends a TLS Error alert message. In earlier versions of TLS, error alerts could be warnings or fatal. In TLS 1.3, error alerts are always fatal and the only alerts sent at warning level are "close_notify" and "user_canceled", both of which indicate that the connection is not going to continue normally, see <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-2.1.4-4" class="pilcrow">Â¶</a></p>
<p id="section-2.1.4-5">In TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, error alerts are not mandatory to send after a fatal error condition. Failure to send TLS Error alerts means that the peer or server would have no way of determining what went wrong. EAP-TLS 1.3 strengthens this requirement. Whenever an implementation encounters a fatal error condition, it MUST send an appropriate TLS Error alert.<a href="#section-2.1.4-5" class="pilcrow">Â¶</a></p>
<p id="section-2.1.4-6"><a href="#figterm1" class="xref">Figure 4</a> shows an example message flow where the EAP-TLS server rejects the ClientHello with an error alert. The EAP-TLS server can also partly reject the ClientHello with a HelloRetryRequest, see <a href="#helloretry" class="xref">Section 2.1.6</a>.<a href="#section-2.1.4-6" class="pilcrow">Â¶</a></p>
<span id="name-eap-tls-server-rejection-of"></span><div id="figterm1">
<figure id="figure-4">
            <div class="artwork art-text alignLeft" id="section-2.1.4-7.1">
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------           (TLS Error Alert)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Failure
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-eap-tls-server-rejection-of" class="selfRef">EAP-TLS server rejection of ClientHello</a>
            </figcaption></figure>
</div>
<p id="section-2.1.4-8"><a href="#figterm2" class="xref">Figure 5</a> shows an example message flow where EAP-TLS server authentication is unsuccessful and the EAP-TLS peer sends a TLS Error alert.<a href="#section-2.1.4-8" class="pilcrow">Â¶</a></p>
<span id="name-eap-tls-unsuccessful-eap-tl"></span><div id="figterm2">
<figure id="figure-5">
            <div class="artwork art-text alignLeft" id="section-2.1.4-9.1">
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                             &lt;--------               TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Error Alert)
                             --------&gt;
                             &lt;--------               EAP-Failure
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-eap-tls-unsuccessful-eap-tl" class="selfRef">EAP-TLS unsuccessful EAP-TLS server authentication</a>
            </figcaption></figure>
</div>
<p id="section-2.1.4-10"><a href="#figterm3" class="xref">Figure 6</a> shows an example message flow where the EAP-TLS server authenticates to the EAP-TLS peer successfully, but the EAP-TLS peer fails to authenticate to the EAP-TLS server and the server sends a TLS Error alert.<a href="#section-2.1.4-10" class="pilcrow">Â¶</a></p>
<span id="name-eap-tls-unsuccessful-client"></span><div id="figterm3">
<figure id="figure-6">
            <div class="artwork art-text alignLeft" id="section-2.1.4-11.1">
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                  Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;

                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                             &lt;--------               TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)               --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------           (TLS Error Alert)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Failure
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-eap-tls-unsuccessful-client" class="selfRef">EAP-TLS unsuccessful client authentication</a>
            </figcaption></figure>
</div>
</section>
<section id="section-2.1.5">
          <h4 id="name-no-peer-authentication">
<a href="#section-2.1.5" class="section-number selfRef">2.1.5. </a><a href="#name-no-peer-authentication" class="section-name selfRef">No Peer Authentication</a>
          </h4>
<p id="section-2.1.5-1">This is a new section when compared to <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.1.5-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1.5-2"><a href="#figbase3" class="xref">Figure 7</a> shows an example message flow for a successful EAP-TLS full handshake without peer authentication (e.g., emergency services, as described in <span>[<a href="#RFC7406" class="xref">RFC7406</a>]</span>).<a href="#section-2.1.5-2" class="pilcrow">Â¶</a></p>
<span id="name-eap-tls-without-peer-authen"></span><div id="figbase3">
<figure id="figure-7">
            <div class="artwork art-text alignLeft" id="section-2.1.5-3.1">
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                             &lt;--------               TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Finished)               --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;-------- (TLS Application Data 0x00)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Success
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-eap-tls-without-peer-authen" class="selfRef">EAP-TLS without peer authentication</a>
            </figcaption></figure>
</div>
</section>
<div id="helloretry">
<section id="section-2.1.6">
          <h4 id="name-hello-retry-request">
<a href="#section-2.1.6" class="section-number selfRef">2.1.6. </a><a href="#name-hello-retry-request" class="section-name selfRef">Hello Retry Request</a>
          </h4>
<p id="section-2.1.6-1">This is a new section when compared to <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.1.6-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1.6-2">As defined in TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, EAP-TLS servers can send a HelloRetryRequest message in response to a ClientHello if the EAP-TLS server finds an acceptable set of parameters but the initial ClientHello does not contain all the needed information to continue the handshake. One use case is if the EAP-TLS server does not support the groups in the "key_share" extension (or there is no "key_share" extension), but supports one of the groups in the "supported_groups" extension. In this case the client should send a new ClientHello with a "key_share" that the EAP-TLS server supports.<a href="#section-2.1.6-2" class="pilcrow">Â¶</a></p>
<p id="section-2.1.6-3"><a href="#fighelloretryrequest" class="xref">Figure 8</a> shows an example message flow for a successful EAP-TLS full handshake with mutual authentication and HelloRetryRequest. Note the extra round-trip as a result of the HelloRetryRequest.<a href="#section-2.1.6-3" class="pilcrow">Â¶</a></p>
<span id="name-eap-tls-with-hello-retry-re"></span><div id="fighelloretryrequest">
<figure id="figure-8">
            <div class="artwork art-text alignLeft" id="section-2.1.6-4.1">
<pre>
 EAP-TLS Peer                                      EAP-TLS Server

                                                      EAP-Request/
                             &lt;--------                   Identity
 EAP-Response/
 Identity (Privacy-Friendly) --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;--------                 (TLS Start)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                           (TLS HelloRetryRequest)
                             &lt;--------
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS ClientHello)            --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                                                 (TLS ServerHello,
                                          TLS EncryptedExtensions,
                                           TLS CertificateRequest,
                                                  TLS Certificate,
                                            TLS CertificateVerify,
                                                     TLS Finished)
 EAP-Response/
 EAP-Type=EAP-TLS
(TLS Certificate,
 TLS CertificateVerify,
 TLS Finished)               --------&gt;
                                                      EAP-Request/
                                                 EAP-Type=EAP-TLS
                             &lt;-------- (TLS Application Data 0x00)
 EAP-Response/
 EAP-Type=EAP-TLS            --------&gt;
                             &lt;--------                EAP-Success
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-eap-tls-with-hello-retry-re" class="selfRef">EAP-TLS with Hello Retry Request</a>
            </figcaption></figure>
</div>
</section>
</div>
<section id="section-2.1.7">
          <h4 id="name-identity">
<a href="#section-2.1.7" class="section-number selfRef">2.1.7. </a><a href="#name-identity" class="section-name selfRef">Identity</a>
          </h4>
<p id="section-2.1.7-1">This is a new section when compared to <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.1.7-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1.7-2">It is RECOMMENDED to use anonymous NAIs <span>[<a href="#RFC7542" class="xref">RFC7542</a>]</span> in the Identity Response as such identities are routable and privacy-friendly. While opaque blobs are allowed by <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span>, such identities are NOT RECOMMENDED as they are not routable and should only be considered in local deployments where the EAP-TLS peer, EAP authenticator, and EAP-TLS server all belong to the same network. Many client certificates contain an identity such as an email address, which is already in NAI format. When the client certificate contains a NAI as subject name or alternative subject name, an anonymous NAI SHOULD be derived from the NAI in the certificate, see <a href="#privacy" class="xref">Section 2.1.8</a>. More details on identities are described in Sections <a href="#resumption" class="xref">2.1.3</a>, <a href="#privacy" class="xref">2.1.8</a>, <a href="#identity" class="xref">2.2</a>, and <a href="#privcon" class="xref">5.8</a>.<a href="#section-2.1.7-2" class="pilcrow">Â¶</a></p>
</section>
<div id="privacy">
<section id="section-2.1.8">
          <h4 id="name-privacy">
<a href="#section-2.1.8" class="section-number selfRef">2.1.8. </a><a href="#name-privacy" class="section-name selfRef">Privacy</a>
          </h4>
<p id="section-2.1.8-1">This section updates Section 2.1.4 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.1.8-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1.8-2">EAP-TLS 1.3 significantly improves privacy when compared to earlier versions of EAP-TLS. EAP-TLS 1.3 forbids cipher suites without confidentiality which means that TLS 1.3 is always encrypting large parts of the TLS handshake including the certificate messages.<a href="#section-2.1.8-2" class="pilcrow">Â¶</a></p>
<p id="section-2.1.8-3">EAP-TLS peer and server implementations supporting TLS 1.3 MUST support anonymous Network Access Identifiers (NAIs) (Section 2.4 in <span>[<a href="#RFC7542" class="xref">RFC7542</a>]</span>) and a client supporting TLS 1.3 MUST NOT send its username in cleartext in the Identity Response. Following <span>[<a href="#RFC7542" class="xref">RFC7542</a>]</span>, it is RECOMMENDED to omit the username (i.e., the NAI is @realm), but other constructions such as a fixed username (e.g., anonymous@realm) or an encrypted username (e.g., xCZINCPTK5+7y81CrSYbPg+RKPE3OTrYLn4AQc4AC2U=@realm) are allowed. Note that the NAI MUST be a UTF-8 string as defined by the grammar in Section 2.2 of <span>[<a href="#RFC7542" class="xref">RFC7542</a>]</span>.<a href="#section-2.1.8-3" class="pilcrow">Â¶</a></p>
<p id="section-2.1.8-4">As the certificate messages in TLS 1.3 are encrypted, there is no need to send an empty certificate_list and perform a second handshake for privacy (as needed by EAP-TLS with earlier versions of TLS). When EAP-TLS is used with TLS version 1.3 the EAP-TLS peer and EAP-TLS server SHALL follow the processing specified by version 1.3 of TLS. This means that the EAP-TLS peer only sends an empty certificate_list if it does not have an appropriate certificate to send, and the EAP-TLS server MAY treat an empty certificate_list as a terminal condition.<a href="#section-2.1.8-4" class="pilcrow">Â¶</a></p>
<p id="section-2.1.8-5">EAP-TLS with TLS 1.3 is always used with privacy. This does not add any extra round-trips and the message flow with privacy is just the normal message flow as shown in <a href="#figbase1" class="xref">Figure 1</a>.<a href="#section-2.1.8-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<section id="section-2.1.9">
          <h4 id="name-fragmentation">
<a href="#section-2.1.9" class="section-number selfRef">2.1.9. </a><a href="#name-fragmentation" class="section-name selfRef">Fragmentation</a>
          </h4>
<p id="section-2.1.9-1">This section updates Section 2.1.5 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.1.9-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1.9-2">Including ContentType (1 byte), ProtocolVersion (2 bytes), and length (2 bytes) headers a single TLS record may be up to 16645 octets in length. EAP-TLS fragmentation support is provided through addition of a flags octet within the EAP-Response and EAP-Request packets, as well as a TLS Message Length field of four octets. Implementations MUST NOT set the L bit in unfragmented messages, but MUST accept unfragmented messages with and without the L bit set.<a href="#section-2.1.9-2" class="pilcrow">Â¶</a></p>
<p id="section-2.1.9-3">Some EAP implementations and access networks may limit the number of EAP packet exchanges that can be handled. To avoid fragmentation, it is RECOMMENDED to keep the sizes of EAP-TLS peer, EAP-TLS server, and trust anchor certificates small and the length of the certificate chains short. In addition, it is RECOMMENDED to use mechanisms that reduce the sizes of Certificate messages. For a detailed discussion on reducing message sizes to prevent fragmentation, see <span>[<a href="#I-D.ietf-emu-eaptlscert" class="xref">I-D.ietf-emu-eaptlscert</a>]</span>.<a href="#section-2.1.9-3" class="pilcrow">Â¶</a></p>
</section>
</section>
<div id="identity">
<section id="section-2.2">
        <h3 id="name-identity-verification">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-identity-verification" class="section-name selfRef">Identity Verification</a>
        </h3>
<p id="section-2.2-1">This section updates Section 2.2 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>. The guidance in this section is relevant for EAP-TLS in general (regardless of the underlying TLS version used).<a href="#section-2.2-1" class="pilcrow">Â¶</a></p>
<p id="section-2.2-2">The EAP peer identity provided in the EAP-Response/Identity is not authenticated by EAP-TLS. Unauthenticated information MUST NOT be used for accounting purposes or to give authorization. The authenticator and the EAP-TLS server MAY examine the identity presented in EAP-Response/Identity for purposes such as routing and EAP method selection. EAP-TLS servers MAY reject conversations if the identity does not match their policy. Note that this also applies to resumption, see Sections <a href="#resumption" class="xref">2.1.3</a>, <a href="#secauth" class="xref">5.6</a>, and <a href="#secres" class="xref">5.7</a>.<a href="#section-2.2-2" class="pilcrow">Â¶</a></p>
<p id="section-2.2-3">The EAP server identity in the TLS server certificate is typically a fully qualified domain name (FQDN) in the SubjectAltName (SAN) extension. Since EAP-TLS deployments may use more than one EAP server, each with a different certificate, EAP peer implementations SHOULD allow for the configuration of one or more trusted root certificates (CA certificate) to authenticate the server certificate and one or more server names to match against the SubjectAltName (SAN) extension in the server certificate. If any of the configured names match any of the names in the SAN extension then the name check passes. To simplify name matching, an EAP-TLS deployment can assign a name to represent an authorized EAP server and EAP Server certificates can include this name in the list of SANs for each certificate that represents an EAP-TLS server. If server name matching is not used, then it degrades the confidence that the EAP server with which it is interacting is authoritative for the given network. If name matching is not used with a public root CA, then effectively any server can obtain a certificate which will be trusted for EAP authentication by the Peer. While this requirement to verify domain names is new, and was not mentioned in <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>, it has been widely implemented in EAP-TLS peers. As such, it is believed that this section contains minimal new interoperability or implementation requirements on EAP-TLS peers and can be applied to earlier versions of TLS.<a href="#section-2.2-3" class="pilcrow">Â¶</a></p>
<p id="section-2.2-4">The process of configuring a root CA certificate and a server name is non-trivial and therefore automated methods of provisioning are RECOMMENDED. For example, the eduroam federation <span>[<a href="#RFC7593" class="xref">RFC7593</a>]</span> provides a Configuration Assistant Tool (CAT) to automate the configuration process. In the absence of a trusted root CA certificate (user configured or system-wide), EAP peers MAY implement a trust on first use (TOFU) mechanism where the peer trusts and stores the server certificate during the first connection attempt. The EAP peer ensures that the server presents the same stored certificate on subsequent interactions. Use of a TOFU mechanism does not allow for the server certificate to change without out-of-band validation of the certificate and is therefore not suitable for many deployments including ones where multiple EAP servers are deployed for high availability. TOFU mechanisms increase the susceptibility to traffic interception attacks and should only be used if there are adequate controls in place to mitigate this risk.<a href="#section-2.2-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="keyheirarchy">
<section id="section-2.3">
        <h3 id="name-key-hierarchy">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-key-hierarchy" class="section-name selfRef">Key Hierarchy</a>
        </h3>
<p id="section-2.3-1">This section updates Section 2.3 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.3-1" class="pilcrow">Â¶</a></p>
<p id="section-2.3-2">TLS 1.3 replaces the TLS pseudorandom function (PRF) used in earlier versions of TLS with HKDF and completely changes the Key Schedule. The key hierarchies shown in Section 2.3 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> are therefore not correct when EAP-TLS is used with TLS version 1.3. For TLS 1.3 the key schedule is described in Section 7.1 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-2.3-2" class="pilcrow">Â¶</a></p>
<p id="section-2.3-3">When EAP-TLS is used with TLS version 1.3 the Key_Material and Method-Id SHALL be derived from the exporter_secret using the TLS exporter interface <span>[<a href="#RFC5705" class="xref">RFC5705</a>]</span> (for TLS 1.3 this is defined in Section 7.5 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>). Type is the value of the EAP Type field defined in Section 2 of <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span>. For EAP-TLS the Type field has value 0x0D.<a href="#section-2.3-3" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.3-4">
<pre>
Type = 0x0D
Key_Material = TLS-Exporter("EXPORTER_EAP_TLS_Key_Material",
                            Type, 128)
Method-Id    = TLS-Exporter("EXPORTER_EAP_TLS_Method-Id",
                            Type, 64)
Session-Id   = Type || Method-Id
</pre><a href="#section-2.3-4" class="pilcrow">Â¶</a>
</div>
<p id="section-2.3-5">The MSK and EMSK are derived from the Key_Material in the same manner as with EAP-TLS <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>, Section 2.3. The definitions are repeated below for simplicity:<a href="#section-2.3-5" class="pilcrow">Â¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.3-6">
<pre>
MSK          = Key_Material(0, 63)
EMSK         = Key_Material(64, 127)
</pre><a href="#section-2.3-6" class="pilcrow">Â¶</a>
</div>
<p id="section-2.3-7">Other TLS based EAP methods can use the TLS exporter in a similar fashion, see <span>[<a href="#I-D.ietf-emu-tls-eap-types" class="xref">I-D.ietf-emu-tls-eap-types</a>]</span>.<a href="#section-2.3-7" class="pilcrow">Â¶</a></p>
<p id="section-2.3-8"><span>[<a href="#RFC5247" class="xref">RFC5247</a>]</span> deprecates the use of IV. Thus, RECV-IV and SEND-IV are not exported in EAP-TLS with TLS 1.3. As noted in <span>[<a href="#RFC5247" class="xref">RFC5247</a>]</span>, lower layers use the MSK in a lower-layer dependent manner. EAP-TLS with TLS 1.3 exports the MSK and does not specify how it is used by lower layers.<a href="#section-2.3-8" class="pilcrow">Â¶</a></p>
<p id="section-2.3-9">Note that the key derivation MUST use the length values given above. While in TLS 1.2 and earlier it was possible to truncate the output by requesting less data from the TLS-Exporter function, this practice is not possible with TLS 1.3. If an implementation intends to use only a part of the output of the TLS-Exporter function, then it MUST ask for the full output and then only use the desired part. Failure to do so will result in incorrect values being calculated for the above keying material.<a href="#section-2.3-9" class="pilcrow">Â¶</a></p>
<p id="section-2.3-10">By using the TLS exporter, EAP-TLS can use any TLS 1.3 implementation which provides a public API for the exporter. Note that EAP-TLS with TLS 1.2 <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> can be used with the TLS exporter since the public exporter was defined in <span>[<a href="#RFC5705" class="xref">RFC5705</a>]</span>.<a href="#section-2.3-10" class="pilcrow">Â¶</a></p>
</section>
</div>
<section id="section-2.4">
        <h3 id="name-parameter-negotiation-and-c">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-parameter-negotiation-and-c" class="section-name selfRef">Parameter Negotiation and Compliance Requirements</a>
        </h3>
<p id="section-2.4-1">This section updates Section 2.4 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-2.4-1" class="pilcrow">Â¶</a></p>
<p id="section-2.4-2">TLS 1.3 cipher suites are defined differently than in earlier versions of TLS (see Section B.4 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>), and the cipher suites discussed in Section 2.4 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> can therefore not be used when EAP-TLS is used with TLS version 1.3.<a href="#section-2.4-2" class="pilcrow">Â¶</a></p>
<p id="section-2.4-3">When EAP-TLS is used with TLS version 1.3, the EAP-TLS peers and EAP-TLS servers MUST comply with the compliance requirements (mandatory-to-implement cipher suites, signature algorithms, key exchange algorithms, extensions, etc.) defined in Section 9 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>. In EAP-TLS with TLS 1.3, only cipher suites with confidentiality SHALL be supported.<a href="#section-2.4-3" class="pilcrow">Â¶</a></p>
<p id="section-2.4-4">While EAP-TLS does not protect any application data except for the TLS record with application data 0x00, the negotiated cipher suites and algorithms MAY be used to secure data as done in other TLS-based EAP methods.<a href="#section-2.4-4" class="pilcrow">Â¶</a></p>
</section>
<div id="state">
<section id="section-2.5">
        <h3 id="name-eap-state-machines">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-eap-state-machines" class="section-name selfRef">EAP State Machines</a>
        </h3>
<p id="section-2.5-1">This is a new section when compared to <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> and only applies to TLS 1.3. <span>[<a href="#RFC4137" class="xref">RFC4137</a>]</span> offers a proposed state machine for EAP.<a href="#section-2.5-1" class="pilcrow">Â¶</a></p>
<p id="section-2.5-2">TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> introduces post-handshake messages. These post-handshake messages use the handshake content type and can be sent after the main handshake. Examples of post-handshake messages are NewSessionTicket, which is used for resumption and KeyUpdate, which is not useful and not expected in EAP-TLS. After sending TLS Finished, the EAP-TLS server may send any number of post-handshake messages in separate EAP-Requests.<a href="#section-2.5-2" class="pilcrow">Â¶</a></p>
<p id="section-2.5-3">To provide a protected success result indication and to decrease the uncertainty for the EAP-TLS peer, the following procedure MUST be followed:<a href="#section-2.5-3" class="pilcrow">Â¶</a></p>
<p id="section-2.5-4">When an EAP-TLS server has successfully processed the TLS client Finished and sent its last handshake message (Finished or a post-handshake message), it sends an encrypted TLS record with application data 0x00. The encrypted TLS record with application data 0x00 is a protected success result indication, as defined in <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span>. After sending an EAP-Request that contains the protected success result indication, the EAP-TLS server must not send any more EAP-Request and may only send an EAP-Success. The EAP-TLS server MUST NOT send an encrypted TLS record with application data 0x00 alert before it has successfully processed the client finished and sent its last handshake message.<a href="#section-2.5-4" class="pilcrow">Â¶</a></p>
<p id="section-2.5-5">TLS Error alerts SHOULD be considered a failure result indication, as defined in <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span>. Implementations following <span>[<a href="#RFC4137" class="xref">RFC4137</a>]</span> sets the alternate indication of failure variable altReject after sending or receiving an error alert. After sending or receiving a TLS Error alert, the EAP-TLS server may only send an EAP-Failure. Protected TLS Error alerts are protected failure result indications, unprotected TLS Error alerts are not.<a href="#section-2.5-5" class="pilcrow">Â¶</a></p>
<p id="section-2.5-6">The keying material can be derived after the TLS server Finished has been sent or received. Implementations following <span>[<a href="#RFC4137" class="xref">RFC4137</a>]</span> can then set the eapKeyData and aaaEapKeyData variables.<a href="#section-2.5-6" class="pilcrow">Â¶</a></p>
<p id="section-2.5-7">The keying material can be made available to lower layers and the authenticator after the authenticated success result indication has been sent or received. Implementations following <span>[<a href="#RFC4137" class="xref">RFC4137</a>]</span> can set the eapKeyAvailable and aaaEapKeyAvailable variables.<a href="#section-2.5-7" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
<section id="section-3">
      <h2 id="name-detailed-description-of-the">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-detailed-description-of-the" class="section-name selfRef">Detailed Description of the EAP-TLS Protocol</a>
      </h2>
<p id="section-3-1">No updates to Section 3 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-3-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-4">
      <h2 id="name-iana-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA considerations</a>
      </h2>
<p id="section-4-1">This section provides guidance to the Internet Assigned Numbers Authority (IANA) regarding registration of values related to the EAP-TLS 1.3 protocol in accordance with <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-4-1" class="pilcrow">Â¶</a></p>
<p id="section-4-2">This document requires IANA to add the following labels to the TLS Exporter Label Registry defined by <span>[<a href="#RFC5705" class="xref">RFC5705</a>]</span>. These labels are used in derivation of Key_Material and Method-Id as defined in <a href="#keyheirarchy" class="xref">Section 2.3</a>:<a href="#section-4-2" class="pilcrow">Â¶</a></p>
<span id="name-tls-exporter-label-registry"></span><div id="exporter-label">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-tls-exporter-label-registry" class="selfRef">TLS Exporter Label Registry</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">DTLS-OK</th>
            <th class="text-left" rowspan="1" colspan="1">Recommended</th>
            <th class="text-left" rowspan="1" colspan="1">Note</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">EXPORTER_EAP_TLS_Key_Material</td>
            <td class="text-left" rowspan="1" colspan="1">N</td>
            <td class="text-left" rowspan="1" colspan="1">Y</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">EXPORTER_EAP_TLS_Method-Id</td>
            <td class="text-left" rowspan="1" colspan="1">N</td>
            <td class="text-left" rowspan="1" colspan="1">Y</td>
            <td class="text-left" rowspan="1" colspan="1"></td>
          </tr>
        </tbody>
      </table>
</div>
</section>
<div id="seccon">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<section id="section-5.1">
        <h3 id="name-security-claims">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-security-claims" class="section-name selfRef">Security Claims</a>
        </h3>
<p id="section-5.1-1">Using EAP-TLS with TLS 1.3 does not change the security claims for EAP-TLS as given in Section 5.1 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>. However, it strengthens several of the claims as described in the following updates to the notes given in Section 5.1 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-5.1-1" class="pilcrow">Â¶</a></p>
<p id="section-5.1-2">[1] Mutual authentication: By mandating revocation checking of certificates, the authentication in EAP-TLS with TLS 1.3 is stronger as authentication with revoked certificates will always fail.<a href="#section-5.1-2" class="pilcrow">Â¶</a></p>
<p id="section-5.1-3">[2] Confidentiality: The TLS 1.3 handshake offers much better confidentiality than earlier versions of TLS. EAP-TLS with TLS 1.3 mandates use of cipher suites that ensure confidentiality. TLS 1.3 also encrypts certificates and some of the extensions. When using EAP-TLS with TLS 1.3, the use of privacy is mandatory and does not cause any additional round-trips.<a href="#section-5.1-3" class="pilcrow">Â¶</a></p>
<p id="section-5.1-4">[3] Cryptographic strength: TLS 1.3 only defines strong algorithms without major weaknesses and EAP-TLS with TLS 1.3 always provides forward secrecy, see [RFC8446]. Weak algorithms such as 3DES, CBC mode, RC4, SHA-1, MD5, P-192, and RSA-1024 cannot be negotiated.<a href="#section-5.1-4" class="pilcrow">Â¶</a></p>
<p id="section-5.1-5">[4] Cryptographic Negotiation: The TLS layer handles the negotiation of cryptographic parameters. When EAP-TLS is used with TLS 1.3, EAP-TLS inherits the cryptographic negotiation of AEAD algorithm, HKDF hash algorithm, key exchange groups, and signature algorithm, see Section 4.1.1 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-5.1-5" class="pilcrow">Â¶</a></p>
</section>
<section id="section-5.2">
        <h3 id="name-peer-and-server-identities">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-peer-and-server-identities" class="section-name selfRef">Peer and Server Identities</a>
        </h3>
<p id="section-5.2-1">No updates to section 5.2 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>. Note that <a href="#identity" class="xref">Section 2.2</a> has additional discussion on identities.<a href="#section-5.2-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-5.3">
        <h3 id="name-certificate-validation">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-certificate-validation" class="section-name selfRef">Certificate Validation</a>
        </h3>
<p id="section-5.3-1">No updates to section 5.3 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-5.3-1" class="pilcrow">Â¶</a></p>
</section>
<section id="section-5.4">
        <h3 id="name-certificate-revocation">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-certificate-revocation" class="section-name selfRef">Certificate Revocation</a>
        </h3>
<p id="section-5.4-1">This section updates Section 5.4 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-5.4-1" class="pilcrow">Â¶</a></p>
<p id="section-5.4-2">There are a number of reasons (e.g., key compromise, CA compromise, privilege withdrawn, etc.) why EAP-TLS peer, EAP-TLS server, or sub-CA certificates have to be revoked before their expiry date. Revocation of the EAP-TLS server's certificate is complicated by the fact that the EAP-TLS peer may not have Internet connectivity until authentication completes.<a href="#section-5.4-2" class="pilcrow">Â¶</a></p>
<p id="section-5.4-3">When EAP-TLS is used with TLS 1.3, the revocation status of all the certificates in the certificate chains MUST be checked (except the trust anchor). An implementation may use Certificate Revocation List (CRL), Online Certificate Status Protocol (OSCP), or other standardized/proprietary methods for revocation checking. Examples of proprietary methods are non-standard formats for distribution of revocation lists as well as certificates with very short lifetime.<a href="#section-5.4-3" class="pilcrow">Â¶</a></p>
<p id="section-5.4-4">EAP-TLS servers supporting TLS 1.3 MUST implement Certificate Status Requests (OCSP stapling) as specified in <span>[<a href="#RFC6066" class="xref">RFC6066</a>]</span> and Section 4.4.2.1 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>. It is RECOMMENDED that EAP-TLS peers and EAP-TLS servers use OCSP stapling for verifying the status of the EAP-TLS server's certificate chain. When an EAP-TLS peer uses Certificate Status Requests to check the revocation status of the EAP-TLS server's certificate chain it MUST treat a CertificateEntry (except the trust anchor) without a valid CertificateStatus extension as invalid and abort the handshake with an appropriate alert. The OCSP status handling in TLS 1.3 is different from earlier versions of TLS, see Section 4.4.2.1 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>. In TLS 1.3 the OCSP information is carried in the CertificateEntry containing the associated certificate instead of a separate CertificateStatus message as in <span>[<a href="#RFC6066" class="xref">RFC6066</a>]</span>. This enables sending OCSP information for all certificates in the certificate chain (except the trust anchor).<a href="#section-5.4-4" class="pilcrow">Â¶</a></p>
<p id="section-5.4-5">To enable revocation checking in situations where EAP-TLS peers do not implement or use OCSP stapling, and where network connectivity is not available prior to authentication completion, EAP-TLS peer implementations MUST also support checking for certificate revocation after authentication completes and network connectivity is available. An EAP peer implementation SHOULD NOT trust the network (and any services) until it has verified the revocation status of the server certificate after receiving network connectivity. An EAP peer MUST use a secure transport to verify the revocation status of the server certificate. An EAP peer SHOULD NOT send any other traffic before revocation checking for the server certificate is complete.<a href="#section-5.4-5" class="pilcrow">Â¶</a></p>
</section>
<section id="section-5.5">
        <h3 id="name-packet-modification-attacks">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-packet-modification-attacks" class="section-name selfRef">Packet Modification Attacks</a>
        </h3>
<p id="section-5.5-1">This section updates Section 5.5 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-5.5-1" class="pilcrow">Â¶</a></p>
<p id="section-5.5-2">As described in <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span> and Section 5.5 of <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>, the only information that is integrity and replay protected in EAP-TLS are the parts of the TLS Data that TLS protects. All other information in the EAP-TLS message exchange including EAP-Request and EAP-Response headers, the identity in the identity response, EAP-TLS packet header fields, Type, and Flags, EAP-Success, and EAP-Failure can be modified, spoofed, or replayed.<a href="#section-5.5-2" class="pilcrow">Â¶</a></p>
<p id="section-5.5-3">Protected TLS Error alerts are protected failure result indications and enables the EAP-TLS peer and EAP-TLS server to determine that the failure result was not spoofed by an attacker. Protected failure result indications provide integrity and replay protection but MAY be unauthenticated. Protected failure results do not significantly improve availability as TLS 1.3 treats most malformed data as a fatal error.<a href="#section-5.5-3" class="pilcrow">Â¶</a></p>
</section>
<div id="secauth">
<section id="section-5.6">
        <h3 id="name-authorization">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-authorization" class="section-name selfRef">Authorization</a>
        </h3>
<p id="section-5.6-1">This is a new section when compared to <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>. The guidance in this section is relevant for EAP-TLS in general (regardless of the underlying TLS version used).<a href="#section-5.6-1" class="pilcrow">Â¶</a></p>
<p id="section-5.6-2">EAP servers will usually require the EAP peer to provide a valid certificate and will fail the connection if one is not provided. Some deployments may permit no peer authentication for some or all connections. When peer authentication is not used, EAP-TLS server implementations MUST take care to limit network access appropriately for unauthenticated peers and implementations MUST use resumption with caution to ensure that a resumed session is not granted more privilege than was intended for the original session. An example of limiting network access would be to invoke a vendor's walled garden or quarantine network functionality.<a href="#section-5.6-2" class="pilcrow">Â¶</a></p>
<p id="section-5.6-3">EAP-TLS is typically encapsulated in other protocols, such as PPP <span>[<a href="#RFC1661" class="xref">RFC1661</a>]</span>, RADIUS <span>[<a href="#RFC2865" class="xref">RFC2865</a>]</span>, Diameter <span>[<a href="#RFC6733" class="xref">RFC6733</a>]</span>, or PANA <span>[<a href="#RFC5191" class="xref">RFC5191</a>]</span>. The encapsulating protocols can also provide additional, non-EAP information to an EAP-TLS server. This information can include, but is not limited to, information about the authenticator, information about the EAP-TLS peer, or information about the protocol layers above or below EAP (MAC addresses, IP addresses, port numbers, WiFi SSID, etc.). EAP-TLS servers implementing EAP-TLS inside those protocols can make policy decisions and enforce authorization based on a combination of information from the EAP-TLS exchange and non-EAP information.<a href="#section-5.6-3" class="pilcrow">Â¶</a></p>
<p id="section-5.6-4">As noted in <a href="#identity" class="xref">Section 2.2</a>, the identity presented in EAP-Response/Identity is not authenticated by EAP-TLS and is therefore trivial for an attacker to forge, modify, or replay. Authorization and accounting MUST be based on authenticated information such as information in the certificate or the PSK identity and cached data provisioned for resumption as described in <a href="#secres" class="xref">Section 5.7</a>. Note that the requirements for Network Access Identifiers (NAIs) specified in Section 4 of <span>[<a href="#RFC7542" class="xref">RFC7542</a>]</span> still apply and MUST be followed.<a href="#section-5.6-4" class="pilcrow">Â¶</a></p>
<p id="section-5.6-5">EAP-TLS servers MAY reject conversations based on non-EAP information provided by the encapsulating protocol, for example, if the MAC address of the authenticator does not match the expected policy.<a href="#section-5.6-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="secres">
<section id="section-5.7">
        <h3 id="name-resumption-2">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-resumption-2" class="section-name selfRef">Resumption</a>
        </h3>
<p id="section-5.7-1">This is a new section when compared to <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>. The guidance in this section is relevant for EAP-TLS in general (regardless of the underlying TLS version used).<a href="#section-5.7-1" class="pilcrow">Â¶</a></p>
<p id="section-5.7-2">There are a number of security issues related to resumption that are not described in <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>. The problems, guidelines, and requirements in this section therefore applies to EAP-TLS when it is used with any version of TLS.<a href="#section-5.7-2" class="pilcrow">Â¶</a></p>
<p id="section-5.7-3">When resumption occurs, it is based on cached information at the TLS layer. To perform resumption in a secure way, the EAP-TLS peer and EAP-TLS server need to be able to securely retrieve authorization information such as certificate chains from the initial full handshake. This document uses the term "cached data" to describe such information. Authorization during resumption MUST be based on such cached data. The EAP-TLS peer and EAP-TLS server MAY perform fresh revocation checks on the cached certificate data. Any security policies for authorization MUST be followed also for resumption. The certificates may have been revoked since the initial full handshake and the authorizations of the other party may have reduced. If the cached revocation data is not sufficiently current, the EAP-TLS peer or EAP-TLS server MAY force a full TLS handshake.<a href="#section-5.7-3" class="pilcrow">Â¶</a></p>
<p id="section-5.7-4">There are two ways to retrieve the cached data from the original full handshake. The first method is that the EAP-TLS server and client cache the information locally. The cached information is identified by an identifier. For TLS versions before 1.3, the identifier can be the session ID, for TLS 1.3, the identifier is the PSK identity. The second method for retrieving cached information is via <span>[<a href="#RFC5077" class="xref">RFC5077</a>]</span> or <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, where the EAP-TLS server avoids storing information locally and instead encapsulates the information into a ticket or PSK which is sent to the client for storage. This ticket or PSK is encrypted using a key that only the EAP-TLS server knows. Note that the client still needs to cache the original handshake information locally and will use the session ID or PSK identity to lookup this information during resumption. However, the EAP-TLS server is able to decrypt the ticket or PSK to obtain the original handshake information.<a href="#section-5.7-4" class="pilcrow">Â¶</a></p>
<p id="section-5.7-5">The EAP-TLS server or EAP client MUST cache data during the initial full handshake sufficient to allow authorization decisions to be made during resumption. If cached data cannot be retrieved in a secure way, resumption MUST NOT be done.<a href="#section-5.7-5" class="pilcrow">Â¶</a></p>
<p id="section-5.7-6">The above requirements also apply if the EAP-TLS server expects some system to perform accounting for the session. Since accounting must be tied to an authenticated identity, and resumption does not supply such an identity, accounting is impossible without access to cached data. Therefore systems which expect to perform accounting for the session SHOULD cache an identifier which can be used in subsequent accounting.<a href="#section-5.7-6" class="pilcrow">Â¶</a></p>
<p id="section-5.7-7">As suggested in <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, EAP-TLS peers MUST NOT store resumption PSKs or tickets (and associated cached data) for longer than 604800 seconds (7 days), regardless of the PSK or ticket lifetime. The EAP-TLS peer MAY delete them earlier based on local policy. The cached data MAY also be removed on the EAP-TLS server or EAP-TLS peer if any certificate in the certificate chain has been revoked or has expired. In all such cases, an attempt at resumption results in a full TLS handshake instead.<a href="#section-5.7-7" class="pilcrow">Â¶</a></p>
<p id="section-5.7-8">Information from the EAP-TLS exchange (e.g., the identity provided in EAP-Response/Identity) as well as non-EAP information (e.g., IP addresses) may change between the initial full handshake and resumption. This change creates a "time-of-check time-of-use" (TOCTOU) security vulnerability. A malicious or compromised user could supply one set of data during the initial authentication, and a different set of data during resumption, potentially allowing them to obtain access that they should not have.<a href="#section-5.7-8" class="pilcrow">Â¶</a></p>
<p id="section-5.7-9">If any authorization, accounting, or policy decisions were made with information that has changed between the initial full handshake and resumption, and if change may lead to a different decision, such decisions MUST be reevaluated. It is RECOMMENDED that authorization, accounting, and policy decisions are reevaluated based on the information given in the resumption. EAP-TLS servers MAY reject resumption where the information supplied during resumption does not match the information supplied during the original authentication. If a safe decision is not possible, EAP-TLS servers SHOULD reject the resumption and continue with a full handshake.<a href="#section-5.7-9" class="pilcrow">Â¶</a></p>
<p id="section-5.7-10">Section 2.2 and 4.2.11 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> provides security considerations for TLS 1.3 resumption.<a href="#section-5.7-10" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="privcon">
<section id="section-5.8">
        <h3 id="name-privacy-considerations">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
        </h3>
<p id="section-5.8-1">This is a new section when compared to <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-5.8-1" class="pilcrow">Â¶</a></p>
<p id="section-5.8-2">TLS 1.3 offers much better privacy than earlier versions of TLS as discussed in <a href="#privacy" class="xref">Section 2.1.8</a>. In this section, we only discuss the privacy properties of EAP-TLS with TLS 1.3. For privacy properties of TLS 1.3 itself, see <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-5.8-2" class="pilcrow">Â¶</a></p>
<p id="section-5.8-3">EAP-TLS sends the standard TLS 1.3 handshake messages encapsulated in EAP packets. Additionally, the EAP-TLS peer sends an identity in the first EAP-Response. The other fields in the EAP-TLS Request and the EAP-TLS Response packets do not contain any cleartext privacy sensitive information.<a href="#section-5.8-3" class="pilcrow">Â¶</a></p>
<p id="section-5.8-4">Tracking of users by eavesdropping on identity responses or certificates is a well-known problem in many EAP methods. When EAP-TLS is used with TLS 1.3, all certificates are encrypted, and the username part of the identity response is not revealed (e.g., using anonymous NAIs). Note that even though all certificates are encrypted, the server's identity is only protected against passive attackers while client's identity is protected against both passive and active attackers. As with other EAP methods, even when privacy-friendly identifiers or EAP tunneling is used, the domain name (i.e., the realm) in the NAI is still typically visible. How much privacy sensitive information the domain name leaks is highly dependent on how many other users are using the same domain name in the particular access network. If all EAP-TLS peers have the same domain, no additional information is leaked. If a domain name is used by a small subset of the EAP-TLS peers, it may aid an attacker in tracking or identifying the user.<a href="#section-5.8-4" class="pilcrow">Â¶</a></p>
<p id="section-5.8-5">Without padding, information about the size of the client certificate is leaked from the size of the EAP-TLS packets. The EAP-TLS packets sizes may therefore leak information that can be used to track or identify the user. If all client certificates have the same length, no information is leaked. EAP-TLS peers SHOULD use record padding, see Section 5.4 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> to reduce information leakage of certificate sizes.<a href="#section-5.8-5" class="pilcrow">Â¶</a></p>
<p id="section-5.8-6">If anonymous NAIs are not used, the privacy-friendly identifiers need to be generated with care. The identities MUST be generated in a cryptographically secure way so that that it is computationally infeasible for an attacker to differentiate two identities belonging to the same user from two identities belonging to different users in the same realm. This can be achieved, for instance, by using random or pseudo-random usernames such as random byte strings or ciphertexts and only using the pseudo-random usernames a single time. Note that the privacy-friendly usernames also MUST NOT include substrings that can be used to relate the identity to a specific user. Similarly, privacy-friendly username MUST NOT be formed by a fixed mapping that stays the same across multiple different authentications.<a href="#section-5.8-6" class="pilcrow">Â¶</a></p>
<p id="section-5.8-7">An EAP-TLS peer with a policy allowing communication with EAP-TLS servers supporting only TLS 1.2 without privacy and with a static RSA key exchange is vulnerable to disclosure of the EAP-TLS peer username. An active attacker can in this case make the EAP-TLS peer believe that an EAP-TLS server supporting TLS 1.3 only supports TLS 1.2 without privacy. The attacker can simply impersonate the EAP-TLS server and negotiate TLS 1.2 with static RSA key exchange and send an TLS alert message when the EAP-TLS peer tries to use privacy by sending an empty certificate message. Since the attacker (impersonating the EAP-TLS server) does not provide a proof-of-possession of the private key until the Finished message when a static RSA key exchange is used, an EAP-TLS peer may inadvertently disclose its identity (username) to an attacker. Therefore, it is RECOMMENDED for EAP-TLS peers to not use EAP-TLS with TLS 1.2 and static RSA based cipher suites without privacy. This implies that an EAP-TLS peer SHOULD NOT continue the handshake if a TLS 1.2 EAP-TLS server sends an EAP-TLS/Request with a TLS alert message in response to an empty certificate message from the peer.<a href="#section-5.8-7" class="pilcrow">Â¶</a></p>
</section>
</div>
<section id="section-5.9">
        <h3 id="name-pervasive-monitoring">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-pervasive-monitoring" class="section-name selfRef">Pervasive Monitoring</a>
        </h3>
<p id="section-5.9-1">This is a new section when compared to <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-5.9-1" class="pilcrow">Â¶</a></p>
<p id="section-5.9-2">Pervasive monitoring refers to widespread surveillance of users. In the context of EAP-TLS, pervasive monitoring attacks can target EAP-TLS peer devices for tracking them (and their users) as and when they join a network. By encrypting more information, mandating the use of privacy, and always providing forward secrecy, EAP-TLS with TLS 1.3 offers much better protection against pervasive monitoring. In addition to the privacy attacks discussed above, surveillance on a large scale may enable tracking of a user over a wide geographical area and across different access networks. Using information from EAP-TLS together with information gathered from other protocols increases the risk of identifying individual users.<a href="#section-5.9-2" class="pilcrow">Â¶</a></p>
</section>
<section id="section-5.10">
        <h3 id="name-discovered-vulnerabilities">
<a href="#section-5.10" class="section-number selfRef">5.10. </a><a href="#name-discovered-vulnerabilities" class="section-name selfRef">Discovered Vulnerabilities</a>
        </h3>
<p id="section-5.10-1">This is a new section when compared to <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-5.10-1" class="pilcrow">Â¶</a></p>
<p id="section-5.10-2">Over the years, there have been several serious attacks on earlier versions of Transport Layer Security (TLS), including attacks on its most commonly used ciphers and modes of operation. <span>[<a href="#RFC7457" class="xref">RFC7457</a>]</span> summarizes the attacks that were known at the time of publishing and <span><a href="#RFC7525" class="xref">BCP 195</a> [<a href="#RFC7525" class="xref">RFC7525</a>]</span> provides recommendations for improving the security of deployed services that use TLS. However, many of the attacks are less serious for EAP-TLS as EAP-TLS only uses the TLS handshake and does not protect any application data. EAP-TLS implementations MUST mitigate known attacks. EAP-TLS implementations need to monitor and follow new EAP and TLS related security guidance and requirements such as <span>[<a href="#RFC8447" class="xref">RFC8447</a>]</span>, <span>[<a href="#RFC8996" class="xref">RFC8996</a>]</span>, <span>[<a href="#I-D.ietf-tls-md5-sha1-deprecate" class="xref">I-D.ietf-tls-md5-sha1-deprecate</a>]</span>.<a href="#section-5.10-2" class="pilcrow">Â¶</a></p>
</section>
<section id="section-5.11">
        <h3 id="name-cross-protocol-attacks">
<a href="#section-5.11" class="section-number selfRef">5.11. </a><a href="#name-cross-protocol-attacks" class="section-name selfRef">Cross-Protocol Attacks</a>
        </h3>
<p id="section-5.11-1">This is a new section when compared to <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span>.<a href="#section-5.11-1" class="pilcrow">Â¶</a></p>
<p id="section-5.11-2">Allowing the same certificate to be used in multiple protocols can potentially allow an attacker to authenticate via one protocol, and then "resume" that session in another protocol. <a href="#identity" class="xref">Section 2.2</a> above suggests that certificates typically have one or more FQDNs in the SAN extension. However, those fields are for EAP validation only, and do not indicate that the certificates are suitable for use on WWW (or other) protocol server on the named host.<a href="#section-5.11-2" class="pilcrow">Â¶</a></p>
<p id="section-5.11-3"><a href="#resumption" class="xref">Section 2.1.3</a> above suggests that authorization rules should be re-applied on resumption, but does not mandate this behavior. As a result, this cross-protocol resumption could allow the attacker to bypass authorization policies, and to obtain undesired access to secured systems. Along with making sure that appropriate authorization information is available and used during resumption, using different certificates and resumption caches for different protocols is RECOMMENDED to help keep different protocol usages separate.<a href="#section-5.11-3" class="pilcrow">Â¶</a></p>
</section>
</section>
</div>
<section id="section-6">
      <h2 id="name-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-normative-references">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3748">[RFC3748]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Carlson, J.</span>, and <span class="refAuthor">H. Levkowetz, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3748</span>, <span class="seriesInfo">DOI 10.17487/RFC3748</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3748">https://www.rfc-editor.org/info/rfc3748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5216">[RFC5216]</dt>
        <dd>
<span class="refAuthor">Simon, D.</span>, <span class="refAuthor">Aboba, B.</span>, and <span class="refAuthor">R. Hurst</span>, <span class="refTitle">"The EAP-TLS Authentication Protocol"</span>, <span class="seriesInfo">RFC 5216</span>, <span class="seriesInfo">DOI 10.17487/RFC5216</span>, <time datetime="2008-03" class="refDate">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5216">https://www.rfc-editor.org/info/rfc5216</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5705">[RFC5705]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Keying Material Exporters for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5705</span>, <span class="seriesInfo">DOI 10.17487/RFC5705</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5705">https://www.rfc-editor.org/info/rfc5705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6066">https://www.rfc-editor.org/info/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6960">[RFC6960]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Myers, M.</span>, <span class="refAuthor">Ankney, R.</span>, <span class="refAuthor">Malpani, A.</span>, <span class="refAuthor">Galperin, S.</span>, and <span class="refAuthor">C. Adams</span>, <span class="refTitle">"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"</span>, <span class="seriesInfo">RFC 6960</span>, <span class="seriesInfo">DOI 10.17487/RFC6960</span>, <time datetime="2013-06" class="refDate">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6960">https://www.rfc-editor.org/info/rfc6960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7542">[RFC7542]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"The Network Access Identifier"</span>, <span class="seriesInfo">RFC 7542</span>, <span class="seriesInfo">DOI 10.17487/RFC7542</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7542">https://www.rfc-editor.org/info/rfc7542</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8996">[RFC8996]</dt>
      <dd>
<span class="refAuthor">Moriarty, K.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Deprecating TLS 1.0 and TLS 1.1"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 8996</span>, <span class="seriesInfo">DOI 10.17487/RFC8996</span>, <time datetime="2021-03" class="refDate">March 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8996">https://www.rfc-editor.org/info/rfc8996</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-6.2">
        <h3 id="name-informative-references">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative references</a>
        </h3>
<dl class="references">
<dt id="IEEE-802.1X">[IEEE-802.1X]</dt>
        <dd>
<span class="refAuthor">Institute of Electrical and Electronics Engineers</span>, <span class="refTitle">"IEEE Standard for Local and metropolitan area networks -- Port-Based Network Access Control"</span>, <span class="seriesInfo">IEEE Standard 802.1X-2020 </span>, <time datetime="2020-02" class="refDate">February 2020</time>. </dd>
<dd class="break"></dd>
<dt id="IEEE-802.11">[IEEE-802.11]</dt>
        <dd>
<span class="refAuthor">Institute of Electrical and Electronics Engineers</span>, <span class="refTitle">"IEEE Standard for Information technologyâ€”Telecommunications and information exchange between systems Local and metropolitan area networksâ€”Specific requirements - Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications"</span>, <span class="seriesInfo">IEEE Standard 802.11-2020 </span>, <time datetime="2021-02" class="refDate">February 2021</time>. </dd>
<dd class="break"></dd>
<dt id="IEEE-802.1AE">[IEEE-802.1AE]</dt>
        <dd>
<span class="refAuthor">Institute of Electrical and Electronics Engineers</span>, <span class="refTitle">"IEEE Standard for Local and metropolitan area networks -- Media Access Control (MAC) Security"</span>, <span class="seriesInfo">IEEE Standard 802.1AE-2018 </span>, <time datetime="2018-12" class="refDate">December 2018</time>. </dd>
<dd class="break"></dd>
<dt id="TS.33.501">[TS.33.501]</dt>
        <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"Security architecture and procedures for 5G System"</span>, <span class="seriesInfo">3GPP TS 33.501 17.2.1</span>, <time datetime="2021-07" class="refDate">July 2021</time>. </dd>
<dd class="break"></dd>
<dt id="MulteFire">[MulteFire]</dt>
        <dd>
<span class="refAuthor">MulteFire</span>, <span class="refTitle">"MulteFire Release 1.1 specification"</span>, <time datetime="2019" class="refDate">2019</time>. </dd>
<dd class="break"></dd>
<dt id="PEAP">[PEAP]</dt>
        <dd>
<span class="refAuthor">Microsoft Corporation</span>, <span class="refTitle">"[MS-PEAP]: Protected Extensible Authentication Protocol (PEAP)"</span>, <time datetime="2021-04" class="refDate">April 2021</time>. </dd>
<dd class="break"></dd>
<dt id="RFC1661">[RFC1661]</dt>
        <dd>
<span class="refAuthor">Simpson, W., Ed.</span>, <span class="refTitle">"The Point-to-Point Protocol (PPP)"</span>, <span class="seriesInfo">STD 51</span>, <span class="seriesInfo">RFC 1661</span>, <span class="seriesInfo">DOI 10.17487/RFC1661</span>, <time datetime="1994-07" class="refDate">July 1994</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1661">https://www.rfc-editor.org/info/rfc1661</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2246">[RFC2246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">C. Allen</span>, <span class="refTitle">"The TLS Protocol Version 1.0"</span>, <span class="seriesInfo">RFC 2246</span>, <span class="seriesInfo">DOI 10.17487/RFC2246</span>, <time datetime="1999-01" class="refDate">January 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2246">https://www.rfc-editor.org/info/rfc2246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2560">[RFC2560]</dt>
        <dd>
<span class="refAuthor">Myers, M.</span>, <span class="refAuthor">Ankney, R.</span>, <span class="refAuthor">Malpani, A.</span>, <span class="refAuthor">Galperin, S.</span>, and <span class="refAuthor">C. Adams</span>, <span class="refTitle">"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"</span>, <span class="seriesInfo">RFC 2560</span>, <span class="seriesInfo">DOI 10.17487/RFC2560</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2560">https://www.rfc-editor.org/info/rfc2560</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2865">[RFC2865]</dt>
        <dd>
<span class="refAuthor">Rigney, C.</span>, <span class="refAuthor">Willens, S.</span>, <span class="refAuthor">Rubens, A.</span>, and <span class="refAuthor">W. Simpson</span>, <span class="refTitle">"Remote Authentication Dial In User Service (RADIUS)"</span>, <span class="seriesInfo">RFC 2865</span>, <span class="seriesInfo">DOI 10.17487/RFC2865</span>, <time datetime="2000-06" class="refDate">June 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2865">https://www.rfc-editor.org/info/rfc2865</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3280">[RFC3280]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refAuthor">Polk, W.</span>, <span class="refAuthor">Ford, W.</span>, and <span class="refAuthor">D. Solo</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 3280</span>, <span class="seriesInfo">DOI 10.17487/RFC3280</span>, <time datetime="2002-04" class="refDate">April 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3280">https://www.rfc-editor.org/info/rfc3280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4137">[RFC4137]</dt>
        <dd>
<span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Eronen, P.</span>, <span class="refAuthor">Petroni, N.</span>, and <span class="refAuthor">Y. Ohba</span>, <span class="refTitle">"State Machines for Extensible Authentication Protocol (EAP) Peer and Authenticator"</span>, <span class="seriesInfo">RFC 4137</span>, <span class="seriesInfo">DOI 10.17487/RFC4137</span>, <time datetime="2005-08" class="refDate">August 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4137">https://www.rfc-editor.org/info/rfc4137</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4282">[RFC4282]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Beadles, M.</span>, <span class="refAuthor">Arkko, J.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"The Network Access Identifier"</span>, <span class="seriesInfo">RFC 4282</span>, <span class="seriesInfo">DOI 10.17487/RFC4282</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4282">https://www.rfc-editor.org/info/rfc4282</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4346">[RFC4346]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.1"</span>, <span class="seriesInfo">RFC 4346</span>, <span class="seriesInfo">DOI 10.17487/RFC4346</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4346">https://www.rfc-editor.org/info/rfc4346</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4851">[RFC4851]</dt>
        <dd>
<span class="refAuthor">Cam-Winget, N.</span>, <span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Salowey, J.</span>, and <span class="refAuthor">H. Zhou</span>, <span class="refTitle">"The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)"</span>, <span class="seriesInfo">RFC 4851</span>, <span class="seriesInfo">DOI 10.17487/RFC4851</span>, <time datetime="2007-05" class="refDate">May 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4851">https://www.rfc-editor.org/info/rfc4851</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5077">[RFC5077]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span>, <span class="refAuthor">Zhou, H.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Transport Layer Security (TLS) Session Resumption without Server-Side State"</span>, <span class="seriesInfo">RFC 5077</span>, <span class="seriesInfo">DOI 10.17487/RFC5077</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5077">https://www.rfc-editor.org/info/rfc5077</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5191">[RFC5191]</dt>
        <dd>
<span class="refAuthor">Forsberg, D.</span>, <span class="refAuthor">Ohba, Y., Ed.</span>, <span class="refAuthor">Patil, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">A. Yegin</span>, <span class="refTitle">"Protocol for Carrying Authentication for Network Access (PANA)"</span>, <span class="seriesInfo">RFC 5191</span>, <span class="seriesInfo">DOI 10.17487/RFC5191</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5191">https://www.rfc-editor.org/info/rfc5191</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5247">[RFC5247]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Simon, D.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP) Key Management Framework"</span>, <span class="seriesInfo">RFC 5247</span>, <span class="seriesInfo">DOI 10.17487/RFC5247</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5247">https://www.rfc-editor.org/info/rfc5247</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5281">[RFC5281]</dt>
        <dd>
<span class="refAuthor">Funk, P.</span> and <span class="refAuthor">S. Blake-Wilson</span>, <span class="refTitle">"Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)"</span>, <span class="seriesInfo">RFC 5281</span>, <span class="seriesInfo">DOI 10.17487/RFC5281</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5281">https://www.rfc-editor.org/info/rfc5281</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6733">[RFC6733]</dt>
        <dd>
<span class="refAuthor">Fajardo, V., Ed.</span>, <span class="refAuthor">Arkko, J.</span>, <span class="refAuthor">Loughney, J.</span>, and <span class="refAuthor">G. Zorn, Ed.</span>, <span class="refTitle">"Diameter Base Protocol"</span>, <span class="seriesInfo">RFC 6733</span>, <span class="seriesInfo">DOI 10.17487/RFC6733</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6733">https://www.rfc-editor.org/info/rfc6733</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7170">[RFC7170]</dt>
        <dd>
<span class="refAuthor">Zhou, H.</span>, <span class="refAuthor">Cam-Winget, N.</span>, <span class="refAuthor">Salowey, J.</span>, and <span class="refAuthor">S. Hanna</span>, <span class="refTitle">"Tunnel Extensible Authentication Protocol (TEAP) Version 1"</span>, <span class="seriesInfo">RFC 7170</span>, <span class="seriesInfo">DOI 10.17487/RFC7170</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7170">https://www.rfc-editor.org/info/rfc7170</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7406">[RFC7406]</dt>
        <dd>
<span class="refAuthor">Schulzrinne, H.</span>, <span class="refAuthor">McCann, S.</span>, <span class="refAuthor">Bajko, G.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">D. Kroeselberg</span>, <span class="refTitle">"Extensions to the Emergency Services Architecture for Dealing With Unauthenticated and Unauthorized Devices"</span>, <span class="seriesInfo">RFC 7406</span>, <span class="seriesInfo">DOI 10.17487/RFC7406</span>, <time datetime="2014-12" class="refDate">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7406">https://www.rfc-editor.org/info/rfc7406</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7457">[RFC7457]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Summarizing Known Attacks on Transport Layer Security (TLS) and Datagram TLS (DTLS)"</span>, <span class="seriesInfo">RFC 7457</span>, <span class="seriesInfo">DOI 10.17487/RFC7457</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7457">https://www.rfc-editor.org/info/rfc7457</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7525">[RFC7525]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <span class="seriesInfo">DOI 10.17487/RFC7525</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7593">[RFC7593]</dt>
        <dd>
<span class="refAuthor">Wierenga, K.</span>, <span class="refAuthor">Winter, S.</span>, and <span class="refAuthor">T. Wolniewicz</span>, <span class="refTitle">"The eduroam Architecture for Network Roaming"</span>, <span class="seriesInfo">RFC 7593</span>, <span class="seriesInfo">DOI 10.17487/RFC7593</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7593">https://www.rfc-editor.org/info/rfc7593</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8447">[RFC8447]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"IANA Registry Updates for TLS and DTLS"</span>, <span class="seriesInfo">RFC 8447</span>, <span class="seriesInfo">DOI 10.17487/RFC8447</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8447">https://www.rfc-editor.org/info/rfc8447</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-md5-sha1-deprecate">[I-D.ietf-tls-md5-sha1-deprecate]</dt>
        <dd>
<span class="refAuthor">Velvindron, L.</span>, <span class="refAuthor">Moriarty, K.</span>, and <span class="refAuthor">A. Ghedini</span>, <span class="refTitle">"Deprecating MD5 and SHA-1 signature hashes in TLS 1.2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-md5-sha1-deprecate-07</span>, <time datetime="2021-05-17" class="refDate">17 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-tls-md5-sha1-deprecate-07.txt">https://www.ietf.org/archive/id/draft-ietf-tls-md5-sha1-deprecate-07.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-emu-eaptlscert">[I-D.ietf-emu-eaptlscert]</dt>
        <dd>
<span class="refAuthor">Sethi, M.</span>, <span class="refAuthor">Mattsson, J.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Handling Large Certificates and Long Certificate Chains in TLS-based EAP Methods"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-emu-eaptlscert-08</span>, <time datetime="2020-11-20" class="refDate">20 November 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-emu-eaptlscert-08.txt">https://www.ietf.org/archive/id/draft-ietf-emu-eaptlscert-08.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-ticketrequests">[I-D.ietf-tls-ticketrequests]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Schinazi, D.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"TLS Ticket Requests"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-ticketrequests-07</span>, <time datetime="2020-12-03" class="refDate">3 December 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-tls-ticketrequests-07.txt">https://www.ietf.org/archive/id/draft-ietf-tls-ticketrequests-07.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-emu-tls-eap-types">[I-D.ietf-emu-tls-eap-types]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"TLS-based EAP types and TLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-emu-tls-eap-types-03</span>, <time datetime="2021-06-22" class="refDate">22 June 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-emu-tls-eap-types-03.txt">https://www.ietf.org/archive/id/draft-ietf-emu-tls-eap-types-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-rfc8446bis">[I-D.ietf-tls-rfc8446bis]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-rfc8446bis-01</span>, <time datetime="2021-02-19" class="refDate">19 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-tls-rfc8446bis-01.txt">https://www.ietf.org/archive/id/draft-ietf-tls-rfc8446bis-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="updateref">
<section id="appendix-A">
      <h2 id="name-updated-references">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-updated-references" class="section-name selfRef">Updated References</a>
      </h2>
<p id="appendix-A-1">
 All the following references in <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> are updated as specified below when EAP-TLS is used with TLS 1.3.<a href="#appendix-A-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A-2">
 All references to <span>[<a href="#RFC2560" class="xref">RFC2560</a>]</span> are updated with <span>[<a href="#RFC6960" class="xref">RFC6960</a>]</span>.<a href="#appendix-A-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A-3">
 All references to <span>[<a href="#RFC3280" class="xref">RFC3280</a>]</span> are updated with <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.<a href="#appendix-A-3" class="pilcrow">Â¶</a></p>
<p id="appendix-A-4">
 All references to <span>[<a href="#RFC4282" class="xref">RFC4282</a>]</span> are updated with <span>[<a href="#RFC7542" class="xref">RFC7542</a>]</span>.<a href="#appendix-A-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">
 The authors want to thank Bernard Aboba, Jari Arkko, Terry Burton, Alan DeKok, Ari Keraenen, Benjamin Kaduk, Jouni Malinen, Oleg Pekar, Eric Rescorla, Jim Schaad, Joseph Salowey, Martin Thomson, Vesa Torvinen, Hannes Tschofenig, and Heikki Vatiainen for comments and suggestions on the draft. Special thanks to the document shepard Joseph Salowey.<a href="#appendix-B-1" class="pilcrow">Â¶</a></p>
</section>
<section id="appendix-C">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="appendix-C-1">
 Alan DeKok, FreeRADIUS<a href="#appendix-C-1" class="pilcrow">Â¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John PreuÃŸ Mattsson</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">164 40</span> <span class="locality"> Stockholm</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.mattsson@ericsson.com" class="email">john.mattsson@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mohit Sethi</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div dir="auto" class="left">FI-<span class="postal-code">02420</span> <span class="locality">Jorvas</span>
</div>
<div dir="auto" class="left"><span class="country-name">Finland</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mohit@piuha.net" class="email">mohit@piuha.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
