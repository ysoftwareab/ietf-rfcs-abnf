<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Fundamental Elliptic Curve Cryptography Algorithms</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Fundamental Elliptic Curve Cryptography Algorithms">
<meta name="keywords" content="Elliptic Curve Cryptography">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. McGrew</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">K. Igoe</td></tr>
<tr><td class="header">Expires: August 23, 2010</td><td class="header">National Security Agency</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 19, 2010</td></tr>
</table></td></tr></table>
<h1><br />Fundamental Elliptic Curve Cryptography Algorithms<br />draft-mcgrew-fundamental-ecc-02.txt</h1>

<h3>Abstract</h3>

<p>
This note describes the fundamental algorithms of Elliptic Curve
Cryptography (ECC) as they are defined in some early references.
These descriptions may be useful for implementing the
fundamental algorithms without using any of the specialized methods
that were developed in following years.  Only elliptic curves defined over
fields of characteristic greater than three are in scope; these curves
are those used in Suite B.

</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 23, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">1.1.</a>&nbsp;
Conventions Used In This Document<br />
<a href="#anchor2">2.</a>&nbsp;
Mathematical Background<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Mod">2.1.</a>&nbsp;
Modular Arithmetic<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#GROUP">2.2.</a>&nbsp;
Group Operations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#FIELD">2.3.</a>&nbsp;
Finite Fields<br />
<a href="#ECG">3.</a>&nbsp;
Elliptic Curve Groups<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.</a>&nbsp;
Homogeneous Coordinates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.2.</a>&nbsp;
Other Coordinates<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#params">3.3.</a>&nbsp;
ECC Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.3.1.</a>&nbsp;
Security<br />
<a href="#ECDH">4.</a>&nbsp;
Elliptic Curve Diffie-Hellman (ECDH)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.1.</a>&nbsp;
Data Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#REP">4.2.</a>&nbsp;
Compact Representation<br />
<a href="#ECES">5.</a>&nbsp;
Elliptic Curve ElGamal Signatures<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.1.</a>&nbsp;
Background<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#hash">5.2.</a>&nbsp;
Hash Functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#KTsigs">5.3.</a>&nbsp;
KT-IV Signatures<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#kpair">5.3.1.</a>&nbsp;
Keypair Generation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.3.2.</a>&nbsp;
Signature Creation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.3.3.</a>&nbsp;
Signature Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.4.</a>&nbsp;
KT-I Signatures<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.4.1.</a>&nbsp;
Keypair Generation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.4.2.</a>&nbsp;
Signature Creation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.4.3.</a>&nbsp;
Signature Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.5.</a>&nbsp;
Converting KT-IV signatures to KT-I signatures<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AECESrat">5.6.</a>&nbsp;
Rationale<br />
<a href="#Interop">6.</a>&nbsp;
Interoperability<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">6.1.</a>&nbsp;
ECDH<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SigInterop">6.2.</a>&nbsp;
KT-I and ECDSA<br />
<a href="#test">7.</a>&nbsp;
Validating an Implementation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ECDHtest">7.1.</a>&nbsp;
ECDH<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AECEStest">7.2.</a>&nbsp;
KT-I<br />
<a href="#IPR">8.</a>&nbsp;
Intellectual Property<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">8.1.</a>&nbsp;
Disclaimer<br />
<a href="#SEC">9.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">9.1.</a>&nbsp;
Subgroups<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">9.2.</a>&nbsp;
Diffie-Hellman<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#twogroups">9.3.</a>&nbsp;
Group Representation and Security<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#existential">9.4.</a>&nbsp;
Signatures<br />
<a href="#anchor19">10.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor20">11.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
<a href="#keywords">Appendix&nbsp;A.</a>&nbsp;
Key Words<br />
<a href="#rng">Appendix&nbsp;B.</a>&nbsp;
Random Integer Generation<br />
<a href="#Xonly">Appendix&nbsp;C.</a>&nbsp;
Why Compact Representation Works<br />
<a href="#Example">Appendix&nbsp;D.</a>&nbsp;
Example ECC Parameter Set<br />
<a href="#notation">Appendix&nbsp;E.</a>&nbsp;
Additive and multiplicative notation<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
ECC is a public-key technology that offers performance advantages at
higher security levels.  It includes an Elliptic Curve version of
Diffie-Hellman key exchange protocol <a class='info' href='#DH1976'>[DH1976]<span> (</span><span class='info'>Diffie, W. and M. Hellman, &ldquo;New Directions in Cryptography,&rdquo; 1976.</span><span>)</span></a> and 
Elliptic Curve versions of the ElGamal Signature Algorithm
<a class='info' href='#E1985'>[E1985]<span> (</span><span class='info'>ElGamal, T., &ldquo;A public key cryptosystem and a signature scheme            based on discrete logarithms,&rdquo; 1985.</span><span>)</span></a>.  
The adoption of ECC has been slower than had been anticipated,
 perhaps due to the lack of freely available normative documents and
 uncertainty over intellectual property rights.

</p>
<p>
This note contains a description of the fundamental algorithms of ECC
over fields with characteristic greater than three, based directly on
original references.  Its intent is to provide the Internet community
with a summary of the basic algorithms that predate any specialized or
optimized algorithms, which can be used as a normative specification.
The original descriptions and notations were followed as closely
as possible.

</p>
<p>
There are several standards that specify or incorporate ECC
algorithms, including the Internet Key Exchange (IKE), ANSI X9.62, and
IEEE P1363.  The algorithms in this note can interoperate with some of
the algorithms in these standards, with a suitable choice of
parameters and options.  
The specifics are itemized in
<a class='info' href='#Interop'>Section&nbsp;6<span> (</span><span class='info'>Interoperability</span><span>)</span></a>.

</p>
<p>
The rest of the note is organized as follows.  <a class='info' href='#Mod'>Section&nbsp;2.1<span> (</span><span class='info'>Modular Arithmetic</span><span>)</span></a>,
<a class='info' href='#GROUP'>Section&nbsp;2.2<span> (</span><span class='info'>Group Operations</span><span>)</span></a>, and <a class='info' href='#FIELD'>Section&nbsp;2.3<span> (</span><span class='info'>Finite Fields</span><span>)</span></a> furnish the
necessary terminology and notation from modular arithmetic, group
theory and the theory of finite fields, respectively.
<a class='info' href='#ECG'>Section&nbsp;3<span> (</span><span class='info'>Elliptic Curve Groups</span><span>)</span></a> defines the groups based on elliptic curves over
finite fields of characteristic greater than three.
<a class='info' href='#ECDH'>Section&nbsp;4<span> (</span><span class='info'>Elliptic Curve Diffie-Hellman (ECDH)</span><span>)</span></a> presents the fundamental ECDH algorithm.
<a class='info' href='#ECES'>Section&nbsp;5<span> (</span><span class='info'>Elliptic Curve ElGamal Signatures</span><span>)</span></a> presents elliptic curve versions of the ElGamal
signature method.
Sections 2 through 5, inclusive, 
contain all of the
normative text (the text that defines the norm for
implementations conforming to this specification), and all of the
following sections are purely informative.  Interoperability is
discussed in <a class='info' href='#Interop'>Section&nbsp;6<span> (</span><span class='info'>Interoperability</span><span>)</span></a>.  
Validation testing is described in <a class='info' href='#test'>Section&nbsp;7<span> (</span><span class='info'>Validating an Implementation</span><span>)</span></a>.
<a class='info' href='#IPR'>Section&nbsp;8<span> (</span><span class='info'>Intellectual Property</span><span>)</span></a> reviews
intellectual property issues.  <a class='info' href='#SEC'>Section&nbsp;9<span> (</span><span class='info'>Security Considerations</span><span>)</span></a> summarizes
security considerations.  
<a class='info' href='#rng'>Appendix&nbsp;B<span> (</span><span class='info'>Random Integer Generation</span><span>)</span></a> describes random number
generation, and other appendices provide clarifying details.  

</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Conventions Used In This Document</h3>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in <a class='info' href='#keywords'>Appendix&nbsp;A<span> (</span><span class='info'>Key Words</span><span>)</span></a>.

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Mathematical Background</h3>

<p>
This section reviews mathematical preliminaries and establishes
terminology and notation that is used below.

</p>
<a name="Mod"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Modular Arithmetic</h3>

<p>
This section reviews modular arithmetic.  Two integers x and y are
said to be congruent modulo n if x - y is an integer multiple of n.

</p>
<p>
Two integers x and y are coprime when their greatest common divisor is
1; in this case, there is no third number z > 1 such that z divides x and
z divides y.

</p>
<p>
The set Zq = { 0, 1, 2, ..., q-1 } is closed under the operations of
modular addition, modular subtraction, modular multiplication, and
modular inverse.  These operations are as follows.  
</p>
<blockquote class="text">
<p>
For each pair of integers a and b in Zq, a + b mod q is equal to
<br />
 a + b if a + b < q, and is equal to a + b - q
otherwise.

</p>
<p>
For each pair of integers a and b in Zq, a - b mod q is equal to
<br />
 a - b if a - b >= 0, and is equal to a - b + q
otherwise.

</p>
<p>
For each pair of integers a and b in Zq, a * b mod q is equal to the remainder
of a * b divided by q.

</p>
<p>
For each integer x in Zq that is coprime with q, the inverse of x modulo q is
denoted as 1 / x mod q, and can be computed using the extended
euclidean algorithm (see Section 4.5.2 of <a class='info' href='#K1981v2'>[K1981v2]<span> (</span><span class='info'>Knuth, D., &ldquo;The Art of Computer Programming, Vol. 2: Seminumerical Algorithms,&rdquo; 1981.</span><span>)</span></a>, for
example).

</p>
</blockquote><p>
Algorithms for these operations are well known; for instance, see Chapter
4 of <a class='info' href='#K1981v2'>[K1981v2]<span> (</span><span class='info'>Knuth, D., &ldquo;The Art of Computer Programming, Vol. 2: Seminumerical Algorithms,&rdquo; 1981.</span><span>)</span></a>.

</p>
<a name="GROUP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Group Operations</h3>

<p>
This section establishes some terminology and notation for
mathematical groups, which is needed later on.  Background references
abound; see <a class='info' href='#D1966'>[D1966]<span> (</span><span class='info'>Deskins, W., &ldquo;Abstract Algebra,&rdquo; 1966.</span><span>)</span></a>, for example.

</p>
<p>
A group is a set of elements G together with an operation that
combines any two elements in G and returns a third element in G.  The
operation is denoted as * and its application is denoted as a * b, for
any two elements a and b in G.  The operation is associative, that is,
for all a, b and c in G, a * (b * c) is identical to (a * b) * c.
Repeated application of the group operation N-1 times to the element a
is denoted as a^N, for any element a in G and any positive integer N.
That is, a^2, = a * a, a^3 = a * a * a, and so on.  The associativity
of the group operation ensures that the computation of a^n is
unambiguous; any grouping of the terms gives the same result.

</p>
<p>
The above definition of a group operation uses multiplicative
notation.  Sometimes an alternative called additive notation is used,
in which a * b is denoted as a + b, and a^N is denoted as N * a.  In
multiplicative notation, g^N is called exponentiation, while the
equivalent operation in additive notation is called scalar
multiplication.  In this document, multiplicative notation is used
throughout for consistency.   <a class='info' href='#notation'>Appendix&nbsp;E<span> (</span><span class='info'>Additive and multiplicative notation</span><span>)</span></a> 
elucidates the correspondence between the two notations.

</p>
<p>
Every group has a special element called the identity element, which
we denote as e.  For each element a in G, e * a = a * e = a.  By 
convention, a^0 is equal to the identity element for any a in G.  

</p>
<p>
Every group element a has a unique inverse element b such that <br />

a * b =
b * a = e.  The inverse of a is denoted as a^-1 in multiplicative
notation.  (In additive notation, the inverse of a is denoted as -a.)

</p>
<p>
For any positive integer X, a^(-X) is defined to be (a^-1)^(X). Using
this convention, exponentiation behaves as one would expect, namely
for any integers X and Y:
</p>
<blockquote class="text">
<p> a^(X+Y) = (a^X)*(a^Y) 
</p>
<p> (a^X)^Y = a^(XY) = (a^Y)^X. 
</p>
</blockquote><p>
A group element a is said to have finite order if a^X = e for some
positive integer X, and the order of a is the smallest such X. If no
such X exists, a is said to have infinite order. In cryptographic
applications one typically deals with finite groups (groups with a
finite number of elements), and all elements of finite groups have
finite order. If a group element a has order R, then for any integers
X and Y,
</p>
<blockquote class="text">
<p> a^X = a^(X mod R), 
</p>
<p> a^X = a^Y if and only if X is congruent to Y mod R, 
</p>
<p>
  the set H = { a, a^2, a^3, ... , a^R=e } forms a subgroup of G, 
  called the cyclic subgroup generated by a, and a is said to be a 
  generator of H. 

</p>
</blockquote><p>

</p>
<p>
 Typically there are several group elements that generate H. Any
 group element of the form a^M, with M relatively prime to R, also
 generates H.

Note that a^M is equal to g^(M modulo R) for any non-negative integer M.   
 

</p>
<p>
Given the element a of order R, and an integer i between 1 and R-1,
inclusive, the element a^i can be computed by the "square and
multiply" method outlined in Section 2.1
of <a class='info' href='#M1983'>[M1983]<span> (</span><span class='info'>Massey, J., &ldquo;Logarithms in finite cyclic groups - cryptographic issues,&rdquo; 1983.</span><span>)</span></a> (see also Knuth, Vol. 2, Section
4.6.3.), or other methods.

</p>
<a name="FIELD"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Finite Fields</h3>

<p>
This section establishes terminology and notation for finite fields
with prime characteristic.

</p>
<p>
When p is a prime number, then the set Zp, with the 
addition, subtraction, multiplication and division operations, is a
finite field with characteristic p.  
Each nonzero element x in Zp has an inverse 1/x.
There is a one-to-one correspondence
between the integers between zero and p-1, inclusive, and the elements of the
field.  The field Zp is sometimes denoted as Fp.

</p>
<p>
Equations involving field elements do not explicitly denote the "mod p"
operation, but it is understood to be implicit.  For example,
the statement that x, y, and z are in Fp and 
</p>
<blockquote class="text">
<p>
  z = x + y 

</p>
</blockquote><p>
is equivalent to the statement that x, y, and z are in the set <br />
 
{ 0, 1, ..., p-1 } and
</p>
<blockquote class="text">
<p>
  z = x + y mod p.

</p>
</blockquote><p>

</p>
<a name="ECG"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Elliptic Curve Groups</h3>

<p>
This note only covers elliptic curves over fields with characteristic
greater than three; these are the curves used in Suite B <a class='info' href='#SuiteB'>[SuiteB]<span> (</span><span class='info'>, &ldquo;NSA Suite B Cryptography,&rdquo; .</span><span>)</span></a>.
  For other fields, the definition of the elliptic
curve group would be different.

</p>
<p>
An elliptic curve over a field Fp is defined by the curve equation 
</p>
<blockquote class="text">
<p>
y^2 = x^3 + a*x + b,  

</p>
</blockquote><p>
where x, y, a, and b are elements of the field Fp <a class='info' href='#M1985'>[M1985]<span> (</span><span class='info'>Miller, V., &ldquo;Use of elliptic curves in cryptography,&rdquo; 1985.</span><span>)</span></a>.  A point on an elliptic curve is a pair (x,y) of
values in Fp that satisfy the curve equation, such that x and y are
both in Fp, or it is a special point (@,@) that represents the identity
element (which is called the "point at infinity").  The order of an
elliptic curve group is the number of distinct points.

</p>
<p>
Two elliptic curve points (x1,y1) and (x2,y2) are equal whenever x1=x2
and y1=y2, or when both points are the point at infinity.
The inverse of the point (x1,y1) is the point (x1,-y1).
The point at infinity is its own inverse.

</p>
<p> 
The group operation associated with the elliptic curve group is as
follows <a class='info' href='#BC1989'>[BC1989]<span> (</span><span class='info'>Bender, A. and G. Castagnoli, &ldquo;On the Implementation of Elliptic Curve Cryptosystems,&rdquo; 1989.</span><span>)</span></a>.  To an arbitrary pair of points P and
Q specified by their coordinates (x1,y1) and (x2,y2) respectively, the
group operation assigns a third point P*Q with the coordinates
(x3,y3).  These coordinates are computed as follows
</p>
<blockquote class="text">
<p>
  (x3,y3) = (@,@) when P is not equal to Q and x1 is equal to x2.

</p>
<p>
   x3 = ((y2-y1)/(x2-x1))^2 - x1 - x2  and <br />

   y3 = (x1-x3)*(y2-y1)/(x2-x1) - y1 when P is not equal to Q and <br />
 
x1 is not equal to x2.

</p>
<p>
(x3,y3) = (@,@) when P is equal to Q and y1 is equal to 0,

</p>
<p>
x3 = ((3*x1^2 + a)/(2*y1))^2 - 2*x1  and <br />

y3 = (x1-x3)*(3*x1^2 + a)/(2*y1) - y1 if P is equal to Q and y1 is not equal to 0.

</p>
</blockquote><p>
In the above equations, a, x1, x2, x3, y1, y2, and y3 are elements of
the field Fp; thus, computation of x3 and y3 in practice 
must reduce the right-hand-side modulo p.

</p>
<p>
The representation of elliptic curve points as a pair of integers in
Zp is known as the affine coordinate representation.  This
representation is suitable as an external data representation for
communicating or storing group elements, though the point at infinity
must be treated as a special case.


</p>
<p>
Some pairs of integers are not valid elliptic curve points.  A valid
pair will satisfy the curve equation, while an invalid pair will not.

</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Homogeneous Coordinates</h3>

<p>
An alternative way to implement the group operation is to use
homogeneous coordinates <a class='info' href='#K1987'>[K1987]<span> (</span><span class='info'>Koblitz, N., &ldquo;Elliptic Curve Cryptosystems,&rdquo; 1987.</span><span>)</span></a> (see also <a class='info' href='#KMOV1991'>[KMOV1991]<span> (</span><span class='info'>Koyama, K., Maurer, U., Vanstone, S., and T. Okamoto, &ldquo;New Public-Key Schemes Based on Elliptic Curves over the Ring Zn,&rdquo; 1991.</span><span>)</span></a>).  This method is typically more efficient because
it does not require a modular inversion operation.

</p>
<p>
An elliptic curve point (x,y) (other than the point
at infinity (@,@)) is equivalent to a point (X,Y,Z) in
homogeneous coordinates whenever x=X/Z mod p and y=Y/Z mod p.

</p>
<p>
Let P1=(X1,Y1,Z1) and P2=(X2,Y2,Z2) be points on an elliptic curve and
suppose that the points P1, P2 are not equal to (@,@), P1 is not equal
to P2, and P1 is not equal to P2^-1.  Then the product P3=(X3,Y3,Z3) =
P1 * P2 is given by
</p>
<blockquote class="text">
<p>
X3 = v * (Z2 * (Z1 * u^2 - 2 * X1 * v^2) - v^3) mod p

</p>
<p>
Y3 = Z2 * (3 * X1 * u * v^2 - Y1 * v^3 - Z1 * u^3) + u * v^3 mod p

</p>
<p>
Z3 = v^3 * Z1 * Z2 mod p

</p>
</blockquote><p>
where u = Y2 * Z1 - Y1 * Z2  mod p and v = X2 * Z1 - X1 * Z2  mod p.

</p>
<p>
When the points P1 and P2 are equal, then (X1/Z1, Y1/Z1) is equal to
(X2/Z2, Y2/Z2), which is true if and only if u and v are both equal to
zero.

</p>
<p>
The product P3=(X3,Y3,Z3) = P1 * P1 is given by 
</p>
<blockquote class="text">
<p>
  X3 = 2 * Y1 * Z1 * (w^2 - 8 * X1 * Y1^2 * Z1)  mod p

</p>
<p>
  Y3 = 4 * Y1^2 * Z1 * (3 * w * X1 - 2 * Y1^2 * Z1) - w^3 mod p

</p>
<p>
  Z3 = 8 * (Y1 * Z1)^3  mod p

</p>
</blockquote><p>

</p>
<p>
where w = 3 * X1^2 + a * Z1^2 mod p.
In the above equations, a, u, v, w, X1, X2, X3, Y1, Y2, Y3, Z1, Z2,
and Z3 are integers in the set Fp.

</p>
<p>
When converting from affine coordinates to homogeneous coordinates, 
it is convenient to set Z to 1.   When converting from homogeneous
coordinates to affine coordinates, it is necessary to perform
a modular inverse to find 1/Z mod p.  

</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Other Coordinates</h3>

<p>
Some other coordinate systems have been described; several are
documented in <a class='info' href='#CC1986'>[CC1986]<span> (</span><span class='info'>Chudnovsky, D. and G. Chudnovsky, &ldquo;Sequences of numbers generated by addition in formal              groups and new primality and factorization tests,&rdquo; December&nbsp;1986.</span><span>)</span></a>, including Jacobi coordinates.

</p>
<a name="params"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
ECC Parameters</h3>

<p>
In cryptographic contexts, an elliptic curve parameter set consists of
a cyclic subgroup of an elliptic curve together with a preferred
generator of that subgroup.   When working over a prime order finite
field with characteristic greater than three, an elliptic curve group
is completely specified by the following parameters:
</p>
<blockquote class="text">
<p>
The prime number p that indicates the order of the field Fp.

</p>
<p>
The value a used in the curve equation.   

</p>
<p>
The value b used in the curve equation.

</p>
<p>
The generator g of the subgroup.  

</p>
<p>
The order n of the subgroup generated by g.

</p>
</blockquote><p>

</p>
<p>
An example of an ECC parameter set is provided in <a class='info' href='#Example'>Appendix&nbsp;D<span> (</span><span class='info'>Example ECC Parameter Set</span><span>)</span></a>.

</p>
<p>
Each elliptic curve point is associated with a particular parameter
set.  The elliptic curve group operation is only defined between two
points in the same group.  It is an error to apply the group operation
to two elements that are from different groups, or to apply the group
operation to a pair of coordinates that is not a valid point.  (A
pair (x,y) of coordinates in Fp is a valid point only when they
satisfy the curve equation.)  See <a class='info' href='#twogroups'>Section&nbsp;9.3<span> (</span><span class='info'>Group Representation and Security</span><span>)</span></a> for
further information.

</p>
<p>
For each elliptic curve group, the discriminant  - 16*(4*a^3 + 27*b^2) 
must be nonzero modulo p.

</p>
<p>
Parameter generation is out of scope for this note.  

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
Security</h3>

<p>
Security is highly dependent on the choice of these parameters.
This section gives normative guidance on acceptable choices.
See also <a class='info' href='#SEC'>Section&nbsp;9<span> (</span><span class='info'>Security Considerations</span><span>)</span></a> for informative guidance.

</p>
<p>
The order of the group generated by g MUST be divisible by a large
prime, in order to preclude easy solution of the discrete logarithm
problem <a class='info' href='#K1987'>[K1987]<span> (</span><span class='info'>Koblitz, N., &ldquo;Elliptic Curve Cryptosystems,&rdquo; 1987.</span><span>)</span></a>

</p>
<p>
With some parameter choices, the discrete log problem is significantly
easier to solve.  This includes parameter sets in which b = 0 and p = 3
(mod 4), and parameter sets in which a = 0 and 
<br />

p = 2 (mod 3)
<a class='info' href='#MOV1993'>[MOV1993]<span> (</span><span class='info'>Menezes, A., Vanstone, S., and T. Okamoto, &ldquo;Reducing Elliptic Curve Logarithms to 	     Logarithms in a Finite Field,&rdquo; September, 1993.</span><span>)</span></a>.  These parameter choices are inferior for
cryptographic purposes and SHOULD NOT be used.

</p>
<a name="ECDH"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Elliptic Curve Diffie-Hellman (ECDH)</h3>

<p>
The Diffie-Hellman (DH) key exchange protocol <a class='info' href='#DH1976'>[DH1976]<span> (</span><span class='info'>Diffie, W. and M. Hellman, &ldquo;New Directions in Cryptography,&rdquo; 1976.</span><span>)</span></a>
allows two parties communicating over an insecure channel to agree on
a secret key.  It was originally defined in terms of operations in the
multiplicative group of a field with a large prime characteristic.
Massey <a class='info' href='#M1983'>[M1983]<span> (</span><span class='info'>Massey, J., &ldquo;Logarithms in finite cyclic groups - cryptographic issues,&rdquo; 1983.</span><span>)</span></a> observed that it can be easily
generalized so that it is defined in terms of an arbitrary
mathematical group.  Miller <a class='info' href='#M1985'>[M1985]<span> (</span><span class='info'>Miller, V., &ldquo;Use of elliptic curves in cryptography,&rdquo; 1985.</span><span>)</span></a> and Koblitz <a class='info' href='#K1987'>[K1987]<span> (</span><span class='info'>Koblitz, N., &ldquo;Elliptic Curve Cryptosystems,&rdquo; 1987.</span><span>)</span></a> analyzed the DH protocol over an elliptic curve
group.  We describe DH following the former reference.

</p>
<p>
Let G be a group, and g be a generator for that group, and let t
denote the order of G.  The DH protocol runs as follows.  Party A
chooses an exponent j between 1 and t-1, inclusive, uniformly at
random, computes g^j and sends that element to B.  Party B chooses an
exponent k between 1 and t-1, inclusive, uniformly at random, computes
g^k and sends that element to A.  Each party can compute g^(j*k);
party A computes (g^k)^j, and party B computes (g^j)^k.

</p>
<p>
See <a class='info' href='#rng'>Appendix&nbsp;B<span> (</span><span class='info'>Random Integer Generation</span><span>)</span></a> regarding generation of random integers.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Data Types</h3>

<p>
An ECDH private key z is an integer in Zt.  

</p>
<p>
The corresponding ECDH public key Y is the group element, where Y =
g^z.  Each public key is associated with a particular particular
parameter set as per <a class='info' href='#params'>Section&nbsp;3.3<span> (</span><span class='info'>ECC Parameters</span><span>)</span></a>.

</p>
<p> 
The shared secret computed by both parties is a group element.

</p>
<p>
Each run of the ECDH protocol is associated with a particular parameter set,
and both of the public keys and the shared secret are elements of that
group.

</p>
<a name="REP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Compact Representation</h3>

<p>
As described in the final paragraph of <a class='info' href='#M1985'>[M1985]<span> (</span><span class='info'>Miller, V., &ldquo;Use of elliptic curves in cryptography,&rdquo; 1985.</span><span>)</span></a>, the
x-coordinate of the shared secret value g^(j*k) is a suitable
representative for the entire point whenever exponentiation is used as
a one-way function.  In the ECDH key exchange protocol, after the element
g^(j*k) has been computed, the x-coordinate of that value can be used
as the shared secret.  We call this compact output.

</p>
<p>
Following <a class='info' href='#M1985'>[M1985]<span> (</span><span class='info'>Miller, V., &ldquo;Use of elliptic curves in cryptography,&rdquo; 1985.</span><span>)</span></a> again, when compact output is used in
ECDH, only the x-coordinate of an elliptic curve point needs to be
transmitted, instead of both coordinates as in the typical affine
coordinate representation.  We call this the compact representation.
Its mathematical background is explained in <a class='info' href='#Xonly'>Appendix&nbsp;C<span> (</span><span class='info'>Why Compact Representation Works</span><span>)</span></a>. 

</p>
<p>
ECDH can be used with or without compact output.  Both parties in a
particular run of the ECDH protocol MUST use the same method.  ECDH
can be used with or without compact representation.  If compact
representation is used in a particular run of the ECDH protocol, then
compact output MUST be used as well.

</p>
<a name="ECES"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Elliptic Curve ElGamal Signatures</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Background</h3>

<p>
The ElGamal signature algorithm was introduced in 1984
<a class='info' href='#E1984a'>[E1984a]<span> (</span><span class='info'>ElGamal, T., &ldquo;Cryptography and logarithms over finite fields,&rdquo; 1984.</span><span>)</span></a> <a class='info' href='#E1984b'>[E1984b]<span> (</span><span class='info'>ElGamal, T., &ldquo;Cryptography and logarithms over finite fields,&rdquo; 1984.</span><span>)</span></a>
<a class='info' href='#E1985'>[E1985]<span> (</span><span class='info'>ElGamal, T., &ldquo;A public key cryptosystem and a signature scheme            based on discrete logarithms,&rdquo; 1985.</span><span>)</span></a>.  It is based on the discrete logarithm
problem, and was originally defined for the multiplicative group of
the integers modulo a large prime number.  It is straightforward to
extend it to use other finite groups, such as the multiplicative group
of the field GF(2^w) <a class='info' href='#AMV1990'>[AMV1990]<span> (</span><span class='info'>Agnew, G., Mullin, R., and S. Vanstone, &ldquo;Improved Digital Signature Scheme based on Discrete Exponentiation,&rdquo; July, 1990.</span><span>)</span></a> or an elliptic curve
group <a class='info' href='#A1992'>[A1992]<span> (</span><span class='info'>Anderson, J., &ldquo;Response to the proposed DSS,&rdquo; July&nbsp;1992.</span><span>)</span></a>.


</p>
<p>
An ElGamal signature consists of a pair of components.  There are many
possible generalizations of ElGamal signature methods that have been
obtained by different rearrangements of the equation for the second
component; see <a class='info' href='#HMP1994'>[HMP1994]<span> (</span><span class='info'>Horster, P., Michels, M., and H. Petersen, &ldquo;Meta-ElGamal signature schemes,&rdquo; May&nbsp;1994.</span><span>)</span></a>, <a class='info' href='#HP1994'>[HP1994]<span> (</span><span class='info'>Horster, P. and H. Petersen, &ldquo;Verallgemeinerte ElGamal-Signaturen,&rdquo; 1994.</span><span>)</span></a>,
<a class='info' href='#NR1994'>[NR1994]<span> (</span><span class='info'>Nyberg, K. and R. Rueppel, &ldquo;Message Recovery for Signature Schemes Based on the Discrete Logarithm Problem,&rdquo; May&nbsp;1994.</span><span>)</span></a>, <a class='info' href='#A1992'>[A1992]<span> (</span><span class='info'>Anderson, J., &ldquo;Response to the proposed DSS,&rdquo; July&nbsp;1992.</span><span>)</span></a>, and
<a class='info' href='#AMV1990'>[AMV1990]<span> (</span><span class='info'>Agnew, G., Mullin, R., and S. Vanstone, &ldquo;Improved Digital Signature Scheme based on Discrete Exponentiation,&rdquo; July, 1990.</span><span>)</span></a>.  These generalizations are independent of
the mathematical group used, and have been described for the
multiplicative group modulo a prime number, the multiplicative group
of GF(2^w), and elliptic curve groups
<a class='info' href='#HMP1994'>[HMP1994]<span> (</span><span class='info'>Horster, P., Michels, M., and H. Petersen, &ldquo;Meta-ElGamal signature schemes,&rdquo; May&nbsp;1994.</span><span>)</span></a><a class='info' href='#NR1994'>[NR1994]<span> (</span><span class='info'>Nyberg, K. and R. Rueppel, &ldquo;Message Recovery for Signature Schemes Based on the Discrete Logarithm Problem,&rdquo; May&nbsp;1994.</span><span>)</span></a>
<a class='info' href='#AMV1990'>[AMV1990]<span> (</span><span class='info'>Agnew, G., Mullin, R., and S. Vanstone, &ldquo;Improved Digital Signature Scheme based on Discrete Exponentiation,&rdquo; July, 1990.</span><span>)</span></a><a class='info' href='#A1992'>[A1992]<span> (</span><span class='info'>Anderson, J., &ldquo;Response to the proposed DSS,&rdquo; July&nbsp;1992.</span><span>)</span></a>.

</p>
<p> The Digital Signature Algorithm (DSA) <a class='info' href='#FIPS186'>[FIPS186]<span> (</span><span class='info'>, &ldquo;DIGITAL SIGNATURE STANDARD,&rdquo; May&nbsp;1994.</span><span>)</span></a> is
an important ElGamal signature variant.  

</p>
<a name="hash"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Hash Functions</h3>

<p>
ElGamal signatures must use a collision-resistant hash function, so
that it can sign messages of arbitrary length and can avoid
existential forgery attacks; see <a class='info' href='#existential'>Section&nbsp;9.4<span> (</span><span class='info'>Signatures</span><span>)</span></a>.  (This
is true for all ElGamal variants <a class='info' href='#HMP1994'>[HMP1994]<span> (</span><span class='info'>Horster, P., Michels, M., and H. Petersen, &ldquo;Meta-ElGamal signature schemes,&rdquo; May&nbsp;1994.</span><span>)</span></a>.)  We denote
the hash function as h().  Its input is a bit string of arbitrary
length, and its output is a non-negative integer.

</p>
<p>
Let H() denote a hash function whose output is a fixed-length bit
string.  To use H in an ElGamal signature method, we define the
mapping between that output and the non-negative integers;
this realizes the function h() described above.  Given a bit string m,
the function h(m) is computed as follows:
</p>
<ol class="text">
<li>
H(m) is evaluated; the result is a fixed-length bit string.

</li>
<li>
Convert the resulting bit string to an integer i by treating its
leftmost (initial) bit as the most significant bit of i, and treating
its rightmost (final) bit as the least significant bit of i.

</li>
</ol><p>

</p>
<a name="KTsigs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
KT-IV Signatures</h3>

<p>
Koyama and Tsuruoka described a signature method based on Elliptic
Curve ElGamal, in which the first signature component is the
x-coordinate of an elliptic curve point reduced modulo q
<a class='info' href='#KT1994'>[KT1994]<span> (</span><span class='info'>Koyama, K. and Y. Tsuruoka, &ldquo;Digital signature system based on elliptic curve 	     and signer device and verifier device for said system,&rdquo; February 18, 1994.</span><span>)</span></a>.  In this section we recall that method, which
we refer to as KT-IV.

</p>
<p>
The algorithm uses an elliptic curve group, as described in
<a class='info' href='#params'>Section&nbsp;3.3<span> (</span><span class='info'>ECC Parameters</span><span>)</span></a>, with prime field order p, and curve equation
parameters a and b.  We denote the generator as alpha, and the order
of the generator as q.  We follow <a class='info' href='#FIPS186'>[FIPS186]<span> (</span><span class='info'>, &ldquo;DIGITAL SIGNATURE STANDARD,&rdquo; May&nbsp;1994.</span><span>)</span></a> in checking
for exceptional cases.

</p>
<a name="kpair"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
Keypair Generation</h3>

<p>
The private key z is an integer between 1 and q - 1, inclusive,
generated uniformly at random.  (See <a class='info' href='#rng'>Appendix&nbsp;B<span> (</span><span class='info'>Random Integer Generation</span><span>)</span></a> regarding
random integers.)  The public key is the group element <br />
 Y =
alpha^z.
    
Each public key is associated with a particular particular
parameter set as per <a class='info' href='#params'>Section&nbsp;3.3<span> (</span><span class='info'>ECC Parameters</span><span>)</span></a>.

</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
Signature Creation</h3>

<p>
To compute a KT-IV signature for a message m using the private key
z:

</p>
<p>

</p>
<ol class="text">
<li>
    Choose an integer k uniformly at random from the set of all
    integers between 1 and q-1, inclusive.  (See <a class='info' href='#rng'>Appendix&nbsp;B<span> (</span><span class='info'>Random Integer Generation</span><span>)</span></a> regarding
    random integers.)
    
  
</li>
<li>
    Calculate R = (r_x, r_y) = alpha^k.  
  
</li>
<li>
    Calculate s1 = r_x mod q.
  
</li>
<li>
    Calculate s2 = k / (h(m) + z * s1)  mod q.
  
</li>
<li>
    As an option, one MAY check if s1 = 0 or s2 = 0. If either
    <br />
 s1 = 0 or s2 = 0, a new value of k SHOULD be generated
    and the signature SHOULD be recalculated.  (It is extremely
    unlikely that s1 = 0 or s2 = 0 if signatures are generated
    properly.)
  
</li>
</ol><p>
The signature is the ordered pair (s1, s2).    Both signature components
are non-negative integers.

</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.3"></a><h3>5.3.3.&nbsp;
Signature Verification</h3>

<p>
Given the message m, the public key Y, and the signature (s1, s2)
verification is as follows:
</p>
<ol class="text">
<li>
   Check to see that 0 < s1 < q and 0 < s2 < q; if either condition
   is violated, the signature SHALL be rejected.
  
</li>
<li>
    Compute the non-negative integers u1 and u2, where 
    
<blockquote class="text">
<p>
	u1 = h(m) * s2 mod q, and 
      
</p>
<p>
	u2 = s1 * s2 mod q.
      
</p>
</blockquote> 
  
</li>
<li>
    Compute the elliptic curve point R' = alpha^u1 * Y^u2.
  
</li>
<li>
    If the x-coordinate of R' mod q is equal to s1, then the signature and
    message pass the verification; otherwise, they fail.
  
</li>
</ol><p>

</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
KT-I Signatures</h3>

<p>
Horster, Michels, and Petersen categorized many different ElGamal
signature methods, demonstrated their equivalence, and
showed how to convert signatures of one type to another type
<a class='info' href='#HMP1994'>[HMP1994]<span> (</span><span class='info'>Horster, P., Michels, M., and H. Petersen, &ldquo;Meta-ElGamal signature schemes,&rdquo; May&nbsp;1994.</span><span>)</span></a>.  In their terminology, the signature method
of <a class='info' href='#KTsigs'>Section&nbsp;5.3<span> (</span><span class='info'>KT-IV Signatures</span><span>)</span></a> and <a class='info' href='#KT1994'>[KT1994]<span> (</span><span class='info'>Koyama, K. and Y. Tsuruoka, &ldquo;Digital signature system based on elliptic curve 	     and signer device and verifier device for said system,&rdquo; February 18, 1994.</span><span>)</span></a> is a Type IV
method, which is why it is denoted as KT-IV.

</p>
<p> A Type I KT signature method has a second component that is
computed in the same manner as that of the Digital Signature
Algorithm.  In this section, we describe this method, which we refer
to as KT-I.
 
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.1"></a><h3>5.4.1.&nbsp;
Keypair Generation</h3>

<p>
Keypairs and keypair generation are exactly as in <a class='info' href='#kpair'>Section&nbsp;5.3.1<span> (</span><span class='info'>Keypair Generation</span><span>)</span></a>.

</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.2"></a><h3>5.4.2.&nbsp;
Signature Creation</h3>

<p>
 To compute a KT-I signature for a message m using the private key
z:

</p>
<p>
</p>
<ol class="text">
<li>
    Choose an integer k uniformly at random from the set of all
    integers between 1 and q-1, inclusive.  (See <a class='info' href='#rng'>Appendix&nbsp;B<span> (</span><span class='info'>Random Integer Generation</span><span>)</span></a> regarding
    random integers.)
    
  
</li>
<li>
    Calculate R = (r_x, r_y) = alpha^k.  
  
</li>
<li>
    Calculate s1 = r_x mod q.
  
</li>
<li>
    Calculate s2 = (h(m) + z * s1) / k  mod q.
  
</li>
<li>
    As an option, one MAY check if s1 = 0 or s2 = 0. If either
    <br />
 s1 = 0 or s2 = 0, a new value of k SHOULD be generated
    and the signature SHOULD be recalculated.  (It is extremely
    unlikely that s1 = 0 or s2 = 0 if signatures are generated
    properly.)
  
</li>
</ol><p>
The signature is the ordered pair (s1, s2).    Both signature components
are non-negative integers.

</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.3"></a><h3>5.4.3.&nbsp;
Signature Verification</h3>

<p>
Given the message m, the public key Y, and the signature (s1, s2)
verification is as follows:
</p>
<ol class="text">
<li>
   Check to see that 0 < s1 < q and 0 < s2 < q; if either condition
   is violated the signature SHALL be rejected.  
  
</li>
<li>
    Compute s2_inv = 1 / s2 mod q. 
  
</li>
<li>
    Compute the non-negative integers u1 and u2, where 
    
<blockquote class="text">
<p>
	u1 = h(m) * s2_inv mod q, and 
      
</p>
<p>
	u2 = s1 * s2_inv mod q.
      
</p>
</blockquote> 
  
</li>
<li>
    Compute the elliptic curve point R' = alpha^u1 * Y^u2.
  
</li>
<li>
    If the x-coordinate of R' mod q is equal to s1, then the signature
    and message pass the verification; otherwise, they fail.
  
</li>
</ol><p>


</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Converting KT-IV signatures to KT-I signatures</h3>

<p>
A KT-IV signature for a message m and a public key Y can easily be
converted into a KT-I signature for the same message and public key.
If (s1, s2) is a KT-IV signature for a message m, then
<br />
 (s1, 1/s2 mod q) is a KT-I signature for the
same message <a class='info' href='#HMP1994'>[HMP1994]<span> (</span><span class='info'>Horster, P., Michels, M., and H. Petersen, &ldquo;Meta-ElGamal signature schemes,&rdquo; May&nbsp;1994.</span><span>)</span></a>.

</p>
<p>
The conversion operation uses only public information, and it
can be performed by the creator of the pre-conversion KT-IV signature, 
the verifier of the post-conversion KT-I signature, or by 
any other entity.  

</p>
<p>
An implementation MAY use this method to compute KT-I signatures.  

</p>
<a name="AECESrat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
Rationale</h3>

<p>
This subsection is not normative for this specification and is
provided only as background information.

</p>
<p>
<a class='info' href='#HMP1994'>[HMP1994]<span> (</span><span class='info'>Horster, P., Michels, M., and H. Petersen, &ldquo;Meta-ElGamal signature schemes,&rdquo; May&nbsp;1994.</span><span>)</span></a> presents many generalizations of ElGamal signatures.
Equation (5) of that reference shows the general signature equation
</p>
<blockquote class="text">
<p>
  A = x_A * B + k * C (mod q)
  
</p>
</blockquote><p>
where x_A is the private key, k is the secret value, and A, B, and C
are determined by the Type of the equation, as shown in Table 1 of
<a class='info' href='#HMP1994'>[HMP1994]<span> (</span><span class='info'>Horster, P., Michels, M., and H. Petersen, &ldquo;Meta-ElGamal signature schemes,&rdquo; May&nbsp;1994.</span><span>)</span></a>.  DSA <a class='info' href='#FIPS186'>[FIPS186]<span> (</span><span class='info'>, &ldquo;DIGITAL SIGNATURE STANDARD,&rdquo; May&nbsp;1994.</span><span>)</span></a> is an EG-I.1
signature method (as is KT-I), with A = m, B = -r, and C = s.  (Here
we use the notation of <a class='info' href='#HMP1994'>[HMP1994]<span> (</span><span class='info'>Horster, P., Michels, M., and H. Petersen, &ldquo;Meta-ElGamal signature schemes,&rdquo; May&nbsp;1994.</span><span>)</span></a> in which the first
signature component is r and the second signature component is s; in
KT-I and KT-IV these components are denoted as s1 and s2 respectively.
The private key x_A corresponds to the private key z.) Its signature
equation is
</p>
<blockquote class="text">
<p>
    m = - r * z + s * k   (mod q).
    
</p>
</blockquote><p>
The signature method of <a class='info' href='#KT1994'>[KT1994]<span> (</span><span class='info'>Koyama, K. and Y. Tsuruoka, &ldquo;Digital signature system based on elliptic curve 	     and signer device and verifier device for said system,&rdquo; February 18, 1994.</span><span>)</span></a> and
<a class='info' href='#KTsigs'>Section&nbsp;5.3<span> (</span><span class='info'>KT-IV Signatures</span><span>)</span></a> is an EG-IV.1 method, with A = m * s, B = - r
* s, C = 1.  Its signature equation is
</p>
<blockquote class="text">
<p>
  m * s = - r * s * z + k (mod q)
  
</p>
</blockquote><p>
The functions f and g mentioned in Table 1 are merely multiplication,
as described under the heading "Fifth generalization".

</p>
<p>
No hash function is shown in the above equations, but as described in
<a class='info' href='#existential'>Section&nbsp;9.4<span> (</span><span class='info'>Signatures</span><span>)</span></a>, a hash function should be applied to the message prior to
signing in order to prevent existential forgery attacks.

</p>
<p>
Nyberg and Rueppel <a class='info' href='#NR1994'>[NR1994]<span> (</span><span class='info'>Nyberg, K. and R. Rueppel, &ldquo;Message Recovery for Signature Schemes Based on the Discrete Logarithm Problem,&rdquo; May&nbsp;1994.</span><span>)</span></a> studied many different  
ElGamal signature methods, and defined "strong equivalence" as
follows:
</p>
<blockquote class="text">
<p> 
    Two signature methods are called strongly equivalent if the
    signature of the first scheme can be transformed efficiently into
    signatures of the second scheme and vice versa, without knowledge
    of the private key.
  
</p>
</blockquote><p>
KT-I and KT-IV signatures are obviously strongly equivalent.  

</p>
<p>
A valid signature with s2=0 leaks the secret key, since in that case
<br />
 z = - h(m) / s1 mod q.  
We follow
<a class='info' href='#FIPS186'>[FIPS186]<span> (</span><span class='info'>, &ldquo;DIGITAL SIGNATURE STANDARD,&rdquo; May&nbsp;1994.</span><span>)</span></a> in checking for this exceptional case and the case that s1=0.  
The s2=0 check was suggested by Rivest <a class='info' href='#R1992'>[R1992]<span> (</span><span class='info'>Rivest, R., &ldquo;Response to the proposed DSS,&rdquo; July&nbsp;1992.</span><span>)</span></a>
and is discussed in <a class='info' href='#BS1992'>[BS1992]<span> (</span><span class='info'>Branstad, D. and M. Smid, &ldquo;Response to Comments on the NIST Proposed Digital Signature Standard,&rdquo; August&nbsp;1992.</span><span>)</span></a>.

</p>
<p>
<a class='info' href='#KT1994'>[KT1994]<span> (</span><span class='info'>Koyama, K. and Y. Tsuruoka, &ldquo;Digital signature system based on elliptic curve 	     and signer device and verifier device for said system,&rdquo; February 18, 1994.</span><span>)</span></a> uses "a positive integer q' that does not
exceed q" when computing the signature component s1 from the
x-coordinate r_x of the elliptic curve point R = (r_x, r_y).  The
value q' is also used during signature validation when comparing the
x-coordinate of a computed elliptic curve point to the value to s1.
In this note, we use the simplifying convention that q' = q.

</p>
<a name="Interop"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Interoperability</h3>

<p>
The algorithms in this note can be used to interoperate with some
other ECC specifications.  This section provides details for each
algorithm.

</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
ECDH</h3>

<p>
<a class='info' href='#ECDH'>Section&nbsp;4<span> (</span><span class='info'>Elliptic Curve Diffie-Hellman (ECDH)</span><span>)</span></a> can be used with the Internet Key Exchange (IKE)
versions one <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a> or two <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.  These algorithms are compatible
with the ECP groups defined by
<a class='info' href='#RFC4753'>[RFC4753]<span> (</span><span class='info'>Fu, D. and J. Solinas, &ldquo;ECP Groups For IKE and IKEv2,&rdquo; January&nbsp;2007.</span><span>)</span></a>, <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a>, and <a class='info' href='#RFC2412'>[RFC2412]<span> (</span><span class='info'>Orman, H., &ldquo;The OAKLEY Key Determination Protocol,&rdquo; November&nbsp;1998.</span><span>)</span></a>.   The group definition used in this protocol
uses an affine coordinate representation of the public key
and uses neither the compact output nor the compact representation
of <a class='info' href='#REP'>Section&nbsp;4.2<span> (</span><span class='info'>Compact Representation</span><span>)</span></a>.
Note that some groups use a negative curve
parameter "a" and express this fact in the curve equation rather than
in the parameter.  The test cases in Section 8 of <a class='info' href='#RFC4753'>[RFC4753]<span> (</span><span class='info'>Fu, D. and J. Solinas, &ldquo;ECP Groups For IKE and IKEv2,&rdquo; January&nbsp;2007.</span><span>)</span></a> can be used to test an implementation; these cases
use the multiplicative notation, as does this note.  The KEi and KEr
payloads are equal to g^j and g^k, respectively, with 64 bits of
encoding data prepended to them.

</p>
<p>
The algorithms in <a class='info' href='#ECDH'>Section&nbsp;4<span> (</span><span class='info'>Elliptic Curve Diffie-Hellman (ECDH)</span><span>)</span></a> can be used to interoperate
with the IEEE <a class='info' href='#P1363'>[P1363]<span> (</span><span class='info'>, &ldquo;Standard Specifications for Public Key Cryptography,&rdquo; 2000.</span><span>)</span></a> and ANSI <a class='info' href='#X9.62'>[X9.62]<span> (</span><span class='info'>, &ldquo;Public Key Cryptography for the Financial Services                    Industry: The Elliptic Curve Digital Signature                    Algorithm (ECDSA),&rdquo; .</span><span>)</span></a>
standards for ECDH based on fields of characteristic greater than
three.  IEEE P1363 ECDH can be used in a manner that will interoperate with
this note, with the following options and parameter choices from that
specification: 
</p>
<blockquote class="text">
<p>
    prime curves with a cofactor of 1,
  
</p>
<p>
    the ECSVDP-DH primitive, and
  
</p>
<p>
    the Key Derivation Function must be the "identity" function
    (equivalently, the KDF step should be omitted and the shared secret
    value should be output directly).
    
</p>
</blockquote><p>

</p>
<a name="SigInterop"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
KT-I and ECDSA</h3>

<p>
The Digital Signature Algorithm (DSA) is based on the discrete
logarithm problem over the multiplicative subgroup of the finite field
with large prime order <a class='info' href='#DSA1991'>[DSA1991]<span> (</span><span class='info'>, &ldquo;DIGITAL SIGNATURE STANDARD,&rdquo; August&nbsp;1991.</span><span>)</span></a><a class='info' href='#FIPS186'>[FIPS186]<span> (</span><span class='info'>, &ldquo;DIGITAL SIGNATURE STANDARD,&rdquo; May&nbsp;1994.</span><span>)</span></a>.
The Elliptic Curve Digital Signature Algorithm (ECDSA) <a class='info' href='#P1363'>[P1363]<span> (</span><span class='info'>, &ldquo;Standard Specifications for Public Key Cryptography,&rdquo; 2000.</span><span>)</span></a> <a class='info' href='#X9.62'>[X9.62]<span> (</span><span class='info'>, &ldquo;Public Key Cryptography for the Financial Services                    Industry: The Elliptic Curve Digital Signature                    Algorithm (ECDSA),&rdquo; .</span><span>)</span></a> is an elliptic curve version
of DSA.

</p>
<p>
KT-I is mathematically and functionally equivalent to ECDSA,
and can interoperate with the IEEE <a class='info' href='#P1363'>[P1363]<span> (</span><span class='info'>, &ldquo;Standard Specifications for Public Key Cryptography,&rdquo; 2000.</span><span>)</span></a> and ANSI
<a class='info' href='#X9.62'>[X9.62]<span> (</span><span class='info'>, &ldquo;Public Key Cryptography for the Financial Services                    Industry: The Elliptic Curve Digital Signature                    Algorithm (ECDSA),&rdquo; .</span><span>)</span></a> standards for Elliptic Curve DSA (ECDSA) based
on fields of characteristic greater than three.  KT-I
signatures can be verified using the ECDSA verification
algorithm, and ECDSA signatures can be verified using the 
KT-I verification algorithm.

</p>
<a name="test"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Validating an Implementation</h3>

<p>
It is essential to validate the implementation
of a cryptographic algorithm.   This section outlines tests
that should be performed on the algorithms defined in this note.

</p>
<p>
A known answer test, or KAT, uses a fixed set of inputs to test an
algorithm; the output of the algorithm is compared with the expected
output, which is also a fixed value.  KATs for ECDH and KT-I are set
out in the following subsections.  

</p>
<p>
A consistency test generates inputs for one algorithm being tested
using a second algorithm that is also being tested, then checks the
output of the first algorithm.  A signature creation algorithm can be
tested for consistency against a signature verification algorithm.
Implementations of KT-I should be tested in this way.  Their signature
generation processes are non-deterministic, and thus cannot be tested
using a KAT.  Signature verification algorithms, on the other hand,
are deterministic and should be tested via a KAT.  This combination of
tests provides coverage for all of the operations, including keypair
generation.  Consistency testing should also be applied to ECDH.

</p>
<a name="ECDHtest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
ECDH</h3>

<p>
An ECDH implementation can be validated using the known answer test
cases from <a class='info' href='#RFC4753'>[RFC4753]<span> (</span><span class='info'>Fu, D. and J. Solinas, &ldquo;ECP Groups For IKE and IKEv2,&rdquo; January&nbsp;2007.</span><span>)</span></a>.  The correspondence between the
notation in that RFC and the notation in this note are summarized in
the following table.   (Refer to <a class='info' href='#params'>Section&nbsp;3.3<span> (</span><span class='info'>ECC Parameters</span><span>)</span></a> and 
<a class='info' href='#ECDH'>Section&nbsp;4<span> (</span><span class='info'>Elliptic Curve Diffie-Hellman (ECDH)</span><span>)</span></a>), and express the generator g in the affine
coordinate representation as (gx, gy).

</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">ECDH</th><th align="left">RFC 4753</th></tr>
<tr>
<td align="left"> order p of field Fp </td>
<td align="left"> p  </td>
</tr>
<tr>
<td align="left"> curve coefficient a  </td>
<td align="left"> -3  </td>
</tr>
<tr>
<td align="left"> curve coefficient b  </td>
<td align="left"> b  </td>
</tr>
<tr>
<td align="left"> generator g  </td>
<td align="left"> g=(gx, gy)  </td>
</tr>
<tr>
<td align="left"> private keys j and k </td>
<td align="left"> i and r </td>
</tr>
<tr>
<td align="left"> public keys g^j, g^k  </td>
<td align="left"> g^i = (gix, giy) and g^r = (grx, gry) </td>
</tr>
</table>
<br clear="all" />

<a name="AECEStest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
KT-I</h3>

<p>
A KT-I implementation can be validated using the known answer test
cases from <a class='info' href='#RFC4754'>[RFC4754]<span> (</span><span class='info'>Fu, D. and J. Solinas, &ldquo;IKE and IKEv2 Authentication Using the Elliptic Curve Digital Signature Algorithm (ECDSA),&rdquo; January&nbsp;2007.</span><span>)</span></a>.  The correspondence between the
notation in that RFC and the notation in this note are summarized in
the following table.

</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">KT-I</th><th align="left">RFC 4754</th></tr>
<tr>
<td align="left"> order p of field Fp  </td>
<td align="left"> p  </td>
</tr>
<tr>
<td align="left"> curve coefficient a  </td>
<td align="left"> -3  </td>
</tr>
<tr>
<td align="left"> curve coefficient b  </td>
<td align="left"> b  </td>
</tr>
<tr>
<td align="left"> generator alpha  </td>
<td align="left"> g  </td>
</tr>
<tr>
<td align="left"> group order q  </td>
<td align="left"> q  </td>
</tr>
<tr>
<td align="left"> private key z </td>
<td align="left"> w </td>
</tr>
<tr>
<td align="left"> public key Y </td>
<td align="left"> g^w = (gwx,gwy) </td>
</tr>
<tr>
<td align="left"> random k </td>
<td align="left"> ephem priv k </td>
</tr>
<tr>
<td align="left"> s1 </td>
<td align="left"> r </td>
</tr>
<tr>
<td align="left"> s2 </td>
<td align="left"> s </td>
</tr>
<tr>
<td align="left"> s2_inv </td>
<td align="left"> sinv </td>
</tr>
<tr>
<td align="left"> u1 </td>
<td align="left"> u = h*sinv mod q </td>
</tr>
<tr>
<td align="left"> u2 </td>
<td align="left"> v = r*sinv mod q </td>
</tr>
</table>
<br clear="all" />

<a name="IPR"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Intellectual Property</h3>

<p>
Concerns about intellectual property have slowed the adoption of ECC,
because a number of optimizations and specialized algorithms have
been patented in recent years.  

</p>
<p>
All of the normative references for ECDH (as defined in
<a class='info' href='#ECDH'>Section&nbsp;4<span> (</span><span class='info'>Elliptic Curve Diffie-Hellman (ECDH)</span><span>)</span></a>) were published during or before 1989, and those
for KT-I were published during or before May, 1994.  All of the
normative text for these algorithms is based solely on their
respective references.

</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Disclaimer</h3>

<p>
   This document is not intended as legal advice.  Readers are advised
   to consult their own legal advisers if they would like a legal
   interpretation of their rights.

</p>
<p>
   The IETF policies and processes regarding intellectual property and
   patents are outlined in <a class='info' href='#RFC3979'>[RFC3979]<span> (</span><span class='info'>Bradner, S., &ldquo;Intellectual Property Rights in IETF Technology,&rdquo; March&nbsp;2005.</span><span>)</span></a> and
   <a class='info' href='#RFC4879'>[RFC4879]<span> (</span><span class='info'>Narten, T., &ldquo;Clarification of the Third Party Disclosure Procedure in RFC 3979,&rdquo; April&nbsp;2007.</span><span>)</span></a> and at
   https://datatracker.ietf.org/ipr/about/.

</p>
<a name="SEC"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>
The security level of an elliptic curve cryptosystem is determined by
the cryptanalytic algorithm that is the least expensive for an
attacker to implement.   There are several algorithms to consider.

</p>
<p>
The Pohlig-Hellman method is a divide-and-conquer technique
<a class='info' href='#PH1978'>[PH1978]<span> (</span><span class='info'>Pohlig, S. and M. Hellman, &ldquo;An Improved Algorithm for Computing Logarithms over 	     GF(p) and its Cryptographic Significance,&rdquo; 1978.</span><span>)</span></a>.  If the group order n can be 
factored as
</p>
<blockquote class="text">
<p>
    n = q1 * q2 *  ... * qz,
    
</p>
</blockquote><p>
then the discrete log problem over the group can be solved by
independently solving a discrete log problem in groups of order q1,
q2, ..., qz, then combining the results using the Chinese remainder
theorem.   The overall computational cost is dominated by 
that of the discrete log problem in the subgroup with the
largest order. 

</p>
<p>
Shanks algorithm <a class='info' href='#K1981v3'>[K1981v3]<span> (</span><span class='info'>Knuth, D., &ldquo;The Art of Computer Programming, Vol. 3:            Sorting and Searching,&rdquo; 1981.</span><span>)</span></a> computes a discrete
logarithm in a group of order n using O(sqrt(n)) operations and
O(sqrt(n)) storage.  The Pollard rho algorithm <a class='info' href='#P1978'>[P1978]<span> (</span><span class='info'>Pollard, J., &ldquo;Monte Carlo methods for index computation mod p,&rdquo; 1978.</span><span>)</span></a>
computes a discrete logarithm in a group of order n using O(sqrt(n))
operations, with a negligible amount of storage, and can be
efficiently parallelized <a class='info' href='#VW1994'>[VW1994]<span> (</span><span class='info'>van Oorschot, P. and M. Wiener, &ldquo;Parallel Collision Search with Application to Hash Functions and Discrete Logarithms,&rdquo; 1994.</span><span>)</span></a>.

</p>
<p>
The Pollard lambda algorithm  <a class='info' href='#P1978'>[P1978]<span> (</span><span class='info'>Pollard, J., &ldquo;Monte Carlo methods for index computation mod p,&rdquo; 1978.</span><span>)</span></a> can 
solve the discrete logarithm problem using O(sqrt(w))
operations and O(log(w)) storage, when the exponent
is known to lie in an interval of width w.

</p>
<p>
The algorithms described above work in any group.  There
are specialized algorithms that specifically target
elliptic curve groups.  There are no known subexponential algorithms
against general elliptic curve groups, though
there are methods that target certain special 
elliptic curve groups; see <a class='info' href='#MOV1993'>[MOV1993]<span> (</span><span class='info'>Menezes, A., Vanstone, S., and T. Okamoto, &ldquo;Reducing Elliptic Curve Logarithms to 	     Logarithms in a Finite Field,&rdquo; September, 1993.</span><span>)</span></a>
and <a class='info' href='#FR1994'>[FR1994]<span> (</span><span class='info'>Frey, G. and H. Ruck, &ldquo;A remark concerning m-divisibility and the discrete 	     logarithm in the divisor class group of curves.,&rdquo; 1994.</span><span>)</span></a>.

</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Subgroups</h3>

<p>
A group consisting of a nonempty set of elements S with associated group
operation * is a subgroup of the group with the set of elements G, if
the latter group uses the same group operation and S is a subset of G.
For each elliptic curve equation, there is an elliptic curve group
whose group order is equal to the order of the elliptic curve; that
is, there is a group that contains every point on the curve.  

</p>
<p>
The order m of the elliptic curve is divisible by the order n of the
group associated with the generator; that is, for each elliptic curve
group, m = n * c for some number c.  The number c is called the
"cofactor" <a class='info' href='#P1363'>[P1363]<span> (</span><span class='info'>, &ldquo;Standard Specifications for Public Key Cryptography,&rdquo; 2000.</span><span>)</span></a>.  Each ECC parameter set as in <a class='info' href='#params'>Section&nbsp;3.3<span> (</span><span class='info'>ECC Parameters</span><span>)</span></a> is associated with a particular cofactor.

</p>
<p>
It is possible and desirable to use a cofactor equal to 1.  

</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
Diffie-Hellman</h3>

<p>
Note that the key exchange protocol as defined in
<a class='info' href='#ECDH'>Section&nbsp;4<span> (</span><span class='info'>Elliptic Curve Diffie-Hellman (ECDH)</span><span>)</span></a> does not protect against active attacks; Party A
must use some method to ensure that (g^k) originated with the intended
communicant B, rather than an attacker, and Party B must do the same
with (g^j).

</p>
<p>
It is not sufficient to authenticate the shared secret g^(j*k), since
this leaves the protocol open to attacks that manipulate the public
keys.  Instead, the values of the public keys g^x and g^y that are
exchanged should be directly authenticated.  This is the strategy used
by protocols that build on Diffie-Hellman and which use end-entity
authentication to protect against active attacks, such as OAKLEY <a class='info' href='#RFC2412'>[RFC2412]<span> (</span><span class='info'>Orman, H., &ldquo;The OAKLEY Key Determination Protocol,&rdquo; November&nbsp;1998.</span><span>)</span></a> and the Internet Key Exchange <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a><a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>.

</p>
<p>
When the cofactor of a group is not equal to 1, there are a number of
attacks that are possible against ECDH.   See <a class='info' href='#VW1996'>[VW1996]<span> (</span><span class='info'>van Oorschot, P. and M. Wiener, &ldquo;On Diffie-Hellman key agreement with short exponents,&rdquo; 1996.</span><span>)</span></a>,
<a class='info' href='#AV1996'>[AV1996]<span> (</span><span class='info'>Anderson, R. and S. Vaudenay, &ldquo;Minding Your P's and Q's,&rdquo; 1996.</span><span>)</span></a>, and <a class='info' href='#LL1997'>[LL1997]<span> (</span><span class='info'>Lim, C. and P. Lee, &ldquo;A Key Recovery Attack on Discrete Log-based Schemes 	     Using a Prime Order Subgroup,&rdquo; 1997.</span><span>)</span></a>.

</p>
<a name="twogroups"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
Group Representation and Security</h3>

<p>
The elliptic curve group operation does not explicitly incorporate the
parameter b from the curve equation.  This opens the possibility that
a malicious attacker could learn information about an ECDH private key
by submitting a bogus public key <a class='info' href='#BMM2000'>[BMM2000]<span> (</span><span class='info'>Biehl, I., Meyer, B., and V. Muller, &ldquo;Differential fault analysis on elliptic curve cryptosystems,&rdquo; 2000.</span><span>)</span></a>.  An
attacker can craft an elliptic curve group G' that has identical
parameters to a group G that is being used in an ECDH protocol, except
that b is different.  An attacker can submit a point on G' into a run
of the ECDH protocol that is using group G, and gain information from
the fact that the group operations using the private key of the device
under attack are effectively taking place in G' instead of G.

</p>
<p>
This attack can gain useful information about an ECDH private key that
is associated with a static public key, that is, a public key that is
used in more than one run of the protocol.  However, it does not
gain any useful information against ephemeral keys.

</p>
<p>
This sort of attack is thwarted if an ECDH implementation does not
assume that each pair of coordinates in Zp is actually a point on the
appropriate elliptic curve.

</p>
<p>
These considerations also apply when ECDH is used with compact representation
(see <a class='info' href='#Xonly'>Appendix&nbsp;C<span> (</span><span class='info'>Why Compact Representation Works</span><span>)</span></a>).

</p>
<a name="existential"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.4"></a><h3>9.4.&nbsp;
Signatures</h3>

<p>
Elliptic curve parameters should only be used if they come from a
trusted source; otherwise, some attacks are possible
<a class='info' href='#AV1996'>[AV1996]<span> (</span><span class='info'>Anderson, R. and S. Vaudenay, &ldquo;Minding Your P's and Q's,&rdquo; 1996.</span><span>)</span></a>, <a class='info' href='#V1996'>[V1996]<span> (</span><span class='info'>Vaudenay, S., &ldquo;Hidden Collisions on DSS,&rdquo; 1996.</span><span>)</span></a>.

</p>
<p>
If no hash function is used in an ElGamal signature system, then the
system is vulnerable to existential forgeries, in which an attacker
who does not know a private key can generate valid signatures for the
associated public key, but cannot generate a signature for a message
of its own choosing.  (See <a class='info' href='#E1985'>[E1985]<span> (</span><span class='info'>ElGamal, T., &ldquo;A public key cryptosystem and a signature scheme            based on discrete logarithms,&rdquo; 1985.</span><span>)</span></a> for instance.)  The
use of a collision-resistant hash function eliminates this
vulnerability.

</p>
<p>
In principle, any collision-resistant hash function is suitable for
use in KT signatures.  To facilitate interoperability, we recognize
the following hashes as suitable for use as the function H defined in
<a class='info' href='#hash'>Section&nbsp;5.2<span> (</span><span class='info'>Hash Functions</span><span>)</span></a>:
</p>
<blockquote class="text">
<p>
    SHA-256, which has a 256-bit output.  
  
</p>
<p>
    SHA-384, which has a 384-bit output.
  
</p>
<p>
    SHA-512, which has a 512-bit output.
  
</p>
</blockquote><p>
All of these hash functions are defined in <a class='info' href='#FIPS180-2'>[FIPS180&#8209;2]<span> (</span><span class='info'>, &ldquo;SECURE HASH STANDARD,&rdquo; August&nbsp;2002.</span><span>)</span></a>.

</p>
<p>
The number of bits in the output of the hash used in KT signatures
should be equal or close to the number of bits needed to represent the
group order.

</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>
This note has no actions for IANA.  This section should be removed by
the RFC editor before publication as an RFC.

</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgements</h3>

<p>
The author expresses his thanks to the originators of elliptic curve
cryptography, whose work made this note possible, and all of the
reviewers, who provided valuable constructive feedback.   Thanks
are especially due to Howard Pinder and Andrey Jivsov.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="AMV1990">[AMV1990]</a></td>
<td class="author-text">Agnew, G., Mullin, R., and S. Vanstone, &ldquo;Improved Digital Signature Scheme based on Discrete Exponentiation,&rdquo; Electronics Letters&nbsp;Vol. 26, No. 14, July, 1990.</td></tr>
<tr><td class="author-text" valign="top"><a name="BC1989">[BC1989]</a></td>
<td class="author-text">Bender, A. and G. Castagnoli, &ldquo;On the Implementation of Elliptic Curve Cryptosystems,&rdquo; Advances in Cryptology - CRYPTO '89 Proceedings&nbsp;Spinger Lecture Notes in Computer Science (LNCS) volume 435, 1989.</td></tr>
<tr><td class="author-text" valign="top"><a name="CC1986">[CC1986]</a></td>
<td class="author-text">Chudnovsky, D. and G. Chudnovsky, &ldquo;Sequences of numbers generated by addition in formal
             groups and new primality and factorization tests,&rdquo; Advances in Applied Mathematics&nbsp;Volume 7, Issue 4, December&nbsp;1986.</td></tr>
<tr><td class="author-text" valign="top"><a name="D1966">[D1966]</a></td>
<td class="author-text">Deskins, W., &ldquo;Abstract Algebra,&rdquo; MacMillan Company&nbsp;New York, 1966.</td></tr>
<tr><td class="author-text" valign="top"><a name="DH1976">[DH1976]</a></td>
<td class="author-text">Diffie, W. and M. Hellman, &ldquo;New Directions in Cryptography,&rdquo; IEEE Transactions in Information Theory&nbsp;IT-22, pp 644-654, 1976.</td></tr>
<tr><td class="author-text" valign="top"><a name="FR1994">[FR1994]</a></td>
<td class="author-text">Frey, G. and H. Ruck, &ldquo;A remark concerning m-divisibility and the discrete
	     logarithm in the divisor class group of curves.,&rdquo; Mathematics of Computation&nbsp;Vol. 62, No. 206, pp. 865-874, 1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="HMP1994">[HMP1994]</a></td>
<td class="author-text">Horster, P., Michels, M., and H. Petersen, &ldquo;Meta-ElGamal signature schemes,&rdquo; University of Technology Chemnitz-Zwickau Department of Computer Science Technical Report&nbsp;TR-94-5, May&nbsp;1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="K1981v2">[K1981v2]</a></td>
<td class="author-text">Knuth, D., &ldquo;The Art of Computer Programming, Vol. 2: Seminumerical Algorithms,&rdquo; Addison Wesley&nbsp;, 1981.</td></tr>
<tr><td class="author-text" valign="top"><a name="K1987">[K1987]</a></td>
<td class="author-text">Koblitz, N., &ldquo;Elliptic Curve Cryptosystems,&rdquo; Mathematics of Computation&nbsp;Vol. 48, 1987, 203-209, 1987.</td></tr>
<tr><td class="author-text" valign="top"><a name="KT1994">[KT1994]</a></td>
<td class="author-text">Koyama, K. and Y. Tsuruoka, &ldquo;Digital signature system based on elliptic curve
	     and signer device and verifier device for said system,&rdquo; Japanese Unexamined Patent Application
		     Publication&nbsp;H6-43809, February 18, 1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="M1983">[M1983]</a></td>
<td class="author-text">Massey, J., &ldquo;Logarithms in finite cyclic groups - cryptographic issues,&rdquo; Proceedings of the 4th Symposium on Information Theory&nbsp;, 1983.</td></tr>
<tr><td class="author-text" valign="top"><a name="M1985">[M1985]</a></td>
<td class="author-text">Miller, V., &ldquo;Use of elliptic curves in cryptography,&rdquo; Advances in Cryptology - CRYPTO '85 Proceedings&nbsp;Springer Lecture Notes in Computer Science (LNCS) volume 218, 1985.</td></tr>
<tr><td class="author-text" valign="top"><a name="MOV1993">[MOV1993]</a></td>
<td class="author-text">Menezes, A., Vanstone, S., and T. Okamoto, &ldquo;Reducing Elliptic Curve Logarithms to
	     Logarithms in a Finite Field,&rdquo; IEEE Transactions on Information Theory&nbsp;Vol 39, No. 5, pp. 1639-1646, September, 1993.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="A1992">[A1992]</a></td>
<td class="author-text">Anderson, J., &ldquo;Response to the proposed DSS,&rdquo; Communications of the ACM&nbsp;v.35 n.7 p.50-52, July&nbsp;1992.</td></tr>
<tr><td class="author-text" valign="top"><a name="AV1996">[AV1996]</a></td>
<td class="author-text">Anderson, R. and S. Vaudenay, &ldquo;Minding Your P's and Q's,&rdquo; Advances in Cryptology - ASIACRYPT '96
		     Proceedings&nbsp;Spinger Lecture Notes in
		     Computer Science (LNCS) volume 1163, 1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="BMM2000">[BMM2000]</a></td>
<td class="author-text">Biehl, I., Meyer, B., and V. Muller, &ldquo;Differential fault analysis on elliptic curve cryptosystems,&rdquo; Advances in Cryptology - CRYPTO 2000 Proceedings&nbsp;Spinger Lecture Notes in Computer Science (LNCS) volume 1880, 2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="BS1992">[BS1992]</a></td>
<td class="author-text">Branstad, D. and M. Smid, &ldquo;Response to Comments on the NIST Proposed Digital Signature Standard,&rdquo; Advances in Cryptology - CRYPTO '92 Proceedings&nbsp;Springer Lecture Notes in Computer Science (LNCS) volume 740, August&nbsp;1992.</td></tr>
<tr><td class="author-text" valign="top"><a name="DSA1991">[DSA1991]</a></td>
<td class="author-text">&ldquo;DIGITAL SIGNATURE STANDARD,&rdquo; Federal Register&nbsp;Vol. 56, August&nbsp;1991.</td></tr>
<tr><td class="author-text" valign="top"><a name="E1984a">[E1984a]</a></td>
<td class="author-text">ElGamal, T., &ldquo;Cryptography and logarithms over finite fields,&rdquo; Stanford University&nbsp;UMI Order No. DA 8420519, 1984.</td></tr>
<tr><td class="author-text" valign="top"><a name="E1984b">[E1984b]</a></td>
<td class="author-text">ElGamal, T., &ldquo;Cryptography and logarithms over finite fields,&rdquo; Advances in Cryptology - CRYPTO '84 Proceedings&nbsp;Springer Lecture Notes in Computer Science (LNCS) volume 196, 1984.</td></tr>
<tr><td class="author-text" valign="top"><a name="E1985">[E1985]</a></td>
<td class="author-text">ElGamal, T., &ldquo;A public key cryptosystem and a signature scheme
           based on discrete logarithms,&rdquo; IEEE Transactions on Information Theory&nbsp;Vol 30, No. 4, pp. 469-472, 1985.</td></tr>
<tr><td class="author-text" valign="top"><a name="FIPS180-2">[FIPS180-2]</a></td>
<td class="author-text">&ldquo;SECURE HASH STANDARD,&rdquo; Federal Information Processing Standard (FIPS)&nbsp;180-2, August&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="FIPS186">[FIPS186]</a></td>
<td class="author-text">&ldquo;DIGITAL SIGNATURE STANDARD,&rdquo; Federal Information Processing Standard&nbsp;FIPS-186, May&nbsp;1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="HP1994">[HP1994]</a></td>
<td class="author-text">Horster, P. and H. Petersen, &ldquo;Verallgemeinerte ElGamal-Signaturen,&rdquo; Proceedings der Fachtagung SIS '94, Verlag der Fachvereine&nbsp;Zurich, 1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="K1981v3">[K1981v3]</a></td>
<td class="author-text">Knuth, D., &ldquo;The Art of Computer Programming, Vol. 3:
           Sorting and Searching,&rdquo; Addison Wesley&nbsp;, 1981.</td></tr>
<tr><td class="author-text" valign="top"><a name="KMOV1991">[KMOV1991]</a></td>
<td class="author-text">Koyama, K., Maurer, U., Vanstone, S., and T. Okamoto, &ldquo;New Public-Key Schemes Based on Elliptic Curves over the Ring Zn,&rdquo; Advances in Cryptology - CRYPTO '91 Proceedings&nbsp;Spinger Lecture Notes in Computer Science (LNCS) volume 576, 1991.</td></tr>
<tr><td class="author-text" valign="top"><a name="L1969">[L1969]</a></td>
<td class="author-text">&ldquo;Computer technology applied to the theory of numbers,&rdquo; M.A.A. Studies in Mathematics&nbsp;180-2, 1969.</td></tr>
<tr><td class="author-text" valign="top"><a name="LL1997">[LL1997]</a></td>
<td class="author-text">Lim, C. and P. Lee, &ldquo;A Key Recovery Attack on Discrete Log-based Schemes
	     Using a Prime Order Subgroup,&rdquo; Advances in Cryptology - CRYPTO '97 Proceedings&nbsp;Spinger Lecture Notes in Computer Science (LNCS) volume 1294, 1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="NR1994">[NR1994]</a></td>
<td class="author-text">Nyberg, K. and R. Rueppel, &ldquo;Message Recovery for Signature Schemes Based on the Discrete Logarithm Problem,&rdquo; Advances in Cryptology - EUROCRYPT '94 Proceedings&nbsp;Springer Lecture Notes in Computer Science (LNCS) volume 950, May&nbsp;1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="P1363">[P1363]</a></td>
<td class="author-text">&ldquo;Standard Specifications for Public Key Cryptography,&rdquo; Institute of Electric and Electronic Engineers (IEEE)&nbsp;P1363, 2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="P1978">[P1978]</a></td>
<td class="author-text">Pollard, J., &ldquo;Monte Carlo methods for index computation mod p,&rdquo; Mathematics of Computation&nbsp;Vol. 32, 1978.</td></tr>
<tr><td class="author-text" valign="top"><a name="PH1978">[PH1978]</a></td>
<td class="author-text">Pohlig, S. and M. Hellman, &ldquo;An Improved Algorithm for Computing Logarithms over
	     GF(p) and its Cryptographic Significance,&rdquo; IEEE Transactions on Information Theory&nbsp;Vol 24, pp. 106-110, 1978.</td></tr>
<tr><td class="author-text" valign="top"><a name="R1988">[R1988]</a></td>
<td class="author-text">Rose, H., &ldquo;A Course in Number Theory,&rdquo; Oxford University Press&nbsp;, 1988.</td></tr>
<tr><td class="author-text" valign="top"><a name="R1992">[R1992]</a></td>
<td class="author-text">Rivest, R., &ldquo;Response to the proposed DSS,&rdquo; Communications of the ACM&nbsp;v.35 n.7 p.41-47., July&nbsp;1992.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2409">[RFC2409]</a></td>
<td class="author-text"><a href="mailto:dharkins@cisco.com">Harkins, D.</a> and <a href="mailto:carrel@ipsec.org">D. Carrel</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2409">The Internet Key Exchange (IKE)</a>,&rdquo; RFC&nbsp;2409, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2409.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2409.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2409.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2412">[RFC2412]</a></td>
<td class="author-text"><a href="mailto:ho@darpa.mil">Orman, H.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2412">The OAKLEY Key Determination Protocol</a>,&rdquo; RFC&nbsp;2412, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2412.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2412.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2412.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3979">[RFC3979]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc3979">Intellectual Property Rights in IETF Technology</a>,&rdquo; BCP&nbsp;79, RFC&nbsp;3979, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3979.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4086">[RFC4086]</a></td>
<td class="author-text">Eastlake, D., Schiller, J., and S. Crocker, &ldquo;<a href="http://tools.ietf.org/html/rfc4086">Randomness Requirements for Security</a>,&rdquo; BCP&nbsp;106, RFC&nbsp;4086, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4086.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4753">[RFC4753]</a></td>
<td class="author-text">Fu, D. and J. Solinas, &ldquo;<a href="http://tools.ietf.org/html/rfc4753">ECP Groups For IKE and IKEv2</a>,&rdquo; RFC&nbsp;4753, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4753.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4754">[RFC4754]</a></td>
<td class="author-text">Fu, D. and J. Solinas, &ldquo;<a href="http://tools.ietf.org/html/rfc4754">IKE and IKEv2 Authentication Using the Elliptic Curve Digital Signature Algorithm (ECDSA)</a>,&rdquo; RFC&nbsp;4754, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4754.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4879">[RFC4879]</a></td>
<td class="author-text">Narten, T., &ldquo;<a href="http://tools.ietf.org/html/rfc4879">Clarification of the Third Party Disclosure Procedure in RFC 3979</a>,&rdquo; BCP&nbsp;79, RFC&nbsp;4879, April&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4879.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SuiteB">[SuiteB]</a></td>
<td class="author-text">&ldquo;NSA Suite B Cryptography,&rdquo; Web Page&nbsp;http://www.nsa.gov/ia/programs/suiteb_cryptography/index.shtml.</td></tr>
<tr><td class="author-text" valign="top"><a name="V1996">[V1996]</a></td>
<td class="author-text">Vaudenay, S., &ldquo;Hidden Collisions on DSS,&rdquo; Advances in Cryptology - CRYPTO '96
		     Proceedings&nbsp;Spinger Lecture Notes in
		     Computer Science (LNCS) volume 1109, 1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="VW1994">[VW1994]</a></td>
<td class="author-text">van Oorschot, P. and M. Wiener, &ldquo;Parallel Collision Search with Application to Hash Functions and Discrete Logarithms,&rdquo; Proceedings of the 2nd ACM Conference on Computer and communications security &nbsp;pp. 210-218, 1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="VW1996">[VW1996]</a></td>
<td class="author-text">van Oorschot, P. and M. Wiener, &ldquo;On Diffie-Hellman key agreement with short exponents,&rdquo; Advances in Cryptology - EUROCRYPT '96 Proceedings&nbsp;Spinger Lecture Notes in Computer Science (LNCS) volume 1070, 1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="X9.62">[X9.62]</a></td>
<td class="author-text">&ldquo;Public Key Cryptography for the Financial Services
                   Industry: The Elliptic Curve Digital Signature
                   Algorithm (ECDSA),&rdquo; American National Standards Institute (ANSI)&nbsp; X9.62.</td></tr>
</table>

<a name="keywords"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Key Words</h3>

<p>
The definitions of these key words are quoted from <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> and are
commonly used in Internet standards.  They are reproduced in this note in order
to avoid a normative reference from after 1994.

</p>
<p>
</p>
<ol class="text">
<li> MUST  - This word, or the terms "REQUIRED" or "SHALL", mean that the
   definition is an absolute requirement of the specification.

</li>
<li> MUST NOT  - This phrase, or the phrase "SHALL NOT", mean that the
   definition is an absolute prohibition of the specification.

</li>
<li>
   SHOULD  -  This word, or the adjective "RECOMMENDED", mean that there
   may exist valid reasons in particular circumstances to ignore a
   particular item, but the full implications must be understood and
   carefully weighed before choosing a different course.

</li>
<li>
   SHOULD NOT  - This phrase, or the phrase "NOT RECOMMENDED" mean that
   there may exist valid reasons in particular circumstances when the
   particular behavior is acceptable or even useful, but the full
   implications should be understood and the case carefully weighed
   before implementing any behavior described with this label.

</li>
<li>
   MAY  - This word, or the adjective "OPTIONAL", mean that an item is
   truly optional.  One vendor may choose to include the item because a
   particular marketplace requires it or because the vendor feels that
   it enhances the product while another vendor may omit the same item.
   An implementation which does not include a particular option MUST be
   prepared to interoperate with another implementation which does
   include the option, though perhaps with reduced functionality. In the
   same vein an implementation which does include a particular option
   MUST be prepared to interoperate with another implementation which
   does not include the option (except, of course, for the feature the
   option provides.)

</li>
</ol><p>


</p>
<a name="rng"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Random Integer Generation</h3>

<p>
It is easy to generate an integer uniformly at random between zero and
2^t -1, inclusive, for some positive integer t.  Generate a random bit string that
contains exactly t bits, and then convert the bit string to a
non-negative integer by treating the bits as the coefficients in a
base-two expansion of an integer.

</p>
<p>
It is sometimes necessary to generate an integer r uniformly at random
so that r satisfies a certain property P, for example, lying within a
certain interval.  A simple way to do this is with the rejection
method:
</p>
<ol class="text">
<li>
Generate a candidate number c uniformly at random from a set that
includes all numbers that satisfy property P (plus some other numbers,
preferably not too many)

</li>
<li>
If c satisfies property P, then return c.  Otherwise, return to Step
1.

</li>
</ol><p> 
For example, to generate a number between 1 and n-1, inclusive,
repeatedly generate integers between zero and 2^t - 1, inclusive, stopping at the
first integer that falls within that interval.

</p>
<p>
Recommendations on how to generate random bit strings are provided
in <a class='info' href='#RFC4086'>[RFC4086]<span> (</span><span class='info'>Eastlake, D., Schiller, J., and S. Crocker, &ldquo;Randomness Requirements for Security,&rdquo; June&nbsp;2005.</span><span>)</span></a>.

</p>
<a name="Xonly"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Why Compact Representation Works</h3>

<p>
In the affine representation, the x-coordinate of the point P^i does
not depend on the y-coordinate of the point P, for any non-negative
exponent i and any point P.  This fact can be seen as follows.  When
given only the x-coordinate of a point P, it is not possible to
determine exactly what the y-coordinate is, but the y value will be a
solution to the curve equation
</p>
<blockquote class="text">
<p>
    y^2 = x^3 + a*x + b (mod p).
  
</p>
</blockquote><p>
There are at most two distinct solutions y = w and y = -w mod p,
and the point P must be either Q=(x,w) or Q^-1=(x,-w).  Thus P^n
is equal to either Q^n or (Q^-1)^n = (Q^n)^-1.  These values have the
same x-coordinate.  Thus, the x-coordinate of a point P^i can be
computed from the x-coordinate of a point P by computing one of the
possible values of the y coordinate of P, then computing the ith power
of P, and then ignoring the y-coordinate of that result.

</p>
<p>
In general, it is possible to compute a square root modulo p by using
Shanks's method <a class='info' href='#K1987'>[K1987]<span> (</span><span class='info'>Koblitz, N., &ldquo;Elliptic Curve Cryptosystems,&rdquo; 1987.</span><span>)</span></a>; simple methods exist for some
values of p.  When p = 3 (mod 4), the square roots of z mod p are w
and -w mod p, where
</p>
<blockquote class="text">
<p>
    w = z ^ ((p+1)/4) (mod p);
  
</p>
</blockquote><p>
this observation is due to Lehmer <a class='info' href='#L1969'>[L1969]<span> (</span><span class='info'>, &ldquo;Computer technology applied to the theory of numbers,&rdquo; 1969.</span><span>)</span></a>.  When p satisfies this
property, y can be computed from the curve equation, and either y = w or y = -w mod p, where
</p>
<blockquote class="text">
<p>
     w = (x^3 + a*x + b)^((p+1)/4) (mod p).
  
</p>
</blockquote><p>
Square roots modulo p only exist for a quadratic residue modulo p, 
<a class='info' href='#R1988'>[R1988]<span> (</span><span class='info'>Rose, H., &ldquo;A Course in Number Theory,&rdquo; 1988.</span><span>)</span></a>; if z is not a quadratic residue, then 
there is no number w such that w^2 = z (mod p).  A simple 
way to verify that z is a quadratic residue after computing w 
is to verify that <br />
 w * w = z (mod p).  
If this relation does not hold for the above equation,
then the value x is not a valid x-coordinate for 
a valid elliptic curve point.
This is an important consideration when ECDH is used with compact
output; see <a class='info' href='#twogroups'>Section&nbsp;9.3<span> (</span><span class='info'>Group Representation and Security</span><span>)</span></a>.

</p>
<p>
The primes used in the P-256, P-384, and P-521 curves described in
<a class='info' href='#RFC4753'>[RFC4753]<span> (</span><span class='info'>Fu, D. and J. Solinas, &ldquo;ECP Groups For IKE and IKEv2,&rdquo; January&nbsp;2007.</span><span>)</span></a> all have the property that p = 3 (mod 4).  

</p>
<a name="Example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
Example ECC Parameter Set</h3>

<p>
For concreteness, we recall an elliptic curve defined by Solinas and
Fu in <a class='info' href='#RFC4753'>[RFC4753]<span> (</span><span class='info'>Fu, D. and J. Solinas, &ldquo;ECP Groups For IKE and IKEv2,&rdquo; January&nbsp;2007.</span><span>)</span></a> and referred to as P-256, which is
believed to provide a 128-bit security level.  We use the notation of 
<a class='info' href='#params'>Section&nbsp;3.3<span> (</span><span class='info'>ECC Parameters</span><span>)</span></a>, and express the generator in the affine
coordinate representation g=(gx,gy), where the values gx and gy are 
in Fp.  

</p>
<p>
p: FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF

</p>
<p>
a: - 3

</p>
<p>
b: 5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B

</p>
<p>
n: FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551


</p>
<p>
gx: 6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296

</p>
<p>
gy: 4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5

</p>
<p>
Note that p can also be expressed as 
</p>
<blockquote class="text">
<p>
     p = 2^(256)-2^(224)+2^(192)+2^(96)-1.
   
</p>
</blockquote><p>

</p>
<a name="notation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.E"></a><h3>Appendix E.&nbsp;
Additive and multiplicative notation</h3>

<p>
The early publications on elliptic curve cryptography used
multiplicative notation, but most modern publications use additive
notation.  This section includes a table mapping between those two
conventions.  In this section, a and b are elements of an elliptic
curve group, and N is an integer.

</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Multiplicative Notation</th><th align="left">Additive Notation</th></tr>
<tr>
<td align="left"> multiplication  </td>
<td align="left"> addition </td>
</tr>
<tr>
<td align="left"> a * b </td>
<td align="left"> a + b </td>
</tr>
<tr>
<td align="left"> squaring  </td>
<td align="left"> doubling   </td>
</tr>
<tr>
<td align="left">  a * a = a^2 </td>
<td align="left">  a + a = 2a  </td>
</tr>
<tr>
<td align="left"> exponentiation  </td>
<td align="left"> scalar multiplication  </td>
</tr>
<tr>
<td align="left">  a^N = a * a * ... * a </td>
<td align="left">  Na = a + a + ... + a </td>
</tr>
<tr>
<td align="left"> inverse </td>
<td align="left"> inverse </td>
</tr>
<tr>
<td align="left"> a^-1 </td>
<td align="left"> -a </td>
</tr>
</table>
<br clear="all" />

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David A. McGrew</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">510 McCarthy Blvd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Milpitas, CA  95035</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">(408) 525 8651</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mcgrew@cisco.com">mcgrew@cisco.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.mindspring.com/~dmcgrew/dam.htm">http://www.mindspring.com/~dmcgrew/dam.htm</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kevin M. Igoe</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">National Security Agency</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Commercial Solutions Center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">United States of America</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:kmigoe@nsa.gov">kmigoe@nsa.gov</a></td></tr>
</table>
</body></html>
