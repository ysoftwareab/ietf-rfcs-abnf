<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Secure EVPN MAC Signaling</title>
<meta content="Pascal Thubert" name="author">
<meta content="Tony Przygienda" name="author">
<meta content="Jeff Tantsura" name="author">
<meta content="
       
  This specification adds attributes to EVPN to carry IPv6 address metadata
  learned from RFC 8505 and RFC 8928 so as to maintain a synchronized copy of
  the 6LoWPAN ND registrar at each EVPN router and perform locally a unicast
  IPv6 ND service for address lookup and duplicate address detection.
 
    " name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="draft-thubert-bess-secure-evpn-mac-signaling-02" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/secure-evpn-mac-signaling-8f7gfijf.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EVPN Secure MAC</td>
<td class="right">January 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Thubert, et al.</td>
<td class="center">Expires 22 July 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">BESS</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-01-18" class="published">18 January 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-07-22">22 July 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Thubert, <span class="editor">Ed.</span>
</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">A. Przygienda</div>
<div class="org">Juniper Networks, Inc</div>
</div>
<div class="author">
      <div class="author-name">J. Tantsura</div>
<div class="org">Microsoft</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Secure EVPN MAC Signaling</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
  This specification adds attributes to EVPN to carry IPv6 address metadata
  learned from RFC 8505 and RFC 8928 so as to maintain a synchronized copy of
  the 6LoWPAN ND registrar at each EVPN router and perform locally a unicast
  IPv6 ND service for address lookup and duplicate address detection.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 22 July 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-glossary" class="xref">Glossary</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-references" class="xref">References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-6lowpan-neighbor-discovery" class="xref">6LoWPAN Neighbor Discovery</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-ipv6-interface-link-and-sub" class="xref">IPv6 Interface, Link, and Subnet</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-rfc-6775-address-registrati" class="xref">RFC 6775 Address Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-rfc-8505-extended-address-r" class="xref">RFC 8505 Extended Address Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-r-flag" class="xref">R Flag</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="xref">3.3.2</a>.  <a href="#name-tid-i-field-and-opaque-fiel" class="xref">TID, "I" Field and Opaque Fields</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="xref">3.3.3</a>.  <a href="#name-status" class="xref">Status</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="xref">3.3.4</a>.  <a href="#name-route-ownership-verifier" class="xref">Route Ownership Verifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.5">
                    <p id="section-toc.1-1.3.2.3.2.5.1"><a href="#section-3.3.5" class="xref">3.3.5</a>.  <a href="#name-anycast-and-multicast-addre" class="xref">Anycast and Multicast Addresses</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-rfc-8505-extended-dar-dac" class="xref">RFC 8505 Extended DAR/DAC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-rfc-7400-capability-indicat" class="xref">RFC 7400 Capability Indication Option</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-extending-6lowpan-nd" class="xref">Extending 6LoWPAN ND</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-use-of-the-r-flag-in-na" class="xref">Use of the R flag in NA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-distributing-the-6lbr" class="xref">Distributing the 6LBR</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-unicast-address-lookup-with" class="xref">Unicast Address Lookup with the 6LBR</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-requirements-on-the-evpn-un" class="xref">Requirements on the EVPN-Unaware Host</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-support-of-6lowpan-nd" class="xref">Support of 6LoWPAN ND</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-enhancements-to-evpn" class="xref">Enhancements to EVPN</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-arp-nd-extended-community" class="xref">ARP/ND Extended Community</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-rovr-mac-mobility-extended-" class="xref">ROVR MAC Mobility Extended Community</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-extended-rovr-mac-procedure" class="xref">Extended ROVR MAC Procedures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-protocol-operations" class="xref">Protocol Operations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
  <span><a href="#RFC8505" class="xref">"Registration Extensions for IPv6 over 6LoWPAN
  Neighbor Discovery"</a> [<a href="#RFC8505" class="xref">RFC8505</a>]</span> (ND) provides a zeroconf routing-agnostic
  Host-to-Router Link-Local interface for Stateful Address Autoconfiguration.
  <span><a href="#RFC8928" class="xref">"Address-Protected Neighbor Discovery for Low-Power and
  Lossy Networks"</a> [<a href="#RFC8928" class="xref">RFC8928</a>]</span> (AP-ND) adds a zeroconf anti-theft protection that protects the ownership of the autoconfigured address with autoconfigured proof of ownership called a Registration Ownership Verifier (ROVR).<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
  <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> enables the host to claim an IPv6 address and obtain
  reachability services for that address. It is already used to inject host
  routes in RPL <span>[<a href="#RFC9010" class="xref">RFC9010</a>]</span> and RIFT
  <span><a href="#I-D.ietf-rift-rift" class="xref">"Routing in Fat Trees"</a> [<a href="#I-D.ietf-rift-rift" class="xref">RIFT</a>]</span>, and to
  maintain a proxy-ND state in a backbone router <span>[<a href="#RFC8929" class="xref">RFC8929</a>]</span>; this
  specification extends its applicability to the case of Ethernet Virtual
  Private Network (EVPN).<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
  <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> specifies a unicast address registration mechanism
  that enables the host called a 6LowPAN Node (6LN) to install a ND binding
  state in the 6LowPAN Router (6LR) that can serve as Neighbor Cache Entry (NCE),
  though it is not operated as a cache.
  The protocol provides the means to reject the registration in case of address
  duplication. It also enables to discriminate mobility from multihoming.
  <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span> adds the capability to verify the ownership of the
  address and prevent an attacker from stealing and/or impersonating an address.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
  <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> defines the 6LoWPAN Border Router (6LBR) as an
  abstract address registrar that provides authoritative service for Address
  Registration and duplicate detection. The 6LBR stores address metadata
  that is obtained during the Address Registration, including an owner ID and a
  sequence counter.
  As part of the process of a new Address Registration, the 6LR queries the 6LBR
  for existing metadata related to the address being registered. This enables in
  particular to detect a duplication and reject the registration.
  This specification extends the 6LBR abstract data model to store the
  Link Layer Address (LLA) of the Registering Node. This enables the 6LBR to
  perform locally, and using unicast communication, the IPv6 ND services of
  address lookup and duplicate address detection.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
  The <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> address registrar can be centralized, but it can
  also be distributed and maintained synchronized using a routing protocol.
  This specification adds attributes to EVPN to carry the IPv6 address metadata
  learned from <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> so as to maintain a synchronized copy of
  the 6LBR abstract data at each EVPN router.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<div id="bcp">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.1-1">

    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
    "OPTIONAL" in this document are to be interpreted as described in BCP 14
 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
    appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gloss">
<section id="section-2.2">
        <h3 id="name-glossary">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-glossary" class="section-name selfRef">Glossary</a>
        </h3>
<p id="section-2.2-1"> This document uses the following acronyms:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-2.2-2">
          <dt id="section-2.2-2.1">6CIO</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.2">Capability Indication Option <span>[<a href="#RFC7400" class="xref">RFC7400</a>]</span><a href="#section-2.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.3">6LN:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.4"> 6LoWPAN Node (the Host) <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span><a href="#section-2.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.5">6LR:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.6"> 6LoWPAN router (the router) <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span><a href="#section-2.2-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.7">6LBR:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.8"> 6LoWPAN Border router  <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span><a href="#section-2.2-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.9">AMC:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.10"> Address Mapping Confirmation <span>[<a href="#I-D.thubert-6lo-unicast-lookup" class="xref">UNICAST-LOOKUP</a>]</span><a href="#section-2.2-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.11">AMR:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.12"> Address Mapping Request <span>[<a href="#I-D.thubert-6lo-unicast-lookup" class="xref">UNICAST-LOOKUP</a>]</span><a href="#section-2.2-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.13">ARO</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.14">Address Registration Option  <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span><a href="#section-2.2-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.15">CIPO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.16">Crypto-ID Parameters Option<a href="#section-2.2-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.17">DAD:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.18"> Duplicate Address Detection <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span><a href="#section-2.2-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.19">ICMPv6:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.20"> Internet Control Message Protocol for IPv6<a href="#section-2.2-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.21">DAC</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.22">Duplicate Address Confirmation  <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span><a href="#section-2.2-2.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.23">DAR</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.24">Duplicate Address Request <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span><a href="#section-2.2-2.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.25">EDAC</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.26">Extended Duplicate Address Confirmation  <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span><a href="#section-2.2-2.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.27">EDAR</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.28">Extended Duplicate Address Request <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span><a href="#section-2.2-2.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.29">EARO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.30"> Extended Address Registration Option <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span><a href="#section-2.2-2.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.31">EVPN:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.32"> Ethernet VPN  <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span><a href="#section-2.2-2.32" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.33">LLA:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.34"> Link-Layer Address (the MAC address on Ethernet)<a href="#section-2.2-2.34" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.35">LLN</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.36">Low-Power and Lossy Network <span>[<a href="#RFC6550" class="xref">RFC6550</a>]</span><a href="#section-2.2-2.36" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.37">NA:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.38">  Neighbor Advertisement <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span><a href="#section-2.2-2.38" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.39">NCE:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.40">  Neighbor Cache Entry <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span><a href="#section-2.2-2.40" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.41">ND:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.42">  Neighbor Discovery <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span><a href="#section-2.2-2.42" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.43">NDPSO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.44"> Neighbor Discovery Protocol Signature Option<a href="#section-2.2-2.44" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.45">NS:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.46">  Neighbor Solicitation <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span><a href="#section-2.2-2.46" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.47">RA:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.48">  Router Advertisement <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span><a href="#section-2.2-2.48" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.49">ROVR:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.50"> Registration Ownership Verifier <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span><a href="#section-2.2-2.50" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.51">TID:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.52"> Transaction ID (a sequence counter in the EARO) <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span><a href="#section-2.2-2.52" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.53">SLAAC:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.54"> Stateless Address Autoconfiguration <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span><a href="#section-2.2-2.54" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.55">SLLAO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.56"> Source Link-Layer Address Option <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span><a href="#section-2.2-2.56" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.57">TLLAO:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.58"> Target Link-Layer Address Option <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span><a href="#section-2.2-2.58" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.59">ROVR MAC:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.60"> MAC obtained from a host meeting requirements in <a href="#prereq" class="xref">Section 5</a><a href="#section-2.2-2.60" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.61">Validated ROVR MAC:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.62"> ROVR MAC validated by procedures specified in <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span><a href="#section-2.2-2.62" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.63">ROVR Node:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.64"> EVPN node capable of advertising ROVR MACs<a href="#section-2.2-2.64" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.65">non-ROVR Node:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.66"> EVPN node not supporting extensions defined in this document.<a href="#section-2.2-2.66" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.67">VPN:</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.68"> Virtual Private Network<a href="#section-2.2-2.68" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="lo">
<section id="section-2.3">
        <h3 id="name-references">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-references" class="section-name selfRef">References</a>
        </h3>
<p id="section-2.3-1">
This document uses the terms Clos fabric and Fat Tree interchangeably, to
refer to a folded spine-and-leaf topology as defined in the terminology section
of <span><a href="#I-D.ietf-rift-rift" class="xref">"RIFT: Routing in Fat Trees"</a> [<a href="#I-D.ietf-rift-rift" class="xref">RIFT</a>]</span>.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">
The term "leaf" represents the access switch that connects the servers to the
Fat Tree. The leaf is typically a Top-of-Rack (ToR) switch.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">
This specification uses the terms 6LN, 6LR and 6LBR to refer specifically to
nodes that implement the said roles in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> and does not
expect other functionality such as 6LoWPAN Header Compression:<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-4.1">
   In the context of this document, the 6LN is a server that advertises an
   address mapping using <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>, and optionally protects its
   ownership with <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span>.<a href="#section-2.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-4.2">
   The 6LR and 6LBR function are collapsed at the leaf and its state is
   synchronized with that of the EVPN functional support using an internal
   interface that is out of scope. That interface could be "pull" meaning that
   the 6LBR fetches the EVPN information when it needs it, or "push", meaning
   that any information that EVPN distributes is immediately fed in all the
   6LBRs in all the leaves. Note that this is pure control plane and is not
   subject to abbreviating optimization as the FIB may be.<a href="#section-2.3-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.3-5">
 In this document, readers will encounter terms and concepts
 that are discussed in the following documents:<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.3-6">
          <dt id="section-2.3-6.1">EVPN:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-6.2">
            <span><a href="#RFC7432" class="xref">"BGP MPLS-Based Ethernet VPN"</a> [<a href="#RFC7432" class="xref">RFC7432</a>]</span> and
     <span><a href="#RFC8365" class="xref">"Network Virtualization Overlay Solution"</a> [<a href="#RFC8365" class="xref">RFC8365</a>]</span>,<a href="#section-2.3-6.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-6.3">Classical IPv6 ND:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-6.4">
            <span><a href="#RFC4861" class="xref">"Neighbor Discovery for IP version 6"</a> [<a href="#RFC4861" class="xref">RFC4861</a>]</span> and
     <span><a href="#RFC4862" class="xref">"IPv6 Stateless Address Autoconfiguration"</a> [<a href="#RFC4862" class="xref">RFC4862</a>]</span>,<a href="#section-2.3-6.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-6.5">6LoWPAN ND:</dt>
          <dd style="margin-left: 1.5em" id="section-2.3-6.6">
            <span><a href="#RFC6775" class="xref">Neighbor Discovery Optimization for Low-Power
 and Lossy Networks</a> [<a href="#RFC6775" class="xref">RFC6775</a>]</span>,
     <span><a href="#RFC8505" class="xref">"Registration Extensions for 6LoWPAN Neighbor Discovery"</a> [<a href="#RFC8505" class="xref">RFC8505</a>]</span>,
        <span><a href="#RFC8928" class="xref">"Address Protected Neighbor Discovery for Low-power and Lossy Networks"</a> [<a href="#RFC8928" class="xref">RFC8928</a>]</span>, and <span><a href="#RFC8929" class="xref">"IPv6 Backbone Router"</a> [<a href="#RFC8929" class="xref">RFC8929</a>]</span>.<a href="#section-2.3-6.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="lpnd">
<section id="section-3">
      <h2 id="name-6lowpan-neighbor-discovery">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-6lowpan-neighbor-discovery" class="section-name selfRef">6LoWPAN Neighbor Discovery</a>
      </h2>
<p id="section-3-1">
  6LoWPAN Neighbor Discovery defines a stateful address autoconfiguration
  mechanism for IPv6. 6LoWPAN ND enables to divorce the L3 abstractions for
  link and subnet from the characteristics of the L2 link and broadcast domain.
  It is applicable beyond its original field of IoT to any environment where
  the broadcast nature of the underlaying network should not be exploited, e.g.,
  in the case of a wireless link where broadcast uses an excessive amount of
  spectrum, and a distributed cloud, where it may span too widely.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
  In contrast to Stateless Address Autoconfiguration (SLAAC) <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span> which relies on broadcast for duplicate address detection (DAD)
  and address lookup, 6LoWPAN ND installs and maintains a state in the
  neighbors for the duration of their interaction. Though it is also called a
  Neighbor Cache Entry (BCE) in <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>, and in contrast with
  the the BCE in SLAAC, that state is not a cache that can be casually flushed
  and rebuilt. It must be installed proactively and refreshed periodically to
  maintain the connectivity and enable unicast-only operations.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
  This section goes through the 6LoWPAN ND network abstractions and mechanisms
  that this specification leverages, as a non-normative reference to the reader.
  The relevant normative text is to be found in <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>,
  <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>, and <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="link">
<section id="section-3.1">
        <h3 id="name-ipv6-interface-link-and-sub">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-ipv6-interface-link-and-sub" class="section-name selfRef">IPv6 Interface, Link, and Subnet</a>
        </h3>
<p id="section-3.1-1">
  The typical abstraction for an IP Link with 6LoWPAN ND is a logical
  point-to-point (P2P) link between a node (a host or a router) and a router,
  regardless of the physical medium between the node and the router, which
  may or may not be shared with other nodes.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
  A Subnet is deployed over a mesh of nodes connected with those logical P2P
  Links, where routers form a connected dominating set as represented in
  <a href="#FigMesh" class="xref">Figure 1</a>; the resulting aggregate is called a multilink subnet
  (MLSN). An MLSN may be only partially meshed, and the underlaying network is
  not expected to provide a multicast or a broadcast service across the subnet.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<span id="name-ppp-links-in-an-nbma-mesh"></span><div id="FigMesh">
<figure id="figure-1">
          <div class="alignCenter art-text artwork" id="section-3.1-3.1">
<pre>


    +------+                     +------+
    | Host |----------+    +-----| Host |
    +------+          |    |     +------+
        |           +--------+
        |   +-------| Router |
        |   |       +--------+
     +--------+        |   |       +------+
     | Router |        |   +------ | Host |
     +--------+        |           +------+
        |   |   +--------+
        |   +---| Router |
        |       +--------+
      +------+     |  |     +------+
      | Host |-----+  +-----| Host |
      +------+                +------+


</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-ppp-links-in-an-nbma-mesh" class="selfRef">PPP Links in an NBMA Mesh</a>
          </figcaption></figure>
</div>
<p id="section-3.1-4">
  Consequently, the subnet model is not-on-link, meaning that the any-to-any
  connectivity across the subnet is ensured through L3 operations (routing or
  proxy) as opposed to transitive (any-to-any) reachability from L2. It also
  means that hosts do not lookup other nodes using IPv6 Neighbor Discovery but
  forward all their traffic via their connected routers. Which in turn means
  that only routers need to be discovered, which is done by sending Router
  Advertisement (RA) messages to all directly reachable nodes in the subnet,
  e.g., using a radio broadcast.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">
  As illustrated in <a href="#FigIntf" class="xref">Figure 2</a>, an IP interface bundles multiple
  sub-interfaces to connect the IP links between this node and peers in the
  same subnet, which is known as a point-to-multipoint (P2MP) interface.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<span id="name-p2mp-interface"></span><div id="FigIntf">
<figure id="figure-2">
          <div class="alignCenter art-text artwork" id="section-3.1-6.1">
<pre>


    +---------------------
    | P2MP Interface
    | --------------
    |  MAC Address
    |  IPv6 Link-Local address(es)
    |  IPv6 global addresses
    |
    |   +------------------------
    |   | P2P sub-interface
    |   | -----------------
    |   |  Peer MAC Address
    |   |  Peer IP addresses
    |   +------------------------
    |
    |   +------------------------
    |   | P2P sub-interface
    |   | -----------------
    |   |  Peer MAC Address
    |   |  Peer IP addresses
    |   +------------------------
    |
    |   +------------------------
    |   | P2P sub-interface
    |   | -----------------
    |   |  Peer MAC Address
    |   |  Peer IP addresses
    |   +------------------------
    |
    |    ....
    |
    +---------------

</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-p2mp-interface" class="selfRef">P2MP Interface</a>
          </figcaption></figure>
</div>
<p id="section-3.1-7">
  In the case of a 6LoWPAN radio, the IP Interface may be physical, and the P2P
  IP links are virtual based on discovered neighbor routers; the same model can
  apply when the node is connected via a switch to one or more routers.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">
  In the case of a multihomed NIC card in a datacenter, the NIC is connected to
  several Top-of-Rack (ToR) switches acting as leaves in the fabric, over as
  many Ethernet physical interfaces.
  If the NIC provides a L2 virtual switch, then the stack can apply the same
  model as above, modeling the virtual port to the virtual switch as a P2MP
  interface.<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">
  On the other hand, if the NIC provides a virtual router, then Ethernet ports
  are L3 ports and the physical link to the leaf is modeled as P2P. To form
  the P2MP interface, the router bundles (aggregates) the physical interfaces as
  the sub-interfaces of a single logical P2MP Link, as shown in
  <a href="#FigbundleIntf" class="xref">Figure 3</a>.<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<span id="name-logical-p2mp-interface"></span><div id="FigbundleIntf">
<figure id="figure-3">
          <div class="alignCenter art-text artwork" id="section-3.1-10.1">
<pre>


    +---------------------
    | NIC Aggregate interface
    | -----------------------
    |  virtual MAC Address
    |  IPv6 global addresses
    |
    |   +------------------------
    |   |  Ethernet Port 1
    |   | -----------------
    |   |  Physical MAC Address
    |   |  IPv6 Link-Local address(es)
    |   |  Leaf MAC Address
    |   |  Leaf IP addresses
    |   +------------------------
    |
    |   +------------------------
    |   | Ethernet Port 2
    |   | -----------------
    |   |  Physical MAC Address
    |   |  IPv6 Link-Local address(es)
    |   |  Leaf MAC Address
    |   |  Leaf IP addresses
    |   +------------------------
    |
    |    ....
    |
    +---------------

</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-logical-p2mp-interface" class="selfRef">Logical P2MP Interface</a>
          </figcaption></figure>
</div>
<p id="section-3.1-11">
  To conserve the same model, it makes sense to configure the same (virtual) MAC
  address on all the physical interfaces, and use it for the purpose of IPv6 ND.
  In that case, the same MAC address is exposed as Link-layer Address (LLA) to
  both leaves for the NIC IP addresses, and the IPv6 address still appears as
  unicast.
  Note that the Link-Local addresses used to register the global IPv6 addresses
  to the leaf may be different but that does not affect the exposed mapping.<a href="#section-3.1-11" class="pilcrow">¶</a></p>
<p id="section-3.1-12">
  When that is not possible, then the same IP address is advertised with
  the physical MAC address of each port as the LLA over that port. In that
  case, the global IPv6 address appears as anycast, and SHOULD be advertised
  as such, more in <a href="#mcast" class="xref">Section 3.3.5</a>.<a href="#section-3.1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="R6775">
<section id="section-3.2">
        <h3 id="name-rfc-6775-address-registrati">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-rfc-6775-address-registrati" class="section-name selfRef">RFC 6775 Address Registration</a>
        </h3>
<p id="section-3.2-1">
   The classical "IPv6 Neighbor Discovery (IPv6 ND) Protocol"
   <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span> was defined for serial
   links and transit media such as Ethernet. It is a reactive protocol that
   relies heavily on multicast operations for Address Discovery (aka Lookup) and
   Duplicate Address Detection (DAD).<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">
   <span><a href="#RFC6775" class="xref">"Neighbor Discovery Optimizations for 6LoWPAN networks"</a> [<a href="#RFC6775" class="xref">RFC6775</a>]</span>
   adapts IPv6 ND for operations over energy-constrained LLNs.
   The main functions of <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> are to proactively establish
   the Neighbor Cache Entry (NCE) in the 6LR and to prevent address duplication.
   To that effect, <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> introduces a new unicast Address
   Registration  mechanism that contributes to reducing the use of multicast
   messages compared to the classical IPv6 ND protocol.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3"><span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> defines a new Address
   Registration Option (ARO) that is carried in the unicast
   Neighbor Solicitation (NS) and Neighbor Advertisement (NA) messages between
   the 6LoWPAN Node (6LN) and the 6LoWPAN router (6LR).
   It also defines the Duplicate Address Request (DAR) and Duplicate
   Address Confirmation (DAC) messages between the 6LR and the 6LBR.
   In a Low-Power and Lossy Network (LLN), the 6LBR is the central repository of
   all the Registered Addresses in its domain and the authoritative source of
   truth for uniqueness and ownership.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="R8505E">
<section id="section-3.3">
        <h3 id="name-rfc-8505-extended-address-r">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-rfc-8505-extended-address-r" class="section-name selfRef">RFC 8505 Extended Address Registration</a>
        </h3>
<p id="section-3.3-1">
   <span><a href="#RFC8505" class="xref">"Registration Extensions for 6LoWPAN Neighbor Discovery"</a> [<a href="#RFC8505" class="xref">RFC8505</a>]</span>
   updates RFC 6775 into a generic Address Registration mechanism that can be
   used to access services such as routing and ND proxy. To that effect,
   <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> defines the Extended Address Registration Option
   (EARO), shown in <a href="#EARO" class="xref">Figure 4</a>:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<span id="name-earo-option-format"></span><div id="EARO">
<figure id="figure-4">
          <div class="alignCenter art-text artwork" id="section-3.3-2.1">
<pre>
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type      |     Length    |    Status     |    Opaque     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |  Rsvd | I |R|T|     TID       |     Registration Lifetime     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
 ...             Registration Ownership Verifier                 ...
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-earo-option-format" class="selfRef">EARO Option Format</a>
          </figcaption></figure>
</div>
<div id="R8505ER">
<section id="section-3.3.1">
          <h4 id="name-r-flag">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-r-flag" class="section-name selfRef">R Flag</a>
          </h4>
<p id="section-3.3.1-1">
<span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> introduces the R Flag in the EARO.
   The Registering Node sets the R Flag to indicate whether the 6LR should
   ensure reachability for the Registered Address.
   If the R Flag is set to 0, then the Registering Node handles the reachability
   of the Registered Address by other means. In an EVPN network, this means that
   either it is a RAN that injects the route by itself or that it uses another
   EVPN router for reachability services.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">
   This document specifies how the R Flag is used in the context of EVPN.
   An EVPN Host that implements the 6LN functionality from <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>
   requires reachability services for an IPv6 address if and only if it sets
   the R Flag in the NS(EARO) used to register the address to a 6LR acting as
   an EVPN border router. Upon receiving the NS(EARO), the EVPN router
   generates a BGP advertisement for the Registered Address if and only if the R
   flag is set to 1.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3"></p>
<p id="section-3.3.1-4">

   <span>[<a href="#RFC9010" class="xref">RFC9010</a>]</span> specifies that the 'R' flags is
   set in the responded NA messages if and only if the route was installed.
   This specification echoes that behavior.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="R8505ETID">
<section id="section-3.3.2">
          <h4 id="name-tid-i-field-and-opaque-fiel">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-tid-i-field-and-opaque-fiel" class="section-name selfRef">TID, "I" Field and Opaque Fields</a>
          </h4>
<p id="section-3.3.2-1">
   When the T Flag is set to 1, the EARO includes a sequence counter called
   Transaction ID (TID), that is needed to format the MAC Mobility Extended Community.
   This is the reason why the support of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>
   by the Host, as opposed to only <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>, is a prerequisite for
   this specification); this requirement is fully explained in
   <a href="#prereq6lp" class="xref">Section 5.1</a>. The EARO also
   transports an Opaque field and an associated "I" field that describes what
   the Opaque field transports and how to use it.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">
   This document specifies the use of the "I" field and the Opaque
   field by a Host.<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="R8505stat">
<section id="section-3.3.3">
          <h4 id="name-status">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-status" class="section-name selfRef">Status</a>
          </h4>
<p id="section-3.3.3-1">
   The values of the EARO status are maintained by IANA in the
   Address Registration Option Status Values subregistry
   <span>[<a href="#IANA-EARO-STATUS" class="xref">IANA-EARO-STATUS</a>]</span> of the
   Internet Control Message Protocol version 6 (ICMPv6) Parameters registry.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.3-2">
  <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> and <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> defined the original
  values whereas <span>[<a href="#RFC9010" class="xref">RFC9010</a>]</span> reduced range to 64 values and
  reformatted the octet field to enable to transport an external error, e.g.,
  coming form a routing protocol.<a href="#section-3.3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3.3-3">
  This specification uses the  format expressed in <span>[<a href="#RFC9010" class="xref">RFC9010</a>]</span>.
  The value of 0 denotes an unqualified success, 1 indicates an address
  duplication, 3 a TID value that is outdated, and 4 is used in an asynchronous
  NA to indicate that 6LN should remove that address and possibly form new ones.<a href="#section-3.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="R8505EROVR">
<section id="section-3.3.4">
          <h4 id="name-route-ownership-verifier">
<a href="#section-3.3.4" class="section-number selfRef">3.3.4. </a><a href="#name-route-ownership-verifier" class="section-name selfRef">Route Ownership Verifier</a>
          </h4>
<p id="section-3.3.4-1">
   Section 5.3 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> introduces the Registration
   Ownership Verifier (ROVR) field of variable length from 64 to 256 bits.
   The ROVR is a replacement of the EUI-64 in the ARO
   <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> that was used to identify uniquely an Address
   Registration with the Link-Layer address of the owner but provided no
   protection against spoofing.<a href="#section-3.3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.3.4-2">

   <span><a href="#RFC8928" class="xref">"Address Protected Neighbor Discovery for
   Low-power and Lossy Networks"</a> [<a href="#RFC8928" class="xref">RFC8928</a>]</span> leverages the ROVR field as a
   cryptographic proof of ownership to prevent a rogue third party from
   registering an address that is already owned.
   The use of ROVR field enables the 6LR to block traffic that is not
   sourced at an owned address.<a href="#section-3.3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.3.4-3">

   This specification does not address how the protection by
   <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span> could be extended for use in EVPN.
   On the other hand, it adds the ROVR to the BGP advertisement to share the
   state with the other routers via the Reflector (see <a href="#tgt" class="xref">Section 6.2</a>),
   which means that the routers that are aware of the Host route are also aware
   of the ROVR associated to the Target Address, whether it is cryptographic
   and should be verified.<a href="#section-3.3.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mcast">
<section id="section-3.3.5">
          <h4 id="name-anycast-and-multicast-addre">
<a href="#section-3.3.5" class="section-number selfRef">3.3.5. </a><a href="#name-anycast-and-multicast-addre" class="section-name selfRef">Anycast and Multicast Addresses</a>
          </h4>
<p id="section-3.3.5-1">
  <span><a href="#I-D.thubert-6lo-multicast-registration" class="xref">"IPv6 Neighbor Discovery Multicast Address Registration"</a> [<a href="#I-D.thubert-6lo-multicast-registration" class="xref">I-D.thubert-6lo-multicast-registration</a>]</span> updates <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>  to enable the address registration
  of IPv6 anycast and multicast addresses. From the host perspective, the
  registration is very similar to that of unicast addresses, but for a flag in
  the EARO that signals that the address is multicast or anycast.<a href="#section-3.3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.3.5-2">
  This procedure can be used as a replacement to <span><a href="#RFC3810" class="xref">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"</a> [<a href="#RFC3810" class="xref">RFC3810</a>]</span> for
  source-independant multicast operation. As for unicast, the method saves the
  need for the host to listen to pollings from the router, and allows the
  host to sleep for periods of time.<a href="#section-3.3.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="R8505D">
<section id="section-3.4">
        <h3 id="name-rfc-8505-extended-dar-dac">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-rfc-8505-extended-dar-dac" class="section-name selfRef">RFC 8505 Extended DAR/DAC</a>
        </h3>
<p id="section-3.4-1">
   <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> updates the DAR/DAC messages to EDAR/EDAC messages
   to carry  the ROVR field. The EDAR/EDAC exchange takes place between the 6LR
   to which the node registers an address, and the abstract 6LBR that stores the
   reference value for the ROVR and the TID associated to that address.
   It is triggered by an NS(EARO) message from a 6LN to the 6LR, to create,
   refresh, compare and delete the corresponding state in the 6LBR.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">
   In the status returned with the EDAC message, the 6LBR indicates if the
   registration is accepted, should be challenged, or is duplicate. The status
   of 0 (success) indicates that the address is either new or that the current
   registration matches, and in particular that the ROVR at the 6LBR and the
   one in the EDAR message  are identical.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<span id="name-edar-edac-flow"></span><div id="Figedarc">
<figure id="figure-5">
          <div class="alignCenter art-text artwork" id="section-3.4-3.1">
<pre>

   6LN               6LR                6LBR
    |                 |                   |
    |   IP Link       |    subnetwork     |
    |                 |                   |
    |  NS(EARO)       |                   |
    |----------------&gt;|                   |
    |                 |                   |
    |                 |    EDAR           |
    |                 |------------------&gt;|
    |                 |                   |
    |                 |      EDAC(status) |
    |                 |&lt;------------------|
    |                 |                   |
    |       NA(EARO)  |                   |
    |&lt;----------------|                   |
    |                 |                   |

</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-edar-edac-flow" class="selfRef">EDAR/EDAC flow</a>
          </figcaption></figure>
</div>
<p id="section-3.4-4">
   The EDAR/EDAC
   exchange is protected by the retry mechanism specified in Section 8.2.6 of
   <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>, though in a data center, a duration significantly
   shorter than the default value of the Retransmission Timer <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> of 1 second may be sufficient to cover the round-trip delay
   between the 6R and the 6LBR.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">
   With this specification, the 6LBR is distributed across the leaves, and all
   the leaves where an address is currently registered maintain a full 6LBR
   state for the address, aka local state in the following text.  The
   specification leverages the EDAR/EDAC exchange to ensure
   that a leaf (acting as a 6LR) that needs to create a 6LBR state for a new
   registration has the same value for the ROVR as any 6LBR already serving that
   address on another leaf. At the same time, the specification avoids placing
   full ROVR information in BGP so 1) it is not observable by a potential
   attacker and 2) the new attributes remain reasonably small.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="R7400">
<section id="section-3.5">
        <h3 id="name-rfc-7400-capability-indicat">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-rfc-7400-capability-indicat" class="section-name selfRef">RFC 7400 Capability Indication Option</a>
        </h3>
<p id="section-3.5-1">
   <span><a href="#RFC7400" class="xref">"6LoWPAN-GHC: Generic Header Compression for IPv6
   over Low-Power Wireless Personal Area Networks (6LoWPANs)"</a> [<a href="#RFC7400" class="xref">RFC7400</a>]</span> defines the
   6LoWPAN Capability Indication Option (6CIO) that enables a node to expose its
   capabilities in router Advertisement (RA) messages.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">
   <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> defines a number of bits in the 6CIO, in particular:<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-3.5-3">
          <dt id="section-3.5-3.1">L:</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-3.2"> Node is a 6LR.<a href="#section-3.5-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-3.3">E:</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-3.4"> Node is an IPv6 ND Registrar -- i.e., it supports
   registrations based on EARO.<a href="#section-3.5-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-3.5">P:</dt>
          <dd style="margin-left: 1.5em" id="section-3.5-3.6"> Node is a Routing Registrar, -- i.e., an IPv6 ND Registrar
         that also provides reachability services for the Registered Address.<a href="#section-3.5-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-6cio-flags"></span><div id="CIO">
<figure id="figure-6">
          <div class="alignCenter art-text artwork" id="section-3.5-4.1">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |   Length = 1  |     Reserved      |D|L|B|P|E|G|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Reserved                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-6cio-flags" class="selfRef">6CIO flags</a>
          </figcaption></figure>
</div>
<p id="section-3.5-5">

    A 6LR that provides reachability services for a Host in an EVPN network
    as specified in this document includes a 6CIO in its RA messages and
    set the L, P and E flags to 1 as prescribed by <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-3.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ext8505">
<section id="section-4">
      <h2 id="name-extending-6lowpan-nd">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-extending-6lowpan-nd" class="section-name selfRef">Extending 6LoWPAN ND</a>
      </h2>
<div id="upd2">
<section id="section-4.1">
        <h3 id="name-use-of-the-r-flag-in-na">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-use-of-the-r-flag-in-na" class="section-name selfRef">Use of the R flag in NA</a>
        </h3>
<p id="section-4.1-1">
   This document extends <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span> and <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> as follows<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
   This document also updates the behavior of a 6LR acting as EVPN router and of
   a 6LN acting as Host in the 6LoWPAN ND Address Registration  as follows:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-3.1">
   The use of the R Flag is extended to the NA(EARO) to confirm whether the
   route was installed.<a href="#section-4.1-3.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="dist">
<section id="section-4.2">
        <h3 id="name-distributing-the-6lbr">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-distributing-the-6lbr" class="section-name selfRef">Distributing the 6LBR</a>
        </h3>
<p id="section-4.2-1">
 This specification enables to distribute the 6LBR at the edge of the EVPN
    network and collapse the 6LBR function with that of the EVPN support.
    In that model, the EVPN to 6LBR interaction becomes an internal interface,
    where each side informs the other in case of new information concerning an
    IP to Link-Layer Address (LLA) mapping. Since this is an internal interface,
    this specification makes no assumption on whether the 6LBR stores its own
    representation of the full EVPN state, which means that the EVPN support
    informs the 6LBR in case of any change on the EVPN side (this is called
    the push model, see <a href="#Figpush" class="xref">Figure 13</a>), or if the 6LBR queries the
    EVPN support when it does not have a mapping to satisfy a request (pull
    model, see <a href="#Figpull" class="xref">Figure 12</a>).<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">
    This specification leverages <span>[<a href="#RFC8929" class="xref">RFC8929</a>]</span> that augments the
    abstract data model of the 6LBR to store the LLA associated with the
    registered address. Based on that additional state, the 6LBR in a leaf can
    communicate the mapping to the collocated EVPN function and respond to
    unicast address mapping lookups from the server side.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">
    In an environment where the server ranges from a classical host to a more
    complex platform that runs a collection of virtual hosts interconnected by
    a virtual switch, but where the host-to-leaf interface remains at layer 2,
    the 6LR and the 6LBR functions can be collapsed in the  leaf.
    The 6LR to 6LBR interaction also becomes an internal interface, and
    there is no need for EDAR/EDAC messages.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">
    In that case, the MAC address associated to the Registered Address is
    indicated in the Target Link-Layer Address Option (TLLAO) in the NS message
    used for the registration, as shown in <a href="#Figdir" class="xref">Figure 7</a>.
    In the case of a pull model, if the 6LBR does not have a local state for
    the mapping, it queries the EVPN support to obtain the EVPN state if any.
    If a mapping is known then the 6LR/6LBR evaluates the registration for
    address duplication and other possible issues per <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.
    Else (this is for a new mapping), if the registration is accepted, then
    the 6LBR notifies the EVPN support to inject a route type 2 in the fabric.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<span id="name-direct-registration"></span><div id="Figdir">
<figure id="figure-7">
          <div class="alignCenter art-text artwork" id="section-4.2-5.1">
<pre>

        Server              Leaf
  +--------------+   +-------------------+
  |              |   |                   |
   6LN                6LR/6LBR       EVPN
    |                    |            |
    | &lt;vSwitch&gt; Ethernet | &lt;call I/F&gt; |
    |                    |            |
    |  NS(EARO)          |            |
    |-------------------&gt;|            |
    |                    |            | ^
    |                    |   query    | |
    |                    |-----------&gt;| | if pull
    |                    |  response  | | model
    |                    |&lt;-----------| |
    |                                 | v
    |            Evaluation (DAD)     |
    |                                 |
    |                    |new mapping |
    |                    | indication |
    |                    |-----------&gt;|
    |                                 | Inject/maintain
    |         store a mapping state   | EVPN route type 2
    |                                 | ------------------&gt;
    |       NA(EARO)     |            | [via BGP signaling]
    |&lt;-------------------|            |
    |                    |            |

</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-direct-registration" class="selfRef">Direct Registration</a>
          </figcaption></figure>
</div>
<p id="section-4.2-6">
    In another type of deployment, the 6LR may be a virtual router in the server
    whereas the 6LBR runs in the leaf node. To address that case, the EDAR/EDAC
    may be used to communicate as shown in figure 5 of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.
    This draft leverages the capability to insert IPv6 ND options in the EDAR
    and EDAC messages introduced in <span>[<a href="#RFC8929" class="xref">RFC8929</a>]</span> to place a TLLAO
    that carries the MAC address associated to the Registered address in the
    EDAR and EDAC messages as shown in <a href="#FigDAR" class="xref">Figure 8</a>:<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<span id="name-leveraging-edar"></span><div id="FigDAR">
<figure id="figure-8">
          <div class="alignCenter art-text artwork" id="section-4.2-7.1">
<pre>

        Server                       Leaf
  +----------------+          +----------------+
  |                |          |                |
   6LN          6LR            6LBR        EVPN
    |            |              |            |
    | &lt;vSwitch&gt;  |  Ethernet    | &lt;call I/F&gt; |
    |            |              |            |
    |  NS(EARO)  |              |            |
    |-----------&gt;|              |            |
    |            |  EDAR(TLLAO) |            |
    |            |-------------&gt;|            |
    |            |              |            | ^
    |            |              |   query    | |
    |            |              |-----------&gt;| | if pull
    |            |              |  response  | | model
    |            |              |&lt;-----------| |
    |            |                           | v
    |            |    Evaluation (DAD)       |
    |            |                           |
    |            |              |new mapping |
    |            |              | indication |
    |            |              |-----------&gt;|
    |            |                           | Inject/maintain
    |            |   store a mapping state   | EVPN route type 2
    |            |                           | ------------------&gt;
    |            |  EDAC(TLLAO) |            | [via BGP signaling]
    |            |&lt;-------------|            |
    |  NA(EARO)  |              |            |
    |&lt;-----------|              |            |
    |            |              |            |

</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-leveraging-edar" class="selfRef">leveraging EDAR</a>
          </figcaption></figure>
</div>
<p id="section-4.2-8">
   <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> updates the DAR/DAC messages into the Extended
   DAR/DAC to carry the ROVR field. With this specification, the abstract 6LBR
   is distributed in all the Leaf nodes and synchronized with EVPN.
   When a server successfully registers an address to a leaf, the 6LR on that
   leaf becomes 6LBR for that address. It stores the full state for that address
   including the ROVR and the TID. When the address registration moves to
   another leaf, an EDAR/EDAC flow between the 6LR in the new leaf and the 6LBR
   in the old leaf confirms that the ROVR in the NS(EARO) received at the new
   leaf is correct, in which case the 6LR in the new leaf becomes 6LBR.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
<p id="section-4.2-9">
   When the address is already registered to the local leaf,
   the EDAR/EDAC exchange is either local between a virtual router in the server
   and the leaf, or internal to the leaf between a collapsed 6LR and 6LBR.
   Based on its local state, the 6LBR in the leaf checks whether the proposed
   address/route is new and legit, and can reject it otherwise.<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<p id="section-4.2-10">
   It results that
   duplicate addresses and address impersonation attacks can be filtered at the
   level of IPv6 ND by the 6LBR before the information reaches EVPN.<a href="#section-4.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unic">
<section id="section-4.3">
        <h3 id="name-unicast-address-lookup-with">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-unicast-address-lookup-with" class="section-name selfRef">Unicast Address Lookup with the 6LBR</a>
        </h3>
<p id="section-4.3-1">
  A classical IPv6 ND stack in the server that treats the subnet prefix as
  on-link (more in section 4.6.2. of <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>), will resolve an unknown LLA mapping with a multicast
  NS(lookup) message addressed to the solicited node multicast address (SNMA)
  associated with the destination address being resolved. The RECOMMENDED
  operation in that case is for the 6LBR that has a mapping state to forward the
  packet as a unicast MAC to the LLA that is stored for the IPv6 address as
  expected by  <span>[<a href="#RFC6085" class="xref">RFC6085</a>]</span>. The actual owner of the address can
  then answer unicast with a NA message, setting the override (O) bit to 1,
  as shown in <a href="#figlkup1" class="xref">Figure 9</a>.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<span id="name-forwarding-legacy-ns-lookup"></span><div id="figlkup1">
<figure id="figure-9">
          <div class="alignCenter art-text artwork" id="section-4.3-2.1">
<pre>

  Local             Local                   Remote
  Server            Leaf                    Server
  +----+          +--------+                +----+
  |    |          |        |                |    |
   6LN             6LR/6LBR                  6LN
    |                 |                       |
    |    Ethernet     |                       |
    |                 |     [via EVPN    ]    |
    |    multicast    |     [Data Tunnels]    |
    |    NS(lookup)   |                       |
    |----------------&gt;|                       |
    |                 |    forward unicast    |
    |                 |     NS(lookup)        |
    |                 |----------------------&gt;|
    |                 |                       |
    |                 |         NA(O)         |
    |                 |&lt;----------------------|
    |      NA(O)      |                       |
    |&lt;----------------|                       |
    |                 |                       |

</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-forwarding-legacy-ns-lookup" class="selfRef">Forwarding legacy NS (Lookup)</a>
          </figcaption></figure>
</div>
<p id="section-4.3-3">
  Section 3.1. of <span>[<a href="#RFC8929" class="xref">RFC8929</a>]</span>
  adds the capability to insert IPv6 ND options in the EDAR and EDAC messages.
  This enables the 6LBR to store the link-layer address associated with the
  Registered Address and to serve as a mapping server.
  <span>[<a href="#I-D.thubert-6lo-unicast-lookup" class="xref">UNICAST-LOOKUP</a>]</span> leverages that state to define
  a new unicast address lookup operation, extending the EDAR and EDAC
  messages as the Address Mapping Request (AMR) and Confirmation (AMC) with a
  different Code Prefix <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">
  In that model, the router advertises the subnet prefix as not on-link by
  setting the L flag to 0 in the Prefix Information Option (PIO), more in
  section 4.6.2. of <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>.
  The expected behavior is that the host that communicates with a peer in the
  same subnet refrains from resolving the address mapping and passes the packets
  directly to the router.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">In the case where the router is a virtual 6LR running in the server, and
  the source and destination are in the same subnet served by EVPN, the router
  then resolves the address mapping on behalf of the host. To that effect,
  the router sends a unicast AMR message to the 6LBR.
  The message contains the SLLAO of the router to which the 6LBR will reply.
  If the binding is found, the 6LBR replies with an AMC message that contains
  the TLLOA with the requested MAC address, as shown in <a href="#unilook1" class="xref">Figure 10</a>.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<span id="name-unicast-lookup-from-the-vir"></span><div id="unilook1">
<figure id="figure-10">
          <div class="alignCenter art-text artwork" id="section-4.3-6.1">
<pre>

        Local                 Local             Remote
        Server                 Leaf             Server
  +----------------+       +---------+          +----+
  |                |       |         |          |    |
   6LN          6LR         6LBR/EVPN            6LN
    |            |              |                 |
    |            |              |  [via EVPN    ] |
    | &lt;vSwitch&gt;  |  Ethernet    |  [Data Tunnels] |
    |            |              |                 |
    |            |              |                 |
    |  RA(PIO)   |              |                 |
    | not onlink |              |                 |
    |&lt;-----------|              |                 |
    |            |              |                 |
    |  Packet    |              |                 |
    |-----------&gt;|              |                 |
    |            |              |                 |
    |            | AMR (SLLAO)  |                 |
    |            |-------------&gt;|                 |
    |            |              |                 |
    |            | AMC (TLLAO)  |                 |
    |            |&lt;-------------|                 |
    |            |              |                 |
    |    NCE in STALE state     |                 |
    |            |                                |
    |            |            Packet              |
    |            |-------------------------------&gt;|
    |            |                                |
    |    NCE in DELAY state     |                 |
    |            |              |                 |

</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-unicast-lookup-from-the-vir" class="selfRef">Unicast Lookup from the virtual Host</a>
          </figcaption></figure>
</div>
<p id="section-4.3-7">
  If it is not found,
  <span>[<a href="#I-D.thubert-6lo-unicast-lookup" class="xref">UNICAST-LOOKUP</a>]</span> provides the capability to
  indicate immediately that the mapping is not known with a "not found" status
  in the AMC, as opposed to waiting for an NS(lookup) and retries to time out
  per <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">
  In a fully stateful subnet where all nodes register all their addresses with
  <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>, this means that the looked up address is not
  present in the network; in that case the packet is dropped and an ICMP error
  type 1 "Destination Unreachable" code 3 "Address unreachable" <span>[<a href="#RFC4443" class="xref">RFC4443</a>]</span> is returned as shown in <a href="#unilookfail" class="xref">Figure 11</a>.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<span id="name-unicast-lookup-failure"></span><div id="unilookfail">
<figure id="figure-11">
          <div class="alignCenter art-text artwork" id="section-4.3-9.1">
<pre>


           Local                 Local
           Server                 Leaf
     +----------------+       +---------+
     |                |       |         |
      6LN          6LR         6LBR/EVPN
       |            |              |
       |            |              |
       | &lt;vSwitch&gt;  |  Ethernet    |
       |            |              |
       |            |              |
       |   RA(PIO   |              |
       |not on-link)|              |
       |&lt;-----------|              |
       |            |              |
       |  Packet    |              |
       |-----------&gt;|              |
       |            |              |
       |            | AMR (SLLAO)  |
       |            |-------------&gt;|
       |            |              |
       |            | AMC(status=  |
       |            | "Not Found") |
       |            |&lt;-------------|
       |ICMPv6 Error|              |
       | "Address   |              |
       |Unreachable"|              |
       |&lt;-----------|              |
       |         Drop Packet       |
       |            |              |

</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-unicast-lookup-failure" class="selfRef">Unicast Lookup failure</a>
          </figcaption></figure>
</div>
<p id="section-4.3-10">
  Note that the figures above make no assumption on the pull vs. push model.
  In the case of pull model, the 6LBR queries the EVPN support when it does not have the mapping information to satisfy a request.
  <a href="#Figpull" class="xref">Figure 12</a> illustrates a successful pull model lookup flow,
  when the route type 2 for the mapping is already known on the EVPN side.<a href="#section-4.3-10" class="pilcrow">¶</a></p>
<span id="name-pull-model"></span><div id="Figpull">
<figure id="figure-12">
          <div class="alignCenter art-text artwork" id="section-4.3-11.1">
<pre>

        Server                       Leaf
  +----------------+          +----------------+
  |                |          |                |
   6LN          6LR            6LBR        EVPN
    |            |              |            |
    | &lt;vSwitch&gt;  |  Ethernet    | &lt;call I/F&gt; |
    |            |              |            |
    |            |              |            |
    |            |              |            | Receive EVPN
    |            |              |            | route type 2 for
    |            |              |            | remote address A'
    |            |              |            | [via BGP signaling]
    |            |              |            |&lt;-----------------
    |            |              |     store a mapping state
    |            |              |            |
    |Packet for A'              |            |
    |-----------&gt;|              |            |
    |            |AMR(lookup A')|            |
    |            |-------------&gt;|            |
    |            |              |Query addr A'
    |            |              |-----------&gt;|
    |            |              |            |
    |            |              | return LLA |
    |            |              |&lt;-----------|
    |            |              |            |
    |            |AMC(A''s TLLA)|            |
    |            |&lt;-------------|            |
    |            |              |            |
    |            |            Packet for A'  |
    |            |            [via EVPN    ] |
    |            |            [Data Tunnels] |
    |            |-----------------------------------&gt;
    |            |              |            |

</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-pull-model" class="selfRef">Pull model</a>
          </figcaption></figure>
</div>
<p id="section-4.3-12">
  In the case of push model, the EVPN support synchronizes its state upon a route type 2 with the 6LBR, and the 6LBR maintains an abstract data structure for all information known to EVPN. This way, the 6LBR already has the mapping information to satisfy any request for an existing mapping and
  it can answer right away.
  <a href="#Figpush" class="xref">Figure 13</a> illustrates a successful push model lookup flow,
  when the 6LBR is already in possession of the mapping.<a href="#section-4.3-12" class="pilcrow">¶</a></p>
<span id="name-push-model"></span><div id="Figpush">
<figure id="figure-13">
          <div class="alignCenter art-text artwork" id="section-4.3-13.1">
<pre>

        Server                       Leaf
  +----------------+          +----------------+
  |                |          |                |
   6LN          6LR            6LBR        EVPN
    |            |              |            |
    | &lt;vSwitch&gt;  |  Ethernet    | &lt;call I/F&gt; |
    |            |              |            |
    |            |              |            |
    |            |              |            |
    |            |              |            | Receive EVPN
    |            |              |            | route type 2 for
    |            |              |            | remote address A'
    |            |              |            | [via BGP signaling]
    |            |              |            |&lt;-----------------
    |            |              |     store a mapping state
    |            |              |            |
    |            |              |indicate LLA|
    |            |              |&lt;-----------|
    |            |    store a mapping state  |
    |            |              |            |
    |Packet to A'|              |            |
    |-----------&gt;|              |            |
    |            |AMR(lookup A')|            |
    |            |-------------&gt;|            |
    |            |              |            |
    |            |AMC(A's TLLA) |            |
    |            |&lt;-------------|            |
    |            |              |            |
    |            |            Packet to A'   |
    |            |            [via EVPN    ] |
    |            |            [Data Tunnels] |
    |            |-----------------------------------&gt;
    |            |              |            |

</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-push-model" class="selfRef">Push model</a>
          </figcaption></figure>
</div>
<p id="section-4.3-14">
  In a mixed environment, a lookup failure (the mapping is not found though
  the address is present in the network) may be caused by a legacy node that
  was node discovered (aka a silent node).
  In that case, it is an administrative decision for the 6LR to broadcast an
  NS(lookup) or to return an error as shown in <a href="#unilookfail" class="xref">Figure 11</a>.<a href="#section-4.3-14" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="prereq">
<section id="section-5">
      <h2 id="name-requirements-on-the-evpn-un">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-requirements-on-the-evpn-un" class="section-name selfRef">Requirements on the EVPN-Unaware Host</a>
      </h2>
<p id="section-5-1">
   This document describes how EVPN routing can be extended to reach a Host.
   This section specifies the minimal EVPN-independent functionality that the Host
   needs to implement to obtain routing services for its addresses.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="prereq6lp">
<section id="section-5.1">
        <h3 id="name-support-of-6lowpan-nd">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-support-of-6lowpan-nd" class="section-name selfRef">Support of 6LoWPAN ND</a>
        </h3>
<p id="section-5.1-1">
   A host sees a prefix as not on-link (e.g., it learned that prefix in a PIO
   in a RA with the L flag not set) should not attempt to resolve an address
   within that prefix using a multicast NS(lookup).
   Instead, it must pass its packets to a router, preferably one that advertises
   that prefix in a PIO; it must register the address that it uses as source to
   that router to enable source address validation using
   <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.
   It is recommended that the Host also implements <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span> to
   prove its ownership of its addresses.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
   The Host is expected to request routing services from a router only if that
   router originates RA messages with a 6CIO that has the L, P, and E flags all
   set to 1 as discussed in <a href="#R7400" class="xref">Section 3.5</a>, unless configured to do so.
   To obtain routing services for one of its addresses, the host must register
   the address to a router that advertises the prefix, setting the "R" and "T"
   flags in the EARO to 1 as discussed in <a href="#R8505ER" class="xref">Section 3.3.1</a> and
   <a href="#R8505ETID" class="xref">Section 3.3.2</a>, respectively.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">
   This document echoes the behavior specified in <span>[<a href="#RFC9010" class="xref">RFC9010</a>]</span>
   whereby, when the R Flag set to 1 in a NS(EARO) is not echoed in the NA(EARO),
   the host must understand that the route injection failed, and
   if the R flag is reset later in an asynchronous NA(EARO), the host must
   understand that routing service has failed.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">
   The host may attach to multiple 6LRs and is expected to prefer those that
   provide routing services. The abstract model for this is a P2MP interface
   that wraps together as many P2P IP Links the host has adjacencies to 6LRs
   over that interface. The IPv6 address and the subnet are associated to that
   interface.
   The interface may be virtual and it may bundle multiple physical Ethernet
   interfaces that connect to the individual 6LRs over point to point wires,
   possibly via a software switch.
   It can also be associated to one physical interface to an external switch,
   either way the PI Links can be associated to sub-interface of the interface.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">
   The Host needs to register to all the 6LRs from which it desires routing
   services. The multiple Address Registrations to several 6LRs should be
   performed in a rapid sequence, using the same EARO for the same Address.
   Gaps between the Address Registrations will invalidate some of the routes
   till the Address Registration finally shows on those routes.
   The routers recognize the same (ROVR, TID) as the signal of a multihomed
   address and maintain all the routes.
   In the case of EVPN, the Ethernet Segment must also be the same. The flow
   for a successful multihomed registration is illustrated in
   <a href="#fRegmul" class="xref">Figure 17</a>.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6"><span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> introduces error Status values in the NA(EARO)
   which can be received synchronously upon an NS(EARO) or asynchronously.
   The Host needs to support both cases and refrain from using the address
   when the Status value indicates a rejection.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">This specification can be used to register Anycast and Multicast IPv6
   addresses as discussed in <a href="#mcast" class="xref">Section 3.3.5</a> and replace MLDv2.
   To benefit from that capability, both the host and the 6LR MUST support
   the "A" and "M" flags that indicate Anycast and Multicast Addresses
   respectively. Those flags are defined in
   <span>[<a href="#I-D.thubert-6lo-multicast-registration" class="xref">I-D.thubert-6lo-multicast-registration</a>]</span> for use in the EARO
   and in the EDAR and EDAC messages.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="upd">
<section id="section-6">
      <h2 id="name-enhancements-to-evpn">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-enhancements-to-evpn" class="section-name selfRef">Enhancements to EVPN</a>
      </h2>
<p id="section-6-1">This section addresses the necessary changes to EVPN formats and behavior to support
        address registration security per <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span> and mobility per <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>
        while retaining interoperability with traditional nodes.
        Basically the MAC Mobility Extended Community <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span> and the
        ARP/ND Extended Community <span>[<a href="#RFC9047" class="xref">RFC9047</a>]</span> are extended to advertise
        the sequencing and ownership validation information received in the EARO.
        With 6LR injecting not only MACs via packet sources and TLLAO options but also ROVR into MAC Mobility and ARP/ND Extended Community, their semantics will be somewhat extended. Specifically following issues have to be addressed:<a href="#section-6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1">
            The ROVR extends the semantics of the type-2 MAC advertisement via changes in ARP/ND
           and MAC Mobility Extended Community in the sense that the MAC
            must be aligned with the ROVR and under normal circumstances
            only the validity of ROVR guarantees that the type-2
            MAC can be allocated to the requester. A MAC validated by ROVR should take precedence
            over MAC addresses allocated without using it given it presents a much more trustworthy
            topological information (it will be called ROVR MAC in further
            text). EVPN nodes not supporting extensions introduced by this document
            will need to be led to believe that a ROVR MAC is to be preferred over any advertisement
            they see as long a ROVR MAC route is present. Nevertheless, primary key of NRLI is still
            the (IP, MAC, Ethernet Tag ID) tuple as defined in <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>, Section 7.2 and 7.7.
            This implies
            that the same MAC (and consequently ROVR MAC) can be assigned multiple IP addresses and
            those represent independent NLRIs.<a href="#section-6-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.2">
           The TID field in the EARO is smaller than the mobility sequence number in <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>.
           To allow a ROVR MAC mobility to "win" over legacy MACs in every circumstance,
            signaling must be introduced that enables to
           distinguish a TID-generated sequence number from a legacy sequence number.<a href="#section-6-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.3">
          <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> supports IP multihoming, but does not differentiate multihoming from
            anycast, e.g., using the MAC address, to enable MAC address rotation. If an anycast IP address
            is registered with a different ROVR it will be rejected as duplicate. If it is
           registered with a different TID, the older sequence will be withdrawn. So the basic expectation
            with <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> is that
           the advertisement of an anycast address is coordinated, with the same keypair known to all parties,
            and the same value of the TID used by all nodes (and possibly never increasing), in other words,
            with no concept of mobility.<a href="#section-6-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.4">
          <p id="section-6-2.4.1">
        <span>[<a href="#I-D.thubert-6lo-multicast-registration" class="xref">I-D.thubert-6lo-multicast-registration</a>]</span> adds new flags in the EARO
        to signal that an address is anycast or multicast, respectively. This specification
        injects that information in the ARP/ND extended community using matching flags as follows:<a href="#section-6-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.4.2.1">
           This specification uses the "O" flag in the  ARP/ND extended community to signal that the IP address is anycast, and requires
            the local 6LBR to ignore the duplication if the same IP address is registered locally, and then to
            inject the NLRI with the "O" flag set on the ARP/ND Extended Community as well.<a href="#section-6-2.4.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6-2.4.2.2">
           This specification adds the new "M" flag in the ARP/ND extended community to signal that the IP address is multicast, and requires
            the local 6LBR to ignore the duplication if the same IP address is registered locally, and then to
            inject the NLRI with the "M" flag set on the ARP/ND Extended Community as well.<a href="#section-6-2.4.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-6-2.5">
          <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span> needs the full ROVR to validate the address ownership,
            but the full ROVR can be too large to advertise through BGP.
           When an IP address is advertised through EVPN, it is REQUIRED that the EVPN Next Hop
            represents
            the address of the 6LBR of the leaf where the address was registered as well.
            This way, if the address is registered later on a second leaf,
            the 6LR in second leaf can leverage an out-of-band, i.e. via EVPN traffic carrying
            tunnels, EDAR/EDAC exchange
            with that 6LBR to validate that the ROVR in the registration is indeed the same.
            When that is the case, it can continue with the registration procedure and if
            successful, become a 6LBR for that IP address, either as a mobility event or as a
            multihomed registration.<a href="#section-6-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.6">
          <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span> expects nodes to autoconfigure the keypair that is
            used to form the ROVR, in which case the IPv6 address can be locally
            autoconfigured with no central coordination; in that case, the ROVR only
            protects the ownership and enforce first-come first-serve and source address
            validation. But it is also possible to pre-provision the ROVR in the 6LBR
            and then provision the keypair in the node, e.g., in the case of a trusted
            server. To enable that capability in EVPN, this specification adds a flag to
            signal that the 6LBR that injects the address in EVPN does not provide
            reachability to the address. When that flag is set, the value of the TID is
            ignored in the mobility computation, the mapping to the MAC address is ignored,
            and the route to the IP address is not injected in the RIB on ROVR nodes.
            Non-ROVR nodes will consider the node a "honey-pot". Once the address is
            registered by a 6LN in the network and the according validation with
            the node advertising the U-bit version of the route performed, the
            owner will inject the route without the U-bit. A node advertising the
            NLRI with U-bit in its ARP/ND Extended Community MUST withdraw the U-bit route once it sees a validated
            NLRI without the U-bit and it MAY reinject the route with the U-bit once all routes without the U-bit are withdrawn to protect the address again.<a href="#section-6-2.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-3">
        EVPN signaling is not used to carry ROVR since without challenge per  <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span>
        they do not represent any difference over using the IP/MAC combination.
        Instead, the full ROVR is verified upon a movement or a multi-homed advertisement using an EDAR/EDAC exchange.

        Additionally,
        backwards compatibility could not be preserved given comparing routes based on ROVR would
        present a change in primary key of NLRIs which non-ROVR routers do not implement. An indication
        from a ROVR node that a MAC has been validated by proof of ownership is enough to convey the
        necessary information.
        Only a small hash of the ROVR is carried to speed up the identification of an address duplication.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="aec">
<section id="section-6.1">
        <h3 id="name-arp-nd-extended-community">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-arp-nd-extended-community" class="section-name selfRef">ARP/ND Extended Community</a>
        </h3>
<p id="section-6.1-1">
   The ARP/ND Extended Community defined in <span>[<a href="#RFC9047" class="xref">RFC9047</a>]</span>
   is a transitive EVPN Extended Community (Type field value of 0x06) with a
   Sub-Type of 0x08. It is advertised along with EVPN MAC/IP Advertisement
   routes that carry an IPv4 or IPv6 address.
   Extending the ARP/ND Extended Community to transport fields from the
   EARO is natural since the EARO is an extension to IPv6 ND.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2"></p>
<p id="section-6.1-3">ROVR nodes MUST set the "H" flag in Mobility Extended Community to indicate that
    the advertisement is a ROVR MAC in case the host followed the according procedures.
        ROVR MACs use (instead of increasing the normal sequence
    number) the TID in the high bits of the sequence number field to "override" any normal MAC
    advertisement (further considerations will be provided in <a href="#EVPNproc" class="xref">Section 6.3</a>).<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">ROVR nodes MUST set the "V" flag if the address assignment passed proof of ownership per
        <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span>. Such "validated" ROVR MAC addresses will be preferred by
        ROVR nodes over non
    validated ROVR MACs.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">In case a ROVR node configures the address as "sticky" (since the sticky bit semantics
    have been changed to the point a ROVR cannot tell whether address is really sticky unless
    advertised as such by non-ROVR node) a new "X" flag called "super sticky" is introduced.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<span id="name-updated-arp-nd-extended-com"></span><div id="aecpic">
<figure id="figure-14">
          <div class="alignCenter art-text artwork" id="section-6.1-6.1">
<pre>

  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | Type=0x06     | Sub-Type=0x08 |    Flags (2 octet)            |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | Reserved = 0  |                 ROVR Hash                     |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Flags field:
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |       |I| |O|R|   |M|U|M|X|V|H|
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-updated-arp-nd-extended-com" class="selfRef">Updated ARP/ND Extended Community</a>
          </figcaption></figure>
</div>
<p id="section-6.1-7">Flags:<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.1-8">
          <dt id="section-6.1-8.1">U:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-8.2">Unreachable, indicating that the IP address is not reachable
        via that EVPN next hop, but is advertised for the purpose of protecting
        the value of the ROVR until a first 6LBR that can reach the address
        becomes available.<a href="#section-6.1-8.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-8.3">M:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-8.4">Multicast, indicating that the IP address duplication
        should be ignored. When this bit is set, TID should be ignored in
        comparison of EVPN advertisements, i.e. all ROVR MACs at same
        level of validation MUST be considered having same TID.<a href="#section-6.1-8.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-8.5">V:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-8.6">ROVR Validated indicates that the MAC passed proof of ownership per
            <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span>. Presence of this bit implies the "R" bit being set irregardless of its value.<a href="#section-6.1-8.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-8.7">X:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-8.8">Super Sticky indicates that the ROVR MAC is sticky and should follow
                procedures of sticky per <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>.<a href="#section-6.1-8.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-8.9">H:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-8.10">ROVR Capable indicates that the advertisement is originated
            after processing signaling from host meeting the requirements in <a href="#prereq" class="xref">Section 5</a>.
            This indicates a ROVR MAC.<a href="#section-6.1-8.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-8.11">ROVR Hash:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-8.12">Hash of ROVR used to generate the according ROVR MAC. Hash is built
            by XOR'ing ROVR bytes in network order into the least significant byte and rotating
            the two bytes result after every byte by one bit to the left.<a href="#section-6.1-8.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="tgt">
<section id="section-6.2">
        <h3 id="name-rovr-mac-mobility-extended-">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-rovr-mac-mobility-extended-" class="section-name selfRef">ROVR MAC Mobility Extended Community</a>
        </h3>
<p id="section-6.2-1">
        Extending MAC Mobility Extended Community to transport the TID
        allows to design a solution that,
        while backwards compatible, allows to introduce ROVR MAC as "more trusted"
        entities. <a href="#fEVPNtgt" class="xref">Figure 15</a> presents the according extensions that
        will however necessitate some further explanation.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">
        To introduce a "precedence" of ROVR MACs over normal EVPN MACs ROVR MACs are advertised
        to look like "sticky" MACs for non-ROVR nodes.
        As defined in the glossary, for simplicity reasons such nodes will be called non-ROVR nodes vs. ROVR nodes.
        The "sticky" bit will force non-ROVR nodes to disregard the sequence number and
        accept any IP/MAC route provided.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<span id="name-modified-mac-mobility-exten"></span><div id="fEVPNtgt">
<figure id="figure-15">
          <div class="alignLeft art-text artwork" id="section-6.2-3.1">
<pre>
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | Type=0x06     | Sub-Type=0x00 |  Flags = 0  |S|  Reserved = 0 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |T| Flags = 0   |       TID     |     Reserved = 0              |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-modified-mac-mobility-exten" class="selfRef">Modified MAC Mobility Extended Community</a>
          </figcaption></figure>
</div>
<p id="section-6.2-4">
   This specification updates the Sequence Number field defined in
   <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>. The field is split in 3 parts, one 8-bit flags
   field, the TID, and a reserver 2-byte field. The unspecified flags and the
   reserved fields MUST be set to 0 by the sender and ignored by the receiver.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">
    The "S" flag is defined in <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>.
    The following new fields are defined:<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2-6">
          <dt id="section-6.2-6.1">T:</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-6.2">1-bit flag. MUST be set to 1 when this specification is used. This
        ensures that the TID always wins vs. the sequence counter defined in
        <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span><a href="#section-6.2-6.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-6.3">TID:</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-6.4">contains the ROVR MAC TID per <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>. This MUST NOT be
    zero, i.e. a ROVR<a href="#section-6.2-6.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="EVPNproc">
<section id="section-6.3">
        <h3 id="name-extended-rovr-mac-procedure">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-extended-rovr-mac-procedure" class="section-name selfRef">Extended ROVR MAC Procedures</a>
        </h3>
<p id="section-6.3-1">In case a non-ROVR node advertises a sticky MAC by setting the "S" bit and a ROVR node
            sees an ROVR address registration for the same MAC it MUST follow procedures per <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">In case a non-ROVR node advertises a sequence number larger than the one generated by TID on a ROVR
            node, the ROVR node SHOULD advertise a Sequence Number consisting of all bits being set to force a "roll-over" on all nodes and
        then fall back to advertising the TID generated sequence number again. In case a non-ROVR node persists in
        increasing the sequence number after that it is indication of violation of  <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span> on its part.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">
            A ROVR node advertising a ROVR MAC that has not been validated and receiving same type-2 route that has been
            validated MUST immediately withdraw its advertisement.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">
            A ROVR node advertising a ROVR MAC and receiving an equivalent ROVR MAC from other node with a higher TID
            MUST immediately withdraw its advertisement. This will allow the non-ROVR nodes to correctly interpret
            the sequence as MAC move despite ignoring the sequence number due to presence of "S" bit.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">
            A ROVR node that receives a ROVR MAC with "super sticky" indication and seeing the MAC locally MUST
            follow analogous procedures to <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<p id="section-6.3-6">
            Multi-homing a MAC on mix of ROVR and non-ROVR nodes will lead to operational notifications since
            per <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span> the non-ROVR node will interpret the situation as a sticky MAC that
            has shown up on its local interface unless an implementation is somewhat clever and understands that
            the presence of the same ESI on all the routes indicates that this situation does not represent a
            sticky MAC being moved.<a href="#section-6.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="op">
<section id="section-7">
      <h2 id="name-protocol-operations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-protocol-operations" class="section-name selfRef">Protocol Operations</a>
      </h2>
<p id="section-7-1">
   Following section illustrates several situations and resulting signaling
   in EVPN from the point of view of a ROVR node.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">
  <a href="#fReg1" class="xref">Figure 16</a> illustrates the registration flow of a new address
  protected by <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span>. The ROVR in the EARO is a Crypto-ID
  that derives from a public address through hashing with some other terms.
  The router challenges the host with a status of 5 (validation requested).<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">
  The host performs the NS again, passing the parameters that enable to build
  the Crypto-ID in a Crypto-ID Parameters Option (CIPO), and signing that set
  of parameters together with a pair of Nonce values, one from each side, in a
  resulting Neighbor Discovery Protocol Signature Option (NDPDO). The 6LR first
  verifies that the Crypto-ID can be rebuilt based on the public key, then verifies that the signature in the NDPSO was effectively performed with the
  associated public key. When that is the case, the registration flow can
  continue, else the registration is rejected with a status of 10 (Validation
  Failed) in the NA(EARO).<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">
  With this specification, the 6LBR communicates internally with the collocated
  EVPN router to inject the route in EVPN. Since the <span>[<a href="#RFC8928" class="xref">RFC8928</a>]</span>
  validation was performed, the V flag is set. Once this is done, the local 6LBR
  installs a local state associated to the NCE and becomes owner of the
  registration, whereas the remote leaves optionally install a remote state for
  the address with the indication of the 6LBR that owns the registration. The
  local 6LBR MUST be signalled as EVPN Next Hop for the route.<a href="#section-7-4" class="pilcrow">¶</a></p>
<span id="name-host-registration"></span><div id="fReg1">
<figure id="figure-16">
        <div class="alignCenter art-text artwork" id="section-7-5.1">
<pre>
   Local            Local              Route           Remote
   Server           Leaf             Reflector         Leaf
  +-------+       +---------+        +-------+        +---------+
  |       |       |         |        |       |        |         |
     6LN           6LBR/EVPN            BGP            EVPN/6LBR
      |                |                 |                |
      |    Ethernet    |      [via BGP signaling]         |
      |                |                 |                |
      |                |                 |                |
      |  NS(EARO(      |                 |                |
      |       R set))  |                 |                |
      |---------------&gt;|                 |                |
      |   ROVR in EARO is cryptographic  |                |
      |                |                 |                |
      |     NA(EARO(   |                 |                |
      |   R not set,   |                 |                |
      |   status = 5), |                 |                |
      |        Nonce1) |                 |                |
      |&lt;---------------|                 |                |
      |                |                 |                |
      |   NS(EARO(     |                 |                |
      |        R set), |                 |                |
      |      CIPO,     |                 |                |
      |      Nonce2,   |                 |                |
      |      NDPSO)    |                 |                |
      |---------------&gt;|                 |                |
      |        Proof verified            |                |
      |     no state for that address    |                |
      |      install local state         |                |
      |                |                 |                |
      |                |  ROVR MAC Route A'               |
      |                |----------------&gt;|                |
      |        route injected            |                |
      |                |                 |                |
      |     NA(EARO(   |                 |                |
      |   R set,       |                 |                |
      |   status = 0)) |                 |                |
      |&lt;---------------|                 |                |
      |                |                 | ROVR MAC Route A'
      |                |                 |---------------&gt;|
      |                |                 |    install remote state
      |                |                 |                |

</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-host-registration" class="selfRef">Host Registration</a>
        </figcaption></figure>
</div>
<p id="section-7-6">
  <a href="#fRegmul" class="xref">Figure 17</a> presents the same flow but for a multihomed address;
  here and in the following flows, the proof of ownership section is not shown,
  but its use is RECOMMENDED. The interesting piece is that when the node
  registers to the second 6LBR, that second 6LBR find that there is a first
  6LBR that already own the registration. Using and EDAR / EDAC flow, the
  second 6LBR validates that the ROVR and TID are identical, in which case it
  accepts the registration and becomes another 6LBR owner of the registration.
  The result is that the 2 6LBRs are synchronized and any of the 2 can now be
  used, e.g., if the address is registered a third time.<a href="#section-7-6" class="pilcrow">¶</a></p>
<span id="name-multihoming"></span><div id="fRegmul">
<figure id="figure-17">
        <div class="alignCenter art-text artwork" id="section-7-7.1">
<pre>
    Local            Local          Local
    Server           Leaf 1         Leaf 2           Reflector
  +-------+       +---------+    +---------+       +---------+
  |       |       |         |    |         |       |         |
     6LN           6LBR/EVPN      6LBR/EVPN             |
      |                |              |                 |
      |    Ethernet    |              |                 |
      |                |              |       [via BGP signaling]
      |                |              |                 |
      |   NS(EARO)     |              |                 |
      |---------------&gt;|              |                 |
      |      install local state      |                 |
      |                |                                |
      |                |------ROVR MAC Route A'   -----&gt;|
      |   NA(EARO)     |              |                 |
      |&lt;---------------|              |                 |
      |                |              |&lt;----------------|
      |                |    install remote state        |
      |                |              |                 |
      | NS(same address, ES and EARO) |                 |
      |------------------------------&gt;|                 |
      |                |              |                 |
      |                |        Same ES and ROVR Hash   |
      |                |   EDAR       |                 |
      |                |&lt;-------------|                 |
      |                |              |                 |
      |       ROVR match, TID OK      |                 |
      |                |              |                 |
      |                |EDAC(status=0)|                 |
      |                |-------------&gt;|                 |
      |                |    install local state         |
      |                |              |                 |
      |                |       ROVR MAC Route A'        |
      |                |              |----------------&gt;|
      |                |&lt;-------------------------------|
      |        install remote state   |                 |
      |                |              |                 |
      |     NA(EARO(status = 0))      |                 |
      |&lt;------------------------------|                 |
      |                |              |                 |
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-multihoming" class="selfRef">Multihoming</a>
        </figcaption></figure>
</div>
<p id="section-7-8">
   The registration is associated with a lifetime, and it must be renewed with
   an incremented TID. The new TID is propagated in EVPN as illustrated in
  <a href="#fReg2" class="xref">Figure 18</a>.<a href="#section-7-8" class="pilcrow">¶</a></p>
<span id="name-host-registration-renewal"></span><div id="fReg2">
<figure id="figure-18">
        <div class="alignCenter art-text artwork" id="section-7-9.1">
<pre>

   Local            Local              Route           Remote
   Server           Leaf             Reflector         Leaf
  +-------+       +---------+        +-------+        +---------+
  |       |       |         |        |       |        |         |
     6LN           6LBR/EVPN            BGP            EVPN/6LBR
      |                |                 |                |
      |    Ethernet    |      [via BGP signaling]        |
      |                |                 |                |
      |                |                 |                |
      |  NS(EARO(      |                 |                |
      |    TID+1))     |                 |                |
      |---------------&gt;|                 |                |
      |   renew lifetime locally         |                |
      |                |                 |                |
      |                |  ROVR MAC Route A'(TID+1)        |
      |                |----------------&gt;|                |
      |   NA(EARO      |                 |---------------&gt;|
      |   status = 0)) |                 |     update remote state
      |&lt;---------------|                 |                |
      |                |                 |                |
      |                |                 |                |
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-host-registration-renewal" class="selfRef">Host Registration Renewal</a>
        </figcaption></figure>
</div>
<p id="section-7-10">
  <a href="#fRegdup" class="xref">Figure 19</a> illustrates the case where a second host registers
  the same address, creating a potential address duplication situation.
  in most cases, the ROVR hash will be different, and the local 6LBR can reject
  the registration is a status of 1 (duplicate) right away.<a href="#section-7-10" class="pilcrow">¶</a></p>
<span id="name-duplicate-addresses"></span><div id="fRegdup">
<figure id="figure-19">
        <div class="alignCenter art-text artwork" id="section-7-11.1">
<pre>
   Local            Local              Route           Remote
   Server           Leaf             Reflector         Leaf
  +-------+       +---------+        +-------+        +---------+
  |       |       |         |        |       |        |         |
     6LN           6LBR/EVPN            BGP            EVPN/6LBR
      |                |                 |                |
      |    Ethernet    |                 |                |
      |                |        [via BGP signaling]      |
      |                |                 |                |
      |                |                 |         Local state for A'
      |                |                 |                |
      |                |          ROVR MAC Route A'       |
      |                |              ROVR Hash G         |
      |                |                 |&lt;---------------|
      |                |&lt;----------------|                |
      |      Create remote state for A'  |                |
      |                |                 |                |
      |   NS(EARO)     |                 |                |
      |---------------&gt;|                 |                |
      |         compute ROVR Hash F      |                |
      |                |                 |                |
      |   NA(EARO(     |                 |                |
      |   status = 1)) |                 |                |
      |&lt;---------------|                 |                |
      |                |                 |                |
      |                |                 |                |
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-duplicate-addresses" class="selfRef">Duplicate Addresses</a>
        </figcaption></figure>
</div>
<p id="section-7-12">
  <a href="#fRegdup2" class="xref">Figure 20</a> illustrates the case of an address duplication
  situation where by chance, the ROVR hashes are the same. In that case, the
  local 6LR checks with the 6LBR that owns the registration using an EDAR/EDAC message exchange. As opposed to the ROVR hash, the full ROVRs do not collide
  and the registration is also rejected.<a href="#section-7-12" class="pilcrow">¶</a></p>
<span id="name-duplicate-addresses-rovr-ha"></span><div id="fRegdup2">
<figure id="figure-20">
        <div class="alignCenter art-text artwork" id="section-7-13.1">
<pre>
   Local            Local              Route           Remote
   Server           Leaf             Reflector         Leaf
  +-------+       +---------+        +-------+        +---------+
  |       |       |         |        |       |        |         |
     6LN           6LBR EVPN            BGP            EVPN/6LBR
      |              |   |               |               |   |
      |    Ethernet  |   |               |               |   |
      |              |   |        [via BGP signaling]    |   |
      |              |   |               |               |   |
      |              |   |               |     Local state for A'
      |              |   |               |               |   |
      |              |   |        ROVR MAC Route A'      |   |
      |              |   |            ROVR Hash G        |   |
      |              |   |               |&lt;--------------|   |
      |              |   |&lt;--------------|               |   |
      |      Create remote state for A'  |               |   |
      |              |   |                               |   |
      |              |                                       |
      |              |       [[out of band signaling]]       |
      |   NS(EARO)   |                                       |
      |-------------&gt;|                                       |
      |         compute ROVR Hash G                          |
      |              |                                       |
      |              |      EDAR to EVPN Next Hop            |
      |              |--------------------------------------&gt;|
      |              |                                       |
      |              |               EDAC (status = 1)       |
      |              |&lt;--------------------------------------|
      |              |                                       |
      |  NA(EARO(    |                                       |
      |  status = 1))|                                       |
      |&lt;-------------|                                       |
      |              |                                       |
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-duplicate-addresses-rovr-ha" class="selfRef">Duplicate Addresses, ROVR Hash Collision</a>
        </figcaption></figure>
</div>
<p id="section-7-14">
  <a href="#fRegold" class="xref">Figure 21</a> shows a rare case where the registration has already
  moved elsewhere with an incremented TID when the local registration is
  received after being delayed in the network. In that case, the registration is
  rejected with a status of 3 (moved).<a href="#section-7-14" class="pilcrow">¶</a></p>
<span id="name-address-already-moved"></span><div id="fRegold">
<figure id="figure-21">
        <div class="alignCenter art-text artwork" id="section-7-15.1">
<pre>
   Local            Local              Route           Remote
   Server           Leaf             Reflector         Leaf
  +-------+       +---------+        +-------+        +---------+
  |       |       |         |        |       |        |         |
     6LN           6LBR/EVPN            BGP            EVPN/6LBR
      |                |                 |                |
      |    Ethernet    |                 |                |
      |                |        [via BGP signaling]       |
      |                |                 |                |
      |                |          ROVR MAC Route A'       |
      |                |         ESI X', Hash F, TID Z    |
      |                |                 |&lt;---------------|
      |                |&lt;----------------|                |
      |         create remote start A'   |                |
      |       ESI X', ROVR Hash F, TID Z |                |
      |                |                 |                |
      |   NS(EARO(     |                 |                |
      |     TID=Z-1))  |                 |                |
      |---------------&gt;|                 |                |
      |           computes as            |                |
      |           ROVR Hash F            |                |
      |           ESI X'', TID Z-1       |                |
      |   NA(EARO)     |                 |                |
      |   status = 3)) |                 |                |
      |&lt;---------------|                 |                |
      |                |                 |                |
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-address-already-moved" class="selfRef">Address Already Moved</a>
        </figcaption></figure>
</div>
<p id="section-7-16">
        Address move differs from multi-homing by the ESI being different
        as visualized by <a href="#fRegmov" class="xref">Figure 22</a>.
        In case of different ESI BGP signalling happens immediately, in
        case of multi-homing we can reasonably expect for the signalling
        to catch up on the other leg with a new, higher TID. However,
        since ESI matches TID doesn't matter strictly speaking and the
        new remote state can be installed as is. However, if 6LN is
        not refreshing it registration we can expect elapsed lifetime
        to create scenario
        <a href="#fRegTO" class="xref">Figure 25</a> over time.<a href="#section-7-16" class="pilcrow">¶</a></p>
<span id="name-address-move"></span><div id="fRegmov">
<figure id="figure-22">
        <div class="alignCenter art-text artwork" id="section-7-17.1">
<pre>

   Local            Local              Route           Remote
   Server           Leaf             Reflector         Leaf
  +-------+       +---------+        +-------+        +---------+
  |       |       |         |        |       |        |         |
     6LN           6LBR/EVPN            BGP            EVPN/6LBR
      |                |                 |                |
      |    Ethernet    |                 |                |
      |                |        [via BGP signaling]       |
      |   NS(EARO)     |                 |                |
      |---------------&gt;|                 |                |
      |        Create local state        |                |
      |                |        ROVR MAC Route A'         |
      |                |     ESI X', ROVR Hash F, TID Z   |
      |                |----------------&gt;|                |
      |                |                 |---------------&gt;|
      |                |                 |     Create remote state

Same ES (multihomed):
      |                |                 |                |&lt;--
      |                |                 | New local state A' created
      |                |                 |                |
      |                |          ROVR MAC Route A'       |
      |                |         ESI X', Hash F, TID Z+1  |
      |                |                 |&lt;---------------|
      |                |&lt;----------------|                |
      |        Create remote state       |                |
      |       Keep local expect renew    |                |
      |                |                 |                |

Different ES (movement):
      |                |                 |                |&lt;--
      |                |                 | New local state A' created
      |                |                 |                |
      |                |          ROVR MAC Route A'       |
      |                |    ESI X'', ROVR Hash F, TID Z+1 |
      |                |                 |&lt;---------------|
      |                |&lt;----------------|                |
      |        Create remote state       |                |
      |                |                 |                |
      |   NA(EARO(     |                 |                |
      |   status = 4)) |                 |                |
      |&lt;---------------|                 |                |
      |                | Withdraw ROVR MAC Route A'       |
      |                |----------------&gt;|                |
      |                |                 |---------------&gt;|
      |     remove local state           |                |
      |                |                 |                |

</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-address-move" class="selfRef">Address Move</a>
        </figcaption></figure>
</div>
<p id="section-7-18">
  The host that registered the address may cancel the registration at any time,
  e.g., if the address is removed fmor its own interface. This is done by
  registering with a lifetime if 0 as shown in <a href="#fRegArmov" class="xref">Figure 23</a>.
  The Leaf may respond with a status of 0 to indicate success, but a status of 4 (removed) is preferred for this situation.<a href="#section-7-18" class="pilcrow">¶</a></p>
<span id="name-address-removal"></span><div id="fRegArmov">
<figure id="figure-23">
        <div class="alignCenter art-text artwork" id="section-7-19.1">
<pre>
   Local            Local              Route           Remote
   Server           Leaf             Reflector         Leaf
  +-------+       +---------+        +-------+        +---------+
  |       |       |         |        |       |        |         |
     6LN           6LBR/EVPN            BGP            EVPN/6LBR
      |                |                 |                |
      |    Ethernet    |                 |                |
      |                |        [via BGP signaling]       |
      |                |                 |                |
      | NS(EARO,       |                 |                |
      |    lifetime=0) |                 |                |
      |---------------&gt;|                 |                |
      |                |                 |                |
      |                | Withdraw ROVR MAC Route A'       |
      |                |----------------&gt;|                |
      |                |                 |---------------&gt;|
      |   NA(EARO(     |                 |                |
      |   status = 4)) |                 |                |
      |&lt;---------------|                 |                |
      |                |                 |                |
      |     remove local state           |                |
      |                |                 |                |
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-address-removal" class="selfRef">Address Removal</a>
        </figcaption></figure>
</div>
<p id="section-7-20">
  The host that registered the address may withdraw the route but maintain the
  NCE, e.g., in the case where it is multihomed but does not want to use one
  interface for the traffic back as this time. This is done by
  registering with the R flag set to 0 as shown in <a href="#fRegRrmov" class="xref">Figure 24</a>.<a href="#section-7-20" class="pilcrow">¶</a></p>
<span id="name-route-type-2-removal"></span><div id="fRegRrmov">
<figure id="figure-24">
        <div class="alignCenter art-text artwork" id="section-7-21.1">
<pre>
    Local            Local              Route           Remote
   Server           Leaf             Reflector         Leaf
  +-------+       +---------+        +-------+        +---------+
  |       |       |         |        |       |        |         |
     6LN           6LBR/EVPN            BGP            EVPN/6LBR
      |                |                 |                |
      |    Ethernet    |                 |                |
      |                |        [via BGP signaling]       |
      |                |                 |                |
      | NS(EARO,       |                 |                |
      |    R reset)    |                 |                |
      |---------------&gt;|                 |                |
      |                |                 |                |
      |                | Withdraw ROVR MAC Route A'       |
      |                |----------------&gt;|                |
      |                |                 |---------------&gt;|
      |   NA(EARO(     |                 |                |
      |   R reset,     |                 |                |
      |   status = 0)) |                 |                |
      |&lt;---------------|                 |                |
      |                |                 |                |
      |     retain only NCE              |                |
      |                |                 |                |
</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-route-type-2-removal" class="selfRef">Route Type 2 Removal</a>
        </figcaption></figure>
</div>
<p id="section-7-22">
  When the lifetime elapses, the 6LBR requires the collocated EVPN router to
  withdraw the route.<a href="#section-7-22" class="pilcrow">¶</a></p>
<span id="name-lifetime-elapse"></span><div id="fRegTO">
<figure id="figure-25">
        <div class="alignCenter art-text artwork" id="section-7-23.1">
<pre>
    Local            Local              Route           Remote
   Server           Leaf             Reflector         Leaf
  +-------+       +---------+        +-------+        +---------+
  |       |       |         |        |       |        |         |
     6LN           6LBR/EVPN            BGP            EVPN/6LBR
      |                |                 |                |
      |    Ethernet    |                 |                |
      |                |        [via BGP signaling]       |
      |                |                 |                |
      |     lifetime Expired             |                |
      |                |                 |                |
      |                | Withdraw ROVR MAC Route A'       |
      |                |----------------&gt;|                |
      |                |                 |---------------&gt;|
      |   NA(EARO(     |                 |                |
      |   status = 4)) |                 |                |
      |&lt;---------------|                 |                |
      |                |                 |                |
      |     remove local state           |                |
      |                |                 |                |
</pre>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-lifetime-elapse" class="selfRef">Lifetime Elapse</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">TBD<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
</section>
</div>
<div id="Acks">
<section id="section-10">
      <h2 id="name-acknowledgments">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-10-1">
   The authors wish to thank you for reading that far.
   We acknowledge and express gratitude to Wen Lin, Stephane Litkowski, Eric
   Levy-Abegnoli, Lukas Krattiger, Jerome Tollet, and Ali Sajassi, for their
   help and support.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-normative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3810">[RFC3810]</dt>
      <dd>
<span class="refAuthor">Vida, R., Ed.</span> and <span class="refAuthor">L. Costa, Ed.</span>, <span class="refTitle">"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"</span>, <span class="seriesInfo">RFC 3810</span>, <span class="seriesInfo">DOI 10.17487/RFC3810</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3810">https://www.rfc-editor.org/info/rfc3810</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4443">[RFC4443]</dt>
      <dd>
<span class="refAuthor">Conta, A.</span>, <span class="refAuthor">Deering, S.</span>, and <span class="refAuthor">M. Gupta, Ed.</span>, <span class="refTitle">"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 89</span>, <span class="seriesInfo">RFC 4443</span>, <span class="seriesInfo">DOI 10.17487/RFC4443</span>, <time datetime="2006-03" class="refDate">March 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4443">https://www.rfc-editor.org/info/rfc4443</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4861">[RFC4861]</dt>
      <dd>
<span class="refAuthor">Narten, T.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Simpson, W.</span>, and <span class="refAuthor">H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4862">[RFC4862]</dt>
      <dd>
<span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6775">[RFC6775]</dt>
      <dd>
<span class="refAuthor">Shelby, Z., Ed.</span>, <span class="refAuthor">Chakrabarti, S.</span>, <span class="refAuthor">Nordmark, E.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 6775</span>, <span class="seriesInfo">DOI 10.17487/RFC6775</span>, <time datetime="2012-11" class="refDate">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6775">https://www.rfc-editor.org/info/rfc6775</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6085">[RFC6085]</dt>
      <dd>
<span class="refAuthor">Gundavelli, S.</span>, <span class="refAuthor">Townsley, M.</span>, <span class="refAuthor">Troan, O.</span>, and <span class="refAuthor">W. Dec</span>, <span class="refTitle">"Address Mapping of IPv6 Multicast Packets on Ethernet"</span>, <span class="seriesInfo">RFC 6085</span>, <span class="seriesInfo">DOI 10.17487/RFC6085</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6085">https://www.rfc-editor.org/info/rfc6085</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7400">[RFC7400]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"6LoWPAN-GHC: Generic Header Compression for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 7400</span>, <span class="seriesInfo">DOI 10.17487/RFC7400</span>, <time datetime="2014-11" class="refDate">November 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7400">https://www.rfc-editor.org/info/rfc7400</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7432">[RFC7432]</dt>
      <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Aggarwal, R.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Isaac, A.</span>, <span class="refAuthor">Uttaro, J.</span>, <span class="refAuthor">Drake, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"BGP MPLS-Based Ethernet VPN"</span>, <span class="seriesInfo">RFC 7432</span>, <span class="seriesInfo">DOI 10.17487/RFC7432</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7432">https://www.rfc-editor.org/info/rfc7432</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8505">[RFC8505]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Chakrabarti, S.</span>, and <span class="refAuthor">C. Perkins</span>, <span class="refTitle">"Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"</span>, <span class="seriesInfo">RFC 8505</span>, <span class="seriesInfo">DOI 10.17487/RFC8505</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8505">https://www.rfc-editor.org/info/rfc8505</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8365">[RFC8365]</dt>
      <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Drake, J., Ed.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Shekhar, R.</span>, <span class="refAuthor">Uttaro, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"A Network Virtualization Overlay Solution Using Ethernet VPN (EVPN)"</span>, <span class="seriesInfo">RFC 8365</span>, <span class="seriesInfo">DOI 10.17487/RFC8365</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8365">https://www.rfc-editor.org/info/rfc8365</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8928">[RFC8928]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Sarikaya, B.</span>, <span class="refAuthor">Sethi, M.</span>, and <span class="refAuthor">R. Struik</span>, <span class="refTitle">"Address-Protected Neighbor Discovery for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 8928</span>, <span class="seriesInfo">DOI 10.17487/RFC8928</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8928">https://www.rfc-editor.org/info/rfc8928</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9047">[RFC9047]</dt>
      <dd>
<span class="refAuthor">Rabadan, J., Ed.</span>, <span class="refAuthor">Sathappan, S.</span>, <span class="refAuthor">Nagaraj, K.</span>, and <span class="refAuthor">W. Lin</span>, <span class="refTitle">"Propagation of ARP/ND Flags in an Ethernet Virtual Private Network (EVPN)"</span>, <span class="seriesInfo">RFC 9047</span>, <span class="seriesInfo">DOI 10.17487/RFC9047</span>, <time datetime="2021-06" class="refDate">June 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9047">https://www.rfc-editor.org/info/rfc9047</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.thubert-6lo-unicast-lookup">[UNICAST-LOOKUP]</dt>
      <dd>
<span class="refAuthor">Thubert, P.</span> and <span class="refAuthor">E. Levy-Abegnoli</span>, <span class="refTitle">"IPv6 Neighbor Discovery Unicast Lookup"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-thubert-6lo-unicast-lookup-02</span>, <time datetime="2021-11-08" class="refDate">8 November 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-thubert-6lo-unicast-lookup-02">https://datatracker.ietf.org/doc/html/draft-thubert-6lo-unicast-lookup-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.thubert-6lo-multicast-registration">[I-D.thubert-6lo-multicast-registration]</dt>
    <dd>
<span class="refAuthor">Thubert, P.</span>, <span class="refTitle">"IPv6 Neighbor Discovery Multicast Address Registration"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-thubert-6lo-multicast-registration-02</span>, <time datetime="2021-10-08" class="refDate">8 October 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-thubert-6lo-multicast-registration-02">https://datatracker.ietf.org/doc/html/draft-thubert-6lo-multicast-registration-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12">
      <h2 id="name-informative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="RFC6550">[RFC6550]</dt>
      <dd>
<span class="refAuthor">Winter, T., Ed.</span>, <span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Brandt, A.</span>, <span class="refAuthor">Hui, J.</span>, <span class="refAuthor">Kelsey, R.</span>, <span class="refAuthor">Levis, P.</span>, <span class="refAuthor">Pister, K.</span>, <span class="refAuthor">Struik, R.</span>, <span class="refAuthor">Vasseur, JP.</span>, and <span class="refAuthor">R. Alexander</span>, <span class="refTitle">"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 6550</span>, <span class="seriesInfo">DOI 10.17487/RFC6550</span>, <time datetime="2012-03" class="refDate">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6550">https://www.rfc-editor.org/info/rfc6550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8929">[RFC8929]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Perkins, C.E.</span>, and <span class="refAuthor">E. Levy-Abegnoli</span>, <span class="refTitle">"IPv6 Backbone Router"</span>, <span class="seriesInfo">RFC 8929</span>, <span class="seriesInfo">DOI 10.17487/RFC8929</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8929">https://www.rfc-editor.org/info/rfc8929</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9010">[RFC9010]</dt>
      <dd>
<span class="refAuthor">Thubert, P., Ed.</span> and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"Routing for RPL (Routing Protocol for Low-Power and Lossy Networks) Leaves"</span>, <span class="seriesInfo">RFC 9010</span>, <span class="seriesInfo">DOI 10.17487/RFC9010</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9010">https://www.rfc-editor.org/info/rfc9010</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rift-rift">[RIFT]</dt>
      <dd>
<span class="refAuthor">Sharma, A.</span>, <span class="refAuthor">Thubert, P.</span>, <span class="refAuthor">Rijsman, B.</span>, <span class="refAuthor">Afanasiev, D.</span>, and <span class="refAuthor">A. Przygienda</span>, <span class="refTitle">"RIFT: Routing in Fat Trees"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rift-rift-15</span>, <time datetime="2022-01-03" class="refDate">3 January 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rift-rift-15">https://datatracker.ietf.org/doc/html/draft-ietf-rift-rift-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-EARO-STATUS">[IANA-EARO-STATUS]</dt>
    <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Address Registration Option Status Values"</span>, <span>&lt;<a href="https://www.iana.org/assignments/icmpv6-parameters/icmpv6-parameters.xhtml#address-registration">https://www.iana.org/assignments/icmpv6-parameters/icmpv6-parameters.xhtml#address-registration</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pascal Thubert (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc</span></div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+33%20497%2023%2026%2034" class="tel">+33 497 23 26 34</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:pthubert@cisco.com" class="email">pthubert@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tony Przygienda</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc</span></div>
<div dir="auto" class="left"><span class="country-name">Switzerland</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:prz@juniper.net" class="email">prz@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jeff Tantsura</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jefftant.ietf@gmail.com" class="email">jefftant.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
