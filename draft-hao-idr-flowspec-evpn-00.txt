IDR                                                          Weiguo Hao
                                                         Qiandeng Liang
                                                         Shunwan Zhuang
Internet Draft                                                   Huawei
Intended status: Standards Track                        August 20, 2014
Expires: February 2015



             Dissemination of Flow Specification Rules for EVPN
                    draft-hao-idr-flowspec-evpn-00.txt

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79. This document may not be modified,
   and derivative works of it may not be created, and it may not be
   published except as an Internet-Draft.

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79. This document may not be modified,
   and derivative works of it may not be created, except to publish it
   as an RFC and to translate it into languages other than English.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six
   months and may be updated, replaced, or obsoleted by other documents
   at any time.  It is inappropriate to use Internet-Drafts as
   reference material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   This Internet-Draft will expire on February 20,2014.

Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors. All rights reserved.




Hao & Liu,et,al       Expires February 20, 2015               [Page 1]

Internet-Draft             EVPN Flow Spec                  August 2014


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with
   respect to this document. Code Components extracted from this
   document must include Simplified BSD License text as described in
   Section 4.e of the Trust Legal Provisions and are provided without
   warranty as described in the Simplified BSD License.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with
   respect to this document.

Abstract

   This document defines BGP flow-spec extension for Ethernet traffic
   filtering in EVPN network. A new BGP NLRI type (AFI=25, SAFI=TBD)
   value is proposed to identify EVPN flow-spec application. A new
   subset of component types and extended community also are defined.

Table of Contents


   1. Introduction ................................................ 2
   2. Ethernet Flow Specification encoding in BGP.................. 3
   3. Ethernet Flow Specification Traffic Actions.................. 5
   4. Security Considerations...................................... 5
   5. IANA Considerations ......................................... 5
      5.1. Normative References.................................... 6
      5.2. Informative References.................................. 6
   6. Acknowledgments ............................................. 6

1. Introduction

   BGP Flow-spec is an extension to BGP that allows for the
   dissemination of traffic flow specification rules.  It leverages the
   BGP Control Plane to simplify the distribution of ACLs, new filter
   rules can be injected to all BGP peers simultaneously without
   changing router configuration. The typical application of BGP Flow-
   spec is to automate the distribution of traffic filter lists to
   routers for DDOS mitigation.




Hao & Liu,et,al       Expires February 20, 2015               [Page 2]

Internet-Draft             EVPN Flow Spec                  August 2014


   RFC5575 defines a new BGP Network Layer Reachability Information
   (NLRI) format used to distribute traffic flow specification rules.
   NLRI (AFI=1, SAFI=133)is for IPv4 unicast filtering. NLRI (AFI=1,
   SAFI=134)is for BGP/MPLS VPN filtering. The Flow specification match
   part only includes L3/L4 information like source/destination prefix,
   protocol, ports, and etc, so traffic flows can only be selectively
   filtered based on L3/L4 information.

   BGP MPLS based Ethernet VPNs(EVPN)[EVPN] is being deployed in an
   increasing number of WAN networks. In [EVPN-OVERLAY], EVPN also can
   be deployed within a data center using layer 2 overlays like VXLAN,
   NVGRE, and etc. In EVPN network, we also have requirement to deploy
   BGP Flow-spec to mitigate DDoS attack traffic. Within EVPN network,
   both IP and non-IP Ethernet traffic maybe exist. For IP traffic
   filtering, the Flow specification rules defined in [RFC5575] which
   include match criteria and actions can still be used, flow
   specification rules received via new NLRI format apply only to
   traffic that belongs to the MAC VRF(s) in which it is imported. For
   non-IP Ethernet traffic filtering, Layer 2 related information like
   source/destination MAC and VLAN should be considered. But the flow
   specification match criteria defined in RFC5575 only include layer 3
   and layer 4 IP information, layer 2 Ethernet information haven't
   been included.

   This document proposes a new BGP NLRI type (AFI=25, SAFI=TBD) value,
   which can be used to propagate traffic filtering information in an
   EVPN environment. The new specific (AFI, SAFI) pair is to identify
   EVPN flow-spec application. A new subset of component types and
   extended community also are defined.

2. Ethernet Flow Specification encoding in BGP

   A new BGP NLRI type (AFI=25, SAFI=TBD) value is proposed to identify
   EVPN flow-spec application.

   Flow specification rules received via this NLRI apply only to
   traffic that belongs to the MAC VRF(s) in which it is imported. Flow
   rules are accepted by default, when received from remote PE routers.

   Besides the component types defined in [RFC5575], this document
   proposes the following additional component types for EVPN Ethernet
   traffic filtering:

   Type 13 - Source MAC

   Encoding: <type (1 octet), [op, value]+>



Hao & Liu,et,al       Expires February 20, 2015               [Page 3]

Internet-Draft             EVPN Flow Spec                  August 2014


   Defines a list of {operation, value} pairs used to match source MAC.
   Values are encoded as 1-byte to 6-byte quantities.

   Type 14 - Destination MAC

   Encoding: <type (1 octet), [op, value]+>

   Defines a list of {operation, value} pairs used to match destination
   MAC. Values are encoded as 1-byte to 6-byte quantities.

   Type 15 - Ethernet Type

   Encoding: <type (1 octet), [op, value]+>

   Defines a list of {operation, value} pairs used to match two-octet
   field. Values are encoded as 1- or 2-byte quantities.

   Type 16 - VLAN ID

   Encoding: <type (1 octet), [op, value]+>

   Defines a list of {operation, value} pairs used to match VLAN ID.
   Values are encoded as 1- or 2-byte quantities.

   Type 17 - VLAN COS

   Encoding: <type (1 octet), [op, value]+>

   Defines a list of {operation, value} pairs used to match 3-bit VLAN
   COS fields [802.1p]. Values are encoded using a single byte, where
   the five most significant bits are zero and the three least
   significant bits contain the VLAN COS value.

   Type 18 - VN ID

   Encoding: <type (1 octet), [op, value]+>

   Defines a list of {operation, value} pairs used to match 24-bit VN
   ID fields. VN ID is tenant identification in NVO3 network. Values
   are encoded as 1- to 3-byte quantities.








Hao & Liu,et,al       Expires February 20, 2015               [Page 4]

Internet-Draft             EVPN Flow Spec                  August 2014


3. Ethernet Flow Specification Traffic Actions

   +--------+--------------------+--------------------------+
   |  type  | extended community |        encoding          |
   +--------+--------------------+--------------------------+
   | 0x8006 | traffic-rate       | 2-byte as#, 4-byte float |
   | 0x8007 | traffic-action     | bitmask                  |
   | 0x8008 | redirect           | 6-byte Route Target      |
   | 0x8009 | traffic-marking    | DSCP value               |
   +--------+--------------------+--------------------------+
   Besides to support the above extended communities per RFC5575, this
   document also proposes the following BGP extended communities
   specifications for Ethernet flow to extend [RFC5575]:

   +--------+--------------------+--------------------------+
   | type   | extended community | encoding                 |
   +--------+--------------------+--------------------------+
   | 0x800A | VLAN COS marking   | COS value                |
   +--------+--------------------+--------------------------+
   The VLAN COS marking extended community instructs a system to modify
   the COS bits of a transiting Ethernet packet to the corresponding
   value. This extended community is encoded as a sequence of 5 zero
   bytes followed by the VLAN COS value encoded in the 3 least
   significant bits of 6th byte.


4. Security Considerations

   No new security issues are introduced to the BGP protocol by this
   specification.

5. IANA Considerations

   IANA is requested to allocate a new SAFI to identify EVPN flow-spec
   application.

   IANA is requested to create and maintain a new registry entitled:
   "Flow spec MPLS Component Types":

   Type 13 - Source MAC

   Type 14 - Destination MAC

   Type 15 - Ethernet Type

   Type 16 - VLAN ID



Hao & Liu,et,al       Expires February 20, 2015               [Page 5]

Internet-Draft             EVPN Flow Spec                  August 2014


   Type 17 - VLAN COS

   Type 18 - VN ID

   IANA is requested to update the reference for the following
   assignment in the "BGP Extended Communities Type - extended,
   transitive" registry:

   Type value Name Reference

   ---------- ---------------------------------------- ---------

   0x080A Flow spec VLAN COS marking [this document]

5.1. Normative References

   [1]  [RFC2119] Bradner, S., "Key words for use in RFCs to Indicate

         Requirement Levels", BCP 14, RFC 2119, March 1997.

5.2. Informative References

   [1]  [RFC5575] P. Marques, N. Sheth, R. Raszuk, B. Greene, J.Mauch,
         D. McPherson, "Dissemination of Flow Specification Rules", RFC
         5575, August 2009.

   [2]  [EVPN] Sajassi et al., "BGP MPLS Based Ethernet VPN", draft-
         ietf-l2vpn-evpn-07.txt, work in progress, May, 2014.

   [3]  [EVPN-OVERLAY] A. Sajassi,etc, ''A Network Virtualization
         Overlay Solution using EVPN'', draft-sd-l2vpn-evpn-overlay-03,
         June, 2014

   [4]  [IEEE 802.1p] Javin, et.al. "IEEE 802.1p: LAN Layer 2 QoS/CoS
         Protocol for Traffic Prioritization", 2012-02-15

6. Acknowledgments

   The authors wish to acknowledge the important contributions of
   Xiaohu Xu, Lucy Yong.








Hao & Liu,et,al       Expires February 20, 2015               [Page 6]

Internet-Draft             EVPN Flow Spec                  August 2014


   Authors' Addresses

   Weiguo Hao
   Huawei Technologies
   101 Software Avenue,
   Nanjing 210012
   China
   Email: haoweiguo@huawei.com

   Qiandeng Liang
   Huawei Technologies
   101 Software Avenue,
   Nanjing 210012
   China
   Email: liuweihang@huawei.com


   Shunwan Zhuang
   Huawei Technologies
   Huawei Bld., No.156 Beiqing Rd.
   Beijing  100095
   China
   Email: zhuangshunwan@huawei.com

























Hao & Liu,et,al       Expires February 20, 2015               [Page 7]

