





Network Working Group                                      Sanjeev Singh
Internet-Draft                                          W. Mark Townsley
Category: Standards Track                                        Jed Lau
Expiration Date: October 2005                              cisco Systems

                                                              April 2005

                            ATM over L2TPv3

                   draft-ietf-l2tpext-pwe3-atm-03.txt


Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/1id-abstracts.html

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

Copyright Notice

   Copyright (C) The Internet Society (2005). All Rights Reserved.

Abstract


   The Layer 2 Tunneling Protocol, Version 3, (L2TPv3) defines an
   extensible tunneling protocol, how to transport layer 2 services over
   IP network. This document describes the specifics of how to use the
   L2TP control plane for Asynchronous Transfer Mode (ATM) Pseudo-Wires
   and guidelines for transporting various ATM services over an IP
   network.



Sanjeev, et al.             Standards Track                     [Page 1]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


   Contents

   Status of this Memo..........................................    1

   1. Introduction..............................................    3
      1.1 Abbreviations.........................................    3

   2. Control Connection Establishment..........................    4

   3. Session Establishment and ATM Circuit Status Notification.    4
      3.1 L2TPv3 Session Establishment..........................    4
      3.2 L2TPv3 Session Teardown...............................    6
      3.3 L2TPv3 Session Maintenance............................    6

   4. Encapsulation.............................................    7
      4.1 ATM-Specific Sublayer.................................    7
      4.2 Sequencing............................................    9

   5. ATM Transport.............................................    9
      5.1 ATM AAL5-SDU Mode.....................................   10
      5.2 ATM Cell Mode.........................................   10
         5.2.1 ATM VCC Cell-Relay Service.......................   11
         5.2.2 ATM VPC Cell-Relay Service.......................   12
         5.2.3 ATM Port Cell-Relay Service......................   12
      5.3 OAM Cell Support......................................   12
         5.3.1 VCC switching....................................   12
         5.3.1 VPC switching....................................   13

   6. ATM Maximum Concatenated Cells AVP........................   13

   7. OAM Emulation Required AVP................................   13

   8. ATM defects mapping and status notification...............   14
      8.1 ATM Alarm Status AVP..................................   14

   9. Security Considerations...................................   15

   10. IANA Considerations......................................   16
      10.1 L2-Specific Sublayer Type............................   16
      10.2  Control Message Attribute Value Pairs (AVPs)........   16
      10.3  Result Code AVP Values..............................   16
      10.4  ATM Alarm Status AVP Values.........................   17
      10.5  ATM-Specific Sublayer bits..........................   18

   11. Acknowledgments..........................................   18

   12. References...............................................   18
      12.1 Normative References.................................   18



Sanjeev, et al.             Standards Track                     [Page 2]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


      12.2 Informative References...............................   18

   13. Authors' Addresses.......................................   19

Specification of Requirements

   In this document, several words are used to signify the requirements
   of the specification.  These words are often capitalized.  The key
   words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
   "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document
   are to be interpreted as described in [RFC2119].


1. Introduction

   This document describes the specifics of how to use the L2TP for ATM
   pseudo-wires, including encapsulation, carrying various ATM services,
   such as, AAL5 SDU, ATM VCC/VPC/Port cell-relay over L2TP, and mapping
   ATM defects to L2TP SLI message to notify the peer LCCE.

   Any ATM specific AVPs or other L2TP constructs for ATM pseudo-wire
   (ATMPW) support will be defined here as well. Support for ATM
   Switched Virtual Path/Connection (SVP/SVC) and Soft Permanent Virtual
   Path/Connection (SPVP/SPVC) are outside the scope of this document.

   The reader is expected to be very familiar with the terminology and
   protocol constructs defined in [RFC3931].

1.1 Abbreviations

   AIS     Alarm Indication Signal
   ATMPW   ATM Pseudo-wire
   AVP     Attribute Value Pair
   CC      Continuity Check OAM Cell
   CE      Customer Edge
   HEC     Header Error Control
   LAC     L2TP Access Concentrator (See [RFC3931])
   LCCE    L2TP control connection endpoint (See [RFC3931])
   MSB     Most Significant Byte
   OAM     Operation, Administration, and Management
   PE      Provider Edge
   PSN     Packet Service Network
   PWE3    Pseudo-wire Edge-to-edge emulation
   RDI     Remote Defect Indicator
   SDU     Service Data Unit
   SLI     Set Link Info, an L2TP control message
   SVC     Switched Virtual Connection
   SVP     Switched Virtual Path



Sanjeev, et al.             Standards Track                     [Page 3]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


   SPVC    Soft Permanent Virtual Connection
   SPVP    Soft Permanent Virtual Path
   VC      Virtual Circuit
   VCC     Virtual Channel Connection
   VCI     Virtual Channel Identifier
   VPC     Virtual Path Connection
   VPI     Virtual Path Identifier

2. Control Connection Establishment

   To emulate, ATM pseudo-wires using L2TP, an L2TP Control Connection
   as described in Section 3.3 of [RFC3931] MUST be established.

   The SCCRQ and corresponding SCCRP MUST include the supported ATM PW
   types (See Section 3.1), in the Pseudo-Wire Capabilities List as
   defined in Section 5.4.3 of [RFC3931]. This identifies the control
   connection as able to establish L2TP sessions in support of the ATM
   Pseudo-Wires.

   An LCCE MUST be able to uniquely identify itself in the SCCRQ and
   SCCRP messages via a globally unique value. By default, this is
   advertised via the structured Router ID AVP [RFC3931], though the
   unstructured Hostname AVP [RFC3931] MAY be used to identify LCCEs via
   this value.

3. Session Establishment and ATM Circuit Status Notification

   This section describes how L2TP ATM PW or sessions are established
   between two LCCEs. This includes what will happen when an ATM Circuit
   (e.g. AAL5 PVC) is created, deleted or changes state when circuit is
   in alarm.

3.1 L2TPv3 Session Establishment

   ATM Circuit (e.g. an AAL5 PVC) creation triggers establishment of a
   L2TP session using three-way handshake described in Section 3.4.1 of
   [RFC3931]. An LCCE MAY initiate the session immediately upon ATM
   circuit creation, or wait until the Circuit state transitions to
   ACTIVE before attempting to establish a session for the ATM circuit.
   It MAY be preferred to wait until Circuit status transitions to
   ACTIVE in order to avoid wasting L2TP resources.

   The Circuit Status AVP (see Section 8) MUST be present in the ICRQ
   and ICRP messages, and MAY be present in the SLI message for ATM PWs.

   The following figure shows how L2TP messages are exchanged to setup
   an ATM PWs after ATM Circuit (e.g. an AAL5 PVC) becomes ACTIVE.




Sanjeev, et al.             Standards Track                     [Page 4]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


          LCCE (LAC) A                                  LCCE (LAC) B
      ------------------                            --------------------

       ATM Ckt Provisioned
                                                    ATM Ckt Provisioned
       ATM Ckt ACTIVE
                       ICRQ (status = 0x03) ---->
                                                    ATM Ckt ACTIVE
                       <----- ICRP (status = 0x03)
       L2TP session established
       OK to send data into PW

                       ICCN ----->
                                               L2TP session established
                                               OK to send data into PW

   The following signaling elements are required for the ATM PW
   establishment.

   a. Pseudo-Wire Type: One of the supported ATM related PW Types as
   defined in section 2 of [IANA] should be present in PW Type AVP of
   [RFC3931].

      0x0002  ATM AAL5 SDU VCC transport
      0x0003  ATM Cell transport Port Mode
      0x0009  ATM Cell transport VCC Mode
      0x000A  ATM Cell transport VPC Mode

   The above Cell-Relay mode can also signal the ATM Cell Concatenation
   AVP as described in Section 6. Other ATM PW types are outside the
   scope of this document.

   b. PW Remote End ID: Each PW is associated with a PW Remote End ID
      akin to the VC-ID in [PWE3ATM]. Two LCCEs of a PW would have the
      same PW Remote End ID and its format is described in Section 5.4.4
      of [RFC3931].

      This Remote End ID AVP MUST be present in the ICRQ in order for
      the remote LCCE to associate the session to the ATM Circuit. The
      Remote End Identifier AVP defined in [RFC3931] is of opaque form,
      though ATMPW implementations MAY simply use a four-octet value
      that is known to both LCCEs (either by direct configuration, or
      some other means). The exact method of how this value is
      configured, retrieved, discovered, or otherwise determined at
      each LCCE is outside the scope of this document.

   As with the ICRQ, the ICRP is sent only after the ATM Circuit
   transitions to ACTIVE. If LCCE B had not been provisioned yet for the



Sanjeev, et al.             Standards Track                     [Page 5]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


   ATM Circuit identified in the ICRQ, a CDN would have been immediately
   returned indicating that the circuit was either not provisioned or is
   not available at this LCCE. LCCE A should then exhibit a periodic
   retry mechanism. The period and maximum number of retries MUST be
   configurable.

   An Implementation MAY send an ICRQ or ICRP before a PVC is ACTIVE, as
   long as the Circuit Status AVP reflects that the ATM Circuit is
   INACTIVE and an SLI is sent when the ATM Circuit becomes ACTIVE (see
   Section 8).

   The ICCN is the final stage in the session establishment. It confirms
   the receipt of the ICRP with acceptable parameters to allow
   bidirectional traffic.

3.2 L2TPv3 Session Teardown

   When an ATM Circuit is unprovisioned (deleted) at either LCCE, the
   associated L2TP session MUST be torn down via the CDN message defined
   in Section 3.4.3 of [RFC3931].

3.3 L2TPv3 Session Maintenance

   All sessions established by a given control connection utilize the
   L2TP Hello facility defined in Section 4.4 of [RFC3931] for session
   keepalive. This gives all sessions basic dead peer and path detection
   between LCCEs.

   If the control channel utilizing the Hello message is not in-band
   with data traffic over PSN, then other method MAY be used to detect
   the Session failure and it is left for further study.

   ATMPW over L2TP uses the Set Link Info (SLI) control message as
   defined in [RFC3931] to signal ATM Circuit Status between LCCEs after
   initial session establishment. This includes ACTIVE or INACTIVE
   notifications of the ATM Circuit, or any other parameters that may
   need to be shared between the LCCEs in order to provide proper PW
   emulation.

   The SLI message MUST be sent whenever there is a status change which
   may be reported by any values identified in the Circuit Status AVP.
   The only exception to this are the initial ICRQ, ICRP and CDN
   messages which establish and teardown the L2TP session itself when
   ATM circuit is created or deleted. The SLI message may be sent from
   either LCCE at any time after the first ICRQ is sent (and perhaps
   before an ICRP is received, requiring the peer to perform a reverse
   Session ID lookup).




Sanjeev, et al.             Standards Track                     [Page 6]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


   The other application of the SLI message is to map the ATM OAM or
   physical layer alarms into Circuit Status AVP as described in Section
   8.

4. Encapsulation

   This section describes the general encapsulation format for ATM
   services over L2TP.

   Figure 1: General format for ATM encapsulation over L2TPv3 over IP

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     PSN Transport Header                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Session Header                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    ATM-Specific Sublayer                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                      ATM Service Payload                      |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The PSN Transport header is specific to IP and its underlying
   transport header. This header is used to transport the encapsulated
   ATM payload through the IP network.

   The Session Header is a non-zero 32-bit session ID with optional
   cookies upto 64-bits. This Session ID is exchanged during session
   setup.

   The ATM Specific Sublayer is REQUIRED for AAL5 SDU mode and OPTIONAL
   for ATM Cell mode. Please refer to Section 4.1 for more details.

4.1 ATM-Specific Sublayer

   This section defines a new ATM-specific sublayer as, an alternative
   to default L2-Specific Sublayer as mentioned in Section 4.6 of
   [RFC3931].  Four new flag bits (T,G,C,U) are defined which concur
   with Section 8.2 of [PWE3ATM].

   Figure 2: ATM-Specific Sublayer Format







Sanjeev, et al.             Standards Track                     [Page 7]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |x|S|B|E|T|G|C|U|          Sequence Number                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Definition of these four bits are as per Section 8.2 of [PWE3ATM] and
   also included here for reference.

      * S bit

      Definition of this bit is as per Section 4.6 of [RFC3931].

      * B and E bits

      Definition of these bits as per Section 5.5 of [L2TPFRAG]

      These bits are reserved and MUST be set to 0 upon transmission
      and ignored upon reception, unless otherwise, these bits are
      used as per [L2TPFRAG].

      * T (Transport type) bit

      Bit (T) of the control word indicates whether the packet
      contains an ATM admin cell or an AAL5 payload. If T = 1, the
      packet contains an ATM admin cell, encapsulated according to
      the VCC cell relay encapsulation of Section 5.2.
      If not set, the PDU contains an AAL5 payload. The ability to
      transport an ATM cell in the AAL5 SDU mode is intended to
      provide a means of enabling administrative functionality over
      the AAL5 VCC (though it does not endeavor to preserve user-cell
      and admin-cell arrival/transport ordering).

      * G (EFCI) Bit

      The ingress LCCE device SHOULD set this bit to 1 if the EFCI bit
      of the final cell of the incoming AAL5 payload is set to 1, or
      if the EFCI bit of the single ATM cell to be transported in
      the packet is set to 1.  Otherwise this bit SHOULD be set to
      0.  The egress LCCE device SHOULD set the EFCI bit of all the
      outgoing cells that transport the AAL5 payload to the value
      contained in this field.

      * C (CLP) Bit

      The ingress LCCE device SHOULD set this bit to 1 if the CLP bit
      of any of the incoming ATM cells of the AAL5 payload are set
      to 1, or if the CLP bit of the single ATM cell that is to be



Sanjeev, et al.             Standards Track                     [Page 8]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


      transported in the packet is set to 1.  Otherwise this bit
      SHOULD be set to 0. The egress LCCE device SHOULD set the CLP
      bit of all outgoing cells that transport the AAL5 CPCS-PDU to
      the value contained in this field.


      * U (Command/Response) Bit

      When FRF.8.1 Frame Relay / ATM PVC Service Interworking (see
      [FRF8.1]) traffic is being transported, the CPCS-UU Least
      Significant Bit (LSB) of the AAL5 CPCS-PDU may contain the
      Frame Relay C/R bit.
      The ingress LCCE device SHOULD copy this bit to the U bit of
      the control word. The egress LCCE device SHOULD copy the
      U bit to the CPCS-UU Least Significant Bit (LSB) of the AAL5
      payload.

      The Sequence Number fields are described in Section 4.3

      In case of a reassembly timeout, the encapsulating LCCE should
      discard all component cells of the AAL5 frame.

      An additional enumeration is added to the L2-Specific Sublayer AVP
      to identify the ATM-Specific Sublayer:

         0     -   There is no L2-Specific Sublayer present.
         1     -   The default L2-Specific Sublayer (defined in
                   Section 4.6) is used.
         TBA-1 -   The ATM-Specific Sublayer is used.

   The first two values are already defined in the L2TPv3 base draft
   [RFC3931].

4.2 Sequencing

   Data Packet Sequencing MAY be enabled for ATMPWs. The sequencing
   mechanisms described in [RFC3931] MUST be used to signal sequencing
   support. ATMPW over L2TPv3 MUST request the presence of the ATM-
   Specific Sublayer when sequencing is enabled, and MAY request its
   presence at all times.

5. ATM Transport

   There are two encapsulations supported for ATM transport as described
   below.

   ATM Specific Sublayer is prepended to AAL5-SDU. The other Cell-mode
   encapsulation consists of the OPTIONAL ATM-Specific Sublayer and 4-



Sanjeev, et al.             Standards Track                     [Page 9]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


   byte ATM Cell Header and 48-byte ATM Cell-payload.

5.1 ATM AAL5-SDU Mode

   In this mode each AAL5 VC is mapped to an L2TP session. Ingress LCCE
   reassembles AAL5 CPCS-SDU without AAL5 trailer and any padding bytes.
   Incoming EFCI, CLP and C/R (if present) are carried in ATM Specific
   sublayer across ATMPW to egress LCCE. The processing of these bits on
   ingress and egress are LCCE defined in Section 4.1.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |x|S|x|x|T|G|C|U|             Sequence Number                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                                                               |
   |                         AAL5 CPCS-SDU                         |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   If ingress LCCE determines that an encapsulated AAL5 SDU exceeds the
   MTU size of the L2TPv3 session, then AAL5 SDU may be fragmented as
   per [L2TPFRAG] or underneath Transport layer (IP, etc).  F5 OAM cells
   that arrive during the reassembly of an AAL5 SDU are sent immediately
   on the PW followed by the AAL5 SDU payload. In this case OAM cell's
   relative order with respect to user data cells is not maintained.

   Performance Monitoring OAM, as specified in ITU-T 610 [I610-1],
   [I610-2], [I610-3] and security OAM cells as specified in [ATMSEC],
   should not be used in combination with AAL5 SDU mode. These cells MAY
   be dropped at ingress LCCE because cell sequence integrity is not
   maintained.

   The Pseudowire Type AVP defined in Section 5.4.4 of [RFC3931],
   Attribute Type 68, MUST be present in the ICRQ messages and MUST
   include the ATM AAL5 SDU VCC transport PW Type of 0x0002.

5.2 ATM Cell Mode

   In this mode, ATM cells skip the reassembly process at ingress LCCE.
   These cells are transported over an L2TP session, either as a single
   Cell or as concatenated cells, into a single packet. Each ATM Cell
   consists of 4 byte ATM cell header and 48-byte ATM Cell-payload, HEC
   is not included.

   In ATM Cell Mode encapsulation, ATM-Specific Sublayer is OPTIONAL.
   It can be included, if sequencing support is required. It is left to



Sanjeev, et al.             Standards Track                    [Page 10]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


   the implementation to choose to signal Default L2-Specific Sublayer
   or ATM-Specific Sublayer.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |x|S|x|x|x|x|x|x|          Sequence Number (Optional)           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        VPI            |           VCI                 |PTI  |C|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                    ATM Cell Payload (48-bytes)                |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                               "
                               "
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        VPI            |           VCI                 |PTI  |C|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                    ATM Cell Payload (48-bytes)                |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   In the simplest case, this encapsulation can be used to transmit
   a single ATM cell per Pseudo Wire PDU. However, in order to
   provide better Pseudo Wire bandwidth efficiency, several ATM cells
   may be optionally encapsulated into single Pseudo Wire PDU.

   The maximum number of concatenated cells in a packet is limited by
   the MTU size of the session and also by the ability of egress
   LCCE to process them.  For more details about ATM Maximum
   Concatenated cells, please refer to Section 6.

5.2.1 ATM VCC Cell-Relay Service

   A VCC cell relay service may be provided by mapping an ATM Virtual
   Channel Connection to a single Pseudo-Wire using cell mode
   encapsulation as defined in section 5.2.

   An LCCE may map one or more VCCs to a single PW. However, a service
   provider may wish to provision a single VCC to a PW in order to
   satify QOS or restoration requirement.

   The Pseudowire Type AVP defined in Section 5.4.4 of [RFC3931],
   Attribute Type 68, MUST be present in the ICRQ messages and MUST
   include the ATM Cell transport VCC mode PW Type of 0x0009.




Sanjeev, et al.             Standards Track                    [Page 11]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


5.2.2 ATM VPC Cell-Relay Service

   A Virtual Path Connection cell relay service may be provided by
   mapping an ATM Virtual Path Connection to single Pseudo Wire using
   cell mode encapsulation as defined in section 5.2.

   An LCCE may map one or more VPCs to a single Pseudo Wire.

   The Pseudowire Type AVP defined in Section 5.4.4 of [RFC3931],
   Attribute Type 68, MUST be present in the ICRQ messages and MUST
   include the ATM Cell transport VPC mode PW Type of 0x000A.

5.2.3 ATM Port Cell-Relay Service

   ATM port cell relay service allows an ATM port to be connected to
   only another ATM port. All ATM cells that are received at the
   ingress ATM port on the LCCE, are encapsulated as per section 5.2,
   into Pseudo wire PDU and sent to peer LCCE.

   Each LCCE MUST discard any idle/unassigned cells received on an ATM
   port associated with ATM PW.

   The Pseudowire Type AVP defined in Section 5.4.4 of [RFC3931],
   Attribute Type 68, MUST be present in the ICRQ messages and MUST
   include the ATM Cell transport Port mode PW Type of 0x0003.

5.3 OAM Cell Support

   The OAM cells are defined in [I610-1], [I610-2], [I610-3] and
   [ATMSEC] can be categoried as:

      a. Fault Management
      b. Performance monitoring and reporting
      c. Activation/deactivation
      d. System Management (e.g. security OAM cells).

   OAM Cells are always encapsulated using cell mode encapsulation,
   regardless of the encapsulation format used for user data.

5.3.1 VCC switching

   The LCCEs SHOULD be able to pass the F5 segment and end-to-end Fault
   Management, Resource Management (RM cells), Performance Management,
   Activation/deactivation and System Management OAM cells.

   F4 OAM cells are inserted or extracted at the VP link termination.
   These OAM cells are not seen at the VC link termination and are
   therefore not sent across the PW.



Sanjeev, et al.             Standards Track                    [Page 12]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


5.3.1 VPC switching

   The LCCEs MUST be able to pass the F4 segment and end-to-end Fault
   Management, Resource Management (RM cells), Performance Management,
   Activation/deactivation and System Management OAM cells transparently
   according to [I610-1].

   F5 OAM cells are not inserted or extracted at the VP cross-connect.
   The LCCEs MUST be able to pass the F5 OAM cells transparently across
   the PW.

6. ATM Maximum Concatenated Cells AVP

   The "ATM Maximum Cells Concatenated AVP", Attribute type AVP-TBA-1,
   indicates that the egress LCCE node can process a single PDU with
   concatenated cells upto a specified number of cells. An LCCE
   node transmitting concatenated cells on this PW MUST not exceed
   the maximum number of cells as specified in this AVP. This AVP
   is applicable only to ATM Cell-Relay PW types (VCC, VPC, Port
   Cell-Relay). This Attribute value may not be same in both
   directions of the specific PW.

   The Attribute Value field for this AVP has the following format:

    0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | ATM Maximum Concatenated Cells|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   This AVP MAY be hidden (the H bit MAY be 0 or 1). The M bit for this
   AVP MAY be set to 0, but MAY vary (see Section 5.2 of [RFC3931]).
   The length (before hiding) of this AVP is 8.

   This AVP is sent in an ICRQ, ICRP during session negotiation or via
   SLI control messages when LCCE changes the maximum number of
   Concatenated Cells configuration for a given ATM cell-relay Circuit.

   This AVP is OPTIONAL. If egress LCCE is configured with maximum
   number of cells to be concatenated by ingress LCEE, it should signal
   to ingress LCCE.

7. OAM Emulation Required AVP

   An "OAM Emulation Required AVP" Attribute type, AVP-TBA-2 MAY be
   needed to signal OAM Emulation in AAL5 SDU mode, if LCCE can not
   support transport of OAM cells across L2TP session. If OAM Cell
   Emulation is configured or detected via some other means on one side,



Sanjeev, et al.             Standards Track                    [Page 13]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


   the other LCCE MUST support OAM Cell Emulation as well.

   This AVP is exchanged during session negotiation (in ICRQ, ICRP) or
   during life of the session via SLI control message. If the other LCCE
   can not support the OAM Cell Emulation, the associated L2TP session
   MUST be torn down via CDN message with result code, RC-TBA-1.

   OAM Emulation AVP is a boolean AVP, having no Attribute Value. Its
   absence is FALSE and its presence is TRUE. This AVP MAY be hidden
   (the H bit MAY be 0 or 1). The M bit for this AVP SHOULD be set to 0,
   but MAY vary (see Section 5.2 of [RFC3931]). The Length (before
   hiding) of this AVP is 6.

8. ATM defects mapping and status notification

   ATM OAM alarms or circuit status is indicated via Circuit Status AVP
   as defined in  Section 5.4.5 of [RFC3931]. For reference, usage of
   this AVP is shown below.

    0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           Reserved        |N|A|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The Value is a 16 bit mask with the two least significant bits
   defined and the remaining bits are reserved for future use. Reserved
   bits MUST be set to 0 when sending, and ignored upon receipt.

   The A (Active) bit indicates whether the ATM Circuit is ACTIVE (1) or
   INACTIVE (0).

   The N (New) bit indicates whether the ATM circuit status indication
   is for a new Circuit (1) or an existing ATM Circuit (0).

8.1 ATM Alarm Status AVP

   An "ATM Alarm Status AVP" attribute type, AVP-TBA-3 indicates the
   reason for the ATM circuit status and specific alarm type, if any, to
   its peer LCCE node. This OPTIONAL AVP MAY be present in SLI message
   with Circuit Status AVP.

   The Attribute Value field for this AVP has the following format:








Sanjeev, et al.             Standards Track                    [Page 14]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Circuit Status Reason     |            Alarm              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The Circuit status reason is a 2-octets unsigned integer and Alarm
   Type is also a 2-octets unsigned integer.

   This AVP MAY be hidden (the H bit MAY be 0 or 1). The m bit for this
   AVP SHOULD be set to 0, but MAY vary (see Section 5.2 of [RFC3931]).
   The Length (before hiding) of this AVP is 10 octets.

   This AVP is sent in SLI message to indicate the additional
   information about the ATM circuit status.

   Circuit Status Reason values for the SLI message are as follows:

      0        - Reserved
      CSR-TBA1 - No alarm or alarm cleared (default for Active Status)
      CSR-TBA2 - Unspecified or unknown Alarm Received (default for
                 Inactive Status)
      CSR-TBA3 - ATM Circuit received F1 Alarm on ingress LCCE
      CSR-TBA4 - ATM Circuit received F2 Alarm on ingress LCCE
      CSR-TBA5 - ATM Circuit received F3 Alarm on ingress LCCE
      CSR-TBA6 - ATM Circuit received F4 Alarm on ingress LCCE
      CSR-TBA7 - ATM Circuit received F5 Alarm on ingress LCCE
      CSR-TBA8 - ATM Circuit down due to ATM Port shutdown on Peer LCCE
      CSR-TBA9 - ATM Circuit down due to loop-back timeout on ingress
                 LCCE

   The general ATM Alarm failures are encoded as below:

      0      - Reserved
      A-TBA1 - No Alarm type specified (default)
      A-TBA2 - Alarm Indication Signal (AIS)
      A-TBA3 - Remote Defect Indicator (RDI)
      A-TBA4 - Loss of Signal (LOS)
      A-TBA5 - Loss of pointer (LOP)
      A-TBA6 - Loss of framer (LOF)
      A-TBA7 - loopback cells (LB)
      A-TBA8 - Continuity Check (CC)

9. Security Considerations

   For generic security issues regarding PWs and ATMPWs, this document
   will eventually refer to documents from the PWE3 WG.




Sanjeev, et al.             Standards Track                    [Page 15]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


10. IANA Considerations

   The signaling mechanisms defined in this document rely upon the
   allocation of following ATM Pseudowire Types (see Pseudo Wire
   Capabilities List as defined in 5.4.3 of [RFC3931] and L2TPv3
   Pseudowire Types in 10.6 of [RFC3931]) by the IANA (number space
   created as part of publication of [RFC3931]):

      Pseudowire Types
      ----------------

      0x0002  ATM AAL5 SDU VCC transport
      0x0003  ATM Cell transparent Port Mode
      0x0009  ATM Cell transport VCC Mode
      0x000A  ATM Cell transport VPC Mode

10.1 L2-Specific Sublayer Type

   This number space is created and maintained per [RFC3931].

      L2-Specific Sublayer Type
      -------------------------

      TBA-1 - ATM L2-Specific Sublayer present

10.2  Control Message Attribute Value Pairs (AVPs)

   This number space is managed by IANA as per [BCP0068].

   New AVPs requiring assignment in this document are encoded with
   "AVP-TBA-x," where "x" is 1, 2, 3...

   A summary of the three new AVPs follows:

   Control Message Attribute Value Pairs

      Attribute
      Type        Description
      ---------   ----------------------------------
      AVP-TBA-1   ATM Maximum Concatenated Cells AVP
      AVP-TBA-2   OAM Emulation Required AVP
      AVP-TBA-3   ATM Alarm Status AVP


10.3  Result Code AVP Values

   This number space is managed by IANA as per [BCP0068].




Sanjeev, et al.             Standards Track                    [Page 16]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


   New Result Code value for the CDN message is defined in section 7.
   Following is a summary:

   Result Code AVP (Attribute Type 1) Values
   -----------------------------------------

   General Error Codes

   RC-TBA-1 - Session not established due to other LCCE
              can not support the OAM Cell Emulation,

10.4  ATM Alarm Status AVP Values

   This is a new registry for IANA to maintain.

   New Attribute values for the SLI message is defined in section 8.
   Following is a summary:

   ATM Alarm Status AVP (Attribute Type AVP-TBA-3) Values
   ------------------------------------------------------

   Circuit Status Reason values for the SLI message are as follows:

      0        - Reserved
      CSR-TBA1 - No alarm or alarm cleared (default for Active Status)
      CSR-TBA2 - Unspecified or unknown Alarm Received (default for
                    Inactive Status)
      CSR-TBA3 - ATM Circuit received F1 Alarm on ingress LCCE
      CSR-TBA4 - ATM Circuit received F2 Alarm on ingress LCCE
      CSR-TBA5 - ATM Circuit received F3 Alarm on ingress LCCE
      CSR-TBA6 - ATM Circuit received F4 Alarm on ingress LCCE
      CSR-TBA7 - ATM Circuit received F5 Alarm on ingress LCCE
      CSR-TBA8 - ATM Circuit down due to ATM Port shutdown on Peer LCCE
      CSR-TBA9 - ATM Circuit down due to loop-back timeout on ingress
                    LCCE

   The general ATM Alarm failures are encoded as below:

      0      - Reserved
      A-TBA1 - No Alarm type specified (default)
      A-TBA2 - Alarm Indication Signal (AIS)
      A-TBA3 - Remote Defect Indicator (RDI)
      A-TBA4 - Loss of Signal (LOS)
      A-TBA5 - Loss of pointer (LOP)
      A-TBA6 - Loss of framer (LOF)
      A-TBA7 - loopback cells (LB)
      A-TBA8 - Continuity Check (CC)




Sanjeev, et al.             Standards Track                    [Page 17]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


10.5  ATM-Specific Sublayer bits

   This is a new registry for IANA to maintain.

   The ATM-Specific Sublayer contains 8 bits in the low-order portion of
   the header. Reserved bits may be assigned by IETF Consensus
   [RFC2434].

      Bit 0 - Reserved
      Bit 1 - S (Sequence) bit
      Bit 2 - B (Fragmentation) bit
      Bit 3 - E (Fragmentation) bit
      Bit 4 - T (Transport type) bit
      Bit 5 - G (EFCI) bit
      Bit 6 - C (CLP) bit
      Bit 7 - U (Command/Response) bit



11. Acknowledgments

   Thanks for the contribution from Pony Zhu, Prasad Yaditi, Durai, Jaya
   Kumar, and razor sharp review by Carlos Pignataro.

   Many Thanks to Srinivas Kotamraju for editorial review.

   Thanks to Shoou Yiu and Fred Shu for their valuable time to review
   this document.

12. References

12.1 Normative References

      [RFC3931]  J. Lau, M. Townsley, I. Goyret, "Layer Two Tunneling
                 Protocol - Version 3 (L2TPv3)", RFC 3931, March 2005.

      [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
                    Requirement Levels", BCP 14, RFC 2119, March 1997.

12.2 Informative References

      [PWE3ATM]  L. Martini., et al., "Encapsulation Methods for
                 Transport of ATM Cells/Frame Over IP and MPLS
                 Networks", work in progress,
                 draft-ietf-pwe3-atm-encap-08.txt

      [L2TPFRAG] A. Malis, W. M. Townsley, "PWE3 Fragmentation and
                 Reassembly", draft-ietf-pwe3-fragmentation-08.txt



Sanjeev, et al.             Standards Track                    [Page 18]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


      [FRF8.1]   "Frame Relay / ATM PVC Service Interworking
                 Implementation Agreement (FRF 8.1)", Frame Relay
                 Forum 2000.

      [BCP0068]  Townsley, W., "Layer Two Tunneling Protocol (L2TP)
                 Internet Assigned Numbers Authority (IANA)
                 Considerations Update" RFC3438, BCP0068, December 2002

      [RFC2434]  Narten, T. and H. Alvestrand, "Guidelines for Writing
                 an IANA Considerations section in RFCs", BCP 26,
                 RFC 2434, October 1998.

      [IANA]     L. Martini, W. M. Townsley, "IANA Allocations for
                 pseudo Wire Edge to Edge Emulation (PWE3)",
                 draft-ietf-pwe3-iana-allocation-07.txt

      [I610-1]   ITU-T Recommendation I.610 (1999): B-ISDN operation and
                 maintenance principles and functions

      [I610-2]   ITU-T Recommendation I.610, Corrigendum 1 (2000):
                 B-ISDN operation and maintenance principles and
                 functions (corrigendum 1)

      [I610-3]   ITU-T Recommendation I.610, Amendment 1 (2000): B-ISDN
                 operation and maintenance principles and functions
                 (Amendment 1)

      [ATMSEC]   ATM Forum Specification, af-sec-0100.002 (2001): ATM
                 Security Specification version 1.1


13. Authors' Addresses

   Sanjeev Singh
   cisco Systems
   170 W. Tasman Drive
   San Jose, CA  95134
   sanjeevs@cisco.com

   W. Mark Townsley
   cisco Systems
   7025 Kit Creek Road
   PO Box 14987
   Research Triangle Park, NC 27709
   mark@townsley.net

   Jed Lau
   cisco Systems



Sanjeev, et al.             Standards Track                    [Page 19]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


   170 W. Tasman Drive
   San Jose, CA  95134
   jedlau@cisco.com


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Disclaimer of Validity

   This document and the information contained herein are provided on
   an "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE
   REPRESENTS OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE
   INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Copyright Statement

   Copyright (C) The Internet Society (2005).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.





Sanjeev, et al.             Standards Track                    [Page 20]

INTERNET DRAFT              ATM over L2TPv3                   April 2005


Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.















































Sanjeev, et al.             Standards Track                    [Page 21]

