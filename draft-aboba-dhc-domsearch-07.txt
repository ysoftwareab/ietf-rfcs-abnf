





Network Working Group                                      Bernard Aboba
INTERNET-DRAFT                                                 Microsoft
Category: Standards Track                                Stuart Cheshire
<draft-aboba-dhc-domsearch-07.txt>                        Apple Computer
1 November 2001

                       DHCP Domain Search Option

This document is an Internet-Draft and is in full conformance with all
provisions of Section 10 of RFC 2026.

Internet-Drafts are working documents of the Internet Engineering Task
Force (IETF), its areas, and its working groups.  Note that other groups
may also distribute working documents as Internet- Drafts.

Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any
time.  It is inappropriate to use Internet-Drafts as reference material
or to cite them other than as "work in progress."

The list of current Internet-Drafts can be accessed at
http://www.ietf.org/ietf/1id-abstracts.txt

The list of Internet-Draft Shadow Directories can be accessed at
http://www.ietf.org/shadow.html.

The distribution of this memo is unlimited.

Copyright Notice

Copyright (C) The Internet Society (2001).  All Rights Reserved.

Abstract

The Dynamic Host Configuration Protocol (DHCP) provides a mechanism for
host configuration. RFC 2132 allows DHCP servers to specify
configuration information for various kinds of name services to be
passed to DHCP clients.  In some circumstances, it is useful for the
DHCP client to be configured with the domain search list.  This document
defines a new DHCP option which is passed from the DHCP Server to the
DHCP Client to specify the domain search list when resolving hostnames.










Aboba & Cheshire             Standards Track                    [Page 1]





INTERNET-DRAFT          DHCP Domain Search Option        1 November 2001


1.  Introduction

The Dynamic Host Configuration Protocol (DHCP) [2] provides a mechanism
for host configuration. RFC 2132 [3] and RFC 2937 [6] allow DHCP servers
to pass name service configuration information to DHCP clients.  In some
circumstances, it is useful for the DHCP client to be configured with
the domain search list.  This document defines a new DHCP option which
is passed from the DHCP Server to the DHCP Client to specify the domain
search list when resolving hostnames.

1.1.  Terminology

This document uses the following terms:

DHCP client
          A DHCP client or "client" is an Internet host using DHCP to
          obtain configuration parameters such as a network address.

DHCP server
          A DHCP server or "server" is an Internet host that returns
          configuration parameters to DHCP clients.

1.2.  Requirements language

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this
document are to be interpreted as described in "Key words for use in
RFCs to Indicate Requirement Levels" [1].

2.  Domain Search Option Format

The code for this option is TBD.

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     TBD       |     Len       |         Searchstring...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Searchstring...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

In the above diagram, Searchstring is a string specifying the
searchlist. If the length of the searchlist exceeds the maximum
permissible within a single option (256 octets), then multiple options
MAY be used, as described in "Encoding Long DHCP Options" [7].

To enable the searchlist to be encoded compactly, searchstrings in the
searchlist are concatenated and encoded using the technique described in



Aboba & Cheshire             Standards Track                    [Page 2]





INTERNET-DRAFT          DHCP Domain Search Option        1 November 2001


section 4.1.4 of "Domain Names - Implementation And Specification" [5].
In this scheme, an entire domain name or a  list of labels at the end of
a domain name is replaced with a pointer to a prior occurrence of the
same name.  Despite its complexity, this technique is valuable since the
space available for encoding DHCP options is limited, and it is likely
that a domain searchstring will contain repeated instances of the same
domain name.  Thus the DNS name compression is both useful and likely to
be effective.

For use in this specification, the pointer refers to the offset within
the data portion of the DHCP option (not including the preceding DHCP
option code byte or DHCP option length byte).

If multiple Domain Search Options are present, then the data portions of
all the Domain Search Options are concatenated together as specified in
"Encoding Long DHCP Options" [7] and the pointer indicates an offset
within the complete aggregate block of data.

3.  Example

Below is an example encoding of a search list consisting of
"eng.apple.com." and "marketing.apple.com.":

+---+---+---+---+---+---+---+---+---+---+---+
|TBD| 9 | 3 |'e'|'n'|'g'| 5 |'a'|'p'|'p'|'l'|
+---+---+---+---+---+---+---+---+---+---+---+

+---+---+---+---+---+---+---+---+---+---+---+
|TBD| 9 |'e'| 3 |'c'|'o'|'m'| 0 | 9 |'m'|'a'|
+---+---+---+---+---+---+---+---+---+---+---+

+---+---+---+---+---+---+---+---+---+---+---+
|TBD| 9 |'r'|'k'|'e'|'t'|'i'|'n'|'g'|xC0|x04|
+---+---+---+---+---+---+---+---+---+---+---+

Note:


i.   The encoding of has been split (for this example) into three Domain
     Search Options. All Domain Search Options are logically
     concatenated into one block of data before being interpreted by the
     client.

ii.  The encoding of "eng.apple.com." ends with a zero, the null root
     label, to mark the end of the name, as required by RFC 1035.

iii. The encoding of "marketing" (for "marketing.apple.com.")  ends with
     the two-octet compression pointer C004 (hex), which points to



Aboba & Cheshire             Standards Track                    [Page 3]





INTERNET-DRAFT          DHCP Domain Search Option        1 November 2001


     offset 4 in the complete aggregated block of Domain Search Option
     data, where another validly encoded domain name can be found to
     complete the name ("apple.com.").

Every search domain name must end either with a zero or with a two-octet
compression pointer. If the receiver is part-way through decoding a
search domain name when it reaches the end of the complete aggregated
block of searchlist option data, without finding a zero or a valid two-
octet compression pointer, then the partially read name must be
discarded as invalid.

4.  References

[1]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
     Levels", BCP 14, RFC 2119, March 1997.

[2]  Droms, R., "Dynamic Host Configuration Protocol", RFC 2131, March
     1997.

[3]  Alexander, S., Droms, R., "DHCP Options and BOOTP Vendor
     Extensions", RFC 2132, March 1997.

[4]  Droms, R., Arbaugh, W., "Authentication for DHCP Messages", RFC
     3118, June 2001.

[5]  Mockapetris, P., "DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION",
     RFC 1035, November 1987.

[6]  Smith, C., "The Name Service Search Option for DHCP", RFC 2937,
     September 2000.

[7]  Lemon, T., Cheshire, S., "Encoding Long DHCP Options", Internet
     draft (work in progress), draft-ietf-dhc-concat-02.txt, October
     2001.

5.  Security Considerations

Potential attacks on DHCP are discussed in section 7 of the DHCP
protocol specification [2], as well as in the DHCP authentication
specification [4]. In particular, using the domain search option, a
rogue DHCP server might be able to redirect traffic to another site.

To avert this attack, where DNS parameters such as the domain searchlist
have been manually configured, these parameters SHOULD NOT be overridden
by DHCP.






Aboba & Cheshire             Standards Track                    [Page 4]





INTERNET-DRAFT          DHCP Domain Search Option        1 November 2001


6.  IANA Considerations

This draft requires assignment of a DHCP option code. It does not create
any new number spaces for IANA administration.

Acknowledgments

The authors would like to thank Michael Patton, Erik Guttman, Olafur
Gudmundsson, Thomas Narten, Mark Andrews, Erik Nordmark, Myron Hattig,
Keith Moore and Bill Manning for comments on this draft.

Authors' Addresses

Bernard Aboba
Microsoft Corporation
One Microsoft Way
Redmond, WA 98052

Phone: +1 425 706 6605
EMail: bernarda@microsoft.com

Stuart Cheshire
Apple Computer, Inc.
1 Infinite Loop
Cupertino
California 95014
USA

Phone: +1 408 974 3207
EMail: rfc@stuartcheshire.org

Intellectual Property Statement

The IETF takes no position regarding the validity or scope of any
intellectual property or other rights that might be claimed to  pertain
to the implementation or use of the technology described in this
document or the extent to which any license under such rights might or
might not be available; neither does it represent that it has made any
effort to identify any such rights.  Information on the IETF's
procedures with respect to rights in standards-track and standards-
related documentation can be found in BCP-11.  Copies of claims of
rights made available for publication and any assurances of licenses to
be made available, or the result of an attempt made to obtain a general
license or permission for the use of such proprietary rights by
implementors or users of this specification can be obtained from the
IETF Secretariat.

The IETF invites any interested party to bring to its attention any



Aboba & Cheshire             Standards Track                    [Page 5]





INTERNET-DRAFT          DHCP Domain Search Option        1 November 2001


copyrights, patents or patent applications, or other proprietary rights
which may cover technology that may be required to practice this
standard.  Please address the information to the IETF Executive
Director.

Full Copyright Statement

Copyright (C) The Internet Society (2001).  All Rights Reserved.
This document and translations of it may be copied and furnished to
others, and derivative works that comment on or otherwise explain it or
assist in its implementation may be prepared, copied, published and
distributed, in whole or in part, without restriction of any kind,
provided that the above copyright notice and this paragraph are included
on all such copies and derivative works.  However, this document itself
may not be modified in any way, such as by removing the copyright notice
or references to the Internet Society or other Internet organizations,
except as needed for the purpose of developing Internet standards in
which case the procedures for copyrights defined in the Internet
Standards process must be followed, or as required to translate it into
languages other than English.  The limited permissions granted above are
perpetual and will not be revoked by the Internet Society or its
successors or assigns.  This document and the information contained
herein is provided on an "AS IS" basis and THE INTERNET SOCIETY AND THE
INTERNET ENGINEERING TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE."

Expiration Date

This memo is filed as <draft-aboba-dhc-domsearch-07.txt>,  and  expires
May 27, 2002.



















Aboba & Cheshire             Standards Track                    [Page 6]


