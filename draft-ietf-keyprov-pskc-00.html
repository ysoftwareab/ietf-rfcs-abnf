<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Portable Symmetric Key Container (PSKC)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Portable Symmetric Key Container (PSKC)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">keyprov</td><td class="header">P. Hoyer</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">ActivIdentity</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">M. Pei</td></tr>
<tr><td class="header">Expires: July 17, 2009</td><td class="header">VeriSign</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Machani</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Diversinet</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 13, 2009</td></tr>
</table></td></tr></table>
<h1><br />Portable Symmetric Key Container (PSKC)<br />draft-ietf-keyprov-pskc-00.txt</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on July 17, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document specifies a symmetric key format for transport and provisioning of
				symmetric keys (for example One Time Password (OTP) shared secrets or symmetric
				cryptographic keys) to different types of crypto modules, such as a strong
				authentication device. The standard key transport format enables enterprises to
				deploy best-of-breed solutions combining components from different vendors into the
				same infrastructure. 
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
Portable Key Container Entities Overview and Relationships<br />
<a href="#basics">4.</a>&nbsp;
&lt;KeyContainer&gt; Element: The Basics<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DeviceInfoElement">4.1.</a>&nbsp;
&lt;DeviceInfo&gt; Element: Unique Device Identification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#KeyEntity">4.2.</a>&nbsp;
&lt;Key&gt;: Embedding Keying Material<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UserElement">4.3.</a>&nbsp;
&lt;User&gt; Element: User Identification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UsageElement">4.4.</a>&nbsp;
&lt;Usage&gt; Element: Supplementary Information for OTP and CR Algorithms<br />
<a href="#policy">5.</a>&nbsp;
Policy<br />
<a href="#EncryptionKeyDescription">6.</a>&nbsp;
Protection of Keys and Related Data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SymmetricKeyProtectionDescription">6.1.</a>&nbsp;
Encryption based on Pre-Shared Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">6.2.</a>&nbsp;
Encryption based on Passphrase-based Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">6.3.</a>&nbsp;
Encryption based on Asymmetric Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">6.4.</a>&nbsp;
Transmission of Key Derivation Values<br />
<a href="#anchor7">7.</a>&nbsp;
Digital Signature<br />
<a href="#bulk">8.</a>&nbsp;
Bulk Provisioning<br />
<a href="#anchor8">9.</a>&nbsp;
Extensibility<br />
<a href="#profiles">10.</a>&nbsp;
PSKC Algorithm Profile<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#hotp">10.1.</a>&nbsp;
HOTP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#pin">10.2.</a>&nbsp;
KEYPROV-PIN<br />
<a href="#schema">11.</a>&nbsp;
XML Schema<br />
<a href="#iana">12.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">12.1.</a>&nbsp;
Content-type registration for 'application/pskc+xml'<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">12.2.</a>&nbsp;
XML Schema Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">12.3.</a>&nbsp;
URN Sub-Namespace Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SymmetricKeyAlgorithmIdentifierRegistry">12.4.</a>&nbsp;
PSKC Algorithm Profile Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">12.5.</a>&nbsp;
PSKC Version Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">12.6.</a>&nbsp;
Key Usage Registry<br />
<a href="#anchor14">13.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">13.1.</a>&nbsp;
Payload confidentiality<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">13.2.</a>&nbsp;
Payload integrity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">13.3.</a>&nbsp;
Payload authenticity<br />
<a href="#anchor18">14.</a>&nbsp;
Contributors<br />
<a href="#anchor19">15.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">16.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">16.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">16.2.</a>&nbsp;
Informative References<br />
<a href="#anchor22">Appendix&nbsp;A.</a>&nbsp;
Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">A.1.</a>&nbsp;
Online Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">A.1.1.</a>&nbsp;
Transport of keys from Server to Cryptographic Module<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">A.1.2.</a>&nbsp;
Transport of keys from Cryptographic Module to Cryptographic Module<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">A.1.3.</a>&nbsp;
Transport of keys from Cryptographic Module to Server<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">A.1.4.</a>&nbsp;
Server to server Bulk import/export of keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">A.2.</a>&nbsp;
Offline Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">A.2.1.</a>&nbsp;
Server to server Bulk import/export of keys<br />
<a href="#anchor30">Appendix&nbsp;B.</a>&nbsp;
Requirements<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>With increasing use of symmetric key based authentication systems such as systems
				based one time password (OTP) and challenge response mechanisms, there is a need for
				vendor interoperability and a standard format for importing, exporting or
				provisioning symmetric keys from one system to another. Traditionally authentication
				server vendors and service providers have used proprietary formats for importing,
				exporting and provisioning these keys into their systems making it hard to use
				tokens from vendor A with a server from vendor B.
</p>
<p>This document describes a standard format for serializing symmetric keys such as OTP
				shared secrets for system import, export or network/protocol transport. The goal is
				that the format will facilitate dynamic provisioning and transfer of symmetric keys
				such as OTP shared secrets or encryption keys of different types. In the case of OTP
				shared secrets, the format will facilitate dynamic provisioning using an online
				provisioning protocol to different flavors of embedded tokens or allow customers to
				import new or existing tokens in batch or single instances into a compliant system.
</p>
<p>This draft also specifies the key attributes required for computation such as the
				initial event counter used in the HOTP algorithm <a class='info' href='#HOTP'>[HOTP]<span> (</span><span class='info'>MRaihi, D., Bellare, M., Hoornaert, F., Naccache, D., and O. Ranen, &ldquo;HOTP: An HMAC-Based One Time Password Algorithm,&rdquo; December&nbsp;2005.</span><span>)</span></a>. It is also
				applicable for other time-based or proprietary algorithms. 
</p>
<p>To provide an analogy, in public key environments the PKCS#12 format <a class='info' href='#PKCS12'>[PKCS12]<span> (</span><span class='info'>RSA Laboratories, &ldquo;PKCS #12: Personal Information Exchange Syntax Standard,&rdquo; .</span><span>)</span></a> is commonly used for importing and exporting private keys and
				certificates between systems. In the environments outlined in this document where
				OTP keys may be transported directly down to smartcards or devices with limited
				computing capabilities and explicit shared secret, configuration attribute
				information is desirable. With PKCS#12, one would have to use opaque data to carry
				shared secret attributes used for OTP calculations, whereas a more explicit
				attribute schema definition is better for interoperability and efficiency.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
				NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as
				described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>, &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>In subsequent sections of the document we highlight mandatory elements and
				attributes. Optional elements and attributes are not explicitly indicated. 
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Portable Key Container Entities Overview and Relationships</h3>

<p>The portable key container is based on an XML schema definition and contains the
				following main conceptual entities: </p>
<ol class="text">
<li>KeyContainer entity - representing the container that carries the keys
</li>
<li>Device entity - representing a physical or virtual device where the keys
						reside optionally bound to a specific user
</li>
<li>DeviceInfo entity - representing the information about the device and
						criteria to uniquely identify the device
</li>
<li>Key entity - representing the key transmitted
</li>
<li>KeyData entity - representing data related to the key including value either
						in plain or encrypted
</li>
</ol><p>
			
</p>
<p>The figure below represents the entity relationship diagram (brackets () denote
				optional elements).
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   -----------------
   | KeyContainer  |
   |---------------|
   | EncryptionKey |
   | Signature	   |
   | ...           |
   -----------------
           |
           |
          /|\ 1..n
   ----------------     ----------------
   | Device       |    1| DeviceInfo   |
   |--------------|-----|--------------|
   | (User)       |     | SerialNumber |
   ----------------     | Manufacturer |
           |            | ....         |
           |            ----------------
          /|\ 1..n
   ----------------
   | Key          |
   |--------------|
   | ID           |
   | Algorithm    |
   | (User)       |
   | ....         |
   ----------------
           |
           |
          /|\ 1..n      --------------
   ----------------     | Plainvalue |
   | KeyData      |     --------------
   |--------------|          |
   | name         |    either|
   | value        |----------|
   | .....        |   ------------------
   ----------------   | EncryptedValue |
                      ------------------

</pre></div>
<p>The following sections describe in detail all the entities and related XML schema
				elements and attributes.
</p>
<a name="basics"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
&lt;KeyContainer&gt; Element: The Basics</h3>

<p>In it's most basic form a PSKC document uses the top-level element
				&lt;KeyContainer&gt; and a single &lt;Device&gt; element to carry
				key information.
</p>
<p>The following example shows such a simple PSKC document. We will use it to describe
				the structure of the &lt;KeyContainer&gt; element and it's child elements.
					<br /><hr class="insert" />
<a name="example-simple"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer Version="1" id="exampleID1"
xmlns="urn:ietf:params:xml:ns:keyprov:pskc"&gt;
    &lt;Device&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;Manufacturer&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;987654321&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key KeyId="12345678"
        KeyAlgorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;Usage&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/Usage&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
        &lt;/Key&gt;
    &lt;/Device&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Basic PSKC Key Container Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

			
</p>
<p>The attributes of the &lt;KeyContainer&gt; element have the following
				semantic: </p>
<blockquote class="text"><dl>
<dt>'Version:'</dt>
<dd>The 'Version' attribute is used to identify the version
						of the PSKC schema version. This specification defines the initial version
						("1") of the PSKC schema. This attribute is mandatory.
</dd>
<dt>'ID:'</dt>
<dd>The 'ID' attribute carries a unique identifier for the
						container. This is useful when needing to refer to an individual key
						container when more than one container is embedded into a larger XML
						document.
</dd>
</dl></blockquote><p>
			
</p>
<p>A &lt;KeyContainer&gt; element MUST contain at least one
				&lt;Device&gt; elements. Multiple &lt;Device&gt; elements may be
				used when for bulk provisioning, see <a class='info' href='#bulk'>Section&nbsp;8<span> (</span><span class='info'>Bulk Provisioning</span><span>)</span></a>. A &lt;Device&gt;
				MUST contain at least one &lt;Key&gt; element. A &lt;Device&gt; MAY
				be bound to a user. A key SHOULD be bound to only one &lt;Device&gt;
				element. 
			
</p>
<a name="DeviceInfoElement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
&lt;DeviceInfo&gt; Element: Unique Device Identification</h3>

<p>The &lt;DeviceInfo&gt; element allows to uniquely identify the device the
					&lt;Key&gt; element refers to. Since devices can come in different form
					factors, such as hardware tokens, smart-cards, soft tokens in a mobile phone or
					as a PC, this element allows different criteria to be used. Combined though the
					criteria MUST uniquely identify the device. For example, for hardware tokens the
					combination of SerialNo and Manufacturer will uniquely identify a device but not
					SerialNo alone since two different token manufacturers might issue devices with
					the same serial number (similar to the IssuerDN and serial number of a
					certificate). Symmetric keys used in the payment industry are usually stored on
					Integrated Circuit Smart Cards. 
</p>
<p>The &lt;DeviceInfo&gt; element has the following child elements: </p>
<blockquote class="text"><dl>
<dt>&lt;Manufacturer&gt;:</dt>
<dd>This element indicates the
							manufacturer of the device.
</dd>
<dt>&lt;SerialNo&gt;:</dt>
<dd>This element contains the serial
							number of the device
</dd>
<dt>&lt;Model&gt;:</dt>
<dd>This element describes the model of the
							device (e.g., one-button-HOTP-token-V1)
</dd>
<dt>&lt;IssueNo&gt;:</dt>
<dd>This element contains the issue
							number in case devices with the same serial number that are
							distinguished by different issue numbers
</dd>
<dt>&lt;DeviceBinding&gt;:</dt>
<dd>This element carries the
							identifier that can be used to bind keys to the device or class of
							device. When loading keys into a device, this identifier can be checked
							against information obtained from the device to ensure that the correct
							device or class of device is being used.
							 
						
</dd>
<dt>&lt;StartDate&gt;:</dt>
<dd>This element indicates the start
							date of a device (such as the one on a payment card, used when issue
							numbers are not printed on cards). The date MUST be expressed in UTC
							form with no timezone component. Implementations SHOULD NOT rely on time
							resolution finer than milliseconds and MUST NOT generate time instants
							that specify leap seconds.
</dd>
<dt>&lt;ExpiryDate&gt;:</dt>
<dd>This field contains the expiry
							date of a device (such as the one on a payment card, used when issue
							numbers are not printed on cards). It MUST be expressed in UTC form with
							no timezone component. Implementations SHOULD NOT rely on time
							resolution finer than milliseconds and MUST NOT generate time instants
							that specify leap seconds. 
</dd>
</dl></blockquote><p>
				
</p>
<a name="KeyEntity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
&lt;Key&gt;: Embedding Keying Material</h3>

<p>The following attributes of the &lt;Key&gt; element MUST be included at a
					minimum: </p>
<blockquote class="text"><dl>
<dt>'KeyId':</dt>
<dd>This attribute carries a globally unique identifier
							for the symmetric key. The identifier is defined as a string of
							alphanumeric characters.
</dd>
<dt>'KeyAlgorithm':</dt>
<dd>This attribute contains a unique identifier
							for the PSKC algorithm profile. This profile associates a specific
							semantic to the elements and attributes contained in the
							&lt;Key&gt; element. More information about the PSKC algorithm
							profile defined in this document can be found in <a class='info' href='#profiles'>Section&nbsp;10<span> (</span><span class='info'>PSKC Algorithm Profile</span><span>)</span></a>. 
</dd>
</dl></blockquote><p>
				
</p>
<p>The &lt;Key&gt; element has a number of optional child elements. An
					initial set is described below: </p>
<blockquote class="text"><dl>
<dt>&lt;Issuer&gt;:</dt>
<dd>The key issuer name, this is normally
							the name of the organization that issues the key to the end user of the
							key. For example MyBank issuing hardware tokens to their retail banking
							users 'MyBank' would be the issuer.
</dd>
<dt>&lt;FriendlyName&gt;:</dt>
<dd> A human readable name for the
							secret key for easier reference. This element serves informational
							purposes only.
</dd>
<dt>&lt;Usage&gt;:</dt>
<dd>This element defines the intended usage
							of the key and related metadata as defined in <a class='info' href='#UsageElement'>Section&nbsp;4.4<span> (</span><span class='info'>&lt;Usage&gt; Element: Supplementary Information for OTP and CR Algorithms</span><span>)</span></a> There are cases where the specific context
							in which the key is used can be inferred but typically the context is
							provided explicitly. 
</dd>
<dt>&lt;Data&gt;:</dt>
<dd>This element carries data about and
							related to the key. Further description about the &lt;Data&gt;
							element can be found subsequent to this list. 
</dd>
</dl></blockquote><p>
				
</p>
<p>This document defines a few child element for the &lt;Data&gt; element,
					namely </p>
<blockquote class="text"><dl>
<dt>&lt;Secret&gt;:</dt>
<dd>This element carries the value of the
							key itself in a binary representation.
</dd>
<dt>&lt;Counter&gt;:</dt>
<dd>This element contains the event
							counter for event based OTP algorithms.
</dd>
<dt>&lt;Time&gt;:</dt>
<dd>This element contains the time for time
							based OTP algorithms. (If time interval is used, this element carries
							the number of time intervals passed from a specific start point,
							normally algorithm dependent)
</dd>
<dt>&lt;TimeInterval&gt;:</dt>
<dd>This element carries the time
							interval value for time based OTP algorithms.
</dd>
<dt>&lt;TimeDrift&gt;:</dt>
<dd>This element contains the device
							clock drift value for time based OTP algorithms. The value indicates
							number of seconds that the device clock may drift each day. 
</dd>
</dl></blockquote><p>
				
</p>
<p> All these elements listed above (and those defined in the future) obey a simple
					structure in that they must support child element to convey the content in
					plaintext or in encrypted format: </p>
<blockquote class="text"><dl>
<dt>Plain Text:</dt>
<dd>The &lt;PlainValue> element carries plaintext
							content that is typed, for example to xs:integer.
</dd>
<dt>Encrypted Content:</dt>
<dd>The &lt;EncryptedValue> element carries
							encrypted content.
</dd>
</dl></blockquote><p>
				
</p>
<p>Additionally, an optional &lt;ValueMac> element, which is populated with a
					MAC generated from the unencrypted value in case the encryption algorithm does
					not support integrity checks, may be included as a child element.
</p>
<p>The example shown at <a class='info' href='#example-simple'>Figure&nbsp;1<span> (</span><span class='info'>Basic PSKC Key Container Example</span><span>)</span></a> illustrates the usage of the
					&lt;Data&gt; element with two child elements, namely
					&lt;Secret&gt; and &lt;Counter&gt;. Both elements carry
					plaintext value within the &lt;PlainValue> child element. 
</p>
<a name="UserElement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
&lt;User&gt; Element: User Identification</h3>

<p>&lt;User&gt; element identifies the owner or the user of the device
					using a distinguished name, as defined in <a class='info' href='#RFC4514'>[RFC4514]<span> (</span><span class='info'>Zeilenga, K., &ldquo;Lightweight Directory Access Protocol (LDAP): String Representation of 						Distinguished Names,&rdquo; June&nbsp;2006.</span><span>)</span></a>. For example:
					UID=jsmith,DC=example,DC=net 
</p>
<p>There is no semantic associated with this element, i.e., there are no checks
					enforcing that only a specific user can use this key. As such, this element is
					for informational purposes only.
</p>
<a name="UsageElement"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
&lt;Usage&gt; Element: Supplementary Information for OTP and CR Algorithms</h3>

<p>The &lt;Usage&gt; element is a child element of the &lt;Key&gt;
					element.
</p>
<p>The optional &lt;ChallengeFormat&gt; element defines the characteristics
					of the challenge in a CR usage scenario whereby the following attributes are
					defined: </p>
<blockquote class="text"><dl>
<dt>'Encoding':</dt>
<dd> This mandatory attribute defines the encoding of
							the challenge accepted by the device and MUST be one of the following
							values: 
<blockquote class="text"><dl>
<dt>DECIMAL</dt>
<dd> Only numerical digits
</dd>
<dt>HEXADECIMAL</dt>
<dd>Hexadecimal response
</dd>
<dt>ALPHANUMERIC</dt>
<dd>All letters and numbers (case sensitive)
</dd>
<dt>BASE64</dt>
<dd>Base 64 encoded
</dd>
<dt>BINARY</dt>
<dd>Binary data
</dd>
</dl></blockquote>
						
</dd>
<dt>'CheckDigit':</dt>
<dd> This optional attribute indicates whether a
							device needs to check the appended Luhn check digit, as defined in <a class='info' href='#LUHN'>[LUHN]<span> (</span><span class='info'>Luhn, H., &ldquo;Luhn algorithm,&rdquo; August&nbsp;1960.</span><span>)</span></a>, contained in a provided challenge. This is only
							valid if the 'Encoding' attribute is 'DECIMAL'. A value of TRUE
							indicates that the device will check the appended Luhn check digit in a
							provided challenge. A value of indicates that the device will not check
							appended Luhn check digit in challenge.
</dd>
<dt>'Min':</dt>
<dd> This mandatory attribute defines the minimum size of
							the challenge accepted by the device for CR mode. If the 'Encoding'
							attribute is 'DECIMAL', 'HEXADECIMAL' or 'ALPHANUMERIC' this value
							indicates the minimum number of digits/characters. If the 'Encoding'
							attribute is 'BASE64' or 'BINARY', this value indicates the minimum
							number of bytes of the unencoded value.
</dd>
<dt>'Max':</dt>
<dd>This mandatory attribute defines the maximum size of
							the challenge accepted by the device for CR mode. If the 'Encoding'
							attribute is 'DECIMAL', 'HEXADECIMAL' or 'ALPHANUMERIC' this value
							indicates the maximum number of digits/characters. If the 'Encoding'
							attribute is 'BASE64' or 'BINARY', this value indicates the maximum
							number of bytes of the unencoded value.
</dd>
</dl></blockquote><p>
				
</p>
<p>The &lt;ResponseFormat&gt; element defines the characteristics of the
					result of a computation and defines the format of the OTP or the response to a
					challenge. For cases where the key is a PIN value, this element contains the
					format of the PIN itself (e.g., DECIMAL, length 4 for a 4 digit PIN). The
					following attributes are defined: </p>
<blockquote class="text"><dl>
<dt>'Encoding':</dt>
<dd>This mandatory attribute defines the encoding of
							the response generated by the device and MUST be one of the following
							values: DECIMAL, HEXADECIMAL, ALPHANUMERIC, BASE64, or BINARY
</dd>
<dt>'CheckDigit':</dt>
<dd>This optional attribute indicates whether the
							device needs to append a Luhn check digit, as defined in <a class='info' href='#LUHN'>[LUHN]<span> (</span><span class='info'>Luhn, H., &ldquo;Luhn algorithm,&rdquo; August&nbsp;1960.</span><span>)</span></a>, to the response. This is only valid if the
							'Encoding' attribute is 'DECIMAL'. If the value is TRUE then the device
							will append a Luhn check digit to the response. If the value is FALSE
							then the device will not append a Luhn check digit to the response.
</dd>
<dt>'Length':</dt>
<dd>This mandatory attribute defines the length of the
							response generated by the device. If the 'Encoding' attribute is
							'DECIMAL', 'HEXADECIMAL' or 'ALPHANUMERIC' this value indicates the
							number of digits/characters. If the 'Encoding' attribute is 'BASE64' or
							'BINARY', this value indicates the number of bytes of the unencoded
							value.
</dd>
</dl></blockquote><p>
				
</p>
<a name="policy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Policy</h3>

<p>This section illustrates the functionality of the &lt;Policy&gt; element within PSKC that allows 
				policy to be attached to a key and related meta data. This element is a child
				element of the &lt;Key&gt; element.
</p>
<p>If the &lt;Policy&gt; element contains child elements or values within
				elements/attributes that are not understood by the recipient of the PSKC document
				then the recipient MUST assume that key usage is not permitted. This statement ensures that
				the lack of understanding of certain extension does not lead to unintended key
				usage. 
</p>
<p>We
				will start our description with an example that expands the example shown in <a class='info' href='#example-pin'>Figure&nbsp;2<span> (</span><span class='info'>Non-Encrypted HOTP Secret Key protected by PIN</span><span>)</span></a>. <br /><hr class="insert" />
<a name="example-pin"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer Version="1" id="exampleID1"
  xmlns="urn:ietf:params:xml:ns:keyprov:pskc"&gt;
    &lt;Device&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;Manufacturer&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;987654321&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key KeyId="12345678"
        KeyAlgorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;Usage&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/Usage&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;Policy&gt;
                &lt;PINPolicy MinLength="4" MaxLength="4"
                PINKeyId="123456781" PINEncoding="DECIMAL"
                PINUsageMode="Local"/&gt;
                &lt;KeyUsage&gt;OTP&lt;/KeyUsage&gt;
            &lt;/Policy&gt;
        &lt;/Key&gt;
        &lt;Key KeyId="123456781"
          KeyAlgorithm="urn:ietf:params:xml:ns:keyprov:pskc#pin"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;Usage&gt;
                &lt;ResponseFormat Length="4" Encoding="DECIMAL"/&gt;
            &lt;/Usage&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;MTIzNA==&lt;/PlainValue&gt;
                &lt;/Secret&gt;
            &lt;/Data&gt;
        &lt;/Key&gt;
    &lt;/Device&gt;
&lt;/KeyContainer&gt;</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Non-Encrypted HOTP Secret Key protected by PIN&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

			
</p>
<p>This document defines the following elements: </p>
<blockquote class="text"><dl>
<dt>&lt;StartDate&gt;:</dt>
<dd>This element denotes the start date of
						the key. It MUST NOT be possible to use this key before this date. The value
						MUST be expressed in UTC form, with no time zone component. Implementations
						SHOULD NOT rely on time resolution finer than milliseconds and MUST NOT
						generate time instants that specify leap seconds. When this element is
						absent then the current time is assumed as a start time.
</dd>
<dt>&lt;ExpiryDate&gt;:</dt>
<dd>This element denotes the expiry date
						of the key. It MUST NOT be possible to use this key after this date. The
						value MUST be expressed in UTC form, with no time zone component.
						Implementations SHOULD NOT rely on time resolution finer than milliseconds
						and MUST NOT generate time instants that specify leap seconds. When this
						element is absent then no expiry date is assumed.
</dd>
<dt>&lt;KeyUsage&gt;:</dt>
<dd> The &lt;KeyUsage&gt; element
						allows to indicate the intended usage of the key. The recipient of the PSKC
						document is expected to enforce the key usage. Currently, the following
						tokens are registered by this document: 
<blockquote class="text"><dl>
<dt>OTP:</dt>
<dd> The key MUST only be used for OTP generation.
</dd>
<dt>CR:</dt>
<dd> The key MUST only be used for Challenge/Response
								purposes.
</dd>
<dt>Encrypt:</dt>
<dd>The key MUST only be used for data encryption
								purposes.
</dd>
<dt>Integrity:</dt>
<dd>The key MUST only be used to generate a keyed
								message digest for data integrity or authentication purposes.
</dd>
<dt>Unlock:</dt>
<dd> The key MUST only be used for an inverse
								challenge response in the case a user has locked the device by
								entering a wrong PIN too many times (for devices with PIN-input
								capability).
</dd>
<dt>Decrypt:</dt>
<dd>The key MUST only be used for data decryption
								purposes.
</dd>
<dt>KeyWrap:</dt>
<dd>The key MUST only be used for key wrap
							purposes.
</dd>
</dl></blockquote> The element may also be repeated to allow several key usages to be
						expressed. When this element is absent then no key usage constraint is
						assumed, i.e., the key may be utilized for every usage. 
</dd>
<dt>&lt;PINPolicy&gt;:</dt>
<dd> The &lt;PINPolicy&gt; element
						allows policy about the PIN usage to be associated to the key. The following
						attributes are specified: 
<blockquote class="text"><dl>
<dt>'PINKeyId':</dt>
<dd>This attribute contains the unique key id of
								the key held within this container that contains the value of the
								PIN that protects the key.
</dd>
<dt>'PINUsageMode':</dt>
<dd>This mandatory attribute indicates the way
								the PIN is used during the usage of the key. The following values
								are defined: 
<blockquote class="text"><dl>
<dt>Local:</dt>
<dd>This value indicates that the PIN is
										checked locally on the device before allowing the key to be
										used in executing the algorithm.
</dd>
<dt>Prepend:</dt>
<dd>This value indicates that the PIN is
										prepended to the OTP or response hence it MUST be checked by
										the validation server.
</dd>
<dt>Append:</dt>
<dd>This value indicates that the PIN is
										appended to the OTP or response hence it MUST be checked by
										the validation server.
</dd>
<dt>Algorithmic:</dt>
<dd>This value indicates that the PIN is
										used as part of the algorithm computation.
</dd>
</dl></blockquote>
							
</dd>
<dt>'MaxFailedAttempts':</dt>
<dd> This attribute indicates the maximum
								number of times the PIN can be entered wrongly before it MUST not be
								possible to use the key anymore. If the 'PinUsageMode'="Local" then
								the device MUST enforce this value, otherwise it MUST be enforced by
								the validation server.
</dd>
<dt>'MinLength':</dt>
<dd> This attribute indicates the minimum length
								of a PIN that can be set to protect this key. It MUST NOT be
								possible to set a PIN shorter than this value. If the 'PINFormat'
								attribute is 'DECIMAL', 'HEXADECIMAL' or 'ALPHANUMERIC' this value
								indicates the number of digits/characters. If the 'PINFormat'
								attribute is 'BASE64' or 'BINARY', this value indicates the number
								of bytes of the unencoded value. If the 'PinUsageMode' attribute is
								set to "Local" then the device MUST enforce this value, otherwise it
								MUST be enforced by the validation server.
</dd>
<dt>'MaxLength':</dt>
<dd> This attribute indicates the maximum lenght
								of a PIN that can be set to protect this key. It MUST NOT be
								possible to set a PIN longer than this value. If the 'PINFormat'
								attribute is 'DECIMAL', 'HEXADECIMAL' or 'ALPHANUMERIC' this value
								indicates the number of digits/characters. If the 'PINFormat'
								attribute is 'BASE64' or 'BINARY', this value indicates the number
								of bytes of the unencoded value. If the 'PinUsageMode' attribute is
								set to "Local" then the device MUST enforce this value, otherwise it
								MUST be enforced by the validation server.
</dd>
<dt>'PINEncoding':</dt>
<dd>This attribute indicates the encoding of
								the PIN and MUST be one of the values: DECIMAL, HEXADECIMAL,
								ALPHANUMERIC, BASE64, or BINARY. If the 'PINUsageMode' attribute is
								set to "Local" then the device MUST enforce that the entered value
								is of this format, otherwise it MUST be enforced by the validation
								server.
</dd>
</dl></blockquote>
					
</dd>
</dl></blockquote><p>
			
</p>
<a name="EncryptionKeyDescription"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Protection of Keys and Related Data</h3>

<p>With the functionality described in the previous sections information related to keys
				had to be transmitted in clear text. With the help of the
				&lt;EncryptionKey&gt; element, which is a child element of the
				&lt;KeyContainer&gt; element, it is possible to encrypt keys and associated
				information. The level of encryption is applied to each individual element and the
				indicated encryption method MUST be the same for elements. In subsequent sections
				key encryption based on pre-shared keys, based on passphrase-based keys, and based
				on asymmetric keys will be discussed.
</p>
<a name="SymmetricKeyProtectionDescription"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Encryption based on Pre-Shared Keys</h3>

<p><a class='info' href='#example-encr-psk'>Figure&nbsp;3<span> (</span><span class='info'>AES-128-CBC Encrypted Pre-Shared Secret Key</span><span>)</span></a> shows an example that illustrates the
					encryption of the content of the &lt;Secret&gt; element using
					AES128-CBC, the plaintext value of &lt;Secret&gt; is '3132333435363738393031323334353637383930'. The name of the pre-shared secret is "Example-Key1", as set in the
					&lt;KeyName&gt; element (which is a child element of the
					&lt;EncryptionKey&gt; element). The value of the key used is '12345678901234567890123456789012'.  Since AES128-CBC does not provide
					integrity checks a keyed MAC is applied to the encrypted value using the
					algorithm indicated in &lt;MACAlgorithm&gt; element (in our example
					"http://www.w3.org/2000/09/xmldsig#hmac-sha1" is used). The result of the keyed
					MAC computation is placed in the &lt;ValueMAC&gt; element. 
</p>
<p>
					<br /><hr class="insert" />
<a name="example-encr-psk"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer Version="1" xmlns="urn:ietf:params:xml:ns:keyprov:pskc"
xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"&gt;
    &lt;EncryptionKey&gt;
        &lt;ds:KeyName&gt;Pre-shared-key&lt;/ds:KeyName&gt;
    &lt;/EncryptionKey&gt;
    &lt;MACAlgorithm&gt;http://www.w3.org/2000/09/xmldsig#hmac-sha1
    &lt;/MACAlgorithm&gt;
    &lt;Device&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;Manufacturer&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;987654321&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key KeyId="12345678"
        KeyAlgorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;Usage&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/Usage&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;EncryptedValue&gt;
                        &lt;xenc:EncryptionMethod
                        Algorithm=
                        "http://www.w3.org/2001/04/xmlenc#aes128-cbc"/&gt;
                        &lt;xenc:CipherData&gt;
                        &lt;xenc:CipherValue&gt;
                        pgznhXdDh4LJ2G3mOY2RL7UA47yizMlXX3ADDcZd8Vs=
                        &lt;/xenc:CipherValue&gt;
                        &lt;/xenc:CipherData&gt;
                    &lt;/EncryptedValue&gt;
                    &lt;ValueMAC&gt;zdrZbGBj9BDZJzunbfAG3kyZyYc=
                    &lt;/ValueMAC&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
        &lt;/Key&gt;
    &lt;/Device&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: AES-128-CBC Encrypted Pre-Shared Secret Key&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

				
</p>
<p>When protecting the payload with pre-shared keys implementations SHOULD set the
					name of the specific pre-shared key in the &lt;KeyName&gt; element
					inside the &lt;EncryptionKey&gt;
					element.
				
</p>
<p> The following is the list of symmetric key encryption algorithm and possible
					parameters for usage with pre-shared secret based encryption. Systems
					implementing PSKC MUST support AES128-CBC (with the URI of
					http://www.w3.org/2001/04/xmlenc#aes128-cbc).
</p>
<p>An example list of optionally-to-implement encryption algorithms can be found
					below:
</p>
<p>
					</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Algorithm      | URL
---------------+------------------------------------------------------
AES192-CBC     | http://www.w3.org/2001/04/xmlenc#aes192-cbc
AES256-CBC     | http://www.w3.org/2001/04/xmlenc#aes256-cbc
TripleDES-CBC  | http://www.w3.org/2001/04/xmlenc#tripledes-cbc
Camellia128    | http://www.w3.org/2001/04/xmldsig-more#camellia128
Camellia192    | http://www.w3.org/2001/04/xmldsig-more#camellia192
Camellia256    | http://www.w3.org/2001/04/xmldsig-more#camellia256
KW-AES128      | http://www.w3.org/2001/04/xmlenc#kw-aes128
KW-AES192      | http://www.w3.org/2001/04/xmlenc#kw-aes192
KW-AES256      | http://www.w3.org/2001/04/xmlenc#kw-aes256
KW-TripleDES   | http://www.w3.org/2001/04/xmlenc#kw-tripledes
KW-Camellia128 | http://www.w3.org/2001/04/xmldsig-more#kw-camellia128
KW-Camellia192 | http://www.w3.org/2001/04/xmldsig-more#kw-camellia192
KW-Camellia256 | http://www.w3.org/2001/04/xmldsig-more#kw-camellia256
</pre></div><p>

				
</p>
<p>When algorithms without integrity checks are used, such as AES12-CBC, a keyed MAC
					value using the same key as the key encryption key MUST be placed in the
					&lt;ValueMAC&gt; element of the &lt;Data&gt; element. In this
					case the MAC algorithm type MUST be set in the &lt;MACAlgorithm&gt;
					element of the &lt;KeyContainer&gt; element. Implementations of PSKC
					MUST support HMAC-SHA1 (with the URI of
					http://www.w3.org/2000/09/xmldsig#hmac-sha1) as the mandatory-to-implement MAC
					algorithm. An example list of optionally-to-implement MAC algorithms can be
					found below: 
</p>
<p>
					</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Algorithm      | URL
---------------+------------------------------------------------------
HMAC-SHA256    | http://www.w3.org/2001/04/xmldsig-more#hmac-sha256
HMAC-SHA384    | http://www.w3.org/2001/04/xmldsig-more#hmac-sha384
HMAC-SHA512    | http://www.w3.org/2001/04/xmldsig-more#hmac-sha512
</pre></div><p>

				
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Encryption based on Passphrase-based Keys</h3>

<p>To be able to support passphrase based key encryption keys as defined in PKCS#5
					the following PBE related parameters have been introduced into PSKC.
					Implementations of PSKC MUST support the PKCS#5 recommended PBKDF2 and PBES2
					algorithms. Differing from the PKCS#5 XML schema definition, the PBKDF2 and
					PBES2 are specified in two separate elements in a &lt;KeyContainer> element:
						</p>
<blockquote class="text">
<p>(a) PBKDF2 is specified via the &lt;DerivedKey> element, which is a
							child element of the &lt;EncryptionKey> element.
</p>
<p>(b) PBES2 is specified by the 'Algorithm' attribute (with the value set
							to http://www.rsasecurity.com/rsalabs/pkcs/schemas/pkcs-5#pbes2) of the
							&lt;EncryptionMethod&gt; element used inside the encrypted data
							elements. 
</p>
</blockquote><p>
				
</p>
<p>The attributes of the &lt;DerivedKey> element have the following semantic:
						</p>
<blockquote class="text"><dl>
<dt>'xml:id':</dt>
<dd>This attribute carries the unique identifier for
							this key.
</dd>
<dt>'Type':</dt>
<dd>This attribute was included for conformance with XML
							encryption. It is an optional attribute identifying type information
							about the plaintext form of the encrypted content. Please see Section
							3.1 of <a class='info' href='#XMLENC'>[XMLENC]<span> (</span><span class='info'>Eastlake, D., &ldquo;XML Encryption Syntax and Processing.,&rdquo; December&nbsp;2002.</span><span>)</span></a> for more details.
</dd>
</dl></blockquote><p>
				
</p>
<p>The elements of the &lt;DerivedKey> element have the following semantic:
						</p>
<blockquote class="text"><dl>
<dt>&lt;CarriedKeyName>:</dt>
<dd>This element carries a friendly name
							of the key.
</dd>
<dt>&lt;KeyDerivationMethod>:</dt>
<dd>This element defines how key
							encryption key is derived. The 'Algorithm' attribute is used to indicate
							the key derivation method. When PBKDF2 is used, the URI
							http://www.rsasecurity.com/rsalabs/pkcs/schemas/pkcs-5#pbkdf2 MUST be
							used. When PBKDF2 is used, it MUST include the &lt;PBKDF2-params>
							child element to indicate the PBKDF2 parameters, such as salt and
							iteration count.
</dd>
<dt>&lt;ReferenceList>:</dt>
<dd>This element contains a list of IDs of
							the elements that have been encrypted by this key.
</dd>
</dl></blockquote><p>
				
</p>
<p> When PBES2 is used for encryption, the URL
					http://www.rsasecurity.com/rsalabs/pkcs/schemas/pkcs-5#pbes2 MUST be specified
					as the 'Algorithm' attribute of &lt;xenc:EncryptionMethod> element. The
					underlying encryption scheme and initialization vector MUST be expressed in the
					&lt;pskc:EncryptionScheme> element, which is a child element of
					&lt;xenc:EncryptionMethod>. 
</p>
<p>When PKCS#5 password based encryption is used, the &lt;EncryptionKey&gt;
					element and &lt;xenc:EncryptionMethod> element MUST be used in exactly the
					form as shown in <a class='info' href='#example-encr-passwd'>Figure&nbsp;4<span> (</span><span class='info'>Example of a PSKC Document using Encryption based on Passphrase-based Keys</span><span>)</span></a>. 
</p>
<p>In the example below, the following data is used.
                                    </p>
<blockquote class="text"><dl>
<dt>Password:       </dt>
<dd>qwerty
</dd>
<dt>Salt:           </dt>
<dd>0x123eff3c4a72129c
</dd>
<dt>Iteration Count:</dt>
<dd>1000
</dd>
<dt>OTP Secret:     </dt>
<dd>12345678901234567890
</dd>
</dl></blockquote><p>
                                     The derived encryption key is "0x651e63cd57008476af1ff6422cd02e41". This key is also
                                     used to calculate MAC value of the secret key "12345678901234567890". The encryption
                                     with algorithm "AES-128-CBC" follows the specification defined in <a class='info' href='#XMLENC'>[XMLENC]<span> (</span><span class='info'>Eastlake, D., &ldquo;XML Encryption Syntax and Processing.,&rdquo; December&nbsp;2002.</span><span>)</span></a>.
                                
</p>
<p>
					<br /><hr class="insert" />
<a name="example-encr-passwd"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer
    xmlns="urn:ietf:params:xml:ns:keyprov:pskc"
    xmlns:pkcs5=
     "http://www.rsasecurity.com/rsalabs/pkcs/schemas/pkcs-5v2-0#"
    xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"
    Version="1"&gt;
    &lt;EncryptionKey&gt;
        &lt;DerivedKey&gt;
            &lt;CarriedKeyName&gt;Passphrase1&lt;/CarriedKeyName&gt;
            &lt;KeyDerivationMethod
                Algorithm=
"http://www.rsasecurity.com/rsalabs/pkcs/schemas/pkcs-5v2-0#pbkdf2"&gt;
                &lt;pkcs5:PBKDF2-params&gt;
                    &lt;pkcs5:Salt&gt;
                        &lt;pkcs5:Specified&gt;Ej7/PEpyEpw=&lt;/pkcs5:Specified&gt;
                    &lt;/pkcs5:Salt&gt;
                    &lt;pkcs5:IterationCount&gt;1000&lt;/pkcs5:IterationCount&gt;
                    &lt;pkcs5:KeyLength&gt;16&lt;/pkcs5:KeyLength&gt;
                    &lt;pkcs5:PRF/&gt;
                &lt;/pkcs5:PBKDF2-params&gt;
            &lt;/KeyDerivationMethod&gt;
            &lt;xenc:ReferenceList&gt;
                &lt;xenc:DataReference URI="#ED"/&gt;
            &lt;/xenc:ReferenceList&gt;
        &lt;/DerivedKey&gt;
    &lt;/EncryptionKey&gt;
    &lt;Device&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;TokenVendorAcme&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;987654321&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key KeyAlgorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"
        KeyId="123456"&gt;
            &lt;Issuer&gt;Example-Issuer&lt;/Issuer&gt;
            &lt;Usage&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/Usage&gt;
            &lt;Data&gt;
            &lt;Secret&gt;
                &lt;EncryptedValue Id="ED"&gt;
                    &lt;xenc:EncryptionMethod Algorithm=
"http://www.rsasecurity.com/rsalabs/pkcs/schemas/pkcs-5#pbes2"&gt;
                        &lt;EncryptionScheme Algorithm=
"http://www.w3.org/2001/04/xmlenc#aes128-cbc"&gt;
                        &lt;/EncryptionScheme&gt;
                    &lt;/xenc:EncryptionMethod&gt;
                    &lt;xenc:CipherData&gt;
                        &lt;xenc:CipherValue&gt;
      oTvo+S22nsmS2Z/RtcoF8Hfh+jzMe0RkiafpoDpnoZTjPYZu6V+A4aEn032yCr4f
                        &lt;/xenc:CipherValue&gt;
                    &lt;/xenc:CipherData&gt;
                    &lt;ns2:ValueMAC&gt;cOpiQ/H7Zlj6ywiYWtwgz9cRaOA=
                    &lt;/ns2:ValueMAC&gt;
                &lt;/EncryptedValue&gt;
            &lt;/Secret&gt;
            &lt;/Data&gt;
        &lt;/Key&gt;
    &lt;/Device&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Example of a PSKC Document using Encryption based on Passphrase-based Keys&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

				
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Encryption based on Asymmetric Keys</h3>

<p>When using asymmetric keys to encrypt child element of the &lt;Data&gt;
					element information about the certificate being used MUST be stated in the
					&lt;X509Data&gt; element, which is a child element of the
					&lt;EncryptionKey&gt; element. The encryption algorithm MUST be
					indicated in the 'Algorithm' attribute of the &lt;EncryptionMethod&gt;
					element. In the example shown in <a class='info' href='#example-encr-asymm'>Figure&nbsp;5<span> (</span><span class='info'>Example of a PSKC Document using Encryption based on Asymmetric Keys</span><span>)</span></a> the
					algorithm is set to "http://www.w3.org/2001/04/xmlenc#rsa_1_5".
</p>
<p>
					<br /><hr class="insert" />
<a name="example-encr-asymm"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer Version="1"
    xmlns="urn:ietf:params:xml:ns:keyprov:pskc"
    xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
    xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"&gt;
    &lt;EncryptionKey&gt;
        &lt;ds:X509Data&gt;
            &lt;ds:X509Certificate&gt;miib&lt;/ds:X509Certificate&gt;
        &lt;/ds:X509Data&gt;
    &lt;/EncryptionKey&gt;
    &lt;Device&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;Manufacturer&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;0755225266&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key KeyAlgorithm=
            "urn:ietf:params:xml:ns:keyprov:pskc#hotp"
            KeyId="0755225266"&gt;
            &lt;Issuer&gt;AnIssuer&lt;/Issuer&gt;
            &lt;Usage&gt;
                &lt;ResponseFormat Length="8"
                    Encoding="DECIMAL"/&gt;
            &lt;/Usage&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;EncryptedValue Id="ED"&gt;
                        &lt;xenc:EncryptionMethod
                         Algorithm=
                         "http://www.w3.org/2001/04/xmlenc#rsa_1_5"/&gt;
                        &lt;xenc:CipherData&gt;
                         &lt;xenc:CipherValue&gt;rf4dx3rvEPO0vKtKL14NbeVu8nk=
                         &lt;/xenc:CipherValue&gt;
                        &lt;/xenc:CipherData&gt;
                    &lt;/EncryptedValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
        &lt;/Key&gt;
    &lt;/Device&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Example of a PSKC Document using Encryption based on Asymmetric Keys&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

				
</p>
<p>Systems implementing PSKC MUST support the
					http://www.w3.org/2001/04/xmlenc#rsa-1_5 algorithm.
					http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p is an example of an
					optional-to-implement algorithm. 
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Transmission of Key Derivation Values</h3>

<p>&lt;KeyProfileId> element, which is a child element of the
					&lt;Key&gt; element, carries a unique identifier used between the
					sending and receiving party to establish a set of key attribute values that are
					not transmitted within the container but agreed between the two parties out of
					band. This element will then represent the unique reference to a set of
					attribute values. For example, a smart card application personalisation profile
					id related to attributes present on a smart card application that have influence
					when computing a response. The sending and the receiving party would agree to a
					set of values related to the MasterCard's Chip Authentication Protocol (CAP)
						<a class='info' href='#CAP'>[CAP]<span> (</span><span class='info'>MasterCard International, &ldquo;Chip Authentication Program Functional Architecture,&rdquo; September&nbsp;2004.</span><span>)</span></a>.
					
				
</p>
<p>For example, sending and receiving party would agree that KeyProfileId='1' would
					represent a certain set of values (e.g., Internet authentication flag set to a
					specific value). When sending keys these values would not be transmitted as key
					attributes but only referred to via the &lt;KeyProfileId&gt; element set
					to the specific agreed profile (in this case '1'). When the receiving party
					receives the keys it can then associate all relevant key attributes contained in
					the out of band agreed profile with the imported keys. Often this methodology is
					used between the manufacturing and the validation service to avoid transmission
					of mainly the same set of values.
</p>
<p>&lt;MasterKeyId> element uniquely references an external master key when key
					derivation schemes are used and no specific key is transported but only the
					reference to the master key used to derive a specific key and some derivation
					data (e.g., the PKCS#11 key label).
</p>
<p>
					<br /><hr class="insert" />
<a name="example-key-derivation-values"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer Version="1" id="exampleID1"
xmlns="urn:ietf:params:xml:ns:keyprov:pskc"&gt;
    &lt;Device&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;Manufacturer&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;987654321&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key KeyId="12345678"
        KeyAlgorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;Usage&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/Usage&gt;
            &lt;KeyProfileId&gt;keyProfile1&lt;/KeyProfileId&gt;
            &lt;MasterKeyId&gt;MasterKeyLabel&lt;/MasterKeyId&gt;
            &lt;Data&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;Policy&gt;
                &lt;KeyUsage&gt;OTP&lt;/KeyUsage&gt;
            &lt;/Policy&gt;
        &lt;/Key&gt;
    &lt;/Device&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: Example of a PSKC Document transmitting a HOTP key via key derivation values (the key value will be derived using the serialnumber and a pre-shared masterkey identified by 'MasterKeyLabel' )&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

				
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Digital Signature</h3>

<p>PSKC allows a digital signature to be added to the XML document, as a child element
				of the &lt;KeyContainer&gt; element. The description of the XML digital
				signature can be found in <a class='info' href='#XMLDSIG'>[XMLDSIG]<span> (</span><span class='info'>Eastlake, D., &ldquo;XML-Signature Syntax and Processing,&rdquo; February&nbsp;2002.</span><span>)</span></a>.
</p>
<p>
				<br /><hr class="insert" />
<a name="example-dsig"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer
    xmlns="urn:ietf:params:xml:ns:keyprov:pskc"
    xmlns:pkcs5=
    "http://www.rsasecurity.com/rsalabs/pkcs/schemas/pkcs-5v2-0#"
    xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
    xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"
    Version="1"&gt;
    &lt;Device&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;TokenVendorAcme&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;0755225266&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key KeyAlgorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"
        KeyId="123"&gt;
            &lt;Issuer&gt;Example-Issuer&lt;/Issuer&gt;
            &lt;Usage&gt;
                &lt;ResponseFormat Length="6" Encoding="DECIMAL"/&gt;
            &lt;/Usage&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;
                        MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
        &lt;/Key&gt;
    &lt;/Device&gt;
    &lt;Signature&gt;
        &lt;ds:SignedInfo&gt;
            &lt;ds:CanonicalizationMethod
             Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/&gt;
            &lt;ds:SignatureMethod
             Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/&gt;
            &lt;ds:Reference URI="#Device"&gt;
                &lt;ds:DigestMethod
             Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
                &lt;ds:DigestValue&gt;
                    j6lwx3rvEPO0vKtMup4NbeVu8nk=
                &lt;/ds:DigestValue&gt;
            &lt;/ds:Reference&gt;
        &lt;/ds:SignedInfo&gt;
        &lt;ds:SignatureValue&gt;
            j6lwx3rvEPO0vKtMup4NbeVu8nk=
        &lt;/ds:SignatureValue&gt;
        &lt;ds:KeyInfo&gt;
            &lt;ds:X509Data&gt;
                &lt;ds:X509IssuerSerial&gt;
                    &lt;ds:X509IssuerName&gt;
                        CN=Example.com,C=US
                    &lt;/ds:X509IssuerName&gt;
                    &lt;ds:X509SerialNumber&gt;
                        12345678
                    &lt;/ds:X509SerialNumber&gt;
                &lt;/ds:X509IssuerSerial&gt;
            &lt;/ds:X509Data&gt;
        &lt;/ds:KeyInfo&gt;
    &lt;/Signature&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: Digital Signature Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

			
</p>
<a name="bulk"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Bulk Provisioning</h3>

<p>The functionality of bulk provisioning can be accomplished by repeating the
				&lt;Device&gt; element multiple times within the
				&lt;KeyContainer&gt; element indicating that multiple keys are provided to
				different devices. The &lt;EncryptionKey&gt; element then applies to all
				&lt;Device&gt; elements. Furthermore, within a single &lt;Device&gt;
				element the &lt;Key&gt; element may also be repeated providing different
				keys and meta data for a single device.
</p>
<p><a class='info' href='#example-bulk'>Figure&nbsp;8<span> (</span><span class='info'>Bulk Provisioning Example</span><span>)</span></a> shows an example utilizing these capabilities.
</p>
<p>
				<br /><hr class="insert" />
<a name="example-bulk"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;KeyContainer Version="1"
    xmlns="urn:ietf:params:xml:ns:keyprov:pskc"&gt;
    &lt;Device&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;TokenVendorAcme&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;654321&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key KeyAlgorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"
        KeyId="1"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;Usage&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/Usage&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;
                        MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;Policy&gt;
                &lt;StartDate&gt;2006-05-01T00:00:00Z&lt;/StartDate&gt;
                &lt;ExpiryDate&gt;2006-05-31T00:00:00Z&lt;/ExpiryDate&gt;
            &lt;/Policy&gt;
        &lt;/Key&gt;
    &lt;/Device&gt;
    &lt;Device&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;TokenVendorAcme&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;123456&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key KeyAlgorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"
        KeyId="2"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;Usage&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/Usage&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;
                        MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;Policy&gt;
                &lt;StartDate&gt;2006-05-01T00:00:00Z&lt;/StartDate&gt;
                &lt;ExpiryDate&gt;2006-05-31T00:00:00Z&lt;/ExpiryDate&gt;
            &lt;/Policy&gt;
        &lt;/Key&gt;
    &lt;/Device&gt;
    &lt;Device&gt;
        &lt;DeviceInfo&gt;
            &lt;Manufacturer&gt;TokenVendorAcme&lt;/Manufacturer&gt;
            &lt;SerialNo&gt;9999999&lt;/SerialNo&gt;
        &lt;/DeviceInfo&gt;
        &lt;Key KeyAlgorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"
        KeyId="3"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;Usage&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/Usage&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;
                        MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;Policy&gt;
                &lt;StartDate&gt;2006-03-01T00:00:00Z&lt;/StartDate&gt;
                &lt;ExpiryDate&gt;2006-03-31T00:00:00Z&lt;/ExpiryDate&gt;
            &lt;/Policy&gt;
        &lt;/Key&gt;
        &lt;Key KeyAlgorithm="urn:ietf:params:xml:ns:keyprov:pskc#hotp"
        KeyId="4"&gt;
            &lt;Issuer&gt;Issuer&lt;/Issuer&gt;
            &lt;Usage&gt;
                &lt;ResponseFormat Length="8" Encoding="DECIMAL"/&gt;
            &lt;/Usage&gt;
            &lt;Data&gt;
                &lt;Secret&gt;
                    &lt;PlainValue&gt;
                        MTIzNDU2Nzg5MDEyMzQ1Njc4OTA=
                    &lt;/PlainValue&gt;
                &lt;/Secret&gt;
                &lt;Counter&gt;
                    &lt;PlainValue&gt;0&lt;/PlainValue&gt;
                &lt;/Counter&gt;
            &lt;/Data&gt;
            &lt;Policy&gt;
                &lt;StartDate&gt;2006-04-01T00:00:00Z&lt;/StartDate&gt;
                &lt;ExpiryDate&gt;2006-04-30T00:00:00Z&lt;/ExpiryDate&gt;
            &lt;/Policy&gt;
        &lt;/Key&gt;
    &lt;/Device&gt;
&lt;/KeyContainer&gt;
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: Bulk Provisioning Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

			
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Extensibility</h3>

<p>This section lists a few common extension points provided by PSKC: 
</p>
<p>
				</p>
<blockquote class="text"><dl>
<dt>New PSKC Version:</dt>
<dd>Whenever it is necessary to define a new version
						of this document then a new version number has to be allocated to refer to
						the new specification version. The version number is carried inside the
						'Algorithm' attribute, as described in <a class='info' href='#basics'>Section&nbsp;4<span> (</span><span class='info'>&lt;KeyContainer&gt; Element: The Basics</span><span>)</span></a>, and rules
						for extensibililty are defined in <a class='info' href='#iana'>Section&nbsp;12<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>.
</dd>
<dt>New XML Elements:</dt>
<dd>The usage of the XML schema and the available
						extension points allows new XML elements to be added. Depending of type of
						XML elements different ways for extensibility are offered. In some places
						the &lt;Extensions&gt; element can be used and elsewhere the
						"&lt;xs:any namespace="##other" processContents="lax" minOccurs="0"
						maxOccurs="unbounded"/&gt;" XML extension point is utilized.
</dd>
<dt>New XML Attributes:</dt>
<dd>The XML schema allows new XML attributes to be
						added where XML extension points have been defined (see
						"&lt;xs:anyAttribute namespace="##other"/&gt;" in <a class='info' href='#schema'>Section&nbsp;11<span> (</span><span class='info'>XML Schema</span><span>)</span></a>).
</dd>
<dt>New PSKC Algorithm Profiles:</dt>
<dd>This document defines two PSKC
						algorithm profiles, see <a class='info' href='#profiles'>Section&nbsp;10<span> (</span><span class='info'>PSKC Algorithm Profile</span><span>)</span></a>. Further PSKC algorithm
						profiles can be registered as described in <a class='info' href='#SymmetricKeyAlgorithmIdentifierRegistry'>Section&nbsp;12.4<span> (</span><span class='info'>PSKC Algorithm Profile Registry</span><span>)</span></a>.
</dd>
<dt>Algorithm URIs:</dt>
<dd>
						<a class='info' href='#EncryptionKeyDescription'>Section&nbsp;6<span> (</span><span class='info'>Protection of Keys and Related Data</span><span>)</span></a> defines how keys and related data
						can be protected. A number of algorithms can be used. The usage of new
						algorithms can be used by pointing to a new algorithm URI. 
</dd>
<dt>Policy:</dt>
<dd>
						<a class='info' href='#policy'>Section&nbsp;5<span> (</span><span class='info'>Policy</span><span>)</span></a> defines policies that can be attached to a key
						and keying related data. The &lt;Policy&gt; element is one such
						item that allows to restrict the usage of the key to certain functions, such
						as "OTP usage only". Further values may be registered as described in <a class='info' href='#iana'>Section&nbsp;12<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a>. 
</dd>
</dl></blockquote><p>
			
</p>
<a name="profiles"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
PSKC Algorithm Profile</h3>

<a name="hotp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
HOTP</h3>

<p>
					</p>
<blockquote class="text"><dl>
<dt>Common Name:</dt>
<dd> HOTP 
</dd>
<dt>Class:</dt>
<dd> OTP 
</dd>
<dt>URN:</dt>
<dd>urn:ietf:params:xml:ns:keyprov:pskc#hotp
</dd>
<dt>Algorithm Definition:</dt>
<dd> http://www.ietf.org/rfc/rfc4226.txt 
</dd>
<dt>Identifier Definition:</dt>
<dd> (this RFC) 
</dd>
<dt>Registrant Contact:</dt>
<dd> IESG 
</dd>
<dt>Profiling:</dt>
<dd>
							
<blockquote class="text">
<p>The &lt;Usage> element MUST be present. The &lt;ResponseFormat> element
									of the &lt;Usage> element MUST be used to indicate the OTP
									length and the value format.
</p>
<p>The &lt;Counter&gt; element (see <a class='info' href='#KeyEntity'>Section&nbsp;4.2<span> (</span><span class='info'>&lt;Key&gt;: Embedding Keying Material</span><span>)</span></a>) MUST be provided as meta-data for the key. 
</p>
<p>The following additional constraints apply: </p>
<ul class="text">
<li>The value of the &lt;Secret> element MUST contain key
											material with a length of at least 16 octets (128 bits),
											if it is present.
</li>
<li>The &lt;ResponseFormat> element MUST have the
											'Format' attribute set to "DECIMAL", and the 'Length'
											attribute MUST indicate a length value between 6 and 9.
</li>
<li>The &lt;PINPolicy> element MAY be present but the
											'PINUsageMode' attribute cannot be set to "Algorithmic".
										
</li>
</ul>
								

<p>An example can be found in <a class='info' href='#example-simple'>Figure&nbsp;1<span> (</span><span class='info'>Basic PSKC Key Container Example</span><span>)</span></a>. 
</p>
</blockquote>
						
</dd>
</dl></blockquote><p>
				
</p>
<a name="pin"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
KEYPROV-PIN</h3>

<p>
					</p>
<blockquote class="text"><dl>
<dt>Common Name:</dt>
<dd> KEYPROV-PIN 
</dd>
<dt>Class:</dt>
<dd> Symmetric static credential comparison 
</dd>
<dt>URN:</dt>
<dd>urn:ietf:params:xml:ns:keyprov:pskc#pin
</dd>
<dt>Algorithm Definition:</dt>
<dd> (this document) 
</dd>
<dt>Identifier Definition</dt>
<dd> (this document) 
</dd>
<dt>Registrant Contact:</dt>
<dd> IESG 
</dd>
<dt>Profiling:</dt>
<dd>
							
<blockquote class="text">
<p>The &lt;Usage> element MAY be present but no attribute of the
									&lt;Usage> element is required. The &lt;ResponseFormat>
									element MAY be used to indicate the PIN value format.
</p>
<p>The &lt;Secret&gt; element (see <a class='info' href='#KeyEntity'>Section&nbsp;4.2<span> (</span><span class='info'>&lt;Key&gt;: Embedding Keying Material</span><span>)</span></a>) MUST be provided. 
</p>
<p>See the example in <a class='info' href='#example-pin'>Figure&nbsp;2<span> (</span><span class='info'>Non-Encrypted HOTP Secret Key protected by PIN</span><span>)</span></a>
								
</p>
</blockquote>
						
</dd>
</dl></blockquote><p>
				
</p>
<a name="schema"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
XML Schema</h3>

<p>This section defines the XML schema for PSKC. 
</p>
<p>
				</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;xs:schema
  targetNamespace="urn:ietf:params:xml:ns:keyprov:pskc"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:pskc="urn:ietf:params:xml:ns:keyprov:pskc"
  xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
  xmlns:xenc="http://www.w3.org/2001/04/xmlenc#"
  elementFormDefault="qualified"
  attributeFormDefault="unqualified"&gt;
  &lt;xs:import namespace="http://www.w3.org/2000/09/xmldsig#"
schemaLocation=
"http://www.w3.org/TR/2002/REC-xmldsig-core-20020212/
xmldsig-core-schema.xsd"/&gt;
  &lt;xs:import namespace="http://www.w3.org/2001/04/xmlenc#"
      schemaLocation=
"http://www.w3.org/TR/2002/REC-xmlenc-core-20021210/
xenc-schema.xsd"/&gt;
	&lt;xs:import namespace="http://www.w3.org/XML/1998/namespace"/&gt;

    &lt;xs:complexType name="KeyContainerType"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element name="EncryptionKey" type="ds:KeyInfoType"
          minOccurs="0"/&gt;
        &lt;xs:element name="MACAlgorithm" type="pskc:KeyAlgorithmType"
          minOccurs="0"/&gt;
        &lt;xs:element name="Device" type="pskc:DeviceType"
          minOccurs="1" maxOccurs="unbounded"/&gt;
        &lt;xs:element name="Signature" type="ds:SignatureType"
          minOccurs="0"/&gt;
        &lt;xs:element name="Extensions"
        type="pskc:ExtensionsType" minOccurs="0"
        maxOccurs="unbounded"/&gt;
    &lt;/xs:sequence&gt;
        &lt;xs:attribute name="Version" type="xs:unsignedInt"
            use="required"/&gt;
        &lt;xs:attribute name="id" type="xs:ID" use="optional"/&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:complexType name="KeyType"&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name="Issuer"
            type="xs:string" minOccurs="0"/&gt;
            &lt;xs:element name="Usage"
            type="pskc:UsageType"/&gt;
			&lt;xs:element name="KeyProfileId"
			type="xs:string" minOccurs="0"/&gt;
			&lt;xs:element name="MasterKeyId"
			type="xs:string" minOccurs="0"/&gt;
            &lt;xs:element name="FriendlyName"
            type="xs:string" minOccurs="0"/&gt;
            &lt;xs:element name="Data" type="pskc:KeyDataType"
            minOccurs="0" maxOccurs="1"/&gt;
            &lt;xs:element name="UserId" type="xs:string"
                minOccurs="0"/&gt;
            &lt;xs:element name="Policy"
                type="pskc:PolicyType" minOccurs="0"/&gt;
            &lt;xs:element name="Extensions"
            type="pskc:ExtensionsType" minOccurs="0"
            maxOccurs="unbounded"/&gt;
        &lt;/xs:sequence&gt;
        &lt;xs:attribute name="KeyId"
        type="xs:string" use="required"/&gt;
        &lt;xs:attribute name="KeyAlgorithm"
        type="pskc:KeyAlgorithmType"
          use="optional"/&gt;
        &lt;xs:attribute name="KeyProperties"
        type="xs:IDREF" use="optional"/&gt;
    &lt;/xs:complexType&gt;

    &lt;xs:complexType name="PolicyType"&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name="StartDate"
                     type="xs:dateTime" minOccurs="0"/&gt;
            &lt;xs:element name="ExpiryDate"
                type="xs:dateTime" minOccurs="0"/&gt;
            &lt;xs:element name="PINPolicy"
                type="pskc:PINPolicyType" minOccurs="0"/&gt;
            &lt;xs:element name="KeyUsage"
                type="pskc:KeyUsageType" minOccurs="0"/&gt;
            &lt;xs:any namespace="##other"
                minOccurs="0" maxOccurs="unbounded"/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;

	&lt;xs:complexType name="KeyDataType"&gt;
	    &lt;xs:sequence&gt;
            &lt;xs:element name="Secret"
            type="pskc:binaryDataType"
            minOccurs="0" maxOccurs="1"/&gt;
            &lt;xs:element name="Counter"
            type="pskc:longDataType"
            minOccurs="0" maxOccurs="1"/&gt;
            &lt;xs:element name="Time"
            type="pskc:intDataType"
            minOccurs="0" maxOccurs="1"/&gt;
            &lt;xs:element name="TimeInterval"
            type="pskc:intDataType"
            minOccurs="0" maxOccurs="1"/&gt;
            &lt;xs:element name="TimeDrift"
            type="pskc:intDataType"
            minOccurs="0" maxOccurs="1"/&gt;
            &lt;xs:any namespace="##other" processContents="lax"
            minOccurs="0" maxOccurs="unbounded"/&gt;
	    &lt;/xs:sequence&gt;
	&lt;/xs:complexType&gt;
    &lt;xs:complexType name="binaryDataType"&gt;
        &lt;xs:sequence&gt;
            &lt;xs:choice&gt;
                &lt;xs:element name="PlainValue"
                type="xs:base64Binary"/&gt;
                &lt;xs:element name="EncryptedValue"
                type="xenc:EncryptedDataType"/&gt;
            &lt;/xs:choice&gt;
			&lt;xs:element name="ValueMAC"
			type="xs:base64Binary" minOccurs="0"/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:complexType name="intDataType"&gt;
        &lt;xs:sequence&gt;
            &lt;xs:choice&gt;
                &lt;xs:element name="PlainValue"
                type="xs:int"/&gt;
                &lt;xs:element name="EncryptedValue"
                type="xenc:EncryptedDataType"/&gt;
            &lt;/xs:choice&gt;
			&lt;xs:element name="ValueMAC"
			type="xs:base64Binary" minOccurs="0"/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:complexType name="stringDataType"&gt;
        &lt;xs:sequence&gt;
            &lt;xs:choice&gt;
                &lt;xs:element name="PlainValue"
                type="xs:string"/&gt;
                &lt;xs:element name="EncryptedValue"
                type="xenc:EncryptedDataType"/&gt;
            &lt;/xs:choice&gt;
			&lt;xs:element name="ValueMAC"
			type="xs:base64Binary" minOccurs="0"/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:complexType name="longDataType"&gt;
        &lt;xs:sequence&gt;
            &lt;xs:choice&gt;
                &lt;xs:element name="PlainValue"
                type="xs:long"/&gt;
                &lt;xs:element name="EncryptedValue"
                type="xenc:EncryptedDataType"/&gt;
            &lt;/xs:choice&gt;
			&lt;xs:element name="ValueMAC"
			type="xs:base64Binary" minOccurs="0"/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:complexType name="DerivedKeyType"&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name="KeyDerivationMethod"
              type="pskc:KeyDerivationMethodType" minOccurs="0"/&gt;
            &lt;xs:element ref="xenc:ReferenceList" minOccurs="0"/&gt;
            &lt;xs:element name="CarriedKeyName" type="xs:string"
                minOccurs="0"/&gt;
        &lt;/xs:sequence&gt;
        &lt;xs:attribute name="id" type="xs:ID" use="optional"/&gt;
        &lt;xs:attribute name="Type" type="xs:anyURI" use="optional"/&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:complexType name="KeyDerivationMethodType"&gt;
        &lt;xs:sequence&gt;
            &lt;xs:any namespace="##other" processContents="lax"
						minOccurs="0"
            maxOccurs="unbounded"/&gt;
        &lt;/xs:sequence&gt;
        &lt;xs:attribute name="Algorithm" type="xs:anyURI"
        use="required"/&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:complexType name="PINPolicyType"&gt;
        &lt;xs:attribute name="PINKeyId" type="xs:string"
            use="optional"/&gt;
        &lt;xs:attribute name="PINUsageMode"
            type="pskc:PINUsageModeType"/&gt;
        &lt;xs:attribute name="MaxFailedAttempts" type="xs:unsignedInt"
            use="optional"/&gt;
        &lt;xs:attribute name="MinLength"
            type="xs:unsignedInt" use="optional"/&gt;
        &lt;xs:attribute name="MaxLength"
            type="xs:unsignedInt" use="optional"/&gt;
        &lt;xs:attribute name="PINEncoding"
            type="pskc:ValueFormatType" use="optional"/&gt;
        &lt;xs:anyAttribute namespace="##other"/&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:simpleType name="PINUsageModeType"&gt;
        &lt;xs:restriction base="xs:string"&gt;
            &lt;xs:enumeration value="Local"/&gt;
            &lt;xs:enumeration value="Prepend"/&gt;
            &lt;xs:enumeration value="Append"/&gt;
            &lt;xs:enumeration value="Algorithmic"/&gt;
        &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;
    &lt;xs:simpleType name="KeyUsageType"&gt;
        &lt;xs:restriction base="xs:string"&gt;
            &lt;xs:enumeration value="OTP"/&gt;
            &lt;xs:enumeration value="CR"/&gt;
            &lt;xs:enumeration value="Encrypt"/&gt;
            &lt;xs:enumeration value="Integrity"/&gt;
            &lt;xs:enumeration value="Unlock"/&gt;
            &lt;xs:enumeration value="Decrypt"/&gt;
            &lt;xs:enumeration value="KeyWrap"/&gt;
        &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;
    &lt;xs:complexType name="DeviceInfoType"&gt;
        &lt;xs:sequence&gt;
        &lt;xs:element name="Manufacturer" type="xs:string"
        minOccurs="0"/&gt;
        &lt;xs:element name="SerialNo" type="xs:string"
        minOccurs="0"/&gt;
        &lt;xs:element name="Model" type="xs:string"
        minOccurs="0"/&gt;
        &lt;xs:element name="IssueNo" type="xs:string"
        minOccurs="0"/&gt;
        &lt;xs:element name="DeviceBinding" type="xs:string"
        minOccurs="0"/&gt;
        &lt;xs:element name="StartDate" type="xs:dateTime"
        minOccurs="0"/&gt;
        &lt;xs:element name="ExpiryDate" type="xs:dateTime"
        minOccurs="0"/&gt;
        &lt;xs:element name="Extensions"
        type="pskc:ExtensionsType" minOccurs="0"
        maxOccurs="unbounded"/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:complexType name="DeviceType"&gt;
        &lt;xs:sequence&gt;
        &lt;xs:element name="DeviceInfo" type="pskc:DeviceInfoType"
          minOccurs="0"/&gt;
        &lt;xs:element name="Key" type="pskc:KeyType"
          maxOccurs="unbounded"/&gt;
        &lt;xs:element name="User" type="xs:string"
        minOccurs="0"/&gt;
        &lt;xs:element name="Extensions"
        type="pskc:ExtensionsType" minOccurs="0"
        maxOccurs="unbounded"/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:complexType name="UsageType"&gt;
        &lt;xs:choice&gt;
            &lt;xs:element name="ChallengeFormat" minOccurs="0"&gt;
                &lt;xs:complexType&gt;
                    &lt;xs:attribute name="Encoding"
                      type="pskc:ValueFormatType" use="required"/&gt;
                    &lt;xs:attribute name="Min" type="xs:unsignedInt"
                      use="required"/&gt;
                    &lt;xs:attribute name="Max" type="xs:unsignedInt"
                      use="required"/&gt;
                    &lt;xs:attribute name="CheckDigits" type="xs:boolean"
                      default="false"/&gt;
                &lt;/xs:complexType&gt;
            &lt;/xs:element&gt;
            &lt;xs:element name="ResponseFormat" minOccurs="0"&gt;
                &lt;xs:complexType&gt;
                    &lt;xs:attribute name="Encoding"
                      type="pskc:ValueFormatType" use="required"/&gt;
                    &lt;xs:attribute name="Length" type="xs:unsignedInt"
                      use="required"/&gt;
                    &lt;xs:attribute name="CheckDigits" type="xs:boolean"
                      default="false"/&gt;
                &lt;/xs:complexType&gt;
            &lt;/xs:element&gt;
        &lt;xs:element name="Extensions"
        type="pskc:ExtensionsType" minOccurs="0"
        maxOccurs="unbounded"/&gt;
            &lt;/xs:choice&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:complexType name="ExtensionsType"&gt;
      &lt;xs:sequence&gt;
        &lt;xs:any namespace="##other" processContents="lax"
        maxOccurs="unbounded"/&gt;
      &lt;/xs:sequence&gt;
      &lt;xs:attribute name="definition" type="xs:anyURI"
      use="optional"/&gt;
    &lt;/xs:complexType&gt;
    &lt;xs:simpleType name="KeyAlgorithmType"&gt;
        &lt;xs:restriction base="xs:anyURI"/&gt;
    &lt;/xs:simpleType&gt;
    &lt;xs:simpleType name="ValueFormatType"&gt;
        &lt;xs:restriction base="xs:string"&gt;
            &lt;xs:enumeration value="DECIMAL"/&gt;
            &lt;xs:enumeration value="HEXADECIMAL"/&gt;
            &lt;xs:enumeration value="ALPHANUMERIC"/&gt;
            &lt;xs:enumeration value="BASE64"/&gt;
            &lt;xs:enumeration value="BINARY"/&gt;
        &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;

    &lt;xs:element name="DerivedKey" type="pskc:DerivedKeyType"/&gt;
    &lt;xs:element name="EncryptionScheme"
        type="xenc:EncryptionMethodType"/&gt;
    &lt;xs:element name="KeyContainer" type="pskc:KeyContainerType"/&gt;
&lt;/xs:schema&gt;</pre></div><p>

<p>
</p>
			

<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
IANA Considerations</h3>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.1"></a><h3>12.1.&nbsp;
Content-type registration for 'application/pskc+xml'</h3>

<p>This specification requests the registration of a new MIME type according to the
					procedures of RFC 4288 <a class='info' href='#RFC4288'>[RFC4288]<span> (</span><span class='info'>Freed, N. and J. Klensin, &ldquo;Media Type Specifications and Registration Procedures,&rdquo; December&nbsp;2005.</span><span>)</span></a> and guidelines in RFC 3023 <a class='info' href='#RFC3023'>[RFC3023]<span> (</span><span class='info'>Murata, M., St. Laurent, S., and D. Kohn, &ldquo;XML Media Types,&rdquo; January&nbsp;2001.</span><span>)</span></a>.
</p>
<p>
					</p>
<blockquote class="text"><dl>
<dt>MIME media type name:</dt>
<dd>application 
</dd>
<dt>MIME subtype name:</dt>
<dd>pskc+xml 
</dd>
<dt>Mandatory parameters:</dt>
<dd>none 
</dd>
<dt>Optional parameters:</dt>
<dd>charset<br />
 Indicates
							the character encoding of enclosed XML. 
</dd>
<dt>Encoding considerations:</dt>
<dd> Uses XML, which can employ 8-bit
							characters, depending on the character encoding used. See RFC 3023 <a class='info' href='#RFC3023'>[RFC3023]<span> (</span><span class='info'>Murata, M., St. Laurent, S., and D. Kohn, &ldquo;XML Media Types,&rdquo; January&nbsp;2001.</span><span>)</span></a>, Section 3.2.
</dd>
<dt>Security considerations:</dt>
<dd> This content type is designed to
							carry PSKC protocol payloads.
</dd>
<dt>Interoperability considerations:</dt>
<dd>None
</dd>
<dt>Published specification:</dt>
<dd>RFCXXXX [NOTE TO IANA/RFC-EDITOR:
							Please replace XXXX with the RFC number of this specification.] 
</dd>
<dt>Applications which use this media type:</dt>
<dd> This MIME type is
							being used as a symmetric key container format for transport and
							provisioning of symmetric keys (One Time Password (OTP) shared secrets
							or symmetric cryptographic keys) to different types of strong
							authentication devices. As such, it is used for key provisioning
							systems. 
</dd>
<dt>Additional information:</dt>
<dd>
							
<blockquote class="text"><dl>
<dt>Magic Number:</dt>
<dd>None 
</dd>
<dt>File Extension:</dt>
<dd>.pskcxml 
</dd>
<dt>Macintosh file type code:</dt>
<dd>'TEXT' 
</dd>
</dl></blockquote>
						
</dd>
<dt>Personal and email address for further information:</dt>
<dd>Philip
							Hoyer, Philip.Hoyer@actividentity.com 
</dd>
<dt>Intended usage:</dt>
<dd>LIMITED USE 
</dd>
<dt>Author:</dt>
<dd> This specification is a work item of the IETF KEYPROV
							working group, with mailing list address
							&lt;keyprov@ietf.org&gt;. 
</dd>
<dt>Change controller:</dt>
<dd> The IESG &lt;iesg@ietf.org&gt;
						
</dd>
</dl></blockquote><p>
				
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.2"></a><h3>12.2.&nbsp;
XML Schema Registration</h3>

<p> This section registers an XML schema as per the guidelines in <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>.
</p>
<p>
					</p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:ns:keyprov:pskc
</dd>
<dt>Registrant Contact:</dt>
<dd>IETF KEYPROV Working Group, Philip Hoyer
							(Philip.Hoyer@actividentity.com).
</dd>
<dt>XML Schema:</dt>
<dd>The XML schema to be registered is contained in
								<a class='info' href='#schema'>Section&nbsp;11<span> (</span><span class='info'>XML Schema</span><span>)</span></a>. Its first line is <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</pre></div> and its last line is<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;/xs:schema&gt;
</pre></div>
						
</dd>
</dl></blockquote><p>
				
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.3"></a><h3>12.3.&nbsp;
URN Sub-Namespace Registration</h3>

<p> This section registers a new XML namespace,
					"urn:ietf:params:xml:ns:keyprov:pskc", per the guidelines in <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>. 
</p>
<p>
					</p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:ns:keyprov:pskc
</dd>
<dt>Registrant Contact:</dt>
<dd>IETF KEYPROV Working Group, Philip Hoyer
							(Philip.Hoyer@actividentity.com).
</dd>
<dt>XML:</dt>
<dd>
							<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
BEGIN
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.0//EN"
  "http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
  &lt;meta http-equiv="content-type"
        content="text/html;charset=iso-8859-1"/&gt;
  &lt;title&gt;PSKC Namespace&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Namespace for PSKC&lt;/h1&gt;
  &lt;h2&gt;urn:ietf:params:xml:ns:keyprov:pskc:1.0&lt;/h2&gt;
&lt;p&gt;See &lt;a href="[URL of published RFC]"&gt;RFCXXXX
    [NOTE TO IANA/RFC-EDITOR:
     Please replace XXXX with the RFC number of this
    specification.]&lt;/a&gt;.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
END
</pre></div>
						
</dd>
</dl></blockquote><p>
				
</p>
<a name="SymmetricKeyAlgorithmIdentifierRegistry"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.4"></a><h3>12.4.&nbsp;
PSKC Algorithm Profile Registry</h3>

<p> This specification requests the creation of a new IANA registry for PSKC
					algorithm profiles in accordance with the principles set out in <a class='info' href='#RFC5226'>RFC 5226<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a> [RFC5226]. 
</p>
<p> As part of this registry IANA will maintain the following information: 
</p>
<p>
					</p>
<blockquote class="text"><dl>
<dt>Common Name:</dt>
<dd> The name by which the PSKC algorithm profile is
							generally referred. 
</dd>
<dt>Class:</dt>
<dd> The type of PSKC algorithm profile registry entry being
							created, such as encryption, Message Authentication Code (MAC), One Time
							Password (OTP), Digest. 
</dd>
<dt>URN:</dt>
<dd> The URN to be used to identify the profile. 
</dd>
<dt>Identifier Definition:</dt>
<dd> IANA will be asked to add a pointer to
							the specification containing information about the PSKC algorithm
							profile registration. 
</dd>
<dt>Algorithm Definition:</dt>
<dd> A reference to the stable document in
							which the algorithm being used with the PSKC is defined. 
</dd>
<dt>Registrant Contact:</dt>
<dd> Contact information about the party
							submitting the registration request. 
</dd>
<dt>PSKC Profiling:</dt>
<dd> Information about PSKC XML elements and
							attributes being used (or not used) with this specific profile of PSKC.
						
</dd>
</dl></blockquote><p>
				
</p>
<p> PSKC algorithm profile identifier registrations are to be subject to Expert
					Review as per <a class='info' href='#RFC5226'>RFC 5226<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a> [RFC5226]. 
</p>
<p> IANA is asked to add an initial value to the registry based on the PSKC HOTP
					algorithm profile described in <a class='info' href='#profiles'>Section&nbsp;10<span> (</span><span class='info'>PSKC Algorithm Profile</span><span>)</span></a>. 
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.5"></a><h3>12.5.&nbsp;
PSKC Version Registry</h3>

<p>IANA is requested to create a registry for PSKC version numbers. The registry has
					the following structure: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  PSKC Version              | Specification
+---------------------------+----------------
| 1                         | [This document]
</pre></div><p>

				
</p>
<p> Standards action is required to define new versions of PSKC. It is not
					envisioned to depreciate, delete, or modify existing PSKC versions. 
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12.6"></a><h3>12.6.&nbsp;
Key Usage Registry</h3>

<p>IANA is requested to create a registry for key usage. A description of the
					'KeyUsage' element can be found in <a class='info' href='#policy'>Section&nbsp;5<span> (</span><span class='info'>Policy</span><span>)</span></a>. The registry
					has the following structure: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Key Usage Token           | Specification
+---------------------------+-------------------------------
| OTP                       | [Section 5 of this document ]
| CR                        | [Section 5 of this document ]
| Encrypt                   | [Section 5 of this document ]
| Integrity                 | [Section 5 of this document ]
| Unlock                    | [Section 5 of this document ]
| Decrypt                   | [Section 5 of this document ]
| KeyWrap                   | [Section 5 of this document ]
+---------------------------+-------------------------------
</pre></div><p>

				
</p>
<p>Expert Review is required to define new key usage tokens. Each registration
					request has to provide a description of the semantic. Using the same procedure
					it is possible to depreciate, delete, or modify existing key usage tokens.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Security Considerations</h3>

<p>The portable key container carries sensitive information (e.g., cryptographic keys)
				and may be transported across the boundaries of one secure perimeter to another. For
				example, a container residing within the secure perimeter of a back-end provisioning
				server in a secure room may be transported across the internet to an end-user device
				attached to a personal computer. This means that special care must be taken to
				ensure the confidentiality, integrity, and authenticity of the information contained
				within.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.1"></a><h3>13.1.&nbsp;
Payload confidentiality</h3>

<p>By design, the container allows two main approaches to guaranteeing the
					confidentiality of the information it contains while transported. 
</p>
<p>First, the container key data payload may be encrypted.
</p>
<p>In this case no transport layer security is required. However, standard security
					best practices apply when selecting the strength of the cryptographic algorithm
					for payload encryption. Symmetric cryptographic cipher should be used - the
					longer the cryptographic key, the stronger the protection. At the time of this
					writing both 3DES and AES are mandatory algorithms but 3DES may be dropped in
					the relatively near future. Applications concerned with algorithm longevity are
					advised to use AES-256-CBC. In cases where the exchange of key encryption keys
					between the sender and the receiver is not possible, asymmetric encryption of
					the secret key payload may be employed. Similarly to symmetric key cryptography,
					the stronger the asymmetric key, the more secure the protection is. 
</p>
<p>If the payload is encrypted with a method that uses one of the password-based
					encryption methods provided above, the payload may be subjected to password
					dictionary attacks to break the encryption password and recover the information.
					Standard security best practices for selection of strong encryption passwords
					apply <a class='info' href='#Schneier'>[Schneier]<span> (</span><span class='info'>Schneier, B., &ldquo;Secrets and Lies: Digitial Security in a Networked World,&rdquo; 2000.</span><span>)</span></a>.
</p>
<p>Practical implementations should use PBESalt and PBEIterationCount when PBE
					encryption is used. Different PBESalt value per key container should be used for
					best protection.
</p>
<p>The second approach to protecting the confidentiality of the payload is based on
					using transport layer security. The secure channel established between the
					source secure perimeter (the provisioning server from the example above) and the
					target perimeter (the device attached to the end-user computer) utilizes
					encryption to transport the messages that travel across. No payload encryption
					is required in this mode. Secure channels that encrypt and digest each message
					provide an extra measure of security, especially when the signature of the
					payload does not encompass the entire payload. 
</p>
<p>Because of the fact that the plain text payload is protected only by the
					transport layer security, practical implementation must ensure protection
					against man-in-the-middle attacks <a class='info' href='#Schneier'>[Schneier]<span> (</span><span class='info'>Schneier, B., &ldquo;Secrets and Lies: Digitial Security in a Networked World,&rdquo; 2000.</span><span>)</span></a>. Validating the
					secure channel end-points is critically important for eliminating intruders that
					may compromise the confidentiality of the payload.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.2"></a><h3>13.2.&nbsp;
Payload integrity</h3>

<p>The portable symmetric key container provides a mean to guarantee the integrity
					of the information it contains through digital signatures. For best security
					practices, the digital signature of the container should encompass the entire
					payload. This provides assurances for the integrity of all attributes. It also
					allows verification of the integrity of a given payload even after the container
					is delivered through the communication channel to the target perimeter and
					channel message integrity check is no longer possible. 
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.3"></a><h3>13.3.&nbsp;
Payload authenticity</h3>

<p>The digital signature of the payload is the primary way of showing its
					authenticity. The recipient of the container may use the public key associated
					with the signature to assert the authenticity of the sender by tracing it back
					to a preloaded public key or certificate. Note that the digital signature of the
					payload can be checked even after the container has been delivered through the
					secure channel of communication.
</p>
<p>A weaker payload authenticity guarantee may be provided by the transport layer if
					it is configured to digest each message it transports. However, no authenticity
					verification is possible once the container is delivered at the recipient end.
					This approach may be useful in cases where the digital signature of the
					container does not encompass the entire payload. 
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
Contributors</h3>

<p>We would like Hannes Tschofenig for his text contributions to this document.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
Acknowledgements</h3>

<p> The authors of this draft would like to thank the following people for their
				contributions and support to make this a better specification: Apostol Vassilev,
				Shuh Chang, Jon Martinson, Siddhart Bajaj, Stu Veath, Kevin Lewis, Philip
				Hallam-Baker, Andrea Doherty, Magnus Nystrom, Tim Moses, Anders
				Rundgren, Sean Turner and especially Robert Philpott. 
</p>
<p>This work is based on earlier work by the members of OATH (Initiative for Open
				AuTHentication) to specify a format that can be freely distributed to the technical
				community.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16"></a><h3>16.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>16.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="LUHN">[LUHN]</a></td>
<td class="author-text">Luhn, H., &ldquo;<a href="http://patft.uspto.gov/netacgi/nph-Parser?patentnumber=2950048">Luhn algorithm</a>,&rdquo; US Patent&nbsp;2950048, August&nbsp;1960 (<a href="http://patft.uspto.gov/netacgi/nph-Parser?patentnumber=2950048">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="PKCS1">[PKCS1]</a></td>
<td class="author-text">Kaliski, B., &ldquo;<a href="http://tools.ietf.org/html/rfc2437">PKCS #1: RSA Cryptography Specifications Version 2.0.</a>,&rdquo; RFC&nbsp;2437, October&nbsp;1998.</td></tr>
<tr><td class="author-text" valign="top"><a name="PKCS5">[PKCS5]</a></td>
<td class="author-text">RSA Laboratories, &ldquo;PKCS #5: Password-Based Cryptography Standard,&rdquo; Version&nbsp;2.0, URL:&nbsp;http://www.rsasecurity.com/rsalabs/pkcs/, March&nbsp;1999.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">&ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3023">[RFC3023]</a></td>
<td class="author-text">Murata, M., St. Laurent, S., and D. Kohn, &ldquo;<a href="http://tools.ietf.org/html/rfc3023">XML Media Types</a>,&rdquo; RFC&nbsp;3023, January&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3553">[RFC3553]</a></td>
<td class="author-text">Mealling, M., Masinter, L., Hardie, T., and G. Klyne, &ldquo;<a href="http://tools.ietf.org/html/rfc3553">An IETF URN Sub-namespace for Registered Protocol Parameters</a>,&rdquo; BCP&nbsp;73, RFC&nbsp;3553, June&nbsp;2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3688">[RFC3688]</a></td>
<td class="author-text">Mealling, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3688">The IETF XML Registry</a>,&rdquo; BCP&nbsp;81, RFC&nbsp;3688, January&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4288">[RFC4288]</a></td>
<td class="author-text">Freed, N. and J. Klensin, &ldquo;<a href="http://tools.ietf.org/html/rfc4288">Media Type Specifications and Registration Procedures</a>,&rdquo; BCP&nbsp;13, RFC&nbsp;4288, December&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4514">[RFC4514]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4514">Lightweight Directory Access Protocol (LDAP): String Representation of
						Distinguished Names</a>,&rdquo; RFC&nbsp;4514, June&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="XMLDSIG">[XMLDSIG]</a></td>
<td class="author-text">Eastlake, D., &ldquo;XML-Signature Syntax and Processing,&rdquo; URL:&nbsp;http://www.w3.org/TR/2002/REC-xmldsig-core-20020212/, W3C&nbsp;Recommendation, February&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="XMLENC">[XMLENC]</a></td>
<td class="author-text">Eastlake, D., &ldquo;XML Encryption Syntax and Processing.,&rdquo; URL:&nbsp;http://www.w3.org/TR/xmlenc-core/, W3C&nbsp;Recommendation, December&nbsp;2002.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>16.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="AlgorithmURIs">[AlgorithmURIs]</a></td>
<td class="author-text">Eastlake, D., &ldquo;<a href="http://tools.ietf.org/html/rfc4051">Additional XML Security Uniform Resource Identifiers</a>,&rdquo; RFC&nbsp;4051, April&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="CAP">[CAP]</a></td>
<td class="author-text">MasterCard International, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2200.txt">Chip Authentication Program Functional Architecture</a>,&rdquo; September&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="DSKPP">[DSKPP]</a></td>
<td class="author-text">Doherty, A., Pei, M., Machani, S., and M. Nystrom, &ldquo;Dynamic Symmetric Key Provisioning Protocol,&rdquo; Internet Draft&nbsp;Informational, URL:&nbsp;http://www.ietf.org/internet-drafts/draft-ietf-keyprov-dskpp-05.txt, February&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="HOTP">[HOTP]</a></td>
<td class="author-text">MRaihi, D., Bellare, M., Hoornaert, F., Naccache, D., and O. Ranen, &ldquo;<a href="http://tools.ietf.org/html/rfc4226">HOTP: An HMAC-Based One Time Password Algorithm</a>,&rdquo; RFC&nbsp;4226, December&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST-SP800-57">[NIST-SP800-57]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;Recommendation for Key Management - Part I: General (Revised),&rdquo; NIST&nbsp;800-57, URL:&nbsp;http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57-Part1-revised2_Mar08-2007.pdf, March&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="OATH">[OATH]</a></td>
<td class="author-text">&ldquo;<a href="http://www.ietf.org/rfc/rfc2200.txt">Initiative for Open AuTHentication</a>,&rdquo; URL:&nbsp;http://www.openauthentication.org.</td></tr>
<tr><td class="author-text" valign="top"><a name="OCRA">[OCRA]</a></td>
<td class="author-text">MRaihi, D., Rydell, J., Naccache, D., Machani, S., and S. Bajaj, &ldquo;<a href="http://www.ietf.org/rfc/rfc2200.txt">OCRA: OATH Challenge Response Algorithm</a>,&rdquo; Internet Draft&nbsp;Informational, URL:&nbsp;http://www.ietf.org/internet-drafts/draft-mraihi-mutual-oath-hotp-variants-06.txt, December&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="PKCS12">[PKCS12]</a></td>
<td class="author-text">RSA Laboratories, &ldquo;<a href="http://www.ietf.org/rfc/rfc2200.txt">PKCS #12: Personal Information Exchange Syntax Standard</a>,&rdquo; Version&nbsp;1.0, URL:&nbsp;http://www.rsasecurity.com/rsalabs/pkcs/.</td></tr>
<tr><td class="author-text" valign="top"><a name="Schneier">[Schneier]</a></td>
<td class="author-text">Schneier, B., &ldquo;<a href="http://www.ietf.org/rfc/rfc2200.txt">Secrets and Lies: Digitial Security in a Networked World</a>,&rdquo; &nbsp;Wiley Computer Publishing, ISBN&nbsp;0-8493-8253-7, 2000.</td></tr>
</table>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Use Cases</h3>

<p>This section describes a comprehensive list of use cases that inspired the
				development of this specification. These requirements were used to derive the
				primary requirement that drove the design. These requirements are covered in the
				next section.
</p>
<p>These use cases also help in understanding the applicability of this specification to
				real world situations.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Online Use Cases</h3>

<p>This section describes the use cases related to provisioning the keys using an
					online provisioning protocol such as <a class='info' href='#DSKPP'>[DSKPP]<span> (</span><span class='info'>Doherty, A., Pei, M., Machani, S., and M. Nystrom, &ldquo;Dynamic Symmetric Key Provisioning Protocol,&rdquo; February&nbsp;2008.</span><span>)</span></a>
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.1"></a><h3>A.1.1.&nbsp;
Transport of keys from Server to Cryptographic Module</h3>

<p>For example, a mobile device user wants to obtain a symmetric key for use
						with a Cryptographic Module on the device. The Cryptographic Module from
						vendor A initiates the provisioning process against a provisioning system
						from vendor B using a standards-based provisioning protocol such as <a class='info' href='#DSKPP'>[DSKPP]<span> (</span><span class='info'>Doherty, A., Pei, M., Machani, S., and M. Nystrom, &ldquo;Dynamic Symmetric Key Provisioning Protocol,&rdquo; February&nbsp;2008.</span><span>)</span></a>. The provisioning entity delivers one or more keys in a
						standard format that can be processed by the mobile device.
</p>
<p>For example, in a variation of the above, instead of the user's mobile phone,
						a key is provisioned in the user's soft token application on a laptop using
						a network-based online protocol. As before, the provisioning system delivers
						a key in a standard format that can be processed by the soft token on the
						PC.
</p>
<p>For example, the end-user or the key issuer wants to update or configure an
						existing key in the Cryptographic Module and requests a replacement key
						container. The container may or may not include a new key and may include
						new or updated key attributes such as a new counter value in HOTP key case,
						a modified response format or length, a new friendly name, etc.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.2"></a><h3>A.1.2.&nbsp;
Transport of keys from Cryptographic Module to Cryptographic Module</h3>

<p>For example, a user wants to transport a key from one Cryptographic Module to
						another. There may be two cryptographic modules, one on a computer one on a
						mobile phone, and the user wants to transport a key from the computer to the
						mobile phone. The user can export the key and related data in a standard
						format for input into the other Cryptographic Module.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.3"></a><h3>A.1.3.&nbsp;
Transport of keys from Cryptographic Module to Server</h3>

<p>For example, a user wants to activate and use a new key and related data
						against a validation system that is not aware of this key. This key may be
						embedded in the Cryptographic Module (e.g. SD card, USB drive) that the user
						has purchased at the local electronics retailer. Along with the
						Cryptographic Module, the user may get the key on a CD or a floppy in a
						standard format. The user can now upload via a secure online channel or
						import this key and related data into the new validation system and start
						using the key.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.4"></a><h3>A.1.4.&nbsp;
Server to server Bulk import/export of keys</h3>

<p>From time to time, a key management system may be required to import or
						export keys in bulk from one entity to another. 
</p>
<p>For example, instead of importing keys from a manufacturer using a file, a
						validation server may download the keys using an online protocol. The keys
						can be downloaded in a standard format that can be processed by a validation
						system.
</p>
<p>For example, in a variation of the above, an Over-The-Aire (OTA) key
						provisioning gateway that provisions keys to mobile phones may obtain key
						material from a key issuer using an online protocol. The keys are delivered
						in a standard format that can be processed by the key provisioning gateway
						and subsequently sent to the end-user's mobile phone.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Offline Use Cases</h3>

<p>This section describes the use cases relating to offline transport of keys from
					one system to another, using some form of export and import model. 
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1"></a><h3>A.2.1.&nbsp;
Server to server Bulk import/export of keys</h3>

<p>For example, Cryptographic Modules such as OTP authentication tokens, may
						have their symmetric keys initialized during the manufacturing process in
						bulk, requiring copies of the keys and algorithm data to be loaded into the
						authentication system through a file on portable media. The manufacturer
						provides the keys and related data in the form of a file containing records
						in standard format, typically on a CD. Note that the token manufacturer and
						the vendor for the validation system may be the same or different. Some
						crypto modules will allow local PIN management (the device will have a PIN
						pad) hence random initial PINs set at manufacturing should be transmitted
						together with the respective keys they protect.
</p>
<p>For example, an enterprise wants to port keys and related data from an
						existing validation system A into a different validation system B. The
						existing validation system provides the enterprise with a functionality that
						enables export of keys and related data (e.g. for OTP authentication tokens)
						in a standard format. Since the OTP tokens are in the standard format, the
						enterprise can import the token records into the new validation system B and
						start using the existing tokens. Note that the vendors for the two
						validation systems may be the same or different. 
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Requirements</h3>

<p>This section outlines the most relevant requirements that are the basis of this work.
				Several of the requirements were derived from use cases described above. </p>
<blockquote class="text"><dl>
<dt>R1:</dt>
<dd>The format MUST support transport of multiple types of symmetric keys and
						related attributes for algorithms including HOTP, other OTP,
						challenge-response, etc.
</dd>
<dt>R2:</dt>
<dd>The format MUST handle the symmetric key itself as well of attributes that
						are typically associated with symmetric keys. Some of these attributes may
						be 
<ul class="text">
<li>Unique Key Identifier
</li>
<li>Issuer information
</li>
<li>Algorithm ID
</li>
<li>Algorithm mode
</li>
<li>Issuer Name
</li>
<li>Key friendly name
</li>
<li>Event counter value (moving factor for OTP algorithms)
</li>
<li>Time value
</li>
</ul>
					
</dd>
<dt>R3:</dt>
<dd>The format SHOULD support both offline and online scenarios. That is it
						should be serializable to a file as well as it should be possible to use
						this format in online provisioning protocols such as <a class='info' href='#DSKPP'>[DSKPP]<span> (</span><span class='info'>Doherty, A., Pei, M., Machani, S., and M. Nystrom, &ldquo;Dynamic Symmetric Key Provisioning Protocol,&rdquo; February&nbsp;2008.</span><span>)</span></a>
</dd>
<dt>R4:</dt>
<dd>The format SHOULD allow bulk representation of symmetric keys
</dd>
<dt>R5:</dt>
<dd>The format SHOULD allow bulk representation of PINs related to specific keys
</dd>
<dt>R6:</dt>
<dd>The format SHOULD be portable to various platforms. Furthermore, it SHOULD be
						computationally efficient to process.
</dd>
<dt>R7:</dt>
<dd>The format MUST provide appropriate level of security in terms of data
						encryption and data integrity. 
</dd>
<dt>R8:</dt>
<dd>For online scenarios the format SHOULD NOT rely on transport level security
						(e.g., SSL/TLS) for core security requirements.
</dd>
<dt>R9:</dt>
<dd>The format SHOULD be extensible. It SHOULD enable extension points allowing
						vendors to specify additional attributes in the future.
</dd>
<dt>R10:</dt>
<dd>The format SHOULD allow for distribution of key derivation data without the
						actual symmetric key itself. This is to support symmetric key management
						schemes that rely on key derivation algorithms based on a pre-placed master
						key. The key derivation data typically consists of a reference to the key,
						rather than the key value itself.
</dd>
<dt>R11:</dt>
<dd>The format SHOULD allow for additional lifecycle management operations such
						as counter resynchronization. Such processes require confidentiality between
						client and server, thus could use a common secure container format, without
						the transfer of key material.
</dd>
<dt>R12:</dt>
<dd>The format MUST support the use of pre-shared symmetric keys to ensure
						confidentiality of sensitive data elements. 
</dd>
<dt>R13:</dt>
<dd>The format MUST support a password-based encryption (PBE) <a class='info' href='#PKCS5'>[PKCS5]<span> (</span><span class='info'>RSA Laboratories, &ldquo;PKCS #5: Password-Based Cryptography Standard,&rdquo; March&nbsp;1999.</span><span>)</span></a> scheme to ensure security of sensitive data elements.
						This is a widely used method for various provisioning scenarios.
</dd>
<dt>R14:</dt>
<dd>The format SHOULD support asymmetric encryption algorithms such as RSA to
						ensure end-to-end security of sensitive data elements. This is to support
						scenarios where a pre-set shared key encryption key is difficult to use.
					
</dd>
</dl></blockquote><p>
			
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Philip Hoyer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">ActivIdentity, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">117 Waterloo Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">London, SE1  8UL</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">UK</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+44 (0) 20 7744 6455</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Philip.Hoyer@actividentity.com">Philip.Hoyer@actividentity.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mingliang Pei</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">VeriSign, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">487 E. Middlefield Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mountain View, CA  94043</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 650 426 5173</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mpei@verisign.com">mpei@verisign.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Salah Machani</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Diversinet, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2225 Sheppard Avenue East</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Suite 1801</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Toronto, Ontario  M2J 5C2</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 416 756 2324 Ext. 321</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:smachani@diversinet.com">smachani@diversinet.com</a></td></tr>
</table>
</body></html>
