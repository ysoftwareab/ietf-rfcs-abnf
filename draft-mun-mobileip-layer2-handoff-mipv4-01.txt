


                                                             Youngsong Mun
INTERNET-DRAFT                                                Jongjin Park
Expires March 2004                                     Soongsil University
                                                            September 2003


                Layer 2 Handoff for Mobile-IPv4 with 802.11
             <draft-mun-mobileip-layer2-handoff-mipv4-01.txt>


Status of this Memo

This document is an Internet-Draft and is in full conformance with all
provisions of Section 10 of RFC2026.

Internet-Drafts are working documents of the Internet Engineering Task
Force (IETF), its areas, and its working groups.  Note that other groups
may also distribute working documents as Internet-Drafts.

Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any
time.  It is inappropriate to use Internet- Drafts as reference material
or to cite them other than as "work in progress."

The list of current Internet-Drafts can be accessed at
http://www.ietf.org/ietf/1id-abstracts.txt

The list of Internet-Draft Shadow Directories can be accessed at
http://www.ietf.org/shadow.html.





Abstract

Mobile-IPv4 describes how a Mobile Node can perform layer 3 handoff between
subnets served by different Foreign Agents. Sometimes the delay during
handoffs can exceed the threshold of delay sensitive applications. So low
delay must be considered.
This document describes a method to perform  fast handoff on the Layer 2 for
Mobile-IPv4 with 802.11's Access Point. Mobile-IPv4 Registration messages
are carried in the Information Elements of 802.11 frames. According to this
method, Mobile-IPv4 can perform handoff at the same time as 802.11 handoff.
But some modifications must be adopted in the existing Mobile-IPv4 and
802.11's entities such as Mobile Node and Access Point.




Youngsong Mun                  Expire March 2004                     [Page 1]


INTERNET-DRAFT   Layer 2 Handoff for Mobile-IPv4 with 802.11   September 2003


1. Introduction

Mobile-IPv4 describes how a Mobile Node (MN) can perform Layer 3 handoff
between subnets served by different Foreign Agents (FAs). Sometimes the
delay during handoffs can exceed the threshold of delay sensitive
applications. So low delay must be carefully considered. The aim of this
document is to achieve low delay Mobile-IPv4 handoff during movement between
FAs. The proposed method is base on the Layer 2 handoff (802.11's
Association/Reassociation procedure).

In the Mobile-IPv4, when a Mobile-IPv4 (MIP4) MN moves from subnet to
another subnet, MN seeks a Foreign Agent (FA) situated in the subnet and
registers with the FA. The IP packet sent in Registration Message has the
Home IP address as the source, and the destination address can be the FA's
IP address. The FA then responds with Registration Reply Message. The
Registration Message also includes Authentication Extensions.

In the 802.11 wireless LAN network, an 802.11 client connects to an 802.11
Access Point (AP) on the Layer 2. The 802.11 provides a mechanism to achieve
Association/Reassociation procedure between AP's and the client. A 802.11
client first authenticates and then associates with selected AP. When the
802.11 client decides that it is better to move to another AP, it can
carry out a pre-authentication and re-association with that AP.


2. Terminology

The following terminology and abbreviations are used in this document. The
reference network architecture and handover scenario is illustrated in Figure 1.

	AR: Access Router

	MN: Mobile Node

	FA: Foreign Agent

	HA: Home Agent

	BU: Binding Update

	HoA: Home of Address

	CoA: Care of Address

	AP: Access Point

	BSS: Basic Service Set

	ESS: Extended Service Set

	SSID: Service Set ID

	IE: Information Element



Youngsong Mun                  Expire March 2004                     [Page 2]


INTERNET-DRAFT   Layer 2 Handoff for Mobile-IPv4 with 802.11   September 2003




                                 [FA1]
                                   |
         V      ....... [AP1]----  |
        [MN]...           |     |------[AR1]--|
         V      ....... [AP2]----             |---------> [HA]
         V                                    |
         V      ....... [AP3]----------[AR3]--|
                                  |
                                [FA3]
        ...  - 802.11 link
        ---  - 802.3  link

               Figure 1. Reference Network Architecture




3. Protocol Overview

3.1 Technique

The Figure 1 shows the scenario when MN moves from AP1 to AP2 (movement
from one BSS to another BSS within the same ESS) and continuously move from
AP2 to AP3 (movement from a BSS in one ESS to a BSS within another ESS).
Because the same ESS means same subnet, the transition from AP1 to AP2
handoff means that the MN is in the same subnet. Therefore MIPv4 registration
is not necessary. But, in this time, the MN only knows that here is different
BSS because of detecting a newer and stronger beacon signal from another BSS.
Hence this document present that if any transitions between BSSs are occurred
then MN always sends Registration Request Message within 802.11 Association
/Reassociation Request Message. It is achieved by substitute 802.11
Information Element with MIPv4 Registration Request Message. This idea is
pointed out from draft about simultaneous handoff [5]. But there is some
drawback. The first one is that AP must have the ability of layer 3 mechanism
and the other one is that Association/Reassociation delay time may be long
inadequately. Thus we suggest more feasible to implement and more shorter
Association/Reassociation delay time than [5].

When the AP acquires MIPv4 Registration Request Message from the 802.11
Association/Reassociation Request Message, the AP rearrange this information
to the 802.3 frame and then send to the assigned FA. If FA knows that MN has
been already registered then FA responds with MIPv4 Registration Reply
Message to the MN directly (bypass AP) which can be generated without
exchange message sequence from FA to HA. Else if FA knows that MN is unknown
then FA responds with MIPv4 Registration Reply Message to the MN directly
(bypass AP) which can be generated with exchange message sequence from FA
to HA.








Youngsong Mun                  Expire March 2004                     [Page 3]


INTERNET-DRAFT   Layer 2 Handoff for Mobile-IPv4 with 802.11   September 2003


3.2 Handoff Message Timing

MN                                AP1     AP2     AP3    FA1    FA2    HA

 ---- 802.11 Authentication Request ------>
 
 <--- 802.11 Authentication Response ------
.
.
.

 ----- 802.11 Reassociation  Request ----->
     (MIPv4 Registration IE included)

 <---- 802.11 Reassociation  Response -----

                                         MIPv4 Registration
                                          ----------------->
 <----------------------------- MIPv4 Reply ----------------

   802.11 Dissociation Request
 --------------------------------->
 .
 .
 .
 ------ 802.11 Reassociation  Request ------------>
      (MIPv4 Registration IE included)
 
 <------ 802.11 Reassociation  Response -----------
                                              MIPv4 Registration
                                                   ------------->
                                                               MIPv6 BU
                                                                <----->
 <----------------------------------------- MIPv4 Reply ---------------

 ---------- 802.11 Dissociation Request ---------->
 
	          Figure 2. Handoff Message Timing Diagram


When the MN moves from AP2 to AP3 there is a change of the serving FA, 
hence FA3 now needs to execute a FA-HA message exchange. 



4. MIPv4 BU Message in 802.11 Management Frames

The 802.11 Association/Reassociation frames are shown in the Figure 3.
The Association/Reassociation frames carry an MIPv4 Registration Request
Message as information element optionally. The MIPv4 Registration Request
Message is contained in the 802.11 Association/Reassociation Request Messages.
The MIPv4 Registration Reply Message is sent to the MN directly and is
independent with the 802.11 Association/Reassociation Response messages.




Youngsong Mun                  Expire March 2004                     [Page 4]


INTERNET-DRAFT   Layer 2 Handoff for Mobile-IPv4 with 802.11   September 2003




    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Frame Control          |         Duration              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Destination Address                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        Destination Address    |         Source Address        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Source Address                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Transmitter Address                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |       Transmitter Address     |         Sequence Control      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   .                                                               .
   +                MIPv4 Registration Request IE                  +
   .                                                               .
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Frame Check Sequence                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

	      Figure 3. 802.11 (Re) Association Request Frame




The MIPv4 Registration Request IE with a unique Element ID. The 802.11
Information Element consists of the following fields: Element ID, Length ID, and
Information. The length field is 1 octet long and specifies the length of the
information field in number of octets. The information field is consisted with
MIPv4 Registration Request Message.

In the Figure 4, the Home Address is the IP address of the MN. The Home Agent is
the IP address of the MN's HA. The Care of Address is the IP address for the tunnel
endpoint. The Identification is a 64-bit number constructed by the MN and used for
matching registration requests with registration replies, as well as for protecting
against replay attacks of registration messages.














Youngsong Mun                  Expire March 2004                     [Page 5]


INTERNET-DRAFT   Layer 2 Handoff for Mobile-IPv4 with 802.11   September 2003


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                   |  Element ID   |    Length     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |S|B|D|M|G|V|rsv|          Lifetime             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Home Address                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Home Agent                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Care-of Address                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                         Identification                        +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Extensions ...
   +-+-+-+-+-+-+-+-

           Figure 4. MIPv4 Registration Request IE of 802.11

The FA determines the Layer 2 address of the Request message that came from and
after receiving a reply message from the HA, the FA sends the reply message to this
Layer 2 address. The FA must not use the ARP response for this Layer 2 address.


5. Considerations

There are some considerations for the mobile entities.

5.1 Considerations for MN

The MN should have capability of passing the MIPv4 information to the 802.11 
driver and vice-versa. At the instant the MN is ready to send an Association/
Reassociation Request it should be able to access the MN's MIPv4 attributes.
But, the recieved MN's MIPv4 Registration Reply Message is independent within the
802.11 Association/Reassociation Response Message.

5.2 Considerations for 802.11 AP

The 802.11 AP must have FA's MAC address information and be able to extract/
rearrange the MIPv4 Registration Request IE.

When the FA is an independent entity (separate with AP) with its own IP address,
the situation is more difficult. Because the AP behaves only Layer 2 device,
so they do not understand FA's Advertisement Message.

The simple method to overcome this problem is to use install program of AP.
This program acquires FA's information through FA's Advertisement Message or
manual input.

After registration is complete, the MN would send periodic ICMP Registration
Request directly to the FA which would be carried by regular 802.11 Data Frames.


Youngsong Mun                  Expire March 2004                     [Page 6]


INTERNET-DRAFT   Layer 2 Handoff for Mobile-IPv4 with 802.11   September 2003


6. Acknowledgments

All the RFCs, IDs, freely available 802.11 standards, and web-sites.
Specially thanks for Goswami's ID for simultaneous handoff of MIPv4.


7. References

[1] IEEE, "Part 11: Wireless LAN Medium Access Control (MAC) and 
Physical Layer (PHY) Specifications", 1999.

[2] Mustafa Ergen, "IEEE 802.11 Tutorial," June 2002.

[3] Bob Conner, "IEEE 802.11 and HIPERLAN WIRELESS LANs: An Overview and
Comparison," April 2000.

[4] Perkins, C., "IP Mobility Support", RFC 3220, January 2002.

[5] Subrata Goswami, "Simultaneous Handoff of Mobile-IPv4 and 802.11",
draft-goswami-mobileip-simultaneous-handoff-v4-02.txt", February 4, 2003.

8. Contact Information

     Jongjin Park                           Youngsong Mun
     Soongsil University                    Soongsil University
     Seoul Korea                            Seoul Korea
     spel@sunny.soongsil.ac.kr              mun@computing.ssu.ac.kr


This document expires March 2004.
























Youngsong Mun                  Expire April 2003                     [Page 7]
