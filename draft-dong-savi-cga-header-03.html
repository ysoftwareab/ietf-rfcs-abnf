<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Cryptographically Generated Address (CGA) Extension Header for Internet Protocol version 6 (IPv6)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Cryptographically Generated Address (CGA) Extension Header for Internet Protocol version 6 (IPv6)">
<meta name="keywords" content="CGA, Cryptographically Generated Addresses, IPv6, Internet Protocol Version 6">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. Zhang</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">P. Nallur</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Huawei Symantec</td></tr>
<tr><td class="header">Expires: January 13, 2011</td><td class="header">M. Wasserman</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Painless Security</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 12, 2010</td></tr>
</table></td></tr></table>
<h1><br />Cryptographically Generated Address (CGA) Extension Header for Internet Protocol version 6 (IPv6)<br />draft-dong-savi-cga-header-03.txt</h1>

<h3>Abstract</h3>

<p>
This document specifies an IPv6 extension header called the
Cryptographically Generated Address (CGA) Extension Header.  The CGA
Extension Header holds the CGA parameters associated with the source
CGA of an IPv6 packet. This information can be used to validate that a
particular packet was sent by the node associated with a specific CGA,
enabling secure IPv6 address-based access control mechanisms.

</p>
<h3>Status of This Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on January 13, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Requirements Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
Secure Node-Based Access Control<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Use Cases<br />
<a href="#anchor5">4.</a>&nbsp;
Issues with the CGA Extension Header<br />
<a href="#anchor6">5.</a>&nbsp;
CGA Extension Header Definition<br />
<a href="#anchor7">6.</a>&nbsp;
CGA Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">6.1.</a>&nbsp;
CGA Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">6.2.</a>&nbsp;
CGA Params<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">6.3.</a>&nbsp;
CGA Signature<br />
<a href="#anchor11">7.</a>&nbsp;
Packet Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">7.1.</a>&nbsp;
Sending a CGA Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">7.2.</a>&nbsp;
Receiving a CGA Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">7.3.</a>&nbsp;
Sending CGA Params<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">7.4.</a>&nbsp;
Sending a CGA Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">7.5.</a>&nbsp;
Receiving CGA Params and CGA Signature<br />
<a href="#anchor17">8.</a>&nbsp;
ICMP Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">8.1.</a>&nbsp;
Verification Failure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">8.2.</a>&nbsp;
Option Errors<br />
<a href="#anchor20">9.</a>&nbsp;
Source Address Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">9.1.</a>&nbsp;
Initiator Verifying Responder&rsquo;s Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">9.2.</a>&nbsp;
Responder Verifying Initiator&rsquo;s Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">9.3.</a>&nbsp;
Bidirectional Verification<br />
<a href="#anchor24">10.</a>&nbsp;
Discussion<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">10.1.</a>&nbsp;
MTU and Fragmentation Issues<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">10.2.</a>&nbsp;
Strength of Security<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">10.3.</a>&nbsp;
Costs of Verification<br />
<a href="#anchor28">11.</a>&nbsp;
Security Considerations<br />
<a href="#anchor29">12.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor30">13.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">14.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">14.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">14.2.</a>&nbsp;
Informative References<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
A Cryptographically Generated Address (CGA) is an IPv6 address that
has been generated using a cryptographic key
<a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a>. CGAs were originally designed for use in the
SEcure Neighbor Discovery (SEND) protocol <a class='info' href='#RFC3971'>[RFC3971]<span> (</span><span class='info'>Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;SEcure Neighbor Discovery (SEND),&rdquo; March&nbsp;2005.</span><span>)</span></a>,
where they are used to verify that SEND messages have been signed by their
source CGA owners without the need for any additional security
infrastructure.  The SEND verification mechanism depends on a set of
CGA parameters that are associated with each CGA and included in every
SEND packet.

</p>
<p>
This document specifies a method to carry CGA parameters in an IPv6
extension header to allow similar verification of IPv6 source CGAs
across the Internet. This document specifies the details of an IPv6
CGA Extension Header containing the CGA parameters and ICMP message to
report related errors.  The CGA parameters can be used by any host
along the path to verify that an IPv6 packet was sent by the owner of
the source CGA.

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Requirements Terminology</h3>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in
<a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.

</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Secure Node-Based Access Control</h3>

<p>
A node-based (or IP address-based) access control list (ACL)
conceptually consists of a list of nodes, specified by IP addresses or
fully-qualified domain names (FQDNs).  The ACL indicates which nodes
are authorized to access a resource or perform a task.  The IETF
discourages the use of node-based ACLs, because they are inherently
insecure -- it is trivial, in many cases, to send a packet from one
node that uses the IP source address of another node.  However, ACLs
are still widely used in networks today, because of their conceptual
simplicity and their ease of configuration.

</p>
<p>
By using the IPv6 CGA Extension header to verify that an IPv6 packet
was sent by the node that owns the source IP address in use, it is
possible to greatly improve the security of a traditional ACL.
Without any additional security infrastructure or configuration, it is
possible to securely verify that a packet was sent by the node that
owns the authorized IPv6 source address. 

</p>
<p>
Given the ability to verify that a particular packet was sent by the
owner of its source CGA, it may also be possible to simplify or
improve other types of access control mechanisms.

</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Use Cases</h3>

<p>
Some example use cases for the CGA Extension Header include:
		</p>
<ul class="text">
<li>
Printer access control lists (ACLs), or similar ACLs, could be
configured with a list of IP addresses.  Access from a specific node
would be authorized by placing a CGA owned by that node into the ACL.
Nodes that wish to gain access would use their authorized CGA as the
source address of a packet containing the CGA Extension Header, and
the mechanism described in this document would be used to verify that
each access attempt originated with the owner of the source CGA,
before that CGA is checked against the ACL, and appropriate access is
granted.  This would substantially improve the security of simple
ACLs, without requiring additional configuration, and without
requiring any additional security infrastructure.

</li>
<li>
Multicast replicators could be configured with a set of authorized
CGA addresses.  Packets would not be replicated unless the source
address was verified, thus preventing the flooding of unauthorized
flows.

</li>
<li>
In cellular or wireless networks with limited radio bandwidth, the
edge node that interfaces between the radio network and the wireline
network could verify the signature in each packet. Unverified packets
could be dropped, conserving valuable bandwidth.

</li>
<li>
This mechanism could be used to validate that syslog messages or 
SNMP traps have been received from an authorized sender before logging
them to disk or taking any corresponding action.

</li>
<li>
RADIUS configuration for infrastructure nodes (routers, switches,
etc.) could be substantially simplified. There are no individual
users on most of these devices, and today many RADIUS servers are
configured to share a password between a set of devices, thus
compromising security.  Instead, configuration could be reduced to
configuring a list of CGA addresses for which access should be allowed.

</li>
<li>
Dynamic DNS updates could be substantially simplified for CGA
addresses, as it should be possible to allow the verified owner of a
CGA to update the corresponding entry directly.

</li>
</ul><p>

</p>
<p>
All of the examples above would require implementation changes in
order to take effect.  In some cases, such as the RADIUS and DDNS
cases, protocol changes would  also be required.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Issues with the CGA Extension Header</h3>

<p>
The CGA Extension Header mechanism does have a few limitations that
affect its applicability in some cases.  Specifically:
</p>
<ul class="text">
<li>
CGA addresses only offer limited security. The cryptographic strength
of CGA addresses makes it 2**59 times harder to forge an address than
to generate a new address.  This mechanism should only be used in
cases where that level of security is acceptable and/or represents a
considerable improvement over current practice.

</li>
<li>
Using CGAs, it is necessary to specify each CGA separately in an
access control list, as opposed to assigning address ranges.  It
doesn't work to assign address ranges because the prefix portion of a
CGA is not cryptographically generated, and CGA IIDs are randomly
distributed across the IID space.

</li>
<li>
CGA verification is a costly process. There is a substantial cost on
the sender side to generate the per-packet signature, and a similar
cost on the receiving side to perform the verification. The utility of
this mechanism is limited to cases where those costs are justified
and/or acceptable.

</li>
</ul><p>

</p>
<p>
Some ideas about how to address the above issues are discussed in the 
"Discussion" section below.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
CGA Extension Header Definition</h3>

<p>
The base IPv6 specification <a class='info' href='#RFC2460'>[RFC2460]<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> defines several
extension headers and makes recommendations about how future extension
headers should be defined.  It also makes recommendations about the
order in which extension headers should appear in IPv6 packets.

</p>
<p>
An IPv6 node that implements the CGA Extension Header defined in this
document would be expected to implement, at minimum, the following IPv6
Extension Headers:
        </p>
<blockquote class="text"><dl>
<dt></dt>
<dd>Hop-by-Hop Options Header
</dd>
<dt></dt>
<dd>Destination Options Header
</dd>
<dt></dt>
<dd>Routing Header
</dd>
<dt></dt>
<dd>Fragment Header
</dd>
<dt></dt>
<dd>CGA Extension Header
</dd>
<dt></dt>
<dd>Authentication Header
</dd>
<dt></dt>
<dd>Encapsulating Security Payload Header
</dd>
<dt></dt>
<dd>Destination Options Header
</dd>
<dt></dt>
<dd>Upper-Layer Header
</dd>
</dl></blockquote><p>

</p>
<p>
When more than one extension header appears in an IPv6 packet, it is
recommended that they appear in the order indicated above.  Note that
the CGA Extension header is currently defined to appear inside the
Fragment Header.  This has the implication that intermediate nodes
cannot count on receiving a full CGA Extension Header in an IPv6
fragment.  The trade-offs related to this choice are discussed in the
"Discussion" section below.

</p>
<p>
The CGA Extension Header MUST NOT be displayed in the extension header of a
packet more than once.

</p>
<p>
The CGA Extension Header is comprised of the following fields:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |  Next Header  |  Hdr Ext Len  |            Reserved           |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  .                                                               .
  .                            Options                            .
  .                                                               .
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  Next Header     8-bit selector. Identifies the type of the header
                  immediately following the CGA Extension Header.
  Hdr Ext Len     8-bit unsigned integer. Length of the header
                  in 8-octet units, excluding the first 8 octets.
                  When the value of Hdr Ext Len is zero, it means
                  that this information is for CGA initialization.
  Reserved        A 16-bit field reserved for future use. The value
                  MUST be initialized to zero by the sender and MUST
                  be ignored by the receiver.
  Options         Variable-length field.  The length of this field,
                  in octets, is determined by multiplying the value
                  of the "Hdr Ext Len" field by 8 and adding 4.
                  Contains one or more TLV-encoded options, as described
                  in section 4.2 of [RFC2460].
</pre></div>
<p>
The Options field contains three types of options: a CGA Request, CGA
Params and/or a CGA Signature. A CGA Request is used to ask the
counterpart for CGA Params; the CGA Params option carries a CGA
parameters data structure; and a CGA Signature contains the signature
produced by the host using its private key. CGA Params MUST be
accompanied with a CGA Signature, otherwise the receiver SHOULD
respond with an ICMP error message. A packet MAY include CGA Signature
only when CGA Params is sent. How the node handles the CGA Params in
the packet before receiving CGA Request depends on the host's policy.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
CGA Options</h3>

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
CGA Request</h3>

<p>
Any node can ask its peer for CGA Params by sending a CGA Request in the
packet. The node that receives a packet containing a CGA Request, MAY
respond with its own CGA Params and CGA Signature. A CGA Request has
the following format:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |      Type     |    Length     |            Reserved           |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                         Sequence Number                       |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  Type            8-bit unsigned integer. Type code for CGA Request.
                  The value is TBD2.
  Length          The length of the option (including the Type,
                  Length, Reserved and Sequence Number) in units of
                  byte.
  Reserved        An 24-bit field reserved for future use. The value
                  MUST be initialized to zero when sending, and
                  SHOULD be ignored on receipt.
  Sequence Number 32-bit unsigned integer containing a counter value
                  that is initialized to a random number and increases
                  by one for each packet sent. It may enable an
                  anti-replay service.
</pre></div>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
CGA Params</h3>

<p>
The CGA Params option carries CGA parameters that the receiver can
use to validate the source CGA. The format of the CGA Params is
described in the following diagram:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |      Type     |    Length     |   Pad Length  |    Reserved   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                         Sequence Number                       |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  .                                                               .
  .                         CGA Parameters                        .
  .                                                               .
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  .                             Padding                           .
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  Type            8-bit unsigned integer. Type code for CGA Params.
                  The value is TBD3.
  Length          8-bit unsigned integer. The length of the option
                  (including the Type, Length, Pad Length, Reserved,
                  Sequence Number, CGA Parameters, and Padding
                  fields) in 8-octet units.
  Pad Length      8-bit unsigned integer. The number of padding
                  octets beyond the end of the CGA Parameters field
                  but within the length specified by the Length
                  field.
  Reserved        An 8-bit field reserved for future use.  The value
                  MUST be initialized to zero by the sender and MUST
                  be ignored by the receiver.
  Sequence Number 32-bit unsigned integer. If the CGA Params
                  option was sent in response to a CGA Request,
                  this field matches he sequence number in the
                  request.  Otherwise, it SHOULD be set to zero.
  CGA Parameters  A variable-length field containing the CGA
                  Parameters data structure described in Section 2
                  of [RFC3972].
  Padding         A variable-length field making the option length a
                  multiple of 8, containing as many octets as
                  specified in the Pad Length field. The contents of
                  padding MUST be set to zero on sending and
                  ignored on receipt.
</pre></div>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
CGA Signature</h3>

<p>
The CGA Signature option contains the digital signature calculated
by he sender. It is formatted as follows:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |      Type     |    Length     |   Pad Length  |    Reserved   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  .                                                               .
  .                       Signature                               .
  .                                                               .
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  .                           Padding                             .
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  Type            8-bit unsigned integer. Type code for CGA
                  Signature. The value is TBD4.
  Length          The length of the option (including the Type,
                  Length, Pad Length, Reserved, Sequence Number, CGA
                  Signature, and Padding fields) in units of 8-octets.
  Pad Length      8-bit unsigned integer. The number of padding
                  octets beyond the end of the CGA Signature field
                  but within the length specified by the Length field.
  Reserved        8-bit unsigned integer. An 8-bit field reserved for
                  future use. The value MUST be initialized to zero
                  by the sender and MUST be ignored by the receiver.
  Signature       A variable-length field containing the signature
                  which is produced by the private-key.
  Padding         A variable-length field making the option length a
                  multiple of 8, containing as many octets as
                  specified in the Pad Length field.  The contents
                  MUST be set to zero when sending and MUST be
                  ignored on receipt.
</pre></div>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Packet Processing</h3>

<p>
This section describes how CGA Extension Headers are generated and
processed.

</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Sending a CGA Request</h3>

<p>
To send a CGA Request packet, the host generates a new Sequence
Number, and formats the packet as described in section 3.1. 

</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Receiving a CGA Request</h3>

<p>
When a host receives a packet containing a CGA Request, it MAY send
CGA Params and CGA Signature to its peer as a response.  Whether or
not to send a response is determined by local policy or configuration.

</p>
<p>
If the host responds to the CGA Request, it must set the Sequence
Number of the CGA Params option to the Sequence Number received in
the CGA Request.

</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Sending CGA Params</h3>

<p>
The CGA parameters should be generated using the procedure defined in
Section 4 of <a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a>.  The public key carried 
in the CGA Params must correspond to the private key used to generate
the digital signature.

</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Sending a CGA Signature</h3>

<p>
When sending a CGA Signature, the host must calculate the digital
signature value using the procedure described here.

</p>
<p>
The contents to be signed contain the following parts concatenated
from left to right:
  </p>
<ol class="text">
<li>The CGA Extension Header signature type tag (128-bits);
</li>
<li>The 128-bit source address in the IP header;
</li>
<li>The 128-bit destination address in the IP header;
</li>
<li>All parts of CGA Extension Header except the CGA Signature;
</li>
<li>The payload of the packet (transport and higher layers).
</li>
</ol><p>

</p>
<p>
The resulting data is signed using an RSA signature, and the signature
is placed in the Signature field.  The signature is generated largely
as described in <a class='info' href='#RFC3971'>[RFC3971]<span> (</span><span class='info'>Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;SEcure Neighbor Discovery (SEND),&rdquo; March&nbsp;2005.</span><span>)</span></a> section 5.2.  TBD: Need to
describe the procedure in detail and specify a signature type tag for
the CGA Extension Header here.  Pick up algorithm agility work from 
CSI?

</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
Receiving CGA Params and CGA Signature</h3>

<p>
After the host receives the packet with CGA Params and CGA Signature,
it MAY verify the signature, thus authenticating the source
CGA. Whether or not the host performs the verification procedure on a
specific packet is based on policy and/or configuration. The
verification procedure consists of the following steps:
  </p>
<ol class="text">
<li>
If a host receives a packet corresponding to an outstanding CGA
Request, it checks if the Sequence Number is zero (meaning this is not
a response).  If so, it continues to the next step.  If the Sequence
number is non-zero, it compares the received Sequence Number with the
Sequence Numbers of recently sent CGA Requests.  If the Sequence
Number matches a previous request, go to the next step. Otherwise, the
host MUST drop the packet and send an ICMP message.

</li>
<li>
The host MAY use the CGA parameters and signature to verify the source
CGA of the packet. The verification procedure is given in Section 5
of <a class='info' href='#RFC3972'>[RFC3972]<span> (</span><span class='info'>Aura, T., &ldquo;Cryptographically Generated Addresses (CGA),&rdquo; March&nbsp;2005.</span><span>)</span></a>. If the verification succeeds, go to
the next step. Otherwise, the host MUST drop the packet, which leads
to the generation of an ICMP message.

</li>
<li>
The inputs of the signature verification operation are the public key,
which is a part of the CGA parameters data structure, the
concatenation created in Section 3.1 and the signature. If the
signature verification succeeds, the host should continue to process
the packet as usual.  If it fails, the host MUST drop the packet and
send an ICMP message.

</li>
</ol><p>

</p>
<p>
Certain errors MAY result in dropping the packet and sending ICMP messages:
  </p>
<ol class="text">
<li>The CGA header contains only CGA Params rather than CGA Signature;
</li>
<li>The CGA header contains only CGA Signature rather than CGA Params;
</li>
<li>The host sends the CGA Request, however, the returned packet does not 
       contain CGA Params and CGA Signature.
</li>
</ol><p>

</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
ICMP Messages</h3>

<p>
TBD: ICMP errors and related behavior will need to be defined in more detail.

</p>
<p>
When the CGA header of IPv6 is deployed and certain errors occur, ICMP
messages are required to report errors to the source host. In addition
to the problems described in <a class='info' href='#RFC4443'>[RFC4443]<span> (</span><span class='info'>Conta, A., Deering, S., and M. Gupta, &ldquo;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification,&rdquo; March&nbsp;2006.</span><span>)</span></a>, CGA
header has following types of errors.

</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Verification Failure</h3>

<p>Verification failure MAY be caused by the following:
	</p>
<ol class="text">
<li>Sequence Number error;
</li>
<li>CGA verification error;
</li>
<li>Signature verification error.
</li>
</ol><p>
	
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Option Errors</h3>

<p>
The three type option errors described at the end of Section 4.2 also MAY generate ICMP messages.

</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Source Address Verification</h3>

<p>
This mechanism supports both one-way and bi-directional verification.
In this section, we denote the two ends of the verification process as
the Initiator and the Responder, and we present all three verification
scenarios.

</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Initiator Verifying Responder&rsquo;s Address</h3>

<p>
The following picture shows a typical exchange when the initiator
verifies the address of the responder.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         Initiator                              Responder

                           CGA Request
                   --------------------------&gt;

                       CGA Params, CGA Sig
                   &lt;-------------------------
</pre></div>
<p>
The initiator sends CGA Request in the message to require the CGA
parameters of the responder. After receiving the request, the
responder returns its own CGA Params and CGA Signature to the
initiator. The processing rules and verification process are given in
Section 4.1 and Section 4.2 respectively.

</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
Responder Verifying Initiator&rsquo;s Address</h3>

<p>
The responder can also verify the address of the
initiator. Conceptually, the process can be represented by the
following message sequence.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         Initiator                              Responder

                         NULL CGA HEADER
                   --------------------------&gt;

                           CGA Request
                   &lt;-------------------------

                       CGA Params, CGA Sig
                   --------------------------&gt;

</pre></div>
<p>
A packet with a NULL CGA Extension Header coming from the initiator
implies that the initiator may support CGA verification. After
receiving the null CGA Extension Header, the responder sends a CGA
Request to the initiator. Then the initiator sends its CGA Params and
CGA Signature in a response, which is used to verify the initiator's
address by the responder.

</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
Bidirectional Verification</h3>

<p>
In certain cases, the hosts need to verify the address of each
other. The figure below illustrates the basic exchange.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         Initiator                              Responder

                         NULL CGA HEADER
                   --------------------------&gt;

                           CGA Request
                   &lt;-------------------------

                  CGA Params, CGA Sig, CGA Request
                   --------------------------&gt;

                        CGA Params, CGA Sig,
                   &lt;-------------------------
</pre></div>
<p>
A packet with null CGA Extension Header coming from the initiator
implies that the sender may support CGA verification. After receiving
the NULL CGA Extension Header in the message, the responder sends CGA
Request to the initiator. Then the initiator transfers the message
containing its CGA Params, CGA Signature and CGA Request. The last
message with CGA Params and CGA Signature of the responder is to allow
the initiator to verify the responder's address.

</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Discussion</h3>

<p>
There are a number of architectural issues and tradeoffs in the design
of this mechanism that might benefit from further discussion and
consideration.  This section attempt to outline those issues at a
fairly high level in the hope of generating discussion within the IETF
on these topics:

</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
MTU and Fragmentation Issues</h3>

<p>
As this document is currently written, the CGA Fragmentation Header
appears after the IPv6 Fragment Header.  This allows us to avoid MTU
issues, because a long CGA Extension Header would be fragmented, as
necessary, to fit on the link.  However, it means that intermediate
nodes are not guaranteed to see a full CGA Extension Header,
potentially limiting the use cases of this mechanism.  If there is
interest in this approach, we should further discuss these tradeoffs.

</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
Strength of Security</h3>

<p>
As discussed in Section 7.2 of RFC 3972, an attacker has to do 2**59
times as much work as the holder of a CGA in order to forge a given
CGA. This may provide inadequate security for many potential uses of
this mechanism.

</p>
<p>
There are some approaches that could be used to increase the security
strength of CGAs.  For instance, it might be possible to increase the
length of the cryptographically-generated portion of the CGA, in cases
where the prefix length allow sufficient room to do so.  It might also
be possible for higher-level protocols to introduce additional bits of
security into the algorithm.  Work on these, or other, approaches to 
increase the security of this mechanism could be considered if there
is interest in the general approach.

</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.3"></a><h3>10.3.&nbsp;
Costs of Verification</h3>

<p>
Generating and verifying the digital signatures are both high cost
operations.  The costs of generating and/or verifying the source CGA
of every packet would make this mechanism too costly for many
applications.  The mechanism includes the a method to explicitly
request this information, but there is no guidance on when/how to use
it.

</p>
<p>
It might be possible to use this mechanism in concert with another,
lower costs security mechanism.  For example, the CGA Extension Header
could be used to verify that the remote node owns a particular CGA
before using that CGA to determine and IPsec SA that will be used to
protect the rest of the session.

</p>
<p>
The ability for a remote host to prompt a costly operation in a local
host by sending a single packet represents a potential DoS attack.  We
might want to consider a preliminary challenge/response operation or
some other mechanism to ensure that prompting this operation in a
local host requires at least as much processing by the remote host.

</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Considerations</h3>

<p>
This specification defines a mechanism to use CGAs for access
control. The RSA signature in a packet can be used to confirm that the
packet is generated by the holder of the private key associated with
the CGA. If a resource is authorized to a CGA and the signature is
checked, then the node providing the resource has confidence that the
resource is being accessed by the holder of the CGA. Implementations
MUST provide a mechanism for indicating which addresses require
signatures and signature verification. The security of authorization
depends critically on the correct usage of this mechanism. If an
address is added to an access-control list but not to the list of
addresses requiring signature verification, then an attacker may gain
access to the protected resource by spoofing this address.

</p>
<p>
Unlike a traditional IP-based access-control list, this mechanism does
not permit ranges of IP addresses. An attacker could potentially
generate an address within a given range and legitimate users are
unlikely to have addresses in any given range. For this reason,
security depends on authorizing each address separately.

</p>
<p>
As discussed in Section 7.2 of RFC 3972, an attacker has to do 2**59
times as much work as the holder of a CGA in order to forge a given
CGA. The work can be increased for an attacker at the expense of
making address generation harder for legitimate users. For some
applications, the work factor of 2**59 address generations to forge a
given address may provide insufficient security. The CGA extension
header is not a good approach for these applications.

</p>
<p>
Section 7.4 of RFC 3972 discusses security concerns when CGAs are used
for protocols other than SEND. Of particular note, RSA keys of
384-bits are inappropriate for the CGA extension header. Keys of at
least 2048-bits in length SHOULD be used.

</p>
<p>
This mechanism only secures access-control based on IP address. If
another insecure mechanism is used to determine authorized source
addresses, then attacks on that mechanism result in attacks on the
authorization. For example if DNS is used to lookup the addresses of
nodes to populate an access-control list, then attacks on the
integrity of DNS will result in attacks of the security of this
mechanism used along-side DNS.

</p>
<p>
CGA extension header signatures can be expensive to verify.
Understanding how to prevent denial of service attacks against the CGA
header mechanism is ongoing work.

</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
IANA Considerations</h3>

<p>
This document specifies a new type of IPv6 extension header, whose
value is to be allocated:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Value Next Header Name Reference
      ------  -------------------------------  ---------
      TBD1    CGA Header                       [this doc]
</pre></div>
<p>
This document defines three new options in the CGA Header. A new
namespace is required to be assigned by IANA and the values of these
options are to be allocated:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Value   Option Name                      Reference
      ------  -------------------------------  ---------
      TBD2    CGA Request                      [this doc]
      TBD3    CGA Params                       [this doc]
      TBD4    CGA Signature                    [this doc]
</pre></div>
<p>
The above assignation of the three CGA options SHOULD also be used in
destination extension header and identified by the any host.

</p>
<p>
This document also defines two new types of ICMP messages whose values
are to be allocated from the namespace of ICMP Type Numbers:

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Value   Name                             Reference
      ------  -------------------------------  ---------
      TBD5    Verification Failure             [this doc]
      TBD6    Option Errors                    [this doc]
</pre></div>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Acknowledgements</h3>

<p>
The authors would like to thank the following people for their
contributions to this document: Sam Hartman.

</p>
<p>
Margaret Wasserman's contributions to this document were funded by
Huawei Symantec.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>14.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2460">[RFC2460]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a> and <a href="mailto:hinden@iprg.nokia.com">R. Hinden</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;2460, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2460.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2460.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2460.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3972">[RFC3972]</a></td>
<td class="author-text">Aura, T., &ldquo;<a href="http://tools.ietf.org/html/rfc3972">Cryptographically Generated Addresses (CGA)</a>,&rdquo; RFC&nbsp;3972, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3972.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4443">[RFC4443]</a></td>
<td class="author-text">Conta, A., Deering, S., and M. Gupta, &ldquo;<a href="http://tools.ietf.org/html/rfc4443">Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;4443, March&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4443.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>14.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3704">[RFC3704]</a></td>
<td class="author-text">Baker, F. and P. Savola, &ldquo;<a href="http://tools.ietf.org/html/rfc3704">Ingress Filtering for Multihomed Networks</a>,&rdquo; BCP&nbsp;84, RFC&nbsp;3704, March&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3704.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3971">[RFC3971]</a></td>
<td class="author-text">Arkko, J., Kempf, J., Zill, B., and P. Nikander, &ldquo;<a href="http://tools.ietf.org/html/rfc3971">SEcure Neighbor Discovery (SEND)</a>,&rdquo; RFC&nbsp;3971, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3971.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dong Zhang</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei Symantec</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3rd Floor,Section D, Keshi Building, No.28, Xinxi Rd., Shangdi</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">HaiDian district, Beijing</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86-10-62721287</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:zhangdong_rh@huaweisymantec.com">zhangdong_rh@huaweisymantec.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Padmanabha Nallur</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei Symantec</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">20245 Stevens Creek Blvd., Suite 100</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cupertino, California</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:paddy@huaweisymantec.com">paddy@huaweisymantec.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Margaret Wasserman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Painless Security</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">356 Abbott Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">North Andover, MA</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-781-405-7464</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:mrw@painless-security.com">mrw@painless-security.com</a></td></tr>
</table>
</body></html>
