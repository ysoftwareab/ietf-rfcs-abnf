6lo                                                               C. Pu
Internet Draft                                                  Y. Wang
Intended status: Standards Track                                H. Wang
Expires: March 25, 2019                                         Y. Yang
                                                                P. Wang
                                                Chongqing University of
                                           Posts and Telecommunications
                                                     September 21, 2018


                Multipath Transmission for 6LoWPAN Networks
                  draft-pu-6lo-multipath-transmission-03


Abstract

   This document provides a multipath transmission method for 6LoWPAN
   Networks, which can effectively provide the transmission redundancy
   for packets. It is suitable for high-reliability networks,
   especially for IPv6-based industrial wireless scenarios.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six
   months and may be updated, replaced, or obsoleted by other documents
   at any time. It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   This Internet-Draft will expire on March 25, 2019.








Pu, et al.             Expires March 25, 2019                 [Page 1]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2018


Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors. All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with
   respect to this document. Code Components extracted from this
   document must include Simplified BSD License text as described in
   Section 4.e of the Trust Legal Provisions and are provided without
   warranty as described in the Simplified BSD License.

Table of Contents

   1. Introduction ................................................ 2
   2. 6LoWPAN Multipath Header Format.............................. 3
   3. Architecture ................................................ 3
   4. Number of Paths Destination.................................. 4
   5. Multipath Distribution....................................... 5
   6. Packet Replication and Elimination........................... 7
   7. Security Considerations...................................... 8
   8. IANA Considerations ......................................... 8
   9. References .................................................. 8
      9.1. Normative References.................................... 8
      9.2. Informative References.................................. 9
   Authors' Addresses ............................................ 10

1. Introduction

   6LoWPAN can deploy large-scale and high-density wireless personal
   area network devices with its high popularity, applicability, and
   more address space. However, due to the low processing power, the
   limited energy and the poor communication environment of the 6LoWPAN
   network, packets are easily lost during transmission, which causes
   transmission failure. The use of multipath packet transmission
   technology in 6LoWPAN is of great significance for improving
   communication reliability and transmission performance. It is well
   known that RPL as a routing protocol standardized by IETF, is an
   efficient distance vector protocol for wireless sensor networks,
   which has designed a series of new mechanisms [RFC6550], and is
   widely used in 6LoWPAN. Aiming at the explicit requirement of multi-
   path packet transmission for 6LoWPAN, this document proposes an RPL-
   based multipath transmission method, which improves the success rate



 Pu, et al.              Expires March 25, 2019                [Page 2]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2018


   of packets transmission in uplink networks and further enhances the
   transmission reliability.

2. 6LoWPAN Multipath Header Format

   6LoWPAN multipath header designed at the adaptation layer contains
   the multipath header type field, the sequence number field of the
   multipath package (SequenceNumber) and the path number field
   (PathCount) [RFC4944], as depicted in Figure 1.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Multipath   |         Sequence Number       |  Path Number  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                Figure 1: 6LoWPAN Multipath Header Format

   Field definitions are as follows.

   Multipath: Different types of headers at the adaptation layer must
      have a length of 8-bit header type field. The multipath field is
      the header type field of 6LoWPAN Multipath Header that uses the
      Dispatch Value Bit Pattern of 11101000.

   Sequence Number: This field contains the unique sequence number
      SequenceNumber of packets, and its length is 16 bits.

   Path Number: This field includes the number of paths PathCount that
      needs to be filled in the packet, and its length is 8 bit.

3. Architecture

   The following figure 2 shows the architecture of the 6LoWPAN
   protocol stack. In this architecture, the IP layer uses RPL to
   realize the multipath transmission. Moreover, at the adaptation
   layer, the multipath transmission entity is achieved by designing a
   multipath header. The encapsulation of multipath packets and the
   transmission of multipath packets can be implemented by using above
   methods.









 Pu, et al.              Expires March 25, 2019                [Page 3]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2018


          +---------------------------------------------------+
          |   COAP           Application Layer           XMPP |
          |---------------------------------------------------|
          |   UDP             Transport Layer                 |
          |---------------------------------------------------|
          |  ----------                         --------------|
          |  |RPL|IPv6|          IP Layer       |   Multipath||
          |  ----------                         |Transmission||
          |                                     --------------|
          |---------------------------------------------------|
          |                                 ------------------|
          |   Fragmentation Adaptation Layer|       Multipath||
          |   Header Compression            |Transport Entity||
          |                                 ------------------|
          |---------------------------------------------------|
          |   CSMA/CA            Mac Layer                    |
          |---------------------------------------------------|
          |   Channel Detection     Physical Layer            |
          +---------------------------------------------------+
               Figure 2: 6LoWPAN Protocol Stack Architecture

   Before the source node sends a message, it is necessary to determine
   the number of paths P according to reliability requirements. Then we
   need to assign one or more paths for each parent node at the IP
   layer through the rank value. The rank value is calculated according
   to the residual energy value and the hop value to the sink node from
   the source node [RFC6551], [RFC6552]. The number of paths is
   encapsulated into the multipath header of the message at the
   adaptation layer before sending the message to the parent node. In
   addition, each intermediate routing node forwards the message
   according to the above method until it reaches the sink node.

4. Number of Paths Destination

   Before the source node sends packets, it is needed to first
   determine the number of transmission paths. By determining the
   number of suitable paths, the end-to-end transmission success rate
   can be effectively improved, and the transmission reliability of the
   network can be further improved.

   ETX refers to the number of expected transmissions of a link and is
   an important criterion for evaluating the quality of links in the
   network. This paper uses ETX to confirm the number of paths and
   balance the link quality of each path. At the same time, it selects



 Pu, et al.              Expires March 25, 2019                [Page 4]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2018


   the path with better quality, thereby increases the transmission
   success rate of the network.

   Assume that there are n paths in the network, each path has a, b, c,
   d,...links, then the total ETX value of path a can be calculated by
   following formula:

   E1 = L1 + L2 + ... + La.

   Similarly, the total ETX values of the path b, path c, and path d
   are

   E2 = L1+L2+...+Lb, E3 = L1+L2+...+Lc, E4 = L1+L2+...+Ld, and
   so on.

   Among them, li represents the ETX of the link i in each path, so the
   transmission success rate of the path a is

   p1 = 1 / E1.

   Similarly, the transmission success rate of the path b, path c, and
   path d are

   p2 = 1 / E2, p3 = 1 / E3, p4 = 1 / E4, and so on.

   Then, the transmission success rate of the entire network is the sum
   of the transmission success rates of all the paths, that is

   p = p1 + p2 + p3 + ... + pi + ... + pn.

   Where p represents the success rate of the entire network, and pi
   represents the transmission success rate of path i. Sort p1 to pn
   from largest to smallest, followed by p11, p12, p13,..., p1i,...p1n.
   In order to ensure the success rate of one transmission, calculating
   the following formula:

   p = p11 + p12 + p13 + ... + p1i >= 1.

   When the above formula is established, then i is the number of
   required path.


5. Multipath Distribution

   If the required number of paths P is greater than the total number
   of parent nodes N in the collection of RPL parent nodes, multiple



 Pu, et al.              Expires March 25, 2019                [Page 5]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2018


   paths are assigned to each parent node according to the size
   relation among the rank values of all parent nodes. The following
   formula is used.

   Pm = round (P/Rm/R)     where     R = 1/R1 + 1/R2 + ... + 1/Rn

   Here, round() presents the rounding function, rounding for the
   calculation result of (P/Rm/R). P is the total number of paths. Pm
   shows the number of paths allocated for parent node m. Rm represents
   the Rank value corresponding to the parent node m (m=1,2,...n). The
   above situation is shown as Figure 3.

          +---------------------------------------------------+
          |  rank2=500 P2=1                                   |
          | +------------>(R1)----> .....                     |
          | |                                                 |
          | |                                                 |
          | |               /---->(R3)---->(R4)----> .....\   |
          | |rank1=100 P1=5/                               \  |
          |(S) ---------->(R2).....--->(R5)--->(R6)---> ...(D)|
          | |P=8           \                               /  |
          | |               \---->(R7)---->(R8)----> ...../   |
          | |                                                 |
          | |rank3=200 P3=2     /----> .....                  |
          | +---------------->(R9)                            |
          |                     \----> .....                  |
          +---------------------------------------------------+
               Figure 3: The Transmission Process of P>N

   If the number of paths P is less than or equal to the total number
   of parent nodes, P rank values are selected according to the rise
   order of rank values, and one path is assigned to the parent node
   corresponding to each rank value, as shown in Figure 4.















 Pu, et al.              Expires March 25, 2019                [Page 6]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2018


          +---------------------------------------------------+
          |   rank2=500 P2=1                                  |
          | +---------------->(R1)---->(R2)---->(R3)......... |
          | |                                               | |
          | | rank1=100 P1=1                                | |
          | | /-------------->(R4)---->(R5)---->(R6)......\ | |
          | |/                                             \| |
          |(S)P=3                                          (D)|
          | .\rank3=200 P3=1                               /. |
          | . \-------------->(R7)---->(R8)---->(R9)....../ . |
          | .                                               . |
          | . rank4=600 P4=0                                . |
          | ..................(10)....(R11)....(R12)......... |
          |                                                   |
          +---------------------------------------------------+
               Figure 4: The Transmission Process of P<=N

6. Packet Replication and Elimination

   The process of packet multipath transmission also includes packet
   replication and elimination. A detailed description is given as
   following five steps.

     1) When the multipath transport entity of the adaptation layer
   receives the packet from the upper layer of the protocol stack, it
   first confirms the total number of paths P of the transmission
   packet according to the reliability requirements of the packet. When
   P is less than or equal to 1, it indicates that the packet does not
   need to use multipath transmission, then the packet can be forwarded
   directly.

     2) When the total number of paths P is larger than 1, the number of
   the replicated packets PathCount that needs to be forwarded by each
   parent node in the collection of RPL parent nodes is allocated using
   the multipath packet allocation method [I-D.ietf-detnet-
   architecture], [I-D.ietf-detnet-problem-statement].

     3) For the parent node that PathCount is greater than or equal to
   1, the multipath transport entity replicates the packet and adds the
   multipath header at the adaptation layer, and then sends the packet
   to the parent node. In this case, the packet sequence number
   SequenceNumber of the multipath header in all replicated packets
   must be concurrent and it can be accumulated when the next new
   packet is sent. The path number field is filled with the
   corresponding number of copies PathCount. For the parent node whose




 Pu, et al.              Expires March 25, 2019                [Page 7]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2018


   number of copies PathCount is less than 1, the source node does not
   send the packet.

     4) After the intermediate routing node receives the packet
   including the multipath header, it judges whether the number of
   paths PathCount is equal to 1 in the multipath header. If PathCount
   is equal to 1, the intermediate node sends the packet directly with
   the value of each field in the multipath header constant. If
   PathCount is greater than 1, the node replicate PathCount copies of
   the packet and distributes them to multiple paths. Repeating step 2
   and 3, and in step 2, P is equal to PathCount. In step 3, the new
   multipath header is not added, the SequenceNumber of the packet is
   unchanged, and the path number field is filled with the new
   corresponding number of copies.

     5) When a destination node receives a packet containing the
   multipath header, it can distinguish whether the packet has been
   received according to the source address and the packet sequence
   number in the multipath header. If the destination node has not
   received the packet before, the node forwards the packet to its
   upper layer protocol directly. Otherwise, the node discards the
   packet [I-D.ietf-detnet-architecture], [I-D.ietf-detnet-problem-
   statement].

7. Security Considerations

   This document does not add any new security considerations other
   than what is already mentioned in the referenced technology.

8. IANA Considerations

   This document creates an IANA registry for 6LoWPAN Multipath Header
   Type, and assigns the following dispatch type values:

   11101000: for 6LoWPAN Multipath Header Type.

9. References

9.1. Normative References

[RFC6550]  Winter, T., Ed., Thubert, P., Ed., Brandt, A., Hui, J.,
           Kelsey, R., Levis, P., Pister, K., Struik, R., Vasseur, JP.,
           and R. Alexander, "RPL: IPv6 Routing Protocol for Low-Power
           and Lossy Networks", RFC 6550, March 2012,
           <http://www.rfc-editor.org/info/rfc6550>.




 Pu, et al.              Expires March 25, 2019                [Page 8]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2018


[RFC4944]  Montenegro, G., Kushalnagar, N., Hui, J., and D. Culler,
           "Transmission of IPv6 Packets over IEEE 802.15.4 Networks",
           RFC 4944, September 2007,
           <http://www.rfc-editor.org/info/rfc4944>.

[RFC6551]  Vasseur, JP., Ed., Kim, M., Ed., Pister, K., Dejean, N., and
           D. Barthel, "Routing Metrics Used for Path Calculation in
           Low-Power and Lossy Networks", RFC 6551, March 2012,
           <http://www.rfc-editor.org/info/rfc6551>.

[RFC6552]  Thubert, P., Ed., "Objective Function Zero for the Routing
           Protocol for Low-Power and Lossy Networks (RPL)", RFC 6552,
           March 2012, <http://www.rfc-editor.org/info/rfc6552>.



9.2. Informative References

 [I-D.ietf-detnet-architecture]
           Finn, N. and P. Thubert, "Deterministic Networking
           Architecture", draft-ietf-detnet-architecture-04 (work in
           progress), August 2017.

 [I-D.ietf-detnet-problem-statement]
           Finn, N. and P. Thubert, "Deterministic Networking Problem
           Statement", draft-ietf-detnet-problem-statement-02 (work in
           progress), September 2016.





















 Pu, et al.              Expires March 25, 2019                [Page 9]

Internet-Draft    Multipath Transmission for 6LoWPAN     September 2018


Authors' Addresses

   Chenggen Pu
   Chongqing University of Posts and Telecommunications
   2 Chongwen Road
   Chongqing, 400065
   China

   Phone: (86)-23-6246-1061
   Email: mentospcg@163.com

   Yadong Wang
   Chongqing University of Posts and Telecommunications
   2 Chongwen Road
   Chongqing, 400065
   China

   Phone: (86)-23-6246-1061
   Email: 13618266302@163.com

   Heng Wang
   Chongqing University of Posts and Telecommunications
   2 Chongwen Road
   Chongqing, 400065
   China

  Phone: (86)-23-6248-7845
   Email: wangheng@cqupt.edu.cn

   Yi Yang
   Chongqing University of Posts and Telecommunications
   2 Chongwen Road
   Chongqing, 400065
   China

   Phone: (86)-23-6246-1061
   Email: 15023705316@163.com

   Ping Wang
   Chongqing University of Posts and Telecommunications
   2 Chongwen Road
   Chongqing, 400065
   China

   Phone: (86)-23-6246-1061
   Email: wangping@cqupt.edu.cn



 Pu, et al.              Expires March 25, 2019               [Page 10]

