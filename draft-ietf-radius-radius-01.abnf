Framed-Protocol = PPP as a hint to the RADIUS server that PPP service
b1 = MD(S + RA)       c(1) = p1 xor b1
b2 = MD(S + c(1))     c(2) = p2 xor b2
                .                       .
                .                       .
                .                       .
bi  = MD(S + c(i-1))   c(i) = pi xor bi


Code = 1        (Access-Request)
ID = 0
Authenticator = {16 octet random number}
User-Name = "nemo"
User-Password = {16 octets of Password padded at end with
                      nulls, XORed with MD5 checksum of shared secret
                      plus above Authenticator}
NAS-IP-Address = 192.168.1.16
NAS-Port = 3


Code = 2        (Access-Accept)
ID = 0          (same as in Access-Request)
Authenticator = {16-octet MD-5 checksum of the code (2), id (0),
                       the request authenticator from above, the
                       attributes in this reply, and the shared secret}
Service-Type = Login-User
Login-Service = Telnet
Login-Host = 192.168.1.3




Code = 1        (Access-Request)
ID = 1
Authenticator = {16 octet random number also used as CHAP
                       challenge}
User-Name = "flopsy"
CHAP-Password = {1 octet CHAP ID followed by 16 octet
                           CHAP response}
NAS-IP-Address = 192.168.1.16
NAS-Port = 20
Service-Type = Framed-User
Framed-Protocol = PPP


Code = 2        (Access-Accept)
ID = 1          (same as in Access-Request)
Authenticator = {16-octet MD-5 checksum of the code (2), id (1),
                       the request authenticator from above, the
                       attributes in this reply, and the shared secret}
Service-Type = Framed-User
Framed-Protocol = PPP
Framed-IP-Address = 255.255.255.254
Framed-Routing = None
Framed-Compression = 1      (VJ TCP/IP Header Compression)
Framed-MTU = 1500




Code = 1        (Access-Request)
ID = 2
Authenticator = {16 octet random number}
User-Name = "mopsy"
User-Password = {16 octets of Password padded at end with
                      nulls, XORed with MD5 checksum of shared secret
                      plus above Authenticator}
NAS-IP-Address = 192.168.1.16
NAS-Port = 7


Code = 11       (Access-Challenge}
ID = 2          (same as in Access-Request)
Authenticator = {16-octet MD-5 checksum of the code (11), id (2),
                       the request authenticator from above, the
                       attributes in this reply, and the shared secret}
Reply-Message = "Challenge 32769430.  Enter response at prompt."
State =     {Magic Cookie to be returned along with user's response}


Code = 1        (Access-Request)
ID = 3          (Note that this changes)
Authenticator = {NEW 16 octet random number}
User-Name = "mopsy"
User-Password = {16 octets of Response padded at end with
                      nulls, XORed with MD5 checksum of shared secret
                      plus above Authenticator}
NAS-IP-Address = 192.168.1.16
NAS-Port = 7
State =     {Magic Cookie from Access-Challenge packet, unchanged}


Code = 3        (Access-Reject)
ID = 3          (same as in Access-Request)
Authenticator = {16-octet MD-5 checksum of the code (3), id (3),
                       the request authenticator from above, the
                       attributes in this reply if any, and the shared
                       secret}
