<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>LURK Extension version 1 for (D)TLS 1.2 Authentication</title>
<meta content="Daniel Migault" name="author">
<meta content="Ioana Boureanu" name="author">
<meta content="
       This document describes the LURK Extension 'tls12' which enables
interactions between a LURK Client and a LURK Server in a context of
authentication with (D)TLS 1.2. 
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-mglt-lurk-tls12-05" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-mglt-lurk-tls12-hr2bmk62.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">LURK/TLS 1.2</td>
<td class="right">July 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Migault &amp; Boureanu</td>
<td class="center">Expires 27 January 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">LURK</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-mglt-lurk-tls12-05</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-07-26" class="published">26 July 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-01-27">27 January 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Migault</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">I. Boureanu</div>
<div class="org">University of Surrey</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">LURK Extension version 1 for (D)TLS 1.2 Authentication</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the LURK Extension 'tls12' which enables
interactions between a LURK Client and a LURK Server in a context of
authentication with (D)TLS 1.2.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 January 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulBare ulEmpty compact toc">
<li class="ulBare ulEmpty compact toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology-and-acronyms" class="xref">Terminology and Acronyms</a></p>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-lurk-header" class="xref">LURK Header</a></p>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-rsa_master-rsa_master_with_" class="xref">rsa_master, rsa_master_with_poh</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-request-payload" class="xref">Request Payload</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-perfect-forward-secrecy" class="xref">Perfect Forward Secrecy</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-response-payload" class="xref">Response Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-lurk-client-behavior" class="xref">LURK Client Behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-lurk-server-behavior" class="xref">LURK Server Behavior</a></p>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-rsa_extended_master-rss_ext" class="xref">rsa_extended_master, rss_extended_master_with_poh</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-request-payload-2" class="xref">Request Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-response-payload-2" class="xref">Response Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-lurk-client-behavior-2" class="xref">LURK Client Behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-lurk-server-behavior-2" class="xref">LURK Server Behavior</a></p>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-ecdhe" class="xref">ecdhe"</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-request-payload-3" class="xref">Request Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-response-payload-3" class="xref">Response Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-lurk-client-behavior-3" class="xref">LURK Client Behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-lurk-server-behavior-3" class="xref">LURK Server Behavior</a></p>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-capabilities" class="xref">capabilities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-request-payload-4" class="xref">Request Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-response-payload-4" class="xref">Response Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-lurk-client-behavior-4" class="xref">LURK Client Behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-lurk-server-behavior-4" class="xref">LURK Server Behavior"</a></p>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-ping" class="xref">ping</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-request-payload-5" class="xref">Request Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-response-payload-5" class="xref">Response Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-lurk-client-behavior-5" class="xref">LURK Client Behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-lurk-server-behavior-5" class="xref">LURK Server Behavior</a></p>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-rsa" class="xref">RSA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-ecdhe-2" class="xref">ECDHE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-perfect-foward-secrecy" class="xref">Perfect Foward Secrecy</a></p>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-apendix" class="xref">Apendix</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-lurk-exchange-for-tls-rsa-m" class="xref">LURK Exchange for TLS RSA Master Secret with Proof of Handshake</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.  <a href="#name-lurk-exchange-for-tls-rsa-e" class="xref">LURK Exchange for TLS RSA Extended Master Secret</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="xref">12.3</a>.  <a href="#name-lurk-exchange-for-tls-rsa-ex" class="xref">LURK Exchange for TLS RSA Extended Master Secret with proof of handshake</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="xref">12.4</a>.  <a href="#name-lurk-exchange-for-tls-ecdhe" class="xref">LURK Exchange for TLS ECDHE Signature</a></p>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="xref">13.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="xref">13.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulBare ulEmpty compact toc" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sec-intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document describes the LURK Extension for TLS 1.2 so the LURK
Server can implement a Cryptographic Service in a TLS 1.2 <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span>
and DTLS 1.2 <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span> context.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">More specifically, the LURK Server will be in charge of performing the
cryptographic operations associated to the private key of the TLS
Server, while other aspects of the termination of the TLS session is
handled by other services in the same administrative domain or in a
different administrative domain. Most Cryptographic Operations are
related to the TLS authentication and the current document limits the
Cryptographic Operations to the following authentication methods: RSA
and ECDHE_RSA defined in <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span>, <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span> as well as
ECDHE_ECDSA defined in <span>[<a href="#RFC8422" class="xref">RFC8422</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">A more detailed description of some use cases foreseen in a TLS context
can be found in <span>[<a href="#I-D.mglt-lurk-tls-use-cases" class="xref">I-D.mglt-lurk-tls-use-cases</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">HTTPS delegation has been the main concern of the Content Delivery
Networks Interconnection (cdni) Working Group and several mechanisms
have been designed to delegate the load from an upstream entity to a
downstream entity. Entities can be of different nature and may
designated differently according to the context. Typically designations
includes Content Owner, CDN Provider, Domain Name Owner for example.
<span>[<a href="#I-D.fieau-cdni-https-delegation" class="xref">I-D.fieau-cdni-https-delegation</a>]</span> provides a details comparison of
the various mechanisms applies to the CDN Interconnection, and the
remaining of this section positions these mechanisms at a very high
level view.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">STAR <span>[<a href="#I-D.ietf-acme-star" class="xref">I-D.ietf-acme-star</a>]</span>, <span>[<a href="#I-D.sheffer-acme-star-request" class="xref">I-D.sheffer-acme-star-request</a>]</span>
describes a methods where the domain name owner or the content owner
orchestrates the refreshing process between a CA and the CDN
(terminating the TLS session). The CDN refreshes regularly and
automatically its certificates using <span>[<a href="#I-D.ietf-acme-acme" class="xref">I-D.ietf-acme-acme</a>]</span>, which
allows the use of short term certificates.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Delegated credentials <span>[<a href="#I-D.rescorla-tls-subcerts" class="xref">I-D.rescorla-tls-subcerts</a>]</span> consists having a
certificate that enables the servers to generates some "delegated
credentials".<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">STAR and "delegated credentials" both require some changes performed by
the CA - new certificate type for the delegated credentials and new
interfaces for the delegated and delegating entity for STAR. In both
case the TLS Client authenticates the delegated entity. While STAR does
not require changes on the TLS Client, the "delegated credential"
solution does. In both cases, the delegation is controlled by limiting
in time (7 days), which is also the limit of use of a stolen key or a
rogue server. Such delegation provides a high scalability of the
architecture and prevents additional delays when a TLS session is
established.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">The LURK Architecture <span>[<a href="#I-D.mglt-lurk-lurk" class="xref">I-D.mglt-lurk-lurk</a>]</span> and the LURK Extension
'tls12' do not proceed to the delegation of the HTTPS delegation by
delegating the entire TLS termination. Instead, the TLS termination is
split into sub services, for example one associated to the networking
part and one associated to the cryptographic operation. While micro
services associated to the networking part are delegated, the micro
service associated to the cryptographic operation may not be delegated.
As a result, LURK Architecture is focused on the protection of the
Cryptographic Material and prevents leakage of the Cryptographic
Material for example by avoiding node exposed to the Internet to host
the Cryptographic Material. In addition, LURK provides means to
instantaneously suspend the delegation with a suspicious node. On the
other hand the LURK Extension 'tls12' introduces some latency, and is
not as scalable as STAR or delegated credential solutions.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">The LURK Extension 'tls12' is seen as a complementary to the STAR and
"delegated credentials". The LURK Extension 'tls12' is a backend
solution that does not require any modifications from TLS Client or the
CA. It is also aimed at protecting the Cryptographic Material.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">LURK may also be deployed within an administrative domain in order to to
provide a more controlled deployment of TLS Servers.<a href="#section-1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology-and-acronyms">
<section id="section-2">
      <h2 id="name-terminology-and-acronyms">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology-and-acronyms" class="section-name selfRef">Terminology and Acronyms</a>
      </h2>
<p id="section-2-1">This document re-uses the terminology defined in
<span>[<a href="#I-D.mglt-lurk-lurk" class="xref">I-D.mglt-lurk-lurk</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-lurk-tls-header">
<section id="section-3">
      <h2 id="name-lurk-header">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-lurk-header" class="section-name selfRef">LURK Header</a>
      </h2>
<p id="section-3-1">LURK / TLS 1.2 is a LURK Extension that introduces a new designation
"tls12". This document assumes that Extension is defined with
designation set to "tls12" and version set to 1. The LURK Extension
extends the LURKHeader structure defined in <span>[<a href="#I-D.mglt-lurk-lurk" class="xref">I-D.mglt-lurk-lurk</a>]</span> as
follows:<a href="#section-3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3-2">
<pre>
enum {
    tls12 (1), (255)
} Designation;

enum {
   capabilities (0), ping (1), rsa_master (2),
   rsa_master_with_poh (3), rsa_extended_master (4),
   rsa_extended_master_with_poh (5), ecdhe (6), (255)
}TLS12Type;


enum {
    // generic values reserved or aligned with the
    // LURK Protocol
    request (0), success (1), undefined_error (2),
    invalid_payload_format (3),

    // code points for rsa authentication
    invalid_key_id_type (4), invalid_key_id (5),
    invalid_tls_random (6), invalid_freshness_funct (7),
    invalid_encrypted_premaster (8), invalid_finished (9)

    //code points for ecdhe authentication
    invalid_ec_type (10), invalid_ec_curve (11),
    invalid_poo_prf (12), invalid_poo (13), (255)
}TLS12Status

struct {
     Designation designation = "tls12";
     int8 version = 1;
} Extension;

struct {
    Extension extension;
    select( Extension ){
        case ("tls12", 1):
            TLS12Type;
    } type;
    select( Extension ){
        case ("tls12", 1):
            TLS12Status;
    } status;
    uint64 id;
    unint32 length;
} LURKHeader;
</pre><a href="#section-3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="rsamaster-rsamasterwithpoh">
<section id="section-4">
      <h2 id="name-rsa_master-rsa_master_with_">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-rsa_master-rsa_master_with_" class="section-name selfRef">rsa_master, rsa_master_with_poh</a>
      </h2>
<p id="section-4-1">An exchange of type "rsa_master" or "rsa_master_with_poh" enables the
LURK Client to delegate the RSA Key Exchange and authentication as
defined in <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span>. The LURK Server returns the master secret.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">"rsa_master" provides the necessary parameters and details to generate
the master secret, as well as to hinder replaying of old handshake
messages by a corrupt LURK Client. I.e., some attestation of
message-freshness is acquired by the LURK Server.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">In addition, the"rsa_master_with_poh" provides  a proof of handshake
(PoH).  The proof of handshake consists in providing the Finished
message of the TLS Client to the LURK Server, so that latter  can
perform more checks that in the "rsa_master" mode. Notably, herein, the
LURK Server also checks that the LURK request is performed in a context
of a TLS handshake.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">While "rsa_master" and "rsa_master_with_poh" exchange have respectively
different requests, the response is the same. The motivation for having
different type is that the parameters provided to the LURK Server are
provided using different format. "rsa_master" provides them explicitly,
while "rsa_master_with_poh" provides them via handshake messages.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="sec-rsa-master-req">
<section id="section-4.1">
        <h3 id="name-request-payload">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-request-payload" class="section-name selfRef">Request Payload</a>
        </h3>
<p id="section-4.1-1">A rsa_master request payload has the following structure:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-2">
<pre>
enum {
    sha256_32 (0), (255)
}KeyPairIdType;

struct {
    KeyPairIdType type;
    opaque data; // length defined by the type
} KeyPairID;

enum{
    sha256 (0), (255)
} FreshnessFunct

enum{
    sha256 (0), sha384(1), sha512(2), (255)
} PRFHash

struct {
    KeyPairID key_id;
    FreshnessFunct freshness_funct;
    PRFHash prf_hash;
    Random client_random;        // see RFC5246 section 7.4.1.2
    Random server_random;
    EncryptedPreMasterSecret  pre_master;
                // see RFC5246 section 7.4.7.1
                // Length depends on the key.
    }
} TLS12RSAMasterRequestPayload;
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.1-3">
          <dt id="section-4.1-3.1">key_id</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.2">
  The identifier of the public key. This document defines sha256_32
format which takes the 32 first bits of the hash of the binary ASN.1 DER
representation of the public key using sha256. The binary representation
of RSA keys is described in <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>. The binary representation of
ECC keys is the subjectPublicKeyInfo structure defined in <span>[<a href="#RFC5480" class="xref">RFC5480</a>]</span>.<a href="#section-4.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.3">freshness_funct</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.4">
  the one-way hash function (OWHF) used by LURK to implement Perfect
Forward Secrecy.<a href="#section-4.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.5">prf_hash</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.6">
  the one way hash function used by the Pseudo Random Function (PRF) to
generate the master secret. PRF and hash function are defined in
{!RFC5246}} Section 5.<a href="#section-4.1-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.7">client_random</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.8">
  the random value associated to the TLS Client as defined in
<span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> Section 7.4.1.2.<a href="#section-4.1-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-4">server_random: the random value associated to the TLS Server as defined
in <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> Section 7.4.1.2.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">EncryptedPreMasterSecret : The encrypted master secret as defined in
<span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> Section 7.4.7.1.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">A rsa_master_with_poh request payload has the following structure:<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-7">
<pre>
struct {
    KeyPairID key_id;
    FreshnessFunct freshness_funct;
    opaque handshake_messages&lt;2...2^16-2&gt;
              // see RFC5246 section 7.4.9
    Finished finished
} TLS12RSAMasterWithPoHRequestPayload;
</pre><a href="#section-4.1-7" class="pilcrow">¶</a>
</div>
<p id="section-4.1-8">key_id, freshness_funct are defined above<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-9">
          <dt id="section-4.1-9.1">handshake_messages</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-9.2">
  provides the necessary handshake messages to compute the Finished
message of the TLS Client as defined in <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> section 7.4.9.<a href="#section-4.1-9.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-9.3">finished</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-9.4">
  the TLS Client Finished message as defined by <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> section
7.4.9.<a href="#section-4.1-9.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div id="sec-pfs">
<section id="section-4.1.1">
          <h4 id="name-perfect-forward-secrecy">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-perfect-forward-secrecy" class="section-name selfRef">Perfect Forward Secrecy</a>
          </h4>
<p id="section-4.1.1-1">This document defines a mechanism which uses a function called
freshness_funct, to prevent an attacker to send a request to the LURK
Server in such a way that the said attacker can obtain back the
mastersecret for an old handshake. In other words, the use of this
function helps prevent a forward-secrecy attack on an old TLS session,
where the attack would make use that session's handshake-data observed
by the adversary.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">This design achieves PFS  with freshness_funct being a
collision-resistant hash function (CHRF). By CRHF, we mean a one-way
hash function (OWHF) which also has collision resistance; the latter
means that it is computationally infeasible to find any two inputs x1
and x2 such that freshness_funct(x1) = freshness_funct(x2). By one-way
hash function (OWHF) we mean, as standard, a hash function
freshness_funct that satisfies preimage resistance and 2nd-preimage
resistance. That is, given a hash value y, it is computationally
infeasible to find an x such that freshness_funct(x) = y, and
respectively-- given a value x1 and its hash freshness_funct(x1), it is
computationally infeasible to find another x2 such that
freshness_funct(x2) = freshness_funct(x1).<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3">For the concrete use of our freshness_funct funtions, let S be a fresh,
randomly picked value generated by the LURK Client. The value of
server_random in the TLS exchange is then equal to freshness_funct(S),
i.e., server_random=freshness_funct(S). Between the TLS Client and the
LURK Server only server-random is exchanged. The LURK Client sends S to
the Key Server, in the query. Note that the latter SHOULD happen over a
secure channel.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">A man-in-the-middle attacker observing the (plaintext) TLS handshake
between a TLS Client and the LURK Client does not see S, but only
server_random. The preimage resistance guaranted by the freshness_funct
makes it such that this man-in-the-middle cannot retrieve S out of the
observed server-random. As such, this man-in-the-middle attacker cannot
query the S corresponding to an (old) observed handshake to the Key
Server. Moreover, the collision resistance guaranteed by the
freshness_funct makes it such that if the aforementioned
man-in-the-middle cannot find S' such that
freshness_funct(S)=freshness_funct(S').<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-5">As discussed in <a href="#sec-sec" class="xref">Section 9</a>, PFS may be achieved in other ways (i.e.,
not using a CRHF and the aforementioned exchanges but other
cryptographic primitives and other exchanges). These may offer better
computational efficiency. These may be standardized in future versions
of the LURK extension "tls12.<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1.1-6">The server_random MUST follow the structure of <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> section
7.4.1.2, which carries the gmt_unix_time in the first four bytes. 
So, the ServerHello.random of the TLS exchange is derived from the
server_random of the LURK exchange as defined below:<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.1-7">
<pre>
gmt_unix_time = server_random[0..3];
ServerHello.random = freshness_funct( server_random + "tls12 pfs" );
ServerHello.random[0..3] = gmt_unix_time;
</pre><a href="#section-4.1.1-7" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-8">The operation MUST be performed by the LURK Server as well as the TLS
Server, upon receiving the master secret or the signature of the
ecdhe_params from the LURK Client.<a href="#section-4.1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-lurk-tls-rsa-master-resp">
<section id="section-4.2">
        <h3 id="name-response-payload">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-response-payload" class="section-name selfRef">Response Payload</a>
        </h3>
<p id="section-4.2-1">The "rsa_master" response payload contains the master secret and has
the following structure:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2-2">
<pre>
struct {
    opaque master[0..47];
} TLS12RSAMasterResponsePayload;
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-rsa-master-clt">
<section id="section-4.3">
        <h3 id="name-lurk-client-behavior">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-lurk-client-behavior" class="section-name selfRef">LURK Client Behavior</a>
        </h3>
<p id="section-4.3-1">A LURK Client initiates an rsa_master or an rsa_master_with_poh exchange
in order to retrieve the master secret. The LURK exchange happens on the
TLS Server side (Edge Server). Upon receipt of the master_secret the
Edge Server generates the session keys and finish the TLS key exchange
protocol.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">A LURK Client MAY use the rsa_master_with_poh to provide the LURK Server
evidences that the LURK exchange is performed in the context of a TLS
handshake. The Proof of TLS Hanshake (POH) helps the LURK Server to
audit the context associated to the query.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">The LURK Client MUST ensure that the transmitted values for
server_random is S such as server_random = freshness_funct( S ).<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-rsa-master-srv">
<section id="section-4.4">
        <h3 id="name-lurk-server-behavior">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-lurk-server-behavior" class="section-name selfRef">LURK Server Behavior</a>
        </h3>
<p id="section-4.4-1">Upon receipt of a rsa_master or a rsa_master_with_poh request, the LURK
Server proceeds according to the following steps:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4-2">
<li id="section-4.4-2.1">The LURK Server checks the RSA key pair is available (key_id). If the
format of the key pair identifier is not understood, an
"invalid_key_id_type" error is returned. If the designated key pair is
not available an "invalid_key_id" error is returned.<a href="#section-4.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.2">The LURK Server checks the freshness_funct. If it does not support the
FreshnessFunct, an "invalid_freshness_funct" error is returned.<a href="#section-4.4-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.3">The LURK Server collects the client_random, server_random and
pre_master parameters either provided explicitly (rsa_master) or within
the handshake (rsa_master_with_poh).<a href="#section-4.4-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.4">The LURK Server MUST check the format of the server_random and more
specifically checks the gmt_unix_time associated to the random is
acceptable. Otherwise it SHOULD return an "invalid_tls_random" error.
The value of the time window is implementation dependent and SHOULD be a
configurable parameters. The LURK Server MAY also check the
client_random. This should be considered cautiously as such check may
prevent TLS Clients to set a TLS session. client_random is generated by
the TLS Client whose clock might not be synchronized with the one of the
LURK Server or that might have a TLS implementations that does not
generate random based on gmt_unix_time.<a href="#section-4.4-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.5">The LURK Server computes the necessary ServerHello.random from the
server_random when applicable as described in <a href="#sec-pfs" class="xref">Section 4.1.1</a>. When option
is set to "finished" the ServerHello.random in the handshake is replaced
by its new value.<a href="#section-4.4-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.6">The LURK Server checks the length of the encrypted premaster secret
and returns an "invalid_payload_format" error if the length differs from
the length of binary representation of the RSA modulus.<a href="#section-4.4-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.7">The LURK Server decrypts the encrypted premaster secret as described
in <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> section 7.4.7.1. When a PKCS1.5 format error is
detected, or a mismatch between the TLS versions provided as input and
the one indicated in the encrypted premaster secret, the Key Server
returns a randomly generated master secret.<a href="#section-4.4-2.7" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.8">The LURK Server generates the master secret as described in
<span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> section 8.1 using the client_random, and the server_random
provided by the LURK Client.<a href="#section-4.4-2.8" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.9">With a rsa_master_with_poh, the LURK Server checks the Finished
message is checked as defined in <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> section 7.4.9. In case of
mismatch returns an "invalid_finished" error.<a href="#section-4.4-2.9" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.10">The LURK Server returns a master secret in a
TLS12RSAMasterResponsePayload.<a href="#section-4.4-2.10" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.11">Error are expected to provide the LURK Client an indication of the
cause that resulted in the error. When an error occurs the LURK Server
MAY ignore the request, or provide more generic error codes such as
"undefined_error" or "invalid_format".<a href="#section-4.4-2.11" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="rsaextendedmaster-rssextendedmasterwithpoh">
<section id="section-5">
      <h2 id="name-rsa_extended_master-rss_ext">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-rsa_extended_master-rss_ext" class="section-name selfRef">rsa_extended_master, rss_extended_master_with_poh</a>
      </h2>
<p id="section-5-1">A exchange of type "rsa_extended_master" enables the LURK Client to
delegate
the RSA Key Exchange and authentication. The LURK Server returns the
extended master secret as defined in <span>[<a href="#RFC7627" class="xref">RFC7627</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="request-payload">
<section id="section-5.1">
        <h3 id="name-request-payload-2">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-request-payload-2" class="section-name selfRef">Request Payload</a>
        </h3>
<p id="section-5.1-1">The "rsa_extended_master" request has the following structure:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-2">
<pre>
enum { sha256 (0), (255) } FreshnessFunct

enum { null(0), sha256_128(1), sha256_256(2),
(255) }POOPRF

struct {
    KeyPairID key_id
    FreshnessFunct freshness_funct        // see RFC5246 section 6.1
    opaque handshake_messages&lt;2...2^16-2&gt; // see RFC7627 section 4
}TLS12ExtendedMasterRSARequestPayload;
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1-3">The "rsa_extended_master_with_poh" request has the following structure:<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-4">
<pre>
struct {
    KeyPairID key_id
    FreshnessFunct freshness_funct        // see RFC5246 section 6.1
    opaque handshake_messages&lt;2...2^16-2&gt;
                                // see RFC5246 section 7.4.9
    Finished finished
    }
}TLS12ExtendedMasterRSAWithPoHRequestPayload;
</pre><a href="#section-5.1-4" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.1-5">
          <dt id="section-5.1-5.1">key_id, freshness_funct, option, handshake, finished</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-5.2">
  are defined in <a href="#sec-rsa-master-req" class="xref">Section 4.1</a>.<a href="#section-5.1-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-5.3">handshake_messages</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-5.4">
  With a the handshake message includes
are those necessary to generate a extended master secret as defined in
<span>[<a href="#RFC7627" class="xref">RFC7627</a>]</span> section 4.<a href="#section-5.1-5.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="response-payload">
<section id="section-5.2">
        <h3 id="name-response-payload-2">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-response-payload-2" class="section-name selfRef">Response Payload</a>
        </h3>
<p id="section-5.2-1">rsa_extended_master response payload has a similar structure as the
rsa_master response payload <a href="#sec-lurk-tls-rsa-master-resp" class="xref">Section 4.2</a>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lurk-client-behavior">
<section id="section-5.3">
        <h3 id="name-lurk-client-behavior-2">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-lurk-client-behavior-2" class="section-name selfRef">LURK Client Behavior</a>
        </h3>
<p id="section-5.3-1">The LURK Client proceeds as described in <a href="#sec-rsa-master-clt" class="xref">Section 4.3</a>. The
main difference is that the necessary element to generate the master
secret are included in the handshake and or not provided separately.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lurk-server-behavior">
<section id="section-5.4">
        <h3 id="name-lurk-server-behavior-2">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-lurk-server-behavior-2" class="section-name selfRef">LURK Server Behavior</a>
        </h3>
<p id="section-5.4-1">The LURK Server proceeds as described in <a href="#sec-rsa-master-srv" class="xref">Section 4.4</a> except
that the generation of the extended master is processed as described in
<span>[<a href="#RFC7627" class="xref">RFC7627</a>]</span>.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-ecdhe">
<section id="section-6">
      <h2 id="name-ecdhe">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-ecdhe" class="section-name selfRef">ecdhe"</a>
      </h2>
<p id="section-6-1">A exchange of type "ecdhe" enables the LURK Client to delegate the
ECDHE_RSA <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> or the ECDHE_ECDSA <span>[<a href="#RFC8422" class="xref">RFC8422</a>]</span>
authentication.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="sec-ecdhe-req">
<section id="section-6.1">
        <h3 id="name-request-payload-3">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-request-payload-3" class="section-name selfRef">Request Payload</a>
        </h3>
<p id="section-6.1-1">The "ecdhe" request payload has the following structure:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.1-2">
<pre>
enum { null(0), sha256_128(1), sha256_256(2),
(255) }POOPRF

struct {
    POOPRF poo_prf;
    select( poo_prf ) {
        case ( "null" ):
        case ( "sha256_128" )
            ECPoint vG;  //RFC8422 section 5.4
            opaque R[16] r;
        case ( "sha256_256" ):
            ECPoint vG;  //RFC8422 section 5.4
            opaque R[32] r;
    }
} TLS12POOParams;

struct {
    KeyPairID key_id;
    FreshnessFunct freshness_funct;
    Random client_random;        // see RFC5246 section 7.4.1.2
    Random server_random;
    SignatureAndHashAlgorithm sig_and_hash  //RFC 5246 section 4.7
    ServerECDHParams ecdhe_params;  // RFC8422 section 5.4
    POOParams poo_params;
} TLS12ECDHERequestPayload;
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.1-3">
          <dt id="section-6.1-3.1">key_id, freshness_funct, client_random, server_random</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-3.2">
  is defined in  <a href="#sec-rsa-master-req" class="xref">Section 4.1</a>.<a href="#section-6.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.3">ecdhe_params</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-3.4">
  contains as defined in <span>[<a href="#RFC8422" class="xref">RFC8422</a>]</span> section 5.4, the
elliptic curve domain parameters associated with the ECDH public key
(defined by the ECParameters structure) and the ephemeral ECDH public
key (defined by the ECPoint structure). The public key is also noted in
this document bG with b is a random secret generated by the LURK Client
and G the base point of the curve.<a href="#section-6.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.5">poo_params</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-3.6">
  defines the necessary parameters to provide a proof of ownership of
the ECDHE private key. This option is intended to prevent the LURK
Server to sign bytes that do not correspond to a ECDHE public key.<a href="#section-6.1-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.7">poo_prf</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-3.8">
  pseudo random function used to generate the necessary randoms to proof
ownership of the private key.  This document defines sha256_128 and
sha256_256 which apply the sha256 hash function and respectively return
the 128 or 256 first bits of the resulting hash.<a href="#section-6.1-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.9">vG</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-3.10">
  are the necessary points to generate the proof of ownership.<a href="#section-6.1-3.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.11">r</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-3.12">
  necessary value to create the proof of ownership.<a href="#section-6.1-3.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.1-4">The proof of ownership (PoO) consists in the LURK Client proving the knowledge
of the private random b, while not disclosing b. With G the base point, bG
represents the public value. The PoO is based on the non-interactive variant of
the three-pass Schnorr identification scheme (NIZR) also designated as the
Fiat-Shamir transformation described in <span>[<a href="#RFC8235" class="xref">RFC8235</a>]</span>. More specifically, the
LURK Client randomly generates v and then derive c and r = v - b*c. The LURK
Client provides bG, vG, and r to the LURK Servers. The LURK Server first checks
bG is on the curve. Then it computes c similarly to the LURK Client as well S =
rG + (bG)c. This latest value S is compared to vG. The equality between S and
vG proves the ownership of b.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">v is randomly generated by the LURK Client. v MUST remain non-predictable with a
length equivalent to the expected level of security, that is 128 bit length
(resp. 256 bit length) for a 128 (resp 256) bit security level. Given b, we
RECOMMEND v to be at least half the size of b.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">c is computed by the LURK Client and the LURK Server as described in
<span>[<a href="#RFC8235" class="xref">RFC8235</a>]</span>. UserID is defined by the concatenation of the client_random and
the server_random. OtherInfo is defined as the concatenation of key_id,
freshness_funct, sig_and_hash, ecdhe_params, "tls12 poo". Each concatenated
item is prefixed with a 4-byte integer that represents the byte length of the
item.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.1-7">
<pre>
UserID = client_random || server_random
OtherInfo =  key_id || freshness_funct || sig_and_hash ||
             ecdhe_params || "tls12 poo"
c = poo_prf(G || vG || bG || UserID || OtherInfo)
</pre><a href="#section-6.1-7" class="pilcrow">¶</a>
</div>
<p id="section-6.1-8">The LURK Client provides bG in ecdhe_params and vG as well as r in poo_params.<a href="#section-6.1-8" class="pilcrow">¶</a></p>
<p id="section-6.1-9">With X25519 or X448, b and r MUST be clamped and vG MUST use the Curve25519
(resp. Curve448). bG MAY also use the Curve25519 or Curve448 representation, or
the LURK Server MAY derive bG values from the provided xlined value in
ecdhe_params.<a href="#section-6.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="response-payload-1">
<section id="section-6.2">
        <h3 id="name-response-payload-3">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-response-payload-3" class="section-name selfRef">Response Payload</a>
        </h3>
<p id="section-6.2-1">The "ecdhe" response payload has the following structure:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.2-2">
<pre>
struct {
    Signature signed_params;  // RFC8422 section 5.4
} TLS12ECDHEResponsePayload;
</pre><a href="#section-6.2-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.2-3">
          <dt id="section-6.2-3.1">signed_params</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-3.2">
            <p id="section-6.2-3.2.1">
  signature applied to the hash of the
ecdhe_params
as well as client_random and server_random as described in<a href="#section-6.2-3.2.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.2.2"><span>[<a href="#RFC8422" class="xref">RFC8422</a>]</span> section 5.4.<a href="#section-6.2-3.2.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="lurk-client-behavior-1">
<section id="section-6.3">
        <h3 id="name-lurk-client-behavior-3">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-lurk-client-behavior-3" class="section-name selfRef">LURK Client Behavior</a>
        </h3>
<p id="section-6.3-1">The LURK Client builds the base as described in <a href="#sec-rsa-master-req" class="xref">Section 4.1</a> and in
<a href="#sec-ecdhe-req" class="xref">Section 6.1</a>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">Upon receiving the response payload, the LURK Client MAY check the
signature. If the signature does not match an error SHOULD be
reported.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lurk-server-behavior-1">
<section id="section-6.4">
        <h3 id="name-lurk-server-behavior-3">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-lurk-server-behavior-3" class="section-name selfRef">LURK Server Behavior</a>
        </h3>
<p id="section-6.4-1">Upon receiving an ecdhe request, the LURK Server proceeds as follows:<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.4-2">
<li id="section-6.4-2.1">perform steps 1 - 6 as described in <a href="#sec-rsa-master-srv" class="xref">Section 4.4</a><a href="#section-6.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.2">The LURK Server performs some format check of the ecdhe_params before
signing them. If the ecdhe_params does not follow the expected
structure. With the notations from <span>[<a href="#RFC8422" class="xref">RFC8422</a>]</span>, if
curve_type is not set to "named_curve", the LURK Server SHOULD respond
with an "invalid_ec_type" error. If the curve or namedcurve is not
supported the LURK Server SHOULD be able to respond with an
"invalid_ec_curve" error.<a href="#section-6.4-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.3">The LURK Server processes the poo_params. If the poo_prf is not
supported, the LURK Extension returns a "invalid_poo_prf" status. If
poo_prf is supported and different from "null", the LURK Server proceeds
to the proof of ownership as described in <a href="#sec-ecdhe-req" class="xref">Section 6.1</a>. If the
proof is not properly verified, the LURK Extension returns a
"invalid_poo" status.<a href="#section-6.4-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.4">The LURK Server processes the base structure as described in
<a href="#sec-rsa-master-srv" class="xref">Section 4.4</a><a href="#section-6.4-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.5">The LURK Server generates the signed_params.<a href="#section-6.4-2.5" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-6.4-3">Error are expected to provide the LURK Client an indication of the cause
that resulted in the error. When an error occurs the LURK Server MAY
ignore the request, or provide more generic error codes such as
"undefined_error" or "invalid_format".<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="capabilities">
<section id="section-7">
      <h2 id="name-capabilities">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-capabilities" class="section-name selfRef">capabilities</a>
      </h2>
<p id="section-7-1">A exchange of type "capabilities" enables the LURK Client to be informed
of the supported operations performed by the LURK Server. The supported
parameters are provided on a per type basis.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="request-payload-1">
<section id="section-7.1">
        <h3 id="name-request-payload-4">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-request-payload-4" class="section-name selfRef">Request Payload</a>
        </h3>
<p id="section-7.1-1">A LURK "capabilities" request has no payload.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="response-payload-2">
<section id="section-7.2">
        <h3 id="name-response-payload-4">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-response-payload-4" class="section-name selfRef">Response Payload</a>
        </h3>
<p id="section-7.2-1">The "capabilities" response payload lists for each supported type, the
supported certificates, the supported signatures and hash associated.
The "capabilities" payload has the following structure:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.2-2">
<pre>
struct{
    CertificateType certificate_type  // RFC8442 section 4.4.2
    select (certificate_type) {
         case RawPublicKey:
           /* From RFC 7250 ASN.1_subjectPublicKeyInfo */
           opaque ASN1_subjectPublicKeyInfo&lt;1..2^24-1&gt;;
         case X509:
           opaque cert_data&lt;1..2^24-1&gt;;
     };
} TypedCertificate;

struct {
     KeyPairID key_id_type_list&lt;0..255&gt;;
     TypedCertificate typed_certificate_list&lt;0..255&gt;
     FreshnessFunctList freshness_funct_list&lt;0..255&gt;
     CipherSuites cipher_suite_list&lt;0..255&gt;
     PRFHash prf_hash_list&lt;0..255&gt;
} TLS12RSACapability;



struct {
     KeyPairID key_id_type_list&lt;0..255&gt;;
     TypedCertificate typed_certificate_list&lt;0..255&gt;
     FreshnessFunctList freshness_funct_list&lt;0..255&gt;
     CipherSuites cipher_suite_list&lt;0..255&gt;
     SignatureAndHashAlgorithm sig_and_hash_list&lt;0..255&gt;
     NameCurve ecdsa_curves_list&lt;0..255&gt;;
     NameCurve ecdhe_curves_list&lt;0..255&gt;
     POOPRF poo_prf_list&lt;0..255&gt;
} TLS12ECDHECapability;

struct {
    uint32 length;
    TLS12Type type
    Select( type ) {
           case rsa_master : TLS12RSACapability,
           case rsa_master_with_poh : TLS12RSACapability,
           case rsa_extended_master : TLS12RSACapability,
           case rsa_extended_master_with_poh : TLS12RSACapability,
           case ecdhe : TLS12ECDHECapability
    } capability ;
} TLS12Capability


struct {
    TLS12Capability capability_list;
    opaque state&lt;32&gt;;
} TLS12CapabilitiesResponsePayload;
</pre><a href="#section-7.2-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-7.2-3">
          <dt id="section-7.2-3.1">typed_certificate</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-3.2">
  enables to contain authentication credentials of various type, such as
X09 certificate or raw public key. While different,  the structure is
similar of CertificateEntry defined in <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> section 4.4.2 as
well as the Certificate structure defined in <span>[<a href="#RFC7250" class="xref">RFC7250</a>]</span>.<a href="#section-7.2-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-3.3">key_id_type_list</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-3.4">
  the supported key_id_type.<a href="#section-7.2-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-3.5">freshness_funct_list</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-3.6">
  designates the list of freshness_funct ( see <a href="#sec-rsa-master-req" class="xref">Section 4.1</a>).<a href="#section-7.2-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-3.7">certificate_list</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-3.8">
  designates the certificates associated to message type. The format is
similar but different from the CertificateEntry defined in <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>
in section 4.4.2 and <span>[<a href="#RFC7250" class="xref">RFC7250</a>]</span> section 1. The CertificateBis format enables
the use of X509 as well as Raw Public key, while the Certificate
structure defined in <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> section 7.4.2 does not.<a href="#section-7.2-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-3.9">sig_and_hash_list</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-3.10">
  designates supported signature algorithms as well as PRF used for the
different operations. The format is defined in <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span> section
7.4.1.4.1.<a href="#section-7.2-3.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-3.11">ecdsa_curves_list</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-3.12">
  the supported signatures<a href="#section-7.2-3.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-3.13">ecdhe_curves_list</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-3.14">
  the supported curves for ECHDE parameters.<a href="#section-7.2-3.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-3.15">poo_prf_list</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-3.16">
  the supported message type poo_prf ( see <a href="#sec-ecdhe-req" class="xref">Section 6.1</a>. to be used
with the proof of ownership.<a href="#section-7.2-3.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-3.17">type_list</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-3.18">
  the supported message type of the LURK extension.<a href="#section-7.2-3.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-3.19">state</dt>
          <dd style="margin-left: 1.5em" id="section-7.2-3.20">
  characterizes the configuration associated to 'tls12' on the LURK
Server..<a href="#section-7.2-3.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="lurk-client-behavior-2">
<section id="section-7.3">
        <h3 id="name-lurk-client-behavior-4">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-lurk-client-behavior-4" class="section-name selfRef">LURK Client Behavior</a>
        </h3>
<p id="section-7.3-1">The LURK Client performs a capability request in order to determine
the possible operations.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">The LURK Client is expected to keep the state value to be able to
detect a change in the LURK Server configuration when an error
occurs.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lurk-server-behavior-2">
<section id="section-7.4">
        <h3 id="name-lurk-server-behavior-4">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-lurk-server-behavior-4" class="section-name selfRef">LURK Server Behavior"</a>
        </h3>
<p id="section-7.4-1">Upon receiving a capabilities request, the LURK Extension MUST return
the capabilities payload associated to a "success" status to the LURK
Server. These information are then forwarded by the LURK Server to the
LURK Client.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ping">
<section id="section-8">
      <h2 id="name-ping">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-ping" class="section-name selfRef">ping</a>
      </h2>
<p id="section-8-1">A exchange of type "ping" enables the LURK Client to check the 
reachability in a context of the defined LURK Extension.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="request-payload-2">
<section id="section-8.1">
        <h3 id="name-request-payload-5">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-request-payload-5" class="section-name selfRef">Request Payload</a>
        </h3>
<p id="section-8.1-1">A "ping" request has no payload.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="response-payload-3">
<section id="section-8.2">
        <h3 id="name-response-payload-5">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-response-payload-5" class="section-name selfRef">Response Payload</a>
        </h3>
<p id="section-8.2-1">A "ping" response has no payload.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lurk-client-behavior-3">
<section id="section-8.3">
        <h3 id="name-lurk-client-behavior-5">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-lurk-client-behavior-5" class="section-name selfRef">LURK Client Behavior</a>
        </h3>
<p id="section-8.3-1">The LURK Client sends a "ping" request to test the reachability of
the LURK Server. The reachability is performed for the tls12 LURK
Extension.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lurk-server-behavior-3">
<section id="section-8.4">
        <h3 id="name-lurk-server-behavior-5">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-lurk-server-behavior-5" class="section-name selfRef">LURK Server Behavior</a>
        </h3>
<p id="section-8.4-1">Upon receiving a ping request, the LURK Extension MUST return the
ping response associated with a "success" status to the LURK Server.
These information are then forwarded by the LURK Server to the LURK
Client.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-sec">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">The security considerations defined in <span>[<a href="#I-D.mglt-lurk-lurk" class="xref">I-D.mglt-lurk-lurk</a>]</span> applies
to the LURK Extension "tls12" defined in this document.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Anti-replay mechanisms rely in part on the security of channel between
the LURK Client and the LURK Server. As such the channel between the
LURK Client and the LURK Server MUST be ensuring confidentiality and
integrity. More specifically, the exchanges between the LURK Client and
the LURK Server MUST be an encrypted with authentication encryption, and
the two parties had previously mutually authenticated.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">The LURK Extension "tls12" is expected to have response smaller that
the request or at least not significantly larger, which makes
"tls12" relatively robust to amplification attacks. This is especially
matters when LURK is using UDP. The use of an authenticated channel
reduces also the risk of amplification attacks even when UDP is being
used.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">The LURK Client and the LURK Server use time in their way to generate
the server_random. Care MUST be taken so the LURK Client and LURK Server
remain synchronized.<a href="#section-9-4" class="pilcrow">¶</a></p>
<div id="rsa">
<section id="section-9.1">
        <h3 id="name-rsa">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-rsa" class="section-name selfRef">RSA</a>
        </h3>
<p id="section-9.1-1">The rsa_master and rsa_extended_master returns the master_secret
instead of the premaster. The additional hashing operation
necessary to generate the master secret is expected to improve the
protection of the RSA private key against cryptographic analysis based
on the observation of a set of clear text and corresponding encrypted
text.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">The standard TLS1.2 is robust against Bleichenbacher attack as it
provides no means to detect if the error comes from a TLS version
mismatch or from the premaster format. This properties remain with LURK,
and so LURK does not present vulnerabilities toward Bleichenbacher
attack, and cannot be used as a decryption oracle.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ecdhe">
<section id="section-9.2">
        <h3 id="name-ecdhe-2">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-ecdhe-2" class="section-name selfRef">ECDHE</a>
        </h3>
<p id="section-9.2-1">A passive attacker observing the ecdhe exchange may collect a
sufficient amount of clear text and corresponding signature to perform a
cryptographic analysis or to reuse the signature for other purposes. As
a result, it remains important to encrypt the ecdhe exchange between the
LURK Client and the LURK Server. Note that this vulnerability is present
in TLS 1.2 as a TLS Client can accumulate these data as well. The
difference with LURK is by listening the LURK Server, the accumulation
is achieved for all TLS Clients.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">As previously mentioned, the LURK Server may be used as signing
oracle for the specific string:<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-9.2-3">
<pre>
    SHA(ClientHello.random + ServerHello.random +
                         ServerKeyExchange.params);
</pre><a href="#section-9.2-3" class="pilcrow">¶</a>
</div>
<p id="section-9.2-4">More specifically, the ECDHE_RSA and ECDHE_DSA mechanisms does not
associate the signature to a TLS1.2 context. As a result, an attacker
could  re-used the signature in another context.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2-5">The attack may operate by collecting a large collection of clear text
and their corresponding signature. When the attacker want to provide a
signature, it checks in its database, a match occurs between the two
contents to be signed. The probability of a collision increases with
number of available hashes. The attack is related the pre-image and
collision resistance properties of the hash function.<a href="#section-9.2-5" class="pilcrow">¶</a></p>
<p id="section-9.2-6">The attacker may also given a clear text to be signed, generate a
collision such that a collision occurs which provides is related to the
second pre-image and collision resistance property of the hash
function.<a href="#section-9.2-6" class="pilcrow">¶</a></p>
<p id="section-9.2-7">The surface of attack is limited by:<a href="#section-9.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-8.1">limiting the possibility of aggregating a collection of clear text
and their corresponding signatures. This could be achieved by using
multiple LURK Clients using an encrypted channel between the LURK Client
and the LURK Server.<a href="#section-9.2-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.2-8.2">increasing the checks and ensure that signature is performed in a TLS
1.2 context. For that purpose it is RECOMMENDED the LURK Server checks
the consistency of its input parameters. This includes the proof of
ownership as well as the format of the randoms and ecdhe_params for
example.<a href="#section-9.2-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.2-8.3">limiting the usage of a Cryptographic material to a single usage, in
our case serving  TLS 1.2.<a href="#section-9.2-8.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="perfect-foward-secrecy">
<section id="section-9.3">
        <h3 id="name-perfect-foward-secrecy">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-perfect-foward-secrecy" class="section-name selfRef">Perfect Foward Secrecy</a>
        </h3>
<p id="section-9.3-1">This document uses sha256 as the freshness_funct, in order to achieve
PFS <a href="#sec-pfs" class="xref">Section 4.1.1</a> as described above.  By construction of the
server_random, of the output of freshness_funct we will keep only the
last 28 bytes.  The PFS property is in place as long as this truncated
version of  freshness_funct can be considered a CRHF and that the 28
bytes of randomness carried by the server_random are sufficient.
Otherwise, the mechanism described in this document will not be
considered as safe.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">Details on the truncation will be added.  Alternatively, we could use a
hash function like SHA3 (or, more explicitly SHAKE) which considers
variable output length  as part of its design.  The SHAKE functions
allow arbitrary output lengths and  the PFS-input S  can be of arbitrary
length too.  However, for SHAKE128-d, if the truncated output is of
length d as low as 224 bits (28 bytes), then one only gets 224/2=112
bits security w.r.t.  collision-resistance, &gt; 112 bits w.r.t. preimage
resistance and 112 bits security w.r.t. second preimage resistance.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<p id="section-9.3-3">One reason why we have the hash-based solution to is to reduce
communication costs between the LURK Client and the LURK Server, whilst
still getting more than some security w.r.t. a MiM corrupting a LURK
Client and then attempting a PFS attack.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
<p id="section-9.3-4">But, if we disregard the overhaed on communication costs, we  can
consider other mechanisms not based on CRHF for attaining PFS security.
See I and II below.<a href="#section-9.3-4" class="pilcrow">¶</a></p>
<p id="section-9.3-5">I. For example, as  freshness_funct, one can use an instance of a pseudo random
function (PRF), keyed on a key K  that the LURK Server already shares
with the LURK Client. I.e., server_random=freshness_funct(S;K).
In this case, the mechanisms to achieve PFS are as follows:
1. The LURK Client and the LURK Server  run a key-establishment protocol before every LURK session 
to establish such a new key K for every LURK session. Alternatively, the export this key of the key-establishment
run to secure the channel. The time-to-live of K is  one session only.
2. The LURK Server  generates the value  S on its side and send the server_random to the LURK Client.
3. The LURK Client uses this server_random with the TLS Client
4. The LURK Server checks the correctness of the use of the said server_random when the query for the master_secret is made, with 
the messages forwarded therein;<a href="#section-9.3-5" class="pilcrow">¶</a></p>
<p id="section-9.3-6">II. In fact, since the channel between the LURK Client and the LURK Server  MUST be encrypted by default, all for 2 steps in point I above can 
be combined into 1 step (without the need of a specially executed key-establishment): 
 a.  the LURK Server  sends the server_random to the LURK Client.
 b.  the LURK Client uses this server_random with the TLS Client
 c.  the LURK Server checks the correctness of the use of the said server_random when the query for the master_secret is made, with 
the messages forwarded therein;<a href="#section-9.3-6" class="pilcrow">¶</a></p>
<p id="section-9.3-7">Yet, option I and option II  are more expensive on the communication
than the version achieving PFS with a hash function. I.e., in I and II,
the LURK Server needs to be involved on the first part of the TLS
handshake to produce the S or server_random for the LURK Client.
However, note that the LURK Client no longer queries S, hence the risk
of a man-in-the-middle querying an old S is eliminated by design.<a href="#section-9.3-7" class="pilcrow">¶</a></p>
<p id="section-9.3-8">Option II above is akin to what "Content delivery over TLS: a
cryptographic analysis of keyless SSL," by K. Bhargavan, I. Boureanu, P.
A. Fouque, C. Onete and B. Richard at 2017 IEEE European Symposium on
Security and Privacy (EuroS&amp;P), Paris, 2017, pp. 1-16, suggested in
order to amend (forward-secrecy) attacks  on Keyless SSL.<a href="#section-9.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">The requested information is defined  in <span>[<a href="#I-D.mglt-lurk-lurk" class="xref">I-D.mglt-lurk-lurk</a>]</span>.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">LURK Extension Designation: tls12 
LURK Extension Reference: [RFD-TBD]
LURK Extension Description: RSA, ECDHE_RSA and ECDHE_ECDSA for (D)TLS
1.2.<a href="#section-10-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10-3">
<pre>
LURK tls12 Extension Status

Value    Description                 Reference
---------------------------------------------------
0 - 1    Reserved                    [RFC-TBD-LURK]
2        undefined_error             [RFC-TBD]
3        invalid_payload_format      [RFC-TBD]
4        invalid_key_id_type         [RFC-TBD]
5        invalid_key_id              [RFC-TBD]
6        invalid_tls_random          [RFC-TBD]
7        invalid_freshness_funct     [RFC-TBD]
8        invalid_encrypted_premaster [RFC-TBD]
9        invalid_finished            [RFC-TBD]
10       invalid_ec_type             [RFC-TBD]
11       invalid_ec_curve            [RFC-TBD]
12       invalid_poo_prf             [RFC-TBD]
13       invalid_poo                 [RFC-TBD]
14       invalid_cipher_or_prf_hash  [RFC-TBD]
15 - 255 UNASSIGNED

LURK tls12 Extension Type

Value    Description                  Reference
----------------------------------------------
0        capabilities                 [RFC-TBD]
1        ping                         [RFC-TBD]
2        rsa_master                   [RFC-TBD]
2        rsa_master_with_poh          [RFC-TBD]
3        rsa_extended_master          [RFC-TBD]
3        rsa_extended_master_with_poh [RFC-TBD]
4        ecdhe                        [RFC-TBD]
16 - 255 UNASSIGNED
</pre><a href="#section-10-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-11">
      <h2 id="name-acknowledgments">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-11-1">We would like to thank for their very useful feed backs: Yaron Sheffer, Yoav
Nir, Stephen Farrell, Eric Burger, Thomas Fossati, Eric Rescorla, Mat Naslung,
Rich Salz, Ilari Liusvaara, Scott Fluhrer. Many ideas in this document are from
<span>[<a href="#I-D.erb-lurk-rsalg" class="xref">I-D.erb-lurk-rsalg</a>]</span>.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">We would also like to thank those that have supported LURK or raised
interesting discussions. This includes among others Robert Skog, Hans
Spaak, Salvatore Loreto, John Mattsson, Alexei Tumarkin,
Richard Brunner, Stephane Dault, Dan Kahn Gillmor, Joe Hildebrand,
Kelsey Cairns.<a href="#section-11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="apendix">
<section id="section-12">
      <h2 id="name-apendix">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-apendix" class="section-name selfRef">Apendix</a>
      </h2>
<p id="section-12-1">## LURK Exchange for TLS RSA Master Secret<a href="#section-12-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-12-2">
<pre>
TLS Client          Edge Server         Key Server

ClientHello
   server_version
   client_random
   cipher_suite
       TLS_RSA_*, ...
--------&gt;
                    S = server_random
                    server_random = freshness_funct( S )

                    ServerHello
                        tls_version
                        server_random
                        Cipher_suite=TLS_RSA
                    Certificate
                        RSA Public Key
                    ServerHelloDone
                    &lt;--------

ClientKeyExchange
    EncryptedPremasterSecret
[ChangeCipherSpec]
Finished
--------&gt;


                    TLS12 Request Header
                    TLS12MasterRSARequestPayload
                        key_id
                        freshness_funct
                        prf_hash
                        client_random
                        S
                        EncryptedPremasterSecret
                    --------&gt;

                                 server_random = freshness_funct( S )

                                 master_secret = PRF(\
                                 pre_master_secret + \
                                 "master secret" +\
                                 client_random +\
                                 server_random)[0..47];

                                        TLS12 Response Header
                                        TLS12MasterResponsePayload
                                            master
                                        &lt;--------

                    [ChangeCipherSpec]
                        Finished
                    &lt;--------
Application Data      &lt;-------&gt;     Application Data
</pre><a href="#section-12-2" class="pilcrow">¶</a>
</div>
<div id="lurk-exchange-for-tls-rsa-master-secret-with-proof-of-handshake">
<section id="section-12.1">
        <h3 id="name-lurk-exchange-for-tls-rsa-m">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-lurk-exchange-for-tls-rsa-m" class="section-name selfRef">LURK Exchange for TLS RSA Master Secret with Proof of Handshake</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-12.1-1">
<pre>
TLS Client          Edge Server         Key Server

ClientHello
   server_version
   client_random
   cipher_suite
       TLS_RSA_*, ...
--------&gt;
                    S = server_random
                    server_random = freshness_funct( S )

                    ServerHello
                        tls_version
                        server_random
                        Cipher_suite=TLS_RSA
                    Certificate
                        RSA Public Key
                    ServerHelloDone
                    &lt;--------

ClientKeyExchange
    EncryptedPremasterSecret
[ChangeCipherSpec]
Finished
--------&gt;


                    TLS12 Request Header
                    TLS12MasterRSAWithPoHRequestPayload
                        key_id
                        freshness_funct
                        handshake_messages
                        finished
                    --------&gt;

                                 server_random = freshness_funct( S )

                                 master_secret = PRF(\
                                 pre_master_secret + \
                                 "master secret" +\
                                 client_random +\
                                 server_random)[0..47];

                                        TLS12 Response Header
                                        TLS12MasterResponsePayload
                                            master
                                        &lt;--------

                    [ChangeCipherSpec]
                        Finished
                    &lt;--------
Application Data      &lt;-------&gt;     Application Data
</pre><a href="#section-12.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="lurk-exchange-for-tls-rsa-extended-master-secret">
<section id="section-12.2">
        <h3 id="name-lurk-exchange-for-tls-rsa-e">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-lurk-exchange-for-tls-rsa-e" class="section-name selfRef">LURK Exchange for TLS RSA Extended Master Secret</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-12.2-1">
<pre>
TLS Client          Edge Server         Key Server

ClientHello
   tls_version
   cipher_suite
       TLS_RSA_*, ...
   Extension 0x0017
--------&gt;

                    ServerHello
                        edge_server_version
                        cipher_suite=TLS_RSA
                        Extension 0x0017
                    Certificate
                        RSA Public Key
                    ServerHelloDone
                    &lt;--------
ClientKeyExchange
    EncryptedPremasterSecret
[ChangeCipherSpec]
Finished
--------&gt;

                    TLS12 Request Header
                    TLS12ExtendedMasterRSARequestPayload
                        key_id
                        freshness_funct
                        handshake_messages
                        EncryptedPreMasterSecret
                    --------&gt;

                                 1. Computing Master Secret
                                 master_secret = master_prf(
                                 pre_master_secret +\
                                 "extended master secret" +\
                                 session_hash)[0..47]

                                        TLS12 Response Header
                                        TLS12MasterPayload
                                            master
                                        &lt;--------

                    [ChangeCipherSpec]
                        Finished
                    &lt;--------
Application Data      &lt;-------&gt;     Application Data
</pre><a href="#section-12.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="lurk-exchange-for-tls-rsa-extended-master-secret-with-proof-of-handshake">
<section id="section-12.3">
        <h3 id="name-lurk-exchange-for-tls-rsa-ex">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-lurk-exchange-for-tls-rsa-ex" class="section-name selfRef">LURK Exchange for TLS RSA Extended Master Secret with proof of handshake</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-12.3-1">
<pre>
TLS Client          Edge Server         Key Server

ClientHello
   tls_version
   cipher_suite
       TLS_RSA_*, ...
   Extension 0x0017
--------&gt;

                    ServerHello
                        edge_server_version
                        cipher_suite=TLS_RSA
                        Extension 0x0017
                    Certificate
                        RSA Public Key
                    ServerHelloDone
                    &lt;--------
ClientKeyExchange
    EncryptedPremasterSecret
[ChangeCipherSpec]
Finished
--------&gt;

                    TLS12 Request Header
                    TLS12ExtendedMasterWithPoHRequestPayload
                        key_id
                        freshness_funct
                        handshake_messages
                        finished
                    --------&gt;

                                 1. Computing Master Secret
                                 master_secret = master_prf(
                                 pre_master_secret +\
                                 "extended master secret" +\
                                 session_hash)[0..47]

                                        TLS12 Response Header
                                        TLS12MasterPayload
                                            master
                                        &lt;--------

                    [ChangeCipherSpec]
                        Finished
                    &lt;--------
Application Data      &lt;-------&gt;     Application Data
</pre><a href="#section-12.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="lurk-exchange-for-tls-ecdhe-signature">
<section id="section-12.4">
        <h3 id="name-lurk-exchange-for-tls-ecdhe">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-lurk-exchange-for-tls-ecdhe" class="section-name selfRef">LURK Exchange for TLS ECDHE Signature</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-12.4-1">
<pre>
TLS Client          Edge Server         Key Server

ClientHello
   tls_version
   client_random
   cipher_suite
       TLS_ECDHE_ECDSA_*, TLS_ECDHE_RSA_*, ...
       Extension Supported EC, Supported Point Format
--------&gt;
                    S = server_random
                    server_random = freshness_funct( S )

                    TLS12 Request Header
                    TLS12ECDHEInputPayload
                        key_id
                        client_random
                        S
                        ecdhe_params
                    --------&gt;
                                 server_random = freshness_funct( S )

                                 signature = ECDSA( client_random +\
                                 server_random + ecdhe_params )

                                        TLS12 Response Header
                                        TLS12DigitallySignedPayloads
                                            signature
                                        &lt;--------

                    ServerHello
                        tls_version
                        server_random
                        Cipher_suite=TLS_ECDHE_ECDSA
                        Extension Supported EC,
                        Supported Point Format
                    Certificate
                        ECDSA Public Key
                    ServerKeyExchange
                        ecdhe_params
                        signature
                    ServerHelloDone
                    &lt;--------


ClientKeyExchange
[ChangeCipherSpec]
Finished
--------&gt;
                    [ChangeCipherSpec]
                    Finished
                    &lt;--------
Application Data      &lt;-------&gt;     Application Data
</pre><a href="#section-12.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5480">[RFC5480]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refAuthor">Brown, D.</span>, <span class="refAuthor">Yiu, K.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">T. Polk</span>, <span class="refTitle">"Elliptic Curve Cryptography Subject Public Key Information"</span>, <span class="seriesInfo">RFC 5480</span>, <span class="seriesInfo">DOI 10.17487/RFC5480</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5480">https://www.rfc-editor.org/info/rfc5480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7250">[RFC7250]</dt>
        <dd>
<span class="refAuthor">Wouters, P., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Gilmore, J.</span>, <span class="refAuthor">Weiler, S.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7250">https://www.rfc-editor.org/info/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7627">[RFC7627]</dt>
        <dd>
<span class="refAuthor">Bhargavan, K., Ed.</span>, <span class="refAuthor">Delignat-Lavaud, A.</span>, <span class="refAuthor">Pironti, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">M. Ray</span>, <span class="refTitle">"Transport Layer Security (TLS) Session Hash and Extended Master Secret Extension"</span>, <span class="seriesInfo">RFC 7627</span>, <span class="seriesInfo">DOI 10.17487/RFC7627</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7627">https://www.rfc-editor.org/info/rfc7627</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8422">[RFC8422]</dt>
        <dd>
<span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Josefsson, S.</span>, and <span class="refAuthor">M. Pegourie-Gonnard</span>, <span class="refTitle">"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS) Versions 1.2 and Earlier"</span>, <span class="seriesInfo">RFC 8422</span>, <span class="seriesInfo">DOI 10.17487/RFC8422</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8422">https://www.rfc-editor.org/info/rfc8422</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.erb-lurk-rsalg">[I-D.erb-lurk-rsalg]</dt>
        <dd>
<span class="refAuthor">Erb, S.</span> and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"A PFS-preserving protocol for LURK"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-erb-lurk-rsalg-01</span>, <time datetime="2016-05-28" class="refDate">28 May 2016</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-erb-lurk-rsalg-01.txt">https://www.ietf.org/archive/id/draft-erb-lurk-rsalg-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.fieau-cdni-https-delegation">[I-D.fieau-cdni-https-delegation]</dt>
        <dd>
<span class="refAuthor">Fieau, F.</span>, <span class="refAuthor">Stephan, E.</span>, and <span class="refAuthor">S. Mishra</span>, <span class="refTitle">"HTTPS delegation in CDNI"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-fieau-cdni-https-delegation-02</span>, <time datetime="2017-07-03" class="refDate">3 July 2017</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-fieau-cdni-https-delegation-02.txt">https://www.ietf.org/archive/id/draft-fieau-cdni-https-delegation-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-acme-acme">[I-D.ietf-acme-acme]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-acme-acme-18</span>, <time datetime="2018-12-20" class="refDate">20 December 2018</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-acme-acme-18.txt">https://www.ietf.org/archive/id/draft-ietf-acme-acme-18.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-acme-star">[I-D.ietf-acme-star]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Lopez, D.</span>, <span class="refAuthor">Dios, O. G. D.</span>, <span class="refAuthor">Perales, A. A. P.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Support for Short-Term, Automatically Renewed (STAR) Certificates in the Automated Certificate Management Environment (ACME)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-acme-star-11</span>, <time datetime="2019-10-24" class="refDate">24 October 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-acme-star-11.txt">https://www.ietf.org/archive/id/draft-ietf-acme-star-11.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mglt-lurk-lurk">[I-D.mglt-lurk-lurk]</dt>
        <dd>
<span class="refAuthor">Migault, D.</span>, <span class="refTitle">"LURK Protocol version 1"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mglt-lurk-lurk-00</span>, <time datetime="2018-02-09" class="refDate">9 February 2018</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-mglt-lurk-lurk-00.txt">https://www.ietf.org/archive/id/draft-mglt-lurk-lurk-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mglt-lurk-tls-use-cases">[I-D.mglt-lurk-tls-use-cases]</dt>
        <dd>
<span class="refAuthor">Migault, D.</span>, <span class="refAuthor">J, K. M.</span>, <span class="refAuthor">Salz, R.</span>, <span class="refAuthor">Mishra, S.</span>, and <span class="refAuthor">O. G. D. Dios</span>, <span class="refTitle">"LURK TLS/DTLS Use Cases"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mglt-lurk-tls-use-cases-02</span>, <time datetime="2016-06-28" class="refDate">28 June 2016</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-mglt-lurk-tls-use-cases-02.txt">https://www.ietf.org/archive/id/draft-mglt-lurk-tls-use-cases-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.rescorla-tls-subcerts">[I-D.rescorla-tls-subcerts]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Iyengar, S.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Delegated Credentials for TLS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-rescorla-tls-subcerts-02</span>, <time datetime="2017-10-30" class="refDate">30 October 2017</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-rescorla-tls-subcerts-02.txt">https://www.ietf.org/archive/id/draft-rescorla-tls-subcerts-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.sheffer-acme-star-request">[I-D.sheffer-acme-star-request]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Lopez, D.</span>, <span class="refAuthor">Dios, O. G. D.</span>, <span class="refAuthor">Perales, A. A. P.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Generating Certificate Requests for Short-Term, Automatically-Renewed (STAR) Certificates"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-sheffer-acme-star-request-02</span>, <time datetime="2018-06-29" class="refDate">29 June 2018</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-sheffer-acme-star-request-02.txt">https://www.ietf.org/archive/id/draft-sheffer-acme-star-request-02.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8235">[RFC8235]</dt>
      <dd>
<span class="refAuthor">Hao, F., Ed.</span>, <span class="refTitle">"Schnorr Non-interactive Zero-Knowledge Proof"</span>, <span class="seriesInfo">RFC 8235</span>, <span class="seriesInfo">DOI 10.17487/RFC8235</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8235">https://www.rfc-editor.org/info/rfc8235</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Daniel Migault</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div dir="auto" class="left"><span class="street-address">8275 Trans Canada Route</span></div>
<div dir="auto" class="left">
<span class="locality">Saint Laurent, QC</span>  <span class="postal-code">4S 0B6</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:daniel.migault@ericsson.com" class="email">daniel.migault@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ioana Boureanu</span></div>
<div dir="auto" class="left"><span class="org">University of Surrey</span></div>
<div dir="auto" class="left"><span class="street-address">Stag Hill Campus</span></div>
<div dir="auto" class="left"><span class="locality">Guildford</span></div>
<div dir="auto" class="left"><span class="postal-code">GU2 7XH</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:i.boureanu@surrey.ac.uk" class="email">i.boureanu@surrey.ac.uk</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
