<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Requirements and Analysis of Media
    Security Key Management Protocols</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Requirements and Analysis of Media
    Security Key Management Protocols">
<meta name="keywords" content="I-D, Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SIP</td><td class="header">D. Wing</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">S. Fries</td></tr>
<tr><td class="header">Expires: March 31, 2008</td><td class="header">Siemens AG</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">F. Audet</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nortel</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">September 28, 2007</td></tr>
</table></td></tr></table>
<h1><br />Requirements and Analysis of Media
    Security Key Management Protocols<br />draft-ietf-sip-media-security-requirements-00.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on March 31, 2008.</p>

<h3>Abstract</h3>

<p>A number of proposals have been published to address the need of
      securing media traffic. A summary of the proposals available at that
      time is available in the appendix of this document. Different
      assumptions, requirements, and usage environments justify every one of
      them. This document aims to summarize the discussed media security
      requirements. A comparison of the requirements against the individual
        proposals is provided.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#scenarios">3.</a>&nbsp;
Call Scenarios<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#clipping">3.1.</a>&nbsp;
Clipping Media Before Signaling Answer<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#forking">3.2.</a>&nbsp;
Retargeting and Forking<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#conferencing">3.3.</a>&nbsp;
Shared Key Conferencing<br />
<a href="#requirements">4.</a>&nbsp;
Requirements<br />
<a href="#clustering">5.</a>&nbsp;
Requirements Classification<br />
<a href="#security">6.</a>&nbsp;
Security Considerations<br />
<a href="#iana">7.</a>&nbsp;
IANA Considerations<br />
<a href="#acks">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#comparison">Appendix&nbsp;A.</a>&nbsp;
Overview of Keying Mechanisms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">A.1.</a>&nbsp;
Signaling Path Keying Techniques<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">A.1.1.</a>&nbsp;
MIKEY-NULL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">A.1.2.</a>&nbsp;
MIKEY-PSK<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">A.1.3.</a>&nbsp;
MIKEY-RSA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">A.1.4.</a>&nbsp;
MIKEY-RSA-R<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">A.1.5.</a>&nbsp;
MIKEY-DHSIGN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">A.1.6.</a>&nbsp;
MIKEY-DHHMAC<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">A.1.7.</a>&nbsp;
MIKEY-ECIES and MIKEY-ECMQV (MIKEY-ECC)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sdesc">A.1.8.</a>&nbsp;
Security Descriptions with SIPS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">A.1.9.</a>&nbsp;
Security Descriptions with S/MIME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">A.1.10.</a>&nbsp;
SDP-DH (expired)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mikey2-sdp">A.1.11.</a>&nbsp;
MIKEYv2 in SDP (expired)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">A.2.</a>&nbsp;
Media Path Keying Technique<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">A.2.1.</a>&nbsp;
ZRTP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">A.3.</a>&nbsp;
Signaling and Media Path Keying Techniques<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">A.3.1.</a>&nbsp;
EKT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dtls-srtp">A.3.2.</a>&nbsp;
DTLS-SRTP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mikey2-inband">A.3.3.</a>&nbsp;
MIKEYv2 Inband (expired)<br />
<a href="#anchor18">Appendix&nbsp;B.</a>&nbsp;
Evaluation Criteria - SIP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#retargeting">B.1.</a>&nbsp;
Secure Retargeting and Secure Forking<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">B.2.</a>&nbsp;
Clipping Media Before SDP Answer<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">B.3.</a>&nbsp;
Centralized Keying<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">B.4.</a>&nbsp;
SSRC and ROC<br />
<a href="#anchor22">Appendix&nbsp;C.</a>&nbsp;
Evaluation Criteria - Security<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">C.1.</a>&nbsp;
Public Key Infrastructure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">C.2.</a>&nbsp;
Perfect Forward Secrecy<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">C.3.</a>&nbsp;
Best Effort Encryption<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">C.4.</a>&nbsp;
Upgrading Algorithms<br />
<a href="#ofs">Appendix&nbsp;D.</a>&nbsp;
Out-of-Scope<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The work on media security started a long time ago where the
      capability of the Session Initiation Protocol (SIP) was still at its
      infancy. With the increased SIP deployment and the availability of new
      SIP extensions and related protocols the need for end-to-end security
      was re-evaluated. The procedure of re-evaluating prior protocol work and
      design decisions is not an uncommon strategy and, to some extend,
      considered necessary protocol work to ensure that the developed
      protocols indeed meet the previously envisioned needs for the users in
      the Internet.
</p>
<p>This document aims to summarize the discussed media security requirements, i.e.,
        requirements for mechanisms that negotiate keys and parameters for SRTP. The organization of
        this document is as follows: <a class='info' href='#terminology'>Section&nbsp;2<span> (</span><span class='info'>Terminology</span><span>)</span></a> introduces terminology, <a class='info' href='#scenarios'>Section&nbsp;3<span> (</span><span class='info'>Call Scenarios</span><span>)</span></a> provides an overview about possible call scenarios, <a class='info' href='#requirements'>Section&nbsp;4<span> (</span><span class='info'>Requirements</span><span>)</span></a> lists requirements for media security, <a class='info' href='#clustering'>Section&nbsp;5<span> (</span><span class='info'>Requirements Classification</span><span>)</span></a>
        will provide a clustering of requirements to certain deployment environments to adress the
        problem that there might not be a single solution with universal applicability. The main
        part of the document concludes with the security considerations <a class='info' href='#security'>Section&nbsp;6<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>,
        IANA considerations <a class='info' href='#iana'>Section&nbsp;7<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a> and an acknowledgement section in <a class='info' href='#acks'>Section&nbsp;8<span> (</span><span class='info'>Acknowledgements</span><span>)</span></a>. The appendix contains an overview of the <a class='info' href='#comparison'>Appendix&nbsp;A<span> (</span><span class='info'>Overview of Keying Mechanisms</span><span>)</span></a>
        lists the available solution proposals and compares them to the requirements. <a class='info' href='#ofs'>Appendix&nbsp;D<span> (</span><span class='info'>Out-of-Scope</span><span>)</span></a> lists non-goals for this document.
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>, with the important qualification that, unless
      otherwise stated, these terms apply to the design of the media security
      key management protocol, not its implementation or application.
</p>
<p>Additionally, the following items are used in this document:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>AOR (Address-of-Record): </dt>
<dd>A SIP or SIPS URI that
          points to a domain with a location service that can map the URI to
          another URI where the user might be available. Typically, the
          location service is populated through registrations. An AOR is
          frequently thought of as the "public address" of the user.
</dd>
<dt>SSRC: </dt>
<dd>The 32-bit value that defines the
          synchronization source, used in RTP. These are generally unique, but
          collisions can occur.
</dd>
<dt>two-time pad: </dt>
<dd>The use of the same key and the same
          key index to encrypt different data. For SRTP, a two-time pad occurs
          if two senders are using the same key and the same RTP SSRC
          value.
</dd>
<dt>PKI</dt>
<dd>Public Key Infrastructure. Throughout this paper,
          the term PKI refers to a global PKI.
</dd>
</dl></blockquote>

<a name="scenarios"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Call Scenarios</h3>

<p>The following subsections describe call scenarios with relevance for
      media security. These call scenarios pose the most challenge to the key
      management for media data in cooperation with SIP signaling.
</p>
<a name="clipping"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Clipping Media Before Signaling Answer</h3>

<p>Per the SDP Offer/Answer Model <a class='info' href='#RFC3264'>[RFC3264]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;An Offer/Answer Model with Session Description Protocol (SDP),&rdquo; June&nbsp;2002.</span><span>)</span></a>,
</p>
<p></p>
<blockquote class="text">
<p>"Once the offerer has sent the offer, it MUST be prepared to
            receive media for any recvonly streams described by that offer. It
            MUST be prepared to send and receive media for any sendrecv
            streams in the offer, and send media for any sendonly streams in
            the offer (of course, it cannot actually send until the peer
            provides an answer with the needed address and port
            information)."
</p>
</blockquote>

<p>To meet this requirement with SRTP, the offerer needs to know the
        SRTP key for arriving media. If encrypted SRTP media arrives before
        the associated SRTP key, the offerer cannot play the media -- causing
        clipping.
</p>
<p>For key exchange mechanisms that send the answerer's key in SDP, a
        SIP provisional response <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>, such as 183
        (session progress), is useful. However, the 183 messages are not
        reliable unless both the calling and called end point support PRACK
        <a class='info' href='#RFC3262'>[RFC3262]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;Reliability of Provisional Responses in Session Initiation Protocol (SIP),&rdquo; June&nbsp;2002.</span><span>)</span></a>, use TCP across all SIP proxies,
        implement Security Preconditions <a class='info' href='#I-D.ietf-mmusic-securityprecondition'>[I&#8209;D.ietf&#8209;mmusic&#8209;securityprecondition]<span> (</span><span class='info'>Andreasen, F. and D. Wing, &ldquo;Security Preconditions for Session Description Protocol (SDP) Media  Streams,&rdquo; July&nbsp;2007.</span><span>)</span></a>, or the both
        ends implement ICE <a class='info' href='#I-D.ietf-mmusic-ice'>[I&#8209;D.ietf&#8209;mmusic&#8209;ice]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols,&rdquo; October&nbsp;2007.</span><span>)</span></a> and the
        answerer implements the reliable provisional response mechanism
        described in ICE. Unfortunately, there is not wide deployment of any
        of these techniques and there is industry reluctance to set
        requirements regarding these techniques to avoid the problem described
        in this section.
</p>
<p>Note that the receipt of an SDP answer is not always sufficient to
        allow media to be played to the offerer. Sometimes, the offerer must
        send media in order to open up firewall holes or NAT bindings before
        media can be received. In this case a solution that makes the key
        available before the SDP answer arrives will not help.
</p>
<p>Requirements are created due to early media, in the sense of
        pre-offer/answer media, as described in <a class='info' href='#I-D.barnes-sip-em-ps-req-sol'>[I&#8209;D.barnes&#8209;sip&#8209;em&#8209;ps&#8209;req&#8209;sol]<span> (</span><span class='info'>Barnes, R. and M. Lepinski, &ldquo;Early Media in SIP: Problem Statement, Requirements, and Analysis of  Solutions,&rdquo; February&nbsp;2007.</span><span>)</span></a>. Fixes to early media
        might make the requirements to become obsolete, but at the time of
        writing no progress has been accomplished.
</p>
<a name="forking"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Retargeting and Forking</h3>

<p>In SIP, a request sent to a specific AOR but delivered to a
        different AOR is called a "retarget". A typical scenario is a "call
        forwarding" feature. In <a class='info' href='#retargeting_figure'>Figure&nbsp;1<span> (</span><span class='info'>Retargeting</span><span>)</span></a>
        Alice sends an Invite in step 1 that is sent to Bob in step 2. Bob
        responds with a redirect (SIP response code 3xx) pointing to Carol in
        step 3. This redirect typically does not propagate back to Alice but
        only goes to a proxy (i.e., the retargeting proxy) that sends the
        original Invite to Carol in step 4.
</p>
<p><br /><hr class="insert" />
<a name="retargeting_figure"></a>
</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                +-----+
                |Alice|
                +--+--+
                   |
                   | Invite (1)
                   V
              +----+----+
              |  proxy  |
              ++-+-----++
               | ^     |
    Invite (2) | |     | Invite (4)
&amp; redirect (3) | |     |
               V |     V
              ++-++   ++----+
              |Bob|   |Carol|
              +---+   +-----+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Retargeting&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<p>The mechanism used by SIP for identifying the calling party is SIP
        Identity <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>. However, due to SIP
        retargeting issues <a class='info' href='#I-D.peterson-sipping-retarget'>[I&#8209;D.peterson&#8209;sipping&#8209;retarget]<span> (</span><span class='info'>Peterson, J., &ldquo;Retargeting and Security in SIP: A Framework and Requirements,&rdquo; February&nbsp;2005.</span><span>)</span></a>, SIP Identity can only
        identify the calling party (that is, the party that initiated the SIP
        request). Some key exchange mechanisms predate SIP Identity and
        include their own identity mechanism. However, those built-in identity
        mechanism suffer from the same SIP retargeting problem described in
        the above draft. Going forward, <a class='info' href='#RFC4916'>Connected Identity<span> (</span><span class='info'>Elwell, J., &ldquo;Connected Identity in the Session Initiation Protocol (SIP),&rdquo; June&nbsp;2007.</span><span>)</span></a> [RFC4916]
        allows identifying the called party.  This is also described as
        the 'retargeting identity' problem.
</p>
<p>In SIP, 'forking' is the delivery of a request to multiple
        locations. This happens when a single AOR is registered more than
        once. An example of forking is when a user has a desk phone, PC
        client, and mobile handset all registered with the same AOR.
</p>
<p><br /><hr class="insert" />
<a name="forking_figure"></a>
</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
         +-----+
         |Alice|
         +--+--+
            |
            | Invite
            V
      +-----+-----+
      |   proxy   |
      ++---------++
       |         |
Invite |         | Invite
       V         V
    +--+--+   +--+--+
    |Bob-1|   |Bob-2|
    +-----+   +-----+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Forking&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<p>With forking, both Bob-1 and Bob-2 might send back SDP answers in
        SIP responses. Alice will see those intermediate (18x) and final (200)
        responses. It is useful for Alice to be able to associate the SIP
        response with the incoming media stream. Although this association can
        be done with ICE <a class='info' href='#I-D.ietf-mmusic-ice'>[I&#8209;D.ietf&#8209;mmusic&#8209;ice]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols,&rdquo; October&nbsp;2007.</span><span>)</span></a>, and ICE
        is useful to make this association with RTP, it is not desirable to
        require ICE to accomplish this association.
</p>
<p>Forking and retargeting are often used together. For example, a
        boss and secretary might have both phones ring and rollover to voice
        mail if neither phone is answered.
</p>
<p>To maintain security of the media traffic, only the end point that
        answers the call should know the SRTP keys for the session. This is
        only an issue with public key encryption and not with DH-based
        approaches. For key exchange mechanisms that do not provide secure
        forking or secure retargeting, one workaround is to re-key immediately
        after forking or retargeting (that is, perform a re-Invite). However,
        because the originator may not be aware that the call forked this
        mechanism requires rekeying immediately after every session is
        established. This doubles the Invite messages processed by the
        network.
</p>
<p>Retargeting securely introduces a more significant problem. With
        retargeting, the actual recipient of the request is not the original
        recipient. This means that if the offerer encrypted material (such as
        the session key or the SDP) using the original recipient's public key,
        the actual recipient will not be able to decrypt that material because
        the recipient won't have the original recipient's private key. In some
        cases, this is the intended behavior, i.e., you wanted to establish a
        secure connection with a specific individual. In other cases, it is
        not intended behavior (you want all voice media to be encrypted,
        regardless of who answers).
</p>
<p>For some forms of key management the calling party needs to know in
        advance the certificate or shared secret of the called party, and
        retargeting can interfere with this.
</p>
<p>Further compounding this problem is a particularity of SIP that
        when forking is used, there is always only one final error response
        delivered to the sender of the request: the forking proxy is
        responsible for choosing which final response to choose in the event
        where forking results in multiple final error responses being received
        by the forking proxy. This means that if a request is rejected, say
        with information that the keying information was rejected and
        providing the far end's credentials, it is very possible that the
        rejection will never reach the sender. This problem, called the <a class='info' href='#I-D.mahy-sipping-herfp-fix'>Heterogeneous Error Response
        Forking Problem (HERFP)<span> (</span><span class='info'>Mahy, R., &ldquo;A Solution to the Heterogeneous Error Response Forking Problem (HERFP) in  the Session Initiation Protocol (SIP),&rdquo; March&nbsp;2006.</span><span>)</span></a> [I&#8209;D.mahy&#8209;sipping&#8209;herfp&#8209;fix], is difficult to solve in SIP.
</p>
<a name="conferencing"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Shared Key Conferencing</h3>

<p>For efficient scaling, large audio and video conference bridges
        operate most efficiently by encrypting the current speaker once and
        distributing that stream to the conference attendees. Typically,
        inactive participants receive the same streams -- they hear (or see)
        the active speaker(s), and the active speakers receive distinct
        streams that don't include themselves. In order to maintain
        confidentiality of such conferences where listeners share a common
        key, all listeners must rekeyed when a listener joins or leaves a
        conference.
</p>
<p>An important use case for mixers/translators is a conference
        bridge:
</p>
<p><br /><hr class="insert" />
<a name="figure_centralized_keying"></a>
</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
            +----+
A --- 1 ---&gt;|    |
  &lt;-- 2 ----| M  |
            | I  |
B --- 3 ---&gt;| X  |
  &lt;-- 4 ----| E  |
            | R  |
C --- 5 ---&gt;|    |
  &lt;-- 6 ----|    |
            +----+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Centralized Keying&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<p>In the figure above, 1, 3, and 5 are RTP media contributions from
        Alice, Bob, and Carol, and 2, 4, and 6 are the RTP flows to those
        devices carrying the 'mixed' media.
</p>
<p>Several scenarios are possible:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>Multiple inbound sessions: 1, 3, and 5 are distinct RTP
            sessions,
</dd>
<dt>b.</dt>
<dd>Multiple outbound sessions: 2, 4, and 6 are distinct RTP
            sessions,
</dd>
<dt>c.</dt>
<dd>Single inbound session: 1, 3, and 5 are just different sources
            within the same RTP session,
</dd>
<dt>d.</dt>
<dd>Single outbound session: 2, 4, and 6 are different flows of the
            same (multi-unicast) RTP session
</dd>
</dl></blockquote>

<p>If there are multiple inbound sessions and multiple outbound
        sessions (scenarios a and b), then every keying mechanism behaves as
        if the mixer were an end point and can set up a point-to-point secure
        session between the participant and the mixer. This is the simplest
        situation, but is computationally wasteful, since SRTP processing has
        to be done independently for each participant. The use of multiple
        inbound sessions (scenario a) doesn't waste computational resources,
        though it does consume additional cryptographic context on the mixer
        for each participant and has the advantage of non-repudiation of the
        originator of the incoming stream.
</p>
<p>To support a single outbound session (scenario d), the mixer has to
        dictate its encryption key to the participants. Some keying mechanisms
        allow the transmitter to determine its own key, and others allow the
        offerer to determine the key for the offerer and answerer. Depending
        on how the call is established, the offerer might be a participant
        (such as a participant dialing into a conference bridge) or the
        offerer might be the mixer (such as a conference bridge calling a
        participant). The use of offerless Invites may help some keying
        mechanisms reverse the role of offerer/answerer. A difficulty,
        however, is knowing a priori if the role should be reversed for a
        particular call.
</p>
<a name="requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Requirements</h3>

<p></p>
<blockquote class="text"><dl>
<dt>R1:</dt>
<dd>Negotiation of SRTP keys MUST NOT cause the call
          setup to fail in forked and retargeted calls where all end points
          are willing to use SRTP, unless the execution of the authentication
          and key exchange protocol leads to a failure (e.g., an unsuccessful
          authentication attempt).
</dd>
<dt>R2:</dt>
<dd>Even when some end points of a forked or retargeted call are
          incapable of using SRTP, the key management protocol MUST allow the
          establishment of SRTP associations with SRTP-capable endpoints and /
          or RTP associations with non-SRTP-capable endpoints.
</dd>
<dt>R3:</dt>
<dd>Forked end points MUST NOT know the SRTP key of
          any call established with another forked end point.
</dd>
<dt>R4:</dt>
<dd>The media security key management protocol MAY
          support the ability to utilize an initially established security
          context that was established as part of the first call setup with a
          remote end point.<br />
 Specialized devices may
          need to avoid public key operations or Diffie-Hellman operations as
          much as possible because of the computational cost or because of the
          additional call setup delay. For example, it can take a second or
          two to perform a Diffie-Hellman operation in certain devices.
          Examples of these specialized devices would include some handsets,
          intelligent SIMs, and PSTN gateways. For the typical case because a
          phone call has not yet been established, ancillary processing cycles
          can be utilized to perform the PK or DH operation; for example, in a
          PSTN gateway the DSP, which is not yet involved with typical DSP
          operations, could be used to perform the calculation, so as to avoid
          having the central host processor perform the calculation. Some
          devices, such as handsets, and intelligent SIMs do not have such
          ancillary processing capability.
</dd>
<dt>R5:</dt>
<dd>The media security key management protocol SHOULD
          avoid clipping media before SDP answer without requiring PRACK <a class='info' href='#RFC3262'>[RFC3262]<span> (</span><span class='info'>Rosenberg, J. and H. Schulzrinne, &ldquo;Reliability of Provisional Responses in Session Initiation Protocol (SIP),&rdquo; June&nbsp;2002.</span><span>)</span></a>.
</dd>
<dt>R6:</dt>
<dd>The media security key management protocol MUST
          provide protection against passive attacks on the media path.
</dd>
<dt>R7:</dt>
<dd>The media security key management protocol MUST
          provide protection against passive attacks of a SIP proxy that is
          legitimately routing SIP messages.
</dd>
<dt>R8:</dt>
<dd>The media security key management protocol MUST be
          able to support perfect forward secrecy (or PFS). The term PFS is
          the property that disclosure of the long-term secret keying material
          that is used to derive an agreed ephemeral key does not compromise
          the secrecy of agreed keys from earlier runs.
</dd>
<dt>R9:</dt>
<dd>The media security key management protocol MUST
          support negotiation of SRTP cipher suites without incurring
          per-algorithm computational expense. This allows an offer to be
          built without incurring computational expense for each
          algorithm.
</dd>
<dt>R10:</dt>
<dd>If SRTP keying is performed over the media path,
          the keying packets MUST NOT pass the RTP validity check defined in
          Appendix A.1 of <a class='info' href='#RFC3550'>[RFC3550]<span> (</span><span class='info'>Schulzrinne, H., Casner, S., Frederick, R., and V. Jacobson, &ldquo;RTP: A Transport Protocol for Real-Time Applications,&rdquo; July&nbsp;2003.</span><span>)</span></a>.
</dd>
<dt>R11:</dt>
<dd>The media security key management protocol that
          utilizes expensive cryptographic computations SHOULD offer the
          ability to resume previous sessions in an efficient way. 
</dd>
<dt>R12:</dt>
<dd>The media security key management protocol MUST
          NOT require 3rd parties to sign certificates.<br />
This requirement points to the fact that a global
          PKI cannot be assumed and opportunistic security approaches should
          be considered as part of the solution.
</dd>
<dt>R13:</dt>
<dd>The media security key management protocol SHOULD
          use algorithms that allow <a class='info' href='#FIPS-140-2'>FIPS
          140-2<span> (</span><span class='info'>NIST, &ldquo;Security Requirements for Cryptographic Modules,&rdquo; June&nbsp;2005.</span><span>)</span></a> [FIPS&#8209;140&#8209;2] certification. <br />
 Note that the
          United States Government can only purchase and use crypto
          implementations that have been validated by the <a class='info' href='#FIPS-140-2'>FIPS-140<span> (</span><span class='info'>NIST, &ldquo;Security Requirements for Cryptographic Modules,&rdquo; June&nbsp;2005.</span><span>)</span></a> [FIPS&#8209;140&#8209;2] process: <br />
<br />
 "The FIPS-140 standard is applicable to all
          Federal agencies that use cryptographic-based security systems to
          protect sensitive information in computer and telecommunication
          systems, including voice systems. The adoption and use of this
          standard is available to private and commercial organizations."<a class='info' href='#cryptval'>[cryptval]<span> (</span><span class='info'>NIST, &ldquo;Cryptographic Module Validation Program,&rdquo; December&nbsp;2006.</span><span>)</span></a> <br />
<br />
 Some commercial
          organizations, such as banks and defense contractors, also require
          or prefer equipment which has validated by the FIPS-140 process.
</dd>
<dt>R14:</dt>
<dd>The media security key management protocol SHOULD
          be able to associate the signaling exchange with the media
          traffic.<br />

For example, if using a Diffie-Hellman keying technique with
          security preconditions that forks to 20 end points, the call
          initiator would get 20 provisional responses containing 20 signed
          Diffie-Hellman key pairs. Calculating 20 DH secrets and validating
          signatures can be a difficult task depending on the device
          capabilities. Hence, in the case of forking, it is not desirable to
          perform a DH or PK operation with every party, but rather only with
          the party that answers the call (and incur some media clipping). To
          do this, the signaling and media need to be associated so the
          calling party knows which key management needs to be completed. This
          might be done by using the transport address indicated in the SDP,
          although NATs can complicate this association.
<br />
<br />

Allowing such an association also allows the SDP offerer to avoid performing
CPU-consuming operations (e.g., DH or public key operations) with attackers
that have not seen the signaling messages.

</dd>
<dt>R15:</dt>
<dd>The media security key management protocol SHOULD
          allow to start with RTP and then upgrade to SRTP. 
</dd>
<dt>R16:</dt>
<dd>The media security key management protocol SHOULD
          NOT introduce new denial of service vulnerabilities.
</dd>
<dt>R17:</dt>
<dd>The media security key management protocol SHOULD
          require the adversary to have access to the data as well as the
          signaling path for a successful attack to be launched. An adversary
          that is located only along the data or only along the signaling path
          MUST NOT be able to successfully mount an attack. A successful
          attack refers to the ability for the adversary to obtain keying
          material to decrypt the SRTP encrypted media traffic.
</dd>
<dt>R18:</dt>
<dd>If two parties share an authentication
          infrastructure that has 3rd parties signing certificates, they
          SHOULD be able to make use of it.
</dd>
<dt>R19:</dt>
<dd>The media security key management protocol MUST
          provide crypto-agility.
</dd>
<dt>R20:</dt>
<dd>The media security key management protocol MUST
          protect cipher suite negotiation against downgrading attacks.
</dd>
<dt>R21:</dt>
<dd>The media security key management protocol MUST
          allow a SIP User Agent to negotiate media security parameters for
          each individual session.
</dd>
<dt>R22:</dt>
<dd>The media security key management protocol SHOULD
          allow establishing SRTP keying between different call signaling
          protocols (e.g., between Jabber, SIP, H.323, MGCP)
</dd>
<dt>R23:</dt>
<dd>The media security key management protocol SHOULD
          support recording of decrypted media.<br />
 Media
          recording may be realized by an intermediate nodes. An example for
          those intermediate nodes are devices, which could be used in banking
          applications or for quality monitoring in call centers. Here, it
          must be ensured, that the media security is ensured by the
          intermediate nodes on the connections to the involved endpoints as
          originally negotiated. The endpoints need to be informed that there
          is an intermediate device and need to cooperate. A solution approach
          for this is described in <a class='info' href='#I-D.wing-sipping-srtp-key'>[I&#8209;D.wing&#8209;sipping&#8209;srtp&#8209;key]<span> (</span><span class='info'>Wing, D., Audet, F., Fries, S., Tschofenig, H., and A. Johnston, &ldquo;Secure Media Recording and Transcoding with the Session Initiation  Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a>.
</dd>
<dt>R24:</dt>
<dd>The media security key management protocol SHOULD
          NOT allow end users to determine whether their end-to-end
          interaction is subject to lawful interception.
</dd>
<dt>R25:</dt>
<dd>The media security key management protocol MUST
          work when there are intermediate nodes, terminating or processing
          media, between the end points.
</dd>
<dt>R26:</dt>
<dd>The media security key management protocol MUST
          consider termination of media security in a PSTN gateway.<br />
A typical case of using media security is the one
          where two entities are having a VoIP conversation over IP capable
          networks. However, there are cases where the other end of the
          communication is not connected to an IP capable network. In this
          kind of setting, there needs to be some kind of gateway at the edge
          of the IP network which converts the VoIP conversation to format
          understood by the other network. An example of such gateway is a
          PSTN gateway sitting at the edge of IP and PSTN networks.<br />
<br />
If media security (e.g., SRTP protection) is
          employed in this kind of gateway-setting, then media security and
          the related key management needs to be terminated at the gateway.
          The other network (e.g., PSTN) may have its own measures to protect
          the communication, but this means that from media security point of
          view the media security is not employed end-to-end between the
          communicating entities.
</dd>
</dl></blockquote>

<a name="clustering"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Requirements Classification</h3>

<p>An adversary might be located along </p>
<ol class="text">
<li>the media path,
</li>
<li>the signaling path,
</li>
<li>the media and the signaling path.
</li>
</ol>

<p>An attacker that can solely be located along the signaling path, and
      does not have access to media, is not considered (ref item 2).
</p>
<p>Furthermore, it is reasonable to consider the capabilities of the
      adversary. We also have different types of adversaries, namely </p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>active adversary
</dd>
<dt>b.</dt>
<dd>passive adversary
</dd>
</dl></blockquote>

<p>Note that the adversary model for (a) and (b) also assumes the
      attacker being able to control SIP signaling entities.
</p>
<p>With respect to item (a) an adversary may need to be active with
      regard to the key exchange relevant information traveling along the data
      or the signaling path.
</p>
<p>Some of the deployment variants of the media security key management
      proposals under considerations do not provide protection against
      man-in-the-middle adversaries under certain conditions, for example when
      SIP signaling entities are compromised, when a global PKI is missing or
      pre-shared secrets are not exchanged between the end points prior to the
      protocol exchange.
</p>
<p>Based on the above-mentioned considerations the following
      classifications can be made: </p>
<blockquote class="text"><dl>
<dt>Class I:</dt>
<dd><br />
 Passive attack on
          the signaling and the data path sufficient to reveal the content of
          the media traffic. <br />
<br />

</dd>
<dt>Class II:</dt>
<dd><br />
 Active attack on
          the signaling path and passive attack on the data path to reveal the
          content of the media traffic. <br />
<br />

</dd>
<dt>Class III:</dt>
<dd><br />
 Active attack on
          the signaling and the data path necessary to reveal the content of
          the media traffic. <br />
<br />

</dd>
<dt>Class IV:</dt>
<dd><br />
 Active attack is
          required and will be detected by the end points when adversary
          tampers with the messages.
</dd>
</dl></blockquote>

<p>For example, SDES falls into Class I since the adversary needs to
      learn the SDES key by progressing a signaling message at a SIP proxy
      (assuming that the adversary is in control of the SIP proxy). Subsequent
      media traffic can be decrypted with the help of the learned key.
</p>
<p>As another example, DTLS-RTP falls into Class III when DTLS is used a
      public key based ciphersuite with self-signed certificates and without
      SIP Identity. An adversary would have to modify the fingerprint that is
      sent along the signaling path and subsequently to modify the
      certificates carried in the DTLS handshake that travel along the media
      path.
</p>
<p>An attack is not successful when SIP Identity is used, the adversary
      is not between the SIP UA and its Authentication Service (or at the
      Authentication Service), both end points are able to verify the digital
      signature (of the SIP Identity) and are able to validate the
      corresponding certificates.
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>This document lists requirements for securing media traffic. As such,
      it addresses security throughout the document.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This document does not require actions by IANA.
</p>
<a name="acks"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>For contributions to the requirements portion of this document, the authors
      would like to thank the active participants of the RTPSEC
      BoF and on the RTPSEC mailing list. The authors would furthermore like
      to thank Wolfgang Buecker, Guenther Horn, Peter Howard, Hans-Heinrich
      Grusdt, Srinath Thiruvengadam, Martin Euchner, Eric Rescorla, Matt
      Lepinski, Dan York, Werner Dittmann, Richard Barnes, Vesa Lehtovirta,
      Colin Perkins, Peter Schneider, and Christer Holmberg for their feedback
      to this document.
</p>
<p>For contributions to the analysis portion of this document,
      the authors would like to thank Special thanks to Steffen Fries and Dragan
     Ignjatic for their
      excellent <a class='info' href='#I-D.ietf-msec-mikey-applicability'>MIKEY
      comparison document<span> (</span><span class='info'>Fries, S. and D. Ignjatic, &ldquo;On the applicability of various MIKEY modes and extensions,&rdquo; March&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;msec&#8209;mikey&#8209;applicability]. The authors would furthermore like to thank
Cullen Jennings, David Oran,
      David McGrew, Mark Baugher, Flemming Andreasen, Eric Raymond, Dave Ward,
      Leo Huang, Eric Rescorla, Lakshminath Dondeti, Steffen Fries, Alan
      Johnston, Dragan Ignjatic and John Elwell for their feedback to this
      document.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS-140-2">[FIPS-140-2]</a></td>
<td class="author-text">NIST, &ldquo;<a href="http://csrc.nist.gov/publications/fips/fips140-2/fips1402.pdf">Security Requirements for Cryptographic Modules</a>,&rdquo; June&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3262">[RFC3262]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3262">Reliability of Provisional Responses in Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;3262, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3262.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3264">[RFC3264]</a></td>
<td class="author-text">Rosenberg, J. and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3264">An Offer/Answer Model with Session Description Protocol (SDP)</a>,&rdquo; RFC&nbsp;3264, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3264.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3711">[RFC3711]</a></td>
<td class="author-text">Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;<a href="http://tools.ietf.org/html/rfc3711">The Secure Real-time Transport Protocol (SRTP)</a>,&rdquo; RFC&nbsp;3711, March&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3711.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="cryptval">[cryptval]</a></td>
<td class="author-text">NIST, &ldquo;<a href="http://csrc.nist.gov/cryptval/140-2APP.htm">Cryptographic Module Validation Program</a>,&rdquo; December&nbsp;2006.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.barnes-sip-em-ps-req-sol">[I-D.barnes-sip-em-ps-req-sol]</a></td>
<td class="author-text">Barnes, R. and M. Lepinski, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-barnes-sip-em-ps-req-sol-00.txt">Early Media in SIP: Problem Statement, Requirements, and Analysis of  Solutions</a>,&rdquo; draft-barnes-sip-em-ps-req-sol-00 (work in progress), February&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-barnes-sip-em-ps-req-sol-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.baugher-mmusic-sdp-dh">[I-D.baugher-mmusic-sdp-dh]</a></td>
<td class="author-text">Baugher, M. and D. McGrew, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-baugher-mmusic-sdp-dh-00.txt">Diffie-Hellman Exchanges for Multimedia Sessions</a>,&rdquo; draft-baugher-mmusic-sdp-dh-00 (work in progress), February&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-baugher-mmusic-sdp-dh-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.dondeti-msec-rtpsec-mikeyv2">[I-D.dondeti-msec-rtpsec-mikeyv2]</a></td>
<td class="author-text">Dondeti, L., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-dondeti-msec-rtpsec-mikeyv2-01.txt">MIKEYv2: SRTP Key Management using MIKEY, revisited</a>,&rdquo; draft-dondeti-msec-rtpsec-mikeyv2-01 (work in progress), March&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-dondeti-msec-rtpsec-mikeyv2-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.fischl-sipping-media-dtls">[I-D.fischl-sipping-media-dtls]</a></td>
<td class="author-text">Fischl, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-fischl-sipping-media-dtls-03.txt">Datagram Transport Layer Security (DTLS) Protocol for Protection of Media  Traffic Established with the Session Initiation Protocol</a>,&rdquo; draft-fischl-sipping-media-dtls-03 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-fischl-sipping-media-dtls-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mmusic-ice">[I-D.ietf-mmusic-ice]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-19.txt">Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols</a>,&rdquo; draft-ietf-mmusic-ice-19 (work in progress), October&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-19.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mmusic-sdp-capability-negotiation">[I-D.ietf-mmusic-sdp-capability-negotiation]</a></td>
<td class="author-text">Andreasen, F., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-sdp-capability-negotiation-13.txt">SDP Capability Negotiation</a>,&rdquo; draft-ietf-mmusic-sdp-capability-negotiation-13 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-sdp-capability-negotiation-13.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mmusic-securityprecondition">[I-D.ietf-mmusic-securityprecondition]</a></td>
<td class="author-text">Andreasen, F. and D. Wing, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-securityprecondition-04.txt">Security Preconditions for Session Description Protocol (SDP) Media  Streams</a>,&rdquo; draft-ietf-mmusic-securityprecondition-04 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-securityprecondition-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-msec-mikey-applicability">[I-D.ietf-msec-mikey-applicability]</a></td>
<td class="author-text">Fries, S. and D. Ignjatic, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-msec-mikey-applicability-09.txt">On the applicability of various MIKEY modes and extensions</a>,&rdquo; draft-ietf-msec-mikey-applicability-09 (work in progress), March&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-msec-mikey-applicability-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-msec-mikey-ecc">[I-D.ietf-msec-mikey-ecc]</a></td>
<td class="author-text">Milne, A., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-msec-mikey-ecc-03.txt">ECC Algorithms for MIKEY</a>,&rdquo; draft-ietf-msec-mikey-ecc-03 (work in progress), June&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-msec-mikey-ecc-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sip-certs">[I-D.ietf-sip-certs]</a></td>
<td class="author-text">Jennings, C. and J. Fischl, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-certs-12.txt">Certificate Management Service for The Session Initiation Protocol (SIP)</a>,&rdquo; draft-ietf-sip-certs-12 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-certs-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.jennings-sipping-multipart">[I-D.jennings-sipping-multipart]</a></td>
<td class="author-text">Wing, D. and C. Jennings, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-jennings-sipping-multipart-02.txt">Session Initiation Protocol (SIP) Offer/Answer with Multipart Alternative</a>,&rdquo; draft-jennings-sipping-multipart-02 (work in progress), March&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-jennings-sipping-multipart-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.mahy-sipping-herfp-fix">[I-D.mahy-sipping-herfp-fix]</a></td>
<td class="author-text">Mahy, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-mahy-sipping-herfp-fix-01.txt">A Solution to the Heterogeneous Error Response Forking Problem (HERFP) in  the Session Initiation Protocol (SIP)</a>,&rdquo; draft-mahy-sipping-herfp-fix-01 (work in progress), March&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-mahy-sipping-herfp-fix-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.mcgrew-srtp-ekt">[I-D.mcgrew-srtp-ekt]</a></td>
<td class="author-text">McGrew, D., Andreasen, F., Wing, D., and L. Dondeti, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-mcgrew-srtp-ekt-06.txt">Encrypted Key Transport for Secure RTP</a>,&rdquo; draft-mcgrew-srtp-ekt-06 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-mcgrew-srtp-ekt-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.mcgrew-tls-srtp">[I-D.mcgrew-tls-srtp]</a></td>
<td class="author-text">Rescorla, E. and D. McGrew, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-mcgrew-tls-srtp-02.txt">Datagram Transport Layer Security (DTLS) Extension to Establish Keys for  Secure Real-time Transport Protocol (SRTP)</a>,&rdquo; draft-mcgrew-tls-srtp-02 (work in progress), March&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-mcgrew-tls-srtp-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.peterson-sipping-retarget">[I-D.peterson-sipping-retarget]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-peterson-sipping-retarget-00.txt">Retargeting and Security in SIP: A Framework and Requirements</a>,&rdquo; draft-peterson-sipping-retarget-00 (work in progress), February&nbsp;2005 (<a href="http://www.ietf.org/internet-drafts/draft-peterson-sipping-retarget-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.wing-sipping-srtp-key">[I-D.wing-sipping-srtp-key]</a></td>
<td class="author-text">Wing, D., Audet, F., Fries, S., Tschofenig, H., and A. Johnston, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-wing-sipping-srtp-key-04.txt">Secure Media Recording and Transcoding with the Session Initiation  Protocol</a>,&rdquo; draft-wing-sipping-srtp-key-04 (work in progress), October&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-wing-sipping-srtp-key-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.zimmermann-avt-zrtp">[I-D.zimmermann-avt-zrtp]</a></td>
<td class="author-text">Zimmermann, P., Johnston, A., and J. Callas, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-zimmermann-avt-zrtp-18.txt">ZRTP: Media Path Key Agreement for Unicast Secure RTP</a>,&rdquo; draft-zimmermann-avt-zrtp-18 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-zimmermann-avt-zrtp-18.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3388">[RFC3388]</a></td>
<td class="author-text">Camarillo, G., Eriksson, G., Holler, J., and H. Schulzrinne, &ldquo;<a href="http://tools.ietf.org/html/rfc3388">Grouping of Media Lines in the Session Description Protocol (SDP)</a>,&rdquo; RFC&nbsp;3388, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3388.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3550">[RFC3550]</a></td>
<td class="author-text">Schulzrinne, H., Casner, S., Frederick, R., and V. Jacobson, &ldquo;<a href="http://tools.ietf.org/html/rfc3550">RTP: A Transport Protocol for Real-Time Applications</a>,&rdquo; STD&nbsp;64, RFC&nbsp;3550, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3550.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc3550.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc3550.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3830">[RFC3830]</a></td>
<td class="author-text">Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;<a href="http://tools.ietf.org/html/rfc3830">MIKEY: Multimedia Internet KEYing</a>,&rdquo; RFC&nbsp;3830, August&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3830.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4346">[RFC4346]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc4346">The Transport Layer Security (TLS) Protocol Version 1.1</a>,&rdquo; RFC&nbsp;4346, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4346.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4474">[RFC4474]</a></td>
<td class="author-text">Peterson, J. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4474">Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4474, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4474.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4492">[RFC4492]</a></td>
<td class="author-text">Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;<a href="http://tools.ietf.org/html/rfc4492">Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)</a>,&rdquo; RFC&nbsp;4492, May&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4492.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4568">[RFC4568]</a></td>
<td class="author-text">Andreasen, F., Baugher, M., and D. Wing, &ldquo;<a href="http://tools.ietf.org/html/rfc4568">Session Description Protocol (SDP) Security Descriptions for Media Streams</a>,&rdquo; RFC&nbsp;4568, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4568.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4650">[RFC4650]</a></td>
<td class="author-text">Euchner, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4650">HMAC-Authenticated Diffie-Hellman for Multimedia Internet KEYing (MIKEY)</a>,&rdquo; RFC&nbsp;4650, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4650.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4738">[RFC4738]</a></td>
<td class="author-text">Ignjatic, D., Dondeti, L., Audet, F., and P. Lin, &ldquo;<a href="http://tools.ietf.org/html/rfc4738">MIKEY-RSA-R: An Additional Mode of Key Distribution in Multimedia Internet KEYing (MIKEY)</a>,&rdquo; RFC&nbsp;4738, November&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4738.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4771">[RFC4771]</a></td>
<td class="author-text">Lehtovirta, V., Naslund, M., and K. Norrman, &ldquo;<a href="http://tools.ietf.org/html/rfc4771">Integrity Transform Carrying Roll-Over Counter for the Secure Real-time Transport Protocol (SRTP)</a>,&rdquo; RFC&nbsp;4771, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4771.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4916">[RFC4916]</a></td>
<td class="author-text">Elwell, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4916">Connected Identity in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4916, June&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4916.txt">TXT</a>).</td></tr>
</table>

<a name="comparison"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Overview of Keying Mechanisms</h3>

<p>Based on how the SRTP keys are exchanged, each SRTP key exchange
      mechanism belongs to one general category:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>signaling path:</dt>
<dd>All the keying is carried in the
              call signaling (SIP or SDP) path.
</dd>
<dt>media path:</dt>
<dd>All the keying is carried in the
              SRTP/SRTCP media path, and no signaling whatsoever is carried in
              the call signaling path.
</dd>
<dt>signaling and media path:</dt>
<dd>Parts of the keying are
              carried in the SRTP/SRTCP media path, and parts are carried in
              the call signaling (SIP or SDP) path.
</dd>
</dl></blockquote>

</blockquote>

<p>One of the significant benefits of SRTP over other end-to-end
      encryption mechanisms, such as for example IPsec, is that SRTP is
      bandwidth efficient and SRTP retains the header of RTP packets.
      Bandwidth efficiency is vital for VoIP in many scenarios where access
      bandwidth is limited or expensive, and retaining the RTP header is
      important for troubleshooting packet loss, delay, and jitter.
</p>
<p>Related to SRTP's characteristics is a goal that any SRTP keying
      mechanism to also be efficient and not cause additional call setup
      delay. Contributors to additional call setup delay include network or
      database operations: retrieval of certificates and additional SIP or
      media path messages, and computational overhead of establishing keys or
      validating certificates.
</p>
<p>When examining the choice between keying in the signaling path,
      keying in the media path, or keying in both paths, it is important to
      realize the media path is generally 'faster' than the SIP signaling
      path. The SIP signaling path has computational elements involved which
      parse and route SIP messages. The media path, on the other hand, does
      not normally have computational elements involved, and even when
      computational elements such as firewalls are involved, they cause very
      little additional delay. Thus, the media path can be useful for
      exchanging several messages to establish SRTP keys. A disadvantage of
      keying over the media path is that interworking different key exchange
      requires the interworking function be in the media path, rather than
      just in the signaling path; in practice this involvement is probably
      unavoidable anyway.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Signaling Path Keying Techniques</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.1"></a><h3>A.1.1.&nbsp;
MIKEY-NULL</h3>

<p><a class='info' href='#RFC3830'>MIKEY-NULL<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a> [RFC3830] has the offerer indicate
          the SRTP keys for both directions. The key is sent unencrypted in
          SDP, which means the SDP must be encrypted hop-by-hop (e.g., by
          using TLS (SIPS)) or end-to-end (e.g., by using S/MIME).
</p>
<p>MIKEY-NULL requires one message from offerer to answerer (half a
          round trip), and does not add additional media path messages.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.2"></a><h3>A.1.2.&nbsp;
MIKEY-PSK</h3>

<p>MIKEY-PSK (pre-shared key) <a class='info' href='#RFC3830'>[RFC3830]<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a>
          requires that all endpoints share one common key. MIKEY-PSK has the
          offerer encrypt the SRTP keys for both directions using this
          pre-shared key.
</p>
<p>MIKEY-PSK requires one message from offerer to answerer (half a
          round trip), and does not add additional media path messages.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.3"></a><h3>A.1.3.&nbsp;
MIKEY-RSA</h3>

<p><a class='info' href='#RFC3830'>MIKEY-RSA<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a> [RFC3830] has the offerer encrypt
          the keys for both directions using the intended answerer's public
          key, which is obtained from a PKI.
</p>
<p>MIKEY-RSA requires one message from offerer to answerer (half a
          round trip), and does not add additional media path messages.
          MIKEY-RSA requires the offerer to obtain the intended answerer's
          certificate.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.4"></a><h3>A.1.4.&nbsp;
MIKEY-RSA-R</h3>

<p>MIKEY-RSA-R <a class='info' href='#RFC4738'>An additional mode of key
          distribution in MIKEY: MIKEY-RSA-R<span> (</span><span class='info'>Ignjatic, D., Dondeti, L., Audet, F., and P. Lin, &ldquo;MIKEY-RSA-R: An Additional Mode of Key Distribution in Multimedia Internet KEYing (MIKEY),&rdquo; November&nbsp;2006.</span><span>)</span></a> [RFC4738] is essentially the same as
          MIKEY-RSA but reverses the role of the offerer and the answerer with
          regards to providing the keys. That is, the answerer encrypts the
          keys for both directions using the offerer's public key. Both the
          offerer and answerer validate each other's public keys using a PKI.
          MIKEY-RSA-R also enables sending certificates in the MIKEY
          message.
</p>
<p>MIKEY-RSA-R requires one message from offerer to answer, and one
          message from answerer to offerer (full round trip), and does not add
          additional media path messages. MIKEY-RSA-R requires the offerer
          validate the answerer's certificate.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.5"></a><h3>A.1.5.&nbsp;
MIKEY-DHSIGN</h3>

<p><a class='info' href='#RFC3830'>In MIKEY-DHSIGN<span> (</span><span class='info'>Arkko, J., Carrara, E., Lindholm, F., Naslund, M., and K. Norrman, &ldquo;MIKEY: Multimedia Internet KEYing,&rdquo; August&nbsp;2004.</span><span>)</span></a> [RFC3830] the offerer and
          answerer derive the key from a Diffie-Hellman exchange. In order to
          prevent an active man-in-the-middle the DH exchange itself is signed
          using each endpoint's private key and the associated public keys are
          validated using a PKI.
</p>
<p>MIKEY-DHSIGN requires one message from offerer to answerer, and
          one message from answerer to offerer (full round trip), and does not
          add additional media path messages. MIKEY-DHSIGN requires the
          offerer and answerer to validate each other's certificates.
          MIKEY-DHSIGN also enables sending the answerer's certificate in the
          MIKEY message.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.6"></a><h3>A.1.6.&nbsp;
MIKEY-DHHMAC</h3>

<p><a class='info' href='#RFC4650'>MIKEY-DHHMAC<span> (</span><span class='info'>Euchner, M., &ldquo;HMAC-Authenticated Diffie-Hellman for Multimedia Internet KEYing (MIKEY),&rdquo; September&nbsp;2006.</span><span>)</span></a> [RFC4650] uses a pre-shared
          secret to HMAC the Diffie-Hellman exchange, essentially combining
          aspects of MIKEY-PSK with MIKEY-DHSIGN, but without MIKEY-DHSIGN's
          need for a PKI to authenticate the Diffie-Hellman exchange.
</p>
<p>MIKEY-DHHMAC requires one message from offerer to answerer, and
          one message from answerer to offerer (full round trip), and does not
          add additional media path messages.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.7"></a><h3>A.1.7.&nbsp;
MIKEY-ECIES and MIKEY-ECMQV (MIKEY-ECC)</h3>

<p><a class='info' href='#I-D.ietf-msec-mikey-ecc'>ECC Algorithms For
          MIKEY<span> (</span><span class='info'>Milne, A., &ldquo;ECC Algorithms for MIKEY,&rdquo; June&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;msec&#8209;mikey&#8209;ecc] describes how ECC can be used with MIKEY-RSA (using
          ECDSA signature) and with MIKEY-DHSIGN (using a new DH-Group code),
          and also defines two new ECC-based algorithms, Elliptic Curve
          Integrated Encryption Scheme (ECIES) and Elliptic Curve
          Menezes-Qu-Vanstone (ECMQV) .
</p>
<p>For the purposes of this paper, the ECDSA signature, MIKEY-ECIES,
          and MIKEY-ECMQV function exactly like MIKEY-RSA, and the new
          DH-Group code function exactly like MIKEY-DHSIGN. Therefore these
          ECC mechanisms aren't discussed separately in this paper.
</p>
<a name="sdesc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.8"></a><h3>A.1.8.&nbsp;
Security Descriptions with SIPS</h3>

<p><a class='info' href='#RFC4568'>Security Descriptions<span> (</span><span class='info'>Andreasen, F., Baugher, M., and D. Wing, &ldquo;Session Description Protocol (SDP) Security Descriptions for Media Streams,&rdquo; July&nbsp;2006.</span><span>)</span></a> [RFC4568] has each side
          indicate the key it will use for transmitting SRTP media, and the
          keys are sent in the clear in SDP. Security Descriptions relies on
          hop-by-hop (TLS via "SIPS:") encryption to protect the keys
          exchanged in signaling.
</p>
<p>Security Descriptions requires one message from offerer to
          answerer, and one message from answerer to offerer (full round
          trip), and does not add additional media path messages.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.9"></a><h3>A.1.9.&nbsp;
Security Descriptions with S/MIME</h3>

<p>This keying mechanism is identical to <a class='info' href='#sdesc'>Appendix&nbsp;A.1.8<span> (</span><span class='info'>Security Descriptions with SIPS</span><span>)</span></a>, except that rather than protecting the
          signaling with TLS, the entire SDP is encrypted with S/MIME.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.10"></a><h3>A.1.10.&nbsp;
SDP-DH (expired)</h3>

<p><a class='info' href='#I-D.baugher-mmusic-sdp-dh'>SDP
          Diffie-Hellman<span> (</span><span class='info'>Baugher, M. and D. McGrew, &ldquo;Diffie-Hellman Exchanges for Multimedia Sessions,&rdquo; February&nbsp;2006.</span><span>)</span></a> [I&#8209;D.baugher&#8209;mmusic&#8209;sdp&#8209;dh] exchanges Diffie-Hellman messages in the
          signaling path to establish session keys. To protect against active
          man-in-the-middle attacks, the Diffie-Hellman exchange needs to be
          protected with S/MIME, SIPS, or <a class='info' href='#RFC4474'>SIP-Identity<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4474] and <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>.
</p>
<p>SDP-DH requires one message from offerer to answerer, and one
          message from answerer to offerer (full round trip), and does not add
          additional media path messages.
</p>
<a name="mikey2-sdp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.11"></a><h3>A.1.11.&nbsp;
MIKEYv2 in SDP (expired)</h3>

<p><a class='info' href='#I-D.dondeti-msec-rtpsec-mikeyv2'>MIKEYv2<span> (</span><span class='info'>Dondeti, L., &ldquo;MIKEYv2: SRTP Key Management using MIKEY, revisited,&rdquo; March&nbsp;2007.</span><span>)</span></a> [I&#8209;D.dondeti&#8209;msec&#8209;rtpsec&#8209;mikeyv2]
          adds mode negotiation to MIKEYv1 and removes the time
          synchronization requirement. It therefore now takes 2 round-trips to
          complete. In the first round trip, the communicating parties learn
          each other's identities, agree on a MIKEY mode, crypto algorithm,
          SRTP policy, and exchanges nonces for replay protection. In the
          second round trip, they negotiate unicast and/or group SRTP context
          for SRTP and/or SRTCP.
</p>
<p>Furthemore, MIKEYv2 also defines an in-band negotiation mode as
          an alternative to SDP (see <a class='info' href='#mikey2-inband'>Appendix&nbsp;A.3.3<span> (</span><span class='info'>MIKEYv2 Inband (expired)</span><span>)</span></a>).
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Media Path Keying Technique</h3>

<p>
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1"></a><h3>A.2.1.&nbsp;
ZRTP</h3>

<p><a class='info' href='#I-D.zimmermann-avt-zrtp'>ZRTP<span> (</span><span class='info'>Zimmermann, P., Johnston, A., and J. Callas, &ldquo;ZRTP: Media Path Key Agreement for Unicast Secure RTP,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.zimmermann&#8209;avt&#8209;zrtp] does not
          exchange information in the signaling path (although it's possible
          for endpoints to indicate support for ZRTP with "a=zrtp" in the
          initial Offer). In ZRTP the keys are exchanged entirely in the media
          path using a Diffie-Hellman exchange. The advantage to this
          mechanism is that the signaling channel is used only for call setup
          and the media channel is used to establish an encrypted channel --
          much like encryption devices on the PSTN. ZRTP uses voice
          authentication of its Diffie-Hellman exchange by having each person
          read digits to the other person. Subsequent sessions with the same
          ZRTP endpoint can be authenticated using the stored hash of the
          previously negotiated key rather than voice authentication.
</p>
<p>ZRTP uses 4 media path messages (Hello, Commit, DHPart1, and
          DHPart2) to establish the SRTP key, and 3 media path confirmation
          messages. The first 4 are sent as RTP packets (using RTP header
          extensions), and the last 3 are sent in conjunction with SRTP media
          packets (again as SRTP header extensions). Note that unencrypted RTP
          is being exchanged until the SRTP keys are established.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
Signaling and Media Path Keying Techniques</h3>

<p>
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3.1"></a><h3>A.3.1.&nbsp;
EKT</h3>

<p><a class='info' href='#I-D.mcgrew-srtp-ekt'>EKT<span> (</span><span class='info'>McGrew, D., Andreasen, F., Wing, D., and L. Dondeti, &ldquo;Encrypted Key Transport for Secure RTP,&rdquo; October&nbsp;2009.</span><span>)</span></a> [I&#8209;D.mcgrew&#8209;srtp&#8209;ekt] relies on another
          SRTP key exchange protocol, such as Security Descriptions or MIKEY,
          for bootstrapping. In the initial phase, each member of a conference
          uses an SRTP key exchange protocol to establish a common key
          encryption key (KEK). Each member may use the KEK to securely
          transport its SRTP master key and current SRTP rollover counter
          (ROC), via RTCP, to the other participants in the session.
</p>
<p>EKT requires the offerer to send some parameters (EKT_Cipher,
          KEK, and security parameter index (SPI)) via the bootstrapping
          protocol such as Security Descriptions or MIKEY. Each answerer sends
          an SRTCP message which contains the answerer's SRTP Master Key,
          rollover counter, and the SRTP sequence number. Rekeying is done by
          sending a new SRTCP message. For reliable transport, multiple RTCP
          messages need to be sent.
</p>
<a name="dtls-srtp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3.2"></a><h3>A.3.2.&nbsp;
DTLS-SRTP</h3>

<p><a class='info' href='#I-D.mcgrew-tls-srtp'>DTLS-SRTP<span> (</span><span class='info'>Rescorla, E. and D. McGrew, &ldquo;Datagram Transport Layer Security (DTLS) Extension to Establish Keys for  Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2007.</span><span>)</span></a> [I&#8209;D.mcgrew&#8209;tls&#8209;srtp] exchanges
          public key fingerprints in SDP <a class='info' href='#I-D.fischl-sipping-media-dtls'>[I&#8209;D.fischl&#8209;sipping&#8209;media&#8209;dtls]<span> (</span><span class='info'>Fischl, J., &ldquo;Datagram Transport Layer Security (DTLS) Protocol for Protection of Media  Traffic Established with the Session Initiation Protocol,&rdquo; July&nbsp;2007.</span><span>)</span></a> and then establishes
          a DTLS session over the media channel. The endpoints use the DTLS
          handshake to agree on crypto suites and establish SRTP session keys.
          SRTP packets are then exchanged between the endpoints.
</p>
<p>DTLS-SRTP requires one message from offerer to answerer (half
          round trip), and, if the offerer wishes to correlate the SDP answer
          with the endpoint, requires one message from answer to offerer (full
          round trip). DTLS-SRTP uses 4 media path messages to establish the
          SRTP key.
</p>
<p>This paper assumes DTLS will use TLS_RSA_WITH_3DES_EDE_CBC_SHA as
          its cipher suite, which is the mandatory-to-implement cipher suite
          in <a class='info' href='#RFC4346'>TLS<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a> [RFC4346].
</p>
<a name="mikey2-inband"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3.3"></a><h3>A.3.3.&nbsp;
MIKEYv2 Inband (expired)</h3>

<p>As defined in <a class='info' href='#mikey2-sdp'>Appendix&nbsp;A.1.11<span> (</span><span class='info'>MIKEYv2 in SDP (expired)</span><span>)</span></a>, MIKEYv2 also
          defines an in-band negotiation mode as an alternative to SDP (see
          <a class='info' href='#mikey2-inband'>Appendix&nbsp;A.3.3<span> (</span><span class='info'>MIKEYv2 Inband (expired)</span><span>)</span></a>). The details are not sorted
          out in the draft yet on what in-band actually means (i.e., UDP, RTP,
          RTCP, etc.).
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Evaluation Criteria - SIP</h3>

<p>This section considers how each keying mechanism interacts with SIP
      features.
</p>
<a name="retargeting"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
Secure Retargeting and Secure Forking</h3>

<p>
</p>
<p> Retargeting and forking of signaling requests is described
        within <a class='info' href='#forking'>Section&nbsp;3.2<span> (</span><span class='info'>Retargeting and Forking</span><span>)</span></a>. The following builds upon this
        description.
</p>
<p>The following list compares the behavior of secure forking,
        answering association, two-time pads, and secure retargeting for each
        keying mechanism.
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>MIKEY-NULL</dt>
<dd>Secure Forking: No, all AORs see
                offerer's and answerer's keys. Answer is associated with media
                by the SSRC in MIKEY. Additionally, a two-time pad occurs if
                two branches choose the same 32-bit SSRC and transmit SRTP
                packets.<br />
Secure Retargeting: No, all
                targets see offerer's and answerer's keys. Suffers from
                retargeting identity problem.
</dd>
<dt>MIKEY-PSK</dt>
<dd>Secure
                Forking: No, all AORs see offerer's and answerer's keys.
                Answer is associated with media by the SSRC in MIKEY. Note
                that all AORs must share the same pre-shared key in order for
                forking to work at all with MIKEY-PSK. Additionally, a
                two-time pad occurs if two branches choose the same 32-bit
                SSRC and transmit SRTP packets.<br />
<br />
Secure
                Retargeting: Not secure. For retargeting to work, the final
                target must possess the correct PSK. As this is likely in
                scenarios were the call is targeted to another device
                belonging to the same user (forking), it is very unlikely that
                other users will possess that PSK and be able to successfully
                answer that call.
</dd>
<dt>MIKEY-RSA</dt>
<dd>Secure
                Forking: No, all AORs see offerer's and answerer's keys.
                Answer is associated with media by the SSRC in MIKEY. Note
                that all AORs must share the same private key in order for
                forking to work at all with MIKEY-RSA. Additionally, a
                two-time pad occurs if two branches choose the same 32-bit
                SSRC and transmit SRTP packets.<br />
<br />
Secure
                Retargeting: No.
</dd>
<dt>MIKEY-RSA-R</dt>
<dd>Secure
                Forking: Yes. Answer is associated with media by the SSRC in
                MIKEY.<br />
<br />
Secure Retargeting: Yes.
</dd>
<dt>MIKEY-DHSIGN</dt>
<dd>Secure
                Forking: Yes, each forked endpoint negotiates unique keys with
                the offerer for both directions. Answer is associated with
                media by the SSRC in MIKEY.<br />
<br />
Secure
                Retargeting: Yes, each target negotiates unique keys with the
                offerer for both directions.
</dd>
<dt>MIKEYv2 in SDP</dt>
<dd>The
                behavior will depend on which mode is picked.
</dd>
<dt>MIKEY-DHHMAC</dt>
<dd>Secure
                Forking: Yes, each forked endpoint negotiates unique keys with
                the offerer for both directions. Answer is associated with
                media by the SSRC in MIKEY.<br />
<br />
Secure
                Retargeting: Yes, each target negotiates unique keys with the
                offerer for both directions. Note that for the keys to be
                meaningful, it would require the PSK to be the same for all
                the potential intermediaries, which would only happen within a
                single domain.
</dd>
<dt>Security Descriptions with SIPS</dt>
<dd>Secure Forking: No. Each forked endpoint sees
                the offerer's key. Answer is not associated with media.<br />
<br />
Secure Retargeting: No. Each target sees the
                offerer's key.
</dd>
<dt>Security Descriptions with S/MIME</dt>
<dd>Secure Forking: No. Each forked endpoint sees
                the offerer's key. Answer is not associated with media.<br />
<br />
Secure Retargeting: No. Each target sees the
                offerer's key. Suffers from retargeting identity problem.
</dd>
<dt>SDP-DH</dt>
<dd>Secure Forking:
                Yes. Each forked endpoint calculates a unique SRTP key. Answer
                is not associated with media.<br />
<br />
Secure
                Retargeting: Yes. The final target calculates a unique SRTP
                key.
</dd>
<dt>ZRTP</dt>
<dd>Secure Forking:
                Yes. Each forked endpoint calculates a unique SRTP key. As
                ZRTP isn't signaled in SDP, there is no association of the
                answer with media.<br />
<br />
Secure Retargeting:
                Yes. The final target calculates a unique SRTP key.
</dd>
<dt>EKT</dt>
<dd>Secure Forking:
                Inherited from the bootstrapping mechanism (the specific MIKEY
                mode or Security Descriptions). Answer is associated with
                media by the SPI in the EKT protocol. Answer is associated
                with media by the SPI in the EKT protocol.<br />
<br />
Secure Retargeting: Inherited from the
                bootstrapping mechanism (the specific MIKEY mode or Security
                Descriptions).
</dd>
<dt>DTLS-SRTP</dt>
<dd>Secure
                Forking: Yes. Each forked endpoint calculates a unique SRTP
                key. Answer is associated with media by the certificate
                fingerprint in signaling and certificate in the media
                path.<br />
<br />
 Secure Retargeting: Yes. The
                final target calculates a unique SRTP key.
</dd>
<dt>MIKEYv2 Inband</dt>
<dd>The
                behavior will depend on which mode is picked.
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2"></a><h3>B.2.&nbsp;
Clipping Media Before SDP Answer</h3>

<p> Clipping media before receiving the signaling answer is described
        within <a class='info' href='#clipping'>Section&nbsp;3.1<span> (</span><span class='info'>Clipping Media Before Signaling Answer</span><span>)</span></a>. The following builds upon this
        description.
</p>
<p>Furthermore, the problem of clipping gets compounded when forking
        is used. For example, if using a Diffie-Hellman keying technique with
        security preconditions that forks to 20 endpoints, the call initiator
        would get 20 provisional responses containing 20 signed Diffie-Hellman
        half keys. Calculating 20 DH secrets and validating signatures can
        be a difficult task depending on the device capabilities.
</p>
<p>The following list compares the behavior of clipping before SDP
        answer for each keying mechanism.
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>MIKEY-NULL</dt>
<dd>Not clipped.
                The offerer provides the answerer's keys.
</dd>
<dt>MIKEY-PSK</dt>
<dd>Not clipped.
                The offerer provides the answerer's keys.
</dd>
<dt>MIKEY-RSA</dt>
<dd>Not clipped.
                The offerer provides the answerer's keys.
</dd>
<dt>MIKEY-RSA-R</dt>
<dd>Clipped.
                The answer contains the answerer's encryption key.
</dd>
<dt>MIKEY-DHSIGN</dt>
<dd>Clipped.
                The answer contains the answerer's Diffie-Hellman
                response.
</dd>
<dt>MIKEY-DHHMAC</dt>
<dd>Clipped.
                The answer contains the answerer's Diffie-Hellman
                response.
</dd>
<dt>MIKEYv2 in SDP</dt>
<dd>The
                behavior will depend on which mode is picked.
</dd>
<dt>Security Descriptions with SIPS</dt>
<dd>Clipped. The answer contains the answerer's
                encryption key.
</dd>
<dt>Security Descriptions with S/MIME</dt>
<dd>Clipped. The answer contains the answerer's
                encryption key.
</dd>
<dt>SDP-DH</dt>
<dd>Clipped. The
                answer contains the answerer's Diffie-Hellman response.
</dd>
<dt>ZRTP</dt>
<dd>Not clipped
                because the session intially uses RTP. While RTP is flowing,
                both ends negotiate SRTP keys in the media path and then
                switch to using SRTP.
</dd>
<dt>EKT</dt>
<dd>Not clipped, as
                long as the first RTCP packet (containing the answerer's key)
                is not lost in transit. The answerer sends its encryption key
                in RTCP, which arrives at the same time (or before) the first
                SRTP packet encrypted with that key.
<blockquote class="text"><dl>
<dt></dt>
<dd>Note: RTCP needs to work, in the answerer-to-offerer
                    direction, before the offerer can decrypt SRTP media.
</dd>
</dl></blockquote>
</dd>
<dt>DTLS-SRTP</dt>
<dd>Not clipped.
                Keys are exchanged in the media path without relying on the
                signaling path.
</dd>
<dt>MIKEYv2 Inband</dt>
<dd>Not
                clipped. Keys are exchanged in the media path without relying
                on the signaling path.
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.3"></a><h3>B.3.&nbsp;
Centralized Keying</h3>

<p> Centralized keying is described within 
        <a class='info' href='#conferencing'>Section&nbsp;3.3<span> (</span><span class='info'>Shared Key Conferencing</span><span>)</span></a>. The following builds upon this
        description.
</p>
<p>The following list describes how each keying mechanism behaves with
        centralized keying (scenario d) and rekeying.</p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>MIKEY-NULL</dt>
<dd>Keying: Yes,
                if offerer is the mixer. No, if offerer is the participant
                (end user).<br />
<br />
Rekeying: Yes, via
                re-Invite
</dd>
<dt>MIKEY-PSK</dt>
<dd>Keying: Yes,
                if offerer is the mixer. No, if offerer is the participant
                (end user).<br />
<br />
Rekeying: Yes, with a
                re-Invite
</dd>
<dt>MIKEY-RSA</dt>
<dd>Keying: Yes,
                if offerer is the mixer. No, if offerer is the participant
                (end user).<br />
<br />
Rekeying: Yes, with a
                re-Invite
</dd>
<dt>MIKEY-RSA-R</dt>
<dd>Keying: No,
                if offerer is the mixer. Yes, if offerer is the participant
                (end user).<br />
<br />
Rekeying: n/a
</dd>
<dt>MIKEY-DHSIGN</dt>
<dd>Keying:
                No; a group-key Diffie-Hellman protocol is not
                supported.<br />
<br />
Rekeying: n/a
</dd>
<dt>MIKEY-DHHMAC</dt>
<dd>Keying:
                No; a group-key Diffie-Hellman protocol is not
                supported.<br />
<br />
Rekeying: n/a
</dd>
<dt>MIKEYv2 in SDP</dt>
<dd>The
                behavior will depend on which mode is picked.
</dd>
<dt>Security Descriptions with SIPS</dt>
<dd>Keying: Yes, if offerer is the mixer. Yes, if
                offerer is the participant.<br />
<br />
Rekeying:
                Yes, with a Re-Invite.
</dd>
<dt>Security Descriptions with S/MIME</dt>
<dd>Keying: Yes, if offerer is the mixer. Yes, if
                offerer is the participant.<br />
<br />
Rekeying:
                Yes, with a Re-Invite.
</dd>
<dt>SDP-DH</dt>
<dd>Keying: No; a
                group-key Diffie-Hellman protocol is not supported.<br />
<br />
Rekeying: n/a
</dd>
<dt>ZRTP</dt>
<dd>Keying: No; a
                group-key Diffie-Hellman protocol is not supported.<br />
<br />
Rekeying: n/a
</dd>
<dt>EKT</dt>
<dd>Keying: Yes. After
                bootstrapping a KEK using Security Descriptions or MIKEY, each
                member originating an SRTP stream can send its SRTP master
                key, sequence number and ROC via RTCP.<br />
<br />
Rekeying: Yes. EKT supports each sender to
                transmit its SRTP master key to the group via RTCP packets.
                Thus, EKT supports each originator of an SRTP stream to rekey
                at any time.
</dd>
<dt>DTLS-SRTP</dt>
<dd>Keying: Yes,
                because with the assumed cipher suite,
                TLS_RSA_WITH_3DES_EDE_CBC_SHA, each end indicates its SRTP
                key.<br />
<br />
Rekeying: via DTLS in the media
                path.
</dd>
<dt>MIKEYv2 Inband</dt>
<dd>The
                behavior will depend on which mode is picked.
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.4"></a><h3>B.4.&nbsp;
SSRC and ROC</h3>

<p>In SRTP, a cryptographic context is defined as the SSRC,
        destination network address, and destination transport port number.
        Whereas RTP, a flow is defined as the destination network address and
        destination transport port number. This results in a problem -- how to
        communicate the SSRC so that the SSRC can be used for the
        cryptographic context.
</p>
<p>Two approaches have emerged for this communication. One, used by
        all MIKEY modes, is to communicate the SSRCs to the peer in the MIKEY
        exchange. Another, used by Security Descriptions, is to use "late
        bindng" -- that is, any new packet containing a previously-unseen SSRC
        (which arrives at the same destination network address and destination
        transport port number) will create a new cryptographic context.
        Another approach, common amongst techniques with media-path SRTP key
        establishment, is to require a handshake over that media path before
        SRTP packets are sent. MIKEY's approach changes RTP's SSRC collision
        detection behavior by requiring RTP to pre-establish the SSRC values
        for each session.
</p>
<p>Another related issue is that SRTP introduces a rollover counter
        (ROC), which records how many times the SRTP sequence number has
        rolled over. As the sequence number is used for SRTP's default
        ciphers, it is important that all endpoints know the value of the ROC.
        The ROC starts at 0 at the beginning of a session.
</p>
<p>Some keying mechanisms cause a two-time pad to occur if two
        endpoints of a forked call have an SSRC collision.
</p>
<p>Note: A proposal has been made to send the ROC value on every Nth
        SRTP packet<a class='info' href='#RFC4771'>[RFC4771]<span> (</span><span class='info'>Lehtovirta, V., Naslund, M., and K. Norrman, &ldquo;Integrity Transform Carrying Roll-Over Counter for the Secure Real-time Transport Protocol (SRTP),&rdquo; January&nbsp;2007.</span><span>)</span></a>. This proposal has not yet
        been incorporated into this document.
</p>
<p>The following list examines handling of SSRC and ROC:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>MIKEY-NULL</dt>
<dd>Each
                endpoint indicates a set of SSRCs and the ROC for SRTP packets
                it transmits.
</dd>
<dt>MIKEY-PSK</dt>
<dd>Each endpoint
                indicates a set of SSRCs and the ROC for SRTP packets it
                transmits.
</dd>
<dt>MIKEY-RSA</dt>
<dd>Each endpoint
                indicates a set of SSRCs and the ROC for SRTP packets it
                transmits.
</dd>
<dt>MIKEY-RSA-R</dt>
<dd>Each
                endpoint indicates a set of SSRCs and the ROC for SRTP packets
                it transmits.
</dd>
<dt>MIKEY-DHSIGN</dt>
<dd>Each
                endpoint indicates a set of SSRCs and the ROC for SRTP packets
                it transmits.
</dd>
<dt>MIKEY-DHHMAC</dt>
<dd>Each
                endpoint indicates a set of SSRCs and the ROC for SRTP packets
                it transmits.
</dd>
<dt>MIKEYv2 in SDP</dt>
<dd>Each
                endpoint indicates a set of SSRCs and the ROC for SRTP packets
                it transmits.
</dd>
<dt>Security Descriptions with SIPS</dt>
<dd>Neither SSRC nor ROC are signaled. SSRC 'late
                binding' is used.
</dd>
<dt>Security Descriptions with S/MIME</dt>
<dd>Neither SSRC nor ROC are signaled. SSRC 'late
                binding' is used.
</dd>
<dt>SDP-DH</dt>
<dd>Neither SSRC nor
                ROC are signaled. SSRC 'late binding' is used.
</dd>
<dt>ZRTP</dt>
<dd>Neither SSRC nor
                ROC are signaled. SSRC 'late binding' is used.
</dd>
<dt>EKT</dt>
<dd>The SSRC of the
                SRTCP packet containing an EKT update corresponds to the SRTP
                master key and other parameters within that packet.
</dd>
<dt>DTLS-SRTP</dt>
<dd>Neither SSRC
                nor ROC are signaled. SSRC 'late binding' is used.
</dd>
<dt>MIKEYv2 Inband</dt>
<dd>Each
                endpoint indicates a set of SSRCs and the ROC for SRTP packets
                it transmits.
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Evaluation Criteria - Security</h3>

<p>This section evaluates each keying mechanism on the basis of their
      security properties.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1"></a><h3>C.1.&nbsp;
Public Key Infrastructure</h3>

<p>There are two aspects of PKI requirements -- one aspect is if PKI
        is necessary in order for the mechanism to function at all, the other
        is if PKI is used to authenticate a certificate. With interactive
        communications it is desirable to avoid fetching certificates that
        delay call setup; rather it is preferable to fetch or validate
        certificates in such a way that call setup isn't delayed. For example,
        a certificate can be validated while the phone is ringing or can be
        validated while ring-back tones are being played or even while the
        called party is answering the phone and saying "hello".
</p>
<p>SRTP key exchange mechanisms that require a
        global PKI to operate are gated on the deployment of a common PKI
        available to both endpoints. This means that no media security is
        achievable until such a PKI exists. For SIP, something like <a class='info' href='#I-D.ietf-sip-certs'>sip-certs<span> (</span><span class='info'>Jennings, C. and J. Fischl, &ldquo;Certificate Management Service for The Session Initiation Protocol (SIP),&rdquo; March&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;sip&#8209;certs] might be used to obtain
        the certificate of a peer.
</p>
<p></p>
<blockquote class="text">
<p>Note: Even if SIP CERTs was deployed, the <a class='info' href='#retargeting'>retargeting problem<span> (</span><span class='info'>Secure Retargeting and Secure Forking</span><span>)</span></a> would still
            prevent successful deployment of keying techniques which require
            the offerer to obtain the actual target's public key.
</p>
</blockquote>

<p>The following list compares the PKI requirements of each keying
        mechanism, both if a PKI is required for the key exchange itself, and
        if PKI is only used to authenticate the certificate supplied in
        signaling.
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>MIKEY-NULL</dt>
<dd>PKI not
                used.
</dd>
<dt>MIKEY-PSK</dt>
<dd>PKI not used;
                rather, all endpoints must have some way to exchange
                per-endpoint or per-system pre-shared keys.
</dd>
<dt>MIKEY-RSA</dt>
<dd>The offerer
                obtains the intended answerer's public key before initiating
                the call. This public key is used to encrypt the SRTP keys.
                There is no defined mechanism for the offerer to obtain the
                answerer's public key, although <a class='info' href='#I-D.ietf-sip-certs'>[I&#8209;D.ietf&#8209;sip&#8209;certs]<span> (</span><span class='info'>Jennings, C. and J. Fischl, &ldquo;Certificate Management Service for The Session Initiation Protocol (SIP),&rdquo; March&nbsp;2010.</span><span>)</span></a> might be viable in the
                future.
</dd>
<dt>MIKEY-RSA-R</dt>
<dd>The offer
                contains the offerer's public key. The answerer uses that
                public key to encrypt the SRTP keys that will be used by the
                offerer and the answerer. A PKI is necessary to validate the
                certificates.
</dd>
<dt>MIKEY-DHSIGN</dt>
<dd>PKI is
                used to authenticate the public key that is included in the
                MIKEY message, by walking the CA trust chain.
</dd>
<dt>MIKEY-DHHMAC</dt>
<dd>PKI not
                used; rather, all endpoints must have some way to exchange
                per-endpoint or per-system pre-shared keys.
</dd>
<dt>MIKEYv2 in SDP</dt>
<dd>The
                behavior will depend on which mode is picked.
</dd>
<dt>Security Descriptions with SIPS</dt>
<dd>PKI not used.
</dd>
<dt>Security Descriptions with S/MIME</dt>
<dd>PKI is needed for S/MIME. The offerer must
                obtain the intended target's public key and encrypt their SDP
                with that key. The answerer must obtain the offerer's public
                key and encrypt their SDP with that key.
</dd>
<dt>SDP-DH</dt>
<dd>PKI not
                used.
</dd>
<dt>ZRTP</dt>
<dd>PKI not used.
</dd>
<dt>EKT</dt>
<dd>PKI not used by EKT
                itself, but might be used by the EKT bootstrapping keying
                mechanism (such as certain MIKEY modes).
</dd>
<dt>DTLS-SRTP</dt>
<dd>Remote
                party's certificate is sent in media path, and a fingerprint
                of the same certificate is sent in the signaling path.
</dd>
<dt>MIKEYv2 Inband</dt>
<dd>The
                behavior will depend on which mode is picked.
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2"></a><h3>C.2.&nbsp;
Perfect Forward Secrecy</h3>

<p>In the context of SRTP, Perfect Forward Secrecy is the property
        that SRTP session keys that protected a previous session are not
        compromised if the static keys belonging to the endpoints are
        compromised. That is, if someone were to record your encrypted session
        content and later acquires either party's private key, that encrypted
        session content would be safe from decryption if your key exchange
        mechanism had perfect forward secrecy.
</p>
<p>The following list describes how each key exchange mechanism
        provides PFS.
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>MIKEY-NULL</dt>
<dd>No PFS.
</dd>
<dt>MIKEY-PSK</dt>
<dd>No PFS.
</dd>
<dt>MIKEY-RSA</dt>
<dd>No PFS.
</dd>
<dt>MIKEY-RSA-R</dt>
<dd>No PFS.
</dd>
<dt>MIKEY-DHSIGN</dt>
<dd>PFS is
                provided with the Diffie-Hellman exchange.
</dd>
<dt>MIKEY-DHHMAC</dt>
<dd>PFS is
                provided with the Diffie-Hellman exchange.
</dd>
<dt>MIKEYv2 in SDP</dt>
<dd>The
                behavior will depend on which mode is picked.
</dd>
<dt>Security Descriptions with SIPS</dt>
<dd>No PFS.
</dd>
<dt>Security Descriptions with S/MIME</dt>
<dd>No PFS.
</dd>
<dt>SDP-DH</dt>
<dd>PFS is provided
                with the Diffie-Hellman exchange.
</dd>
<dt>ZRTP</dt>
<dd>PFS is provided
                with the Diffie-Hellman exchange.
</dd>
<dt>EKT</dt>
<dd>No PFS.
</dd>
<dt>DTLS-SRTP</dt>
<dd>PFS is
                achieved if the negotiated cipher suite includes an
                exponential or discrete-logarithmic key exchange (such as
                Diffie-Hellman or <a class='info' href='#RFC4492'>Elliptic Curve
                Diffie-Hellman<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a> [RFC4492]).
</dd>
<dt>MIKEYv2 Inband</dt>
<dd>The
                behavior will depend on which mode is picked.
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.3"></a><h3>C.3.&nbsp;
Best Effort Encryption</h3>

<p><br />
<br />
 </p>
<blockquote class="text">
<p>Note: With the ongoing efforts in <a class='info' href='#I-D.ietf-mmusic-sdp-capability-negotiation'>SDP Capability
            Negotiation<span> (</span><span class='info'>Andreasen, F., &ldquo;SDP Capability Negotiation,&rdquo; March&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;mmusic&#8209;sdp&#8209;capability&#8209;negotiation], the conclusions reached in this section may no
            longer be accurate.
</p>
</blockquote><p> <br />
<br />

</p>
<p>With best effort encryption, SRTP is used with endpoints that
        support SRTP, otherwise RTP is used.
</p>
<p>SIP needs a backwards-compatible best effort encryption in order
        for SRTP to work successfully with SIP retargeting and forking when
        there is a mix of forked or retargeted devices that support SRTP and
        don't support SRTP.
</p>
<p></p>
<blockquote class="text">
<p>Consider the case of Bob, with a phone that only does RTP and a
            voice mail system that supports SRTP and RTP. If Alice calls Bob
            with an SRTP offer, Bob's RTP-only phone will reject the media
            stream (with an empty "m=" line) because Bob's phone doesn't
            understand SRTP (RTP/SAVP). Alice's phone will see this rejected
            media stream and may terminate the entire call (BYE) and
            re-initiate the call as RTP-only, or Alice's phone may decide to
            continue with call setup with the SRTP-capable leg (the voice mail
            system). If Alice's phone decided to re-initiate the call as
            RTP-only, and Bob doesn't answer his phone, Alice will then leave
            voice mail using only RTP, rather than SRTP as expected.
</p>
</blockquote><p>Currently, several techniques are commonly considered as
        candidates to provide opportunistic encryption:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>multipart/alternative</dt>
<dd>
            <a class='info' href='#I-D.jennings-sipping-multipart'>[I&#8209;D.jennings&#8209;sipping&#8209;multipart]<span> (</span><span class='info'>Wing, D. and C. Jennings, &ldquo;Session Initiation Protocol (SIP) Offer/Answer with Multipart Alternative,&rdquo; March&nbsp;2006.</span><span>)</span></a> describes
            how to form a multipart/alternative body part in SIP. The
            significant issues with this technique are (1) that multipart MIME
            is incompatible with existing SIP proxies, firewalls, Session
            Border Controllers, and endpoints and (2) when forking, the <a class='info' href='#I-D.mahy-sipping-herfp-fix'>Heterogeneous Error Response
            Forking Problem (HERFP)<span> (</span><span class='info'>Mahy, R., &ldquo;A Solution to the Heterogeneous Error Response Forking Problem (HERFP) in  the Session Initiation Protocol (SIP),&rdquo; March&nbsp;2006.</span><span>)</span></a> [I&#8209;D.mahy&#8209;sipping&#8209;herfp&#8209;fix] causes problems if such
            non-multipart-capable endpoints were involved in the forking.
</dd>
<dt>SDP Grouping</dt>
<dd>A new SDP
            grouping mechanism (following the idea introduced in <a class='info' href='#RFC3388'>[RFC3388]<span> (</span><span class='info'>Camarillo, G., Eriksson, G., Holler, J., and H. Schulzrinne, &ldquo;Grouping of Media Lines in the Session Description Protocol (SDP),&rdquo; December&nbsp;2002.</span><span>)</span></a>) has been discussed which would allow a
            media line to indicate RTP/AVP and another media line to indicate
            RTP/SAVP, allowing non-SRTP-aware endpoints to choose RTP/AVP and
            SRTP-aware endpoints to choose RTP/SAVP. As of this writing, this
            SDP grouping mechanism has not been published as an Internet
            Draft.
</dd>
<dt>session attribute</dt>
<dd>With this
            technique, the endpoints signal their desire to do SRTP by
            signaling RTP (RTP/AVP), and using an attribute ("a=") in the SDP.
            This technique is entirely backwards compatible with
            non-SRTP-aware endpoints, but doesn't use the RTP/SAVP protocol
            registered by <a class='info' href='#RFC3711'>SRTP<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a> [RFC3711].
</dd>
<dt>Probing</dt>
<dd>With this
            technique, the endpoints first establish an RTP session using RTP
            (RTP/AVP). The endpoints send probe messages, over the media path,
            to determine if the remote endpoint supports their keying
            technique.
</dd>
</dl></blockquote><p>The following list compares the availability of best effort
        encryption for each keying mechanism.
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>MIKEY-NULL</dt>
<dd>No best
                effort encryption.
</dd>
<dt>MIKEY-PSK</dt>
<dd>No best
                effort encryption.
</dd>
<dt>MIKEY-RSA</dt>
<dd>No best
                effort encryption.
</dd>
<dt>MIKEY-RSA-R</dt>
<dd>No best
                effort encryption.
</dd>
<dt>MIKEY-DHSIGN</dt>
<dd>No best
                effort encryption.
</dd>
<dt>MIKEY-DHHMAC</dt>
<dd>No best
                effort encryption.
</dd>
<dt>MIKEYv2 in SDP</dt>
<dd>No best
                effort encryption.
</dd>
<dt>Security Descriptions with SIPS</dt>
<dd>No best effort encryption.
</dd>
<dt>Security Descriptions with S/MIME</dt>
<dd>No best effort encryption.
</dd>
<dt>SDP-DH</dt>
<dd>No best effort
                encryption.
</dd>
<dt>ZRTP</dt>
<dd>Best effort
                encryption is done by probing (sending RTP messages with
                header extensions) or by session attribute (see "a=zrtp",
                defined in Section 10 of <a class='info' href='#I-D.zimmermann-avt-zrtp'>[I&#8209;D.zimmermann&#8209;avt&#8209;zrtp]<span> (</span><span class='info'>Zimmermann, P., Johnston, A., and J. Callas, &ldquo;ZRTP: Media Path Key Agreement for Unicast Secure RTP,&rdquo; April&nbsp;2010.</span><span>)</span></a>). Current
                implementations of ZRTP use probing.
</dd>
<dt>EKT</dt>
<dd>No best effort
                encryption.
</dd>
<dt>DTLS-SRTP</dt>
<dd>No best
                effort encryption.
</dd>
<dt>MIKEY Inband</dt>
<dd>No best
                effort encryption.
</dd>
</dl></blockquote>

</blockquote>

<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.4"></a><h3>C.4.&nbsp;
Upgrading Algorithms</h3>

<p>It is necessary to allow upgrading SRTP encryption and hash
        algorithms, as well as upgrading the cryptographic functions used for
        the key exchange mechanism. With SIP's offer/answer model, this can be
        computionally expensive because the offer needs to contain all
        combinations of the key exchange mechanisms (all MIKEY modes, Security
        Descriptions) and all SRTP cryptographic suites (AES-128, AES-256) and
        all SRTP cryptographic hash functions (SHA-1, SHA-256) that the
        offerer supports. In order to do this, the offerer has to expend CPU
        resources to build an offer containing all of this information which
        becomes computationally prohibitive.
</p>
<p>Thus, it is important to keep the offerer's CPU impact fixed so
        that offering multiple new SRTP encryption and hash functions incurs
        no additional expense.
</p>
<p>The following list describes the CPU effort involved in using each
        key exchange technique.
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>MIKEY-NULL</dt>
<dd>No
                significant computaional expense.
</dd>
<dt>MIKEY-PSK</dt>
<dd>No
                significant computational expense.
</dd>
<dt>MIKEY-RSA</dt>
<dd>For each
                offered SRTP crypto suite, the offerer has to perform RSA
                operation to encrypt the TGK
</dd>
<dt>MIKEY-RSA-R</dt>
<dd>For each
                offered SRTP crypto suite, the offerer has to perform public
                key operation to sign the MIKEY message.
</dd>
<dt>MIKEY-DHSIGN</dt>
<dd>For each
                offered SRTP crypto suite, the offerer has to perform
                Diffie-Hellman operation, and a public key operation to sign
                the Diffie-Hellman output.
</dd>
<dt>MIKEY-DHHMAC</dt>
<dd>For each
                offered SRTP crypto suite, the offerer has to perform
                Diffie-Hellman operation.
</dd>
<dt>MIKEYv2 in SDP</dt>
<dd>The
                behavior will depend on which mode is picked.
</dd>
<dt>Security Descriptions with SIPS</dt>
<dd>No significant computational expense.
</dd>
<dt>Security Descriptions with S/MIME</dt>
<dd>S/MIME requires the offerer and the answerer
                to encrypt the SDP with the other's public key, and to decrypt
                the received SDP with their own private key.
</dd>
<dt>SDP-DH</dt>
<dd>For each offered
                SRTP crypto suite, the offerer has to perform a Diffie-Hellman
                operation.
</dd>
<dt>ZRTP</dt>
<dd>The offerer has no
                additional computational expense at all, as the offer contains
                no information about ZRTP or might contain "a=zrtp".
</dd>
<dt>EKT</dt>
<dd>The offerer's
                Computational expense depends entirely on the EKT
                bootstrapping mechanism selected (one or more MIKEY modes or
                Security Descriptions).
</dd>
<dt>DTLS-SRTP</dt>
<dd>The offerer
                has no additional computational expense at all, as the offer
                contains only a fingerprint of the certificate that will be
                presented in the DTLS exchange.
</dd>
<dt>MIKEYv2 Inband</dt>
<dd>The
                behavior will depend on which mode is picked.
</dd>
</dl></blockquote>

</blockquote>

<a name="ofs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
Out-of-Scope</h3>

<p>Discussions concluded that key management for shared-key encryption
      of conferencing is outside the scope of this document. As the priority
      is point-to-point unicast SRTP session keying, resolving shared-key SRTP
      session keying is deferred to later and left as an item for future
      investigations.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dan Wing</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 West Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dwing@cisco.com">dwing@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Steffen Fries</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Siemens AG</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Otto-Hahn-Ring 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Munich, Bavaria  81739</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:steffen.fries@siemens.com">steffen.fries@siemens.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Otto-Hahn-Ring 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Munich, Bavaria  81739</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@nsn.com">Hannes.Tschofenig@nsn.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.com">http://www.tschofenig.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Francois Audet</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nortel</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">4655 Great America Parkway</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Santa Clara, CA  95054</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:audet@nortel.com">audet@nortel.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
