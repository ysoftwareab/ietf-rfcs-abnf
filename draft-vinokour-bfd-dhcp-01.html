<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Configuring BFD with DHCP and
    Other Musings</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Configuring BFD with DHCP and
    Other Musings">
<meta name="keywords" content="bfd, dhcp, Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Bidirectional Forwarding Detection</td><td class="header">V. Vinokour</td></tr>
<tr><td class="header">Working Group</td><td class="header">D. Ward</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">May 09, 2008</td></tr>
<tr><td class="header">Expires: November 10, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Configuring BFD with DHCP and
    Other Musings<br />draft-vinokour-bfd-dhcp-01</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on November 10, 2008.</p>

<h3>Abstract</h3>

<p>This document defines a method for configuring Bidirectional
      Forwarding Detection (BFD) by an IP Edge device using DHCPv4 or DHCPv6.
      It provides motivation for the new functionality, defines new DHCP
      options to assist with the task and outlines the rules for configuring
      BFD on an IP endpoint for different network topologies. The document
      also discusses endpoint behavior upon BFD failure. Comments on this
      draft should be directed to rtg-bfd@ietf.org.
</p>
<h3>Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#Endpoint">2.</a>&nbsp;
BFD Provisioning on IP Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">2.1.</a>&nbsp;
New DHCP Options Inserted by Client<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.2.</a>&nbsp;
New DHCP Options Inserted by Server<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Parameters">2.3.</a>&nbsp;
BFD Configuration Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.4.</a>&nbsp;
Operation with DHCP Relay Agent<br />
<a href="#IpEdge">3.</a>&nbsp;
BFD Provisioning and Management on IP Edge<br />
<a href="#IpAddress">4.</a>&nbsp;
BFD and IP Address Lifecycle<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
BFD and DHCPv4 Client States<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
BFD and DHCPv6 Client<br />
<a href="#BFDFailure">5.</a>&nbsp;
BFD Failure and DHCP Client<br />
<a href="#InitMethods">6.</a>&nbsp;
Other BFD Initialization Methods<br />
<a href="#IANA">7.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">8.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">9.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">10.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>A particularly useful application for BFD <a class='info' href='#I-D.ietf-bfd-base'>[I&#8209;D.ietf&#8209;bfd&#8209;base]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Bidirectional Forwarding Detection,&rdquo; March&nbsp;2008.</span><span>)</span></a> is to track IP connectivity between
      dynamically configured endpoints (e.g. hosts or CPE) and their IP Edge
      device (BRAS, BNG etc.) While IP connectivity is typically enabled on
      endpoints using DHCP <a class='info' href='#RFC2131'>[RFC2131]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a> or DHCPv6 <a class='info' href='#RFC3315'>[RFC3315]<span> (</span><span class='info'>Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6),&rdquo; July&nbsp;2003.</span><span>)</span></a>, there is currently no well-defined procedure
      for autoconfiguring BFD on IP devices to enable forwarding plane failure
      detection.
</p>
<p>BFD runs over IPv4 or IPv6 and can only be initiated on dynamically
      configured endpoints after DHCP configuration is successfully completed,
      for two reasons. First, an endpoint lacks an IP address until configured
      by DHCP and thus can't be identified by IP network and receive BFD
      packets. Second, an endpoint lacks knowledge of its peer IP devices
      (e.g. default gateway) and thus can't send BFD packets to them.
</p>
<p>The first reason suggests that BFD can not be started up until after
      unconfigured DHCP client obtains a valid network address. The second one
      implies that BFD requires configuration parameters supplied by DHCP for
      its operation. Thus, BFD startup must be coordinated with DHCP which
      also supplies BFD parameters. In short, BFD must be provisioned by DHCP
      on DHCP-configured endpoints.
</p>
<p>In turn, BFD can be used to enhance behavior of DHCP client by
      notifying it about loss of IP connectivity with IP Edge. While DHCP
      client operation upon L2 link failure is well-defined and is designed to
      verify network configuration as soon as connectivity is restored,
      similar functionality is absent for loss of L3. Ability by a DHCP client
      to initiate negotiation upon detecting an IP connectivity failure can be
      very useful in broadband scenarios. The document discusses a BFD-based
      mechanism to that effect.
</p>
<a name="Endpoint"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
BFD Provisioning on IP Endpoint</h3>

<p>BFD is a light-weight protocol that has no auto-bootstrapping
      facility and no discovery mechanism. It is fully reliant on a client
      application for configuration as described in <a class='info' href='#I-D.ietf-bfd-generic'>[I&#8209;D.ietf&#8209;bfd&#8209;generic]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Generic Application of BFD,&rdquo; January&nbsp;2008.</span><span>)</span></a>. In current deployments, BFD is
      used in conjunction with routing protocols and is configured locally on
      both endpoints of the connection. In such scenarios applications or the
      operator configuring BFD are implicitly aware of BFD capabilities of the
      system and need neither discovery nor transport mechanism to bring up
      the protocol instance.
</p>
<p> In contrast, supporting BFD auto-configuration on a remote host
      requires a BFD bootstrapping application compliant with <a class='info' href='#I-D.ietf-bfd-generic'>[I&#8209;D.ietf&#8209;bfd&#8209;generic]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Generic Application of BFD,&rdquo; January&nbsp;2008.</span><span>)</span></a> to provide full BFD configuration
      to the host. The application should also provide a mechanism for
      detecting BFD capability of the host and supply BFD configuration that
      is consistent with this capability. Such requirements on the
      bootstrapping application stem from basic principles of BFD design and
      are based on the premise that BFD never runs "standalone" but always in
      the context of client applications. 
</p>
<p>No mechanism is currently defined for DHCP-assisted BFD configuration
      on an IP endpoint. BFD can only be enabled if BFD parameters are
      hard-wired (pre-provisioned) on a device or provided by some out-of-band
      mechanism like the one specified in <a class='info' href='#TR-069'>DSLF
      TR-069<span> (</span><span class='info'>DSLHome-Technical Working Group, &ldquo;CPE WAN Management Protocol,&rdquo; May&nbsp;2004.</span><span>)</span></a> [TR&#8209;069]. To enable DHCP-based BFD bootstrapping, we suggest
      defining two sets of DHCP options. Options in the first set (one for
      DHCPv4, one for DHCPv6) is inserted by the client and advertise BFD
      capability of the remote endpoint. Options in the second set would carry
      BFD specific configuration parameters and allow DHCP client to bootstrap
      BFD locally.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
New DHCP Options Inserted by Client</h3>

<p>Option TBD_1 MAY be used by DHCPv4 client in DHCPDISCOVER,
        DHCPREQUEST or DHCPINFORM packets to advertise BFD support on an IP
        endpoint. The format of the option TBD_1 is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Code (TBD_1)  |  Length       |Vers |Reserved | Num Auth Types|
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       A1      |      A2       |  ...                          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>An equivalent option TBD_2 MAY be used by DHCPv6 client in SOLICIT,
        REQUEST, CONFIRM, RENEW, REBIND, and INFORMATON_REQUEST packets to
        advertise BFD support on an IP endpoint. The format of the option
        TBD_2 is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          Code (TBD_2)         |             Length            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Vers |Reserved | Num Auth Types|      A1       |       A2      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                            ...                                |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>In both options TBD_1 and TBD_2 "Vers" stands for the version of
        BFD supported on the endpoint running DHCP client. BFD version should
        be currently set to 1 according to <a class='info' href='#I-D.ietf-bfd-base'>[I&#8209;D.ietf&#8209;bfd&#8209;base]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Bidirectional Forwarding Detection,&rdquo; March&nbsp;2008.</span><span>)</span></a>. "Num Auth Types" is the number of
        BFD Authentication types supported by the IP endpoint. If client does
        not support BFD Authentication, the field MUST be set to 0. Finally,
        A1, A2. etc are the codes of BFD Authentication types supported by the
        endpoint as defined in <a class='info' href='#I-D.ietf-bfd-base'>[I&#8209;D.ietf&#8209;bfd&#8209;base]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Bidirectional Forwarding Detection,&rdquo; March&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
New DHCP Options Inserted by Server</h3>

<p>When a DHCPv4 packet containing option TBD_1 is received by a
        DHCPv4 server, the server MAY configure BFD on the endpoint running
        the client if it supports version of BFD requested by the client. If
        DHCP server cannot supply BFD configuration for BFD version that IP
        endpoint is running, the server SHOULD NOT configure BFD on the
        endpoint. To deliver BFD configuration to the endpoint, the server
        inserts option TBD_3 into DHCPOFFER and DHCPACK packets. The format of
        the option TBD_3 is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Code (TBD_3) |     Length    |Vers |E|R|C|A|D|  Detect Mult  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Local Discriminator                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Desired Min TX Interval                    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Required Min RX Interval                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Required Min Echo RX Interval              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|
    |                    Remote IP address                          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>If option TBD_1 specifies support for BFD Authentication, the
        server MAY supply an Authentication Section. The format of
        Authentication Section is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Auth Len    |   Num Keys    |           Reserved            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Type1       |   ID1         |     Len1      |  Key1         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                              ...                              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Type2       |   ID2         |     Len2      |  Key2         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                              ...                              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>Here "Auth Len" is the length of Authentication Section and "Num
        Keys" is the number of authentication keys to be used during the
        session. Then follows the authentication key definition in a modified
        TLV format - in addition to Type an Authentication Key ID is provided
        for each key. Codes for Authentication types MUST be consistent with
        <a class='info' href='#I-D.ietf-bfd-base'>[I&#8209;D.ietf&#8209;bfd&#8209;base]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Bidirectional Forwarding Detection,&rdquo; March&nbsp;2008.</span><span>)</span></a>. If Authentication Section is
        present it MUST immediately follow Remote IP Address field.
</p>
<p>If "Num Auth Types" field in option TBD_1 is set to 0, the server
        SHOULD NOT supply Authentication Section in option TBD_3. The server
        SHOULD only configure Authentication types that the endpoint
        supports.
</p>
<p>Likewise, when a DHCPv6 server receives a packet containing option
        TBD_2, it MAY choose to configure BFD on the endpoint if it supports
        version of BFD requested by the client. To deliver BFD configuration
        to the endpoint the server inserts option TBD_4 into ADVERTISE, REPLY,
        or RECONFIGURE packets. The format of the option TBD_4 is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Code (TBD_4)       |             Length            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Vers |E|R|C|A|D|  Detect Mult  |  Local Discriminator          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               |  Desired Min TX Interval      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               |  Required Min RX Interval     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               |  Required Min Echo RX Interval|
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               |  Remote IP Address            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|
    |                                                               |
    |                     Remote IP address                         |
    |                                                               |
    |                               |-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>As with option TBD_3, an optional Authentication Section of the
        same format MAY be supplied. If present, Authentication Section MUST
        immediately follow Remote IP address field.
</p>
<a name="Parameters"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
BFD Configuration Parameters</h3>

<p>BFD parameters defined in options TBD_3 and TBD_4, along with
        recommended (default) values are as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Vers is BFD version               1
   Enable (E)                        1
   Role (R) is Active vs Passive     Passive
   Control Plane Independent Bit (C) 0
   Authentication Present Bit (A)    0
   Local Demand Mode Bit (D)         0
   Detect Multiplier                 3
   Local Discriminator               No default value
   Desired Min TX Interval           10000 (ms)
   Required Min RX Interval          1000  (ms)
   Required Min Echo RX Interval     0     (ms)
   Remote IP address                 No default value
   Authentication data               None
</pre></div>
<p>Definitions of all parameters (except for remote IP address) can be
        found in <a class='info' href='#I-D.ietf-bfd-base'>[I&#8209;D.ietf&#8209;bfd&#8209;base]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Bidirectional Forwarding Detection,&rdquo; March&nbsp;2008.</span><span>)</span></a>.
</p>
<p>In order for BFD configuration in option TBD_3 or TBD_4 to be
        accepted by an IP endpoint, BFD Version field MUST match BFD version
        supported by the endpoint and provided to DHCP server in option TBD_1
        or TBD_2. If BFD versions do not match configuration MUST be discarded
        by the endpoint. Currently the version should be set to 1 according to
        <a class='info' href='#I-D.ietf-bfd-base'>[I&#8209;D.ietf&#8209;bfd&#8209;base]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Bidirectional Forwarding Detection,&rdquo; March&nbsp;2008.</span><span>)</span></a>.
</p>
<p>Enable bit (E) set to 1 indicates that BFD on the endpoint SHOULD
        be enabled. If Enable bit is set to 0, BFD MUST NOT be initiated. If
        BFD is already running, it SHOULD be disabled.
</p>
<p>Default values define an IP endpoint as a passive BFD peer running
        in Asynchronous mode without Authentication. Authentication Present
        Bit (A) set to 1 indicates the presence of the optional Authentication
        Section. Asynchronous mode is selected as default because Demand mode
        requires some mechanism outside of BFD to generate polls toward the
        peer. Numeric values of Detect Multiplier and Desired Min TX interval
        are selected as being consistent with PPP keepalive default values
        that are relevant for broadband scenarios. Required Min RX intervals
        are set to 1 second as sub-second detection times are not currently
        expected in broadband scenarios. The failure detection time of 3
        seconds (given the suggested default Detect Multiplier value) on IP
        Edge would represent an order of magnitude improvement over the
        current industry default of 30s (the typical failure detection time
        for PPP).
</p>
<p>Value 0 for Required min Echo RX Interval indicates that Echo mode
        is not supported by an endpoint. This reflects the expectation that
        Echo mode is not typically used in broadband scenarios.
</p>
<p>C-bit value depends on BFD implementation on an endpoint; the
        default value of 0 assumes that the endpoint's control plane and
        forwarding plane share fate.
</p>
<p>Remote IP address cannot be initialized with a meaningful default
        value. As explained in <a class='info' href='#IpAddress'>Section 4<span> (</span><span class='info'>BFD and IP Address Lifecycle</span><span>)</span></a>, BFD
        operation is undefined until DHCP negotiation is completed at which
        point remote IP address will be set to a value extracted from option
        TBD_3 or TBD_4.
</p>
<p>Authentication data is not supplied by default. If Authentication
        Section is present, IP endpoint MUST discard configuration for BFD
        Authentication types that it does not support.
</p>
<p>Note that these parameters can be pre-provisioned or configured by
        some out-of-band mechanism as well as by DHCP. Therefore, precedence
        rules must be defined to resolve conflicts when a device is configured
        by several methods at once. <a class='info' href='#InitMethods'>Section
        6<span> (</span><span class='info'>Other BFD Initialization Methods</span><span>)</span></a> defines and discusses these rules.
</p>
<p>When DHCP client receives DHCPACK with a properly formed option
        TBD_3, or REPLY or RECONFIGURE with a properly formed option TBD_4,
        the BFD parameters in the respective option MUST be used to initialize
        and start up BFD on the endpoint according to <a class='info' href='#I-D.ietf-bfd-base'>[I&#8209;D.ietf&#8209;bfd&#8209;base]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Bidirectional Forwarding Detection,&rdquo; March&nbsp;2008.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-bfd-v4v6-1hop'>[I&#8209;D.ietf&#8209;bfd&#8209;v4v6&#8209;1hop]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;BFD for IPv4 and IPv6 (Single Hop),&rdquo; March&nbsp;2008.</span><span>)</span></a> and using precedence rules
        specified in <a class='info' href='#InitMethods'>Section 6<span> (</span><span class='info'>Other BFD Initialization Methods</span><span>)</span></a>, provided
        Enable bit is set 1 and BFD version in the configuration matches BFD
        version supported by the endpoint. BFD state is initially set to Down,
        and destination IP address for BFD packets is set to the Remote IP
        address from option TBD_3 or TBD_4. Subsequent BFD operation on the
        endpoint is fully defined by BFD state machine as described in <a class='info' href='#I-D.ietf-bfd-base'>[I&#8209;D.ietf&#8209;bfd&#8209;base]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Bidirectional Forwarding Detection,&rdquo; March&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Operation with DHCP Relay Agent</h3>

<p>In some deployments, IP Edge device serving as BFD endpoint is
        configured as a DHCPv4 relay agent. In this case, it may be preferable
        for an operator to program BFD endpoint configuration on the DHCP
        relay rather than the server. Relay agent can not insert BFD
        configuration into DHCP packets directly: the only manipulations a
        relay agent is allowed to perform on DHCP packets is setting giaddr
        and inserting relay-agent-info option. Therefore, in order to allow
        DHCP relay to provide an IP endpoint BFD configuration to the server,
        there is a need to extend the relay-agent-info option (<a class='info' href='#RFC3046'>[RFC3046]<span> (</span><span class='info'>Patrick, M., &ldquo;DHCP Relay Agent Information Option,&rdquo; January&nbsp;2001.</span><span>)</span></a>) with a new sub-option, the bfd-endpoint
        sub-option. The new sub-option has the same format as option TBD_3,
        except it employs a different code (TBD_5):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Code (TBD_5) |     Length    |Vers |R|C|A|D|E|  Detect Mult  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Local Discriminator                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Desired Min TX Interval                    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Required Min RX Interval                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Required Min Echo RX Interval              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|
    |                    Remote IP address                          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>The relay agent MAY insert the bfd-endpoint sub-option into
        DHCPDISCOVER or DHCPREQUEST packet from an IP endpoint if it would
        like the server to use its BFD configuration to configure BFD on the
        endpoint. If the server supports BFD provisioning and detects
        bfd-endpoint sub-option it MUST use BFD configuration from the
        sub-option in option TBD_3 that it inserts into DHCPOFFER and DHCPACK
        packets.
</p>
<p>DHCPv4 server MAY be configured to supply BFD configuration to the
        client only if bfd-endpoint sub-option is present in a DHCPDISCOVER or
        DHCPREQUEST packet. However, in a general case, the presence of the
        sub-option does not directly influence the server's decision to insert
        option TBD_3 in a packet; rather it places a requirement on the
        content of the option if the server chooses to insert it. For example,
        whether or not bfd-endpoint sub-option is present in DHCPDISCOVER or
        DHCPREQUEST, the server MUST NOT insert option TBD_3 in DHCPOFFER or
        DHCPACK if option TBD_1 was not supplied by the client. This is
        consistent with usage of other sub-options of relay-agent-info
        option.
</p>
<p>Below is a sample call flow with DHCPv4 relay agent:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
DHCPv4 client /   IP Edge acting                      DHCPv4 server
IP Endpoint       as DHCPv4 relay

-DHCPDISCOVER -&gt;  IP Edge inserts  --DHCPDISCOVER -&gt;  Server retrieves
    (TBD_1)       relay-agent-info  (TBD_1 + TBD_5)   BFD configuration
                  option with bfd-                    from bfd-endpoint
                  endpoint sub-option                 sub-option

&lt;--DHCPOFFER ---  IP Edge relays   &lt;--DHCPOFFER ----  Server constructs
    (TBD_3)       DHCPOFFER to      (TBD_3 + TBD_5)   option TBD_3
                  the client                          using bfd-endpoint
                                                      sub-option,inserts
                                                      TBD_3 into
                                                      DHCPOFFER

--DHCPREQUEST -&gt;  IP Edge inserts  --DHCPREQUEST --&gt;  Server retrieves
    (TBD_1)       relay-agent-info   (TBD_1 + TBD_5)  BFD configuration
                  option with bfd-                    from bfd-endpoint
                  endpoint sub-option                 sub-option

&lt;--DHCPACK -----  IP Edge relays   &lt;--DHCPACK ------  Server constructs
    (TBD_3)       DHCPACK to        (TBD_3 + TBD_5)   option TBD_3
                  the client                          using bfd-endpoint
                                                      sub-option,inserts
                                                      TBD_3 into DHCPACK

&lt;--BFD poll-----  IP Edge initiates
                  BFD polling
--BFD response-&gt;

&lt;--BFD poll-----

--BFD response-&gt;
</pre></div>
<p>Similarly, an operator may wish to program BFD endpoint
        configuration on a DHCPv6 relay agent rather than the server. To
        enable DHCPv6 server to use BFD endpoint configuration provided by a
        relay agent, the relay agent MAY insert option TBD_4 into RELAY_FORW
        packet that it sends to the server upon receiving SOLICIT, REQUEST,
        CONFIRM, RENEW, REBIND, or INFORMATON_REQUEST packet from an IP
        endpoint. If a server detects option TBD_4 in RELAY_FORW it MUST
        insert it unchanged into respective client message that is
        subsequently appended to RELAY_REPL packet, provided option TBD_2 is
        present in the original client packet. Relay agent then transparently
        passes ADVERTISE, REPLY, or RECONFIGURE message with embedded option
        TBD_4 to the client.
</p>
<p>Below is a sample call flow with DHCPv6 relay agent:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
DHCPv6 client /   IP Edge acting as                   DHCPv6 server
IP Endpoint       DHCPv6 relay


--SOLICIT -----&gt;  IP Edge inserts  --RELAY_FORW ---&gt;  Server copies
  (TBD_2)         option TBD_4      (TBD_4, TBD_2     TBD_4 into REPLY
                  into RELAY_FORW    embedded in      message and
                                     SOLICIT msg)     inserts the REPLY
                                                      into REPLAY_REPL

&lt;--REPLY -------  IP Edge extracts  &lt;--RELAY_REPL---  Server sends
  (TBD_4)         REPLY and relays   (TBD_4 embedded  RELAY_REPL
                  it transparently   in REPLY msg)    to IP Edge
                  to the client

--REQUEST -----&gt;  IP Edge inserts   --RELAY_FORW --&gt;  Server copies
  (TBD_2)         option TBD_4      (TBD_2 + TBD_4)   TBD_4 into REPLY
                  into RELAY_FORW                     message and
                                                      inserts the REPLY
                                                      into REPLAY_REPL

&lt;--REPLY -------  IP Edge extracts  &lt;--RELAY_REPL---  Server sends
  (TBD_4)         REPLY and relays   (TBD_4 embedded  RELAY_REPL
                  it transparently   in REPLY msg)    to IP Edge
                  to the client

&lt;-BFD poll------  IP Edge initiates
                  BFD polling
--BFD response-&gt;

&lt;--BFD poll-----

--BFD response-&gt;
</pre></div>
<p>
</p>
<p>
</p>
<a name="IpEdge"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
BFD Provisioning and Management on IP Edge</h3>

<p>BFD provisioning on IP Edge is not done via DHCP; it is a
      responsibility of IP Edge operator and is out of scope of this document.
      Likewise, DHCP is not responsible for configuring Remote IP address
      provided to IP endpoint in option TBD_3 or TBD_4 on IP Edge.
</p>
<p>IP Edge is expected to be the active BFD peer (BFD role on the
      endpoint is Passive by default, see <a class='info' href='#Parameters'>Section
      2.3<span> (</span><span class='info'>BFD Configuration Parameters</span><span>)</span></a>). If BFD on an endpoint is provisioned via DHCP, IP Edge
      configured as DHCP server or relay agent can initiate BFD session with
      the endpoint immediately after completion of DHCP messaging. This is an
      additional benefit of the DHCP based BFD configuration: any other
      provisioning method, e.g. via an ACS server (<a class='info' href='#TR-069'>[TR&#8209;069]<span> (</span><span class='info'>DSLHome-Technical Working Group, &ldquo;CPE WAN Management Protocol,&rdquo; May&nbsp;2004.</span><span>)</span></a>) is asynchronous with IP connectivity
      establishment between IP Edge and the endpoint and does not give IP Edge
      any an indication of BFD availability on the endpoint.
</p>
<p>While DHCP module on IP Edge MAY assist with the timing of BFD
      session initiation, it is not a bootstrapping or management client of
      BFD. BFD does not inform DHCP server or relay of BFD failures and thus
      does not influence the state of IP address lease by the endpoint.
</p>
<a name="IpAddress"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
BFD and IP Address Lifecycle</h3>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
BFD and DHCPv4 Client States</h3>

<p>BFD can operate on an endpoint for as long as IP address lease by
        DHCP client is valid. If lease renewal fails for some reason and
        DHCPv4 client transitions to DHCP INIT state, BFD MUST be disabled.
        Subsequently, BFD can only be re-enabled upon successful DHCP
        renegotiation and DHCP transitioning into BOUND state.
</p>
<p>BFD MAY be initiated by DHCP client upon its transitioning into
        BOUND state provided a valid option TBD_3 is received by the client in
        a DHCPv4 packet. BFD is disabled by DHCP client when the DHCPv4 client
        transitions into INIT state.
</p>
<p>Thus, BFD can run on an IP endpoint configured by DHCP when DHCP
        client is in BOUND, RENEWING, REBINDING, INIT-REBOOT and REBOOTING
        states only. In DHCP INIT, SELECTING and REQUESTING states BFD
        operation is undefined.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
BFD and DHCPv6 Client</h3>

<p>DHCPv6 does not have a formal state machine like DHCPv4. Therefore,
        BFD operation on an IPv6 endpoint running DHCPv6 client is best
        described in relation to the lifecycle of IPv6 address lease. As with
        DHCPv4, BFD can only run on an IPv6 endpoint wit ha valid IPv6
        address. If IP address lease expires BFD MUST be disabled. BFD MAY be
        enabled when a configuration with a valid IPv6 address is applied on
        the endpoint, provided BFD configuration is supplied in option TBD_4
        or by some other means.
</p>
<p>It is possible that IPv6 endpoints running DHCPv6 client use SLAAC
        to obtain their network address. Such endpoints could still use DHCPv6
        for BFD configuration. Specifically, once an endpoint is configured
        with an IPv6 address, it MAY send an INFORMATION-REQUEST message with
        an option TBD_2. Processing by the server or relay agent should be the
        same in this case as for a regular DHCPv6 client. The contents of
        <a class='info' href='#Endpoint'>Section 2<span> (</span><span class='info'>BFD Provisioning on IP Endpoint</span><span>)</span></a> fully applies to this
        situation.
</p>
<p>
</p>
<a name="BFDFailure"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
BFD Failure and DHCP Client</h3>

<p>If BFD on an IP endpoint is configured using DHCP options TBD_3 or
      TBD_4, DHCP client is a client application of BFD in the sense of <a class='info' href='#I-D.ietf-bfd-generic'>[I&#8209;D.ietf&#8209;bfd&#8209;generic]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Generic Application of BFD,&rdquo; January&nbsp;2008.</span><span>)</span></a>. Thus, BFD events, e.g. unplanned
      BFD failures SHOULD be reported to DHCP client. If BFD on an endpoint
      detects a planned failure, e.g. the BFD peer transition to AdminDown
      state, DHCP client SHOULD NOT be informed. Decision of whether or not to
      inform DHCP MAY be based on BFD Diag code.
</p>
<p>Modern Access and Aggregation networks connecting dynamically
      configured endpoints and their IP Edge device can be quite complex and
      have non-trivial redundancy behavior designed to minimize service
      interruptions. Given that DHCP packets are often used for subscriber
      line authentication and session establishment, some self-healing network
      designs may rely on DHCP message exchange initiated upon connectivity
      interruption between IP Edge and an endpoint. However, DHCP exchanges
      initiated by DHCP servers are typically disallowed in broadband
      scenarios for security reasons and a mechanism informing DHCP client of
      IP connectivity loss with the network is currently missing.
</p>
<p>BFD running on an endpoint provides such mechanism. Unplanned BFD
      failure on an endpoint indicates loss of IP connectivity with IP Edge.
      Therefore, indication of unplanned BFD failure can be used by DHCP
      client to react to interruptions in IP connectivity in the same way as
      is currently specified for L2 loss.
</p>
<p>If IP endpoint is running DHCPv4 client, the client MAY transition
      into INIT-REBOOT state upon receiving a notification of BFD failure. If
      IP endpoint is running DHCPv6 client, the client MAY consider loss of
      BFD to be equivalent to loss of L2, and initiate a Confirm messages
      exchange as described in section 18.1.2 of <a class='info' href='#RFC3315'>[RFC3315]<span> (</span><span class='info'>Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6),&rdquo; July&nbsp;2003.</span><span>)</span></a>. The exact behavior of DHCP client upon
      receiving unplanned BFD failure notification is determined by the
      operator and is outside the scope of this document.
</p>
<a name="InitMethods"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Other BFD Initialization Methods</h3>

<p>BFD on an IP endpoint can be pre-provisioned or configured by
      mechanisms other than DHCP, e.g. manually or via ACS per <a class='info' href='#TR-069'>DSLF TR-069<span> (</span><span class='info'>DSLHome-Technical Working Group, &ldquo;CPE WAN Management Protocol,&rdquo; May&nbsp;2004.</span><span>)</span></a> [TR&#8209;069]. As DHCP-based BFD configuration is
      initiated by the endpoint using DHCP option TBD_1 or TBD_2, it is
      expected that, once this provisioning mode is selected, no other
      mechanisms to configure BFD will be used.
</p>
<p>If BFD has been pre-provisioned on an IP endpoint, DHCP-based
      configuration SHOULD override pre-provisioned BFD configuration with the
      exception of Control Plane Independent (C) Bit. Proper setting of C bit
      requires knowledge of BFD implementation on the endpoint and thus
      pre-provisioned value is more reliable than the one supplied by DHCP.
      Likewise, BFD initialization information in option TBD_3 or TBD_4 SHOULD
      override any BFD configuration present on an IP endpoint at the time of
      DHCP negotiation, with the exception of C-bit, no matter what its origin
      is.
</p>
<p>In particular, if Enable bit in the option TBD_3 or TBD_4 in a DHCP
      packet received by the endpoint is set to 0, BFD MUST NOT be initiated
      even if BFD configuration has been pre-provisioned by other means. In
      case BFD is already running by the time options TBD_3 or TBD_4 are
      received with Enable bit set to 0, BFD SHOULD be disabled no matter what
      the origin of its configuration is.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This document requests IANA to allocate option and sub-option codes
      for newly defined DHCP options and sub-options as described in the
      text.
</p>
<p>Note to RFC Editor: this section may be removed on publication as an
      RFC.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>The configuration of BFD by DHCP is subject to the same security
      concerns as is the configuration of an endpoint by DHCP in general;
      these are outlined in <a class='info' href='#RFC2131'>[RFC2131]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a>. Potentially, a
      malicious user snooping on DHCP interaction between IP Edge and an
      endpoint can retrieve BFD discriminator values and hijack the BFD
      session. This can lead to temporary disruption of IP connectivity for
      the endpoint.
</p>
<p>In the networks with high security risk, BFD authentication SHOULD be
      enabled for BFD running between IP endpoints. To ensure security of
      authentication keys, DHCP messages containing options TBD_3 or TBD_4
      with BFD authentication information MUST be authenticated using the
      procedures described in <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a>. Messages failing
      the authentication should be silently discarded by the client.
</p>
<p>An alternative DHCP based authentication mechanism has been proposed
      in <a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R. and G. Zorn, &ldquo;EAP Authentication Extensions for the Dynamic Host Configuration Protocol for Broadband,&rdquo; February&nbsp;2010.</span><span>)</span></a>. The progress of that
      document in DHC WG will be closely followed, and this draft will be
      updated accordingly.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgements</h3>

<p>Authors would like to thank Ralph Droms for reviewing the document
      prior to publication and providing many insightful comments.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-bfd-base">[I-D.ietf-bfd-base]</a></td>
<td class="author-text">Katz, D. and D. Ward, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-base-08.txt">Bidirectional Forwarding Detection</a>,&rdquo; draft-ietf-bfd-base-08 (work in progress), March&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-base-08.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-bfd-generic">[I-D.ietf-bfd-generic]</a></td>
<td class="author-text">Katz, D. and D. Ward, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-generic-04.txt">Generic Application of BFD</a>,&rdquo; draft-ietf-bfd-generic-04 (work in progress), January&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-generic-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-bfd-v4v6-1hop">[I-D.ietf-bfd-v4v6-1hop]</a></td>
<td class="author-text">Katz, D. and D. Ward, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-v4v6-1hop-08.txt">BFD for IPv4 and IPv6 (Single Hop)</a>,&rdquo; draft-ietf-bfd-v4v6-1hop-08 (work in progress), March&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-v4v6-1hop-08.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.pruss-dhcp-auth-dsl">[I-D.pruss-dhcp-auth-dsl]</a></td>
<td class="author-text">Pruss, R. and G. Zorn, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-pruss-dhcp-auth-dsl-07.txt">EAP Authentication Extensions for the Dynamic Host Configuration Protocol for Broadband</a>,&rdquo; draft-pruss-dhcp-auth-dsl-07 (work in progress), February&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-pruss-dhcp-auth-dsl-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2131">[RFC2131]</a></td>
<td class="author-text"><a href="mailto:droms@bucknell.edu">Droms, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2131">Dynamic Host Configuration Protocol</a>,&rdquo; RFC&nbsp;2131, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2131.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2131.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2131.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3046">[RFC3046]</a></td>
<td class="author-text">Patrick, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3046">DHCP Relay Agent Information Option</a>,&rdquo; RFC&nbsp;3046, January&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3046.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3118">[RFC3118]</a></td>
<td class="author-text">Droms, R. and W. Arbaugh, &ldquo;<a href="http://tools.ietf.org/html/rfc3118">Authentication for DHCP Messages</a>,&rdquo; RFC&nbsp;3118, June&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3118.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3315">[RFC3315]</a></td>
<td class="author-text">Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>,&rdquo; RFC&nbsp;3315, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3315.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TR-069">[TR-069]</a></td>
<td class="author-text">DSLHome-Technical Working Group, &ldquo;<a href="http://www.dslforum.org/techwork/tr/TR-069.pdf">CPE WAN Management Protocol</a>,&rdquo; May&nbsp;2004.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Vitali Vinokour</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1414 Massachusetts Ave</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Boxborough, MA  01719</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-978-936-0774</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:vvinokou@cisco.com">vvinokou@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dave Ward</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 W. Tasman Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-408-526-4000</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dward@cisco.com">dward@cisco.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href=""></a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
