<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Requirements for an Tunnel Based EAP Method</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Requirements for an Tunnel Based EAP Method">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">EMU Working Group</td><td class="header">K. Hoeper</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">NIST</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">S. Hanna</td></tr>
<tr><td class="header">Expires: December 7, 2008</td><td class="header">Juniper Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. Zhou</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">J. Salowey, Ed.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 05, 2008</td></tr>
</table></td></tr></table>
<h1><br />Requirements for an Tunnel Based EAP Method<br />draft-salowey-emu-eaptunnel-req-01.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on December 7, 2008.</p>

<h3>Abstract</h3>

<p> This memo defines the requirements for a tunnel-based Extensible Authentication Protocol (EAP) Method.   This method will use Transport Layer Security (TLS) to establish a secure tunnel.  The tunnel will provide support for password authentication, EAP authentication and the transport of additional data for other purposes.  
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<br />
<a href="#anchor2">2.</a>&nbsp;
Conventions Used In This Document<br />
<br />
<a href="#anchor3">3.</a>&nbsp;
Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Password Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Protect Weak EAP Methods<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
Chained EAP Methods<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.4.</a>&nbsp;
Identity Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.5.</a>&nbsp;
Emergency Services Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.6.</a>&nbsp;
Network Endpoint Assessment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.7.</a>&nbsp;
Credential Provisioning and Enrollment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.8.</a>&nbsp;
Resource Constrained Environments<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.9.</a>&nbsp;
Client Authentication During Tunnel Establishment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.10.</a>&nbsp;
Extensibility<br />
<br />
<a href="#reqs">4.</a>&nbsp;
Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.1.</a>&nbsp;
General Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.1.1.</a>&nbsp;
RFC Compliance<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.1.2.</a>&nbsp;
Draw from Existing Work<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.2.</a>&nbsp;
Tunnel Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.2.1.</a>&nbsp;
TLS Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.2.1.1.</a>&nbsp;
Cipher Suites<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">4.2.1.1.1.</a>&nbsp;
Cipher Suite Negotiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">4.2.1.1.2.</a>&nbsp;
Tunnel Data Protection Algorithms<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#keyest">4.2.1.1.3.</a>&nbsp;
Tunnel Authentication and Key Establishment<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.2.1.2.</a>&nbsp;
Tunnel Replay Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.2.1.3.</a>&nbsp;
TLS Extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">4.2.1.4.</a>&nbsp;
Peer Identity Privacy<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">4.2.1.5.</a>&nbsp;
Session Resumption<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">4.2.2.</a>&nbsp;
Fragmentation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">4.2.3.</a>&nbsp;
EAP Header Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">4.3.</a>&nbsp;
Tunnel Payload Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">4.3.1.</a>&nbsp;
Extensible Attribute Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">4.3.2.</a>&nbsp;
Request/Challenge Response Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">4.3.3.</a>&nbsp;
Mandatory and Optional Attributes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">4.3.4.</a>&nbsp;
Vendor Specific Support<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">4.3.5.</a>&nbsp;
Result Indication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">4.3.6.</a>&nbsp;
Internationalization of Display Strings<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">4.4.</a>&nbsp;
EAP Channel Binding Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">4.5.</a>&nbsp;
Requirements Associated with Carrying Username and Passwords<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">4.5.1.</a>&nbsp;
Security<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">4.5.1.1.</a>&nbsp;
Confidentiality and Integrity<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">4.5.1.2.</a>&nbsp;
Authentication of Server<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#revocation">4.5.1.3.</a>&nbsp;
Server Credential Revocation Checking<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">4.5.2.</a>&nbsp;
Internationalization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">4.5.3.</a>&nbsp;
Meta-data<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">4.5.4.</a>&nbsp;
Password Change<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">4.6.</a>&nbsp;
Requirements Associated with Carrying EAP Methods<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">4.6.1.</a>&nbsp;
Method Negotiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">4.6.2.</a>&nbsp;
Chained Methods<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">4.6.3.</a>&nbsp;
Cryptographic Binding with TLS Tunnel<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor47">4.6.4.</a>&nbsp;
Peer Initiated<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor48">4.6.5.</a>&nbsp;
Method Meta-data<br />
<br />
<a href="#anchor49">5.</a>&nbsp;
IANA Considerations<br />
<br />
<a href="#Security">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#secciph">6.1.</a>&nbsp;
Ciphersuite Selection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor50">6.2.</a>&nbsp;
Tunneled Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor51">6.3.</a>&nbsp;
Outer EAP Method Header<br />
<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Running EAP methods within a TLS protected tunnel has been deployed in several different solutions.  EAP methods supporting this include PEAP, <a class='info' href='#I-D.funk-eap-ttls-v0'>TTLS<span> (</span><span class='info'>Funk, P. and S. Blake-Wilson, &ldquo;EAP Tunneled TLS Authentication Protocol Version 0 (EAP-TTLSv0),&rdquo; April&nbsp;2008.</span><span>)</span></a> [I&#8209;D.funk&#8209;eap&#8209;ttls&#8209;v0] and <a class='info' href='#RFC4851'>EAP-FAST<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a> [RFC4851].  There have been various reasons for employing a protected tunnel for EAP processes.  They include protecting weak authentication exchanges, such as username and password.  In addition a protected tunnel can provide a means to provide peer identity protection and EAP method chaining.  Finally, systems have found it useful to transport additional types of data within the protected tunnel.
</p>
<p>This document describes the requirements for an EAP  tunnel method as well as for a password protocol supporting legacy password databases within the tunnel method.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions Used In This Document</h3>

<p>Because this specification is an informational specification  
    (not able to directly use <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>), the following capitalized  
    words are used to express requirements language used in this  
    specification.  Use of each capitalized word within a sentence  
    or phrase carries the following meaning during the EMU WG's  
    method selection process:
</p>
<blockquote class="text">
<p><br />
MUST - indicates an absolute requirement 
</p>
<p><br />
MUST NOT - indicates something absolutely prohibited 
</p>
<p><br />
SHOULD - indicates a strong recommendation of a desired result
</p>
<p><br />
SHOULD NOT - indicates a strong recommendation against a result
</p>
<p><br />
MAY - indicates a willingness to allow an optional outcome
</p>
</blockquote>
<p>Lower case uses of "MUST", "MUST NOT", "SHOULD", "SHOULD NOT" and  
    "MAY" carry their normal meaning and are not subject to these  
    definitions.  
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Use Cases</h3>

<p>To motivate and explain the requirements in this document, a representative set of use cases for the EAP tunnel method are supplied here. The candidate tunnel method is expected to meet all of the use cases marked as MUST.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Password Authentication</h3>

<p>Many legacy systems only support user authentication with passwords.  Some of these systems require transport of the actual username and password to the authentication server.  This is true for systems where the authentication server does not have access to the cleartext password or a consistent transform of the cleartext password.  Example of such systems are one time password (OTP) systems and other systems where the username and password are submitted to an external party for validation.  The tunnel method MUST meet this use case. However, it MUST NOT expose the username and password to untrusted parties and it MUST provide protection against man-in-the-middle and dictionary attacks.
</p>
<p>Since EAP authentication occurs before network access is granted the tunnel method SHOULD provide support for minimal password management tasks including password change, "new PIN mode", and "next token mode" required by some systems.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Protect Weak EAP Methods</h3>

<p>Some existing EAP methods have vulnerabilities that could be eliminated or reduced by running them inside a protected tunnel.  For example, a method such as EAP-MD5 does not provide mutual authentication or protection from dictionary attacks.   In addition, tunneled EAP methods are subject to a specific form of man-in-the-middle attack described in <a class='info' href='#TUNNEL-MITM'>[TUNNEL&#8209;MITM]<span> (</span><span class='info'>Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunnelled Authentication Protocols,&rdquo; November&nbsp;2002.</span><span>)</span></a>.
</p>
<p>The tunnel method MUST support protection of weak inner methods and protect against man-in-the-middle attacks associated with tunneled authentication.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Chained EAP Methods</h3>

<p>Several circumstances are best addressed by using chained EAP methods.
For example, it may be desirable to authenticate the user and also authenticate the device that he or she is using. However, chained EAP methods from different conversations can be re-directed into the same conversation by an attacker giving the authenticator the impression that both conversations terminate at the same end-point.  Cryptographic binding can be used to bind the results of key generating methods together or to an encompassing tunnel.
</p>
<p>The tunnel method MUST support chained EAP methods while including strong protection against attacks on the method chaining.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Identity Protection</h3>

<p>When performing an EAP authentication, the peer may want to protect its identity, only disclosing its identity to a trusted backend authentication server.  This helps to maintain the privacy of the peer's identity.
</p>
<p>The tunnel method MUST support identity protection, ensuring that peer identity is not disclosed to the authenticator and any other intermediaries before the server that terminates the tunnel method.  If an inner method also provides identity protection, this protection MUST extend all the way to the server that terminates that inner method.  Note that the peer may need to expose the realm portion of the EAP outer identity in the NAI <a class='info' href='#RFC4282'>[RFC4282]<span> (</span><span class='info'>Aboba, B., Beadles, M., Arkko, J., and P. Eronen, &ldquo;The Network Access Identifier,&rdquo; December&nbsp;2005.</span><span>)</span></a> in a roaming scenario in order to reach the appropriate authentication server.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Emergency Services Authentication</h3>

<p>When wireless VOIP service is provided, some regulations require any user to be able to gain access to the network to make an emergency telephone call. To avoid eavesdropping on this call, it's best to negotiate link layer security as with any other authentication.
</p>
<p>Therefore, the tunnel method SHOULD allow anonymous peers or server-only authentication, but still derive keys that can be used for link layer security.  The tunnel method MAY also allow for the bypass of server authentication processing on the client.  Forgoing authentication increases the chance of man-in-the-middle and other types of attacks that can compromise the derived keys used for link layer security.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Network Endpoint Assessment</h3>

<p>The Network Endpoint Assessment (NEA) protocols and reference model described in <a class='info' href='#I-D.ietf-nea-requirements'>[I&#8209;D.ietf&#8209;nea&#8209;requirements]<span> (</span><span class='info'>Sangster, P., &ldquo;Network Endpoint Assessment (NEA): Overview and Requirements,&rdquo; April&nbsp;2008.</span><span>)</span></a> provide a standard way to check the health ("posture") of a device at or after the time it connects to a network. If the device does not comply with the network's requirements, it can be denied access to the network or granted limited access to remediate itself. EAP is a convenient place for conducting an NEA exchange.
</p>
<p>The tunnel method SHOULD support carrying NEA protocols such as PB-TNC <a class='info' href='#I-D.ietf-nea-pb-tnc'>[I&#8209;D.ietf&#8209;nea&#8209;pb&#8209;tnc]<span> (</span><span class='info'>Sahita, R., Hanna, S., and K. Narayan, &ldquo;PB-TNC: A Posture Broker Protocol (PB) Compatible with TNC,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
Depending on the specifics of the tunnel method, these protocols may be required to be carried in an EAP method.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Credential Provisioning and Enrollment</h3>

<p>When a peer has authenticated with EAP, this is a convenient time to distribute credentials to that peer that may be used for later authentication exchanges. For example, the authentication server can provide a private key or shared key to the peer that can be used by the peer to perform rapid re-authentication or roaming. In addition there have been proposals to perform enrollment within EAP, such as <a class='info' href='#I-D.mahy-eap-enrollment'>[I&#8209;D.mahy&#8209;eap&#8209;enrollment]<span> (</span><span class='info'>Mahy, R., &ldquo;An Extensible Authentication Protocol (EAP) Enrollment Method,&rdquo; March&nbsp;2006.</span><span>)</span></a>.  
</p>
<p>The tunnel method SHOULD support carrying credential distribution protocols.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.8"></a><h3>3.8.&nbsp;
Resource Constrained Environments</h3>

<p> A growing number of "resource constrained" devices (e.g. printers and
phones) are connecting to IP networks and those networks increasingly require EAP authentication to gain access. Therefore, it is natural to expect that new EAP methods be designed to work as well as possible with these devices.
</p>
<p>For the purposes of this document, the phrase "resource constrained"
means any combination of the following constraints: little processing power, small amounts of memory (both ROM and RAM), small amounts of long-term mutable storage (e.g. flash or hard drive) or none at all, and constrained power usage (perhaps due to small battery).
</p>
<p>The tunnel method SHOULD be designed so it can be configured to work with "resource constrained" devices, when possible.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.9"></a><h3>3.9.&nbsp;
Client Authentication During Tunnel Establishment</h3>

<p>In cases where client authentication can be performed as part of the tunnel establishment it is efficient for the tunnel method to allow this.  The tunnel MUST be capable of providing client side authentication during tunnel establishment.  

</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.10"></a><h3>3.10.&nbsp;
Extensibility</h3>

<p> The tunnel method MUST provide extensibility so that additional types of data can be carried inside the tunnel in the future. This removes the need to develop new tunneling methods for specific purposes. 
</p>
<a name="reqs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Requirements</h3>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
General Requirements</h3>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
RFC Compliance</h3>

<p>The tunnel method MUST include a Security Claims section with all security claims specified in Section 7.2 in <a class='info' href='#RFC3748'>RFC 3748<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> [RFC3748]. In addition, it MUST meet the requirement in Sections 2.1 and 7.4 of RFC 3748 that tunnel methods MUST support protection against man-in-the-middle attacks. Furthermore, all tunnel methods MUST support identity protection as specified in Section 7.3 in RFC 3748.
</p>
<p>The tunnel method MUST be unconditionally compliant with <a class='info' href='#RFC4017'>RFC 4017<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4017] (using the definition of "unconditionally compliant" contained in section 1.1 of RFC 4017). This means that the method MUST satisfy all the MUST, MUST NOT, SHOULD, and SHOULD NOT requirements in RFC 4017.
</p>
<p>The tunnel method MUST meet all the EAP method requirements contained in the EAP Key Management Framework draft <a class='info' href='#I-D.ietf-eap-keying'>[I&#8209;D.ietf&#8209;eap&#8209;keying]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; November&nbsp;2007.</span><span>)</span></a> or its successor. The tunnel method MUST include MSK and EMSK generation.  This will enable the tunnel method to properly fit into the EAP key management framework, maintaining all of the security properties and guarantees of that framework.
</p>
<p>The tunnel method MUST NOT be tied to any single cryptographic algorithm.
Instead, it MUST support run-time negotiation to select among an extensible set of cryptographic algorithms. This "cryptographic algorithm agility"
provides several advantages. Most important, when a weakness in an algorithm is discovered or increased processing power overtakes an algorithm, users can easily transition to a new algorithm. Also, users can choose the algorithm that best meets their needs.
</p>
<p>The tunnel method MUST meet requirements pertinent to EAP method contained in Section 3 of <a class='info' href='#RFC4962'>RFC 4962<span> (</span><span class='info'>Housley, R. and B. Aboba, &ldquo;Guidance for Authentication, Authorization, and Accounting (AAA) Key Management,&rdquo; July&nbsp;2007.</span><span>)</span></a> [RFC4962].  This includes: cryptographic algorithm independence; strong, fresh session keys; replay detection; keying material confidentiality and integrity; confirm cipher suite selection; and uniquely named keys. In addition, the tunnel method MUST support EAP channel bindings to enable a system based on EAP to meet the additional requirements in Section 3 of RFC 4962.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Draw from Existing Work</h3>

<p>Several existing tunnel methods are already in widespread usage:
EAP-FAST <a class='info' href='#RFC4851'>[RFC4851]<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a>, EAP-TTLS <a class='info' href='#I-D.funk-eap-ttls-v0'>[I&#8209;D.funk&#8209;eap&#8209;ttls&#8209;v0]<span> (</span><span class='info'>Funk, P. and S. Blake-Wilson, &ldquo;EAP Tunneled TLS Authentication Protocol Version 0 (EAP-TTLSv0),&rdquo; April&nbsp;2008.</span><span>)</span></a>, and PEAP. Considerable experience has been gained from various deployments with these methods. This experience SHOULD be considered when evaluating tunnel methods. If one of these existing tunnel methods can meet the requirements contained in this specification then that method SHOULD be preferred over a new method.
</p>
<p>Even if minor modifications or extensions to an existing tunnel method are needed, this method SHOULD be preferred over a completely new method so that the advantage of accumulated deployment experience and security analysis can be gained. 
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Tunnel Requirements</h3>

<p>Existing tunnel methods make use of TLS <a class='info' href='#I-D.ietf-tls-rfc4346-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4346&#8209;bis]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; March&nbsp;2008.</span><span>)</span></a> to provide the protected tunnel.  In general this has worked well so there is consensus to continue to use TLS as the basis for a tunnel method. 
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
TLS Requirements</h3>

<p>The tunnel based method MUST support TLS version 1.2 <a class='info' href='#I-D.ietf-tls-rfc4346-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4346&#8209;bis]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; March&nbsp;2008.</span><span>)</span></a> and SHOULD support TLS version 1.0 <a class='info' href='#RFC2246'>[RFC2246]<span> (</span><span class='info'>Dierks, T. and C. Allen, &ldquo;The TLS Protocol Version 1.0,&rdquo; January&nbsp;1999.</span><span>)</span></a> and version 1.1 <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a> to enable the possibility of backwards compatibility with existing deployments. The following section discusses requirements for TLS Tunnel Establishment.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1"></a><h3>4.2.1.1.&nbsp;
Cipher Suites</h3>

<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1.1"></a><h3>4.2.1.1.1.&nbsp;
Cipher Suite Negotiation</h3>

<p>Cipher suite negotiations always suffer from downgrading attacks when they are not secured by any kind of integrity protection. A common practice is a post integrity check in which, as soon as available, the established keys (here the tunnel key) are used to derive integrity keys. These integrity keys are then used by peer and authentication server to verify whether the cipher suite negotiation has been maliciously altered by another party.
</p>
<p>Integrity checks prevent downgrading attacks only if the derived integrity keys and the employed integrity algorithms cannot be broken in real-time.  See <a class='info' href='#secciph'>Section&nbsp;6.1<span> (</span><span class='info'>Ciphersuite Selection</span><span>)</span></a> or <a class='info' href='#KHLC07'>[KHLC07]<span> (</span><span class='info'>Hoeper, K. and L. Chen, &ldquo;Where EAP Security Claims Fail,&rdquo; August&nbsp;2007.</span><span>)</span></a> for more information on this.  Hence, the tunnel method MUST provide integrity protected cipher suite negotiation with secure integrity algorithms and integrity keys. 
</p>
<p> All versions of TLS meet these requirements as long as the cipher suites used provide strong authentication, key establishment and data integrity protection.   

</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1.2"></a><h3>4.2.1.1.2.&nbsp;
Tunnel Data Protection Algorithms</h3>

<p>In order to prevent attacks on the cryptographic algorithms employed by inner authentication methods, a tunnel protocol's protection needs to provide a basic level of algorithm strength.  The tunnel method MUST provide at least one mandatory to implement cipher suite that provides the equivalent security of 128-bit AES for encryption and message authentication. See <a class='info' href='#NIST SP 800-57'>[NIST SP 800&#8209;57]<span> (</span><span class='info'>Barker, E., Barker, W., Burr, W., Polk, W., and M. Smid, &ldquo;Recommendation for Key Management - Part 1: General (Revised),&rdquo; March&nbsp;2007.</span><span>)</span></a> for a discussion of the relative strengths of common algorithms.

</p>
<a name="keyest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.1.3"></a><h3>4.2.1.1.3.&nbsp;
Tunnel Authentication and Key Establishment</h3>

<p>A tunnel method MUST provide unidirectional authentication from authentication server to EAP peer or mutual authentication between authentication server and EAP peer.  The tunnel method MUST provide at least one mandatory to implement cipher suite that provides certificate based authentication of the server and provides optional certificate based authentication of the client. Other types of authentication MAY be supported.
</p>
<p>At least one mandatory to implement cipher suite MUST meet the
   following requirements for secure key establishment along with the
   previous requirements for authentication and data protection
   algorithms: 
</p>
<p></p>
<ul class="text">
<li>One-way key derivation, i.e., a compromised key leads to
      the compromise of all descendant keys but does not affect the
      security of any precedent key in the same branch of the key
      hierarchy. <br />
<br />

</li>
<li>Cryptographically separated keys, i.e., a compromised key in one branch of the key hierarchy
      does not affect the security of keys in other branches.
<br />
<br />
 
</li>
<li>Cryptographically separated entities, i.e., keys held by different entities are cryptographically separate. As a result, the
      compromise of a single peer does not compromise keying
      material held by any other peer within the system, including
      session keys and long-term keys. <br />
<br />

</li>
<li>Identity binding, i.e., each derived key is bound to the EAP peer and authentication
      server by including their identifiers as input to the key derivation.
<br />
<br />

</li>
<li>Context binding, i.e., each derived key is bound to its context by including appropriate
      key labels in the input of the key derivation. <br />
<br />

</li>
<li>Key lifetime, i.e., each key has a lifetime assigned that does not exceed the
      lifetime of any key higher in the key hierarchy. <br />
<br />

</li>
<li> Mutual implicit key authentication, i.e., the keying material
      derived upon a successful key establishment execution is only
      known to the EAP peer and authentication server and is kept
      confidential.
 <br />
<br />

</li>
<li>Key freshness, i.e.  EAP peer and EAP server are assured that the
      derived keys are fresh and the re-use of expired key material is
      prevented.  The freshness property is typically achieved by using
      one or more of the following techniques: nonces, sequence numbers,
      timestamps. <br />
<br />

</li>
</ul>

<p>The mandatory to implement cipher suites MUST NOT
   include "export strength" cipher suites, cipher suites providing mutually anonymous authentication
   or static Diffie-Hellman cipher suites.  NIST publication <a class='info' href='#NIST SP 800-52'>[NIST SP 800&#8209;52]<span> (</span><span class='info'>Chernick, C., Edington III, C., Fanto, M., and R. Rosenthal, &ldquo;Guidelines for the Selection and Use of Transport Layer Security (TLS) Implementations,&rdquo; June&nbsp;2005.</span><span>)</span></a> can be consulted for a list of
   acceptable TLS v1.0 cipher suites and <a class='info' href='#NIST SP 800-108'>[NIST SP 800&#8209;108]<span> (</span><span class='info'>Chen, L., &ldquo;Recommendation for Key Derivation Using Pseudorandom Functions,&rdquo; April&nbsp;2008.</span><span>)</span></a> for additional information on secure key derivation.
</p>
<p>In addition a tunnel method SHOULD provide cipher suites to meet the following additional recommendations for good key establishment algorithms: 
</p>
<p></p>
<ul class="text">
<li>Key control , i.e., EAP peer and authentication server each contribute
      to the key computation of the tunnel key.  This property prevents
      that a single protocol participant controls the value of an
      established key.  In that way, protocol participants can ensure
      that generated keys are fresh and have good random properties. <br />
<br />

</li>
<li>Key confirmation, i.e., one protocol participant is assured that
      another participant actually possesses a particular secret key.
      In the case of mutual key confirmation both the EAP peer and the
      authentication server are assured that they possess the same key.
      Key confirmation is commonly achieved by using one of the derived
      keys to generate a message authentication code.  Mutual key
      confirmation combined with mutual implicit key authentication
      leads to mutual explicit key authentication.
 <br />
<br />

</li>
<li>Forward secrecy (FS), i.e., if a long-term secret key is
      compromised, it does not compromise keys that have been
      established in previous EAP executions.  This property is
      typically achieved by executing an ephemeral Diffie-Hellman key
      establishment. <br />
<br />

</li>
</ul><p>

</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.2"></a><h3>4.2.1.2.&nbsp;
Tunnel Replay Protection</h3>

<p>In order to prevent replay attacks on a tunnel protocol, the message authentication MUST be generated using a time-variant input such as timestamps, sequence numbers, nonces, or a combination of these so that any re-use of the authentication data can be detected as invalid.  TLS makes use of an 8 byte sequence number to protect against replay. 
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.3"></a><h3>4.2.1.3.&nbsp;
TLS Extensions</h3>

<p>In order to meet the requirements in this document TLS extensions MAY be used.  For example, TLS extensions may be useful in providing certificate revocation information via the TLS OCSP extension (thus meeting the requirement in <a class='info' href='#revocation'>Section&nbsp;4.5.1.3<span> (</span><span class='info'>Server Credential Revocation Checking</span><span>)</span></a>).
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.4"></a><h3>4.2.1.4.&nbsp;
Peer Identity Privacy</h3>

<p>A tunnel protocol MUST support peer privacy. This requires that the username is not transmitted in the clear  and, if applicable, the peer certificate is sent confidentially (i.e. encrypted). 
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1.5"></a><h3>4.2.1.5.&nbsp;
Session Resumption</h3>

<p>The tunnel method MUST support TLS session resumption as defined in <a class='info' href='#I-D.ietf-tls-rfc4346-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4346&#8209;bis]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; March&nbsp;2008.</span><span>)</span></a>.  The tunnel method MAY support other methods of session resumption such as those defined in <a class='info' href='#RFC5077'>[RFC5077]<span> (</span><span class='info'>Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig, &ldquo;Transport Layer Security (TLS) Session Resumption without Server-Side State,&rdquo; January&nbsp;2008.</span><span>)</span></a>. 
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Fragmentation</h3>

<p>Tunnel establishment sometimes requires the exchange of information that exceeds what can be carried in a single EAP message.  In addition information carried within the tunnel may also exceed this limit.  Therefore a tunnel method MUST support fragmentation and reassembly. 
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
EAP Header Protection</h3>

<p>A tunnel method SHOULD provide protection of the outer EAP header information when possible to make sure the outer EAP header is not modified by the intermediaries.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Tunnel Payload Requirements</h3>

<p>This section describes the payload requirements inside the tunnel. These requirements frequently express features that a candidate protocol must be capable of offering so that a  deployer can decide whether to make use of that feature.  This  section does not state requirements about what features of each protocol must be used during a deployment.  
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Extensible Attribute Types</h3>

<p> The payload MUST be extensible. Some standard payload attribute types will be defined to meet known requirements listed below, such as password authentication, inner EAP method, vendor specific attributes, and result indication. Additional payload attributes MAY be defined in the future to support additional features and data types.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Request/Challenge Response Operation</h3>

<p>The payload MUST support request and response type of half-duplex operation typical of EAP. Multiple attributes may be sent in a single payload. The payload MAY support carrying on multiple authentications in a single payload packet.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3"></a><h3>4.3.3.&nbsp;
Mandatory and Optional Attributes</h3>

<p>The payload MUST support marking of mandatory and optional attributes, as well as an attribute used for rejecting mandatory attributes. Mandatory attributes are attributes sent by the requester that the responder is expected to understand and MUST respond to. If the responder does not understand or support one of the mandatory attributes in the request, it MUST ignore the rest of the attributes and send a NAK attribute to decline the request. The NAK attribute MUST support inclusion of which mandatory attribute is not supported. The optional attributes are attributes that are not mandatory to support and respond to. If the responder does not understand or support the optional attributes, it can ignore these attributes.

</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.4"></a><h3>4.3.4.&nbsp;
Vendor Specific Support</h3>

<p>The payload MUST support communication of an extensible set of vendor-specific attributes.  These attributes will be segmented into uniquely identified vendor specific name spaces. They can be used for experiments or vendor specific features.
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.5"></a><h3>4.3.5.&nbsp;
Result Indication</h3>

<p>The payload MUST support result indication and its acknowledgement, so both the EAP peer and server will end up with a synchronized state. The result indication is needed after each chained inner authentication method and at the end of the authentication, so separate result indication for intermediate and final result MUST be supported.
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.6"></a><h3>4.3.6.&nbsp;
Internationalization of Display Strings</h3>

<p>The payload MAY provide a standard attribute format that supports international strings.  This attribute format MUST support encoding strings in 
    UTF-8 <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a> format.  Any
   strings sent by the server intended for display to the user MUST be sent in UTF-8 format and SHOULD be able to be marked with language information 
   and adapted to the user's language preference.
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
EAP Channel Binding Requirements</h3>

<p>The so-called "lying NAS" problem is a well-documented problem with the 
current Extensible Authentication Protocol (EAP) architecture <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> when 
used with pass-through authenticators.  Here, a Network Access Server (NAS), 
or pass-through authenticator, may authenticate to the backend AAA 
infrastructure using one set of credentials, while representing contrary 
information to EAP peers.
</p>
<p>Such attacks can be prevented by so-called channel bindings <a class='info' href='#I-D.clancy-emu-chbind'>[I&#8209;D.clancy&#8209;emu&#8209;chbind]<span> (</span><span class='info'>Clancy, C. and K. Hoeper, &ldquo;Channel Binding Support for EAP Methods,&rdquo; November&nbsp;2008.</span><span>)</span></a>, in which key channel binding characteristics are transported from the 
peer to the server, allowing the server to verify whether the authenticator 
has advertised valid information to the peer.  The server can also respond 
back with additional information that could be useful for the peer to decide 
whether or not to continue its session with the serving authenticator.
</p>
<p>
The tunnel method MUST be capable of supporting EAP channel bindings described above. 

</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Requirements Associated with Carrying Username and Passwords</h3>

<p>This section describes the requirements associated with tunneled password authentication. The password authentication mentioned here refers to user or machine authentication using a legacy password database, such as LDAP, OTP, etc. These legacy user databases typically require the password in its original text form in order to authenticate the peer, hence they require the peer to send the clear text user name and password to the EAP server.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1"></a><h3>4.5.1.&nbsp;
Security</h3>

<p>Due to the fact that the EAP peer needs to send clear text password to the EAP server to authenticate to the legacy user database, the security measures in the following sections MUST be met.
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1.1"></a><h3>4.5.1.1.&nbsp;
Confidentiality and Integrity</h3>

<p>The clear text password exchange MUST be integrity and confidentiality protected. As long as the password exchange occurs inside an authenticated and encrypted tunnel, this requirement is met.

</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1.2"></a><h3>4.5.1.2.&nbsp;
Authentication of Server</h3>

<p>The EAP server MUST be authenticated before the peer can send the clear text user name and password to the server. 
</p>
<a name="revocation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1.3"></a><h3>4.5.1.3.&nbsp;
Server Credential Revocation Checking</h3>

<p>In some cases, the EAP peer needs to present its password to the server before it has network access to check the revocation status of the server's credentials.  Therefore,  the tunnel method MUST support mechanisms to check the revocation status of a credential. The tunnel method SHOULD make use of Online Certificate Status Protocol (OCSP) <a class='info' href='#RFC2560'>[RFC2560]<span> (</span><span class='info'>Myers, M., Ankney, R., Malpani, A., Galperin, S., and C. Adams, &ldquo;X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP,&rdquo; June&nbsp;1999.</span><span>)</span></a> or  Server-based Certificate Validation Protocol (SCVP) <a class='info' href='#RFC5055'>[RFC5055]<span> (</span><span class='info'>Freeman, T., Housley, R., Malpani, A., Cooper, D., and W. Polk, &ldquo;Server-Based Certificate Validation Protocol (SCVP),&rdquo; December&nbsp;2007.</span><span>)</span></a> to obtain the revocation status of the EAP server certificate.
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.2"></a><h3>4.5.2.&nbsp;
Internationalization</h3>

<p>The password authentication exchange MUST support user names and passwords in international languages. It MUST support encoding of user name and password strings in UTF-8 <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a> format.  Any strings sent by the server during the password exchange and intended for display to the user MUST be sent in UTF-8 format and SHOULD be able to be marked with language information and adapted to the user's language preference.
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.3"></a><h3>4.5.3.&nbsp;
Meta-data</h3>

<p>The password authentication exchange MUST support additional associated meta-data which can be used to indicate whether the authentication is for a user or a machine. This allows the EAP server and peer to request and negotiate authentication  specifically for a user or machine. This is useful in the case of multiple inner authentications where the user and machine both need to be authenticated.

</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.4"></a><h3>4.5.4.&nbsp;
Password Change</h3>

<p>The password authentication exchange MUST support password change, as well as other multiple round trips exchanges like new pin mode and next token mode for OTP database.
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Requirements Associated with Carrying EAP Methods</h3>

<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.1"></a><h3>4.6.1.&nbsp;
Method Negotiation</h3>

<p> The tunnel method MUST support the protected negotiation of the inner EAP method. It MUST NOT allow the inner EAP method negotiation to be downgraded or manipulated by intermediaries.
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.2"></a><h3>4.6.2.&nbsp;
Chained Methods</h3>

<p>The tunnel method MUST support the chaining of multiple EAP methods.  The tunnel method MUST allow for the communication of intermediate result and verification of compound binding between executed inner methods when chained methods are employed.
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.3"></a><h3>4.6.3.&nbsp;
Cryptographic Binding with TLS Tunnel</h3>

<p>The tunnel method MUST provide a mechanism to bind the tunnel protocol and 
the inner EAP method. This property is referred to as cryptographic binding. 
Without such bindings attacks are feasible on tunnel 
methods <a class='info' href='#TUNNEL-MITM'>[TUNNEL&#8209;MITM]<span> (</span><span class='info'>Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunnelled Authentication Protocols,&rdquo; November&nbsp;2002.</span><span>)</span></a> and chained methods. 
</p>
<p>Cryptographic bindings are typically achieved by securely mixing the
   established keying material (say tunnel key TK) from the tunnel
   protocol with the established keying material (say method key MK)
   from the inner authentication method(s) in order to derive fresh keying
   material.  If chained EAP methods are executed in the tunnel, all derived inner keys are combined to one method key MK.
   The keying material derived from mixing tunnel and method keys is also referred to as compound
   key CTK.  In particular, CTK is used to derive MSK, EMSK and other
   transient keys TEK, such as transient encryption keys and integrity
   protection keys.  The key hierarchy for tunnel methods executions that derive compound keys for the purpose of cryptographic binding is depicted in
   Figure 1.
</p><br /><hr class="insert" />
<a name="compoundkeys"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                            -----------
                            | TK | MK |
                            -----------
                               |   |
                               v   v
                             --------
                             | CTK  |
                             --------
                                 |
                                 v
                          ----------------
                          |      |       |
                          v      v       v
                      -------  ------  -------
                      | TEK | | MSK | | EMSK |
                      ------- ------- --------
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Compound Keys&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
For every key deriving inner EAP method that completes successfully within the tunnel cryptographic binding MUST be performed similar to the following:<br />
<br />


</p>
<ul class="text">
<li>compute a compound key CTK using the keying material from tunnel
      protocol and all tunneled inner authentication method(s) as inputs <br />
<br />

</li>
<li>use compound key CTK to derive transient keys for use in a
      cryptographic protocol that verifies the integrity of the tunnel
      and the inner authentication method.
</li>
</ul>
<p>Furthermore, the compound key  CTK and all keys derived from it
SHOULD be derived in accordance to the guidelines for key derivations and key 
hierarchies as specified in <a class='info' href='#keyest'>Section&nbsp;4.2.1.1.3<span> (</span><span class='info'>Tunnel Authentication and Key Establishment</span><span>)</span></a>. In particular, all derived keys 
MUST have a lifetime assigned that does not exceed the lifetime of any key 
higher in the key hierarchy, and MUST prevent domino effects.
</p>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.4"></a><h3>4.6.4.&nbsp;
Peer Initiated</h3>

<p>The tunnel method SHOULD allow for the peer to initiate an inner EAP authentication in order to meet its policy requirements for authenticating the server. 
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6.5"></a><h3>4.6.5.&nbsp;
Method Meta-data</h3>

<p>The tunnel method MUST allow for the communication of additional data associated with an EAP method. This can be used to indicate whether the authentication is for a user or a machine. This allows the EAP server and peer to request and negotiate authentication  specifically for a user or machine. This is useful in the case of multiple inner EAP authentications where the user and machine both need to be authenticated. 
</p>
<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>This document has no IANA considerations.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>A tunnel method is often deployed to provide mutual authentication between EAP Peer and EAP Server and to generate strong key material for use in protecting lower layer protocols.  In addition the tunnel is used to protect the communication of additional data, including peer identity between the EAP Peer and EAP Server from disclosure to or modification by an attacker.  These sections cover considerations that affect the ability for a method to achieve these goals.  

</p>
<a name="secciph"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Ciphersuite Selection</h3>

<p>TLS supports a wide variety of cipher suites providing a variety of
   security properties.  The selection of strong cipher suites is
   critical to the security of the tunnel method.  Selection of a cipher
   suite with weak or no authentication, such as an anonymous Diffie-
   Hellman based cipher suite will greatly increase the risk of system
   compromise.  Since a tunnel method uses the TLS tunnel to transport
   data, the selection of a ciphersuite with weak data encryption and
   integrity algorithms will also increase the vulnerability of the
   method to attacks. 
</p>
<p>A tunnel protocol is prone to downgrading attacks if the tunnel
   protocol supports any key establishment algorithm that can be broken
   on-line.  In a successful downgrading attack, an adversary breaks the
   selected "weak" key establishment algorithm and optionally the "weak"
   authentication algorithm without being detected.  Here, "weak" refers
   to a key establishment algorithm that can be broken in real-time, and
   an authentication scheme that can be broken off-line, respectively. See <a class='info' href='#KHLC07'>[KHLC07]<span> (</span><span class='info'>Hoeper, K. and L. Chen, &ldquo;Where EAP Security Claims Fail,&rdquo; August&nbsp;2007.</span><span>)</span></a> for more details.  The
   requirements in this document disapprove the use of key establishment
   algorithms that can be broken on-line. 
</p>
<p>Mutually anonymous tunnel protocols are prone to man-in-the-middle attacks described in <a class='info' href='#KHLC07'>[KHLC07]<span> (</span><span class='info'>Hoeper, K. and L. Chen, &ldquo;Where EAP Security Claims Fail,&rdquo; August&nbsp;2007.</span><span>)</span></a>.
   During such an attack, an adversary establishes a tunnel with each the peer and the
   authentication server, while peer and server believe that they established a tunnel with each other.  Once both tunnels have been
   established, the adversary can eavesdrop on all communications within
   the tunnels, i.e. the execution of the inner authentication method(s).
   Consequently, the adversary can eavesdrop on the identifiers that are
   exchanged as part of the EAP method and thus, the privacy of peer
   and/or authentication server is compromised along with any other data
   transmitted within the tunnels.

</p>
<a name="anchor50"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Tunneled Authentication</h3>

<p>In many cases a tunnel method provides mutual authentication by
   authenticating the server during tunnel establishment and
   authenticating the peer within the tunnel using an EAP method.  As
   described in <a class='info' href='#TUNNEL-MITM'>[TUNNEL&#8209;MITM]<span> (</span><span class='info'>Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunnelled Authentication Protocols,&rdquo; November&nbsp;2002.</span><span>)</span></a>, this mode of operation can allow a man-
   in-the-middle to authenticate to the server as the peer by tunneling
   the inner EAP protocol messages to and from a peer executing the
   method outside a tunnel or with an untrustworthy server.
   Cryptographic binding between the established keying material from the inner authentication
   method(s) and the tunnel protocol verifies that the endpoints of the tunnel
   and the inner authentication method(s) are the same. this can thwart the
   attack if the inner method derived keys of sufficient strength that
   they cannot be broken in real-time. 
</p>
<p>In cases where the inner authentication method does not generate any or
   only weak key material care must be taken to ensure that the peer
   does not execute the inner method with the same credentials outside
   a protective tunnel or with an untrustworthy server.

</p>
<a name="anchor51"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Outer EAP Method Header</h3>

<p>There are several existing EAP methods which use a similar packet format to EAP-TLS.  Often for the initial portions of the exchange the execution of the method is identical except for the method ID.  Protection of the outer EAP header helps to avoid vulnerabilities that may arise when an attacker attempts to modify packets to make one EAP message look like one from a different method.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.clancy-emu-chbind">[I-D.clancy-emu-chbind]</a></td>
<td class="author-text">Clancy, C. and K. Hoeper, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-clancy-emu-chbind-04.txt">Channel Binding Support for EAP Methods</a>,&rdquo; draft-clancy-emu-chbind-04 (work in progress), November&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-clancy-emu-chbind-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-eap-keying">[I-D.ietf-eap-keying]</a></td>
<td class="author-text">Aboba, B., Simon, D., and P. Eronen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-eap-keying-22.txt">Extensible Authentication Protocol (EAP) Key Management Framework</a>,&rdquo; draft-ietf-eap-keying-22 (work in progress), November&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-eap-keying-22.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tls-rfc4346-bis">[I-D.ietf-tls-rfc4346-bis]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4346-bis-10.txt">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; draft-ietf-tls-rfc4346-bis-10 (work in progress), March&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4346-bis-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2560">[RFC2560]</a></td>
<td class="author-text"><a href="mailto:mmyers@verisign.com">Myers, M.</a>, <a href="mailto:rankney@erols.com">Ankney, R.</a>, <a href="mailto:ambarish@valicert.com">Malpani, A.</a>, <a href="mailto:galperin@mycfo.com">Galperin, S.</a>, and <a href="mailto:cadams@entrust.com">C. Adams</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2560">X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</a>,&rdquo; RFC&nbsp;2560, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2560.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[RFC3748]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4017">[RFC4017]</a></td>
<td class="author-text">Stanley, D., Walker, J., and B. Aboba, &ldquo;<a href="http://tools.ietf.org/html/rfc4017">Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs</a>,&rdquo; RFC&nbsp;4017, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4017.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4962">[RFC4962]</a></td>
<td class="author-text">Housley, R. and B. Aboba, &ldquo;<a href="http://tools.ietf.org/html/rfc4962">Guidance for Authentication, Authorization, and Accounting (AAA) Key Management</a>,&rdquo; BCP&nbsp;132, RFC&nbsp;4962, July&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4962.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5055">[RFC5055]</a></td>
<td class="author-text">Freeman, T., Housley, R., Malpani, A., Cooper, D., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5055">Server-Based Certificate Validation Protocol (SCVP)</a>,&rdquo; RFC&nbsp;5055, December&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5055.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.funk-eap-ttls-v0">[I-D.funk-eap-ttls-v0]</a></td>
<td class="author-text">Funk, P. and S. Blake-Wilson, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-funk-eap-ttls-v0-05.txt">EAP Tunneled TLS Authentication Protocol Version 0 (EAP-TTLSv0)</a>,&rdquo; draft-funk-eap-ttls-v0-05 (work in progress), April&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-funk-eap-ttls-v0-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-nea-pb-tnc">[I-D.ietf-nea-pb-tnc]</a></td>
<td class="author-text">Sahita, R., Hanna, S., and K. Narayan, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-nea-pb-tnc-06.txt">PB-TNC: A Posture Broker Protocol (PB) Compatible with TNC</a>,&rdquo; draft-ietf-nea-pb-tnc-06 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-nea-pb-tnc-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-nea-requirements">[I-D.ietf-nea-requirements]</a></td>
<td class="author-text">Sangster, P., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-nea-requirements-07.txt">Network Endpoint Assessment (NEA): Overview and Requirements</a>,&rdquo; draft-ietf-nea-requirements-07 (work in progress), April&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-nea-requirements-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.mahy-eap-enrollment">[I-D.mahy-eap-enrollment]</a></td>
<td class="author-text">Mahy, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-mahy-eap-enrollment-01.txt">An Extensible Authentication Protocol (EAP) Enrollment Method</a>,&rdquo; draft-mahy-eap-enrollment-01 (work in progress), March&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-mahy-eap-enrollment-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="KHLC07">[KHLC07]</a></td>
<td class="author-text">Hoeper, K. and L. Chen, &ldquo;Where EAP Security Claims Fail,&rdquo; ICST QShine&nbsp;, August&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST SP 800-108">[NIST SP 800-108]</a></td>
<td class="author-text">Chen, L., &ldquo;Recommendation for Key Derivation Using Pseudorandom Functions,&rdquo; Draft NIST Special Publication&nbsp;800-108, April&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST SP 800-52">[NIST SP 800-52]</a></td>
<td class="author-text">Chernick, C., Edington III, C., Fanto, M., and R. Rosenthal, &ldquo;Guidelines for the Selection and Use of Transport Layer Security (TLS) Implementations,&rdquo; NIST Special Publication&nbsp;800-52, June&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST SP 800-57">[NIST SP 800-57]</a></td>
<td class="author-text">Barker, E., Barker, W., Burr, W., Polk, W., and M. Smid, &ldquo;Recommendation for Key Management - Part 1: General (Revised),&rdquo; NIST Special Publication&nbsp;800-57, March&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2246">[RFC2246]</a></td>
<td class="author-text"><a href="mailto:tdierks@certicom.com">Dierks, T.</a> and <a href="mailto:callen@certicom.com">C. Allen</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>,&rdquo; RFC&nbsp;2246, January&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4282">[RFC4282]</a></td>
<td class="author-text">Aboba, B., Beadles, M., Arkko, J., and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc4282">The Network Access Identifier</a>,&rdquo; RFC&nbsp;4282, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4282.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4346">[RFC4346]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc4346">The Transport Layer Security (TLS) Protocol Version 1.1</a>,&rdquo; RFC&nbsp;4346, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4346.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4851">[RFC4851]</a></td>
<td class="author-text">Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;<a href="http://tools.ietf.org/html/rfc4851">The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)</a>,&rdquo; RFC&nbsp;4851, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4851.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5077">[RFC5077]</a></td>
<td class="author-text">Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc5077">Transport Layer Security (TLS) Session Resumption without Server-Side State</a>,&rdquo; RFC&nbsp;5077, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5077.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TUNNEL-MITM">[TUNNEL-MITM]</a></td>
<td class="author-text">Asokan, N., Niemi, V., and K. Nyberg, &ldquo;Man-in-the-Middle in Tunnelled Authentication Protocols,&rdquo; Cryptology ePrint Archive: &nbsp;Report 2002/163, November&nbsp;2002.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Katrin Hoeper</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NIST</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">100 Bureau Drive, MS: 8930</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gaithersburg, MD  20899</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:khoeper@nist.gov">khoeper@nist.gov</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stephen Hanna</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juniper Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3 Beverly Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bedford, MA  01730</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:shanna@juniper.net">shanna@juniper.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hao Zhou</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">4125 Highlander Parkway</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Richfield, OH  44286</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hzhou@cisco.com">hzhou@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Joseph Salowey (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2901 3rd. Ave</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, WA  98121</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jsalowey@cisco.com">jsalowey@cisco.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
