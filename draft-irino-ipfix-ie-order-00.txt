


Network Working Group                                           H. Irino
Internet-Draft                                               NTT NS Lab.
Intended status: Informational                          October 16, 2006
Expires: April 19, 2007


                     Order of Information Elements
                   draft-irino-ipfix-ie-order-00.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on April 19, 2007.

Copyright Notice

   Copyright (C) The Internet Society (2006).














Irino                    Expires April 19, 2007                 [Page 1]

Internet-Draft        Order of Information Elements         October 2006


Abstract

   This document describes about guideline of order of Information
   Elements of IPFIX protocol to create templates for exporters.  This
   document aims at definition rules to generate same template from same
   selected Information Elements independently of difference of
   implementation.  And then it can be expected for simple template
   management of collecting process and increasing speed or decreasing
   load of decoding of Information Elements.










































Irino                    Expires April 19, 2007                 [Page 2]

Internet-Draft        Order of Information Elements         October 2006


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  5
     1.1.  Purposes of this draft . . . . . . . . . . . . . . . . . .  5
     1.2.  Targets of this draft  . . . . . . . . . . . . . . . . . .  5
     1.3.  Contents of this draft . . . . . . . . . . . . . . . . . .  6
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  7
   3.  Approach to order Information Elements . . . . . . . . . . . .  8
     3.1.  Scope  . . . . . . . . . . . . . . . . . . . . . . . . . .  8
     3.2.  The order of Information Elements based on their data
           size.  . . . . . . . . . . . . . . . . . . . . . . . . . .  9
       3.2.1.  Separation of position of types of Information
               Elements classified by size  . . . . . . . . . . . . .  9
       3.2.2.  Data alignment . . . . . . . . . . . . . . . . . . . . 13
     3.3.  Order of Information Elements groups between these
           groups . . . . . . . . . . . . . . . . . . . . . . . . . . 15
       3.3.1.  Flow keys  . . . . . . . . . . . . . . . . . . . . . . 15
       3.3.2.  Padding  . . . . . . . . . . . . . . . . . . . . . . . 16
       3.3.3.  Information Elements belonging to other groups . . . . 16
     3.4.  Order of Information Elements in a group . . . . . . . . . 16
       3.4.1.  Rules for ordering Information Elements in Group
               9. Flow Time Stamp . . . . . . . . . . . . . . . . . . 17
       3.4.2.  Rules for ordering Information Elements in a group
               for flow keys  . . . . . . . . . . . . . . . . . . . . 18
   4.  Recommended order for Information Elements . . . . . . . . . . 20
     4.1.  When a field count is 64 or less . . . . . . . . . . . . . 20
     4.2.  When a field count is more than 64 . . . . . . . . . . . . 22
     4.3.  Order of Information Elements according to data size
           in each group  . . . . . . . . . . . . . . . . . . . . . . 25
       4.3.1.  Group 1. Identification  . . . . . . . . . . . . . . . 25
       4.3.2.  Group 2. Metering and Exporting Process
               Configuration  . . . . . . . . . . . . . . . . . . . . 26
       4.3.3.  Group 3. Metering and Exporting Process Statistics . . 27
       4.3.4.  Group 4. IP Header Fields  . . . . . . . . . . . . . . 27
       4.3.5.  Group 5. Transport Header Fields . . . . . . . . . . . 29
       4.3.6.  Group 6. Sub-IP Header Fields  . . . . . . . . . . . . 30
       4.3.7.  Group 7. Derived Packet Properties . . . . . . . . . . 31
       4.3.8.  Group 8. Derived Packet Properties . . . . . . . . . . 32
       4.3.9.  Group 9. Flow Time Stamps  . . . . . . . . . . . . . . 33
       4.3.10. Group 10. Per-Flow Counters  . . . . . . . . . . . . . 33
       4.3.11. Group 11. Miscellaneous Flow Properties  . . . . . . . 34
   5.  Special case . . . . . . . . . . . . . . . . . . . . . . . . . 36
     5.1.  Enterprise Specific Information Elements for forward
           flow . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
     5.2.  Enterprise Specific Information Elements for reverse
           flow in Biflow . . . . . . . . . . . . . . . . . . . . . . 36
     5.3.  Information Element is required more than once in
           Template . . . . . . . . . . . . . . . . . . . . . . . . . 36



Irino                    Expires April 19, 2007                 [Page 3]

Internet-Draft        Order of Information Elements         October 2006


   6.  Security Considerations  . . . . . . . . . . . . . . . . . . . 37
   7.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 38
   8.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 39
   Appendix A.  A template composed with Information Elements
                equivalent of NetFlow Version 5 record  . . . . . . . 40
   Author's Address . . . . . . . . . . . . . . . . . . . . . . . . . 42
   Intellectual Property and Copyright Statements . . . . . . . . . . 43












































Irino                    Expires April 19, 2007                 [Page 4]

Internet-Draft        Order of Information Elements         October 2006


1.  Introduction

1.1.  Purposes of this draft

   The IPFIX protocol defines how IP Flow information can be exported
   from routers, measurement probes or other devices.  The template set
   is structured with template records, and a template record is
   structured with a combination of Information Elements.

   According to section 3.4.1 in [IPFIX-INFO], templates greatly enhance
   the flexibility of the record format because they allow the
   Collecting Process to process IPFIX Messages without necessarily
   knowing the interpretation of all Data Records.

   However, IPFIX collectors must store and manage a template set at
   each exporter; therefore, when a collector receives more templates
   from exporters, the collector must store more templates.

   If rules of order of an Information Element array are defined, any
   exporter can create the same or almost the same template as that
   structured with a set of the same selected Information Elements.
   (However, an exporter cannot create a template that is completely the
   same as that containing variable length Information Elements and/or
   "Reduced Size Encoding" applicable Information Elements.)  Thus,
   collecting processes can conserve memory resources for storing
   templates by storing common parts of several templates in a single
   common format.  In addition, the collecting process can decode
   Information Elements in an orderly manner. (e.g., automaton
   processing)

   This draft describes a guideline about a rule of order of Information
   Elements for creating templates in the exporting process.  The
   purposes of this draft are as follows:

   o  To conserve memory resources for storing templates in collecting
      process

   o  To achieve decoding Information Elements in an orderly manner in
      the collecting process.

1.2.  Targets of this draft

   Implementation of (IPFIX/NetFlow v9) exporters at present is
   classified into some kinds; examples are as follows:







Irino                    Expires April 19, 2007                 [Page 5]

Internet-Draft        Order of Information Elements         October 2006


   Fully Configurable:  can select Information Elements, can configure
      data size of these Information Elements, and can decide order of
      these Information Elements freely. (e.g., software-based
      implementations such as ntop)

   Partially Configurable:  can select Information Elements partially,
      but cannot configure data size of Information Elements, and cannot
      decide order of these Information Elements freely. (e.g., Flexible
      NetFlow implementation)

   Hard Coded:  can select preset templates, but cannot configure
      Information Elements in the templates. (e.g., some router vendors'
      NetFlow v9 implementation.)

   Exporters cannot create templates that are exactly the same if the
   template contains variable length Information Elements and/or
   "Reduced Sized Encoded" Information Elements.

   Therefore, the target of this draft is hard-coded implementation or
   partially configurable implementation.  This draft SHOULD be referred
   to for these implementations, or be referred to for configuration of
   a fully configurable implementation, but for special requirements.
   Implementations or configurations written above achieve the above
   mentioned purposes.

1.3.  Contents of this draft

   Terminology is described in Section 2.

   An Approach to order Information Elements is described in Section 3.
   An order of Information Elements recommended by this draft in
   described in Section 4.  If you want to know an argument of this
   draft, it is better to read Section 4 at first.  Section 3 explains
   reasons why the order described in Section 4 is recommended in this
   draft.

   Security Considerations is described in Section 6.














Irino                    Expires April 19, 2007                 [Page 6]

Internet-Draft        Order of Information Elements         October 2006


2.  Terminology

   The terminology used in this document is aligned with the terminology
   defined in [IPFIX-PROTO] and [IPFIX-INFO].

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].











































Irino                    Expires April 19, 2007                 [Page 7]

Internet-Draft        Order of Information Elements         October 2006


3.  Approach to order Information Elements

   This draft defines three orders for ordering Information Elements.

   1.  The order of Information Elements based on their data size.

   2.  The order of Information Element groups among these groups.

   3.  The order of Information Elements in a group.

3.1.  Scope

   Information Elements that use scope in option templates are
   exceptions to the order suggested in this draft.  Information
   Elements that use scopes MUST be placed at the "top" of the option
   template. "top" means after the Option Template Record Header Format.
   According to [IPFIX-PROTO], the Scope Field Count MUST NOT be zero.
   Information Elements used as scopes belong to Group 1 or Group 2.
   The order of scopes is important, because each combination of the
   scopes has a different meaning.  For example, if the first scope
   defines the filtering function, while the second scope defines the
   sampling function, that means applying the sampling function first,
   followed by the filtering function.  (According to [IPFIX-PROTO]
   section 3.4.2.1) This is a different meaning from the combination in
   which sampling occurs first and filtering second.  Therefore,
   Information Elements used as scopes are not ordered with respect to
   rules of order in this draft.

   o  lineCardId(141, Group 1.  Identifiers)

   o  portId(142, Group 1.  Identifiers)

   o  ingressInterface(10, Group 1.  Identifiers)

   o  meteringProcessId(143, Group 1.  Identifiers)

   o  exportingProcessId(144, Group 1.  Identifiers)

   o  templateId(145, Group 1.  Identifiers)

   o  observationPointId(138, Group 1.  Identifiers)

   o  commonPropertiesId(137, Group 1.  Identifiers)

   o  exporterIPv4Address (130, Group 2.  Metering and Exporting Process
      Configuration)





Irino                    Expires April 19, 2007                 [Page 8]

Internet-Draft        Order of Information Elements         October 2006


   o  exporterIPv6Address (131, Group 2.  Metering and Exporting Process
      Configuration)

3.2.  The order of Information Elements based on their data size.

   Purposes for defining the order of Information Elements based on
   their data size are as follows:

   o  Increase speed of decoding of partial Information Elements or
      decrease load of decoding by structuring templates with three
      types of Information Elements.  Three types are "Reduced Size
      Encoding" inapplicable Information Elements, "Reduced Size
      Encoding" applicable Information Elements, and variable length
      Information Elements.

   o  Decrease padding for alignment.

3.2.1.  Separation of position of types of Information Elements
        classified by size

   Information Elements can be classified by size into three types.
   Three types are "Reduced Size Encoding" inapplicable Information
   Elements, "Reduced Size Encoding" applicable Information Elements,
   and variable length Information Elements.  The sizes of "Reduced Size
   Encoding" inapplicable Information Elements are steady and fixed in
   any templates.  The sizes of "Reduced Size Encoding" applicable
   Information Elements are unsteady, because they have possibility that
   their size are reduced.  Variable length Information Elements have
   possibility that their length are different each data record.
   Therefore, variable length Information Elements have possibility that
   they affect positions of other Information Elements and data
   alignment in each data record.

   The positions in the template of these sets SHOULD be separated.
   This separation can produce simplified decoding for partial
   Information Elements that have a steady size.  Simplified decoding
   can be expected to increase speed or decrease load of collecting
   process.  And this separation aims to minimize bad effect of variable
   length Information Elements.

   "Reduced Size Encoding" inapplicable Information Elements have always
   steady data size in any template.  Therefore, they SHOULD be
   positioned at earlier position than other types in a template.
   Variable length Information Elements have possibility that their
   length are different each data record, and variable length
   Information Elements have possibility that they affect positions of
   other Information Elements and data alignment in each data record.
   Therefore they SHOULD be positioned at later position than other



Irino                    Expires April 19, 2007                 [Page 9]

Internet-Draft        Order of Information Elements         October 2006


   types in a template to minimize bad effect of variable length
   Information Elements for positions and data alignments.  Consequently
   "Reduced Size Encoding" applicable Information Elements SHOULD be
   positioned between "Reduced Size Encoding" inapplicable Information
   Elements and variable length Information Elements.

   This draft defines the order of Information Elements groups between
   these groups in the following section.  There are supposed to be two
   types of separation methods for "Reduced Size Encoding" inapplicable,
   "Reduced Size Encoding" applicable and variable length Information
   Elements depending on the relationship between group order and
   ordering by size.

   1.  Separation of "Reduced Size Encoding" inapplicable, "Reduced Size
       Encoding" applicable Information Elements and variable length
       Information Elements in a group.

   2.  Separation of "Reduced Size Encoding" inapplicable Information
       Elements of all groups, "Reduced Size Encoding" applicable
       Information Elements of all groups and variable length
       Information Elements of all groups, and applying group order to
       each set of Information Elements after the above method.





























Irino                    Expires April 19, 2007                [Page 10]

Internet-Draft        Order of Information Elements         October 2006


   +-------------------------------------------------------+
   | Group A                                               |
   | +---------------------------------------------------+ |
   | |"Reduced Size Encoding" inapplicable IEs           | |
   | +---------------------------------------------------+ |
   | +---------------------------------------------------+ |
   | |"Reduced Size Encoding" applicable IEs             | |
   | +---------------------------------------------------+ |
   | +---------------------------------------------------+ |
   | |variable length IEs                                | |
   | +---------------------------------------------------+ |
   +-------------------------------------------------------+
   | Group B                                               |
   | +---------------------------------------------------+ |
   | |"Reduced Size Encoding" inapplicable IEs           | |
   | +---------------------------------------------------+ |
   | +---------------------------------------------------+ |
   | |"Reduced Size Encoding" applicable IEs             | |
   | +---------------------------------------------------+ |
   | +---------------------------------------------------+ |
   | |variable length IEs                                | |
   | +---------------------------------------------------+ |
   +-------------------------------------------------------+
   |                          :                            |
   |                          :                            |

         Figure 1: Separation of Information Elements in a group.
























Irino                    Expires April 19, 2007                [Page 11]

Internet-Draft        Order of Information Elements         October 2006


   +-------------------------------------------------------+
   | Array of "Reduced Size Encoding" inapplicable IEs     |
   | +---------------------------------------------------+ |
   | |"Reduced Size Encoding" inapplicable IEs of Group A| |
   | +---------------------------------------------------+ |
   | +---------------------------------------------------+ |
   | |"Reduced Size Encoding" inapplicable IEs of Group B| |
   | +---------------------------------------------------+ |
   |                          :                            |
   |                          :                            |
   +-------------------------------------------------------+
   | Array of "Reduced Size Encoding" applicable IEs       |
   | +---------------------------------------------------+ |
   | |"Reduced Size Encoding" applicable IEs of Group A  | |
   | +---------------------------------------------------+ |
   | +---------------------------------------------------+ |
   | |"Reduced Size Encoding" applicable IEs of Group B  | |
   | +---------------------------------------------------+ |
   |                          :                            |
   |                          :                            |
   +-------------------------------------------------------+
   | Array of variable length IEs                          |
   | +---------------------------------------------------+ |
   | |variable length IEs of Group A                     | |
   | +---------------------------------------------------+ |
   | +---------------------------------------------------+ |
   | |variable length IEs of Group B                     | |
   | +---------------------------------------------------+ |
   |                          :                            |
   |                          :                            |
   +-------------------------------------------------------+

        Figure 2: Separation of Information Elements of all groups

   The former is simple, but that method is limited in producing
   efficient decoding because "Reduced Size Encoding" inapplicable
   Information Elements are distributed to several positions in a
   template.  The latter is more efficient than the above method because
   this method concentrates on "Reduced Size Encoding" inapplicable
   Information Elements.  However, the method has a problem.
   Information Elements used as flow keys MUST be positioned in the
   first 64 Information Elements.  There is a possibility that "Reduced
   Size Encoding" applicable Information Elements of group 4.-7 will not
   be positioned in the first 64 Information Elements.

   For the above reason, Separation of Information Elements of all
   groups SHOULD be used when a field count in a template record header
   is 64 or less.  When the field count in a template record header is



Irino                    Expires April 19, 2007                [Page 12]

Internet-Draft        Order of Information Elements         October 2006


   more than 64, Information Elements used as flow keys concentrate at
   the top of templates.  At first, "Reduced Size Encoding" inapplicable
   Information Elements belonging to Group 4.-7. are positioned from the
   top.  Second, "Reduced Size Encoding" applicable Information Elements
   belonging to Group 4.-7. are positioned next to "Reduced Size
   Encoding" inapplicable Information Elements.  Third, "Reduced Size
   Encoding" inapplicable Information Elements belonging to other groups
   are positioned.  Fourth, "Reduced Size Encoding" applicable
   Information Elements belonging to other groups are positioned.

3.2.2.  Data alignment

   Information Elements have various sizes.  Therefore, data alignment
   causes a problem with data records.  A Padding Information Element is
   used for adjusting these data alignments.  Padding Information
   Elements can be used flexibly.  However, padding SHOULD be reduced as
   much as possible from the viewpoint of efficiency because padding has
   no information about flow.  Therefore, Information Elements whose
   sizes are multiples of four octets SHOULD be positioned with the same
   data sizes to adjust the data alignment.  The information elements
   whose data sizes are an even number (and not a multiple of four
   octets) can adjust the data alignment of four octets by collecting
   two octets.  The information elements whose data sizes are an odd
   number (and not a multiple of four octets) can adjust the data
   alignment of four octets by collecting four or two octets.  For the
   reason mentioned above, in this draft, each class of Information
   Element SHOULD be classified and positioned according to their data
   sizes as follows: multiple of four octets, even number of octets, and
   odd number of octets.

   The following lists describe classified Information Elements.
   Information Elements are classified as a multiple of four octets in
   "Reduced Size Encoding" inapplicable Information Elements, even
   number of octets in "Reduced Size Encoding" inapplicable Information
   Elements, odd number of octets in "Reduced Size Encoding"
   inapplicable Information Elements, "Reduced Size Encoding" applicable
   Information Elements to which "Reduced Size Encoding" is applied),
   and variable length Information Elements.

   o  steady sized Information Elements

      *  multiple of four octets in "Reduced Size Encoding" inapplicable
         Information Elements

         +  ipv6Address (16 octet, 128 bit)

         +  dateTimeMilliseconds (8 octet, 64 bit)




Irino                    Expires April 19, 2007                [Page 13]

Internet-Draft        Order of Information Elements         October 2006


         +  dateTimeMicroseconds (8 octet, 64 bit)

         +  dateTimeNanoseconds (8 octet, 64 bit)

         +  dateTimeSeconds (4 octet, 32 bit)

         +  ipv4Address (4 octet, 32 bit)

      *  even number of octets in "Reduced Size Encoding" inapplicable
         Information Elements

         +  macAddress (6 octet, 48 bit)

      *  odd number of octets in "Reduced Size Encoding" inapplicable
         Information Elements

         +  unsigned8 (1 octet, 8 bit)

         +  signed8 (1 octet, 8 bit)

         +  boolean (1 octet, 8 bit)

   o  "Reduced Size Encoding" applicable Information Elements

      *  unsigned64 (8 octet, 64 bit)

      *  signed64 (8 octet, 64 bit)

      *  float64 (8 octet, 64 bit)

      *  unsigned32 (4 octet, 32 bit)

      *  signed32 (4 octet, 32 bit)

      *  float32 (4 octet, 32 bit)

      *  unsigned16 (2 octet, 16 bit)

      *  signed16 (2 octet, 16 bit)

   o  variable length Information Elements

      *  octetArray

      *  string

   "Reduced Size Encoding" MUST NOT be applied to the following
   Information Elements because their size is sufficient to carry any



Irino                    Expires April 19, 2007                [Page 14]

Internet-Draft        Order of Information Elements         October 2006


   value the Exporter may need to deliver.

   o  templateId (Group 1)

   o  exporterTransportPort (Group 2)

   o  collectorTransportPort (Group 2)

   o  fragmentOffset (Group 4)

   o  totalLengthIPv4 (Group 4)

   o  icmpTypeCodeIPv4 (Group 5)

   o  sourceTransportPort (Group 5)

   o  destinationTransportPort (Group 5)

   o  udpSourcePort (Group 5)

   o  udpDestinationPort (Group 5)

   o  tcpSourcePort (Group 5)

   o  tcpSequenceNumber (Group 5)

   o  tcpAcknowledgementNumber (Group 5)

   o  tcpWindowSize (Group 5)

   o  tcpUrgentPointer (Group 5)

   o  tcpHeaderLength (Group 5)

   o  udpMassageLength (Group 5)

   o  vlanId (Group 6)

   o  postVlanId (Group 6)

   o  ipv4Options (Group 8)

3.3.  Order of Information Elements groups between these groups

3.3.1.  Flow keys

   Information Elements belonging to group 4.-7. can be used as flow
   keys.  The Information Elements that are derived from fields of



Irino                    Expires April 19, 2007                [Page 15]

Internet-Draft        Order of Information Elements         October 2006


   packets or from packet treatment, such as the Information Elements in
   group 4.-7., can serve as Flow Keys used for mapping packets to
   Flows.  (According to [IPFIX-INFO]) flowKeyIndicator is an unsigned64
   Information Element.  Therefore, Information Elements used as flow
   keys are positioned in the first 64 Information Elements.  When a
   template field count is more than 64, Information Elements belonging
   to group 4.-7.  SHOULD have a priority to be positioned at the top of
   a template over other groups.  In this draft, the recommended order
   of these groups is the following group numbers, which are defined in
   [IPFIX-INFO].  That means these groups are positioned in order of 4,
   5, 6, and 7.  Information Elements belonging to these groups are used
   in the template and option template, for example, these are used for
   [IPFIX-RED].

3.3.2.  Padding

   paddingOctets Information Element belonging padding group is an
   exception of rule suggested in this draft.  It can be positioned
   freely to set starts of subsequent Information Elements at an aligned
   boundary.  This draft recommends that paddingOctets are positioned at
   between "Reduce Size Encoding" inapplicable Information Elements and
   "Reduce Size Encoding" applicable Information Elements, between
   "Reduce Size Encoding" applicable Information Elements and variable
   length Information Elements, and end of a template, if it is needed
   to adjust data alignment boundary.

3.3.3.  Information Elements belonging to other groups

   There is no priority to order groups except groups for scopes and
   flow keys.  This draft recommends an order of the groups that are not
   scopes and not flow keys, which are the sequence of the following
   group numbers defined in [IPFIX-INFO].  However, the groups whose
   Information Elements' Data Type are only total/delta Counter are
   excepted.

3.3.3.1.  Counter

   All Information Elements belonging to Group 3 and Group 10 are of the
   Counter Data Type, and "Reduced Size Encoding" can be applied to
   these Information Elements.  Therefore, these groups are positioned
   at the end of position for "Reduced Size Encoding" applicable
   Information Elements, in other words these groups are positioned just
   before positions for valiable length Information Elements.

3.4.  Order of Information Elements in a group

   This draft defines some rules for positioning Information Elements in
   a group.



Irino                    Expires April 19, 2007                [Page 16]

Internet-Draft        Order of Information Elements         October 2006


3.4.1.  Rules for ordering Information Elements in Group 9. Flow Time
        Stamp

   o  A number of Information Elements whose prefix is "flowStart" and a
      number of Information Elements whose prefix is "flowEnd" MUST be
      the same in a template.  Otherwise, information about the flow is
      imperfect.

   o  Exporters SHOULD use Information Elements with the same data type
      whose prefix is "flowStart" and Information Elements whose prefix
      is "flowEnd".

   o  Information Elements whose prefix is "flowStart" SHOULD be earlier
      in the sequence than Information Elements whose prefix is
      flowEnd", and they SHOULD be adjacent.

   o  Information Elements whose prefix is "flowStart":

      *  150: flowStartSeconds

      *  152: flowStartMilliseconds

      *  154: flowStartMicroseconds

      *  156: flowStartNanoseconds

      *  158: flowStartDeltaMicroseconds

      *  22: flowStartSysUptime

   o  Information Elements whose prefix is "flowEnd":

      *  151: flowEndSeconds

      *  153: flowEndMilliseconds

      *  155: flowEndMicroseconds

      *  157: flowEndNanoseconds

      *  159: flowEndDeltaMicroseconds

      *  21: flowEndSysUptime








Irino                    Expires April 19, 2007                [Page 17]

Internet-Draft        Order of Information Elements         October 2006


3.4.2.  Rules for ordering Information Elements in a group for flow keys

   1.  A template SHOULD not contain "udpSourcePort" or "tcpSourcePort"
       when the template contains "sourceTransportPort".  A template
       SHOULD not contain "udpDestinationPort" or "tcpDestinationPort"
       when the template also contains sourceTransportPort.

   2.  When a template contains both Information Elements which are an
       Information Element whose names include "source" and
       corresponding Information Elements whose names include
       "destination", Information Elements whose names include "source"
       SHOULD be earlier in the sequence than Information Elements whose
       names include "destination", and they SHOULD be adjacent.

   o  Information Elements whose names include "source"

      *  8: sourceIPv4Address

      *  27: sourceIPv6Address

      *  9: sourceIPv4PrefixLength

      *  29: sourceIPv6PrefixLength

      *  44: sourceIPv4Prefix

      *  170: sourceIPv6Prefix

      *  7: sourceTransportPort

      *  180: udpSourcePort

      *  182: tcpSourcePort

      *  56: sourceMacAddress

      *  81: postSourceMacAddress

      *  16: bgpSourceAsNumber

   o  Information Elements whose names include "destination"

      *  12: destinationIPv4Address

      *  28: destinationIPv6Address

      *  13: destinationIPv4PrefixLength




Irino                    Expires April 19, 2007                [Page 18]

Internet-Draft        Order of Information Elements         October 2006


      *  30: destinationIPv6PrefixLength

      *  45: destinationIPv4Prefix

      *  169: destinationIPv6Prefix

      *  11: destinationTransportPort

      *  181: udpDestinationPort

      *  183: tcpDestinationPort

      *  80: sourceMacAddress

      *  57: postSourceMacAddress

      *  17: bgpDestinationAsNumber


































Irino                    Expires April 19, 2007                [Page 19]

Internet-Draft        Order of Information Elements         October 2006


4.  Recommended order for Information Elements

   The order of Information Elements (except paddingOctets Infromation
   Element) recommended in this draft according to the above mentioned
   rules are as follows:

4.1.  When a field count is 64 or less

   1.  Scope (only for option template)

       *  Group 1.  Identification

       *  Group 2.  Metering Process Configuration

   2.  Multiple of four octets in "Reduced Size Encoding" inapplicable
       Information Elements

       1.  Group 1.  Identification

       2.  Group 2.  Metering Process Configuration (only for option
           template)

       3.  Group 4.  IP Header Fields

       4.  Group 5.  Transport Header Fields

       5.  Group 6.  Sub-IP Header Fields

       6.  Group 7.  Derived Packet Properties

       7.  Group 8.  Min/Max Flow Properties

       8.  Group 9.  Flow Time Stamp

       9.  Group 11.  Miscellaneous Flow Properties

   3.  Even number of octets in "Reduced Size Encoding" inapplicable
       Information Elements

       1.  Group 1.  Identification

       2.  Group 2.  Metering Process Configuration (only for option
           template)

       3.  Group 4.  IP Header Fields

       4.  Group 5.  Transport Header Fields




Irino                    Expires April 19, 2007                [Page 20]

Internet-Draft        Order of Information Elements         October 2006


       5.  Group 6.  Sub-IP Header Fields

       6.  Group 7.  Derived Packet Properties

       7.  Group 8.  Min/Max Flow Properties

       8.  Group 9.  Flow Time Stamp

       9.  Group 11.  Miscellaneous Flow Properties

   4.  Odd number of octets in "Reduced Size Encoding" inapplicable
       Information Elements

       1.  Group 1.  Identification

       2.  Group 2.  Metering Process Configuration (only for option
           template)

       3.  Group 4.  IP Header Fields

       4.  Group 5.  Transport Header Fields

       5.  Group 6.  Sub-IP Header Fields

       6.  Group 7.  Derived Packet Properties

       7.  Group 8.  Min/Max Flow Properties

       8.  Group 9.  Flow Time Stamp

       9.  Group 11.  Miscellaneous Flow Properties

   5.  "Reduced Size Encoding" applicable Information Elements

       1.   Group 1.  Identification

       2.   Group 2.  Metering Process Configuration (only for option
            template)

       3.   Group 4.  IP Header Fields

       4.   Group 5.  Transport Header Fields

       5.   Group 6.  Sub-IP Header Fields

       6.   Group 7.  Derived Packet Properties





Irino                    Expires April 19, 2007                [Page 21]

Internet-Draft        Order of Information Elements         October 2006


       7.   Group 8.  Min/Max Flow Properties

       8.   Group 9.  Flow Time Stamp

       9.   Group 11.  Miscellaneous Flow Properties

       10.  Group 3.  Metering Process Statistics (only for option
            template)

       11.  Group 10.  Per-Flow Counters

   6.  variable length Information Elements

       1.   Group 1.  Identification

       2.   Group 2.  Metering Process Configuration (only for option
            template)

       3.   Group 4.  IP Header Fields

       4.   Group 5.  Transport Header Fields

       5.   Group 6.  Sub-IP Header Fields

       6.   Group 7.  Derived Packet Properties

       7.   Group 8.  Min/Max Flow Properties

       8.   Group 9.  Flow Time Stamp

       9.   Group 11.  Miscellaneous Flow Properties

       10.  Group 3.  Metering Process Statistics (only for option
            template)

       11.  Group 10.  Per-Flow Counters

4.2.  When a field count is more than 64

   1.   Scope (only for option template)

        *  Group 1.  Identification

        *  Group 2.  Metering Process Configuration

   2.   Multiple of four octets in "Reduced Size Encoding" inapplicable
        Information Elements




Irino                    Expires April 19, 2007                [Page 22]

Internet-Draft        Order of Information Elements         October 2006


        1.  Group 4.  IP Header Fields

        2.  Group 5.  Transport Header Fields

        3.  Group 6.  Sub-IP Header Fields

        4.  Group 7.  Derived Packet Properties

   3.   Even number of octets in "Reduced Size Encoding" inapplicable
        Information Elements

        1.  Group 4.  IP Header Fields

        2.  Group 5.  Transport Header Fields

        3.  Group 6.  Sub-IP Header Fields

        4.  Group 7.  Derived Packet Properties

   4.   Odd number of octets in "Reduced Size Encoding" inapplicable
        Information Elements

        1.  Group 4.  IP Header Fields

        2.  Group 5.  Transport Header Fields

        3.  Group 6.  Sub-IP Header Fields

        4.  Group 7.  Derived Packet Properties

   5.   "Reduced Size Encoding" applicable Information Elements

        1.  Group 4.  IP Header Fields

        2.  Group 5.  Transport Header Fields

        3.  Group 6.  Sub-IP Header Fields

        4.  Group 7.  Derived Packet Properties

   6.   variable length Information Elements

        1.  Group 4.  IP Header Fields

        2.  Group 5.  Transport Header Fields

        3.  Group 6.  Sub-IP Header Fields




Irino                    Expires April 19, 2007                [Page 23]

Internet-Draft        Order of Information Elements         October 2006


        4.  Group 7.  Derived Packet Properties

   7.   Multiple of four octets in "Reduced Size Encoding" inapplicable
        Information Elements

        1.  Group 1.  Identification

        2.  Group 2.  Metering Process Configuration (only for option
            template)

        3.  Group 8.  Min/Max Flow Properties

        4.  Group 9.  Flow Time Stamp

        5.  Group 11.  Miscellaneous Flow Properties

   8.   Even number of octets in "Reduced Size Encoding" inapplicable
        Information Elements

        1.  Group 1.  Identification

        2.  Group 2.  Metering Process Configuration (only for option
            template)

        3.  Group 8.  Min/Max Flow Properties

        4.  Group 9.  Flow Time Stamp

        5.  Group 11.  Miscellaneous Flow Properties

   9.   Odd number of octets in "Reduced Size Encoding" inapplicable
        Information Elements

        1.  Group 1.  Identification

        2.  Group 2.  Metering Process Configuration (only for option
            template)

        3.  Group 8.  Min/Max Flow Properties

        4.  Group 9.  Flow Time Stamp

        5.  Group 11.  Miscellaneous Flow Properties

   10.  "Reduced Size Encoding" applicable Information Elements

        1.  Group 1.  Identification




Irino                    Expires April 19, 2007                [Page 24]

Internet-Draft        Order of Information Elements         October 2006


        2.  Group 2.  Metering Process Configuration (only for option
            template)

        3.  Group 8.  Min/Max Flow Properties

        4.  Group 9.  Flow Time Stamp

        5.  Group 11.  Miscellaneous Flow Properties

        6.  Group 3.  Metering Process Statistics (only for option
            template)

        7.  Group 10.  Per-Flow Counters

   11.  variable length Information Elements

        1.  Group 1.  Identification

        2.  Group 2.  Metering Process Configuration (only for option
            template)

        3.  Group 8.  Min/Max Flow Properties

        4.  Group 9.  Flow Time Stamp

        5.  Group 11.  Miscellaneous Flow Properties

        6.  Group 3.  Metering Process Statistics (only for option
            template)

        7.  Group 10.  Per-Flow Counters

4.3.  Order of Information Elements according to data size in each group

   In this section, all Information Elements except paddingOctets are
   classified by size in each group.

4.3.1.  Group 1. Identification

   o  Even number of octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  141: templateId

   o  "Reduced Size Encoding" applicable Information Elements

      1.  141: lineCardId




Irino                    Expires April 19, 2007                [Page 25]

Internet-Draft        Order of Information Elements         October 2006


      2.  142: portId

      3.  10: ingressInterface

      4.  14: egressInterface

      5.  143: meteringProcessId

      6.  144: exportingProcessId

      7.  148: flowId

      8.  138: observationDomainId

      9.  137: commonPorpertiesId

4.3.2.  Group 2. Metering and Exporting Process Configuration

   o  Multiple of four octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  130: exporterIPv4Address

      2.  131: exporterIPv6Address

      3.  211: collectorIPv4Address

      4.  212: collectorIPv6Address

   o  Even number of octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  217: exporterTransportPort

      2.  216: collectorTransportPort

   o  Odd number of octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  214: collectorProtocolVersion

   o  "Reduced Size Encoding" applicable Information Elements

      1.  213: collectorInterface

      2.  173: flowKeyIndicator





Irino                    Expires April 19, 2007                [Page 26]

Internet-Draft        Order of Information Elements         October 2006


4.3.3.  Group 3. Metering and Exporting Process Statistics

   o  "Reduced Size Encoding" applicable Information Elements

      1.  41: exportedMessageTotalCount

      2.  40: exportedOctetTotalCount

      3.  42: exportedFlowRecordTotalCount

      4.  163: observedFlowTotalCount

      5.  164: ignoredPacketTotalCount

      6.  165: ignoredOctetTotalCount

      7.  166: notSentFlowTotalCount

      8.  167: notSentPacketTotalCount

      9.  168: notSentOctetTotalCount

4.3.4.  Group 4. IP Header Fields

   o  Multiple of four octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  8: sourceIPv4Address

      2.  27: sourceIPv6Address

      3.  44: sourceIPv4Prefix

      4.  170: sourceIPv6Prefix

      5.  12: destinationIPv4Address

      6.  28: destinationIPv6Address

      7.  45: destinationIPv4Prefix

      8.  169: destinationIPv6Prefix

   o  Even number of octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  88: fragmentOffset




Irino                    Expires April 19, 2007                [Page 27]

Internet-Draft        Order of Information Elements         October 2006


      2.  190: totalLengthIPv4

   o  Odd number of octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.   60: ipVersion

      2.   9: sourceIPv4PrefixLength

      3.   29: sourceIPv6PrefixLength

      4.   13: destinationIPv4PrefixLength

      5.   30: destinationIPv6PrefixLength

      6.   192: ipTTL

      7.   4: protocolIdentifier

      8.   193: nextHeaderIPv6

      9.   195: ipDiffServCodePoint

      10.  196: ipPrecedence

      11.  5: ipClassOfService

      12.  55: postIpClassOfService

      13.  206: isMulticast

      14.  197: fragmentFlags

   o  "Reduced Size Encoding" applicable Information Elements

      1.  31: flowLabelIPv6

      2.  54: fragmentIdentification

      3.  189: ipHeaderLength

      4.  207: ipv4IHL

      5.  191: payloadLengthIPv6

      6.  204: ipPayloadLength





Irino                    Expires April 19, 2007                [Page 28]

Internet-Draft        Order of Information Elements         October 2006


4.3.5.  Group 5. Transport Header Fields

   o  Multiple of four octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  184: tcpSequenceNumber

      2.  185: tcpAcknowledgementNumber

      3.  186: tcpWindowSize

      4.  187: tcpUrgentPointer

      5.  188: tcpHeaderLength

   o  Even number of octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  7: sourceTransportPort

      2.  11: destinationTransportPort

      3.  180: udpSourcePort

      4.  181: udpDestinationPort

      5.  205: udpMessageLength

      6.  182: tcpSourcePort

      7.  183: tcpDestinationPort

      8.  32: icmpTypeCodeIPv4

      9.  139: icmpTypeCodeIPv6

   o  Odd number of octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  176: icmpTypeIPv4

      2.  177: icmpCodeIPv4

      3.  178: icmpTypeIPv6

      4.  179: icmpCodeIPv6





Irino                    Expires April 19, 2007                [Page 29]

Internet-Draft        Order of Information Elements         October 2006


      5.  33: igmpType

   o  "Reduced Size Encoding" applicable Information Elements

      1.  141: lineCardId

      2.  142: portId

      3.  10: ingressInterface

      4.  14: egressInterface

      5.  143: meteringProcessId

      6.  144: exportingProcessId

      7.  148: flowId

      8.  138: observationDomainId

      9.  137: commonPorpertiesId

4.3.6.  Group 6. Sub-IP Header Fields

   o  Even number of octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  56: sourceMacAddress

      2.  81: postSourceMacAddress

      3.  58: vlanId

      4.  59: postVlanId

      5.  80: destinationMacAddress

      6.  57: postDestinationMacAddress

   o  Odd number of octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  146: wlanChannelId

      2.  203: mplsTopLabelExp






Irino                    Expires April 19, 2007                [Page 30]

Internet-Draft        Order of Information Elements         October 2006


   o  "Reduced Size Encoding" applicable Information Elements

      1.   200: mplsTopLabelTTL

      2.   202: mplsLabelStackDepth

      3.   201: mplsLabelStackLength

      4.   194: mplsPayloadLength

      5.   70: mplsTopLabelStackSection

      6.   71: mplsLabelStackSection2

      7.   72: mplsLabelStackSection3

      8.   73: mplsLabelStackSection4

      9.   74: mplsLabelStackSection5

      10.  75: mplsLabelStackSection6

      11.  76: mplsLabelStackSection7

      12.  77: mplsLabelStackSection8

      13.  78: mplsLabelStackSection9

      14.  79: mplsLabelStackSection10

   o  Variable length Information Elements

      1.  147: wlanSSID (string)

4.3.7.  Group 7. Derived Packet Properties

   o  Multiple of four octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  15: ipNextHopIPv4Address

      2.  62: ipNextHopIPv6Address

      3.  18: bgpNextHopIPv4Address

      4.  63: bgpNextHopIPv6Address





Irino                    Expires April 19, 2007                [Page 31]

Internet-Draft        Order of Information Elements         October 2006


      5.  47: mplsTopLabelIPv4Address

      6.  140: mplsTopLabelIPv6Address

   o  Odd number of octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  46: mplsTopLabelType

   o  "Reduced Size Encoding" applicable Information Elements

      1.  16: bgpSourceAsNumber

      2.  17: bgpDestinationAsNumber

      3.  128: bgpNextAdjacentAsNumber

      4.  129: bgpPrevAdjacentAsNumber

   o  variable length Information Elements

      1.  90: mplsVpnRouteDistinguisher

4.3.8.  Group 8. Derived Packet Properties

   o  Multiple of four octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  208: ipv4Options

   o  Odd number of octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  52: minimumTTL

      2.  53: maximumTTL

      3.  6: tcpControlBits

   o  "Reduced Size Encoding" applicable Information Elements

      1.  25: minimumPacketLength

      2.  26: maximumPacketLength

      3.  64: ipv6ExtensionHeader





Irino                    Expires April 19, 2007                [Page 32]

Internet-Draft        Order of Information Elements         October 2006


      4.  209: tcpOptions

4.3.9.  Group 9. Flow Time Stamps

   o  Multiple of four octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.   150: flowStartSeconds

      2.   151: flowEndSeconds

      3.   152: flowStartMilliseconds

      4.   153: flowEndMilliseconds

      5.   154: flowStartMicroseconds

      6.   155: flowEndMicroseconds

      7.   156: flowStartNanoseconds

      8.   157: flowEndNanoseconds

      9.   158: flowStartDeltaMicroseconds

      10.  159: flowEndDeltaMicroseconds

      11.  160: systemInitTimeMilliseconds

   o  "Reduced Size Encoding" applicable Information Elements

      1.  22: flowStartSysUpTime

      2.  21: flowEndSysUpTime

4.3.10.  Group 10. Per-Flow Counters

   o  "Reduced Size Encoding" applicable Information Elements

      1.   1: octetDeltaCount

      2.   23: postOctetDeltaCount

      3.   198: octetDeltaSumOfSquares

      4.   85: octetTotalCount





Irino                    Expires April 19, 2007                [Page 33]

Internet-Draft        Order of Information Elements         October 2006


      5.   171: postOctetTotalCount

      6.   199: octetTotalSumOfSquares

      7.   2: packetDeltaCount

      8.   24: postPacketDeltaCount

      9.   86: packetTotalCount

      10.  172: postPacketTotalCount

      11.  132: droppedOctetDeltaCount

      12.  133: droppedPacketDeltaCount

      13.  134: droppedOctetTotalCount

      14.  135: droppedPacketTotalCount

      15.  19: postMCastPacketDeltaCount

      16.  20: postMCastOctetDeltaCount

      17.  174: postMCastPacketTotalCount

      18.  175: postMCastOctetTotalCount

      19.  218: tcpSynTotalCount

      20.  219: tcpFinTotalCount

      21.  220: tcpRstTotalCount

      22.  221: tcpPshTotalCount

      23.  222: tcpAckTotalCount

      24.  223: tcpUrgTotalCount

4.3.11.  Group 11. Miscellaneous Flow Properties

   o  Odd number of octets in "Reduced Size Encoding" inapplicable
      Information Elements

      1.  136: flowEndReason





Irino                    Expires April 19, 2007                [Page 34]

Internet-Draft        Order of Information Elements         October 2006


      2.  61: flowDirection

   o  "Reduced Size Encoding" applicable Information Elements

      1.  36: flowActiveTimeout

      2.  37: flowIdleTimeout

      3.  161: flowDurationMilliseconds

      4.  162: flowDurationMicroseconds








































Irino                    Expires April 19, 2007                [Page 35]

Internet-Draft        Order of Information Elements         October 2006


5.  Special case

5.1.  Enterprise Specific Information Elements for forward flow

   Enterprise Specific fixed length Information Elements SHOULD be
   positioned between "Reduce Size Encoding" applicable Information
   Elements defined in [IPFIX-INFO] and variable length Information
   Elements defined in [IPFIX-INFO].

   Enterprise Specific variable length Information Elements SHOULD be
   positioned after variable length Information Elements defined in
   [IPFIX-INFO].

5.2.  Enterprise Specific Information Elements for reverse flow in
      Biflow

   Reverse flow Information Elements which have reverse PEN are
   suggested in [IPFIX-BIFLOW].  Reverse flow Information Elements are
   positioned just after corresponding forward Information Elements.
   Forward and reverse Information Elements SHOULD be adjacent.

5.3.  Information Element is required more than once in Template

   If an Information Element is required more than once in Template, the
   different occurrences of this Information Element SHOULD follow the
   logical order of their treatments by the Metering Process.
   (According to [IPFIX-PROTO])

   Logical order has more priority than the rule described in this draft
   when an Information Element is required more than once in Template.





















Irino                    Expires April 19, 2007                [Page 36]

Internet-Draft        Order of Information Elements         October 2006


6.  Security Considerations

   The "order of Information Elements" document does not directly relate
   to and introduce security issues.  The same security considerations
   as those for the IPFIX Information Model [IPFIX-INFO] apply.














































Irino                    Expires April 19, 2007                [Page 37]

Internet-Draft        Order of Information Elements         October 2006


7.  IANA Considerations

   This document has no actions for IANA.
















































Irino                    Expires April 19, 2007                [Page 38]

Internet-Draft        Order of Information Elements         October 2006


8.  References

   [IPFIX-BIFLOW]
              Trammell, B. and E. Boschi, "Bidirectional Flow Export
              using IPFIX,  draft-ietf-ipfix-reducing-biflow-00.txt,
              work in progress", Aug 2006.

   [IPFIX-INFO]
              Quittek, J., Bryant, S., Claise, B., and J. Meyer,
              "Information Model for IP Flow Information Export,
              draft-ietf-ipfix-info-11.txt, work in progress", Sep 2006.

   [IPFIX-PROTO]
              Claise, B., "IPFIX Protocol Specification Internet Draft,
              draft-ietf-ipfix-protocol-23.txt, work in progress",
              June 2006.

   [IPFIX-RED]
              Boschi, E., Mark, L., and B. Claise, "Reducing redundancy
              in IPFIX and PSAMP reports,
              draft-ietf-ipfix-reducing-redundancy-00.txt, work in
              progress", Aug 2006.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels, BCP 14, RFC 2119 progress",
              March 1997.

























Irino                    Expires April 19, 2007                [Page 39]

Internet-Draft        Order of Information Elements         October 2006


Appendix A.  A template composed with Information Elements equivalent of
             NetFlow Version 5 record

   In this section, a example of application of above order rule through
   building a template which has Information Elements equivalent of
   NetFlow Version 5 record is described.













































Irino                    Expires April 19, 2007                [Page 40]

Internet-Draft        Order of Information Elements         October 2006


       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |         FlowSet ID = 2        |       Length = 56 bytes       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Any template No xxx       |       Field Count = 18        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     sourceIPv4Address(8)      |                4              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  destinationIPv4Address(12)   |                4              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    ipNextHopIPv4Address(15)   |                4              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    sourceTransportPort(7)     |                2              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  destinationTransportPort(11) |                2              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |   sourceIPv4PrefixLength(9)   |                1              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |destinationIPv4PrefixLength(13)|                1              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |       protocolIdentifier(4)   |                1              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |      ipClassOfService(5)      |                1              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |       tcpControlBits(6)       |                1              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |      paddingOctets(210)       |                3              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     ingressInterface(10)      |                4              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |      egressInterface(14)      |                4              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    bgpSourceAsNumber(16)      |                4              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |  bgpDestinationAsNumber(17)   |                4              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |    flowStartSysUpTime(22)     |                4              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     flowEndSysUpTime(21)      |                4              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |      octetDeltaCount(1)       |                4              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     packetDeltaCount(2)       |                4              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

           Figure 3: A template equivalent of NetFlow Version 5




Irino                    Expires April 19, 2007                [Page 41]

Internet-Draft        Order of Information Elements         October 2006


Author's Address

   Hitoshi Irino
   NTT Network Service Systems Laboratories
   9-11, Midori-Cho 3-Chome
   Musashino-Shi, Tokyo  180-8585
   Japan

   Phone: +81 422 59 4403
   Email: irino.hitoshi@lab.ntt.co.jp









































Irino                    Expires April 19, 2007                [Page 42]

Internet-Draft        Order of Information Elements         October 2006


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Irino                    Expires April 19, 2007                [Page 43]

