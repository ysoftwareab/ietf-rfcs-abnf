<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DomainKeys Security Tagging (DOSETA)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DomainKeys Security Tagging (DOSETA)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">DKIM</td><td class="header">D. Crocker, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Brandenburg InternetWorking</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">M. Kucherawy, Ed.</td></tr>
<tr><td class="header">Expires: July 18, 2011</td><td class="header">Cloudmark</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 14, 2011</td></tr>
</table></td></tr></table>
<h1><br />DomainKeys Security Tagging (DOSETA)<br />draft-crocker-dkim-doseta-00</h1>

<h3>Abstract</h3>

<p>DomainKeys Security Tagging (DOSETA) is a component mechanism that
            enables development of a security-related service, such as
            authentication or encryption, with keys based on domain names; the
            name owner can be any actor involved in the handling of the data,
            such as the author's organization, a server operator or one of
            their agents. The DOSETA Library provides a collection of common
            capabilities, including canonicalization, parameter tagging, and
            retrieval of self-certified keys. The DOSETA Signing Template
            affixes a signature to data that is in a "header/content" form.
            Defining the meaning of the signature is the responsibility of the
            service that incorporates DOSETA. The signature is validated
            through a cryptographic signature and querying the signer's domain
            directly, to retrieve the appropriate public key. 
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on July 18, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2011 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#features">1.1.</a>&nbsp;
DOSETA Features<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#arch">1.2.</a>&nbsp;
DOSETA Architecture<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology and Definitions {rfc4871bis-02 2, subset}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Identity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Actors<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Syntax<br />
<a href="#library">3.</a>&nbsp;
DOSETA Library<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#canon">3.1.</a>&nbsp;
Canonicalization {rfc4871bis-02 3.4}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tagval">3.2.</a>&nbsp;
Tag=Value Parameters {rfc4871bis-02 3.2}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#keymgmt">3.3.</a>&nbsp;
Key Management {rfc4871bis-02 3.6}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#selectors">3.4.</a>&nbsp;
Selectors for Keys {rfc4871bis-02 3.1}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dnsbind">3.5.</a>&nbsp;
DNS Binding for Key Retrieval {rfc4871bis-02 3.6.2}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#keydata">3.6.</a>&nbsp;
Stored Key Data {rfc4871bis-02 3.6.1, subset, with preface}<br />
<a href="#template">4.</a>&nbsp;
DOSETA H/C Signing Template<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#cryptoalgs">4.1.</a>&nbsp;
Cryptographic Algorithms {rfc4871bis-02 3.3, subset}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#signeddatastruct">4.2.</a>&nbsp;
Signature Data Structure {rfc4871bis-02 3.5, subset}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sigcalc">4.3.</a>&nbsp;
Signature Calculation {rfc4871bis-02 3.7, reorganized and clarified}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#signer">4.4.</a>&nbsp;
Signer Actions {rfc4871bis-02 5}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verifier">4.5.</a>&nbsp;
Verifier Actions {rfc4871bis-02 6}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">4.6.</a>&nbsp;
Requirements for Tailoring the Signing Service {added}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#parentsig">4.7.</a>&nbsp;
Signing by Parent Domains {rfc4871bis-02 3.8}<br />
<a href="#multisig">5.</a>&nbsp;
Semantics of Multiple Signatures {rfc4871bis-02 4}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">5.1.</a>&nbsp;
Example Scenarios {rfc4871bis-02 4.1}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">5.2.</a>&nbsp;
Interpretation {rfc4871bis-02 4.2}<br />
<a href="#anchor31">6.</a>&nbsp;
Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#iana">6.1.</a>&nbsp;
IANA Considerations {rfc4871bis-02 7, subset}<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#security">6.2.</a>&nbsp;
Security Considerations {rfc4871bis-02 8, subset}<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#createpkey">Appendix&nbsp;A.</a>&nbsp;
Creating a Public Key {rfc4871bis-02 C}<br />
<a href="#anchor53">Appendix&nbsp;B.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>DomainKeys Security Tagging (DOSETA) is a component mechanism that
            enables development of a security-related service, such as
            authentication or encryption, with keys based on domain names <a class='info' href='#RFC1034'>[RFC1034]<span> (</span><span class='info'>Mockapetris, P., &ldquo;DOMAIN NAMES - CONCEPTS AND FACILITIES,&rdquo; November&nbsp;1987.</span><span>)</span></a>; the name owner can be any actor involved in
            the handling of the data, such as the author's organization, a
            server operator or one of their agents. The DOSETA Library
            provides a collection of common capabilities, including
            canonicalization, parameter tagging, and retrieval of
            self-certified keys. The DOSETA Signing Template affixes a
            signature to data that is in a "header/content" form. Defining the
            meaning of the signature is the responsibility of the service that
            incorporates DOSETA. The signature is validated through a
            cryptographic signature and querying the signer's domain directly,
            to retrieve the appropriate public key.
</p>
<p>The approach taken by DOSETA differs from previous approaches to
            data signing (such as, Secure/Multipurpose Internet Mail
            Extensions (S/MIME) <a class='info' href='#RFC1847'>[RFC1847]<span> (</span><span class='info'>Galvin, J., Murphy, S., Crocker, S., and N. Freed, &ldquo;Security Multiparts for MIME:                   Multipart/Signed and Multipart/Encrypted,&rdquo; October&nbsp;1995.</span><span>)</span></a>, OpenPGP <a class='info' href='#RFC4880'>[RFC4880]<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;2007.</span><span>)</span></a>) in that: </p>
<ul class="text">
<li>the message signature can be packaged independently of the
                  data it is signing, so that neither human viewers of the
                  data nor existing data handling software is confused by
                  signature-related content appearing in the Content;
</li>
<li>there is no dependency on public and private key pairs being
                  issued by well-known, trusted certificate authorities; 
</li>
<li>there is no dependency on the deployment of any new Internet
                  protocols or services for public key distribution or
                  revocation;
</li>
<li>no attempt is made to include encryption as part of the
                  mechanism;
</li>
</ul>

<p>DOSETA: </p>
<ul class="text">
<li>enables compatibility with the existing data handling
                  infrastructure and transparent to the fullest extent
                  possible;
</li>
<li>requires minimal new infrastructure;
</li>
<li>can be implemented independently of data clients in order to
                  reduce deployment time;
</li>
<li>can be deployed incrementally;
</li>
<li>allows delegation of signing to third parties.
</li>
</ul>

<p>DOSETA is taken directly from the original DKIM Signing
            specification <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>, <a class='info' href='#RFC5672'>[RFC5672]<span> (</span><span class='info'>Crocker, D., Ed., &ldquo;RFC 4871 DomainKeys Identified Mail (DKIM) Signatures:                   Update,&rdquo; August&nbsp;2009.</span><span>)</span></a>. It has merely extracted the core portions
            of the specification, so that they can be applied to other
            security-related services. For example, the core could support a
            DKIM-like signing service for web pages, and it could support a
            data encryption mechanism using the same DNS-based, self-certified
            key service as DKIM. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>Much of the text for this draft is taken
                  from the DKIM working group draft-ietf-DKIM-rfc4871bis-02
                  revision. Sections in this document cross reference their
                  source with the notation: <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>{rfc4871bis-02 xx}</pre></div>where "xx" indicates the section number. It might
                  also indicate that a subset is taken, such as when a portion
                  is applied to the DKIM-over-DOSETA draft and a portion to
                  the DOSETA draft. In some cases the base text also has been
                  enhanced.
</dd>
</dl></blockquote>

<a name="features"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
DOSETA Features</h3>

<p>DOSETA features include: </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Identity:  </dt>
<dd>DOSETA separates the
                           question of the identity of the DOSETA Creator from
                           any other associated identifier, such as the data's
                           purported author. In particular, a DOSETA header
                           includes the identity of the signer. DOSETA
                           Consumers can use the DOSETA identity information
                           to decide how they want to process the data. That
                           identity can be included in the attributes of the
                           data or recorded elsewhere. 
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>DOSETA does not, iiself,
                                 require that the identity it uses be required
                                 to match any other associated identifier.
                                 Those other identifiers already carry their
                                 own semantics which might conflict with the
                                 use of the identifier needed by DOSETA.
                                 However a particular service that
                                 incorporates DNS might choose to add
                                 constraints on the choice of identifier, such
                                 as having it match another identifier
                                 associated with the data.
</dd>
</dl></blockquote>
</dd>
<dt>Scalability:  </dt>
<dd>DOSETA is designed to
                           support the extreme scalability requirements that
                           characterize Internet data identification. 
</dd>
<dt>Key Management:  </dt>
<dd>DOSETA differs from
                           traditional hierarchical public-key systems in that
                           no Certificate Authority infrastructure is
                           required; the verifier requests the public key from
                           a repository in the domain of the claimed signer
                           directly rather than from a third party. Hence
                           DOSETA provides self-certifying keys.
</dd>
<dt></dt>
<dd>The DNS is the initial mechanism for DOSETA public
                           keys. Thus, DOSETA currently depends on DNS
                           administration and the security of the DNS system.
                           DOSETA is designed to be extensible to other key
                           fetching services as they become available.
</dd>
<dt>Data Integrity:  </dt>
<dd> A DOSETA signature
                           associates its identifier with the computed hash of
                           some or all of the data in order to prevent the
                           re-use of the signature with different data.
                           Verifying the signature asserts that the hashed
                           data has not changed since it was signed, and
                           asserts nothing else about "protecting" the
                           end-to-end integrity of the data.
</dd>
<dt>Assessment:  </dt>
<dd>For identity and
                           authentication related processes, this phase
                           integrates the validation output for determing
                           further action.
</dd>
</dl></blockquote>

</blockquote>

<a name="arch"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
DOSETA Architecture</h3>

<p>As component technology, DOSETA is meant to be incorporated
               into a service. This specification provides an underlying set
               of common features and a template for using them to provide a
               signing service, such as for authenticating an identifier.
               Hence, the pieces can be depicted as follows, with DKIM being
               shown as a specific service that incorporates DOSETA:</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>    +--------+                              +-----------------+
    |  DKIM  |                              | Message Privacy |
    +---+----+                              +--------+--------+
        |                                            |
  +-----V---------------------------+                |
  | Header/Content Signing Template |                |
  +----------------+----------------+                |
                   |                                 |
...................V.................................V.............
.                     D O S E T A     L I B R A R Y               .
.+------------------+ +------------+ +-------------+ +-----------+.
.|                  | |    Key     | |  Common     | | Signature |.
.| Canonicalization | | Management | |  Parameters | |  Header   |.
.|                  | |   (DNS)    | | (tab=value) | |           |.
.+------------------+ +------------+ +-------------+ +-----------+.
...................................................................
</pre></div><p>

            
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology and Definitions {rfc4871bis-02 2, subset}</h3>

<p>This section defines terms used in the rest of the document. 
</p>
<p>Within the specification, the label "TEMPLATE" is used to indicate
            actions that are required to incorporate DOSETA into a
            service.
</p>
<p>Syntax descriptions use Augmented BNF (ABNF) <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications:                   ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>. 
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
            NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL"
            in this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate                   Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Identity</h3>

<p></p>
<blockquote class="text"><dl>
<dt>Identity:  </dt>
<dd> A person, role, or organization.
                     In the context of DOSETA, examples include author,
                     author's organization, an ISP along the handling path, an
                     independent trust assessment service, and a data
                     processing intermediary operator.
</dd>
<dt>Identifier:  </dt>
<dd> A label that refers to an
                     identity.
</dd>
<dt>Signing Domain Identifier (SDID):  </dt>
<dd> A single
                     domain name that refers to the identity owning the key to
                     be used for DOSETA processing. The name has only basic
                     domain name semantics; any possible owner-specific
                     semantics are outside the scope of DOSETA. It is
                     specified in <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>.
</dd>
</dl></blockquote>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Actors</h3>

<p></p>
<blockquote class="text"><dl>
<dt>Creator:  </dt>
<dd>An element in the data handling
                     system that produces a cryptographic encoding, on behalf
                     of a domain, is referred to as a Creator. 
</dd>
<dt>Consumer:  </dt>
<dd>An element in the data handling
                     system that processes an existing cryptographic encoding,
                     on behalf of a domain, is referred to as a Consumer.
</dd>
<dt>Signer:  </dt>
<dd> An element in the data handling
                     system that signs messages on behalf of a domain is
                     referred to as a signer. This element specifies the
                     organization acting as a type of DOSETA Creator. It might
                     be a client, server or other agent such as a reputation
                     service. The key issue is that the data MUST be signed
                     before it leaves the administrative domain of the signer. 
</dd>
<dt>Verifier:  </dt>
<dd> An element in the data handling
                     system that verifies signatures is referred to as a
                     verifier. This element is a Consumer of a signing
                     service. It might be a client, server, or other agent,
                     such as a reputation service. In most cases it is
                     expected that a verifier will be close to an end user
                     (Creator) of the data or some consuming agent such as a
                     data processing intermediary. 
</dd>
</dl></blockquote>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Syntax</h3>

<a name="whitespace"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1"></a><h3>2.3.1.&nbsp;
Whitespace</h3>

<p>There are three forms of whitespace: </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>WSP:  </dt>
<dd> represents simple whitespace,
                              that is, a space or a tab character (formal
                              definition in <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications:                   ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>).
</dd>
<dt>LWSP:  </dt>
<dd> is linear whitespace,
                              defined as WSP plus CRLF (formal definition in <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications:                   ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>).
</dd>
<dt>FWS:  </dt>
<dd> is folding whitespace. It
                              allows multiple lines separated by CRLF followed
                              by at least one whitespace, to be joined.
</dd>
</dl></blockquote>

</blockquote>

<p>The formal syntax for these are (WSP and LWSP are given for
                  information only): </p>
<blockquote class="text">
<p>
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>WSP</dfn>  =  <cite class='key'>SP</cite> / <cite class='key'>HTAB</cite>
<dfn>LWSP</dfn> =  <span class='rep'>*</span>(<cite class='key'>WSP</cite> / <cite class='key'>CRLF</cite> <cite class='key'>WSP</cite>)
<dfn>FWS</dfn>  =  [<span class='rep'>*</span><cite class='key'>WSP</cite> <cite class='key'>CRLF</cite>] <span class='rep'>1*</span><cite class='key'>WSP</cite></pre></div>

</blockquote><p>
               
</p>
<p>The definition of FWS is identical to that in <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a> except for the exclusion of
                  obs-FWS.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2"></a><h3>2.3.2.&nbsp;
Common ABNF Tokens</h3>

<p>The following tokens are used in this document: </p>
<blockquote class="text">
<p>
                        
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>hyphenated-word</dfn> =  <cite class='key'>ALPHA</cite>
                   [ <span class='rep'>*</span>(<cite class='key'>ALPHA</cite> / <cite class='key'>DIGIT</cite> / "<span class='str'>-</span>")
                   (<cite class='key'>ALPHA</cite> / <cite class='key'>DIGIT</cite>) ]
<dfn>ALPHADIGITPS</dfn>    =  (<cite class='key'>ALPHA</cite> / <cite class='key'>DIGIT</cite> / "<span class='str'>+</span>" / "<span class='str'>/</span>")
<dfn>base64string</dfn>    =  <cite class='id'>ALPHADIGITPS</cite> <span class='rep'>*</span>([<cite class='id'>FWS</cite>] <cite class='id'>ALPHADIGITPS</cite>)
                   [ [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [ [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" ] ]
<dfn>hdr-name</dfn>        =  <cite class='id'>field-name</cite>
<dfn>qp-hdr-value</dfn>    =  <cite class='id'>D-quoted-printable</cite>
                        <em>; with "|" encoded</em></pre></div>

</blockquote><p>
               
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.3"></a><h3>2.3.3.&nbsp;
Imported ABNF Tokens</h3>

<p> The following tokens are imported from other RFCs as noted.
                  Those RFCs SHOULD be considered definitive.
</p>
<p>From <a class='info' href='#RFC5321'>[RFC5321]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a>: </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>&lt;local-part&gt;  </dt>
<dd> (implementation
                              warning: this permits quoted strings)
</dd>
<dt>&lt;sub-domain&gt;</dt>
<dd> 
</dd>
</dl></blockquote>

</blockquote>

<p>From <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>: </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>&lt;field-name&gt;  </dt>
<dd> (name of a
                              header field)
</dd>
</dl></blockquote>

</blockquote>

<p>From <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail                   Extensions (MIME) Part One: Format of Internet Message                   Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a>: </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>&lt;qp-section&gt;  </dt>
<dd>a single line of
                              quoted-printable-encoded text
</dd>
<dt>&lt;hex-octet&gt; </dt>
<dd>a quoted-printable
                              encoded octet)
</dd>
</dl></blockquote>

</blockquote><p>
               
</p>
<p>
                  </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>Be aware that the ABNF in <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail                   Extensions (MIME) Part One: Format of Internet Message                   Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a> does not obey the rules of <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications:                   ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a> and MUST be interpreted
                        accordingly, particularly as regards case folding.
</dd>
</dl></blockquote><p>
               
</p>
<p> Other tokens not defined herein are imported from <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications:                   ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>. These are intuitive primitives such
                  as SP, HTAB, WSP, ALPHA, DIGIT, CRLF, etc.
</p>
<a name="D-quoted-printable"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.4"></a><h3>2.3.4.&nbsp;
D-Quoted-Printable</h3>

<p>The D-Quoted-Printable encoding syntax resembles that
                  described in Quoted-Printable <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail                   Extensions (MIME) Part One: Format of Internet Message                   Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a>, Section 6.7: </p>
<ul class="text">
<li>Any character MAY be encoded as an "=" followed by two
                        hexadecimal digits from the alphabet
                        "0123456789ABCDEF" (no lowercase characters permitted)
                        representing the hexadecimal-encoded integer value of
                        that character.
</li>
<li>All control characters (those with values &lt; %x20),
                        8-bit characters (values &gt; %x7F), and the
                        characters DEL (%x7F), SPACE (%x20), and semicolon
                        (";", %x3B) MUST be encoded.
</li>
<li>All whitespace, including SPACE, CR, and LF
                        characters, MUST be encoded.
</li>
<li>After encoding, FWS MAY be added at arbitrary
                        locations in order to avoid excessively long lines;
                        such whitespace is NOT part of the value, and MUST be
                        removed before decoding.
</li>
</ul>

<p>The formal syntax for D-Quoted-Printable is: </p>
<blockquote class="text">
<p>
                        
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>D-quoted-printable</dfn> =  <span class='rep'>*</span>(<cite class='id'>FWS</cite> / <cite class='id'>hex-octet</cite> / <cite class='id'>D-safe-char</cite>)
                         <em>; hex-octet is from RFC2045</em>
<dfn>D-safe-char</dfn>        =  <span class='val'>%x21-3A</span> / <span class='val'>%x3C</span> / <span class='val'>%x3E-7E</span>
                         <em>; '!' - ':', '&lt;', '&gt;' - '~'</em>
                         <em>; Characters not listed as "mail-safe"</em>
                         <em>; in [RFC2049] are also not</em>
                         <em>; recommended.</em></pre></div>

</blockquote>

<p>D-Quoted-Printable differs from Quoted-Printable as defined
                  in <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail                   Extensions (MIME) Part One: Format of Internet Message                   Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a> in several important ways: </p>
<ol class="text">
<li>Whitespace in the input text, including CR and LF,
                        MUST be encoded. <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail                   Extensions (MIME) Part One: Format of Internet Message                   Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a> does not require such encoding,
                        and does not permit encoding of CR or LF characters
                        that are part of a CRLF line break.
</li>
<li>Whitespace in the encoded text is ignored. This is to
                        allow tags encoded using D-Quoted-Printable to be
                        wrapped as needed. In particular, <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail                   Extensions (MIME) Part One: Format of Internet Message                   Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a> requires that line breaks in the
                        input be represented as physical line breaks; that is
                        not the case here.
</li>
<li>The "soft line break" syntax ("=" as the last
                        non-whitespace character on the line) does not
                        apply.
</li>
<li>D-Quoted-Printable does not require that encoded lines
                        be no more than 76 characters long (although there
                        might be other requirements depending on the context
                        in which the encoded text is being used).
</li>
</ol>

<a name="library"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
DOSETA Library</h3>

<p>DOSETA is distinguished by a DNS-based, self-certifying public key
            mechanism, common canonicalization algorithms, and a common
            parameter encoding mechanism.
</p>
<a name="canon"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Canonicalization {rfc4871bis-02 3.4}</h3>

<p>Some data handling systems modify the original data,
               potentially invalidating a cryptographic function, such as with
               a signature. For most signers, mild modification of data is
               immaterial to validation of the DOSETA domain name's use. For
               such signers, a canonicalization algorithm that survives modest
               handling modification is preferred.
</p>
<p>Other signers demand that any modification of the data, however
               minor, result in a signature verification failure. These
               signers prefer a canonicalization algorithm that does not
               tolerate any in-transit modification of the signed email.
</p>
<p>To satisfy basic requirements, two canonicalization algorithms
               are defined: a "simple" algorithm that tolerates almost no
               modification and a "relaxed" algorithm that tolerates common
               modifications such as whitespace replacement and data line
               rewrapping.
</p>
<p>Data handling systems sometimes treat different portions of
               text differentially and might be subject to more or less
               likelihood of breaking a signature. DOSETA currently covers two
               types of data:</p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Header:   </dt>
<dd>Attribute:value sets, in the
                           style of an Internet Mail header fields
</dd>
<dt>Content:  </dt>
<dd>Lines of ASCII text
</dd>
</dl></blockquote>

</blockquote>

<p>Some DOSETA Creators might be willing to accept modifications
               to some portions of the data, but not other portions. For
               DOSETA, a Creator MAY specify either algorithm for one portion
               of the data and another for a different portion when signing
               the data. 
</p>
<p>If no canonicalization algorithm is specified, the "simple"
               algorithm defaults for all of the data. DOSETA Creators MUST
               implement both canonicalization algorithms. Because further
               canonicalization algorithms might be defined in the future,
               Creators MUST ignore any signatures that use unrecognized
               canonicalization algorithms.
</p>
<p>Canonicalization simply prepares the data for presentation to
               the signing or verification algorithm. It MUST NOT change the
               transmitted data in any way. Canonicalization of distinct data
               portions is described below.</p>
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>This section assumes that data is
                     already in "network normal" format (text is ASCII
                     encoded, lines are separated with CRLF characters, etc.).
                     See also <a class='info' href='#normalize'>Section&nbsp;4.4.3<span> (</span><span class='info'>Normalize the Message to Prevent Transport Conversions</span><span>)</span></a> for information about normalizing
                     the message.
</dd>
</dl></blockquote>

<a name="hdrcanon"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Header Canonicalization Algorithms</h3>

<p>This section specifies initial entry for the IANA registry
                  defined in <a class='info' href='#hdrcanonreg'>Table&nbsp;2<span> (</span><span class='info'>DKIM&nbhy;Signature Header Canonicalization Algorithm                Registry                Initial Values</span><span>)</span></a>. </p>
<blockquote class="text"><dl>
<dt>simple:  </dt>
<dd> The "simple" header
                        canonicalization algorithm is for a set of
                        "attribute:value" textual data structures, such as
                        email header fields <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>. It does not change the original
                        Header fields in any way. Header fields MUST be
                        presented to the signing or verification algorithm
                        exactly as they are in the message being signed or
                        verified. In particular, header field names MUST NOT
                        be case folded and whitespace MUST NOT be changed.
</dd>
<dt>relaxed:  </dt>
<dd> The "relaxed" header
                        canonicalization algorithm is for a set of
                        "attribute:value" textual data structures, such as
                        email header fields <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>. It does not change the original
                        Header fields in any way. It MUST apply the following
                        steps in order: 
<ul class="text">
<li>Convert all header field names (not the header
                              field values) to lowercase. For example, convert
                              "SUBJect: AbC" to "subject: AbC".
</li>
<li>Unfold all header field continuation lines as
                              described in <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>; in particular, lines with
                              terminators embedded in continued header field
                              values (that is, CRLF sequences followed by WSP)
                              MUST be interpreted without the CRLF.
                              Implementations MUST NOT remove the CRLF at the
                              end of the header field value.
</li>
<li>Convert all sequences of one or more WSP
                              characters to a single SP character. WSP
                              characters here include those before and after a
                              line folding boundary.
</li>
<li>Delete all WSP characters at the end of each
                              unfolded header field value.
</li>
<li>Delete any WSP characters remaining before and
                              after the colon separating the header field name
                              from the header field value. The colon separator
                              MUST be retained.
</li>
</ul>
</dd>
</dl></blockquote>

<a name="contentcanon"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Content Canonicalization Algorithms</h3>

<p>This section specifies initial entry for the IANA registry
                  defined in <a class='info' href='#bodcanonreg'>Table&nbsp;3<span> (</span><span class='info'>DKIM&nbhy;Signature Body Canonicalization Algorithm                Registry                Initial Values</span><span>)</span></a>. </p>
<blockquote class="text"><dl>
<dt>simple:  </dt>
<dd> The "simple" Content
                        canonicalization algorithm is for lines of ASCII text,
                        such as occur in the body of email <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>. It ignores all empty lines at
                        the end of the Content. An empty line is a line of
                        zero length after removal of the line terminator. If
                        there is no Content or no trailing CRLF on the
                        Content, a CRLF is added. It makes no other changes to
                        the Content. In more formal terms, the "simple"
                        Content canonicalization algorithm converts "0*CRLF"
                        at the end of the Content to a single "CRLF".
</dd>
<dt></dt>
<dd>Note that a completely empty or missing Content is
                        canonicalized as a single "CRLF"; that is, the
                        canonicalized length will be 2 octets.
</dd>
<dt></dt>
<dd>
                        The sha1 value (in base64) for
                        an empty Content (canonicalized to a "CRLF") is: <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>uoq1oCgLlTqpdDX/iUbLy7J1Wic=</pre></div> The sha256 value is: <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>frcCV1k9oG9oKj3dpUqdJg1PxRT2RSN/XKdLCPjaYaY=</pre></div>
                     
</dd>
<dt>relaxed:  </dt>
<dd>
                        
                         The "relaxed" Content
                        canonicalization algorithm is for lines of ASCII text,
                        such as occur in the body of email <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>. It MUST apply the following
                        steps (a) and (b) in order:
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>Reduce whitespace: 
<ul class="text">
<li>Ignore all whitespace at the end of lines.
                                    Implementations MUST NOT remove the CRLF
                                    at the end of the line.
</li>
<li>Reduce all sequences of WSP within a line
                                    to a single SP character.
</li>
</ul>
</dd>
<dt>B.</dt>
<dd>Ignore all empty lines at the end of the
                              Content. "Empty line" is defined in Section
                              3.4.3.  If the Content
                              is non-empty, but does not end with a CRLF, a
                              CRLF is added. (For email, this is only possible
                              when using extensions to SMTP or non-SMTP
                              transport mechanisms.)
</dd>
</dl></blockquote>
                        The sha1 value (in base64) for
                        an empty Content (canonicalized to a null input) is: <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>2jmj7l5rSw0yVb/vlWAYkK/YBwk=</pre></div> The sha256 value is: <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU=</pre></div>
                        
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>It ought to be noted that the
                              relaxed Content canonicalization algorithm might
                              enable certain types of extremely crude "ASCII
                              Art" attacks where a message might be conveyed
                              by adjusting the spacing between words. If this
                              is a concern, the "simple" Content
                              canonicalization algorithm SHOULD be used
                              instead.
</dd>
</dl></blockquote>
                     
</dd>
</dl></blockquote>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
Canonicalization Examples (3.4.6}</h3>

<p>In the following examples, actual whitespace is used only
                  for clarity. The actual input and output text is designated
                  using bracketed descriptors: "&lt;SP&gt;" for a space
                  character, "&lt;HTAB&gt;" for a tab character, and
                  "&lt;CRLF&gt;" for a carriage-return/line-feed sequence. For
                  example, "X &lt;SP&gt; Y" and "X&lt;SP&gt;Y" represent the
                  same three characters.
</p>
<p>
                  
<p style='text-align: left'>Example 1: An email message reading:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>A: &lt;SP&gt; X &lt;CRLF&gt;
B &lt;SP&gt; : &lt;SP&gt; Y &lt;HTAB&gt;&lt;CRLF&gt;
                &lt;HTAB&gt; Z &lt;SP&gt;&lt;SP&gt;&lt;CRLF&gt;
&lt;CRLF&gt;
&lt;SP&gt; C &lt;SP&gt;&lt;CRLF&gt;
D &lt;SP&gt;&lt;HTAB&gt;&lt;SP&gt; E &lt;CRLF&gt;
&lt;CRLF&gt;
&lt;CRLF&gt;</pre></div>
               

<p>
                  
<p style='text-align: left'>when canonicalized using relaxed
                        canonicalization for both header and Content results
                        in a header reading:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>a:X &lt;CRLF&gt;
b:Y &lt;SP&gt; Z &lt;CRLF&gt;</pre></div>
               

<p>
                  
<p style='text-align: left'>and a Content reading:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>&lt;SP&gt; C &lt;CRLF&gt;
D &lt;SP&gt; E &lt;CRLF&gt;</pre></div>
               

<p>
</p>
<p>
                  
<p style='text-align: left'>Example 2: The same message canonicalized using
                        simple canonicalization for both header and Content
                        results in a header reading:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>A: &lt;SP&gt; X &lt;CRLF&gt;
B &lt;SP&gt; : &lt;SP&gt; Y &lt;HTAB&gt;&lt;CRLF&gt;
       &lt;HTAB&gt; Z &lt;SP&gt;&lt;SP&gt;&lt;CRLF&gt;</pre></div>
               

<p>
                  
<p style='text-align: left'>and a Content reading:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>&lt;SP&gt; C &lt;SP&gt;&lt;CRLF&gt;
D &lt;SP&gt;&lt;HTAB&gt;&lt;SP&gt; E &lt;CRLF&gt;</pre></div>
               

<p>
</p>
<p>
                  
<p style='text-align: left'>Example 3: When processed using relaxed header
                        canonicalization and simple Content canonicalization,
                        the canonicalized version has a header of:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>a:X &lt;CRLF&gt;
b:Y &lt;SP&gt; Z &lt;CRLF&gt;</pre></div>
               

<p>
                  
<p style='text-align: left'>and a Content reading:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>&lt;SP&gt; C &lt;SP&gt;&lt;CRLF&gt;
D &lt;SP&gt;&lt;HTAB&gt;&lt;SP&gt; E &lt;CRLF&gt;</pre></div>
               

<a name="tagval"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Tag=Value Parameters {rfc4871bis-02 3.2}</h3>

<p>DOSETA uses a simple "tag=value" syntax in several contexts,
               including to represent associated cryptographic data and domain
               cryptographic key records.
</p>
<p>Values are a series of strings containing either plain text,
               "base64" text (as defined in <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail                   Extensions (MIME) Part One: Format of Internet Message                   Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a>, Section&nbsp;6.8), "qp-section" (ibid,
               Section&nbsp;6.7), or "D-quoted-printable" (as defined in
               Section&nbsp;2.6). The name of the tag will determine the
               encoding of each value. Unencoded semicolon (";") characters
               MUST NOT occur in the tag value, since that separates
               tag-specs. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>Although the "plain text" defined
                     below (as "tag-value") only includes 7-bit characters, an
                     implementation that wished to anticipate future standards
                     would be advised not to preclude the use of UTF8-encoded
                     text in tag=value lists. 
</dd>
</dl></blockquote>

<p>Formally the syntax rules are as follows: </p>
<blockquote class="text">
<p>
                     
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>tag-list</dfn>  =  <cite class='id'>tag-spec</cite> <span class='rep'>0*</span>( "<span class='str'>;</span>" <cite class='id'>tag-spec</cite> ) [ "<span class='str'>;</span>" ]
<dfn>tag-spec</dfn>  =  [<cite class='id'>FWS</cite>] <cite class='id'>tag-name</cite> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>tag-value</cite> [<cite class='id'>FWS</cite>]
<dfn>tag-name</dfn>  =  <cite class='key'>ALPHA</cite> <span class='rep'>0*</span><cite class='id'>ALNUMPUNC</cite>
<dfn>tag-value</dfn> =  [ <cite class='id'>tval</cite> <span class='rep'>0*</span>( <span class='rep'>1*</span>(<cite class='key'>WSP</cite> / <cite class='id'>FWS</cite>) <cite class='id'>tval</cite> ) ]
                <em>; WSP and FWS prohibited at beginning and end</em>
<dfn>tval</dfn>      =  <span class='rep'>1*</span><cite class='id'>VALCHAR</cite>
<dfn>VALCHAR</dfn>   =  <span class='val'>%x21-3A</span> / <span class='val'>%x3C-7E</span>
                <em>; EXCLAMATION to TILDE except SEMICOLON</em>
<dfn>ALNUMPUNC</dfn> =  <cite class='key'>ALPHA</cite> / <cite class='key'>DIGIT</cite> / "<span class='str'>_</span>"</pre></div>
                  

</blockquote><p>
            
</p>
<p>Note that WSP is allowed anywhere around tags. In particular,
               any WSP after the "=" and any WSP before the terminating ";" is
               not part of the value; however, WSP inside the value is
               significant.
</p>
<p>Tags MUST be interpreted in a case-sensitive manner. Values
               MUST be processed as case sensitive unless the specific tag
               description of semantics specifies case insensitivity.
</p>
<p>Tags with duplicate names MUST NOT occur within a single
               tag-list; if a tag name does occur more than once, the entire
               tag-list is invalid.
</p>
<p>Whitespace within a value MUST be retained unless explicitly
               excluded by the specific tag description.
</p>
<p>Tag=value pairs that represent the default value MAY be
               included to aid legibility.
</p>
<p> Unrecognized tags MUST be ignored.
</p>
<p>Tags that have an empty value are not the same as omitted tags.
               An omitted tag is treated as having the default value; a tag
               with an empty value explicitly designates the empty string as
               the value. 
</p>
<a name="keymgmt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Key Management {rfc4871bis-02 3.6}</h3>

<p>Applications require some level of assurance that a cited
               public key is associated with the Creator using it. Many
               applications achieve this by using public key certificates
               issued by a trusted third party. For applications with modest
               certification requirements, DOSETA achieves a sufficient level
               of security, with significantly enhanced scalability, by simply
               having the Consumer query the purported Creator's DNS entry (or
               a supported equivalent) in order to retrieve the public
               key.
</p>
<p>DOSETA keys might be stored in multiple types of key servers
               and in multiple formats. The storage and format of keys are
               irrelevant to the remainder of the DOSETA algorithm.
</p>
<p>
               </p>
<blockquote class="text">
<p>
<p>The key lookup algorithm is:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>public-key = D-find-key(q-val, d-val, s-val)</pre></div> where: 
<blockquote class="text"><dl>
<dt>q-val:  </dt>
<dd>The type of the lookup, as
                           specified in the "q=" tag (<a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>)
</dd>
<dt>d-val:  </dt>
<dd>The domain of the signature, as
                           specified in the "d=" tag (<a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>)
</dd>
<dt>s-val:  </dt>
<dd>The selector of the lookup as
                           specified in the "s=" tag (<a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>)
</dd>
<dt>D-find-key:  </dt>
<dd>A function that uses q-val
                           to determine the specific details for accessing the
                           desired stored Key record.
</dd>
</dl></blockquote>

</blockquote>

<p>This document defines a single binding, using DNS TXT records
               to distribute the keys, per <a class='info' href='#dnsbind'>Section&nbsp;3.5<span> (</span><span class='info'>DNS Binding for Key Retrieval {rfc4871bis-02 3.6.2}</span><span>)</span></a>. Other bindings might be defined in the
               future.
</p>
<a name="selectors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Selectors for Keys {rfc4871bis-02 3.1}</h3>

<p>To support multiple concurrent public keys per signing domain,
               the key namespace is subdivided using "selectors". For example,
               selectors might indicate the names of office locations (for
               example, "sanfrancisco", "coolumbeach", and "reykjavik"), the
               signing date (for example, "january2005", "february2005",
               etc.), or even an individual user.
</p>
<p>Selectors are needed to support some important use cases. For
               example: </p>
<ul class="text">
<li>Domains that want to delegate signing capability for a
                     specific address for a given duration to a partner, such
                     as an advertising provider or other outsourced
                     function.
</li>
<li> Domains that want to allow frequent travelers to
                     generate signed data locally without the need to connect
                     to a particular server.
</li>
<li>"Affinity" domains (such as, college alumni associations)
                     that provide data forwarding, but that do not operate a
                     data origination agent for outgoing data.
</li>
</ul>

<p> Periods are allowed in selectors and are component separators.
               When keys are retrieved from the DNS, periods in selectors
               define DNS label boundaries in a manner similar to the
               conventional use in domain names. Selector components might be
               used to combine dates with locations, for example,
               "march2005.reykjavik". In a DNS implementation, this can be
               used to allow delegation of a portion of the selector
               namespace.
</p>
<p>
               </p>
<blockquote class="text">
<p>
                     
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>selector</dfn> =  <cite class='id'>sub-domain</cite> <span class='rep'>*</span>( "<span class='str'>.</span>" <cite class='id'>sub-domain</cite> )</pre></div>
                  

</blockquote><p>
            
</p>
<p>The number of public keys and corresponding selectors for each
               domain is determined by the domain owner. Many domain owners
               will be satisfied with just one selector, whereas
               administratively distributed organizations might choose to
               manage disparate selectors and key pairs in different regions
               or on different servers.
</p>
<p>Beyond administrative convenience, selectors make it possible
               to seamlessly replace public keys on a routine basis. If a
               domain wishes to change from using a public key associated with
               selector "january2005" to a public key associated with selector
               "february2005", it merely makes sure that both public keys are
               advertised in the public-key repository concurrently for the
               transition period during which data might be in transit prior
               to verification. At the start of the transition period, the
               outbound servers are configured to sign with the "february2005"
               private key. At the end of the transition period, the
               "january2005" public key is removed from the public-key
               repository. </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>A key can also be revoked as
                           described below. The distinction between revoking
                           and removing a key selector record is subtle. When
                           phasing out keys as described above, a signing
                           domain would probably simply remove the key record
                           after the transition period. However, a signing
                           domain could elect to revoke the key (but maintain
                           the key record) for a further period. There is no
                           defined semantic difference between a revoked key
                           and a removed key.
</dd>
</dl></blockquote>

</blockquote>

<p>While some domains might wish to make selector values well
               known, others will want to take care not to allocate selector
               names in a way that allows harvesting of data by outside
               parties. For example, if per-user keys are issued, the domain
               owner will need to make the decision as to whether to associate
               this selector directly with the name of a registered end-user,
               or make it some unassociated random value, such as a
               fingerprint of the public key. </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>The ability to reuse a selector
                           with a new key (for example, changing the key
                           associated with a user's name) makes it impossible
                           to tell the difference between data that didn't
                           verify because the key is no longer valid versus a
                           data that is actually forged. For this reason,
                           signers are ill-advised to reuse selectors for new
                           keys. A better strategy is to assign new keys to
                           new selectors.
</dd>
</dl></blockquote>

</blockquote>

<a name="dnsbind"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
DNS Binding for Key Retrieval {rfc4871bis-02 3.6.2}</h3>

<p>This section defines a binding using DNS TXT records as a key
               service. All implementations MUST support this binding.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.1"></a><h3>3.5.1.&nbsp;
Namespace</h3>

<p>A DOSETA key is stored in a subdomain named: </p>
<blockquote class="text">
<p>
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>dns-record</dfn> =  <cite class='id'>s</cite> "<span class='str'>._domainkey.</span>" <cite class='id'>d</cite></pre></div> where: 
<blockquote class="text"><dl>
<dt>s:  </dt>
<dd>is the selector of the lookup as
                              specified in the "s=" tag (<a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>)
</dd>
<dt>d:  </dt>
<dd>is the domain of the signature,
                              as specified in the "d=" tag (<a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>)
</dd>
</dl></blockquote>

</blockquote><p>
                  </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>The string constant "_domainkey" is
                        used to mark a sub-tree that contains unified DOSETA
                        key information. This string is a constant, rather
                        than being a different string for different key-based
                        services, in the view that keys are agnostic about the
                        service they are used for. That is, there is no
                        semantic or security benefit in having a different
                        constant string for different key services.
</dd>
</dl></blockquote>

<p>Given a DOSETA&#8209;Signature field with a "d=" tag of
                  "example.com" and an "s=" tag of "foo.bar", the DNS query
                  will be for: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>foo.bar._domainkey.example.com</pre></div><p>

</p>
<p>Wildcard DNS records (for example,
                  *.bar._domainkey.example.com) do not make sense in this
                  context and SHOULD not be used. Note also that wildcards
                  within domains (for example, s._domainkey.*.example.com) are
                  not supported by the DNS.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.2"></a><h3>3.5.2.&nbsp;
Resource Record Types for Key Storage</h3>

<p>The DNS Resource Record type used is specified by an option
                  to the query-type ("q=") tag. The only option defined in
                  this base specification is "txt", indicating the use of a
                  TXT Resource Record (RR). A later extension of this standard
                  might define another RR type.
</p>
<p>Strings in a TXT RR MUST be concatenated together before use
                  with no intervening whitespace. TXT RRs MUST be unique for a
                  particular selector name; that is, if there are multiple
                  records in an RRset, the results are undefined.
</p>
<p>TXT RRs are encoded as described in <a class='info' href='#keydata'>Section&nbsp;3.6<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset, with preface}</span><span>)</span></a>.
</p>
<a name="keydata"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Stored Key Data {rfc4871bis-02 3.6.1, subset, with preface}</h3>

<p>This section defines a syntax for encoding stored key data
               within an unstructured environment such as simple text. </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>TEMPLATE:  </dt>
<dd>(Key Retrieval) A service
                           that incorporates DOSETA MAY define the specific
                           mechanism by which Consumers can obtain associated
                           public keys. This might be as easy as referencing
                           an existing key management system or it might
                           require a new set of conventions.
</dd>
<dt></dt>
<dd>Absent an explicit specification for key retrieval,
                           the default mechanism is specified in <a class='info' href='#dnsbind'>Section&nbsp;3.5<span> (</span><span class='info'>DNS Binding for Key Retrieval {rfc4871bis-02 3.6.2}</span><span>)</span></a>.
</dd>
</dl></blockquote>

</blockquote><p>
            
</p>
<p>The overall syntax is a tag-list as described in <a class='info' href='#tagval'>Section&nbsp;3.2<span> (</span><span class='info'>Tag=Value Parameters {rfc4871bis-02 3.2}</span><span>)</span></a>. The current valid tags are described
               below. Other tags MAY be present and MUST be ignored by any
               implementation that does not understand them.
</p>
<p>
               </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>v=</dt>
<dd>
                           Version of the DOSETA key
                           record (plain-text; RECOMMENDED, default is
                           "DKIM1"). If specified, this tag MUST be set to
                           "DKIM1" (without the quotes). This tag MUST be the
                           first tag in the record. Records beginning with a
                           "v=" tag with any other value MUST be discarded.
                           Note that verifiers MUST do a string comparison on
                           this value; for example, "DKIM1" is not the same as
                           "DKIM1.0". 
<blockquote class="text"><dl>
<dt></dt>
<dd>ABNF: <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>key-v-tag</dfn>    = <span class='val'>%x76</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <span class='val'>%x44</span> <span class='val'>%x4B</span> <span class='val'>%x49</span> <span class='val'>%x4D</span> <span class='val'>%x31</span></pre></div>
</dd>
</dl></blockquote>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>The version string "DKIM1"
                                 is retained from the original DKIM
                                 specification, in order to preserve the
                                 installed base of records. In addition, there
                                 is no functional benefit in defining a new
                                 string, since the key record is not
                                 application-specific.
</dd>
</dl></blockquote>
                        
</dd>
<dt>k=  </dt>
<dd>Key type (plain-text; OPTIONAL,
                           default is "rsa"). Signers and verifiers MUST
                           support the "rsa" key type. The "rsa" key type
                           indicates that an ASN.1 DER-encoded <a class='info' href='#ITU-X660-1997'>[ITU&#8209;X660&#8209;1997]<span> (</span><span class='info'>, &ldquo;Information Technology - ASN.1 encoding rules:                   Specification of Basic Encoding Rules (BER), Canonical                   Encoding Rules (CER) and Distinguished Encoding Rules                   (DER),&rdquo; 1997.</span><span>)</span></a> RSAPublicKey <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA                   Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a> (see Sections <a class='info' href='#selectors'>Section&nbsp;3.4<span> (</span><span class='info'>Selectors for Keys {rfc4871bis-02 3.1}</span><span>)</span></a> and A.1.1) is being used in
                           the "p=" tag. (Note: the "p=" tag further encodes
                           the value using the base64 algorithm.)  Unrecognized key types MUST be
                           ignored. 
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>key-k-tag</dfn>        = <span class='val'>%x76</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>key-k-tag-type</cite>
<dfn>key-k-tag-type</dfn>   = "<span class='str'>rsa</span>" / <cite class='id'>x-key-k-tag-type</cite>
<dfn>x-key-k-tag-type</dfn> = <cite class='id'>hyphenated-word</cite>   <em>; for future extension</em></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt>n=  </dt>
<dd>Notes that might be of interest to
                           a human (qp-section; OPTIONAL, default is empty).
                           No interpretation is made by any program. This tag
                           should be used sparingly in any key server
                           mechanism that has space limitations (notably DNS).
                           This is intended for use by administrators, not end
                           users.
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>key-n-tag</dfn>    = <span class='val'>%x6e</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>qp-section</cite></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt>p=  </dt>
<dd>Public-key data (base64; REQUIRED).
                           An empty value means that this public key has been
                           revoked. The syntax and semantics of this tag value
                           before being encoded in base64 are defined by the
                           "k=" tag. 
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>key-p-tag</dfn>    = <span class='val'>%x70</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [ [<cite class='id'>FWS</cite>] <cite class='id'>base64string</cite>]</pre></div>
</dd>
</dl></blockquote>
                           
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>If a private key has been
                                 compromised or otherwise disabled (for
                                 example, an outsourcing contract has been
                                 terminated), a signer might want to
                                 explicitly state that it knows about the
                                 selector, but also have all queries using
                                 that selector result in a failed
                                 verification. Verifiers SHOULD ignore any
                                 DOSETA&#8209;Signature header fields with a
                                 selector referencing a revoked key.
</dd>
<dt>NOTE: </dt>
<dd>A base64string is permitted
                                 to include white space (FWS) at arbitrary
                                 places; however, any CRLFs MUST be followed
                                 by at least one WSP character. Implementors
                                 and administrators are cautioned to ensure
                                 that selector TXT records conform to this
                                 specification.
</dd>
</dl></blockquote>
                        
</dd>
</dl></blockquote>

</blockquote><p>
            
</p>
<a name="template"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
DOSETA H/C Signing Template</h3>

<p>This section specifies the basic components of a signing
            mechanism, which is similar to the one defined for DKIM. This
            template for a signing service can be mapped to a two-part --
            header/content -- data model. As with DKIM it separates
            specification of the signer's identity from any other identifiers
            that might be associated with that data.</p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>The use of hashing and signing
                        algorithms by DOSETA inherently provides a degree of
                        data integrity protection, between the signing and
                        verifying steps. However it does not necessarily
                        "authenticate" the data that is signed. For example,
                        it does not inherently validate the accuracy of the
                        data or declare that the signer is the author or owner
                        of the data.
</dd>
<dt>TEMPLATE:  </dt>
<dd>(Header/Content Mapping) The
                        service incorporating this mechanism MUST define the
                        precise mappings onto the template provided in this
                        section. (Note that data lacking a header component
                        might still be possible to cast in a header/content
                        form, where the header comprises on the DOSETA
                        Signature information.)
</dd>
<dt></dt>
<dd>The service also MUST define the precise
                        meaning of a signature.
</dd>
</dl></blockquote>

</blockquote>

<a name="cryptoalgs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Cryptographic Algorithms {rfc4871bis-02 3.3, subset}</h3>

<p>DOSETA supports multiple digital signature algorithms:
               
            
</p>
<p>
               </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>rsa-sha1:  </dt>
<dd> The rsa-sha1 Signing
                           Algorithm computes a message hash as described in <a class='info' href='#sigcalc'>Section&nbsp;4.3<span> (</span><span class='info'>Signature Calculation {rfc4871bis-02 3.7, reorganized and clarified}</span><span>)</span></a> below using SHA-1 <a class='info' href='#FIPS-180-2-2002'>[FIPS&#8209;180&#8209;2&#8209;2002]<span> (</span><span class='info'>U.S. Department of Commerce, &ldquo;Secure Hash Standard,&rdquo; August&nbsp;2002.</span><span>)</span></a> as a hashing
                           algorithm. That hash is then signed by the signer
                           using the RSA algorithm (defined in PKCS#1 version
                           1.5 <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA                   Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a>) as the crypt-alg and the
                           signer's private key. The hash MUST NOT be
                           truncated or converted into any form other than the
                           native binary form before being signed. The signing
                           algorithm SHOULD use a public exponent of
                           65537.
</dd>
<dt>rsa-sha256:  </dt>
<dd> The rsa-sha256 Signing
                           Algorithm computes a message hash as described in <a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message                   Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a> below using SHA-256 <a class='info' href='#FIPS-180-2-2002'>[FIPS&#8209;180&#8209;2&#8209;2002]<span> (</span><span class='info'>U.S. Department of Commerce, &ldquo;Secure Hash Standard,&rdquo; August&nbsp;2002.</span><span>)</span></a> as the hash-alg. That
                           hash is then signed by the signer using the RSA
                           algorithm (defined in PKCS#1 version 1.5 <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA                   Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a>) as the crypt-alg and the
                           signer's private key. The hash MUST NOT be
                           truncated or converted into any form other than the
                           native binary form before being signed.
</dd>
<dt>Other:  </dt>
<dd> Other algorithms MAY be
                           defined in the future. Verifiers MUST ignore any
                           signatures using algorithms that they do not
                           implement.
</dd>
</dl></blockquote>

</blockquote><p> Signers MUST implement and SHOULD sign using
               rsa-sha256. Verifiers MUST implement rsa-sha256. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>Although sha256 is strongly
                     encouraged, some senders of low-security messages (such
                     as routine newsletters) might prefer to use sha1 because
                     of reduced CPU requirements to compute a sha1 hash. In
                     general, sha256 is always preferred, whenever
                     possible.
</dd>
</dl></blockquote>

<p>Selecting appropriate key sizes is a trade-off between cost,
               performance, and risk. Since short RSA keys more easily succumb
               to off-line attacks, signers MUST use RSA keys of at least 1024
               bits for long-lived keys. Verifiers MUST be able to validate
               signatures with keys ranging from 512 bits to 2048 bits, and
               they MAY be able to validate signatures with larger keys.
               Verifier policies might use the length of the signing key as
               one metric for determining whether a signature is
               acceptable.
</p>
<p>Factors that ought to influence the key size choice include the
               following: </p>
<ul class="text">
<li>The practical constraint that large (for example, 4096
                     bit) keys might not fit within a 512-byte DNS UDP
                     response packet
</li>
<li>The security constraint that keys smaller than 1024 bits
                     are subject to off-line attacks
</li>
<li>Larger keys impose higher CPU costs to verify and sign
                     data
</li>
<li>Keys can be replaced on a regular basis, thus their
                     lifetime can be relatively short
</li>
<li>The security goals of this specification are modest
                     compared to typical goals of other systems that employ
                     digital signatures
</li>
</ul>

<p>See <a class='info' href='#RFC3766'>[RFC3766]<span> (</span><span class='info'>Orman, H. and P. Hoffman, &ldquo;Determining Strengths For Public Keys Used For                   Exchanging Symmetric Keys,&rdquo; April&nbsp;2004.</span><span>)</span></a> for further discussion on selecting key
               sizes.
</p>
<a name="signeddatastruct"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Signature Data Structure {rfc4871bis-02 3.5, subset}</h3>

<p>A signature of data is stored into an data structure associated
               with the signed data. This structure contains all of the
               signature and key&#8209;fetching data. This
               DOSETA&#8209;Signature structure is a tag-list as defined in <a class='info' href='#tagval'>Section&nbsp;3.2<span> (</span><span class='info'>Tag=Value Parameters {rfc4871bis-02 3.2}</span><span>)</span></a>. </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>TEMPLATE:  </dt>
<dd>(Signature Association) A
                           service that incorporates DOSETA MUST define the
                           exact means by which the Signature structure is
                           associated with the data.
</dd>
</dl></blockquote>

</blockquote>

<p>When the DOSETA&#8209;Signature is part of a sequence of
               structures -- such as being added to an email header -- it
               SHOULD NOT be reordered and SHOULD be prepended to the message.
               (This is the same handling as is given to email trace Header
               fields, defined in Section&nbsp;3.6 of <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>.) 
</p>
<p>The tags are specified below. Tags described as
               &lt;qp-section&gt; are encoded as described in Section&nbsp;6.7
               of MIME Part One <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail                   Extensions (MIME) Part One: Format of Internet Message                   Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a>, with the additional conversion of
               semicolon characters to "=3B"; intuitively, this is one line of
               quoted-printable encoded text. The D-quoted-printable syntax is
               defined in <a class='info' href='#D-quoted-printable'>Section&nbsp;2.3.4<span> (</span><span class='info'>D-Quoted-Printable</span><span>)</span></a>.
</p>
<p>Tags on the DOSETA&#8209;Signature structure along with their
               type and requirement status are shown below. Unrecognized tags
               MUST be ignored. </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>v=  </dt>
<dd>Version (MUST be included). This
                           tag defines the version of this specification that
                           applies to the signature record. It MUST have the
                           value "1". Note that verifiers MUST do a string
                           comparison on this value; for example, "1" is not
                           the same as "1.0". 
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>sig-v-tag</dfn>       = <span class='val'>%x76</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] "<span class='str'>1</span>"</pre></div>
</dd>
</dl></blockquote>
                           
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>DOSETA&#8209;Signature
                                 version numbers are expected to increase
                                 arithmetically as new versions of this
                                 specification are released.
</dd>
</dl></blockquote>
                        
</dd>
<dt>a=  </dt>
<dd>The algorithm used to generate the
                           signature (plain-text; REQUIRED). Verifiers MUST
                           support "rsa-sha1" and "rsa-sha256"; signers SHOULD
                           sign using "rsa-sha256". See <a class='info' href='#cryptoalgs'>Section&nbsp;4.1<span> (</span><span class='info'>Cryptographic Algorithms {rfc4871bis-02 3.3, subset}</span><span>)</span></a> for a description of
                           algorithms.
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
<dfn>sig-a-tag</dfn>       = <span class='val'>%x61</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>sig-a-tag-alg</cite>
<dfn>sig-a-tag-alg</dfn>   = <cite class='id'>sig-a-tag-k</cite> "<span class='str'>-</span>" <cite class='id'>sig-a-tag-h</cite>
<dfn>sig-a-tag-k</dfn>     = "<span class='str'>rsa</span>" / <cite class='id'>x-sig-a-tag-k</cite>
<dfn>sig-a-tag-h</dfn>     = "<span class='str'>sha1</span>" / "<span class='str'>sha256</span>" / <cite class='id'>x-sig-a-tag-h</cite>
<dfn>x-sig-a-tag-k</dfn>   = <cite class='key'>ALPHA</cite> <span class='rep'>*</span>(<cite class='key'>ALPHA</cite> / <cite class='key'>DIGIT</cite>)
                     <em>; for later extension</em>
<dfn>x-sig-a-tag-h</dfn>   = <cite class='key'>ALPHA</cite> <span class='rep'>*</span>(<cite class='key'>ALPHA</cite> / <cite class='key'>DIGIT</cite>)
                     <em>; for later extension</em></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt>b=  </dt>
<dd>The signature data (base64;
                           REQUIRED). Whitespace is ignored in this value and
                           MUST be ignored when reassembling the original
                           signature. In particular, the signing process can
                           safely insert FWS in this value in arbitrary places
                           to conform to line-length limits. See Signer
                           Actions (<a class='info' href='#signer'>Section&nbsp;4.4<span> (</span><span class='info'>Signer Actions {rfc4871bis-02 5}</span><span>)</span></a>) for how the signature is
                           computed.
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>sig-b-tag</dfn>       = <span class='val'>%x62</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>sig-b-tag-data</cite>
<dfn>sig-b-tag-data</dfn>  = <cite class='id'>base64string</cite></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt>bh=  </dt>
<dd>The hash of the canonicalized
                           Content (body), as limited by the "l=" tag (base64;
                           REQUIRED). Whitespace is ignored in this value and
                           MUST be ignored when reassembling the original
                           signature. In particular, the signing process can
                           safely insert FWS in this value in arbitrary places
                           to conform to line-length limits. See <a class='info' href='#sigcalc'>Section&nbsp;4.3<span> (</span><span class='info'>Signature Calculation {rfc4871bis-02 3.7, reorganized and clarified}</span><span>)</span></a> for how the Content hash is
                           computed. 
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>sig-bh-tag</dfn>      = <span class='val'>%x62</span> <span class='val'>%x68</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>sig-bh-tag-data</cite>
<dfn>sig-bh-tag-data</dfn> = <cite class='id'>base64string</cite></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt>c=  </dt>
<dd>Message canonicalization
                           (plain-text; OPTIONAL, default is "simple/simple").
                           This tag informs the verifier of the type of
                           canonicalization used to prepare the message for
                           signing. It consists of two names separated by a
                           "slash" (%d47) character, corresponding to the
                           header and Content canonicalization algorithms
                           respectively: 
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>sig-bh-tag</dfn>      = <span class='val'>%x63</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>sig-c-header</cite> "<span class='str'>/</span>" <cite class='id'>sig-c-content</cite></pre></div> where:
<blockquote class="text"><dl>
<dt>sig-c-header:  </dt>
<dd>A value from
                                       IANA registry defined in <a class='info' href='#hdrcanonreg'>Table&nbsp;2<span> (</span><span class='info'>DKIM&nbhy;Signature Header Canonicalization Algorithm                Registry                Initial Values</span><span>)</span></a>
</dd>
<dt>sig-c-content:  </dt>
<dd>A value
                                       from IANA registry defined in <a class='info' href='#bodcanonreg'>Table&nbsp;3<span> (</span><span class='info'>DKIM&nbhy;Signature Body Canonicalization Algorithm                Registry                Initial Values</span><span>)</span></a>
</dd>
</dl></blockquote>
                              
</dd>
</dl></blockquote> These algorithms are described in <a class='info' href='#canon'>Section&nbsp;3.1<span> (</span><span class='info'>Canonicalization {rfc4871bis-02 3.4}</span><span>)</span></a>. If only one algorithm is
                           named, that algorithm is used for the header and
                           "simple" is used for the Content. For example,
                           "c=relaxed" is treated the same as
                           "c=relaxed/simple".
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>sig-c-tag</dfn>       = <span class='val'>%x63</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>sig-c-tag-alg</cite>
                  ["<span class='str'>/</span>" <cite class='id'>sig-c-tag-alg</cite>]
<dfn>sig-c-tag-alg</dfn>   = "<span class='str'>simple</span>" / "<span class='str'>relaxed</span>" / <cite class='id'>x-sig-c-tag-alg</cite>
<dfn>x-sig-c-tag-alg</dfn> = <cite class='id'>hyphenated-word</cite>    <em>; for later extension</em></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt>d=  </dt>
<dd>The SDID doing the signing
                           (plain-text; REQUIRED). Hence, the SDID value is
                           used to form the query for the public key. The SDID
                           MUST correspond to a valid DNS name under which the
                           DOSETA key record is published. The conventions and
                           semantics used by a signer to create and use a
                           specific SDID are outside the scope of the DOSETA
                           Signing specification, as is any use of those
                           conventions and semantics. When presented with a
                           signature that does not meet these requirements,
                           verifiers MUST consider the signature invalid.
</dd>
<dt></dt>
<dd>Internationalized domain names MUST be encoded as
                           described in <a class='info' href='#RFC5890'>[RFC5890]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalizing Domain Names in Applications (IDNA):                   Definitions and Document Framework,&rdquo; August&nbsp;2010.</span><span>)</span></a>.
</dd>
<dt></dt>
<dd>
<blockquote class="text"><dl>
<dt></dt>
<dd>
<blockquote class="text"><dl>
<dt>TEMPLATE:  </dt>
<dd>(Semantics) The
                                       service incorporating DOSETA MUST
                                       define the semantics of a
                                       signature.
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
<dfn>sig-d-tag</dfn>       = <span class='val'>%x64</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>domain-name</cite>
<dfn>domain-name</dfn>     = <cite class='id'>sub-domain</cite> <span class='rep'>1*</span>("<span class='str'>.</span>" <cite class='id'>sub-domain</cite>)
                     <em>; from RFC 5321 Domain, </em>
                     <em>; but excluding address-literal</em></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt>h=  </dt>
<dd>Signed Header fields (plain-text,
                           but see description; REQUIRED). A colon-separated
                           list of header field names that identify the Header
                           fields presented to the signing algorithm. The
                           field MUST contain the complete list of Header
                           fields in the order presented to the signing
                           algorithm. The field MAY contain names of Header
                           fields that do not exist when signed; nonexistent
                           Header fields do not contribute to the signature
                           computation (that is, they are treated as the null
                           input, including the header field name, the
                           separating colon, the header field value, and any
                           CRLF terminator). The field MUST NOT include the
                           DOSETA Signature header field that is being created
                           or verified, but might include others. Folding
                           whitespace (FWS) MAY be included on either side of
                           the colon separator. Header field names MUST be
                           compared against actual header field names in a
                           case-insensitive manner. This list MUST NOT be
                           empty. See <a class='info' href='#fields2sign'>Section&nbsp;4.4.4<span> (</span><span class='info'>Determine the Header Fields to Sign</span><span>)</span></a> for a discussion of
                           choosing Header fields to sign.
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>sig-h-tag</dfn>       = <span class='val'>%x68</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>hdr-name</cite>
                   <span class='rep'>0*</span>( [<cite class='id'>FWS</cite>] "<span class='str'>:</span>" [<cite class='id'>FWS</cite>] <cite class='id'>hdr-name</cite> )</pre></div>
</dd>
</dl></blockquote>
</dd>
<dt></dt>
<dd>By "signing" Header fields that do not actually
                           exist, a signer can prevent insertion of those
                           Header fields before verification. However, since a
                           signer cannot possibly know all possible Header
                           fields that might be created in the future, the
                           security of this solution is not total.
</dd>
<dt></dt>
<dd>The exclusion of the header field name and colon as
                           well as the header field value for non-existent
                           Header fields prevents an attacker from inserting
                           an actual header field with a null value.
</dd>
<dt>q=  </dt>
<dd>A colon-separated list of query
                           methods used to retrieve the public key
                           (plain-text; OPTIONAL, default is "dns/txt"). Each
                           query method is of the form "type[/options]", where
                           the syntax and semantics of the options depend on
                           the type and specified options. If there are
                           multiple query mechanisms listed, the choice of
                           query mechanism MUST NOT change the interpretation
                           of the signature. Implementations MUST use the
                           recognized query mechanisms in the order presented.
                               Unrecognized query
                           mechanisms MUST be ignored. 
</dd>
<dt></dt>
<dd>Currently, the only valid value is "dns/txt", which
                           defines the DNS TXT record lookup algorithm
                           described elsewhere in this document. The only
                           option defined for the "dns" query type is "txt",
                           which MUST be included. Verifiers and signers MUST
                           support "dns/txt".
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>sig-q-tag</dfn>        = <span class='val'>%x71</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>sig-q-tag-method</cite>
                      <span class='rep'>*</span>([<cite class='id'>FWS</cite>] "<span class='str'>:</span>" [<cite class='id'>FWS</cite>] <cite class='id'>sig-q-tag-method</cite>)
<dfn>sig-q-tag-method</dfn> = "<span class='str'>dns/txt</span>" / <cite class='id'>x-sig-q-tag-type</cite>
                   ["<span class='str'>/</span>" <cite class='id'>x-sig-q-tag-args</cite>]
<dfn>x-sig-q-tag-type</dfn> = <cite class='id'>hyphenated-word</cite>  <em>; for future extension</em>
<dfn>x-sig-q-tag-args</dfn> = <cite class='id'>qp-hdr-value</cite></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt>s=  </dt>
<dd>The selector subdividing the
                           namespace for the "d=" (domain) tag (plain-text;
                           REQUIRED).
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>sig-s-tag</dfn>    = <span class='val'>%x73</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <cite class='id'>selector</cite></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt>t=  </dt>
<dd>Signature Timestamp (plain-text
                           unsigned decimal integer; RECOMMENDED, default is
                           an unknown creation time). The time that this
                           signature was created. The format is the number of
                           seconds since 00:00:00 on January 1, 1970 in the
                           UTC time zone. The value is expressed as an
                           unsigned integer in decimal ASCII. This value is
                           not constrained to fit into a 31- or 32-bit
                           integer. Implementations SHOULD be prepared to
                           handle values up to at least 10^12 (until
                           approximately AD 200,000; this fits into 40 bits).
                           To avoid denial-of-service attacks, implementations
                           MAY consider any value longer than 12 digits to be
                           infinite. Leap seconds are not counted.
                           Implementations MAY ignore signatures that have a
                           timestamp in the future.
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>sig-t-tag</dfn>    = <span class='val'>%x74</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>] <span class='rep'>1*12</span><cite class='key'>DIGIT</cite></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
<dt>x=  </dt>
<dd>Signature Expiration (plain-text
                           unsigned decimal integer; RECOMMENDED, default is
                           no expiration). The format is the same as in the
                           "t=" tag, represented as an absolute date, not as a
                           time delta from the signing timestamp. The value is
                           expressed as an unsigned integer in decimal ASCII,
                           with the same constraints on the value in the "t="
                           tag. Signatures MAY be considered invalid if the
                           verification time at the verifier is past the
                           expiration date. Ideally verification time is when
                           a message is first received at the administrative
                           domain of the verifier; otherwise the current time
                           SHOULD be used. The value of the "x=" tag MUST be
                           greater than the value of the "t=" tag if both are
                           present.
</dd>
<dt></dt>
<dd>
                           
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>The "x=" tag is not
                                 intended as an anti-replay defense.
</dd>
<dt>NOTE: </dt>
<dd>
                                 Due to clock drift,
                                 the receiver's notion of when to consider the
                                 signature expired might not match exactly
                                 when the sender is expecting. Receivers MAY
                                 add a 'fudge factor' to allow for such
                                 possible drift. 
</dd>
<dt></dt>
<dd>
                                 
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><dfn>sig-x-tag</dfn>    = <span class='val'>%x78</span> [<cite class='id'>FWS</cite>] "<span class='str'>=</span>" [<cite class='id'>FWS</cite>]
               <span class='rep'>1*12</span><cite class='key'>DIGIT</cite></pre></div>
                              
</dd>
</dl></blockquote>
                        
</dd>
</dl></blockquote>

</blockquote>

<a name="sigcalc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Signature Calculation {rfc4871bis-02 3.7, reorganized and clarified}</h3>

<p>Hashing and Cryptographic algorithms are combined into a
               procedure for computing a digital signature. 
</p>
<p>Creators will choose appropriate parameters for the signing
               process; Creators will use the tags that are then passed as an
               associated DOSETA Header field. <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a> defines the contents of the
               Header field.
</p>
<p>In the following discussion, the names of the tags in the
               Header field that either exist (when consuming) or will be
               created (when creating) are used. </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd> Canonicalization (see <a class='info' href='#canon'>Section&nbsp;3.1<span> (</span><span class='info'>Canonicalization {rfc4871bis-02 3.4}</span><span>)</span></a>) prepares a separate
                           representation of the data for additional
                           processing; it does not affect the transmitted data
                           in any way.
</dd>
</dl></blockquote>

</blockquote>

<p>Creators MUST compute hashes in the order defined. Consumers
               MAY compute them in any order convenient to the Creator,
               provided that the result is semantically identical to the
               semantics that would be the case had they been computed in this
               order.
</p>
<p>The combined hashing algorithm is: </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Step 1:  </dt>
<dd>The Creator/Creator hashes the
                           Content portion, canonicalized using the Content
                           canonicalization algorithm specified in the "c="
                           tag and then truncated to the length specified in
                           the "l=" tag. That hash value is then converted to
                           base64 form. Signers then insert it into the "bh="
                           tag of the DOSETA&#8209;Signature field; verifiers
                           compare their hash with the value in the "bh="
                           tag.
</dd>
<dt>Step 2:  </dt>
<dd>Pass the following to a second
                           hash algorithm in the indicated order: 
<ul class="text">
<li>Complete attribute:value Header fields
                                 specified by the "h=" tag, in the order
                                 specified in that tag, and canonicalized
                                 using the Header canonicalization algorithm
                                 specified in the "c=" tag. Each field MUST be
                                 terminated with a single CRLF. 
</li>
<li>The DOSETA&#8209;Signature field that exists
                                 (verifying), or will be inserted (signing),
                                 in the Header, with the value of the "b="
                                 signature data tag (including all surrounding
                                 whitespace) deleted (that is, treated as the
                                 empty string), canonicalized using the Header
                                 canonicalization algorithm specified in the
                                 "c=" tag, and without a trailing CRLF. 
</li>
<li>The hash produced in Step 1.
</li>
</ul>
</dd>
</dl></blockquote>

</blockquote><p>
            
</p>
<p>When calculating or verifying a signature, the value of the
               "b=" tag (signature value) of that DOSETA&#8209;Signature
               structure MUST be treated as though it were an empty string.
               Unknown tags in the DOSETA&#8209;Signature header field MUST be
               included in the signature calculation but MUST be otherwise
               ignored by verifiers.
               
               Other DOSETA&#8209;Signature tags that are included in the
               signature SHOULD be treated as normal tags; in particular, the
               "b=" tag is not treated specially.
</p>
<p>All tags and their values in the DOSETA&#8209;Signature field
               are included in the cryptographic hash with the sole exception
               of the value portion of the "b=" (signature) tag, which MUST be
               treated as the null string. All tags MUST be included even if
               they might not be understood by the verifier. The
               DOSETA&#8209;Signature field MUST be presented to the hash
               algorithm after the Content. rather than with the rest of the
               Header fields and MUST be canonicalized as specified in the
               "c=" (canonicalization) tag. The DOSETA&#8209;Signature header
               structure MUST NOT be included in its own h= tag, although
               other DOSETA&#8209;Signature Header fields MAY be signed (see <a class='info' href='#multisig'>Section&nbsp;5<span> (</span><span class='info'>Semantics of Multiple Signatures {rfc4871bis-02 4}</span><span>)</span></a>).
</p>
<p>When calculating the hash on data that will be transmitted
               using additional encoding, such as base64 or quoted-printable,
               signers MUST compute the hash after the encoding. Likewise, the
               verifier MUST incorporate the values into the hash before
               decoding the base64 or quoted-printable text. However, the hash
               MUST be computed before transport level encodings such as SMTP
               "dot-stuffing" (the modification of lines beginning with a "."
               to avoid confusion with the SMTP end-of-message marker, as
               specified in <a class='info' href='#RFC5321'>[RFC5321]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; October&nbsp;2008.</span><span>)</span></a>).
</p>
<p>With the exception of the canonicalization procedure described
               in <a class='info' href='#canon'>Section&nbsp;3.1<span> (</span><span class='info'>Canonicalization {rfc4871bis-02 3.4}</span><span>)</span></a>, the DOSETA signing process treats the
               Content as simply a string of octets. DOSETA Content MAY be
               either in plain-text or in MIME format; no special treatment is
               afforded to MIME content. 
</p>
<p>More formally, the algorithm for the signature is as follows: </p>
<blockquote class="text">
<p>
<p>ABNF:
                           
                        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre><span class='err'>content-hash =  bh-hash-alg (canon-content, l-param)
data-hash    =  a-hash-alg (h-headers, D-SIG, content-hash)
signature    =  sig-alg (d-domain, selector, data-hash) </span></pre></div>

</blockquote><p>
            
</p>
<p>where: </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>content-hash:  </dt>
<dd>is the output of a
                           function to hash the data Content.
</dd>
<dt>bh-hash-alg:  </dt>
<dd>is the hashing algorithm
                           specified in the "bh" parameter.
</dd>
<dt>canon-body:  </dt>
<dd>is a canonicalized
                           representation of the body.
</dd>
<dt>l-param:  </dt>
<dd>is the value of the l= length
                           parameter.
</dd>
<dt>data-hash:  </dt>
<dd>is the output from hashing
                           the header, the DOSETA&#8209;Signature header, and
                           the Content hash.
</dd>
<dt>a-hash-alg:  </dt>
<dd>is the hash algorithm
                           specified by the "a=" tag, 
</dd>
<dt>h-headers:  </dt>
<dd>is the list of headers to
                           be signed, as specified in the h= parameter.
</dd>
<dt>D-SIG:  </dt>
<dd>is the canonicalized
                           DOSETA&#8209;Signature field sans the signature
                           value itself.
</dd>
<dt>canon-content:  </dt>
<dd>is the canonicalized
                           data Content(respectively) as defined in <a class='info' href='#canon'>Section&nbsp;3.1<span> (</span><span class='info'>Canonicalization {rfc4871bis-02 3.4}</span><span>)</span></a> (excluding the
                           DOSETA&#8209;Signature field). 
</dd>
<dt>signature:  </dt>
<dd>is the signature value
                           produced by the signing algorithm.
</dd>
<dt>sig-alg:  </dt>
<dd>is the signature algorithm
                           specified by the "a=" tag, 
</dd>
<dt>d-domain:  </dt>
<dd>is the domain name specified
                           in the d= parameter.
</dd>
<dt>selector:  </dt>
<dd>is the value of the s=
                           selector parameter
</dd>
</dl></blockquote>

</blockquote><p>
               </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>Many digital signature APIs provide
                     both hashing and application of the RSA private key using
                     last two steps in the algorithm would probably be
                     combined into a single call that would perform both the
                     "a-hash-alg" and the "sig-alg".
</dd>
</dl></blockquote>

<a name="signer"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Signer Actions {rfc4871bis-02 5}</h3>

<p>The following steps are performed in order by signers.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.1"></a><h3>4.4.1.&nbsp;
Determine Whether the Data Should Be Signed and by Whom</h3>

<p>A signer can obviously only sign data using domains for
                  which it has a private key and the necessary knowledge of
                  the corresponding public key and selector information.
                  However, there are a number of other reasons beyond the lack
                  of a private key why a signer could choose not to sign the
                  data. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>Signing modules can be incorporated
                        into any portion of a service, as deemed appropriate,
                        including end-systems, servers and intermediaries.
                        Wherever implemented, signers need to beware of the
                        semantics of signing data. An example of how this can
                        be problematic is that within a trusted enclave the
                        signing address might be derived from the data
                        according to local policy; the derivation is based on
                        local trust rather than explicit validation.
</dd>
</dl></blockquote>

<p>If the data cannot be signed for some reason, the
                  disposition of that data is a local policy decision.
</p>
<a name="selectpriv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.2"></a><h3>4.4.2.&nbsp;
Select a Private Key and Corresponding Selector Information</h3>

<p>This specification does not define the basis by which a
                  signer ought to choose which private key and selector
                  information to use. Currently, all selectors are equal, with
                  respect to this specification. So the choices ought to
                  largely be a matter of administrative convenience.
                  Distribution and management of private keys is also outside
                  the scope of this document. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>A signer SHOULD use a private key
                        with an associated selector record that is expected to
                        still be valid by time the verifier is likely to have
                        an opportunity to validate the signature. The signer
                        SHOULD anticipate that verifiers can choose to defer
                        validation, perhaps until the message is actually read
                        by the final recipient. In particular, when rotating
                        to a new key pair, signing SHOULD immediately commence
                        with the new private key, but the old public key
                        SHOULD be retained for a reasonable validation
                        interval before being removed from the key server.
</dd>
</dl></blockquote>

<a name="normalize"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.3"></a><h3>4.4.3.&nbsp;
Normalize the Message to Prevent Transport Conversions</h3>

<p>Some messages, particularly those using 8-bit characters,
                  are subject to modification during transit, notably from
                  conversion to 7-bit form. Such conversions will break DOSETA
                  signatures. In order to minimize the chances of such
                  breakage, signers SHOULD convert the data to a suitable
                  encoding, such as quoted-printable or base64, as described
                  in <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail                   Extensions (MIME) Part One: Format of Internet Message                   Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a> before signing. Such conversion is
                  outside the scope of DOSETA; the data SHOULD be converted to
                  7-bit prior to presentation to the DOSETA signing
                  procedure.
</p>
<p>Similarly, data that is not compliant with its associated
                  standard, might be subject to corrective efforts
                  intermediaries. See Section 8 of <a class='info' href='#RFC4409'>[RFC4409]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a> for examples of changes that are
                  commonly made to email. Such "corrections" might break
                  DOSETA signatures or have other undesirable effects.
                  
               
</p>
<p>If the data is submitted to the signer with any local
                  encoding that will be modified before transmission, that
                  modification to a canonical form MUST be done before
                  signing. For Text data in particular, bare CR or LF
                  characters (used by some systems as a local line separator
                  convention) MUST be converted to the CRLF sequences before
                  the data is signed. Any conversion of this sort SHOULD be
                  applied to the data actually sent to the recipient(s), not
                  just to the version presented to the signing algorithm.
</p>
<p>More generally, the signer MUST sign the data as it is
                  expected to be received by the verifier rather than in some
                  local or internal form.
</p>
<a name="fields2sign"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.4"></a><h3>4.4.4.&nbsp;
Determine the Header Fields to Sign</h3>

<p>
                  
                  Signers SHOULD NOT sign an existing header field that is
                  likely to be legitimately modified or removed in transit.
                  
                  Signers MAY include any other Header fields present at the
                  time of signing at the discretion of the signer. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>The choice of which Header fields
                        to sign is non-obvious. One strategy is to sign all
                        existing, non-repeatable Header fields. An alternative
                        strategy is to sign only Header fields that are likely
                        to be displayed to or otherwise be likely to affect
                        the processing of the Content at the receiver. A third
                        strategy is to sign only "well known" headers. Note
                        that verifiers might treat unsigned Header fields with
                        extreme skepticism, including refusing to display them
                        to the end user or even ignoring the signature if it
                        does not cover certain Header fields. 
</dd>
</dl></blockquote>

<p> The DOSETA&#8209;Signature header field is always implicitly
                  signed and MUST NOT be included in the "h=" tag except to
                  indicate that other preexisting signatures are also
                  signed.
</p>
<p>Signers MAY claim to have signed Header fields that do not
                  exist (that is, signers MAY include the header field name in
                  the "h=" tag even if that header field does not exist in the
                  message). When computing the signature, the non-existing
                  header field MUST be treated as the null string (including
                  the header field name, header field value, all punctuation,
                  and the trailing CRLF). </p>
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>This allows signers to explicitly
                        assert the absence of a header field; if that header
                        field is added later the signature will fail.
</dd>
<dt>NOTE: </dt>
<dd>A header field name need only be
                        listed once more than the actual number of that header
                        field in a message at the time of signing in order to
                        prevent any further additions. For example, if there
                        is a single Comments header field at the time of
                        signing, listing Comments twice in the "h=" tag is
                        sufficient to prevent any number of Comments Header
                        fields from being appended; it is not necessary (but
                        is legal) to list Comments three or more times in the
                        "h=" tag.
</dd>
</dl></blockquote>

<p>Signers choosing to sign an existing header field that
                  occurs more than once in the message (such as Received) MUST
                  sign the physically last instance of that header field in
                  the header block. Signers wishing to sign multiple instances
                  of such a header field MUST include the header field name
                  multiple times in the h= tag of the DOSETA&#8209;Signature
                  header field, and MUST sign such Header fields in order from
                  the bottom of the header field block to the top. The signer
                  MAY include more instances of a header field name in h= than
                  there are actual corresponding Header fields to indicate
                  that additional Header fields of that name SHOULD NOT be
                  added. </p>
<blockquote class="text">
<p>EXAMPLE:
</p>
<p>If the signer wishes to sign two existing Received
                        Header fields, and the existing header contains: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>Received: &lt;A&gt;
Received: &lt;B&gt;
Received: &lt;c&gt;</pre></div><p>

                        
<p style='text-align: left'>then the resulting DOSETA&#8209;Signature
                              header field ought to read:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
DKIM-Signature: ... h=Received : Received :...</pre></div> and Received Header fields &lt;C&gt; and
                        &lt;B&gt; will be signed in that order.

</blockquote>

<p>Signers need to be careful of signing Header fields that
                  might have additional instances added later in the delivery
                  process, since such Header fields might be inserted after
                  the signed instance or otherwise reordered. Trace Header
                  fields (such as Received) and Resent-* blocks are the only
                  fields prohibited by <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a> from being reordered. In particular,
                  since DOSETA&#8209;Signature Header fields might be reordered
                  by some intermediate MTAs, signing existing
                  DOSETA&#8209;Signature Header fields is error-prone. </p>
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>Despite the fact that <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a> permits Header fields to be
                        reordered (with the exception of Received Header
                        fields), reordering of signed Header fields with
                        multiple instances by intermediate MTAs will cause
                        DOSETA signatures to be broken; such anti-social
                        behavior ought to be avoided.
</dd>
<dt>NOTE: </dt>
<dd>Although not required by this
                        specification, all end-user visible Header fields
                        SHOULD be signed to avoid possible "indirect
                        spamming". For example, if the Subject header field is
                        not signed, a spammer can resend a previously signed
                        mail, replacing the legitimate subject with a one-line
                        spam.
</dd>
</dl></blockquote>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.5"></a><h3>4.4.5.&nbsp;
Compute the Message Signature</h3>

<p>The signer MUST compute the message hash as described in <a class='info' href='#sigcalc'>Section&nbsp;4.3<span> (</span><span class='info'>Signature Calculation {rfc4871bis-02 3.7, reorganized and clarified}</span><span>)</span></a> and then sign it using the selected
                  public-key algorithm. This will result in a
                  DOSETA&#8209;Signature header field that will include the
                  Content hash and a signature of the header hash, where that
                  header includes the DOSETA&#8209;Signature header field
                  itself.
</p>
<p>Entities such as mailing list managers that implement DOSETA
                  and that modify the message or a header field (for example,
                  inserting unsubscribe information) before retransmitting the
                  message SHOULD check any existing signature on input and
                  MUST make such modifications before re-signing the
                  message.
</p>
<p> The signer MAY elect to limit the number of bytes of the
                  Content that will be included in the hash and hence signed.
                  The length actually hashed SHOULD be inserted in the "l="
                  tag of the DOSETA&#8209;Signature header field.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.6"></a><h3>4.4.6.&nbsp;
Insert the DOSETA&#8209;Signature Header Field</h3>

<p>Finally, the signer MUST insert the DOSETA&#8209;Signature
                  header field created in the previous step prior to
                  transmitting the data. The DOSETA&#8209;Signature header
                  field MUST be the same as used to compute the hash as
                  described above, except that the value of the "b=" tag MUST
                  be the appropriately signed hash computed in the previous
                  step, signed using the algorithm specified in the "a=" tag
                  of the DOSETA&#8209;Signature header field and using the
                  private key corresponding to the selector given in the "s="
                  tag of the DOSETA&#8209;Signature header field, as chosen
                  above in <a class='info' href='#selectpriv'>Section&nbsp;4.4.2<span> (</span><span class='info'>Select a Private Key and Corresponding Selector Information</span><span>)</span></a>
</p>
<p>The DOSETA&#8209;Signature header field MUST be inserted
                  before any other DOSETA&#8209;Signature fields in the header
                  block. </p>
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>The easiest way to achieve this is
                        to insert the DOSETA&#8209;Signature header field at
                        the beginning of the header block. In particular, it
                        might be placed before any existing Received Header
                        fields. This is consistent with treating
                        DOSETA&#8209;Signature as a trace header field.
</dd>
</dl></blockquote>

<a name="verifier"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Verifier Actions {rfc4871bis-02 6}</h3>

<p>Since a signer MAY remove or revoke a public key at any time,
               it is recommended that verification occur in a timely manner.
               In many configurations, the most timely place is during
               acceptance by the border MTA or shortly thereafter. In
               particular, deferring verification until the message is
               accessed by the end user is discouraged.
</p>
<p>A border or intermediate server MAY verify the data
               signature(s). An server that has performed verification MAY
               communicate the result of that verification by adding a
               verification header field to incoming data.
               
</p>
<p>A verifying server MAY implement a policy with respect to
               unverifiable data, regardless of whether or not it applies the
               verification header field to signed messages.
</p>
<p>Verifiers MUST produce a result that is semantically equivalent
               to applying the following steps in the order listed. In
               practice, several of these steps can be performed in parallel
               in order to improve performance.
</p>
<a name="extractsig"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.1"></a><h3>4.5.1.&nbsp;
Extract Signatures from the Message</h3>

<p> The order in which verifiers try DOSETA&#8209;Signature
                  Header fields is not defined; verifiers MAY try signatures
                  in any order they like. For example, one implementation
                  might try the signatures in textual order, whereas another
                  might try signatures by identities that match the contents
                  of the From header field before trying other signatures.
                  Verifiers MUST NOT attribute ultimate meaning to the order
                  of multiple DOSETA&#8209;Signature Header fields. In
                  particular, there is reason to believe that some relays will
                  reorder the Header fields in potentially arbitrary ways. </p>
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>Verifiers might use the order as a
                        clue to signing order in the absence of any other
                        information. However, other clues as to the semantics
                        of multiple signatures (such as correlating the
                        signing host with Received Header fields) might also
                        be considered.
</dd>
</dl></blockquote>

<p>A verifier SHOULD NOT treat a message that has one or more
                  bad signatures and no good signatures differently from a
                  message with no signature at all; such treatment is a matter
                  of local policy and is beyond the scope of this
                  document.
</p>
<p>When a signature successfully verifies, a verifier will
                  either stop processing or attempt to verify any other
                  signatures, at the discretion of the implementation. A
                  verifier MAY limit the number of signatures it tries to
                  avoid denial-of-service attacks. </p>
<blockquote class="text"><dl>
<dt>NOTE: </dt>
<dd>An attacker could send messages with
                        large numbers of faulty signatures, each of which
                        would require a DNS lookup and corresponding CPU time
                        to verify the message. This could be an attack on the
                        domain that receives the message, by slowing down the
                        verifier by requiring it to do a large number of DNS
                        lookups and/or signature verifications. It could also
                        be an attack against the domains listed in the
                        signatures, essentially by enlisting innocent
                        verifiers in launching an attack against the DNS
                        servers of the actual victim.
</dd>
</dl></blockquote>

<p>In the following description, text reading "return status
                  (explanation)" (where "status" is one of "PERMFAIL" or
                  "TEMPFAIL") means that the verifier MUST immediately cease
                  processing that signature. The verifier SHOULD proceed to
                  the next signature, if any is present, and completely ignore
                  the bad signature. If the status is "PERMFAIL", the
                  signature failed and SHOULD NOT be reconsidered. If the
                  status is "TEMPFAIL", the signature could not be verified at
                  this time but might be tried again later. A verifier MAY
                  either defer the message for later processing, perhaps by
                  queueing it locally or issuing a 451/4.7.5 SMTP reply, or
                  try another signature; if no good signature is found and any
                  of the signatures resulted in a TEMPFAIL status, the
                  verifier MAY save the message for later processing. The
                  "(explanation)" is not normative text; it is provided solely
                  for clarification.
</p>
<p>Verifiers SHOULD ignore any DOSETA&#8209;Signature Header
                  fields where the signature does not validate. Verifiers that
                  are prepared to validate multiple signature Header fields
                  SHOULD proceed to the next signature header field, if it
                  exists. However, verifiers MAY make note of the fact that an
                  invalid signature was present for consideration at a later
                  step. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>The rationale of this requirement
                        is to permit messages that have invalid signatures but
                        also a valid signature to work. For example, a mailing
                        list exploder might opt to leave the original
                        submitter signature in place even though the exploder
                        knows that it is modifying the message in some way
                        that will break that signature, and the exploder
                        inserts its own signature. In this case, the message
                        ought to succeed even in the presence of the
                        known-broken signature.
</dd>
</dl></blockquote>

<p>For each signature to be validated, the following steps need
                  to be performed in such a manner as to produce a result that
                  is semantically equivalent to performing them in the
                  indicated order.
</p>
<a name="validatesig"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.2"></a><h3>4.5.2.&nbsp;
Validate the Signature Header Field</h3>

<p>Implementers MUST meticulously validate the format and
                  values in the DOSETA&#8209;Signature header field; any
                  inconsistency or unexpected values MUST cause the header
                  field to be completely ignored and the verifier to return
                  PERMFAIL (signature syntax error). Being "liberal in what
                  you accept" is definitely a bad strategy in this security
                  context. Note however that this does not include the
                  existence of unknown tags in a DOSETA&#8209;Signature header
                  field, which are explicitly permitted. Verifiers MUST ignore
                  DOSETA&#8209;Signature Header fields with a "v=" tag that is
                  inconsistent with this specification and return PERMFAIL
                  (incompatible version). </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>An implementation might, of course,
                        choose to also verify signatures generated by older
                        versions of this specification.
</dd>
</dl></blockquote>

<p>If any tag listed as "required" in <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a> is omitted from the
                  DOSETA&#8209;Signature header field, the verifier MUST ignore
                  the DOSETA&#8209;Signature header field and return PERMFAIL
                  (signature missing required tag). </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>The tags listed as required in <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a> are "v=", "a=", "b=",
                        "bh=", "d=", "h=", and "s=". Should there be a
                        conflict between this note and <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>, is normative.
</dd>
</dl></blockquote>

<p>If the DOSETA&#8209;Signature header field does not contain
                  the "i=" tag, the verifier MUST behave as though the value
                  of that tag were "@d", where "d" is the value from the "d="
                  tag.
</p>
<p>Verifiers MUST confirm that the domain specified in the "d="
                  tag is the same as or a parent domain of the domain part of
                  the "i=" tag. If not, the DOSETA&#8209;Signature header field
                  MUST be ignored and the verifier SHOULD return PERMFAIL
                  (domain mismatch).
</p>
<p>If the "h=" tag does not include the From header field, the
                  verifier MUST ignore the DOSETA&#8209;Signature header field
                  and return PERMFAIL (From field not signed).
</p>
<p>Verifiers MAY ignore the DOSETA&#8209;Signature header field
                  and return PERMFAIL (signature expired) if it contains an
                  "x=" tag and the signature has expired.
</p>
<p>Verifiers MAY ignore the DOSETA&#8209;Signature header field
                  if the domain used by the signer in the "d=" tag is not
                  associated with a valid signing entity. For example,
                  signatures with "d=" values such as "com" and "co.uk" might
                  be ignored. The list of unacceptable domains SHOULD be
                  configurable.
</p>
<p>Verifiers MAY ignore the DOSETA&#8209;Signature header field
                  and return PERMFAIL (unacceptable signature header) for any
                  other reason, for example, if the signature does not sign
                  Header fields that the verifier views to be essential. As a
                  case in point, if MIME Header fields are not signed, certain
                  attacks might be possible that the verifier would prefer to
                  avoid.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.3"></a><h3>4.5.3.&nbsp;
Get the Public Key</h3>

<p>The public key for a signature is needed to complete the
                  verification process. The process of retrieving the public
                  key depends on the query type as defined by the "q=" tag in
                  the DOSETA&#8209;Signature header field. Obviously, a public
                  key need only be retrieved if the process of extracting the
                  signature information is completely successful. Details of
                  key management and representation are described in <a class='info' href='#keymgmt'>Section&nbsp;3.3<span> (</span><span class='info'>Key Management {rfc4871bis-02 3.6}</span><span>)</span></a>. The verifier MUST validate the key
                  record and MUST ignore any public key records that are
                  malformed.
</p>
<p>
                  </p>
<blockquote class="text"><dl>
<dt>NOTE:</dt>
<dd> The use of wildcard TXT records in
                        the DNS will produce a response to a DOSETA query that
                        is unlikely to be valid DOSETA key record. This
                        problem applies to many other types of queries, and
                        client software that processes DNS responses needs to
                        take this problem into account.
</dd>
</dl></blockquote><p>
               
</p>
<p>When validating a message, a verifier MUST perform the
                  following steps in a manner that is semantically the same as
                  performing them in the order indicated -- in some cases the
                  implementation might parallelize or reorder these steps, as
                  long as the semantics remain unchanged: </p>
<ol class="text">
<li>Retrieve the public key as described in <a class='info' href='#keymgmt'>Section&nbsp;3.3<span> (</span><span class='info'>Key Management {rfc4871bis-02 3.6}</span><span>)</span></a> using the algorithm in the "q="
                        tag, the domain from the "d=" tag, and the selector
                        from the "s=" tag.
</li>
<li>If the query for the public key fails to respond, the
                        verifier MAY defer acceptance of this data and return
                        TEMPFAIL - key unavailable. (If verification is
                        occurring during the incoming SMTP session, this MAY
                        be achieved with a 451/4.7.5 SMTP reply code.)
                        Alternatively, the verifier MAY store the message in
                        the local queue for later trial or ignore the
                        signature. Note that storing a message in the local
                        queue is subject to denial-of- service attacks.
</li>
<li> If the query for the public key fails because the
                        corresponding key record does not exist, the verifier
                        MUST immediately return PERMFAIL (no key for
                        signature).
</li>
<li>If the query for the public key returns multiple key
                        records, the verifier might choose one of the key
                        records or might cycle through the key records
                        performing the remainder of these steps on each record
                        at the discretion of the implementer. The order of the
                        key records is unspecified. If the verifier chooses to
                        cycle through the key records, then the "return ..."
                        wording in the remainder of this section means "try
                        the next key record, if any; if none, return to try
                        another signature in the usual way".
</li>
<li>If the result returned from the query does not adhere
                        to the format defined in this specification, the
                        verifier MUST ignore the key record and return
                        PERMFAIL (key syntax error). Verifiers are urged to
                        validate the syntax of key records carefully to avoid
                        attempted attacks. In particular, the verifier MUST
                        ignore keys with a version code ("v=" tag) that they
                        do not implement.
</li>
<li>If the "h=" tag exists in the public key record and
                        the hash algorithm implied by the a= tag in the
                        DOSETA&#8209;Signature header field is not included in
                        the contents of the "h=" tag, the verifier MUST ignore
                        the key record and return PERMFAIL (inappropriate hash
                        algorithm).
</li>
<li>If the public key data (the "p=" tag) is empty, then
                        this key has been revoked and the verifier MUST treat
                        this as a failed signature check and return PERMFAIL
                        (key revoked). There is no defined semantic difference
                        between a key that has been revoked and a key record
                        that has been removed.
</li>
<li>If the public key data is not suitable for use with
                        the algorithm and key types defined by the "a=" and
                        "k=" tags in the DOSETA&#8209;Signature header field,
                        the verifier MUST immediately return PERMFAIL
                        (inappropriate key algorithm).
</li>
</ol>

<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.4"></a><h3>4.5.4.&nbsp;
Compute the Verification</h3>

<p>Given a signer and a public key, verifying a signature
                  consists of actions semantically equivalent to the following
                  steps. </p>
<ol class="text">
<li>Based on the algorithm defined in the "c=" tag, the
                        Content length specified in the "l=" tag, and the
                        header field names in the "h=" tag, prepare a
                        canonicalized version of the Content as is described
                        in <a class='info' href='#sigcalc'>Section&nbsp;4.3<span> (</span><span class='info'>Signature Calculation {rfc4871bis-02 3.7, reorganized and clarified}</span><span>)</span></a> (note that this version does not
                        actually need to be instantiated). When matching
                        header field names in the "h=" tag against the actual
                        message header field, comparisons MUST be
                        case-insensitive.
</li>
<li>Based on the algorithm indicated in the "a=" tag,
                        compute the message hashes from the canonical copy as
                        described in <a class='info' href='#sigcalc'>Section&nbsp;4.3<span> (</span><span class='info'>Signature Calculation {rfc4871bis-02 3.7, reorganized and clarified}</span><span>)</span></a>
</li>
<li>Verify that the hash of the canonicalized Content
                        computed in the previous step matches the hash value
                        conveyed in the "bh=" tag. If the hash does not match,
                        the verifier SHOULD ignore the signature and return
                        PERMFAIL (Content hash did not verify).
</li>
<li> Using the signature conveyed in the "b=" tag, verify
                        the signature against the header hash using the
                        mechanism appropriate for the public key algorithm
                        described in the "a=" tag. If the signature does not
                        validate, the verifier SHOULD ignore the signature and
                        return PERMFAIL (signature did not verify).
</li>
<li>Otherwise, the signature has correctly verified.
</li>
</ol><p>
                  </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>Implementations might wish to
                        initiate the public-key query in parallel with
                        calculating the hash as the public key is not needed
                        until the final decryption is calculated.
                        Implementations might also verify the signature on the
                        message header before validating that the message hash
                        listed in the "bh=" tag in the DOSETA&#8209;Signature
                        header field matches that of the actual Content;
                        however, if the Content hash does not match, the
                        entire signature MUST be considered to have
                        failed.
</dd>
</dl></blockquote><p>
               
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.5"></a><h3>4.5.5.&nbsp;
Communicate Verification Results</h3>

<p>Verifiers wishing to communicate the results of verification
                  to other parts of the data handling system can do so in
                  whatever manner they see fit. For example, implementations
                  might choose to add a Header field to the data before
                  passing it on. Any such header field SHOULD be inserted
                  before any existing DOSETA&#8209;Signature or preexisting
                  verification status Header fields in the header field block.
                  The Authentication-Results: header field (<a class='info' href='#RFC5451'>[RFC5451]<span> (</span><span class='info'>Kucherawy, M., &ldquo;Message Header Field for Indicating Message                   Authentication Status,&rdquo; April&nbsp;2009.</span><span>)</span></a>) MAY be used for this purpose. </p>
<blockquote class="text">
<p>Patterns intended to search for results Header fields
                        to visibly mark authenticated data for end users
                        SHOULD verify that the header field was added by the
                        appropriate verifying
                        domain.
                        In particular,  filters SHOULD NOT be
                        influenced by bogus results header fields added by
                        attackers. To circumvent this attack, verifiers SHOULD
                        delete existing results Header fields after
                        verification and before adding a new header field.
</p>
</blockquote>

<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5.6"></a><h3>4.5.6.&nbsp;
Interpret Results/Apply Local Policy</h3>

<p>It is beyond the scope of this specification to describe
                  what actions an Assessment phase will take, but data with a
                  verified DOSETA signature presents an opportunity to an
                  Assessor that unsigned data does not. Specifically, signed
                  data creates a predictable identifier by which other
                  decisions can reliably be managed, such as trust and
                  reputation. Conversely, unsigned data typically lacks a
                  reliable identifier that can be used to assign trust and
                  reputation. It is usually reasonable to treat unsigned data
                  as lacking any trust and having no positive reputation.
</p>
<p>In general, verifiers SHOULD NOT reject data solely on the
                  basis of a lack of signature or an unverifiable signature;
                  such rejection would cause severe interoperability problems.
                  However, if the verifier does opt to reject such
                  data.
</p>
<p>Temporary failures such as inability to access the key
                  server or other external service are the only conditions
                  that SHOULD use a temporary failure code. In particular,
                  cryptographic signature verification failures MUST NOT
                  return temporary failure replies.
</p>
<p>Once the signature has been verified, that information MUST
                  be conveyed to the Assessor (such as an explicit
                  allow/whitelist and reputation system) and/or to the end
                  user. If the SDID is not the same as the address in the
                  From: header field, the data system SHOULD take pains to
                  ensure that the actual SDID is clear to the reader.
</p>
<p>The verifier MAY treat unsigned Header fields with extreme
                  skepticism, including marking them as untrusted or even
                  deleting
                  them.
</p>
<p>While the symptoms of a failed verification are obvious --
                  the signature doesn't verify -- establishing the exact cause
                  can be more difficult. If a selector cannot be found, is
                  that because the selector has been removed, or was the value
                  changed somehow in transit? If the signature line is
                  missing, is that because it was never there, or was it
                  removed by an overzealous filter? For diagnostic purposes,
                  the exact nature of a verification failure SHOULD be made
                  available to the policy module and possibly recorded in the
                  system logs. If the data cannot be verified, then it SHOULD
                  be rendered the same as all unverified data regardless of
                  whether or not it looks like it was signed.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Requirements for Tailoring the Signing Service {added}</h3>

<p>This generic template requires additional details, to define a
               specific service:</p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>D-Signature Association: </dt>
<dd>Specify the
                           means by which a DOSETA&#8209;Signature header field
                           is associated with the data it signs. For example,
                           DKIM uses the DKIM&#8209;Signature email header
                           field. If the header field is encoded differently
                           than defined for the DOSETA generic service, such
                           as in XML, then that also needs to be specified
                           including the algorithm for mapping between the
                           common encoding provided here and the new
                           encoding.
</dd>
<dt>Semantics Signaling:  </dt>
<dd>The means by
                           which a Consumer is to know what semantics apply
                           must be indicated. This is likely to be the same
                           means by which the Consumer knows what specific
                           service is being used. For example, different
                           service-specific DOSETA&#8209;Signature header
                           fields might be used. "DKIM&#8209;Signature" signals
                           a name-affixing service, while
                           "DKVM&#8209;Signature" might signal a message
                           validation service.
</dd>
<dt>Semantics:  </dt>
<dd>Define the meaning of a
                           signature. Note that exactly the same algorithms
                           might be used for very different semantics. One
                           might merely affix an identifier to some data, in a
                           verifiable fashion, while the same set of
                           mechanisms might separately be defined as
                           authenticating the validity of that data. 
</dd>
<dt>Header/Content Mapping:  </dt>
<dd>The mappings
                           between the generic service and data of a
                           particular service needs to be defined. For
                           example, with DKIM Header maps to the email header
                           and Content maps to the email body.
</dd>
</dl></blockquote>

</blockquote><p>
            
</p>
<a name="parentsig"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
Signing by Parent Domains {rfc4871bis-02 3.8}</h3>

<p>In some circumstances, it is desirable for a domain to apply a
               signature on behalf of any of its subdomains without the need
               to maintain separate selectors (key records) in each subdomain.
               By default, private keys corresponding to key records can be
               used to sign messages for any subdomain of the domain in which
               they reside; for example, a key record for the domain
               example.com can be used to verify messages where the AUID ("i="
               tag of the signature) is sub.example.com, or even
               sub1.sub2.example.com. In order to limit the capability of such
               keys when this is not intended, the "s" flag MAY be set in the
               "t=" tag of the key record, to constrain the validity of the
               domain of the AUID. If the referenced key record contains the
               "s" flag as part of the "t=" tag, the domain of the AUID ("i="
               flag) MUST be the same as that of the SDID (d=) domain. If this
               flag is absent, the domain of the AUID MUST be the same as, or
               a subdomain of, the SDID.
</p>
<a name="multisig"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Semantics of Multiple Signatures {rfc4871bis-02 4}</h3>

<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Example Scenarios {rfc4871bis-02 4.1}</h3>

<p>There are many reasons why a message might have multiple
               signatures. For example, a given signer might sign multiple
               times, perhaps with different hashing or signing algorithms
               during a transition phase. </p>
<blockquote class="text"><dl>
<dt>EXAMPLE: </dt>
<dd>Suppose SHA-256 is in the future
                     found to be insufficiently strong, and DOSETA usage
                     transitions to SHA-1024. A signer might immediately sign
                     using the newer algorithm, but continue to sign using the
                     older algorithm for interoperability with verifiers that
                     had not yet upgraded. The signer would do this by adding
                     two DOSETA&#8209;Signature Header fields, one using each
                     algorithm. Older verifiers that did not recognize
                     SHA-1024 as an acceptable algorithm would skip that
                     signature and use the older algorithm; newer verifiers
                     could use either signature at their option, and all other
                     things being equal might not even attempt to verify the
                     other signature.
</dd>
</dl></blockquote>

<p>Similarly, a signer might sign a message including all headers
               and no "l=" tag (to satisfy strict verifiers) and a second time
               with a limited set of headers and an "l=" tag (in anticipation
               of possible message modifications in route to other verifiers).
               Verifiers could then choose which signature they preferred. </p>
<blockquote class="text"><dl>
<dt>EXAMPLE: </dt>
<dd>A verifier might receive data with
                     two signatures, one covering more of the data than the
                     other. If the signature covering more of the data
                     verified, then the verifier could make one set of policy
                     decisions; if that signature failed but the signature
                     covering less of the data verified, the verifier might
                     make a different set of policy decisions.
</dd>
</dl></blockquote>

<p>Of course, a message might also have multiple signatures
               because it passed through multiple signers. A common case is
               expected to be that of a signed message that passes through a
               mailing list that also signs all messages. Assuming both of
               those signatures verify, a recipient might choose to accept the
               message if either of those signatures were known to come from
               trusted sources. </p>
<blockquote class="text"><dl>
<dt>EXAMPLE: </dt>
<dd>Recipients might choose to whitelist
                     mailing lists to which they have subscribed and that have
                     acceptable anti- abuse policies so as to accept messages
                     sent to that list even from unknown authors. They might
                     also subscribe to less trusted mailing lists (for
                     example, those without anti-abuse protection) and be
                     willing to accept all messages from specific authors, but
                     insist on doing additional abuse scanning for other
                     messages.
</dd>
</dl></blockquote>

<p>Another related example of multiple signers might be forwarding
               services, such as those commonly associated with academic
               alumni sites. </p>
<blockquote class="text"><dl>
<dt>EXAMPLE: </dt>
<dd>A recipient might have an address at
                     members.example.org, a site that has anti-abuse
                     protection that is somewhat less effective than the
                     recipient would prefer. Such a recipient might have
                     specific authors whose messages would be trusted
                     absolutely, but messages from unknown authors that had
                     passed the forwarder's scrutiny would have only medium
                     trust.
</dd>
</dl></blockquote>

<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Interpretation {rfc4871bis-02 4.2}</h3>

<p>A signer that is adding a signature to a message merely creates
               a new DOSETA&#8209;Signature header, using the usual semantics
               of the h= option. A signer MAY sign previously existing
               DOSETA&#8209;Signature Header fields using the method described
               in <a class='info' href='#fields2sign'>Section&nbsp;4.4.4<span> (</span><span class='info'>Determine the Header Fields to Sign</span><span>)</span></a> to sign trace Header fields. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>Signers need to be cognizant that
                     signing DOSETA&#8209;Signature Header fields might result
                     in verification failures due to modifications by
                     intermediaries, such as their reordering
                     DOSETA&#8209;Signature header fields. For this reason,
                     signing existing DOSETA&#8209;Signature Header fields is
                     unadvised, albeit legal.
</dd>
<dt>NOTE: </dt>
<dd>If a header field with multiple
                     instances is signed, those Header fields are always
                     signed from the "bottom" up (from last to first). Thus,
                     it is not possible to sign only specific
                     DOSETA&#8209;Signature Header fields. For example, if the
                     message being signed already contains three
                     DOSETA&#8209;Signature header fields A, B, and C, it is
                     possible to sign all of them, B and C only, or C only,
                     but not A only, B only, A and B only, or A and C
                     only.
</dd>
</dl></blockquote>

<p>A signer MAY add more than one DOSETA&#8209;Signature header
               field using different parameters. For example, during a
               transition period a signer might want to produce signatures
               using two different hash algorithms.
</p>
<p>Signers SHOULD NOT remove any DOSETA&#8209;Signature Header
               fields from messages they are signing, even if they know that
               the signatures cannot be verified.
</p>
<p>When evaluating a message with multiple signatures, a verifier
               SHOULD evaluate signatures independently and on their own
               merits. For example, a verifier that by policy chooses not to
               accept signatures with deprecated cryptographic algorithms
               would consider such signatures invalid. Verifiers MAY process
               signatures in any order of their choice; for example, some
               verifiers might choose to process signatures corresponding to
               the From field in the message header before other signatures.
               See <a class='info' href='#extractsig'>Section&nbsp;4.5.1<span> (</span><span class='info'>Extract Signatures from the Message</span><span>)</span></a> for more information about signature
               choices. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>Verifier attempts to correlate valid
                     signatures with invalid signatures in an attempt to guess
                     why a signature failed are ill-advised. In particular,
                     there is no general way that a verifier can determine
                     that an invalid signature was ever valid.
</dd>
</dl></blockquote>

<p>Verifiers SHOULD ignore failed signatures as though they were
               not present in the message. Verifiers SHOULD continue to check
               signatures until a signature successfully verifies to the
               satisfaction of the verifier. To limit potential
               denial-of-service attacks, verifiers MAY limit the total number
               of signatures they will attempt to verify.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Considerations</h3>

<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
IANA Considerations {rfc4871bis-02 7, subset}</h3>

<p>This section carries forward the IANA registrations made by
               DKIM <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. The original DKIM language has been
               retained, including the use of "DKIM" in the name of these
               registries, in order to provide continuity from the original
               specification.
</p>
<p>In all cases, new values are assigned only for values that have
               been documented in a published RFC that has IETF Consensus <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for                   Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
DKIM&#8209;Signature Tag Specifications</h3>

<p></p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>The content of a
                        DOSETA&#8209;Signature structure match those in a
                        DKIM&#8209;Signature header field.
</dd>
</dl></blockquote>

<p>A DKIM&#8209;Signature provides for a list of tag
                  specifications. IANA has established the DKIM&#8209;Signature
                  Tag Specification Registry for tag specifications that can
                  be used in DKIM&#8209;Signature fields.
</p>
<p>The initial entries in the registry comprise:
</p><br /><hr class="insert" />
<a name="sigtagreg"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">TYPE</th><th align="left">REFERENCE</th></tr>
<tr>
<td align="center"> v </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> a </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> b </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> bh </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> c </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> d </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> h </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> q </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> s </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> t </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> x </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: DKIM&nbhy;Signature Tag Specification Registry Initial Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.2"></a><h3>6.1.2.&nbsp;
DKIM&#8209;Signature Query Method Registry</h3>

<p>The "q=" tag-spec (specified in <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) provides for a list of query
                  methods.
</p>
<p>IANA has established the DKIM&#8209;Signature Query Method
                  Registry for mechanisms that can be used to retrieve the key
                  that will permit validation processing of a message signed
                  using DKIM.
</p>
<p>The initial entry in the registry comprises:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="left">
<tr><th align="center">TYPE</th><th align="center">OPTION</th><th align="left">REFERENCE</th></tr>
<tr>
<td align="center"> dns </td>
<td align="center"> txt </td>
<td align="left"> (this document, <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>, "q=") </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;DKIM&nbhy;Signature Query Method Registry Initial Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.3"></a><h3>6.1.3.&nbsp;
DKIM&#8209;Signature Canonicalization Registry</h3>

<p>The "c=" tag-spec (specified in <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) provides for a specifier for
                  canonicalization algorithms for the header and Content.
</p>
<p> IANA has established the DKIM&#8209;Signature
                  Canonicalization Algorithm Registry for algorithms for
                  converting a message into a canonical form before signing or
                  verifying using DKIM.
</p>
<p>The initial entries in the Header registry comprise:
</p><br /><hr class="insert" />
<a name="hdrcanonreg"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">TYPE</th><th align="left">REFERENCE</th></tr>
<tr>
<td align="center"> simple </td>
<td align="left"> (this document, <a class='info' href='#hdrcanon'>Section&nbsp;3.1.1<span> (</span><span class='info'>Header Canonicalization Algorithms</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> relaxed </td>
<td align="left"> (this document, <a class='info' href='#hdrcanon'>Section&nbsp;3.1.1<span> (</span><span class='info'>Header Canonicalization Algorithms</span><span>)</span></a>) </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: DKIM&nbhy;Signature Header Canonicalization Algorithm
               Registry                Initial Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The initial entries in the Content (Body) registry
                  comprise:
</p><br /><hr class="insert" />
<a name="bodcanonreg"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">TYPE</th><th align="left">REFERENCE</th></tr>
<tr>
<td align="center"> simple </td>
<td align="left"> (this document, <a class='info' href='#contentcanon'>Section&nbsp;3.1.2<span> (</span><span class='info'>Content Canonicalization Algorithms</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> relaxed </td>
<td align="left"> (this document, <a class='info' href='#contentcanon'>Section&nbsp;3.1.2<span> (</span><span class='info'>Content Canonicalization Algorithms</span><span>)</span></a>) </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: DKIM&nbhy;Signature Body Canonicalization Algorithm
               Registry                Initial Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.4"></a><h3>6.1.4.&nbsp;
_domainkey DNS TXT Record Tag Specifications</h3>

<p>A _domainkey DNS TXT record provides for a list of tag
                  specifications. IANA has established the DKIM _domainkey DNS
                  TXT Tag Specification Registry for tag specifications that
                  can be used in DNS TXT Records.
</p>
<p>The initial entries in the registry comprise:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">TYPE</th><th align="left">REFERENCE</th></tr>
<tr>
<td align="center"> v </td>
<td align="left"> (this document, <a class='info' href='#keydata'>Section&nbsp;3.6<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset, with preface}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> k </td>
<td align="left"> (this document, <a class='info' href='#keydata'>Section&nbsp;3.6<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset, with preface}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> n </td>
<td align="left"> (this document, <a class='info' href='#keydata'>Section&nbsp;3.6<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset, with preface}</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="center"> p </td>
<td align="left"> (this document, <a class='info' href='#keydata'>Section&nbsp;3.6<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset, with preface}</span><span>)</span></a>) </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;DOSETA _domainkey DNS TXT Record Tag Specification Registry
               Initial Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.5"></a><h3>6.1.5.&nbsp;
DKIM Key Type Registry</h3>

<p>The "k=" &lt;key-k-tag&gt; (specified in <a class='info' href='#keydata'>Section&nbsp;3.6<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset, with preface}</span><span>)</span></a>) and the "a=" &lt;sig- a-tag-k&gt;
                  (specified in <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) tags provide for a list of
                  mechanisms that can be used to decode a DKIM signature.
</p>
<p>IANA has established the DKIM Key Type Registry for such
                  mechanisms.
</p>
<p>The initial entry in the registry comprises:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">TYPE</th><th align="left">REFERENCE</th></tr>
<tr>
<td align="center"> rsa </td>
<td align="left">
                     <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA                   Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a>
                  </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;DKIM Key Type Initial Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.6"></a><h3>6.1.6.&nbsp;
DKIM Hash Algorithms Registry</h3>

<p>The "h=" &lt;key-h-tag&gt; (specified in <a class='info' href='#keydata'>Section&nbsp;3.6<span> (</span><span class='info'>Stored Key Data {rfc4871bis-02 3.6.1, subset, with preface}</span><span>)</span></a>) and the "a=" &lt;sig- a-tag-h&gt;
                  (specified in <a class='info' href='#signeddatastruct'>Section&nbsp;4.2<span> (</span><span class='info'>Signature Data Structure {rfc4871bis-02 3.5, subset}</span><span>)</span></a>) tags provide for a list of
                  mechanisms that can be used to produce a digest of message
                  data.
</p>
<p>IANA has established the DKIM Hash Algorithms Registry for
                  such mechanisms.
</p>
<p>The initial entries in the registry comprise:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">TYPE</th><th align="left">REFERENCE</th></tr>
<tr>
<td align="center"> sha1 </td>
<td align="left">
                     <a class='info' href='#FIPS-180-2-2002'>[FIPS&#8209;180&#8209;2&#8209;2002]<span> (</span><span class='info'>U.S. Department of Commerce, &ldquo;Secure Hash Standard,&rdquo; August&nbsp;2002.</span><span>)</span></a>
                  </td>
</tr>
<tr>
<td align="center"> sha256 </td>
<td align="left">
                     <a class='info' href='#FIPS-180-2-2002'>[FIPS&#8209;180&#8209;2&#8209;2002]<span> (</span><span class='info'>U.S. Department of Commerce, &ldquo;Secure Hash Standard,&rdquo; August&nbsp;2002.</span><span>)</span></a>
                  </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;DKIM Hash Algorithms Initial Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Security Considerations {rfc4871bis-02 8, subset}</h3>

<p> It has been observed that any mechanism that is introduced
               that attempts to stem the flow of spam is subject to intensive
               attack. DOSETA needs to be carefully scrutinized to identify
               potential attack vectors and the vulnerability to each. See
               also <a class='info' href='#RFC4686'>[RFC4686]<span> (</span><span class='info'>Fenton, J., &ldquo;Analysis of Threats Motivating DomainKeys Identified                   Mail (DKIM),&rdquo; September&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.1"></a><h3>6.2.1.&nbsp;
Misappropriated Private Key</h3>

<p>If the private key for a user is resident on their computer
                  and is not protected by an appropriately secure mechanism,
                  it is possible for malware to send mail as that user and any
                  other user sharing the same private key. The malware would
                  not, however, be able to generate signed spoofs of other
                  signers' addresses, which would aid in identification of the
                  infected user and would limit the possibilities for certain
                  types of attacks involving socially engineered messages.
                  This threat applies mainly to MUA-based implementations;
                  protection of private keys on servers can be easily achieved
                  through the use of specialized cryptographic hardware.
</p>
<p>A larger problem occurs if malware on many users' computers
                  obtains the private keys for those users and transmits them
                  via a covert channel to a site where they can be shared. The
                  compromised users would likely not know of the
                  misappropriation until they receive "bounce" messages from
                  messages they are purported to have sent. Many users might
                  not understand the significance of these bounce messages and
                  would not take action.
</p>
<p>One countermeasure is to use a user-entered passphrase to
                  encrypt the private key, although users tend to choose weak
                  passphrases and often reuse them for different purposes,
                  possibly allowing an attack against DOSETA to be extended
                  into other domains. Nevertheless, the decoded private key
                  might be briefly available to compromise by malware when it
                  is entered, or might be discovered via keystroke logging.
                  The added complexity of entering a passphrase each time one
                  sends a message would also tend to discourage the use of a
                  secure passphrase.
</p>
<p>A somewhat more effective countermeasure is to send messages
                  through an outgoing MTA that can authenticate the submitter
                  using existing techniques (for example, SMTP
                  Authentication), possibly validate the message itself (for
                  example, verify that the header is legitimate and that the
                  content passes a spam content check), and sign the message
                  using a key appropriate for the submitter address. Such an
                  MTA can also apply controls on the volume of outgoing mail
                  each user is permitted to originate in order to further
                  limit the ability of malware to generate bulk email.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.2"></a><h3>6.2.2.&nbsp;
Key Server Denial-of-Service Attacks</h3>

<p>Since the key servers are distributed (potentially separate
                  for each domain), the number of servers that would need to
                  be attacked to defeat this mechanism on an Internet-wide
                  basis is very large. Nevertheless, key servers for
                  individual domains could be attacked, impeding the
                  verification of messages from that domain. This is not
                  significantly different from the ability of an attacker to
                  deny service to the mail exchangers for a given domain,
                  although it affects outgoing, not incoming, mail.
</p>
<p>A variation on this attack is that if a very large amount of
                  mail were to be sent using spoofed addresses from a given
                  domain, the key servers for that domain could be overwhelmed
                  with requests. However, given the low overhead of
                  verification compared with handling of the email message
                  itself, such an attack would be difficult to mount.
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.3"></a><h3>6.2.3.&nbsp;
Attacks Against the DNS</h3>

<p>Since the DNS is a required binding for key services,
                  specific attacks against the DNS need to be considered.
</p>
<p>While the DNS is currently insecure <a class='info' href='#RFC3833'>[RFC3833]<span> (</span><span class='info'>Atkins, D. and R. Austein, &ldquo;Threat Analysis of the Domain Name System (DNS),&rdquo; August&nbsp;2004.</span><span>)</span></a>, these security problems are the
                  motivation behind DNS Security (DNSSEC) <a class='info' href='#RFC4033'>[RFC4033]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a>, and all users of the DNS will reap
                  the benefit of that work.
</p>
<p>DOSETA is only intended as a "sufficient" method of proving
                  authenticity. It is not intended to provide strong
                  cryptographic proof about authorship or contents. Other
                  technologies such as OpenPGP <a class='info' href='#RFC4880'>[RFC4880]<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;2007.</span><span>)</span></a> and S/MIME <a class='info' href='#RFC5751'>[RFC5751]<span> (</span><span class='info'>Ramsdell, B., &ldquo;Secure/Multipurpose Internet Mail Extensions (S/MIME)                   Version 3.1 Message Specification,&rdquo; January&nbsp;2010.</span><span>)</span></a> address those requirements.
</p>
<p>A second security issue related to the DNS revolves around
                  the increased DNS traffic as a consequence of fetching
                  selector-based data as well as fetching signing domain
                  policy. Widespread deployment of DOSETA will result in a
                  significant increase in DNS queries to the claimed signing
                  domain. In the case of forgeries on a large scale, DNS
                  servers could see a substantial increase in queries.
</p>
<p>A specific DNS security issue that ought to be considered by
                  DOSETA verifiers is the name chaining attack described in
                  Section 2.3 of <a class='info' href='#RFC3833'>[RFC3833]<span> (</span><span class='info'>Atkins, D. and R. Austein, &ldquo;Threat Analysis of the Domain Name System (DNS),&rdquo; August&nbsp;2004.</span><span>)</span></a>. A DOSETA verifier, while verifying a
                  DOSETA&#8209;Signature header field, could be prompted to
                  retrieve a key record of an attacker's choosing. This threat
                  can be minimized by ensuring that name servers, including
                  recursive name servers, used by the verifier enforce strict
                  checking of "glue" and other additional information in DNS
                  responses and are therefore not vulnerable to this
                  attack.
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.4"></a><h3>6.2.4.&nbsp;
Replay Attacks</h3>

<p>In this attack, a spammer sends a message to be spammed to
                  an accomplice, which results in the message being signed by
                  the originating MTA. The accomplice resends the message,
                  including the original signature, to a large number of
                  recipients, possibly by sending the message to many
                  compromised machines that act as MTAs. The messages, not
                  having been modified by the accomplice, have valid
                  signatures.
</p>
<p>Partial solutions to this problem involve the use of
                  reputation services to convey the fact that the specific
                  email address is being used for spam and that messages from
                  that signer are likely to be spam. This requires a real-time
                  detection mechanism in order to react quickly enough.
                  However, such measures might be prone to abuse, if for
                  example an attacker resent a large number of messages
                  received from a victim in order to make them appear to be a
                  spammer.
</p>
<p>Large verifiers might be able to detect unusually large
                  volumes of mails with the same signature in a short time
                  period. Smaller verifiers can get substantially the same
                  volume of information via existing collaborative
                  systems.
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.5"></a><h3>6.2.5.&nbsp;
Limits on Revoking Keys</h3>

<p>When a large domain detects undesirable behavior on the part
                  of one of its users, it might wish to revoke the key used to
                  sign that user's messages in order to disavow responsibility
                  for messages that have not yet been verified or that are the
                  subject of a replay attack. However, the ability of the
                  domain to do so can be limited if the same key, for
                  scalability reasons, is used to sign messages for many other
                  users. Mechanisms for explicitly revoking keys on a
                  per-address basis have been proposed but require further
                  study as to their utility and the DNS load they
                  represent.
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.6"></a><h3>6.2.6.&nbsp;
Intentionally Malformed Key Records</h3>

<p>It is possible for an attacker to publish key records in DNS
                  that are intentionally malformed, with the intent of causing
                  a denial-of- service attack on a non-robust verifier
                  implementation. The attacker could then cause a verifier to
                  read the malformed key record by sending a message to one of
                  its users referencing the malformed record in a (not
                  necessarily valid) signature. Verifiers MUST thoroughly
                  verify all key records retrieved from the DNS and be robust
                  against intentionally as well as unintentionally malformed
                  key records.
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.7"></a><h3>6.2.7.&nbsp;
Intentionally Malformed DOSETA&#8209;Signature Header Fields</h3>

<p>Verifiers MUST be prepared to receive messages with
                  malformed DOSETA&#8209;Signature Header fields, and
                  thoroughly verify the header field before depending on any
                  of its contents.
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.8"></a><h3>6.2.8.&nbsp;
Information Leakage</h3>

<p>An attacker could determine when a particular signature was
                  verified by using a per-message selector and then monitoring
                  their DNS traffic for the key lookup. This would act as the
                  equivalent of a "web bug" for verification time rather than
                  when the message was read.
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.9"></a><h3>6.2.9.&nbsp;
Remote Timing Attacks</h3>

<p>In some cases it might be possible to extract private keys
                  using a remote timing attack <a class='info' href='#BONEH03'>[BONEH03]<span> (</span><span class='info'>, &ldquo;Remote Timing Attacks are Practical,&rdquo; 2003.</span><span>)</span></a>. Implementations SHOULD obfuscate the
                  timing to prevent such attacks.
</p>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.10"></a><h3>6.2.10.&nbsp;
Reordered Header Fields</h3>

<p>Existing standards allow intermediate MTAs to reorder Header
                  fields. If a signer signs two or more Header fields of the
                  same name, this can cause spurious verification errors on
                  otherwise legitimate messages. In particular, signers that
                  sign any existing DOSETA&#8209;Signature fields run the risk
                  of having messages incorrectly fail to verify.
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.11"></a><h3>6.2.11.&nbsp;
RSA Attacks</h3>

<p>An attacker could create a large RSA signing key with a
                  small exponent, thus requiring that the verification key
                  have a large exponent. This will force verifiers to use
                  considerable computing resources to verify the signature.
                  Verifiers might avoid this attack by refusing to verify
                  signatures that reference selectors with public keys having
                  unreasonable exponents.
</p>
<p>In general, an attacker might try to overwhelm a verifier by
                  flooding it with data requiring verification. This is
                  similar to other server denial-of-service attacks and needs
                  to be dealt with in a similar fashion.
</p>
<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.12"></a><h3>6.2.12.&nbsp;
Inappropriate Signing by Parent Domains</h3>

<p>The trust relationship described in <a class='info' href='#parentsig'>Section&nbsp;4.7<span> (</span><span class='info'>Signing by Parent Domains {rfc4871bis-02 3.8}</span><span>)</span></a> could conceivably be used by a
                  parent domain to sign messages with identities in a
                  subdomain not administratively related to the parent. For
                  example, the ".com" registry could create messages with
                  signatures using an "i=" value in the example.com domain.
                  There is no general solution to this problem, since the
                  administrative cut could occur anywhere in the domain name.
                  For example, in the domain "example.podunk.ca.us" there are
                  three administrative cuts (podunk.ca.us, ca.us, and us), any
                  of which could create messages with an identity in the full
                  domain. </p>
<blockquote class="text"><dl>
<dt>NOTE:  </dt>
<dd>This is considered an acceptable
                        risk for the same reason that it is acceptable for
                        domain delegation. For example, in the example above
                        any of the domains could potentially simply delegate
                        "example.podunk.ca.us" to a server of their choice and
                        completely replace all DNS-served information. Note
                        that a verifier MAY ignore signatures that come from
                        an unlikely domain such as ".com", as discussed in <a class='info' href='#validatesig'>Section&nbsp;4.5.2<span> (</span><span class='info'>Validate the Signature Header Field</span><span>)</span></a>.
</dd>
</dl></blockquote><p>
               
</p>
<a name="anchor50"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.13"></a><h3>6.2.13.&nbsp;
Attacks Involving Addition of Header Fields</h3>

<p>Many email implementations do not enforce <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a> with strictness. As discussed in <a class='info' href='#normalize'>Section&nbsp;4.4.3<span> (</span><span class='info'>Normalize the Message to Prevent Transport Conversions</span><span>)</span></a> DOSETA processing is predicated on a
                  valid mail message as its input. However, DOSETA
                  implementers need to be aware of the potential effect of
                  having loose enforcement by email components interacting
                  with DOSETA modules.
</p>
<p>For example, a message with multiple From: Header fields
                  violates Section 3.6 of <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a>. With the intent of providing a better
                  user experience, many agents tolerate these violations and
                  deliver the message anyway. An MUA then might elect to
                  render to the user the value of the last, or "top", From:
                  field. This might also be done simply out of the expectation
                  that there is only one, where a "find first" algorithm would
                  have the same result. Such code in an MUA can be exploited
                  to fool the user if it is also known that the other From:
                  field is the one checked by arriving message filters. Such
                  is the case with DOSETA; although the From: field MUST be
                  signed, a malformed message bearing more than one From:
                  field might only have the first ("bottom") one signed, in an
                  attempt to show the message with some "DOSETA passed"
                  annotation while also rendering the From: field that was not
                  authenticated. (This can also be taken as a demonstration
                  that DOSETA is not designed to support author validation.) 
</p>
<p>To resist this specific attack the signed header field list
                  can include an additional reference for each field that was
                  present at signing. For example, a proper message with one
                  From: field could be signed using "h=From:From:..." Due to
                  the way header fields are canonicalized for input to the
                  hash function, the extra field references will prevent
                  instances of the cited fields from being added after
                  signing, as doing so would render the signature invalid. 
</p>
<p>The From: field is used above to illustrate this issue, but
                  it is only one of > several fields that Section 3.6 of <a class='info' href='#RFC5322'>[RFC5322]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; October&nbsp;2008.</span><span>)</span></a> constrains in this way. In reality any
                  agent that forgives malformations, or is careless about
                  identifying which parts of a message were authenticated, is
                  open to exploitation.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS-180-2-2002">[FIPS-180-2-2002]</a></td>
<td class="author-text">U.S. Department of Commerce, &ldquo;Secure Hash Standard,&rdquo; FIPS PUB&nbsp;180-2, August&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="ITU-X660-1997">[ITU-X660-1997]</a></td>
<td class="author-text">&ldquo;Information Technology - ASN.1 encoding rules:
                  Specification of Basic Encoding Rules (BER), Canonical
                  Encoding Rules (CER) and Distinguished Encoding Rules
                  (DER),&rdquo; 1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">DOMAIN NAMES - CONCEPTS AND FACILITIES</a>,&rdquo; RFC&nbsp;1034, November&nbsp;1987.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2045">[RFC2045]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com">N. Borenstein</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2045">Multipurpose Internet Mail
                  Extensions (MIME) Part One: Format of Internet Message
                  Bodies</a>,&rdquo; RFC&nbsp;2045, November&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2045.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2049">[RFC2049]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com">N. Borenstein</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2049">Multipurpose Internet Mail
                  Extensions (MIME) Part Five: Conformance Criteria and
                  Examples</a>,&rdquo; RFC&nbsp;2049, November&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2049.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2049.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2049.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate
                  Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3447">[RFC3447]</a></td>
<td class="author-text">Jonsson, J. and B. Kaliski, &ldquo;<a href="http://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA
                  Cryptography Specifications Version 2.1</a>,&rdquo; RFC&nbsp;3447, February&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3447.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">Crocker, D., Ed.</a> and <a href="mailto:paul.overell@thus.net">P. Overell</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4234">Augmented BNF for Syntax Specifications:
                  ABNF</a>,&rdquo; RFC&nbsp;4234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc4234.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4234.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4234.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5321">[RFC5321]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5321">Simple Mail Transfer Protocol</a>,&rdquo; RFC&nbsp;5321, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5321.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5322">[RFC5322]</a></td>
<td class="author-text">Resnick, P., &ldquo;<a href="http://tools.ietf.org/html/rfc5322">Internet Message Format</a>,&rdquo; RFC&nbsp;5322, October&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5322.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5890">[RFC5890]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5890">Internationalizing Domain Names in Applications (IDNA):
                  Definitions and Document Framework</a>,&rdquo; RFC&nbsp;5890, August&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5890.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="BONEH03">[BONEH03]</a></td>
<td class="author-text">&ldquo;Remote Timing Attacks are Practical,&rdquo; Proceedings &nbsp;12th USENIX Security Symposium, 2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1847">[RFC1847]</a></td>
<td class="author-text"><a href="mailto:galvin@tis.com">Galvin, J.</a>, <a href="mailto:sandy@tis.com">Murphy, S.</a>, <a href="mailto:crocker@cybercash.com">Crocker, S.</a>, and <a href="mailto:ned@innosoft.com">N. Freed</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1847">Security Multiparts for MIME:
                  Multipart/Signed and Multipart/Encrypted</a>,&rdquo; RFC&nbsp;1847, October&nbsp;1995 (<a href="http://www.rfc-editor.org/rfc/rfc1847.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3766">[RFC3766]</a></td>
<td class="author-text">Orman, H. and P. Hoffman, &ldquo;<a href="http://tools.ietf.org/html/rfc3766">Determining Strengths For Public Keys Used For
                  Exchanging Symmetric Keys</a>,&rdquo; BCP&nbsp;86, RFC&nbsp;3766, April&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3766.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3833">[RFC3833]</a></td>
<td class="author-text">Atkins, D. and R. Austein, &ldquo;<a href="http://tools.ietf.org/html/rfc3833">Threat Analysis of the Domain Name System (DNS)</a>,&rdquo; RFC&nbsp;3833, August&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3833.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3864">[RFC3864]</a></td>
<td class="author-text">Klyne, G., Nottingham, M., and J. Mogul, &ldquo;<a href="http://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header
                  Fields</a>,&rdquo; BCP&nbsp;90, RFC&nbsp;3864, September&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3864.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[RFC4033]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4409">[RFC4409]</a></td>
<td class="author-text">Gellens, R. and J. Klensin, &ldquo;<a href="http://tools.ietf.org/html/rfc4409">Message Submission for Mail</a>,&rdquo; RFC&nbsp;4409, April&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4686">[RFC4686]</a></td>
<td class="author-text">Fenton, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4686">Analysis of Threats Motivating DomainKeys Identified
                  Mail (DKIM)</a>,&rdquo; RFC&nbsp;4686, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4686.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4871">[RFC4871]</a></td>
<td class="author-text">Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;<a href="http://tools.ietf.org/html/rfc4871">DomainKeys Identified Mail (DKIM) Signatures</a>,&rdquo; RFC&nbsp;4871, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4871.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4880">[RFC4880]</a></td>
<td class="author-text"><a href="mailto:jon@pgp.com">Callas, J.</a>, <a href="mailto:lutz@iks-jena.de">Donnerhacke, L.</a>, <a href="mailto:hal@pgp.com">Finney, H.</a>, and <a href="mailto:rodney@unitran.com">R. Thayer</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4880">OpenPGP Message Format</a>,&rdquo; RFC&nbsp;4880, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4880.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4880.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4880.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text"><a href="mailto:narten@raleigh.ibm.com">Narten, T.</a> and <a href="mailto:Harald@Alvestrand.no">H. Alvestrand</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for
                  Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc5226.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc5226.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5451">[RFC5451]</a></td>
<td class="author-text">Kucherawy, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5451">Message Header Field for Indicating Message
                  Authentication Status</a>,&rdquo; RFC&nbsp;5451, April&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5451.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5672">[RFC5672]</a></td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">Crocker, D., Ed.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc5672">RFC 4871 DomainKeys Identified Mail (DKIM) Signatures:
                  Update</a>,&rdquo; RFC&nbsp;5672, August&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5751">[RFC5751]</a></td>
<td class="author-text">Ramsdell, B., &ldquo;<a href="http://tools.ietf.org/html/rfc5751">Secure/Multipurpose Internet Mail Extensions (S/MIME)
                  Version 3.1 Message Specification</a>,&rdquo; RFC&nbsp;5751, January&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5751.txt">TXT</a>).</td></tr>
</table>

<a name="createpkey"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Creating a Public Key {rfc4871bis-02 C}</h3>

<p> The default signature is an RSA signed SHA256 digest of the
            complete email. For ease of explanation, the openssl command is
            used to describe the mechanism by which keys and signatures are
            managed. One way to generate a 1024-bit, unencrypted private key
            suitable for DOSETA is to use openssl like this: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>$ openssl genrsa -out rsa.private 1024</pre></div><p>
 For increased security, the "-passin" parameter can also
            be added to encrypt the private key. Use of this parameter will
            require entering a password for several of the following steps.
            Servers might prefer to use hardware cryptographic support.
</p>
<p>
            
<p style='text-align: left'>The "genrsa" step results in the file rsa.private
                  containing the key information similar to this:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>-----BEGIN RSA PRIVATE KEY-----
MIICXwIBAAKBgQDwIRP/UC3SBsEmGqZ9ZJW3/DkMoGeLnQg1fWn7/zYtIxN2SnFC
jxOCKG9v3b4jYfcTNh5ijSsq631uBItLa7od+v/RtdC2UzJ1lWT947qR+Rcac2gb
to/NMqJ0fzfVjH4OuKhitdY9tf6mcwGjaNBcWToIMmPSPDdQPNUYckcQ2QIDAQAB
AoGBALmn+XwWk7akvkUlqb+dOxyLB9i5VBVfje89Teolwc9YJT36BGN/l4e0l6QX
/1//6DWUTB3KI6wFcm7TWJcxbS0tcKZX7FsJvUz1SbQnkS54DJck1EZO/BLa5ckJ
gAYIaqlA9C0ZwM6i58lLlPadX/rtHb7pWzeNcZHjKrjM461ZAkEA+itss2nRlmyO
n1/5yDyCluST4dQfO8kAB3toSEVc7DeFeDhnC1mZdjASZNvdHS4gbLIA1hUGEF9m
3hKsGUMMPwJBAPW5v/U+AWTADFCS22t72NUurgzeAbzb1HWMqO4y4+9Hpjk5wvL/
eVYizyuce3/fGke7aRYw/ADKygMJdW8H/OcCQQDz5OQb4j2QDpPZc0Nc4QlbvMsj
7p7otWRO5xRa6SzXqqV3+F0VpqvDmshEBkoCydaYwc2o6WQ5EBmExeV8124XAkEA
qZzGsIxVP+sEVRWZmW6KNFSdVUpk3qzK0Tz/WjQMe5z0UunY9Ax9/4PVhp/j61bf
eAYXunajbBSOLlx4D+TunwJBANkPI5S9iylsbLs6NkaMHV6k5ioHBBmgCak95JGX
GMot/L2x0IYyMLAz6oLWh2hm7zwtb0CgOrPo1ke44hFYnfc=
-----END RSA PRIVATE KEY-----</pre></div>
         

<p>
            
<p>To extract the public-key component from the private
                  key, use openssl like this:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>$ openssl rsa -in rsa.private -out rsa.public -pubout -outform PEM</pre></div>
         

<p>
            
<p style='text-align: left'>This results in the file rsa.public containing the
                  key information similar to this:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDwIRP/UC3SBsEmGqZ9ZJW3/DkM
oGeLnQg1fWn7/zYtIxN2SnFCjxOCKG9v3b4jYfcTNh5ijSsq631uBItLa7od+v/R
tdC2UzJ1lWT947qR+Rcac2gbto/NMqJ0fzfVjH4OuKhitdY9tf6mcwGjaNBcWToI
MmPSPDdQPNUYckcQ2QIDAQAB
-----END PUBLIC KEY-----</pre></div>
            
<p style='text-align: left'>This public-key data (without the BEGIN and END tags)
                  is placed in the DNS:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
brisbane IN  TXT
        ("v=DKIM1; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQ"
         "KBgQDwIRP/UC3SBsEmGqZ9ZJW3/DkMoGeLnQg1fWn7/zYt"
         "IxN2SnFCjxOCKG9v3b4jYfcTNh5ijSsq631uBItLa7od+v"
         "/RtdC2UzJ1lWT947qR+Rcac2gbto/NMqJ0fzfVjH4OuKhi"
         "tdY9tf6mcwGjaNBcWToIMmPSPDdQPNUYckcQ2QIDAQAB")</pre></div>
         

<a name="anchor53"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Acknowledgements</h3>

<p>DOSETA is derived from DKIM <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">D. Crocker (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brandenburg InternetWorking</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">675 Spruce Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1.408.246.8253</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">dcrocker@bbiw.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://bbiw.net">http://bbiw.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">M. Kucherawy (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cloudmark</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">128 King St., 2nd Floor</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Francisco, CA  94107</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:msk@cloudmark.com">msk@cloudmark.com</a></td></tr>
</table>
</body></html>
