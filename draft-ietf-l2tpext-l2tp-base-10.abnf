shared_key = HMAC_MD5 (shared_secret | 1)

b1 = MD5(AV + S + RV)   c(1) = p1 xor b1
b2 = MD5(S  + c(1))     c(2) = p2 xor b2
                          .                       .
                          .                       .
                          .                       .
bi = MD5(S  + c(i-1))   c(i) = pi xor bi

shared_key = HMAC_MD5 (shared_secret | 2)

Digest = Hash (local_nonce | remote_nonce | shared_key |
Digest = Hash (shared_key | control_message)

