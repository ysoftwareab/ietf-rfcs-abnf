Forwarded   = "Forwarded" ":" LWS Forwarded-v
Forwarded-v = 1#forwarded-element

forwarded-element =
               OWS forwarded-value *( OWS ";" OWS forwarded-value ) OWS

forwarded-value   = for-kv | by-kv | proto-kv | host-kv | ext-kv

for-kv     = "for=" node
by-kv      = "by="  node
proto-kv   = "proto=" proto-name
host-kv    = "host=" host
ext-kv     =  extension "=" ext-value
proto-name = ALPHA *( ALPHA | DIGIT | "+" | "-" | "." )

for=198.51.100.17;by=203.0.113.60;proto=http;host=example.com"
extension = 1*( ALPHA | DIGIT | "-" )
ext-value = <any OCTET except CTLs, "," and ";",
         but including SP>

nodename = IPv4address | IPv6address |
                   "unknown" | obfnode

node            = nodename [ ":" node-port ]

node-port       = port | obfport
port            = 1*5DIGIT
obfport         = 1*(ALPHA | DIGIT)

obfnode         = "_" 1*( ALPHA | DIGIT )

Forwarded   = "Forwarded" ":" LWS Forwarded-v
Forwarded-v = 1#forwarded-element

forwarded-element =
               OWS forwarded-value *( OWS ";" OWS forwarded-value ) OWS

forwarded-value   = for-kv | by-kv | proto-kv | host-kv | ext-kv

for-kv     = "for=" node
by-kv      = "by="  node
proto-kv   = "proto=" proto-name
host-kv    = "host=" host
ext-kv     =  extension "=" ext-value

node = nodename [ ":" node-port ]
nodename = IPv4address | IPv6address |
         "unknown" | obfnode
obfnode = "_" 1*( ALPHA | DIGIT )
node-port = port | obfport
port = 1*5DIGIT
obfport = 1*( ALPHA | DIGIT )
proto-name = ALPHA *( ALPHA | DIGIT | "+" | "-" | "." )
extension = 1*( ALPHA | DIGIT | "-" )
ext-value = <any OCTET except CTLs, "," and ";",
         but including SP>


