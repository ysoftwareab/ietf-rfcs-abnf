q = 2^^m in this specification.
tot_k = B * NumSPA.

max_k = floor((2^^m - 1) * CR)
