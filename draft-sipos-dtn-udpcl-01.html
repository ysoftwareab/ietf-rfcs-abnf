<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Delay-Tolerant Networking UDP Convergence Layer Protocol</title>
<meta content="Brian Sipos" name="author">
<meta content="
       
This document describes a UDP-based convergence layer (UDPCL) for Delay-Tolerant Networking (DTN).
This version of the UDPCL protocol clarifies requirements of RFC7122, adds discussion of multicast addressing, and updates to the Bundle Protocol (BP) contents, encodings, and convergence layer requirements in BP Version 7.
Specifically, the UDPCL uses CBOR-encoded BPv7 bundles as its service data unit being transported and provides a reliable transport of such bundles.
This version of UDPCL also includes security and extensibility mechanisms.
       
    " name="description">
<meta content="xml2rfc 3.5.0" name="generator">
<meta content="draft-sipos-dtn-udpcl-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.2
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 54.0.0
    six 1.15.0
-->
<link href="/tmp/draft-sipos-dtn-udpcl-m1sa2i6d.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DTN UDPCL</td>
<td class="right">March 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Sipos</td>
<td class="center">Expires 26 September 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Delay-Tolerant Networking</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-sipos-dtn-udpcl-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-03-25" class="published">25 March 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-09-26">26 September 2021</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">B. Sipos</div>
<div class="org">RKF Engineering</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Delay-Tolerant Networking UDP Convergence Layer Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
This document describes a UDP-based convergence layer (UDPCL) for Delay-Tolerant Networking (DTN).
This version of the UDPCL protocol clarifies requirements of RFC7122, adds discussion of multicast addressing, and updates to the Bundle Protocol (BP) contents, encodings, and convergence layer requirements in BP Version 7.
Specifically, the UDPCL uses CBOR-encoded BPv7 bundles as its service data unit being transported and provides a reliable transport of such bundles.
This version of UDPCL also includes security and extensibility mechanisms.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 26 September 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-scope" class="xref">Scope</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-use-of-cddl" class="xref">Use of CDDL</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a><a href="#section-toc.1-1.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-definitions-specific-to-the" class="xref">Definitions Specific to the UDPCL Protocol</a><a href="#section-toc.1-1.1.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-general-protocol-descriptio" class="xref">General Protocol Description</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-convergence-layer-services" class="xref">Convergence Layer Services</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-pkix-environments-and-ca-po" class="xref">PKIX Environments and CA Policy</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-fragmentation-policies" class="xref">Fragmentation Policies</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-error-checking-policies" class="xref">Error Checking Policies</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-congestion-control-policies" class="xref">Congestion Control Policies</a><a href="#section-toc.1-1.2.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-udpcl-operation" class="xref">UDPCL Operation</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-ip-addressing" class="xref">IP Addressing</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-udp-header" class="xref">UDP Header</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-udpcl-packets" class="xref">UDPCL Packets</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-udpcl-messages" class="xref">UDPCL Messages</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-udpcl-extension-items" class="xref">UDPCL Extension Items</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="xref">3.5.1</a>.  <a href="#name-dtls-initiation-starttls" class="xref">DTLS Initiation (STARTTLS)</a><a href="#section-toc.1-1.3.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="xref">3.5.2</a>.  <a href="#name-bundle-transfer" class="xref">Bundle Transfer</a><a href="#section-toc.1-1.3.2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.5.2.3">
                    <p id="section-toc.1-1.3.2.5.2.3.1"><a href="#section-3.5.3" class="xref">3.5.3</a>.  <a href="#name-sender-listen" class="xref">Sender Listen</a><a href="#section-toc.1-1.3.2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.5.2.4">
                    <p id="section-toc.1-1.3.2.5.2.4.1"><a href="#section-3.5.4" class="xref">3.5.4</a>.  <a href="#name-sender-node-id" class="xref">Sender Node ID</a><a href="#section-toc.1-1.3.2.5.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-explicit-transfers" class="xref">Explicit Transfers</a><a href="#section-toc.1-1.3.2.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="xref">3.6.1</a>.  <a href="#name-bundle-transfer-id" class="xref">Bundle Transfer ID</a><a href="#section-toc.1-1.3.2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="xref">3.6.2</a>.  <a href="#name-fragmentation-and-reassembl" class="xref">Fragmentation and Reassembly</a><a href="#section-toc.1-1.3.2.6.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-udpcl-security" class="xref">UDPCL Security</a><a href="#section-toc.1-1.3.2.7.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.3.2.7.2.1">
                    <p id="section-toc.1-1.3.2.7.2.1.1"><a href="#section-3.7.1" class="xref">3.7.1</a>.  <a href="#name-entity-identification" class="xref">Entity Identification</a><a href="#section-toc.1-1.3.2.7.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.7.2.2">
                    <p id="section-toc.1-1.3.2.7.2.2.1"><a href="#section-3.7.2" class="xref">3.7.2</a>.  <a href="#name-certificate-profile-for-udp" class="xref">Certificate Profile for UDPCL</a><a href="#section-toc.1-1.3.2.7.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.7.2.3">
                    <p id="section-toc.1-1.3.2.7.2.3.1"><a href="#section-3.7.3" class="xref">3.7.3</a>.  <a href="#name-dtls-handshake" class="xref">DTLS Handshake</a><a href="#section-toc.1-1.3.2.7.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.7.2.4">
                    <p id="section-toc.1-1.3.2.7.2.4.1"><a href="#section-3.7.4" class="xref">3.7.4</a>.  <a href="#name-dtls-authentication" class="xref">DTLS Authentication</a><a href="#section-toc.1-1.3.2.7.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.7.2.5">
                    <p id="section-toc.1-1.3.2.7.2.5.1"><a href="#section-3.7.5" class="xref">3.7.5</a>.  <a href="#name-policy-recommendations" class="xref">Policy Recommendations</a><a href="#section-toc.1-1.3.2.7.2.5.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.7.2.6">
                    <p id="section-toc.1-1.3.2.7.2.6.1"><a href="#section-3.7.6" class="xref">3.7.6</a>.  <a href="#name-example-secured-and-bidirec" class="xref">Example Secured and Bidirectional Transfers</a><a href="#section-toc.1-1.3.2.7.2.6.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-implementation-status" class="xref">Implementation Status</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-threat-passive-leak-of-node" class="xref">Threat: Passive Leak of Node Data</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-threat-passive-leak-of-bund" class="xref">Threat: Passive Leak of Bundle Data</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-threat-transport-security-s" class="xref">Threat: Transport Security Stripping</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-threat-weak-dtls-configurat" class="xref">Threat: Weak DTLS Configurations</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-threat-untrusted-end-entity" class="xref">Threat: Untrusted End-Entity Certificate</a><a href="#section-toc.1-1.5.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-threat-certificate-validati" class="xref">Threat: Certificate Validation Vulnerabilities</a><a href="#section-toc.1-1.5.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.  <a href="#name-threat-bp-node-impersonatio" class="xref">Threat: BP Node Impersonation</a><a href="#section-toc.1-1.5.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="xref">5.8</a>.  <a href="#name-threat-denial-of-service" class="xref">Threat: Denial of Service</a><a href="#section-toc.1-1.5.2.8.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="xref">5.9</a>.  <a href="#name-mandatory-to-implement-dtls" class="xref">Mandatory-to-Implement DTLS</a><a href="#section-toc.1-1.5.2.9.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.10">
                <p id="section-toc.1-1.5.2.10.1"><a href="#section-5.10" class="xref">5.10</a>. <a href="#name-alternate-uses-of-dtls" class="xref">Alternate Uses of DTLS</a><a href="#section-toc.1-1.5.2.10.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.10.2.1">
                    <p id="section-toc.1-1.5.2.10.2.1.1"><a href="#section-5.10.1" class="xref">5.10.1</a>.  <a href="#name-dtls-without-authentication" class="xref">DTLS Without Authentication</a><a href="#section-toc.1-1.5.2.10.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.10.2.2">
                    <p id="section-toc.1-1.5.2.10.2.2.1"><a href="#section-5.10.2" class="xref">5.10.2</a>.  <a href="#name-non-certificate-dtls-use" class="xref">Non-Certificate DTLS Use</a><a href="#section-toc.1-1.5.2.10.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.11">
                <p id="section-toc.1-1.5.2.11.1"><a href="#section-5.11" class="xref">5.11</a>. <a href="#name-predictability-of-transfer-" class="xref">Predictability of Transfer IDs</a><a href="#section-toc.1-1.5.2.11.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-port-number" class="xref">Port Number</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-udpcl-extension-types" class="xref">UDPCL Extension Types</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-significant-changes-from-rf" class="xref">Significant changes from RFC7122</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sec-intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
This document describes the UDP-based convergence-layer protocol for Delay-Tolerant Networking.
Delay-Tolerant Networking is an end-to-end architecture providing communications in and/or through highly stressed environments, including those with intermittent connectivity, long and/or variable delays, and high bit error rates.
More detailed descriptions of the rationale and capabilities of these networks can be found in "Delay-Tolerant Network Architecture" <span>[<a href="#RFC4838" class="xref">RFC4838</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
An important goal of the DTN architecture is to accommodate a wide range of networking technologies and environments.
The protocol used for DTN communications is the Bundle Protocol Version 7 (BPv7) <span>[<a href="#I-D.ietf-dtn-bpbis" class="xref">I-D.ietf-dtn-bpbis</a>]</span>, an application-layer protocol that is used to construct a store-and-forward overlay network.
BPv7 requires the services of a "convergence-layer adapter" (CLA) to send and receive bundles using the service of some "native" link, network, or Internet protocol.
This document describes one such convergence-layer adapter that uses the well-known User Datagram Protocol (UDP).
This convergence layer is referred to as UDP Convergence Layer (UDPCL).
For the remainder of this document, the abbreviation "BP" without the version suffix refers to BPv7.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
The locations of the UDPCL and the BP in the Internet model protocol stack (described in <span>[<a href="#RFC1122" class="xref">RFC1122</a>]</span>) are shown in <a href="#fig-udpcl-ip-stack" class="xref">Figure 1</a>.
In particular, when BP is using UDP as its bearer with UDPCL as its convergence layer, both BP and UDPCL reside at the application layer of the Internet model.<a href="#section-1-3" class="pilcrow">¶</a></p>
<span id="name-the-locations-of-the-bundle"></span><div id="fig-udpcl-ip-stack">
<figure id="figure-1">
        <div class="artwork art-text alignCenter art-ascii-art" id="section-1-4.1">
<pre>
+-------------------------+
|     DTN Application     | -\
+-------------------------|   |
|  Bundle Protocol (BP)   |   -&gt; Application Layer
+-------------------------+   |
| UDP Conv. Layer (UDPCL) |   |
+-------------------------+   |
|     DTLS (optional)     | -/
+-------------------------+
|          UDP            | ---&gt; Transport Layer
+-------------------------+
|       IPv4/IPv6         | ---&gt; Network Layer
+-------------------------+
|   Link-Layer Protocol   | ---&gt; Link Layer
+-------------------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-the-locations-of-the-bundle" class="selfRef">The Locations of the Bundle Protocol and the UDP Convergence-Layer Protocol above the Internet Protocol Stack</a>
        </figcaption></figure>
</div>
<section id="section-1.1">
        <h3 id="name-scope">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-scope" class="section-name selfRef">Scope</a>
        </h3>
<p id="section-1.1-1">
This document describes the format of the protocol data units passed between entities participating in UDPCL communications.
This document does not address:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">
The format of protocol data units of the Bundle Protocol, as those are defined elsewhere in <span>[<a href="#I-D.ietf-dtn-bpbis" class="xref">I-D.ietf-dtn-bpbis</a>]</span>.
This includes the concept of bundle fragmentation or bundle encapsulation.
The UDPCL transfers bundles as opaque data blocks.<a href="#section-1.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.2">
Mechanisms for locating or identifying other bundle entities (peers) within a network or across an internet.
The mapping of Node ID to potential convergence layer (CL) protocol and network address is left to implementation and configuration of the BP Agent and its various potential routing strategies.<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.3">
Logic for routing bundles along a path toward a bundle's endpoint.
This CL protocol is involved only in transporting bundles between adjacent entities in a routing sequence.<a href="#section-1.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.4">
Logic for performing rate control and congestion control of bundle transfers, both incoming and outgoing from a UDPCL entity.<a href="#section-1.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.5">
Policies or mechanisms for issuing Public Key Infrastructure Using X.509 (PKIX) certificates; provisioning, deploying, or accessing certificates and private keys; deploying or accessing certificate revocation lists (CRLs); or configuring security parameters on an individual entity or across a network.<a href="#section-1.1-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.6">
Uses of Datagram Transport Layer Security (DTLS) which are not based on PKIX certificate authentication (see <a href="#sec-security-tlsnopki" class="xref">Section 5.10.2</a>) or in which authentication of both entities is not possible (see <a href="#sec-security-tlsnoauth" class="xref">Section 5.10.1</a>).<a href="#section-1.1-2.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-3">
Any UDPCL implementation requires a BP agent to perform those above listed functions in order to perform end-to-end bundle delivery.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-use-of-cddl">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-use-of-cddl" class="section-name selfRef">Use of CDDL</a>
        </h3>
<p id="section-1.2-1">
This document defines CBOR structure using the Concise Data Definition Language (CDDL) of <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span>.
The entire CDDL structure can be extracted from the XML version of this document using the XPath expression:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<div id="section-1.2-2">
<pre class="sourcecode">'//sourcecode[@type="cddl"]'</pre><a href="#section-1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-1.2-3">
The following initial fragment defines the top-level symbols of this document's CDDL.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<div id="section-1.2-4">
<pre class="sourcecode lang-cddl">
start = udpcl-ext-map
</pre><a href="#section-1.2-4" class="pilcrow">¶</a>
</div>
</section>
<section id="section-1.3">
        <h3 id="name-requirements-language">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.3-1">
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
</section>
<div id="sec-term-defs">
<section id="section-1.4">
        <h3 id="name-definitions-specific-to-the">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-definitions-specific-to-the" class="section-name selfRef">Definitions Specific to the UDPCL Protocol</a>
        </h3>
<p id="section-1.4-1">
This section contains definitions specific to the UDPCL protocol.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.4-2">
          <dt id="section-1.4-2.1">UDPCL Entity:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.2">
            <p id="section-1.4-2.2.1">
This is the notional UDPCL application that initiates UDPCL transfers.
This design, implementation, configuration, and specific behavior of such an entity is outside of the scope of this document.
However, the concept of an entity has utility within the scope of this document as the container and initiator of transfers.
The relationship between a UDPCL entity and UDPCL sessions is defined as follows:<a href="#section-1.4-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-2.2.2.1">
A UDPCL Entity MAY actively perform any number of transfers and should do so whenever the entity has a bundle to forward to another entity in the network.<a href="#section-1.4-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.4-2.2.2.2">
A UDPCL Entity MAY support zero or more passive listening elements that listen for transfers from other entities in the network, including non-unicast transfers.<a href="#section-1.4-2.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-1.4-2.2.3">
These relationships are illustrated in <a href="#fig-entity-transfer-relations" class="xref">Figure 2</a>.
For the remainder of this document, the term "entity" without the prefix "UDPCL" refers to a UDPCL entity.<a href="#section-1.4-2.2.3" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-2.3">UDP Conversation:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.4">
This refers to datagrams exchanged between two network peers, with each peer identified by a (unicast IP address, UDP port) tuple.
Because UDP is connectionless, there is no notion of a conversation being "opened" or "closed" and some conversations are uni-directional.<a href="#section-1.4-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-2.5">Transfer:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.6">
This refers to the procedures and mechanisms for conveyance of an individual bundle from one entity to one or more destinations.
This version of UDPCL includes a fragmentation mechanism to allow transfers which are larger than the allowable UDP datagram size.<a href="#section-1.4-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-2.7">Transmit:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.8">
This refers to a transfer outgoing from an entity as seen from that transmitting entity.<a href="#section-1.4-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-2.9">Receive:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.10">
This refers to a transfer incoming to an entity as seen from that receiving entity.<a href="#section-1.4-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-the-relationships-between-u"></span><div id="fig-entity-transfer-relations">
<figure id="figure-2">
          <div class="artwork art-text alignCenter art-ascii-art" id="section-1.4-3.1">
<pre>
+----------------------------------------+
|              UDPCL Entity              |
|                                        |      +----------------+
|   +--------------------------------+   |      |                |-+
|   | Actively Initiated Transfer #1 |---------&gt;| Other          | |
|   +--------------------------------+   |      | UDPCL Entity's | |
|                  ...                   |      | Passive        | |
|   +--------------------------------+   |      | Listener       | |
|   | Actively Initiated Transfer #n |---------&gt;|                | |
|   |                                |          |                | |
|   |         Sender Listen          |&lt;---------|                | |
|   +--------------------------------+   |      +----------------+ |
|                                        |       +-----------------+
|      +---------------------------+     |
|      | +---------------------------+   |      +----------------+
|      | | Optional Passive          |   |      |                |-+
|      +-| Listener(s)               |&lt;---------+ Other          | |
|        +---------------------------+   |      | UDPCL Entity's | |
|                                 ^      |      | Active         | |
|                                 |      |      | Initiator(s)   | |
|                                 +-------------|                | |
+----------------------------------------+      +----------------+ |
                                                 +-----------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-the-relationships-between-u" class="selfRef">The relationships between UDPCL entities</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-prococol">
<section id="section-2">
      <h2 id="name-general-protocol-descriptio">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-general-protocol-descriptio" class="section-name selfRef">General Protocol Description</a>
      </h2>
<p id="section-2-1">
The service of this protocol is the transmission of DTN bundles via the User Datagram Protocol (UDP).
This document specifies the optional fragmentation of bundles, procedures for DTLS setup and teardown, and a set of messages and entity requirements.
The general operation of the protocol is as follows.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
Fundamentally, the UDPCL is a (logically) unidirectional "transmit and forget" protocol which itself maintains no long-term state and provides no feedback to the transmitter.
The only long-term state related to UDPCL is used by DTLS in its session keeping (which is bound to a UDP conversation).
An entity receiving a bundle from a particular source address-and-port does not imply that the transmitter is willing to accept bundle transfers on that same address-and-port.
It is the obligation of a BP agent and its routing schemes to determine a bundle return path.<a href="#section-2-2" class="pilcrow">¶</a></p>
<div id="sec-cl-services">
<section id="section-2.1">
        <h3 id="name-convergence-layer-services">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-convergence-layer-services" class="section-name selfRef">Convergence Layer Services</a>
        </h3>
<p id="section-2.1-1">
This version of the UDPCL provides the following services to support the over-laying Bundle Protocol agent.
In all cases, this is not an API definition but a logical description of how the CL can interact with the BP agent.
Each of these interactions can be associated with any number of additional metadata items as necessary to support the operation of the CL or BP agent.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-2">
          <dt id="section-2.1-2.1">Begin Transmission:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.2">
The principal purpose of the UDPCL is to allow a BP agent to transmit bundle data to one or more other entities.
The receiver of each transfer is identified by an (destination) IPv4 or IPv6 address and a UDP port number (see <a href="#sec-operation" class="xref">Section 3</a> for details).
The CL does not necessarily perform any transmission queueing, but may block while transmissions are being processed at the UDP layer.
Any queueing of transmissions is the obligation of the BP agent.<a href="#section-2.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.3">Transmission Started:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.4">
The UDPCL entity indicates to the BP agent when a bundle transmission begins sending UDP datagrams.
Once started, there is no notion of a UDPCL transmission failure; a BP agent has to rely on bundle-level status reporting to track bundle progress through the network.
Because of potential queueing or DTLS setup time, this may be delayed from the BP agent providing the bundle-to-transmit.<a href="#section-2.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.5">Transmission Finished:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.6">
The UDPCL entity indicates to the BP agent when a bundle has been fully transmitted.
This is not a positive indication that any next-hop receiver has either received or processed the transfer.<a href="#section-2.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.7">Reception Started:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.8">
The UDPCL entity indicates to the BP agent when a bundle transfer has begun, which may include information about the total size of a fragmented transfer.<a href="#section-2.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.9">Reception Success:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.10">
The UDPCL entity indicates to the BP agent when a bundle has been fully transferred from a peer entity.
The transmitter of each transfer is identified by an (source) IP address and a UDP port number (see <a href="#sec-operation" class="xref">Section 3</a> for details).<a href="#section-2.1-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.11">Reception Failure:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.12">
The UDPCL entity indicates to the BP agent on certain reasons for reception failure, notably upon an unfinished transfer timeout (see <a href="#sec-ext-transfer" class="xref">Section 3.5.2</a>).<a href="#section-2.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.13">Attempt DTLS Session:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.14">
The UDPCL allows a BP agent to preemptively attempt to establish a DTLS session with a peer entity (see <a href="#sec-ext-starttls" class="xref">Section 3.5.1</a> and <a href="#sec-udpcl-security" class="xref">Section 3.7</a>).
Each session attempt can send a different set of session negotiation parameters as directed by the BP agent.<a href="#section-2.1-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.15">Close DTLS Session:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.16">
The UDPCL allows a BP agent to preemptively close an established DTLS session with a peer entity.
The closure request is on a per-session basis.<a href="#section-2.1-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.17">DTLS Session State Changed:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.18">
The UDPCL entity indicates to the BP agent when a DTLS session state changes.
The possible DTLS session states are defined in <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span>.<a href="#section-2.1-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.19">Begin Sender Listen:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.20">
The UDPCL allows a BP agent to indicate when packets on a particular address-and-port is listened for (see <a href="#sec-ext-sender-listen" class="xref">Section 3.5.3</a>).
The Sender Listen interval is configurable for each peer address-and-port.<a href="#section-2.1-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.21">End Sender Listen:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.22">
The UDPCL allows a BP agent to indicate when packets on a particular address-and-port are no longer be accepted.<a href="#section-2.1-2.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.23">Sender Listen Received:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.24">
The UDPCL entity indicates to the BP agent when a Sender Listen extension has been received from a peer.
The Sender Node ID, if present, is part of this indication.<a href="#section-2.1-2.24" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-pkix-env">
<section id="section-2.2">
        <h3 id="name-pkix-environments-and-ca-po">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-pkix-environments-and-ca-po" class="section-name selfRef">PKIX Environments and CA Policy</a>
        </h3>
<p id="section-2.2-1">
This specification gives requirements about how to use PKIX certificates issued by a Certificate Authority (CA), but does not define any mechanisms for how those certificates come to be.
The UDPCL uses the exact same mechanisms and makes the same assumptions as TCPCL in <span><a href="https://tools.ietf.org/html/draft-ietf-dtn-tcpclv4-24#section-3.4" class="relref">Section 3.4</a> of [<a href="#I-D.ietf-dtn-tcpclv4" class="xref">I-D.ietf-dtn-tcpclv4</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-policy-fragmentation">
<section id="section-2.3">
        <h3 id="name-fragmentation-policies">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-fragmentation-policies" class="section-name selfRef">Fragmentation Policies</a>
        </h3>
<p id="section-2.3-1">
It is a implementation matter for a sending entity to determine the path maximum transmit unit (PMTU) to be used as a target upper-bound UDP datagram size.
Some techniques to perform MTU discovery are defined in <span>[<a href="#RFC8899" class="xref">RFC8899</a>]</span>.
All IP packets sent by a UDPCL entity SHOULD have the "don't fragment" bit set to allow detection of PMTU issues.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">
The priority order of fragmentation is the following:<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3-3">
          <li id="section-2.3-3.1">
When possible, bundles too large to fit in one PMTU-sized packet SHOULD be fragmented at the BP layer.
Bundle payload fragmentation does not help a large bundle if extension blocks are a major contributor to bundle size, so in some circumstances BP layer fragmentation will not reduce the bundle size sufficiently.
It is outside the scope of UDPCL to manage BP agent fragmentation policies; bundles are received from the BP agent either already fragmented or not.<a href="#section-2.3-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-3.2">
Bundles too large to fit in one PMTU-sized packet SHALL be fragmented as a UDPCL transfer (see <a href="#sec-transfer" class="xref">Section 3.6</a>).
Fragmentation at this level treats bundle transfers as opaque data, so it is independent of bundle block sizes or counts.<a href="#section-2.3-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-3.3">
All IP packets larger than expected PMTU SHALL be fragmented by the transmitting entity to fit within one PMTU.
Because of the issues listed in <span><a href="https://rfc-editor.org/rfc/rfc8085#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8085" class="xref">RFC8085</a>]</span> and <span>[<a href="#RFC8900" class="xref">RFC8900</a>]</span>, it is best to avoid IP fragmentation as much as possible.<a href="#section-2.3-3.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.3-4">
A UDPCL entity SHOULD NOT proactively drop an outgoing transfer due to datagram size.
If intermediate network nodes drop IP packets it is an implementation matter to receive network feedback (e.g. ICMP Packet Too Big).<a href="#section-2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-2.4">
        <h3 id="name-error-checking-policies">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-error-checking-policies" class="section-name selfRef">Error Checking Policies</a>
        </h3>
<p id="section-2.4-1">
The core Bundle Protocol specification assumes that bundles are transferring over an erasure channel, i.e., a channel that either delivers packets correctly or
not at all.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">
A UDP transmitter SHALL NOT disable UDP checksums.
A UDP receiver SHALL NOT disable the checking of received UDP checksums.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">
Even when UDP checksums are enabled, a small probability of UDP packet corruption remains.
In some environments, it may be acceptable for a BP agent to occasionally receive corrupted input.
In general, however, a UDPCL entity SHOULD insure the a bundle's blocks are either covered by a CRC or a BPSec integrity check.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
</section>
<section id="section-2.5">
        <h3 id="name-congestion-control-policies">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-congestion-control-policies" class="section-name selfRef">Congestion Control Policies</a>
        </h3>
<p id="section-2.5-1">
The applications using UDPCL for bundle transport SHALL conform to the congestion control requirements of <span><a href="https://rfc-editor.org/rfc/rfc8085#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8085" class="xref">RFC8085</a>]</span>.
The application SHALL either perform active congestion control of bundles or behave as the Low Data-Volume application as defined in <span><a href="https://rfc-editor.org/rfc/rfc8085#section-3.1.3" class="relref">Section 3.1.3</a> of [<a href="#RFC8085" class="xref">RFC8085</a>]</span>.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">
When nodes have bidirectional transfer capability, the bundle deletion reason code "traffic pared" can be used by a receiving agent to signal to the bundle source application that throttling of bundles along that path SHOULD occur.<a href="#section-2.5-2" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="sec-operation">
<section id="section-3">
      <h2 id="name-udpcl-operation">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-udpcl-operation" class="section-name selfRef">UDPCL Operation</a>
      </h2>
<p id="section-3-1">
This section defines the UDPCL protocol and its interactions with under-layers (IP and UDP) and over-layers (BP), as illustrated in <a href="#fig-udpcl-ip-stack" class="xref">Figure 1</a>.
The section is organized from the network layer up toward the BP layer.
It also discusses behavior within the UDPCL layer, which is illustrated in <a href="#fig-udpcl-sublayers" class="xref">Figure 3</a>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-breakdown-of-sub-layers-wit"></span><div id="fig-udpcl-sublayers">
<figure id="figure-3">
        <div class="artwork art-text alignCenter art-ascii-art" id="section-3-2.1">
<pre>
+------------------------------------------+
|  Bundle Transfer  |  Extension Signaling | &lt;- Sequencing /
+------------------------------------------+      fragmentation
|  Bundle  | Ext. Map |  ...  |  Padding   | &lt;- Messaging
+------------------------------------------+
|               UDPCL Packet               | &lt;- Packetization
+------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-breakdown-of-sub-layers-wit" class="selfRef">Breakdown of sub-layers within the UDPCL</a>
        </figcaption></figure>
</div>
<div id="sec-ip-addressing">
<section id="section-3.1">
        <h3 id="name-ip-addressing">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-ip-addressing" class="section-name selfRef">IP Addressing</a>
        </h3>
<p id="section-3.1-1">
The earlier UDPCL specification in <span>[<a href="#RFC7122" class="xref">RFC7122</a>]</span> did not include guidance on IP addressing, interface sourcing, or potential use of multicast, though the architecture of <span>[<a href="#RFC4838" class="xref">RFC4838</a>]</span> explicitly includes multicast and anycast as expected network modes.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
The BP agent determines the mapping from destination EID to next-hop CL parameters, including transfer destination address and transfer source interface.
Some EIDs represent unicast destinations and others non-unicast destinations as defined in <span><a href="https://tools.ietf.org/html/draft-ietf-dtn-bpbis-31#section-4.2.5.1" class="relref">Section 4.2.5.1</a> of [<a href="#I-D.ietf-dtn-bpbis" class="xref">I-D.ietf-dtn-bpbis</a>]</span>.
The unicast-ness of an EID does not necessarily correspond with the unicast-ness, as some bundle routing schemes involve attempting multiple parallel paths to a unicast endpoint.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">
For unicast transfers to a single node, the destination address SHALL be a non-multicast IPv4 or IPv6 address (which does include link-local addresses).
For unicast transfers, the source interface address MAY be supplied by the BP agent or otherwise determined by the operating system IP routing.
When performing unicast transfers, a UDPCL entity SHOULD require DTLS use (see <a href="#sec-udpcl-security" class="xref">Section 3.7</a>) or restrict the network to one protected by IPsec or some other under-layer security mechanism (e.g., a virtual private network).<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">
For multicast transfers to one or more nodes, the destination address SHALL be a multicast IPv4 <span>[<a href="#IANA-IPv4-MCAST" class="xref">IANA-IPv4-MCAST</a>]</span> or IPv6 <span>[<a href="#IANA-IPv6-MCAST" class="xref">IANA-IPv6-MCAST</a>]</span> address.
For multicast transfers, the source interface address MUST be supplied by the BP agent rather than inferred by the UDPCL entity.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-udp-header">
<section id="section-3.2">
        <h3 id="name-udp-header">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-udp-header" class="section-name selfRef">UDP Header</a>
        </h3>
<p id="section-3.2-1">
Destination port number 4556 has been assigned by IANA <span>[<a href="#IANA-PORTS" class="xref">IANA-PORTS</a>]</span> as the Registered Port number for the UDP convergence layer and SHALL be used as a default.
Other destination port numbers MAY be used per local configuration.
Determining a passive entity's destination port number (if different from the registered UDPCL port number) is up to the implementation.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">
Any source port number MAY be used for UDPCL transfers.
Typically an operating system assigned number in the UDP Ephemeral range (49152-65535) is used.
For repeated messaging to the same destination address-and-port, the active entity SHOULD reuse the same source address-and-port.
Reusing source address-and-port allows simplifies network monitoring and analysis and also enables bi-directional messaging as defined in <a href="#sec-ext-sender-listen" class="xref">Section 3.5.3</a>.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-udpcl-packet">
<section id="section-3.3">
        <h3 id="name-udpcl-packets">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-udpcl-packets" class="section-name selfRef">UDPCL Packets</a>
        </h3>
<p id="section-3.3-1">
The lowest layer of UDPCL communication are individual-datagram packets.
To exchange UDPCL data, an active entity SHALL transmit a UDP datagram to a listening passive entity in accordance with <span>[<a href="#RFC0768" class="xref">RFC0768</a>]</span>, typically by using the services provided by the operating system.
For backward compatibility with <span>[<a href="#RFC7122" class="xref">RFC7122</a>]</span>, UDPCL has no explicit message type identifier.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">
Each UDP datagram SHALL contain one or more UDPCL message as defined in <a href="#sec-udpcl-message" class="xref">Section 3.4</a>.
Each type of message defines additional restrictions on how it may be used in a packet.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">
The following are special cases of UDPCL packet uses.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.3-4">
          <dt id="section-3.3-4.1">Unframed Transfer:</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-4.2">
An unframed transfer packet SHALL consist of a single encoded BPv6 or BPv7 bundle with no padding.
This provides backward compatibility with <span>[<a href="#RFC7122" class="xref">RFC7122</a>]</span> and a allows a trivial use of UDPCL which is just embedding an encoded bundle in a UDP datagram.<a href="#section-3.3-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-4.3">Keepalive</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-4.4">
A keepalive packet SHALL consist of exactly four octets of padding with no preceding message.
This behavior maintains backward compatibility with <span>[<a href="#RFC7122" class="xref">RFC7122</a>]</span>.<a href="#section-3.3-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-udpcl-message">
<section id="section-3.4">
        <h3 id="name-udpcl-messages">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-udpcl-messages" class="section-name selfRef">UDPCL Messages</a>
        </h3>
<p id="section-3.4-1">
The middle layer of UDPCL communication are unframed, but self-delimited, messages.
Specific message types MAY be concatenated together into a single packet, each message type indicates any restrictions on how it can be used within a packet.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">
For backward compatibility with <span>[<a href="#RFC7122" class="xref">RFC7122</a>]</span>, UDPCL has no explicit message type identifier.
The message type is inferred by the inspecting the data contents according to the following rules:<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.4-3">
          <dt id="section-3.4-3.1">BPv6 Bundle:</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-3.2">
All encoded BP version 6 bundles begin with the version identifier octet 0x06 in accordance with <span>[<a href="#RFC5050" class="xref">RFC5050</a>]</span>.
A message with a leading octet value of 0x06 SHALL be treated as a BPv6 bundle.
Multiple BPv6 Bundles SHOULD NOT be present in one UDPCL packet to maintain compatibility with <span>[<a href="#RFC7122" class="xref">RFC7122</a>]</span>.<a href="#section-3.4-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-3.3">BPv7 Bundle:</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-3.4">
            <p id="section-3.4-3.4.1">
All encoded BP version 7 bundles begin with a CBOR array head in accordance with <span>[<a href="#I-D.ietf-dtn-bpbis" class="xref">I-D.ietf-dtn-bpbis</a>]</span>.
A message with a leading octet value indicating CBOR array (major type 4) SHALL be treated as a BPv7 bundle.<a href="#section-3.4-3.4.1" class="pilcrow">¶</a></p>
<p id="section-3.4-3.4.2">
BPv7 bundles transmitted via UDPCL SHALL NOT include any leading CBOR tag.
If the BP agent provides bundles with such tags the transmitting UDPCL entity SHALL remove them.<a href="#section-3.4-3.4.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-3.5">Extension Map:</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-3.6">
All UDPCL extensions SHALL be contained in a CBOR map in accordance with the definitions of <a href="#sec-udpcl-extension" class="xref">Section 3.5</a>.
The encoded Extension Map SHALL NOT have any CBOR tags.
A message with a leading octet value indicating CBOR map (major type 5) SHALL be treated as an Extension Map.<a href="#section-3.4-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-3.7">Padding:</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-3.8">
            <p id="section-3.4-3.8.1">
Padding data SHALL be a sequence of octets all with value 0x00.
A message with a leading octet value of 0x00 SHALL be treated as padding.<a href="#section-3.4-3.8.1" class="pilcrow">¶</a></p>
<p id="section-3.4-3.8.2">
Padding is used to ensure a UDP datagram is exactly a desired size.
Because padding has no intrinsic length indication, if present it SHALL be the last contents of any UDPCL packet.
A receiving UDPCL entity SHALL ignore all padding, including any trailing non-zero octets.<a href="#section-3.4-3.8.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-3.9">DTLS Record:</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-3.10">
            <p id="section-3.4-3.10.1">
In addition to the UDPCL specific messaging, immediately after a DTLS Initiation (see <a href="#sec-ext-starttls" class="xref">Section 3.5.1</a>) the DTLS handshake sequence will begin.
Data with a leading octet value of 0x16 SHALL be treated as a DTLS handshake record in accordance with <span><a href="https://rfc-editor.org/rfc/rfc6347#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC6347" class="xref">RFC6347</a>]</span>.<a href="#section-3.4-3.10.1" class="pilcrow">¶</a></p>
<p id="section-3.4-3.10.2">
If the datagram with the DTLS Initiation extension is not received by an entity, the entity SHOULD still detect the DTLS handshake records and start the handshake sequence at that point.
Data with a leading octet value of 0x17--0x19 SHALL be treated as a DTLS sequencing failure; DTLS non-handshake records should never be seen by the UDPCL messaging layer.<a href="#section-3.4-3.10.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.4-4">
A summary of how a receiving UDPCL entity can interpret the first octet of a datagram is listed in <a href="#tab-message-first-octet" class="xref">Table 1</a>.
When inspecting using CBOR major types, the range of values is caused by the CBOR head encoding of <span>[<a href="#RFC8949" class="xref">RFC8949</a>]</span>.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<span id="name-first-octet-contents"></span><div id="tab-message-first-octet">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-first-octet-contents" class="selfRef">First-Octet Contents</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Octet Value</th>
              <th class="text-left" rowspan="1" colspan="1">Message Content</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00</td>
              <td class="text-left" rowspan="1" colspan="1">Padding (remainder of packet)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x06</td>
              <td class="text-left" rowspan="1" colspan="1">BPv6 Bundle</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x16--0x19</td>
              <td class="text-left" rowspan="1" colspan="1">DTLS Record (remainder of packet)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x80--0x9F</td>
              <td class="text-left" rowspan="1" colspan="1">BPv7 Bundle (CBOR array)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0xA0--0xBF</td>
              <td class="text-left" rowspan="1" colspan="1">Extension Map (CBOR map)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">others</td>
              <td class="text-left" rowspan="1" colspan="1">unused</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-udpcl-extension">
<section id="section-3.5">
        <h3 id="name-udpcl-extension-items">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-udpcl-extension-items" class="section-name selfRef">UDPCL Extension Items</a>
        </h3>
<p id="section-3.5-1">
Extensions to UDPCL are encoded per-datagram in a single CBOR map as defined in <a href="#sec-udpcl-message" class="xref">Section 3.4</a>.
Each UDPCL extension item SHALL be identified by a unique Extension ID used as a key in the Extension Map.
Extension ID values SHALL be a CBOR int item no longer than 16-bits.
Extension ID assignments are listed in <a href="#sec-iana-extension-types" class="xref">Section 6.2</a>.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">
Unless prohibited by particular extension type requirements, a single Extension Map MAY contain any combination of extension items.
Receivers SHALL ignore extension items with unknown Extension ID and continue to process known extension items.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<span id="name-extension-map-structure-cdd"></span><div id="fig-udpcl-ext-map">
<figure id="figure-4">
          <div id="section-3.5-3.1">
<pre class="sourcecode lang-cddl">
; Map structure requiring non-zero-int keys.
; CDDL cannot enforce type-specific requirements about other items
; being present (or not present) in the same map.
udpcl-ext-map = $udpcl-ext-map .within udpcl-ext-map-structure
$udpcl-ext-map = {
    * $$udpcl-ext-item
}
udpcl-ext-map-structure = {
    * ext-key =&gt; any
}
ext-key = (int .size 2) .ne 0
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-extension-map-structure-cdd" class="selfRef">Extension Map structure CDDL</a>
          </figcaption></figure>
</div>
<p id="section-3.5-4">
The following subsections define the initial UDPCL extension types.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<div id="sec-ext-starttls">
<section id="section-3.5.1">
          <h4 id="name-dtls-initiation-starttls">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-dtls-initiation-starttls" class="section-name selfRef">DTLS Initiation (STARTTLS)</a>
          </h4>
<p id="section-3.5.1-1">
This extension item indicates that the transmitter is about to begin a DTLS handshake sequence in accordance with <a href="#sec-udpcl-security" class="xref">Section 3.7</a>.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<p id="section-3.5.1-2">
The DTLS Initiation value SHALL be an untagged null value.
There are no DTLS parameters actually transmitted as part of this extension, it only serves to indicate to the recipient that the next datagram will be a DTLS ClientHello.
Although the datagram containing this extension is not retransmitted, the DTLS handshake itself will retransmit ClientHello messages until confirmation is received.<a href="#section-3.5.1-2" class="pilcrow">¶</a></p>
<span id="name-dtls-initiation-cddl"></span><figure id="figure-5">
            <div id="section-3.5.1-3.1">
<pre class="sourcecode lang-cddl">
$$udpcl-ext-item //= (
    5: null
)
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-dtls-initiation-cddl" class="selfRef">DTLS Initiation CDDL</a>
            </figcaption></figure>
<p id="section-3.5.1-4">
If the entity is configured to enable exchanging messages according to DTLS 1.2 <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span> or any successors which are compatible with that DTLS ClientHello, the first message in any sequence to a unicast recipient SHALL be an Extension Map with the DTLS Initiation item.
The RECOMMENDED policy is to enable DTLS for all unicast recipients, even if security policy does not allow or require authentication.
This follows the opportunistic security model of <span>[<a href="#RFC7435" class="xref">RFC7435</a>]</span>, though an active attacker could interfere with the exchange in such cases (see <a href="#sec-threat-tls-strip" class="xref">Section 5.3</a>).<a href="#section-3.5.1-4" class="pilcrow">¶</a></p>
<p id="section-3.5.1-5">
The Extension Map containing a DTLS Initiation item SHALL NOT contain any other items.
A DTLS Initiation item SHALL NOT be present in any message transmitted within a DTLS session.
A receiver of a DTLS Initiation item within a DTLS session SHALL ignore it.
Between transmitting a DTLS Initiation item and finishing a DTLS handshake (either success or failure) an entity SHALL NOT transmit any other UDP datagrams in that same conversation.<a href="#section-3.5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-ext-transfer">
<section id="section-3.5.2">
          <h4 id="name-bundle-transfer">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-bundle-transfer" class="section-name selfRef">Bundle Transfer</a>
          </h4>
<p id="section-3.5.2-1">
This extension item allows CL-layer fragmentation of bundle transfers as defined in <a href="#sec-transfer" class="xref">Section 3.6</a>.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
<p id="section-3.5.2-2">
The Transfer value SHALL be an untagged CBOR array of four items.
The items are defined in the following order:<a href="#section-3.5.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5.2-3">
            <dt id="section-3.5.2-3.1">Transfer ID:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.2-3.2">
This field SHALL be a CBOR uint item no larger than 32-bits, which is used to correlate multiple fragments.<a href="#section-3.5.2-3.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.5.2-3.3">Total Length:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.2-3.4">
This field SHALL be a CBOR uint item no larger than 32-bits, which is used to indicate the total length (in octets) of the transfer.
If multiple Transfer items for the same Transfer ID are received with differing Total Length values, the receiver SHALL treat the transfer as being malformed and refuse to handle any further fragments associated with the transfer.<a href="#section-3.5.2-3.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.5.2-3.5">Fragment Offset:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.2-3.6">
This field SHALL be a CBOR uint item no larger than 32-bits, which is used to indicate the offset (in octets) into the transfer for the start of this fragment.<a href="#section-3.5.2-3.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.5.2-3.7">Fragment Data:</dt>
            <dd style="margin-left: 1.5em" id="section-3.5.2-3.8">
This field SHALL be a CBOR bstr item no larger than 2^32-1 octets, in which the fragment data is contained.
The bstr itself indicates the length of the fragment data.<a href="#section-3.5.2-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-transfer-cddl"></span><figure id="figure-6">
            <div id="section-3.5.2-4.1">
<pre class="sourcecode lang-cddl">
$$udpcl-ext-item //= (
    2: [
        transfer-id: uint .size 4,
        total-length: uint .size 4,
        fragment-offset: uint .size 4,
        fragment-data: bstr,
    ]
)
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-transfer-cddl" class="selfRef">Transfer CDDL</a>
            </figcaption></figure>
</section>
</div>
<div id="sec-ext-sender-listen">
<section id="section-3.5.3">
          <h4 id="name-sender-listen">
<a href="#section-3.5.3" class="section-number selfRef">3.5.3. </a><a href="#name-sender-listen" class="section-name selfRef">Sender Listen</a>
          </h4>
<p id="section-3.5.3-1">
This extension item indicates that the transmitter is listening for UDPCL packets on the source address-and-port used to transmit the message containing this extension item.
This is different from simply listening on a UDP port (either the default or any other) when the entity is behind a NAT or firewall which will not allow unsolicited UDP/IP datagrams.
Although the packet containing this extension is not retransmitted, the time interval is finite and the extension is sent repeatedly while the transmitter continues to listen for packets.
There is no positive indication that packets are no longer accepted; the Sender Listen just stops being transmitted.<a href="#section-3.5.3-1" class="pilcrow">¶</a></p>
<p id="section-3.5.3-2">
The Sender Listen value SHALL be an untagged uint value representing the interval of time (in milliseconds) that the entity is willing to accept UDPCL packets on the source address-and-port used for the associated transmitted message.
After transmitting a Sender Listen, the entity SHALL listen for and accept datagrams on the source address-and-port used for the associated transmitted message.
As long as the entity is still willing to accept packets, at the end of one accept interval the entity SHALL transmit another Sender Listen item.
This repetition continues until the entity is no longer willing to listen for packets.<a href="#section-3.5.3-2" class="pilcrow">¶</a></p>
<p id="section-3.5.3-3">
A receiving entity SHOULD treat a peer as no longer listening after an implementation-defined timeout since the last received Sender Listen item.
A RECOMMENDED Sender Listen timeout is three (3) times the associated time duration; this allows a single dropped datagram to not interrupt a continuous sequence.<a href="#section-3.5.3-3" class="pilcrow">¶</a></p>
<span id="name-sender-listen-cddl"></span><figure id="figure-7">
            <div id="section-3.5.3-4.1">
<pre class="sourcecode lang-cddl">
$$udpcl-ext-item //= (
    3: time-duration,
)
time-duration = uint
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-sender-listen-cddl" class="selfRef">Sender Listen CDDL</a>
            </figcaption></figure>
<p id="section-3.5.3-5">
Unlike the generic source port requirement in <a href="#sec-udp-header" class="xref">Section 3.2</a>, when repeated Sender Listen are transmitted in a sequence a consistent source address-and-port SHALL be used.<a href="#section-3.5.3-5" class="pilcrow">¶</a></p>
<p id="section-3.5.3-6">
The Sender Listen interval SHOULD be no shorter than 1 second and no longer than 60 seconds.<a href="#section-3.5.3-6" class="pilcrow">¶</a></p>
<p id="section-3.5.3-7">
An entity SHOULD include a Sender Node ID item along with a Sender Listen item if the conditions of <a href="#sec-ext-sender-nodeid" class="xref">Section 3.5.4</a> are met.
An entity MAY include any other extension type along with a Sender Listen item.
An entity SHALL NOT transmit a Sender Listen item before or along with a DTLS Initiate if DTLS is desired for a conversation.<a href="#section-3.5.3-7" class="pilcrow">¶</a></p>
<p id="section-3.5.3-8">
This extension is not a neighbor discovery mechanism and does not indicate an entity listening generally on a particular UDP port.
Sender Listen applies only to UDP datagrams from the the peer address-and-port.
An entity SHALL NOT include a Sender Listen item in a message transmitted to a multicast address.<a href="#section-3.5.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-ext-sender-nodeid">
<section id="section-3.5.4">
          <h4 id="name-sender-node-id">
<a href="#section-3.5.4" class="section-number selfRef">3.5.4. </a><a href="#name-sender-node-id" class="section-name selfRef">Sender Node ID</a>
          </h4>
<p id="section-3.5.4-1">
This extension item indicates the Node ID of the transmitter.
For DTLS-secured sessions (see <a href="#sec-dtls-authentication" class="xref">Section 3.7.4</a>) this extension can be used to disambiguate an end-entity certificate which has multiple NODE-ID values.<a href="#section-3.5.4-1" class="pilcrow">¶</a></p>
<p id="section-3.5.4-2">
The Sender Node ID value SHALL be an untagged tstr value containing a Node ID.
Every Node ID SHALL be a URI consistent with the requirements of <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span> and the URI schemes of the IANA "Bundle Protocol URI Scheme Type" registry <span>[<a href="#IANA-BUNDLE" class="xref">IANA-BUNDLE</a>]</span>.<a href="#section-3.5.4-2" class="pilcrow">¶</a></p>
<span id="name-sender-node-id-cddl"></span><figure id="figure-8">
            <div id="section-3.5.4-3.1">
<pre class="sourcecode lang-cddl">
$$udpcl-ext-item //= (
    4: nodeid,
)
nodeid = tstr
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-sender-node-id-cddl" class="selfRef">Sender Node ID CDDL</a>
            </figcaption></figure>
<p id="section-3.5.4-4">
An entity SHOULD NOT include a Sender Node ID item if a DTLS session has already been established and the presented end-entity certificate contains a single NODE-ID.
In this case there is no ambiguity about which Node ID is identified by the certificate.<a href="#section-3.5.4-4" class="pilcrow">¶</a></p>
<p id="section-3.5.4-5">
If an entity receives a peer Node ID which is not authenticated (by the procedure of <a href="#sec-dtls-authentication" class="xref">Section 3.7.4</a>) that Node ID SHOULD NOT be used by a BP agent for any discovery or routing functions.
Trusting an unauthenticated Node ID can lead to the threat described in <a href="#sec-threat-node-impersonation" class="xref">Section 5.7</a>.<a href="#section-3.5.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-transfer">
<section id="section-3.6">
        <h3 id="name-explicit-transfers">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-explicit-transfers" class="section-name selfRef">Explicit Transfers</a>
        </h3>
<p id="section-3.6-1">
This version of UDPCL supports CL-layer fragmentation of bundles larger than the PMTU would otherwise allow.
Policies related to fragmentation at, above, or below the UDPCL layer are defined in <a href="#sec-policy-fragmentation" class="xref">Section 2.3</a>.
The entire fragmented bundle is referred to as a Transfer and individual fragments of a transfer are encoded as Transfer extension items in accordance with <a href="#sec-ext-transfer" class="xref">Section 3.5.2</a>.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">
This mechanism also allows a bundle transfer to be transmitted along with additional extension items, which the unframed bundle-in-datagram data does not.
This specification does not define any extension items which augment an associated transfer.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<div id="sec-transfer-id">
<section id="section-3.6.1">
          <h4 id="name-bundle-transfer-id">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-bundle-transfer-id" class="section-name selfRef">Bundle Transfer ID</a>
          </h4>
<p id="section-3.6.1-1">
Each Transfer item contains a Transfer ID which is used to correlate messages for a single bundle transfer.
A Transfer ID does not attempt to address uniqueness of the bundle data itself and has no relation to concepts such as bundle fragmentation.
Each invocation of UDPCL by the BP agent, requesting transmission of a bundle (fragmentary or otherwise), can cause the initiation of a single UDPCL transfer.<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<p id="section-3.6.1-2">
Because UDPCL operation is connectionless, Transfer IDs from each entity SHALL be unique for the operating duration of the entity.
In practice, the ID needs only be unique for the longest receiver reassembly time window; but because that information is not part of the protocol there is no way for an transmitting entity to know the reassembly time window of any receiver (see <a href="#sec-transfer-fragmentation" class="xref">Section 3.6.2</a>).
When there are bidirectional bundle transfers between UDPCL entities, an entity SHOULD NOT rely on any relation between Transfer IDs originating from each side of the conversation.<a href="#section-3.6.1-2" class="pilcrow">¶</a></p>
<p id="section-3.6.1-3">
Although there is not a strict requirement for Transfer ID initial values or ordering (see <a href="#sec-security-xferid" class="xref">Section 5.11</a>), in the absence of any other mechanism for generating Transfer IDs an entity SHALL use the following algorithm:
the initial Transfer ID from each entity is zero;
subsequent Transfer ID values are incremented from the prior Transfer ID value by one;
upon exhaustion of the entire 32-bit Transfer ID space, the subsequent Transfer ID value is zero.<a href="#section-3.6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-transfer-fragmentation">
<section id="section-3.6.2">
          <h4 id="name-fragmentation-and-reassembl">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-fragmentation-and-reassembl" class="section-name selfRef">Fragmentation and Reassembly</a>
          </h4>
<p id="section-3.6.2-1">
The full data content of a transfer SHALL be an unframed (BPv6 or BPv7) bundle as defined in <a href="#sec-udpcl-message" class="xref">Section 3.4</a>.
A receiving entity SHALL discard any reassembled transfer which does not properly contain a bundle.<a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
<p id="section-3.6.2-2">
A transmitting entity MAY produce a Transfer with a single fragment (i.e., a Fragment Data size identical to the Total Length).
A transmitting entity SHALL NOT produce Transfer fragments with overlapping span.
A transmitting entity SHOULD transmit Transfer fragments in order of Fragment Offset; this makes the behavior deterministic.<a href="#section-3.6.2-2" class="pilcrow">¶</a></p>
<p id="section-3.6.2-3">
Because of the nature of UDP transport, there is no guaranteed order or timing of received Transfer items.
A receiving entity SHALL consider a transport as finished when Fragment Data has been received which fully covers the Total Length of the transfer.<a href="#section-3.6.2-3" class="pilcrow">¶</a></p>
<p id="section-3.6.2-4">
A receiving entity SHALL discard any Transfer item containing different CBOR types than defined in this document.
A receiving entity SHALL discard any Transfer item containing a fragment with an overlapping span.
Because there is no feedback indication at the UDPCL layer, a transmitter has no indication when a transfer is discarded by the receiver.<a href="#section-3.6.2-4" class="pilcrow">¶</a></p>
<p id="section-3.6.2-5">
A receiving entity SHOULD discard unfinished transfer state after an implementation-defined timeout since the last received fragment.
Entities SHOULD choose a transfer timeout interval no longer than one minute (60 seconds).
Discarding an unfinished transfer causes no indication to the transmitting entity, but does indicate this to the BP agent.
This timeout is purely receiver-side and represents the maximum allowed time between sequential received datagrams (in any order), which should be short if the datagrams take a similar network path.<a href="#section-3.6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-udpcl-security">
<section id="section-3.7">
        <h3 id="name-udpcl-security">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-udpcl-security" class="section-name selfRef">UDPCL Security</a>
        </h3>
<p id="section-3.7-1">
This version of the UDPCL supports establishing a DTLS session within an existing UDP conversation.
When DTLS is used within the UDPCL it affects the entire conversation.
There is no concept of a plaintext message being sent in a conversation after a DTLS session is established.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<p id="section-3.7-2">
Once established, the lifetime of a DTLS session SHALL be bound by the DTLS session ticket lifetime or either peer sending a Closure Alert record.<a href="#section-3.7-2" class="pilcrow">¶</a></p>
<p id="section-3.7-3">
Subsequent DTLS session attempts to the same passive entity MAY attempt to use the DTLS session resumption feature.
There is no guarantee that the passive entity will accept the request to resume a DTLS session, and the active entity cannot assume any resumption outcome.<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<div id="sec-dtls-identification">
<section id="section-3.7.1">
          <h4 id="name-entity-identification">
<a href="#section-3.7.1" class="section-number selfRef">3.7.1. </a><a href="#name-entity-identification" class="section-name selfRef">Entity Identification</a>
          </h4>
<p id="section-3.7.1-1">
The UDPCL uses DTLS for certificate exchange in both directions to identify each entity and to allow each entity to authenticate its peer.
Each certificate can potentially identify multiple entities and there is no problem using such a certificate as long as the identifiers are sufficient to meet authentication policy (as described in later sections) for the entity which presents it.<a href="#section-3.7.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.1-2">
The types and priorities of identities used by DTLS in UDPCL is the same as those for TLS in TCPCL as defined in <span><a href="https://tools.ietf.org/html/draft-ietf-dtn-tcpclv4-24#section-4.4.1" class="relref">Section 4.4.1</a> of [<a href="#I-D.ietf-dtn-tcpclv4" class="xref">I-D.ietf-dtn-tcpclv4</a>]</span>.<a href="#section-3.7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-udpcl-cert-profile">
<section id="section-3.7.2">
          <h4 id="name-certificate-profile-for-udp">
<a href="#section-3.7.2" class="section-number selfRef">3.7.2. </a><a href="#name-certificate-profile-for-udp" class="section-name selfRef">Certificate Profile for UDPCL</a>
          </h4>
<p id="section-3.7.2-1">
All end-entity certificates used by a UDPCL entity SHALL conform to the profile defined in <span><a href="https://tools.ietf.org/html/draft-ietf-dtn-tcpclv4-24#section-4.4.2" class="relref">Section 4.4.2</a> of [<a href="#I-D.ietf-dtn-tcpclv4" class="xref">I-D.ietf-dtn-tcpclv4</a>]</span>.<a href="#section-3.7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-dtls-handshake">
<section id="section-3.7.3">
          <h4 id="name-dtls-handshake">
<a href="#section-3.7.3" class="section-number selfRef">3.7.3. </a><a href="#name-dtls-handshake" class="section-name selfRef">DTLS Handshake</a>
          </h4>
<p id="section-3.7.3-1">
The signaling for DTLS Initiation is described in <a href="#sec-ext-starttls" class="xref">Section 3.5.1</a>.
After sending or receiving an Extension Map containing a DTLS Initiation item, an entity SHALL begin the handshake procedure of <span><a href="https://rfc-editor.org/rfc/rfc6347#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC6347" class="xref">RFC6347</a>]</span>.
By convention, this protocol uses the entity which sent the DTLS Initiation (the active peer) as the "client" role of the DTLS handshake request.<a href="#section-3.7.3-1" class="pilcrow">¶</a></p>
<p id="section-3.7.3-2">
Upon receiving an unexpected ClientHello record outside of a DTLS session, an entity SHALL begin the DTLS handshake procedure as if a DTLS Initiation had been received.
This allows recovering from a dropped packet containing DTLS Initiation.<a href="#section-3.7.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-dtls-authentication">
<section id="section-3.7.4">
          <h4 id="name-dtls-authentication">
<a href="#section-3.7.4" class="section-number selfRef">3.7.4. </a><a href="#name-dtls-authentication" class="section-name selfRef">DTLS Authentication</a>
          </h4>
<p id="section-3.7.4-1">
The function and mechanism of DTLS authentication in UDPCL is the same as for TLS in TCPCL as defined in <span><a href="https://tools.ietf.org/html/draft-ietf-dtn-tcpclv4-24#section-4.4.4" class="relref">Section 4.4.4</a> of [<a href="#I-D.ietf-dtn-tcpclv4" class="xref">I-D.ietf-dtn-tcpclv4</a>]</span>, with the exception that Node ID Authentication is based on an optional Sender Node ID extension (see <a href="#sec-ext-sender-nodeid" class="xref">Section 3.5.4</a>) used to disambiguate when an end-entity certificate contains multiple NODE-ID values.<a href="#section-3.7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-dtls-auth-policy-rec">
<section id="section-3.7.5">
          <h4 id="name-policy-recommendations">
<a href="#section-3.7.5" class="section-number selfRef">3.7.5. </a><a href="#name-policy-recommendations" class="section-name selfRef">Policy Recommendations</a>
          </h4>
<p id="section-3.7.5-1">
The policy recommendations given here are are the same as those for TCPCL in <span><a href="https://tools.ietf.org/html/draft-ietf-dtn-tcpclv4-24#section-4.4.5" class="relref">Section 4.4.5</a> of [<a href="#I-D.ietf-dtn-tcpclv4" class="xref">I-D.ietf-dtn-tcpclv4</a>]</span>.
They are restated in this document for clarity.<a href="#section-3.7.5-1" class="pilcrow">¶</a></p>
<p id="section-3.7.5-2">
A RECOMMENDED security policy is to enable the use of OCSP checking during DTLS handshake.
A RECOMMENDED security policy is that if an Extended Key Usage is present that it needs to contain "id-kp-bundleSecurity" of <span>[<a href="#IANA-SMI" class="xref">IANA-SMI</a>]</span> to be usable with UDPCL security.
A RECOMMENDED security policy is to require a validated NODE-ID and to ignore any network-level DNS-ID or IPADDR-ID.<a href="#section-3.7.5-2" class="pilcrow">¶</a></p>
<p id="section-3.7.5-3">
This policy relies on and informs the certificate requirements in <a href="#sec-udpcl-cert-profile" class="xref">Section 3.7.2</a>.
This policy assumes that a DTN-aware CA (see <a href="#sec-pkix-env" class="xref">Section 2.2</a>) will only issue a certificate for a Node ID when it has verified that the private key holder actually controls the DTN node; this is needed to avoid the threat identified in <a href="#sec-threat-node-impersonation" class="xref">Section 5.7</a>.
This policy requires that a certificate contain a NODE-ID and allows the certificate to also contain network-level identifiers.
A tailored policy on a more controlled network could relax the requirement on Node ID validation and allow just network-level identifiers to authenticate a peer.<a href="#section-3.7.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-3.7.6">
          <h4 id="name-example-secured-and-bidirec">
<a href="#section-3.7.6" class="section-number selfRef">3.7.6. </a><a href="#name-example-secured-and-bidirec" class="section-name selfRef">Example Secured and Bidirectional Transfers</a>
          </h4>
<p id="section-3.7.6-1">
This simple example shows a sequence of pre-transfer setup followed by a set of (unrelated) bundle transfers.
All messaging in this example occurs between the same Entity A address-and-port and Entity B address-and-port.<a href="#section-3.7.6-1" class="pilcrow">¶</a></p>
<p id="section-3.7.6-2">
The example Entity A has a policy to only send or receive bundles within a DTLS session, so any outgoing bundles to Entity B are queued until the DTLS session is established.
Because Entity A is willing to accept transfers on its ephemeral UDP port, the first outgoing message after the DTLS handshake contains the Sender Listen extension (along with a Sender Node ID indicating its identity to Entity B).<a href="#section-3.7.6-2" class="pilcrow">¶</a></p>
<span id="name-an-example-of-the-flow-of-p"></span><div id="fig-conversation-example">
<figure id="figure-9">
            <div class="artwork art-text alignCenter art-ascii-art" id="section-3.7.6-3.1">
<pre>
         Entity A                             Entity B
        active peer                         passive peer

+-------------------------+
|    Initiate DTLS Ext.   | -&gt;
+-------------------------+
+-------------------------+         +-------------------------+
|     DTLS Negotiation    | -&gt;   &lt;- |     DTLS Negotiation    |
|       (as client)       |         |       (as server)       |
+-------------------------+         +-------------------------+

           DNS-ID and IPADDR-ID authentication occurs.
               Secured UDPCL messaging can begin.

+-------------------------+
|   Sender Listen Ext.    | -&gt;
|   Sender Node ID Ext.   |
+-------------------------+

                  NODE-ID authentication occurs.
         DTLS session is established, transfers can begin.

+-------------------------+
|    Unframed Transfer    | -&gt;      +-------------------------+
+-------------------------+      &lt;- |    Unframed Transfer    |
+-------------------------+         +-------------------------+
|    Unframed Transfer    | -&gt;
+-------------------------+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-an-example-of-the-flow-of-p" class="selfRef">An example of the flow of protocol messages on a single UDP conversation between two entities</a>
            </figcaption></figure>
</div>
</section>
</section>
</div>
</section>
</div>
<section id="section-4">
      <h2 id="name-implementation-status">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-4-1">This section is to be removed before publishing as an RFC.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
[NOTE to the RFC Editor: please remove this section before publication, as well as the reference to <span>[<a href="#RFC7942" class="xref">RFC7942</a>]</span>, <span>[<a href="#github-dtn-demo-agent" class="xref">github-dtn-demo-agent</a>]</span>, and <span>[<a href="#github-dtn-wireshark" class="xref">github-dtn-wireshark</a>]</span>.]<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">
This section records the status of known implementations of the protocol defined by this specification at the time of posting of this Internet-Draft, and is based on a proposal described in <span>[<a href="#RFC7942" class="xref">RFC7942</a>]</span>.
The description of implementations in this section is intended to assist the IETF in its decision processes in progressing drafts to RFCs.
Please note that the listing of any individual implementation here does not imply endorsement by the IETF.
Furthermore, no effort has been spent to verify the information presented here that was supplied by IETF contributors.
This is not intended as, and must not be construed to be, a catalog of available implementations or their features.
Readers are advised to note that other implementations can exist.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
An example implementation of the this draft of UDPCL has been created as a GitHub project <span>[<a href="#github-dtn-demo-agent" class="xref">github-dtn-demo-agent</a>]</span> and is intended to use as a proof-of-concept and as a possible source of interoperability testing.
This example implementation uses D-Bus as the CL-BP Agent interface, so it only runs on hosts which provide the Python "dbus" library.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">
A wireshark dissector for UDPCL has been created as a GitHub project <span>[<a href="#github-dtn-wireshark" class="xref">github-dtn-wireshark</a>]</span> and has been kept in-sync with the latest encoding of this specification.<a href="#section-4-5" class="pilcrow">¶</a></p>
</section>
<div id="sec-security">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">
This section separates security considerations into threat categories based on guidance of BCP 72 <span>[<a href="#RFC3552" class="xref">RFC3552</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<section id="section-5.1">
        <h3 id="name-threat-passive-leak-of-node">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-threat-passive-leak-of-node" class="section-name selfRef">Threat: Passive Leak of Node Data</a>
        </h3>
<p id="section-5.1-1">
When used without DTLS security, the UDPCL can expose the Node ID and other configuration data to passive eavesdroppers.
This can occur even if no bundle transfers are transmitted.
This can be avoided by always using DTLS, even if authentication is not available (see <a href="#sec-security-tlsalt" class="xref">Section 5.10</a>).<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.2">
        <h3 id="name-threat-passive-leak-of-bund">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-threat-passive-leak-of-bund" class="section-name selfRef">Threat: Passive Leak of Bundle Data</a>
        </h3>
<p id="section-5.2-1">
UDPCL can be used to provide point-to-point unicast transport security, but does not provide multicast security, security of data-at-rest, and does not guarantee end-to-end bundle security.
In those cases the bundle security mechanisms defined in <span>[<a href="#I-D.ietf-dtn-bpsec" class="xref">I-D.ietf-dtn-bpsec</a>]</span> are to be used instead.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
When used without DTLS security, the UDPCL exposes all bundle data to passive eavesdroppers.
This can be avoided by always using DTLS for unicast messaging, even if authentication is not available (see <a href="#sec-security-tlsalt" class="xref">Section 5.10</a>).<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
<div id="sec-threat-tls-strip">
<section id="section-5.3">
        <h3 id="name-threat-transport-security-s">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-threat-transport-security-s" class="section-name selfRef">Threat: Transport Security Stripping</a>
        </h3>
<p id="section-5.3-1">
When security policy allows non-DTLS messaging, UDPCL does not protect against active network attackers.
It is possible for a on-path attacker to drop or alter packets containing Extension Map and/or DTLS handshake records, which will cause the receiver to not negotiate a DTLS session.
This leads to the "SSL Stripping" attack described in <span>[<a href="#RFC7457" class="xref">RFC7457</a>]</span>.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">
When DTLS is available on an entity, it is strongly encouraged that the security policy disallow non-DTLS messaging for unicast purposes.
This requires that the DTLS handshake occurs before any other UDPCL messaging, regardless of the policy-driven parameters of the handshake and policy-driven handling of the handshake outcome.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">
One mechanism to mitigate the possibility of DTLS stripping is the use of DNS-based Authentication of Named Entities (DANE) <span>[<a href="#RFC6698" class="xref">RFC6698</a>]</span> toward the passive peer.
This mechanism relies on DNS and is unidirectional, so it doesn't help with applying policy toward the active peer, but it can be useful in an environment using opportunistic security.
The configuration and use of DANE are outside of the scope of this document.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">
The negotiated use of DTLS is identical behavior to STARTTLS use in <span>[<a href="#RFC2595" class="xref">RFC2595</a>]</span>, <span>[<a href="#RFC4511" class="xref">RFC4511</a>]</span>, and others.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5.4">
        <h3 id="name-threat-weak-dtls-configurat">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-threat-weak-dtls-configurat" class="section-name selfRef">Threat: Weak DTLS Configurations</a>
        </h3>
<p id="section-5.4-1">
Even when using DTLS to secure the UDPCL session, the actual ciphersuite negotiated between the DTLS peers can be insecure.
Recommendations for ciphersuite use are included in BCP 195 <span>[<a href="#RFC7525" class="xref">RFC7525</a>]</span>.
It is up to security policies within each UDPCL entity to ensure that the negotiated DTLS ciphersuite meets transport security requirements.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
<div id="sec-threat-untrust-cert">
<section id="section-5.5">
        <h3 id="name-threat-untrusted-end-entity">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-threat-untrusted-end-entity" class="section-name selfRef">Threat: Untrusted End-Entity Certificate</a>
        </h3>
<p id="section-5.5-1">
The profile in <a href="#sec-dtls-authentication" class="xref">Section 3.7.4</a> uses end-entity certificates chained up to a trusted root CA.
During DTLS handshake, either entity can send a certificate set which does not contain the full chain, possibly excluding intermediate or root CAs.
In an environment where peers are known to already contain needed root and intermediate CAs there is no need to include those CAs, but this has a risk of an entity not actually having one of the needed CAs.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5.6">
        <h3 id="name-threat-certificate-validati">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-threat-certificate-validati" class="section-name selfRef">Threat: Certificate Validation Vulnerabilities</a>
        </h3>
<p id="section-5.6-1">
Even when DTLS itself is operating properly an attacker can attempt to exploit vulnerabilities within certificate check algorithms or configuration to establish a secure DTLS session using an invalid certificate.
An invalid certificate exploit could lead to bundle data leaking and/or denial of service to the Node ID being impersonated.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">
There are many reasons, described in <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> and <span>[<a href="#RFC6125" class="xref">RFC6125</a>]</span>, why a certificate can fail to validate, including using the certificate outside of its valid time interval, using purposes for which it was not authorized, or using it after it has been revoked by its CA.
Validating a certificate is a complex task and can require network connectivity outside of the primary UDPCL network path(s) if a mechanism such as OCSP <span>[<a href="#RFC6960" class="xref">RFC6960</a>]</span> is used by the CA.
The configuration and use of particular certificate validation methods are outside of the scope of this document.<a href="#section-5.6-2" class="pilcrow">¶</a></p>
</section>
<div id="sec-threat-node-impersonation">
<section id="section-5.7">
        <h3 id="name-threat-bp-node-impersonatio">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-threat-bp-node-impersonatio" class="section-name selfRef">Threat: BP Node Impersonation</a>
        </h3>
<p id="section-5.7-1">
The certificates exchanged by DTLS enable authentication of peer DNS name and Node ID, but it is possible that a peer either not provide a valid certificate or that the certificate does not validate either the DNS-ID/IPADDR-ID or NODE-ID of the peer (see <a href="#sec-pkix-env" class="xref">Section 2.2</a>).
Having a CA-validated certificate does not alone guarantee the identity of the network host or BP node from which the certificate is provided; additional validation procedures in <a href="#sec-dtls-handshake" class="xref">Section 3.7.3</a> bind the DNS-ID/IPADDR-ID or NODE-ID based on the contents of the certificate.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">
The DNS-ID/IPADDR-ID validation is a weaker form of authentication, because even if a peer is operating on an authenticated network DNS name or IP address it can provide an invalid Node ID and cause bundles to be "leaked" to an invalid node.
Especially in DTN environments, network names and addresses of nodes can be time-variable so binding a certificate to a Node ID is a more stable identity.<a href="#section-5.7-2" class="pilcrow">¶</a></p>
<p id="section-5.7-3">
NODE-ID validation ensures that the peer to which a bundle is transferred is in fact the node which the BP Agent expects it to be.
In circumstances where certificates can only be issued to DNS names, Node ID validation is not possible but it could be reasonable to assume that a trusted host is not going to present an invalid Node ID.
Determining when a DNS-ID/IPADDR-ID authentication can be trusted to validate a Node ID is also a policy matter outside of the scope of this document.<a href="#section-5.7-3" class="pilcrow">¶</a></p>
<p id="section-5.7-4">
One mitigation to arbitrary entities with valid PKIX certificates impersonating arbitrary Node IDs is the use of the PKIX Extended Key Usage key purpose "id-kp-bundleSecurity" of <span>[<a href="#IANA-SMI" class="xref">IANA-SMI</a>]</span>.
When this Extended Key Usage is present in the certificate, it represents a stronger assertion that the private key holder should in fact be trusted to operate as a DTN Node.<a href="#section-5.7-4" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5.8">
        <h3 id="name-threat-denial-of-service">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-threat-denial-of-service" class="section-name selfRef">Threat: Denial of Service</a>
        </h3>
<p id="section-5.8-1">
The behaviors described in this section all amount to a potential denial-of-service to a UDPCL entity.
The denial-of-service could be limited to an individual UDPCL entity, or could affect all entities on a host or network segment.<a href="#section-5.8-1" class="pilcrow">¶</a></p>
<p id="section-5.8-2">
An entity can send a large amount of data to a UDPCL entity, requiring the receiving entity to handle the data.
The victim entity can block UDP packets from network peers which are thought to be incorrectly behaving within network.<a href="#section-5.8-2" class="pilcrow">¶</a></p>
<p id="section-5.8-3">
An entity can also send only one fragment of a seemingly valid transfer and never send the remaining fragments, which will cause resources on the receiver to be wasted on transfer reassembly state.
The victim entity can either block packets from network peers or intentionally keep a short unfinished transfer timeout (see <a href="#sec-transfer-fragmentation" class="xref">Section 3.6.2</a>).<a href="#section-5.8-3" class="pilcrow">¶</a></p>
<p id="section-5.8-4">
The keepalive mechanism can be abused to waste throughput within a network link which would otherwise be usable for bundle transmissions.<a href="#section-5.8-4" class="pilcrow">¶</a></p>
</section>
<div id="sec-security-dtls-mandate">
<section id="section-5.9">
        <h3 id="name-mandatory-to-implement-dtls">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-mandatory-to-implement-dtls" class="section-name selfRef">Mandatory-to-Implement DTLS</a>
        </h3>
<p id="section-5.9-1">
Following IETF best current practice, DTLS is mandatory to implement for all UDPCL implementations but DTLS is optional to use for a any given transfer.
The recommended configuration of <a href="#sec-ext-starttls" class="xref">Section 3.5.1</a> is to always attempt DTLS, but entities are permitted to disable DTLS based on local configuration.
The configuration to enable or disable DTLS for an entity or a session is outside of the scope of this document.
The configuration to disable DTLS is different from the threat of DTLS stripping described in <a href="#sec-threat-tls-strip" class="xref">Section 5.3</a>.<a href="#section-5.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-security-tlsalt">
<section id="section-5.10">
        <h3 id="name-alternate-uses-of-dtls">
<a href="#section-5.10" class="section-number selfRef">5.10. </a><a href="#name-alternate-uses-of-dtls" class="section-name selfRef">Alternate Uses of DTLS</a>
        </h3>
<p id="section-5.10-1">
This specification makes use of PKIX certificate validation and authentication within DTLS.
There are alternate uses of DTLS which are not necessarily incompatible with the security goals of this specification, but are outside of the scope of this document.
The following subsections give examples of alternate DTLS uses.<a href="#section-5.10-1" class="pilcrow">¶</a></p>
<div id="sec-security-tlsnoauth">
<section id="section-5.10.1">
          <h4 id="name-dtls-without-authentication">
<a href="#section-5.10.1" class="section-number selfRef">5.10.1. </a><a href="#name-dtls-without-authentication" class="section-name selfRef">DTLS Without Authentication</a>
          </h4>
<p id="section-5.10.1-1"> In environments where PKI is available but there are restrictions on the issuance of certificates (including the contents of certificates), it may be possible to make use of DTLS in a way which authenticates only the passive entity of a UDPCL transfer or which does not authenticate either entity.
Using DTLS in a way which does not successfully authenticate some claim of both peer entities of a UDPCL transfer is outside of the scope of this document but does have similar properties to the opportunistic security model of <span>[<a href="#RFC7435" class="xref">RFC7435</a>]</span>.<a href="#section-5.10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-security-tlsnopki">
<section id="section-5.10.2">
          <h4 id="name-non-certificate-dtls-use">
<a href="#section-5.10.2" class="section-number selfRef">5.10.2. </a><a href="#name-non-certificate-dtls-use" class="section-name selfRef">Non-Certificate DTLS Use</a>
          </h4>
<p id="section-5.10.2-1">
In environments where PKI is unavailable, alternate uses of DTLS which do not require certificates such as pre-shared key (PSK) authentication <span>[<a href="#RFC5489" class="xref">RFC5489</a>]</span> and the use of raw public keys <span>[<a href="#RFC7250" class="xref">RFC7250</a>]</span> are available and can be used to ensure confidentiality within UDPCL.
Using non-PKI node authentication methods is outside of the scope of this document.<a href="#section-5.10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-security-xferid">
<section id="section-5.11">
        <h3 id="name-predictability-of-transfer-">
<a href="#section-5.11" class="section-number selfRef">5.11. </a><a href="#name-predictability-of-transfer-" class="section-name selfRef">Predictability of Transfer IDs</a>
        </h3>
<p id="section-5.11-1">
The only requirement on Transfer IDs is that they are unique from the transmitting peer only.
The trivial algorithm of the first transfer starting at zero and later transfers incrementing by one causes absolutely predictable Transfer IDs.
Even when UDPCL is not DTLS secured and there is a on-path attacker altering UDPCL messages, there is no UDPCL feedback mechanism to interrupt or refuse a transfer so there is no benefit in having unpredictable Transfer IDs.<a href="#section-5.11-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-iana">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">
Registration procedures referred to in this section are defined in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="sec-iana-port">
<section id="section-6.1">
        <h3 id="name-port-number">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-port-number" class="section-name selfRef">Port Number</a>
        </h3>
<p id="section-6.1-1">
Within the port registry of <span>[<a href="#IANA-PORTS" class="xref">IANA-PORTS</a>]</span>, UDP port number 4556 has been previously assigned as the default port for the UDP convergence layer in <span>[<a href="#RFC7122" class="xref">RFC7122</a>]</span>.
This assignment to UDPCL is unchanged, but the assignment reference is updated to this specification.
There is no UDPCL version indication on-the-wire but this specification is a superset of <span>[<a href="#RFC7122" class="xref">RFC7122</a>]</span> and is fully backward compatible.
The related assignment for DCCP port 4556 (registered by <span>[<a href="#RFC7122" class="xref">RFC7122</a>]</span>) is unchanged.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Parameter</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Service Name:</td>
              <td class="text-left" rowspan="1" colspan="1">dtn-bundle</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Transport Protocol(s):</td>
              <td class="text-left" rowspan="1" colspan="1">UDP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Assignee:</td>
              <td class="text-left" rowspan="1" colspan="1">IESG &lt;iesg@ietf.org&gt;</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Contact:</td>
              <td class="text-left" rowspan="1" colspan="1">IESG &lt;iesg@ietf.org&gt;</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Description:</td>
              <td class="text-left" rowspan="1" colspan="1">DTN Bundle UDP CL Protocol</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Reference:</td>
              <td class="text-left" rowspan="1" colspan="1">This specification.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Port Number:</td>
              <td class="text-left" rowspan="1" colspan="1">4556</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sec-iana-extension-types">
<section id="section-6.2">
        <h3 id="name-udpcl-extension-types">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-udpcl-extension-types" class="section-name selfRef">UDPCL Extension Types</a>
        </h3>
<p id="section-6.2-1">EDITOR NOTE: sub-registry to-be-created upon publication of this specification.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">
IANA will create, under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="xref">IANA-BUNDLE</a>]</span>, a sub-registry titled "Bundle Protocol UDP Convergence-Layer Extension Types" and initialize it with the contents of <a href="#tab-iana-extension-types" class="xref">Table 3</a>.
For positive code points the registration procedure is Specification Required.
Negative code points are reserved for use on private networks for functions not published to the IANA.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">
Specifications of new extension types need to define the CBOR item structure of the extension data as well as the purpose and relationship of the new extension to existing session/transfer state within the baseline UDPCL sequencing.
Receiving entities will ignore items with unknown Extension ID, and that behavior needs to be considered by new extension types.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">
Expert(s) are encouraged to be biased towards approving registrations unless they are abusive, frivolous, or actively harmful (not merely aesthetically displeasing, or architecturally dubious).<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<span id="name-extension-type-codes"></span><div id="tab-iana-extension-types">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-extension-type-codes" class="selfRef">Extension Type Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Extension ID</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">negative</td>
              <td class="text-left" rowspan="1" colspan="1">Private/Experimental Use</td>
              <td class="text-left" rowspan="1" colspan="1">This specification.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              <td class="text-left" rowspan="1" colspan="1">This specification.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Transfer</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#sec-ext-transfer" class="xref">Section 3.5.2</a> of this specification.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Sender Listen</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#sec-ext-sender-listen" class="xref">Section 3.5.3</a> of this specification.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">Sender Node ID</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#sec-ext-sender-nodeid" class="xref">Section 3.5.4</a> of this specification.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">DTLS Initiation (STARTTLS)</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#sec-ext-starttls" class="xref">Section 3.5.1</a> of this specification.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">6-65535</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="sec-doc-ack">
<section id="section-7">
      <h2 id="name-acknowledgments">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-7-1">
TBD<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="IANA-BUNDLE">[IANA-BUNDLE]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Bundle Protocol"</span>, <span>&lt;<a href="https://www.iana.org/assignments/bundle/">https://www.iana.org/assignments/bundle/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-PORTS">[IANA-PORTS]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Service Name and Transport Protocol Port Number Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/service-names-port-numbers/">https://www.iana.org/assignments/service-names-port-numbers/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-IPv4-MCAST">[IANA-IPv4-MCAST]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IPv4 Multicast Address Space Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/multicast-addresses/">https://www.iana.org/assignments/multicast-addresses/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-IPv6-MCAST">[IANA-IPv6-MCAST]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IPv6 Multicast Address Space Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ipv6-multicast-addresses/">https://www.iana.org/assignments/ipv6-multicast-addresses/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-SMI">[IANA-SMI]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Structure of Management Information (SMI) Numbers"</span>, <span>&lt;<a href="https://www.iana.org/assignments/smi-numbers/">https://www.iana.org/assignments/smi-numbers/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0768">[RFC0768]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08" class="refDate">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc768">https://www.rfc-editor.org/info/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1122">[RFC1122]</dt>
        <dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Communication Layers"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1122</span>, <span class="seriesInfo">DOI 10.17487/RFC1122</span>, <time datetime="1989-10" class="refDate">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1122">https://www.rfc-editor.org/info/rfc1122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span><span class="refAuthor">, Fielding, R.</span><span class="refAuthor">, and L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5050">[RFC5050]</dt>
        <dd>
<span class="refAuthor">Scott, K.</span><span class="refAuthor"> and S. Burleigh</span>, <span class="refTitle">"Bundle Protocol Specification"</span>, <span class="seriesInfo">RFC 5050</span>, <span class="seriesInfo">DOI 10.17487/RFC5050</span>, <time datetime="2007-11" class="refDate">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5050">https://www.rfc-editor.org/info/rfc5050</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span><span class="refAuthor">, Santesson, S.</span><span class="refAuthor">, Farrell, S.</span><span class="refAuthor">, Boeyen, S.</span><span class="refAuthor">, Housley, R.</span><span class="refAuthor">, and W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[RFC6125]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span><span class="refAuthor"> and J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor"> and N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6960">[RFC6960]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span><span class="refAuthor">, Myers, M.</span><span class="refAuthor">, Ankney, R.</span><span class="refAuthor">, Malpani, A.</span><span class="refAuthor">, Galperin, S.</span><span class="refAuthor">, and C. Adams</span>, <span class="refTitle">"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"</span>, <span class="seriesInfo">RFC 6960</span>, <span class="seriesInfo">DOI 10.17487/RFC6960</span>, <time datetime="2013-06" class="refDate">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6960">https://www.rfc-editor.org/info/rfc6960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7525">[RFC7525]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span><span class="refAuthor">, Holz, R.</span><span class="refAuthor">, and P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <span class="seriesInfo">DOI 10.17487/RFC7525</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8085">[RFC8085]</dt>
        <dd>
<span class="refAuthor">Eggert, L.</span><span class="refAuthor">, Fairhurst, G.</span><span class="refAuthor">, and G. Shepherd</span>, <span class="refTitle">"UDP Usage Guidelines"</span>, <span class="seriesInfo">BCP 145</span>, <span class="seriesInfo">RFC 8085</span>, <span class="seriesInfo">DOI 10.17487/RFC8085</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8085">https://www.rfc-editor.org/info/rfc8085</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span><span class="refAuthor">, Vigano, C.</span><span class="refAuthor">, and C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor"> and P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dtn-bpbis">[I-D.ietf-dtn-bpbis]</dt>
        <dd>
<span class="refAuthor">Burleigh, S.</span><span class="refAuthor">, Fall, K.</span><span class="refAuthor">, and E. Birrane</span>, <span class="refTitle">"Bundle Protocol Version 7"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dtn-bpbis-31</span>, <time datetime="2021-01-25" class="refDate">25 January 2021</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-dtn-bpbis-31">https://tools.ietf.org/html/draft-ietf-dtn-bpbis-31</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dtn-tcpclv4">[I-D.ietf-dtn-tcpclv4]</dt>
      <dd>
<span class="refAuthor">Sipos, B.</span><span class="refAuthor">, Demmer, M.</span><span class="refAuthor">, Ott, J.</span><span class="refAuthor">, and S. Perreault</span>, <span class="refTitle">"Delay-Tolerant Networking TCP Convergence Layer Protocol Version 4"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dtn-tcpclv4-24</span>, <time datetime="2020-12-07" class="refDate">7 December 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-dtn-tcpclv4-24">https://tools.ietf.org/html/draft-ietf-dtn-tcpclv4-24</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC2595">[RFC2595]</dt>
        <dd>
<span class="refAuthor">Newman, C.</span>, <span class="refTitle">"Using TLS with IMAP, POP3 and ACAP"</span>, <span class="seriesInfo">RFC 2595</span>, <span class="seriesInfo">DOI 10.17487/RFC2595</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2595">https://www.rfc-editor.org/info/rfc2595</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3552">[RFC3552]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor"> and B. Korver</span>, <span class="refTitle">"Guidelines for Writing RFC Text on Security Considerations"</span>, <span class="seriesInfo">BCP 72</span>, <span class="seriesInfo">RFC 3552</span>, <span class="seriesInfo">DOI 10.17487/RFC3552</span>, <time datetime="2003-07" class="refDate">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3552">https://www.rfc-editor.org/info/rfc3552</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4511">[RFC4511]</dt>
        <dd>
<span class="refAuthor">Sermersheim, J., Ed.</span>, <span class="refTitle">"Lightweight Directory Access Protocol (LDAP): The Protocol"</span>, <span class="seriesInfo">RFC 4511</span>, <span class="seriesInfo">DOI 10.17487/RFC4511</span>, <time datetime="2006-06" class="refDate">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4511">https://www.rfc-editor.org/info/rfc4511</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4838">[RFC4838]</dt>
        <dd>
<span class="refAuthor">Cerf, V.</span><span class="refAuthor">, Burleigh, S.</span><span class="refAuthor">, Hooke, A.</span><span class="refAuthor">, Torgerson, L.</span><span class="refAuthor">, Durst, R.</span><span class="refAuthor">, Scott, K.</span><span class="refAuthor">, Fall, K.</span><span class="refAuthor">, and H. Weiss</span>, <span class="refTitle">"Delay-Tolerant Networking Architecture"</span>, <span class="seriesInfo">RFC 4838</span>, <span class="seriesInfo">DOI 10.17487/RFC4838</span>, <time datetime="2007-04" class="refDate">April 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4838">https://www.rfc-editor.org/info/rfc4838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5489">[RFC5489]</dt>
        <dd>
<span class="refAuthor">Badra, M.</span><span class="refAuthor"> and I. Hajjeh</span>, <span class="refTitle">"ECDHE_PSK Cipher Suites for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5489</span>, <span class="seriesInfo">DOI 10.17487/RFC5489</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5489">https://www.rfc-editor.org/info/rfc5489</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6698">[RFC6698]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor"> and J. Schlyter</span>, <span class="refTitle">"The DNS-Based Authentication of Named Entities (DANE) Transport Layer Security (TLS) Protocol: TLSA"</span>, <span class="seriesInfo">RFC 6698</span>, <span class="seriesInfo">DOI 10.17487/RFC6698</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6698">https://www.rfc-editor.org/info/rfc6698</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7122">[RFC7122]</dt>
        <dd>
<span class="refAuthor">Kruse, H.</span><span class="refAuthor">, Jero, S.</span><span class="refAuthor">, and S. Ostermann</span>, <span class="refTitle">"Datagram Convergence Layers for the Delay- and Disruption-Tolerant Networking (DTN) Bundle Protocol and Licklider Transmission Protocol (LTP)"</span>, <span class="seriesInfo">RFC 7122</span>, <span class="seriesInfo">DOI 10.17487/RFC7122</span>, <time datetime="2014-03" class="refDate">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7122">https://www.rfc-editor.org/info/rfc7122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7250">[RFC7250]</dt>
        <dd>
<span class="refAuthor">Wouters, P., Ed.</span><span class="refAuthor">, Tschofenig, H., Ed.</span><span class="refAuthor">, Gilmore, J.</span><span class="refAuthor">, Weiler, S.</span><span class="refAuthor">, and T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7250">https://www.rfc-editor.org/info/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7435">[RFC7435]</dt>
        <dd>
<span class="refAuthor">Dukhovni, V.</span>, <span class="refTitle">"Opportunistic Security: Some Protection Most of the Time"</span>, <span class="seriesInfo">RFC 7435</span>, <span class="seriesInfo">DOI 10.17487/RFC7435</span>, <time datetime="2014-12" class="refDate">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7435">https://www.rfc-editor.org/info/rfc7435</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7457">[RFC7457]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span><span class="refAuthor">, Holz, R.</span><span class="refAuthor">, and P. Saint-Andre</span>, <span class="refTitle">"Summarizing Known Attacks on Transport Layer Security (TLS) and Datagram TLS (DTLS)"</span>, <span class="seriesInfo">RFC 7457</span>, <span class="seriesInfo">DOI 10.17487/RFC7457</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7457">https://www.rfc-editor.org/info/rfc7457</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span><span class="refAuthor"> and A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7942">https://www.rfc-editor.org/info/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8899">[RFC8899]</dt>
        <dd>
<span class="refAuthor">Fairhurst, G.</span><span class="refAuthor">, Jones, T.</span><span class="refAuthor">, Tüxen, M.</span><span class="refAuthor">, Rüngeler, I.</span><span class="refAuthor">, and T. Völker</span>, <span class="refTitle">"Packetization Layer Path MTU Discovery for Datagram Transports"</span>, <span class="seriesInfo">RFC 8899</span>, <span class="seriesInfo">DOI 10.17487/RFC8899</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8899">https://www.rfc-editor.org/info/rfc8899</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8900">[RFC8900]</dt>
        <dd>
<span class="refAuthor">Bonica, R.</span><span class="refAuthor">, Baker, F.</span><span class="refAuthor">, Huston, G.</span><span class="refAuthor">, Hinden, R.</span><span class="refAuthor">, Troan, O.</span><span class="refAuthor">, and F. Gont</span>, <span class="refTitle">"IP Fragmentation Considered Fragile"</span>, <span class="seriesInfo">BCP 230</span>, <span class="seriesInfo">RFC 8900</span>, <span class="seriesInfo">DOI 10.17487/RFC8900</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8900">https://www.rfc-editor.org/info/rfc8900</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dtn-bpsec">[I-D.ietf-dtn-bpsec]</dt>
        <dd>
<span class="refAuthor">Birrane, E.</span><span class="refAuthor"> and K. McKeever</span>, <span class="refTitle">"Bundle Protocol Security Specification"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dtn-bpsec-26</span>, <time datetime="2021-01-08" class="refDate">8 January 2021</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-dtn-bpsec-26">https://tools.ietf.org/html/draft-ietf-dtn-bpsec-26</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="github-dtn-demo-agent">[github-dtn-demo-agent]</dt>
        <dd>
<span class="refAuthor">Sipos, B.</span>, <span class="refTitle">"UDPCL Example Implementation"</span>, <span>&lt;<a href="https://github.com/BSipos-RKF/dtn-demo-agent/">https://github.com/BSipos-RKF/dtn-demo-agent/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="github-dtn-wireshark">[github-dtn-wireshark]</dt>
      <dd>
<span class="refAuthor">Sipos, B.</span>, <span class="refTitle">"UDPCL Wireshark Dissector"</span>, <span>&lt;<a href="https://github.com/BSipos-RKF/dtn-wireshark/">https://github.com/BSipos-RKF/dtn-wireshark/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="section-appendix.a">
      <h2 id="name-significant-changes-from-rf">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-significant-changes-from-rf" class="section-name selfRef">Significant changes from RFC7122</a>
      </h2>
<p id="section-appendix.a-1">
The areas in which changes from <span>[<a href="#RFC7122" class="xref">RFC7122</a>]</span> have been made to existing requirements:<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.a-2.1">Made explicit references to UDP- and IP-related RFCs.<a href="#section-appendix.a-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-2.2">Made more strict Keepalive and Padding requirements.<a href="#section-appendix.a-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-2.3">Defined UDPCL security and made mandatory-to-implement.<a href="#section-appendix.a-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.a-3">
The areas in which extensions from <span>[<a href="#RFC7122" class="xref">RFC7122</a>]</span> have been made as new behaviors are:<a href="#section-appendix.a-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.a-4.1">Added BPv7 bundle as a possible UDPCL payload.<a href="#section-appendix.a-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-4.2">Added Extension Map message type and initial extension types.<a href="#section-appendix.a-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-4.3">Defined semantics for UDPCL multicast addressing.<a href="#section-appendix.a-4.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Brian Sipos</span></div>
<div dir="auto" class="left"><span class="org">RKF Engineering Solutions, LLC</span></div>
<div dir="auto" class="left"><span class="street-address">7500 Old Georgetown Road<br>Suite 1275</span></div>
<div dir="auto" class="left">
<span class="locality">Bethesda</span>, <span class="region">MD</span> <span class="postal-code">20814-6198</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:BSipos@rkf-eng.com" class="email">BSipos@rkf-eng.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
