<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>GSSAPI authentication for HTTP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="GSSAPI authentication for HTTP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header"> Johansson</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">SU</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">July 13, 2008</td></tr>
<tr><td class="header">Expires: January 14, 2009</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />GSSAPI authentication for HTTP<br />draft-johansson-http-gss-03</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 14, 2009.</p>

<h3>Abstract</h3>

<p>
				This document specifies an extention to the HTTP
				Negotiate authentication mechanism defined in RFC4559
				which supports mutual authentication, fast session-based
				reauth and channel bindings.
			
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Terminology<br />
<a href="#anchor2">2.</a>&nbsp;
Introduction and motivation<br />
<a href="#anchor3">3.</a>&nbsp;
HTTP GSS Authentication Mechanism<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
GSS Token Header Syntax<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Naming and Transport<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
Protocol Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.3.1.</a>&nbsp;
Intiating authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.3.2.</a>&nbsp;
The authentication phase<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.3.3.</a>&nbsp;
The authorization phase<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.3.4.</a>&nbsp;
Fast Renegotiation<br />
<a href="#anchor11">4.</a>&nbsp;
Examples<br />
<a href="#anchor12">5.</a>&nbsp;
Implementation Notes<br />
<a href="#anchor13">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor14">7.</a>&nbsp;
Notes & TODO<br />
<a href="#anchor15">8.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor16">9.</a>&nbsp;
Changes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">9.1.</a>&nbsp;
00 to 01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">9.2.</a>&nbsp;
02 to 03<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Terminology</h3>

<p>
				The keywords "MUST", "MUST NOT", "REQUIRED", "SHOULD",
				"SHOULD NOT" and "MAY" that appear in this document are
				to be interpreted as described in
				<a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>
			
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction and motivation</h3>

<p>
				<a class='info' href='#RFC4559'>[RFC4559]<span> (</span><span class='info'>Jaganathan, K., Zhu, L., and J. Brezak, &ldquo;SPNEGO-based Kerberos and NTLM HTTP Authentication in Microsoft Windows,&rdquo; June&nbsp;2006.</span><span>)</span></a>
				describes an authentication mechanism based on SPNEGO
				for HTTP. This mechanism suffers from a couple of
				drawbacks, notably:
				</p>
<blockquote class="text">
<p>
						Only supports single-round-trip GSS-API
						mechanisms
					
</p>
<p>
						Lack of channel bindings to the underlying HTTPS
						connection which makes in unsuitable for
						deployment in situations where proxies exists.
					
</p>
<p>
						Lack of session-based re-authentication (compare
						with TLS).
					
</p>
</blockquote><p>
				This document is intended to solve these problems by
				introducing a new authentication mechanism called 'GSS'.
				This mechanism is a proper extension of Negotiate but
				since Negotiate is already widely deployed this
				mechanism was given a separate name.
			
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
HTTP GSS Authentication Mechanism</h3>

<p>
				The GSS mechanism is an authentication mechanism for
				<a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>
				based on a multi-roundrip handshake using base64-encoded
				GSS-API
				<a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a>
				tokens encoded in the WWW-Authenticate Response Header
				and the Authorization Request Header. An important
				difference from
				<a class='info' href='#RFC4559'>[RFC4559]<span> (</span><span class='info'>Jaganathan, K., Zhu, L., and J. Brezak, &ldquo;SPNEGO-based Kerberos and NTLM HTTP Authentication in Microsoft Windows,&rdquo; June&nbsp;2006.</span><span>)</span></a>
				is that multiple roundtrips are supported which means
				that the server can be authenticated to the client (aka
				mutual authentication).
			
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
GSS Token Header Syntax</h3>

<p>
					Both the Authorization and the WWW-Authenticate
					headers use the same syntax throughout the handshake
					(cf below for details on the protocol flow)
					specified by this Augmented BNF following
					<a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a> and <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>:
					</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   challenge 	            = auth-scheme 1*SP 1#auth-param
   auth-scheme              = "GSS"
   auth-param               = auth-param-type "=" auth-param-value
   auth-param-value         = ( token | quoted-string )
   auth-param-type          = ( "auth-data" | "context-identifier" )
   auth-data-value          = 1*(UPALPHA|DIGIT)  ;base64-encoded
   context-identifier-value = 1*(UPALPHA|DIGIT)  ;base64-encoded
</pre></div><p>

					The auth-param types defined by this specification
					(auth-data and context-identifier) both have
					auth-param-value which contain base64 encoded data.
					Note that both the auth-data and context-identifier
					auth-param may be absent. The semantics of these
					parameters will be explained below. Each
					auth-param-type MUST NOT occur more than once in a
					single challenge.
				
</p>
<p>
					[NOTE: It may be interesting to allow existing implementations 
					of NEGOTIATE to treat the fast reauth feature as an optional 
					extension. In this case it will be necessary to change to way 
					the authentication token is represented.]
				
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Naming and Transport</h3>

<p>
					The GSS name of the server is
					"HTTP@&lt;hostname&gt;[:port]" where the :port part
					is absent if the port == 80 or if the port == 443.
				
</p>
<p>
					This mechanism SHOULD be used together with an HTTP
					transport providing session protection and
					encryption such as
					<a class='info' href='#RFC2817'>[RFC2817]<span> (</span><span class='info'>Khare, R. and S. Lawrence, &ldquo;Upgrading to TLS Within HTTP/1.1,&rdquo; May&nbsp;2000.</span><span>)</span></a>
					or
					<a class='info' href='#RFC2818'>[RFC2818]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a>
					. Session protection is a requirement for fast
					reauthentication described below.
				
</p>
<p>
					Like
					<a class='info' href='#RFC4559'>[RFC4559]<span> (</span><span class='info'>Jaganathan, K., Zhu, L., and J. Brezak, &ldquo;SPNEGO-based Kerberos and NTLM HTTP Authentication in Microsoft Windows,&rdquo; June&nbsp;2006.</span><span>)</span></a>
					the mechanism described in this specification is
					based on mapping the GSS-API protocol to HTTP
					requests and responses where the GSS-API tokens are
					sent in the Authorization and WWW-Authentication
					headers. Unlike
					<a class='info' href='#RFC4559'>[RFC4559]<span> (</span><span class='info'>Jaganathan, K., Zhu, L., and J. Brezak, &ldquo;SPNEGO-based Kerberos and NTLM HTTP Authentication in Microsoft Windows,&rdquo; June&nbsp;2006.</span><span>)</span></a>
					the entire handshake need not take place using a
					single TCP connection or a single HTTP/1.1 session.
					Instead opaque identifiers in the GSS challenge
					option field are optionally used together with
					channel bindings to provide a way to share a
					security context over several HTTP connections. This
					mechanism also serves as a way to let the client do
					a fast reauthentication to the server.
				
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Protocol Flow</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
Intiating authentication</h3>

<p>
						Normally the server initiates an authentication
						handshake when the client attempts to access a
						protected resource. The exception is when the
						client knows that it is accessing a protected
						resource and that the server supports the GSS
						mechanism, for instance when fast
						re-authentication is attempted by the client (cf
						below). In both cases the GSS-API negotiation is
						initiated by the client - i.e if the server
						initiates the authentication it is only to
						inform the client that authentication is
						required. The client SHOULD request mutual
						authentication from the GSS-API layer.
					
</p>
<p>
						Note that the first request by the client to a
						protected resource will also serve to let the
						client and server establish channel bindings
						using the 'tls-server-end-point' CB type which 
						means that this first request is not in general 
						"wasted" even in the case when the client has 
						no prior knowledge about the server or is attempting 
						fast re-authentication.
					
</p>
<p>
						If the client tries to access a protected
						resource the server may return a code 401
						response with an WWW-Authenticate header
						containing a list of authentication challenges
						allowing the client to choose among different
						authentication mechanisms supported by the
						server. If the server supports the "GSS"
						mechanism the server returns a challenge with
						only the auth-scheme part ("GSS") and no
						parameters along with any other challenges for
						mechanisms supported by the server. This first
						request also allows the client and server to
						establish channel-bindings.
					
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2"></a><h3>3.3.2.&nbsp;
The authentication phase</h3>

<p>
						In each case below when GSS-API tokens resulting
						from calls into the GSS-API layer are sent from
						the server to the client or vice-versa, the
						token is encoded using base64 and sent as the
						"auth-data" parameter value of the Authorization
						and WWW-Authenticate headers respectively.
					
</p>
<p>
						A client initiates the authentication phase by
						sending the token resulting from the first call
						to gss_init_security_context to the server.
					
</p>
<p>
						Upon receipt of token (i.e a request with an
						accompanying Authenticate header with non-empty
						"auth-data" parameter value), the server MUST
						return the token resulting from a call to
						gss_accept_security_context in a code 401
						response, unless the call to
						gss_accept_security_context fails in which case
						a code 403 response is returned.
					
</p>
<p>
						If the underlying transport provides session
						protection (eg HTTPS) and if channel-bindings
						are in place (cf below) then the server MAY
						include a unique identifier of the security
						context beeing negotiated (or having been
						negotiated in the case of the last transaction)
						in the "context-identifier" parameter value. The
						server MUST uniquely associate this identifier
						with the client and the security context.
					
</p>
<p>
						Upon receipt of a code 401 response from the
						server when the WWW-Authenticate header contains
						a non-empty "auth-data" parameter value, the
						client MUST return the token resulting from a
						call to gss_initiate_security_context to the
						server in a new request to the same resource. If
						the call fails the client MUST close the
						connection. If a "context-identifier" parameter
						value is present in the response from the server
						the client MUST include this in the ensuing request as
						the "context-identifier" parameter value. If the
						"context-identifier" parameter value is not
						present in the response from the server the
						client MUST use the same HTTP/1.1 connection for
						the entier handshake. If the client breaks the
						HTTP/1.1 connection the server MUST invalidate
						the security context unless a context identifier
						was sent to the client and returned to the
						server.
					
</p>
<p>
						A client may close the connection both as the
						result of using the context-identifier to spread
						the authentication over several underlying
						connections or as the result of a failed call to
						gss_initiate_security_context. This might at
						first seem like a problem but the GSS-API layer
						combined with proper handling of the context
						identifier will ensure that handling of these
						cases are disambiguated at the server.
					
</p>
<p>
						The client and server continues the handshake
						until either an error occurs (in which case a
						403 is returned to the client or the client
						closes the connection depending on where the
						error happens) or the GSS-API layer has
						successfully completed the negotiation in which
						case the server sends a normal response to the
						client. If the last call to
						gss_accept_sec_context on the server resulted in
						a non-empty token the server MUST include this
						in a WWW-Authenticate header in the response to
						the client regardless of the return code which
						is beeing sent to the client. If the underlying
						transport provides session protection (eg HTTPS)
						and if channel-bindings are in place (cf below)
						then the server MAY include a
						"context-identifier" parameter value uniquely
						identifying the established security context.
						The server MAY decide to limit the validity of
						the established context and MAY choose not to
						consider references to the context after a
						certain amount of time (cf below).
					
</p>
<p>
						If the client receives a normal response with an
						non-empty "auth-data" parameter value the client
						MUST call gss_initiate_sec_context with this
						token as input to complete the authentication
						handshake. If the final response contains a
						"context-identifier" parameter value the client
						may cache it and use it to provide fast
						re-authentication by including it in a
						Authorization header with "GSS" mechanism and
						empty "auth-data" parameter value.
					
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3"></a><h3>3.3.3.&nbsp;
The authorization phase</h3>

<p>
						Authorization failures can occur even if the
						client is successfully authenticated to the
						server. In this case the server will send a 403
						response to the client even though the GSS-API
						handshake has succeeded. It is important to let
						the client and server finish the authentication
						handshake even if the client is not authorized
						to access the resource. Therefore the client
						MUST call gss_initiate_sec_context with any
						GSS-API token returned to the client, even if
						the token was sent along with a 403 response.
					
</p>
<p>
						During authorization the server MAY use the
						GSS-API name associated with the established 
						security context for authorization decisions
						and SHOULD provide a string representation of
						the GSS-API name as the REMOTE_USER meta-variable
						and "GSS" as the AUTH_TYPE meta-variable if the
						Commong Gateway Interface is provided by the server.
					
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.4"></a><h3>3.3.4.&nbsp;
Fast Renegotiation</h3>

<p>
						Upon receipt of a request containing an
						Authorization header with the "GSS" mechanism,
						an empty auth-data and the context-identifier
						parameter value, the server MUST verify that the
						identifier references a valid security context.
						If the security context is missing or invalid
						the server MUST return a 401 response prompting
						the client to re-negotiate the security context.
						If the identifier references a valid security
						context the server MUST process the request as
						if the client had just completed the full
						authentication handshake.
					
</p>
<p>
						When this process is completed the client is
						authenticated to the server and possibly
						(depending on the way the GSS-API layer was
						called and which GSS-mechanism was used) the
						server is authenticated to the client.
					
</p>
<p>
						The use of fast regegotiation is optional and
						clients and servers MUST NOT assume that this
						feature is supported. 
					
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Examples</h3>

<p>TODO
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Implementation Notes</h3>

<p>
				The context-identifier could be produced by exporting
				the security context through gss_export_sec_context
				which requires that the GSS-API implementation supports
				exporting unfinished contexts.
			
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
				Should channel-bindings be absent, the protocol is
				subject to a MITM attack unless the authentication is
				between a client and a server with no proxies in between
				and each request is sent over the same HTTP/1.1
				connection.
			
</p>
<p>
				If fast re-authentication is used together with GSS-API
				credentials delegation the server will need to associate
				forwarded credentials with the negotiated security
				context. This presents a challenge for server
				implementors since it must be guarateed that security
				states and their associated credentials must be
				separated from each other.
			
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Notes & TODO</h3>

<p>
				Write a specification of how the client and server uses
				draft-johansson-http-tls-cb.
			
</p>
<p>
				Rewrite the CGI language as non-normative text.
			
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>
				Registration of the GSS HTTP authentication mechanism?
			
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Changes</h3>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
00 to 01</h3>

<p>
		    		Changed from ABNF to Augmented BNF to align with <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>.
		    	
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
02 to 03</h3>

<p>
		    		Added reference to rfc 5056.
		    	
</p>
<p>
		    		Reference to tls-server-end-point channel binding mechanism.
		    	
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2617">[RFC2617]</a></td>
<td class="author-text"><a href="mailto:john@math.nwu.edu">Franks, J.</a>, <a href="mailto:pbaker@verisign.com">Hallam-Baker, P.</a>, <a href="mailto:jeff@AbiSource.com">Hostetler, J.</a>, <a href="mailto:lawrence@agranat.com">Lawrence, S.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, Luotonen, A., and <a href="mailto:stewart@OpenMarket.com">L. Stewart</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2617">HTTP Authentication: Basic and Digest Access Authentication</a>,&rdquo; RFC&nbsp;2617, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2617.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2617.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2617.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2743">[RFC2743]</a></td>
<td class="author-text"><a href="mailto:jlinn@rsasecurity.com">Linn, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2743">Generic Security Service Application Program Interface Version 2, Update 1</a>,&rdquo; RFC&nbsp;2743, January&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2743.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2817">[RFC2817]</a></td>
<td class="author-text">Khare, R. and S. Lawrence, &ldquo;<a href="http://tools.ietf.org/html/rfc2817">Upgrading to TLS Within HTTP/1.1</a>,&rdquo; RFC&nbsp;2817, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2817.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2818">[RFC2818]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4234">[RFC4234]</a></td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">Crocker, D., Ed.</a> and <a href="mailto:paul.overell@thus.net">P. Overell</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; RFC&nbsp;4234, October&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4234.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4234.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4234.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5056">[RFC5056]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>,&rdquo; RFC&nbsp;5056, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5056.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC3875">[RFC3875]</a></td>
<td class="author-text">Robinson, D. and K. Coar, &ldquo;<a href="http://tools.ietf.org/html/rfc3875">The Common Gateway Interface (CGI) Version 1.1</a>,&rdquo; RFC&nbsp;3875, October&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3875.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc3875.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4559">[RFC4559]</a></td>
<td class="author-text">Jaganathan, K., Zhu, L., and J. Brezak, &ldquo;<a href="http://tools.ietf.org/html/rfc4559">SPNEGO-based Kerberos and NTLM HTTP Authentication in Microsoft Windows</a>,&rdquo; RFC&nbsp;4559, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4559.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Leif Johansson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Stockholm university</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:leifj@it.su.se">leifj@it.su.se</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.su.se/">http://www.su.se/</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
